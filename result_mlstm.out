############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 53/553 [00:00<00:00, 528.10it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 583.31it/s]extract the null data:  32%|███▏      | 175/553 [00:00<00:00, 414.59it/s]extract the null data:  43%|████▎     | 238/553 [00:00<00:00, 482.20it/s]extract the null data:  55%|█████▍    | 302/553 [00:00<00:00, 528.88it/s]extract the null data:  66%|██████▌   | 365/553 [00:00<00:00, 559.26it/s]extract the null data:  77%|███████▋  | 426/553 [00:00<00:00, 572.17it/s]extract the null data:  88%|████████▊ | 486/553 [00:00<00:00, 533.01it/s]extract the null data:  98%|█████████▊| 542/553 [00:01<00:00, 443.45it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 492.75it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 199.70it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 209.74it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 212.30it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 211.01it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 213.98it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 215.97it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:01, 216.07it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:01, 217.41it/s]replace nan value:  36%|███▌      | 197/553 [00:00<00:01, 194.88it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:02, 167.02it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 165.93it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 174.80it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 187.72it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 196.98it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 175.88it/s]replace nan value:  62%|██████▏   | 345/553 [00:01<00:01, 187.85it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 197.15it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 203.42it/s]replace nan value:  75%|███████▍  | 412/553 [00:02<00:00, 206.88it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 209.83it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 213.85it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 192.60it/s]replace nan value:  91%|█████████ | 501/553 [00:02<00:00, 199.37it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 203.90it/s]replace nan value:  98%|█████████▊| 544/553 [00:02<00:00, 198.74it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 197.40it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.04it/s]  5%|▌         | 28/553 [00:00<00:03, 136.79it/s]  8%|▊         | 42/553 [00:00<00:04, 103.03it/s] 10%|▉         | 54/553 [00:00<00:05, 89.41it/s]  12%|█▏        | 64/553 [00:00<00:07, 69.69it/s] 14%|█▎        | 76/553 [00:00<00:05, 80.98it/s] 16%|█▌        | 86/553 [00:00<00:05, 85.18it/s] 18%|█▊        | 99/553 [00:01<00:04, 93.46it/s] 21%|██        | 116/553 [00:01<00:03, 113.19it/s] 23%|██▎       | 129/553 [00:01<00:04, 104.78it/s] 25%|██▌       | 141/553 [00:01<00:03, 104.23it/s] 28%|██▊       | 154/553 [00:01<00:03, 109.78it/s] 30%|███       | 166/553 [00:01<00:03, 101.90it/s] 33%|███▎      | 182/553 [00:01<00:03, 116.68it/s] 36%|███▌      | 200/553 [00:01<00:02, 133.09it/s] 39%|███▉      | 217/553 [00:02<00:02, 141.10it/s] 42%|████▏     | 232/553 [00:02<00:02, 140.60it/s] 45%|████▌     | 249/553 [00:02<00:02, 144.75it/s] 48%|████▊     | 265/553 [00:02<00:01, 144.68it/s] 51%|█████     | 280/553 [00:02<00:01, 139.47it/s] 53%|█████▎    | 295/553 [00:02<00:01, 138.96it/s] 56%|█████▌    | 309/553 [00:02<00:01, 137.82it/s] 58%|█████▊    | 323/553 [00:02<00:01, 128.98it/s] 61%|██████    | 337/553 [00:02<00:01, 130.69it/s] 64%|██████▎   | 352/553 [00:02<00:01, 135.86it/s] 66%|██████▌   | 366/553 [00:03<00:01, 120.04it/s] 69%|██████▉   | 382/553 [00:03<00:01, 129.55it/s] 72%|███████▏  | 396/553 [00:03<00:01, 122.54it/s] 74%|███████▍  | 411/553 [00:03<00:01, 129.56it/s] 77%|███████▋  | 425/553 [00:03<00:01, 121.14it/s] 80%|███████▉  | 440/553 [00:03<00:00, 127.89it/s] 83%|████████▎ | 458/553 [00:03<00:00, 141.86it/s] 86%|████████▌ | 475/553 [00:03<00:00, 147.69it/s] 89%|████████▉ | 491/553 [00:04<00:00, 139.52it/s] 92%|█████████▏| 506/553 [00:04<00:00, 138.37it/s] 94%|█████████▍| 521/553 [00:04<00:00, 137.75it/s] 97%|█████████▋| 535/553 [00:04<00:00, 123.34it/s]100%|█████████▉| 551/553 [00:04<00:00, 114.62it/s]100%|██████████| 553/553 [00:04<00:00, 120.64it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 419.66it/s]extract the null data:  80%|███████▉  | 111/139 [00:00<00:00, 574.07it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 575.87it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 237.31it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 237.41it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 220.85it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 214.94it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 220.52it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 224.17it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 128.93it/s] 19%|█▉        | 27/139 [00:00<00:00, 130.83it/s] 32%|███▏      | 44/139 [00:00<00:00, 142.49it/s] 42%|████▏     | 59/139 [00:00<00:00, 129.75it/s] 53%|█████▎    | 73/139 [00:00<00:00, 131.53it/s] 63%|██████▎   | 87/139 [00:00<00:00, 124.39it/s] 73%|███████▎  | 102/139 [00:00<00:00, 131.57it/s] 85%|████████▍ | 118/139 [00:00<00:00, 138.84it/s] 96%|█████████▌| 133/139 [00:01<00:00, 110.01it/s]100%|██████████| 139/139 [00:01<00:00, 121.98it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 2/173 [00:00<00:09, 17.15it/s]extract the null data:  24%|██▎       | 41/173 [00:00<00:00, 208.06it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 318.78it/s]extract the null data:  82%|████████▏ | 142/173 [00:00<00:00, 401.79it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 359.00it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 233.55it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 153.39it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 132.52it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 126.59it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 148.89it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 159.74it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 170.86it/s]replace nan value:  95%|█████████▍| 164/173 [00:00<00:00, 189.27it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 167.39it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 143.03it/s] 17%|█▋        | 30/173 [00:00<00:01, 135.47it/s] 28%|██▊       | 48/173 [00:00<00:00, 152.87it/s] 38%|███▊      | 65/173 [00:00<00:00, 154.75it/s] 47%|████▋     | 82/173 [00:00<00:00, 158.45it/s] 57%|█████▋    | 98/173 [00:00<00:00, 157.10it/s] 66%|██████▋   | 115/173 [00:00<00:00, 156.01it/s] 76%|███████▌  | 131/173 [00:00<00:00, 147.19it/s] 84%|████████▍ | 146/173 [00:00<00:00, 144.91it/s] 93%|█████████▎| 161/173 [00:01<00:00, 133.12it/s]100%|██████████| 173/173 [00:01<00:00, 132.46it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.574, valid loss : 0.408, train acc : 0.734, valid acc : 0.922, train f1 : 0.532, valid f1 : 0.582
training process:   1%|          | 1/128 [01:33<3:17:40, 93.39s/it]Best score increase :0.000 -> 0.582
training process:   2%|▏         | 2/128 [02:55<3:02:38, 86.97s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [04:18<2:56:56, 84.93s/it]Best score increase :0.582 -> 0.623
training process:   3%|▎         | 4/128 [06:02<3:10:47, 92.32s/it]Best score increase :0.623 -> 0.653
epoch : 5, train loss : 0.201, valid loss : 0.202, train acc : 0.935, valid acc : 0.932, train f1 : 0.683, valid f1 : 0.667
training process:   4%|▍         | 5/128 [08:18<3:41:54, 108.25s/it]Best score increase :0.653 -> 0.667
training process:   5%|▍         | 6/128 [10:13<3:44:28, 110.40s/it]Best score increase :0.667 -> 0.699
training process:   5%|▌         | 7/128 [12:18<3:52:26, 115.26s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [13:50<3:35:41, 107.85s/it]Best score increase :0.699 -> 0.717
epoch : 9, train loss : 0.172, valid loss : 0.180, train acc : 0.942, valid acc : 0.936, train f1 : 0.731, valid f1 : 0.716
training process:   7%|▋         | 9/128 [15:40<3:35:12, 108.51s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [17:26<3:32:01, 107.81s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [19:09<3:27:21, 106.33s/it]Best score increase :0.717 -> 0.734
training process:   9%|▉         | 12/128 [20:45<3:19:25, 103.15s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.158, valid loss : 0.178, train acc : 0.945, valid acc : 0.937, train f1 : 0.757, valid f1 : 0.715
training process:  10%|█         | 13/128 [22:37<3:22:39, 105.73s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [24:34<3:27:24, 109.16s/it]Best score increase :0.734 -> 0.740
training process:  12%|█▏        | 15/128 [26:16<3:21:38, 107.07s/it]Best score increase :0.740 -> 0.749
training process:  12%|█▎        | 16/128 [27:53<3:14:21, 104.12s/it]Best score increase :0.749 -> 0.758
epoch : 17, train loss : 0.146, valid loss : 0.160, train acc : 0.948, valid acc : 0.943, train f1 : 0.777, valid f1 : 0.763
training process:  13%|█▎        | 17/128 [29:39<3:13:30, 104.60s/it]Best score increase :0.758 -> 0.763
training process:  14%|█▍        | 18/128 [30:40<2:48:01, 91.65s/it] EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [31:44<2:31:21, 83.32s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [32:45<2:17:56, 76.63s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.135, valid loss : 0.158, train acc : 0.953, valid acc : 0.944, train f1 : 0.799, valid f1 : 0.776
training process:  16%|█▋        | 21/128 [33:59<2:15:03, 75.74s/it]Best score increase :0.763 -> 0.776
training process:  17%|█▋        | 22/128 [35:03<2:07:43, 72.30s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [36:09<2:03:06, 70.35s/it]Best score increase :0.776 -> 0.777
training process:  19%|█▉        | 24/128 [37:14<1:59:02, 68.68s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.126, valid loss : 0.151, train acc : 0.955, valid acc : 0.949, train f1 : 0.812, valid f1 : 0.795
training process:  20%|█▉        | 25/128 [38:25<1:59:26, 69.57s/it]Best score increase :0.777 -> 0.795
training process:  20%|██        | 26/128 [39:28<1:54:46, 67.51s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [40:33<1:52:18, 66.71s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [41:36<1:49:19, 65.59s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.119, valid loss : 0.146, train acc : 0.959, valid acc : 0.948, train f1 : 0.831, valid f1 : 0.794
training process:  23%|██▎       | 29/128 [42:48<1:51:29, 67.58s/it]EarlyStopping counter : 4 out of 12
training process:  23%|██▎       | 30/128 [43:51<1:47:57, 66.09s/it]EarlyStopping counter : 5 out of 12
training process:  24%|██▍       | 31/128 [44:58<1:47:07, 66.26s/it]Best score increase :0.795 -> 0.807
training process:  25%|██▌       | 32/128 [46:02<1:45:01, 65.64s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.111, valid loss : 0.144, train acc : 0.960, valid acc : 0.950, train f1 : 0.838, valid f1 : 0.803
training process:  26%|██▌       | 33/128 [47:29<1:53:58, 71.99s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [48:32<1:48:52, 69.50s/it]Best score increase :0.807 -> 0.816
training process:  27%|██▋       | 35/128 [49:57<1:54:54, 74.14s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [51:17<1:56:22, 75.90s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.106, valid loss : 0.143, train acc : 0.961, valid acc : 0.952, train f1 : 0.845, valid f1 : 0.815
training process:  29%|██▉       | 37/128 [52:46<2:01:00, 79.79s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [54:18<2:05:15, 83.51s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [55:37<2:01:50, 82.14s/it]Best score increase :0.816 -> 0.824
training process:  31%|███▏      | 40/128 [56:49<1:55:45, 78.93s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.102, valid loss : 0.144, train acc : 0.964, valid acc : 0.950, train f1 : 0.860, valid f1 : 0.799
training process:  32%|███▏      | 41/128 [58:20<2:00:04, 82.81s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [59:50<2:01:39, 84.88s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [1:01:29<2:06:15, 89.13s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [1:02:54<2:03:05, 87.92s/it]Best score increase :0.824 -> 0.834
epoch : 45, train loss : 0.101, valid loss : 0.132, train acc : 0.964, valid acc : 0.953, train f1 : 0.862, valid f1 : 0.827
training process:  35%|███▌      | 45/128 [1:04:33<2:06:10, 91.22s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [1:06:02<2:03:33, 90.41s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [1:07:24<1:58:36, 87.86s/it]Best score increase :0.834 -> 0.841
training process:  38%|███▊      | 48/128 [1:08:41<1:53:08, 84.85s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.095, valid loss : 0.133, train acc : 0.966, valid acc : 0.955, train f1 : 0.869, valid f1 : 0.830
training process:  38%|███▊      | 49/128 [1:10:15<1:54:57, 87.31s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [1:11:45<1:54:34, 88.13s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [1:13:20<1:55:50, 90.26s/it]EarlyStopping counter : 4 out of 12
training process:  41%|████      | 52/128 [1:14:50<1:54:13, 90.18s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.091, valid loss : 0.139, train acc : 0.968, valid acc : 0.956, train f1 : 0.876, valid f1 : 0.842
training process:  41%|████▏     | 53/128 [1:16:25<1:54:39, 91.73s/it]Best score increase :0.841 -> 0.842
training process:  42%|████▏     | 54/128 [1:17:44<1:48:23, 87.89s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [1:19:18<1:48:59, 89.58s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [1:20:46<1:47:06, 89.25s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.087, valid loss : 0.137, train acc : 0.968, valid acc : 0.954, train f1 : 0.877, valid f1 : 0.829
training process:  45%|████▍     | 57/128 [1:22:28<1:50:04, 93.02s/it]EarlyStopping counter : 4 out of 12
training process:  45%|████▌     | 58/128 [1:23:49<1:44:22, 89.46s/it]Best score increase :0.842 -> 0.845
training process:  46%|████▌     | 59/128 [1:25:14<1:41:15, 88.05s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [1:26:36<1:37:55, 86.41s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.090, valid loss : 0.137, train acc : 0.969, valid acc : 0.956, train f1 : 0.880, valid f1 : 0.840
training process:  48%|████▊     | 61/128 [1:28:13<1:40:00, 89.55s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [1:29:39<1:37:18, 88.46s/it]Best score increase :0.845 -> 0.852
training process:  49%|████▉     | 63/128 [1:31:07<1:35:33, 88.21s/it]EarlyStopping counter : 1 out of 12
training process:  50%|█████     | 64/128 [1:32:31<1:32:49, 87.02s/it]EarlyStopping counter : 2 out of 12
epoch : 65, train loss : 0.084, valid loss : 0.140, train acc : 0.970, valid acc : 0.956, train f1 : 0.884, valid f1 : 0.839
training process:  51%|█████     | 65/128 [1:34:20<1:38:14, 93.56s/it]EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 66/128 [1:35:44<1:33:36, 90.59s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 67/128 [1:37:02<1:28:29, 87.04s/it]EarlyStopping counter : 5 out of 12
training process:  53%|█████▎    | 68/128 [1:38:32<1:27:47, 87.79s/it]EarlyStopping counter : 6 out of 12
epoch : 69, train loss : 0.082, valid loss : 0.136, train acc : 0.970, valid acc : 0.958, train f1 : 0.887, valid f1 : 0.848
training process:  54%|█████▍    | 69/128 [1:40:24<1:33:36, 95.20s/it]EarlyStopping counter : 7 out of 12
training process:  55%|█████▍    | 70/128 [1:41:56<1:31:05, 94.23s/it]EarlyStopping counter : 8 out of 12
training process:  55%|█████▌    | 71/128 [1:43:27<1:28:31, 93.18s/it]EarlyStopping counter : 9 out of 12
training process:  56%|█████▋    | 72/128 [1:44:55<1:25:26, 91.54s/it]EarlyStopping counter : 10 out of 12
epoch : 73, train loss : 0.081, valid loss : 0.143, train acc : 0.971, valid acc : 0.957, train f1 : 0.891, valid f1 : 0.844
training process:  57%|█████▋    | 73/128 [1:46:53<1:31:20, 99.65s/it]EarlyStopping counter : 11 out of 12
training process:  57%|█████▋    | 73/128 [1:48:41<1:21:53, 89.34s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 73, best f1 score : 0.852
training process finished, best loss : 0.136 and best acc : 0.959, best f1 : 0.852, best epoch : 61

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.86      0.60      0.71       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.91      0.80      0.84      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.80, test loss : 11.262

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:12<02:21, 12.90s/it]processing for feature importance:  17%|█▋        | 2/12 [00:25<02:08, 12.86s/it]processing for feature importance:  25%|██▌       | 3/12 [00:37<01:50, 12.25s/it]processing for feature importance:  33%|███▎      | 4/12 [00:51<01:44, 13.11s/it]processing for feature importance:  42%|████▏     | 5/12 [01:05<01:33, 13.43s/it]processing for feature importance:  50%|█████     | 6/12 [01:19<01:20, 13.48s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:30<01:04, 12.90s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:43<00:51, 12.83s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:56<00:38, 12.81s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:07<00:24, 12.30s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:20<00:12, 12.62s/it]processing for feature importance: 100%|██████████| 12/12 [02:34<00:00, 12.81s/it]processing for feature importance: 100%|██████████| 12/12 [02:34<00:00, 12.85s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▌         | 16/306 [00:00<00:01, 159.18it/s] 10%|█         | 32/306 [00:00<00:01, 148.71it/s] 20%|█▉        | 61/306 [00:00<00:01, 209.96it/s] 31%|███       | 94/306 [00:00<00:00, 254.46it/s] 39%|███▉      | 120/306 [00:00<00:00, 203.73it/s] 46%|████▋     | 142/306 [00:00<00:00, 179.51it/s] 53%|█████▎    | 162/306 [00:00<00:00, 179.74it/s] 59%|█████▉    | 181/306 [00:00<00:00, 174.39it/s] 68%|██████▊   | 207/306 [00:01<00:00, 194.51it/s] 75%|███████▌  | 230/306 [00:01<00:00, 200.23it/s] 83%|████████▎ | 255/306 [00:01<00:00, 213.83it/s] 91%|█████████ | 278/306 [00:01<00:00, 217.67it/s] 99%|█████████▉| 303/306 [00:01<00:00, 226.03it/s]100%|██████████| 306/306 [00:01<00:00, 204.53it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   2%|▏         | 11/553 [00:00<00:04, 108.57it/s]extract the null data:   6%|▌         | 32/553 [00:00<00:03, 132.48it/s]extract the null data:  12%|█▏        | 67/553 [00:00<00:02, 190.69it/s]extract the null data:  16%|█▌        | 89/553 [00:00<00:02, 176.54it/s]extract the null data:  19%|█▉        | 107/553 [00:00<00:02, 169.86it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:02, 158.35it/s]extract the null data:  30%|██▉       | 164/553 [00:00<00:01, 224.84it/s]extract the null data:  37%|███▋      | 204/553 [00:00<00:01, 274.26it/s]extract the null data:  46%|████▌     | 255/553 [00:01<00:00, 340.90it/s]extract the null data:  53%|█████▎    | 291/553 [00:01<00:00, 293.36it/s]extract the null data:  59%|█████▉    | 328/553 [00:01<00:00, 312.86it/s]extract the null data:  65%|██████▌   | 362/553 [00:01<00:00, 297.83it/s]extract the null data:  71%|███████   | 394/553 [00:01<00:00, 269.38it/s]extract the null data:  79%|███████▊  | 435/553 [00:01<00:00, 304.37it/s]extract the null data:  87%|████████▋ | 483/553 [00:01<00:00, 349.80it/s]extract the null data:  95%|█████████▍| 523/553 [00:01<00:00, 362.92it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 279.49it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   1%|▏         | 8/553 [00:00<00:07, 77.02it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:06, 86.50it/s]replace nan value:   5%|▌         | 28/553 [00:00<00:06, 85.01it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:06, 81.97it/s]replace nan value:   8%|▊         | 47/553 [00:00<00:05, 87.28it/s]replace nan value:  10%|█         | 56/553 [00:00<00:06, 77.10it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:06, 73.97it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:06, 71.90it/s]replace nan value:  16%|█▌        | 86/553 [00:01<00:05, 83.38it/s]replace nan value:  18%|█▊        | 102/553 [00:01<00:04, 99.42it/s]replace nan value:  21%|██        | 117/553 [00:01<00:03, 111.86it/s]replace nan value:  24%|██▍       | 134/553 [00:01<00:03, 123.71it/s]replace nan value:  27%|██▋       | 151/553 [00:01<00:03, 130.86it/s]replace nan value:  30%|██▉       | 165/553 [00:01<00:03, 126.85it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 137.90it/s]replace nan value:  35%|███▌      | 196/553 [00:01<00:02, 131.31it/s]replace nan value:  38%|███▊      | 210/553 [00:01<00:02, 122.20it/s]replace nan value:  40%|████      | 223/553 [00:02<00:03, 105.04it/s]replace nan value:  42%|████▏     | 234/553 [00:02<00:03, 88.80it/s] replace nan value:  44%|████▍     | 244/553 [00:02<00:03, 86.12it/s]replace nan value:  46%|████▌     | 254/553 [00:02<00:03, 88.27it/s]replace nan value:  48%|████▊     | 264/553 [00:02<00:03, 72.48it/s]replace nan value:  51%|█████     | 283/553 [00:02<00:02, 98.06it/s]replace nan value:  55%|█████▍    | 302/553 [00:02<00:02, 118.96it/s]replace nan value:  58%|█████▊    | 322/553 [00:03<00:01, 137.71it/s]replace nan value:  62%|██████▏   | 342/553 [00:03<00:01, 152.61it/s]replace nan value:  65%|██████▍   | 359/553 [00:03<00:01, 124.75it/s]replace nan value:  68%|██████▊   | 374/553 [00:03<00:01, 128.55it/s]replace nan value:  70%|███████   | 389/553 [00:03<00:01, 128.12it/s]replace nan value:  73%|███████▎  | 403/553 [00:03<00:01, 121.91it/s]replace nan value:  75%|███████▌  | 416/553 [00:03<00:01, 114.60it/s]replace nan value:  77%|███████▋  | 428/553 [00:04<00:01, 104.34it/s]replace nan value:  79%|███████▉  | 439/553 [00:04<00:01, 87.90it/s] replace nan value:  81%|████████  | 449/553 [00:04<00:01, 74.39it/s]replace nan value:  83%|████████▎ | 458/553 [00:04<00:01, 72.89it/s]replace nan value:  85%|████████▍ | 470/553 [00:04<00:01, 79.86it/s]replace nan value:  87%|████████▋ | 479/553 [00:04<00:00, 82.16it/s]replace nan value:  88%|████████▊ | 488/553 [00:04<00:00, 81.40it/s]replace nan value:  91%|█████████ | 501/553 [00:04<00:00, 92.61it/s]replace nan value:  93%|█████████▎| 517/553 [00:05<00:00, 110.05it/s]replace nan value:  97%|█████████▋| 536/553 [00:05<00:00, 129.77it/s]replace nan value:  99%|█████████▉| 550/553 [00:05<00:00, 125.85it/s]replace nan value: 100%|██████████| 553/553 [00:05<00:00, 104.13it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 9/553 [00:00<00:06, 83.22it/s]  3%|▎         | 19/553 [00:00<00:06, 82.75it/s]  5%|▌         | 28/553 [00:00<00:06, 76.68it/s]  7%|▋         | 38/553 [00:00<00:08, 57.42it/s]  8%|▊         | 45/553 [00:00<00:08, 60.53it/s] 10%|▉         | 53/553 [00:00<00:07, 64.51it/s] 11%|█         | 60/553 [00:01<00:12, 40.74it/s] 12%|█▏        | 66/553 [00:01<00:13, 37.43it/s] 13%|█▎        | 71/553 [00:01<00:14, 34.25it/s] 14%|█▎        | 76/553 [00:01<00:13, 34.37it/s] 14%|█▍        | 80/553 [00:01<00:13, 34.30it/s] 16%|█▌        | 86/553 [00:01<00:12, 37.73it/s] 17%|█▋        | 92/553 [00:02<00:11, 39.60it/s] 18%|█▊        | 97/553 [00:02<00:11, 38.58it/s] 18%|█▊        | 101/553 [00:02<00:11, 37.98it/s] 20%|█▉        | 108/553 [00:02<00:09, 44.58it/s] 20%|██        | 113/553 [00:02<00:10, 41.95it/s] 22%|██▏       | 120/553 [00:02<00:09, 47.78it/s] 23%|██▎       | 125/553 [00:02<00:10, 41.96it/s] 24%|██▍       | 132/553 [00:02<00:08, 47.82it/s] 26%|██▌       | 142/553 [00:03<00:07, 58.31it/s] 28%|██▊       | 153/553 [00:03<00:05, 70.91it/s] 29%|██▉       | 162/553 [00:03<00:05, 75.34it/s] 31%|███       | 171/553 [00:03<00:04, 77.82it/s] 32%|███▏      | 179/553 [00:03<00:04, 76.49it/s] 34%|███▍      | 187/553 [00:03<00:04, 74.71it/s] 35%|███▌      | 196/553 [00:03<00:04, 77.77it/s] 37%|███▋      | 207/553 [00:03<00:04, 85.65it/s] 39%|███▉      | 216/553 [00:03<00:04, 78.66it/s] 41%|████      | 225/553 [00:04<00:05, 62.94it/s] 42%|████▏     | 232/553 [00:04<00:05, 56.43it/s] 44%|████▍     | 242/553 [00:04<00:04, 65.29it/s] 46%|████▌     | 254/553 [00:04<00:03, 77.04it/s] 48%|████▊     | 268/553 [00:04<00:03, 92.69it/s] 50%|█████     | 279/553 [00:04<00:03, 91.32it/s] 52%|█████▏    | 289/553 [00:04<00:03, 84.95it/s] 54%|█████▍    | 298/553 [00:05<00:03, 77.97it/s] 56%|█████▌    | 307/553 [00:05<00:03, 73.37it/s] 57%|█████▋    | 315/553 [00:05<00:03, 69.78it/s] 58%|█████▊    | 323/553 [00:05<00:03, 70.58it/s] 60%|█████▉    | 331/553 [00:05<00:03, 69.25it/s] 61%|██████▏   | 339/553 [00:05<00:03, 68.72it/s] 63%|██████▎   | 347/553 [00:05<00:03, 67.88it/s] 64%|██████▍   | 354/553 [00:05<00:03, 64.17it/s] 66%|██████▌   | 365/553 [00:05<00:02, 74.96it/s] 69%|██████▊   | 380/553 [00:06<00:01, 94.11it/s] 71%|███████   | 390/553 [00:06<00:01, 93.50it/s] 72%|███████▏  | 400/553 [00:06<00:01, 81.54it/s] 74%|███████▍  | 409/553 [00:06<00:01, 72.58it/s] 75%|███████▌  | 417/553 [00:06<00:02, 58.03it/s] 77%|███████▋  | 428/553 [00:06<00:01, 68.23it/s] 81%|████████  | 447/553 [00:06<00:01, 95.64it/s] 84%|████████▎ | 463/553 [00:07<00:00, 110.21it/s] 86%|████████▋ | 478/553 [00:07<00:00, 117.65it/s] 89%|████████▉ | 491/553 [00:07<00:00, 91.61it/s]  91%|█████████ | 502/553 [00:07<00:00, 78.67it/s] 93%|█████████▎| 512/553 [00:07<00:00, 79.31it/s] 94%|█████████▍| 521/553 [00:07<00:00, 72.18it/s] 96%|█████████▌| 529/553 [00:08<00:00, 66.18it/s] 97%|█████████▋| 539/553 [00:08<00:00, 72.32it/s] 99%|█████████▉| 549/553 [00:08<00:00, 76.13it/s]100%|██████████| 553/553 [00:08<00:00, 65.76it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  11%|█         | 15/139 [00:00<00:00, 148.23it/s]extract the null data:  45%|████▍     | 62/139 [00:00<00:00, 334.01it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 484.76it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 436.54it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 221.70it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 221.37it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 220.38it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 220.66it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 219.99it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 219.87it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 220.09it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.15it/s] 18%|█▊        | 25/139 [00:00<00:00, 123.29it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.33it/s] 39%|███▉      | 54/139 [00:00<00:00, 100.14it/s] 50%|████▉     | 69/139 [00:00<00:00, 114.59it/s] 60%|█████▉    | 83/139 [00:00<00:00, 120.27it/s] 69%|██████▉   | 96/139 [00:00<00:00, 121.07it/s] 78%|███████▊  | 109/139 [00:00<00:00, 123.10it/s] 91%|█████████▏| 127/139 [00:01<00:00, 136.88it/s]100%|██████████| 139/139 [00:01<00:00, 126.93it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 237.52it/s]extract the null data:  53%|█████▎    | 91/173 [00:00<00:00, 489.25it/s]extract the null data:  91%|█████████ | 157/173 [00:00<00:00, 566.76it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 528.91it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 155.19it/s]replace nan value:  20%|██        | 35/173 [00:00<00:00, 152.78it/s]replace nan value:  29%|██▉       | 51/173 [00:00<00:00, 152.36it/s]replace nan value:  39%|███▊      | 67/173 [00:00<00:00, 145.90it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 111.52it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 94.64it/s] replace nan value:  61%|██████▏   | 106/173 [00:01<00:00, 80.73it/s]replace nan value:  67%|██████▋   | 116/173 [00:01<00:00, 84.55it/s]replace nan value:  73%|███████▎  | 126/173 [00:01<00:00, 86.68it/s]replace nan value:  79%|███████▊  | 136/173 [00:01<00:00, 79.47it/s]replace nan value:  86%|████████▌ | 149/173 [00:01<00:00, 89.69it/s]replace nan value:  94%|█████████▎| 162/173 [00:01<00:00, 96.67it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 101.20it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  3%|▎         | 6/173 [00:00<00:03, 48.44it/s]  8%|▊         | 13/173 [00:00<00:02, 57.00it/s] 13%|█▎        | 23/173 [00:00<00:02, 69.22it/s] 20%|██        | 35/173 [00:00<00:01, 86.16it/s] 28%|██▊       | 48/173 [00:00<00:01, 95.77it/s] 35%|███▍      | 60/173 [00:00<00:01, 101.17it/s] 42%|████▏     | 73/173 [00:00<00:00, 109.57it/s] 49%|████▉     | 85/173 [00:00<00:00, 107.34it/s] 55%|█████▌    | 96/173 [00:01<00:00, 89.64it/s]  61%|██████▏   | 106/173 [00:01<00:00, 87.14it/s] 67%|██████▋   | 116/173 [00:01<00:00, 89.09it/s] 73%|███████▎  | 126/173 [00:01<00:00, 81.76it/s] 78%|███████▊  | 135/173 [00:01<00:00, 74.73it/s] 83%|████████▎ | 144/173 [00:01<00:00, 77.50it/s] 88%|████████▊ | 152/173 [00:01<00:00, 69.20it/s] 92%|█████████▏| 160/173 [00:02<00:00, 63.68it/s] 97%|█████████▋| 167/173 [00:02<00:00, 39.24it/s]100%|██████████| 173/173 [00:02<00:00, 33.43it/s]100%|██████████| 173/173 [00:02<00:00, 65.37it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.559, valid loss : 0.483, train acc : 0.710, valid acc : 0.759, train f1 : 0.709, valid f1 : 0.596
training process:   1%|          | 1/128 [02:21<5:00:28, 141.96s/it]Best score increase :0.000 -> 0.596
training process:   2%|▏         | 2/128 [04:39<4:52:35, 139.33s/it]Best score increase :0.596 -> 0.629
training process:   2%|▏         | 3/128 [06:47<4:39:18, 134.07s/it]Best score increase :0.629 -> 0.668
training process:   3%|▎         | 4/128 [09:03<4:39:03, 135.03s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.402, valid loss : 0.390, train acc : 0.821, valid acc : 0.854, train f1 : 0.821, valid f1 : 0.693
training process:   4%|▍         | 5/128 [11:43<4:54:44, 143.78s/it]Best score increase :0.668 -> 0.693
training process:   5%|▍         | 6/128 [13:42<4:35:24, 135.45s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [15:31<4:16:09, 127.02s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [17:10<3:55:44, 117.87s/it]Best score increase :0.693 -> 0.720
epoch : 9, train loss : 0.358, valid loss : 0.358, train acc : 0.842, valid acc : 0.862, train f1 : 0.842, valid f1 : 0.705
training process:   7%|▋         | 9/128 [19:04<3:51:36, 116.78s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [20:39<3:36:30, 110.09s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [22:16<3:26:48, 106.05s/it]Best score increase :0.720 -> 0.727
training process:   9%|▉         | 12/128 [24:03<3:25:37, 106.36s/it]Best score increase :0.727 -> 0.732
epoch : 13, train loss : 0.301, valid loss : 0.325, train acc : 0.871, valid acc : 0.864, train f1 : 0.871, valid f1 : 0.707
training process:  10%|█         | 13/128 [26:01<3:30:15, 109.70s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [27:49<3:27:51, 109.40s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [29:43<3:28:35, 110.75s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [31:42<3:31:09, 113.12s/it]Best score increase :0.732 -> 0.742
epoch : 17, train loss : 0.254, valid loss : 0.299, train acc : 0.897, valid acc : 0.867, train f1 : 0.897, valid f1 : 0.718
training process:  13%|█▎        | 17/128 [33:55<3:40:10, 119.01s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [35:45<3:33:32, 116.48s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [37:32<3:26:17, 113.55s/it]Best score increase :0.742 -> 0.744
training process:  16%|█▌        | 20/128 [39:14<3:17:58, 109.98s/it]Best score increase :0.744 -> 0.762
epoch : 21, train loss : 0.235, valid loss : 0.283, train acc : 0.905, valid acc : 0.878, train f1 : 0.905, valid f1 : 0.734
training process:  16%|█▋        | 21/128 [41:15<3:22:14, 113.40s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [43:06<3:18:52, 112.57s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [44:47<3:11:01, 109.16s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [46:35<3:08:42, 108.87s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.209, valid loss : 0.250, train acc : 0.916, valid acc : 0.890, train f1 : 0.916, valid f1 : 0.746
training process:  20%|█▉        | 25/128 [48:46<3:18:21, 115.54s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [50:44<3:17:50, 116.38s/it]Best score increase :0.762 -> 0.791
training process:  21%|██        | 27/128 [52:47<3:18:54, 118.16s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [54:36<3:12:21, 115.42s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.198, valid loss : 0.248, train acc : 0.921, valid acc : 0.898, train f1 : 0.921, valid f1 : 0.762
training process:  23%|██▎       | 29/128 [56:44<3:16:36, 119.16s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [58:35<3:10:57, 116.92s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [1:00:27<3:06:21, 115.27s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [1:02:21<3:03:50, 114.90s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.186, valid loss : 0.252, train acc : 0.928, valid acc : 0.897, train f1 : 0.928, valid f1 : 0.759
training process:  26%|██▌       | 33/128 [1:04:30<3:08:48, 119.25s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [1:06:16<3:00:45, 115.37s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [1:08:06<2:56:08, 113.64s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [1:10:13<3:00:29, 117.71s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.174, valid loss : 0.287, train acc : 0.932, valid acc : 0.885, train f1 : 0.932, valid f1 : 0.747
training process:  29%|██▉       | 37/128 [1:12:29<3:06:41, 123.09s/it]EarlyStopping counter : 11 out of 12
training process:  29%|██▉       | 37/128 [1:14:21<3:02:53, 120.59s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.791
training process finished, best loss : 0.215 and best acc : 0.919, best f1 : 0.791, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.53      0.77      0.63       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.86      0.80      7398
weighted avg       0.94      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.86, test loss : 11.946

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:16<02:56, 16.04s/it]processing for feature importance:  17%|█▋        | 2/12 [00:33<02:51, 17.16s/it]processing for feature importance:  25%|██▌       | 3/12 [00:52<02:38, 17.64s/it]processing for feature importance:  33%|███▎      | 4/12 [01:08<02:17, 17.15s/it]processing for feature importance:  42%|████▏     | 5/12 [01:26<02:02, 17.47s/it]processing for feature importance:  50%|█████     | 6/12 [01:43<01:44, 17.35s/it]processing for feature importance:  58%|█████▊    | 7/12 [02:00<01:25, 17.04s/it]processing for feature importance:  67%|██████▋   | 8/12 [02:16<01:07, 16.76s/it]processing for feature importance:  75%|███████▌  | 9/12 [02:35<00:52, 17.45s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:51<00:34, 17.03s/it]processing for feature importance:  92%|█████████▏| 11/12 [03:07<00:16, 16.85s/it]processing for feature importance: 100%|██████████| 12/12 [03:25<00:00, 17.19s/it]processing for feature importance: 100%|██████████| 12/12 [03:25<00:00, 17.15s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 136.32it/s] 10%|█         | 32/306 [00:00<00:01, 152.18it/s] 16%|█▋        | 50/306 [00:00<00:01, 148.07it/s] 21%|██        | 65/306 [00:00<00:01, 132.69it/s] 26%|██▌       | 79/306 [00:00<00:02, 110.66it/s] 31%|███▏      | 96/306 [00:00<00:01, 124.19it/s] 42%|████▏     | 129/306 [00:00<00:01, 173.30it/s] 48%|████▊     | 148/306 [00:01<00:01, 118.30it/s] 59%|█████▉    | 181/306 [00:01<00:00, 161.01it/s] 67%|██████▋   | 204/306 [00:01<00:00, 175.73it/s] 74%|███████▎  | 225/306 [00:01<00:00, 179.35it/s] 80%|████████  | 246/306 [00:01<00:00, 179.80it/s] 87%|████████▋ | 266/306 [00:01<00:00, 170.18it/s] 93%|█████████▎| 285/306 [00:01<00:00, 172.71it/s]100%|██████████| 306/306 [00:01<00:00, 159.90it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   3%|▎         | 15/553 [00:00<00:03, 149.02it/s]extract the null data:   5%|▌         | 30/553 [00:00<00:03, 135.13it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:04, 120.30it/s]extract the null data:  11%|█▏        | 63/553 [00:00<00:03, 144.08it/s]extract the null data:  21%|██        | 117/553 [00:00<00:01, 275.14it/s]extract the null data:  29%|██▉       | 159/553 [00:00<00:01, 315.70it/s]extract the null data:  38%|███▊      | 209/553 [00:00<00:00, 372.27it/s]extract the null data:  48%|████▊     | 264/553 [00:00<00:00, 426.02it/s]extract the null data:  57%|█████▋    | 317/553 [00:00<00:00, 455.42it/s]extract the null data:  66%|██████▌   | 364/553 [00:01<00:00, 392.05it/s]extract the null data:  73%|███████▎  | 406/553 [00:01<00:00, 348.16it/s]extract the null data:  80%|████████  | 443/553 [00:01<00:00, 235.40it/s]extract the null data:  88%|████████▊ | 487/553 [00:01<00:00, 274.02it/s]extract the null data:  97%|█████████▋| 539/553 [00:01<00:00, 326.78it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 306.54it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 183.26it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 183.22it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 178.52it/s]replace nan value:  14%|█▎        | 75/553 [00:00<00:03, 158.47it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:02, 165.08it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 160.03it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 164.48it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 173.43it/s]replace nan value:  30%|███       | 166/553 [00:00<00:02, 174.70it/s]replace nan value:  34%|███▎      | 186/553 [00:01<00:02, 181.10it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:02, 173.10it/s]replace nan value:  40%|████      | 223/553 [00:01<00:02, 149.64it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:02, 107.49it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:03, 94.28it/s] replace nan value:  48%|████▊     | 263/553 [00:01<00:03, 84.85it/s]replace nan value:  49%|████▉     | 273/553 [00:02<00:03, 79.68it/s]replace nan value:  51%|█████     | 283/553 [00:02<00:03, 82.99it/s]replace nan value:  53%|█████▎    | 294/553 [00:02<00:02, 88.12it/s]replace nan value:  56%|█████▌    | 311/553 [00:02<00:02, 107.76it/s]replace nan value:  59%|█████▉    | 329/553 [00:02<00:01, 125.65it/s]replace nan value:  63%|██████▎   | 347/553 [00:02<00:01, 137.74it/s]replace nan value:  66%|██████▌   | 365/553 [00:02<00:01, 149.13it/s]replace nan value:  69%|██████▉   | 384/553 [00:02<00:01, 158.72it/s]replace nan value:  73%|███████▎  | 401/553 [00:03<00:01, 130.35it/s]replace nan value:  75%|███████▌  | 416/553 [00:03<00:01, 117.02it/s]replace nan value:  78%|███████▊  | 432/553 [00:03<00:00, 125.41it/s]replace nan value:  81%|████████  | 446/553 [00:03<00:00, 125.84it/s]replace nan value:  83%|████████▎ | 460/553 [00:03<00:00, 118.16it/s]replace nan value:  86%|████████▌ | 473/553 [00:03<00:00, 102.29it/s]replace nan value:  88%|████████▊ | 484/553 [00:03<00:00, 100.31it/s]replace nan value:  90%|████████▉ | 495/553 [00:03<00:00, 96.80it/s] replace nan value:  91%|█████████▏| 505/553 [00:04<00:00, 91.83it/s]replace nan value:  93%|█████████▎| 515/553 [00:04<00:00, 77.33it/s]replace nan value:  95%|█████████▍| 524/553 [00:04<00:00, 76.42it/s]replace nan value:  98%|█████████▊| 541/553 [00:04<00:00, 97.53it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 120.22it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 5/553 [00:00<00:13, 39.30it/s]  2%|▏         | 9/553 [00:00<00:13, 39.64it/s]  3%|▎         | 14/553 [00:00<00:12, 41.83it/s]  3%|▎         | 19/553 [00:00<00:12, 43.48it/s]  5%|▍         | 26/553 [00:00<00:10, 52.23it/s]  6%|▋         | 35/553 [00:00<00:08, 64.29it/s]  8%|▊         | 45/553 [00:00<00:06, 75.17it/s] 10%|█         | 57/553 [00:00<00:05, 86.03it/s] 12%|█▏        | 67/553 [00:00<00:05, 90.17it/s] 14%|█▍        | 77/553 [00:01<00:05, 83.06it/s] 16%|█▋        | 91/553 [00:01<00:04, 96.77it/s] 19%|█▉        | 105/553 [00:01<00:04, 108.40it/s] 21%|██        | 117/553 [00:01<00:03, 109.76it/s] 24%|██▎       | 130/553 [00:01<00:03, 114.05it/s] 27%|██▋       | 148/553 [00:01<00:03, 132.73it/s] 29%|██▉       | 163/553 [00:01<00:02, 137.13it/s] 32%|███▏      | 177/553 [00:01<00:03, 111.39it/s] 34%|███▍      | 189/553 [00:02<00:03, 94.65it/s]  36%|███▌      | 200/553 [00:02<00:03, 95.09it/s] 38%|███▊      | 211/553 [00:02<00:03, 90.06it/s] 40%|███▉      | 221/553 [00:02<00:04, 81.69it/s] 42%|████▏     | 230/553 [00:02<00:04, 79.68it/s] 44%|████▍     | 244/553 [00:02<00:03, 91.63it/s] 47%|████▋     | 258/553 [00:02<00:02, 103.39it/s] 49%|████▊     | 269/553 [00:02<00:02, 104.29it/s] 51%|█████     | 280/553 [00:03<00:03, 88.48it/s]  52%|█████▏    | 290/553 [00:03<00:03, 85.33it/s] 54%|█████▍    | 299/553 [00:03<00:03, 70.56it/s] 56%|█████▌    | 307/553 [00:03<00:04, 59.20it/s] 57%|█████▋    | 314/553 [00:03<00:04, 54.67it/s] 58%|█████▊    | 320/553 [00:03<00:04, 47.50it/s] 59%|█████▉    | 326/553 [00:04<00:04, 49.14it/s] 61%|██████    | 335/553 [00:04<00:03, 55.52it/s] 62%|██████▏   | 345/553 [00:04<00:03, 64.10it/s] 64%|██████▍   | 354/553 [00:04<00:02, 67.99it/s] 65%|██████▌   | 362/553 [00:04<00:02, 69.24it/s] 67%|██████▋   | 372/553 [00:04<00:02, 76.23it/s] 69%|██████▊   | 380/553 [00:04<00:02, 72.84it/s] 70%|███████   | 388/553 [00:04<00:02, 61.03it/s] 72%|███████▏  | 399/553 [00:05<00:02, 70.28it/s] 75%|███████▌  | 415/553 [00:05<00:01, 85.11it/s] 77%|███████▋  | 424/553 [00:05<00:01, 65.54it/s] 78%|███████▊  | 432/553 [00:05<00:02, 56.83it/s] 79%|███████▉  | 439/553 [00:05<00:02, 52.94it/s] 80%|████████  | 445/553 [00:05<00:02, 50.33it/s] 82%|████████▏ | 451/553 [00:06<00:02, 48.36it/s] 83%|████████▎ | 457/553 [00:06<00:02, 47.68it/s] 84%|████████▍ | 464/553 [00:06<00:01, 52.26it/s] 85%|████████▍ | 470/553 [00:06<00:01, 53.20it/s] 87%|████████▋ | 479/553 [00:06<00:01, 61.27it/s] 88%|████████▊ | 488/553 [00:06<00:00, 68.22it/s] 90%|████████▉ | 496/553 [00:06<00:00, 59.91it/s] 91%|█████████▏| 505/553 [00:06<00:00, 66.45it/s] 93%|█████████▎| 515/553 [00:06<00:00, 74.94it/s] 95%|█████████▍| 523/553 [00:07<00:00, 69.45it/s] 96%|█████████▌| 531/553 [00:07<00:00, 70.85it/s] 99%|█████████▉| 547/553 [00:07<00:00, 93.57it/s]100%|██████████| 553/553 [00:07<00:00, 73.89it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   1%|          | 1/139 [00:00<00:25,  5.49it/s]extract the null data:  18%|█▊        | 25/139 [00:00<00:01, 93.09it/s]extract the null data:  29%|██▉       | 41/139 [00:00<00:00, 116.30it/s]extract the null data:  40%|███▉      | 55/139 [00:00<00:00, 124.10it/s]extract the null data:  50%|████▉     | 69/139 [00:00<00:00, 120.29it/s]extract the null data:  67%|██████▋   | 93/139 [00:00<00:00, 155.89it/s]extract the null data:  98%|█████████▊| 136/139 [00:00<00:00, 237.55it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 160.71it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 16/139 [00:00<00:00, 139.06it/s]replace nan value:  22%|██▏       | 30/139 [00:00<00:01, 103.93it/s]replace nan value:  29%|██▉       | 41/139 [00:00<00:01, 88.68it/s] replace nan value:  38%|███▊      | 53/139 [00:00<00:00, 97.74it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 77.17it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 84.42it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 102.97it/s]replace nan value:  79%|███████▉  | 110/139 [00:01<00:00, 126.07it/s]replace nan value:  92%|█████████▏| 128/139 [00:01<00:00, 139.80it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 106.27it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  3%|▎         | 4/139 [00:00<00:04, 28.98it/s]  6%|▋         | 9/139 [00:00<00:04, 31.59it/s] 12%|█▏        | 16/139 [00:00<00:02, 42.20it/s] 19%|█▊        | 26/139 [00:00<00:01, 60.92it/s] 25%|██▌       | 35/139 [00:00<00:01, 68.25it/s] 32%|███▏      | 44/139 [00:00<00:01, 71.59it/s] 37%|███▋      | 52/139 [00:00<00:01, 68.80it/s] 43%|████▎     | 60/139 [00:00<00:01, 67.68it/s] 48%|████▊     | 67/139 [00:01<00:01, 65.15it/s] 53%|█████▎    | 74/139 [00:01<00:01, 64.56it/s] 58%|█████▊    | 81/139 [00:01<00:01, 54.82it/s] 63%|██████▎   | 87/139 [00:01<00:01, 48.86it/s] 67%|██████▋   | 93/139 [00:01<00:00, 46.79it/s] 71%|███████   | 99/139 [00:01<00:00, 45.74it/s] 76%|███████▌  | 105/139 [00:01<00:00, 47.03it/s] 79%|███████▉  | 110/139 [00:02<00:00, 42.27it/s] 83%|████████▎ | 115/139 [00:02<00:00, 43.51it/s] 88%|████████▊ | 123/139 [00:02<00:00, 52.22it/s] 93%|█████████▎| 129/139 [00:02<00:00, 52.95it/s] 98%|█████████▊| 136/139 [00:02<00:00, 56.37it/s]100%|██████████| 139/139 [00:02<00:00, 54.27it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:19,  8.77it/s]extract the null data:  32%|███▏      | 56/173 [00:00<00:00, 309.30it/s]extract the null data:  55%|█████▌    | 96/173 [00:00<00:00, 349.33it/s]extract the null data:  88%|████████▊ | 153/173 [00:00<00:00, 433.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 382.69it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 189.84it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 182.46it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 153.57it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 141.57it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 121.18it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 106.98it/s]replace nan value:  65%|██████▌   | 113/173 [00:01<00:00, 82.87it/s] replace nan value:  71%|███████   | 123/173 [00:01<00:00, 82.04it/s]replace nan value:  76%|███████▋  | 132/173 [00:01<00:00, 81.45it/s]replace nan value:  82%|████████▏ | 142/173 [00:01<00:00, 85.51it/s]replace nan value:  89%|████████▉ | 154/173 [00:01<00:00, 93.85it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 117.80it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 109.48it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 114.98it/s] 15%|█▌        | 26/173 [00:00<00:01, 110.32it/s] 24%|██▍       | 42/173 [00:00<00:01, 130.70it/s] 34%|███▍      | 59/173 [00:00<00:00, 142.86it/s] 43%|████▎     | 74/173 [00:00<00:00, 137.23it/s] 51%|█████▏    | 89/173 [00:00<00:00, 139.60it/s] 60%|██████    | 104/173 [00:00<00:00, 103.81it/s] 69%|██████▉   | 119/173 [00:00<00:00, 114.26it/s] 77%|███████▋  | 133/173 [00:01<00:00, 117.94it/s] 86%|████████▌ | 148/173 [00:01<00:00, 124.00it/s] 94%|█████████▎| 162/173 [00:01<00:00, 118.08it/s]100%|██████████| 173/173 [00:01<00:00, 113.27it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.088, valid loss : 0.082, train acc : 0.540, valid acc : 0.672, train f1 : 0.451, valid f1 : 0.541
training process:   1%|          | 1/128 [02:04<4:24:10, 124.80s/it]Best score increase :0.000 -> 0.541
training process:   2%|▏         | 2/128 [03:51<4:00:02, 114.31s/it]Best score increase :0.541 -> 0.625
training process:   2%|▏         | 3/128 [05:39<3:51:37, 111.18s/it]Best score increase :0.625 -> 0.653
training process:   3%|▎         | 4/128 [07:39<3:57:34, 114.96s/it]Best score increase :0.653 -> 0.682
epoch : 5, train loss : 0.064, valid loss : 0.066, train acc : 0.841, valid acc : 0.848, train f1 : 0.671, valid f1 : 0.681
training process:   4%|▍         | 5/128 [09:54<4:09:55, 121.92s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [11:41<3:57:45, 116.93s/it]Best score increase :0.682 -> 0.709
training process:   5%|▌         | 7/128 [13:35<3:54:09, 116.12s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [15:52<4:05:04, 122.54s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.058, valid loss : 0.064, train acc : 0.872, valid acc : 0.869, train f1 : 0.708, valid f1 : 0.704
training process:   7%|▋         | 9/128 [18:28<4:23:56, 133.08s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [20:36<4:18:28, 131.43s/it]Best score increase :0.709 -> 0.715
training process:   9%|▊         | 11/128 [22:45<4:15:08, 130.84s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [25:01<4:15:47, 132.30s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.054, valid loss : 0.065, train acc : 0.886, valid acc : 0.896, train f1 : 0.728, valid f1 : 0.732
training process:  10%|█         | 13/128 [27:33<4:25:13, 138.38s/it]Best score increase :0.715 -> 0.732
training process:  11%|█         | 14/128 [29:48<4:21:03, 137.40s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [31:57<4:14:04, 134.91s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [34:12<4:11:22, 134.67s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.050, valid loss : 0.058, train acc : 0.897, valid acc : 0.874, train f1 : 0.747, valid f1 : 0.717
training process:  13%|█▎        | 17/128 [36:48<4:21:16, 141.23s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [39:00<4:13:57, 138.53s/it]Best score increase :0.732 -> 0.741
training process:  15%|█▍        | 19/128 [41:16<4:09:56, 137.59s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [43:30<4:06:01, 136.68s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.047, valid loss : 0.058, train acc : 0.909, valid acc : 0.873, train f1 : 0.766, valid f1 : 0.716
training process:  16%|█▋        | 21/128 [45:57<4:09:12, 139.74s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [47:50<3:52:49, 131.78s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [49:51<3:44:42, 128.40s/it]EarlyStopping counter : 5 out of 12
training process:  19%|█▉        | 24/128 [51:50<3:37:52, 125.70s/it]Best score increase :0.741 -> 0.743
epoch : 25, train loss : 0.044, valid loss : 0.056, train acc : 0.917, valid acc : 0.873, train f1 : 0.782, valid f1 : 0.718
training process:  20%|█▉        | 25/128 [53:49<3:31:58, 123.48s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 26/128 [55:27<3:17:07, 115.96s/it]EarlyStopping counter : 2 out of 12
training process:  21%|██        | 27/128 [57:03<3:04:54, 109.85s/it]EarlyStopping counter : 3 out of 12
training process:  22%|██▏       | 28/128 [58:39<2:56:29, 105.90s/it]EarlyStopping counter : 4 out of 12
epoch : 29, train loss : 0.042, valid loss : 0.056, train acc : 0.922, valid acc : 0.893, train f1 : 0.794, valid f1 : 0.742
training process:  23%|██▎       | 29/128 [1:00:36<2:59:58, 109.08s/it]EarlyStopping counter : 5 out of 12
training process:  23%|██▎       | 30/128 [1:02:14<2:52:58, 105.91s/it]Best score increase :0.743 -> 0.748
training process:  24%|██▍       | 31/128 [1:03:48<2:45:12, 102.19s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [1:05:22<2:39:49, 99.89s/it] Best score increase :0.748 -> 0.761
epoch : 33, train loss : 0.039, valid loss : 0.054, train acc : 0.927, valid acc : 0.909, train f1 : 0.806, valid f1 : 0.767
training process:  26%|██▌       | 33/128 [1:07:31<2:51:50, 108.53s/it]Best score increase :0.761 -> 0.767
training process:  27%|██▋       | 34/128 [1:09:03<2:42:06, 103.47s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [1:10:39<2:36:53, 101.22s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [1:12:08<2:29:46, 97.67s/it] EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.037, valid loss : 0.054, train acc : 0.934, valid acc : 0.894, train f1 : 0.819, valid f1 : 0.748
training process:  29%|██▉       | 37/128 [1:13:55<2:32:27, 100.52s/it]EarlyStopping counter : 4 out of 12
training process:  30%|██▉       | 38/128 [1:15:27<2:26:50, 97.90s/it] EarlyStopping counter : 5 out of 12
training process:  30%|███       | 39/128 [1:16:55<2:20:41, 94.85s/it]EarlyStopping counter : 6 out of 12
training process:  31%|███▏      | 40/128 [1:18:24<2:16:36, 93.14s/it]Best score increase :0.767 -> 0.774
epoch : 41, train loss : 0.036, valid loss : 0.060, train acc : 0.937, valid acc : 0.920, train f1 : 0.825, valid f1 : 0.773
training process:  32%|███▏      | 41/128 [1:20:05<2:18:18, 95.38s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [1:21:36<2:15:04, 94.24s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [1:23:07<2:12:06, 93.25s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [1:24:31<2:06:33, 90.40s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.035, valid loss : 0.053, train acc : 0.938, valid acc : 0.904, train f1 : 0.827, valid f1 : 0.767
training process:  35%|███▌      | 45/128 [1:26:14<2:10:21, 94.23s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [1:27:39<2:05:01, 91.49s/it]Best score increase :0.774 -> 0.781
training process:  37%|███▋      | 47/128 [1:29:08<2:02:41, 90.88s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [1:30:12<1:50:10, 82.64s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.032, valid loss : 0.056, train acc : 0.943, valid acc : 0.921, train f1 : 0.839, valid f1 : 0.790
training process:  38%|███▊      | 49/128 [1:31:27<1:45:49, 80.37s/it]Best score increase :0.781 -> 0.790
training process:  39%|███▉      | 50/128 [1:32:30<1:37:36, 75.08s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [1:33:34<1:32:14, 71.88s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [1:34:36<1:27:21, 68.97s/it]Best score increase :0.790 -> 0.799
epoch : 53, train loss : 0.032, valid loss : 0.056, train acc : 0.945, valid acc : 0.903, train f1 : 0.844, valid f1 : 0.766
training process:  41%|████▏     | 53/128 [1:35:51<1:28:27, 70.76s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [1:36:52<1:23:37, 67.81s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [1:37:46<1:17:16, 63.51s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [1:38:37<1:11:54, 59.92s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.030, valid loss : 0.056, train acc : 0.948, valid acc : 0.921, train f1 : 0.851, valid f1 : 0.792
training process:  45%|████▍     | 57/128 [1:39:39<1:11:32, 60.46s/it]EarlyStopping counter : 5 out of 12
training process:  45%|████▌     | 58/128 [1:40:43<1:11:51, 61.60s/it]EarlyStopping counter : 6 out of 12
training process:  46%|████▌     | 59/128 [1:41:45<1:10:58, 61.72s/it]EarlyStopping counter : 7 out of 12
training process:  47%|████▋     | 60/128 [1:42:54<1:12:29, 63.96s/it]EarlyStopping counter : 8 out of 12
epoch : 61, train loss : 0.031, valid loss : 0.059, train acc : 0.947, valid acc : 0.914, train f1 : 0.847, valid f1 : 0.782
training process:  48%|████▊     | 61/128 [1:44:14<1:16:47, 68.77s/it]EarlyStopping counter : 9 out of 12
training process:  48%|████▊     | 62/128 [1:45:21<1:14:54, 68.10s/it]EarlyStopping counter : 10 out of 12
training process:  49%|████▉     | 63/128 [1:46:28<1:13:30, 67.85s/it]Best score increase :0.799 -> 0.806
training process:  50%|█████     | 64/128 [1:47:42<1:14:24, 69.75s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.029, valid loss : 0.069, train acc : 0.951, valid acc : 0.918, train f1 : 0.857, valid f1 : 0.788
training process:  51%|█████     | 65/128 [1:49:24<1:23:16, 79.31s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 66/128 [1:50:50<1:24:11, 81.47s/it]Best score increase :0.806 -> 0.832
training process:  52%|█████▏    | 67/128 [1:52:17<1:24:17, 82.92s/it]EarlyStopping counter : 1 out of 12
training process:  53%|█████▎    | 68/128 [1:53:48<1:25:32, 85.54s/it]EarlyStopping counter : 2 out of 12
epoch : 69, train loss : 0.028, valid loss : 0.064, train acc : 0.954, valid acc : 0.914, train f1 : 0.864, valid f1 : 0.783
training process:  54%|█████▍    | 69/128 [1:55:30<1:28:50, 90.34s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▍    | 70/128 [1:56:58<1:26:47, 89.79s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▌    | 71/128 [1:58:26<1:24:44, 89.21s/it]EarlyStopping counter : 5 out of 12
training process:  56%|█████▋    | 72/128 [1:59:52<1:22:23, 88.28s/it]EarlyStopping counter : 6 out of 12
epoch : 73, train loss : 0.029, valid loss : 0.073, train acc : 0.953, valid acc : 0.919, train f1 : 0.864, valid f1 : 0.788
training process:  57%|█████▋    | 73/128 [2:01:27<1:22:41, 90.21s/it]EarlyStopping counter : 7 out of 12
training process:  58%|█████▊    | 74/128 [2:02:59<1:21:38, 90.71s/it]EarlyStopping counter : 8 out of 12
training process:  59%|█████▊    | 75/128 [2:04:26<1:19:02, 89.49s/it]EarlyStopping counter : 9 out of 12
training process:  59%|█████▉    | 76/128 [2:05:48<1:15:46, 87.44s/it]EarlyStopping counter : 10 out of 12
epoch : 77, train loss : 0.027, valid loss : 0.069, train acc : 0.956, valid acc : 0.912, train f1 : 0.869, valid f1 : 0.780
training process:  60%|██████    | 77/128 [2:07:32<1:18:29, 92.34s/it]EarlyStopping counter : 11 out of 12
training process:  60%|██████    | 77/128 [2:09:00<1:25:26, 100.52s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 77, best f1 score : 0.832
training process finished, best loss : 0.061 and best acc : 0.945, best f1 : 0.832, best epoch : 65

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.68      0.71      0.70       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.83      0.84      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.84, test loss : 4.847

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:08, 11.71s/it]processing for feature importance:  17%|█▋        | 2/12 [00:24<02:03, 12.34s/it]processing for feature importance:  25%|██▌       | 3/12 [00:36<01:50, 12.30s/it]processing for feature importance:  33%|███▎      | 4/12 [00:47<01:34, 11.78s/it]processing for feature importance:  42%|████▏     | 5/12 [00:59<01:22, 11.79s/it]processing for feature importance:  50%|█████     | 6/12 [01:11<01:10, 11.72s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:22<00:57, 11.50s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:35<00:47, 11.96s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:45<00:34, 11.60s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:58<00:23, 11.87s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:11<00:12, 12.12s/it]processing for feature importance: 100%|██████████| 12/12 [02:21<00:00, 11.70s/it]processing for feature importance: 100%|██████████| 12/12 [02:21<00:00, 11.82s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 26/306 [00:00<00:01, 256.98it/s] 19%|█▉        | 58/306 [00:00<00:00, 289.84it/s] 28%|██▊       | 87/306 [00:00<00:00, 243.13it/s] 39%|███▊      | 118/306 [00:00<00:00, 266.00it/s] 49%|████▊     | 149/306 [00:00<00:00, 279.24it/s] 59%|█████▉    | 180/306 [00:00<00:00, 288.42it/s] 69%|██████▊   | 210/306 [00:00<00:00, 275.25it/s] 78%|███████▊  | 238/306 [00:00<00:00, 267.35it/s] 87%|████████▋ | 267/306 [00:00<00:00, 272.87it/s] 97%|█████████▋| 297/306 [00:01<00:00, 279.59it/s]100%|██████████| 306/306 [00:01<00:00, 274.38it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:01, 436.60it/s]extract the null data:  16%|█▌        | 88/553 [00:00<00:01, 424.50it/s]extract the null data:  24%|██▎       | 131/553 [00:00<00:01, 414.93it/s]extract the null data:  31%|███▏      | 173/553 [00:00<00:00, 413.49it/s]extract the null data:  39%|███▉      | 215/553 [00:00<00:00, 409.88it/s]extract the null data:  46%|████▋     | 256/553 [00:00<00:00, 405.89it/s]extract the null data:  54%|█████▎    | 297/553 [00:00<00:00, 403.98it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 401.78it/s]extract the null data:  69%|██████▊   | 379/553 [00:00<00:00, 388.37it/s]extract the null data:  76%|███████▌  | 419/553 [00:01<00:00, 391.05it/s]extract the null data:  83%|████████▎ | 459/553 [00:01<00:00, 385.42it/s]extract the null data:  90%|█████████ | 500/553 [00:01<00:00, 391.23it/s]extract the null data:  98%|█████████▊| 540/553 [00:01<00:00, 392.45it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 399.05it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 145.23it/s]replace nan value:   5%|▌         | 30/553 [00:00<00:03, 145.05it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:03, 147.86it/s]replace nan value:  11%|█         | 61/553 [00:00<00:03, 148.07it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:03, 142.99it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:03, 145.54it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 149.04it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:03, 120.38it/s]replace nan value:  25%|██▌       | 139/553 [00:01<00:03, 127.25it/s]replace nan value:  28%|██▊       | 155/553 [00:01<00:02, 134.73it/s]replace nan value:  31%|███       | 171/553 [00:01<00:02, 140.63it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 144.98it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:02, 147.80it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:02, 148.11it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:02, 146.55it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:02, 144.17it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 145.77it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 148.20it/s]replace nan value:  54%|█████▎    | 296/553 [00:02<00:01, 149.63it/s]replace nan value:  56%|█████▋    | 312/553 [00:02<00:01, 150.63it/s]replace nan value:  59%|█████▉    | 328/553 [00:02<00:01, 149.23it/s]replace nan value:  62%|██████▏   | 343/553 [00:02<00:01, 148.86it/s]replace nan value:  65%|██████▍   | 359/553 [00:02<00:01, 149.32it/s]replace nan value:  68%|██████▊   | 375/553 [00:02<00:01, 149.44it/s]replace nan value:  71%|███████   | 390/553 [00:02<00:01, 148.44it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 151.07it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 150.98it/s]replace nan value:  79%|███████▉  | 438/553 [00:03<00:00, 148.75it/s]replace nan value:  82%|████████▏ | 453/553 [00:03<00:00, 149.02it/s]replace nan value:  85%|████████▍ | 468/553 [00:03<00:00, 145.41it/s]replace nan value:  87%|████████▋ | 483/553 [00:03<00:00, 122.36it/s]replace nan value:  90%|████████▉ | 496/553 [00:03<00:00, 123.71it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 129.21it/s]replace nan value:  95%|█████████▍| 525/553 [00:03<00:00, 127.32it/s]replace nan value:  97%|█████████▋| 538/553 [00:03<00:00, 114.34it/s]replace nan value:  99%|█████████▉| 550/553 [00:04<00:00, 103.32it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 136.80it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 117.77it/s]  5%|▍         | 25/553 [00:00<00:04, 123.41it/s]  7%|▋         | 39/553 [00:00<00:04, 127.47it/s]  9%|▉         | 52/553 [00:00<00:04, 114.40it/s] 12%|█▏        | 64/553 [00:00<00:04, 100.30it/s] 14%|█▍        | 77/553 [00:00<00:04, 106.78it/s] 16%|█▋        | 91/553 [00:00<00:04, 111.63it/s] 19%|█▊        | 103/553 [00:00<00:03, 112.56it/s] 21%|██▏       | 118/553 [00:01<00:03, 122.59it/s] 24%|██▎       | 131/553 [00:01<00:03, 120.46it/s] 26%|██▋       | 146/553 [00:01<00:03, 128.81it/s] 29%|██▉       | 161/553 [00:01<00:02, 134.03it/s] 32%|███▏      | 175/553 [00:01<00:02, 134.74it/s] 34%|███▍      | 189/553 [00:01<00:02, 134.65it/s] 37%|███▋      | 205/553 [00:01<00:02, 141.56it/s] 40%|███▉      | 220/553 [00:01<00:02, 118.10it/s] 42%|████▏     | 234/553 [00:01<00:02, 122.44it/s] 45%|████▍     | 248/553 [00:02<00:02, 126.35it/s] 47%|████▋     | 262/553 [00:02<00:02, 108.64it/s] 50%|████▉     | 274/553 [00:02<00:02, 105.46it/s] 52%|█████▏    | 286/553 [00:02<00:02, 109.08it/s] 54%|█████▍    | 298/553 [00:02<00:02, 108.28it/s] 56%|█████▌    | 310/553 [00:02<00:02, 109.24it/s] 58%|█████▊    | 322/553 [00:02<00:02, 110.56it/s] 60%|██████    | 334/553 [00:02<00:01, 111.97it/s] 63%|██████▎   | 346/553 [00:02<00:01, 114.02it/s] 65%|██████▍   | 358/553 [00:03<00:01, 110.77it/s] 67%|██████▋   | 372/553 [00:03<00:01, 117.70it/s] 69%|██████▉   | 384/553 [00:03<00:01, 115.70it/s] 72%|███████▏  | 396/553 [00:03<00:01, 105.22it/s] 74%|███████▍  | 408/553 [00:03<00:01, 108.20it/s] 76%|███████▌  | 419/553 [00:03<00:01, 99.38it/s]  78%|███████▊  | 430/553 [00:03<00:01, 99.02it/s] 81%|████████  | 446/553 [00:03<00:00, 114.14it/s] 83%|████████▎ | 458/553 [00:03<00:00, 111.99it/s] 85%|████████▌ | 471/553 [00:04<00:00, 115.94it/s] 87%|████████▋ | 483/553 [00:04<00:00, 115.54it/s] 90%|████████▉ | 495/553 [00:04<00:00, 107.45it/s] 92%|█████████▏| 506/553 [00:04<00:00, 90.25it/s]  93%|█████████▎| 517/553 [00:04<00:00, 90.85it/s] 95%|█████████▌| 527/553 [00:04<00:00, 70.16it/s] 97%|█████████▋| 537/553 [00:04<00:00, 75.69it/s] 99%|█████████▉| 549/553 [00:05<00:00, 84.53it/s]100%|██████████| 553/553 [00:05<00:00, 105.73it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   1%|          | 1/139 [00:00<00:14,  9.25it/s]extract the null data:  14%|█▍        | 20/139 [00:00<00:01, 103.65it/s]extract the null data:  40%|████      | 56/139 [00:00<00:00, 212.08it/s]extract the null data:  73%|███████▎  | 101/139 [00:00<00:00, 301.97it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 274.40it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 17/139 [00:00<00:00, 167.25it/s]replace nan value:  24%|██▍       | 34/139 [00:00<00:00, 107.29it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 94.94it/s] replace nan value:  41%|████      | 57/139 [00:00<00:00, 87.60it/s]replace nan value:  48%|████▊     | 67/139 [00:00<00:00, 87.18it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 86.47it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 86.53it/s]replace nan value:  68%|██████▊   | 94/139 [00:01<00:00, 82.99it/s]replace nan value:  74%|███████▍  | 103/139 [00:01<00:00, 83.71it/s]replace nan value:  81%|████████  | 112/139 [00:01<00:00, 83.16it/s]replace nan value:  87%|████████▋ | 121/139 [00:01<00:00, 84.90it/s]replace nan value:  99%|█████████▉| 138/139 [00:01<00:00, 107.44it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 94.52it/s] 
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 99.77it/s] 16%|█▌        | 22/139 [00:00<00:01, 104.88it/s] 26%|██▌       | 36/139 [00:00<00:00, 116.44it/s] 35%|███▍      | 48/139 [00:00<00:00, 116.73it/s] 43%|████▎     | 60/139 [00:00<00:00, 109.59it/s] 53%|█████▎    | 73/139 [00:00<00:00, 113.82it/s] 61%|██████    | 85/139 [00:00<00:00, 106.11it/s] 69%|██████▉   | 96/139 [00:00<00:00, 100.73it/s] 77%|███████▋  | 107/139 [00:01<00:00, 100.20it/s] 88%|████████▊ | 122/139 [00:01<00:00, 113.91it/s] 96%|█████████▋| 134/139 [00:01<00:00, 112.95it/s]100%|██████████| 139/139 [00:01<00:00, 110.98it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:18,  9.32it/s]extract the null data:  27%|██▋       | 46/173 [00:00<00:00, 259.12it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 347.88it/s]extract the null data:  80%|████████  | 139/173 [00:00<00:00, 393.30it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 326.40it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|▉         | 17/173 [00:00<00:00, 162.29it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 157.28it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 136.29it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 140.59it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 149.03it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 128.95it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 138.21it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 146.40it/s]replace nan value:  86%|████████▌ | 149/173 [00:01<00:00, 151.37it/s]replace nan value:  95%|█████████▌| 165/173 [00:01<00:00, 146.75it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 144.30it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 134.08it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.10it/s] 23%|██▎       | 40/173 [00:00<00:01, 108.03it/s] 31%|███       | 53/173 [00:00<00:01, 112.46it/s] 38%|███▊      | 65/173 [00:00<00:00, 108.89it/s] 45%|████▍     | 77/173 [00:00<00:00, 110.24it/s] 52%|█████▏    | 90/173 [00:00<00:00, 114.15it/s] 59%|█████▉    | 102/173 [00:00<00:00, 115.25it/s] 68%|██████▊   | 117/173 [00:01<00:00, 123.19it/s] 75%|███████▌  | 130/173 [00:01<00:00, 111.05it/s] 83%|████████▎ | 143/173 [00:01<00:00, 114.56it/s] 90%|████████▉ | 155/173 [00:01<00:00, 108.92it/s] 97%|█████████▋| 167/173 [00:01<00:00, 87.18it/s] 100%|██████████| 173/173 [00:01<00:00, 103.63it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.184, valid loss : 0.098, train acc : 0.643, valid acc : 0.371, train f1 : 0.613, valid f1 : 0.342
training process:   1%|          | 1/128 [01:43<3:38:48, 103.37s/it]Best score increase :0.000 -> 0.342
training process:   2%|▏         | 2/128 [03:07<3:13:20, 92.06s/it] EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [04:39<3:12:03, 92.19s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [06:09<3:08:42, 91.31s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.091, valid loss : 0.109, train acc : 0.648, valid acc : 0.348, train f1 : 0.599, valid f1 : 0.326
training process:   4%|▍         | 5/128 [07:47<3:11:38, 93.49s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [09:15<3:06:18, 91.62s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [10:37<2:58:37, 88.57s/it]Best score increase :0.342 -> 0.356
training process:   6%|▋         | 8/128 [11:56<2:51:21, 85.68s/it]Best score increase :0.356 -> 0.391
epoch : 9, train loss : 0.080, valid loss : 0.097, train acc : 0.688, valid acc : 0.437, train f1 : 0.657, valid f1 : 0.392
training process:   7%|▋         | 9/128 [13:39<3:00:07, 90.82s/it]Best score increase :0.391 -> 0.392
training process:   8%|▊         | 10/128 [14:49<2:46:24, 84.61s/it]Best score increase :0.392 -> 0.417
training process:   9%|▊         | 11/128 [15:55<2:33:54, 78.93s/it]Best score increase :0.417 -> 0.433
training process:   9%|▉         | 12/128 [17:00<2:24:19, 74.65s/it]Best score increase :0.433 -> 0.480
epoch : 13, train loss : 0.068, valid loss : 0.092, train acc : 0.750, valid acc : 0.510, train f1 : 0.733, valid f1 : 0.444
training process:  10%|█         | 13/128 [18:21<2:26:38, 76.51s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [19:31<2:21:26, 74.44s/it]Best score increase :0.480 -> 0.493
training process:  12%|█▏        | 15/128 [20:40<2:17:05, 72.79s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [21:49<2:13:48, 71.68s/it]Best score increase :0.493 -> 0.527
epoch : 17, train loss : 0.057, valid loss : 0.081, train acc : 0.800, valid acc : 0.627, train f1 : 0.792, valid f1 : 0.525
training process:  13%|█▎        | 17/128 [23:36<2:32:15, 82.30s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [24:44<2:22:59, 78.00s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [25:48<2:14:25, 74.00s/it]Best score increase :0.527 -> 0.544
training process:  16%|█▌        | 20/128 [26:58<2:10:59, 72.77s/it]Best score increase :0.544 -> 0.565
epoch : 21, train loss : 0.053, valid loss : 0.078, train acc : 0.828, valid acc : 0.653, train f1 : 0.823, valid f1 : 0.542
training process:  16%|█▋        | 21/128 [28:15<2:11:45, 73.89s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [29:17<2:04:14, 70.33s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [30:27<2:02:45, 70.15s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [31:35<2:00:33, 69.55s/it]Best score increase :0.565 -> 0.570
epoch : 25, train loss : 0.047, valid loss : 0.072, train acc : 0.851, valid acc : 0.703, train f1 : 0.848, valid f1 : 0.579
training process:  20%|█▉        | 25/128 [32:50<2:02:22, 71.28s/it]Best score increase :0.570 -> 0.579
training process:  20%|██        | 26/128 [33:57<1:59:04, 70.04s/it]Best score increase :0.579 -> 0.594
training process:  21%|██        | 27/128 [35:07<1:57:48, 69.99s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [36:17<1:56:39, 69.99s/it]Best score increase :0.594 -> 0.609
epoch : 29, train loss : 0.045, valid loss : 0.069, train acc : 0.865, valid acc : 0.724, train f1 : 0.863, valid f1 : 0.596
training process:  23%|██▎       | 29/128 [37:34<1:59:06, 72.19s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [38:43<1:56:22, 71.25s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [39:54<1:54:45, 70.99s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [40:59<1:50:36, 69.13s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.043, valid loss : 0.068, train acc : 0.870, valid acc : 0.755, train f1 : 0.868, valid f1 : 0.619
training process:  26%|██▌       | 33/128 [42:18<1:54:24, 72.26s/it]Best score increase :0.609 -> 0.619
training process:  27%|██▋       | 34/128 [43:29<1:52:45, 71.98s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [44:34<1:48:20, 69.90s/it]Best score increase :0.619 -> 0.645
training process:  28%|██▊       | 36/128 [45:42<1:45:57, 69.10s/it]Best score increase :0.645 -> 0.651
epoch : 37, train loss : 0.039, valid loss : 0.077, train acc : 0.883, valid acc : 0.726, train f1 : 0.881, valid f1 : 0.596
training process:  29%|██▉       | 37/128 [46:58<1:48:16, 71.39s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [47:58<1:41:53, 67.92s/it]Best score increase :0.651 -> 0.653
training process:  30%|███       | 39/128 [48:55<1:35:50, 64.61s/it]Best score increase :0.653 -> 0.668
training process:  31%|███▏      | 40/128 [49:59<1:34:18, 64.30s/it]Best score increase :0.668 -> 0.679
epoch : 41, train loss : 0.039, valid loss : 0.063, train acc : 0.889, valid acc : 0.804, train f1 : 0.888, valid f1 : 0.661
training process:  32%|███▏      | 41/128 [51:11<1:36:52, 66.81s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [52:17<1:35:13, 66.43s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [53:22<1:33:29, 65.99s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [54:27<1:32:04, 65.77s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.038, valid loss : 0.070, train acc : 0.892, valid acc : 0.774, train f1 : 0.891, valid f1 : 0.634
training process:  35%|███▌      | 45/128 [55:45<1:35:52, 69.30s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [56:49<1:32:45, 67.87s/it]EarlyStopping counter : 6 out of 12
training process:  37%|███▋      | 47/128 [57:55<1:30:54, 67.34s/it]EarlyStopping counter : 7 out of 12
training process:  38%|███▊      | 48/128 [59:08<1:31:48, 68.85s/it]EarlyStopping counter : 8 out of 12
epoch : 49, train loss : 0.036, valid loss : 0.073, train acc : 0.897, valid acc : 0.771, train f1 : 0.896, valid f1 : 0.632
training process:  38%|███▊      | 49/128 [1:00:52<1:44:40, 79.50s/it]EarlyStopping counter : 9 out of 12
training process:  39%|███▉      | 50/128 [1:01:53<1:36:00, 73.86s/it]EarlyStopping counter : 10 out of 12
training process:  40%|███▉      | 51/128 [1:03:03<1:33:17, 72.70s/it]EarlyStopping counter : 11 out of 12
training process:  40%|███▉      | 51/128 [1:04:14<1:36:59, 75.57s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 51, best f1 score : 0.679
training process finished, best loss : 0.064 and best acc : 0.823, best f1 : 0.679, best epoch : 39

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.35      0.88      0.50       580
           1       0.99      0.86      0.92      6818

    accuracy                           0.86      7398
   macro avg       0.67      0.87      0.71      7398
weighted avg       0.94      0.86      0.89      7398


# test acc : 0.86, test f1 : 0.71, test AUC : 0.87, test loss : 3.123

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:56, 10.58s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:34,  9.45s/it]processing for feature importance:  25%|██▌       | 3/12 [00:29<01:27,  9.72s/it]processing for feature importance:  33%|███▎      | 4/12 [00:39<01:19,  9.90s/it]processing for feature importance:  42%|████▏     | 5/12 [00:50<01:11, 10.24s/it]processing for feature importance:  50%|█████     | 6/12 [01:00<01:02, 10.34s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:08<00:47,  9.56s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:20<00:40, 10.20s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:30<00:30, 10.17s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:41<00:21, 10.51s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:51<00:10, 10.14s/it]processing for feature importance: 100%|██████████| 12/12 [02:01<00:00, 10.09s/it]processing for feature importance: 100%|██████████| 12/12 [02:01<00:00, 10.08s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 14%|█▎        | 42/306 [00:00<00:00, 417.08it/s] 28%|██▊       | 86/306 [00:00<00:00, 426.93it/s] 42%|████▏     | 129/306 [00:00<00:00, 328.47it/s] 56%|█████▌    | 172/306 [00:00<00:00, 360.53it/s] 70%|███████   | 215/306 [00:00<00:00, 382.35it/s] 83%|████████▎ | 255/306 [00:00<00:00, 339.35it/s] 95%|█████████▌| 291/306 [00:00<00:00, 293.40it/s]100%|██████████| 306/306 [00:00<00:00, 334.60it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 38/553 [00:00<00:01, 371.98it/s]extract the null data:  16%|█▌        | 86/553 [00:00<00:01, 430.55it/s]extract the null data:  24%|██▍       | 134/553 [00:00<00:00, 450.01it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 464.22it/s]extract the null data:  42%|████▏     | 232/553 [00:00<00:00, 472.96it/s]extract the null data:  51%|█████     | 280/553 [00:00<00:00, 474.93it/s]extract the null data:  59%|█████▉    | 328/553 [00:00<00:00, 473.98it/s]extract the null data:  68%|██████▊   | 376/553 [00:00<00:00, 455.21it/s]extract the null data:  76%|███████▋  | 422/553 [00:00<00:00, 378.87it/s]extract the null data:  84%|████████▍ | 466/553 [00:01<00:00, 394.93it/s]extract the null data:  93%|█████████▎| 514/553 [00:01<00:00, 417.76it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 432.23it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 155.73it/s]replace nan value:   6%|▌         | 32/553 [00:00<00:03, 145.63it/s]replace nan value:   9%|▉         | 49/553 [00:00<00:03, 154.17it/s]replace nan value:  12%|█▏        | 65/553 [00:00<00:03, 151.81it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:03, 147.78it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 156.26it/s]replace nan value:  21%|██        | 117/553 [00:00<00:02, 161.55it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 162.85it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 152.61it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 159.52it/s]replace nan value:  34%|███▍      | 188/553 [00:01<00:02, 163.91it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:02, 167.65it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 167.68it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 169.54it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 170.94it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 171.72it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 172.12it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 171.52it/s]replace nan value:  60%|█████▉    | 331/553 [00:02<00:01, 170.74it/s]replace nan value:  63%|██████▎   | 349/553 [00:02<00:01, 170.71it/s]replace nan value:  66%|██████▋   | 367/553 [00:02<00:01, 166.01it/s]replace nan value:  69%|██████▉   | 384/553 [00:02<00:01, 160.84it/s]replace nan value:  73%|███████▎  | 401/553 [00:02<00:00, 162.53it/s]replace nan value:  76%|███████▌  | 418/553 [00:02<00:00, 163.07it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 164.34it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 166.73it/s]replace nan value:  85%|████████▌ | 471/553 [00:02<00:00, 168.91it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 170.02it/s]replace nan value:  92%|█████████▏| 507/553 [00:03<00:00, 170.20it/s]replace nan value:  95%|█████████▍| 525/553 [00:03<00:00, 170.47it/s]replace nan value:  98%|█████████▊| 543/553 [00:03<00:00, 160.35it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 163.86it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.69it/s]  5%|▍         | 26/553 [00:00<00:04, 127.13it/s]  7%|▋         | 40/553 [00:00<00:03, 130.33it/s] 10%|▉         | 54/553 [00:00<00:06, 80.28it/s]  12%|█▏        | 64/553 [00:00<00:05, 83.43it/s] 14%|█▍        | 77/553 [00:00<00:05, 93.12it/s] 16%|█▌        | 89/553 [00:00<00:04, 97.75it/s] 18%|█▊        | 100/553 [00:01<00:04, 97.56it/s] 21%|██        | 116/553 [00:01<00:03, 113.53it/s] 23%|██▎       | 128/553 [00:01<00:03, 113.88it/s] 26%|██▌       | 145/553 [00:01<00:03, 128.64it/s] 29%|██▉       | 161/553 [00:01<00:02, 137.35it/s] 32%|███▏      | 176/553 [00:01<00:02, 136.45it/s] 35%|███▍      | 191/553 [00:01<00:02, 133.17it/s] 38%|███▊      | 208/553 [00:01<00:02, 142.36it/s] 40%|████      | 223/553 [00:01<00:02, 136.13it/s] 43%|████▎     | 239/553 [00:01<00:02, 140.77it/s] 46%|████▌     | 254/553 [00:02<00:02, 121.84it/s] 49%|████▊     | 269/553 [00:02<00:02, 125.87it/s] 51%|█████     | 282/553 [00:02<00:02, 125.73it/s] 53%|█████▎    | 295/553 [00:02<00:02, 122.95it/s] 56%|█████▌    | 308/553 [00:02<00:02, 104.90it/s] 58%|█████▊    | 320/553 [00:02<00:02, 107.13it/s] 60%|██████    | 334/553 [00:02<00:01, 113.83it/s] 63%|██████▎   | 346/553 [00:02<00:01, 110.64it/s] 65%|██████▍   | 358/553 [00:03<00:01, 111.66it/s] 67%|██████▋   | 373/553 [00:03<00:01, 120.92it/s] 70%|██████▉   | 386/553 [00:03<00:01, 115.87it/s] 72%|███████▏  | 398/553 [00:03<00:01, 109.33it/s] 75%|███████▍  | 414/553 [00:03<00:01, 117.94it/s] 77%|███████▋  | 426/553 [00:03<00:01, 109.35it/s] 80%|███████▉  | 440/553 [00:03<00:00, 116.42it/s] 83%|████████▎ | 457/553 [00:03<00:00, 127.29it/s] 85%|████████▌ | 471/553 [00:03<00:00, 130.37it/s] 88%|████████▊ | 485/553 [00:04<00:00, 127.16it/s] 90%|█████████ | 498/553 [00:04<00:00, 104.08it/s] 92%|█████████▏| 510/553 [00:04<00:00, 101.43it/s] 94%|█████████▍| 521/553 [00:04<00:00, 85.62it/s]  96%|█████████▌| 531/553 [00:04<00:00, 83.99it/s] 99%|█████████▉| 548/553 [00:04<00:00, 103.04it/s]100%|██████████| 553/553 [00:04<00:00, 111.84it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 299.06it/s]extract the null data:  71%|███████   | 98/139 [00:00<00:00, 519.73it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 529.49it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 208.66it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 219.81it/s]replace nan value:  48%|████▊     | 67/139 [00:00<00:00, 222.09it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 223.09it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 223.15it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 222.43it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 221.60it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.58it/s] 17%|█▋        | 24/139 [00:00<00:00, 115.17it/s] 29%|██▉       | 40/139 [00:00<00:00, 131.96it/s] 39%|███▉      | 54/139 [00:00<00:00, 128.73it/s] 50%|████▉     | 69/139 [00:00<00:00, 136.02it/s] 60%|█████▉    | 83/139 [00:00<00:00, 134.23it/s] 70%|██████▉   | 97/139 [00:00<00:00, 131.12it/s] 80%|███████▉  | 111/139 [00:00<00:00, 131.50it/s] 92%|█████████▏| 128/139 [00:00<00:00, 140.38it/s]100%|██████████| 139/139 [00:01<00:00, 135.31it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 277.90it/s]extract the null data:  55%|█████▍    | 95/173 [00:00<00:00, 505.37it/s]extract the null data:  92%|█████████▏| 160/173 [00:00<00:00, 570.86it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 535.56it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 219.18it/s]replace nan value:  26%|██▌       | 45/173 [00:00<00:00, 220.14it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 219.72it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 219.99it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 219.79it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 215.81it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 215.31it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 215.71it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 136.81it/s] 16%|█▌        | 28/173 [00:00<00:01, 120.12it/s] 25%|██▍       | 43/173 [00:00<00:00, 131.15it/s] 34%|███▍      | 59/173 [00:00<00:00, 139.12it/s] 43%|████▎     | 74/173 [00:00<00:00, 139.08it/s] 51%|█████     | 88/173 [00:00<00:00, 136.98it/s] 59%|█████▉    | 102/173 [00:00<00:00, 137.21it/s] 68%|██████▊   | 117/173 [00:00<00:00, 138.17it/s] 76%|███████▌  | 131/173 [00:00<00:00, 126.83it/s] 83%|████████▎ | 144/173 [00:01<00:00, 126.21it/s] 91%|█████████ | 157/173 [00:01<00:00, 107.15it/s] 98%|█████████▊| 169/173 [00:01<00:00, 95.60it/s] 100%|██████████| 173/173 [00:01<00:00, 115.95it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.574, valid loss : 0.408, train f1 : 0.532, valid f1 : 0.582
training process - Deferred Re-weighting:   1%|          | 1/128 [01:04<2:17:23, 64.91s/it]Best score increase :0.000 -> 0.582
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:01<2:05:33, 59.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:55<1:59:24, 57.32s/it]Best score increase :0.582 -> 0.621
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:02<2:06:35, 61.25s/it]Best score increase :0.621 -> 0.653
epoch : 5, train loss : 0.201, valid loss : 0.202, train f1 : 0.683, valid f1 : 0.668
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:11<2:11:26, 64.12s/it]Best score increase :0.653 -> 0.668
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:07<2:04:35, 61.28s/it]Best score increase :0.668 -> 0.702
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:02<1:59:09, 59.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:57<1:55:42, 57.85s/it]Best score increase :0.702 -> 0.719
epoch : 9, train loss : 0.171, valid loss : 0.180, train f1 : 0.733, valid f1 : 0.721
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:02<1:59:19, 60.16s/it]Best score increase :0.719 -> 0.721
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:06<2:00:45, 61.40s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:04<1:57:39, 60.34s/it]Best score increase :0.721 -> 0.735
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:02<1:55:06, 59.54s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.156, valid loss : 0.177, train f1 : 0.760, valid f1 : 0.715
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:06<1:56:47, 60.94s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:04<1:53:55, 59.96s/it]Best score increase :0.735 -> 0.742
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:01<1:51:00, 58.94s/it]Best score increase :0.742 -> 0.751
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:58<1:49:27, 58.64s/it]Best score increase :0.751 -> 0.755
epoch : 17, train loss : 0.143, valid loss : 0.158, train f1 : 0.781, valid f1 : 0.769
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:06<1:53:41, 61.45s/it]Best score increase :0.755 -> 0.769
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:05<1:51:19, 60.72s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:06<1:50:04, 60.59s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:05<1:48:25, 60.23s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.130, valid loss : 0.154, train f1 : 0.812, valid f1 : 0.790
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [21:16<1:53:04, 63.41s/it]Best score increase :0.769 -> 0.790
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [22:14<1:49:22, 61.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [23:19<1:49:33, 62.60s/it]Best score increase :0.790 -> 0.796
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [24:19<1:47:33, 62.06s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.119, valid loss : 0.145, train f1 : 0.828, valid f1 : 0.806
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [25:28<1:49:59, 64.07s/it]Best score increase :0.796 -> 0.806
training process - Deferred Re-weighting:  20%|██        | 26/128 [26:25<1:45:28, 62.04s/it]Best score increase :0.806 -> 0.809
training process - Deferred Re-weighting:  21%|██        | 27/128 [27:26<1:43:28, 61.47s/it]Best score increase :0.809 -> 0.813
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [28:22<1:39:52, 59.93s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.110, valid loss : 0.141, train f1 : 0.845, valid f1 : 0.809
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [29:35<1:45:10, 63.74s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [30:41<1:45:31, 64.60s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [31:59<1:50:36, 68.42s/it]Best score increase :0.813 -> 0.821
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [33:12<1:51:45, 69.85s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.102, valid loss : 0.139, train f1 : 0.856, valid f1 : 0.812
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [34:45<2:01:44, 76.89s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [36:01<1:59:50, 76.50s/it]Best score increase :0.821 -> 0.828
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [37:14<1:57:00, 75.48s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [38:29<1:55:36, 75.40s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.097, valid loss : 0.140, train f1 : 0.868, valid f1 : 0.825
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [39:54<1:58:49, 78.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [41:09<1:55:54, 77.27s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [42:23<1:53:25, 76.47s/it]Best score increase :0.828 -> 0.843
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [43:42<1:53:08, 77.15s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.093, valid loss : 0.143, train f1 : 0.873, valid f1 : 0.808
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [45:10<1:56:41, 80.48s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [46:22<1:51:26, 77.75s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [47:36<1:48:37, 76.68s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [48:54<1:47:56, 77.10s/it]Best score increase :0.843 -> 0.853
epoch : 45, train loss : 0.092, valid loss : 0.130, train f1 : 0.875, valid f1 : 0.842
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [50:21<1:50:38, 79.98s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [51:33<1:46:01, 77.58s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [52:47<1:43:17, 76.51s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [54:01<1:41:14, 75.93s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.085, valid loss : 0.133, train f1 : 0.884, valid f1 : 0.851
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [55:29<1:44:35, 79.43s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [56:38<1:39:11, 76.30s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [57:41<1:32:58, 72.45s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [58:44<1:27:48, 69.33s/it]EarlyStopping counter : 8 out of 12
epoch : 53, train loss : 0.080, valid loss : 0.160, train f1 : 0.892, valid f1 : 0.842
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [1:00:06<1:31:36, 73.28s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [1:01:08<1:26:18, 69.98s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:01:59<1:17:55, 64.05s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:02:48<1:23:21, 68.52s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 55, best f1 score : 0.853
training process finished, best loss : 0.135, best acc : 0.958, best f1 : 0.853, best epoch : 43

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.84      0.62      0.71       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.90      0.80      0.85      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.85, test AUC : 0.80, test loss : 10.317

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.62s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.75s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.89s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:05,  8.16s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:56,  8.12s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.07s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:40,  8.17s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:31,  7.96s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:24,  8.05s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:20<00:16,  8.01s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:28<00:08,  8.21s/it]processing for feature importance: 100%|██████████| 12/12 [01:37<00:00,  8.38s/it]processing for feature importance: 100%|██████████| 12/12 [01:37<00:00,  8.13s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 135.54it/s]  9%|▉         | 28/306 [00:00<00:02, 100.38it/s] 16%|█▌        | 48/306 [00:00<00:01, 136.71it/s] 23%|██▎       | 71/306 [00:00<00:01, 168.15it/s] 32%|███▏      | 97/306 [00:00<00:01, 198.06it/s] 40%|████      | 123/306 [00:00<00:00, 217.63it/s] 49%|████▉     | 150/306 [00:00<00:00, 233.48it/s] 57%|█████▋    | 174/306 [00:00<00:00, 221.51it/s] 64%|██████▍   | 197/306 [00:01<00:00, 167.55it/s] 73%|███████▎  | 224/306 [00:01<00:00, 190.60it/s] 82%|████████▏ | 250/306 [00:01<00:00, 207.79it/s] 91%|█████████ | 277/306 [00:01<00:00, 222.23it/s]100%|██████████| 306/306 [00:01<00:00, 239.84it/s]100%|██████████| 306/306 [00:01<00:00, 201.56it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 42/553 [00:00<00:01, 419.68it/s]extract the null data:  15%|█▌        | 84/553 [00:00<00:01, 406.01it/s]extract the null data:  23%|██▎       | 127/553 [00:00<00:01, 413.83it/s]extract the null data:  31%|███       | 170/553 [00:00<00:00, 420.04it/s]extract the null data:  39%|███▊      | 213/553 [00:00<00:00, 419.40it/s]extract the null data:  46%|████▌     | 255/553 [00:00<00:00, 379.77it/s]extract the null data:  54%|█████▍    | 298/553 [00:00<00:00, 393.94it/s]extract the null data:  62%|██████▏   | 342/553 [00:00<00:00, 406.21it/s]extract the null data:  69%|██████▉   | 384/553 [00:00<00:00, 404.17it/s]extract the null data:  77%|███████▋  | 427/553 [00:01<00:00, 411.63it/s]extract the null data:  86%|████████▌ | 473/553 [00:01<00:00, 424.60it/s]extract the null data:  94%|█████████▎| 518/553 [00:01<00:00, 431.85it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 414.69it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 157.48it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 162.03it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 160.14it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:02, 162.43it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 163.94it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 163.79it/s]replace nan value:  21%|██▏       | 118/553 [00:00<00:02, 164.83it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 163.96it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 164.31it/s]replace nan value:  31%|███       | 169/553 [00:01<00:02, 163.55it/s]replace nan value:  34%|███▎      | 186/553 [00:01<00:02, 163.47it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:02, 165.20it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:02, 164.54it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 161.38it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 152.72it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 155.84it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 156.95it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 157.43it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 159.24it/s]replace nan value:  61%|██████    | 336/553 [00:02<00:01, 153.01it/s]replace nan value:  64%|██████▎   | 352/553 [00:02<00:01, 148.51it/s]replace nan value:  66%|██████▋   | 367/553 [00:02<00:01, 138.87it/s]replace nan value:  69%|██████▉   | 382/553 [00:02<00:01, 141.21it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:01, 150.29it/s]replace nan value:  75%|███████▌  | 416/553 [00:02<00:00, 144.91it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 154.59it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 158.83it/s]replace nan value:  85%|████████▍ | 470/553 [00:02<00:00, 165.63it/s]replace nan value:  88%|████████▊ | 488/553 [00:03<00:00, 167.14it/s]replace nan value:  91%|█████████▏| 505/553 [00:03<00:00, 167.47it/s]replace nan value:  95%|█████████▍| 523/553 [00:03<00:00, 168.61it/s]replace nan value:  98%|█████████▊| 541/553 [00:03<00:00, 170.33it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 159.78it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.53it/s]  5%|▍         | 27/553 [00:00<00:03, 133.00it/s]  7%|▋         | 41/553 [00:00<00:03, 132.03it/s] 10%|▉         | 55/553 [00:00<00:04, 122.71it/s] 12%|█▏        | 68/553 [00:00<00:04, 111.71it/s] 15%|█▌        | 83/553 [00:00<00:03, 122.79it/s] 18%|█▊        | 97/553 [00:00<00:03, 124.26it/s] 20%|██        | 112/553 [00:00<00:03, 130.64it/s] 23%|██▎       | 126/553 [00:01<00:03, 127.48it/s] 26%|██▌       | 144/553 [00:01<00:02, 140.85it/s] 29%|██▉       | 162/553 [00:01<00:02, 148.56it/s] 32%|███▏      | 178/553 [00:01<00:02, 148.96it/s] 35%|███▌      | 195/553 [00:01<00:02, 152.71it/s] 38%|███▊      | 212/553 [00:01<00:02, 157.15it/s] 41%|████      | 228/553 [00:01<00:02, 147.92it/s] 44%|████▍     | 243/553 [00:01<00:02, 146.12it/s] 47%|████▋     | 258/553 [00:01<00:02, 144.17it/s] 49%|████▉     | 273/553 [00:01<00:01, 140.67it/s] 52%|█████▏    | 289/553 [00:02<00:01, 143.16it/s] 55%|█████▍    | 304/553 [00:02<00:01, 135.33it/s] 58%|█████▊    | 318/553 [00:02<00:01, 127.31it/s] 60%|██████    | 332/553 [00:02<00:01, 129.35it/s] 63%|██████▎   | 346/553 [00:02<00:01, 132.04it/s] 65%|██████▌   | 360/553 [00:02<00:01, 118.89it/s] 67%|██████▋   | 373/553 [00:02<00:01, 107.89it/s] 70%|██████▉   | 385/553 [00:03<00:01, 86.88it/s]  71%|███████▏  | 395/553 [00:03<00:01, 84.38it/s] 74%|███████▍  | 409/553 [00:03<00:01, 96.24it/s] 76%|███████▌  | 420/553 [00:03<00:01, 98.54it/s] 78%|███████▊  | 431/553 [00:03<00:01, 101.14it/s] 81%|████████  | 449/553 [00:03<00:00, 121.46it/s] 84%|████████▍ | 464/553 [00:03<00:00, 127.34it/s] 86%|████████▋ | 478/553 [00:03<00:00, 128.59it/s] 89%|████████▉ | 492/553 [00:03<00:00, 126.07it/s] 91%|█████████▏| 505/553 [00:04<00:00, 124.43it/s] 94%|█████████▍| 520/553 [00:04<00:00, 130.38it/s] 97%|█████████▋| 534/553 [00:04<00:00, 113.55it/s] 99%|█████████▉| 550/553 [00:04<00:00, 124.24it/s]100%|██████████| 553/553 [00:04<00:00, 123.22it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 326.24it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 446.65it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 472.53it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 187.95it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 178.45it/s]replace nan value:  40%|████      | 56/139 [00:00<00:00, 139.20it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 151.66it/s]replace nan value:  68%|██████▊   | 94/139 [00:00<00:00, 166.32it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 132.82it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 113.65it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 134.52it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 128.13it/s] 21%|██        | 29/139 [00:00<00:00, 137.17it/s] 33%|███▎      | 46/139 [00:00<00:00, 147.97it/s] 44%|████▍     | 61/139 [00:00<00:00, 105.62it/s] 55%|█████▍    | 76/139 [00:00<00:00, 116.90it/s] 64%|██████▍   | 89/139 [00:00<00:00, 109.18it/s] 76%|███████▌  | 105/139 [00:00<00:00, 118.19it/s] 85%|████████▍ | 118/139 [00:01<00:00, 113.08it/s] 94%|█████████▎| 130/139 [00:01<00:00, 114.78it/s]100%|██████████| 139/139 [00:01<00:00, 118.88it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 23/173 [00:00<00:00, 229.97it/s]extract the null data:  44%|████▍     | 76/173 [00:00<00:00, 403.20it/s]extract the null data:  74%|███████▍  | 128/173 [00:00<00:00, 455.73it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 421.72it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 185.30it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 138.57it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 157.82it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 166.54it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 171.86it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 175.27it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 136.47it/s]replace nan value:  85%|████████▍ | 147/173 [00:01<00:00, 116.30it/s]replace nan value:  94%|█████████▎| 162/173 [00:01<00:00, 123.13it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 141.42it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 125.58it/s] 16%|█▌        | 27/173 [00:00<00:01, 106.80it/s] 23%|██▎       | 40/173 [00:00<00:01, 113.53it/s] 31%|███       | 54/173 [00:00<00:00, 122.83it/s] 39%|███▊      | 67/173 [00:00<00:00, 122.02it/s] 46%|████▌     | 80/173 [00:00<00:00, 120.39it/s] 54%|█████▍    | 93/173 [00:00<00:00, 122.78it/s] 61%|██████▏   | 106/173 [00:00<00:00, 121.44it/s] 69%|██████▉   | 119/173 [00:00<00:00, 121.51it/s] 76%|███████▋  | 132/173 [00:01<00:00, 117.90it/s] 83%|████████▎ | 144/173 [00:01<00:00, 117.40it/s] 90%|█████████ | 156/173 [00:01<00:00, 105.65it/s] 97%|█████████▋| 167/173 [00:01<00:00, 90.08it/s] 100%|██████████| 173/173 [00:01<00:00, 107.62it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.559, valid loss : 0.483, train f1 : 0.709, valid f1 : 0.597
training process - Deferred Re-weighting:   1%|          | 1/128 [01:20<2:50:02, 80.34s/it]Best score increase :0.000 -> 0.597
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:28<2:33:29, 73.09s/it]Best score increase :0.597 -> 0.629
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:36<2:27:12, 70.66s/it]Best score increase :0.629 -> 0.669
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:43<2:23:43, 69.55s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.401, valid loss : 0.390, train f1 : 0.821, valid f1 : 0.692
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:00<2:28:00, 72.20s/it]Best score increase :0.669 -> 0.692
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:06<2:21:56, 69.81s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [08:09<2:16:50, 67.86s/it]Best score increase :0.692 -> 0.695
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:15<2:13:59, 66.99s/it]Best score increase :0.695 -> 0.720
epoch : 9, train loss : 0.355, valid loss : 0.355, train f1 : 0.844, valid f1 : 0.705
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:32<2:19:21, 70.27s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [11:38<2:15:31, 68.91s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [12:42<2:11:37, 67.50s/it]Best score increase :0.720 -> 0.730
training process - Deferred Re-weighting:   9%|▉         | 12/128 [13:51<2:11:12, 67.87s/it]Best score increase :0.730 -> 0.733
epoch : 13, train loss : 0.289, valid loss : 0.319, train f1 : 0.879, valid f1 : 0.716
training process - Deferred Re-weighting:  10%|█         | 13/128 [15:16<2:19:54, 73.00s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [16:22<2:15:00, 71.06s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [17:28<2:10:34, 69.33s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [18:40<2:10:55, 70.14s/it]Best score increase :0.733 -> 0.752
epoch : 17, train loss : 0.243, valid loss : 0.290, train f1 : 0.902, valid f1 : 0.723
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [20:02<2:16:37, 73.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [21:11<2:12:42, 72.39s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [22:18<2:08:21, 70.66s/it]Best score increase :0.752 -> 0.754
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [23:26<2:06:00, 70.01s/it]Best score increase :0.754 -> 0.768
epoch : 21, train loss : 0.224, valid loss : 0.268, train f1 : 0.911, valid f1 : 0.741
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [24:43<2:08:45, 72.20s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [25:52<2:05:32, 71.06s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [27:09<2:07:30, 72.86s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [28:34<2:12:24, 76.39s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.198, valid loss : 0.244, train f1 : 0.922, valid f1 : 0.751
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [30:04<2:18:23, 80.62s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [31:23<2:16:15, 80.15s/it]Best score increase :0.768 -> 0.783
training process - Deferred Re-weighting:  21%|██        | 27/128 [32:47<2:16:34, 81.13s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [34:07<2:14:43, 80.83s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.186, valid loss : 0.246, train f1 : 0.927, valid f1 : 0.766
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [35:29<2:14:10, 81.32s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [36:42<2:08:43, 78.81s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [37:51<2:02:37, 75.85s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [39:03<1:59:41, 74.80s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.172, valid loss : 0.264, train f1 : 0.934, valid f1 : 0.756
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [40:27<2:02:50, 77.58s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [41:39<1:58:45, 75.80s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [42:46<1:53:25, 73.18s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [43:59<1:52:06, 73.12s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.159, valid loss : 0.294, train f1 : 0.938, valid f1 : 0.750
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [45:17<1:53:00, 74.51s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [46:26<1:54:14, 75.32s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.783
training process finished, best loss : 0.214, best acc : 0.914, best f1 : 0.783, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.78      0.64       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.86      0.80      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.86, test loss : 11.665

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:58, 10.76s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:42, 10.27s/it]processing for feature importance:  25%|██▌       | 3/12 [00:31<01:32, 10.32s/it]processing for feature importance:  33%|███▎      | 4/12 [00:41<01:24, 10.54s/it]processing for feature importance:  42%|████▏     | 5/12 [00:51<01:11, 10.24s/it]processing for feature importance:  50%|█████     | 6/12 [01:01<01:01, 10.22s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:11<00:49,  9.98s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:20<00:39,  9.86s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:29<00:28,  9.50s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:38<00:18,  9.30s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:48<00:09,  9.52s/it]processing for feature importance: 100%|██████████| 12/12 [01:58<00:00,  9.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:58<00:00,  9.85s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 10/306 [00:00<00:02, 99.81it/s]  8%|▊         | 26/306 [00:00<00:02, 134.77it/s] 18%|█▊        | 55/306 [00:00<00:01, 203.00it/s] 27%|██▋       | 83/306 [00:00<00:00, 229.90it/s] 36%|███▌      | 110/306 [00:00<00:00, 243.50it/s] 45%|████▍     | 137/306 [00:00<00:00, 251.63it/s] 54%|█████▍    | 165/306 [00:00<00:00, 259.34it/s] 62%|██████▏   | 191/306 [00:00<00:00, 215.64it/s] 70%|██████▉   | 214/306 [00:01<00:00, 169.80it/s] 80%|███████▉  | 244/306 [00:01<00:00, 198.32it/s] 90%|████████▉ | 274/306 [00:01<00:00, 221.76it/s] 99%|█████████▉| 303/306 [00:01<00:00, 237.30it/s]100%|██████████| 306/306 [00:01<00:00, 218.05it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 42/553 [00:00<00:01, 414.08it/s]extract the null data:  15%|█▌        | 84/553 [00:00<00:01, 243.53it/s]extract the null data:  20%|██        | 113/553 [00:00<00:01, 237.66it/s]extract the null data:  25%|██▌       | 139/553 [00:00<00:01, 239.04it/s]extract the null data:  30%|██▉       | 165/553 [00:00<00:01, 229.36it/s]extract the null data:  36%|███▋      | 201/553 [00:00<00:01, 266.28it/s]extract the null data:  42%|████▏     | 231/553 [00:00<00:01, 274.43it/s]extract the null data:  47%|████▋     | 260/553 [00:01<00:01, 262.16it/s]extract the null data:  54%|█████▍    | 301/553 [00:01<00:00, 303.14it/s]extract the null data:  62%|██████▏   | 344/553 [00:01<00:00, 339.31it/s]extract the null data:  70%|██████▉   | 386/553 [00:01<00:00, 362.62it/s]extract the null data:  78%|███████▊  | 429/553 [00:01<00:00, 380.65it/s]extract the null data:  86%|████████▌ | 474/553 [00:01<00:00, 399.88it/s]extract the null data:  93%|█████████▎| 515/553 [00:01<00:00, 401.93it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 319.73it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 152.66it/s]replace nan value:   6%|▌         | 32/553 [00:00<00:03, 156.33it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:03, 146.50it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:03, 132.86it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:03, 139.00it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:03, 144.37it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:03, 123.40it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:03, 132.07it/s]replace nan value:  26%|██▌       | 143/553 [00:01<00:02, 140.16it/s]replace nan value:  29%|██▉       | 159/553 [00:01<00:02, 145.06it/s]replace nan value:  32%|███▏      | 175/553 [00:01<00:02, 147.30it/s]replace nan value:  34%|███▍      | 190/553 [00:01<00:02, 147.45it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:02, 150.81it/s]replace nan value:  40%|████      | 222/553 [00:01<00:02, 133.34it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:02, 140.16it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:02, 147.44it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:02, 135.21it/s]replace nan value:  52%|█████▏    | 285/553 [00:02<00:02, 116.83it/s]replace nan value:  54%|█████▍    | 298/553 [00:02<00:02, 100.40it/s]replace nan value:  56%|█████▌    | 309/553 [00:02<00:02, 95.48it/s] replace nan value:  59%|█████▊    | 324/553 [00:02<00:02, 106.79it/s]replace nan value:  62%|██████▏   | 341/553 [00:02<00:01, 121.38it/s]replace nan value:  65%|██████▍   | 358/553 [00:02<00:01, 132.04it/s]replace nan value:  68%|██████▊   | 374/553 [00:02<00:01, 138.58it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:01, 129.84it/s]replace nan value:  73%|███████▎  | 405/553 [00:03<00:01, 135.84it/s]replace nan value:  76%|███████▌  | 421/553 [00:03<00:00, 141.32it/s]replace nan value:  79%|███████▉  | 437/553 [00:03<00:00, 144.53it/s]replace nan value:  82%|████████▏ | 452/553 [00:03<00:00, 118.15it/s]replace nan value:  84%|████████▍ | 465/553 [00:03<00:00, 117.47it/s]replace nan value:  87%|████████▋ | 482/553 [00:03<00:00, 129.40it/s]replace nan value:  90%|█████████ | 499/553 [00:03<00:00, 137.90it/s]replace nan value:  93%|█████████▎| 516/553 [00:03<00:00, 144.79it/s]replace nan value:  96%|█████████▌| 531/553 [00:03<00:00, 142.34it/s]replace nan value:  99%|█████████▉| 547/553 [00:04<00:00, 144.70it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 133.32it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 9/553 [00:00<00:06, 85.26it/s]  4%|▍         | 22/553 [00:00<00:04, 109.72it/s]  7%|▋         | 36/553 [00:00<00:04, 122.42it/s]  9%|▉         | 49/553 [00:00<00:04, 108.23it/s] 11%|█         | 61/553 [00:00<00:04, 104.61it/s] 13%|█▎        | 72/553 [00:00<00:05, 89.64it/s]  15%|█▌        | 85/553 [00:00<00:04, 100.01it/s] 17%|█▋        | 96/553 [00:00<00:04, 100.22it/s] 19%|█▉        | 107/553 [00:01<00:04, 89.48it/s] 21%|██        | 117/553 [00:01<00:05, 80.51it/s] 23%|██▎       | 126/553 [00:01<00:06, 67.22it/s] 25%|██▍       | 136/553 [00:01<00:05, 73.80it/s] 26%|██▌       | 144/553 [00:01<00:05, 71.86it/s] 28%|██▊       | 154/553 [00:01<00:05, 78.58it/s] 29%|██▉       | 163/553 [00:01<00:05, 73.99it/s] 31%|███       | 172/553 [00:02<00:04, 77.54it/s] 33%|███▎      | 181/553 [00:02<00:05, 72.99it/s] 36%|███▌      | 197/553 [00:02<00:03, 92.38it/s] 39%|███▊      | 213/553 [00:02<00:03, 109.11it/s] 41%|████      | 225/553 [00:02<00:03, 108.96it/s] 43%|████▎     | 237/553 [00:02<00:03, 101.31it/s] 45%|████▍     | 248/553 [00:02<00:03, 88.61it/s]  47%|████▋     | 258/553 [00:02<00:03, 79.28it/s] 48%|████▊     | 267/553 [00:03<00:04, 70.36it/s] 50%|████▉     | 275/553 [00:03<00:03, 70.98it/s] 51%|█████     | 283/553 [00:03<00:04, 65.71it/s] 53%|█████▎    | 291/553 [00:03<00:03, 66.41it/s] 54%|█████▍    | 299/553 [00:03<00:03, 69.48it/s] 56%|█████▌    | 311/553 [00:03<00:03, 80.38it/s] 59%|█████▊    | 324/553 [00:03<00:02, 92.60it/s] 61%|██████    | 337/553 [00:03<00:02, 101.55it/s] 63%|██████▎   | 348/553 [00:04<00:01, 103.66it/s] 65%|██████▍   | 359/553 [00:04<00:01, 104.12it/s] 68%|██████▊   | 375/553 [00:04<00:01, 116.64it/s] 70%|██████▉   | 387/553 [00:04<00:01, 106.76it/s] 72%|███████▏  | 398/553 [00:04<00:01, 78.01it/s]  74%|███████▎  | 407/553 [00:04<00:01, 76.50it/s] 76%|███████▌  | 418/553 [00:04<00:01, 82.35it/s] 77%|███████▋  | 428/553 [00:04<00:01, 85.56it/s] 80%|████████  | 444/553 [00:05<00:01, 103.32it/s] 83%|████████▎ | 458/553 [00:05<00:00, 111.84it/s] 85%|████████▌ | 472/553 [00:05<00:00, 117.86it/s] 88%|████████▊ | 485/553 [00:05<00:00, 117.37it/s] 90%|█████████ | 498/553 [00:05<00:00, 109.51it/s] 93%|█████████▎| 512/553 [00:05<00:00, 116.00it/s] 95%|█████████▍| 524/553 [00:05<00:00, 107.69it/s] 97%|█████████▋| 536/553 [00:05<00:00, 101.95it/s]100%|█████████▉| 551/553 [00:06<00:00, 92.20it/s] 100%|██████████| 553/553 [00:06<00:00, 90.61it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   6%|▋         | 9/139 [00:00<00:01, 88.48it/s]extract the null data:  38%|███▊      | 53/139 [00:00<00:00, 291.55it/s]extract the null data:  71%|███████   | 98/139 [00:00<00:00, 363.23it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 353.19it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 17/139 [00:00<00:00, 167.08it/s]replace nan value:  24%|██▍       | 34/139 [00:00<00:00, 166.75it/s]replace nan value:  37%|███▋      | 51/139 [00:00<00:00, 136.35it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 149.37it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 134.66it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 143.54it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 147.58it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 153.88it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 149.40it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  6%|▋         | 9/139 [00:00<00:01, 76.97it/s] 14%|█▍        | 20/139 [00:00<00:01, 91.68it/s] 26%|██▌       | 36/139 [00:00<00:00, 115.47it/s] 35%|███▌      | 49/139 [00:00<00:00, 119.39it/s] 44%|████▍     | 61/139 [00:00<00:00, 118.79it/s] 54%|█████▍    | 75/139 [00:00<00:00, 122.36it/s] 63%|██████▎   | 88/139 [00:00<00:00, 101.22it/s] 74%|███████▍  | 103/139 [00:00<00:00, 113.56it/s] 83%|████████▎ | 116/139 [00:01<00:00, 116.67it/s] 93%|█████████▎| 129/139 [00:01<00:00, 120.32it/s]100%|██████████| 139/139 [00:01<00:00, 115.64it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:17, 10.00it/s]extract the null data:  28%|██▊       | 48/173 [00:00<00:00, 277.17it/s]extract the null data:  54%|█████▍    | 93/173 [00:00<00:00, 354.14it/s]extract the null data:  80%|████████  | 139/173 [00:00<00:00, 392.78it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 348.17it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 172.47it/s]replace nan value:  21%|██        | 36/173 [00:00<00:01, 123.00it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 141.92it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 150.04it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 148.62it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 154.06it/s]replace nan value:  71%|███████   | 123/173 [00:00<00:00, 160.20it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 163.86it/s]replace nan value:  91%|█████████▏| 158/173 [00:01<00:00, 165.56it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 156.21it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 124.89it/s] 16%|█▌        | 27/173 [00:00<00:01, 92.40it/s]  21%|██▏       | 37/173 [00:00<00:01, 85.89it/s] 30%|███       | 52/173 [00:00<00:01, 104.05it/s] 37%|███▋      | 64/173 [00:00<00:01, 106.91it/s] 44%|████▍     | 76/173 [00:00<00:01, 86.20it/s]  50%|████▉     | 86/173 [00:00<00:01, 81.10it/s] 55%|█████▍    | 95/173 [00:01<00:01, 75.14it/s] 64%|██████▎   | 110/173 [00:01<00:00, 92.95it/s] 71%|███████   | 123/173 [00:01<00:00, 100.52it/s] 79%|███████▊  | 136/173 [00:01<00:00, 107.68it/s] 86%|████████▌ | 149/173 [00:01<00:00, 110.74it/s] 93%|█████████▎| 161/173 [00:01<00:00, 104.14it/s] 99%|█████████▉| 172/173 [00:01<00:00, 83.25it/s] 100%|██████████| 173/173 [00:01<00:00, 92.81it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.137, valid loss : 0.074, train acc : 0.738, valid acc : 0.921, train f1 : 0.521, valid f1 : 0.563
training process:   1%|          | 1/128 [01:24<2:59:22, 84.74s/it]Best score increase :0.000 -> 0.563
training process:   2%|▏         | 2/128 [02:26<2:29:16, 71.08s/it]Best score increase :0.563 -> 0.616
training process:   2%|▏         | 3/128 [03:36<2:26:51, 70.49s/it]Best score increase :0.616 -> 0.657
training process:   3%|▎         | 4/128 [04:49<2:28:14, 71.73s/it]Best score increase :0.657 -> 0.674
epoch : 5, train loss : 0.049, valid loss : 0.051, train acc : 0.938, valid acc : 0.934, train f1 : 0.707, valid f1 : 0.691
training process:   4%|▍         | 5/128 [06:05<2:29:50, 73.09s/it]Best score increase :0.674 -> 0.691
training process:   5%|▍         | 6/128 [07:04<2:19:21, 68.54s/it]Best score increase :0.691 -> 0.710
training process:   5%|▌         | 7/128 [08:06<2:13:28, 66.19s/it]Best score increase :0.710 -> 0.711
training process:   6%|▋         | 8/128 [09:10<2:11:17, 65.65s/it]Best score increase :0.711 -> 0.718
epoch : 9, train loss : 0.044, valid loss : 0.049, train acc : 0.943, valid acc : 0.936, train f1 : 0.745, valid f1 : 0.728
training process:   7%|▋         | 9/128 [10:19<2:11:55, 66.52s/it]Best score increase :0.718 -> 0.728
training process:   8%|▊         | 10/128 [11:15<2:04:42, 63.41s/it]Best score increase :0.728 -> 0.732
training process:   9%|▊         | 11/128 [12:17<2:03:00, 63.08s/it]Best score increase :0.732 -> 0.735
training process:   9%|▉         | 12/128 [13:18<2:00:31, 62.34s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.041, valid loss : 0.050, train acc : 0.948, valid acc : 0.936, train f1 : 0.770, valid f1 : 0.713
training process:  10%|█         | 13/128 [14:32<2:06:16, 65.88s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [15:47<2:10:16, 68.56s/it]Best score increase :0.735 -> 0.746
training process:  12%|█▏        | 15/128 [16:50<2:05:49, 66.81s/it]Best score increase :0.746 -> 0.748
training process:  12%|█▎        | 16/128 [17:55<2:03:40, 66.26s/it]Best score increase :0.748 -> 0.758
epoch : 17, train loss : 0.037, valid loss : 0.046, train acc : 0.951, valid acc : 0.944, train f1 : 0.790, valid f1 : 0.771
training process:  13%|█▎        | 17/128 [19:05<2:04:39, 67.39s/it]Best score increase :0.758 -> 0.771
training process:  14%|█▍        | 18/128 [20:08<2:01:16, 66.15s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [21:18<2:02:06, 67.22s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [22:20<1:58:22, 65.77s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.035, valid loss : 0.045, train acc : 0.954, valid acc : 0.945, train f1 : 0.806, valid f1 : 0.780
training process:  16%|█▋        | 21/128 [23:33<2:00:57, 67.83s/it]Best score increase :0.771 -> 0.780
training process:  17%|█▋        | 22/128 [24:40<1:59:24, 67.59s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [25:49<1:59:01, 68.02s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [26:55<1:56:59, 67.49s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.051, train acc : 0.957, valid acc : 0.946, train f1 : 0.823, valid f1 : 0.786
training process:  20%|█▉        | 25/128 [28:05<1:57:08, 68.24s/it]Best score increase :0.780 -> 0.786
training process:  20%|██        | 26/128 [29:03<1:50:40, 65.10s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [29:59<1:44:59, 62.37s/it]Best score increase :0.786 -> 0.789
training process:  22%|██▏       | 28/128 [30:57<1:42:10, 61.30s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.031, valid loss : 0.048, train acc : 0.959, valid acc : 0.947, train f1 : 0.835, valid f1 : 0.791
training process:  23%|██▎       | 29/128 [32:04<1:43:42, 62.85s/it]Best score increase :0.789 -> 0.791
training process:  23%|██▎       | 30/128 [33:06<1:42:12, 62.57s/it]Best score increase :0.791 -> 0.792
training process:  24%|██▍       | 31/128 [34:08<1:40:49, 62.36s/it]Best score increase :0.792 -> 0.801
training process:  25%|██▌       | 32/128 [35:04<1:36:40, 60.42s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.029, valid loss : 0.045, train acc : 0.960, valid acc : 0.948, train f1 : 0.841, valid f1 : 0.794
training process:  26%|██▌       | 33/128 [36:11<1:38:51, 62.43s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [37:06<1:34:31, 60.34s/it]Best score increase :0.801 -> 0.814
training process:  27%|██▋       | 35/128 [38:04<1:32:30, 59.68s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [39:03<1:31:14, 59.50s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.028, valid loss : 0.048, train acc : 0.962, valid acc : 0.950, train f1 : 0.848, valid f1 : 0.807
training process:  29%|██▉       | 37/128 [40:10<1:33:29, 61.64s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [41:08<1:30:35, 60.40s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [42:06<1:28:33, 59.70s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [43:03<1:26:30, 58.99s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.027, valid loss : 0.045, train acc : 0.964, valid acc : 0.949, train f1 : 0.858, valid f1 : 0.794
training process:  32%|███▏      | 41/128 [44:08<1:28:21, 60.94s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [45:06<1:25:49, 59.88s/it]Best score increase :0.814 -> 0.818
training process:  34%|███▎      | 43/128 [46:05<1:24:38, 59.75s/it]Best score increase :0.818 -> 0.820
training process:  34%|███▍      | 44/128 [47:08<1:24:48, 60.58s/it]Best score increase :0.820 -> 0.823
epoch : 45, train loss : 0.026, valid loss : 0.045, train acc : 0.965, valid acc : 0.951, train f1 : 0.864, valid f1 : 0.815
training process:  35%|███▌      | 45/128 [48:20<1:28:34, 64.03s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [49:24<1:27:39, 64.14s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [50:30<1:27:18, 64.67s/it]Best score increase :0.823 -> 0.831
training process:  38%|███▊      | 48/128 [51:38<1:27:31, 65.64s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.024, valid loss : 0.041, train acc : 0.967, valid acc : 0.953, train f1 : 0.872, valid f1 : 0.817
training process:  38%|███▊      | 49/128 [52:54<1:30:32, 68.76s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [54:05<1:30:01, 69.25s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [55:14<1:29:02, 69.38s/it]EarlyStopping counter : 4 out of 12
training process:  41%|████      | 52/128 [56:21<1:26:58, 68.67s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.023, valid loss : 0.049, train acc : 0.968, valid acc : 0.951, train f1 : 0.877, valid f1 : 0.826
training process:  41%|████▏     | 53/128 [57:39<1:29:07, 71.30s/it]EarlyStopping counter : 6 out of 12
training process:  42%|████▏     | 54/128 [58:47<1:26:38, 70.26s/it]EarlyStopping counter : 7 out of 12
training process:  43%|████▎     | 55/128 [1:00:03<1:27:44, 72.12s/it]EarlyStopping counter : 8 out of 12
training process:  44%|████▍     | 56/128 [1:01:18<1:27:27, 72.89s/it]EarlyStopping counter : 9 out of 12
epoch : 57, train loss : 0.023, valid loss : 0.045, train acc : 0.969, valid acc : 0.953, train f1 : 0.884, valid f1 : 0.824
training process:  45%|████▍     | 57/128 [1:02:37<1:28:31, 74.81s/it]EarlyStopping counter : 10 out of 12
training process:  45%|████▌     | 58/128 [1:03:49<1:26:11, 73.89s/it]Best score increase :0.831 -> 0.842
training process:  46%|████▌     | 59/128 [1:05:01<1:24:30, 73.48s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [1:06:13<1:22:32, 72.83s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.023, valid loss : 0.046, train acc : 0.970, valid acc : 0.955, train f1 : 0.885, valid f1 : 0.834
training process:  48%|████▊     | 61/128 [1:07:27<1:21:43, 73.19s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [1:08:29<1:17:02, 70.04s/it]Best score increase :0.842 -> 0.845
training process:  49%|████▉     | 63/128 [1:09:35<1:14:21, 68.64s/it]EarlyStopping counter : 1 out of 12
training process:  50%|█████     | 64/128 [1:10:42<1:12:42, 68.17s/it]EarlyStopping counter : 2 out of 12
epoch : 65, train loss : 0.022, valid loss : 0.052, train acc : 0.971, valid acc : 0.956, train f1 : 0.889, valid f1 : 0.842
training process:  51%|█████     | 65/128 [1:11:48<1:11:00, 67.62s/it]EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 66/128 [1:12:46<1:06:53, 64.73s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 67/128 [1:13:40<1:02:23, 61.36s/it]EarlyStopping counter : 5 out of 12
training process:  53%|█████▎    | 68/128 [1:14:35<59:33, 59.57s/it]  EarlyStopping counter : 6 out of 12
epoch : 69, train loss : 0.021, valid loss : 0.048, train acc : 0.971, valid acc : 0.953, train f1 : 0.891, valid f1 : 0.832
training process:  54%|█████▍    | 69/128 [1:15:43<1:01:10, 62.21s/it]EarlyStopping counter : 7 out of 12
training process:  55%|█████▍    | 70/128 [1:16:41<58:48, 60.83s/it]  EarlyStopping counter : 8 out of 12
training process:  55%|█████▌    | 71/128 [1:17:35<55:53, 58.84s/it]EarlyStopping counter : 9 out of 12
training process:  56%|█████▋    | 72/128 [1:18:31<54:08, 58.01s/it]EarlyStopping counter : 10 out of 12
epoch : 73, train loss : 0.021, valid loss : 0.052, train acc : 0.972, valid acc : 0.955, train f1 : 0.895, valid f1 : 0.837
training process:  57%|█████▋    | 73/128 [1:19:54<1:00:08, 65.61s/it]EarlyStopping counter : 11 out of 12
training process:  57%|█████▋    | 73/128 [1:20:54<1:00:57, 66.49s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 73, best f1 score : 0.846
training process finished, best loss : 0.049 and best acc : 0.957, best f1 : 0.846, best epoch : 69

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.83      0.59      0.69       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.90      0.79      0.83      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.83, test AUC : 0.79, test loss : 4.197

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:33,  8.50s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:33,  9.37s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:27,  9.73s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:18,  9.81s/it]processing for feature importance:  42%|████▏     | 5/12 [00:47<01:07,  9.60s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:56,  9.45s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:05<00:46,  9.27s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:15<00:37,  9.32s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:24<00:27,  9.16s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:32<00:17,  8.80s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:42<00:09,  9.33s/it]processing for feature importance: 100%|██████████| 12/12 [01:53<00:00,  9.67s/it]processing for feature importance: 100%|██████████| 12/12 [01:53<00:00,  9.42s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 15%|█▍        | 45/306 [00:00<00:00, 440.52it/s] 29%|██▉       | 90/306 [00:00<00:00, 445.08it/s] 44%|████▍     | 135/306 [00:00<00:00, 440.02it/s] 59%|█████▉    | 180/306 [00:00<00:00, 437.02it/s] 74%|███████▎  | 225/306 [00:00<00:00, 438.39it/s] 88%|████████▊ | 270/306 [00:00<00:00, 439.83it/s]100%|██████████| 306/306 [00:00<00:00, 438.68it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 55/553 [00:00<00:00, 540.64it/s]extract the null data:  20%|█▉        | 110/553 [00:00<00:00, 542.61it/s]extract the null data:  30%|███       | 167/553 [00:00<00:00, 553.64it/s]extract the null data:  41%|████      | 226/553 [00:00<00:00, 564.97it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 594.71it/s]extract the null data:  65%|██████▍   | 358/553 [00:00<00:00, 619.50it/s]extract the null data:  77%|███████▋  | 425/553 [00:00<00:00, 633.88it/s]extract the null data:  88%|████████▊ | 489/553 [00:00<00:00, 609.05it/s]extract the null data: 100%|█████████▉| 551/553 [00:00<00:00, 590.86it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 590.62it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 190.72it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 190.94it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 189.82it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 191.60it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 194.35it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 196.46it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 197.28it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:01, 198.01it/s]replace nan value:  33%|███▎      | 181/553 [00:00<00:01, 197.61it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:01, 198.25it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 197.35it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 196.07it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 196.53it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 196.90it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 196.24it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 196.21it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 198.35it/s]replace nan value:  65%|██████▌   | 362/553 [00:01<00:00, 197.74it/s]replace nan value:  69%|██████▉   | 382/553 [00:01<00:00, 197.26it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 196.57it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 195.94it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 195.68it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 196.46it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 197.75it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 197.56it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 196.02it/s]replace nan value:  98%|█████████▊| 543/553 [00:02<00:00, 195.51it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 196.10it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.99it/s]  5%|▌         | 29/553 [00:00<00:03, 144.55it/s]  8%|▊         | 44/553 [00:00<00:03, 135.58it/s] 10%|█         | 58/553 [00:00<00:03, 126.00it/s] 13%|█▎        | 71/553 [00:00<00:03, 124.39it/s] 16%|█▌        | 88/553 [00:00<00:03, 138.32it/s] 18%|█▊        | 102/553 [00:00<00:03, 132.48it/s] 22%|██▏       | 120/553 [00:00<00:02, 145.17it/s] 24%|██▍       | 135/553 [00:00<00:02, 144.19it/s] 27%|██▋       | 152/553 [00:01<00:02, 150.87it/s] 31%|███       | 171/553 [00:01<00:02, 159.02it/s] 34%|███▍      | 187/553 [00:01<00:02, 155.98it/s] 37%|███▋      | 206/553 [00:01<00:02, 164.82it/s] 40%|████      | 223/553 [00:01<00:02, 155.60it/s] 43%|████▎     | 240/553 [00:01<00:01, 158.85it/s] 46%|████▋     | 256/553 [00:01<00:01, 151.24it/s] 49%|████▉     | 272/553 [00:01<00:01, 148.23it/s] 52%|█████▏    | 289/553 [00:01<00:01, 153.20it/s] 55%|█████▌    | 305/553 [00:02<00:01, 144.41it/s] 58%|█████▊    | 320/553 [00:02<00:01, 134.06it/s] 61%|██████    | 335/553 [00:02<00:01, 137.10it/s] 63%|██████▎   | 349/553 [00:02<00:01, 136.61it/s] 66%|██████▌   | 363/553 [00:02<00:01, 135.31it/s] 68%|██████▊   | 378/553 [00:02<00:01, 139.17it/s] 71%|███████   | 392/553 [00:02<00:01, 129.86it/s] 73%|███████▎  | 406/553 [00:02<00:01, 131.42it/s] 76%|███████▌  | 420/553 [00:02<00:01, 129.08it/s] 78%|███████▊  | 433/553 [00:03<00:00, 126.64it/s] 82%|████████▏ | 451/553 [00:03<00:00, 141.16it/s] 84%|████████▍ | 466/553 [00:03<00:00, 143.46it/s] 87%|████████▋ | 481/553 [00:03<00:00, 139.71it/s] 90%|████████▉ | 496/553 [00:03<00:00, 131.99it/s] 93%|█████████▎| 512/553 [00:03<00:00, 138.91it/s] 95%|█████████▌| 527/553 [00:03<00:00, 123.74it/s] 98%|█████████▊| 541/553 [00:03<00:00, 126.48it/s]100%|██████████| 553/553 [00:04<00:00, 137.37it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 338.32it/s]extract the null data:  72%|███████▏  | 100/139 [00:00<00:00, 523.49it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 532.25it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 213.89it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 215.96it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 214.19it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 214.89it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 212.94it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 213.14it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 214.06it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 125.75it/s] 21%|██        | 29/139 [00:00<00:00, 135.27it/s] 33%|███▎      | 46/139 [00:00<00:00, 146.25it/s] 44%|████▍     | 61/139 [00:00<00:00, 132.93it/s] 55%|█████▍    | 76/139 [00:00<00:00, 135.87it/s] 65%|██████▍   | 90/139 [00:00<00:00, 120.86it/s] 76%|███████▌  | 105/139 [00:00<00:00, 124.76it/s] 87%|████████▋ | 121/139 [00:00<00:00, 134.29it/s] 97%|█████████▋| 135/139 [00:01<00:00, 128.91it/s]100%|██████████| 139/139 [00:01<00:00, 131.90it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 39/173 [00:00<00:00, 387.47it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 550.07it/s]extract the null data:  99%|█████████▉| 171/173 [00:00<00:00, 591.58it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 564.01it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 215.11it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 215.53it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 213.95it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 212.07it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 211.75it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 211.48it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 211.59it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 211.21it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 140.23it/s] 17%|█▋        | 30/173 [00:00<00:01, 127.51it/s] 27%|██▋       | 46/173 [00:00<00:00, 140.98it/s] 36%|███▌      | 62/173 [00:00<00:00, 147.10it/s] 45%|████▍     | 77/173 [00:00<00:00, 144.65it/s] 53%|█████▎    | 92/173 [00:00<00:00, 144.43it/s] 62%|██████▏   | 107/173 [00:00<00:00, 143.71it/s] 71%|███████   | 122/173 [00:00<00:00, 141.34it/s] 79%|███████▉  | 137/173 [00:00<00:00, 137.21it/s] 87%|████████▋ | 151/173 [00:01<00:00, 132.31it/s] 95%|█████████▌| 165/173 [00:01<00:00, 119.44it/s]100%|██████████| 173/173 [00:01<00:00, 124.30it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.117, train acc : 0.717, valid acc : 0.801, train f1 : 0.716, valid f1 : 0.633
training process:   1%|          | 1/128 [01:00<2:07:05, 60.04s/it]Best score increase :0.000 -> 0.633
training process:   2%|▏         | 2/128 [01:51<1:55:40, 55.09s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:45<1:53:07, 54.30s/it]Best score increase :0.633 -> 0.659
training process:   3%|▎         | 4/128 [03:36<1:49:52, 53.17s/it]Best score increase :0.659 -> 0.673
epoch : 5, train loss : 0.098, valid loss : 0.100, train acc : 0.831, valid acc : 0.856, train f1 : 0.831, valid f1 : 0.694
training process:   4%|▍         | 5/128 [04:37<1:55:09, 56.18s/it]Best score increase :0.673 -> 0.694
training process:   5%|▍         | 6/128 [05:30<1:51:51, 55.01s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:22<1:49:05, 54.10s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:14<1:46:44, 53.37s/it]Best score increase :0.694 -> 0.728
epoch : 9, train loss : 0.086, valid loss : 0.088, train acc : 0.858, valid acc : 0.871, train f1 : 0.858, valid f1 : 0.712
training process:   7%|▋         | 9/128 [08:14<1:49:58, 55.45s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:04<1:45:45, 53.78s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:55<1:43:08, 52.89s/it]Best score increase :0.728 -> 0.730
training process:   9%|▉         | 12/128 [10:46<1:41:14, 52.36s/it]Best score increase :0.730 -> 0.737
epoch : 13, train loss : 0.074, valid loss : 0.082, train acc : 0.880, valid acc : 0.876, train f1 : 0.880, valid f1 : 0.718
training process:  10%|█         | 13/128 [11:46<1:44:35, 54.57s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:38<1:42:00, 53.68s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [13:29<1:39:30, 52.84s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [14:20<1:37:43, 52.35s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.066, valid loss : 0.082, train acc : 0.897, valid acc : 0.869, train f1 : 0.897, valid f1 : 0.717
training process:  13%|█▎        | 17/128 [15:20<1:41:10, 54.69s/it]EarlyStopping counter : 5 out of 12
training process:  14%|█▍        | 18/128 [16:11<1:38:07, 53.52s/it]EarlyStopping counter : 6 out of 12
training process:  15%|█▍        | 19/128 [17:02<1:35:55, 52.81s/it]EarlyStopping counter : 7 out of 12
training process:  16%|█▌        | 20/128 [17:54<1:34:59, 52.77s/it]Best score increase :0.737 -> 0.751
epoch : 21, train loss : 0.060, valid loss : 0.077, train acc : 0.909, valid acc : 0.886, train f1 : 0.909, valid f1 : 0.741
training process:  16%|█▋        | 21/128 [18:55<1:38:13, 55.08s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:47<1:35:43, 54.19s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:40<1:34:11, 53.82s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:33<1:32:49, 53.55s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.053, valid loss : 0.071, train acc : 0.920, valid acc : 0.884, train f1 : 0.920, valid f1 : 0.737
training process:  20%|█▉        | 25/128 [22:34<1:35:52, 55.85s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [23:27<1:33:12, 54.83s/it]Best score increase :0.751 -> 0.773
training process:  21%|██        | 27/128 [24:17<1:29:54, 53.41s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [25:08<1:27:55, 52.75s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.050, valid loss : 0.073, train acc : 0.923, valid acc : 0.895, train f1 : 0.923, valid f1 : 0.756
training process:  23%|██▎       | 29/128 [26:10<1:31:50, 55.66s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [27:02<1:28:41, 54.30s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [27:55<1:27:34, 54.17s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [28:48<1:26:00, 53.75s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.047, valid loss : 0.074, train acc : 0.932, valid acc : 0.896, train f1 : 0.932, valid f1 : 0.757
training process:  26%|██▌       | 33/128 [29:50<1:28:55, 56.16s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [30:43<1:26:26, 55.17s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [31:35<1:24:10, 54.31s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [32:28<1:22:34, 53.85s/it]Best score increase :0.773 -> 0.775
epoch : 37, train loss : 0.044, valid loss : 0.090, train acc : 0.934, valid acc : 0.877, train f1 : 0.934, valid f1 : 0.736
training process:  29%|██▉       | 37/128 [33:28<1:24:45, 55.88s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [34:19<1:21:16, 54.18s/it]Best score increase :0.775 -> 0.778
training process:  30%|███       | 39/128 [35:10<1:19:12, 53.40s/it]Best score increase :0.778 -> 0.797
training process:  31%|███▏      | 40/128 [36:01<1:17:16, 52.68s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.042, valid loss : 0.067, train acc : 0.939, valid acc : 0.910, train f1 : 0.939, valid f1 : 0.777
training process:  32%|███▏      | 41/128 [37:01<1:19:32, 54.86s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [37:53<1:17:24, 54.01s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [38:46<1:15:51, 53.55s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [39:35<1:13:14, 52.31s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.041, valid loss : 0.080, train acc : 0.938, valid acc : 0.887, train f1 : 0.938, valid f1 : 0.746
training process:  35%|███▌      | 45/128 [40:36<1:15:48, 54.81s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 46/128 [41:27<1:13:37, 53.87s/it]EarlyStopping counter : 7 out of 12
training process:  37%|███▋      | 47/128 [42:18<1:11:29, 52.96s/it]EarlyStopping counter : 8 out of 12
training process:  38%|███▊      | 48/128 [43:09<1:09:37, 52.22s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.039, valid loss : 0.081, train acc : 0.943, valid acc : 0.896, train f1 : 0.943, valid f1 : 0.756
training process:  38%|███▊      | 49/128 [44:03<1:09:34, 52.84s/it]EarlyStopping counter : 10 out of 12
training process:  39%|███▉      | 50/128 [44:50<1:06:28, 51.14s/it]EarlyStopping counter : 11 out of 12
training process:  39%|███▉      | 50/128 [45:44<1:11:20, 54.88s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 50, best f1 score : 0.797
training process finished, best loss : 0.059 and best acc : 0.925, best f1 : 0.797, best epoch : 38

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.76      0.65       580
           1       0.98      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.85      0.81      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.85, test loss : 2.933

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:19,  7.19s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.35s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.52s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.57s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.56s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.48s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:36,  7.36s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:29,  7.28s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:21,  7.24s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:13<00:14,  7.32s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:20<00:07,  7.29s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.32s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.36s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 31/306 [00:00<00:00, 303.19it/s] 20%|██        | 62/306 [00:00<00:00, 301.61it/s] 31%|███       | 94/306 [00:00<00:00, 309.47it/s] 42%|████▏     | 128/306 [00:00<00:00, 318.23it/s] 52%|█████▏    | 160/306 [00:00<00:00, 314.69it/s] 63%|██████▎   | 192/306 [00:00<00:00, 313.78it/s] 73%|███████▎  | 224/306 [00:00<00:00, 312.27it/s] 84%|████████▍ | 258/306 [00:00<00:00, 318.64it/s] 95%|█████████▌| 291/306 [00:00<00:00, 319.63it/s]100%|██████████| 306/306 [00:00<00:00, 315.06it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 447.33it/s]extract the null data:  16%|█▋        | 90/553 [00:00<00:01, 443.06it/s]extract the null data:  24%|██▍       | 135/553 [00:00<00:00, 444.06it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 456.35it/s]extract the null data:  42%|████▏     | 231/553 [00:00<00:00, 462.20it/s]extract the null data:  50%|█████     | 278/553 [00:00<00:00, 464.81it/s]extract the null data:  59%|█████▉    | 326/553 [00:00<00:00, 468.14it/s]extract the null data:  68%|██████▊   | 374/553 [00:00<00:00, 469.25it/s]extract the null data:  77%|███████▋  | 424/553 [00:00<00:00, 476.94it/s]extract the null data:  86%|████████▌ | 474/553 [00:01<00:00, 482.26it/s]extract the null data:  95%|█████████▍| 525/553 [00:01<00:00, 488.60it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 471.86it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 166.46it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.50it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 173.38it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 175.08it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 176.05it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 177.04it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 177.36it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 177.15it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 177.28it/s]replace nan value:  32%|███▏      | 179/553 [00:01<00:02, 176.95it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 177.72it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 177.28it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 176.51it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 177.18it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 177.62it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 178.87it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 177.98it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 178.24it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 178.18it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 178.45it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:00, 178.00it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 177.60it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 176.93it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 176.62it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 176.89it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 177.03it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 176.56it/s]replace nan value:  91%|█████████▏| 505/553 [00:02<00:00, 177.68it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 176.80it/s]replace nan value:  98%|█████████▊| 541/553 [00:03<00:00, 175.54it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 176.70it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.32it/s]  5%|▍         | 27/553 [00:00<00:04, 130.35it/s]  7%|▋         | 41/553 [00:00<00:04, 126.61it/s] 10%|▉         | 54/553 [00:00<00:04, 115.71it/s] 12%|█▏        | 66/553 [00:00<00:04, 108.03it/s] 14%|█▍        | 79/553 [00:00<00:04, 114.27it/s] 17%|█▋        | 92/553 [00:00<00:03, 118.81it/s] 19%|█▉        | 105/553 [00:00<00:03, 119.82it/s] 22%|██▏       | 120/553 [00:00<00:03, 127.76it/s] 24%|██▍       | 133/553 [00:01<00:03, 126.08it/s] 27%|██▋       | 150/553 [00:01<00:02, 136.56it/s] 30%|███       | 166/553 [00:01<00:02, 142.08it/s] 33%|███▎      | 181/553 [00:01<00:02, 140.91it/s] 36%|███▌      | 197/553 [00:01<00:02, 142.09it/s] 39%|███▊      | 214/553 [00:01<00:02, 147.99it/s] 41%|████▏     | 229/553 [00:01<00:02, 142.82it/s] 44%|████▍     | 244/553 [00:01<00:02, 144.53it/s] 48%|████▊     | 263/553 [00:01<00:01, 155.58it/s] 50%|█████     | 279/553 [00:02<00:01, 148.70it/s] 53%|█████▎    | 294/553 [00:02<00:01, 143.07it/s] 56%|█████▌    | 309/553 [00:02<00:01, 138.50it/s] 58%|█████▊    | 323/553 [00:02<00:01, 135.87it/s] 61%|██████    | 338/553 [00:02<00:01, 138.83it/s] 64%|██████▍   | 353/553 [00:02<00:01, 137.60it/s] 66%|██████▋   | 367/553 [00:02<00:01, 132.60it/s] 69%|██████▉   | 383/553 [00:02<00:01, 139.45it/s] 72%|███████▏  | 398/553 [00:02<00:01, 122.88it/s] 75%|███████▍  | 414/553 [00:03<00:01, 129.37it/s] 77%|███████▋  | 428/553 [00:03<00:01, 117.51it/s] 81%|████████  | 447/553 [00:03<00:00, 134.96it/s] 84%|████████▎ | 463/553 [00:03<00:00, 139.38it/s] 86%|████████▋ | 478/553 [00:03<00:00, 139.29it/s] 89%|████████▉ | 493/553 [00:03<00:00, 134.38it/s] 92%|█████████▏| 507/553 [00:03<00:00, 135.80it/s] 94%|█████████▍| 521/553 [00:03<00:00, 134.38it/s] 97%|█████████▋| 535/553 [00:04<00:00, 117.55it/s]100%|█████████▉| 551/553 [00:04<00:00, 109.20it/s]100%|██████████| 553/553 [00:04<00:00, 130.64it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  39%|███▉      | 54/139 [00:00<00:00, 536.41it/s]extract the null data:  90%|████████▉ | 125/139 [00:00<00:00, 638.11it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 631.53it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 240.59it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 237.92it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 237.84it/s]replace nan value:  71%|███████   | 98/139 [00:00<00:00, 237.71it/s]replace nan value:  88%|████████▊ | 122/139 [00:00<00:00, 236.81it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 237.80it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 126.30it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.90it/s] 32%|███▏      | 44/139 [00:00<00:00, 141.60it/s] 42%|████▏     | 59/139 [00:00<00:00, 127.64it/s] 53%|█████▎    | 74/139 [00:00<00:00, 131.42it/s] 63%|██████▎   | 88/139 [00:00<00:00, 114.94it/s] 74%|███████▍  | 103/139 [00:00<00:00, 123.93it/s] 83%|████████▎ | 116/139 [00:00<00:00, 124.74it/s] 94%|█████████▎| 130/139 [00:01<00:00, 128.32it/s]100%|██████████| 139/139 [00:01<00:00, 128.16it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  32%|███▏      | 55/173 [00:00<00:00, 545.58it/s]extract the null data:  75%|███████▍  | 129/173 [00:00<00:00, 657.73it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 624.89it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 196.69it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 197.25it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 199.24it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 201.39it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 198.84it/s]replace nan value:  71%|███████   | 123/173 [00:00<00:00, 198.42it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 197.81it/s]replace nan value:  94%|█████████▍| 163/173 [00:00<00:00, 196.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 197.95it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.98it/s] 16%|█▌        | 28/173 [00:00<00:01, 117.11it/s] 24%|██▍       | 42/173 [00:00<00:01, 125.40it/s] 33%|███▎      | 57/173 [00:00<00:00, 133.58it/s] 41%|████      | 71/173 [00:00<00:00, 133.23it/s] 49%|████▉     | 85/173 [00:00<00:00, 130.79it/s] 57%|█████▋    | 99/173 [00:00<00:00, 128.06it/s] 65%|██████▌   | 113/173 [00:00<00:00, 129.65it/s] 73%|███████▎  | 127/173 [00:01<00:00, 121.94it/s] 81%|████████  | 140/173 [00:01<00:00, 121.14it/s] 88%|████████▊ | 153/173 [00:01<00:00, 113.42it/s] 95%|█████████▌| 165/173 [00:01<00:00, 102.04it/s]100%|██████████| 173/173 [00:01<00:00, 109.27it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.023, valid loss : 0.020, train acc : 0.552, valid acc : 0.783, train f1 : 0.457, valid f1 : 0.622
training process:   1%|          | 1/128 [01:04<2:16:35, 64.53s/it]Best score increase :0.000 -> 0.622
training process:   2%|▏         | 2/128 [01:56<2:00:27, 57.36s/it]Best score increase :0.622 -> 0.670
training process:   2%|▏         | 3/128 [02:51<1:57:19, 56.31s/it]Best score increase :0.670 -> 0.679
training process:   3%|▎         | 4/128 [03:47<1:55:32, 55.91s/it]Best score increase :0.679 -> 0.698
epoch : 5, train loss : 0.016, valid loss : 0.017, train acc : 0.861, valid acc : 0.858, train f1 : 0.692, valid f1 : 0.693
training process:   4%|▍         | 5/128 [04:49<1:59:04, 58.09s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:40<1:53:30, 55.83s/it]Best score increase :0.698 -> 0.713
training process:   5%|▌         | 7/128 [06:33<1:50:42, 54.89s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:31<1:51:47, 55.89s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.014, valid loss : 0.017, train acc : 0.878, valid acc : 0.873, train f1 : 0.719, valid f1 : 0.709
training process:   7%|▋         | 9/128 [08:48<2:04:00, 62.52s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [09:46<2:00:18, 61.17s/it]Best score increase :0.713 -> 0.727
training process:   9%|▊         | 11/128 [10:56<2:04:34, 63.89s/it]Best score increase :0.727 -> 0.733
training process:   9%|▉         | 12/128 [12:02<2:04:45, 64.53s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.013, valid loss : 0.018, train acc : 0.894, valid acc : 0.892, train f1 : 0.743, valid f1 : 0.724
training process:  10%|█         | 13/128 [13:19<2:10:51, 68.27s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [14:11<2:00:04, 63.20s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [15:15<1:59:30, 63.45s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [16:20<1:59:33, 64.05s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.012, valid loss : 0.015, train acc : 0.907, valid acc : 0.884, train f1 : 0.766, valid f1 : 0.731
training process:  13%|█▎        | 17/128 [17:47<2:11:18, 70.98s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [18:56<2:09:02, 70.39s/it]Best score increase :0.733 -> 0.751
training process:  15%|█▍        | 19/128 [20:06<2:07:34, 70.23s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [21:12<2:04:15, 69.03s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.011, valid loss : 0.017, train acc : 0.915, valid acc : 0.878, train f1 : 0.780, valid f1 : 0.723
training process:  16%|█▋        | 21/128 [22:35<2:10:31, 73.19s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [23:47<2:08:32, 72.76s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [24:39<1:56:32, 66.59s/it]EarlyStopping counter : 5 out of 12
training process:  19%|█▉        | 24/128 [25:27<1:45:47, 61.03s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.011, valid loss : 0.018, train acc : 0.921, valid acc : 0.876, train f1 : 0.792, valid f1 : 0.722
training process:  20%|█▉        | 25/128 [26:28<1:44:46, 61.03s/it]EarlyStopping counter : 7 out of 12
training process:  20%|██        | 26/128 [27:17<1:37:15, 57.21s/it]EarlyStopping counter : 8 out of 12
training process:  21%|██        | 27/128 [28:03<1:31:02, 54.08s/it]EarlyStopping counter : 9 out of 12
training process:  22%|██▏       | 28/128 [28:48<1:25:31, 51.31s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.011, valid loss : 0.019, train acc : 0.926, valid acc : 0.900, train f1 : 0.801, valid f1 : 0.751
training process:  23%|██▎       | 29/128 [29:41<1:25:26, 51.78s/it]EarlyStopping counter : 11 out of 12
training process:  23%|██▎       | 29/128 [30:27<1:43:57, 63.00s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 29, best f1 score : 0.751
training process finished, best loss : 0.017 and best acc : 0.905, best f1 : 0.751, best epoch : 17

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.49      0.70      0.57       580
           1       0.97      0.94      0.96      6818

    accuracy                           0.92      7398
   macro avg       0.73      0.82      0.76      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.76, test AUC : 0.82, test loss : 1.006

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:17,  7.06s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:12,  7.26s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:03,  7.05s/it]processing for feature importance:  33%|███▎      | 4/12 [00:28<00:57,  7.18s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.37s/it]processing for feature importance:  50%|█████     | 6/12 [00:43<00:44,  7.44s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:50<00:36,  7.27s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:57<00:28,  7.14s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:04<00:20,  6.96s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:10<00:13,  6.89s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:18<00:06,  6.95s/it]processing for feature importance: 100%|██████████| 12/12 [01:24<00:00,  6.91s/it]processing for feature importance: 100%|██████████| 12/12 [01:24<00:00,  7.07s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 33/306 [00:00<00:00, 328.99it/s] 22%|██▏       | 68/306 [00:00<00:00, 337.93it/s] 36%|███▌      | 109/306 [00:00<00:00, 370.49it/s] 49%|████▉     | 150/306 [00:00<00:00, 382.62it/s] 62%|██████▏   | 189/306 [00:00<00:00, 364.24it/s] 74%|███████▍  | 226/306 [00:00<00:00, 361.99it/s] 87%|████████▋ | 265/306 [00:00<00:00, 368.12it/s] 99%|█████████▊| 302/306 [00:00<00:00, 359.83it/s]100%|██████████| 306/306 [00:00<00:00, 361.37it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 50/553 [00:00<00:01, 499.11it/s]extract the null data:  18%|█▊        | 100/553 [00:00<00:00, 495.22it/s]extract the null data:  27%|██▋       | 150/553 [00:00<00:00, 496.09it/s]extract the null data:  37%|███▋      | 204/553 [00:00<00:00, 509.75it/s]extract the null data:  46%|████▋     | 257/553 [00:00<00:00, 514.03it/s]extract the null data:  56%|█████▌    | 310/553 [00:00<00:00, 518.43it/s]extract the null data:  65%|██████▌   | 362/553 [00:00<00:00, 518.19it/s]extract the null data:  75%|███████▍  | 414/553 [00:00<00:00, 514.74it/s]extract the null data:  85%|████████▍ | 468/553 [00:00<00:00, 519.94it/s]extract the null data:  95%|█████████▍| 523/553 [00:01<00:00, 526.78it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 517.27it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 182.45it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 180.66it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 183.50it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 186.41it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:02, 187.77it/s]replace nan value:  21%|██        | 116/553 [00:00<00:02, 186.14it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 184.74it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 186.99it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:02, 188.38it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:01, 188.62it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 188.15it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 186.01it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 188.49it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 188.68it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 187.97it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 187.42it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 186.86it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:01, 187.74it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 190.92it/s]replace nan value:  70%|███████   | 388/553 [00:02<00:00, 192.63it/s]replace nan value:  74%|███████▍  | 408/553 [00:02<00:00, 194.44it/s]replace nan value:  77%|███████▋  | 428/553 [00:02<00:00, 190.24it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 195.12it/s]replace nan value:  85%|████████▌ | 471/553 [00:02<00:00, 201.05it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 200.31it/s]replace nan value:  93%|█████████▎| 513/553 [00:02<00:00, 196.23it/s]replace nan value:  96%|█████████▋| 533/553 [00:02<00:00, 190.79it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 189.33it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 189.66it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.17it/s]  5%|▌         | 28/553 [00:00<00:03, 135.29it/s]  8%|▊         | 42/553 [00:00<00:03, 132.25it/s] 10%|█         | 56/553 [00:00<00:04, 123.44it/s] 12%|█▏        | 69/553 [00:00<00:04, 113.13it/s] 15%|█▌        | 85/553 [00:00<00:03, 125.33it/s] 18%|█▊        | 98/553 [00:00<00:03, 123.89it/s] 20%|██        | 111/553 [00:00<00:03, 118.03it/s] 23%|██▎       | 125/553 [00:01<00:03, 121.84it/s] 26%|██▌       | 142/553 [00:01<00:03, 134.53it/s] 29%|██▉       | 161/553 [00:01<00:02, 147.00it/s] 32%|███▏      | 177/553 [00:01<00:02, 149.77it/s] 35%|███▍      | 193/553 [00:01<00:02, 151.52it/s] 38%|███▊      | 210/553 [00:01<00:02, 156.61it/s] 41%|████      | 226/553 [00:01<00:02, 147.95it/s] 44%|████▍     | 242/553 [00:01<00:02, 147.47it/s] 46%|████▋     | 257/553 [00:01<00:02, 145.15it/s] 49%|████▉     | 272/553 [00:01<00:01, 141.39it/s] 52%|█████▏    | 289/553 [00:02<00:01, 149.13it/s] 55%|█████▌    | 305/553 [00:02<00:01, 143.29it/s] 58%|█████▊    | 320/553 [00:02<00:01, 134.23it/s] 61%|██████    | 336/553 [00:02<00:01, 139.86it/s] 63%|██████▎   | 351/553 [00:02<00:01, 142.31it/s] 66%|██████▌   | 366/553 [00:02<00:01, 139.92it/s] 69%|██████▉   | 384/553 [00:02<00:01, 148.01it/s] 72%|███████▏  | 399/553 [00:02<00:01, 129.78it/s] 75%|███████▌  | 416/553 [00:03<00:01, 135.09it/s] 78%|███████▊  | 430/553 [00:03<00:00, 131.04it/s] 82%|████████▏ | 451/553 [00:03<00:00, 148.50it/s] 84%|████████▍ | 467/553 [00:03<00:00, 151.18it/s] 87%|████████▋ | 483/553 [00:03<00:00, 147.70it/s] 90%|█████████ | 498/553 [00:03<00:00, 135.84it/s] 93%|█████████▎| 514/553 [00:03<00:00, 140.67it/s] 96%|█████████▌| 529/553 [00:03<00:00, 128.33it/s] 98%|█████████▊| 543/553 [00:03<00:00, 130.04it/s]100%|██████████| 553/553 [00:04<00:00, 135.41it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 38/139 [00:00<00:00, 379.29it/s]extract the null data:  78%|███████▊  | 108/139 [00:00<00:00, 566.87it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 575.06it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 231.54it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 228.93it/s]replace nan value:  51%|█████     | 71/139 [00:00<00:00, 228.84it/s]replace nan value:  68%|██████▊   | 94/139 [00:00<00:00, 225.76it/s]replace nan value:  84%|████████▍ | 117/139 [00:00<00:00, 224.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 227.07it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 126.29it/s] 20%|██        | 28/139 [00:00<00:00, 131.62it/s] 32%|███▏      | 44/139 [00:00<00:00, 142.87it/s] 42%|████▏     | 59/139 [00:00<00:00, 129.67it/s] 53%|█████▎    | 74/139 [00:00<00:00, 133.34it/s] 63%|██████▎   | 88/139 [00:00<00:00, 116.64it/s] 75%|███████▍  | 104/139 [00:00<00:00, 126.29it/s] 85%|████████▍ | 118/139 [00:00<00:00, 129.53it/s] 95%|█████████▍| 132/139 [00:01<00:00, 126.23it/s]100%|██████████| 139/139 [00:01<00:00, 130.33it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 44/173 [00:00<00:00, 435.80it/s]extract the null data:  67%|██████▋   | 116/173 [00:00<00:00, 601.66it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 607.82it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 228.51it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 229.26it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 221.55it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 208.49it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 211.26it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 216.13it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 215.54it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 216.00it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.43it/s] 16%|█▌        | 28/173 [00:00<00:01, 124.47it/s] 25%|██▌       | 44/173 [00:00<00:00, 137.81it/s] 35%|███▍      | 60/173 [00:00<00:00, 144.15it/s] 43%|████▎     | 75/173 [00:00<00:00, 139.35it/s] 53%|█████▎    | 91/173 [00:00<00:00, 144.46it/s] 61%|██████▏   | 106/173 [00:00<00:00, 140.67it/s] 70%|██████▉   | 121/173 [00:00<00:00, 142.59it/s] 79%|███████▊  | 136/173 [00:00<00:00, 139.23it/s] 87%|████████▋ | 151/173 [00:01<00:00, 140.47it/s] 96%|█████████▌| 166/173 [00:01<00:00, 111.69it/s]100%|██████████| 173/173 [00:01<00:00, 126.79it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.036, valid loss : 0.033, train acc : 0.576, valid acc : 0.203, train f1 : 0.501, valid f1 : 0.202
training process:   1%|          | 1/128 [00:59<2:05:45, 59.42s/it]Best score increase :0.000 -> 0.202
training process:   2%|▏         | 2/128 [01:49<1:52:52, 53.75s/it]Best score increase :0.202 -> 0.215
training process:   2%|▏         | 3/128 [02:39<1:48:39, 52.15s/it]Best score increase :0.215 -> 0.272
training process:   3%|▎         | 4/128 [03:31<1:47:36, 52.07s/it]Best score increase :0.272 -> 0.357
epoch : 5, train loss : 0.023, valid loss : 0.027, train acc : 0.674, valid acc : 0.391, train f1 : 0.636, valid f1 : 0.358
training process:   4%|▍         | 5/128 [04:29<1:51:03, 54.17s/it]Best score increase :0.357 -> 0.358
training process:   5%|▍         | 6/128 [05:16<1:45:31, 51.90s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:17<1:50:29, 54.79s/it]Best score increase :0.358 -> 0.412
training process:   6%|▋         | 8/128 [07:03<1:44:16, 52.14s/it]Best score increase :0.412 -> 0.446
epoch : 9, train loss : 0.020, valid loss : 0.023, train acc : 0.717, valid acc : 0.521, train f1 : 0.695, valid f1 : 0.451
training process:   7%|▋         | 9/128 [08:02<1:47:04, 53.99s/it]Best score increase :0.446 -> 0.451
training process:   8%|▊         | 10/128 [08:58<1:47:47, 54.81s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:44<1:41:40, 52.14s/it]Best score increase :0.451 -> 0.460
training process:   9%|▉         | 12/128 [10:32<1:38:11, 50.79s/it]Best score increase :0.460 -> 0.496
epoch : 13, train loss : 0.017, valid loss : 0.022, train acc : 0.769, valid acc : 0.546, train f1 : 0.757, valid f1 : 0.468
training process:  10%|█         | 13/128 [11:30<1:41:21, 52.89s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:15<1:36:21, 50.72s/it]Best score increase :0.496 -> 0.502
training process:  12%|█▏        | 15/128 [13:03<1:33:52, 49.85s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [13:48<1:30:07, 48.28s/it]Best score increase :0.502 -> 0.537
epoch : 17, train loss : 0.015, valid loss : 0.022, train acc : 0.804, valid acc : 0.633, train f1 : 0.796, valid f1 : 0.528
training process:  13%|█▎        | 17/128 [14:40<1:31:28, 49.45s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:26<1:28:38, 48.35s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [16:18<1:29:39, 49.36s/it]Best score increase :0.537 -> 0.545
training process:  16%|█▌        | 20/128 [17:06<1:28:25, 49.13s/it]Best score increase :0.545 -> 0.581
epoch : 21, train loss : 0.014, valid loss : 0.021, train acc : 0.834, valid acc : 0.666, train f1 : 0.829, valid f1 : 0.552
training process:  16%|█▋        | 21/128 [18:05<1:32:59, 52.15s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [18:53<1:29:35, 50.71s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [19:46<1:29:58, 51.41s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [20:38<1:29:37, 51.71s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.012, valid loss : 0.019, train acc : 0.855, valid acc : 0.720, train f1 : 0.852, valid f1 : 0.590
training process:  20%|█▉        | 25/128 [21:45<1:36:47, 56.38s/it]Best score increase :0.581 -> 0.590
training process:  20%|██        | 26/128 [22:35<1:32:16, 54.28s/it]Best score increase :0.590 -> 0.613
training process:  21%|██        | 27/128 [23:31<1:32:30, 54.95s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:28<1:32:20, 55.40s/it]Best score increase :0.613 -> 0.616
epoch : 29, train loss : 0.012, valid loss : 0.020, train acc : 0.869, valid acc : 0.745, train f1 : 0.866, valid f1 : 0.612
training process:  23%|██▎       | 29/128 [25:28<1:33:45, 56.83s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [26:32<1:36:33, 59.12s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [27:33<1:36:16, 59.55s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [28:24<1:31:17, 57.06s/it]Best score increase :0.616 -> 0.617
epoch : 33, train loss : 0.011, valid loss : 0.019, train acc : 0.876, valid acc : 0.766, train f1 : 0.874, valid f1 : 0.628
training process:  26%|██▌       | 33/128 [29:34<1:36:25, 60.90s/it]Best score increase :0.617 -> 0.628
training process:  27%|██▋       | 34/128 [30:22<1:29:13, 56.95s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [31:11<1:24:46, 54.69s/it]Best score increase :0.628 -> 0.648
training process:  28%|██▊       | 36/128 [32:14<1:27:33, 57.11s/it]Best score increase :0.648 -> 0.653
epoch : 37, train loss : 0.010, valid loss : 0.021, train acc : 0.887, valid acc : 0.740, train f1 : 0.886, valid f1 : 0.607
training process:  29%|██▉       | 37/128 [33:10<1:26:14, 56.86s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [34:18<1:30:15, 60.18s/it]Best score increase :0.653 -> 0.655
training process:  30%|███       | 39/128 [35:08<1:24:39, 57.07s/it]Best score increase :0.655 -> 0.674
training process:  31%|███▏      | 40/128 [36:14<1:27:51, 59.90s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.019, train acc : 0.893, valid acc : 0.806, train f1 : 0.892, valid f1 : 0.663
training process:  32%|███▏      | 41/128 [37:14<1:26:51, 59.90s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [38:19<1:27:50, 61.28s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [39:06<1:20:55, 57.13s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [40:01<1:18:48, 56.29s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.010, valid loss : 0.020, train acc : 0.896, valid acc : 0.771, train f1 : 0.895, valid f1 : 0.632
training process:  35%|███▌      | 45/128 [41:15<1:25:15, 61.63s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 46/128 [42:09<1:21:17, 59.49s/it]EarlyStopping counter : 7 out of 12
training process:  37%|███▋      | 47/128 [43:21<1:25:17, 63.18s/it]EarlyStopping counter : 8 out of 12
training process:  38%|███▊      | 48/128 [44:10<1:18:37, 58.97s/it]Best score increase :0.674 -> 0.682
epoch : 49, train loss : 0.009, valid loss : 0.022, train acc : 0.903, valid acc : 0.782, train f1 : 0.902, valid f1 : 0.642
training process:  38%|███▊      | 49/128 [45:14<1:19:24, 60.31s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [46:27<1:23:34, 64.29s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [47:22<1:18:45, 61.36s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [48:36<1:22:28, 65.11s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.009, valid loss : 0.025, train acc : 0.906, valid acc : 0.820, train f1 : 0.905, valid f1 : 0.676
training process:  41%|████▏     | 53/128 [49:36<1:19:28, 63.58s/it]EarlyStopping counter : 5 out of 12
training process:  42%|████▏     | 54/128 [50:27<1:13:46, 59.81s/it]EarlyStopping counter : 6 out of 12
training process:  43%|████▎     | 55/128 [51:18<1:09:48, 57.37s/it]EarlyStopping counter : 7 out of 12
training process:  44%|████▍     | 56/128 [52:32<1:14:50, 62.37s/it]EarlyStopping counter : 8 out of 12
epoch : 57, train loss : 0.009, valid loss : 0.024, train acc : 0.912, valid acc : 0.792, train f1 : 0.911, valid f1 : 0.649
training process:  45%|████▍     | 57/128 [53:36<1:14:24, 62.88s/it]EarlyStopping counter : 9 out of 12
training process:  45%|████▌     | 58/128 [54:44<1:15:00, 64.29s/it]EarlyStopping counter : 10 out of 12
training process:  46%|████▌     | 59/128 [55:33<1:08:42, 59.75s/it]EarlyStopping counter : 11 out of 12
training process:  46%|████▌     | 59/128 [56:19<1:05:52, 57.29s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 59, best f1 score : 0.682
training process finished, best loss : 0.024 and best acc : 0.826, best f1 : 0.682, best epoch : 47

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.38      0.87      0.53       580
           1       0.99      0.88      0.93      6818

    accuracy                           0.88      7398
   macro avg       0.68      0.87      0.73      7398
weighted avg       0.94      0.88      0.90      7398


# test acc : 0.88, test f1 : 0.73, test AUC : 0.87, test loss : 0.978

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:19,  7.20s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:12,  7.29s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:04,  7.18s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.49s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:57,  8.15s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.90s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.89s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:31,  7.86s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:25,  8.52s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:22<00:18,  9.26s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:33<00:09,  9.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:44<00:00, 10.14s/it]processing for feature importance: 100%|██████████| 12/12 [01:44<00:00,  8.73s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 32/306 [00:00<00:00, 312.06it/s] 21%|██        | 65/306 [00:00<00:00, 318.88it/s] 33%|███▎      | 102/306 [00:00<00:00, 338.55it/s] 46%|████▋     | 142/306 [00:00<00:00, 358.36it/s] 58%|█████▊    | 178/306 [00:00<00:00, 334.91it/s] 71%|███████   | 218/306 [00:00<00:00, 353.99it/s] 83%|████████▎ | 254/306 [00:00<00:00, 349.09it/s] 95%|█████████▍| 290/306 [00:00<00:00, 313.49it/s]100%|██████████| 306/306 [00:00<00:00, 309.23it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   5%|▌         | 28/553 [00:00<00:02, 256.17it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:02, 236.58it/s]extract the null data:  14%|█▍        | 78/553 [00:00<00:02, 222.00it/s]extract the null data:  18%|█▊        | 101/553 [00:00<00:02, 221.19it/s]extract the null data:  23%|██▎       | 125/553 [00:00<00:01, 226.10it/s]extract the null data:  27%|██▋       | 148/553 [00:00<00:01, 225.25it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:01, 267.52it/s]extract the null data:  38%|███▊      | 211/553 [00:00<00:01, 235.92it/s]extract the null data:  43%|████▎     | 236/553 [00:01<00:01, 196.88it/s]extract the null data:  47%|████▋     | 260/553 [00:01<00:01, 207.29it/s]extract the null data:  52%|█████▏    | 286/553 [00:01<00:01, 221.01it/s]extract the null data:  56%|█████▌    | 310/553 [00:01<00:01, 225.00it/s]extract the null data:  63%|██████▎   | 347/553 [00:01<00:00, 264.48it/s]extract the null data:  69%|██████▉   | 381/553 [00:01<00:00, 279.86it/s]extract the null data:  74%|███████▍  | 410/553 [00:01<00:00, 278.87it/s]extract the null data:  83%|████████▎ | 460/553 [00:01<00:00, 340.54it/s]extract the null data:  90%|█████████ | 499/553 [00:01<00:00, 338.84it/s]extract the null data:  97%|█████████▋| 534/553 [00:02<00:00, 302.91it/s]extract the null data: 100%|██████████| 553/553 [00:02<00:00, 259.37it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 12/553 [00:00<00:04, 109.14it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:06, 87.37it/s] replace nan value:   8%|▊         | 42/553 [00:00<00:04, 125.90it/s]replace nan value:  11%|█         | 60/553 [00:00<00:03, 143.41it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:03, 154.13it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:02, 161.33it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 166.01it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:02, 170.30it/s]replace nan value:  27%|██▋       | 151/553 [00:00<00:02, 176.19it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 178.90it/s]replace nan value:  34%|███▍      | 189/553 [00:01<00:02, 181.18it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 184.23it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 185.04it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 186.28it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 185.38it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 188.14it/s]replace nan value:  55%|█████▌    | 305/553 [00:01<00:01, 184.19it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 160.50it/s]replace nan value:  62%|██████▏   | 341/553 [00:02<00:01, 128.77it/s]replace nan value:  64%|██████▍   | 356/553 [00:02<00:01, 117.50it/s]replace nan value:  67%|██████▋   | 369/553 [00:02<00:01, 109.77it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:01, 98.02it/s] replace nan value:  71%|███████   | 392/553 [00:02<00:01, 95.88it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:01, 94.09it/s]replace nan value:  75%|███████▍  | 412/553 [00:02<00:01, 89.07it/s]replace nan value:  76%|███████▋  | 422/553 [00:03<00:01, 90.40it/s]replace nan value:  79%|███████▉  | 436/553 [00:03<00:01, 102.94it/s]replace nan value:  82%|████████▏ | 454/553 [00:03<00:00, 123.27it/s]replace nan value:  84%|████████▍ | 467/553 [00:03<00:00, 122.59it/s]replace nan value:  88%|████████▊ | 485/553 [00:03<00:00, 133.97it/s]replace nan value:  90%|█████████ | 499/553 [00:03<00:00, 119.09it/s]replace nan value:  93%|█████████▎| 512/553 [00:03<00:00, 101.50it/s]replace nan value:  95%|█████████▍| 523/553 [00:03<00:00, 91.89it/s] replace nan value:  96%|█████████▋| 533/553 [00:04<00:00, 88.83it/s]replace nan value:  99%|█████████▉| 550/553 [00:04<00:00, 107.04it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 130.52it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.98it/s]  5%|▌         | 29/553 [00:00<00:03, 141.58it/s]  8%|▊         | 44/553 [00:00<00:03, 131.75it/s] 10%|█         | 58/553 [00:00<00:04, 122.73it/s] 13%|█▎        | 71/553 [00:00<00:04, 105.42it/s] 15%|█▍        | 82/553 [00:00<00:04, 105.94it/s] 18%|█▊        | 97/553 [00:00<00:03, 115.36it/s] 20%|██        | 113/553 [00:00<00:03, 126.18it/s] 23%|██▎       | 126/553 [00:01<00:03, 125.46it/s] 26%|██▌       | 145/553 [00:01<00:02, 143.21it/s] 29%|██▉       | 162/553 [00:01<00:02, 150.86it/s] 32%|███▏      | 178/553 [00:01<00:02, 152.43it/s] 35%|███▌      | 195/553 [00:01<00:02, 156.36it/s] 39%|███▊      | 213/553 [00:01<00:02, 160.64it/s] 42%|████▏     | 230/553 [00:01<00:02, 145.86it/s] 44%|████▍     | 245/553 [00:01<00:02, 146.32it/s] 47%|████▋     | 262/553 [00:01<00:01, 150.81it/s] 50%|█████     | 278/553 [00:02<00:01, 142.49it/s] 53%|█████▎    | 293/553 [00:02<00:01, 138.94it/s] 56%|█████▌    | 308/553 [00:02<00:02, 118.02it/s] 58%|█████▊    | 321/553 [00:02<00:02, 96.72it/s]  61%|██████    | 335/553 [00:02<00:02, 106.08it/s] 63%|██████▎   | 349/553 [00:02<00:01, 111.92it/s] 65%|██████▌   | 362/553 [00:02<00:01, 113.82it/s] 68%|██████▊   | 377/553 [00:02<00:01, 122.67it/s] 71%|███████   | 390/553 [00:03<00:01, 115.90it/s] 73%|███████▎  | 403/553 [00:03<00:01, 119.43it/s] 75%|███████▌  | 416/553 [00:03<00:01, 120.77it/s] 78%|███████▊  | 429/553 [00:03<00:01, 116.61it/s] 81%|████████  | 448/553 [00:03<00:00, 134.02it/s] 84%|████████▍ | 464/553 [00:03<00:00, 138.24it/s] 86%|████████▋ | 478/553 [00:03<00:00, 136.45it/s] 89%|████████▉ | 492/553 [00:03<00:00, 132.66it/s] 92%|█████████▏| 506/553 [00:03<00:00, 130.45it/s] 94%|█████████▍| 520/553 [00:04<00:00, 133.09it/s] 97%|█████████▋| 534/553 [00:04<00:00, 115.38it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.68it/s]100%|██████████| 553/553 [00:04<00:00, 125.67it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 21/139 [00:00<00:00, 180.79it/s]extract the null data:  62%|██████▏   | 86/139 [00:00<00:00, 438.25it/s]extract the null data:  95%|█████████▍| 132/139 [00:00<00:00, 443.51it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 421.62it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 176.87it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 196.00it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 200.78it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 200.18it/s]replace nan value:  73%|███████▎  | 102/139 [00:00<00:00, 193.78it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 198.83it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 198.34it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  7%|▋         | 10/139 [00:00<00:01, 98.03it/s] 14%|█▍        | 20/139 [00:00<00:01, 89.35it/s] 27%|██▋       | 38/139 [00:00<00:00, 126.55it/s] 37%|███▋      | 52/139 [00:00<00:00, 129.69it/s] 47%|████▋     | 66/139 [00:00<00:00, 132.09it/s] 58%|█████▊    | 80/139 [00:00<00:00, 112.97it/s] 66%|██████▌   | 92/139 [00:00<00:00, 112.47it/s] 76%|███████▌  | 105/139 [00:00<00:00, 113.95it/s] 88%|████████▊ | 122/139 [00:01<00:00, 128.39it/s] 98%|█████████▊| 136/139 [00:01<00:00, 131.46it/s]100%|██████████| 139/139 [00:01<00:00, 123.44it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 40/173 [00:00<00:00, 397.12it/s]extract the null data:  47%|████▋     | 81/173 [00:00<00:00, 402.81it/s]extract the null data:  71%|███████   | 122/173 [00:00<00:00, 377.70it/s]extract the null data:  92%|█████████▏| 160/173 [00:00<00:00, 340.34it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 368.45it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   6%|▌         | 10/173 [00:00<00:01, 99.79it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:01, 100.27it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 148.15it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 170.86it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 183.86it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 191.89it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 197.59it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 199.54it/s]replace nan value:  97%|█████████▋| 167/173 [00:01<00:00, 148.85it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 157.48it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▌         | 9/173 [00:00<00:01, 82.28it/s] 10%|█         | 18/173 [00:00<00:01, 83.20it/s] 16%|█▌        | 27/173 [00:00<00:02, 65.69it/s] 20%|██        | 35/173 [00:00<00:02, 66.66it/s] 27%|██▋       | 46/173 [00:00<00:01, 74.41it/s] 34%|███▎      | 58/173 [00:00<00:01, 86.65it/s] 42%|████▏     | 73/173 [00:00<00:00, 101.98it/s] 49%|████▊     | 84/173 [00:00<00:00, 94.93it/s]  54%|█████▍    | 94/173 [00:01<00:00, 89.43it/s] 60%|██████    | 104/173 [00:01<00:00, 83.64it/s] 65%|██████▌   | 113/173 [00:01<00:00, 84.38it/s] 71%|███████   | 122/173 [00:01<00:00, 74.99it/s] 75%|███████▌  | 130/173 [00:01<00:00, 71.82it/s] 80%|███████▉  | 138/173 [00:01<00:00, 66.54it/s] 84%|████████▍ | 145/173 [00:01<00:00, 66.86it/s] 88%|████████▊ | 152/173 [00:01<00:00, 64.52it/s] 94%|█████████▍| 163/173 [00:02<00:00, 75.72it/s] 99%|█████████▉| 171/173 [00:02<00:00, 65.32it/s]100%|██████████| 173/173 [00:02<00:00, 75.99it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.137, valid loss : 0.074, train f1 : 0.521, valid f1 : 0.563
training process - Deferred Re-weighting:   1%|          | 1/128 [01:16<2:41:48, 76.45s/it]Best score increase :0.000 -> 0.563
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:10<2:13:12, 63.43s/it]Best score increase :0.563 -> 0.614
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:00<1:59:30, 57.37s/it]Best score increase :0.614 -> 0.656
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:57<1:58:19, 57.25s/it]Best score increase :0.656 -> 0.673
epoch : 5, train loss : 0.049, valid loss : 0.051, train f1 : 0.708, valid f1 : 0.694
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:05<2:05:06, 61.03s/it]Best score increase :0.673 -> 0.694
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:54<1:55:39, 56.88s/it]Best score increase :0.694 -> 0.713
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:42<1:48:35, 53.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:35<1:47:24, 53.71s/it]Best score increase :0.713 -> 0.718
epoch : 9, train loss : 0.044, valid loss : 0.049, train f1 : 0.746, valid f1 : 0.731
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:40<1:53:23, 57.17s/it]Best score increase :0.718 -> 0.731
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:41<1:54:43, 58.34s/it]Best score increase :0.731 -> 0.734
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:33<1:49:53, 56.35s/it]Best score increase :0.734 -> 0.737
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:33<1:51:34, 57.72s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.040, valid loss : 0.050, train f1 : 0.775, valid f1 : 0.715
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:38<1:54:27, 59.72s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:40<1:54:40, 60.35s/it]Best score increase :0.737 -> 0.753
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:44<1:55:47, 61.49s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:46<1:55:02, 61.63s/it]Best score increase :0.753 -> 0.761
epoch : 17, train loss : 0.037, valid loss : 0.046, train f1 : 0.795, valid f1 : 0.771
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:03<2:02:30, 66.22s/it]Best score increase :0.761 -> 0.771
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:12<2:03:22, 67.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:21<2:02:51, 67.63s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:32<2:03:55, 68.85s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.034, valid loss : 0.046, train f1 : 0.815, valid f1 : 0.789
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [21:53<2:09:11, 72.45s/it]Best score increase :0.771 -> 0.789
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [22:56<2:02:57, 69.60s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [24:02<1:59:43, 68.42s/it]Best score increase :0.789 -> 0.796
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [24:54<1:50:06, 63.53s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.031, valid loss : 0.050, train f1 : 0.834, valid f1 : 0.796
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [26:14<1:57:40, 68.55s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [27:31<2:00:31, 70.90s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [28:48<2:02:40, 72.88s/it]Best score increase :0.796 -> 0.806
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [30:09<2:05:28, 75.29s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.029, valid loss : 0.047, train f1 : 0.847, valid f1 : 0.806
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [31:38<2:10:48, 79.28s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [32:52<2:07:06, 77.82s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [34:07<2:04:27, 76.98s/it]Best score increase :0.806 -> 0.820
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [35:21<2:01:52, 76.17s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.027, valid loss : 0.044, train f1 : 0.855, valid f1 : 0.815
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [36:49<2:05:59, 79.57s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [37:58<1:59:48, 76.47s/it]Best score increase :0.820 -> 0.822
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [39:09<1:55:53, 74.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [40:19<1:52:26, 73.34s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.026, valid loss : 0.047, train f1 : 0.869, valid f1 : 0.824
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [41:45<1:56:48, 77.02s/it]Best score increase :0.822 -> 0.824
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [42:55<1:52:31, 75.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [44:04<1:48:45, 73.32s/it]Best score increase :0.824 -> 0.828
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [45:16<1:46:39, 72.73s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.025, valid loss : 0.046, train f1 : 0.877, valid f1 : 0.806
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [46:43<1:51:48, 77.11s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [47:51<1:46:32, 74.33s/it]Best score increase :0.828 -> 0.832
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [48:55<1:41:06, 71.38s/it]Best score increase :0.832 -> 0.839
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [49:57<1:35:53, 68.49s/it]Best score increase :0.839 -> 0.848
epoch : 45, train loss : 0.024, valid loss : 0.045, train f1 : 0.880, valid f1 : 0.831
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [51:12<1:37:26, 70.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [52:15<1:33:04, 68.10s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [53:22<1:31:27, 67.75s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [54:28<1:29:41, 67.27s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.022, valid loss : 0.041, train f1 : 0.891, valid f1 : 0.840
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [55:41<1:30:45, 68.93s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [56:52<1:30:34, 69.67s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [57:59<1:28:33, 69.01s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [59:05<1:26:17, 68.13s/it]EarlyStopping counter : 8 out of 12
epoch : 53, train loss : 0.020, valid loss : 0.055, train f1 : 0.899, valid f1 : 0.837
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [1:00:19<1:27:14, 69.80s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [1:01:22<1:23:24, 67.62s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:02:30<1:22:21, 67.69s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:03:35<1:24:23, 69.37s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 55, best f1 score : 0.848
training process finished, best loss : 0.045, best acc : 0.958, best f1 : 0.848, best epoch : 46

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.81      0.63      0.71       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.89      0.81      0.84      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.81, test loss : 3.820

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:42,  9.34s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:37,  9.74s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:27,  9.68s/it]processing for feature importance:  33%|███▎      | 4/12 [00:37<01:12,  9.07s/it]processing for feature importance:  42%|████▏     | 5/12 [00:47<01:06,  9.48s/it]processing for feature importance:  50%|█████     | 6/12 [00:58<01:01, 10.18s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:11<00:55, 11.08s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:24<00:46, 11.57s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:35<00:34, 11.51s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:43<00:20, 10.36s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:51<00:09,  9.54s/it]processing for feature importance: 100%|██████████| 12/12 [02:00<00:00,  9.56s/it]processing for feature importance: 100%|██████████| 12/12 [02:00<00:00, 10.07s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|▉         | 30/306 [00:00<00:00, 297.55it/s] 20%|██        | 62/306 [00:00<00:00, 304.93it/s] 30%|███       | 93/306 [00:00<00:00, 306.17it/s] 41%|████      | 125/306 [00:00<00:00, 310.62it/s] 51%|█████▏    | 157/306 [00:00<00:00, 300.92it/s] 62%|██████▏   | 190/306 [00:00<00:00, 309.08it/s] 73%|███████▎  | 223/306 [00:00<00:00, 313.70it/s] 84%|████████▎ | 256/306 [00:00<00:00, 318.30it/s] 94%|█████████▍| 288/306 [00:00<00:00, 316.95it/s]100%|██████████| 306/306 [00:00<00:00, 312.71it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 36/553 [00:00<00:01, 310.36it/s]extract the null data:  12%|█▏        | 68/553 [00:00<00:01, 269.10it/s]extract the null data:  17%|█▋        | 96/553 [00:00<00:01, 249.06it/s]extract the null data:  27%|██▋       | 151/553 [00:00<00:01, 351.25it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:01, 336.41it/s]extract the null data:  40%|████      | 223/553 [00:00<00:01, 307.66it/s]extract the null data:  49%|████▉     | 273/553 [00:00<00:00, 361.56it/s]extract the null data:  58%|█████▊    | 319/553 [00:00<00:00, 388.54it/s]extract the null data:  67%|██████▋   | 369/553 [00:01<00:00, 417.91it/s]extract the null data:  75%|███████▌  | 416/553 [00:01<00:00, 432.97it/s]extract the null data:  83%|████████▎ | 461/553 [00:01<00:00, 427.89it/s]extract the null data:  91%|█████████▏| 505/553 [00:01<00:00, 396.44it/s]extract the null data:  99%|█████████▉| 548/553 [00:01<00:00, 403.39it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 372.39it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 12/553 [00:00<00:04, 113.73it/s]replace nan value:   5%|▌         | 28/553 [00:00<00:04, 118.09it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:04, 121.49it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:04, 108.91it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:04, 120.45it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:03, 125.65it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:03, 142.84it/s]replace nan value:  21%|██        | 117/553 [00:00<00:03, 141.75it/s]replace nan value:  24%|██▍       | 132/553 [00:01<00:03, 134.08it/s]replace nan value:  27%|██▋       | 149/553 [00:01<00:02, 143.15it/s]replace nan value:  30%|███       | 166/553 [00:01<00:02, 149.81it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 155.48it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:02, 145.91it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:02, 154.37it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:02, 156.75it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:02, 150.33it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 148.01it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 146.63it/s]replace nan value:  54%|█████▎    | 296/553 [00:02<00:01, 137.48it/s]replace nan value:  56%|█████▌    | 310/553 [00:02<00:01, 136.21it/s]replace nan value:  59%|█████▊    | 324/553 [00:02<00:01, 131.95it/s]replace nan value:  61%|██████    | 338/553 [00:02<00:01, 129.11it/s]replace nan value:  64%|██████▎   | 352/553 [00:02<00:01, 131.13it/s]replace nan value:  66%|██████▌   | 366/553 [00:02<00:01, 133.22it/s]replace nan value:  69%|██████▊   | 380/553 [00:02<00:01, 129.41it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:01, 135.95it/s]replace nan value:  74%|███████▍  | 410/553 [00:03<00:01, 129.99it/s]replace nan value:  77%|███████▋  | 424/553 [00:03<00:00, 132.26it/s]replace nan value:  79%|███████▉  | 438/553 [00:03<00:00, 133.18it/s]replace nan value:  82%|████████▏ | 453/553 [00:03<00:00, 130.09it/s]replace nan value:  85%|████████▍ | 468/553 [00:03<00:00, 135.21it/s]replace nan value:  87%|████████▋ | 482/553 [00:03<00:00, 118.13it/s]replace nan value:  90%|████████▉ | 495/553 [00:03<00:00, 117.70it/s]replace nan value:  93%|█████████▎| 512/553 [00:03<00:00, 130.32it/s]replace nan value:  95%|█████████▌| 526/553 [00:03<00:00, 128.74it/s]replace nan value:  98%|█████████▊| 540/553 [00:04<00:00, 129.22it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 134.51it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 10/553 [00:00<00:05, 94.93it/s]  4%|▍         | 21/553 [00:00<00:05, 100.65it/s]  7%|▋         | 36/553 [00:00<00:04, 120.45it/s]  9%|▉         | 49/553 [00:00<00:06, 77.93it/s]  11%|█         | 59/553 [00:00<00:06, 77.51it/s] 12%|█▏        | 68/553 [00:00<00:06, 77.05it/s] 14%|█▍        | 77/553 [00:00<00:06, 77.49it/s] 16%|█▋        | 91/553 [00:01<00:05, 91.43it/s] 18%|█▊        | 101/553 [00:01<00:05, 84.76it/s] 20%|█▉        | 110/553 [00:01<00:05, 84.37it/s] 22%|██▏       | 119/553 [00:01<00:05, 79.90it/s] 23%|██▎       | 128/553 [00:01<00:05, 77.18it/s] 26%|██▌       | 143/553 [00:01<00:04, 95.66it/s] 29%|██▉       | 159/553 [00:01<00:03, 110.99it/s] 31%|███▏      | 174/553 [00:01<00:03, 119.85it/s] 34%|███▍      | 188/553 [00:01<00:02, 124.02it/s] 37%|███▋      | 202/553 [00:02<00:02, 126.20it/s] 39%|███▉      | 215/553 [00:02<00:03, 108.47it/s] 41%|████      | 227/553 [00:02<00:03, 103.87it/s] 43%|████▎     | 240/553 [00:02<00:02, 109.08it/s] 46%|████▌     | 252/553 [00:02<00:02, 108.48it/s] 48%|████▊     | 265/553 [00:02<00:02, 111.87it/s] 50%|█████     | 277/553 [00:02<00:02, 92.65it/s]  52%|█████▏    | 289/553 [00:02<00:02, 99.21it/s] 54%|█████▍    | 300/553 [00:03<00:02, 96.90it/s] 56%|█████▌    | 311/553 [00:03<00:02, 96.27it/s] 58%|█████▊    | 321/553 [00:03<00:02, 97.23it/s] 60%|█████▉    | 331/553 [00:03<00:02, 94.90it/s] 62%|██████▏   | 345/553 [00:03<00:02, 103.76it/s] 64%|██████▍   | 356/553 [00:03<00:01, 98.78it/s]  66%|██████▌   | 366/553 [00:03<00:01, 95.02it/s] 68%|██████▊   | 377/553 [00:03<00:01, 93.95it/s] 70%|██████▉   | 387/553 [00:03<00:01, 93.30it/s] 72%|███████▏  | 397/553 [00:04<00:01, 85.81it/s] 75%|███████▍  | 412/553 [00:04<00:01, 97.54it/s] 76%|███████▋  | 422/553 [00:04<00:01, 93.21it/s] 78%|███████▊  | 432/553 [00:04<00:01, 87.26it/s] 82%|████████▏ | 451/553 [00:04<00:00, 111.03it/s] 84%|████████▎ | 463/553 [00:04<00:00, 108.82it/s] 86%|████████▌ | 475/553 [00:04<00:00, 107.60it/s] 88%|████████▊ | 486/553 [00:04<00:00, 106.31it/s] 90%|████████▉ | 497/553 [00:05<00:00, 99.64it/s]  92%|█████████▏| 508/553 [00:05<00:00, 100.76it/s] 94%|█████████▍| 519/553 [00:05<00:00, 81.14it/s]  95%|█████████▌| 528/553 [00:05<00:00, 72.14it/s] 98%|█████████▊| 540/553 [00:05<00:00, 82.78it/s]100%|█████████▉| 551/553 [00:05<00:00, 80.34it/s]100%|██████████| 553/553 [00:05<00:00, 94.98it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 299.53it/s]extract the null data:  65%|██████▌   | 91/139 [00:00<00:00, 477.82it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 498.20it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 208.33it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 139.55it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 150.43it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 165.84it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 178.07it/s]replace nan value:  87%|████████▋ | 121/139 [00:00<00:00, 186.07it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 177.12it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.36it/s] 17%|█▋        | 24/139 [00:00<00:00, 116.39it/s] 29%|██▉       | 41/139 [00:00<00:00, 139.49it/s] 40%|███▉      | 55/139 [00:00<00:00, 133.75it/s] 50%|████▉     | 69/139 [00:00<00:00, 129.42it/s] 59%|█████▉    | 82/139 [00:00<00:00, 128.89it/s] 68%|██████▊   | 95/139 [00:00<00:00, 121.95it/s] 78%|███████▊  | 108/139 [00:00<00:00, 121.85it/s] 87%|████████▋ | 121/139 [00:00<00:00, 114.36it/s] 96%|█████████▌| 133/139 [00:01<00:00, 89.74it/s] 100%|██████████| 139/139 [00:01<00:00, 111.64it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 286.70it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 485.57it/s]extract the null data:  88%|████████▊ | 153/173 [00:00<00:00, 539.80it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 513.34it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 205.02it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 205.59it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 203.49it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 202.23it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 202.41it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 199.36it/s]replace nan value:  84%|████████▍ | 146/173 [00:00<00:00, 199.10it/s]replace nan value:  96%|█████████▌| 166/173 [00:00<00:00, 195.31it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 199.05it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.72it/s] 16%|█▌        | 28/173 [00:00<00:01, 113.05it/s] 24%|██▍       | 42/173 [00:00<00:01, 122.79it/s] 32%|███▏      | 56/173 [00:00<00:00, 128.80it/s] 40%|████      | 70/173 [00:00<00:00, 127.09it/s] 49%|████▊     | 84/173 [00:00<00:00, 126.04it/s] 57%|█████▋    | 98/173 [00:00<00:00, 127.96it/s] 65%|██████▌   | 113/173 [00:00<00:00, 133.83it/s] 73%|███████▎  | 127/173 [00:00<00:00, 132.02it/s] 82%|████████▏ | 142/173 [00:01<00:00, 136.54it/s] 90%|█████████ | 156/173 [00:01<00:00, 124.49it/s] 98%|█████████▊| 169/173 [00:01<00:00, 103.96it/s]100%|██████████| 173/173 [00:01<00:00, 113.89it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.117, train f1 : 0.716, valid f1 : 0.633
training process - Deferred Re-weighting:   1%|          | 1/128 [01:36<3:24:22, 96.55s/it]Best score increase :0.000 -> 0.633
training process - Deferred Re-weighting:   2%|▏         | 2/128 [03:03<3:10:38, 90.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [04:13<2:49:30, 81.36s/it]Best score increase :0.633 -> 0.661
training process - Deferred Re-weighting:   3%|▎         | 4/128 [05:21<2:37:23, 76.15s/it]Best score increase :0.661 -> 0.674
epoch : 5, train loss : 0.098, valid loss : 0.100, train f1 : 0.831, valid f1 : 0.695
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:45<2:41:40, 78.86s/it]Best score increase :0.674 -> 0.695
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:59<2:37:24, 77.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [09:19<2:37:25, 78.06s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [10:30<2:31:44, 75.87s/it]Best score increase :0.695 -> 0.727
epoch : 9, train loss : 0.085, valid loss : 0.087, train f1 : 0.859, valid f1 : 0.712
training process - Deferred Re-weighting:   7%|▋         | 9/128 [11:40<2:26:34, 73.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [12:39<2:16:34, 69.45s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [13:27<2:02:43, 62.94s/it]Best score increase :0.727 -> 0.730
training process - Deferred Re-weighting:   9%|▉         | 12/128 [14:27<1:59:45, 61.95s/it]Best score increase :0.730 -> 0.739
epoch : 13, train loss : 0.072, valid loss : 0.082, train f1 : 0.883, valid f1 : 0.722
training process - Deferred Re-weighting:  10%|█         | 13/128 [15:33<2:01:11, 63.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [16:24<1:52:48, 59.37s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [17:31<1:56:12, 61.71s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [18:24<1:50:34, 59.24s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.063, valid loss : 0.082, train f1 : 0.903, valid f1 : 0.724
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [19:40<1:58:51, 64.25s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [20:31<1:50:19, 60.18s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [21:37<1:52:38, 62.01s/it]Best score increase :0.739 -> 0.740
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [22:37<1:50:27, 61.36s/it]Best score increase :0.740 -> 0.760
epoch : 21, train loss : 0.057, valid loss : 0.075, train f1 : 0.914, valid f1 : 0.750
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [23:47<1:54:01, 63.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [24:35<1:44:50, 59.35s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [25:25<1:38:37, 56.36s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [26:17<1:35:26, 55.06s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.050, valid loss : 0.070, train f1 : 0.927, valid f1 : 0.745
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [27:16<1:36:44, 56.35s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [28:06<1:32:13, 54.25s/it]Best score increase :0.760 -> 0.776
training process - Deferred Re-weighting:  21%|██        | 27/128 [28:56<1:29:08, 52.95s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [29:51<1:29:41, 53.82s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.047, valid loss : 0.075, train f1 : 0.931, valid f1 : 0.759
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [30:55<1:33:42, 56.79s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [31:48<1:30:51, 55.62s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [32:34<1:25:22, 52.80s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [33:22<1:21:57, 51.22s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.043, valid loss : 0.077, train f1 : 0.937, valid f1 : 0.757
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [34:20<1:24:40, 53.48s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [35:08<1:21:11, 51.83s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:54<1:17:17, 49.87s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:41<1:15:10, 49.03s/it]Best score increase :0.776 -> 0.780
epoch : 37, train loss : 0.040, valid loss : 0.095, train f1 : 0.939, valid f1 : 0.737
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [37:36<1:17:11, 50.90s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [38:36<1:20:15, 53.50s/it]Best score increase :0.780 -> 0.784
training process - Deferred Re-weighting:  30%|███       | 39/128 [39:27<1:18:15, 52.75s/it]Best score increase :0.784 -> 0.802
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [40:13<1:14:24, 50.73s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.038, valid loss : 0.074, train f1 : 0.945, valid f1 : 0.776
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [41:09<1:16:05, 52.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [41:59<1:13:51, 51.53s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [42:51<1:13:17, 51.74s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [43:39<1:10:45, 50.54s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.037, valid loss : 0.091, train f1 : 0.945, valid f1 : 0.746
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [44:35<1:12:16, 52.24s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [45:22<1:09:15, 50.68s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [46:09<1:06:50, 49.51s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:56<1:05:15, 48.95s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.034, valid loss : 0.095, train f1 : 0.951, valid f1 : 0.758
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [48:06<1:12:36, 55.14s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [49:06<1:13:28, 56.52s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [49:57<1:17:55, 59.94s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 50, best f1 score : 0.802
training process finished, best loss : 0.062, best acc : 0.927, best f1 : 0.802, best epoch : 38

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.58      0.76      0.66       580
           1       0.98      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.86      0.81      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.86, test loss : 3.123

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:50, 10.07s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:41, 10.12s/it]processing for feature importance:  25%|██▌       | 3/12 [00:29<01:29,  9.91s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:13,  9.24s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:03,  9.10s/it]processing for feature importance:  50%|█████     | 6/12 [00:57<00:58,  9.74s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:07<00:49,  9.81s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:15<00:37,  9.25s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:23<00:26,  8.80s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:31<00:17,  8.53s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:38<00:08,  8.16s/it]processing for feature importance: 100%|██████████| 12/12 [01:46<00:00,  7.89s/it]processing for feature importance: 100%|██████████| 12/12 [01:46<00:00,  8.86s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|▉         | 30/306 [00:00<00:00, 287.02it/s] 19%|█▉        | 59/306 [00:00<00:00, 277.32it/s] 28%|██▊       | 87/306 [00:00<00:00, 277.26it/s] 38%|███▊      | 115/306 [00:00<00:00, 273.90it/s] 47%|████▋     | 143/306 [00:00<00:00, 271.24it/s] 56%|█████▌    | 172/306 [00:00<00:00, 275.77it/s] 65%|██████▌   | 200/306 [00:00<00:00, 274.47it/s] 75%|███████▍  | 229/306 [00:00<00:00, 276.62it/s] 84%|████████▍ | 257/306 [00:00<00:00, 273.10it/s] 93%|█████████▎| 285/306 [00:01<00:00, 272.99it/s]100%|██████████| 306/306 [00:01<00:00, 274.20it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 449.09it/s]extract the null data:  16%|█▋        | 90/553 [00:00<00:01, 445.98it/s]extract the null data:  24%|██▍       | 135/553 [00:00<00:00, 442.63it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 456.64it/s]extract the null data:  41%|████▏     | 229/553 [00:00<00:00, 457.83it/s]extract the null data:  50%|████▉     | 276/553 [00:00<00:00, 460.17it/s]extract the null data:  59%|█████▊    | 324/553 [00:00<00:00, 464.03it/s]extract the null data:  67%|██████▋   | 373/553 [00:00<00:00, 470.23it/s]extract the null data:  76%|███████▌  | 421/553 [00:00<00:00, 467.97it/s]extract the null data:  85%|████████▍ | 468/553 [00:01<00:00, 466.13it/s]extract the null data:  93%|█████████▎| 515/553 [00:01<00:00, 467.07it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 462.43it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 170.25it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 173.80it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 176.44it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 179.58it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 180.51it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 179.64it/s]replace nan value:  23%|██▎       | 129/553 [00:00<00:02, 178.78it/s]replace nan value:  27%|██▋       | 147/553 [00:00<00:02, 177.61it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:02, 176.38it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 176.22it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 178.04it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 177.59it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 177.29it/s]replace nan value:  46%|████▋     | 256/553 [00:01<00:01, 176.17it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 176.58it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 176.65it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 170.35it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 170.08it/s]replace nan value:  63%|██████▎   | 346/553 [00:01<00:01, 170.23it/s]replace nan value:  66%|██████▌   | 364/553 [00:02<00:01, 172.08it/s]replace nan value:  69%|██████▉   | 382/553 [00:02<00:01, 169.81it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 168.46it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 168.23it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 167.70it/s]replace nan value:  82%|████████▏ | 452/553 [00:02<00:00, 170.19it/s]replace nan value:  85%|████████▍ | 470/553 [00:02<00:00, 168.52it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 170.42it/s]replace nan value:  92%|█████████▏| 506/553 [00:02<00:00, 169.98it/s]replace nan value:  95%|█████████▍| 524/553 [00:03<00:00, 169.59it/s]replace nan value:  98%|█████████▊| 541/553 [00:03<00:00, 167.94it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 172.81it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.43it/s]  5%|▌         | 28/553 [00:00<00:03, 135.40it/s]  8%|▊         | 42/553 [00:00<00:03, 130.29it/s] 10%|█         | 56/553 [00:00<00:04, 122.16it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.66it/s] 15%|█▌        | 84/553 [00:00<00:03, 120.96it/s] 18%|█▊        | 97/553 [00:00<00:03, 121.90it/s] 20%|██        | 112/553 [00:00<00:03, 128.52it/s] 23%|██▎       | 125/553 [00:01<00:03, 126.74it/s] 26%|██▌       | 142/553 [00:01<00:02, 137.12it/s] 29%|██▉       | 160/553 [00:01<00:02, 147.93it/s] 32%|███▏      | 175/553 [00:01<00:02, 146.68it/s] 34%|███▍      | 190/553 [00:01<00:02, 147.48it/s] 37%|███▋      | 207/553 [00:01<00:02, 152.87it/s] 40%|████      | 223/553 [00:01<00:02, 142.34it/s] 43%|████▎     | 239/553 [00:01<00:02, 145.26it/s] 46%|████▌     | 254/553 [00:01<00:02, 137.75it/s] 49%|████▊     | 269/553 [00:01<00:02, 138.30it/s] 51%|█████     | 283/553 [00:02<00:02, 133.90it/s] 54%|█████▎    | 297/553 [00:02<00:01, 129.32it/s] 56%|█████▌    | 311/553 [00:02<00:01, 128.06it/s] 59%|█████▉    | 325/553 [00:02<00:01, 129.52it/s] 61%|██████    | 338/553 [00:02<00:01, 129.39it/s] 63%|██████▎   | 351/553 [00:02<00:01, 127.94it/s] 66%|██████▌   | 364/553 [00:02<00:01, 123.99it/s] 68%|██████▊   | 378/553 [00:02<00:01, 126.65it/s] 71%|███████   | 391/553 [00:02<00:01, 116.81it/s] 73%|███████▎  | 403/553 [00:03<00:01, 115.21it/s] 75%|███████▌  | 415/553 [00:03<00:01, 110.15it/s] 77%|███████▋  | 427/553 [00:03<00:01, 105.39it/s] 80%|████████  | 443/553 [00:03<00:00, 118.38it/s] 83%|████████▎ | 458/553 [00:03<00:00, 126.06it/s] 85%|████████▌ | 472/553 [00:03<00:00, 129.83it/s] 88%|████████▊ | 486/553 [00:03<00:00, 128.20it/s] 90%|█████████ | 499/553 [00:03<00:00, 120.01it/s] 93%|█████████▎| 513/553 [00:03<00:00, 125.11it/s] 95%|█████████▌| 526/553 [00:04<00:00, 112.49it/s] 97%|█████████▋| 538/553 [00:04<00:00, 109.32it/s]100%|█████████▉| 551/553 [00:04<00:00, 99.21it/s] 100%|██████████| 553/553 [00:04<00:00, 124.87it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 257.43it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 422.27it/s]extract the null data:  97%|█████████▋| 135/139 [00:00<00:00, 478.03it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 447.57it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 183.12it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 191.21it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 183.23it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 175.68it/s]replace nan value:  71%|███████   | 98/139 [00:00<00:00, 181.85it/s]replace nan value:  84%|████████▍ | 117/139 [00:00<00:00, 174.70it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 179.94it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 180.32it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.79it/s] 17%|█▋        | 24/139 [00:00<00:00, 119.69it/s] 27%|██▋       | 38/139 [00:00<00:00, 125.80it/s] 37%|███▋      | 51/139 [00:00<00:00, 121.34it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.09it/s] 55%|█████▌    | 77/139 [00:00<00:00, 118.35it/s] 64%|██████▍   | 89/139 [00:00<00:00, 108.41it/s] 74%|███████▍  | 103/139 [00:00<00:00, 116.25it/s] 83%|████████▎ | 115/139 [00:00<00:00, 116.94it/s] 92%|█████████▏| 128/139 [00:01<00:00, 119.51it/s]100%|██████████| 139/139 [00:01<00:00, 118.79it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 33/173 [00:00<00:00, 329.25it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 454.58it/s]extract the null data:  82%|████████▏ | 142/173 [00:00<00:00, 491.04it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 475.64it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 182.03it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 185.66it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 188.37it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 191.19it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 189.38it/s]replace nan value:  68%|██████▊   | 117/173 [00:00<00:00, 188.60it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 186.18it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 185.65it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 185.99it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.70it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.20it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.75it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.37it/s] 40%|███▉      | 69/173 [00:00<00:00, 131.45it/s] 49%|████▊     | 84/173 [00:00<00:00, 135.30it/s] 57%|█████▋    | 99/173 [00:00<00:00, 138.95it/s] 67%|██████▋   | 116/173 [00:00<00:00, 144.29it/s] 76%|███████▌  | 131/173 [00:00<00:00, 135.91it/s] 84%|████████▍ | 145/173 [00:01<00:00, 136.32it/s] 92%|█████████▏| 159/173 [00:01<00:00, 125.33it/s] 99%|█████████▉| 172/173 [00:01<00:00, 96.22it/s] 100%|██████████| 173/173 [00:01<00:00, 119.77it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.008, train acc : 0.728, valid acc : 0.922, train f1 : 0.531, valid f1 : 0.602
training process:   1%|          | 1/128 [01:29<3:10:10, 89.85s/it]Best score increase :0.000 -> 0.602
training process:   2%|▏         | 2/128 [02:31<2:33:40, 73.18s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:47<2:34:59, 74.40s/it]Best score increase :0.602 -> 0.632
training process:   3%|▎         | 4/128 [04:57<2:30:46, 72.95s/it]Best score increase :0.632 -> 0.657
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.936, valid acc : 0.933, train f1 : 0.692, valid f1 : 0.679
training process:   4%|▍         | 5/128 [06:20<2:36:35, 76.39s/it]Best score increase :0.657 -> 0.679
training process:   5%|▍         | 6/128 [07:30<2:31:07, 74.33s/it]Best score increase :0.679 -> 0.710
training process:   5%|▌         | 7/128 [08:43<2:29:02, 73.90s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:46<2:20:32, 70.27s/it]Best score increase :0.710 -> 0.720
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.942, valid acc : 0.937, train f1 : 0.735, valid f1 : 0.725
training process:   7%|▋         | 9/128 [11:01<2:22:31, 71.86s/it]Best score increase :0.720 -> 0.725
training process:   8%|▊         | 10/128 [12:05<2:16:39, 69.48s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [13:26<2:22:27, 73.05s/it]Best score increase :0.725 -> 0.737
training process:   9%|▉         | 12/128 [14:28<2:14:11, 69.41s/it]Best score increase :0.737 -> 0.740
epoch : 13, train loss : 0.003, valid loss : 0.003, train acc : 0.945, valid acc : 0.936, train f1 : 0.760, valid f1 : 0.716
training process:  10%|█         | 13/128 [15:50<2:20:52, 73.50s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [16:57<2:15:46, 71.46s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [18:06<2:13:00, 70.62s/it]Best score increase :0.740 -> 0.751
training process:  12%|█▎        | 16/128 [19:10<2:08:10, 68.67s/it]Best score increase :0.751 -> 0.760
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.949, valid acc : 0.943, train f1 : 0.781, valid f1 : 0.764
training process:  13%|█▎        | 17/128 [20:29<2:12:41, 71.72s/it]Best score increase :0.760 -> 0.764
training process:  14%|█▍        | 18/128 [21:48<2:15:52, 74.11s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [22:49<2:07:05, 69.96s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [24:03<2:08:21, 71.31s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train acc : 0.953, valid acc : 0.945, train f1 : 0.804, valid f1 : 0.781
training process:  16%|█▋        | 21/128 [25:16<2:07:59, 71.77s/it]Best score increase :0.764 -> 0.781
training process:  17%|█▋        | 22/128 [26:29<2:07:22, 72.10s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [27:39<2:05:11, 71.54s/it]Best score increase :0.781 -> 0.785
training process:  19%|█▉        | 24/128 [29:00<2:08:53, 74.36s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.955, valid acc : 0.948, train f1 : 0.816, valid f1 : 0.796
training process:  20%|█▉        | 25/128 [30:29<2:14:55, 78.59s/it]Best score increase :0.785 -> 0.796
training process:  20%|██        | 26/128 [31:43<2:11:35, 77.40s/it]Best score increase :0.796 -> 0.797
training process:  21%|██        | 27/128 [32:49<2:04:20, 73.87s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [33:57<2:00:18, 72.18s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.959, valid acc : 0.949, train f1 : 0.833, valid f1 : 0.799
training process:  23%|██▎       | 29/128 [35:22<2:05:25, 76.01s/it]Best score increase :0.797 -> 0.799
training process:  23%|██▎       | 30/128 [36:33<2:01:45, 74.54s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [37:48<2:00:52, 74.77s/it]Best score increase :0.799 -> 0.807
training process:  25%|██▌       | 32/128 [39:05<2:00:41, 75.43s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.951, train f1 : 0.842, valid f1 : 0.809
training process:  26%|██▌       | 33/128 [40:29<2:03:21, 77.91s/it]Best score increase :0.807 -> 0.809
training process:  27%|██▋       | 34/128 [41:41<1:59:11, 76.08s/it]Best score increase :0.809 -> 0.819
training process:  27%|██▋       | 35/128 [42:57<1:58:06, 76.20s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [44:16<1:57:43, 76.78s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.962, valid acc : 0.952, train f1 : 0.851, valid f1 : 0.820
training process:  29%|██▉       | 37/128 [45:38<1:59:12, 78.60s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [46:51<1:55:19, 76.88s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [48:06<1:53:11, 76.31s/it]Best score increase :0.819 -> 0.830
training process:  31%|███▏      | 40/128 [49:21<1:51:23, 75.95s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.964, valid acc : 0.951, train f1 : 0.861, valid f1 : 0.805
training process:  32%|███▏      | 41/128 [50:46<1:53:54, 78.56s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [51:56<1:48:49, 75.92s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [53:10<1:46:49, 75.40s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [54:25<1:45:16, 75.19s/it]Best score increase :0.830 -> 0.838
epoch : 45, train loss : 0.002, valid loss : 0.002, train acc : 0.964, valid acc : 0.955, train f1 : 0.862, valid f1 : 0.834
training process:  35%|███▌      | 45/128 [55:53<1:49:24, 79.10s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [57:16<1:49:33, 80.17s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [58:34<1:47:28, 79.61s/it]Best score increase :0.838 -> 0.845
training process:  38%|███▊      | 48/128 [59:42<1:41:31, 76.14s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.966, valid acc : 0.955, train f1 : 0.871, valid f1 : 0.832
training process:  38%|███▊      | 49/128 [1:01:03<1:42:24, 77.77s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [1:02:14<1:38:14, 75.57s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [1:03:16<1:31:47, 71.53s/it]EarlyStopping counter : 4 out of 12
training process:  41%|████      | 52/128 [1:04:16<1:26:15, 68.10s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.958, train f1 : 0.876, valid f1 : 0.851
training process:  41%|████▏     | 53/128 [1:05:26<1:25:53, 68.72s/it]Best score increase :0.845 -> 0.851
training process:  42%|████▏     | 54/128 [1:06:29<1:22:22, 66.80s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [1:07:31<1:19:40, 65.49s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [1:08:31<1:16:41, 63.90s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.955, train f1 : 0.878, valid f1 : 0.834
training process:  45%|████▍     | 57/128 [1:09:42<1:18:08, 66.04s/it]EarlyStopping counter : 4 out of 12
training process:  45%|████▌     | 58/128 [1:10:44<1:15:38, 64.83s/it]EarlyStopping counter : 5 out of 12
training process:  46%|████▌     | 59/128 [1:12:06<1:20:23, 69.90s/it]EarlyStopping counter : 6 out of 12
training process:  47%|████▋     | 60/128 [1:13:18<1:20:04, 70.65s/it]EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.956, train f1 : 0.882, valid f1 : 0.844
training process:  48%|████▊     | 61/128 [1:14:49<1:25:42, 76.76s/it]EarlyStopping counter : 8 out of 12
training process:  48%|████▊     | 62/128 [1:15:54<1:20:28, 73.16s/it]EarlyStopping counter : 9 out of 12
training process:  49%|████▉     | 63/128 [1:16:43<1:11:28, 65.98s/it]EarlyStopping counter : 10 out of 12
training process:  50%|█████     | 64/128 [1:17:32<1:04:57, 60.91s/it]EarlyStopping counter : 11 out of 12
epoch : 65, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.956, train f1 : 0.886, valid f1 : 0.841
training process:  50%|█████     | 64/128 [1:18:31<1:18:31, 73.62s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 64, best f1 score : 0.852
training process finished, best loss : 0.003 and best acc : 0.959, best f1 : 0.852, best epoch : 61

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.81      0.62      0.70       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.89      0.80      0.84      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.80, test loss : 0.205

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:31,  8.35s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.70s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.45s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.31s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:53,  7.59s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.53s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:36,  7.35s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:28,  7.11s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:21,  7.12s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:14,  7.45s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.69s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.67s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.51s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 14%|█▎        | 42/306 [00:00<00:00, 413.10it/s] 27%|██▋       | 84/306 [00:00<00:00, 381.80it/s] 40%|████      | 123/306 [00:00<00:00, 369.02it/s] 53%|█████▎    | 161/306 [00:00<00:00, 369.97it/s] 65%|██████▌   | 199/306 [00:00<00:00, 362.99it/s] 78%|███████▊  | 238/306 [00:00<00:00, 371.69it/s] 91%|█████████ | 279/306 [00:00<00:00, 383.18it/s]100%|██████████| 306/306 [00:00<00:00, 380.69it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 64/553 [00:00<00:00, 632.87it/s]extract the null data:  24%|██▎       | 131/553 [00:00<00:00, 649.03it/s]extract the null data:  35%|███▌      | 196/553 [00:00<00:00, 638.64it/s]extract the null data:  47%|████▋     | 262/553 [00:00<00:00, 644.36it/s]extract the null data:  59%|█████▉    | 328/553 [00:00<00:00, 649.74it/s]extract the null data:  71%|███████   | 393/553 [00:00<00:00, 641.56it/s]extract the null data:  83%|████████▎ | 458/553 [00:00<00:00, 640.55it/s]extract the null data:  95%|█████████▍| 523/553 [00:00<00:00, 643.43it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 640.89it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 194.09it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 200.99it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 203.61it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 207.53it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 206.35it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 210.53it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:01, 213.37it/s]replace nan value:  31%|███       | 171/553 [00:00<00:01, 206.06it/s]replace nan value:  35%|███▍      | 193/553 [00:00<00:01, 208.66it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 216.89it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 215.61it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 204.92it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 204.38it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 204.14it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 204.33it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:00, 212.86it/s]replace nan value:  67%|██████▋   | 372/553 [00:01<00:00, 220.31it/s]replace nan value:  72%|███████▏  | 397/553 [00:01<00:00, 226.10it/s]replace nan value:  76%|███████▌  | 421/553 [00:01<00:00, 228.15it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 224.11it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 224.67it/s]replace nan value:  89%|████████▊ | 490/553 [00:02<00:00, 225.17it/s]replace nan value:  93%|█████████▎| 513/553 [00:02<00:00, 226.22it/s]replace nan value:  97%|█████████▋| 536/553 [00:02<00:00, 220.17it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 213.86it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.66it/s]  6%|▌         | 31/553 [00:00<00:03, 150.54it/s]  8%|▊         | 47/553 [00:00<00:03, 130.04it/s] 11%|█         | 61/553 [00:00<00:03, 127.79it/s] 14%|█▍        | 77/553 [00:00<00:03, 135.20it/s] 17%|█▋        | 92/553 [00:00<00:03, 139.77it/s] 19%|█▉        | 107/553 [00:00<00:03, 142.47it/s] 22%|██▏       | 122/553 [00:00<00:03, 143.18it/s] 25%|██▌       | 140/553 [00:00<00:02, 151.90it/s] 29%|██▉       | 160/553 [00:01<00:02, 163.61it/s] 32%|███▏      | 177/553 [00:01<00:02, 163.36it/s] 35%|███▌      | 194/553 [00:01<00:02, 164.86it/s] 39%|███▊      | 213/553 [00:01<00:01, 170.12it/s] 42%|████▏     | 231/553 [00:01<00:02, 156.53it/s] 45%|████▌     | 249/553 [00:01<00:01, 157.90it/s] 48%|████▊     | 265/553 [00:01<00:01, 156.89it/s] 51%|█████     | 281/553 [00:01<00:01, 151.92it/s] 54%|█████▎    | 297/553 [00:01<00:01, 140.84it/s] 56%|█████▋    | 312/553 [00:02<00:01, 138.96it/s] 59%|█████▉    | 327/553 [00:02<00:01, 141.31it/s] 62%|██████▏   | 344/553 [00:02<00:01, 149.15it/s] 65%|██████▌   | 360/553 [00:02<00:01, 138.36it/s] 68%|██████▊   | 378/553 [00:02<00:01, 147.82it/s] 71%|███████   | 394/553 [00:02<00:01, 138.18it/s] 74%|███████▍  | 410/553 [00:02<00:01, 142.98it/s] 77%|███████▋  | 425/553 [00:02<00:00, 132.64it/s] 80%|███████▉  | 442/553 [00:03<00:00, 142.32it/s] 84%|████████▎ | 462/553 [00:03<00:00, 155.31it/s] 86%|████████▋ | 478/553 [00:03<00:00, 155.29it/s] 89%|████████▉ | 494/553 [00:03<00:00, 148.25it/s] 92%|█████████▏| 511/553 [00:03<00:00, 153.35it/s] 95%|█████████▌| 527/553 [00:03<00:00, 136.34it/s] 98%|█████████▊| 542/553 [00:03<00:00, 139.17it/s]100%|██████████| 553/553 [00:03<00:00, 144.03it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  34%|███▍      | 47/139 [00:00<00:00, 468.70it/s]extract the null data:  89%|████████▉ | 124/139 [00:00<00:00, 641.63it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 628.01it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 248.59it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 249.23it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 254.96it/s]replace nan value:  76%|███████▋  | 106/139 [00:00<00:00, 266.82it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 265.14it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 262.11it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 136.88it/s] 22%|██▏       | 30/139 [00:00<00:00, 143.39it/s] 34%|███▍      | 47/139 [00:00<00:00, 152.83it/s] 45%|████▌     | 63/139 [00:00<00:00, 147.44it/s] 57%|█████▋    | 79/139 [00:00<00:00, 149.70it/s] 68%|██████▊   | 94/139 [00:00<00:00, 138.85it/s] 78%|███████▊  | 109/139 [00:00<00:00, 139.42it/s] 91%|█████████▏| 127/139 [00:00<00:00, 148.70it/s]100%|██████████| 139/139 [00:00<00:00, 143.14it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 378.78it/s]extract the null data:  61%|██████    | 105/173 [00:00<00:00, 549.18it/s]extract the null data:  99%|█████████▉| 171/173 [00:00<00:00, 597.06it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 567.49it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 236.62it/s]replace nan value:  28%|██▊       | 49/173 [00:00<00:00, 240.34it/s]replace nan value:  43%|████▎     | 74/173 [00:00<00:00, 240.02it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 243.90it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 246.30it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 222.56it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 229.00it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.39it/s] 16%|█▌        | 28/173 [00:00<00:01, 123.12it/s] 25%|██▌       | 44/173 [00:00<00:00, 137.15it/s] 36%|███▋      | 63/173 [00:00<00:00, 154.82it/s] 46%|████▌     | 80/173 [00:00<00:00, 154.74it/s] 56%|█████▌    | 97/173 [00:00<00:00, 157.72it/s] 66%|██████▋   | 115/173 [00:00<00:00, 163.33it/s] 76%|███████▋  | 132/173 [00:00<00:00, 153.34it/s] 86%|████████▌ | 148/173 [00:00<00:00, 153.32it/s] 95%|█████████▍| 164/173 [00:01<00:00, 138.70it/s]100%|██████████| 173/173 [00:01<00:00, 135.32it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.010, train acc : 0.708, valid acc : 0.729, train f1 : 0.705, valid f1 : 0.575
training process:   1%|          | 1/128 [00:56<1:59:31, 56.47s/it]Best score increase :0.000 -> 0.575
training process:   2%|▏         | 2/128 [01:42<1:46:02, 50.50s/it]Best score increase :0.575 -> 0.611
training process:   2%|▏         | 3/128 [02:31<1:43:29, 49.68s/it]Best score increase :0.611 -> 0.648
training process:   3%|▎         | 4/128 [03:20<1:42:24, 49.55s/it]Best score increase :0.648 -> 0.651
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.821, valid acc : 0.839, train f1 : 0.821, valid f1 : 0.681
training process:   4%|▍         | 5/128 [04:17<1:46:59, 52.19s/it]Best score increase :0.651 -> 0.681
training process:   5%|▍         | 6/128 [05:05<1:43:11, 50.75s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [05:57<1:43:03, 51.11s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [06:45<1:40:23, 50.20s/it]Best score increase :0.681 -> 0.711
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.840, valid acc : 0.846, train f1 : 0.840, valid f1 : 0.689
training process:   7%|▋         | 9/128 [07:43<1:44:13, 52.55s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:40<1:46:17, 54.05s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:30<1:42:42, 52.67s/it]Best score increase :0.711 -> 0.712
training process:   9%|▉         | 12/128 [10:19<1:39:37, 51.53s/it]Best score increase :0.712 -> 0.719
epoch : 13, train loss : 0.006, valid loss : 0.006, train acc : 0.873, valid acc : 0.853, train f1 : 0.873, valid f1 : 0.697
training process:  10%|█         | 13/128 [11:15<1:41:41, 53.06s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:06<1:39:10, 52.20s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [12:55<1:36:58, 51.49s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [13:47<1:35:51, 51.36s/it]Best score increase :0.719 -> 0.732
epoch : 17, train loss : 0.005, valid loss : 0.006, train acc : 0.898, valid acc : 0.857, train f1 : 0.898, valid f1 : 0.708
training process:  13%|█▎        | 17/128 [14:49<1:41:08, 54.67s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:46<1:41:45, 55.51s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [16:49<1:44:57, 57.78s/it]Best score increase :0.732 -> 0.736
training process:  16%|█▌        | 20/128 [17:44<1:42:14, 56.80s/it]Best score increase :0.736 -> 0.756
epoch : 21, train loss : 0.005, valid loss : 0.006, train acc : 0.906, valid acc : 0.871, train f1 : 0.906, valid f1 : 0.726
training process:  16%|█▋        | 21/128 [18:44<1:43:01, 57.78s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:38<1:39:56, 56.57s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:27<1:35:04, 54.33s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:17<1:32:07, 53.15s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.005, train acc : 0.917, valid acc : 0.884, train f1 : 0.917, valid f1 : 0.739
training process:  20%|█▉        | 25/128 [22:15<1:33:26, 54.43s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [23:06<1:30:43, 53.37s/it]Best score increase :0.756 -> 0.776
training process:  21%|██        | 27/128 [23:56<1:28:33, 52.61s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:47<1:26:54, 52.14s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.005, train acc : 0.921, valid acc : 0.892, train f1 : 0.921, valid f1 : 0.754
training process:  23%|██▎       | 29/128 [25:46<1:29:01, 53.96s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [26:34<1:25:19, 52.24s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [27:23<1:23:09, 51.44s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [28:12<1:20:43, 50.45s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.005, train acc : 0.927, valid acc : 0.891, train f1 : 0.927, valid f1 : 0.752
training process:  26%|██▌       | 33/128 [29:10<1:23:47, 52.92s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [29:59<1:20:59, 51.70s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [30:56<1:22:29, 53.23s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [31:47<1:20:32, 52.53s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.006, train acc : 0.933, valid acc : 0.881, train f1 : 0.933, valid f1 : 0.742
training process:  29%|██▉       | 37/128 [32:44<1:21:51, 53.98s/it]EarlyStopping counter : 11 out of 12
training process:  29%|██▉       | 37/128 [33:32<1:22:29, 54.40s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.776
training process finished, best loss : 0.004 and best acc : 0.910, best f1 : 0.776, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.52      0.79      0.63       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.86      0.80      7398
weighted avg       0.95      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.86, test loss : 0.233

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:06<01:13,  6.70s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:11,  7.16s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:04,  7.11s/it]processing for feature importance:  33%|███▎      | 4/12 [00:28<00:57,  7.17s/it]processing for feature importance:  42%|████▏     | 5/12 [00:35<00:49,  7.07s/it]processing for feature importance:  50%|█████     | 6/12 [00:42<00:43,  7.21s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:49<00:35,  7.17s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:57<00:28,  7.15s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:04<00:21,  7.12s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:11<00:14,  7.18s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:18<00:07,  7.14s/it]processing for feature importance: 100%|██████████| 12/12 [01:25<00:00,  7.08s/it]processing for feature importance: 100%|██████████| 12/12 [01:25<00:00,  7.12s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 23/306 [00:00<00:01, 222.92it/s] 15%|█▌        | 46/306 [00:00<00:01, 226.64it/s] 23%|██▎       | 69/306 [00:00<00:01, 206.87it/s] 30%|███       | 93/306 [00:00<00:00, 216.87it/s] 38%|███▊      | 117/306 [00:00<00:00, 223.43it/s] 46%|████▌     | 140/306 [00:00<00:00, 224.96it/s] 53%|█████▎    | 163/306 [00:00<00:00, 226.08it/s] 61%|██████▏   | 188/306 [00:00<00:00, 231.52it/s] 69%|██████▉   | 212/306 [00:00<00:00, 229.53it/s] 78%|███████▊  | 238/306 [00:01<00:00, 236.73it/s] 86%|████████▌ | 262/306 [00:01<00:00, 236.91it/s] 94%|█████████▍| 287/306 [00:01<00:00, 238.00it/s]100%|██████████| 306/306 [00:01<00:00, 230.35it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 414.87it/s]extract the null data:  16%|█▌        | 89/553 [00:00<00:01, 380.86it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:01, 400.52it/s]extract the null data:  32%|███▏      | 176/553 [00:00<00:00, 414.38it/s]extract the null data:  40%|███▉      | 221/553 [00:00<00:00, 423.30it/s]extract the null data:  48%|████▊     | 265/553 [00:00<00:00, 428.19it/s]extract the null data:  56%|█████▌    | 308/553 [00:00<00:00, 421.65it/s]extract the null data:  64%|██████▍   | 353/553 [00:00<00:00, 430.27it/s]extract the null data:  72%|███████▏  | 397/553 [00:00<00:00, 417.44it/s]extract the null data:  79%|███████▉  | 439/553 [00:01<00:00, 405.97it/s]extract the null data:  88%|████████▊ | 487/553 [00:01<00:00, 427.34it/s]extract the null data:  96%|█████████▌| 531/553 [00:01<00:00, 429.72it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 420.37it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 149.69it/s]replace nan value:   6%|▌         | 31/553 [00:00<00:03, 154.47it/s]replace nan value:   8%|▊         | 47/553 [00:00<00:03, 152.70it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:03, 155.01it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:03, 157.57it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:02, 160.41it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 158.97it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 159.20it/s]replace nan value:  27%|██▋       | 147/553 [00:00<00:02, 160.26it/s]replace nan value:  30%|██▉       | 164/553 [00:01<00:02, 159.63it/s]replace nan value:  33%|███▎      | 180/553 [00:01<00:02, 156.22it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 158.56it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:02, 154.85it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:02, 149.80it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:02, 139.77it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:02, 143.24it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 148.96it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 154.30it/s]replace nan value:  56%|█████▌    | 311/553 [00:02<00:01, 155.46it/s]replace nan value:  59%|█████▉    | 328/553 [00:02<00:01, 158.55it/s]replace nan value:  62%|██████▏   | 345/553 [00:02<00:01, 160.53it/s]replace nan value:  65%|██████▌   | 362/553 [00:02<00:01, 160.84it/s]replace nan value:  69%|██████▊   | 380/553 [00:02<00:01, 163.73it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 166.01it/s]replace nan value:  75%|███████▌  | 416/553 [00:02<00:00, 167.63it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 162.12it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 158.80it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 156.15it/s]replace nan value:  87%|████████▋ | 482/553 [00:03<00:00, 150.95it/s]replace nan value:  90%|█████████ | 498/553 [00:03<00:00, 151.04it/s]replace nan value:  93%|█████████▎| 514/553 [00:03<00:00, 150.33it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 150.50it/s]replace nan value:  99%|█████████▊| 546/553 [00:03<00:00, 150.73it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 154.96it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 9/553 [00:00<00:06, 87.35it/s]  4%|▎         | 20/553 [00:00<00:05, 96.55it/s]  5%|▌         | 30/553 [00:00<00:05, 92.06it/s]  7%|▋         | 40/553 [00:00<00:05, 94.39it/s]  9%|▉         | 50/553 [00:00<00:05, 92.91it/s] 11%|█         | 60/553 [00:00<00:05, 89.60it/s] 13%|█▎        | 72/553 [00:00<00:04, 97.45it/s] 15%|█▌        | 85/553 [00:00<00:04, 106.13it/s] 18%|█▊        | 97/553 [00:00<00:04, 108.79it/s] 20%|█▉        | 110/553 [00:01<00:03, 114.45it/s] 22%|██▏       | 124/553 [00:01<00:03, 119.43it/s] 25%|██▍       | 138/553 [00:01<00:03, 124.08it/s] 27%|██▋       | 152/553 [00:01<00:03, 127.14it/s] 30%|███       | 167/553 [00:01<00:02, 132.85it/s] 33%|███▎      | 181/553 [00:01<00:02, 132.03it/s] 35%|███▌      | 196/553 [00:01<00:02, 135.95it/s] 38%|███▊      | 210/553 [00:01<00:02, 131.59it/s] 41%|████      | 224/553 [00:01<00:02, 112.35it/s] 43%|████▎     | 236/553 [00:02<00:02, 114.04it/s] 45%|████▌     | 249/553 [00:02<00:02, 114.85it/s] 48%|████▊     | 264/553 [00:02<00:02, 120.52it/s] 50%|█████     | 277/553 [00:02<00:02, 112.72it/s] 53%|█████▎    | 291/553 [00:02<00:02, 116.71it/s] 55%|█████▍    | 303/553 [00:02<00:02, 114.79it/s] 57%|█████▋    | 315/553 [00:02<00:02, 111.31it/s] 59%|█████▉    | 327/553 [00:02<00:01, 113.12it/s] 61%|██████▏   | 339/553 [00:02<00:01, 112.82it/s] 63%|██████▎   | 351/553 [00:03<00:02, 91.78it/s]  65%|██████▌   | 361/553 [00:03<00:02, 82.27it/s] 67%|██████▋   | 373/553 [00:03<00:02, 89.34it/s] 69%|██████▉   | 384/553 [00:03<00:01, 92.53it/s] 71%|███████   | 394/553 [00:03<00:01, 86.63it/s] 73%|███████▎  | 405/553 [00:03<00:01, 91.65it/s] 75%|███████▌  | 416/553 [00:03<00:01, 94.57it/s] 77%|███████▋  | 426/553 [00:03<00:01, 95.06it/s] 79%|███████▉  | 439/553 [00:04<00:01, 103.41it/s] 82%|████████▏ | 453/553 [00:04<00:00, 106.25it/s] 84%|████████▍ | 464/553 [00:04<00:00, 102.03it/s] 86%|████████▋ | 477/553 [00:04<00:00, 109.19it/s] 88%|████████▊ | 489/553 [00:04<00:00, 106.53it/s] 90%|█████████ | 500/553 [00:04<00:00, 100.20it/s] 93%|█████████▎| 512/553 [00:04<00:00, 104.85it/s] 95%|█████████▍| 523/553 [00:04<00:00, 101.09it/s] 97%|█████████▋| 534/553 [00:05<00:00, 94.07it/s]  99%|█████████▉| 548/553 [00:05<00:00, 105.68it/s]100%|██████████| 553/553 [00:05<00:00, 104.93it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 23/139 [00:00<00:00, 229.33it/s]extract the null data:  51%|█████     | 71/139 [00:00<00:00, 373.73it/s]extract the null data:  85%|████████▍ | 118/139 [00:00<00:00, 415.36it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 391.16it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 175.79it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 174.94it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 173.01it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 170.83it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 165.68it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 163.89it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 165.67it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 167.35it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 103.58it/s] 16%|█▌        | 22/139 [00:00<00:01, 107.22it/s] 26%|██▌       | 36/139 [00:00<00:00, 118.50it/s] 35%|███▍      | 48/139 [00:00<00:00, 118.63it/s] 43%|████▎     | 60/139 [00:00<00:00, 112.73it/s] 52%|█████▏    | 72/139 [00:00<00:00, 115.03it/s] 60%|██████    | 84/139 [00:00<00:00, 108.38it/s] 68%|██████▊   | 95/139 [00:00<00:00, 105.74it/s] 77%|███████▋  | 107/139 [00:00<00:00, 108.50it/s] 88%|████████▊ | 122/139 [00:01<00:00, 119.67it/s] 97%|█████████▋| 135/139 [00:01<00:00, 119.05it/s]100%|██████████| 139/139 [00:01<00:00, 115.42it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   8%|▊         | 14/173 [00:00<00:01, 139.94it/s]extract the null data:  35%|███▌      | 61/173 [00:00<00:00, 332.53it/s]extract the null data:  55%|█████▍    | 95/173 [00:00<00:00, 283.39it/s]extract the null data:  72%|███████▏  | 125/173 [00:00<00:00, 273.48it/s]extract the null data:  94%|█████████▍| 163/173 [00:00<00:00, 307.43it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 300.25it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 207.47it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 172.40it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 169.78it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 170.00it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 168.61it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 161.57it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 157.07it/s]replace nan value:  84%|████████▍ | 146/173 [00:00<00:00, 157.16it/s]replace nan value:  94%|█████████▍| 163/173 [00:00<00:00, 158.49it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 162.43it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 136.74it/s] 17%|█▋        | 29/173 [00:00<00:01, 103.32it/s] 26%|██▌       | 45/173 [00:00<00:01, 123.72it/s] 35%|███▌      | 61/173 [00:00<00:00, 131.98it/s] 43%|████▎     | 75/173 [00:00<00:00, 130.55it/s] 51%|█████▏    | 89/173 [00:00<00:00, 132.34it/s] 60%|█████▉    | 103/173 [00:00<00:00, 132.76it/s] 68%|██████▊   | 118/173 [00:00<00:00, 133.22it/s] 76%|███████▋  | 132/173 [00:01<00:00, 129.01it/s] 84%|████████▍ | 145/173 [00:01<00:00, 128.10it/s] 91%|█████████▏| 158/173 [00:01<00:00, 113.99it/s] 98%|█████████▊| 170/173 [00:01<00:00, 81.01it/s] 100%|██████████| 173/173 [00:01<00:00, 107.48it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.530, valid acc : 0.645, train f1 : 0.445, valid f1 : 0.524
training process:   1%|          | 1/128 [01:40<3:33:35, 100.91s/it]Best score increase :0.000 -> 0.524
training process:   2%|▏         | 2/128 [03:04<3:10:31, 90.73s/it] Best score increase :0.524 -> 0.595
training process:   2%|▏         | 3/128 [04:31<3:05:45, 89.17s/it]Best score increase :0.595 -> 0.628
training process:   3%|▎         | 4/128 [05:56<3:00:43, 87.45s/it]Best score increase :0.628 -> 0.665
epoch : 5, train loss : 0.009, valid loss : 0.009, train acc : 0.825, valid acc : 0.836, train f1 : 0.657, valid f1 : 0.673
training process:   4%|▍         | 5/128 [07:35<3:07:53, 91.65s/it]Best score increase :0.665 -> 0.673
training process:   5%|▍         | 6/128 [09:04<3:04:26, 90.71s/it]Best score increase :0.673 -> 0.698
training process:   5%|▌         | 7/128 [10:29<2:59:12, 88.86s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [11:51<2:53:24, 86.70s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.008, valid loss : 0.008, train acc : 0.860, valid acc : 0.859, train f1 : 0.696, valid f1 : 0.698
training process:   7%|▋         | 9/128 [13:30<2:59:43, 90.62s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [14:50<2:51:13, 87.07s/it]Best score increase :0.698 -> 0.705
training process:   9%|▊         | 11/128 [16:15<2:48:31, 86.42s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [17:25<2:37:30, 81.47s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.008, train acc : 0.875, valid acc : 0.888, train f1 : 0.717, valid f1 : 0.724
training process:  10%|█         | 13/128 [18:52<2:39:37, 83.28s/it]Best score increase :0.705 -> 0.724
training process:  11%|█         | 14/128 [19:57<2:27:54, 77.84s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [21:05<2:20:54, 74.82s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [22:16<2:17:32, 73.68s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.007, valid loss : 0.008, train acc : 0.889, valid acc : 0.865, train f1 : 0.738, valid f1 : 0.709
training process:  13%|█▎        | 17/128 [23:36<2:19:42, 75.52s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [24:49<2:17:13, 74.85s/it]Best score increase :0.724 -> 0.733
training process:  15%|█▍        | 19/128 [26:00<2:13:52, 73.70s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [27:25<2:18:41, 77.05s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.008, train acc : 0.901, valid acc : 0.863, train f1 : 0.756, valid f1 : 0.705
training process:  16%|█▋        | 21/128 [28:49<2:21:13, 79.19s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [29:59<2:14:46, 76.29s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [31:08<2:09:39, 74.09s/it]EarlyStopping counter : 5 out of 12
training process:  19%|█▉        | 24/128 [32:16<2:05:09, 72.21s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.007, train acc : 0.911, valid acc : 0.864, train f1 : 0.774, valid f1 : 0.709
training process:  20%|█▉        | 25/128 [33:37<2:08:42, 74.98s/it]EarlyStopping counter : 7 out of 12
training process:  20%|██        | 26/128 [34:49<2:06:01, 74.13s/it]EarlyStopping counter : 8 out of 12
training process:  21%|██        | 27/128 [36:00<2:03:01, 73.08s/it]EarlyStopping counter : 9 out of 12
training process:  22%|██▏       | 28/128 [37:09<1:59:33, 71.73s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.007, train acc : 0.917, valid acc : 0.887, train f1 : 0.786, valid f1 : 0.735
training process:  23%|██▎       | 29/128 [38:28<2:01:57, 73.91s/it]Best score increase :0.733 -> 0.735
training process:  23%|██▎       | 30/128 [39:42<2:00:51, 73.99s/it]Best score increase :0.735 -> 0.739
training process:  24%|██▍       | 31/128 [40:59<2:01:23, 75.09s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [42:13<1:59:19, 74.57s/it]Best score increase :0.739 -> 0.752
epoch : 33, train loss : 0.005, valid loss : 0.007, train acc : 0.923, valid acc : 0.903, train f1 : 0.798, valid f1 : 0.759
training process:  26%|██▌       | 33/128 [43:35<2:01:34, 76.79s/it]Best score increase :0.752 -> 0.759
training process:  27%|██▋       | 34/128 [44:47<1:58:08, 75.41s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [46:00<1:55:57, 74.81s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [47:08<1:51:30, 72.72s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.007, train acc : 0.929, valid acc : 0.886, train f1 : 0.811, valid f1 : 0.739
training process:  29%|██▉       | 37/128 [48:34<1:56:18, 76.69s/it]EarlyStopping counter : 4 out of 12
training process:  30%|██▉       | 38/128 [49:48<1:53:48, 75.88s/it]EarlyStopping counter : 5 out of 12
training process:  30%|███       | 39/128 [50:59<1:50:17, 74.36s/it]EarlyStopping counter : 6 out of 12
training process:  31%|███▏      | 40/128 [52:11<1:48:04, 73.69s/it]Best score increase :0.759 -> 0.770
epoch : 41, train loss : 0.005, valid loss : 0.007, train acc : 0.934, valid acc : 0.918, train f1 : 0.820, valid f1 : 0.775
training process:  32%|███▏      | 41/128 [53:37<1:52:02, 77.27s/it]Best score increase :0.770 -> 0.775
training process:  33%|███▎      | 42/128 [54:46<1:47:21, 74.90s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [55:55<1:43:38, 73.15s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [57:06<1:41:21, 72.40s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.005, valid loss : 0.007, train acc : 0.935, valid acc : 0.897, train f1 : 0.822, valid f1 : 0.757
training process:  35%|███▌      | 45/128 [58:30<1:44:55, 75.85s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [59:39<1:41:06, 73.98s/it]EarlyStopping counter : 5 out of 12
training process:  37%|███▋      | 47/128 [1:00:48<1:37:50, 72.47s/it]EarlyStopping counter : 6 out of 12
training process:  38%|███▊      | 48/128 [1:01:58<1:35:21, 71.52s/it]EarlyStopping counter : 7 out of 12
epoch : 49, train loss : 0.004, valid loss : 0.007, train acc : 0.940, valid acc : 0.918, train f1 : 0.833, valid f1 : 0.786
training process:  38%|███▊      | 49/128 [1:03:25<1:40:21, 76.22s/it]Best score increase :0.775 -> 0.786
training process:  39%|███▉      | 50/128 [1:04:50<1:42:37, 78.94s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [1:06:02<1:38:32, 76.79s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [1:07:14<1:35:26, 75.35s/it]Best score increase :0.786 -> 0.797
epoch : 53, train loss : 0.004, valid loss : 0.007, train acc : 0.941, valid acc : 0.896, train f1 : 0.837, valid f1 : 0.757
training process:  41%|████▏     | 53/128 [1:08:36<1:36:44, 77.39s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [1:09:46<1:32:47, 75.23s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [1:10:59<1:30:37, 74.48s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [1:12:08<1:27:29, 72.91s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.004, valid loss : 0.007, train acc : 0.944, valid acc : 0.918, train f1 : 0.843, valid f1 : 0.788
training process:  45%|████▍     | 57/128 [1:13:29<1:29:09, 75.35s/it]EarlyStopping counter : 5 out of 12
training process:  45%|████▌     | 58/128 [1:14:39<1:26:05, 73.79s/it]EarlyStopping counter : 6 out of 12
training process:  46%|████▌     | 59/128 [1:15:51<1:24:06, 73.14s/it]EarlyStopping counter : 7 out of 12
training process:  47%|████▋     | 60/128 [1:17:00<1:21:23, 71.81s/it]EarlyStopping counter : 8 out of 12
epoch : 61, train loss : 0.004, valid loss : 0.007, train acc : 0.944, valid acc : 0.909, train f1 : 0.841, valid f1 : 0.775
training process:  48%|████▊     | 61/128 [1:18:19<1:22:51, 74.20s/it]EarlyStopping counter : 9 out of 12
training process:  48%|████▊     | 62/128 [1:19:25<1:18:47, 71.62s/it]EarlyStopping counter : 10 out of 12
training process:  49%|████▉     | 63/128 [1:20:27<1:14:24, 68.69s/it]Best score increase :0.797 -> 0.801
training process:  50%|█████     | 64/128 [1:21:39<1:14:29, 69.83s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.004, valid loss : 0.008, train acc : 0.949, valid acc : 0.914, train f1 : 0.853, valid f1 : 0.782
training process:  51%|█████     | 65/128 [1:22:47<1:12:34, 69.12s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 66/128 [1:23:51<1:09:45, 67.51s/it]Best score increase :0.801 -> 0.830
training process:  52%|█████▏    | 67/128 [1:24:49<1:05:53, 64.82s/it]EarlyStopping counter : 1 out of 12
training process:  53%|█████▎    | 68/128 [1:25:51<1:03:57, 63.96s/it]EarlyStopping counter : 2 out of 12
epoch : 69, train loss : 0.004, valid loss : 0.007, train acc : 0.951, valid acc : 0.909, train f1 : 0.859, valid f1 : 0.776
training process:  54%|█████▍    | 69/128 [1:27:00<1:04:20, 65.44s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▍    | 70/128 [1:28:00<1:01:38, 63.77s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▌    | 71/128 [1:29:00<59:26, 62.57s/it]  EarlyStopping counter : 5 out of 12
training process:  56%|█████▋    | 72/128 [1:30:01<58:03, 62.21s/it]EarlyStopping counter : 6 out of 12
epoch : 73, train loss : 0.004, valid loss : 0.008, train acc : 0.952, valid acc : 0.918, train f1 : 0.861, valid f1 : 0.789
training process:  57%|█████▋    | 73/128 [1:31:25<1:03:05, 68.83s/it]EarlyStopping counter : 7 out of 12
training process:  58%|█████▊    | 74/128 [1:32:33<1:01:40, 68.53s/it]EarlyStopping counter : 8 out of 12
training process:  59%|█████▊    | 75/128 [1:33:44<1:01:14, 69.34s/it]EarlyStopping counter : 9 out of 12
training process:  59%|█████▉    | 76/128 [1:34:51<59:25, 68.57s/it]  EarlyStopping counter : 10 out of 12
epoch : 77, train loss : 0.004, valid loss : 0.008, train acc : 0.953, valid acc : 0.908, train f1 : 0.863, valid f1 : 0.773
training process:  60%|██████    | 77/128 [1:36:06<59:59, 70.58s/it]EarlyStopping counter : 11 out of 12
training process:  60%|██████    | 77/128 [1:37:08<1:04:20, 75.70s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 77, best f1 score : 0.830
training process finished, best loss : 0.007 and best acc : 0.944, best f1 : 0.830, best epoch : 65

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.70      0.69       580
           1       0.97      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.84      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.84, test loss : 0.553

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:58, 10.75s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:40, 10.04s/it]processing for feature importance:  25%|██▌       | 3/12 [00:31<01:33, 10.37s/it]processing for feature importance:  33%|███▎      | 4/12 [00:42<01:25, 10.65s/it]processing for feature importance:  42%|████▏     | 5/12 [00:51<01:12, 10.31s/it]processing for feature importance:  50%|█████     | 6/12 [01:01<01:00, 10.15s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:12<00:52, 10.52s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:22<00:41, 10.32s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:32<00:30, 10.06s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:43<00:20, 10.39s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:54<00:10, 10.46s/it]processing for feature importance: 100%|██████████| 12/12 [02:04<00:00, 10.50s/it]processing for feature importance: 100%|██████████| 12/12 [02:04<00:00, 10.39s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 34/306 [00:00<00:00, 337.10it/s] 23%|██▎       | 69/306 [00:00<00:00, 343.98it/s] 34%|███▍      | 105/306 [00:00<00:00, 347.95it/s] 46%|████▌     | 141/306 [00:00<00:00, 349.58it/s] 58%|█████▊    | 177/306 [00:00<00:00, 350.07it/s] 70%|██████▉   | 213/306 [00:00<00:00, 351.51it/s] 81%|████████▏ | 249/306 [00:00<00:00, 348.82it/s] 93%|█████████▎| 284/306 [00:00<00:00, 348.01it/s]100%|██████████| 306/306 [00:00<00:00, 347.77it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   4%|▍         | 22/553 [00:00<00:02, 216.90it/s]extract the null data:  11%|█         | 62/553 [00:00<00:01, 316.67it/s]extract the null data:  19%|█▉        | 104/553 [00:00<00:01, 361.10it/s]extract the null data:  25%|██▌       | 141/553 [00:00<00:01, 345.39it/s]extract the null data:  32%|███▏      | 176/553 [00:00<00:01, 282.46it/s]extract the null data:  40%|███▉      | 219/553 [00:00<00:01, 323.46it/s]extract the null data:  47%|████▋     | 262/553 [00:00<00:00, 352.82it/s]extract the null data:  56%|█████▌    | 308/553 [00:00<00:00, 383.03it/s]extract the null data:  63%|██████▎   | 350/553 [00:00<00:00, 393.43it/s]extract the null data:  71%|███████   | 394/553 [00:01<00:00, 405.37it/s]extract the null data:  79%|███████▉  | 436/553 [00:01<00:00, 377.24it/s]extract the null data:  86%|████████▋ | 477/553 [00:01<00:00, 384.61it/s]extract the null data:  93%|█████████▎| 517/553 [00:01<00:00, 366.67it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 360.81it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 162.49it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 159.27it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 158.57it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:03, 135.15it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:03, 141.47it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:03, 127.86it/s]replace nan value:  20%|██        | 111/553 [00:00<00:03, 112.40it/s]replace nan value:  22%|██▏       | 123/553 [00:01<00:04, 98.16it/s] replace nan value:  25%|██▌       | 139/553 [00:01<00:03, 112.43it/s]replace nan value:  28%|██▊       | 156/553 [00:01<00:03, 126.16it/s]replace nan value:  31%|███▏      | 173/553 [00:01<00:02, 136.79it/s]replace nan value:  34%|███▍      | 189/553 [00:01<00:02, 142.28it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 143.04it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:02, 149.68it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:02, 154.49it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 157.22it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 158.43it/s]replace nan value:  52%|█████▏    | 288/553 [00:02<00:01, 157.34it/s]replace nan value:  55%|█████▍    | 304/553 [00:02<00:01, 157.39it/s]replace nan value:  58%|█████▊    | 320/553 [00:02<00:01, 157.47it/s]replace nan value:  61%|██████    | 337/553 [00:02<00:01, 158.80it/s]replace nan value:  64%|██████▍   | 354/553 [00:02<00:01, 159.88it/s]replace nan value:  67%|██████▋   | 371/553 [00:02<00:01, 159.11it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:01, 159.00it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 160.16it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 159.98it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 161.28it/s]replace nan value:  82%|████████▏ | 455/553 [00:03<00:00, 163.22it/s]replace nan value:  85%|████████▌ | 472/553 [00:03<00:00, 163.41it/s]replace nan value:  88%|████████▊ | 489/553 [00:03<00:00, 162.11it/s]replace nan value:  92%|█████████▏| 506/553 [00:03<00:00, 157.07it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 157.15it/s]replace nan value:  97%|█████████▋| 539/553 [00:03<00:00, 159.55it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 148.88it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.63it/s]  5%|▍         | 27/553 [00:00<00:03, 131.81it/s]  7%|▋         | 41/553 [00:00<00:03, 129.37it/s] 10%|▉         | 54/553 [00:00<00:04, 113.20it/s] 12%|█▏        | 66/553 [00:00<00:04, 101.84it/s] 14%|█▍        | 80/553 [00:00<00:04, 109.43it/s] 17%|█▋        | 94/553 [00:00<00:03, 116.04it/s] 20%|█▉        | 108/553 [00:00<00:03, 120.17it/s] 22%|██▏       | 122/553 [00:01<00:03, 124.34it/s] 25%|██▍       | 137/553 [00:01<00:03, 129.93it/s] 28%|██▊       | 153/553 [00:01<00:02, 137.79it/s] 31%|███       | 169/553 [00:01<00:02, 143.75it/s] 33%|███▎      | 184/553 [00:01<00:02, 139.65it/s] 36%|███▌      | 200/553 [00:01<00:02, 144.29it/s] 39%|███▉      | 215/553 [00:01<00:02, 144.74it/s] 42%|████▏     | 230/553 [00:01<00:02, 134.71it/s] 44%|████▍     | 244/553 [00:01<00:02, 134.52it/s] 47%|████▋     | 258/553 [00:02<00:02, 128.66it/s] 49%|████▉     | 271/553 [00:02<00:02, 125.46it/s] 52%|█████▏    | 285/553 [00:02<00:02, 127.72it/s] 54%|█████▍    | 298/553 [00:02<00:02, 124.11it/s] 56%|█████▌    | 311/553 [00:02<00:02, 115.15it/s] 59%|█████▊    | 324/553 [00:02<00:01, 118.14it/s] 61%|██████    | 337/553 [00:02<00:01, 120.72it/s] 63%|██████▎   | 350/553 [00:02<00:01, 121.09it/s] 66%|██████▌   | 363/553 [00:02<00:01, 118.29it/s] 68%|██████▊   | 377/553 [00:03<00:01, 122.41it/s] 71%|███████   | 390/553 [00:03<00:01, 112.79it/s] 73%|███████▎  | 402/553 [00:03<00:01, 114.19it/s] 75%|███████▌  | 415/553 [00:03<00:01, 118.34it/s] 77%|███████▋  | 427/553 [00:03<00:01, 109.88it/s] 79%|███████▉  | 439/553 [00:03<00:01, 110.23it/s] 82%|████████▏ | 454/553 [00:03<00:00, 119.74it/s] 85%|████████▍ | 469/553 [00:03<00:00, 126.93it/s] 87%|████████▋ | 482/553 [00:03<00:00, 123.61it/s] 90%|████████▉ | 495/553 [00:04<00:00, 115.45it/s] 92%|█████████▏| 510/553 [00:04<00:00, 122.92it/s] 95%|█████████▍| 523/553 [00:04<00:00, 114.80it/s] 97%|█████████▋| 535/553 [00:04<00:00, 105.56it/s]100%|█████████▉| 551/553 [00:04<00:00, 98.08it/s] 100%|██████████| 553/553 [00:04<00:00, 120.05it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 23/139 [00:00<00:00, 226.72it/s]extract the null data:  55%|█████▍    | 76/139 [00:00<00:00, 400.18it/s]extract the null data:  92%|█████████▏| 128/139 [00:00<00:00, 450.85it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 427.82it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 182.66it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 182.65it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 183.32it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 180.73it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 179.35it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 164.10it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 170.25it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 174.91it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.30it/s] 17%|█▋        | 23/139 [00:00<00:01, 114.63it/s] 27%|██▋       | 38/139 [00:00<00:00, 127.23it/s] 37%|███▋      | 51/139 [00:00<00:00, 127.97it/s] 47%|████▋     | 66/139 [00:00<00:00, 132.78it/s] 58%|█████▊    | 80/139 [00:00<00:00, 129.01it/s] 67%|██████▋   | 93/139 [00:00<00:00, 114.17it/s] 77%|███████▋  | 107/139 [00:00<00:00, 118.63it/s] 89%|████████▉ | 124/139 [00:00<00:00, 130.57it/s] 99%|█████████▉| 138/139 [00:01<00:00, 131.12it/s]100%|██████████| 139/139 [00:01<00:00, 126.42it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 219.43it/s]extract the null data:  46%|████▌     | 79/173 [00:00<00:00, 422.24it/s]extract the null data:  77%|███████▋  | 133/173 [00:00<00:00, 473.12it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 456.07it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 185.62it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 170.32it/s]replace nan value:  32%|███▏      | 56/173 [00:00<00:00, 132.71it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 124.38it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 118.28it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 112.49it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 108.62it/s]replace nan value:  69%|██████▉   | 120/173 [00:01<00:00, 107.28it/s]replace nan value:  77%|███████▋  | 133/173 [00:01<00:00, 108.26it/s]replace nan value:  87%|████████▋ | 151/173 [00:01<00:00, 126.77it/s]replace nan value:  98%|█████████▊| 169/173 [00:01<00:00, 140.29it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 127.79it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 126.05it/s] 16%|█▌        | 27/173 [00:00<00:01, 84.66it/s]  25%|██▍       | 43/173 [00:00<00:01, 109.10it/s] 34%|███▍      | 59/173 [00:00<00:00, 123.64it/s] 43%|████▎     | 74/173 [00:00<00:00, 129.95it/s] 51%|█████     | 88/173 [00:00<00:00, 127.32it/s] 60%|█████▉    | 103/173 [00:00<00:00, 131.29it/s] 68%|██████▊   | 117/173 [00:00<00:00, 123.93it/s] 75%|███████▌  | 130/173 [00:01<00:00, 113.45it/s] 83%|████████▎ | 144/173 [00:01<00:00, 118.19it/s] 91%|█████████ | 157/173 [00:01<00:00, 113.62it/s] 98%|█████████▊| 169/173 [00:01<00:00, 98.27it/s] 100%|██████████| 173/173 [00:01<00:00, 109.40it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.008, valid loss : 0.013, train acc : 0.653, valid acc : 0.393, train f1 : 0.628, valid f1 : 0.358
training process:   1%|          | 1/128 [01:17<2:43:20, 77.17s/it]Best score increase :0.000 -> 0.358
training process:   2%|▏         | 2/128 [02:19<2:23:31, 68.35s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:20<2:15:23, 64.99s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [04:26<2:15:08, 65.39s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.015, train acc : 0.636, valid acc : 0.322, train f1 : 0.581, valid f1 : 0.305
training process:   4%|▍         | 5/128 [05:43<2:23:02, 69.78s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [06:52<2:21:03, 69.37s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [08:02<2:20:37, 69.73s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [09:07<2:15:54, 67.96s/it]Best score increase :0.358 -> 0.374
epoch : 9, train loss : 0.003, valid loss : 0.013, train acc : 0.674, valid acc : 0.410, train f1 : 0.638, valid f1 : 0.372
training process:   7%|▋         | 9/128 [10:20<2:18:22, 69.77s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [11:25<2:14:00, 68.14s/it]Best score increase :0.374 -> 0.392
training process:   9%|▊         | 11/128 [12:30<2:11:07, 67.24s/it]Best score increase :0.392 -> 0.405
training process:   9%|▉         | 12/128 [13:34<2:08:01, 66.22s/it]Best score increase :0.405 -> 0.458
epoch : 13, train loss : 0.003, valid loss : 0.013, train acc : 0.736, valid acc : 0.473, train f1 : 0.716, valid f1 : 0.418
training process:  10%|█         | 13/128 [14:46<2:10:23, 68.03s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [15:48<2:05:42, 66.16s/it]Best score increase :0.458 -> 0.479
training process:  12%|█▏        | 15/128 [16:54<2:04:43, 66.23s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [18:00<2:03:22, 66.10s/it]Best score increase :0.479 -> 0.510
epoch : 17, train loss : 0.002, valid loss : 0.011, train acc : 0.790, valid acc : 0.603, train f1 : 0.782, valid f1 : 0.507
training process:  13%|█▎        | 17/128 [19:15<2:07:16, 68.80s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [20:19<2:03:16, 67.24s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [21:22<1:59:50, 65.97s/it]Best score increase :0.510 -> 0.529
training process:  16%|█▌        | 20/128 [22:10<1:49:11, 60.66s/it]Best score increase :0.529 -> 0.556
epoch : 21, train loss : 0.002, valid loss : 0.011, train acc : 0.819, valid acc : 0.629, train f1 : 0.813, valid f1 : 0.526
training process:  16%|█▋        | 21/128 [23:06<1:45:49, 59.34s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [23:55<1:39:07, 56.11s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [24:44<1:34:32, 54.02s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [25:33<1:31:05, 52.56s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.009, train acc : 0.843, valid acc : 0.688, train f1 : 0.839, valid f1 : 0.568
training process:  20%|█▉        | 25/128 [26:31<1:32:41, 54.00s/it]Best score increase :0.556 -> 0.568
training process:  20%|██        | 26/128 [27:17<1:27:55, 51.72s/it]Best score increase :0.568 -> 0.579
training process:  21%|██        | 27/128 [28:04<1:24:33, 50.23s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [28:51<1:22:09, 49.30s/it]Best score increase :0.579 -> 0.598
epoch : 29, train loss : 0.002, valid loss : 0.009, train acc : 0.858, valid acc : 0.711, train f1 : 0.855, valid f1 : 0.585
training process:  23%|██▎       | 29/128 [29:46<1:24:26, 51.18s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [30:35<1:22:24, 50.46s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [31:25<1:21:03, 50.14s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [32:15<1:20:17, 50.18s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.009, train acc : 0.864, valid acc : 0.742, train f1 : 0.862, valid f1 : 0.609
training process:  26%|██▌       | 33/128 [33:14<1:23:29, 52.73s/it]Best score increase :0.598 -> 0.609
training process:  27%|██▋       | 34/128 [34:03<1:20:54, 51.65s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [35:05<1:24:51, 54.75s/it]Best score increase :0.609 -> 0.636
training process:  28%|██▊       | 36/128 [36:01<1:24:32, 55.14s/it]Best score increase :0.636 -> 0.642
epoch : 37, train loss : 0.002, valid loss : 0.010, train acc : 0.875, valid acc : 0.711, train f1 : 0.873, valid f1 : 0.585
training process:  29%|██▉       | 37/128 [37:12<1:30:48, 59.87s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [38:12<1:30:05, 60.07s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [39:07<1:26:46, 58.50s/it]Best score increase :0.642 -> 0.657
training process:  31%|███▏      | 40/128 [40:05<1:25:30, 58.30s/it]Best score increase :0.657 -> 0.669
epoch : 41, train loss : 0.002, valid loss : 0.008, train acc : 0.883, valid acc : 0.793, train f1 : 0.882, valid f1 : 0.651
training process:  32%|███▏      | 41/128 [41:10<1:27:28, 60.33s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [42:09<1:25:57, 59.97s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [43:07<1:24:02, 59.33s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [44:09<1:24:15, 60.18s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.001, valid loss : 0.009, train acc : 0.886, valid acc : 0.762, train f1 : 0.884, valid f1 : 0.625
training process:  35%|███▌      | 45/128 [45:15<1:25:37, 61.90s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [46:11<1:22:18, 60.23s/it]EarlyStopping counter : 6 out of 12
training process:  37%|███▋      | 47/128 [47:07<1:19:28, 58.87s/it]EarlyStopping counter : 7 out of 12
training process:  38%|███▊      | 48/128 [48:13<1:21:28, 61.11s/it]EarlyStopping counter : 8 out of 12
epoch : 49, train loss : 0.001, valid loss : 0.010, train acc : 0.891, valid acc : 0.758, train f1 : 0.890, valid f1 : 0.621
training process:  38%|███▊      | 49/128 [49:27<1:25:32, 64.96s/it]EarlyStopping counter : 9 out of 12
training process:  39%|███▉      | 50/128 [50:26<1:21:58, 63.05s/it]EarlyStopping counter : 10 out of 12
training process:  40%|███▉      | 51/128 [51:24<1:19:03, 61.60s/it]EarlyStopping counter : 11 out of 12
training process:  40%|███▉      | 51/128 [52:20<1:19:01, 61.58s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 51, best f1 score : 0.669
training process finished, best loss : 0.008 and best acc : 0.813, best f1 : 0.669, best epoch : 39

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.33      0.89      0.48       580
           1       0.99      0.85      0.91      6818

    accuracy                           0.85      7398
   macro avg       0.66      0.87      0.70      7398
weighted avg       0.94      0.85      0.88      7398


# test acc : 0.85, test f1 : 0.70, test AUC : 0.87, test loss : 0.415

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:45,  9.60s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:36,  9.62s/it]processing for feature importance:  25%|██▌       | 3/12 [00:27<01:20,  8.94s/it]processing for feature importance:  33%|███▎      | 4/12 [00:36<01:13,  9.20s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:04,  9.18s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:56,  9.49s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:05<00:46,  9.35s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:13<00:35,  8.85s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:21<00:25,  8.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:30<00:17,  8.85s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:40<00:09,  9.27s/it]processing for feature importance: 100%|██████████| 12/12 [01:48<00:00,  8.93s/it]processing for feature importance: 100%|██████████| 12/12 [01:48<00:00,  9.07s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 31/306 [00:00<00:00, 306.45it/s] 20%|██        | 62/306 [00:00<00:01, 223.13it/s] 28%|██▊       | 86/306 [00:00<00:01, 191.05it/s] 35%|███▍      | 106/306 [00:00<00:01, 180.75it/s] 46%|████▌     | 140/306 [00:00<00:00, 225.87it/s] 57%|█████▋    | 173/306 [00:00<00:00, 254.71it/s] 65%|██████▌   | 200/306 [00:00<00:00, 217.67it/s] 73%|███████▎  | 224/306 [00:01<00:00, 194.42it/s] 80%|████████  | 245/306 [00:01<00:00, 184.25it/s] 91%|█████████ | 278/306 [00:01<00:00, 219.78it/s] 99%|█████████▊| 302/306 [00:01<00:00, 203.11it/s]100%|██████████| 306/306 [00:01<00:00, 209.35it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 592.63it/s]extract the null data:  22%|██▏       | 121/553 [00:00<00:00, 601.81it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 607.32it/s]extract the null data:  44%|████▍     | 244/553 [00:00<00:00, 607.37it/s]extract the null data:  55%|█████▌    | 305/553 [00:00<00:00, 606.63it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 606.19it/s]extract the null data:  77%|███████▋  | 427/553 [00:00<00:00, 605.23it/s]extract the null data:  88%|████████▊ | 488/553 [00:00<00:00, 606.32it/s]extract the null data:  99%|█████████▉| 549/553 [00:00<00:00, 605.03it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 604.47it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 188.06it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 195.62it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 186.22it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 193.35it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 197.68it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:02, 188.44it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 178.06it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:02, 188.35it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 195.31it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 200.69it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 194.04it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 198.57it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 201.81it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 197.20it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 201.54it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 204.81it/s]replace nan value:  64%|██████▍   | 356/553 [00:01<00:00, 204.86it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 204.00it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 202.72it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 201.47it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 202.63it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 199.00it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 201.45it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 200.75it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 201.21it/s]replace nan value:  99%|█████████▊| 545/553 [00:02<00:00, 202.66it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 198.25it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.69it/s]  6%|▌         | 31/553 [00:00<00:03, 151.99it/s]  8%|▊         | 47/553 [00:00<00:03, 126.94it/s] 11%|█         | 61/553 [00:00<00:03, 123.43it/s] 14%|█▎        | 75/553 [00:00<00:03, 122.42it/s] 16%|█▋        | 90/553 [00:00<00:03, 130.51it/s] 19%|█▉        | 104/553 [00:00<00:03, 129.46it/s] 22%|██▏       | 121/553 [00:00<00:03, 140.10it/s] 25%|██▍       | 136/553 [00:01<00:03, 127.59it/s] 28%|██▊       | 154/553 [00:01<00:02, 140.90it/s] 31%|███       | 172/553 [00:01<00:02, 150.45it/s] 34%|███▍      | 188/553 [00:01<00:02, 138.04it/s] 37%|███▋      | 205/553 [00:01<00:02, 145.50it/s] 40%|███▉      | 220/553 [00:01<00:02, 125.69it/s] 43%|████▎     | 237/553 [00:01<00:02, 134.38it/s] 46%|████▌     | 252/553 [00:01<00:02, 136.94it/s] 48%|████▊     | 267/553 [00:02<00:02, 127.95it/s] 51%|█████     | 282/553 [00:02<00:02, 128.69it/s] 54%|█████▎    | 296/553 [00:02<00:01, 128.80it/s] 56%|█████▌    | 310/553 [00:02<00:01, 124.23it/s] 58%|█████▊    | 323/553 [00:02<00:02, 98.04it/s]  60%|██████    | 334/553 [00:02<00:02, 87.63it/s] 62%|██████▏   | 344/553 [00:02<00:02, 85.53it/s] 64%|██████▍   | 355/553 [00:02<00:02, 88.95it/s] 67%|██████▋   | 371/553 [00:03<00:01, 105.88it/s] 70%|██████▉   | 385/553 [00:03<00:01, 110.97it/s] 72%|███████▏  | 397/553 [00:03<00:01, 106.07it/s] 75%|███████▍  | 414/553 [00:03<00:01, 119.58it/s] 77%|███████▋  | 427/553 [00:03<00:01, 113.48it/s] 80%|████████  | 445/553 [00:03<00:00, 129.05it/s] 84%|████████▎ | 462/553 [00:03<00:00, 137.38it/s] 86%|████████▋ | 478/553 [00:03<00:00, 137.44it/s] 89%|████████▉ | 492/553 [00:03<00:00, 133.37it/s] 92%|█████████▏| 506/553 [00:04<00:00, 131.73it/s] 94%|█████████▍| 521/553 [00:04<00:00, 132.74it/s] 97%|█████████▋| 535/553 [00:04<00:00, 117.81it/s] 99%|█████████▉| 549/553 [00:04<00:00, 123.31it/s]100%|██████████| 553/553 [00:04<00:00, 121.49it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 368.02it/s]extract the null data:  73%|███████▎  | 102/139 [00:00<00:00, 529.80it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 534.57it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 213.53it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 215.08it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 213.51it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 186.02it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 173.85it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 184.01it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 189.46it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.97it/s] 17%|█▋        | 24/139 [00:00<00:00, 121.08it/s] 27%|██▋       | 38/139 [00:00<00:00, 128.20it/s] 37%|███▋      | 51/139 [00:00<00:00, 118.34it/s] 47%|████▋     | 66/139 [00:00<00:00, 127.92it/s] 57%|█████▋    | 79/139 [00:00<00:00, 126.72it/s] 66%|██████▌   | 92/139 [00:00<00:00, 120.71it/s] 76%|███████▌  | 105/139 [00:00<00:00, 119.26it/s] 88%|████████▊ | 122/139 [00:00<00:00, 131.63it/s] 98%|█████████▊| 136/139 [00:01<00:00, 133.46it/s]100%|██████████| 139/139 [00:01<00:00, 128.01it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 306.07it/s]extract the null data:  55%|█████▍    | 95/173 [00:00<00:00, 498.57it/s]extract the null data:  91%|█████████▏| 158/173 [00:00<00:00, 557.60it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 528.98it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 214.41it/s]replace nan value:  26%|██▌       | 45/173 [00:00<00:00, 222.04it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 217.90it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 214.98it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 213.56it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 210.62it/s]replace nan value:  90%|█████████ | 156/173 [00:00<00:00, 208.62it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 210.49it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  6%|▌         | 10/173 [00:00<00:01, 96.75it/s] 13%|█▎        | 23/173 [00:00<00:01, 111.88it/s] 22%|██▏       | 38/173 [00:00<00:01, 128.27it/s] 32%|███▏      | 55/173 [00:00<00:00, 142.39it/s] 40%|████      | 70/173 [00:00<00:00, 112.24it/s] 49%|████▊     | 84/173 [00:00<00:00, 116.57it/s] 58%|█████▊    | 101/173 [00:00<00:00, 130.20it/s] 68%|██████▊   | 118/173 [00:00<00:00, 138.67it/s] 77%|███████▋  | 133/173 [00:01<00:00, 137.70it/s] 86%|████████▌ | 148/173 [00:01<00:00, 136.13it/s] 94%|█████████▎| 162/173 [00:01<00:00, 104.32it/s]100%|██████████| 173/173 [00:01<00:00, 112.59it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.008, train f1 : 0.531, valid f1 : 0.602
training process - Deferred Re-weighting:   1%|          | 1/128 [01:07<2:23:22, 67.73s/it]Best score increase :0.000 -> 0.602
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:03<2:07:49, 60.87s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:54<1:57:16, 56.29s/it]Best score increase :0.602 -> 0.632
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:44<1:51:10, 53.80s/it]Best score increase :0.632 -> 0.657
epoch : 5, train loss : 0.004, valid loss : 0.004, train f1 : 0.692, valid f1 : 0.679
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:42<1:53:26, 55.33s/it]Best score increase :0.657 -> 0.679
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:33<1:49:06, 53.66s/it]Best score increase :0.679 -> 0.711
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:22<1:45:41, 52.41s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:11<1:42:41, 51.34s/it]Best score increase :0.711 -> 0.724
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.736, valid f1 : 0.725
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:09<1:45:36, 53.25s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:02<1:44:33, 53.17s/it]Best score increase :0.724 -> 0.728
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:54<1:43:15, 52.96s/it]Best score increase :0.728 -> 0.742
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:48<1:42:40, 53.10s/it]Best score increase :0.742 -> 0.744
epoch : 13, train loss : 0.003, valid loss : 0.003, train f1 : 0.766, valid f1 : 0.723
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:49<1:46:32, 55.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:42<1:43:54, 54.69s/it]Best score increase :0.744 -> 0.747
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:33<1:41:19, 53.80s/it]Best score increase :0.747 -> 0.753
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:26<1:39:32, 53.33s/it]Best score increase :0.753 -> 0.762
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.785, valid f1 : 0.769
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:31<1:45:05, 56.80s/it]Best score increase :0.762 -> 0.769
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:22<1:40:53, 55.04s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:15<1:38:57, 54.48s/it]Best score increase :0.769 -> 0.772
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:08<1:37:15, 54.03s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train f1 : 0.815, valid f1 : 0.791
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:10<1:40:31, 56.37s/it]Best score increase :0.772 -> 0.791
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:05<1:39:11, 56.14s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:58<1:36:22, 55.07s/it]Best score increase :0.791 -> 0.800
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:49<1:33:38, 54.02s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.833, valid f1 : 0.809
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:49<1:35:47, 55.80s/it]Best score increase :0.800 -> 0.809
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:41<1:32:47, 54.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:35<1:31:42, 54.48s/it]Best score increase :0.809 -> 0.817
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:35<1:33:24, 56.05s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.848, valid f1 : 0.812
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:48<1:40:58, 61.20s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:47<1:38:41, 60.43s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:49<1:38:23, 60.86s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:57<1:41:00, 63.13s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.861, valid f1 : 0.816
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [31:05<1:42:16, 64.60s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [32:01<1:37:02, 61.94s/it]Best score increase :0.817 -> 0.829
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [33:00<1:34:30, 60.98s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [34:00<1:33:06, 60.72s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.870, valid f1 : 0.826
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [35:07<1:35:05, 62.69s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [36:05<1:31:59, 61.32s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [37:06<1:30:43, 61.16s/it]Best score increase :0.829 -> 0.848
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [38:04<1:28:12, 60.14s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.875, valid f1 : 0.814
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [39:23<1:35:30, 65.87s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [40:24<1:32:24, 64.47s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [41:23<1:28:53, 62.75s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [42:19<1:25:10, 60.84s/it]Best score increase :0.848 -> 0.852
epoch : 45, train loss : 0.002, valid loss : 0.002, train f1 : 0.876, valid f1 : 0.850
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [43:26<1:26:41, 62.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [44:24<1:23:51, 61.36s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [45:28<1:23:36, 61.93s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:25<1:20:49, 60.62s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.002, train f1 : 0.886, valid f1 : 0.855
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [47:35<1:23:17, 63.26s/it]Best score increase :0.852 -> 0.855
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [48:32<1:19:52, 61.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [49:30<1:17:39, 60.52s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [50:28<1:15:26, 59.56s/it]EarlyStopping counter : 3 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train f1 : 0.894, valid f1 : 0.846
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [51:42<1:19:59, 63.99s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [52:42<1:17:30, 62.84s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [53:39<1:14:11, 60.98s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [54:39<1:12:52, 60.72s/it]EarlyStopping counter : 7 out of 12
epoch : 57, train loss : 0.001, valid loss : 0.003, train f1 : 0.900, valid f1 : 0.847
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [55:48<1:14:54, 63.31s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [56:50<1:13:22, 62.89s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [57:52<1:11:54, 62.53s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [58:51<1:09:44, 61.53s/it]EarlyStopping counter : 11 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.003, train f1 : 0.897, valid f1 : 0.850
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [59:57<1:07:57, 59.96s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 60, best f1 score : 0.856
training process finished, best loss : 0.003, best acc : 0.959, best f1 : 0.856, best epoch : 57

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.86      0.60      0.71       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.91      0.80      0.84      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.80, test loss : 0.173

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.84s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:25,  8.51s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:19,  8.82s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:10,  8.82s/it]processing for feature importance:  42%|████▏     | 5/12 [00:43<01:01,  8.72s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:51,  8.53s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:42,  8.57s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:09<00:35,  8.85s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:19<00:27,  9.04s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:28<00:18,  9.21s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:37<00:09,  9.13s/it]processing for feature importance: 100%|██████████| 12/12 [01:46<00:00,  9.06s/it]processing for feature importance: 100%|██████████| 12/12 [01:46<00:00,  8.88s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 31/306 [00:00<00:00, 304.00it/s] 20%|██        | 62/306 [00:00<00:00, 305.77it/s] 30%|███       | 93/306 [00:00<00:00, 234.78it/s] 39%|███▉      | 119/306 [00:00<00:00, 241.98it/s] 49%|████▉     | 150/306 [00:00<00:00, 262.57it/s] 59%|█████▉    | 181/306 [00:00<00:00, 275.21it/s] 69%|██████▉   | 211/306 [00:00<00:00, 280.26it/s] 78%|███████▊  | 240/306 [00:00<00:00, 244.39it/s] 87%|████████▋ | 266/306 [00:01<00:00, 211.01it/s] 96%|█████████▋| 295/306 [00:01<00:00, 229.70it/s]100%|██████████| 306/306 [00:01<00:00, 248.32it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 477.39it/s]extract the null data:  18%|█▊        | 97/553 [00:00<00:00, 484.25it/s]extract the null data:  27%|██▋       | 149/553 [00:00<00:00, 496.31it/s]extract the null data:  36%|███▌      | 199/553 [00:00<00:00, 455.13it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:00, 461.72it/s]extract the null data:  54%|█████▎    | 297/553 [00:00<00:00, 471.69it/s]extract the null data:  63%|██████▎   | 346/553 [00:00<00:00, 474.89it/s]extract the null data:  71%|███████   | 394/553 [00:00<00:00, 460.87it/s]extract the null data:  80%|████████  | 445/553 [00:00<00:00, 474.69it/s]extract the null data:  90%|████████▉ | 497/553 [00:01<00:00, 487.86it/s]extract the null data:  99%|█████████▉| 547/553 [00:01<00:00, 488.81it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 477.30it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 156.08it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.65it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 164.32it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 166.76it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:03, 140.60it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 151.35it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 160.83it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:03, 137.20it/s]replace nan value:  28%|██▊       | 155/553 [00:01<00:03, 121.08it/s]replace nan value:  30%|███       | 168/553 [00:01<00:03, 113.65it/s]replace nan value:  33%|███▎      | 180/553 [00:01<00:03, 101.66it/s]replace nan value:  35%|███▍      | 191/553 [00:01<00:03, 97.88it/s] replace nan value:  37%|███▋      | 202/553 [00:01<00:03, 98.39it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:03, 104.94it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:02, 123.05it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:02, 137.26it/s]replace nan value:  49%|████▉     | 270/553 [00:02<00:01, 150.70it/s]replace nan value:  52%|█████▏    | 289/553 [00:02<00:01, 160.78it/s]replace nan value:  56%|█████▌    | 307/553 [00:02<00:01, 165.50it/s]replace nan value:  59%|█████▉    | 325/553 [00:02<00:01, 168.94it/s]replace nan value:  62%|██████▏   | 343/553 [00:02<00:01, 171.84it/s]replace nan value:  65%|██████▌   | 361/553 [00:02<00:01, 173.98it/s]replace nan value:  69%|██████▊   | 380/553 [00:02<00:00, 177.61it/s]replace nan value:  72%|███████▏  | 399/553 [00:02<00:00, 178.94it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 177.62it/s]replace nan value:  79%|███████▊  | 435/553 [00:03<00:00, 149.52it/s]replace nan value:  82%|████████▏ | 451/553 [00:03<00:00, 124.38it/s]replace nan value:  84%|████████▍ | 465/553 [00:03<00:00, 112.69it/s]replace nan value:  86%|████████▋ | 478/553 [00:03<00:00, 107.03it/s]replace nan value:  89%|████████▊ | 490/553 [00:03<00:00, 98.67it/s] replace nan value:  91%|█████████ | 501/553 [00:03<00:00, 96.48it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 93.39it/s]replace nan value:  94%|█████████▍| 521/553 [00:04<00:00, 94.05it/s]replace nan value:  96%|█████████▌| 531/553 [00:04<00:00, 91.09it/s]replace nan value:  98%|█████████▊| 541/553 [00:04<00:00, 92.28it/s]replace nan value: 100%|█████████▉| 551/553 [00:04<00:00, 93.06it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 126.83it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 5/553 [00:00<00:11, 49.41it/s]  2%|▏         | 13/553 [00:00<00:08, 67.19it/s]  4%|▍         | 21/553 [00:00<00:07, 69.27it/s]  5%|▌         | 29/553 [00:00<00:07, 69.26it/s]  7%|▋         | 40/553 [00:00<00:06, 81.27it/s]  9%|▉         | 51/553 [00:00<00:05, 89.66it/s] 11%|█         | 61/553 [00:00<00:05, 92.59it/s] 14%|█▎        | 75/553 [00:00<00:04, 106.53it/s] 16%|█▋        | 90/553 [00:00<00:03, 118.43it/s] 18%|█▊        | 102/553 [00:01<00:03, 116.51it/s] 21%|██        | 114/553 [00:01<00:03, 116.47it/s] 23%|██▎       | 126/553 [00:01<00:03, 114.45it/s] 26%|██▌       | 145/553 [00:01<00:03, 135.57it/s] 29%|██▉       | 162/553 [00:01<00:02, 145.49it/s] 32%|███▏      | 178/553 [00:01<00:02, 147.82it/s] 35%|███▌      | 194/553 [00:01<00:02, 150.22it/s] 38%|███▊      | 211/553 [00:01<00:02, 154.72it/s] 41%|████      | 227/553 [00:01<00:02, 147.15it/s] 44%|████▍     | 242/553 [00:02<00:02, 139.21it/s] 46%|████▋     | 257/553 [00:02<00:02, 138.41it/s] 49%|████▉     | 271/553 [00:02<00:02, 135.06it/s] 52%|█████▏    | 286/553 [00:02<00:01, 138.37it/s] 54%|█████▍    | 300/553 [00:02<00:02, 108.66it/s] 56%|█████▋    | 312/553 [00:02<00:02, 91.93it/s]  59%|█████▉    | 327/553 [00:02<00:02, 102.41it/s] 62%|██████▏   | 342/553 [00:02<00:01, 113.12it/s] 64%|██████▍   | 355/553 [00:03<00:01, 115.01it/s] 67%|██████▋   | 368/553 [00:03<00:01, 97.05it/s]  69%|██████▉   | 383/553 [00:03<00:01, 108.48it/s] 71%|███████▏  | 395/553 [00:03<00:01, 103.40it/s] 73%|███████▎  | 406/553 [00:03<00:01, 103.51it/s] 76%|███████▌  | 418/553 [00:03<00:01, 106.40it/s] 78%|███████▊  | 429/553 [00:03<00:01, 107.31it/s] 81%|████████  | 448/553 [00:03<00:00, 127.41it/s] 84%|████████▍ | 464/553 [00:03<00:00, 133.38it/s] 86%|████████▋ | 478/553 [00:04<00:00, 133.90it/s] 89%|████████▉ | 492/553 [00:04<00:00, 118.95it/s] 91%|█████████▏| 505/553 [00:04<00:00, 119.10it/s] 94%|█████████▍| 520/553 [00:04<00:00, 126.64it/s] 96%|█████████▋| 533/553 [00:04<00:00, 109.14it/s] 99%|█████████▉| 549/553 [00:04<00:00, 120.86it/s]100%|██████████| 553/553 [00:04<00:00, 114.57it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 368.58it/s]extract the null data:  74%|███████▍  | 103/139 [00:00<00:00, 538.66it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 537.77it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 193.77it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 195.23it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 191.24it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 190.46it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 188.43it/s]replace nan value:  88%|████████▊ | 122/139 [00:00<00:00, 198.12it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 197.39it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 127.52it/s] 19%|█▉        | 27/139 [00:00<00:00, 128.84it/s] 31%|███       | 43/139 [00:00<00:00, 139.44it/s] 41%|████      | 57/139 [00:00<00:00, 121.49it/s] 51%|█████     | 71/139 [00:00<00:00, 127.18it/s] 60%|██████    | 84/139 [00:00<00:00, 120.31it/s] 70%|██████▉   | 97/139 [00:00<00:00, 94.17it/s]  78%|███████▊  | 108/139 [00:01<00:00, 92.56it/s] 90%|████████▉ | 125/139 [00:01<00:00, 110.18it/s]100%|██████████| 139/139 [00:01<00:00, 115.10it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 355.70it/s]extract the null data:  56%|█████▌    | 97/173 [00:00<00:00, 503.03it/s]extract the null data:  92%|█████████▏| 160/173 [00:00<00:00, 557.45it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 530.29it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 206.03it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 206.12it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 204.97it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 204.00it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 181.97it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 189.18it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 193.54it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 193.99it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 189.37it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.73it/s] 16%|█▌        | 28/173 [00:00<00:01, 128.03it/s] 25%|██▍       | 43/173 [00:00<00:00, 134.88it/s] 34%|███▎      | 58/173 [00:00<00:00, 140.21it/s] 42%|████▏     | 73/173 [00:00<00:00, 138.76it/s] 50%|█████     | 87/173 [00:00<00:00, 134.70it/s] 58%|█████▊    | 101/173 [00:00<00:00, 135.51it/s] 68%|██████▊   | 117/173 [00:00<00:00, 142.99it/s] 76%|███████▋  | 132/173 [00:00<00:00, 133.86it/s] 84%|████████▍ | 146/173 [00:01<00:00, 134.38it/s] 92%|█████████▏| 160/173 [00:01<00:00, 125.45it/s]100%|██████████| 173/173 [00:01<00:00, 100.26it/s]100%|██████████| 173/173 [00:01<00:00, 123.44it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.010, train f1 : 0.705, valid f1 : 0.575
training process - Deferred Re-weighting:   1%|          | 1/128 [01:17<2:43:41, 77.34s/it]Best score increase :0.000 -> 0.575
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:20<2:25:10, 69.13s/it]Best score increase :0.575 -> 0.610
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:21<2:15:52, 65.22s/it]Best score increase :0.610 -> 0.648
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:21<2:10:24, 63.10s/it]Best score increase :0.648 -> 0.652
epoch : 5, train loss : 0.008, valid loss : 0.008, train f1 : 0.821, valid f1 : 0.681
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:31<2:14:37, 65.67s/it]Best score increase :0.652 -> 0.681
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:29<2:08:24, 63.15s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:27<2:03:46, 61.37s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:23<1:59:13, 59.61s/it]Best score increase :0.681 -> 0.712
epoch : 9, train loss : 0.007, valid loss : 0.007, train f1 : 0.841, valid f1 : 0.690
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:21<1:57:33, 59.27s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:11<1:50:38, 56.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:00<1:45:25, 54.07s/it]Best score increase :0.712 -> 0.717
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:49<1:41:43, 52.61s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.006, train f1 : 0.880, valid f1 : 0.703
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:51<1:46:23, 55.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:41<1:41:54, 53.64s/it]Best score increase :0.717 -> 0.721
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:28<1:37:19, 51.68s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:15<1:33:43, 50.21s/it]Best score increase :0.721 -> 0.742
epoch : 17, train loss : 0.005, valid loss : 0.006, train f1 : 0.903, valid f1 : 0.716
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [16:09<1:35:22, 51.55s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:57<1:32:16, 50.34s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:45<1:30:16, 49.69s/it]Best score increase :0.742 -> 0.746
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:33<1:28:45, 49.31s/it]Best score increase :0.746 -> 0.765
epoch : 21, train loss : 0.004, valid loss : 0.005, train f1 : 0.910, valid f1 : 0.735
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:29<1:31:22, 51.24s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:18<1:29:12, 50.50s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:05<1:26:34, 49.47s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:53<1:24:58, 49.03s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.005, train f1 : 0.921, valid f1 : 0.746
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:49<1:27:35, 51.02s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:40<1:26:54, 51.13s/it]Best score increase :0.765 -> 0.776
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:27<1:23:55, 49.86s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:16<1:22:56, 49.76s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.005, train f1 : 0.928, valid f1 : 0.757
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:11<1:24:41, 51.32s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:01<1:22:50, 50.72s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:48<1:20:30, 49.80s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:37<1:19:02, 49.40s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.003, valid loss : 0.005, train f1 : 0.934, valid f1 : 0.748
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:36<1:22:46, 52.28s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [30:26<1:20:49, 51.60s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:16<1:19:20, 51.19s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [32:06<1:18:00, 50.87s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.006, train f1 : 0.938, valid f1 : 0.740
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:05<1:20:49, 53.29s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:54<1:23:23, 54.99s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.776
training process finished, best loss : 0.004, best acc : 0.910, best f1 : 0.776, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.53      0.79      0.63       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.87      0.80      7398
weighted avg       0.95      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.87, test loss : 0.226

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.20s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.94s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:08,  7.64s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.52s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.58s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.60s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.62s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  8.00s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:24,  8.03s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:16,  8.04s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.92s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.70s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.78s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  9%|▉         | 28/306 [00:00<00:01, 276.82it/s] 18%|█▊        | 56/306 [00:00<00:00, 273.48it/s] 28%|██▊       | 85/306 [00:00<00:00, 279.67it/s] 37%|███▋      | 113/306 [00:00<00:00, 279.16it/s] 46%|████▌     | 141/306 [00:00<00:00, 274.99it/s] 56%|█████▌    | 170/306 [00:00<00:00, 276.84it/s] 65%|██████▍   | 198/306 [00:00<00:00, 275.28it/s] 75%|███████▌  | 230/306 [00:00<00:00, 286.23it/s] 87%|████████▋ | 267/306 [00:00<00:00, 309.99it/s]100%|██████████| 306/306 [00:01<00:00, 302.92it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:01, 439.38it/s]extract the null data:  16%|█▌        | 88/553 [00:00<00:01, 437.77it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:00, 438.27it/s]extract the null data:  32%|███▏      | 178/553 [00:00<00:00, 443.15it/s]extract the null data:  41%|████      | 224/553 [00:00<00:00, 447.24it/s]extract the null data:  49%|████▊     | 269/553 [00:00<00:00, 446.58it/s]extract the null data:  57%|█████▋    | 315/553 [00:00<00:00, 449.99it/s]extract the null data:  65%|██████▌   | 360/553 [00:00<00:00, 441.53it/s]extract the null data:  73%|███████▎  | 405/553 [00:00<00:00, 442.55it/s]extract the null data:  81%|████████▏ | 450/553 [00:01<00:00, 374.97it/s]extract the null data:  89%|████████▉ | 494/553 [00:01<00:00, 390.08it/s]extract the null data:  97%|█████████▋| 538/553 [00:01<00:00, 403.04it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 420.82it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 164.21it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 159.81it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 160.83it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:03, 157.45it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 161.89it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 163.65it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 162.49it/s]replace nan value:  25%|██▍       | 137/553 [00:00<00:02, 162.91it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 166.83it/s]replace nan value:  31%|███       | 172/553 [00:01<00:02, 166.13it/s]replace nan value:  34%|███▍      | 189/553 [00:01<00:02, 166.09it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:02, 166.28it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 165.94it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 163.04it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:01, 164.02it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 164.78it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 166.08it/s]replace nan value:  56%|█████▌    | 308/553 [00:01<00:01, 163.07it/s]replace nan value:  59%|█████▉    | 325/553 [00:01<00:01, 164.90it/s]replace nan value:  62%|██████▏   | 342/553 [00:02<00:01, 165.33it/s]replace nan value:  65%|██████▍   | 359/553 [00:02<00:01, 165.03it/s]replace nan value:  68%|██████▊   | 376/553 [00:02<00:01, 164.93it/s]replace nan value:  71%|███████   | 393/553 [00:02<00:00, 161.76it/s]replace nan value:  74%|███████▍  | 410/553 [00:02<00:00, 163.44it/s]replace nan value:  77%|███████▋  | 427/553 [00:02<00:00, 163.66it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 164.47it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 165.72it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 162.67it/s]replace nan value:  90%|████████▉ | 495/553 [00:03<00:00, 162.71it/s]replace nan value:  93%|█████████▎| 512/553 [00:03<00:00, 164.72it/s]replace nan value:  96%|█████████▌| 529/553 [00:03<00:00, 164.88it/s]replace nan value:  99%|█████████▊| 546/553 [00:03<00:00, 165.12it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 163.97it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 118.14it/s]  5%|▍         | 26/553 [00:00<00:04, 129.04it/s]  7%|▋         | 40/553 [00:00<00:03, 128.51it/s] 10%|▉         | 53/553 [00:00<00:04, 118.16it/s] 12%|█▏        | 65/553 [00:00<00:04, 109.00it/s] 14%|█▍        | 78/553 [00:00<00:04, 114.81it/s] 16%|█▋        | 91/553 [00:00<00:03, 117.17it/s] 19%|█▊        | 103/553 [00:00<00:03, 117.77it/s] 22%|██▏       | 119/553 [00:00<00:03, 129.73it/s] 24%|██▍       | 133/553 [00:01<00:03, 128.03it/s] 27%|██▋       | 151/553 [00:01<00:02, 139.66it/s] 30%|███       | 168/553 [00:01<00:02, 147.87it/s] 33%|███▎      | 183/553 [00:01<00:02, 143.42it/s] 36%|███▌      | 199/553 [00:01<00:02, 146.35it/s] 39%|███▉      | 215/553 [00:01<00:02, 147.92it/s] 42%|████▏     | 230/553 [00:01<00:02, 136.67it/s] 44%|████▍     | 244/553 [00:01<00:02, 134.95it/s] 47%|████▋     | 258/553 [00:01<00:02, 136.11it/s] 49%|████▉     | 272/553 [00:02<00:02, 131.63it/s] 52%|█████▏    | 286/553 [00:02<00:02, 133.14it/s] 54%|█████▍    | 300/553 [00:02<00:02, 125.54it/s] 57%|█████▋    | 313/553 [00:02<00:01, 121.03it/s] 59%|█████▉    | 326/553 [00:02<00:01, 121.95it/s] 61%|██████▏   | 339/553 [00:02<00:01, 123.18it/s] 64%|██████▎   | 352/553 [00:02<00:01, 123.77it/s] 66%|██████▌   | 365/553 [00:02<00:01, 119.12it/s] 69%|██████▊   | 379/553 [00:02<00:01, 123.41it/s] 71%|███████   | 392/553 [00:03<00:01, 113.62it/s] 73%|███████▎  | 404/553 [00:03<00:01, 113.09it/s] 75%|███████▌  | 416/553 [00:03<00:01, 112.81it/s] 77%|███████▋  | 428/553 [00:03<00:01, 108.52it/s] 80%|████████  | 445/553 [00:03<00:00, 123.57it/s] 83%|████████▎ | 460/553 [00:03<00:00, 128.46it/s] 86%|████████▌ | 474/553 [00:03<00:00, 130.57it/s] 88%|████████▊ | 488/553 [00:03<00:00, 125.78it/s] 91%|█████████ | 501/553 [00:03<00:00, 117.93it/s] 93%|█████████▎| 515/553 [00:04<00:00, 123.41it/s] 95%|█████████▌| 528/553 [00:04<00:00, 108.22it/s] 98%|█████████▊| 540/553 [00:04<00:00, 109.79it/s]100%|█████████▉| 552/553 [00:04<00:00, 96.74it/s] 100%|██████████| 553/553 [00:04<00:00, 122.23it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 286.32it/s]extract the null data:  60%|█████▉    | 83/139 [00:00<00:00, 434.40it/s]extract the null data:  97%|█████████▋| 135/139 [00:00<00:00, 470.75it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 447.11it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 181.40it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 182.92it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 187.19it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 186.23it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 183.21it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 182.17it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 183.73it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 184.12it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.33it/s] 17%|█▋        | 23/139 [00:00<00:01, 113.99it/s] 27%|██▋       | 37/139 [00:00<00:00, 123.04it/s] 36%|███▌      | 50/139 [00:00<00:00, 124.95it/s] 45%|████▌     | 63/139 [00:00<00:00, 120.86it/s] 55%|█████▍    | 76/139 [00:00<00:00, 120.90it/s] 64%|██████▍   | 89/139 [00:00<00:00, 108.72it/s] 75%|███████▍  | 104/139 [00:00<00:00, 118.33it/s] 86%|████████▌ | 119/139 [00:00<00:00, 126.25it/s] 95%|█████████▍| 132/139 [00:01<00:00, 124.44it/s]100%|██████████| 139/139 [00:01<00:00, 123.35it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 257.60it/s]extract the null data:  54%|█████▍    | 94/173 [00:00<00:00, 500.70it/s]extract the null data:  96%|█████████▌| 166/173 [00:00<00:00, 596.54it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 550.13it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 223.11it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 219.71it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 214.32it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 211.34it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 206.87it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 204.01it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 203.28it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 205.76it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 148.43it/s] 17%|█▋        | 30/173 [00:00<00:01, 136.55it/s] 28%|██▊       | 48/173 [00:00<00:00, 153.32it/s] 38%|███▊      | 65/173 [00:00<00:00, 155.14it/s] 47%|████▋     | 82/173 [00:00<00:00, 157.99it/s] 57%|█████▋    | 98/173 [00:00<00:00, 156.20it/s] 67%|██████▋   | 116/173 [00:00<00:00, 159.57it/s] 76%|███████▋  | 132/173 [00:00<00:00, 149.43it/s] 86%|████████▌ | 148/173 [00:00<00:00, 147.78it/s] 94%|█████████▍| 163/173 [00:01<00:00, 135.55it/s]100%|██████████| 173/173 [00:01<00:00, 134.19it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.519, valid loss : 0.379, train acc : 0.816, valid acc : 0.922, train f1 : 0.544, valid f1 : 0.577
training process:   1%|          | 1/128 [01:04<2:16:48, 64.63s/it]Best score increase :0.000 -> 0.577
training process:   2%|▏         | 2/128 [02:15<2:22:56, 68.07s/it]Best score increase :0.577 -> 0.606
training process:   2%|▏         | 3/128 [03:20<2:19:12, 66.82s/it]Best score increase :0.606 -> 0.631
training process:   3%|▎         | 4/128 [04:27<2:18:23, 66.97s/it]Best score increase :0.631 -> 0.667
epoch : 5, train loss : 0.199, valid loss : 0.206, train acc : 0.936, valid acc : 0.930, train f1 : 0.686, valid f1 : 0.663
training process:   4%|▍         | 5/128 [05:47<2:26:49, 71.62s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [06:53<2:22:04, 69.87s/it]Best score increase :0.667 -> 0.709
training process:   5%|▌         | 7/128 [07:59<2:18:17, 68.57s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:08<2:17:19, 68.67s/it]Best score increase :0.709 -> 0.711
epoch : 9, train loss : 0.172, valid loss : 0.190, train acc : 0.941, valid acc : 0.937, train f1 : 0.727, valid f1 : 0.724
training process:   7%|▋         | 9/128 [10:28<2:23:16, 72.24s/it]Best score increase :0.711 -> 0.724
training process:   8%|▊         | 10/128 [11:33<2:17:32, 69.94s/it]Best score increase :0.724 -> 0.727
training process:   9%|▊         | 11/128 [12:38<2:13:32, 68.48s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [13:46<2:11:54, 68.23s/it]Best score increase :0.727 -> 0.740
epoch : 13, train loss : 0.157, valid loss : 0.181, train acc : 0.947, valid acc : 0.939, train f1 : 0.763, valid f1 : 0.742
training process:  10%|█         | 13/128 [15:03<2:15:35, 70.75s/it]Best score increase :0.740 -> 0.742
training process:  11%|█         | 14/128 [16:03<2:08:31, 67.64s/it]Best score increase :0.742 -> 0.744
training process:  12%|█▏        | 15/128 [17:06<2:04:38, 66.18s/it]Best score increase :0.744 -> 0.753
training process:  12%|█▎        | 16/128 [18:10<2:02:22, 65.55s/it]Best score increase :0.753 -> 0.760
epoch : 17, train loss : 0.142, valid loss : 0.174, train acc : 0.952, valid acc : 0.943, train f1 : 0.790, valid f1 : 0.770
training process:  13%|█▎        | 17/128 [19:20<2:04:04, 67.06s/it]Best score increase :0.760 -> 0.770
training process:  14%|█▍        | 18/128 [20:13<1:55:09, 62.82s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [21:04<1:47:29, 59.17s/it]Best score increase :0.770 -> 0.774
training process:  16%|█▌        | 20/128 [21:56<1:42:35, 56.99s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.134, valid loss : 0.162, train acc : 0.954, valid acc : 0.947, train f1 : 0.806, valid f1 : 0.790
training process:  16%|█▋        | 21/128 [22:57<1:43:37, 58.11s/it]Best score increase :0.774 -> 0.790
training process:  17%|█▋        | 22/128 [23:50<1:40:18, 56.78s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [24:44<1:37:55, 55.95s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [25:35<1:34:25, 54.47s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.127, valid loss : 0.156, train acc : 0.956, valid acc : 0.948, train f1 : 0.819, valid f1 : 0.795
training process:  20%|█▉        | 25/128 [26:35<1:36:09, 56.01s/it]Best score increase :0.790 -> 0.795
training process:  20%|██        | 26/128 [27:29<1:34:14, 55.44s/it]Best score increase :0.795 -> 0.797
training process:  21%|██        | 27/128 [28:17<1:29:45, 53.32s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [29:08<1:27:29, 52.50s/it]Best score increase :0.797 -> 0.808
epoch : 29, train loss : 0.117, valid loss : 0.156, train acc : 0.960, valid acc : 0.949, train f1 : 0.838, valid f1 : 0.796
training process:  23%|██▎       | 29/128 [30:07<1:29:53, 54.48s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [30:59<1:27:42, 53.70s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [31:49<1:24:56, 52.55s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [32:45<1:25:41, 53.56s/it]Best score increase :0.808 -> 0.816
epoch : 33, train loss : 0.110, valid loss : 0.151, train acc : 0.962, valid acc : 0.950, train f1 : 0.849, valid f1 : 0.802
training process:  26%|██▌       | 33/128 [33:44<1:27:39, 55.36s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [34:33<1:23:32, 53.32s/it]Best score increase :0.816 -> 0.829
training process:  27%|██▋       | 35/128 [35:23<1:21:04, 52.31s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [36:13<1:19:22, 51.77s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.104, valid loss : 0.149, train acc : 0.964, valid acc : 0.953, train f1 : 0.860, valid f1 : 0.819
training process:  29%|██▉       | 37/128 [37:13<1:21:50, 53.96s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [38:02<1:19:09, 52.77s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [38:51<1:16:22, 51.49s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [39:40<1:14:18, 50.67s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.101, valid loss : 0.146, train acc : 0.966, valid acc : 0.954, train f1 : 0.867, valid f1 : 0.828
training process:  32%|███▏      | 41/128 [40:37<1:16:15, 52.60s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [41:26<1:13:56, 51.59s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [42:15<1:12:09, 50.93s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [43:08<1:11:49, 51.30s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.097, valid loss : 0.150, train acc : 0.967, valid acc : 0.955, train f1 : 0.872, valid f1 : 0.831
training process:  35%|███▌      | 45/128 [44:08<1:14:31, 53.88s/it]Best score increase :0.829 -> 0.831
training process:  36%|███▌      | 46/128 [44:57<1:11:47, 52.53s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [45:48<1:10:19, 52.09s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [46:37<1:08:15, 51.20s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.092, valid loss : 0.159, train acc : 0.967, valid acc : 0.954, train f1 : 0.875, valid f1 : 0.825
training process:  38%|███▊      | 49/128 [47:35<1:10:10, 53.30s/it]EarlyStopping counter : 4 out of 12
training process:  39%|███▉      | 50/128 [48:26<1:08:17, 52.53s/it]Best score increase :0.831 -> 0.834
training process:  40%|███▉      | 51/128 [49:16<1:06:36, 51.90s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [50:15<1:08:15, 53.89s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.090, valid loss : 0.162, train acc : 0.969, valid acc : 0.955, train f1 : 0.880, valid f1 : 0.832
training process:  41%|████▏     | 53/128 [51:23<1:12:46, 58.22s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [52:28<1:14:08, 60.11s/it]Best score increase :0.834 -> 0.835
training process:  43%|████▎     | 55/128 [53:28<1:13:07, 60.10s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [54:29<1:12:37, 60.52s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.086, valid loss : 0.169, train acc : 0.969, valid acc : 0.956, train f1 : 0.883, valid f1 : 0.841
training process:  45%|████▍     | 57/128 [55:41<1:15:25, 63.74s/it]Best score increase :0.835 -> 0.841
training process:  45%|████▌     | 58/128 [56:40<1:12:51, 62.45s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [57:42<1:11:42, 62.35s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [58:46<1:11:09, 62.78s/it]EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.085, valid loss : 0.167, train acc : 0.970, valid acc : 0.956, train f1 : 0.888, valid f1 : 0.838
training process:  48%|████▊     | 61/128 [1:00:00<1:13:52, 66.15s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [1:01:07<1:13:03, 66.41s/it]EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [1:02:15<1:12:28, 66.90s/it]EarlyStopping counter : 6 out of 12
training process:  50%|█████     | 64/128 [1:03:24<1:11:55, 67.43s/it]EarlyStopping counter : 7 out of 12
epoch : 65, train loss : 0.082, valid loss : 0.193, train acc : 0.971, valid acc : 0.955, train f1 : 0.891, valid f1 : 0.834
training process:  51%|█████     | 65/128 [1:04:47<1:15:45, 72.15s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 66/128 [1:05:55<1:13:15, 70.90s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 67/128 [1:07:04<1:11:24, 70.23s/it]EarlyStopping counter : 10 out of 12
training process:  53%|█████▎    | 68/128 [1:08:09<1:08:55, 68.93s/it]EarlyStopping counter : 11 out of 12
epoch : 69, train loss : 0.081, valid loss : 0.191, train acc : 0.971, valid acc : 0.955, train f1 : 0.892, valid f1 : 0.834
training process:  53%|█████▎    | 68/128 [1:09:27<1:01:16, 61.28s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 68, best f1 score : 0.841
training process finished, best loss : 0.169 and best acc : 0.956, best f1 : 0.841, best epoch : 56

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.81      0.63      0.71       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.89      0.81      0.84      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.81, test loss : 8.967

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:12<02:13, 12.13s/it]processing for feature importance:  17%|█▋        | 2/12 [00:22<01:49, 10.95s/it]processing for feature importance:  25%|██▌       | 3/12 [00:33<01:38, 10.96s/it]processing for feature importance:  33%|███▎      | 4/12 [00:44<01:29, 11.20s/it]processing for feature importance:  42%|████▏     | 5/12 [00:54<01:14, 10.60s/it]processing for feature importance:  50%|█████     | 6/12 [01:05<01:05, 10.93s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:15<00:52, 10.49s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:26<00:42, 10.58s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:35<00:30, 10.31s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:46<00:20, 10.28s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:56<00:10, 10.32s/it]processing for feature importance: 100%|██████████| 12/12 [02:07<00:00, 10.45s/it]processing for feature importance: 100%|██████████| 12/12 [02:07<00:00, 10.61s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 31/306 [00:00<00:00, 300.34it/s] 20%|██        | 62/306 [00:00<00:00, 304.95it/s] 31%|███       | 94/306 [00:00<00:00, 307.79it/s] 42%|████▏     | 127/306 [00:00<00:00, 315.86it/s] 52%|█████▏    | 160/306 [00:00<00:00, 318.44it/s] 63%|██████▎   | 193/306 [00:00<00:00, 319.72it/s] 74%|███████▍  | 226/306 [00:00<00:00, 320.28it/s] 85%|████████▍ | 259/306 [00:00<00:00, 320.41it/s] 95%|█████████▌| 292/306 [00:00<00:00, 317.31it/s]100%|██████████| 306/306 [00:00<00:00, 315.40it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 577.65it/s]extract the null data:  22%|██▏       | 119/553 [00:00<00:00, 593.89it/s]extract the null data:  33%|███▎      | 181/553 [00:00<00:00, 603.14it/s]extract the null data:  44%|████▍     | 243/553 [00:00<00:00, 608.95it/s]extract the null data:  55%|█████▌    | 305/553 [00:00<00:00, 612.13it/s]extract the null data:  66%|██████▋   | 367/553 [00:00<00:00, 454.81it/s]extract the null data:  77%|███████▋  | 425/553 [00:00<00:00, 486.67it/s]extract the null data:  86%|████████▋ | 478/553 [00:00<00:00, 435.41it/s]extract the null data:  95%|█████████▌| 526/553 [00:01<00:00, 345.79it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 426.36it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 10/553 [00:00<00:07, 77.07it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:06, 87.85it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:04, 123.96it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:03, 138.51it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:03, 150.53it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 159.26it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 164.09it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 167.01it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 154.88it/s]replace nan value:  29%|██▉       | 163/553 [00:01<00:02, 162.68it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 167.34it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:02, 161.36it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:02, 149.87it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:02, 157.75it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 163.44it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 166.53it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 170.31it/s]replace nan value:  55%|█████▌    | 305/553 [00:01<00:01, 171.56it/s]replace nan value:  59%|█████▊    | 324/553 [00:02<00:01, 175.67it/s]replace nan value:  62%|██████▏   | 342/553 [00:02<00:01, 175.46it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 174.74it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:00, 175.67it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 175.50it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 176.29it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 175.30it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 176.04it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 169.90it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 166.92it/s]replace nan value:  91%|█████████ | 503/553 [00:03<00:00, 147.11it/s]replace nan value:  94%|█████████▍| 519/553 [00:03<00:00, 146.09it/s]replace nan value:  97%|█████████▋| 534/553 [00:03<00:00, 146.87it/s]replace nan value: 100%|█████████▉| 551/553 [00:03<00:00, 150.55it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 159.29it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 132.13it/s]  5%|▌         | 28/553 [00:00<00:04, 119.94it/s]  7%|▋         | 41/553 [00:00<00:04, 119.33it/s] 10%|▉         | 53/553 [00:00<00:05, 99.66it/s]  12%|█▏        | 64/553 [00:00<00:05, 82.38it/s] 14%|█▍        | 77/553 [00:00<00:05, 94.13it/s] 16%|█▋        | 91/553 [00:00<00:04, 103.99it/s] 19%|█▊        | 103/553 [00:00<00:04, 107.63it/s] 21%|██        | 115/553 [00:01<00:04, 107.50it/s] 23%|██▎       | 128/553 [00:01<00:03, 113.32it/s] 26%|██▋       | 146/553 [00:01<00:03, 131.07it/s] 29%|██▉       | 162/553 [00:01<00:02, 138.21it/s] 32%|███▏      | 177/553 [00:01<00:02, 136.40it/s] 35%|███▍      | 192/553 [00:01<00:02, 140.01it/s] 38%|███▊      | 210/553 [00:01<00:02, 147.74it/s] 41%|████      | 225/553 [00:01<00:02, 135.19it/s] 43%|████▎     | 240/553 [00:01<00:02, 138.40it/s] 46%|████▌     | 255/553 [00:02<00:02, 133.53it/s] 49%|████▊     | 269/553 [00:02<00:02, 134.73it/s] 51%|█████     | 283/553 [00:02<00:02, 119.28it/s] 54%|█████▎    | 296/553 [00:02<00:02, 120.88it/s] 56%|█████▌    | 309/553 [00:02<00:01, 122.77it/s] 58%|█████▊    | 322/553 [00:02<00:01, 118.82it/s] 61%|██████    | 336/553 [00:02<00:01, 123.34it/s] 63%|██████▎   | 349/553 [00:02<00:01, 122.91it/s] 65%|██████▌   | 362/553 [00:03<00:01, 112.90it/s] 68%|██████▊   | 377/553 [00:03<00:01, 120.70it/s] 71%|███████   | 390/553 [00:03<00:01, 112.08it/s] 73%|███████▎  | 402/553 [00:03<00:01, 113.47it/s] 75%|███████▍  | 414/553 [00:03<00:01, 111.05it/s] 77%|███████▋  | 426/553 [00:03<00:01, 105.14it/s] 80%|███████▉  | 440/553 [00:03<00:00, 114.24it/s] 82%|████████▏ | 456/553 [00:03<00:00, 121.44it/s] 85%|████████▍ | 469/553 [00:03<00:00, 123.22it/s] 87%|████████▋ | 482/553 [00:04<00:00, 123.48it/s] 90%|████████▉ | 495/553 [00:04<00:00, 105.24it/s] 92%|█████████▏| 510/553 [00:04<00:00, 115.06it/s] 94%|█████████▍| 522/553 [00:04<00:00, 111.55it/s] 97%|█████████▋| 534/553 [00:04<00:00, 102.98it/s] 99%|█████████▉| 549/553 [00:04<00:00, 113.74it/s]100%|██████████| 553/553 [00:04<00:00, 116.08it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 25/139 [00:00<00:00, 246.52it/s]extract the null data:  55%|█████▌    | 77/139 [00:00<00:00, 405.06it/s]extract the null data:  96%|█████████▋| 134/139 [00:00<00:00, 476.98it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 445.27it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 190.67it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 190.01it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 189.82it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 190.14it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 189.36it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 189.51it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 190.04it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 189.79it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.08it/s] 16%|█▌        | 22/139 [00:00<00:01, 105.72it/s] 25%|██▌       | 35/139 [00:00<00:00, 115.74it/s] 35%|███▍      | 48/139 [00:00<00:00, 116.71it/s] 44%|████▍     | 61/139 [00:00<00:00, 117.83it/s] 54%|█████▍    | 75/139 [00:00<00:00, 121.11it/s] 63%|██████▎   | 88/139 [00:00<00:00, 103.47it/s] 73%|███████▎  | 101/139 [00:00<00:00, 109.72it/s] 81%|████████▏ | 113/139 [00:01<00:00, 108.10it/s] 93%|█████████▎| 129/139 [00:01<00:00, 119.87it/s]100%|██████████| 139/139 [00:01<00:00, 114.35it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  10%|▉         | 17/173 [00:00<00:00, 167.65it/s]extract the null data:  42%|████▏     | 72/173 [00:00<00:00, 364.45it/s]extract the null data:  62%|██████▏   | 108/173 [00:00<00:00, 314.11it/s]extract the null data:  95%|█████████▍| 164/173 [00:00<00:00, 397.78it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 369.01it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 179.34it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 179.97it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 181.56it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 180.99it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 180.65it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 166.13it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 173.14it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 153.80it/s]replace nan value:  98%|█████████▊| 170/173 [00:01<00:00, 162.52it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 168.80it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  7%|▋         | 12/173 [00:00<00:01, 117.72it/s] 14%|█▍        | 24/173 [00:00<00:01, 113.51it/s] 23%|██▎       | 39/173 [00:00<00:01, 126.41it/s] 32%|███▏      | 56/173 [00:00<00:00, 141.19it/s] 41%|████      | 71/173 [00:00<00:00, 118.92it/s] 49%|████▊     | 84/173 [00:00<00:00, 97.03it/s]  55%|█████▍    | 95/173 [00:00<00:00, 88.61it/s] 61%|██████    | 105/173 [00:01<00:00, 84.11it/s] 66%|██████▌   | 114/173 [00:01<00:00, 85.30it/s] 71%|███████   | 123/173 [00:01<00:00, 81.06it/s] 79%|███████▉  | 137/173 [00:01<00:00, 95.62it/s] 86%|████████▌ | 149/173 [00:01<00:00, 101.37it/s] 93%|█████████▎| 161/173 [00:01<00:00, 103.50it/s] 99%|█████████▉| 172/173 [00:01<00:00, 84.19it/s] 100%|██████████| 173/173 [00:01<00:00, 96.28it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.566, valid loss : 0.498, train acc : 0.701, valid acc : 0.760, train f1 : 0.700, valid f1 : 0.595
training process:   1%|          | 1/128 [01:21<2:51:33, 81.05s/it]Best score increase :0.000 -> 0.595
training process:   2%|▏         | 2/128 [02:25<2:29:41, 71.29s/it]Best score increase :0.595 -> 0.634
training process:   2%|▏         | 3/128 [03:30<2:22:16, 68.29s/it]Best score increase :0.634 -> 0.674
training process:   3%|▎         | 4/128 [04:38<2:21:24, 68.42s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.417, valid loss : 0.385, train acc : 0.810, valid acc : 0.863, train f1 : 0.810, valid f1 : 0.697
training process:   4%|▍         | 5/128 [05:56<2:27:05, 71.75s/it]Best score increase :0.674 -> 0.697
training process:   5%|▍         | 6/128 [06:58<2:19:06, 68.41s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [07:55<2:10:34, 64.75s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [08:53<2:05:07, 62.56s/it]EarlyStopping counter : 3 out of 12
epoch : 9, train loss : 0.355, valid loss : 0.414, train acc : 0.844, valid acc : 0.845, train f1 : 0.844, valid f1 : 0.689
training process:   7%|▋         | 9/128 [10:02<2:07:47, 64.43s/it]EarlyStopping counter : 4 out of 12
training process:   8%|▊         | 10/128 [10:54<1:59:23, 60.71s/it]Best score increase :0.697 -> 0.715
training process:   9%|▊         | 11/128 [11:44<1:51:59, 57.43s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [12:36<1:47:39, 55.69s/it]Best score increase :0.715 -> 0.722
epoch : 13, train loss : 0.298, valid loss : 0.331, train acc : 0.874, valid acc : 0.880, train f1 : 0.874, valid f1 : 0.731
training process:  10%|█         | 13/128 [13:44<1:54:11, 59.58s/it]Best score increase :0.722 -> 0.731
training process:  11%|█         | 14/128 [14:33<1:47:13, 56.43s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [15:24<1:42:46, 54.57s/it]Best score increase :0.731 -> 0.733
training process:  12%|█▎        | 16/128 [16:16<1:40:29, 53.83s/it]Best score increase :0.733 -> 0.743
epoch : 17, train loss : 0.262, valid loss : 0.320, train acc : 0.890, valid acc : 0.876, train f1 : 0.890, valid f1 : 0.732
training process:  13%|█▎        | 17/128 [17:17<1:43:35, 55.99s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [18:08<1:39:59, 54.54s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [19:03<1:39:36, 54.83s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [19:55<1:36:55, 53.84s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.229, valid loss : 0.325, train acc : 0.904, valid acc : 0.870, train f1 : 0.904, valid f1 : 0.724
training process:  16%|█▋        | 21/128 [20:54<1:38:34, 55.28s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [21:44<1:35:05, 53.83s/it]Best score increase :0.743 -> 0.774
training process:  18%|█▊        | 23/128 [22:34<1:32:20, 52.77s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [23:26<1:31:09, 52.59s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.215, valid loss : 0.259, train acc : 0.914, valid acc : 0.899, train f1 : 0.914, valid f1 : 0.761
training process:  20%|█▉        | 25/128 [24:29<1:35:21, 55.55s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [25:19<1:31:52, 54.04s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [26:10<1:29:11, 52.98s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [27:00<1:26:45, 52.06s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.194, valid loss : 0.273, train acc : 0.925, valid acc : 0.900, train f1 : 0.925, valid f1 : 0.766
training process:  23%|██▎       | 29/128 [28:01<1:30:20, 54.75s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [28:50<1:26:28, 52.94s/it]EarlyStopping counter : 8 out of 12
training process:  24%|██▍       | 31/128 [29:40<1:24:18, 52.15s/it]EarlyStopping counter : 9 out of 12
training process:  25%|██▌       | 32/128 [30:31<1:22:55, 51.83s/it]EarlyStopping counter : 10 out of 12
epoch : 33, train loss : 0.188, valid loss : 0.227, train acc : 0.925, valid acc : 0.917, train f1 : 0.925, valid f1 : 0.788
training process:  26%|██▌       | 33/128 [31:33<1:26:50, 54.85s/it]Best score increase :0.774 -> 0.788
training process:  27%|██▋       | 34/128 [32:23<1:23:55, 53.57s/it]Best score increase :0.788 -> 0.791
training process:  27%|██▋       | 35/128 [33:12<1:20:27, 51.91s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [34:00<1:18:10, 50.98s/it]Best score increase :0.791 -> 0.797
epoch : 37, train loss : 0.183, valid loss : 0.207, train acc : 0.927, valid acc : 0.934, train f1 : 0.927, valid f1 : 0.817
training process:  29%|██▉       | 37/128 [35:01<1:21:38, 53.83s/it]Best score increase :0.797 -> 0.817
training process:  30%|██▉       | 38/128 [35:53<1:20:07, 53.41s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [36:52<1:21:29, 54.94s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [37:52<1:22:56, 56.55s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.163, valid loss : 0.251, train acc : 0.936, valid acc : 0.910, train f1 : 0.936, valid f1 : 0.781
training process:  32%|███▏      | 41/128 [39:06<1:29:38, 61.83s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [40:08<1:28:27, 61.72s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [41:07<1:26:26, 61.02s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [42:06<1:24:44, 60.53s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.163, valid loss : 0.240, train acc : 0.938, valid acc : 0.919, train f1 : 0.938, valid f1 : 0.797
training process:  35%|███▌      | 45/128 [43:27<1:31:51, 66.40s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [44:33<1:30:45, 66.41s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [45:40<1:29:59, 66.66s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [46:47<1:28:50, 66.63s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.154, valid loss : 0.260, train acc : 0.939, valid acc : 0.901, train f1 : 0.939, valid f1 : 0.766
training process:  38%|███▊      | 48/128 [48:09<1:20:15, 60.20s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.817
training process finished, best loss : 0.207 and best acc : 0.934, best f1 : 0.817, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.78      0.64       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.86      0.80      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.86, test loss : 11.204

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:08, 11.70s/it]processing for feature importance:  17%|█▋        | 2/12 [00:22<01:52, 11.24s/it]processing for feature importance:  25%|██▌       | 3/12 [00:33<01:41, 11.26s/it]processing for feature importance:  33%|███▎      | 4/12 [00:44<01:28, 11.01s/it]processing for feature importance:  42%|████▏     | 5/12 [00:56<01:19, 11.30s/it]processing for feature importance:  50%|█████     | 6/12 [01:06<01:06, 11.08s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:16<00:53, 10.73s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:29<00:44, 11.16s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:39<00:32, 10.83s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:49<00:21, 10.76s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:00<00:10, 10.69s/it]processing for feature importance: 100%|██████████| 12/12 [02:11<00:00, 10.98s/it]processing for feature importance: 100%|██████████| 12/12 [02:11<00:00, 11.00s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 14%|█▍        | 44/306 [00:00<00:00, 432.66it/s] 29%|██▉       | 88/306 [00:00<00:00, 433.81it/s] 43%|████▎     | 132/306 [00:00<00:00, 435.94it/s] 58%|█████▊    | 177/306 [00:00<00:00, 439.49it/s] 73%|███████▎  | 222/306 [00:00<00:00, 441.88it/s] 87%|████████▋ | 267/306 [00:00<00:00, 254.33it/s] 98%|█████████▊| 301/306 [00:00<00:00, 242.40it/s]100%|██████████| 306/306 [00:01<00:00, 305.86it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 478.30it/s]extract the null data:  18%|█▊        | 97/553 [00:00<00:00, 482.09it/s]extract the null data:  26%|██▋       | 146/553 [00:00<00:00, 480.24it/s]extract the null data:  35%|███▌      | 196/553 [00:00<00:00, 485.43it/s]extract the null data:  44%|████▍     | 245/553 [00:00<00:00, 467.27it/s]extract the null data:  53%|█████▎    | 292/553 [00:00<00:00, 372.04it/s]extract the null data:  60%|██████    | 332/553 [00:00<00:00, 363.34it/s]extract the null data:  69%|██████▉   | 381/553 [00:00<00:00, 397.36it/s]extract the null data:  76%|███████▋  | 423/553 [00:01<00:00, 356.40it/s]extract the null data:  85%|████████▌ | 472/553 [00:01<00:00, 389.24it/s]extract the null data:  93%|█████████▎| 513/553 [00:01<00:00, 387.25it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 408.82it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 10/553 [00:00<00:06, 87.66it/s]replace nan value:   5%|▌         | 28/553 [00:00<00:03, 135.92it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:03, 151.74it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:03, 156.88it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 161.94it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 167.37it/s]replace nan value:  21%|██▏       | 118/553 [00:00<00:02, 172.52it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 174.22it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 178.24it/s]replace nan value:  31%|███▏      | 174/553 [00:01<00:02, 178.85it/s]replace nan value:  35%|███▍      | 193/553 [00:01<00:02, 179.49it/s]replace nan value:  38%|███▊      | 211/553 [00:01<00:01, 178.96it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:02, 161.34it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 165.88it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 168.54it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:02, 130.83it/s]replace nan value:  54%|█████▍    | 298/553 [00:01<00:02, 126.62it/s]replace nan value:  57%|█████▋    | 314/553 [00:02<00:01, 133.67it/s]replace nan value:  60%|██████    | 333/553 [00:02<00:01, 146.80it/s]replace nan value:  64%|██████▎   | 352/553 [00:02<00:01, 156.38it/s]replace nan value:  67%|██████▋   | 371/553 [00:02<00:01, 164.11it/s]replace nan value:  71%|███████   | 390/553 [00:02<00:00, 170.02it/s]replace nan value:  74%|███████▍  | 408/553 [00:02<00:00, 164.13it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 159.36it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 156.70it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 122.82it/s]replace nan value:  85%|████████▌ | 472/553 [00:03<00:00, 112.32it/s]replace nan value:  88%|████████▊ | 485/553 [00:03<00:00, 103.96it/s]replace nan value:  90%|████████▉ | 497/553 [00:03<00:00, 98.88it/s] replace nan value:  93%|█████████▎| 514/553 [00:03<00:00, 114.76it/s]replace nan value:  96%|█████████▋| 533/553 [00:03<00:00, 131.41it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 131.48it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 145.80it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.64it/s]  5%|▌         | 28/553 [00:00<00:03, 137.32it/s]  8%|▊         | 42/553 [00:00<00:04, 127.59it/s] 10%|▉         | 55/553 [00:00<00:04, 121.81it/s] 12%|█▏        | 68/553 [00:00<00:04, 112.50it/s] 15%|█▌        | 84/553 [00:00<00:03, 125.37it/s] 18%|█▊        | 98/553 [00:00<00:03, 128.52it/s] 20%|██        | 112/553 [00:00<00:03, 130.59it/s] 23%|██▎       | 126/553 [00:01<00:03, 111.70it/s] 26%|██▌       | 144/553 [00:01<00:03, 127.80it/s] 29%|██▊       | 158/553 [00:01<00:03, 124.23it/s] 31%|███       | 172/553 [00:01<00:03, 126.30it/s] 33%|███▎      | 185/553 [00:01<00:03, 112.82it/s] 36%|███▌      | 198/553 [00:01<00:03, 116.26it/s] 38%|███▊      | 210/553 [00:01<00:02, 116.63it/s] 40%|████      | 222/553 [00:01<00:02, 117.23it/s] 43%|████▎     | 238/553 [00:01<00:02, 127.89it/s] 45%|████▌     | 251/553 [00:02<00:02, 128.00it/s] 48%|████▊     | 265/553 [00:02<00:02, 131.38it/s] 50%|█████     | 279/553 [00:02<00:02, 129.44it/s] 53%|█████▎    | 293/553 [00:02<00:02, 128.14it/s] 55%|█████▌    | 306/553 [00:02<00:02, 122.96it/s] 58%|█████▊    | 319/553 [00:02<00:01, 122.21it/s] 60%|██████    | 333/553 [00:02<00:01, 124.79it/s] 63%|██████▎   | 346/553 [00:02<00:01, 114.45it/s] 65%|██████▍   | 358/553 [00:02<00:01, 115.54it/s] 67%|██████▋   | 373/553 [00:03<00:01, 124.50it/s] 70%|██████▉   | 386/553 [00:03<00:01, 119.58it/s] 72%|███████▏  | 399/553 [00:03<00:01, 110.88it/s] 75%|███████▌  | 415/553 [00:03<00:01, 119.33it/s] 77%|███████▋  | 428/553 [00:03<00:01, 105.84it/s] 79%|███████▉  | 439/553 [00:03<00:01, 98.23it/s]  82%|████████▏ | 456/553 [00:03<00:00, 114.92it/s] 85%|████████▍ | 470/553 [00:03<00:00, 121.31it/s] 87%|████████▋ | 483/553 [00:04<00:00, 123.64it/s] 90%|████████▉ | 496/553 [00:04<00:00, 115.66it/s] 93%|█████████▎| 512/553 [00:04<00:00, 124.53it/s] 95%|█████████▍| 525/553 [00:04<00:00, 115.74it/s] 97%|█████████▋| 537/553 [00:04<00:00, 112.82it/s]100%|█████████▉| 551/553 [00:04<00:00, 102.69it/s]100%|██████████| 553/553 [00:04<00:00, 118.52it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 267.83it/s]extract the null data:  60%|██████    | 84/139 [00:00<00:00, 443.73it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 462.51it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 189.08it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 193.29it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 194.06it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 193.78it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 192.75it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 191.11it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 191.54it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 192.00it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.21it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.16it/s] 26%|██▌       | 36/139 [00:00<00:00, 116.04it/s] 37%|███▋      | 51/139 [00:00<00:00, 124.57it/s] 47%|████▋     | 66/139 [00:00<00:00, 131.71it/s] 58%|█████▊    | 80/139 [00:00<00:00, 129.10it/s] 67%|██████▋   | 93/139 [00:00<00:00, 120.80it/s] 77%|███████▋  | 107/139 [00:00<00:00, 123.42it/s] 89%|████████▉ | 124/139 [00:00<00:00, 134.60it/s] 99%|█████████▉| 138/139 [00:01<00:00, 135.35it/s]100%|██████████| 139/139 [00:01<00:00, 128.47it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|██        | 35/173 [00:00<00:00, 345.05it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 476.35it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 527.94it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 502.32it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 196.22it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 195.27it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 197.29it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 178.04it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 175.32it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 181.38it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 185.69it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 188.77it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 186.38it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:01, 155.44it/s] 18%|█▊        | 32/173 [00:00<00:01, 133.32it/s] 29%|██▉       | 51/173 [00:00<00:00, 154.52it/s] 39%|███▊      | 67/173 [00:00<00:00, 149.75it/s] 48%|████▊     | 83/173 [00:00<00:00, 147.28it/s] 57%|█████▋    | 98/173 [00:00<00:00, 127.84it/s] 66%|██████▌   | 114/173 [00:00<00:00, 135.96it/s] 74%|███████▍  | 128/173 [00:00<00:00, 130.20it/s] 82%|████████▏ | 142/173 [00:01<00:00, 132.75it/s] 90%|█████████ | 156/173 [00:01<00:00, 120.94it/s] 98%|█████████▊| 169/173 [00:01<00:00, 99.46it/s] 100%|██████████| 173/173 [00:01<00:00, 120.10it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.089, valid loss : 0.090, train acc : 0.559, valid acc : 0.690, train f1 : 0.460, valid f1 : 0.551
training process:   1%|          | 1/128 [01:11<2:30:52, 71.28s/it]Best score increase :0.000 -> 0.551
training process:   2%|▏         | 2/128 [02:11<2:15:39, 64.60s/it]Best score increase :0.551 -> 0.597
training process:   2%|▏         | 3/128 [03:13<2:12:32, 63.62s/it]Best score increase :0.597 -> 0.659
training process:   3%|▎         | 4/128 [04:10<2:06:12, 61.07s/it]Best score increase :0.659 -> 0.670
epoch : 5, train loss : 0.066, valid loss : 0.074, train acc : 0.830, valid acc : 0.858, train f1 : 0.658, valid f1 : 0.690
training process:   4%|▍         | 5/128 [05:17<2:09:14, 63.05s/it]Best score increase :0.670 -> 0.690
training process:   5%|▍         | 6/128 [06:12<2:02:25, 60.21s/it]Best score increase :0.690 -> 0.693
training process:   5%|▌         | 7/128 [07:04<1:56:13, 57.63s/it]Best score increase :0.693 -> 0.701
training process:   6%|▋         | 8/128 [08:00<1:54:26, 57.22s/it]Best score increase :0.701 -> 0.718
epoch : 9, train loss : 0.060, valid loss : 0.071, train acc : 0.870, valid acc : 0.867, train f1 : 0.703, valid f1 : 0.705
training process:   7%|▋         | 9/128 [09:03<1:56:54, 58.94s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:57<1:53:01, 57.47s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [10:50<1:49:27, 56.13s/it]Best score increase :0.718 -> 0.724
training process:   9%|▉         | 12/128 [11:46<1:48:14, 55.99s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.055, valid loss : 0.069, train acc : 0.886, valid acc : 0.884, train f1 : 0.727, valid f1 : 0.725
training process:  10%|█         | 13/128 [12:57<1:55:53, 60.46s/it]Best score increase :0.724 -> 0.725
training process:  11%|█         | 14/128 [13:52<1:51:55, 58.91s/it]Best score increase :0.725 -> 0.727
training process:  12%|█▏        | 15/128 [14:42<1:46:03, 56.32s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:32<1:41:33, 54.41s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.050, valid loss : 0.070, train acc : 0.897, valid acc : 0.875, train f1 : 0.747, valid f1 : 0.717
training process:  13%|█▎        | 17/128 [16:30<1:42:45, 55.55s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [17:18<1:37:41, 53.29s/it]Best score increase :0.727 -> 0.732
training process:  15%|█▍        | 19/128 [18:08<1:34:53, 52.23s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [19:00<1:33:31, 51.96s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.047, valid loss : 0.064, train acc : 0.909, valid acc : 0.877, train f1 : 0.766, valid f1 : 0.724
training process:  16%|█▋        | 21/128 [19:58<1:36:13, 53.96s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [20:52<1:35:20, 53.97s/it]Best score increase :0.732 -> 0.750
training process:  18%|█▊        | 23/128 [21:41<1:31:43, 52.42s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:30<1:29:08, 51.43s/it]Best score increase :0.750 -> 0.757
epoch : 25, train loss : 0.045, valid loss : 0.066, train acc : 0.921, valid acc : 0.908, train f1 : 0.787, valid f1 : 0.765
training process:  20%|█▉        | 25/128 [23:31<1:33:09, 54.27s/it]Best score increase :0.757 -> 0.765
training process:  20%|██        | 26/128 [24:22<1:30:48, 53.41s/it]Best score increase :0.765 -> 0.771
training process:  21%|██        | 27/128 [25:13<1:28:42, 52.70s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [26:04<1:26:56, 52.16s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.042, valid loss : 0.066, train acc : 0.923, valid acc : 0.919, train f1 : 0.797, valid f1 : 0.779
training process:  23%|██▎       | 29/128 [27:03<1:29:04, 53.98s/it]Best score increase :0.771 -> 0.779
training process:  23%|██▎       | 30/128 [27:53<1:26:15, 52.81s/it]Best score increase :0.779 -> 0.784
training process:  24%|██▍       | 31/128 [28:42<1:23:52, 51.88s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [29:31<1:21:30, 50.94s/it]Best score increase :0.784 -> 0.787
epoch : 33, train loss : 0.039, valid loss : 0.066, train acc : 0.932, valid acc : 0.915, train f1 : 0.812, valid f1 : 0.770
training process:  26%|██▌       | 33/128 [30:32<1:25:20, 53.90s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [31:22<1:22:31, 52.68s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [32:12<1:20:20, 51.83s/it]Best score increase :0.787 -> 0.794
training process:  28%|██▊       | 36/128 [33:02<1:18:49, 51.41s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.037, valid loss : 0.067, train acc : 0.937, valid acc : 0.923, train f1 : 0.824, valid f1 : 0.794
training process:  29%|██▉       | 37/128 [34:00<1:21:08, 53.50s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [34:49<1:18:12, 52.13s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [35:41<1:16:55, 51.85s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [36:31<1:15:35, 51.54s/it]Best score increase :0.794 -> 0.807
epoch : 41, train loss : 0.035, valid loss : 0.071, train acc : 0.940, valid acc : 0.933, train f1 : 0.831, valid f1 : 0.811
training process:  32%|███▏      | 41/128 [37:38<1:21:26, 56.16s/it]Best score increase :0.807 -> 0.811
training process:  33%|███▎      | 42/128 [38:40<1:22:40, 57.68s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [39:42<1:23:45, 59.12s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [40:41<1:22:32, 58.96s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.034, valid loss : 0.068, train acc : 0.944, valid acc : 0.920, train f1 : 0.841, valid f1 : 0.793
training process:  35%|███▌      | 45/128 [41:49<1:25:39, 61.92s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [42:51<1:24:17, 61.68s/it]Best score increase :0.811 -> 0.819
training process:  37%|███▋      | 47/128 [43:51<1:22:44, 61.30s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [45:01<1:25:14, 63.93s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.032, valid loss : 0.080, train acc : 0.945, valid acc : 0.932, train f1 : 0.844, valid f1 : 0.812
training process:  38%|███▊      | 49/128 [46:24<1:31:31, 69.51s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [47:35<1:31:07, 70.09s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [48:49<1:31:27, 71.26s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [50:01<1:30:22, 71.35s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.032, valid loss : 0.089, train acc : 0.951, valid acc : 0.929, train f1 : 0.856, valid f1 : 0.806
training process:  41%|████▏     | 53/128 [51:23<1:33:31, 74.82s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [52:28<1:28:26, 71.71s/it]EarlyStopping counter : 8 out of 12
training process:  43%|████▎     | 55/128 [53:36<1:25:59, 70.67s/it]EarlyStopping counter : 9 out of 12
training process:  44%|████▍     | 56/128 [54:45<1:24:00, 70.00s/it]EarlyStopping counter : 10 out of 12
epoch : 57, train loss : 0.030, valid loss : 0.081, train acc : 0.950, valid acc : 0.921, train f1 : 0.855, valid f1 : 0.796
training process:  45%|████▍     | 57/128 [56:07<1:27:09, 73.66s/it]EarlyStopping counter : 11 out of 12
training process:  45%|████▍     | 57/128 [57:18<1:11:23, 60.32s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 57, best f1 score : 0.819
training process finished, best loss : 0.079 and best acc : 0.935, best f1 : 0.819, best epoch : 55

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.55      0.77      0.65       580
           1       0.98      0.95      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.77      0.86      0.80      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.86, test loss : 4.380

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:12<02:15, 12.29s/it]processing for feature importance:  17%|█▋        | 2/12 [00:23<01:57, 11.76s/it]processing for feature importance:  25%|██▌       | 3/12 [00:35<01:45, 11.67s/it]processing for feature importance:  33%|███▎      | 4/12 [00:46<01:32, 11.62s/it]processing for feature importance:  42%|████▏     | 5/12 [00:58<01:21, 11.59s/it]processing for feature importance:  50%|█████     | 6/12 [01:09<01:08, 11.36s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:20<00:55, 11.19s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:31<00:45, 11.25s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:43<00:34, 11.47s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:53<00:22, 11.18s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:05<00:11, 11.18s/it]processing for feature importance: 100%|██████████| 12/12 [02:15<00:00, 10.92s/it]processing for feature importance: 100%|██████████| 12/12 [02:15<00:00, 11.29s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 15%|█▍        | 45/306 [00:00<00:00, 443.78it/s] 30%|██▉       | 91/306 [00:00<00:00, 449.40it/s] 45%|████▍     | 137/306 [00:00<00:00, 450.91it/s] 60%|█████▉    | 183/306 [00:00<00:00, 451.39it/s] 75%|███████▍  | 229/306 [00:00<00:00, 451.64it/s] 90%|████████▉ | 275/306 [00:00<00:00, 451.94it/s]100%|██████████| 306/306 [00:00<00:00, 451.25it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 41/553 [00:00<00:01, 409.70it/s]extract the null data:  19%|█▊        | 103/553 [00:00<00:00, 532.42it/s]extract the null data:  30%|███       | 167/553 [00:00<00:00, 577.69it/s]extract the null data:  42%|████▏     | 230/553 [00:00<00:00, 598.02it/s]extract the null data:  53%|█████▎    | 293/553 [00:00<00:00, 608.09it/s]extract the null data:  64%|██████▍   | 356/553 [00:00<00:00, 614.79it/s]extract the null data:  76%|███████▌  | 419/553 [00:00<00:00, 618.33it/s]extract the null data:  87%|████████▋ | 481/553 [00:00<00:00, 590.36it/s]extract the null data:  98%|█████████▊| 541/553 [00:00<00:00, 586.26it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 586.53it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 208.10it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 207.90it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 209.76it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 210.88it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 211.66it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 212.80it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:01, 214.38it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:01, 214.90it/s]replace nan value:  35%|███▌      | 196/553 [00:00<00:01, 215.44it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 181.25it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 181.92it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 190.92it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 177.85it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 188.26it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 195.88it/s]replace nan value:  63%|██████▎   | 346/553 [00:01<00:01, 201.41it/s]replace nan value:  67%|██████▋   | 370/553 [00:01<00:00, 211.99it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 214.11it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 213.88it/s]replace nan value:  79%|███████▉  | 436/553 [00:02<00:00, 213.05it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 214.19it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 214.60it/s]replace nan value:  91%|█████████ | 502/553 [00:02<00:00, 214.42it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 195.75it/s]replace nan value:  99%|█████████▊| 546/553 [00:02<00:00, 200.85it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 203.26it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.02it/s]  5%|▍         | 27/553 [00:00<00:04, 128.75it/s]  7%|▋         | 40/553 [00:00<00:04, 127.82it/s] 10%|▉         | 53/553 [00:00<00:04, 115.10it/s] 12%|█▏        | 65/553 [00:00<00:04, 105.84it/s] 14%|█▍        | 78/553 [00:00<00:04, 111.08it/s] 16%|█▋        | 91/553 [00:00<00:04, 115.38it/s] 19%|█▊        | 103/553 [00:00<00:03, 116.05it/s] 21%|██        | 115/553 [00:01<00:03, 112.19it/s] 23%|██▎       | 129/553 [00:01<00:03, 120.11it/s] 27%|██▋       | 149/553 [00:01<00:02, 142.20it/s] 30%|██▉       | 164/553 [00:01<00:02, 143.27it/s] 32%|███▏      | 179/553 [00:01<00:02, 137.13it/s] 36%|███▌      | 197/553 [00:01<00:02, 145.61it/s] 39%|███▉      | 215/553 [00:01<00:02, 154.97it/s] 42%|████▏     | 231/553 [00:01<00:02, 132.08it/s] 45%|████▍     | 248/553 [00:01<00:02, 141.40it/s] 48%|████▊     | 264/553 [00:02<00:01, 145.59it/s] 51%|█████     | 280/553 [00:02<00:01, 140.29it/s] 53%|█████▎    | 295/553 [00:02<00:01, 139.00it/s] 56%|█████▌    | 310/553 [00:02<00:01, 136.87it/s] 59%|█████▉    | 325/553 [00:02<00:01, 139.92it/s] 61%|██████▏   | 340/553 [00:02<00:01, 141.96it/s] 64%|██████▍   | 355/553 [00:02<00:01, 137.94it/s] 67%|██████▋   | 372/553 [00:02<00:01, 144.91it/s] 70%|██████▉   | 387/553 [00:02<00:01, 132.63it/s] 73%|███████▎  | 401/553 [00:03<00:01, 125.60it/s] 75%|███████▌  | 416/553 [00:03<00:01, 129.58it/s] 78%|███████▊  | 430/553 [00:03<00:01, 120.30it/s] 81%|████████▏ | 450/553 [00:03<00:00, 139.65it/s] 84%|████████▍ | 466/553 [00:03<00:00, 143.85it/s] 87%|████████▋ | 481/553 [00:03<00:00, 141.49it/s] 90%|████████▉ | 496/553 [00:03<00:00, 134.62it/s] 93%|█████████▎| 512/553 [00:03<00:00, 140.59it/s] 95%|█████████▌| 527/553 [00:03<00:00, 121.67it/s] 98%|█████████▊| 541/553 [00:04<00:00, 124.56it/s]100%|██████████| 553/553 [00:04<00:00, 130.23it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 417.11it/s]extract the null data:  62%|██████▏   | 86/139 [00:00<00:00, 429.34it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 359.08it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 387.20it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:   9%|▊         | 12/139 [00:00<00:01, 103.95it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 116.48it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 112.65it/s]replace nan value:  37%|███▋      | 51/139 [00:00<00:00, 117.44it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 114.09it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 117.75it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 114.60it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 118.03it/s]replace nan value:  83%|████████▎ | 116/139 [00:00<00:00, 120.35it/s]replace nan value:  93%|█████████▎| 129/139 [00:01<00:00, 116.11it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 120.55it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 129.38it/s] 21%|██        | 29/139 [00:00<00:00, 134.92it/s] 32%|███▏      | 45/139 [00:00<00:00, 145.30it/s] 43%|████▎     | 60/139 [00:00<00:00, 129.09it/s] 53%|█████▎    | 74/139 [00:00<00:00, 129.45it/s] 63%|██████▎   | 88/139 [00:00<00:00, 121.17it/s] 76%|███████▌  | 105/139 [00:00<00:00, 132.31it/s] 88%|████████▊ | 123/139 [00:00<00:00, 144.24it/s]100%|██████████| 139/139 [00:01<00:00, 146.92it/s]100%|██████████| 139/139 [00:01<00:00, 137.81it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 40/173 [00:00<00:00, 398.13it/s]extract the null data:  63%|██████▎   | 109/173 [00:00<00:00, 566.76it/s]extract the null data:  99%|█████████▉| 172/173 [00:00<00:00, 591.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 568.00it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 186.50it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 212.47it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 220.19it/s]replace nan value:  51%|█████▏    | 89/173 [00:00<00:00, 180.93it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 154.13it/s]replace nan value:  72%|███████▏  | 125/173 [00:00<00:00, 141.22it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 132.17it/s]replace nan value:  94%|█████████▍| 163/173 [00:01<00:00, 156.13it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 163.86it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 138.24it/s] 17%|█▋        | 29/173 [00:00<00:01, 121.36it/s] 26%|██▌       | 45/173 [00:00<00:00, 136.37it/s] 35%|███▌      | 61/173 [00:00<00:00, 141.31it/s] 44%|████▍     | 76/173 [00:00<00:00, 138.79it/s] 53%|█████▎    | 91/173 [00:00<00:00, 141.42it/s] 61%|██████▏   | 106/173 [00:00<00:00, 136.82it/s] 69%|██████▉   | 120/173 [00:00<00:00, 130.17it/s] 78%|███████▊  | 135/173 [00:00<00:00, 133.69it/s] 86%|████████▌ | 149/173 [00:01<00:00, 129.44it/s] 94%|█████████▍| 163/173 [00:01<00:00, 128.27it/s]100%|██████████| 173/173 [00:01<00:00, 122.95it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.207, valid loss : 0.099, train acc : 0.645, valid acc : 0.377, train f1 : 0.621, valid f1 : 0.345
training process:   1%|          | 1/128 [01:04<2:16:37, 64.54s/it]Best score increase :0.000 -> 0.345
training process:   2%|▏         | 2/128 [01:59<2:03:39, 58.89s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:49<1:54:09, 54.79s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:47<1:55:52, 56.07s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.096, valid loss : 0.115, train acc : 0.615, valid acc : 0.313, train f1 : 0.555, valid f1 : 0.298
training process:   4%|▍         | 5/128 [04:47<1:57:48, 57.47s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:38<1:52:08, 55.15s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [06:27<1:47:34, 53.34s/it]Best score increase :0.345 -> 0.369
training process:   6%|▋         | 8/128 [07:17<1:44:29, 52.24s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.079, valid loss : 0.118, train acc : 0.689, valid acc : 0.403, train f1 : 0.658, valid f1 : 0.366
training process:   7%|▋         | 9/128 [08:16<1:47:42, 54.30s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [09:06<1:44:22, 53.07s/it]Best score increase :0.369 -> 0.441
training process:   9%|▊         | 11/128 [09:58<1:42:32, 52.59s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:47<1:39:27, 51.45s/it]Best score increase :0.441 -> 0.465
epoch : 13, train loss : 0.064, valid loss : 0.098, train acc : 0.768, valid acc : 0.578, train f1 : 0.754, valid f1 : 0.489
training process:  10%|█         | 13/128 [11:46<1:43:06, 53.79s/it]Best score increase :0.465 -> 0.489
training process:  11%|█         | 14/128 [12:36<1:40:27, 52.87s/it]Best score increase :0.489 -> 0.493
training process:  12%|█▏        | 15/128 [13:26<1:37:46, 51.92s/it]Best score increase :0.493 -> 0.498
training process:  12%|█▎        | 16/128 [14:17<1:36:11, 51.53s/it]Best score increase :0.498 -> 0.524
epoch : 17, train loss : 0.057, valid loss : 0.098, train acc : 0.802, valid acc : 0.609, train f1 : 0.794, valid f1 : 0.511
training process:  13%|█▎        | 17/128 [15:17<1:40:04, 54.10s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [16:06<1:36:31, 52.65s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [16:57<1:34:44, 52.15s/it]Best score increase :0.524 -> 0.547
training process:  16%|█▌        | 20/128 [17:46<1:32:20, 51.30s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.051, valid loss : 0.097, train acc : 0.826, valid acc : 0.645, train f1 : 0.822, valid f1 : 0.537
training process:  16%|█▋        | 21/128 [18:46<1:36:04, 53.87s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [19:35<1:32:38, 52.44s/it]Best score increase :0.547 -> 0.577
training process:  18%|█▊        | 23/128 [20:28<1:31:58, 52.55s/it]Best score increase :0.577 -> 0.590
training process:  19%|█▉        | 24/128 [21:18<1:29:54, 51.87s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.048, valid loss : 0.079, train acc : 0.847, valid acc : 0.707, train f1 : 0.844, valid f1 : 0.582
training process:  20%|█▉        | 25/128 [22:17<1:32:40, 53.98s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [23:08<1:29:53, 52.88s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [23:59<1:28:08, 52.36s/it]Best score increase :0.590 -> 0.610
training process:  22%|██▏       | 28/128 [24:49<1:26:21, 51.81s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.044, valid loss : 0.085, train acc : 0.861, valid acc : 0.734, train f1 : 0.859, valid f1 : 0.604
training process:  23%|██▎       | 29/128 [25:58<1:33:49, 56.86s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [27:00<1:35:27, 58.44s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [28:02<1:36:14, 59.53s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [29:13<1:40:29, 62.81s/it]Best score increase :0.610 -> 0.615
epoch : 33, train loss : 0.042, valid loss : 0.081, train acc : 0.873, valid acc : 0.772, train f1 : 0.871, valid f1 : 0.634
training process:  26%|██▌       | 33/128 [30:35<1:48:54, 68.79s/it]Best score increase :0.615 -> 0.634
training process:  27%|██▋       | 34/128 [31:47<1:48:55, 69.52s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [33:01<1:49:59, 70.96s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [34:13<1:49:21, 71.32s/it]Best score increase :0.634 -> 0.648
epoch : 37, train loss : 0.041, valid loss : 0.073, train acc : 0.876, valid acc : 0.801, train f1 : 0.874, valid f1 : 0.660
training process:  29%|██▉       | 37/128 [35:37<1:53:59, 75.16s/it]Best score increase :0.648 -> 0.660
training process:  30%|██▉       | 38/128 [36:50<1:51:51, 74.58s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [38:04<1:50:17, 74.36s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [39:16<1:48:04, 73.69s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.037, valid loss : 0.085, train acc : 0.888, valid acc : 0.790, train f1 : 0.886, valid f1 : 0.651
training process:  32%|███▏      | 41/128 [40:38<1:50:18, 76.07s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [41:52<1:48:11, 75.49s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [43:03<1:45:00, 74.12s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [44:17<1:43:35, 74.00s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.038, valid loss : 0.089, train acc : 0.892, valid acc : 0.799, train f1 : 0.891, valid f1 : 0.658
training process:  35%|███▌      | 45/128 [45:43<1:47:28, 77.69s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [46:56<1:44:06, 76.18s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [48:09<1:41:29, 75.18s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [49:21<1:38:59, 74.24s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.035, valid loss : 0.088, train acc : 0.900, valid acc : 0.787, train f1 : 0.899, valid f1 : 0.647
training process:  38%|███▊      | 48/128 [50:46<1:24:37, 63.47s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.661
training process finished, best loss : 0.083 and best acc : 0.802, best f1 : 0.661, best epoch : 38

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.32      0.92      0.48       580
           1       0.99      0.84      0.91      6818

    accuracy                           0.84      7398
   macro avg       0.66      0.88      0.69      7398
weighted avg       0.94      0.84      0.87      7398


# test acc : 0.84, test f1 : 0.69, test AUC : 0.88, test loss : 3.787

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:08, 11.66s/it]processing for feature importance:  17%|█▋        | 2/12 [00:22<01:52, 11.23s/it]processing for feature importance:  25%|██▌       | 3/12 [00:34<01:44, 11.63s/it]processing for feature importance:  33%|███▎      | 4/12 [00:45<01:29, 11.16s/it]processing for feature importance:  42%|████▏     | 5/12 [00:55<01:16, 11.00s/it]processing for feature importance:  50%|█████     | 6/12 [01:06<01:05, 10.84s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:17<00:55, 11.01s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:28<00:44, 11.08s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:39<00:32, 10.84s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:49<00:21, 10.65s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:59<00:10, 10.31s/it]processing for feature importance: 100%|██████████| 12/12 [02:10<00:00, 10.54s/it]processing for feature importance: 100%|██████████| 12/12 [02:10<00:00, 10.84s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 13%|█▎        | 41/306 [00:00<00:00, 406.01it/s] 27%|██▋       | 83/306 [00:00<00:00, 409.15it/s] 41%|████      | 124/306 [00:00<00:00, 371.25it/s] 53%|█████▎    | 162/306 [00:00<00:00, 202.52it/s] 62%|██████▏   | 190/306 [00:00<00:00, 218.39it/s] 76%|███████▌  | 232/306 [00:00<00:00, 265.82it/s] 87%|████████▋ | 265/306 [00:00<00:00, 278.65it/s]100%|██████████| 306/306 [00:01<00:00, 289.39it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 52/553 [00:00<00:00, 511.26it/s]extract the null data:  19%|█▉        | 104/553 [00:00<00:00, 497.96it/s]extract the null data:  28%|██▊       | 154/553 [00:00<00:00, 476.18it/s]extract the null data:  38%|███▊      | 210/553 [00:00<00:00, 504.58it/s]extract the null data:  48%|████▊     | 264/553 [00:00<00:00, 516.81it/s]extract the null data:  58%|█████▊    | 320/553 [00:00<00:00, 531.05it/s]extract the null data:  68%|██████▊   | 374/553 [00:00<00:00, 532.57it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 485.09it/s]extract the null data:  87%|████████▋ | 482/553 [00:00<00:00, 498.97it/s]extract the null data:  97%|█████████▋| 535/553 [00:01<00:00, 505.63it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 505.75it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 176.96it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 177.28it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 178.75it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 179.04it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 177.95it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 179.55it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 172.11it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:03, 135.25it/s]replace nan value:  29%|██▉       | 161/553 [00:01<00:02, 135.52it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 150.37it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:02, 164.37it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 176.23it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 184.24it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 186.63it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 185.75it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 184.75it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 180.95it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 180.08it/s]replace nan value:  65%|██████▍   | 359/553 [00:02<00:01, 178.59it/s]replace nan value:  68%|██████▊   | 377/553 [00:02<00:00, 178.53it/s]replace nan value:  71%|███████▏  | 395/553 [00:02<00:00, 177.44it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 179.84it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 184.02it/s]replace nan value:  82%|████████▏ | 455/553 [00:02<00:00, 191.49it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 192.48it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 188.28it/s]replace nan value:  93%|█████████▎| 514/553 [00:02<00:00, 186.24it/s]replace nan value:  96%|█████████▋| 533/553 [00:03<00:00, 184.82it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 189.19it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 177.33it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 6/553 [00:00<00:09, 55.66it/s]  4%|▍         | 21/553 [00:00<00:04, 108.73it/s]  7%|▋         | 37/553 [00:00<00:03, 129.47it/s]  9%|▉         | 51/553 [00:00<00:05, 92.75it/s]  11%|█         | 62/553 [00:00<00:05, 90.63it/s] 13%|█▎        | 72/553 [00:00<00:05, 91.54it/s] 15%|█▌        | 84/553 [00:00<00:04, 97.34it/s] 18%|█▊        | 97/553 [00:00<00:04, 106.37it/s] 20%|█▉        | 109/553 [00:01<00:04, 107.59it/s] 22%|██▏       | 122/553 [00:01<00:03, 109.80it/s] 24%|██▍       | 134/553 [00:01<00:03, 110.62it/s] 27%|██▋       | 148/553 [00:01<00:03, 117.57it/s] 29%|██▉       | 161/553 [00:01<00:03, 120.03it/s] 32%|███▏      | 177/553 [00:01<00:02, 130.25it/s] 35%|███▍      | 193/553 [00:01<00:02, 137.31it/s] 38%|███▊      | 211/553 [00:01<00:02, 147.05it/s] 41%|████      | 226/553 [00:01<00:02, 140.07it/s] 44%|████▍     | 242/553 [00:02<00:02, 141.70it/s] 46%|████▋     | 257/553 [00:02<00:02, 139.44it/s] 49%|████▉     | 271/553 [00:02<00:02, 132.67it/s] 52%|█████▏    | 285/553 [00:02<00:02, 128.69it/s] 54%|█████▍    | 298/553 [00:02<00:02, 125.88it/s] 56%|█████▌    | 311/553 [00:02<00:02, 118.55it/s] 59%|█████▉    | 325/553 [00:02<00:01, 123.19it/s] 61%|██████▏   | 339/553 [00:02<00:01, 125.64it/s] 64%|██████▍   | 353/553 [00:02<00:01, 126.26it/s] 66%|██████▌   | 366/553 [00:03<00:01, 123.63it/s] 69%|██████▉   | 381/553 [00:03<00:01, 130.64it/s] 71%|███████▏  | 395/553 [00:03<00:01, 118.91it/s] 74%|███████▍  | 408/553 [00:03<00:01, 119.09it/s] 76%|███████▌  | 421/553 [00:03<00:01, 117.03it/s] 78%|███████▊  | 433/553 [00:03<00:01, 115.03it/s] 82%|████████▏ | 451/553 [00:03<00:00, 131.55it/s] 84%|████████▍ | 465/553 [00:03<00:00, 129.17it/s] 87%|████████▋ | 479/553 [00:03<00:00, 129.59it/s] 89%|████████▉ | 493/553 [00:04<00:00, 125.14it/s] 92%|█████████▏| 506/553 [00:04<00:00, 123.64it/s] 94%|█████████▍| 520/553 [00:04<00:00, 127.59it/s] 96%|█████████▋| 533/553 [00:04<00:00, 110.18it/s] 99%|█████████▉| 547/553 [00:04<00:00, 115.41it/s]100%|██████████| 553/553 [00:04<00:00, 115.19it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 16/139 [00:00<00:00, 158.35it/s]extract the null data:  55%|█████▍    | 76/139 [00:00<00:00, 412.23it/s]extract the null data:  92%|█████████▏| 128/139 [00:00<00:00, 460.91it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 429.62it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 197.31it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 207.63it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 210.12it/s]replace nan value:  62%|██████▏   | 86/139 [00:00<00:00, 201.93it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 188.31it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 185.99it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 194.81it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.89it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.46it/s] 28%|██▊       | 39/139 [00:00<00:00, 128.77it/s] 37%|███▋      | 52/139 [00:00<00:00, 119.64it/s] 48%|████▊     | 67/139 [00:00<00:00, 125.74it/s] 58%|█████▊    | 81/139 [00:00<00:00, 129.46it/s] 68%|██████▊   | 94/139 [00:00<00:00, 120.90it/s] 78%|███████▊  | 108/139 [00:00<00:00, 124.79it/s] 90%|████████▉ | 125/139 [00:00<00:00, 136.71it/s]100%|██████████| 139/139 [00:01<00:00, 130.06it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 355.63it/s]extract the null data:  58%|█████▊    | 100/173 [00:00<00:00, 521.06it/s]extract the null data:  94%|█████████▍| 163/173 [00:00<00:00, 569.68it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 515.46it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   9%|▊         | 15/173 [00:00<00:01, 146.95it/s]replace nan value:  21%|██▏       | 37/173 [00:00<00:00, 186.02it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 196.61it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 201.22it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 194.61it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 184.82it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 178.15it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 168.38it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 176.43it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  6%|▌         | 10/173 [00:00<00:01, 95.82it/s] 12%|█▏        | 20/173 [00:00<00:02, 68.49it/s] 17%|█▋        | 29/173 [00:00<00:01, 75.03it/s] 24%|██▍       | 42/173 [00:00<00:01, 92.22it/s] 31%|███       | 54/173 [00:00<00:01, 100.14it/s] 40%|███▉      | 69/173 [00:00<00:00, 115.03it/s] 50%|████▉     | 86/173 [00:00<00:00, 129.94it/s] 59%|█████▉    | 102/173 [00:00<00:00, 137.99it/s] 68%|██████▊   | 118/173 [00:01<00:00, 141.18it/s] 77%|███████▋  | 133/173 [00:01<00:00, 137.74it/s] 86%|████████▌ | 148/173 [00:01<00:00, 140.07it/s] 94%|█████████▍| 163/173 [00:01<00:00, 131.86it/s]100%|██████████| 173/173 [00:01<00:00, 111.61it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.519, valid loss : 0.379, train f1 : 0.544, valid f1 : 0.578
training process - Deferred Re-weighting:   1%|          | 1/128 [01:10<2:28:31, 70.17s/it]Best score increase :0.000 -> 0.578
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:11<2:16:27, 64.98s/it]Best score increase :0.578 -> 0.606
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:13<2:12:50, 63.77s/it]Best score increase :0.606 -> 0.628
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:14<2:09:35, 62.70s/it]Best score increase :0.628 -> 0.667
epoch : 5, train loss : 0.199, valid loss : 0.206, train f1 : 0.686, valid f1 : 0.664
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:30<2:17:43, 67.19s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:32<2:13:14, 65.53s/it]Best score increase :0.667 -> 0.712
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:34<2:09:59, 64.46s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:38<2:08:23, 64.19s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.171, valid loss : 0.189, train f1 : 0.730, valid f1 : 0.722
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:49<2:11:55, 66.51s/it]Best score increase :0.712 -> 0.722
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:49<2:06:33, 64.36s/it]Best score increase :0.722 -> 0.727
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:49<2:03:03, 63.11s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:49<2:00:00, 62.07s/it]Best score increase :0.727 -> 0.745
epoch : 13, train loss : 0.155, valid loss : 0.179, train f1 : 0.768, valid f1 : 0.747
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:56<2:01:38, 63.47s/it]Best score increase :0.745 -> 0.747
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:58<2:00:08, 63.23s/it]Best score increase :0.747 -> 0.749
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [16:02<1:59:27, 63.43s/it]Best score increase :0.749 -> 0.756
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:02<1:56:19, 62.31s/it]Best score increase :0.756 -> 0.764
epoch : 17, train loss : 0.139, valid loss : 0.170, train f1 : 0.797, valid f1 : 0.780
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:14<2:01:00, 65.41s/it]Best score increase :0.764 -> 0.780
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [19:17<1:58:31, 64.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [20:17<1:54:34, 63.06s/it]Best score increase :0.780 -> 0.783
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [21:12<1:49:15, 60.70s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.129, valid loss : 0.158, train f1 : 0.814, valid f1 : 0.792
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [22:19<1:51:32, 62.55s/it]Best score increase :0.783 -> 0.792
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [23:15<1:47:06, 60.63s/it]Best score increase :0.792 -> 0.794
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [24:12<1:44:12, 59.55s/it]Best score increase :0.794 -> 0.798
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [25:04<1:39:24, 57.35s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.120, valid loss : 0.151, train f1 : 0.832, valid f1 : 0.817
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [26:05<1:40:19, 58.44s/it]Best score increase :0.798 -> 0.817
training process - Deferred Re-weighting:  20%|██        | 26/128 [26:58<1:36:42, 56.89s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [27:49<1:32:26, 54.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [28:39<1:29:26, 53.67s/it]Best score increase :0.817 -> 0.824
epoch : 29, train loss : 0.109, valid loss : 0.152, train f1 : 0.857, valid f1 : 0.817
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [29:38<1:30:48, 55.04s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [30:29<1:28:04, 53.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [31:21<1:26:13, 53.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [32:19<1:27:22, 54.61s/it]Best score increase :0.824 -> 0.825
epoch : 33, train loss : 0.101, valid loss : 0.149, train f1 : 0.865, valid f1 : 0.814
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [33:17<1:28:10, 55.69s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [34:13<1:27:21, 55.76s/it]Best score increase :0.825 -> 0.837
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:20<1:31:34, 59.08s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:23<1:32:43, 60.47s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.096, valid loss : 0.152, train f1 : 0.875, valid f1 : 0.826
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [37:33<1:35:43, 63.11s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [38:35<1:34:11, 62.80s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [39:34<1:31:50, 61.92s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [40:32<1:28:58, 60.66s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.092, valid loss : 0.153, train f1 : 0.876, valid f1 : 0.827
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [41:41<1:31:28, 63.09s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [42:44<1:30:18, 63.00s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [43:43<1:27:34, 61.82s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [44:40<1:24:27, 60.33s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.088, valid loss : 0.175, train f1 : 0.885, valid f1 : 0.837
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [45:54<1:29:20, 64.59s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [46:56<1:26:35, 62.59s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.837
training process finished, best loss : 0.149, best acc : 0.956, best f1 : 0.837, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.83      0.64      0.72       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.90      0.81      0.85      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.85, test AUC : 0.81, test loss : 8.229

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:43,  9.45s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:32,  9.24s/it]processing for feature importance:  25%|██▌       | 3/12 [00:27<01:22,  9.21s/it]processing for feature importance:  33%|███▎      | 4/12 [00:36<01:13,  9.20s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:04,  9.18s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:57,  9.56s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:05<00:47,  9.55s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:15<00:38,  9.63s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:24<00:28,  9.49s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:34<00:19,  9.51s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:45<00:09,  9.84s/it]processing for feature importance: 100%|██████████| 12/12 [01:55<00:00, 10.09s/it]processing for feature importance: 100%|██████████| 12/12 [01:55<00:00,  9.64s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 15%|█▍        | 45/306 [00:00<00:00, 445.28it/s] 30%|██▉       | 91/306 [00:00<00:00, 450.01it/s] 45%|████▍     | 137/306 [00:00<00:00, 452.22it/s] 60%|█████▉    | 183/306 [00:00<00:00, 453.30it/s] 75%|███████▍  | 229/306 [00:00<00:00, 454.28it/s] 90%|████████▉ | 275/306 [00:00<00:00, 453.94it/s]100%|██████████| 306/306 [00:00<00:00, 453.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 464.57it/s]extract the null data:  18%|█▊        | 100/553 [00:00<00:00, 499.33it/s]extract the null data:  27%|██▋       | 150/553 [00:00<00:00, 496.80it/s]extract the null data:  36%|███▌      | 200/553 [00:00<00:00, 487.87it/s]extract the null data:  45%|████▌     | 249/553 [00:00<00:00, 471.91it/s]extract the null data:  55%|█████▍    | 302/553 [00:00<00:00, 488.52it/s]extract the null data:  64%|██████▎   | 352/553 [00:00<00:00, 488.79it/s]extract the null data:  73%|███████▎  | 401/553 [00:00<00:00, 484.05it/s]extract the null data:  81%|████████▏ | 450/553 [00:00<00:00, 482.76it/s]extract the null data:  90%|█████████ | 499/553 [00:01<00:00, 482.88it/s]extract the null data:  99%|█████████▉| 550/553 [00:01<00:00, 488.70it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 485.76it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 169.55it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:03, 171.99it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 170.93it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 170.91it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 172.29it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 173.04it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 173.48it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 175.33it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:02, 176.47it/s]replace nan value:  33%|███▎      | 180/553 [00:01<00:02, 131.99it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:03, 117.61it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:03, 107.19it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:03, 98.26it/s] replace nan value:  42%|████▏     | 232/553 [00:01<00:03, 98.69it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:03, 95.66it/s]replace nan value:  46%|████▌     | 253/553 [00:01<00:03, 92.30it/s]replace nan value:  48%|████▊     | 263/553 [00:02<00:03, 93.61it/s]replace nan value:  49%|████▉     | 273/553 [00:02<00:03, 92.41it/s]replace nan value:  51%|█████     | 283/553 [00:02<00:02, 93.24it/s]replace nan value:  53%|█████▎    | 293/553 [00:02<00:02, 90.23it/s]replace nan value:  55%|█████▍    | 303/553 [00:02<00:02, 88.23it/s]replace nan value:  57%|█████▋    | 313/553 [00:02<00:02, 86.57it/s]replace nan value:  58%|█████▊    | 323/553 [00:02<00:02, 89.74it/s]replace nan value:  60%|██████    | 334/553 [00:02<00:02, 94.76it/s]replace nan value:  62%|██████▏   | 344/553 [00:03<00:02, 85.98it/s]replace nan value:  64%|██████▍   | 354/553 [00:03<00:02, 88.31it/s]replace nan value:  67%|██████▋   | 372/553 [00:03<00:01, 112.67it/s]replace nan value:  71%|███████   | 391/553 [00:03<00:01, 133.30it/s]replace nan value:  74%|███████▍  | 410/553 [00:03<00:00, 148.03it/s]replace nan value:  77%|███████▋  | 428/553 [00:03<00:00, 155.96it/s]replace nan value:  81%|████████  | 447/553 [00:03<00:00, 163.48it/s]replace nan value:  84%|████████▍ | 466/553 [00:03<00:00, 168.91it/s]replace nan value:  88%|████████▊ | 485/553 [00:03<00:00, 172.47it/s]replace nan value:  91%|█████████ | 503/553 [00:03<00:00, 173.92it/s]replace nan value:  94%|█████████▍| 521/553 [00:04<00:00, 175.41it/s]replace nan value:  97%|█████████▋| 539/553 [00:04<00:00, 174.24it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 130.84it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.66it/s]  5%|▌         | 28/553 [00:00<00:03, 137.81it/s]  8%|▊         | 42/553 [00:00<00:03, 131.67it/s] 10%|█         | 56/553 [00:00<00:04, 122.37it/s] 12%|█▏        | 69/553 [00:00<00:04, 99.44it/s]  15%|█▌        | 84/553 [00:00<00:04, 110.76it/s] 18%|█▊        | 97/553 [00:00<00:03, 114.03it/s] 20%|█▉        | 109/553 [00:00<00:03, 113.87it/s] 22%|██▏       | 121/553 [00:01<00:04, 103.45it/s] 24%|██▍       | 132/553 [00:01<00:04, 85.71it/s]  26%|██▌       | 142/553 [00:01<00:04, 83.60it/s] 27%|██▋       | 151/553 [00:01<00:04, 84.19it/s] 29%|██▉       | 160/553 [00:01<00:04, 83.06it/s] 31%|███       | 169/553 [00:01<00:04, 80.20it/s] 32%|███▏      | 178/553 [00:01<00:04, 79.44it/s] 34%|███▍      | 187/553 [00:01<00:04, 75.08it/s] 36%|███▌      | 197/553 [00:02<00:04, 81.25it/s] 38%|███▊      | 208/553 [00:02<00:03, 88.01it/s] 39%|███▉      | 217/553 [00:02<00:04, 80.74it/s] 42%|████▏     | 231/553 [00:02<00:03, 95.26it/s] 45%|████▍     | 248/553 [00:02<00:02, 114.72it/s] 48%|████▊     | 264/553 [00:02<00:02, 125.32it/s] 50%|█████     | 277/553 [00:02<00:02, 125.25it/s] 53%|█████▎    | 292/553 [00:02<00:02, 130.24it/s] 55%|█████▌    | 306/553 [00:02<00:01, 126.06it/s] 58%|█████▊    | 319/553 [00:03<00:01, 127.13it/s] 60%|██████    | 333/553 [00:03<00:01, 130.30it/s] 63%|██████▎   | 348/553 [00:03<00:01, 133.01it/s] 65%|██████▌   | 362/553 [00:03<00:01, 128.97it/s] 68%|██████▊   | 378/553 [00:03<00:01, 134.69it/s] 71%|███████   | 392/553 [00:03<00:01, 124.70it/s] 73%|███████▎  | 406/553 [00:03<00:01, 127.42it/s] 76%|███████▌  | 419/553 [00:03<00:01, 124.41it/s] 78%|███████▊  | 432/553 [00:03<00:00, 122.82it/s] 82%|████████▏ | 451/553 [00:04<00:00, 139.15it/s] 84%|████████▍ | 466/553 [00:04<00:00, 142.00it/s] 87%|████████▋ | 481/553 [00:04<00:00, 137.48it/s] 90%|████████▉ | 495/553 [00:04<00:00, 128.58it/s] 92%|█████████▏| 511/553 [00:04<00:00, 136.36it/s] 95%|█████████▍| 525/553 [00:04<00:00, 110.85it/s] 97%|█████████▋| 537/553 [00:04<00:00, 109.55it/s]100%|█████████▉| 551/553 [00:04<00:00, 102.44it/s]100%|██████████| 553/553 [00:04<00:00, 110.93it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 16/139 [00:00<00:00, 159.19it/s]extract the null data:  58%|█████▊    | 81/139 [00:00<00:00, 445.95it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 475.48it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 183.74it/s]replace nan value:  29%|██▉       | 41/139 [00:00<00:00, 204.10it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 208.61it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 211.66it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 214.02it/s]replace nan value:  94%|█████████▍| 131/139 [00:00<00:00, 222.59it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 215.38it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.36it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.57it/s] 29%|██▉       | 41/139 [00:00<00:00, 136.24it/s] 40%|███▉      | 55/139 [00:00<00:00, 124.78it/s] 50%|████▉     | 69/139 [00:00<00:00, 127.68it/s] 59%|█████▉    | 82/139 [00:00<00:00, 126.53it/s] 68%|██████▊   | 95/139 [00:00<00:00, 124.08it/s] 78%|███████▊  | 109/139 [00:00<00:00, 128.40it/s] 91%|█████████▏| 127/139 [00:00<00:00, 142.26it/s]100%|██████████| 139/139 [00:01<00:00, 134.44it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 44/173 [00:00<00:00, 439.86it/s]extract the null data:  65%|██████▌   | 113/173 [00:00<00:00, 582.70it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 592.53it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 227.14it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 228.56it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 228.66it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 228.63it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 228.90it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 226.24it/s]replace nan value:  93%|█████████▎| 161/173 [00:00<00:00, 225.50it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 225.93it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.17it/s] 16%|█▌        | 28/173 [00:00<00:01, 129.37it/s] 25%|██▍       | 43/173 [00:00<00:00, 136.77it/s] 35%|███▌      | 61/173 [00:00<00:00, 149.98it/s] 45%|████▍     | 77/173 [00:00<00:00, 152.82it/s] 54%|█████▍    | 94/173 [00:00<00:00, 156.40it/s] 65%|██████▍   | 112/173 [00:00<00:00, 162.60it/s] 75%|███████▍  | 129/173 [00:00<00:00, 155.62it/s] 84%|████████▍ | 145/173 [00:00<00:00, 152.32it/s] 93%|█████████▎| 161/173 [00:01<00:00, 127.29it/s]100%|██████████| 173/173 [00:01<00:00, 132.16it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.566, valid loss : 0.498, train f1 : 0.700, valid f1 : 0.595
training process - Deferred Re-weighting:   1%|          | 1/128 [01:08<2:25:31, 68.75s/it]Best score increase :0.000 -> 0.595
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:09<2:14:26, 64.02s/it]Best score increase :0.595 -> 0.635
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:03<2:04:11, 59.61s/it]Best score increase :0.635 -> 0.673
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:50<1:53:02, 54.70s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.416, valid loss : 0.384, train f1 : 0.810, valid f1 : 0.698
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:47<1:53:26, 55.33s/it]Best score increase :0.673 -> 0.698
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:37<1:48:54, 53.56s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:28<1:46:03, 52.59s/it]Best score increase :0.698 -> 0.700
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:20<1:45:19, 52.67s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.351, valid loss : 0.413, train f1 : 0.846, valid f1 : 0.690
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:22<1:49:52, 55.40s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:12<1:45:49, 53.81s/it]Best score increase :0.700 -> 0.720
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:59<1:40:57, 51.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:51<1:40:06, 51.78s/it]Best score increase :0.720 -> 0.722
epoch : 13, train loss : 0.289, valid loss : 0.322, train f1 : 0.878, valid f1 : 0.735
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:48<1:42:29, 53.47s/it]Best score increase :0.722 -> 0.735
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:45<1:43:29, 54.47s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:30<1:37:04, 51.55s/it]Best score increase :0.735 -> 0.739
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:15<1:32:26, 49.52s/it]Best score increase :0.739 -> 0.748
epoch : 17, train loss : 0.251, valid loss : 0.313, train f1 : 0.896, valid f1 : 0.736
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:08<1:33:48, 50.70s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:53<1:29:51, 49.02s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:38<1:26:43, 47.74s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:24<1:24:40, 47.04s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.218, valid loss : 0.318, train f1 : 0.909, valid f1 : 0.731
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:16<1:26:51, 48.71s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:01<1:23:54, 47.50s/it]Best score increase :0.748 -> 0.781
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:46<1:21:46, 46.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:31<1:20:20, 46.36s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.204, valid loss : 0.255, train f1 : 0.920, valid f1 : 0.764
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:24<1:22:48, 48.24s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:10<1:20:54, 47.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [22:57<1:19:42, 47.35s/it]Best score increase :0.781 -> 0.787
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [23:42<1:17:42, 46.62s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.182, valid loss : 0.261, train f1 : 0.930, valid f1 : 0.774
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [24:36<1:20:45, 48.95s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [25:21<1:17:58, 47.74s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [26:05<1:15:31, 46.72s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [26:52<1:14:37, 46.64s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.174, valid loss : 0.224, train f1 : 0.932, valid f1 : 0.792
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [27:52<1:20:26, 50.80s/it]Best score increase :0.787 -> 0.792
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [28:43<1:19:21, 50.66s/it]Best score increase :0.792 -> 0.798
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [29:35<1:19:09, 51.07s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [30:27<1:18:45, 51.36s/it]Best score increase :0.798 -> 0.810
epoch : 37, train loss : 0.167, valid loss : 0.204, train f1 : 0.933, valid f1 : 0.815
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [31:27<1:22:09, 54.17s/it]Best score increase :0.810 -> 0.815
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [32:20<1:20:24, 53.60s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [33:23<1:23:52, 56.55s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [34:22<1:23:57, 57.24s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.148, valid loss : 0.244, train f1 : 0.942, valid f1 : 0.792
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [35:25<1:25:37, 59.05s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:27<1:25:40, 59.77s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:26<1:24:25, 59.59s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:28<1:24:36, 60.44s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.145, valid loss : 0.249, train f1 : 0.944, valid f1 : 0.804
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [39:33<1:25:21, 61.70s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [40:27<1:21:04, 59.33s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:18<1:16:45, 56.85s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [42:10<1:13:59, 55.50s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.135, valid loss : 0.267, train f1 : 0.947, valid f1 : 0.769
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [43:21<1:12:16, 54.20s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.816
training process finished, best loss : 0.218, best acc : 0.932, best f1 : 0.816, best epoch : 47

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.56      0.79      0.65       580
           1       0.98      0.95      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.77      0.87      0.81      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.81, test AUC : 0.87, test loss : 10.832

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.92s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:21,  8.18s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.10s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:05,  8.17s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:56,  8.03s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.16s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:41,  8.31s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:33,  8.44s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:15<00:26,  8.79s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:25<00:18,  9.04s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:35<00:09,  9.49s/it]processing for feature importance: 100%|██████████| 12/12 [01:46<00:00,  9.85s/it]processing for feature importance: 100%|██████████| 12/12 [01:46<00:00,  8.87s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 33/306 [00:00<00:00, 324.55it/s] 22%|██▏       | 66/306 [00:00<00:00, 326.74it/s] 32%|███▏      | 99/306 [00:00<00:00, 277.25it/s] 42%|████▏     | 128/306 [00:00<00:00, 271.78it/s] 53%|█████▎    | 161/306 [00:00<00:00, 289.40it/s] 63%|██████▎   | 194/306 [00:00<00:00, 302.02it/s] 74%|███████▍  | 227/306 [00:00<00:00, 310.22it/s] 85%|████████▌ | 261/306 [00:00<00:00, 317.36it/s] 96%|█████████▌| 293/306 [00:00<00:00, 316.14it/s]100%|██████████| 306/306 [00:01<00:00, 304.97it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 59/553 [00:00<00:00, 582.96it/s]extract the null data:  21%|██▏       | 118/553 [00:00<00:00, 566.94it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:00, 584.54it/s]extract the null data:  43%|████▎     | 238/553 [00:00<00:00, 499.09it/s]extract the null data:  54%|█████▍    | 298/553 [00:00<00:00, 529.37it/s]extract the null data:  65%|██████▍   | 358/553 [00:00<00:00, 549.18it/s]extract the null data:  76%|███████▌  | 421/553 [00:00<00:00, 571.27it/s]extract the null data:  88%|████████▊ | 484/553 [00:00<00:00, 587.87it/s]extract the null data:  98%|█████████▊| 544/553 [00:00<00:00, 581.43it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 564.22it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 192.53it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 193.60it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 194.89it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 194.63it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 194.99it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 195.39it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 193.72it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 192.86it/s]replace nan value:  33%|███▎      | 180/553 [00:00<00:01, 192.67it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 199.77it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 201.85it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 200.67it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 183.76it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 189.84it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 193.88it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 197.49it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:01, 199.27it/s]replace nan value:  67%|██████▋   | 370/553 [00:01<00:00, 200.29it/s]replace nan value:  71%|███████   | 391/553 [00:01<00:00, 200.22it/s]replace nan value:  75%|███████▍  | 412/553 [00:02<00:00, 181.97it/s]replace nan value:  78%|███████▊  | 431/553 [00:02<00:00, 177.33it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 188.12it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 191.77it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 194.59it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 197.11it/s]replace nan value:  97%|█████████▋| 536/553 [00:02<00:00, 197.65it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 191.91it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 134.82it/s]  5%|▌         | 29/553 [00:00<00:03, 142.66it/s]  8%|▊         | 44/553 [00:00<00:03, 132.43it/s] 10%|█         | 58/553 [00:00<00:04, 122.55it/s] 13%|█▎        | 71/553 [00:00<00:03, 122.26it/s] 16%|█▌        | 89/553 [00:00<00:03, 136.49it/s] 19%|█▊        | 103/553 [00:00<00:03, 132.23it/s] 22%|██▏       | 120/553 [00:00<00:03, 142.79it/s] 24%|██▍       | 135/553 [00:00<00:02, 139.85it/s] 27%|██▋       | 152/553 [00:01<00:02, 147.08it/s] 31%|███       | 170/553 [00:01<00:02, 155.24it/s] 34%|███▎      | 186/553 [00:01<00:02, 151.15it/s] 37%|███▋      | 202/553 [00:01<00:02, 152.30it/s] 39%|███▉      | 218/553 [00:01<00:02, 116.64it/s] 42%|████▏     | 232/553 [00:01<00:02, 121.29it/s] 45%|████▌     | 249/553 [00:01<00:02, 130.29it/s] 48%|████▊     | 265/553 [00:01<00:02, 136.78it/s] 51%|█████     | 280/553 [00:02<00:02, 132.28it/s] 53%|█████▎    | 294/553 [00:02<00:01, 132.36it/s] 56%|█████▌    | 308/553 [00:02<00:01, 130.97it/s] 58%|█████▊    | 322/553 [00:02<00:01, 129.34it/s] 61%|██████    | 337/553 [00:02<00:01, 132.98it/s] 63%|██████▎   | 351/553 [00:02<00:01, 133.78it/s] 66%|██████▌   | 365/553 [00:02<00:01, 130.32it/s] 69%|██████▊   | 380/553 [00:02<00:01, 134.12it/s] 71%|███████   | 394/553 [00:02<00:01, 123.05it/s] 74%|███████▍  | 408/553 [00:03<00:01, 127.15it/s] 76%|███████▌  | 421/553 [00:03<00:01, 125.57it/s] 78%|███████▊  | 434/553 [00:03<00:00, 123.74it/s] 82%|████████▏ | 453/553 [00:03<00:00, 136.85it/s] 85%|████████▍ | 470/553 [00:03<00:00, 141.87it/s] 88%|████████▊ | 485/553 [00:03<00:00, 140.67it/s] 90%|█████████ | 500/553 [00:03<00:00, 117.15it/s] 93%|█████████▎| 516/553 [00:03<00:00, 126.44it/s] 96%|█████████▌| 530/553 [00:04<00:00, 111.78it/s] 99%|█████████▊| 546/553 [00:04<00:00, 122.62it/s]100%|██████████| 553/553 [00:04<00:00, 129.09it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 40/139 [00:00<00:00, 395.90it/s]extract the null data:  78%|███████▊  | 109/139 [00:00<00:00, 567.63it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 566.94it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 223.38it/s]replace nan value:  34%|███▍      | 47/139 [00:00<00:00, 229.41it/s]replace nan value:  50%|█████     | 70/139 [00:00<00:00, 229.27it/s]replace nan value:  67%|██████▋   | 93/139 [00:00<00:00, 228.33it/s]replace nan value:  84%|████████▍ | 117/139 [00:00<00:00, 230.05it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 223.77it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 127.78it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.52it/s] 32%|███▏      | 44/139 [00:00<00:00, 142.19it/s] 42%|████▏     | 59/139 [00:00<00:00, 120.97it/s] 52%|█████▏    | 72/139 [00:00<00:00, 116.71it/s] 61%|██████    | 85/139 [00:00<00:00, 120.18it/s] 71%|███████   | 98/139 [00:00<00:00, 122.02it/s] 81%|████████  | 112/139 [00:00<00:00, 126.63it/s] 93%|█████████▎| 129/139 [00:01<00:00, 136.54it/s]100%|██████████| 139/139 [00:01<00:00, 130.50it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 299.76it/s]extract the null data:  57%|█████▋    | 98/173 [00:00<00:00, 522.04it/s]extract the null data:  95%|█████████▌| 165/173 [00:00<00:00, 588.98it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 551.14it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 226.73it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 225.73it/s]replace nan value:  40%|████      | 70/173 [00:00<00:00, 230.19it/s]replace nan value:  54%|█████▍    | 94/173 [00:00<00:00, 230.83it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 225.10it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 220.43it/s]replace nan value:  95%|█████████▍| 164/173 [00:00<00:00, 216.65it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 220.25it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 134.82it/s] 16%|█▌        | 28/173 [00:00<00:01, 116.86it/s] 24%|██▍       | 42/173 [00:00<00:01, 126.06it/s] 33%|███▎      | 57/173 [00:00<00:00, 132.70it/s] 41%|████      | 71/173 [00:00<00:00, 131.77it/s] 49%|████▉     | 85/173 [00:00<00:00, 130.21it/s] 57%|█████▋    | 99/173 [00:00<00:00, 131.71it/s] 67%|██████▋   | 116/173 [00:00<00:00, 139.45it/s] 75%|███████▌  | 130/173 [00:00<00:00, 132.64it/s] 83%|████████▎ | 144/173 [00:01<00:00, 128.33it/s] 91%|█████████ | 157/173 [00:01<00:00, 116.69it/s] 98%|█████████▊| 169/173 [00:01<00:00, 96.58it/s] 100%|██████████| 173/173 [00:01<00:00, 114.98it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.110, valid loss : 0.072, train acc : 0.826, valid acc : 0.924, train f1 : 0.542, valid f1 : 0.591
training process:   1%|          | 1/128 [01:05<2:19:03, 65.70s/it]Best score increase :0.000 -> 0.591
training process:   2%|▏         | 2/128 [02:00<2:05:06, 59.57s/it]Best score increase :0.591 -> 0.645
training process:   2%|▏         | 3/128 [03:00<2:03:42, 59.38s/it]Best score increase :0.645 -> 0.663
training process:   3%|▎         | 4/128 [03:59<2:02:56, 59.49s/it]Best score increase :0.663 -> 0.689
epoch : 5, train loss : 0.049, valid loss : 0.055, train acc : 0.939, valid acc : 0.933, train f1 : 0.715, valid f1 : 0.686
training process:   4%|▍         | 5/128 [05:11<2:10:42, 63.76s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [06:05<2:03:30, 60.74s/it]Best score increase :0.689 -> 0.725
training process:   5%|▌         | 7/128 [07:01<1:58:48, 58.92s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:59<1:57:10, 58.58s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.044, valid loss : 0.054, train acc : 0.944, valid acc : 0.938, train f1 : 0.750, valid f1 : 0.729
training process:   7%|▋         | 9/128 [09:07<2:02:10, 61.60s/it]Best score increase :0.725 -> 0.729
training process:   8%|▊         | 10/128 [10:00<1:56:12, 59.09s/it]Best score increase :0.729 -> 0.742
training process:   9%|▊         | 11/128 [10:54<1:52:07, 57.50s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:49<1:49:21, 56.56s/it]Best score increase :0.742 -> 0.758
epoch : 13, train loss : 0.040, valid loss : 0.051, train acc : 0.949, valid acc : 0.941, train f1 : 0.779, valid f1 : 0.751
training process:  10%|█         | 13/128 [12:54<1:53:50, 59.40s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [13:49<1:49:55, 57.86s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [14:46<1:48:28, 57.60s/it]Best score increase :0.758 -> 0.769
training process:  12%|█▎        | 16/128 [15:41<1:46:21, 56.98s/it]Best score increase :0.769 -> 0.774
epoch : 17, train loss : 0.036, valid loss : 0.051, train acc : 0.953, valid acc : 0.944, train f1 : 0.803, valid f1 : 0.776
training process:  13%|█▎        | 17/128 [16:46<1:49:32, 59.22s/it]Best score increase :0.774 -> 0.776
training process:  14%|█▍        | 18/128 [17:40<1:45:44, 57.68s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [18:35<1:43:18, 56.87s/it]Best score increase :0.776 -> 0.780
training process:  16%|█▌        | 20/128 [19:30<1:41:21, 56.31s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.034, valid loss : 0.049, train acc : 0.955, valid acc : 0.948, train f1 : 0.812, valid f1 : 0.793
training process:  16%|█▋        | 21/128 [20:29<1:42:04, 57.24s/it]Best score increase :0.780 -> 0.793
training process:  17%|█▋        | 22/128 [21:17<1:36:17, 54.50s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [22:02<1:30:23, 51.66s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [22:48<1:26:09, 49.71s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.050, train acc : 0.958, valid acc : 0.947, train f1 : 0.827, valid f1 : 0.790
training process:  20%|█▉        | 25/128 [23:40<1:26:46, 50.55s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [24:25<1:23:19, 49.02s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [25:09<1:19:55, 47.48s/it]EarlyStopping counter : 6 out of 12
training process:  22%|██▏       | 28/128 [25:53<1:17:24, 46.44s/it]Best score increase :0.793 -> 0.801
epoch : 29, train loss : 0.031, valid loss : 0.052, train acc : 0.961, valid acc : 0.947, train f1 : 0.844, valid f1 : 0.787
training process:  23%|██▎       | 29/128 [26:48<1:20:51, 49.00s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [27:35<1:19:00, 48.37s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [28:21<1:16:46, 47.49s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [29:06<1:15:01, 46.89s/it]Best score increase :0.801 -> 0.805
epoch : 33, train loss : 0.029, valid loss : 0.046, train acc : 0.962, valid acc : 0.948, train f1 : 0.847, valid f1 : 0.787
training process:  26%|██▌       | 33/128 [30:03<1:18:49, 49.79s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [30:50<1:16:41, 48.95s/it]Best score increase :0.805 -> 0.809
training process:  27%|██▋       | 35/128 [31:35<1:14:14, 47.90s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [32:23<1:13:16, 47.78s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.028, valid loss : 0.049, train acc : 0.964, valid acc : 0.948, train f1 : 0.858, valid f1 : 0.800
training process:  29%|██▉       | 37/128 [33:17<1:15:29, 49.77s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [34:03<1:12:58, 48.65s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:49<1:11:01, 47.89s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [35:36<1:09:42, 47.53s/it]Best score increase :0.809 -> 0.810
epoch : 41, train loss : 0.027, valid loss : 0.048, train acc : 0.965, valid acc : 0.951, train f1 : 0.862, valid f1 : 0.811
training process:  32%|███▏      | 41/128 [36:32<1:12:35, 50.06s/it]Best score increase :0.810 -> 0.811
training process:  33%|███▎      | 42/128 [37:20<1:10:45, 49.36s/it]Best score increase :0.811 -> 0.813
training process:  34%|███▎      | 43/128 [38:06<1:08:40, 48.47s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [38:53<1:07:22, 48.12s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.025, valid loss : 0.051, train acc : 0.967, valid acc : 0.952, train f1 : 0.871, valid f1 : 0.819
training process:  35%|███▌      | 45/128 [39:48<1:09:19, 50.12s/it]Best score increase :0.813 -> 0.819
training process:  36%|███▌      | 46/128 [40:34<1:06:54, 48.95s/it]Best score increase :0.819 -> 0.820
training process:  37%|███▋      | 47/128 [41:21<1:05:14, 48.32s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [42:19<1:08:16, 51.21s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.024, valid loss : 0.052, train acc : 0.968, valid acc : 0.952, train f1 : 0.877, valid f1 : 0.817
training process:  38%|███▊      | 49/128 [43:26<1:13:29, 55.82s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [44:19<1:11:33, 55.05s/it]Best score increase :0.820 -> 0.828
training process:  40%|███▉      | 51/128 [45:16<1:11:32, 55.74s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [46:03<1:07:20, 53.16s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.024, valid loss : 0.053, train acc : 0.969, valid acc : 0.952, train f1 : 0.882, valid f1 : 0.820
training process:  41%|████▏     | 53/128 [47:01<1:07:56, 54.35s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [47:47<1:04:08, 52.01s/it]Best score increase :0.828 -> 0.834
training process:  43%|████▎     | 55/128 [48:41<1:04:00, 52.61s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [49:31<1:02:12, 51.84s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.022, valid loss : 0.055, train acc : 0.970, valid acc : 0.954, train f1 : 0.887, valid f1 : 0.830
training process:  45%|████▍     | 57/128 [50:31<1:04:01, 54.11s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [51:20<1:01:24, 52.63s/it]EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [52:16<1:01:51, 53.79s/it]Best score increase :0.834 -> 0.839
training process:  47%|████▋     | 60/128 [53:15<1:02:39, 55.29s/it]EarlyStopping counter : 1 out of 12
epoch : 61, train loss : 0.022, valid loss : 0.053, train acc : 0.971, valid acc : 0.956, train f1 : 0.888, valid f1 : 0.836
training process:  48%|████▊     | 61/128 [54:19<1:04:45, 57.99s/it]EarlyStopping counter : 2 out of 12
training process:  48%|████▊     | 62/128 [55:13<1:02:14, 56.58s/it]EarlyStopping counter : 3 out of 12
training process:  49%|████▉     | 63/128 [56:06<1:00:23, 55.75s/it]EarlyStopping counter : 4 out of 12
training process:  50%|█████     | 64/128 [57:02<59:30, 55.79s/it]  EarlyStopping counter : 5 out of 12
epoch : 65, train loss : 0.021, valid loss : 0.059, train acc : 0.972, valid acc : 0.951, train f1 : 0.892, valid f1 : 0.821
training process:  51%|█████     | 65/128 [58:08<1:01:46, 58.84s/it]EarlyStopping counter : 6 out of 12
training process:  52%|█████▏    | 66/128 [59:01<58:57, 57.06s/it]  EarlyStopping counter : 7 out of 12
training process:  52%|█████▏    | 67/128 [59:57<57:36, 56.67s/it]EarlyStopping counter : 8 out of 12
training process:  53%|█████▎    | 68/128 [1:00:57<57:49, 57.83s/it]EarlyStopping counter : 9 out of 12
epoch : 69, train loss : 0.021, valid loss : 0.058, train acc : 0.972, valid acc : 0.953, train f1 : 0.894, valid f1 : 0.827
training process:  54%|█████▍    | 69/128 [1:01:56<57:08, 58.11s/it]EarlyStopping counter : 10 out of 12
training process:  55%|█████▍    | 70/128 [1:02:45<53:29, 55.34s/it]EarlyStopping counter : 11 out of 12
training process:  55%|█████▍    | 70/128 [1:03:34<52:40, 54.49s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 70, best f1 score : 0.840
training process finished, best loss : 0.056 and best acc : 0.956, best f1 : 0.840, best epoch : 69

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.80      0.61      0.69       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.89      0.80      0.84      7398
weighted avg       0.95      0.96      0.95      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.80, test loss : 3.124

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.54s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.69s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.72s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:02,  7.78s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.77s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.92s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.88s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.84s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.80s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.82s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:08,  8.01s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.92s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.85s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 24/306 [00:00<00:01, 239.65it/s] 18%|█▊        | 56/306 [00:00<00:00, 271.37it/s] 27%|██▋       | 84/306 [00:00<00:00, 258.06it/s] 36%|███▌      | 110/306 [00:00<00:00, 256.51it/s] 44%|████▍     | 136/306 [00:00<00:00, 254.74it/s] 53%|█████▎    | 162/306 [00:00<00:00, 232.43it/s] 61%|██████    | 186/306 [00:00<00:00, 231.70it/s] 69%|██████▉   | 212/306 [00:00<00:00, 238.55it/s] 77%|███████▋  | 237/306 [00:00<00:00, 222.54it/s] 85%|████████▍ | 260/306 [00:01<00:00, 221.97it/s] 93%|█████████▎| 286/306 [00:01<00:00, 226.20it/s]100%|██████████| 306/306 [00:01<00:00, 232.65it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 554.47it/s]extract the null data:  21%|██        | 114/553 [00:00<00:00, 565.51it/s]extract the null data:  31%|███       | 172/553 [00:00<00:00, 570.57it/s]extract the null data:  42%|████▏     | 230/553 [00:00<00:00, 574.09it/s]extract the null data:  52%|█████▏    | 290/553 [00:00<00:00, 581.80it/s]extract the null data:  63%|██████▎   | 350/553 [00:00<00:00, 585.71it/s]extract the null data:  74%|███████▍  | 410/553 [00:00<00:00, 588.26it/s]extract the null data:  85%|████████▍ | 469/553 [00:00<00:00, 582.94it/s]extract the null data:  95%|█████████▌| 528/553 [00:00<00:00, 582.07it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 580.72it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 196.34it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 197.72it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 198.15it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 197.74it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 195.80it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 198.05it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 198.82it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:01, 200.68it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 203.84it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:01, 204.60it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 203.89it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 203.56it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 199.98it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 200.51it/s]replace nan value:  56%|█████▌    | 311/553 [00:01<00:01, 200.08it/s]replace nan value:  60%|██████    | 332/553 [00:01<00:01, 199.49it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:01, 198.11it/s]replace nan value:  67%|██████▋   | 372/553 [00:01<00:00, 196.85it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 195.69it/s]replace nan value:  75%|███████▍  | 412/553 [00:02<00:00, 196.04it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 196.17it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 199.15it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 200.63it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 201.42it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 199.97it/s]replace nan value:  97%|█████████▋| 537/553 [00:02<00:00, 201.25it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 199.84it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.15it/s]  6%|▌         | 31/553 [00:00<00:03, 149.93it/s]  8%|▊         | 47/553 [00:00<00:03, 126.79it/s] 11%|█         | 61/553 [00:00<00:03, 123.48it/s] 14%|█▎        | 76/553 [00:00<00:03, 131.23it/s] 16%|█▋        | 91/553 [00:00<00:03, 132.91it/s] 19%|█▉        | 106/553 [00:00<00:03, 136.53it/s] 22%|██▏       | 122/553 [00:00<00:03, 140.49it/s] 25%|██▌       | 139/553 [00:01<00:02, 148.21it/s] 29%|██▊       | 158/553 [00:01<00:02, 157.91it/s] 31%|███▏      | 174/553 [00:01<00:02, 157.39it/s] 35%|███▍      | 191/553 [00:01<00:02, 160.03it/s] 38%|███▊      | 209/553 [00:01<00:02, 165.67it/s] 41%|████      | 226/553 [00:01<00:02, 154.24it/s] 44%|████▍     | 242/553 [00:01<00:02, 154.01it/s] 47%|████▋     | 258/553 [00:01<00:01, 150.65it/s] 50%|████▉     | 274/553 [00:01<00:01, 147.55it/s] 53%|█████▎    | 291/553 [00:01<00:01, 149.48it/s] 56%|█████▌    | 307/553 [00:02<00:01, 137.35it/s] 58%|█████▊    | 321/553 [00:02<00:01, 132.48it/s] 61%|██████    | 336/553 [00:02<00:01, 135.90it/s] 63%|██████▎   | 350/553 [00:02<00:01, 135.07it/s] 66%|██████▌   | 364/553 [00:02<00:01, 132.74it/s] 69%|██████▊   | 379/553 [00:02<00:01, 136.31it/s] 71%|███████   | 393/553 [00:02<00:01, 125.85it/s] 74%|███████▎  | 407/553 [00:02<00:01, 128.66it/s] 76%|███████▌  | 421/553 [00:03<00:01, 126.94it/s] 78%|███████▊  | 434/553 [00:03<00:00, 125.07it/s] 82%|████████▏ | 453/553 [00:03<00:00, 138.12it/s] 85%|████████▍ | 470/553 [00:03<00:00, 143.38it/s] 88%|████████▊ | 485/553 [00:03<00:00, 142.87it/s] 90%|█████████ | 500/553 [00:03<00:00, 131.40it/s] 93%|█████████▎| 516/553 [00:03<00:00, 138.99it/s] 96%|█████████▌| 531/553 [00:03<00:00, 118.20it/s] 99%|█████████▉| 548/553 [00:03<00:00, 129.03it/s]100%|██████████| 553/553 [00:04<00:00, 136.20it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 38/139 [00:00<00:00, 379.49it/s]extract the null data:  77%|███████▋  | 107/139 [00:00<00:00, 558.03it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 561.27it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 229.75it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 224.79it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 221.55it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 219.75it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 218.71it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 219.06it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 220.26it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 127.52it/s] 19%|█▉        | 27/139 [00:00<00:00, 130.31it/s] 32%|███▏      | 44/139 [00:00<00:00, 142.55it/s] 42%|████▏     | 59/139 [00:00<00:00, 130.44it/s] 53%|█████▎    | 74/139 [00:00<00:00, 134.02it/s] 63%|██████▎   | 88/139 [00:00<00:00, 117.18it/s] 74%|███████▍  | 103/139 [00:00<00:00, 125.84it/s] 83%|████████▎ | 116/139 [00:00<00:00, 126.59it/s] 94%|█████████▎| 130/139 [00:01<00:00, 129.29it/s]100%|██████████| 139/139 [00:01<00:00, 129.37it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 42/173 [00:00<00:00, 414.97it/s]extract the null data:  62%|██████▏   | 107/173 [00:00<00:00, 549.79it/s]extract the null data:  98%|█████████▊| 169/173 [00:00<00:00, 579.59it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 557.09it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 214.85it/s]replace nan value:  26%|██▌       | 45/173 [00:00<00:00, 218.97it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 220.05it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 219.85it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 220.72it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 220.84it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 220.44it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 219.23it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 140.51it/s] 17%|█▋        | 30/173 [00:00<00:01, 126.79it/s] 27%|██▋       | 46/173 [00:00<00:00, 137.35it/s] 36%|███▌      | 62/173 [00:00<00:00, 142.64it/s] 45%|████▍     | 77/173 [00:00<00:00, 140.74it/s] 53%|█████▎    | 92/173 [00:00<00:00, 139.96it/s] 62%|██████▏   | 107/173 [00:00<00:00, 140.93it/s] 71%|███████   | 122/173 [00:00<00:00, 139.16it/s] 79%|███████▊  | 136/173 [00:00<00:00, 133.66it/s] 87%|████████▋ | 150/173 [00:01<00:00, 129.51it/s] 94%|█████████▍| 163/173 [00:01<00:00, 122.38it/s]100%|██████████| 173/173 [00:01<00:00, 121.80it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.124, train acc : 0.708, valid acc : 0.794, train f1 : 0.708, valid f1 : 0.624
training process:   1%|          | 1/128 [00:57<2:00:40, 57.01s/it]Best score increase :0.000 -> 0.624
training process:   2%|▏         | 2/128 [01:45<1:48:43, 51.78s/it]Best score increase :0.624 -> 0.639
training process:   2%|▏         | 3/128 [02:34<1:45:25, 50.61s/it]Best score increase :0.639 -> 0.678
training process:   3%|▎         | 4/128 [03:23<1:43:17, 49.98s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.100, valid loss : 0.102, train acc : 0.823, valid acc : 0.853, train f1 : 0.822, valid f1 : 0.689
training process:   4%|▍         | 5/128 [04:19<1:46:57, 52.18s/it]Best score increase :0.678 -> 0.689
training process:   5%|▍         | 6/128 [05:10<1:45:03, 51.67s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [05:58<1:41:51, 50.51s/it]Best score increase :0.689 -> 0.695
training process:   6%|▋         | 8/128 [06:50<1:41:52, 50.94s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.085, valid loss : 0.111, train acc : 0.857, valid acc : 0.843, train f1 : 0.856, valid f1 : 0.686
training process:   7%|▋         | 9/128 [07:48<1:45:44, 53.31s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [08:38<1:42:59, 52.37s/it]Best score increase :0.695 -> 0.710
training process:   9%|▊         | 11/128 [09:28<1:40:35, 51.59s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:22<1:40:50, 52.16s/it]Best score increase :0.710 -> 0.715
epoch : 13, train loss : 0.074, valid loss : 0.090, train acc : 0.879, valid acc : 0.882, train f1 : 0.879, valid f1 : 0.733
training process:  10%|█         | 13/128 [11:23<1:45:23, 54.99s/it]Best score increase :0.715 -> 0.733
training process:  11%|█         | 14/128 [12:14<1:42:09, 53.76s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:07<1:40:28, 53.35s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [13:56<1:37:26, 52.20s/it]Best score increase :0.733 -> 0.742
epoch : 17, train loss : 0.067, valid loss : 0.088, train acc : 0.893, valid acc : 0.880, train f1 : 0.893, valid f1 : 0.735
training process:  13%|█▎        | 17/128 [14:55<1:40:10, 54.15s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:47<1:38:04, 53.50s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [16:39<1:36:24, 53.06s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [17:32<1:35:38, 53.13s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.059, valid loss : 0.092, train acc : 0.907, valid acc : 0.873, train f1 : 0.907, valid f1 : 0.726
training process:  16%|█▋        | 21/128 [18:33<1:38:51, 55.43s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [19:27<1:37:06, 54.97s/it]Best score increase :0.742 -> 0.765
training process:  18%|█▊        | 23/128 [20:20<1:35:08, 54.37s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:13<1:33:27, 53.92s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.055, valid loss : 0.076, train acc : 0.918, valid acc : 0.890, train f1 : 0.918, valid f1 : 0.749
training process:  20%|█▉        | 25/128 [22:10<1:34:36, 55.11s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [23:03<1:32:20, 54.32s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [23:52<1:28:58, 52.86s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [24:41<1:25:59, 51.59s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.050, valid loss : 0.077, train acc : 0.925, valid acc : 0.896, train f1 : 0.925, valid f1 : 0.758
training process:  23%|██▎       | 29/128 [25:39<1:28:24, 53.58s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [26:29<1:25:30, 52.36s/it]EarlyStopping counter : 8 out of 12
training process:  24%|██▍       | 31/128 [27:20<1:23:55, 51.91s/it]EarlyStopping counter : 9 out of 12
training process:  25%|██▌       | 32/128 [28:08<1:21:20, 50.84s/it]EarlyStopping counter : 10 out of 12
epoch : 33, train loss : 0.048, valid loss : 0.069, train acc : 0.931, valid acc : 0.909, train f1 : 0.931, valid f1 : 0.775
training process:  26%|██▌       | 33/128 [29:06<1:23:57, 53.03s/it]Best score increase :0.765 -> 0.775
training process:  27%|██▋       | 34/128 [30:01<1:23:49, 53.51s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [30:52<1:21:40, 52.69s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [31:43<1:20:18, 52.37s/it]Best score increase :0.775 -> 0.781
epoch : 37, train loss : 0.046, valid loss : 0.061, train acc : 0.930, valid acc : 0.929, train f1 : 0.930, valid f1 : 0.807
training process:  29%|██▉       | 37/128 [32:45<1:23:37, 55.13s/it]Best score increase :0.781 -> 0.807
training process:  30%|██▉       | 38/128 [33:34<1:19:53, 53.26s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [34:21<1:16:22, 51.49s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [35:13<1:15:37, 51.57s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.042, valid loss : 0.073, train acc : 0.937, valid acc : 0.909, train f1 : 0.937, valid f1 : 0.779
training process:  32%|███▏      | 41/128 [36:15<1:19:27, 54.80s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [37:02<1:15:11, 52.46s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [37:55<1:14:27, 52.56s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [38:43<1:11:45, 51.26s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.041, valid loss : 0.071, train acc : 0.941, valid acc : 0.922, train f1 : 0.941, valid f1 : 0.800
training process:  35%|███▌      | 45/128 [39:44<1:15:00, 54.22s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [40:38<1:13:49, 54.01s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [41:35<1:14:21, 55.08s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [42:33<1:14:39, 56.00s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.039, valid loss : 0.077, train acc : 0.942, valid acc : 0.891, train f1 : 0.942, valid f1 : 0.751
training process:  38%|███▊      | 48/128 [43:41<1:12:49, 54.62s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.807
training process finished, best loss : 0.061 and best acc : 0.929, best f1 : 0.807, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.78      0.66       580
           1       0.98      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.86      0.81      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.86, test loss : 3.052

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:36,  8.75s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:26,  8.64s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:16,  8.55s/it]processing for feature importance:  33%|███▎      | 4/12 [00:35<01:12,  9.06s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:07,  9.62s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:59,  9.89s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:05<00:47,  9.49s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:14<00:37,  9.48s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:22<00:27,  9.03s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:31<00:17,  8.81s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:39<00:08,  8.63s/it]processing for feature importance: 100%|██████████| 12/12 [01:48<00:00,  8.86s/it]processing for feature importance: 100%|██████████| 12/12 [01:48<00:00,  9.06s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 107.23it/s] 11%|█         | 34/306 [00:00<00:01, 169.87it/s] 17%|█▋        | 51/306 [00:00<00:01, 147.08it/s] 22%|██▏       | 67/306 [00:00<00:01, 147.76it/s] 28%|██▊       | 86/306 [00:00<00:01, 160.70it/s] 34%|███▎      | 103/306 [00:00<00:01, 142.52it/s] 41%|████      | 124/306 [00:00<00:01, 156.80it/s] 46%|████▌     | 141/306 [00:00<00:01, 158.64it/s] 52%|█████▏    | 159/306 [00:01<00:00, 161.81it/s] 58%|█████▊    | 179/306 [00:01<00:00, 171.80it/s] 64%|██████▍   | 197/306 [00:01<00:00, 151.58it/s] 70%|██████▉   | 214/306 [00:01<00:00, 155.00it/s] 75%|███████▌  | 231/306 [00:01<00:00, 157.71it/s] 81%|████████  | 248/306 [00:01<00:00, 141.77it/s] 88%|████████▊ | 269/306 [00:01<00:00, 157.18it/s] 93%|█████████▎| 286/306 [00:01<00:00, 157.73it/s] 99%|█████████▉| 303/306 [00:01<00:00, 145.64it/s]100%|██████████| 306/306 [00:02<00:00, 152.77it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 578.26it/s]extract the null data:  21%|██▏       | 118/553 [00:00<00:00, 586.79it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:00, 596.87it/s]extract the null data:  43%|████▎     | 240/553 [00:00<00:00, 600.30it/s]extract the null data:  55%|█████▍    | 303/553 [00:00<00:00, 609.36it/s]extract the null data:  66%|██████▌   | 365/553 [00:00<00:00, 612.74it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 618.13it/s]extract the null data:  89%|████████▊ | 490/553 [00:00<00:00, 614.27it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 617.87it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 609.94it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 193.78it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 196.25it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 193.94it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 196.46it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 196.58it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 196.70it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 200.93it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:01, 202.76it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 203.59it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 206.19it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 205.77it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 205.56it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 204.60it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 203.62it/s]replace nan value:  56%|█████▋    | 312/553 [00:01<00:01, 203.25it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 204.62it/s]replace nan value:  64%|██████▍   | 354/553 [00:01<00:00, 205.18it/s]replace nan value:  68%|██████▊   | 375/553 [00:01<00:00, 205.02it/s]replace nan value:  72%|███████▏  | 396/553 [00:01<00:00, 205.38it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 205.65it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 205.36it/s]replace nan value:  83%|████████▎ | 459/553 [00:02<00:00, 203.70it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 203.10it/s]replace nan value:  91%|█████████ | 501/553 [00:02<00:00, 201.14it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 200.64it/s]replace nan value:  98%|█████████▊| 543/553 [00:02<00:00, 198.74it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 201.86it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.38it/s]  5%|▍         | 26/553 [00:00<00:04, 127.57it/s]  7%|▋         | 40/553 [00:00<00:04, 128.14it/s] 10%|▉         | 53/553 [00:00<00:04, 116.55it/s] 12%|█▏        | 65/553 [00:00<00:04, 106.73it/s] 14%|█▍        | 78/553 [00:00<00:04, 110.86it/s] 16%|█▋        | 91/553 [00:00<00:04, 114.80it/s] 19%|█▊        | 103/553 [00:00<00:03, 115.67it/s] 22%|██▏       | 119/553 [00:00<00:03, 127.03it/s] 24%|██▍       | 132/553 [00:01<00:03, 127.87it/s] 27%|██▋       | 150/553 [00:01<00:02, 142.75it/s] 30%|███       | 168/553 [00:01<00:02, 151.87it/s] 33%|███▎      | 184/553 [00:01<00:02, 150.09it/s] 37%|███▋      | 202/553 [00:01<00:02, 155.37it/s] 39%|███▉      | 218/553 [00:01<00:02, 154.76it/s] 42%|████▏     | 234/553 [00:01<00:02, 149.71it/s] 45%|████▌     | 250/553 [00:01<00:02, 150.56it/s] 48%|████▊     | 266/553 [00:01<00:01, 147.61it/s] 51%|█████     | 281/553 [00:02<00:01, 144.81it/s] 54%|█████▎    | 296/553 [00:02<00:01, 138.83it/s] 56%|█████▌    | 310/553 [00:02<00:01, 136.92it/s] 59%|█████▊    | 324/553 [00:02<00:01, 135.32it/s] 61%|██████▏   | 339/553 [00:02<00:01, 137.39it/s] 64%|██████▍   | 353/553 [00:02<00:01, 136.55it/s] 66%|██████▋   | 367/553 [00:02<00:01, 133.65it/s] 69%|██████▉   | 383/553 [00:02<00:01, 139.53it/s] 72%|███████▏  | 397/553 [00:02<00:01, 122.38it/s] 75%|███████▍  | 414/553 [00:03<00:01, 130.42it/s] 77%|███████▋  | 428/553 [00:03<00:01, 119.41it/s] 81%|████████  | 446/553 [00:03<00:00, 134.73it/s] 84%|████████▎ | 462/553 [00:03<00:00, 140.03it/s] 86%|████████▋ | 477/553 [00:03<00:00, 141.79it/s] 89%|████████▉ | 492/553 [00:03<00:00, 131.75it/s] 92%|█████████▏| 506/553 [00:03<00:00, 129.96it/s] 94%|█████████▍| 521/553 [00:03<00:00, 131.37it/s] 97%|█████████▋| 535/553 [00:04<00:00, 117.10it/s]100%|█████████▉| 551/553 [00:04<00:00, 109.34it/s]100%|██████████| 553/553 [00:04<00:00, 130.95it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 358.22it/s]extract the null data:  76%|███████▌  | 105/139 [00:00<00:00, 548.49it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 550.16it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 225.53it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 224.10it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 223.61it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 218.33it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 218.52it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 218.47it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 219.54it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 126.42it/s] 19%|█▉        | 27/139 [00:00<00:00, 128.80it/s] 31%|███       | 43/139 [00:00<00:00, 142.59it/s] 42%|████▏     | 58/139 [00:00<00:00, 125.39it/s] 53%|█████▎    | 74/139 [00:00<00:00, 131.53it/s] 63%|██████▎   | 88/139 [00:00<00:00, 115.88it/s] 75%|███████▍  | 104/139 [00:00<00:00, 125.50it/s] 84%|████████▍ | 117/139 [00:00<00:00, 126.42it/s] 94%|█████████▍| 131/139 [00:01<00:00, 127.07it/s]100%|██████████| 139/139 [00:01<00:00, 128.14it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 288.86it/s]extract the null data:  56%|█████▌    | 97/173 [00:00<00:00, 515.40it/s]extract the null data:  94%|█████████▍| 163/173 [00:00<00:00, 578.23it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 543.16it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 221.08it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 219.03it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 220.52it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 219.15it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 219.39it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 217.79it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 218.62it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 217.95it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.18it/s] 16%|█▌        | 28/173 [00:00<00:01, 122.03it/s] 25%|██▍       | 43/173 [00:00<00:00, 133.04it/s] 34%|███▍      | 59/173 [00:00<00:00, 141.40it/s] 43%|████▎     | 74/173 [00:00<00:00, 140.24it/s] 51%|█████▏    | 89/173 [00:00<00:00, 139.72it/s] 60%|██████    | 104/173 [00:00<00:00, 135.96it/s] 69%|██████▉   | 119/173 [00:00<00:00, 137.53it/s] 77%|███████▋  | 133/173 [00:00<00:00, 130.47it/s] 85%|████████▍ | 147/173 [00:01<00:00, 130.10it/s] 93%|█████████▎| 161/173 [00:01<00:00, 115.88it/s]100%|██████████| 173/173 [00:01<00:00, 90.34it/s] 100%|██████████| 173/173 [00:01<00:00, 118.24it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.022, valid loss : 0.026, train acc : 0.594, valid acc : 0.779, train f1 : 0.478, valid f1 : 0.610
training process:   1%|          | 1/128 [00:59<2:06:14, 59.64s/it]Best score increase :0.000 -> 0.610
training process:   2%|▏         | 2/128 [01:48<1:52:15, 53.46s/it]Best score increase :0.610 -> 0.639
training process:   2%|▏         | 3/128 [02:40<1:49:28, 52.55s/it]Best score increase :0.639 -> 0.678
training process:   3%|▎         | 4/128 [03:30<1:46:50, 51.70s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.016, valid loss : 0.022, train acc : 0.849, valid acc : 0.854, train f1 : 0.677, valid f1 : 0.690
training process:   4%|▍         | 5/128 [04:29<1:51:24, 54.35s/it]Best score increase :0.678 -> 0.690
training process:   5%|▍         | 6/128 [05:17<1:46:12, 52.23s/it]Best score increase :0.690 -> 0.697
training process:   5%|▌         | 7/128 [06:07<1:43:57, 51.55s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [06:58<1:42:39, 51.33s/it]Best score increase :0.697 -> 0.719
epoch : 9, train loss : 0.015, valid loss : 0.023, train acc : 0.882, valid acc : 0.868, train f1 : 0.719, valid f1 : 0.704
training process:   7%|▋         | 9/128 [07:56<1:45:27, 53.18s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:44<1:41:53, 51.81s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:35<1:40:17, 51.43s/it]Best score increase :0.719 -> 0.729
training process:   9%|▉         | 12/128 [10:24<1:38:07, 50.75s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.013, valid loss : 0.022, train acc : 0.893, valid acc : 0.883, train f1 : 0.739, valid f1 : 0.720
training process:  10%|█         | 13/128 [11:27<1:44:27, 54.50s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:29<1:47:48, 56.74s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [13:33<1:50:52, 58.87s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [14:34<1:51:04, 59.51s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.012, valid loss : 0.023, train acc : 0.906, valid acc : 0.871, train f1 : 0.762, valid f1 : 0.713
training process:  13%|█▎        | 17/128 [15:44<1:56:06, 62.76s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [16:43<1:52:49, 61.54s/it]EarlyStopping counter : 7 out of 12
training process:  15%|█▍        | 19/128 [17:42<1:50:26, 60.79s/it]EarlyStopping counter : 8 out of 12
training process:  16%|█▌        | 20/128 [18:43<1:49:34, 60.88s/it]EarlyStopping counter : 9 out of 12
epoch : 21, train loss : 0.011, valid loss : 0.022, train acc : 0.914, valid acc : 0.878, train f1 : 0.779, valid f1 : 0.727
training process:  16%|█▋        | 21/128 [19:51<1:52:22, 63.01s/it]EarlyStopping counter : 10 out of 12
training process:  17%|█▋        | 22/128 [20:57<1:53:04, 64.01s/it]Best score increase :0.729 -> 0.747
training process:  18%|█▊        | 23/128 [21:47<1:44:36, 59.77s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:39<1:39:31, 57.42s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.011, valid loss : 0.023, train acc : 0.926, valid acc : 0.900, train f1 : 0.800, valid f1 : 0.749
training process:  20%|█▉        | 25/128 [23:44<1:42:12, 59.54s/it]Best score increase :0.747 -> 0.749
training process:  20%|██        | 26/128 [24:41<1:39:51, 58.74s/it]Best score increase :0.749 -> 0.753
training process:  21%|██        | 27/128 [25:30<1:34:23, 56.07s/it]Best score increase :0.753 -> 0.759
training process:  22%|██▏       | 28/128 [26:25<1:32:42, 55.63s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.010, valid loss : 0.025, train acc : 0.927, valid acc : 0.907, train f1 : 0.804, valid f1 : 0.753
training process:  23%|██▎       | 29/128 [27:33<1:38:06, 59.46s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [28:31<1:36:06, 58.84s/it]Best score increase :0.759 -> 0.771
training process:  24%|██▍       | 31/128 [29:25<1:32:38, 57.31s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [30:16<1:28:47, 55.49s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.010, valid loss : 0.022, train acc : 0.934, valid acc : 0.907, train f1 : 0.818, valid f1 : 0.754
training process:  26%|██▌       | 33/128 [31:21<1:32:30, 58.42s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 34/128 [32:27<1:35:09, 60.74s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 35/128 [33:16<1:28:36, 57.16s/it]Best score increase :0.771 -> 0.774
training process:  28%|██▊       | 36/128 [34:05<1:23:41, 54.58s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.009, valid loss : 0.025, train acc : 0.941, valid acc : 0.918, train f1 : 0.832, valid f1 : 0.783
training process:  29%|██▉       | 37/128 [35:01<1:23:31, 55.07s/it]Best score increase :0.774 -> 0.783
training process:  30%|██▉       | 38/128 [35:52<1:20:43, 53.81s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [36:42<1:18:13, 52.74s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [37:30<1:15:26, 51.44s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.009, valid loss : 0.026, train acc : 0.940, valid acc : 0.924, train f1 : 0.831, valid f1 : 0.788
training process:  32%|███▏      | 41/128 [38:29<1:17:52, 53.71s/it]Best score increase :0.783 -> 0.788
training process:  33%|███▎      | 42/128 [39:19<1:15:06, 52.40s/it]Best score increase :0.788 -> 0.798
training process:  34%|███▎      | 43/128 [40:07<1:12:39, 51.29s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [41:03<1:13:32, 52.53s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.026, train acc : 0.946, valid acc : 0.918, train f1 : 0.845, valid f1 : 0.788
training process:  35%|███▌      | 45/128 [42:09<1:18:22, 56.65s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [43:00<1:15:16, 55.08s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [43:51<1:12:27, 53.68s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [44:48<1:13:00, 54.76s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.008, valid loss : 0.030, train acc : 0.948, valid acc : 0.928, train f1 : 0.849, valid f1 : 0.804
training process:  38%|███▊      | 49/128 [45:59<1:18:22, 59.52s/it]Best score increase :0.798 -> 0.804
training process:  39%|███▉      | 50/128 [46:50<1:14:08, 57.03s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [47:41<1:10:51, 55.22s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [48:29<1:07:18, 53.14s/it]EarlyStopping counter : 3 out of 12
epoch : 53, train loss : 0.008, valid loss : 0.030, train acc : 0.952, valid acc : 0.930, train f1 : 0.858, valid f1 : 0.807
training process:  41%|████▏     | 53/128 [49:26<1:07:54, 54.33s/it]Best score increase :0.804 -> 0.807
training process:  42%|████▏     | 54/128 [50:15<1:04:57, 52.68s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [51:05<1:02:55, 51.71s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [51:55<1:01:32, 51.29s/it]Best score increase :0.807 -> 0.814
epoch : 57, train loss : 0.008, valid loss : 0.029, train acc : 0.954, valid acc : 0.910, train f1 : 0.865, valid f1 : 0.775
training process:  45%|████▍     | 57/128 [52:56<1:04:14, 54.28s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [53:45<1:01:32, 52.75s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 59/128 [54:34<59:17, 51.56s/it]  EarlyStopping counter : 3 out of 12
training process:  47%|████▋     | 60/128 [55:24<57:41, 50.91s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.008, valid loss : 0.028, train acc : 0.955, valid acc : 0.930, train f1 : 0.867, valid f1 : 0.806
training process:  48%|████▊     | 61/128 [56:22<59:18, 53.11s/it]EarlyStopping counter : 5 out of 12
training process:  48%|████▊     | 62/128 [57:12<57:36, 52.37s/it]EarlyStopping counter : 6 out of 12
training process:  49%|████▉     | 63/128 [58:03<56:11, 51.87s/it]EarlyStopping counter : 7 out of 12
training process:  50%|█████     | 64/128 [58:53<54:32, 51.13s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.007, valid loss : 0.035, train acc : 0.956, valid acc : 0.934, train f1 : 0.870, valid f1 : 0.813
training process:  51%|█████     | 65/128 [59:51<55:59, 53.32s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 66/128 [1:00:42<54:20, 52.59s/it]Best score increase :0.814 -> 0.824
training process:  52%|█████▏    | 67/128 [1:01:37<54:13, 53.34s/it]EarlyStopping counter : 1 out of 12
training process:  53%|█████▎    | 68/128 [1:02:29<53:00, 53.01s/it]EarlyStopping counter : 2 out of 12
epoch : 69, train loss : 0.007, valid loss : 0.036, train acc : 0.960, valid acc : 0.937, train f1 : 0.878, valid f1 : 0.819
training process:  54%|█████▍    | 69/128 [1:03:30<54:29, 55.42s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▍    | 70/128 [1:04:21<52:11, 53.99s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▌    | 71/128 [1:05:12<50:28, 53.12s/it]Best score increase :0.824 -> 0.827
training process:  56%|█████▋    | 72/128 [1:06:03<48:51, 52.34s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.007, valid loss : 0.031, train acc : 0.958, valid acc : 0.937, train f1 : 0.875, valid f1 : 0.821
training process:  57%|█████▋    | 73/128 [1:07:22<55:20, 60.37s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:08:25<55:06, 61.23s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▊    | 75/128 [1:09:25<53:49, 60.93s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▉    | 76/128 [1:10:18<50:40, 58.48s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.007, valid loss : 0.032, train acc : 0.962, valid acc : 0.928, train f1 : 0.885, valid f1 : 0.805
training process:  60%|██████    | 77/128 [1:11:20<50:32, 59.46s/it]EarlyStopping counter : 6 out of 12
training process:  61%|██████    | 78/128 [1:12:13<48:06, 57.72s/it]EarlyStopping counter : 7 out of 12
training process:  62%|██████▏   | 79/128 [1:13:03<45:12, 55.37s/it]Best score increase :0.827 -> 0.835
training process:  62%|██████▎   | 80/128 [1:13:55<43:28, 54.34s/it]EarlyStopping counter : 1 out of 12
epoch : 81, train loss : 0.007, valid loss : 0.037, train acc : 0.962, valid acc : 0.939, train f1 : 0.884, valid f1 : 0.822
training process:  63%|██████▎   | 81/128 [1:14:55<43:53, 56.04s/it]EarlyStopping counter : 2 out of 12
training process:  64%|██████▍   | 82/128 [1:15:46<41:42, 54.41s/it]EarlyStopping counter : 3 out of 12
training process:  65%|██████▍   | 83/128 [1:16:34<39:26, 52.59s/it]EarlyStopping counter : 4 out of 12
training process:  66%|██████▌   | 84/128 [1:17:25<38:12, 52.10s/it]EarlyStopping counter : 5 out of 12
epoch : 85, train loss : 0.007, valid loss : 0.040, train acc : 0.960, valid acc : 0.926, train f1 : 0.879, valid f1 : 0.800
training process:  66%|██████▋   | 85/128 [1:18:24<38:54, 54.28s/it]EarlyStopping counter : 6 out of 12
training process:  67%|██████▋   | 86/128 [1:19:14<37:01, 52.90s/it]EarlyStopping counter : 7 out of 12
training process:  68%|██████▊   | 87/128 [1:20:04<35:37, 52.14s/it]EarlyStopping counter : 8 out of 12
training process:  69%|██████▉   | 88/128 [1:20:55<34:28, 51.72s/it]EarlyStopping counter : 9 out of 12
epoch : 89, train loss : 0.007, valid loss : 0.041, train acc : 0.962, valid acc : 0.934, train f1 : 0.883, valid f1 : 0.817
training process:  70%|██████▉   | 89/128 [1:21:53<34:43, 53.43s/it]EarlyStopping counter : 10 out of 12
training process:  70%|███████   | 90/128 [1:22:43<33:11, 52.41s/it]EarlyStopping counter : 11 out of 12
training process:  70%|███████   | 90/128 [1:23:34<35:17, 55.71s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 90, best f1 score : 0.835
training process finished, best loss : 0.041 and best acc : 0.945, best f1 : 0.835, best epoch : 87

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.69      0.73      0.71       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.84      0.85      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.85, test loss : 1.554

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.56s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.79s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.80s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.89s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.92s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:48,  8.08s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.86s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.77s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.79s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.81s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.76s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.81s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 32/306 [00:00<00:00, 313.25it/s] 21%|██        | 64/306 [00:00<00:00, 305.50it/s] 31%|███▏      | 96/306 [00:00<00:00, 309.90it/s] 42%|████▏     | 128/306 [00:00<00:00, 313.75it/s] 53%|█████▎    | 163/306 [00:00<00:00, 324.03it/s] 64%|██████▍   | 196/306 [00:00<00:00, 322.19it/s] 75%|███████▍  | 229/306 [00:00<00:00, 319.32it/s] 86%|████████▌ | 262/306 [00:00<00:00, 320.54it/s] 97%|█████████▋| 296/306 [00:00<00:00, 323.55it/s]100%|██████████| 306/306 [00:00<00:00, 320.17it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 451.84it/s]extract the null data:  17%|█▋        | 94/553 [00:00<00:00, 466.23it/s]extract the null data:  26%|██▌       | 143/553 [00:00<00:00, 473.18it/s]extract the null data:  35%|███▌      | 194/553 [00:00<00:00, 485.19it/s]extract the null data:  44%|████▍     | 244/553 [00:00<00:00, 487.28it/s]extract the null data:  53%|█████▎    | 293/553 [00:00<00:00, 482.69it/s]extract the null data:  62%|██████▏   | 342/553 [00:00<00:00, 472.20it/s]extract the null data:  71%|███████   | 390/553 [00:00<00:00, 473.05it/s]extract the null data:  79%|███████▉  | 439/553 [00:00<00:00, 477.43it/s]extract the null data:  88%|████████▊ | 488/553 [00:01<00:00, 481.11it/s]extract the null data:  97%|█████████▋| 537/553 [00:01<00:00, 481.42it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 477.52it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 164.36it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 163.00it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 163.52it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 165.45it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 168.85it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 172.71it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 175.20it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 177.49it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 176.25it/s]replace nan value:  32%|███▏      | 179/553 [00:01<00:02, 176.46it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 177.48it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:01, 178.53it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 179.51it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 180.11it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 179.67it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 181.64it/s]replace nan value:  56%|█████▌    | 311/553 [00:01<00:01, 180.51it/s]replace nan value:  60%|█████▉    | 330/553 [00:01<00:01, 179.37it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:01, 177.97it/s]replace nan value:  66%|██████▌   | 366/553 [00:02<00:01, 176.93it/s]replace nan value:  69%|██████▉   | 384/553 [00:02<00:00, 175.73it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 174.21it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 169.75it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 170.76it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 172.92it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 173.39it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 174.63it/s]replace nan value:  92%|█████████▏| 511/553 [00:02<00:00, 176.52it/s]replace nan value:  96%|█████████▌| 529/553 [00:03<00:00, 173.96it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 174.14it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 174.27it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 10/553 [00:00<00:05, 95.09it/s]  4%|▍         | 24/553 [00:00<00:04, 115.55it/s]  7%|▋         | 38/553 [00:00<00:04, 122.97it/s]  9%|▉         | 51/553 [00:00<00:04, 103.78it/s] 11%|█         | 62/553 [00:00<00:05, 97.70it/s]  13%|█▎        | 73/553 [00:00<00:04, 98.89it/s] 16%|█▌        | 86/553 [00:00<00:04, 106.75it/s] 18%|█▊        | 97/553 [00:00<00:04, 106.24it/s] 20%|█▉        | 110/553 [00:01<00:03, 112.23it/s] 22%|██▏       | 123/553 [00:01<00:03, 116.89it/s] 25%|██▍       | 136/553 [00:01<00:03, 120.01it/s] 27%|██▋       | 151/553 [00:01<00:03, 127.29it/s] 30%|███       | 166/553 [00:01<00:02, 133.15it/s] 33%|███▎      | 180/553 [00:01<00:02, 133.10it/s] 35%|███▌      | 194/553 [00:01<00:02, 132.84it/s] 38%|███▊      | 209/553 [00:01<00:02, 136.72it/s] 40%|████      | 223/553 [00:01<00:02, 131.10it/s] 43%|████▎     | 239/553 [00:01<00:02, 138.26it/s] 46%|████▌     | 253/553 [00:02<00:02, 137.42it/s] 48%|████▊     | 267/553 [00:02<00:02, 135.49it/s] 51%|█████     | 281/553 [00:02<00:02, 135.47it/s] 53%|█████▎    | 295/553 [00:02<00:01, 131.53it/s] 56%|█████▌    | 309/553 [00:02<00:01, 129.64it/s] 58%|█████▊    | 322/553 [00:02<00:01, 126.73it/s] 61%|██████    | 336/553 [00:02<00:01, 129.46it/s] 63%|██████▎   | 349/553 [00:02<00:01, 126.01it/s] 65%|██████▌   | 362/553 [00:02<00:01, 124.41it/s] 68%|██████▊   | 377/553 [00:03<00:01, 131.04it/s] 71%|███████   | 391/553 [00:03<00:01, 121.56it/s] 73%|███████▎  | 405/553 [00:03<00:01, 123.53it/s] 76%|███████▌  | 418/553 [00:03<00:01, 121.84it/s] 78%|███████▊  | 431/553 [00:03<00:01, 119.51it/s] 81%|████████  | 449/553 [00:03<00:00, 136.06it/s] 84%|████████▍ | 464/553 [00:03<00:00, 136.70it/s] 86%|████████▋ | 478/553 [00:03<00:00, 133.71it/s] 89%|████████▉ | 492/553 [00:03<00:00, 127.63it/s] 91%|█████████▏| 505/553 [00:04<00:00, 124.81it/s] 94%|█████████▍| 520/553 [00:04<00:00, 130.04it/s] 97%|█████████▋| 534/553 [00:04<00:00, 113.47it/s] 99%|█████████▉| 550/553 [00:04<00:00, 123.58it/s]100%|██████████| 553/553 [00:04<00:00, 122.45it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 38/139 [00:00<00:00, 375.39it/s]extract the null data:  79%|███████▉  | 110/139 [00:00<00:00, 572.88it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 567.94it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 205.24it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 196.95it/s]replace nan value:  45%|████▍     | 62/139 [00:00<00:00, 196.53it/s]replace nan value:  59%|█████▉    | 82/139 [00:00<00:00, 196.34it/s]replace nan value:  73%|███████▎  | 102/139 [00:00<00:00, 192.58it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 195.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.00it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.68it/s] 18%|█▊        | 25/139 [00:00<00:00, 120.37it/s] 28%|██▊       | 39/139 [00:00<00:00, 127.94it/s] 37%|███▋      | 52/139 [00:00<00:00, 121.66it/s] 48%|████▊     | 67/139 [00:00<00:00, 125.79it/s] 58%|█████▊    | 80/139 [00:00<00:00, 125.75it/s] 67%|██████▋   | 93/139 [00:00<00:00, 116.43it/s] 76%|███████▋  | 106/139 [00:00<00:00, 119.35it/s] 87%|████████▋ | 121/139 [00:00<00:00, 127.82it/s] 96%|█████████▋| 134/139 [00:01<00:00, 120.72it/s]100%|██████████| 139/139 [00:01<00:00, 123.14it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 20/173 [00:00<00:00, 199.63it/s]extract the null data:  43%|████▎     | 75/173 [00:00<00:00, 403.84it/s]extract the null data:  76%|███████▋  | 132/173 [00:00<00:00, 478.39it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 459.36it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 204.15it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 201.10it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 203.13it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 202.41it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 203.32it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 203.92it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 205.32it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 203.57it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 203.01it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 137.78it/s] 16%|█▌        | 28/173 [00:00<00:01, 124.15it/s] 26%|██▌       | 45/173 [00:00<00:00, 141.65it/s] 36%|███▌      | 62/173 [00:00<00:00, 149.85it/s] 45%|████▌     | 78/173 [00:00<00:00, 148.33it/s] 54%|█████▍    | 93/173 [00:00<00:00, 148.24it/s] 62%|██████▏   | 108/173 [00:00<00:00, 147.23it/s] 71%|███████   | 123/173 [00:00<00:00, 143.80it/s] 80%|███████▉  | 138/173 [00:00<00:00, 144.30it/s] 88%|████████▊ | 153/173 [00:01<00:00, 137.38it/s] 97%|█████████▋| 167/173 [00:01<00:00, 109.68it/s]100%|██████████| 173/173 [00:01<00:00, 128.21it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.041, valid loss : 0.034, train acc : 0.596, valid acc : 0.188, train f1 : 0.541, valid f1 : 0.188
training process:   1%|          | 1/128 [01:02<2:12:01, 62.37s/it]Best score increase :0.000 -> 0.188
training process:   2%|▏         | 2/128 [01:52<1:56:02, 55.25s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:40<1:48:27, 52.06s/it]Best score increase :0.188 -> 0.303
training process:   3%|▎         | 4/128 [03:30<1:45:44, 51.16s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.023, valid loss : 0.032, train acc : 0.654, valid acc : 0.359, train f1 : 0.611, valid f1 : 0.333
training process:   4%|▍         | 5/128 [04:30<1:51:03, 54.17s/it]Best score increase :0.303 -> 0.333
training process:   5%|▍         | 6/128 [05:15<1:43:45, 51.03s/it]Best score increase :0.333 -> 0.359
training process:   5%|▌         | 7/128 [06:00<1:39:03, 49.12s/it]Best score increase :0.359 -> 0.406
training process:   6%|▋         | 8/128 [06:45<1:35:53, 47.94s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.020, valid loss : 0.034, train acc : 0.726, valid acc : 0.460, train f1 : 0.706, valid f1 : 0.408
training process:   7%|▋         | 9/128 [07:46<1:42:45, 51.81s/it]Best score increase :0.406 -> 0.408
training process:   8%|▊         | 10/128 [08:31<1:38:09, 49.91s/it]Best score increase :0.408 -> 0.458
training process:   9%|▊         | 11/128 [09:17<1:34:37, 48.52s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:03<1:32:32, 47.87s/it]Best score increase :0.458 -> 0.463
epoch : 13, train loss : 0.017, valid loss : 0.031, train acc : 0.776, valid acc : 0.585, train f1 : 0.764, valid f1 : 0.493
training process:  10%|█         | 13/128 [10:59<1:36:19, 50.26s/it]Best score increase :0.463 -> 0.493
training process:  11%|█         | 14/128 [11:46<1:33:34, 49.25s/it]Best score increase :0.493 -> 0.501
training process:  12%|█▏        | 15/128 [12:35<1:32:45, 49.25s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [13:20<1:29:42, 48.06s/it]Best score increase :0.501 -> 0.519
epoch : 17, train loss : 0.015, valid loss : 0.031, train acc : 0.806, valid acc : 0.617, train f1 : 0.799, valid f1 : 0.516
training process:  13%|█▎        | 17/128 [14:19<1:34:44, 51.22s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:11<1:34:12, 51.38s/it]Best score increase :0.519 -> 0.535
training process:  15%|█▍        | 19/128 [16:06<1:35:43, 52.69s/it]Best score increase :0.535 -> 0.536
training process:  16%|█▌        | 20/128 [17:08<1:39:33, 55.31s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.014, valid loss : 0.032, train acc : 0.830, valid acc : 0.634, train f1 : 0.826, valid f1 : 0.528
training process:  16%|█▋        | 21/128 [18:27<1:51:17, 62.41s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [19:37<1:54:41, 64.92s/it]Best score increase :0.536 -> 0.576
training process:  18%|█▊        | 23/128 [20:52<1:58:33, 67.75s/it]Best score increase :0.576 -> 0.580
training process:  19%|█▉        | 24/128 [22:00<1:57:27, 67.76s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.013, valid loss : 0.024, train acc : 0.852, valid acc : 0.700, train f1 : 0.849, valid f1 : 0.577
training process:  20%|█▉        | 25/128 [23:22<2:03:49, 72.13s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [24:31<2:00:51, 71.09s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [25:39<1:58:34, 70.44s/it]Best score increase :0.580 -> 0.585
training process:  22%|██▏       | 28/128 [26:50<1:57:22, 70.42s/it]Best score increase :0.585 -> 0.594
epoch : 29, train loss : 0.011, valid loss : 0.027, train acc : 0.867, valid acc : 0.724, train f1 : 0.865, valid f1 : 0.595
training process:  23%|██▎       | 29/128 [28:03<1:57:44, 71.36s/it]Best score increase :0.594 -> 0.595
training process:  23%|██▎       | 30/128 [29:03<1:50:35, 67.71s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [30:01<1:44:51, 64.86s/it]Best score increase :0.595 -> 0.607
training process:  25%|██▌       | 32/128 [31:02<1:42:04, 63.80s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.011, valid loss : 0.024, train acc : 0.875, valid acc : 0.767, train f1 : 0.873, valid f1 : 0.630
training process:  26%|██▌       | 33/128 [32:12<1:44:00, 65.69s/it]Best score increase :0.607 -> 0.630
training process:  27%|██▋       | 34/128 [33:11<1:39:40, 63.62s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [34:11<1:37:05, 62.63s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [35:12<1:35:02, 61.98s/it]Best score increase :0.630 -> 0.633
epoch : 37, train loss : 0.011, valid loss : 0.022, train acc : 0.880, valid acc : 0.795, train f1 : 0.879, valid f1 : 0.656
training process:  29%|██▉       | 37/128 [36:19<1:36:35, 63.68s/it]Best score increase :0.633 -> 0.656
training process:  30%|██▉       | 38/128 [37:19<1:33:31, 62.35s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [38:17<1:30:35, 61.07s/it]Best score increase :0.656 -> 0.661
training process:  31%|███▏      | 40/128 [39:16<1:28:44, 60.51s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.025, train acc : 0.892, valid acc : 0.791, train f1 : 0.891, valid f1 : 0.652
training process:  32%|███▏      | 41/128 [40:24<1:30:59, 62.76s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [41:20<1:26:51, 60.60s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [42:14<1:23:06, 58.66s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [43:09<1:20:52, 57.77s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.010, valid loss : 0.026, train acc : 0.897, valid acc : 0.795, train f1 : 0.896, valid f1 : 0.654
training process:  35%|███▌      | 45/128 [44:11<1:21:30, 58.92s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 46/128 [45:08<1:19:54, 58.47s/it]EarlyStopping counter : 7 out of 12
training process:  37%|███▋      | 47/128 [46:06<1:18:37, 58.24s/it]EarlyStopping counter : 8 out of 12
training process:  38%|███▊      | 48/128 [47:09<1:19:30, 59.64s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.009, valid loss : 0.026, train acc : 0.902, valid acc : 0.769, train f1 : 0.901, valid f1 : 0.632
training process:  38%|███▊      | 49/128 [48:29<1:26:34, 65.75s/it]EarlyStopping counter : 10 out of 12
training process:  39%|███▉      | 50/128 [49:31<1:24:04, 64.67s/it]Best score increase :0.661 -> 0.672
training process:  40%|███▉      | 51/128 [50:35<1:22:40, 64.42s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [51:38<1:21:11, 64.10s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.009, valid loss : 0.025, train acc : 0.900, valid acc : 0.805, train f1 : 0.900, valid f1 : 0.663
training process:  41%|████▏     | 53/128 [52:56<1:25:01, 68.02s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [53:58<1:21:56, 66.44s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [55:04<1:20:42, 66.34s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [56:05<1:17:40, 64.72s/it]Best score increase :0.672 -> 0.684
epoch : 57, train loss : 0.009, valid loss : 0.025, train acc : 0.906, valid acc : 0.801, train f1 : 0.905, valid f1 : 0.659
training process:  45%|████▍     | 57/128 [57:08<1:15:51, 64.11s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [58:00<1:10:36, 60.53s/it]Best score increase :0.684 -> 0.692
training process:  46%|████▌     | 59/128 [58:55<1:07:35, 58.77s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [59:48<1:04:33, 56.96s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.009, valid loss : 0.025, train acc : 0.913, valid acc : 0.811, train f1 : 0.912, valid f1 : 0.668
training process:  48%|████▊     | 61/128 [1:00:50<1:05:30, 58.67s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [1:01:42<1:02:12, 56.55s/it]EarlyStopping counter : 4 out of 12
training process:  49%|████▉     | 63/128 [1:02:36<1:00:24, 55.76s/it]EarlyStopping counter : 5 out of 12
training process:  50%|█████     | 64/128 [1:03:31<59:21, 55.65s/it]  EarlyStopping counter : 6 out of 12
epoch : 65, train loss : 0.008, valid loss : 0.027, train acc : 0.920, valid acc : 0.792, train f1 : 0.920, valid f1 : 0.652
training process:  51%|█████     | 65/128 [1:04:36<1:01:14, 58.33s/it]EarlyStopping counter : 7 out of 12
training process:  52%|█████▏    | 66/128 [1:05:31<59:10, 57.26s/it]  EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 67/128 [1:06:26<57:49, 56.87s/it]EarlyStopping counter : 9 out of 12
training process:  53%|█████▎    | 68/128 [1:07:21<56:09, 56.16s/it]Best score increase :0.692 -> 0.694
epoch : 69, train loss : 0.008, valid loss : 0.025, train acc : 0.916, valid acc : 0.827, train f1 : 0.916, valid f1 : 0.685
training process:  54%|█████▍    | 69/128 [1:08:26<57:50, 58.82s/it]EarlyStopping counter : 1 out of 12
training process:  55%|█████▍    | 70/128 [1:09:22<55:58, 57.91s/it]EarlyStopping counter : 2 out of 12
training process:  55%|█████▌    | 71/128 [1:10:17<54:20, 57.21s/it]EarlyStopping counter : 3 out of 12
training process:  56%|█████▋    | 72/128 [1:11:07<51:14, 54.90s/it]EarlyStopping counter : 4 out of 12
epoch : 73, train loss : 0.008, valid loss : 0.025, train acc : 0.917, valid acc : 0.811, train f1 : 0.916, valid f1 : 0.670
training process:  57%|█████▋    | 73/128 [1:12:04<50:56, 55.58s/it]EarlyStopping counter : 5 out of 12
training process:  58%|█████▊    | 74/128 [1:13:01<50:28, 56.08s/it]Best score increase :0.694 -> 0.708
training process:  59%|█████▊    | 75/128 [1:13:58<49:49, 56.40s/it]EarlyStopping counter : 1 out of 12
training process:  59%|█████▉    | 76/128 [1:14:55<49:02, 56.59s/it]EarlyStopping counter : 2 out of 12
epoch : 77, train loss : 0.008, valid loss : 0.025, train acc : 0.916, valid acc : 0.826, train f1 : 0.916, valid f1 : 0.685
training process:  60%|██████    | 77/128 [1:16:02<50:38, 59.59s/it]EarlyStopping counter : 3 out of 12
training process:  61%|██████    | 78/128 [1:17:00<49:16, 59.13s/it]EarlyStopping counter : 4 out of 12
training process:  62%|██████▏   | 79/128 [1:17:51<46:15, 56.65s/it]EarlyStopping counter : 5 out of 12
training process:  62%|██████▎   | 80/128 [1:18:41<43:37, 54.53s/it]Best score increase :0.708 -> 0.709
epoch : 81, train loss : 0.007, valid loss : 0.024, train acc : 0.921, valid acc : 0.819, train f1 : 0.921, valid f1 : 0.677
training process:  63%|██████▎   | 81/128 [1:19:38<43:24, 55.40s/it]EarlyStopping counter : 1 out of 12
training process:  64%|██████▍   | 82/128 [1:20:36<43:07, 56.25s/it]EarlyStopping counter : 2 out of 12
training process:  65%|██████▍   | 83/128 [1:21:34<42:38, 56.85s/it]EarlyStopping counter : 3 out of 12
training process:  66%|██████▌   | 84/128 [1:22:32<41:43, 56.90s/it]EarlyStopping counter : 4 out of 12
epoch : 85, train loss : 0.008, valid loss : 0.030, train acc : 0.921, valid acc : 0.814, train f1 : 0.921, valid f1 : 0.672
training process:  66%|██████▋   | 85/128 [1:23:38<42:48, 59.73s/it]EarlyStopping counter : 5 out of 12
training process:  67%|██████▋   | 86/128 [1:24:36<41:26, 59.19s/it]EarlyStopping counter : 6 out of 12
training process:  68%|██████▊   | 87/128 [1:25:27<38:47, 56.77s/it]Best score increase :0.709 -> 0.734
training process:  69%|██████▉   | 88/128 [1:26:16<36:19, 54.50s/it]EarlyStopping counter : 1 out of 12
epoch : 89, train loss : 0.007, valid loss : 0.029, train acc : 0.924, valid acc : 0.823, train f1 : 0.923, valid f1 : 0.680
training process:  70%|██████▉   | 89/128 [1:27:17<36:36, 56.32s/it]EarlyStopping counter : 2 out of 12
training process:  70%|███████   | 90/128 [1:28:14<35:57, 56.76s/it]EarlyStopping counter : 3 out of 12
training process:  71%|███████   | 91/128 [1:29:12<35:04, 56.88s/it]EarlyStopping counter : 4 out of 12
training process:  72%|███████▏  | 92/128 [1:30:09<34:18, 57.17s/it]EarlyStopping counter : 5 out of 12
epoch : 93, train loss : 0.008, valid loss : 0.029, train acc : 0.926, valid acc : 0.817, train f1 : 0.925, valid f1 : 0.675
training process:  73%|███████▎  | 93/128 [1:31:15<34:51, 59.76s/it]EarlyStopping counter : 6 out of 12
training process:  73%|███████▎  | 94/128 [1:32:13<33:34, 59.26s/it]EarlyStopping counter : 7 out of 12
training process:  74%|███████▍  | 95/128 [1:33:01<30:40, 55.77s/it]EarlyStopping counter : 8 out of 12
training process:  75%|███████▌  | 96/128 [1:33:48<28:21, 53.18s/it]EarlyStopping counter : 9 out of 12
epoch : 97, train loss : 0.008, valid loss : 0.025, train acc : 0.925, valid acc : 0.841, train f1 : 0.925, valid f1 : 0.699
training process:  76%|███████▌  | 97/128 [1:34:42<27:38, 53.50s/it]EarlyStopping counter : 10 out of 12
training process:  77%|███████▋  | 98/128 [1:35:40<27:26, 54.88s/it]EarlyStopping counter : 11 out of 12
training process:  77%|███████▋  | 98/128 [1:36:38<29:34, 59.17s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 98, best f1 score : 0.734
training process finished, best loss : 0.028 and best acc : 0.872, best f1 : 0.734, best epoch : 86

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.44      0.87      0.59       580
           1       0.99      0.91      0.95      6818

    accuracy                           0.90      7398
   macro avg       0.71      0.89      0.77      7398
weighted avg       0.95      0.90      0.92      7398


# test acc : 0.90, test f1 : 0.77, test AUC : 0.89, test loss : 1.162

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.95s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:15,  7.52s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.70s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.64s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.73s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.58s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:37,  7.57s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.68s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.73s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.68s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.67s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.66s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.66s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 135.96it/s]  9%|▉         | 28/306 [00:00<00:02, 107.85it/s] 13%|█▎        | 40/306 [00:00<00:02, 112.52it/s] 17%|█▋        | 53/306 [00:00<00:02, 114.34it/s] 22%|██▏       | 66/306 [00:00<00:02, 118.62it/s] 26%|██▌       | 80/306 [00:00<00:01, 124.82it/s] 30%|███       | 93/306 [00:00<00:01, 109.74it/s] 35%|███▍      | 107/306 [00:00<00:01, 116.69it/s] 39%|███▉      | 120/306 [00:01<00:01, 119.50it/s] 43%|████▎     | 133/306 [00:01<00:01, 113.96it/s] 48%|████▊     | 146/306 [00:01<00:01, 117.40it/s] 52%|█████▏    | 158/306 [00:01<00:01, 107.36it/s] 57%|█████▋    | 173/306 [00:01<00:01, 118.63it/s] 61%|██████    | 186/306 [00:01<00:01, 117.78it/s] 65%|██████▌   | 199/306 [00:01<00:00, 111.58it/s] 69%|██████▉   | 211/306 [00:01<00:00, 113.64it/s] 73%|███████▎  | 223/306 [00:01<00:00, 113.15it/s] 77%|███████▋  | 236/306 [00:02<00:00, 116.52it/s] 81%|████████▏ | 249/306 [00:02<00:00, 119.40it/s] 86%|████████▌ | 262/306 [00:02<00:00, 107.74it/s] 91%|█████████ | 277/306 [00:02<00:00, 117.89it/s] 95%|█████████▌| 291/306 [00:02<00:00, 120.50it/s] 99%|█████████▉| 304/306 [00:02<00:00, 115.63it/s]100%|██████████| 306/306 [00:02<00:00, 115.90it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:00, 508.23it/s]extract the null data:  20%|██        | 111/553 [00:00<00:00, 557.02it/s]extract the null data:  30%|███       | 167/553 [00:00<00:00, 521.32it/s]extract the null data:  40%|███▉      | 220/553 [00:00<00:00, 523.05it/s]extract the null data:  50%|█████     | 278/553 [00:00<00:00, 539.94it/s]extract the null data:  60%|██████    | 333/553 [00:00<00:00, 536.02it/s]extract the null data:  71%|███████   | 390/553 [00:00<00:00, 545.63it/s]extract the null data:  81%|████████  | 447/553 [00:00<00:00, 552.62it/s]extract the null data:  91%|█████████ | 503/553 [00:00<00:00, 540.20it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 542.30it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 177.23it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 174.79it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 179.23it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 178.57it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 177.78it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 182.30it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 180.56it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:02, 179.91it/s]replace nan value:  31%|███       | 169/553 [00:00<00:02, 184.92it/s]replace nan value:  34%|███▍      | 188/553 [00:01<00:01, 182.56it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 182.74it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 182.11it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 177.01it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 180.47it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 179.38it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 178.47it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 179.60it/s]replace nan value:  61%|██████    | 338/553 [00:01<00:01, 178.87it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:01, 181.52it/s]replace nan value:  68%|██████▊   | 377/553 [00:02<00:00, 186.87it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 186.96it/s]replace nan value:  75%|███████▌  | 416/553 [00:02<00:00, 188.02it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 187.53it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 186.26it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 188.80it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 187.26it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 186.21it/s]replace nan value:  96%|█████████▌| 532/553 [00:02<00:00, 187.97it/s]replace nan value: 100%|█████████▉| 551/553 [00:03<00:00, 183.53it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 182.69it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.63it/s]  5%|▍         | 27/553 [00:00<00:03, 135.64it/s]  7%|▋         | 41/553 [00:00<00:03, 134.08it/s] 10%|▉         | 55/553 [00:00<00:03, 125.38it/s] 12%|█▏        | 68/553 [00:00<00:04, 113.27it/s] 15%|█▌        | 84/553 [00:00<00:03, 124.83it/s] 18%|█▊        | 97/553 [00:00<00:03, 126.29it/s] 20%|██        | 112/553 [00:00<00:03, 131.31it/s] 23%|██▎       | 126/553 [00:00<00:03, 127.41it/s] 26%|██▌       | 144/553 [00:01<00:02, 140.09it/s] 29%|██▉       | 162/553 [00:01<00:02, 148.38it/s] 32%|███▏      | 179/553 [00:01<00:02, 152.96it/s] 35%|███▌      | 195/553 [00:01<00:02, 152.53it/s] 38%|███▊      | 212/553 [00:01<00:02, 157.21it/s] 41%|████      | 228/553 [00:01<00:02, 148.48it/s] 44%|████▍     | 243/553 [00:01<00:02, 145.27it/s] 47%|████▋     | 258/553 [00:01<00:02, 144.18it/s] 49%|████▉     | 273/553 [00:01<00:02, 139.43it/s] 52%|█████▏    | 289/553 [00:02<00:01, 143.84it/s] 55%|█████▍    | 304/553 [00:02<00:01, 136.30it/s] 58%|█████▊    | 318/553 [00:02<00:01, 127.60it/s] 60%|██████    | 332/553 [00:02<00:01, 130.14it/s] 63%|██████▎   | 346/553 [00:02<00:01, 131.73it/s] 65%|██████▌   | 360/553 [00:02<00:01, 123.31it/s] 68%|██████▊   | 376/553 [00:02<00:01, 131.67it/s] 71%|███████   | 390/553 [00:02<00:01, 119.22it/s] 73%|███████▎  | 403/553 [00:03<00:01, 120.65it/s] 75%|███████▌  | 416/553 [00:03<00:01, 120.44it/s] 78%|███████▊  | 429/553 [00:03<00:01, 114.78it/s] 81%|████████  | 447/553 [00:03<00:00, 131.59it/s] 84%|████████▎ | 462/553 [00:03<00:00, 134.83it/s] 86%|████████▋ | 477/553 [00:03<00:00, 137.96it/s] 89%|████████▉ | 491/553 [00:03<00:00, 127.83it/s] 91%|█████████▏| 505/553 [00:03<00:00, 125.34it/s] 94%|█████████▍| 520/553 [00:03<00:00, 131.50it/s] 97%|█████████▋| 534/553 [00:04<00:00, 114.34it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.53it/s]100%|██████████| 553/553 [00:04<00:00, 129.67it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 336.80it/s]extract the null data:  74%|███████▍  | 103/139 [00:00<00:00, 541.83it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 536.31it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 209.52it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 216.53it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 210.41it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 208.08it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 207.85it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 202.17it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 205.35it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 119.24it/s] 18%|█▊        | 25/139 [00:00<00:00, 124.60it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.43it/s] 39%|███▉      | 54/139 [00:00<00:00, 128.07it/s] 48%|████▊     | 67/139 [00:00<00:00, 126.66it/s] 58%|█████▊    | 81/139 [00:00<00:00, 129.82it/s] 68%|██████▊   | 94/139 [00:00<00:00, 121.54it/s] 78%|███████▊  | 108/139 [00:00<00:00, 126.03it/s] 91%|█████████ | 126/139 [00:00<00:00, 138.46it/s]100%|██████████| 139/139 [00:01<00:00, 132.14it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 33/173 [00:00<00:00, 325.64it/s]extract the null data:  60%|█████▉    | 103/173 [00:00<00:00, 544.29it/s]extract the null data:  95%|█████████▍| 164/173 [00:00<00:00, 569.50it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 541.64it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 203.06it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 205.75it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 204.65it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 207.59it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 213.82it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 213.67it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 221.59it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 216.54it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.84it/s] 16%|█▌        | 28/173 [00:00<00:01, 126.02it/s] 25%|██▌       | 44/173 [00:00<00:00, 136.92it/s] 34%|███▍      | 59/173 [00:00<00:00, 141.56it/s] 43%|████▎     | 74/173 [00:00<00:00, 141.67it/s] 51%|█████▏    | 89/173 [00:00<00:00, 138.54it/s] 60%|█████▉    | 103/173 [00:00<00:00, 138.06it/s] 68%|██████▊   | 118/173 [00:00<00:00, 141.43it/s] 77%|███████▋  | 133/173 [00:00<00:00, 133.27it/s] 86%|████████▌ | 148/173 [00:01<00:00, 134.60it/s] 94%|█████████▎| 162/173 [00:01<00:00, 122.00it/s]100%|██████████| 173/173 [00:01<00:00, 122.10it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.110, valid loss : 0.072, train f1 : 0.542, valid f1 : 0.593
training process - Deferred Re-weighting:   1%|          | 1/128 [01:08<2:24:35, 68.31s/it]Best score increase :0.000 -> 0.593
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:05<2:10:06, 61.96s/it]Best score increase :0.593 -> 0.643
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:03<2:05:04, 60.03s/it]Best score increase :0.643 -> 0.663
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:00<2:01:26, 58.76s/it]Best score increase :0.663 -> 0.688
epoch : 5, train loss : 0.049, valid loss : 0.055, train f1 : 0.715, valid f1 : 0.686
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:01<2:02:32, 59.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:53<1:56:05, 57.09s/it]Best score increase :0.688 -> 0.728
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:46<1:52:11, 55.63s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:44<1:52:46, 56.38s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.044, valid loss : 0.054, train f1 : 0.751, valid f1 : 0.729
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:50<1:58:03, 59.53s/it]Best score increase :0.728 -> 0.729
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:49<1:56:17, 59.13s/it]Best score increase :0.729 -> 0.745
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:47<1:55:06, 59.03s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:46<1:53:48, 58.86s/it]Best score increase :0.745 -> 0.760
epoch : 13, train loss : 0.040, valid loss : 0.051, train f1 : 0.781, valid f1 : 0.752
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:50<1:55:34, 60.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:46<1:52:18, 59.11s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:39<1:47:46, 57.23s/it]Best score increase :0.760 -> 0.771
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:37<1:47:31, 57.61s/it]Best score increase :0.771 -> 0.778
epoch : 17, train loss : 0.036, valid loss : 0.051, train f1 : 0.808, valid f1 : 0.783
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [16:45<1:52:10, 60.64s/it]Best score increase :0.778 -> 0.783
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [17:43<1:49:58, 59.99s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [18:42<1:48:13, 59.57s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [19:41<1:46:51, 59.37s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.033, valid loss : 0.049, train f1 : 0.819, valid f1 : 0.797
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [20:42<1:46:32, 59.74s/it]Best score increase :0.783 -> 0.797
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [21:35<1:42:08, 57.82s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [22:29<1:39:01, 56.58s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [23:27<1:39:00, 57.12s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.032, valid loss : 0.050, train f1 : 0.835, valid f1 : 0.803
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [24:34<1:43:15, 60.15s/it]Best score increase :0.797 -> 0.803
training process - Deferred Re-weighting:  20%|██        | 26/128 [25:32<1:41:06, 59.47s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [26:30<1:39:06, 58.88s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [27:28<1:37:46, 58.66s/it]Best score increase :0.803 -> 0.810
epoch : 29, train loss : 0.029, valid loss : 0.053, train f1 : 0.854, valid f1 : 0.790
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [28:30<1:38:22, 59.62s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [29:20<1:32:54, 56.88s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [30:13<1:30:09, 55.77s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [31:11<1:30:24, 56.50s/it]Best score increase :0.810 -> 0.813
epoch : 33, train loss : 0.027, valid loss : 0.046, train f1 : 0.858, valid f1 : 0.802
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [32:18<1:34:23, 59.61s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [33:16<1:32:40, 59.16s/it]Best score increase :0.813 -> 0.823
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [34:15<1:31:32, 59.06s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [35:14<1:30:15, 58.86s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.026, valid loss : 0.050, train f1 : 0.872, valid f1 : 0.814
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [36:15<1:30:20, 59.57s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [37:06<1:25:36, 57.07s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [38:01<1:23:49, 56.51s/it]Best score increase :0.823 -> 0.826
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [39:00<1:23:52, 57.18s/it]Best score increase :0.826 -> 0.832
epoch : 41, train loss : 0.025, valid loss : 0.047, train f1 : 0.874, valid f1 : 0.822
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [40:07<1:27:06, 60.07s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [41:06<1:25:32, 59.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [42:04<1:23:54, 59.23s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [43:02<1:22:33, 58.97s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.023, valid loss : 0.052, train f1 : 0.885, valid f1 : 0.832
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [44:05<1:23:17, 60.21s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [44:59<1:19:26, 58.13s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [45:55<1:17:42, 57.56s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:53<1:17:00, 57.76s/it]Best score increase :0.832 -> 0.835
epoch : 49, train loss : 0.022, valid loss : 0.054, train f1 : 0.894, valid f1 : 0.831
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [48:00<1:19:51, 60.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [48:58<1:17:44, 59.80s/it]Best score increase :0.835 -> 0.846
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [49:56<1:16:00, 59.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [50:53<1:13:57, 58.38s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.021, valid loss : 0.054, train f1 : 0.899, valid f1 : 0.843
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [51:52<1:13:32, 58.84s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [52:45<1:10:19, 57.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [53:43<1:09:34, 57.18s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [54:40<1:08:46, 57.31s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.020, valid loss : 0.057, train f1 : 0.905, valid f1 : 0.840
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [55:46<1:10:54, 59.92s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [56:44<1:09:01, 59.16s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [57:41<1:07:24, 58.61s/it]Best score increase :0.846 -> 0.848
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [58:37<1:05:34, 57.86s/it]Best score increase :0.848 -> 0.851
epoch : 61, train loss : 0.020, valid loss : 0.056, train f1 : 0.907, valid f1 : 0.850
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [59:38<1:05:45, 58.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:00:35<1:03:58, 58.16s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:01:34<1:03:26, 58.56s/it]Best score increase :0.851 -> 0.853
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:02:33<1:02:36, 58.70s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.019, valid loss : 0.062, train f1 : 0.912, valid f1 : 0.832
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:03:43<1:04:58, 61.88s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:04:41<1:02:43, 60.70s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:05:39<1:00:53, 59.89s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:06:36<59:03, 59.06s/it]  EarlyStopping counter : 5 out of 12
epoch : 69, train loss : 0.018, valid loss : 0.060, train f1 : 0.913, valid f1 : 0.846
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:07:38<58:55, 59.93s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:08:31<56:05, 58.03s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:09:30<55:09, 58.07s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:10:28<54:13, 58.10s/it]EarlyStopping counter : 9 out of 12
epoch : 73, train loss : 0.018, valid loss : 0.061, train f1 : 0.913, valid f1 : 0.843
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:11:36<56:00, 61.10s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:12:34<54:09, 60.17s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:13:32<53:40, 59.63s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 74, best f1 score : 0.853
training process finished, best loss : 0.057, best acc : 0.959, best f1 : 0.853, best epoch : 62

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.89      0.64      0.74       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.93      0.81      0.86      7398
weighted avg       0.96      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.81, test loss : 3.379

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.10s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.94s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.00s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.01s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.87s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.87s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.89s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.83s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.85s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.80s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.91s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.90s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.90s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 79.26it/s]  7%|▋         | 22/306 [00:00<00:02, 112.68it/s] 11%|█▏        | 35/306 [00:00<00:02, 116.63it/s] 15%|█▌        | 47/306 [00:00<00:02, 107.40it/s] 20%|█▉        | 60/306 [00:00<00:02, 113.16it/s] 24%|██▎       | 72/306 [00:00<00:02, 113.91it/s] 27%|██▋       | 84/306 [00:00<00:01, 113.87it/s] 32%|███▏      | 97/306 [00:00<00:01, 117.39it/s] 36%|███▌      | 109/306 [00:00<00:01, 106.43it/s] 41%|████      | 124/306 [00:01<00:01, 117.82it/s] 45%|████▌     | 138/306 [00:01<00:01, 123.06it/s] 49%|████▉     | 151/306 [00:01<00:01, 112.98it/s] 54%|█████▎    | 164/306 [00:01<00:01, 116.40it/s] 58%|█████▊    | 176/306 [00:01<00:01, 115.60it/s] 62%|██████▏   | 189/306 [00:01<00:00, 118.51it/s] 66%|██████▌   | 202/306 [00:01<00:00, 121.31it/s] 70%|███████   | 215/306 [00:01<00:00, 111.45it/s] 75%|███████▌  | 230/306 [00:01<00:00, 118.85it/s] 79%|███████▉  | 243/306 [00:02<00:00, 118.23it/s] 83%|████████▎ | 255/306 [00:02<00:00, 112.44it/s] 88%|████████▊ | 268/306 [00:02<00:00, 116.23it/s] 92%|█████████▏| 280/306 [00:02<00:00, 115.41it/s] 95%|█████████▌| 292/306 [00:02<00:00, 116.29it/s]100%|█████████▉| 305/306 [00:02<00:00, 119.95it/s]100%|██████████| 306/306 [00:02<00:00, 115.61it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 55/553 [00:00<00:00, 539.50it/s]extract the null data:  20%|█▉        | 109/553 [00:00<00:00, 458.66it/s]extract the null data:  28%|██▊       | 156/553 [00:00<00:00, 456.74it/s]extract the null data:  37%|███▋      | 203/553 [00:00<00:00, 461.25it/s]extract the null data:  45%|████▌     | 250/553 [00:00<00:00, 450.90it/s]extract the null data:  54%|█████▎    | 296/553 [00:00<00:00, 442.66it/s]extract the null data:  62%|██████▏   | 343/553 [00:00<00:00, 449.02it/s]extract the null data:  70%|███████   | 389/553 [00:00<00:00, 446.67it/s]extract the null data:  78%|███████▊  | 434/553 [00:00<00:00, 446.95it/s]extract the null data:  87%|████████▋ | 479/553 [00:01<00:00, 445.55it/s]extract the null data:  95%|█████████▍| 524/553 [00:01<00:00, 445.52it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 451.46it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 169.65it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 168.07it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 175.20it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 173.57it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 171.86it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 173.10it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 173.44it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 173.70it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 174.94it/s]replace nan value:  32%|███▏      | 179/553 [00:01<00:02, 173.40it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 172.47it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 173.66it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 172.08it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 172.75it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 173.07it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 176.91it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 178.34it/s]replace nan value:  59%|█████▉    | 325/553 [00:01<00:01, 169.43it/s]replace nan value:  62%|██████▏   | 343/553 [00:02<00:01, 162.72it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 162.83it/s]replace nan value:  68%|██████▊   | 377/553 [00:02<00:01, 162.69it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:01, 157.93it/s]replace nan value:  75%|███████▍  | 412/553 [00:02<00:00, 161.80it/s]replace nan value:  78%|███████▊  | 429/553 [00:02<00:00, 162.65it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 165.15it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 169.83it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 170.57it/s]replace nan value:  91%|█████████ | 502/553 [00:02<00:00, 171.14it/s]replace nan value:  94%|█████████▍| 520/553 [00:03<00:00, 165.52it/s]replace nan value:  97%|█████████▋| 537/553 [00:03<00:00, 166.47it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 169.27it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.73it/s]  5%|▌         | 28/553 [00:00<00:03, 135.17it/s]  8%|▊         | 42/553 [00:00<00:03, 129.30it/s] 10%|▉         | 55/553 [00:00<00:04, 123.92it/s] 12%|█▏        | 68/553 [00:00<00:04, 111.54it/s] 15%|█▍        | 82/553 [00:00<00:03, 118.77it/s] 17%|█▋        | 96/553 [00:00<00:03, 123.75it/s] 20%|█▉        | 109/553 [00:00<00:03, 124.61it/s] 22%|██▏       | 124/553 [00:00<00:03, 129.33it/s] 25%|██▌       | 140/553 [00:01<00:03, 135.80it/s] 28%|██▊       | 157/553 [00:01<00:02, 145.37it/s] 31%|███▏      | 173/553 [00:01<00:02, 148.09it/s] 34%|███▍      | 188/553 [00:01<00:02, 142.75it/s] 37%|███▋      | 206/553 [00:01<00:02, 150.89it/s] 40%|████      | 222/553 [00:01<00:02, 141.33it/s] 43%|████▎     | 237/553 [00:01<00:02, 142.78it/s] 46%|████▌     | 252/553 [00:01<00:02, 139.09it/s] 48%|████▊     | 267/553 [00:01<00:02, 136.30it/s] 51%|█████     | 281/553 [00:02<00:02, 134.87it/s] 53%|█████▎    | 295/553 [00:02<00:01, 131.63it/s] 56%|█████▌    | 309/553 [00:02<00:01, 128.16it/s] 58%|█████▊    | 322/553 [00:02<00:01, 124.56it/s] 61%|██████    | 336/553 [00:02<00:01, 126.92it/s] 63%|██████▎   | 349/553 [00:02<00:01, 124.99it/s] 65%|██████▌   | 362/553 [00:02<00:01, 120.25it/s] 68%|██████▊   | 377/553 [00:02<00:01, 126.33it/s] 71%|███████   | 390/553 [00:03<00:01, 115.84it/s] 73%|███████▎  | 402/553 [00:03<00:01, 115.03it/s] 75%|███████▌  | 416/553 [00:03<00:01, 116.31it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.15it/s] 80%|████████  | 444/553 [00:03<00:00, 123.62it/s] 83%|████████▎ | 459/553 [00:03<00:00, 130.22it/s] 86%|████████▌ | 474/553 [00:03<00:00, 133.17it/s] 88%|████████▊ | 488/553 [00:03<00:00, 127.86it/s] 91%|█████████ | 501/553 [00:03<00:00, 120.87it/s] 93%|█████████▎| 516/553 [00:04<00:00, 127.97it/s] 96%|█████████▌| 529/553 [00:04<00:00, 113.70it/s] 98%|█████████▊| 541/553 [00:04<00:00, 115.10it/s]100%|██████████| 553/553 [00:04<00:00, 100.40it/s]100%|██████████| 553/553 [00:04<00:00, 125.35it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 328.82it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 449.24it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 464.52it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 220.85it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 200.98it/s]replace nan value:  48%|████▊     | 67/139 [00:00<00:00, 198.19it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 195.25it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 192.22it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 192.67it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 195.18it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.33it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.60it/s] 29%|██▉       | 40/139 [00:00<00:00, 132.88it/s] 39%|███▉      | 54/139 [00:00<00:00, 124.50it/s] 48%|████▊     | 67/139 [00:00<00:00, 123.99it/s] 58%|█████▊    | 80/139 [00:00<00:00, 120.35it/s] 67%|██████▋   | 93/139 [00:00<00:00, 110.16it/s] 76%|███████▌  | 105/139 [00:00<00:00, 112.68it/s] 86%|████████▌ | 119/139 [00:00<00:00, 119.31it/s] 95%|█████████▍| 132/139 [00:01<00:00, 115.91it/s]100%|██████████| 139/139 [00:01<00:00, 120.13it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 267.81it/s]extract the null data:  47%|████▋     | 82/173 [00:00<00:00, 428.89it/s]extract the null data:  77%|███████▋  | 134/173 [00:00<00:00, 469.15it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 455.29it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 192.38it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 178.94it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 181.81it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 185.10it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 186.16it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 189.40it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 191.90it/s]replace nan value:  91%|█████████▏| 158/173 [00:00<00:00, 190.38it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 187.60it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.39it/s] 16%|█▌        | 28/173 [00:00<00:01, 117.86it/s] 25%|██▍       | 43/173 [00:00<00:01, 128.54it/s] 34%|███▎      | 58/173 [00:00<00:00, 133.91it/s] 42%|████▏     | 72/173 [00:00<00:00, 131.68it/s] 50%|████▉     | 86/173 [00:00<00:00, 129.33it/s] 57%|█████▋    | 99/173 [00:00<00:00, 127.30it/s] 66%|██████▋   | 115/173 [00:00<00:00, 135.18it/s] 75%|███████▍  | 129/173 [00:01<00:00, 127.48it/s] 82%|████████▏ | 142/173 [00:01<00:00, 128.08it/s] 90%|████████▉ | 155/173 [00:01<00:00, 118.51it/s] 97%|█████████▋| 168/173 [00:01<00:00, 96.44it/s] 100%|██████████| 173/173 [00:01<00:00, 114.45it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.124, train f1 : 0.708, valid f1 : 0.624
training process - Deferred Re-weighting:   1%|          | 1/128 [01:10<2:30:01, 70.88s/it]Best score increase :0.000 -> 0.624
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:10<2:14:28, 64.04s/it]Best score increase :0.624 -> 0.638
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:09<2:08:31, 61.70s/it]Best score increase :0.638 -> 0.679
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:05<2:03:25, 59.72s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.100, valid loss : 0.102, train f1 : 0.823, valid f1 : 0.692
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:11<2:06:39, 61.78s/it]Best score increase :0.679 -> 0.692
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:07<2:01:53, 59.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:05<1:59:45, 59.38s/it]Best score increase :0.692 -> 0.695
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:04<1:58:18, 59.15s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.085, valid loss : 0.110, train f1 : 0.858, valid f1 : 0.687
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:12<2:02:38, 61.83s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:09<1:59:03, 60.54s/it]Best score increase :0.695 -> 0.712
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:06<1:56:02, 59.51s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:59<1:51:08, 57.49s/it]Best score increase :0.712 -> 0.717
epoch : 13, train loss : 0.072, valid loss : 0.088, train f1 : 0.882, valid f1 : 0.739
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:55<1:49:18, 57.03s/it]Best score increase :0.717 -> 0.739
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:42<1:42:40, 54.04s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:40<1:44:00, 55.22s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:38<1:44:16, 55.86s/it]Best score increase :0.739 -> 0.747
epoch : 17, train loss : 0.065, valid loss : 0.086, train f1 : 0.897, valid f1 : 0.740
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [16:43<1:48:34, 58.69s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [17:40<1:46:48, 58.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [18:37<1:45:12, 57.91s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [19:26<1:39:07, 55.07s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.056, valid loss : 0.089, train f1 : 0.911, valid f1 : 0.730
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [20:21<1:38:03, 54.99s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [21:15<1:36:36, 54.69s/it]Best score increase :0.747 -> 0.772
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [22:13<1:37:28, 55.70s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [23:11<1:37:44, 56.39s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.052, valid loss : 0.075, train f1 : 0.923, valid f1 : 0.750
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [24:18<1:42:21, 59.63s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [25:17<1:40:54, 59.36s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [26:15<1:39:21, 59.02s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [27:10<1:36:14, 57.74s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.047, valid loss : 0.074, train f1 : 0.930, valid f1 : 0.768
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [28:14<1:38:34, 59.74s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [29:08<1:34:46, 58.03s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [30:06<1:33:55, 58.10s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [31:05<1:33:12, 58.25s/it]EarlyStopping counter : 10 out of 12
epoch : 33, train loss : 0.044, valid loss : 0.067, train f1 : 0.935, valid f1 : 0.776
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [32:12<1:36:19, 60.84s/it]Best score increase :0.772 -> 0.776
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [33:11<1:34:32, 60.35s/it]Best score increase :0.776 -> 0.790
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [34:10<1:32:44, 59.83s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [35:03<1:28:35, 57.78s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.042, valid loss : 0.062, train f1 : 0.936, valid f1 : 0.807
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [36:02<1:28:32, 58.38s/it]Best score increase :0.790 -> 0.807
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [36:57<1:25:49, 57.22s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [37:55<1:25:09, 57.41s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [38:52<1:24:20, 57.51s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.038, valid loss : 0.072, train f1 : 0.943, valid f1 : 0.787
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [40:00<1:27:54, 60.62s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [40:59<1:25:57, 59.97s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [41:56<1:23:44, 59.11s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [42:47<1:19:26, 56.75s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.037, valid loss : 0.073, train f1 : 0.947, valid f1 : 0.801
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [43:48<1:20:16, 58.03s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [44:45<1:18:51, 57.71s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [45:43<1:18:06, 57.86s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:42<1:17:17, 57.97s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.035, valid loss : 0.078, train f1 : 0.950, valid f1 : 0.759
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [47:50<1:19:43, 59.80s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.807
training process finished, best loss : 0.062, best acc : 0.930, best f1 : 0.807, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.78      0.67       580
           1       0.98      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.87      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.87, test loss : 2.985

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.23s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.24s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:15,  8.43s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:07,  8.49s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:58,  8.37s/it]processing for feature importance:  50%|█████     | 6/12 [00:50<00:51,  8.58s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:58<00:41,  8.37s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:33,  8.39s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:16<00:25,  8.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:24<00:16,  8.35s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:31<00:08,  8.15s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.34s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.38s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 107.85it/s]  8%|▊         | 24/306 [00:00<00:02, 118.03it/s] 12%|█▏        | 36/306 [00:00<00:02, 107.11it/s] 16%|█▋        | 50/306 [00:00<00:02, 117.03it/s] 21%|██        | 64/306 [00:00<00:01, 122.48it/s] 25%|██▌       | 77/306 [00:00<00:02, 107.06it/s] 30%|██▉       | 91/306 [00:00<00:01, 114.39it/s] 34%|███▍      | 104/306 [00:00<00:01, 115.81it/s] 38%|███▊      | 116/306 [00:01<00:01, 116.22it/s] 42%|████▏     | 129/306 [00:01<00:01, 118.98it/s] 46%|████▋     | 142/306 [00:01<00:01, 115.90it/s] 51%|█████     | 155/306 [00:01<00:01, 118.30it/s] 55%|█████▍    | 168/306 [00:01<00:01, 121.03it/s] 59%|█████▉    | 181/306 [00:01<00:01, 105.30it/s] 64%|██████▎   | 195/306 [00:01<00:00, 112.90it/s] 68%|██████▊   | 208/306 [00:01<00:00, 116.79it/s] 72%|███████▏  | 220/306 [00:01<00:00, 113.28it/s] 76%|███████▌  | 233/306 [00:02<00:00, 117.12it/s] 80%|████████  | 245/306 [00:02<00:00, 116.13it/s] 85%|████████▍ | 259/306 [00:02<00:00, 121.73it/s] 89%|████████▉ | 272/306 [00:02<00:00, 123.52it/s] 93%|█████████▎| 285/306 [00:02<00:00, 109.84it/s] 98%|█████████▊| 299/306 [00:02<00:00, 117.75it/s]100%|██████████| 306/306 [00:02<00:00, 116.19it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 452.42it/s]extract the null data:  17%|█▋        | 93/553 [00:00<00:00, 462.38it/s]extract the null data:  25%|██▌       | 141/553 [00:00<00:00, 470.31it/s]extract the null data:  34%|███▍      | 189/553 [00:00<00:00, 470.06it/s]extract the null data:  43%|████▎     | 238/553 [00:00<00:00, 474.77it/s]extract the null data:  52%|█████▏    | 286/553 [00:00<00:00, 475.38it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 471.71it/s]extract the null data:  69%|██████▉   | 382/553 [00:00<00:00, 472.66it/s]extract the null data:  78%|███████▊  | 430/553 [00:00<00:00, 472.79it/s]extract the null data:  86%|████████▋ | 478/553 [00:01<00:00, 472.24it/s]extract the null data:  95%|█████████▌| 526/553 [00:01<00:00, 470.44it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 471.20it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 171.04it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 175.53it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 172.98it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 173.12it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 176.79it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 178.44it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 183.59it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:02, 196.65it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:01, 203.50it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:01, 210.66it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 216.31it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 213.29it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 215.00it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 211.12it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 208.34it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 216.55it/s]replace nan value:  64%|██████▍   | 355/553 [00:01<00:00, 216.39it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 210.82it/s]replace nan value:  72%|███████▏  | 399/553 [00:01<00:00, 209.50it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 209.06it/s]replace nan value:  80%|███████▉  | 441/553 [00:02<00:00, 202.07it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 202.83it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 203.30it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 200.10it/s]replace nan value:  95%|█████████▍| 525/553 [00:02<00:00, 199.68it/s]replace nan value:  99%|█████████▊| 546/553 [00:02<00:00, 201.30it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 201.11it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 141.58it/s]  6%|▌         | 31/553 [00:00<00:03, 150.30it/s]  8%|▊         | 47/553 [00:00<00:03, 127.82it/s] 11%|█         | 61/553 [00:00<00:03, 123.77it/s] 14%|█▎        | 76/553 [00:00<00:03, 130.91it/s] 16%|█▋        | 91/553 [00:00<00:03, 132.81it/s] 19%|█▉        | 106/553 [00:00<00:03, 136.62it/s] 22%|██▏       | 122/553 [00:00<00:03, 140.33it/s] 25%|██▌       | 139/553 [00:00<00:02, 149.02it/s] 29%|██▊       | 158/553 [00:01<00:02, 159.75it/s] 32%|███▏      | 175/553 [00:01<00:02, 159.92it/s] 35%|███▍      | 192/553 [00:01<00:02, 160.54it/s] 38%|███▊      | 211/553 [00:01<00:02, 166.40it/s] 41%|████      | 228/553 [00:01<00:02, 157.93it/s] 44%|████▍     | 244/553 [00:01<00:02, 151.86it/s] 47%|████▋     | 262/553 [00:01<00:01, 158.00it/s] 50%|█████     | 278/553 [00:01<00:01, 150.03it/s] 53%|█████▎    | 294/553 [00:02<00:01, 143.15it/s] 56%|█████▌    | 309/553 [00:02<00:01, 139.81it/s] 59%|█████▊    | 324/553 [00:02<00:01, 138.50it/s] 61%|██████▏   | 339/553 [00:02<00:01, 141.63it/s] 64%|██████▍   | 354/553 [00:02<00:01, 140.17it/s] 67%|██████▋   | 370/553 [00:02<00:01, 144.67it/s] 70%|██████▉   | 385/553 [00:02<00:01, 140.77it/s] 72%|███████▏  | 400/553 [00:02<00:01, 123.38it/s] 75%|███████▌  | 415/553 [00:02<00:01, 129.50it/s] 78%|███████▊  | 429/553 [00:03<00:01, 120.70it/s] 81%|████████  | 446/553 [00:03<00:00, 133.34it/s] 83%|████████▎ | 461/553 [00:03<00:00, 137.15it/s] 86%|████████▌ | 476/553 [00:03<00:00, 138.40it/s] 89%|████████▉ | 491/553 [00:03<00:00, 125.93it/s] 91%|█████████ | 504/553 [00:03<00:00, 125.35it/s] 94%|█████████▍| 519/553 [00:03<00:00, 130.97it/s] 96%|█████████▋| 533/553 [00:03<00:00, 111.85it/s] 99%|█████████▉| 549/553 [00:03<00:00, 122.47it/s]100%|██████████| 553/553 [00:04<00:00, 135.41it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 279.70it/s]extract the null data:  61%|██████    | 85/139 [00:00<00:00, 447.10it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 487.55it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 459.59it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 189.49it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 192.04it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 193.73it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 193.88it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 194.36it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 193.89it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.44it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.34it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 119.62it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.66it/s] 29%|██▉       | 40/139 [00:00<00:00, 132.50it/s] 39%|███▉      | 54/139 [00:00<00:00, 124.64it/s] 48%|████▊     | 67/139 [00:00<00:00, 125.60it/s] 58%|█████▊    | 81/139 [00:00<00:00, 129.83it/s] 68%|██████▊   | 95/139 [00:00<00:00, 123.16it/s] 78%|███████▊  | 109/139 [00:00<00:00, 124.62it/s] 91%|█████████ | 126/139 [00:00<00:00, 135.60it/s]100%|██████████| 139/139 [00:01<00:00, 131.04it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 268.36it/s]extract the null data:  49%|████▉     | 85/173 [00:00<00:00, 448.25it/s]extract the null data:  77%|███████▋  | 134/173 [00:00<00:00, 464.89it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 455.88it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 189.79it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 187.60it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 183.23it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 188.49it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 189.97it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 191.14it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 187.05it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 187.52it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 187.75it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 133.67it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.21it/s] 24%|██▍       | 42/173 [00:00<00:01, 126.56it/s] 33%|███▎      | 57/173 [00:00<00:00, 133.68it/s] 41%|████      | 71/173 [00:00<00:00, 132.51it/s] 49%|████▉     | 85/173 [00:00<00:00, 132.08it/s] 57%|█████▋    | 99/173 [00:00<00:00, 131.79it/s] 66%|██████▋   | 115/173 [00:00<00:00, 138.91it/s] 75%|███████▍  | 129/173 [00:00<00:00, 130.31it/s] 83%|████████▎ | 143/173 [00:01<00:00, 128.65it/s] 90%|█████████ | 156/173 [00:01<00:00, 120.20it/s] 98%|█████████▊| 169/173 [00:01<00:00, 98.38it/s] 100%|██████████| 173/173 [00:01<00:00, 115.93it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.008, train acc : 0.813, valid acc : 0.921, train f1 : 0.547, valid f1 : 0.577
training process:   1%|          | 1/128 [01:08<2:25:05, 68.55s/it]Best score increase :0.000 -> 0.577
training process:   2%|▏         | 2/128 [02:06<2:10:43, 62.25s/it]Best score increase :0.577 -> 0.616
training process:   2%|▏         | 3/128 [03:04<2:06:02, 60.50s/it]Best score increase :0.616 -> 0.647
training process:   3%|▎         | 4/128 [04:01<2:01:37, 58.85s/it]Best score increase :0.647 -> 0.672
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.936, valid acc : 0.931, train f1 : 0.692, valid f1 : 0.671
training process:   4%|▍         | 5/128 [04:57<1:58:26, 57.78s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:48<1:53:17, 55.72s/it]Best score increase :0.672 -> 0.713
training process:   5%|▌         | 7/128 [06:40<1:49:37, 54.36s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:37<1:50:24, 55.20s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.004, train acc : 0.942, valid acc : 0.937, train f1 : 0.733, valid f1 : 0.724
training process:   7%|▋         | 9/128 [08:43<1:56:35, 58.78s/it]Best score increase :0.713 -> 0.724
training process:   8%|▊         | 10/128 [09:42<1:55:13, 58.59s/it]Best score increase :0.724 -> 0.727
training process:   9%|▊         | 11/128 [10:39<1:53:17, 58.10s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:35<1:51:11, 57.52s/it]Best score increase :0.727 -> 0.744
epoch : 13, train loss : 0.003, valid loss : 0.003, train acc : 0.947, valid acc : 0.939, train f1 : 0.767, valid f1 : 0.745
training process:  10%|█         | 13/128 [12:29<1:48:09, 56.43s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [13:15<1:41:35, 53.47s/it]Best score increase :0.744 -> 0.746
training process:  12%|█▏        | 15/128 [14:02<1:37:00, 51.51s/it]Best score increase :0.746 -> 0.752
training process:  12%|█▎        | 16/128 [14:59<1:39:18, 53.20s/it]Best score increase :0.752 -> 0.763
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.952, valid acc : 0.944, train f1 : 0.793, valid f1 : 0.772
training process:  13%|█▎        | 17/128 [16:06<1:45:56, 57.27s/it]Best score increase :0.763 -> 0.772
training process:  14%|█▍        | 18/128 [17:04<1:45:05, 57.32s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [18:02<1:44:28, 57.51s/it]Best score increase :0.772 -> 0.780
training process:  16%|█▌        | 20/128 [18:59<1:43:40, 57.59s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train acc : 0.954, valid acc : 0.947, train f1 : 0.808, valid f1 : 0.788
training process:  16%|█▋        | 21/128 [20:01<1:44:56, 58.84s/it]Best score increase :0.780 -> 0.788
training process:  17%|█▋        | 22/128 [20:55<1:41:13, 57.30s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [21:48<1:38:17, 56.16s/it]Best score increase :0.788 -> 0.794
training process:  19%|█▉        | 24/128 [22:46<1:38:05, 56.60s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.957, valid acc : 0.949, train f1 : 0.824, valid f1 : 0.801
training process:  20%|█▉        | 25/128 [23:52<1:42:01, 59.43s/it]Best score increase :0.794 -> 0.801
training process:  20%|██        | 26/128 [24:50<1:40:16, 58.98s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [25:47<1:38:33, 58.55s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [26:46<1:37:20, 58.40s/it]Best score increase :0.801 -> 0.814
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.961, valid acc : 0.950, train f1 : 0.845, valid f1 : 0.802
training process:  23%|██▎       | 29/128 [27:49<1:38:50, 59.91s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [28:39<1:33:02, 56.97s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [29:34<1:31:01, 56.30s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [30:31<1:30:39, 56.66s/it]Best score increase :0.814 -> 0.821
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.962, valid acc : 0.951, train f1 : 0.852, valid f1 : 0.810
training process:  26%|██▌       | 33/128 [31:38<1:34:38, 59.77s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [32:36<1:32:31, 59.06s/it]Best score increase :0.821 -> 0.830
training process:  27%|██▋       | 35/128 [33:33<1:30:52, 58.63s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [34:31<1:29:31, 58.39s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.965, valid acc : 0.953, train f1 : 0.864, valid f1 : 0.821
training process:  29%|██▉       | 37/128 [35:31<1:29:20, 58.91s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [36:25<1:26:03, 57.38s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [37:17<1:22:45, 55.79s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [38:14<1:22:24, 56.19s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.966, valid acc : 0.954, train f1 : 0.869, valid f1 : 0.827
training process:  32%|███▏      | 41/128 [39:20<1:25:42, 59.11s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [40:18<1:24:13, 58.76s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [41:12<1:21:17, 57.39s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [42:06<1:18:54, 56.36s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.955, train f1 : 0.873, valid f1 : 0.831
training process:  35%|███▌      | 45/128 [43:09<1:20:38, 58.30s/it]Best score increase :0.830 -> 0.831
training process:  36%|███▌      | 46/128 [44:06<1:19:05, 57.87s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [45:03<1:17:49, 57.65s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [46:06<1:19:04, 59.31s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.954, train f1 : 0.878, valid f1 : 0.827
training process:  38%|███▊      | 49/128 [47:14<1:21:27, 61.87s/it]EarlyStopping counter : 4 out of 12
training process:  39%|███▉      | 50/128 [48:13<1:19:11, 60.92s/it]Best score increase :0.831 -> 0.833
training process:  40%|███▉      | 51/128 [49:19<1:20:03, 62.38s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [50:10<1:14:42, 58.98s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.954, train f1 : 0.883, valid f1 : 0.830
training process:  41%|████▏     | 53/128 [51:12<1:15:00, 60.01s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [52:07<1:11:55, 58.32s/it]Best score increase :0.833 -> 0.835
training process:  43%|████▎     | 55/128 [53:04<1:10:41, 58.11s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [54:03<1:10:03, 58.39s/it]Best score increase :0.835 -> 0.838
epoch : 57, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.956, train f1 : 0.884, valid f1 : 0.842
training process:  45%|████▍     | 57/128 [55:05<1:10:09, 59.28s/it]Best score increase :0.838 -> 0.842
training process:  45%|████▌     | 58/128 [56:02<1:08:34, 58.78s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [56:58<1:06:29, 57.82s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [57:58<1:06:28, 58.66s/it]EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.003, train acc : 0.971, valid acc : 0.955, train f1 : 0.889, valid f1 : 0.836
training process:  48%|████▊     | 61/128 [59:03<1:07:24, 60.36s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [1:00:06<1:07:19, 61.21s/it]EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [1:01:12<1:07:50, 62.63s/it]EarlyStopping counter : 6 out of 12
training process:  50%|█████     | 64/128 [1:02:15<1:07:04, 62.88s/it]EarlyStopping counter : 7 out of 12
epoch : 65, train loss : 0.002, valid loss : 0.004, train acc : 0.971, valid acc : 0.955, train f1 : 0.892, valid f1 : 0.835
training process:  51%|█████     | 65/128 [1:03:27<1:08:51, 65.58s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 66/128 [1:04:29<1:06:29, 64.35s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 67/128 [1:05:32<1:05:14, 64.17s/it]EarlyStopping counter : 10 out of 12
training process:  53%|█████▎    | 68/128 [1:06:29<1:02:02, 62.04s/it]EarlyStopping counter : 11 out of 12
epoch : 69, train loss : 0.002, valid loss : 0.004, train acc : 0.971, valid acc : 0.955, train f1 : 0.892, valid f1 : 0.835
training process:  53%|█████▎    | 68/128 [1:07:43<59:45, 59.75s/it]  
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 68, best f1 score : 0.842
training process finished, best loss : 0.003 and best acc : 0.956, best f1 : 0.842, best epoch : 56

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.77      0.63      0.69       580
           1       0.97      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.87      0.81      0.84      7398
weighted avg       0.95      0.96      0.95      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.81, test loss : 0.174

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:45,  9.57s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:35,  9.59s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:25,  9.48s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:17,  9.68s/it]processing for feature importance:  42%|████▏     | 5/12 [00:48<01:09,  9.88s/it]processing for feature importance:  50%|█████     | 6/12 [00:58<00:58,  9.79s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:07<00:47,  9.47s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:16<00:37,  9.31s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:25<00:28,  9.43s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:35<00:18,  9.46s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:44<00:09,  9.43s/it]processing for feature importance: 100%|██████████| 12/12 [01:54<00:00,  9.57s/it]processing for feature importance: 100%|██████████| 12/12 [01:54<00:00,  9.55s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:04, 73.62it/s]  8%|▊         | 24/306 [00:00<00:02, 115.64it/s] 12%|█▏        | 36/306 [00:00<00:02, 115.39it/s] 16%|█▌        | 48/306 [00:00<00:02, 94.49it/s]  21%|██        | 64/306 [00:00<00:02, 110.41it/s] 25%|██▌       | 77/306 [00:00<00:02, 112.55it/s] 29%|██▉       | 89/306 [00:00<00:02, 95.99it/s]  35%|███▍      | 107/306 [00:00<00:01, 113.30it/s] 39%|███▉      | 119/306 [00:01<00:01, 112.30it/s] 43%|████▎     | 131/306 [00:01<00:01, 97.17it/s]  49%|████▉     | 150/306 [00:01<00:01, 118.24it/s] 53%|█████▎    | 163/306 [00:01<00:01, 116.21it/s] 58%|█████▊    | 176/306 [00:01<00:01, 100.85it/s] 63%|██████▎   | 192/306 [00:01<00:01, 112.41it/s] 67%|██████▋   | 204/306 [00:01<00:00, 108.18it/s] 71%|███████   | 216/306 [00:02<00:00, 99.06it/s]  77%|███████▋  | 235/306 [00:02<00:00, 119.45it/s] 82%|████████▏ | 251/306 [00:02<00:00, 129.52it/s] 87%|████████▋ | 265/306 [00:02<00:00, 113.52it/s] 93%|█████████▎| 284/306 [00:02<00:00, 131.21it/s] 97%|█████████▋| 298/306 [00:02<00:00, 125.30it/s]100%|██████████| 306/306 [00:02<00:00, 111.48it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 598.24it/s]extract the null data:  22%|██▏       | 120/553 [00:00<00:00, 595.01it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 607.26it/s]extract the null data:  44%|████▍     | 244/553 [00:00<00:00, 604.27it/s]extract the null data:  55%|█████▌    | 305/553 [00:00<00:00, 605.41it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 606.63it/s]extract the null data:  77%|███████▋  | 427/553 [00:00<00:00, 595.47it/s]extract the null data:  88%|████████▊ | 489/553 [00:00<00:00, 600.87it/s]extract the null data:  99%|█████████▉| 550/553 [00:00<00:00, 599.80it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 600.61it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 181.16it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 192.82it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 186.71it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 191.57it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 192.17it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 196.97it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 196.70it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:01, 197.40it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 200.20it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:01, 199.93it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 202.40it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 203.16it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 205.73it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 209.63it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 207.20it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:01, 204.88it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:00, 204.72it/s]replace nan value:  67%|██████▋   | 373/553 [00:01<00:00, 199.91it/s]replace nan value:  71%|███████   | 394/553 [00:01<00:00, 200.23it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 203.06it/s]replace nan value:  79%|███████▉  | 436/553 [00:02<00:00, 198.38it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 197.42it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 199.87it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 201.15it/s]replace nan value:  94%|█████████▍| 519/553 [00:02<00:00, 201.34it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 202.38it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 199.87it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 143.50it/s]  5%|▌         | 30/553 [00:00<00:03, 145.80it/s]  8%|▊         | 45/553 [00:00<00:03, 130.81it/s] 11%|█         | 59/553 [00:00<00:03, 124.36it/s] 13%|█▎        | 72/553 [00:00<00:03, 124.68it/s] 16%|█▌        | 89/553 [00:00<00:03, 136.05it/s] 19%|█▊        | 103/553 [00:00<00:03, 132.61it/s] 22%|██▏       | 121/553 [00:00<00:03, 143.67it/s] 25%|██▍       | 136/553 [00:00<00:02, 144.03it/s] 28%|██▊       | 154/553 [00:01<00:02, 154.24it/s] 31%|███       | 172/553 [00:01<00:02, 161.79it/s] 34%|███▍      | 189/553 [00:01<00:02, 155.91it/s] 38%|███▊      | 208/553 [00:01<00:02, 162.70it/s] 41%|████      | 225/553 [00:01<00:02, 153.14it/s] 44%|████▎     | 241/553 [00:01<00:02, 154.38it/s] 46%|████▋     | 257/553 [00:01<00:02, 147.62it/s] 49%|████▉     | 272/553 [00:01<00:01, 142.23it/s] 52%|█████▏    | 289/553 [00:01<00:01, 148.07it/s] 55%|█████▍    | 304/553 [00:02<00:01, 140.99it/s] 58%|█████▊    | 319/553 [00:02<00:01, 135.08it/s] 60%|██████    | 334/553 [00:02<00:01, 136.97it/s] 63%|██████▎   | 348/553 [00:02<00:01, 136.86it/s] 65%|██████▌   | 362/553 [00:02<00:01, 132.58it/s] 68%|██████▊   | 378/553 [00:02<00:01, 137.27it/s] 71%|███████   | 392/553 [00:02<00:01, 128.89it/s] 73%|███████▎  | 405/553 [00:02<00:01, 128.51it/s] 76%|███████▌  | 418/553 [00:02<00:01, 124.94it/s] 78%|███████▊  | 431/553 [00:03<00:01, 121.77it/s] 81%|████████  | 449/553 [00:03<00:00, 137.61it/s] 84%|████████▍ | 464/553 [00:03<00:00, 141.05it/s] 87%|████████▋ | 479/553 [00:03<00:00, 139.47it/s] 89%|████████▉ | 494/553 [00:03<00:00, 132.52it/s] 92%|█████████▏| 509/553 [00:03<00:00, 137.16it/s] 95%|█████████▍| 523/553 [00:03<00:00, 127.67it/s] 97%|█████████▋| 536/553 [00:03<00:00, 118.43it/s]100%|█████████▉| 551/553 [00:04<00:00, 107.69it/s]100%|██████████| 553/553 [00:04<00:00, 135.34it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   1%|          | 1/139 [00:00<00:16,  8.21it/s]extract the null data:  47%|████▋     | 65/139 [00:00<00:00, 347.07it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 472.24it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 408.94it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 199.22it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 202.89it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 207.82it/s]replace nan value:  62%|██████▏   | 86/139 [00:00<00:00, 210.64it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 207.31it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 209.90it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 209.32it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.57it/s] 19%|█▊        | 26/139 [00:00<00:00, 126.71it/s] 30%|███       | 42/139 [00:00<00:00, 139.94it/s] 40%|████      | 56/139 [00:00<00:00, 124.09it/s] 51%|█████     | 71/139 [00:00<00:00, 128.44it/s] 60%|██████    | 84/139 [00:00<00:00, 122.31it/s] 70%|██████▉   | 97/139 [00:00<00:00, 119.09it/s] 78%|███████▊  | 109/139 [00:00<00:00, 116.96it/s] 90%|████████▉ | 125/139 [00:00<00:00, 127.26it/s]100%|██████████| 139/139 [00:01<00:00, 129.06it/s]100%|██████████| 139/139 [00:01<00:00, 125.91it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 2/173 [00:00<00:08, 19.88it/s]extract the null data:  37%|███▋      | 64/173 [00:00<00:00, 371.22it/s]extract the null data:  76%|███████▋  | 132/173 [00:00<00:00, 511.30it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 473.83it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 214.65it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 212.69it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 215.06it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 210.62it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 211.35it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 210.51it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 208.09it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 208.98it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.55it/s] 16%|█▌        | 28/173 [00:00<00:01, 121.93it/s] 25%|██▌       | 44/173 [00:00<00:00, 136.78it/s] 35%|███▍      | 60/173 [00:00<00:00, 143.99it/s] 43%|████▎     | 75/173 [00:00<00:00, 136.65it/s] 51%|█████▏    | 89/173 [00:00<00:00, 136.93it/s] 60%|█████▉    | 103/173 [00:00<00:00, 134.48it/s] 68%|██████▊   | 118/173 [00:00<00:00, 137.53it/s] 76%|███████▋  | 132/173 [00:00<00:00, 131.66it/s] 84%|████████▍ | 146/173 [00:01<00:00, 128.58it/s] 92%|█████████▏| 159/173 [00:01<00:00, 118.81it/s] 99%|█████████▉| 172/173 [00:01<00:00, 88.46it/s] 100%|██████████| 173/173 [00:01<00:00, 117.65it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.010, train acc : 0.697, valid acc : 0.732, train f1 : 0.695, valid f1 : 0.577
training process:   1%|          | 1/128 [01:45<3:42:47, 105.26s/it]Best score increase :0.000 -> 0.577
training process:   2%|▏         | 2/128 [03:24<3:33:39, 101.74s/it]Best score increase :0.577 -> 0.616
training process:   2%|▏         | 3/128 [04:50<3:16:37, 94.38s/it] Best score increase :0.616 -> 0.663
training process:   3%|▎         | 4/128 [06:26<3:16:59, 95.32s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.807, valid acc : 0.847, train f1 : 0.807, valid f1 : 0.682
training process:   4%|▍         | 5/128 [08:07<3:19:12, 97.17s/it]Best score increase :0.663 -> 0.682
training process:   5%|▍         | 6/128 [09:35<3:11:06, 93.98s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [11:02<3:05:23, 91.93s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [12:28<2:59:39, 89.83s/it]EarlyStopping counter : 3 out of 12
epoch : 9, train loss : 0.007, valid loss : 0.008, train acc : 0.844, valid acc : 0.835, train f1 : 0.844, valid f1 : 0.680
training process:   7%|▋         | 9/128 [13:56<2:56:54, 89.20s/it]EarlyStopping counter : 4 out of 12
training process:   8%|▊         | 10/128 [15:24<2:54:58, 88.97s/it]Best score increase :0.682 -> 0.707
training process:   9%|▊         | 11/128 [16:44<2:48:05, 86.20s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [17:57<2:38:57, 82.22s/it]Best score increase :0.707 -> 0.716
epoch : 13, train loss : 0.006, valid loss : 0.006, train acc : 0.875, valid acc : 0.870, train f1 : 0.875, valid f1 : 0.721
training process:  10%|█         | 13/128 [19:28<2:42:25, 84.74s/it]Best score increase :0.716 -> 0.721
training process:  11%|█         | 14/128 [20:52<2:40:54, 84.69s/it]Best score increase :0.721 -> 0.724
training process:  12%|█▏        | 15/128 [22:19<2:40:47, 85.37s/it]Best score increase :0.724 -> 0.728
training process:  12%|█▎        | 16/128 [23:45<2:39:33, 85.48s/it]Best score increase :0.728 -> 0.733
epoch : 17, train loss : 0.005, valid loss : 0.006, train acc : 0.891, valid acc : 0.870, train f1 : 0.891, valid f1 : 0.726
training process:  13%|█▎        | 17/128 [25:17<2:41:53, 87.51s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [26:32<2:33:46, 83.88s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [27:40<2:23:40, 79.09s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [28:48<2:16:16, 75.71s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.006, train acc : 0.905, valid acc : 0.862, train f1 : 0.905, valid f1 : 0.715
training process:  16%|█▋        | 21/128 [30:08<2:17:07, 76.89s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [31:32<2:19:53, 79.18s/it]Best score increase :0.733 -> 0.760
training process:  18%|█▊        | 23/128 [32:45<2:15:01, 77.16s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [33:53<2:08:52, 74.35s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.005, train acc : 0.915, valid acc : 0.893, train f1 : 0.915, valid f1 : 0.753
training process:  20%|█▉        | 25/128 [35:06<2:07:18, 74.16s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [36:10<2:00:40, 70.98s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [37:21<1:59:32, 71.02s/it]Best score increase :0.760 -> 0.765
training process:  22%|██▏       | 28/128 [38:26<1:55:09, 69.10s/it]Best score increase :0.765 -> 0.768
epoch : 29, train loss : 0.004, valid loss : 0.005, train acc : 0.925, valid acc : 0.892, train f1 : 0.925, valid f1 : 0.756
training process:  23%|██▎       | 29/128 [39:41<1:57:19, 71.11s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [40:47<1:53:24, 69.44s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [41:49<1:48:46, 67.28s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [43:01<1:49:40, 68.54s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.004, train acc : 0.926, valid acc : 0.913, train f1 : 0.926, valid f1 : 0.783
training process:  26%|██▌       | 33/128 [44:22<1:54:25, 72.26s/it]Best score increase :0.768 -> 0.783
training process:  27%|██▋       | 34/128 [45:33<1:52:46, 71.99s/it]Best score increase :0.783 -> 0.784
training process:  27%|██▋       | 35/128 [46:41<1:49:54, 70.90s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [47:54<1:49:31, 71.43s/it]Best score increase :0.784 -> 0.789
epoch : 37, train loss : 0.004, valid loss : 0.004, train acc : 0.927, valid acc : 0.931, train f1 : 0.927, valid f1 : 0.811
training process:  29%|██▉       | 37/128 [49:20<1:55:03, 75.87s/it]Best score increase :0.789 -> 0.811
training process:  30%|██▉       | 38/128 [50:29<1:50:47, 73.86s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [51:44<1:49:52, 74.08s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [52:55<1:47:28, 73.28s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.005, train acc : 0.936, valid acc : 0.901, train f1 : 0.936, valid f1 : 0.766
training process:  32%|███▏      | 41/128 [54:21<1:51:46, 77.08s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [55:30<1:46:58, 74.63s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [56:40<1:43:38, 73.15s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [57:52<1:42:01, 72.87s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.005, train acc : 0.938, valid acc : 0.913, train f1 : 0.938, valid f1 : 0.786
training process:  35%|███▌      | 45/128 [59:09<1:42:24, 74.03s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [1:00:15<1:38:03, 71.75s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [1:01:27<1:36:46, 71.69s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [1:02:39<1:35:46, 71.83s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.003, valid loss : 0.005, train acc : 0.940, valid acc : 0.893, train f1 : 0.940, valid f1 : 0.757
training process:  38%|███▊      | 48/128 [1:03:57<1:46:35, 79.94s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.811
training process finished, best loss : 0.004 and best acc : 0.931, best f1 : 0.811, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.53      0.79      0.63       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.87      0.80      7398
weighted avg       0.95      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.87, test loss : 0.219

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.36s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:12,  7.23s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.36s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.66s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.83s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.99s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:40,  8.10s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.96s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.87s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.97s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:08,  8.07s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.97s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.87s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 129.86it/s]  9%|▉         | 29/306 [00:00<00:01, 143.89it/s] 15%|█▍        | 45/306 [00:00<00:01, 148.72it/s] 20%|█▉        | 60/306 [00:00<00:02, 122.83it/s] 27%|██▋       | 84/306 [00:00<00:01, 155.18it/s] 33%|███▎      | 101/306 [00:00<00:01, 137.48it/s] 38%|███▊      | 116/306 [00:00<00:01, 132.82it/s] 43%|████▎     | 133/306 [00:00<00:01, 141.37it/s] 49%|████▉     | 151/306 [00:01<00:01, 150.45it/s] 55%|█████▍    | 167/306 [00:01<00:01, 130.52it/s] 61%|██████▏   | 188/306 [00:01<00:00, 147.43it/s] 67%|██████▋   | 204/306 [00:01<00:00, 143.03it/s] 72%|███████▏  | 219/306 [00:01<00:00, 127.90it/s] 78%|███████▊  | 238/306 [00:01<00:00, 143.01it/s] 83%|████████▎ | 253/306 [00:01<00:00, 138.10it/s] 88%|████████▊ | 268/306 [00:01<00:00, 125.87it/s] 94%|█████████▍| 289/306 [00:02<00:00, 143.30it/s]100%|█████████▉| 305/306 [00:02<00:00, 144.91it/s]100%|██████████| 306/306 [00:02<00:00, 139.52it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 446.12it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 456.64it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:00, 453.50it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 456.14it/s]extract the null data:  42%|████▏     | 232/553 [00:00<00:00, 459.08it/s]extract the null data:  50%|█████     | 279/553 [00:00<00:00, 461.28it/s]extract the null data:  59%|█████▉    | 326/553 [00:00<00:00, 462.08it/s]extract the null data:  67%|██████▋   | 373/553 [00:00<00:00, 461.25it/s]extract the null data:  76%|███████▌  | 420/553 [00:00<00:00, 459.73it/s]extract the null data:  84%|████████▍ | 466/553 [00:01<00:00, 459.51it/s]extract the null data:  93%|█████████▎| 514/553 [00:01<00:00, 462.64it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 459.16it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.01it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.17it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 166.19it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 167.96it/s]replace nan value:  16%|█▌        | 87/553 [00:00<00:02, 169.39it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 170.63it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 170.69it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 168.29it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:02, 169.10it/s]replace nan value:  32%|███▏      | 177/553 [00:01<00:02, 170.51it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:02, 170.50it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 170.16it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 169.60it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 170.06it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 169.91it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 171.04it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 171.39it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 170.85it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 170.04it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 169.78it/s]replace nan value:  68%|██████▊   | 375/553 [00:02<00:01, 169.93it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:00, 169.42it/s]replace nan value:  74%|███████▍  | 410/553 [00:02<00:00, 169.70it/s]replace nan value:  77%|███████▋  | 427/553 [00:02<00:00, 168.14it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 169.03it/s]replace nan value:  84%|████████▎ | 463/553 [00:02<00:00, 169.31it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 169.87it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 169.15it/s]replace nan value:  93%|█████████▎| 515/553 [00:03<00:00, 168.63it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 168.39it/s]replace nan value:  99%|█████████▉| 550/553 [00:03<00:00, 169.33it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 169.30it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.24it/s]  5%|▌         | 28/553 [00:00<00:03, 136.46it/s]  8%|▊         | 42/553 [00:00<00:03, 131.39it/s] 10%|█         | 56/553 [00:00<00:04, 122.70it/s] 12%|█▏        | 69/553 [00:00<00:04, 113.36it/s] 15%|█▌        | 84/553 [00:00<00:03, 123.27it/s] 18%|█▊        | 98/553 [00:00<00:03, 123.59it/s] 21%|██        | 114/553 [00:00<00:03, 132.00it/s] 23%|██▎       | 128/553 [00:01<00:03, 130.25it/s] 26%|██▋       | 146/553 [00:01<00:02, 143.13it/s] 29%|██▉       | 162/553 [00:01<00:02, 146.14it/s] 32%|███▏      | 178/553 [00:01<00:02, 146.91it/s] 35%|███▌      | 194/553 [00:01<00:02, 149.07it/s] 38%|███▊      | 210/553 [00:01<00:02, 152.16it/s] 41%|████      | 226/553 [00:01<00:02, 142.74it/s] 44%|████▎     | 241/553 [00:01<00:02, 143.25it/s] 46%|████▋     | 256/553 [00:01<00:02, 136.44it/s] 49%|████▉     | 270/553 [00:01<00:02, 136.56it/s] 51%|█████▏    | 284/553 [00:02<00:02, 134.13it/s] 54%|█████▍    | 298/553 [00:02<00:01, 129.91it/s] 56%|█████▋    | 312/553 [00:02<00:01, 125.77it/s] 59%|█████▉    | 326/553 [00:02<00:01, 128.06it/s] 61%|██████▏   | 340/553 [00:02<00:01, 129.15it/s] 64%|██████▍   | 353/553 [00:02<00:01, 128.04it/s] 66%|██████▌   | 366/553 [00:02<00:01, 123.81it/s] 69%|██████▉   | 381/553 [00:02<00:01, 129.73it/s] 71%|███████▏  | 395/553 [00:03<00:01, 118.29it/s] 74%|███████▍  | 408/553 [00:03<00:01, 121.36it/s] 76%|███████▌  | 421/553 [00:03<00:01, 118.27it/s] 78%|███████▊  | 433/553 [00:03<00:01, 115.00it/s] 81%|████████▏ | 450/553 [00:03<00:00, 129.81it/s] 84%|████████▍ | 464/553 [00:03<00:00, 131.11it/s] 86%|████████▋ | 478/553 [00:03<00:00, 130.03it/s] 89%|████████▉ | 492/553 [00:03<00:00, 125.38it/s] 91%|█████████▏| 505/553 [00:03<00:00, 122.11it/s] 94%|█████████▍| 520/553 [00:03<00:00, 126.99it/s] 96%|█████████▋| 533/553 [00:04<00:00, 109.32it/s] 99%|█████████▉| 549/553 [00:04<00:00, 120.27it/s]100%|██████████| 553/553 [00:04<00:00, 126.86it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 268.18it/s]extract the null data:  58%|█████▊    | 81/139 [00:00<00:00, 423.35it/s]extract the null data:  97%|█████████▋| 135/139 [00:00<00:00, 475.96it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 448.61it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 192.94it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 188.18it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 187.42it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 188.72it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 189.07it/s]replace nan value:  85%|████████▍ | 118/139 [00:00<00:00, 188.30it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 188.72it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 188.63it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.95it/s] 17%|█▋        | 24/139 [00:00<00:00, 119.17it/s] 27%|██▋       | 38/139 [00:00<00:00, 126.60it/s] 37%|███▋      | 51/139 [00:00<00:00, 121.73it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.43it/s] 55%|█████▌    | 77/139 [00:00<00:00, 118.26it/s] 64%|██████▍   | 89/139 [00:00<00:00, 106.55it/s] 74%|███████▍  | 103/139 [00:00<00:00, 115.00it/s] 83%|████████▎ | 115/139 [00:00<00:00, 115.94it/s] 92%|█████████▏| 128/139 [00:01<00:00, 118.65it/s]100%|██████████| 139/139 [00:01<00:00, 118.38it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 279.74it/s]extract the null data:  47%|████▋     | 81/173 [00:00<00:00, 426.37it/s]extract the null data:  77%|███████▋  | 134/173 [00:00<00:00, 471.37it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 456.70it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 187.72it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 188.88it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 188.16it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 188.16it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 187.98it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 188.53it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 190.65it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 188.63it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 187.74it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.98it/s] 16%|█▌        | 28/173 [00:00<00:01, 115.87it/s] 24%|██▍       | 42/173 [00:00<00:01, 124.68it/s] 33%|███▎      | 57/173 [00:00<00:00, 132.23it/s] 41%|████      | 71/173 [00:00<00:00, 129.87it/s] 49%|████▉     | 85/173 [00:00<00:00, 128.61it/s] 57%|█████▋    | 99/173 [00:00<00:00, 128.73it/s] 66%|██████▌   | 114/173 [00:00<00:00, 134.08it/s] 74%|███████▍  | 128/173 [00:00<00:00, 127.18it/s] 82%|████████▏ | 141/173 [00:01<00:00, 125.98it/s] 89%|████████▉ | 154/173 [00:01<00:00, 116.34it/s] 96%|█████████▌| 166/173 [00:01<00:00, 93.11it/s] 100%|██████████| 173/173 [00:01<00:00, 112.60it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.012, train acc : 0.546, valid acc : 0.647, train f1 : 0.453, valid f1 : 0.524
training process:   1%|          | 1/128 [01:02<2:12:40, 62.68s/it]Best score increase :0.000 -> 0.524
training process:   2%|▏         | 2/128 [01:51<1:54:42, 54.62s/it]Best score increase :0.524 -> 0.577
training process:   2%|▏         | 3/128 [02:41<1:49:20, 52.49s/it]Best score increase :0.577 -> 0.643
training process:   3%|▎         | 4/128 [03:51<2:02:31, 59.29s/it]Best score increase :0.643 -> 0.658
epoch : 5, train loss : 0.009, valid loss : 0.010, train acc : 0.809, valid acc : 0.843, train f1 : 0.641, valid f1 : 0.676
training process:   4%|▍         | 5/128 [04:52<2:03:15, 60.12s/it]Best score increase :0.658 -> 0.676
training process:   5%|▍         | 6/128 [05:44<1:56:25, 57.26s/it]Best score increase :0.676 -> 0.680
training process:   5%|▌         | 7/128 [06:34<1:50:48, 54.95s/it]Best score increase :0.680 -> 0.690
training process:   6%|▋         | 8/128 [07:25<1:47:28, 53.74s/it]Best score increase :0.690 -> 0.708
epoch : 9, train loss : 0.008, valid loss : 0.009, train acc : 0.858, valid acc : 0.853, train f1 : 0.690, valid f1 : 0.690
training process:   7%|▋         | 9/128 [08:23<1:49:13, 55.07s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:14<1:45:40, 53.73s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [10:04<1:42:18, 52.47s/it]Best score increase :0.708 -> 0.713
training process:   9%|▉         | 12/128 [10:55<1:40:51, 52.17s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.009, train acc : 0.878, valid acc : 0.874, train f1 : 0.718, valid f1 : 0.716
training process:  10%|█         | 13/128 [12:12<1:54:28, 59.72s/it]Best score increase :0.713 -> 0.716
training process:  11%|█         | 14/128 [13:39<2:08:50, 67.82s/it]Best score increase :0.716 -> 0.722
training process:  12%|█▏        | 15/128 [15:04<2:17:15, 72.88s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [16:33<2:25:05, 77.73s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.007, valid loss : 0.009, train acc : 0.889, valid acc : 0.863, train f1 : 0.738, valid f1 : 0.704
training process:  13%|█▎        | 17/128 [18:02<2:30:21, 81.27s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [19:16<2:24:55, 79.05s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [20:43<2:27:46, 81.34s/it]Best score increase :0.722 -> 0.724
training process:  16%|█▌        | 20/128 [22:11<2:30:13, 83.46s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.008, train acc : 0.902, valid acc : 0.870, train f1 : 0.757, valid f1 : 0.719
training process:  16%|█▋        | 21/128 [23:51<2:37:54, 88.55s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [25:10<2:31:13, 85.60s/it]Best score increase :0.724 -> 0.751
training process:  18%|█▊        | 23/128 [26:32<2:27:40, 84.38s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [27:57<2:26:32, 84.54s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.008, train acc : 0.915, valid acc : 0.904, train f1 : 0.778, valid f1 : 0.761
training process:  20%|█▉        | 25/128 [29:32<2:30:40, 87.77s/it]Best score increase :0.751 -> 0.761
training process:  20%|██        | 26/128 [30:50<2:24:07, 84.78s/it]Best score increase :0.761 -> 0.764
training process:  21%|██        | 27/128 [32:17<2:23:55, 85.50s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [33:47<2:24:54, 86.94s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.008, train acc : 0.918, valid acc : 0.915, train f1 : 0.789, valid f1 : 0.775
training process:  23%|██▎       | 29/128 [35:10<2:21:22, 85.68s/it]Best score increase :0.764 -> 0.775
training process:  23%|██▎       | 30/128 [36:27<2:15:56, 83.23s/it]Best score increase :0.775 -> 0.783
training process:  24%|██▍       | 31/128 [37:57<2:17:29, 85.04s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [39:08<2:09:25, 80.89s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.008, train acc : 0.928, valid acc : 0.909, train f1 : 0.804, valid f1 : 0.764
training process:  26%|██▌       | 33/128 [40:33<2:10:15, 82.27s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 34/128 [41:43<2:02:57, 78.49s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 35/128 [43:02<2:01:55, 78.66s/it]Best score increase :0.783 -> 0.785
training process:  28%|██▊       | 36/128 [44:16<1:58:18, 77.16s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.009, train acc : 0.933, valid acc : 0.920, train f1 : 0.817, valid f1 : 0.789
training process:  29%|██▉       | 37/128 [45:38<1:59:30, 78.80s/it]Best score increase :0.785 -> 0.789
training process:  30%|██▉       | 38/128 [46:48<1:54:13, 76.15s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [47:57<1:49:48, 74.03s/it]Best score increase :0.789 -> 0.791
training process:  31%|███▏      | 40/128 [49:16<1:50:46, 75.53s/it]Best score increase :0.791 -> 0.802
epoch : 41, train loss : 0.005, valid loss : 0.009, train acc : 0.936, valid acc : 0.930, train f1 : 0.823, valid f1 : 0.808
training process:  32%|███▏      | 41/128 [50:33<1:50:09, 75.98s/it]Best score increase :0.802 -> 0.808
training process:  33%|███▎      | 42/128 [51:44<1:46:43, 74.46s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [53:11<1:50:40, 78.12s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [54:42<1:54:36, 81.86s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.004, valid loss : 0.008, train acc : 0.940, valid acc : 0.917, train f1 : 0.832, valid f1 : 0.789
training process:  35%|███▌      | 45/128 [56:22<2:00:56, 87.43s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [57:51<2:00:10, 87.94s/it]Best score increase :0.808 -> 0.809
training process:  37%|███▋      | 47/128 [59:16<1:57:20, 86.92s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [1:00:47<1:57:26, 88.08s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.004, valid loss : 0.009, train acc : 0.941, valid acc : 0.929, train f1 : 0.836, valid f1 : 0.808
training process:  38%|███▊      | 49/128 [1:02:27<2:00:58, 91.88s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [1:03:42<1:52:55, 86.87s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [1:05:10<1:51:47, 87.11s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [1:06:37<1:50:22, 87.14s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.004, valid loss : 0.011, train acc : 0.947, valid acc : 0.926, train f1 : 0.848, valid f1 : 0.802
training process:  41%|████▏     | 53/128 [1:07:55<1:45:26, 84.35s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [1:08:59<1:36:35, 78.32s/it]EarlyStopping counter : 8 out of 12
training process:  43%|████▎     | 55/128 [1:10:31<1:40:12, 82.37s/it]Best score increase :0.809 -> 0.810
training process:  44%|████▍     | 56/128 [1:11:35<1:32:17, 76.91s/it]Best score increase :0.810 -> 0.813
epoch : 57, train loss : 0.004, valid loss : 0.009, train acc : 0.947, valid acc : 0.916, train f1 : 0.850, valid f1 : 0.789
training process:  45%|████▍     | 57/128 [1:12:57<1:32:43, 78.36s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [1:14:09<1:29:08, 76.41s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 59/128 [1:15:37<1:31:49, 79.84s/it]EarlyStopping counter : 3 out of 12
training process:  47%|████▋     | 60/128 [1:16:52<1:28:56, 78.48s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.004, valid loss : 0.010, train acc : 0.950, valid acc : 0.930, train f1 : 0.856, valid f1 : 0.810
training process:  48%|████▊     | 61/128 [1:18:11<1:27:38, 78.48s/it]EarlyStopping counter : 5 out of 12
training process:  48%|████▊     | 62/128 [1:19:25<1:24:53, 77.18s/it]Best score increase :0.813 -> 0.822
training process:  49%|████▉     | 63/128 [1:20:40<1:23:05, 76.70s/it]EarlyStopping counter : 1 out of 12
training process:  50%|█████     | 64/128 [1:21:54<1:20:52, 75.82s/it]EarlyStopping counter : 2 out of 12
epoch : 65, train loss : 0.004, valid loss : 0.012, train acc : 0.951, valid acc : 0.938, train f1 : 0.858, valid f1 : 0.821
training process:  51%|█████     | 65/128 [1:23:12<1:20:20, 76.52s/it]EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 66/128 [1:24:18<1:15:48, 73.36s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 67/128 [1:25:42<1:17:48, 76.53s/it]EarlyStopping counter : 5 out of 12
training process:  53%|█████▎    | 68/128 [1:27:08<1:19:24, 79.41s/it]EarlyStopping counter : 6 out of 12
epoch : 69, train loss : 0.004, valid loss : 0.012, train acc : 0.955, valid acc : 0.937, train f1 : 0.867, valid f1 : 0.823
training process:  54%|█████▍    | 69/128 [1:28:26<1:17:36, 78.93s/it]EarlyStopping counter : 7 out of 12
training process:  55%|█████▍    | 70/128 [1:29:52<1:18:18, 81.01s/it]EarlyStopping counter : 8 out of 12
training process:  55%|█████▌    | 71/128 [1:31:17<1:18:03, 82.16s/it]Best score increase :0.822 -> 0.830
training process:  56%|█████▋    | 72/128 [1:32:36<1:15:53, 81.31s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.004, valid loss : 0.011, train acc : 0.953, valid acc : 0.933, train f1 : 0.862, valid f1 : 0.814
training process:  57%|█████▋    | 73/128 [1:34:08<1:17:29, 84.53s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:35:38<1:17:30, 86.11s/it]Best score increase :0.830 -> 0.831
training process:  59%|█████▊    | 75/128 [1:37:03<1:15:44, 85.75s/it]EarlyStopping counter : 1 out of 12
training process:  59%|█████▉    | 76/128 [1:38:35<1:15:59, 87.68s/it]EarlyStopping counter : 2 out of 12
epoch : 77, train loss : 0.004, valid loss : 0.012, train acc : 0.956, valid acc : 0.922, train f1 : 0.870, valid f1 : 0.795
training process:  60%|██████    | 77/128 [1:40:08<1:15:56, 89.33s/it]EarlyStopping counter : 3 out of 12
training process:  61%|██████    | 78/128 [1:41:24<1:11:02, 85.26s/it]EarlyStopping counter : 4 out of 12
training process:  62%|██████▏   | 79/128 [1:42:24<1:03:19, 77.54s/it]EarlyStopping counter : 5 out of 12
training process:  62%|██████▎   | 80/128 [1:43:24<57:48, 72.26s/it]  EarlyStopping counter : 6 out of 12
epoch : 81, train loss : 0.004, valid loss : 0.013, train acc : 0.955, valid acc : 0.938, train f1 : 0.867, valid f1 : 0.824
training process:  63%|██████▎   | 81/128 [1:44:42<58:04, 74.14s/it]EarlyStopping counter : 7 out of 12
training process:  64%|██████▍   | 82/128 [1:45:47<54:41, 71.33s/it]EarlyStopping counter : 8 out of 12
training process:  65%|██████▍   | 83/128 [1:46:48<51:10, 68.24s/it]EarlyStopping counter : 9 out of 12
training process:  66%|██████▌   | 84/128 [1:47:57<50:17, 68.58s/it]EarlyStopping counter : 10 out of 12
epoch : 85, train loss : 0.004, valid loss : 0.014, train acc : 0.955, valid acc : 0.924, train f1 : 0.868, valid f1 : 0.799
training process:  66%|██████▋   | 85/128 [1:49:10<50:01, 69.79s/it]EarlyStopping counter : 11 out of 12
training process:  66%|██████▋   | 85/128 [1:50:18<55:48, 77.86s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 85, best f1 score : 0.831
training process finished, best loss : 0.012 and best acc : 0.943, best f1 : 0.831, best epoch : 73

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.76      0.67       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.86      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.86, test loss : 0.613

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:01, 11.02s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:40, 10.01s/it]processing for feature importance:  25%|██▌       | 3/12 [00:30<01:32, 10.29s/it]processing for feature importance:  33%|███▎      | 4/12 [00:41<01:23, 10.44s/it]processing for feature importance:  42%|████▏     | 5/12 [00:51<01:11, 10.16s/it]processing for feature importance:  50%|█████     | 6/12 [01:01<01:01, 10.27s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:12<00:51, 10.37s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:22<00:41, 10.26s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:32<00:31, 10.34s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:43<00:20, 10.30s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:53<00:10, 10.45s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.32s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.32s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 136.30it/s]  9%|▉         | 28/306 [00:00<00:02, 130.36it/s] 14%|█▎        | 42/306 [00:00<00:02, 130.54it/s] 18%|█▊        | 56/306 [00:00<00:02, 119.07it/s] 24%|██▍       | 74/306 [00:00<00:01, 133.98it/s] 29%|██▉       | 88/306 [00:00<00:01, 132.80it/s] 33%|███▎      | 102/306 [00:00<00:01, 118.93it/s] 40%|███▉      | 121/306 [00:00<00:01, 136.43it/s] 44%|████▍     | 136/306 [00:01<00:01, 130.79it/s] 49%|████▉     | 150/306 [00:01<00:01, 120.63it/s] 55%|█████▌    | 169/306 [00:01<00:01, 136.34it/s] 60%|██████    | 184/306 [00:01<00:00, 130.32it/s] 65%|██████▍   | 198/306 [00:01<00:00, 120.53it/s] 71%|███████   | 216/306 [00:01<00:00, 134.85it/s] 75%|███████▌  | 231/306 [00:01<00:00, 134.93it/s] 80%|████████  | 245/306 [00:01<00:00, 119.12it/s] 86%|████████▋ | 264/306 [00:02<00:00, 133.06it/s] 91%|█████████ | 278/306 [00:02<00:00, 132.74it/s] 95%|█████████▌| 292/306 [00:02<00:00, 118.58it/s]100%|██████████| 306/306 [00:02<00:00, 130.34it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 53/553 [00:00<00:00, 521.67it/s]extract the null data:  20%|█▉        | 109/553 [00:00<00:00, 539.33it/s]extract the null data:  29%|██▉       | 163/553 [00:00<00:00, 537.45it/s]extract the null data:  39%|███▉      | 217/553 [00:00<00:00, 529.46it/s]extract the null data:  49%|████▉     | 271/553 [00:00<00:00, 532.67it/s]extract the null data:  59%|█████▉    | 325/553 [00:00<00:00, 534.91it/s]extract the null data:  69%|██████▊   | 379/553 [00:00<00:00, 533.62it/s]extract the null data:  78%|███████▊  | 434/553 [00:00<00:00, 537.42it/s]extract the null data:  88%|████████▊ | 488/553 [00:00<00:00, 531.31it/s]extract the null data:  98%|█████████▊| 543/553 [00:01<00:00, 534.80it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 533.58it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 182.55it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 177.62it/s]replace nan value:  10%|█         | 58/553 [00:00<00:02, 183.97it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:02, 188.55it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 193.55it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 197.89it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 199.15it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:01, 204.79it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 209.17it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 212.26it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:01, 215.27it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 216.04it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 215.63it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 218.67it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:01, 217.04it/s]replace nan value:  62%|██████▏   | 341/553 [00:01<00:00, 215.57it/s]replace nan value:  66%|██████▌   | 363/553 [00:01<00:00, 199.05it/s]replace nan value:  69%|██████▉   | 384/553 [00:01<00:00, 189.21it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 184.44it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 184.07it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 184.29it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 181.68it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 177.62it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 173.56it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 174.24it/s]replace nan value:  97%|█████████▋| 536/553 [00:02<00:00, 180.21it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 194.29it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 134.91it/s]  5%|▌         | 29/553 [00:00<00:03, 138.14it/s]  8%|▊         | 43/553 [00:00<00:03, 129.32it/s] 10%|█         | 56/553 [00:00<00:04, 121.74it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.60it/s] 15%|█▌        | 84/553 [00:00<00:03, 120.64it/s] 18%|█▊        | 97/553 [00:00<00:03, 122.28it/s] 20%|██        | 111/553 [00:00<00:03, 127.37it/s] 22%|██▏       | 124/553 [00:00<00:03, 127.45it/s] 25%|██▌       | 139/553 [00:01<00:03, 133.24it/s] 28%|██▊       | 156/553 [00:01<00:02, 142.49it/s] 31%|███       | 171/553 [00:01<00:02, 141.58it/s] 34%|███▎      | 186/553 [00:01<00:02, 136.67it/s] 37%|███▋      | 202/553 [00:01<00:02, 142.06it/s] 39%|███▉      | 217/553 [00:01<00:02, 141.41it/s] 42%|████▏     | 232/553 [00:01<00:02, 135.85it/s] 44%|████▍     | 246/553 [00:01<00:02, 136.95it/s] 47%|████▋     | 261/553 [00:01<00:02, 139.76it/s] 50%|████▉     | 276/553 [00:02<00:02, 131.70it/s] 53%|█████▎    | 291/553 [00:02<00:01, 134.52it/s] 55%|█████▌    | 305/553 [00:02<00:01, 128.72it/s] 58%|█████▊    | 318/553 [00:02<00:01, 119.71it/s] 60%|██████    | 332/553 [00:02<00:01, 122.28it/s] 62%|██████▏   | 345/553 [00:02<00:01, 124.02it/s] 65%|██████▍   | 358/553 [00:02<00:01, 122.32it/s] 67%|██████▋   | 373/553 [00:02<00:01, 128.19it/s] 70%|██████▉   | 386/553 [00:02<00:01, 120.60it/s] 72%|███████▏  | 399/553 [00:03<00:01, 110.55it/s] 75%|███████▍  | 414/553 [00:03<00:01, 120.46it/s] 77%|███████▋  | 427/553 [00:03<00:01, 109.90it/s] 80%|███████▉  | 442/553 [00:03<00:00, 120.01it/s] 83%|████████▎ | 457/553 [00:03<00:00, 127.77it/s] 85%|████████▌ | 471/553 [00:03<00:00, 129.22it/s] 88%|████████▊ | 485/553 [00:03<00:00, 128.46it/s] 90%|█████████ | 499/553 [00:03<00:00, 119.61it/s] 93%|█████████▎| 513/553 [00:04<00:00, 124.13it/s] 95%|█████████▌| 526/553 [00:04<00:00, 112.28it/s] 97%|█████████▋| 538/553 [00:04<00:00, 111.00it/s]100%|█████████▉| 551/553 [00:04<00:00, 99.30it/s] 100%|██████████| 553/553 [00:04<00:00, 123.77it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 24/139 [00:00<00:00, 239.16it/s]extract the null data:  55%|█████▌    | 77/139 [00:00<00:00, 408.30it/s]extract the null data:  94%|█████████▎| 130/139 [00:00<00:00, 462.47it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 437.33it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 190.15it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 187.25it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 185.64it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 184.95it/s]replace nan value:  70%|██████▉   | 97/139 [00:00<00:00, 183.29it/s]replace nan value:  83%|████████▎ | 116/139 [00:00<00:00, 181.13it/s]replace nan value:  97%|█████████▋| 135/139 [00:00<00:00, 181.58it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 183.15it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 104.30it/s] 17%|█▋        | 23/139 [00:00<00:01, 112.55it/s] 27%|██▋       | 37/139 [00:00<00:00, 121.53it/s] 36%|███▌      | 50/139 [00:00<00:00, 119.27it/s] 45%|████▍     | 62/139 [00:00<00:00, 116.42it/s] 54%|█████▍    | 75/139 [00:00<00:00, 118.96it/s] 63%|██████▎   | 87/139 [00:00<00:00, 109.61it/s] 71%|███████   | 99/139 [00:00<00:00, 109.29it/s] 80%|███████▉  | 111/139 [00:00<00:00, 110.15it/s] 90%|████████▉ | 125/139 [00:01<00:00, 117.82it/s] 99%|█████████▉| 138/139 [00:01<00:00, 119.28it/s]100%|██████████| 139/139 [00:01<00:00, 116.07it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   9%|▊         | 15/173 [00:00<00:01, 148.88it/s]extract the null data:  39%|███▊      | 67/173 [00:00<00:00, 366.01it/s]extract the null data:  70%|██████▉   | 121/173 [00:00<00:00, 442.05it/s]extract the null data:  99%|█████████▉| 172/173 [00:00<00:00, 466.33it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 425.76it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 186.82it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 185.42it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 188.39it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 187.08it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 187.37it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 186.14it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 185.10it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 184.24it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 181.02it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 184.30it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 138.92it/s] 17%|█▋        | 29/173 [00:00<00:01, 120.38it/s] 26%|██▌       | 45/173 [00:00<00:00, 133.77it/s] 35%|███▌      | 61/173 [00:00<00:00, 142.55it/s] 44%|████▍     | 76/173 [00:00<00:00, 139.04it/s] 53%|█████▎    | 91/173 [00:00<00:00, 142.09it/s] 61%|██████▏   | 106/173 [00:00<00:00, 138.18it/s] 69%|██████▉   | 120/173 [00:00<00:00, 137.78it/s] 77%|███████▋  | 134/173 [00:00<00:00, 131.71it/s] 86%|████████▌ | 148/173 [00:01<00:00, 130.56it/s] 94%|█████████▎| 162/173 [00:01<00:00, 119.88it/s]100%|██████████| 173/173 [00:01<00:00, 121.02it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.013, train acc : 0.650, valid acc : 0.400, train f1 : 0.630, valid f1 : 0.363
training process:   1%|          | 1/128 [01:19<2:48:41, 79.69s/it]Best score increase :0.000 -> 0.363
training process:   2%|▏         | 2/128 [02:25<2:29:44, 71.30s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:26<2:18:54, 66.67s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [04:51<2:32:41, 73.88s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.015, train acc : 0.602, valid acc : 0.274, train f1 : 0.534, valid f1 : 0.265
training process:   4%|▍         | 5/128 [06:30<2:50:30, 83.18s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [07:59<2:53:07, 85.14s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [09:32<2:56:20, 87.44s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [10:49<2:48:16, 84.14s/it]EarlyStopping counter : 7 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.016, train acc : 0.672, valid acc : 0.379, train f1 : 0.635, valid f1 : 0.349
training process:   7%|▋         | 9/128 [12:15<2:48:21, 84.89s/it]EarlyStopping counter : 8 out of 12
training process:   8%|▊         | 10/128 [13:42<2:47:56, 85.39s/it]Best score increase :0.363 -> 0.421
training process:   9%|▊         | 11/128 [14:37<2:28:32, 76.18s/it]Best score increase :0.421 -> 0.422
training process:   9%|▉         | 12/128 [15:45<2:22:30, 73.71s/it]Best score increase :0.422 -> 0.449
epoch : 13, train loss : 0.002, valid loss : 0.013, train acc : 0.754, valid acc : 0.555, train f1 : 0.738, valid f1 : 0.474
training process:  10%|█         | 13/128 [17:21<2:34:09, 80.43s/it]Best score increase :0.449 -> 0.474
training process:  11%|█         | 14/128 [18:14<2:17:02, 72.12s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [19:05<2:04:13, 65.96s/it]Best score increase :0.474 -> 0.484
training process:  12%|█▎        | 16/128 [19:56<1:54:28, 61.33s/it]Best score increase :0.484 -> 0.511
epoch : 17, train loss : 0.002, valid loss : 0.013, train acc : 0.790, valid acc : 0.586, train f1 : 0.780, valid f1 : 0.495
training process:  13%|█▎        | 17/128 [21:14<2:02:54, 66.44s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [22:19<2:00:37, 65.80s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [23:08<1:50:44, 60.96s/it]Best score increase :0.511 -> 0.533
training process:  16%|█▌        | 20/128 [24:00<1:44:49, 58.24s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.013, train acc : 0.816, valid acc : 0.622, train f1 : 0.810, valid f1 : 0.521
training process:  16%|█▋        | 21/128 [25:07<1:48:19, 60.74s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [25:59<1:42:46, 58.17s/it]Best score increase :0.533 -> 0.564
training process:  18%|█▊        | 23/128 [26:50<1:37:59, 55.99s/it]Best score increase :0.564 -> 0.574
training process:  19%|█▉        | 24/128 [27:41<1:34:21, 54.44s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.010, train acc : 0.839, valid acc : 0.691, train f1 : 0.835, valid f1 : 0.570
training process:  20%|█▉        | 25/128 [28:43<1:37:18, 56.68s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [29:37<1:35:07, 55.96s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [30:31<1:33:10, 55.35s/it]Best score increase :0.574 -> 0.597
training process:  22%|██▏       | 28/128 [31:23<1:30:29, 54.29s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.011, train acc : 0.853, valid acc : 0.717, train f1 : 0.850, valid f1 : 0.591
training process:  23%|██▎       | 29/128 [32:28<1:35:02, 57.60s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [33:39<1:40:26, 61.49s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [34:44<1:41:26, 62.75s/it]Best score increase :0.597 -> 0.600
training process:  25%|██▌       | 32/128 [35:47<1:40:31, 62.83s/it]Best score increase :0.600 -> 0.604
epoch : 33, train loss : 0.002, valid loss : 0.010, train acc : 0.866, valid acc : 0.756, train f1 : 0.863, valid f1 : 0.621
training process:  26%|██▌       | 33/128 [37:14<1:50:43, 69.93s/it]Best score increase :0.604 -> 0.621
training process:  27%|██▋       | 34/128 [38:15<1:45:40, 67.45s/it]Best score increase :0.621 -> 0.623
training process:  27%|██▋       | 35/128 [39:14<1:40:26, 64.80s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [40:15<1:37:21, 63.49s/it]Best score increase :0.623 -> 0.631
epoch : 37, train loss : 0.002, valid loss : 0.010, train acc : 0.870, valid acc : 0.782, train f1 : 0.868, valid f1 : 0.643
training process:  29%|██▉       | 37/128 [41:34<1:43:23, 68.18s/it]Best score increase :0.631 -> 0.643
training process:  30%|██▉       | 38/128 [42:45<1:43:45, 69.18s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [43:50<1:40:35, 67.81s/it]Best score increase :0.643 -> 0.646
training process:  31%|███▏      | 40/128 [45:06<1:43:07, 70.31s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.001, valid loss : 0.011, train acc : 0.882, valid acc : 0.775, train f1 : 0.880, valid f1 : 0.637
training process:  32%|███▏      | 41/128 [46:23<1:44:59, 72.41s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [47:25<1:39:12, 69.21s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [48:20<1:32:12, 65.09s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [49:19<1:28:13, 63.01s/it]Best score increase :0.646 -> 0.649
epoch : 45, train loss : 0.001, valid loss : 0.011, train acc : 0.887, valid acc : 0.785, train f1 : 0.886, valid f1 : 0.645
training process:  35%|███▌      | 45/128 [50:30<1:30:50, 65.67s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [51:31<1:27:35, 64.09s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [52:34<1:26:09, 63.82s/it]EarlyStopping counter : 3 out of 12
training process:  38%|███▊      | 48/128 [53:36<1:24:20, 63.25s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.001, valid loss : 0.012, train acc : 0.896, valid acc : 0.775, train f1 : 0.894, valid f1 : 0.636
training process:  38%|███▊      | 49/128 [54:48<1:26:42, 65.85s/it]EarlyStopping counter : 5 out of 12
training process:  39%|███▉      | 50/128 [55:49<1:23:56, 64.57s/it]Best score increase :0.649 -> 0.673
training process:  40%|███▉      | 51/128 [56:47<1:20:19, 62.59s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [57:44<1:17:10, 60.93s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.001, valid loss : 0.011, train acc : 0.891, valid acc : 0.805, train f1 : 0.890, valid f1 : 0.662
training process:  41%|████▏     | 53/128 [58:54<1:19:30, 63.61s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [59:50<1:15:37, 61.32s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [1:00:43<1:11:20, 58.64s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [1:01:37<1:08:47, 57.33s/it]Best score increase :0.673 -> 0.695
epoch : 57, train loss : 0.001, valid loss : 0.011, train acc : 0.900, valid acc : 0.811, train f1 : 0.899, valid f1 : 0.669
training process:  45%|████▍     | 57/128 [1:02:38<1:09:06, 58.41s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [1:03:34<1:07:21, 57.74s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 59/128 [1:04:29<1:05:15, 56.75s/it]EarlyStopping counter : 3 out of 12
training process:  47%|████▋     | 60/128 [1:05:23<1:03:41, 56.20s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.001, valid loss : 0.011, train acc : 0.905, valid acc : 0.823, train f1 : 0.904, valid f1 : 0.678
training process:  48%|████▊     | 61/128 [1:06:27<1:05:14, 58.43s/it]EarlyStopping counter : 5 out of 12
training process:  48%|████▊     | 62/128 [1:07:26<1:04:24, 58.56s/it]EarlyStopping counter : 6 out of 12
training process:  49%|████▉     | 63/128 [1:08:19<1:01:46, 57.02s/it]EarlyStopping counter : 7 out of 12
training process:  50%|█████     | 64/128 [1:09:14<1:00:07, 56.37s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.011, train acc : 0.910, valid acc : 0.803, train f1 : 0.909, valid f1 : 0.662
training process:  51%|█████     | 65/128 [1:10:18<1:01:27, 58.53s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 66/128 [1:11:13<59:30, 57.58s/it]  EarlyStopping counter : 10 out of 12
training process:  52%|█████▏    | 67/128 [1:12:08<57:46, 56.83s/it]EarlyStopping counter : 11 out of 12
training process:  52%|█████▏    | 67/128 [1:12:58<1:06:26, 65.35s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 67, best f1 score : 0.695
training process finished, best loss : 0.008 and best acc : 0.838, best f1 : 0.695, best epoch : 55

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.34      0.89      0.49       580
           1       0.99      0.85      0.91      6818

    accuracy                           0.85      7398
   macro avg       0.66      0.87      0.70      7398
weighted avg       0.94      0.85      0.88      7398


# test acc : 0.85, test f1 : 0.70, test AUC : 0.87, test loss : 0.500

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.41s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.46s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.43s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.35s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.38s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.36s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.49s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:31,  7.85s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:23,  7.92s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.91s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.99s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.83s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.69s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 17/306 [00:00<00:01, 169.35it/s] 12%|█▏        | 36/306 [00:00<00:01, 177.75it/s] 19%|█▉        | 58/306 [00:00<00:01, 187.85it/s] 25%|██▌       | 77/306 [00:00<00:01, 149.47it/s] 32%|███▏      | 97/306 [00:00<00:01, 161.03it/s] 37%|███▋      | 114/306 [00:00<00:01, 150.52it/s] 42%|████▏     | 130/306 [00:00<00:01, 141.96it/s] 51%|█████▏    | 157/306 [00:00<00:00, 176.43it/s] 58%|█████▊    | 176/306 [00:01<00:00, 166.84it/s] 63%|██████▎   | 194/306 [00:01<00:00, 146.58it/s] 71%|███████   | 218/306 [00:01<00:00, 165.35it/s] 77%|███████▋  | 237/306 [00:01<00:00, 171.58it/s] 83%|████████▎ | 255/306 [00:01<00:00, 147.59it/s] 91%|█████████ | 279/306 [00:01<00:00, 167.26it/s] 97%|█████████▋| 297/306 [00:01<00:00, 156.99it/s]100%|██████████| 306/306 [00:01<00:00, 155.51it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 465.80it/s]extract the null data:  17%|█▋        | 95/553 [00:00<00:00, 469.04it/s]extract the null data:  26%|██▌       | 144/553 [00:00<00:00, 475.12it/s]extract the null data:  35%|███▍      | 192/553 [00:00<00:00, 474.43it/s]extract the null data:  43%|████▎     | 240/553 [00:00<00:00, 467.34it/s]extract the null data:  52%|█████▏    | 287/553 [00:00<00:00, 464.87it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 462.57it/s]extract the null data:  69%|██████▉   | 381/553 [00:00<00:00, 462.04it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 461.37it/s]extract the null data:  86%|████████▌ | 475/553 [00:01<00:00, 462.10it/s]extract the null data:  94%|█████████▍| 522/553 [00:01<00:00, 460.45it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 463.03it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 164.80it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.78it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 171.69it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 172.03it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 172.44it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 174.63it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 175.70it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 179.29it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:02, 181.50it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 183.04it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:01, 183.30it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 184.03it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 184.09it/s]replace nan value:  47%|████▋     | 258/553 [00:01<00:01, 183.53it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 182.04it/s]replace nan value:  54%|█████▎    | 296/553 [00:01<00:01, 180.51it/s]replace nan value:  57%|█████▋    | 315/553 [00:01<00:01, 178.96it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 179.18it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:01, 179.21it/s]replace nan value:  67%|██████▋   | 369/553 [00:02<00:01, 179.19it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:00, 178.78it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 180.78it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 181.02it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 184.04it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 186.40it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 186.57it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 187.37it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 186.58it/s]replace nan value:  98%|█████████▊| 541/553 [00:02<00:00, 186.00it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 181.04it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.35it/s]  5%|▌         | 29/553 [00:00<00:03, 139.88it/s]  8%|▊         | 43/553 [00:00<00:03, 131.91it/s] 10%|█         | 57/553 [00:00<00:04, 123.28it/s] 13%|█▎        | 70/553 [00:00<00:04, 116.18it/s] 16%|█▌        | 87/553 [00:00<00:03, 130.65it/s] 18%|█▊        | 101/553 [00:00<00:03, 126.05it/s] 22%|██▏       | 119/553 [00:00<00:03, 140.67it/s] 24%|██▍       | 134/553 [00:01<00:03, 138.00it/s] 27%|██▋       | 151/553 [00:01<00:02, 146.12it/s] 31%|███       | 169/553 [00:01<00:02, 155.32it/s] 33%|███▎      | 185/553 [00:01<00:02, 151.87it/s] 37%|███▋      | 202/553 [00:01<00:02, 155.59it/s] 39%|███▉      | 218/553 [00:01<00:02, 153.94it/s] 42%|████▏     | 234/553 [00:01<00:02, 148.68it/s] 45%|████▌     | 249/553 [00:01<00:02, 145.48it/s] 48%|████▊     | 265/553 [00:01<00:01, 145.61it/s] 51%|█████     | 280/553 [00:01<00:01, 138.55it/s] 53%|█████▎    | 294/553 [00:02<00:01, 134.42it/s] 56%|█████▌    | 308/553 [00:02<00:01, 131.07it/s] 58%|█████▊    | 322/553 [00:02<00:01, 128.10it/s] 61%|██████    | 336/553 [00:02<00:01, 130.70it/s] 63%|██████▎   | 350/553 [00:02<00:01, 129.49it/s] 66%|██████▌   | 363/553 [00:02<00:01, 126.19it/s] 68%|██████▊   | 378/553 [00:02<00:01, 131.22it/s] 71%|███████   | 392/553 [00:02<00:01, 122.82it/s] 73%|███████▎  | 405/553 [00:02<00:01, 123.72it/s] 76%|███████▌  | 418/553 [00:03<00:01, 121.73it/s] 78%|███████▊  | 431/553 [00:03<00:01, 119.53it/s] 81%|████████  | 449/553 [00:03<00:00, 135.53it/s] 84%|████████▍ | 464/553 [00:03<00:00, 137.43it/s] 86%|████████▋ | 478/553 [00:03<00:00, 135.82it/s] 89%|████████▉ | 492/553 [00:03<00:00, 129.86it/s] 92%|█████████▏| 506/553 [00:03<00:00, 127.42it/s] 94%|█████████▍| 521/553 [00:03<00:00, 128.34it/s] 97%|█████████▋| 534/553 [00:04<00:00, 114.89it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.14it/s]100%|██████████| 553/553 [00:04<00:00, 130.92it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  34%|███▍      | 47/139 [00:00<00:00, 464.60it/s]extract the null data:  80%|███████▉  | 111/139 [00:00<00:00, 566.36it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 570.37it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 217.90it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 220.95it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 216.46it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 212.78it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 211.12it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 212.23it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 213.81it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.88it/s] 17%|█▋        | 24/139 [00:00<00:00, 120.65it/s] 28%|██▊       | 39/139 [00:00<00:00, 131.12it/s] 38%|███▊      | 53/139 [00:00<00:00, 124.84it/s] 48%|████▊     | 67/139 [00:00<00:00, 123.77it/s] 58%|█████▊    | 80/139 [00:00<00:00, 120.29it/s] 67%|██████▋   | 93/139 [00:00<00:00, 110.52it/s] 77%|███████▋  | 107/139 [00:00<00:00, 117.30it/s] 89%|████████▉ | 124/139 [00:01<00:00, 130.58it/s]100%|██████████| 139/139 [00:01<00:00, 134.58it/s]100%|██████████| 139/139 [00:01<00:00, 125.57it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 269.95it/s]extract the null data:  50%|████▉     | 86/173 [00:00<00:00, 455.22it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 519.18it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 495.64it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 201.59it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 210.28it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 206.19it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 204.80it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 209.63it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 209.95it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 206.18it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 199.94it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 204.33it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 137.29it/s] 16%|█▌        | 28/173 [00:00<00:01, 117.13it/s] 24%|██▍       | 42/173 [00:00<00:01, 124.25it/s] 33%|███▎      | 57/173 [00:00<00:00, 131.05it/s] 41%|████      | 71/173 [00:00<00:00, 129.94it/s] 49%|████▉     | 85/173 [00:00<00:00, 127.59it/s] 57%|█████▋    | 99/173 [00:00<00:00, 129.06it/s] 67%|██████▋   | 116/173 [00:00<00:00, 138.83it/s] 75%|███████▌  | 130/173 [00:00<00:00, 131.46it/s] 83%|████████▎ | 144/173 [00:01<00:00, 128.24it/s] 91%|█████████ | 157/173 [00:01<00:00, 117.31it/s] 98%|█████████▊| 169/173 [00:01<00:00, 96.00it/s] 100%|██████████| 173/173 [00:01<00:00, 114.16it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.008, train f1 : 0.547, valid f1 : 0.578
training process - Deferred Re-weighting:   1%|          | 1/128 [01:06<2:20:03, 66.17s/it]Best score increase :0.000 -> 0.578
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:00<2:04:11, 59.14s/it]Best score increase :0.578 -> 0.616
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:53<1:57:28, 56.39s/it]Best score increase :0.616 -> 0.645
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:43<1:50:58, 53.70s/it]Best score increase :0.645 -> 0.672
epoch : 5, train loss : 0.004, valid loss : 0.004, train f1 : 0.692, valid f1 : 0.672
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:41<1:53:37, 55.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:32<1:49:52, 54.03s/it]Best score increase :0.672 -> 0.714
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:24<1:47:09, 53.14s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:17<1:46:29, 53.24s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.004, train f1 : 0.735, valid f1 : 0.726
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:20<1:51:18, 56.12s/it]Best score increase :0.714 -> 0.726
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:12<1:48:14, 55.04s/it]Best score increase :0.726 -> 0.728
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:06<1:46:24, 54.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:59<1:44:45, 54.19s/it]Best score increase :0.728 -> 0.750
epoch : 13, train loss : 0.003, valid loss : 0.003, train f1 : 0.771, valid f1 : 0.751
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:01<1:48:25, 56.57s/it]Best score increase :0.750 -> 0.751
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:55<1:45:42, 55.64s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:45<1:41:52, 54.10s/it]Best score increase :0.751 -> 0.757
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:36<1:38:59, 53.03s/it]Best score increase :0.757 -> 0.764
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.802, valid f1 : 0.781
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:37<1:43:00, 55.68s/it]Best score increase :0.764 -> 0.781
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:28<1:39:16, 54.15s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:19<1:36:42, 53.23s/it]Best score increase :0.781 -> 0.787
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:10<1:34:26, 52.47s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train f1 : 0.819, valid f1 : 0.798
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:06<1:35:43, 53.68s/it]Best score increase :0.787 -> 0.798
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:56<1:32:34, 52.40s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:47<1:31:14, 52.14s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:38<1:29:32, 51.66s/it]Best score increase :0.798 -> 0.805
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.835, valid f1 : 0.821
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:35<1:31:28, 53.28s/it]Best score increase :0.805 -> 0.821
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:26<1:29:30, 52.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:16<1:27:28, 51.96s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:04<1:24:22, 50.62s/it]Best score increase :0.821 -> 0.828
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.861, valid f1 : 0.817
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:04<1:28:19, 53.53s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:54<1:25:45, 52.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:44<1:23:36, 51.72s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:36<1:22:50, 51.77s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.867, valid f1 : 0.815
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:36<1:25:57, 54.29s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [30:28<1:24:00, 53.63s/it]Best score increase :0.828 -> 0.835
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:21<1:22:32, 53.25s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [32:16<1:22:32, 53.83s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.877, valid f1 : 0.826
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:18<1:25:23, 56.30s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [34:09<1:22:10, 54.79s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [35:02<1:20:21, 54.18s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:53<1:18:08, 53.27s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.880, valid f1 : 0.832
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:52<1:19:35, 54.90s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [37:43<1:17:08, 53.82s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [38:33<1:14:44, 52.76s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [39:23<1:12:34, 51.84s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.890, valid f1 : 0.836
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [40:23<1:15:01, 54.23s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:17<1:16:09, 55.06s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.836
training process finished, best loss : 0.004, best acc : 0.957, best f1 : 0.836, best epoch : 43

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.79      0.64      0.71       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.88      0.81      0.84      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.81, test loss : 0.159

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.60s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.47s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:09,  7.69s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.69s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.78s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.72s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:29,  7.50s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.60s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.53s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.46s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.41s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.56s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 218.46it/s] 14%|█▍        | 44/306 [00:00<00:01, 202.61it/s] 21%|██        | 65/306 [00:00<00:01, 197.96it/s] 28%|██▊       | 85/306 [00:00<00:01, 187.89it/s] 34%|███▍      | 104/306 [00:00<00:01, 183.45it/s] 40%|████      | 123/306 [00:00<00:01, 178.10it/s] 46%|████▌     | 141/306 [00:00<00:00, 174.54it/s] 53%|█████▎    | 161/306 [00:00<00:00, 176.78it/s] 59%|█████▉    | 180/306 [00:00<00:00, 176.74it/s] 65%|██████▌   | 199/306 [00:01<00:00, 179.85it/s] 72%|███████▏  | 219/306 [00:01<00:00, 184.82it/s] 78%|███████▊  | 238/306 [00:01<00:00, 180.82it/s] 84%|████████▍ | 257/306 [00:01<00:00, 177.41it/s] 90%|████████▉ | 275/306 [00:01<00:00, 174.98it/s] 97%|█████████▋| 296/306 [00:01<00:00, 179.65it/s]100%|██████████| 306/306 [00:01<00:00, 183.05it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:00, 506.89it/s]extract the null data:  18%|█▊        | 102/553 [00:00<00:00, 506.58it/s]extract the null data:  28%|██▊       | 155/553 [00:00<00:00, 515.40it/s]extract the null data:  38%|███▊      | 209/553 [00:00<00:00, 524.41it/s]extract the null data:  47%|████▋     | 262/553 [00:00<00:00, 519.58it/s]extract the null data:  58%|█████▊    | 321/553 [00:00<00:00, 541.01it/s]extract the null data:  69%|██████▉   | 381/553 [00:00<00:00, 557.22it/s]extract the null data:  79%|███████▉  | 439/553 [00:00<00:00, 562.36it/s]extract the null data:  90%|████████▉ | 496/553 [00:00<00:00, 553.70it/s]extract the null data: 100%|█████████▉| 552/553 [00:01<00:00, 550.63it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 541.23it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 192.83it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 189.11it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 190.14it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 188.95it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 191.41it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 188.56it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 186.97it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 194.59it/s]replace nan value:  33%|███▎      | 181/553 [00:00<00:01, 192.46it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:01, 192.20it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 193.01it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 191.02it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 188.74it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 188.70it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 187.35it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:01, 190.21it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 190.28it/s]replace nan value:  65%|██████▍   | 359/553 [00:01<00:01, 191.29it/s]replace nan value:  69%|██████▊   | 379/553 [00:01<00:00, 192.55it/s]replace nan value:  72%|███████▏  | 399/553 [00:02<00:00, 189.35it/s]replace nan value:  76%|███████▌  | 418/553 [00:02<00:00, 188.98it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 186.51it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 190.61it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 187.73it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 189.74it/s]replace nan value:  94%|█████████▎| 518/553 [00:02<00:00, 192.40it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 191.64it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 189.97it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 134.18it/s]  5%|▌         | 29/553 [00:00<00:03, 141.11it/s]  8%|▊         | 44/553 [00:00<00:03, 130.88it/s] 10%|█         | 58/553 [00:00<00:04, 122.02it/s] 13%|█▎        | 71/553 [00:00<00:03, 121.08it/s] 16%|█▌        | 89/553 [00:00<00:03, 136.57it/s] 19%|█▉        | 104/553 [00:00<00:03, 139.37it/s] 22%|██▏       | 122/553 [00:00<00:02, 149.04it/s] 25%|██▌       | 141/553 [00:00<00:02, 159.60it/s] 29%|██▉       | 162/553 [00:01<00:02, 171.30it/s] 33%|███▎      | 181/553 [00:01<00:02, 173.47it/s] 36%|███▋      | 201/553 [00:01<00:01, 179.88it/s] 40%|███▉      | 220/553 [00:01<00:01, 172.59it/s] 43%|████▎     | 239/553 [00:01<00:01, 175.70it/s] 46%|████▋     | 257/553 [00:01<00:01, 169.92it/s] 50%|████▉     | 275/553 [00:01<00:01, 168.22it/s] 53%|█████▎    | 292/553 [00:01<00:01, 164.60it/s] 56%|█████▌    | 309/553 [00:01<00:01, 156.47it/s] 59%|█████▉    | 325/553 [00:02<00:01, 154.93it/s] 62%|██████▏   | 341/553 [00:02<00:01, 154.19it/s] 65%|██████▍   | 357/553 [00:02<00:01, 147.11it/s] 68%|██████▊   | 374/553 [00:02<00:01, 152.21it/s] 71%|███████   | 390/553 [00:02<00:01, 133.80it/s] 73%|███████▎  | 405/553 [00:02<00:01, 135.09it/s] 76%|███████▌  | 419/553 [00:02<00:00, 134.55it/s] 78%|███████▊  | 433/553 [00:02<00:00, 132.40it/s] 82%|████████▏ | 452/553 [00:02<00:00, 147.65it/s] 85%|████████▍ | 469/553 [00:03<00:00, 150.88it/s] 88%|████████▊ | 485/553 [00:03<00:00, 146.89it/s] 90%|█████████ | 500/553 [00:03<00:00, 134.70it/s] 93%|█████████▎| 517/553 [00:03<00:00, 142.72it/s] 96%|█████████▌| 532/553 [00:03<00:00, 121.39it/s] 99%|█████████▉| 549/553 [00:03<00:00, 132.75it/s]100%|██████████| 553/553 [00:03<00:00, 144.65it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 40/139 [00:00<00:00, 395.28it/s]extract the null data:  79%|███████▉  | 110/139 [00:00<00:00, 571.46it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 574.65it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 241.29it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 233.58it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 231.76it/s]replace nan value:  71%|███████   | 98/139 [00:00<00:00, 232.05it/s]replace nan value:  88%|████████▊ | 122/139 [00:00<00:00, 231.14it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 233.38it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 126.34it/s] 21%|██        | 29/139 [00:00<00:00, 137.26it/s] 32%|███▏      | 45/139 [00:00<00:00, 145.91it/s] 43%|████▎     | 60/139 [00:00<00:00, 132.14it/s] 54%|█████▍    | 75/139 [00:00<00:00, 133.83it/s] 64%|██████▍   | 89/139 [00:00<00:00, 118.12it/s] 75%|███████▍  | 104/139 [00:00<00:00, 126.33it/s] 85%|████████▍ | 118/139 [00:00<00:00, 128.25it/s] 95%|█████████▍| 132/139 [00:01<00:00, 125.17it/s]100%|██████████| 139/139 [00:01<00:00, 130.56it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  28%|██▊       | 48/173 [00:00<00:00, 474.55it/s]extract the null data:  70%|██████▉   | 121/173 [00:00<00:00, 619.15it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 613.03it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 222.10it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 228.86it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 233.27it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 232.54it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 233.82it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 230.57it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 227.61it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 229.39it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 147.80it/s] 17%|█▋        | 30/173 [00:00<00:01, 130.47it/s] 27%|██▋       | 47/173 [00:00<00:00, 145.98it/s] 37%|███▋      | 64/173 [00:00<00:00, 153.52it/s] 46%|████▌     | 80/173 [00:00<00:00, 140.62it/s] 55%|█████▍    | 95/173 [00:00<00:00, 137.49it/s] 63%|██████▎   | 109/173 [00:00<00:00, 137.36it/s] 71%|███████   | 123/173 [00:00<00:00, 129.60it/s] 79%|███████▉  | 137/173 [00:01<00:00, 127.26it/s] 87%|████████▋ | 150/173 [00:01<00:00, 125.49it/s] 94%|█████████▍| 163/173 [00:01<00:00, 120.94it/s]100%|██████████| 173/173 [00:01<00:00, 121.96it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.010, train f1 : 0.695, valid f1 : 0.577
training process - Deferred Re-weighting:   1%|          | 1/128 [01:01<2:11:06, 61.94s/it]Best score increase :0.000 -> 0.577
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:55<1:59:59, 57.14s/it]Best score increase :0.577 -> 0.617
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:46<1:53:13, 54.34s/it]Best score increase :0.617 -> 0.663
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:37<1:49:31, 52.99s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.008, valid loss : 0.008, train f1 : 0.807, valid f1 : 0.683
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:37<1:53:59, 55.61s/it]Best score increase :0.663 -> 0.683
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:31<1:51:20, 54.76s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:29<1:52:46, 55.92s/it]Best score increase :0.683 -> 0.686
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:25<1:51:43, 55.86s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.007, valid loss : 0.008, train f1 : 0.846, valid f1 : 0.682
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:31<1:57:36, 59.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:33<1:58:11, 60.10s/it]Best score increase :0.686 -> 0.709
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:36<1:58:48, 60.93s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:32<1:54:42, 59.34s/it]Best score increase :0.709 -> 0.720
epoch : 13, train loss : 0.006, valid loss : 0.006, train f1 : 0.879, valid f1 : 0.728
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:34<1:55:15, 60.14s/it]Best score increase :0.720 -> 0.728
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:34<1:54:23, 60.21s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:26<1:48:34, 57.65s/it]Best score increase :0.728 -> 0.732
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:18<1:44:31, 55.99s/it]Best score increase :0.732 -> 0.741
epoch : 17, train loss : 0.005, valid loss : 0.006, train f1 : 0.896, valid f1 : 0.727
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [16:22<1:47:59, 58.37s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [17:15<1:43:54, 56.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [18:10<1:42:05, 56.20s/it]Best score increase :0.741 -> 0.743
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [19:02<1:38:49, 54.90s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.006, train f1 : 0.909, valid f1 : 0.718
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [20:03<1:41:24, 56.87s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:56<1:38:16, 55.63s/it]Best score increase :0.743 -> 0.777
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:55<1:39:21, 56.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:48<1:36:10, 55.49s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.005, train f1 : 0.919, valid f1 : 0.760
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:51<1:39:20, 57.87s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:44<1:35:55, 56.42s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:39<1:34:02, 55.87s/it]Best score increase :0.777 -> 0.779
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [26:40<1:35:34, 57.34s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.005, train f1 : 0.930, valid f1 : 0.768
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [28:01<1:46:26, 64.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [29:15<1:49:53, 67.28s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [30:31<1:53:12, 70.03s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [31:31<1:47:26, 67.15s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.003, valid loss : 0.004, train f1 : 0.932, valid f1 : 0.784
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [32:41<1:47:27, 67.87s/it]Best score increase :0.779 -> 0.784
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [33:28<1:36:35, 61.65s/it]Best score increase :0.784 -> 0.796
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [34:12<1:27:10, 56.24s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [34:56<1:20:42, 52.64s/it]Best score increase :0.796 -> 0.805
epoch : 37, train loss : 0.003, valid loss : 0.004, train f1 : 0.933, valid f1 : 0.816
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [35:47<1:19:06, 52.16s/it]Best score increase :0.805 -> 0.816
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [36:31<1:14:35, 49.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [37:16<1:11:34, 48.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [38:00<1:08:52, 46.96s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.005, train f1 : 0.943, valid f1 : 0.781
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [38:52<1:10:31, 48.63s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [39:41<1:09:40, 48.61s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [40:30<1:09:06, 48.79s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [41:19<1:08:23, 48.85s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.005, train f1 : 0.945, valid f1 : 0.794
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [42:20<1:12:45, 52.60s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [43:13<1:11:58, 52.67s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [44:07<1:11:25, 52.91s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [45:00<1:10:45, 53.07s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.003, valid loss : 0.005, train f1 : 0.948, valid f1 : 0.757
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:02<1:16:43, 57.54s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.816
training process finished, best loss : 0.004, best acc : 0.934, best f1 : 0.816, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.79      0.64       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.87      0.80      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.87, test loss : 0.215

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.49s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.31s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.41s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<01:00,  7.50s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.53s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.59s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:38,  7.66s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:31,  7.76s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:23,  7.82s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.86s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.81s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.77s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.68s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 111.00it/s]  8%|▊         | 24/306 [00:00<00:02, 103.84it/s] 14%|█▍        | 43/306 [00:00<00:01, 134.94it/s] 19%|█▊        | 57/306 [00:00<00:01, 136.18it/s] 23%|██▎       | 71/306 [00:00<00:02, 113.66it/s] 31%|███▏      | 96/306 [00:00<00:01, 152.37it/s] 37%|███▋      | 113/306 [00:00<00:01, 142.86it/s] 42%|████▏     | 129/306 [00:01<00:01, 122.50it/s] 48%|████▊     | 148/306 [00:01<00:01, 135.80it/s] 54%|█████▎    | 164/306 [00:01<00:01, 141.07it/s] 58%|█████▊    | 179/306 [00:01<00:01, 122.05it/s] 66%|██████▌   | 201/306 [00:01<00:00, 141.83it/s] 71%|███████   | 217/306 [00:01<00:00, 134.04it/s] 76%|███████▌  | 232/306 [00:01<00:00, 125.43it/s] 82%|████████▏ | 250/306 [00:01<00:00, 137.51it/s] 87%|████████▋ | 266/306 [00:01<00:00, 139.30it/s] 92%|█████████▏| 281/306 [00:02<00:00, 125.38it/s] 99%|█████████▉| 303/306 [00:02<00:00, 144.70it/s]100%|██████████| 306/306 [00:02<00:00, 134.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 448.85it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 451.09it/s]extract the null data:  25%|██▌       | 139/553 [00:00<00:00, 462.32it/s]extract the null data:  35%|███▍      | 192/553 [00:00<00:00, 485.85it/s]extract the null data:  44%|████▍     | 242/553 [00:00<00:00, 488.11it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 457.89it/s]extract the null data:  62%|██████▏   | 341/553 [00:00<00:00, 469.08it/s]extract the null data:  71%|███████   | 390/553 [00:00<00:00, 472.63it/s]extract the null data:  79%|███████▉  | 438/553 [00:00<00:00, 465.99it/s]extract the null data:  88%|████████▊ | 488/553 [00:01<00:00, 473.92it/s]extract the null data:  97%|█████████▋| 536/553 [00:01<00:00, 468.36it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 471.84it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 193.30it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 182.74it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 178.60it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 179.00it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:02, 175.26it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 179.29it/s]replace nan value:  24%|██▍       | 133/553 [00:00<00:02, 180.25it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 176.93it/s]replace nan value:  31%|███       | 170/553 [00:00<00:02, 177.78it/s]replace nan value:  34%|███▍      | 188/553 [00:01<00:02, 176.95it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:01, 175.90it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 181.07it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 177.71it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 172.98it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 171.93it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 176.25it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 180.66it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 181.68it/s]replace nan value:  65%|██████▍   | 358/553 [00:02<00:01, 177.73it/s]replace nan value:  68%|██████▊   | 376/553 [00:02<00:01, 175.61it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:00, 171.98it/s]replace nan value:  75%|███████▍  | 412/553 [00:02<00:00, 171.93it/s]replace nan value:  78%|███████▊  | 431/553 [00:02<00:00, 175.26it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 177.44it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 175.36it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 177.29it/s]replace nan value:  91%|█████████▏| 505/553 [00:02<00:00, 174.46it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 174.28it/s]replace nan value:  98%|█████████▊| 541/553 [00:03<00:00, 174.10it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 176.42it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 10/553 [00:00<00:05, 98.20it/s]  4%|▍         | 24/553 [00:00<00:04, 120.51it/s]  7%|▋         | 38/553 [00:00<00:04, 127.73it/s]  9%|▉         | 51/553 [00:00<00:04, 107.04it/s] 11%|█▏        | 63/553 [00:00<00:04, 100.32it/s] 13%|█▎        | 74/553 [00:00<00:04, 101.37it/s] 16%|█▌        | 87/553 [00:00<00:04, 109.57it/s] 18%|█▊        | 99/553 [00:00<00:04, 104.74it/s] 21%|██        | 114/553 [00:01<00:03, 117.03it/s] 23%|██▎       | 126/553 [00:01<00:03, 112.34it/s] 26%|██▌       | 142/553 [00:01<00:03, 123.98it/s] 29%|██▊       | 158/553 [00:01<00:02, 131.71it/s] 31%|███       | 172/553 [00:01<00:02, 132.54it/s] 34%|███▎      | 186/553 [00:01<00:02, 126.49it/s] 36%|███▌      | 200/553 [00:01<00:02, 129.73it/s] 39%|███▊      | 214/553 [00:01<00:02, 131.53it/s] 41%|████      | 228/553 [00:01<00:02, 125.84it/s] 44%|████▎     | 241/553 [00:02<00:02, 125.56it/s] 46%|████▌     | 254/553 [00:02<00:02, 119.96it/s] 48%|████▊     | 267/553 [00:02<00:02, 120.87it/s] 51%|█████     | 280/553 [00:02<00:02, 117.37it/s] 53%|█████▎    | 293/553 [00:02<00:02, 115.61it/s] 55%|█████▌    | 306/553 [00:02<00:02, 114.58it/s] 58%|█████▊    | 318/553 [00:02<00:02, 115.94it/s] 60%|██████    | 332/553 [00:02<00:01, 119.91it/s] 63%|██████▎   | 346/553 [00:02<00:01, 124.50it/s] 65%|██████▍   | 359/553 [00:03<00:01, 119.68it/s] 68%|██████▊   | 375/553 [00:03<00:01, 128.42it/s] 70%|███████   | 388/553 [00:03<00:01, 120.91it/s] 73%|███████▎  | 401/553 [00:03<00:01, 114.41it/s] 75%|███████▌  | 415/553 [00:03<00:01, 120.59it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.11it/s] 80%|████████  | 445/553 [00:03<00:00, 127.28it/s] 83%|████████▎ | 460/553 [00:03<00:00, 131.83it/s] 86%|████████▌ | 474/553 [00:03<00:00, 133.51it/s] 88%|████████▊ | 488/553 [00:04<00:00, 128.10it/s] 91%|█████████ | 501/553 [00:04<00:00, 122.38it/s] 93%|█████████▎| 517/553 [00:04<00:00, 130.89it/s] 96%|█████████▌| 531/553 [00:04<00:00, 109.30it/s] 99%|█████████▉| 547/553 [00:04<00:00, 119.22it/s]100%|██████████| 553/553 [00:04<00:00, 118.34it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 23/139 [00:00<00:00, 227.30it/s]extract the null data:  56%|█████▌    | 78/139 [00:00<00:00, 413.83it/s]extract the null data:  99%|█████████▊| 137/139 [00:00<00:00, 493.74it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 454.29it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 183.18it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 187.59it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 186.92it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 188.93it/s]replace nan value:  70%|██████▉   | 97/139 [00:00<00:00, 188.93it/s]replace nan value:  84%|████████▍ | 117/139 [00:00<00:00, 191.40it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 189.88it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 189.06it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.21it/s] 17%|█▋        | 24/139 [00:00<00:01, 114.81it/s] 29%|██▉       | 41/139 [00:00<00:00, 138.81it/s] 40%|███▉      | 55/139 [00:00<00:00, 132.51it/s] 50%|█████     | 70/139 [00:00<00:00, 137.73it/s] 60%|██████    | 84/139 [00:00<00:00, 131.45it/s] 71%|███████   | 98/139 [00:00<00:00, 126.70it/s] 80%|███████▉  | 111/139 [00:00<00:00, 125.97it/s] 91%|█████████ | 126/139 [00:00<00:00, 132.84it/s]100%|██████████| 139/139 [00:01<00:00, 131.95it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 208.94it/s]extract the null data:  42%|████▏     | 72/173 [00:00<00:00, 384.78it/s]extract the null data:  72%|███████▏  | 124/173 [00:00<00:00, 445.14it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 441.50it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 194.75it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 188.11it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 187.50it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 186.52it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 190.50it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 188.00it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 194.62it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 194.02it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 190.07it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.66it/s] 16%|█▌        | 27/173 [00:00<00:01, 113.21it/s] 24%|██▎       | 41/173 [00:00<00:01, 123.08it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.14it/s] 39%|███▉      | 68/173 [00:00<00:00, 127.38it/s] 47%|████▋     | 82/173 [00:00<00:00, 130.08it/s] 55%|█████▌    | 96/173 [00:00<00:00, 128.59it/s] 64%|██████▎   | 110/173 [00:00<00:00, 130.63it/s] 72%|███████▏  | 124/173 [00:00<00:00, 123.63it/s] 79%|███████▉  | 137/173 [00:01<00:00, 123.92it/s] 87%|████████▋ | 150/173 [00:01<00:00, 119.03it/s] 94%|█████████▎| 162/173 [00:01<00:00, 114.14it/s]100%|██████████| 173/173 [00:01<00:00, 113.60it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.627, valid loss : 0.452, train acc : 0.647, valid acc : 0.924, train f1 : 0.498, valid f1 : 0.677
training process:   1%|          | 1/128 [01:34<3:19:47, 94.39s/it]Best score increase :0.000 -> 0.677
training process:   2%|▏         | 2/128 [03:05<3:14:00, 92.38s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [04:34<3:09:32, 90.98s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [05:55<2:59:34, 86.89s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.201, valid loss : 0.207, train acc : 0.937, valid acc : 0.934, train f1 : 0.698, valid f1 : 0.684
training process:   4%|▍         | 5/128 [07:33<3:06:40, 91.06s/it]Best score increase :0.677 -> 0.684
training process:   5%|▍         | 6/128 [09:09<3:08:21, 92.63s/it]Best score increase :0.684 -> 0.705
training process:   5%|▌         | 7/128 [10:37<3:03:54, 91.19s/it]Best score increase :0.705 -> 0.707
training process:   6%|▋         | 8/128 [12:03<2:59:01, 89.51s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.170, valid loss : 0.189, train acc : 0.942, valid acc : 0.935, train f1 : 0.735, valid f1 : 0.697
training process:   7%|▋         | 9/128 [13:24<2:51:54, 86.67s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [14:24<2:34:26, 78.53s/it]Best score increase :0.707 -> 0.715
training process:   9%|▊         | 11/128 [15:26<2:23:16, 73.48s/it]Best score increase :0.715 -> 0.722
training process:   9%|▉         | 12/128 [16:24<2:12:48, 68.70s/it]Best score increase :0.722 -> 0.726
epoch : 13, train loss : 0.156, valid loss : 0.183, train acc : 0.947, valid acc : 0.937, train f1 : 0.764, valid f1 : 0.724
training process:  10%|█         | 13/128 [17:36<2:13:32, 69.68s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [18:39<2:08:39, 67.72s/it]Best score increase :0.726 -> 0.741
training process:  12%|█▏        | 15/128 [19:41<2:04:26, 66.08s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [20:43<2:00:53, 64.76s/it]Best score increase :0.741 -> 0.743
epoch : 17, train loss : 0.147, valid loss : 0.173, train acc : 0.950, valid acc : 0.939, train f1 : 0.781, valid f1 : 0.740
training process:  13%|█▎        | 17/128 [21:55<2:04:08, 67.11s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [22:58<2:00:30, 65.73s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [24:04<1:59:31, 65.80s/it]Best score increase :0.743 -> 0.748
training process:  16%|█▌        | 20/128 [25:06<1:56:15, 64.59s/it]Best score increase :0.748 -> 0.762
epoch : 21, train loss : 0.137, valid loss : 0.171, train acc : 0.953, valid acc : 0.942, train f1 : 0.799, valid f1 : 0.747
training process:  16%|█▋        | 21/128 [26:18<1:59:35, 67.06s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [27:21<1:56:20, 65.85s/it]Best score increase :0.762 -> 0.770
training process:  18%|█▊        | 23/128 [28:25<1:54:06, 65.20s/it]Best score increase :0.770 -> 0.772
training process:  19%|█▉        | 24/128 [29:26<1:50:47, 63.92s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.128, valid loss : 0.166, train acc : 0.956, valid acc : 0.945, train f1 : 0.819, valid f1 : 0.779
training process:  20%|█▉        | 25/128 [30:39<1:54:25, 66.66s/it]Best score increase :0.772 -> 0.779
training process:  20%|██        | 26/128 [31:43<1:51:45, 65.74s/it]Best score increase :0.779 -> 0.780
training process:  21%|██        | 27/128 [32:46<1:49:35, 65.10s/it]Best score increase :0.780 -> 0.785
training process:  22%|██▏       | 28/128 [33:44<1:44:53, 62.94s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.120, valid loss : 0.168, train acc : 0.958, valid acc : 0.944, train f1 : 0.830, valid f1 : 0.770
training process:  23%|██▎       | 29/128 [34:58<1:49:08, 66.15s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [36:04<1:48:05, 66.18s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [37:12<1:48:01, 66.82s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [38:20<1:47:10, 66.98s/it]Best score increase :0.785 -> 0.799
epoch : 33, train loss : 0.115, valid loss : 0.157, train acc : 0.960, valid acc : 0.950, train f1 : 0.839, valid f1 : 0.803
training process:  26%|██▌       | 33/128 [39:34<1:49:29, 69.15s/it]Best score increase :0.799 -> 0.803
training process:  27%|██▋       | 34/128 [40:33<1:43:46, 66.24s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [41:32<1:39:04, 63.92s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [42:27<1:34:05, 61.37s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.109, valid loss : 0.159, train acc : 0.962, valid acc : 0.950, train f1 : 0.850, valid f1 : 0.807
training process:  29%|██▉       | 37/128 [43:35<1:35:51, 63.21s/it]Best score increase :0.803 -> 0.807
training process:  30%|██▉       | 38/128 [44:36<1:33:42, 62.48s/it]Best score increase :0.807 -> 0.814
training process:  30%|███       | 39/128 [45:43<1:34:57, 64.01s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [46:58<1:38:34, 67.21s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.103, valid loss : 0.157, train acc : 0.963, valid acc : 0.951, train f1 : 0.855, valid f1 : 0.811
training process:  32%|███▏      | 41/128 [48:22<1:45:01, 72.43s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [49:37<1:44:46, 73.10s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [50:39<1:38:51, 69.78s/it]Best score increase :0.814 -> 0.818
training process:  34%|███▍      | 44/128 [51:42<1:34:57, 67.83s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.100, valid loss : 0.154, train acc : 0.964, valid acc : 0.951, train f1 : 0.861, valid f1 : 0.809
training process:  35%|███▌      | 45/128 [53:02<1:38:38, 71.30s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [54:06<1:34:28, 69.13s/it]EarlyStopping counter : 3 out of 12
training process:  37%|███▋      | 47/128 [54:59<1:27:01, 64.46s/it]EarlyStopping counter : 4 out of 12
training process:  38%|███▊      | 48/128 [55:52<1:21:09, 60.87s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.094, valid loss : 0.159, train acc : 0.966, valid acc : 0.949, train f1 : 0.870, valid f1 : 0.804
training process:  38%|███▊      | 49/128 [56:53<1:20:07, 60.86s/it]EarlyStopping counter : 6 out of 12
training process:  39%|███▉      | 50/128 [57:47<1:16:26, 58.80s/it]EarlyStopping counter : 7 out of 12
training process:  40%|███▉      | 51/128 [58:41<1:13:36, 57.36s/it]EarlyStopping counter : 8 out of 12
training process:  41%|████      | 52/128 [59:33<1:10:36, 55.75s/it]EarlyStopping counter : 9 out of 12
epoch : 53, train loss : 0.092, valid loss : 0.155, train acc : 0.967, valid acc : 0.952, train f1 : 0.874, valid f1 : 0.822
training process:  41%|████▏     | 53/128 [1:00:36<1:12:32, 58.03s/it]Best score increase :0.818 -> 0.822
training process:  42%|████▏     | 54/128 [1:01:31<1:10:16, 56.97s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [1:02:25<1:08:27, 56.26s/it]Best score increase :0.822 -> 0.824
training process:  44%|████▍     | 56/128 [1:03:20<1:06:53, 55.74s/it]EarlyStopping counter : 1 out of 12
epoch : 57, train loss : 0.091, valid loss : 0.151, train acc : 0.969, valid acc : 0.953, train f1 : 0.879, valid f1 : 0.823
training process:  45%|████▍     | 57/128 [1:04:23<1:08:32, 57.93s/it]EarlyStopping counter : 2 out of 12
training process:  45%|████▌     | 58/128 [1:05:18<1:06:33, 57.05s/it]EarlyStopping counter : 3 out of 12
training process:  46%|████▌     | 59/128 [1:06:15<1:05:34, 57.02s/it]EarlyStopping counter : 4 out of 12
training process:  47%|████▋     | 60/128 [1:07:12<1:04:52, 57.24s/it]EarlyStopping counter : 5 out of 12
epoch : 61, train loss : 0.089, valid loss : 0.154, train acc : 0.969, valid acc : 0.954, train f1 : 0.881, valid f1 : 0.827
training process:  48%|████▊     | 61/128 [1:08:16<1:06:08, 59.23s/it]Best score increase :0.824 -> 0.827
training process:  48%|████▊     | 62/128 [1:09:10<1:03:16, 57.53s/it]EarlyStopping counter : 1 out of 12
training process:  49%|████▉     | 63/128 [1:10:04<1:01:19, 56.61s/it]Best score increase :0.827 -> 0.829
training process:  50%|█████     | 64/128 [1:10:57<59:03, 55.37s/it]  Best score increase :0.829 -> 0.836
epoch : 65, train loss : 0.087, valid loss : 0.164, train acc : 0.969, valid acc : 0.952, train f1 : 0.882, valid f1 : 0.823
training process:  51%|█████     | 65/128 [1:11:59<1:00:11, 57.32s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:12:53<58:21, 56.48s/it]  EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:13:47<56:40, 55.75s/it]EarlyStopping counter : 3 out of 12
training process:  53%|█████▎    | 68/128 [1:14:41<55:15, 55.26s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.085, valid loss : 0.160, train acc : 0.970, valid acc : 0.954, train f1 : 0.887, valid f1 : 0.833
training process:  54%|█████▍    | 69/128 [1:15:44<56:33, 57.51s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▍    | 70/128 [1:16:38<54:28, 56.35s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▌    | 71/128 [1:17:33<53:18, 56.11s/it]Best score increase :0.836 -> 0.839
training process:  56%|█████▋    | 72/128 [1:18:29<52:12, 55.93s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.082, valid loss : 0.158, train acc : 0.972, valid acc : 0.953, train f1 : 0.892, valid f1 : 0.824
training process:  57%|█████▋    | 73/128 [1:19:32<53:12, 58.05s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:20:28<51:44, 57.50s/it]Best score increase :0.839 -> 0.842
training process:  59%|█████▊    | 75/128 [1:21:23<50:06, 56.74s/it]EarlyStopping counter : 1 out of 12
training process:  59%|█████▉    | 76/128 [1:22:17<48:35, 56.07s/it]EarlyStopping counter : 2 out of 12
epoch : 77, train loss : 0.082, valid loss : 0.159, train acc : 0.972, valid acc : 0.954, train f1 : 0.893, valid f1 : 0.831
training process:  60%|██████    | 77/128 [1:23:20<49:21, 58.06s/it]EarlyStopping counter : 3 out of 12
training process:  61%|██████    | 78/128 [1:24:16<47:44, 57.29s/it]EarlyStopping counter : 4 out of 12
training process:  62%|██████▏   | 79/128 [1:25:12<46:35, 57.05s/it]EarlyStopping counter : 5 out of 12
training process:  62%|██████▎   | 80/128 [1:26:07<45:03, 56.33s/it]EarlyStopping counter : 6 out of 12
epoch : 81, train loss : 0.078, valid loss : 0.159, train acc : 0.971, valid acc : 0.956, train f1 : 0.891, valid f1 : 0.836
training process:  63%|██████▎   | 81/128 [1:27:13<46:23, 59.23s/it]EarlyStopping counter : 7 out of 12
training process:  64%|██████▍   | 82/128 [1:28:09<44:40, 58.28s/it]EarlyStopping counter : 8 out of 12
training process:  65%|██████▍   | 83/128 [1:29:07<43:38, 58.19s/it]EarlyStopping counter : 9 out of 12
training process:  66%|██████▌   | 84/128 [1:30:04<42:20, 57.73s/it]EarlyStopping counter : 10 out of 12
epoch : 85, train loss : 0.079, valid loss : 0.158, train acc : 0.972, valid acc : 0.954, train f1 : 0.895, valid f1 : 0.828
training process:  66%|██████▋   | 85/128 [1:31:07<42:36, 59.46s/it]EarlyStopping counter : 11 out of 12
training process:  66%|██████▋   | 85/128 [1:31:59<46:32, 64.93s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 85, best f1 score : 0.842
training process finished, best loss : 0.154 and best acc : 0.956, best f1 : 0.842, best epoch : 81

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.76      0.65      0.70       580
           1       0.97      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.87      0.82      0.84      7398
weighted avg       0.95      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.84, test AUC : 0.82, test loss : 8.500

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.75s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.69s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.68s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.84s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:56,  8.00s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.76s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.67s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.69s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.90s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.98s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:08,  8.04s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  8.17s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.93s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 107.96it/s] 10%|█         | 32/306 [00:00<00:01, 156.73it/s] 16%|█▌        | 49/306 [00:00<00:01, 155.48it/s] 21%|██        | 65/306 [00:00<00:01, 129.33it/s] 28%|██▊       | 85/306 [00:00<00:01, 146.25it/s] 33%|███▎      | 102/306 [00:00<00:01, 150.56it/s] 39%|███▊      | 118/306 [00:00<00:01, 130.38it/s] 46%|████▌     | 140/306 [00:00<00:01, 151.97it/s] 51%|█████▏    | 157/306 [00:01<00:00, 153.89it/s] 57%|█████▋    | 173/306 [00:01<00:01, 130.92it/s] 63%|██████▎   | 194/306 [00:01<00:00, 148.69it/s] 69%|██████▊   | 210/306 [00:01<00:00, 148.05it/s] 74%|███████▍  | 226/306 [00:01<00:00, 128.30it/s] 80%|████████  | 245/306 [00:01<00:00, 139.37it/s] 85%|████████▌ | 261/306 [00:01<00:00, 143.75it/s] 90%|█████████ | 276/306 [00:01<00:00, 125.97it/s] 97%|█████████▋| 298/306 [00:02<00:00, 147.39it/s]100%|██████████| 306/306 [00:02<00:00, 142.31it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 592.94it/s]extract the null data:  22%|██▏       | 122/553 [00:00<00:00, 604.53it/s]extract the null data:  34%|███▎      | 186/553 [00:00<00:00, 619.14it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 630.77it/s]extract the null data:  57%|█████▋    | 317/553 [00:00<00:00, 640.48it/s]extract the null data:  69%|██████▉   | 382/553 [00:00<00:00, 639.09it/s]extract the null data:  81%|████████  | 446/553 [00:00<00:00, 633.08it/s]extract the null data:  92%|█████████▏| 510/553 [00:00<00:00, 631.93it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 626.46it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 202.94it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 205.21it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 207.48it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 208.03it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 212.56it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 212.95it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:01, 210.90it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:01, 210.08it/s]replace nan value:  35%|███▌      | 196/553 [00:00<00:01, 210.48it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 213.50it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 211.61it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 212.42it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 213.85it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 212.08it/s]replace nan value:  60%|█████▉    | 330/553 [00:01<00:01, 214.76it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:00, 215.61it/s]replace nan value:  68%|██████▊   | 374/553 [00:01<00:00, 215.08it/s]replace nan value:  72%|███████▏  | 396/553 [00:01<00:00, 213.41it/s]replace nan value:  76%|███████▌  | 418/553 [00:01<00:00, 212.94it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 214.77it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 214.75it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 214.23it/s]replace nan value:  92%|█████████▏| 506/553 [00:02<00:00, 212.72it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 212.93it/s]replace nan value:  99%|█████████▉| 550/553 [00:02<00:00, 211.01it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 211.82it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 144.87it/s]  6%|▌         | 32/553 [00:00<00:03, 156.83it/s]  9%|▊         | 48/553 [00:00<00:03, 128.48it/s] 11%|█         | 62/553 [00:00<00:03, 128.07it/s] 14%|█▍        | 77/553 [00:00<00:03, 132.53it/s] 17%|█▋        | 93/553 [00:00<00:03, 135.91it/s] 20%|█▉        | 109/553 [00:00<00:03, 140.95it/s] 23%|██▎       | 125/553 [00:00<00:02, 143.45it/s] 26%|██▌       | 143/553 [00:00<00:02, 153.95it/s] 29%|██▉       | 162/553 [00:01<00:02, 163.00it/s] 33%|███▎      | 180/553 [00:01<00:02, 166.97it/s] 36%|███▌      | 197/553 [00:01<00:02, 166.80it/s] 39%|███▉      | 216/553 [00:01<00:01, 171.57it/s] 42%|████▏     | 234/553 [00:01<00:01, 159.67it/s] 45%|████▌     | 251/553 [00:01<00:01, 157.87it/s] 48%|████▊     | 267/553 [00:01<00:01, 151.05it/s] 51%|█████     | 283/553 [00:01<00:01, 146.87it/s] 54%|█████▍    | 298/553 [00:01<00:01, 144.04it/s] 57%|█████▋    | 313/553 [00:02<00:01, 141.34it/s] 59%|█████▉    | 328/553 [00:02<00:01, 140.20it/s] 62%|██████▏   | 344/553 [00:02<00:01, 145.49it/s] 65%|██████▍   | 359/553 [00:02<00:01, 134.94it/s] 68%|██████▊   | 376/553 [00:02<00:01, 141.18it/s] 71%|███████   | 391/553 [00:02<00:01, 131.95it/s] 73%|███████▎  | 405/553 [00:02<00:01, 132.65it/s] 76%|███████▌  | 419/553 [00:02<00:01, 131.68it/s] 78%|███████▊  | 433/553 [00:03<00:00, 130.83it/s] 82%|████████▏ | 453/553 [00:03<00:00, 144.80it/s] 85%|████████▍ | 470/553 [00:03<00:00, 149.96it/s] 88%|████████▊ | 486/553 [00:03<00:00, 148.51it/s] 91%|█████████ | 501/553 [00:03<00:00, 138.10it/s] 94%|█████████▎| 518/553 [00:03<00:00, 144.29it/s] 96%|█████████▋| 533/553 [00:03<00:00, 123.63it/s]100%|█████████▉| 551/553 [00:03<00:00, 117.01it/s]100%|██████████| 553/553 [00:03<00:00, 141.04it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 357.52it/s]extract the null data:  78%|███████▊  | 109/139 [00:00<00:00, 574.80it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 576.43it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 240.91it/s]replace nan value:  37%|███▋      | 51/139 [00:00<00:00, 247.05it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 248.15it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 240.06it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 240.26it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 242.19it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 134.10it/s] 22%|██▏       | 30/139 [00:00<00:00, 144.44it/s] 34%|███▍      | 47/139 [00:00<00:00, 154.64it/s] 45%|████▌     | 63/139 [00:00<00:00, 140.79it/s] 56%|█████▌    | 78/139 [00:00<00:00, 135.76it/s] 66%|██████▌   | 92/139 [00:00<00:00, 128.32it/s] 76%|███████▋  | 106/139 [00:00<00:00, 129.30it/s] 88%|████████▊ | 123/139 [00:00<00:00, 140.10it/s] 99%|█████████▉| 138/139 [00:00<00:00, 140.22it/s]100%|██████████| 139/139 [00:01<00:00, 138.72it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  28%|██▊       | 49/173 [00:00<00:00, 484.22it/s]extract the null data:  71%|███████   | 123/173 [00:00<00:00, 631.49it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 635.66it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 249.52it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 244.88it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 246.47it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 242.22it/s]replace nan value:  72%|███████▏  | 125/173 [00:00<00:00, 240.10it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 239.36it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 241.49it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 146.97it/s] 17%|█▋        | 30/173 [00:00<00:01, 133.19it/s] 27%|██▋       | 47/173 [00:00<00:00, 148.63it/s] 37%|███▋      | 64/173 [00:00<00:00, 154.69it/s] 46%|████▌     | 80/173 [00:00<00:00, 147.44it/s] 55%|█████▌    | 96/173 [00:00<00:00, 150.11it/s] 65%|██████▌   | 113/173 [00:00<00:00, 155.82it/s] 75%|███████▍  | 129/173 [00:00<00:00, 154.87it/s] 84%|████████▍ | 145/173 [00:00<00:00, 152.62it/s] 93%|█████████▎| 161/173 [00:01<00:00, 140.55it/s]100%|██████████| 173/173 [00:01<00:00, 136.23it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.550, valid loss : 0.483, train acc : 0.717, valid acc : 0.803, train f1 : 0.714, valid f1 : 0.633
training process:   1%|          | 1/128 [01:36<3:24:24, 96.57s/it]Best score increase :0.000 -> 0.633
training process:   2%|▏         | 2/128 [02:42<2:44:57, 78.55s/it]Best score increase :0.633 -> 0.670
training process:   2%|▏         | 3/128 [04:00<2:43:17, 78.38s/it]Best score increase :0.670 -> 0.679
training process:   3%|▎         | 4/128 [05:25<2:46:55, 80.77s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.396, valid loss : 0.358, train acc : 0.825, valid acc : 0.874, train f1 : 0.825, valid f1 : 0.712
training process:   4%|▍         | 5/128 [06:47<2:46:55, 81.43s/it]Best score increase :0.679 -> 0.712
training process:   5%|▍         | 6/128 [08:08<2:44:47, 81.05s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [09:33<2:46:08, 82.39s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [10:57<2:45:50, 82.92s/it]EarlyStopping counter : 3 out of 12
epoch : 9, train loss : 0.347, valid loss : 0.356, train acc : 0.846, valid acc : 0.852, train f1 : 0.846, valid f1 : 0.688
training process:   7%|▋         | 9/128 [12:22<2:45:36, 83.50s/it]EarlyStopping counter : 4 out of 12
training process:   8%|▊         | 10/128 [13:40<2:41:27, 82.10s/it]EarlyStopping counter : 5 out of 12
training process:   9%|▊         | 11/128 [15:01<2:39:05, 81.58s/it]Best score increase :0.712 -> 0.726
training process:   9%|▉         | 12/128 [16:15<2:33:09, 79.22s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.310, valid loss : 0.314, train acc : 0.868, valid acc : 0.878, train f1 : 0.868, valid f1 : 0.723
training process:  10%|█         | 13/128 [17:29<2:29:10, 77.83s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [18:29<2:17:38, 72.44s/it]Best score increase :0.726 -> 0.730
training process:  12%|█▏        | 15/128 [19:29<2:09:17, 68.65s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [20:30<2:04:00, 66.43s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.273, valid loss : 0.324, train acc : 0.887, valid acc : 0.863, train f1 : 0.887, valid f1 : 0.708
training process:  13%|█▎        | 17/128 [21:40<2:04:21, 67.22s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [22:40<1:59:41, 65.29s/it]Best score increase :0.730 -> 0.746
training process:  15%|█▍        | 19/128 [23:38<1:54:19, 62.93s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [24:39<1:52:12, 62.34s/it]Best score increase :0.746 -> 0.761
epoch : 21, train loss : 0.245, valid loss : 0.259, train acc : 0.899, valid acc : 0.902, train f1 : 0.899, valid f1 : 0.756
training process:  16%|█▋        | 21/128 [25:48<1:54:57, 64.47s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [26:48<1:51:37, 63.18s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [27:49<1:49:09, 62.37s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [28:49<1:47:06, 61.79s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.230, valid loss : 0.276, train acc : 0.907, valid acc : 0.896, train f1 : 0.907, valid f1 : 0.756
training process:  20%|█▉        | 25/128 [29:57<1:49:11, 63.61s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [30:58<1:46:38, 62.73s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [31:53<1:42:00, 60.60s/it]Best score increase :0.761 -> 0.763
training process:  22%|██▏       | 28/128 [32:52<1:39:50, 59.90s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.207, valid loss : 0.264, train acc : 0.917, valid acc : 0.904, train f1 : 0.917, valid f1 : 0.769
training process:  23%|██▎       | 29/128 [33:58<1:42:04, 61.86s/it]Best score increase :0.763 -> 0.769
training process:  23%|██▎       | 30/128 [34:58<1:40:06, 61.29s/it]Best score increase :0.769 -> 0.786
training process:  24%|██▍       | 31/128 [35:57<1:37:47, 60.49s/it]Best score increase :0.786 -> 0.794
training process:  25%|██▌       | 32/128 [36:57<1:36:32, 60.34s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.204, valid loss : 0.227, train acc : 0.917, valid acc : 0.921, train f1 : 0.917, valid f1 : 0.797
training process:  26%|██▌       | 33/128 [38:06<1:39:44, 62.99s/it]Best score increase :0.794 -> 0.797
training process:  27%|██▋       | 34/128 [39:07<1:37:54, 62.50s/it]Best score increase :0.797 -> 0.805
training process:  27%|██▋       | 35/128 [40:03<1:33:55, 60.59s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [41:00<1:31:09, 59.45s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.191, valid loss : 0.219, train acc : 0.926, valid acc : 0.923, train f1 : 0.926, valid f1 : 0.797
training process:  29%|██▉       | 37/128 [42:09<1:34:34, 62.35s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [43:06<1:30:53, 60.60s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [44:04<1:28:42, 59.80s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [45:02<1:27:08, 59.42s/it]Best score increase :0.805 -> 0.807
epoch : 41, train loss : 0.181, valid loss : 0.250, train acc : 0.930, valid acc : 0.908, train f1 : 0.930, valid f1 : 0.777
training process:  32%|███▏      | 41/128 [46:10<1:29:42, 61.87s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [47:08<1:27:04, 60.74s/it]Best score increase :0.807 -> 0.808
training process:  34%|███▎      | 43/128 [48:06<1:25:05, 60.06s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [49:02<1:22:01, 58.58s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.174, valid loss : 0.223, train acc : 0.935, valid acc : 0.910, train f1 : 0.935, valid f1 : 0.778
training process:  35%|███▌      | 45/128 [50:00<1:20:50, 58.44s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [50:52<1:17:22, 56.61s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [51:46<1:15:31, 55.95s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [52:45<1:15:30, 56.63s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.169, valid loss : 0.213, train acc : 0.933, valid acc : 0.923, train f1 : 0.933, valid f1 : 0.799
training process:  38%|███▊      | 49/128 [53:52<1:18:38, 59.72s/it]EarlyStopping counter : 7 out of 12
training process:  39%|███▉      | 50/128 [54:50<1:16:59, 59.22s/it]Best score increase :0.808 -> 0.815
training process:  40%|███▉      | 51/128 [55:48<1:15:38, 58.94s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [56:46<1:14:26, 58.77s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.156, valid loss : 0.256, train acc : 0.938, valid acc : 0.903, train f1 : 0.938, valid f1 : 0.774
training process:  41%|████▏     | 53/128 [57:46<1:13:47, 59.03s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [58:38<1:10:20, 57.03s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [59:30<1:07:32, 55.51s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [1:00:29<1:07:47, 56.49s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.159, valid loss : 0.220, train acc : 0.936, valid acc : 0.924, train f1 : 0.936, valid f1 : 0.798
training process:  45%|████▍     | 57/128 [1:01:36<1:10:38, 59.70s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [1:02:35<1:09:29, 59.57s/it]EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [1:03:33<1:07:45, 58.92s/it]EarlyStopping counter : 9 out of 12
training process:  47%|████▋     | 60/128 [1:04:31<1:06:20, 58.54s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.158, valid loss : 0.225, train acc : 0.938, valid acc : 0.925, train f1 : 0.938, valid f1 : 0.801
training process:  48%|████▊     | 61/128 [1:05:33<1:06:36, 59.65s/it]EarlyStopping counter : 11 out of 12
training process:  48%|████▊     | 61/128 [1:06:25<1:12:57, 65.33s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.815
training process finished, best loss : 0.190 and best acc : 0.933, best f1 : 0.815, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.63      0.78      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.80      0.87      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.87, test loss : 10.106

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.46s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.41s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.38s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.35s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.44s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.43s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.37s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:29,  7.33s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:22,  7.42s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:15,  7.55s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.47s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:02, 135.59it/s] 10%|█         | 31/306 [00:00<00:01, 139.90it/s] 15%|█▌        | 46/306 [00:00<00:01, 139.54it/s] 20%|██        | 62/306 [00:00<00:01, 141.96it/s] 25%|██▌       | 78/306 [00:00<00:01, 146.76it/s] 30%|███       | 93/306 [00:00<00:01, 144.18it/s] 35%|███▌      | 108/306 [00:00<00:01, 142.44it/s] 40%|████      | 123/306 [00:00<00:01, 142.31it/s] 45%|████▌     | 138/306 [00:00<00:01, 141.42it/s] 50%|█████     | 153/306 [00:01<00:01, 141.24it/s] 55%|█████▍    | 168/306 [00:01<00:00, 140.32it/s] 60%|█████▉    | 183/306 [00:01<00:00, 139.79it/s] 64%|██████▍   | 197/306 [00:01<00:00, 138.18it/s] 69%|██████▉   | 211/306 [00:01<00:00, 138.14it/s] 74%|███████▍  | 227/306 [00:01<00:00, 140.02it/s] 79%|███████▉  | 243/306 [00:01<00:00, 141.64it/s] 84%|████████▍ | 258/306 [00:01<00:00, 140.25it/s] 90%|████████▉ | 274/306 [00:01<00:00, 141.21it/s] 94%|█████████▍| 289/306 [00:02<00:00, 140.52it/s]100%|█████████▉| 305/306 [00:02<00:00, 142.03it/s]100%|██████████| 306/306 [00:02<00:00, 141.19it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 572.48it/s]extract the null data:  21%|██        | 117/553 [00:00<00:00, 580.51it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 587.24it/s]extract the null data:  43%|████▎     | 237/553 [00:00<00:00, 591.24it/s]extract the null data:  54%|█████▎    | 297/553 [00:00<00:00, 590.97it/s]extract the null data:  65%|██████▍   | 357/553 [00:00<00:00, 591.39it/s]extract the null data:  75%|███████▌  | 417/553 [00:00<00:00, 590.22it/s]extract the null data:  86%|████████▋ | 477/553 [00:00<00:00, 589.92it/s]extract the null data:  97%|█████████▋| 536/553 [00:00<00:00, 574.94it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 583.04it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 190.55it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 193.49it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 192.07it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 193.02it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 195.09it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 196.57it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 197.63it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:01, 199.06it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 199.50it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:01, 199.94it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 199.11it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 198.95it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 202.21it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 201.81it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 200.94it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:01, 201.23it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:01, 200.35it/s]replace nan value:  67%|██████▋   | 369/553 [00:01<00:00, 199.69it/s]replace nan value:  70%|███████   | 389/553 [00:01<00:00, 198.75it/s]replace nan value:  74%|███████▍  | 410/553 [00:02<00:00, 199.86it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 197.88it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 199.53it/s]replace nan value:  85%|████████▌ | 472/553 [00:02<00:00, 201.05it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 204.02it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 204.84it/s]replace nan value:  97%|█████████▋| 537/553 [00:02<00:00, 207.73it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 200.52it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 141.22it/s]  6%|▌         | 31/553 [00:00<00:03, 149.99it/s]  8%|▊         | 47/553 [00:00<00:04, 126.10it/s] 11%|█         | 61/553 [00:00<00:04, 122.39it/s] 14%|█▎        | 76/553 [00:00<00:03, 130.06it/s] 16%|█▋        | 91/553 [00:00<00:03, 132.99it/s] 19%|█▉        | 106/553 [00:00<00:03, 136.05it/s] 22%|██▏       | 122/553 [00:00<00:03, 139.58it/s] 25%|██▌       | 139/553 [00:01<00:02, 147.19it/s] 29%|██▊       | 158/553 [00:01<00:02, 158.17it/s] 31%|███▏      | 174/553 [00:01<00:02, 157.33it/s] 35%|███▍      | 191/553 [00:01<00:02, 159.18it/s] 38%|███▊      | 210/553 [00:01<00:02, 163.57it/s] 41%|████      | 227/553 [00:01<00:02, 155.42it/s] 44%|████▍     | 243/553 [00:01<00:02, 152.79it/s] 47%|████▋     | 259/553 [00:01<00:01, 152.01it/s] 50%|████▉     | 275/553 [00:01<00:01, 150.80it/s] 53%|█████▎    | 291/553 [00:01<00:01, 151.31it/s] 56%|█████▌    | 307/553 [00:02<00:01, 141.91it/s] 58%|█████▊    | 322/553 [00:02<00:01, 141.94it/s] 61%|██████    | 338/553 [00:02<00:01, 146.10it/s] 64%|██████▍   | 353/553 [00:02<00:01, 146.86it/s] 67%|██████▋   | 368/553 [00:02<00:01, 145.29it/s] 70%|██████▉   | 385/553 [00:02<00:01, 145.94it/s] 72%|███████▏  | 400/553 [00:02<00:01, 131.03it/s] 75%|███████▌  | 415/553 [00:02<00:01, 135.00it/s] 78%|███████▊  | 429/553 [00:03<00:01, 122.98it/s] 81%|████████  | 447/553 [00:03<00:00, 136.77it/s] 84%|████████▎ | 462/553 [00:03<00:00, 138.85it/s] 86%|████████▋ | 477/553 [00:03<00:00, 140.39it/s] 89%|████████▉ | 492/553 [00:03<00:00, 127.27it/s] 92%|█████████▏| 506/553 [00:03<00:00, 124.10it/s] 94%|█████████▍| 520/553 [00:03<00:00, 127.40it/s] 96%|█████████▋| 533/553 [00:03<00:00, 111.66it/s] 99%|█████████▉| 549/553 [00:03<00:00, 122.30it/s]100%|██████████| 553/553 [00:04<00:00, 136.05it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 335.22it/s]extract the null data:  64%|██████▍   | 89/139 [00:00<00:00, 460.64it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 483.62it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 190.95it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 192.54it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 192.14it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 189.57it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 190.19it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 189.03it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 190.00it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.00it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.52it/s] 27%|██▋       | 38/139 [00:00<00:00, 124.58it/s] 37%|███▋      | 51/139 [00:00<00:00, 119.85it/s] 46%|████▌     | 64/139 [00:00<00:00, 120.41it/s] 55%|█████▌    | 77/139 [00:00<00:00, 116.35it/s] 64%|██████▍   | 89/139 [00:00<00:00, 104.98it/s] 74%|███████▍  | 103/139 [00:00<00:00, 112.84it/s] 83%|████████▎ | 115/139 [00:01<00:00, 112.99it/s] 92%|█████████▏| 128/139 [00:01<00:00, 116.03it/s]100%|██████████| 139/139 [00:01<00:00, 116.08it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 309.34it/s]extract the null data:  50%|████▉     | 86/173 [00:00<00:00, 448.91it/s]extract the null data:  81%|████████  | 140/173 [00:00<00:00, 488.63it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 474.14it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 185.21it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 188.21it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 187.80it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 186.41it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 187.01it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 182.90it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 182.93it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 183.20it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 180.43it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 183.40it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.84it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.37it/s] 23%|██▎       | 40/173 [00:00<00:01, 118.04it/s] 32%|███▏      | 55/173 [00:00<00:00, 126.26it/s] 39%|███▉      | 68/173 [00:00<00:00, 126.35it/s] 47%|████▋     | 81/173 [00:00<00:00, 126.21it/s] 54%|█████▍    | 94/173 [00:00<00:00, 127.30it/s] 62%|██████▏   | 107/173 [00:00<00:00, 125.99it/s] 69%|██████▉   | 120/173 [00:00<00:00, 125.03it/s] 77%|███████▋  | 133/173 [00:01<00:00, 118.49it/s] 84%|████████▍ | 146/173 [00:01<00:00, 118.65it/s] 91%|█████████▏| 158/173 [00:01<00:00, 110.34it/s] 98%|█████████▊| 170/173 [00:01<00:00, 90.71it/s] 100%|██████████| 173/173 [00:01<00:00, 108.74it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.089, valid loss : 0.080, train acc : 0.459, valid acc : 0.630, train f1 : 0.400, valid f1 : 0.517
training process:   1%|          | 1/128 [01:00<2:08:08, 60.54s/it]Best score increase :0.000 -> 0.517
training process:   2%|▏         | 2/128 [01:58<2:03:33, 58.84s/it]Best score increase :0.517 -> 0.624
training process:   2%|▏         | 3/128 [02:56<2:01:51, 58.50s/it]Best score increase :0.624 -> 0.661
training process:   3%|▎         | 4/128 [03:54<2:00:48, 58.46s/it]Best score increase :0.661 -> 0.684
epoch : 5, train loss : 0.064, valid loss : 0.069, train acc : 0.845, valid acc : 0.872, train f1 : 0.673, valid f1 : 0.708
training process:   4%|▍         | 5/128 [05:00<2:05:28, 61.20s/it]Best score increase :0.684 -> 0.708
training process:   5%|▍         | 6/128 [05:59<2:02:50, 60.41s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:50<1:55:37, 57.33s/it]Best score increase :0.708 -> 0.709
training process:   6%|▋         | 8/128 [07:38<1:48:42, 54.36s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.058, valid loss : 0.068, train acc : 0.871, valid acc : 0.885, train f1 : 0.709, valid f1 : 0.717
training process:   7%|▋         | 9/128 [08:36<1:49:55, 55.43s/it]Best score increase :0.709 -> 0.717
training process:   8%|▊         | 10/128 [09:32<1:49:43, 55.79s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:30<1:49:58, 56.40s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [11:28<1:49:56, 56.87s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.054, valid loss : 0.066, train acc : 0.893, valid acc : 0.871, train f1 : 0.738, valid f1 : 0.707
training process:  10%|█         | 13/128 [12:34<1:54:19, 59.65s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [13:32<1:52:28, 59.20s/it]Best score increase :0.717 -> 0.726
training process:  12%|█▏        | 15/128 [14:24<1:47:17, 56.97s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:12<1:41:09, 54.19s/it]Best score increase :0.726 -> 0.731
epoch : 17, train loss : 0.051, valid loss : 0.062, train acc : 0.903, valid acc : 0.898, train f1 : 0.755, valid f1 : 0.749
training process:  13%|█▎        | 17/128 [16:05<1:39:40, 53.88s/it]Best score increase :0.731 -> 0.749
training process:  14%|█▍        | 18/128 [16:55<1:36:43, 52.76s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [17:52<1:38:09, 54.03s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [18:50<1:39:18, 55.17s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.047, valid loss : 0.066, train acc : 0.910, valid acc : 0.905, train f1 : 0.770, valid f1 : 0.755
training process:  16%|█▋        | 21/128 [19:57<1:44:40, 58.70s/it]Best score increase :0.749 -> 0.755
training process:  17%|█▋        | 22/128 [20:55<1:43:12, 58.42s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [21:53<1:42:01, 58.30s/it]Best score increase :0.755 -> 0.761
training process:  19%|█▉        | 24/128 [22:42<1:36:23, 55.61s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.044, valid loss : 0.066, train acc : 0.919, valid acc : 0.901, train f1 : 0.786, valid f1 : 0.753
training process:  20%|█▉        | 25/128 [23:41<1:37:18, 56.68s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [24:33<1:34:03, 55.33s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [25:32<1:34:50, 56.34s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [26:30<1:34:28, 56.68s/it]Best score increase :0.761 -> 0.771
epoch : 29, train loss : 0.042, valid loss : 0.068, train acc : 0.923, valid acc : 0.912, train f1 : 0.795, valid f1 : 0.761
training process:  23%|██▎       | 29/128 [27:36<1:38:31, 59.72s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [28:35<1:36:45, 59.24s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [29:33<1:35:27, 59.04s/it]Best score increase :0.771 -> 0.778
training process:  25%|██▌       | 32/128 [30:26<1:31:37, 57.26s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.041, valid loss : 0.063, train acc : 0.925, valid acc : 0.902, train f1 : 0.797, valid f1 : 0.755
training process:  26%|██▌       | 33/128 [31:25<1:31:13, 57.61s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [32:14<1:26:25, 55.17s/it]Best score increase :0.778 -> 0.794
training process:  27%|██▋       | 35/128 [33:11<1:26:25, 55.76s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [34:10<1:26:45, 56.58s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.039, valid loss : 0.066, train acc : 0.935, valid acc : 0.914, train f1 : 0.818, valid f1 : 0.773
training process:  29%|██▉       | 37/128 [35:16<1:30:22, 59.58s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [36:15<1:28:49, 59.22s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [37:13<1:27:15, 58.82s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [38:08<1:24:53, 57.88s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.037, valid loss : 0.067, train acc : 0.934, valid acc : 0.916, train f1 : 0.819, valid f1 : 0.778
training process:  32%|███▏      | 41/128 [39:07<1:24:21, 58.18s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [39:56<1:19:19, 55.35s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [40:49<1:17:16, 54.54s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [41:47<1:18:09, 55.83s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.037, valid loss : 0.067, train acc : 0.940, valid acc : 0.920, train f1 : 0.829, valid f1 : 0.784
training process:  35%|███▌      | 45/128 [42:54<1:21:32, 58.95s/it]EarlyStopping counter : 11 out of 12
training process:  35%|███▌      | 45/128 [43:53<1:20:56, 58.51s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.794
training process finished, best loss : 0.067 and best acc : 0.927, best f1 : 0.794, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.61      0.72      0.66       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.84      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.84, test loss : 3.597

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.48s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.48s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.45s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.56s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.81s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.61s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.66s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.63s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.57s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.62s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.64s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.62s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.61s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▌         | 16/306 [00:00<00:01, 150.72it/s] 10%|█         | 32/306 [00:00<00:02, 122.12it/s] 15%|█▍        | 45/306 [00:00<00:02, 125.01it/s] 19%|█▉        | 58/306 [00:00<00:02, 109.43it/s] 24%|██▎       | 72/306 [00:00<00:01, 117.59it/s] 28%|██▊       | 85/306 [00:00<00:01, 119.18it/s] 32%|███▏      | 98/306 [00:00<00:01, 111.81it/s] 36%|███▌      | 110/306 [00:00<00:01, 113.25it/s] 40%|███▉      | 122/306 [00:01<00:01, 112.87it/s] 44%|████▍     | 134/306 [00:01<00:01, 114.71it/s] 48%|████▊     | 147/306 [00:01<00:01, 118.83it/s] 52%|█████▏    | 159/306 [00:01<00:01, 117.70it/s] 56%|█████▌    | 171/306 [00:01<00:01, 117.75it/s] 60%|██████    | 184/306 [00:01<00:01, 121.31it/s] 64%|██████▍   | 197/306 [00:01<00:00, 113.84it/s] 70%|██████▉   | 214/306 [00:01<00:00, 128.77it/s] 75%|███████▍  | 228/306 [00:01<00:00, 129.37it/s] 79%|███████▉  | 242/306 [00:02<00:00, 114.10it/s] 84%|████████▍ | 257/306 [00:02<00:00, 123.10it/s] 89%|████████▉ | 272/306 [00:02<00:00, 126.78it/s] 93%|█████████▎| 285/306 [00:02<00:00, 118.29it/s] 97%|█████████▋| 298/306 [00:02<00:00, 119.60it/s]100%|██████████| 306/306 [00:02<00:00, 119.68it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:00, 532.48it/s]extract the null data:  20%|█▉        | 110/553 [00:00<00:00, 546.68it/s]extract the null data:  30%|███       | 168/553 [00:00<00:00, 560.36it/s]extract the null data:  41%|████      | 227/553 [00:00<00:00, 569.65it/s]extract the null data:  51%|█████▏    | 284/553 [00:00<00:00, 536.84it/s]extract the null data:  62%|██████▏   | 341/553 [00:00<00:00, 545.48it/s]extract the null data:  72%|███████▏  | 398/553 [00:00<00:00, 550.11it/s]extract the null data:  82%|████████▏ | 456/553 [00:00<00:00, 558.23it/s]extract the null data:  93%|█████████▎| 512/553 [00:00<00:00, 556.44it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 553.22it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 171.93it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 175.47it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 177.56it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 176.09it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 180.66it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 183.47it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 185.48it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 194.64it/s]replace nan value:  31%|███▏      | 173/553 [00:00<00:01, 198.88it/s]replace nan value:  35%|███▍      | 193/553 [00:01<00:01, 192.69it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 198.69it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 197.41it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 197.44it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 200.94it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 196.31it/s]replace nan value:  57%|█████▋    | 317/553 [00:01<00:01, 193.42it/s]replace nan value:  61%|██████    | 337/553 [00:01<00:01, 193.65it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:01, 188.99it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 189.54it/s]replace nan value:  72%|███████▏  | 397/553 [00:02<00:00, 192.44it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 190.75it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 192.88it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 197.29it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 195.52it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 197.45it/s]replace nan value:  94%|█████████▍| 520/553 [00:02<00:00, 199.76it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 196.00it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 192.83it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 134.88it/s]  5%|▌         | 29/553 [00:00<00:03, 138.68it/s]  8%|▊         | 43/553 [00:00<00:03, 134.18it/s] 10%|█         | 57/553 [00:00<00:04, 123.72it/s] 13%|█▎        | 70/553 [00:00<00:04, 118.74it/s] 16%|█▌        | 87/553 [00:00<00:03, 133.83it/s] 18%|█▊        | 101/553 [00:00<00:03, 126.59it/s] 22%|██▏       | 119/553 [00:00<00:03, 141.97it/s] 24%|██▍       | 134/553 [00:01<00:03, 138.55it/s] 27%|██▋       | 151/553 [00:01<00:02, 146.46it/s] 31%|███       | 169/553 [00:01<00:02, 154.40it/s] 33%|███▎      | 185/553 [00:01<00:02, 149.89it/s] 37%|███▋      | 202/553 [00:01<00:02, 155.09it/s] 39%|███▉      | 218/553 [00:01<00:02, 156.45it/s] 42%|████▏     | 234/553 [00:01<00:02, 150.21it/s] 45%|████▌     | 250/553 [00:01<00:02, 148.97it/s] 48%|████▊     | 265/553 [00:01<00:01, 144.72it/s] 51%|█████     | 280/553 [00:01<00:01, 137.26it/s] 53%|█████▎    | 294/553 [00:02<00:01, 135.09it/s] 56%|█████▌    | 308/553 [00:02<00:01, 132.84it/s] 58%|█████▊    | 322/553 [00:02<00:01, 130.12it/s] 61%|██████    | 337/553 [00:02<00:01, 135.27it/s] 63%|██████▎   | 351/553 [00:02<00:01, 134.43it/s] 66%|██████▌   | 365/553 [00:02<00:01, 131.45it/s] 69%|██████▊   | 380/553 [00:02<00:01, 135.32it/s] 71%|███████   | 394/553 [00:02<00:01, 122.82it/s] 74%|███████▍  | 408/553 [00:02<00:01, 126.22it/s] 76%|███████▌  | 421/553 [00:03<00:01, 121.93it/s] 78%|███████▊  | 434/553 [00:03<00:00, 119.29it/s] 82%|████████▏ | 452/553 [00:03<00:00, 135.04it/s] 84%|████████▍ | 466/553 [00:03<00:00, 136.18it/s] 87%|████████▋ | 480/553 [00:03<00:00, 129.86it/s] 89%|████████▉ | 494/553 [00:03<00:00, 126.07it/s] 92%|█████████▏| 509/553 [00:03<00:00, 130.97it/s] 95%|█████████▍| 523/553 [00:03<00:00, 123.24it/s] 97%|█████████▋| 536/553 [00:04<00:00, 114.40it/s]100%|█████████▉| 551/553 [00:04<00:00, 104.57it/s]100%|██████████| 553/553 [00:04<00:00, 131.40it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 368.45it/s]extract the null data:  73%|███████▎  | 101/139 [00:00<00:00, 526.76it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 537.12it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 215.37it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 208.74it/s]replace nan value:  47%|████▋     | 65/139 [00:00<00:00, 205.69it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 208.27it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 208.87it/s]replace nan value:  94%|█████████▍| 131/139 [00:00<00:00, 210.96it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 211.09it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 126.62it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.46it/s] 30%|███       | 42/139 [00:00<00:00, 140.58it/s] 41%|████      | 57/139 [00:00<00:00, 123.90it/s] 52%|█████▏    | 72/139 [00:00<00:00, 131.98it/s] 62%|██████▏   | 86/139 [00:00<00:00, 129.98it/s] 72%|███████▏  | 100/139 [00:00<00:00, 125.14it/s] 82%|████████▏ | 114/139 [00:00<00:00, 129.39it/s] 93%|█████████▎| 129/139 [00:00<00:00, 135.19it/s]100%|██████████| 139/139 [00:01<00:00, 132.70it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 25/173 [00:00<00:00, 247.98it/s]extract the null data:  53%|█████▎    | 91/173 [00:00<00:00, 486.15it/s]extract the null data:  86%|████████▌ | 148/173 [00:00<00:00, 524.18it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 500.44it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 198.61it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 206.59it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 200.89it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 206.72it/s]replace nan value:  61%|██████▏   | 106/173 [00:00<00:00, 205.04it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 203.94it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 209.75it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 209.53it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.76it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 137.09it/s] 17%|█▋        | 29/173 [00:00<00:01, 121.64it/s] 26%|██▌       | 45/173 [00:00<00:00, 134.13it/s] 35%|███▌      | 61/173 [00:00<00:00, 141.15it/s] 44%|████▍     | 76/173 [00:00<00:00, 137.16it/s] 53%|█████▎    | 91/173 [00:00<00:00, 140.07it/s] 61%|██████▏   | 106/173 [00:00<00:00, 135.42it/s] 69%|██████▉   | 120/173 [00:00<00:00, 134.47it/s] 77%|███████▋  | 134/173 [00:01<00:00, 128.31it/s] 86%|████████▌ | 148/173 [00:01<00:00, 128.69it/s] 93%|█████████▎| 161/173 [00:01<00:00, 114.84it/s]100%|██████████| 173/173 [00:01<00:00, 88.49it/s] 100%|██████████| 173/173 [00:01<00:00, 117.04it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.173, valid loss : 0.098, train acc : 0.625, valid acc : 0.323, train f1 : 0.577, valid f1 : 0.306
training process:   1%|          | 1/128 [01:09<2:26:23, 69.16s/it]Best score increase :0.000 -> 0.306
training process:   2%|▏         | 2/128 [02:07<2:11:54, 62.81s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:06<2:07:03, 60.98s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [04:04<2:03:51, 59.93s/it]Best score increase :0.306 -> 0.318
epoch : 5, train loss : 0.091, valid loss : 0.101, train acc : 0.641, valid acc : 0.385, train f1 : 0.592, valid f1 : 0.354
training process:   4%|▍         | 5/128 [05:07<2:05:09, 61.05s/it]Best score increase :0.318 -> 0.354
training process:   5%|▍         | 6/128 [05:58<1:57:01, 57.55s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:49<1:51:41, 55.38s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:46<1:51:35, 55.79s/it]Best score increase :0.354 -> 0.393
epoch : 9, train loss : 0.079, valid loss : 0.099, train acc : 0.697, valid acc : 0.448, train f1 : 0.666, valid f1 : 0.400
training process:   7%|▋         | 9/128 [08:52<1:57:24, 59.20s/it]Best score increase :0.393 -> 0.400
training process:   8%|▊         | 10/128 [09:51<1:56:07, 59.04s/it]Best score increase :0.400 -> 0.405
training process:   9%|▊         | 11/128 [10:49<1:54:35, 58.76s/it]Best score increase :0.405 -> 0.437
training process:   9%|▉         | 12/128 [11:48<1:53:31, 58.72s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.072, valid loss : 0.087, train acc : 0.733, valid acc : 0.529, train f1 : 0.714, valid f1 : 0.457
training process:  10%|█         | 13/128 [12:52<1:55:59, 60.52s/it]Best score increase :0.437 -> 0.457
training process:  11%|█         | 14/128 [13:45<1:50:18, 58.05s/it]Best score increase :0.457 -> 0.487
training process:  12%|█▏        | 15/128 [14:37<1:46:09, 56.36s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:32<1:44:30, 55.99s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.064, valid loss : 0.085, train acc : 0.774, valid acc : 0.564, train f1 : 0.762, valid f1 : 0.481
training process:  13%|█▎        | 17/128 [16:39<1:49:47, 59.34s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [17:37<1:47:48, 58.80s/it]Best score increase :0.487 -> 0.515
training process:  15%|█▍        | 19/128 [18:35<1:46:22, 58.55s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [19:33<1:45:02, 58.36s/it]Best score increase :0.515 -> 0.534
epoch : 21, train loss : 0.057, valid loss : 0.073, train acc : 0.806, valid acc : 0.665, train f1 : 0.799, valid f1 : 0.551
training process:  16%|█▋        | 21/128 [20:37<1:46:58, 59.98s/it]Best score increase :0.534 -> 0.551
training process:  17%|█▋        | 22/128 [21:24<1:39:31, 56.34s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [22:14<1:35:10, 54.39s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [23:09<1:34:23, 54.46s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.053, valid loss : 0.073, train acc : 0.825, valid acc : 0.654, train f1 : 0.820, valid f1 : 0.544
training process:  20%|█▉        | 25/128 [24:14<1:39:03, 57.70s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [25:12<1:38:11, 57.76s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [26:09<1:36:50, 57.53s/it]Best score increase :0.551 -> 0.555
training process:  22%|██▏       | 28/128 [27:07<1:36:01, 57.61s/it]Best score increase :0.555 -> 0.564
epoch : 29, train loss : 0.047, valid loss : 0.066, train acc : 0.852, valid acc : 0.723, train f1 : 0.849, valid f1 : 0.596
training process:  23%|██▎       | 29/128 [28:13<1:39:02, 60.02s/it]Best score increase :0.564 -> 0.596
training process:  23%|██▎       | 30/128 [28:58<1:30:54, 55.66s/it]Best score increase :0.596 -> 0.619
training process:  24%|██▍       | 31/128 [29:44<1:25:23, 52.82s/it]Best score increase :0.619 -> 0.627
training process:  25%|██▌       | 32/128 [30:32<1:22:09, 51.34s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.047, valid loss : 0.063, train acc : 0.859, valid acc : 0.741, train f1 : 0.857, valid f1 : 0.611
training process:  26%|██▌       | 33/128 [31:39<1:28:39, 56.00s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [32:38<1:29:01, 56.83s/it]Best score increase :0.627 -> 0.660
training process:  27%|██▋       | 35/128 [33:35<1:28:06, 56.85s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [34:32<1:27:29, 57.06s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.044, valid loss : 0.059, train acc : 0.869, valid acc : 0.779, train f1 : 0.867, valid f1 : 0.642
training process:  29%|██▉       | 37/128 [35:40<1:31:40, 60.44s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [36:36<1:28:32, 59.03s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [37:27<1:23:56, 56.59s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [38:19<1:20:44, 55.05s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.041, valid loss : 0.064, train acc : 0.877, valid acc : 0.755, train f1 : 0.875, valid f1 : 0.620
training process:  32%|███▏      | 41/128 [39:21<1:22:53, 57.16s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [40:20<1:22:41, 57.69s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [41:19<1:22:15, 58.06s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [42:18<1:21:41, 58.36s/it]Best score increase :0.660 -> 0.666
epoch : 45, train loss : 0.040, valid loss : 0.060, train acc : 0.885, valid acc : 0.779, train f1 : 0.884, valid f1 : 0.640
training process:  35%|███▌      | 45/128 [43:24<1:24:04, 60.78s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [44:17<1:19:54, 58.46s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [45:12<1:17:28, 57.39s/it]EarlyStopping counter : 3 out of 12
training process:  38%|███▊      | 48/128 [46:05<1:14:41, 56.02s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.040, valid loss : 0.059, train acc : 0.885, valid acc : 0.788, train f1 : 0.884, valid f1 : 0.649
training process:  38%|███▊      | 49/128 [47:05<1:15:20, 57.22s/it]EarlyStopping counter : 5 out of 12
training process:  39%|███▉      | 50/128 [47:55<1:11:38, 55.11s/it]EarlyStopping counter : 6 out of 12
training process:  40%|███▉      | 51/128 [48:54<1:12:07, 56.20s/it]EarlyStopping counter : 7 out of 12
training process:  41%|████      | 52/128 [49:52<1:11:54, 56.77s/it]EarlyStopping counter : 8 out of 12
epoch : 53, train loss : 0.036, valid loss : 0.062, train acc : 0.895, valid acc : 0.766, train f1 : 0.894, valid f1 : 0.631
training process:  41%|████▏     | 53/128 [50:56<1:13:48, 59.04s/it]EarlyStopping counter : 9 out of 12
training process:  42%|████▏     | 54/128 [51:55<1:12:44, 58.98s/it]Best score increase :0.666 -> 0.669
training process:  43%|████▎     | 55/128 [52:54<1:11:39, 58.90s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [53:49<1:09:21, 57.79s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.037, valid loss : 0.058, train acc : 0.899, valid acc : 0.813, train f1 : 0.898, valid f1 : 0.671
training process:  45%|████▍     | 57/128 [54:52<1:10:24, 59.50s/it]Best score increase :0.669 -> 0.671
training process:  45%|████▌     | 58/128 [55:46<1:07:11, 57.59s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [56:38<1:04:32, 56.13s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [57:36<1:04:09, 56.61s/it]EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.037, valid loss : 0.059, train acc : 0.897, valid acc : 0.793, train f1 : 0.897, valid f1 : 0.654
training process:  48%|████▊     | 61/128 [58:42<1:06:29, 59.55s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [59:41<1:05:11, 59.26s/it]EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [1:00:40<1:04:08, 59.22s/it]EarlyStopping counter : 6 out of 12
training process:  50%|█████     | 64/128 [1:01:38<1:02:50, 58.92s/it]EarlyStopping counter : 7 out of 12
epoch : 65, train loss : 0.037, valid loss : 0.057, train acc : 0.899, valid acc : 0.809, train f1 : 0.898, valid f1 : 0.667
training process:  51%|█████     | 65/128 [1:02:45<1:04:16, 61.22s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 66/128 [1:03:41<1:01:41, 59.69s/it]Best score increase :0.671 -> 0.683
training process:  52%|█████▏    | 67/128 [1:04:37<59:34, 58.60s/it]  EarlyStopping counter : 1 out of 12
training process:  53%|█████▎    | 68/128 [1:05:43<1:00:49, 60.83s/it]EarlyStopping counter : 2 out of 12
epoch : 69, train loss : 0.036, valid loss : 0.059, train acc : 0.905, valid acc : 0.818, train f1 : 0.904, valid f1 : 0.676
training process:  54%|█████▍    | 69/128 [1:07:03<1:05:32, 66.66s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▍    | 70/128 [1:08:14<1:05:36, 67.87s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▌    | 71/128 [1:09:19<1:03:44, 67.09s/it]EarlyStopping counter : 5 out of 12
training process:  56%|█████▋    | 72/128 [1:10:27<1:02:42, 67.19s/it]Best score increase :0.683 -> 0.712
epoch : 73, train loss : 0.032, valid loss : 0.055, train acc : 0.910, valid acc : 0.824, train f1 : 0.910, valid f1 : 0.682
training process:  57%|█████▋    | 73/128 [1:11:44<1:04:23, 70.24s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:12:53<1:02:49, 69.81s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:14:06<1:02:37, 70.90s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▉    | 76/128 [1:15:06<58:26, 67.43s/it]  EarlyStopping counter : 4 out of 12
epoch : 77, train loss : 0.034, valid loss : 0.055, train acc : 0.910, valid acc : 0.841, train f1 : 0.909, valid f1 : 0.699
training process:  60%|██████    | 77/128 [1:16:25<1:00:14, 70.88s/it]EarlyStopping counter : 5 out of 12
training process:  61%|██████    | 78/128 [1:17:20<55:13, 66.27s/it]  EarlyStopping counter : 6 out of 12
training process:  62%|██████▏   | 79/128 [1:18:14<50:59, 62.43s/it]EarlyStopping counter : 7 out of 12
training process:  62%|██████▎   | 80/128 [1:19:05<47:21, 59.19s/it]EarlyStopping counter : 8 out of 12
epoch : 81, train loss : 0.032, valid loss : 0.061, train acc : 0.913, valid acc : 0.795, train f1 : 0.913, valid f1 : 0.655
training process:  63%|██████▎   | 81/128 [1:20:10<47:35, 60.76s/it]EarlyStopping counter : 9 out of 12
training process:  64%|██████▍   | 82/128 [1:21:04<45:04, 58.79s/it]EarlyStopping counter : 10 out of 12
training process:  65%|██████▍   | 83/128 [1:22:01<43:43, 58.29s/it]EarlyStopping counter : 11 out of 12
training process:  65%|██████▍   | 83/128 [1:22:57<44:58, 59.96s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 83, best f1 score : 0.712
training process finished, best loss : 0.053 and best acc : 0.852, best f1 : 0.712, best epoch : 71

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.42      0.90      0.57       580
           1       0.99      0.89      0.94      6818

    accuracy                           0.89      7398
   macro avg       0.70      0.89      0.75      7398
weighted avg       0.95      0.89      0.91      7398


# test acc : 0.89, test f1 : 0.75, test AUC : 0.89, test loss : 2.695

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.79s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:20,  8.00s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.83s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:04,  8.02s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:56,  8.01s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.92s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.81s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.88s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.85s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.88s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.77s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.99s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.91s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 139.00it/s]  9%|▉         | 28/306 [00:00<00:02, 99.93it/s]  14%|█▍        | 44/306 [00:00<00:02, 118.66it/s] 19%|█▊        | 57/306 [00:00<00:02, 121.92it/s] 23%|██▎       | 70/306 [00:00<00:01, 121.24it/s] 27%|██▋       | 84/306 [00:00<00:01, 126.55it/s] 32%|███▏      | 97/306 [00:00<00:01, 125.79it/s] 36%|███▌      | 110/306 [00:00<00:01, 126.46it/s] 41%|████      | 124/306 [00:00<00:01, 130.45it/s] 45%|████▌     | 138/306 [00:01<00:01, 131.11it/s] 50%|████▉     | 152/306 [00:01<00:01, 131.49it/s] 55%|█████▍    | 167/306 [00:01<00:01, 136.35it/s] 59%|█████▉    | 181/306 [00:01<00:01, 120.26it/s] 64%|██████▍   | 197/306 [00:01<00:00, 129.64it/s] 70%|██████▉   | 214/306 [00:01<00:00, 137.30it/s] 75%|███████▍  | 228/306 [00:01<00:00, 127.21it/s] 79%|███████▉  | 242/306 [00:01<00:00, 129.69it/s] 84%|████████▎ | 256/306 [00:02<00:00, 129.87it/s] 88%|████████▊ | 270/306 [00:02<00:00, 130.94it/s] 93%|█████████▎| 284/306 [00:02<00:00, 133.35it/s] 97%|█████████▋| 298/306 [00:02<00:00, 119.28it/s]100%|██████████| 306/306 [00:02<00:00, 127.06it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 571.82it/s]extract the null data:  21%|██▏       | 118/553 [00:00<00:00, 584.76it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:00, 595.28it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 601.13it/s]extract the null data:  55%|█████▍    | 302/553 [00:00<00:00, 603.40it/s]extract the null data:  66%|██████▌   | 363/553 [00:00<00:00, 598.08it/s]extract the null data:  76%|███████▋  | 423/553 [00:00<00:00, 595.82it/s]extract the null data:  88%|████████▊ | 484/553 [00:00<00:00, 597.61it/s]extract the null data:  99%|█████████▊| 545/553 [00:00<00:00, 599.32it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 596.52it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 194.09it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 198.15it/s]replace nan value:  11%|█         | 61/553 [00:00<00:02, 194.11it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 194.71it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 196.39it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:02, 197.49it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 196.11it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:02, 194.68it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 193.35it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 193.55it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 191.13it/s]replace nan value:  44%|████▍     | 242/553 [00:01<00:01, 190.55it/s]replace nan value:  47%|████▋     | 262/553 [00:01<00:01, 190.43it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 190.53it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 191.62it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 190.31it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 189.00it/s]replace nan value:  65%|██████▌   | 362/553 [00:01<00:01, 189.31it/s]replace nan value:  69%|██████▉   | 382/553 [00:01<00:00, 190.82it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 191.80it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 195.14it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 198.21it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 202.12it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 203.98it/s]replace nan value:  92%|█████████▏| 508/553 [00:02<00:00, 202.04it/s]replace nan value:  96%|█████████▌| 529/553 [00:02<00:00, 201.01it/s]replace nan value:  99%|█████████▉| 550/553 [00:02<00:00, 199.94it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 195.09it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 141.37it/s]  6%|▌         | 31/553 [00:00<00:03, 150.08it/s]  8%|▊         | 47/553 [00:00<00:03, 128.63it/s] 11%|█         | 61/553 [00:00<00:03, 123.97it/s] 14%|█▍        | 77/553 [00:00<00:03, 131.56it/s] 16%|█▋        | 91/553 [00:00<00:03, 133.49it/s] 19%|█▉        | 106/553 [00:00<00:03, 136.61it/s] 22%|██▏       | 122/553 [00:00<00:03, 139.58it/s] 25%|██▌       | 139/553 [00:01<00:02, 147.29it/s] 29%|██▊       | 158/553 [00:01<00:02, 159.65it/s] 32%|███▏      | 175/553 [00:01<00:02, 155.39it/s] 35%|███▍      | 191/553 [00:01<00:02, 156.56it/s] 38%|███▊      | 210/553 [00:01<00:02, 161.78it/s] 41%|████      | 227/553 [00:01<00:02, 154.52it/s] 44%|████▍     | 243/553 [00:01<00:02, 153.84it/s] 47%|████▋     | 259/553 [00:01<00:01, 150.83it/s] 50%|████▉     | 275/553 [00:01<00:01, 147.76it/s] 53%|█████▎    | 291/553 [00:01<00:01, 147.66it/s] 55%|█████▌    | 306/553 [00:02<00:01, 136.67it/s] 58%|█████▊    | 320/553 [00:02<00:01, 135.69it/s] 61%|██████    | 335/553 [00:02<00:01, 138.43it/s] 63%|██████▎   | 349/553 [00:02<00:01, 137.61it/s] 66%|██████▌   | 363/553 [00:02<00:01, 134.47it/s] 68%|██████▊   | 378/553 [00:02<00:01, 138.01it/s] 71%|███████   | 392/553 [00:02<00:01, 128.13it/s] 73%|███████▎  | 406/553 [00:02<00:01, 129.74it/s] 76%|███████▌  | 420/553 [00:02<00:01, 126.42it/s] 78%|███████▊  | 433/553 [00:03<00:00, 124.50it/s] 82%|████████▏ | 452/553 [00:03<00:00, 142.22it/s] 84%|████████▍ | 467/553 [00:03<00:00, 143.56it/s] 87%|████████▋ | 482/553 [00:03<00:00, 138.44it/s] 90%|████████▉ | 496/553 [00:03<00:00, 128.81it/s] 93%|█████████▎| 512/553 [00:03<00:00, 135.52it/s] 95%|█████████▌| 526/553 [00:03<00:00, 121.57it/s] 97%|█████████▋| 539/553 [00:03<00:00, 120.16it/s]100%|█████████▉| 552/553 [00:04<00:00, 107.83it/s]100%|██████████| 553/553 [00:04<00:00, 135.77it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 337.85it/s]extract the null data:  72%|███████▏  | 100/139 [00:00<00:00, 524.32it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 530.13it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 217.74it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 218.70it/s]replace nan value:  48%|████▊     | 67/139 [00:00<00:00, 219.11it/s]replace nan value:  64%|██████▍   | 89/139 [00:00<00:00, 218.39it/s]replace nan value:  80%|███████▉  | 111/139 [00:00<00:00, 215.60it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 212.59it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 214.83it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.80it/s] 19%|█▊        | 26/139 [00:00<00:00, 130.66it/s] 29%|██▉       | 41/139 [00:00<00:00, 138.63it/s] 40%|███▉      | 55/139 [00:00<00:00, 126.87it/s] 50%|█████     | 70/139 [00:00<00:00, 132.89it/s] 60%|██████    | 84/139 [00:00<00:00, 124.99it/s] 70%|██████▉   | 97/139 [00:00<00:00, 121.46it/s] 79%|███████▉  | 110/139 [00:00<00:00, 117.61it/s] 91%|█████████ | 126/139 [00:00<00:00, 126.38it/s]100%|██████████| 139/139 [00:01<00:00, 126.77it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 378.86it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 550.87it/s]extract the null data:  98%|█████████▊| 169/173 [00:00<00:00, 584.49it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 558.02it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 218.82it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 214.52it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 212.60it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 211.92it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 211.75it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 211.75it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 210.97it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 210.78it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 138.32it/s] 17%|█▋        | 29/173 [00:00<00:01, 119.76it/s] 27%|██▋       | 46/173 [00:00<00:00, 136.78it/s] 36%|███▌      | 62/173 [00:00<00:00, 142.44it/s] 45%|████▍     | 77/173 [00:00<00:00, 139.66it/s] 53%|█████▎    | 92/173 [00:00<00:00, 137.34it/s] 61%|██████▏   | 106/173 [00:00<00:00, 136.74it/s] 69%|██████▉   | 120/173 [00:00<00:00, 137.10it/s] 77%|███████▋  | 134/173 [00:00<00:00, 130.14it/s] 86%|████████▌ | 148/173 [00:01<00:00, 130.53it/s] 94%|█████████▎| 162/173 [00:01<00:00, 118.04it/s]100%|██████████| 173/173 [00:01<00:00, 118.50it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.627, valid loss : 0.452, train f1 : 0.498, valid f1 : 0.677
training process - Deferred Re-weighting:   1%|          | 1/128 [01:05<2:18:45, 65.56s/it]Best score increase :0.000 -> 0.677
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:56<1:59:49, 57.06s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:48<1:54:17, 54.86s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:42<1:52:13, 54.30s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.201, valid loss : 0.207, train f1 : 0.698, valid f1 : 0.685
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:45<1:58:11, 57.66s/it]Best score increase :0.677 -> 0.685
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:36<1:52:22, 55.27s/it]Best score increase :0.685 -> 0.706
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:35<1:54:07, 56.59s/it]Best score increase :0.706 -> 0.709
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:34<1:54:25, 57.21s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.169, valid loss : 0.188, train f1 : 0.739, valid f1 : 0.701
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:41<1:59:24, 60.20s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:36<1:55:08, 58.55s/it]Best score increase :0.709 -> 0.715
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:32<1:52:40, 57.78s/it]Best score increase :0.715 -> 0.728
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:28<1:50:48, 57.32s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.154, valid loss : 0.183, train f1 : 0.768, valid f1 : 0.728
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:28<1:51:39, 58.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:19<1:46:07, 55.86s/it]Best score increase :0.728 -> 0.743
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:11<1:43:27, 54.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:08<1:43:19, 55.35s/it]Best score increase :0.743 -> 0.749
epoch : 17, train loss : 0.144, valid loss : 0.171, train f1 : 0.788, valid f1 : 0.747
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [16:14<1:48:16, 58.53s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [17:08<1:44:54, 57.22s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [18:05<1:44:05, 57.30s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [19:04<1:43:57, 57.76s/it]Best score increase :0.749 -> 0.766
epoch : 21, train loss : 0.132, valid loss : 0.171, train f1 : 0.808, valid f1 : 0.758
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [20:11<1:47:50, 60.47s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [21:05<1:43:36, 58.65s/it]Best score increase :0.766 -> 0.783
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:57<1:38:59, 56.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:46<1:34:19, 54.42s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.121, valid loss : 0.163, train f1 : 0.828, valid f1 : 0.788
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:44<1:34:59, 55.33s/it]Best score increase :0.783 -> 0.788
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:40<1:34:16, 55.45s/it]Best score increase :0.788 -> 0.799
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:34<1:32:57, 55.22s/it]Best score increase :0.799 -> 0.807
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [26:31<1:32:57, 55.77s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.113, valid loss : 0.162, train f1 : 0.843, valid f1 : 0.788
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:36<1:36:10, 58.29s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [28:35<1:35:50, 58.68s/it]Best score increase :0.807 -> 0.808
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [29:31<1:33:30, 57.84s/it]Best score increase :0.808 -> 0.811
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [30:28<1:32:07, 57.58s/it]Best score increase :0.811 -> 0.817
epoch : 33, train loss : 0.106, valid loss : 0.152, train f1 : 0.854, valid f1 : 0.813
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [31:42<1:38:54, 62.47s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [32:51<1:40:55, 64.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [33:58<1:40:59, 65.15s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [35:05<1:40:56, 65.83s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.100, valid loss : 0.154, train f1 : 0.864, valid f1 : 0.812
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [36:24<1:45:39, 69.66s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [37:31<1:43:18, 68.87s/it]Best score increase :0.817 -> 0.824
training process - Deferred Re-weighting:  30%|███       | 39/128 [38:38<1:41:28, 68.41s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [39:45<1:39:38, 67.94s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.094, valid loss : 0.152, train f1 : 0.871, valid f1 : 0.816
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [41:04<1:43:29, 71.37s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [42:09<1:39:29, 69.42s/it]Best score increase :0.824 -> 0.825
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [43:19<1:38:23, 69.45s/it]Best score increase :0.825 -> 0.837
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [44:29<1:37:29, 69.64s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.091, valid loss : 0.156, train f1 : 0.875, valid f1 : 0.820
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [45:49<1:40:48, 72.87s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [46:58<1:37:47, 71.55s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [48:04<1:34:38, 70.11s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [49:15<1:33:40, 70.25s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.085, valid loss : 0.163, train f1 : 0.886, valid f1 : 0.817
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [50:35<1:36:17, 73.13s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [51:44<1:33:38, 72.04s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [52:49<1:29:30, 69.74s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [53:50<1:25:12, 67.27s/it]EarlyStopping counter : 9 out of 12
epoch : 53, train loss : 0.082, valid loss : 0.156, train f1 : 0.892, valid f1 : 0.845
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [55:04<1:26:40, 69.33s/it]Best score increase :0.837 -> 0.845
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [56:01<1:20:52, 65.58s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [56:54<1:15:04, 61.71s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [57:49<1:11:44, 59.79s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.080, valid loss : 0.156, train f1 : 0.893, valid f1 : 0.833
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [58:52<1:11:56, 60.79s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [59:45<1:08:13, 58.48s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:00:32<1:03:11, 54.95s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:01:20<59:57, 52.90s/it]  EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.078, valid loss : 0.160, train f1 : 0.897, valid f1 : 0.836
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:02:15<59:46, 53.54s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:03:07<58:18, 53.00s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:03:53<55:17, 51.04s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:04:42<53:42, 50.35s/it]EarlyStopping counter : 11 out of 12
epoch : 65, train loss : 0.075, valid loss : 0.171, train f1 : 0.903, valid f1 : 0.837
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:05:36<1:05:36, 61.50s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 64, best f1 score : 0.845
training process finished, best loss : 0.153, best acc : 0.956, best f1 : 0.845, best epoch : 53

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.88      0.63      0.73       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.92      0.81      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.81, test loss : 7.479

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.29s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.32s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.40s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.31s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.36s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.45s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.33s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:28,  7.23s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:05<00:21,  7.27s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:13<00:14,  7.37s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:20<00:07,  7.22s/it]processing for feature importance: 100%|██████████| 12/12 [01:27<00:00,  7.23s/it]processing for feature importance: 100%|██████████| 12/12 [01:27<00:00,  7.30s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 78.52it/s]  7%|▋         | 20/306 [00:00<00:02, 101.92it/s] 12%|█▏        | 36/306 [00:00<00:02, 127.63it/s] 17%|█▋        | 51/306 [00:00<00:01, 133.31it/s] 21%|██        | 65/306 [00:00<00:02, 113.52it/s] 28%|██▊       | 86/306 [00:00<00:01, 140.81it/s] 33%|███▎      | 102/306 [00:00<00:01, 142.59it/s] 38%|███▊      | 117/306 [00:00<00:01, 119.49it/s] 46%|████▌     | 140/306 [00:01<00:01, 147.00it/s] 51%|█████     | 156/306 [00:01<00:01, 141.55it/s] 56%|█████▌    | 171/306 [00:01<00:01, 122.11it/s] 63%|██████▎   | 193/306 [00:01<00:00, 144.52it/s] 68%|██████▊   | 209/306 [00:01<00:00, 147.26it/s] 74%|███████▎  | 225/306 [00:01<00:00, 122.47it/s] 81%|████████  | 247/306 [00:01<00:00, 143.11it/s] 86%|████████▌ | 263/306 [00:01<00:00, 143.53it/s] 91%|█████████ | 279/306 [00:02<00:00, 123.22it/s] 98%|█████████▊| 300/306 [00:02<00:00, 141.74it/s]100%|██████████| 306/306 [00:02<00:00, 133.41it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 473.77it/s]extract the null data:  18%|█▊        | 97/553 [00:00<00:00, 481.37it/s]extract the null data:  27%|██▋       | 150/553 [00:00<00:00, 502.51it/s]extract the null data:  36%|███▋      | 201/553 [00:00<00:00, 496.98it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 495.47it/s]extract the null data:  54%|█████▍    | 301/553 [00:00<00:00, 495.79it/s]extract the null data:  63%|██████▎   | 351/553 [00:00<00:00, 495.64it/s]extract the null data:  73%|███████▎  | 401/553 [00:00<00:00, 486.40it/s]extract the null data:  82%|████████▏ | 451/553 [00:00<00:00, 488.46it/s]extract the null data:  92%|█████████▏| 507/553 [00:01<00:00, 507.46it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 499.43it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 168.90it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:02, 173.49it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 173.94it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 175.10it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 176.30it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 178.52it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 181.59it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 182.12it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:02, 181.54it/s]replace nan value:  33%|███▎      | 184/553 [00:01<00:02, 180.87it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:01, 186.91it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 183.75it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 180.51it/s]replace nan value:  47%|████▋     | 262/553 [00:01<00:01, 181.05it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 179.49it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 176.90it/s]replace nan value:  57%|█████▋    | 317/553 [00:01<00:01, 176.95it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 177.68it/s]replace nan value:  64%|██████▍   | 353/553 [00:01<00:01, 178.27it/s]replace nan value:  67%|██████▋   | 372/553 [00:02<00:01, 180.23it/s]replace nan value:  71%|███████   | 391/553 [00:02<00:00, 179.99it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 183.60it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 179.64it/s]replace nan value:  81%|████████  | 448/553 [00:02<00:00, 179.19it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 182.84it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 185.32it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 183.55it/s]replace nan value:  95%|█████████▌| 526/553 [00:02<00:00, 182.04it/s]replace nan value:  99%|█████████▊| 545/553 [00:03<00:00, 182.57it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 180.43it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.18it/s]  5%|▌         | 29/553 [00:00<00:03, 139.19it/s]  8%|▊         | 43/553 [00:00<00:03, 133.11it/s] 10%|█         | 57/553 [00:00<00:04, 122.16it/s] 13%|█▎        | 70/553 [00:00<00:04, 116.64it/s] 16%|█▌        | 87/553 [00:00<00:03, 131.72it/s] 18%|█▊        | 101/553 [00:00<00:03, 125.62it/s] 22%|██▏       | 119/553 [00:00<00:03, 139.86it/s] 24%|██▍       | 134/553 [00:01<00:03, 137.67it/s] 27%|██▋       | 152/553 [00:01<00:02, 148.30it/s] 31%|███       | 169/553 [00:01<00:02, 154.32it/s] 33%|███▎      | 185/553 [00:01<00:02, 149.17it/s] 37%|███▋      | 202/553 [00:01<00:02, 152.49it/s] 39%|███▉      | 218/553 [00:01<00:02, 150.23it/s] 42%|████▏     | 234/553 [00:01<00:02, 144.27it/s] 45%|████▌     | 249/553 [00:01<00:02, 143.47it/s] 48%|████▊     | 265/553 [00:01<00:01, 144.16it/s] 51%|█████     | 280/553 [00:02<00:01, 138.84it/s] 53%|█████▎    | 294/553 [00:02<00:01, 135.44it/s] 56%|█████▌    | 308/553 [00:02<00:01, 130.47it/s] 58%|█████▊    | 322/553 [00:02<00:01, 127.50it/s] 61%|██████    | 336/553 [00:02<00:01, 129.02it/s] 63%|██████▎   | 349/553 [00:02<00:01, 127.97it/s] 65%|██████▌   | 362/553 [00:02<00:01, 125.76it/s] 68%|██████▊   | 377/553 [00:02<00:01, 132.16it/s] 71%|███████   | 391/553 [00:02<00:01, 119.13it/s] 73%|███████▎  | 404/553 [00:03<00:01, 121.80it/s] 75%|███████▌  | 417/553 [00:03<00:01, 120.76it/s] 78%|███████▊  | 430/553 [00:03<00:01, 116.95it/s] 81%|████████  | 448/553 [00:03<00:00, 132.44it/s] 84%|████████▎ | 463/553 [00:03<00:00, 136.75it/s] 86%|████████▋ | 478/553 [00:03<00:00, 135.74it/s] 89%|████████▉ | 492/553 [00:03<00:00, 130.10it/s] 92%|█████████▏| 506/553 [00:03<00:00, 128.35it/s] 94%|█████████▍| 521/553 [00:03<00:00, 130.50it/s] 97%|█████████▋| 535/553 [00:04<00:00, 115.25it/s]100%|█████████▉| 551/553 [00:04<00:00, 106.77it/s]100%|██████████| 553/553 [00:04<00:00, 130.27it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 295.08it/s]extract the null data:  63%|██████▎   | 88/139 [00:00<00:00, 460.30it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 475.51it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 211.50it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 205.85it/s]replace nan value:  47%|████▋     | 65/139 [00:00<00:00, 203.44it/s]replace nan value:  62%|██████▏   | 86/139 [00:00<00:00, 202.37it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 204.04it/s]replace nan value:  92%|█████████▏| 128/139 [00:00<00:00, 203.38it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 202.94it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.26it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.04it/s] 28%|██▊       | 39/139 [00:00<00:00, 129.39it/s] 37%|███▋      | 52/139 [00:00<00:00, 120.67it/s] 47%|████▋     | 66/139 [00:00<00:00, 125.53it/s] 57%|█████▋    | 79/139 [00:00<00:00, 120.96it/s] 66%|██████▌   | 92/139 [00:00<00:00, 112.77it/s] 76%|███████▌  | 105/139 [00:00<00:00, 114.96it/s] 86%|████████▋ | 120/139 [00:00<00:00, 124.36it/s] 96%|█████████▌| 133/139 [00:01<00:00, 124.96it/s]100%|██████████| 139/139 [00:01<00:00, 123.83it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 277.63it/s]extract the null data:  50%|█████     | 87/173 [00:00<00:00, 457.95it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 537.93it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 507.14it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 204.53it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 202.61it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 203.14it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 202.49it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 199.47it/s]replace nan value:  72%|███████▏  | 125/173 [00:00<00:00, 196.94it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 196.16it/s]replace nan value:  95%|█████████▌| 165/173 [00:00<00:00, 195.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 197.24it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.35it/s] 16%|█▌        | 28/173 [00:00<00:01, 121.58it/s] 25%|██▍       | 43/173 [00:00<00:00, 132.71it/s] 34%|███▎      | 58/173 [00:00<00:00, 136.42it/s] 42%|████▏     | 72/173 [00:00<00:00, 135.22it/s] 50%|████▉     | 86/173 [00:00<00:00, 134.31it/s] 58%|█████▊    | 100/173 [00:00<00:00, 133.80it/s] 66%|██████▌   | 114/173 [00:00<00:00, 135.58it/s] 74%|███████▍  | 128/173 [00:00<00:00, 127.55it/s] 82%|████████▏ | 141/173 [00:01<00:00, 128.09it/s] 89%|████████▉ | 154/173 [00:01<00:00, 118.34it/s] 97%|█████████▋| 167/173 [00:01<00:00, 94.63it/s] 100%|██████████| 173/173 [00:01<00:00, 115.62it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.550, valid loss : 0.483, train f1 : 0.714, valid f1 : 0.633
training process - Deferred Re-weighting:   1%|          | 1/128 [01:03<2:13:35, 63.12s/it]Best score increase :0.000 -> 0.633
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:57<2:01:26, 57.83s/it]Best score increase :0.633 -> 0.670
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:49<1:55:32, 55.46s/it]Best score increase :0.670 -> 0.680
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:41<1:51:13, 53.82s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.396, valid loss : 0.357, train f1 : 0.826, valid f1 : 0.711
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:41<1:54:59, 56.09s/it]Best score increase :0.680 -> 0.711
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:33<1:51:32, 54.86s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:25<1:48:48, 53.95s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:16<1:45:39, 52.83s/it]EarlyStopping counter : 3 out of 12
epoch : 9, train loss : 0.345, valid loss : 0.355, train f1 : 0.848, valid f1 : 0.688
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:17<1:50:06, 55.51s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:08<1:46:09, 53.98s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:58<1:43:03, 52.85s/it]Best score increase :0.711 -> 0.728
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:50<1:41:41, 52.60s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.304, valid loss : 0.309, train f1 : 0.871, valid f1 : 0.727
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:51<1:45:56, 55.27s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:44<1:43:11, 54.31s/it]Best score increase :0.728 -> 0.732
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:36<1:41:02, 53.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:27<1:38:54, 52.99s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.262, valid loss : 0.318, train f1 : 0.893, valid f1 : 0.716
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:30<1:43:41, 56.05s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:21<1:39:55, 54.51s/it]Best score increase :0.732 -> 0.768
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:13<1:37:44, 53.81s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:08<1:37:25, 54.13s/it]Best score increase :0.768 -> 0.778
epoch : 21, train loss : 0.232, valid loss : 0.250, train f1 : 0.904, valid f1 : 0.760
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:07<1:39:13, 55.64s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:59<1:36:18, 54.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:51<1:33:40, 53.53s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:42<1:31:37, 52.86s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.216, valid loss : 0.268, train f1 : 0.913, valid f1 : 0.767
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:43<1:35:01, 55.35s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:36<1:32:49, 54.60s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:27<1:30:09, 53.56s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:18<1:28:11, 52.91s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.192, valid loss : 0.254, train f1 : 0.924, valid f1 : 0.775
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:22<1:32:40, 56.17s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:16<1:30:36, 55.48s/it]Best score increase :0.778 -> 0.792
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:12<1:30:06, 55.73s/it]Best score increase :0.792 -> 0.805
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:05<1:27:29, 54.68s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.190, valid loss : 0.212, train f1 : 0.925, valid f1 : 0.811
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [30:15<1:34:06, 59.43s/it]Best score increase :0.805 -> 0.811
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [31:14<1:32:48, 59.24s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [32:13<1:31:49, 59.24s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [33:12<1:30:33, 59.06s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.174, valid loss : 0.206, train f1 : 0.931, valid f1 : 0.805
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [34:18<1:32:56, 61.28s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [35:13<1:28:51, 59.23s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [36:08<1:26:12, 58.12s/it]Best score increase :0.811 -> 0.814
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [37:13<1:27:58, 59.98s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.166, valid loss : 0.245, train f1 : 0.935, valid f1 : 0.773
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [38:30<1:34:38, 65.27s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [39:42<1:36:30, 67.33s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [40:42<1:32:03, 64.98s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [41:40<1:28:05, 62.92s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.156, valid loss : 0.211, train f1 : 0.942, valid f1 : 0.784
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [42:50<1:29:58, 65.04s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [43:49<1:26:18, 63.15s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [44:48<1:23:32, 61.88s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [45:46<1:21:18, 60.99s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.151, valid loss : 0.189, train f1 : 0.940, valid f1 : 0.813
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [47:00<1:25:05, 64.63s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [47:54<1:19:59, 61.53s/it]Best score increase :0.814 -> 0.826
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [48:46<1:15:10, 58.58s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [49:39<1:12:22, 57.14s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.135, valid loss : 0.239, train f1 : 0.947, valid f1 : 0.785
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [50:45<1:14:40, 59.74s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [51:42<1:12:33, 58.84s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [52:37<1:10:06, 57.62s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [53:31<1:07:52, 56.56s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.139, valid loss : 0.208, train f1 : 0.944, valid f1 : 0.811
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [54:35<1:09:49, 59.01s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [55:34<1:08:43, 58.91s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [56:33<1:07:43, 58.89s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [57:32<1:06:36, 58.78s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.135, valid loss : 0.213, train f1 : 0.946, valid f1 : 0.808
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [58:43<1:09:53, 62.58s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [59:39<1:05:32, 58.69s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.826
training process finished, best loss : 0.174, best acc : 0.939, best f1 : 0.826, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.76      0.70       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.86      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.86, test loss : 9.256

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.66s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.64s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.72s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.69s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.66s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.83s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.83s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.89s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.86s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.81s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.81s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.80s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.79s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 89.60it/s]  9%|▉         | 28/306 [00:00<00:01, 140.52it/s] 14%|█▍        | 44/306 [00:00<00:01, 143.43it/s] 19%|█▉        | 59/306 [00:00<00:02, 116.92it/s] 26%|██▌       | 79/306 [00:00<00:01, 137.81it/s] 31%|███       | 94/306 [00:00<00:01, 138.51it/s] 36%|███▌      | 109/306 [00:00<00:01, 120.31it/s] 45%|████▌     | 139/306 [00:00<00:00, 167.08it/s] 52%|█████▏    | 159/306 [00:01<00:00, 172.75it/s] 58%|█████▊    | 178/306 [00:01<00:00, 154.87it/s] 64%|██████▎   | 195/306 [00:01<00:00, 148.32it/s] 69%|██████▉   | 211/306 [00:01<00:00, 142.95it/s] 74%|███████▍  | 226/306 [00:01<00:00, 135.62it/s] 78%|███████▊  | 240/306 [00:01<00:00, 130.92it/s] 84%|████████▍ | 257/306 [00:01<00:00, 137.57it/s] 89%|████████▉ | 273/306 [00:01<00:00, 141.93it/s] 94%|█████████▍| 288/306 [00:02<00:00, 125.14it/s]100%|██████████| 306/306 [00:02<00:00, 140.41it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 479.78it/s]extract the null data:  18%|█▊        | 98/553 [00:00<00:00, 489.77it/s]extract the null data:  27%|██▋       | 147/553 [00:00<00:00, 480.66it/s]extract the null data:  36%|███▌      | 197/553 [00:00<00:00, 485.24it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 481.77it/s]extract the null data:  53%|█████▎    | 295/553 [00:00<00:00, 482.64it/s]extract the null data:  63%|██████▎   | 351/553 [00:00<00:00, 506.83it/s]extract the null data:  74%|███████▍  | 409/553 [00:00<00:00, 529.45it/s]extract the null data:  84%|████████▎ | 462/553 [00:00<00:00, 528.91it/s]extract the null data:  93%|█████████▎| 515/553 [00:01<00:00, 524.84it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 505.72it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 184.94it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 185.73it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 183.68it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 186.85it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:02, 188.37it/s]replace nan value:  21%|██        | 116/553 [00:00<00:02, 186.34it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 183.96it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:02, 183.86it/s]replace nan value:  31%|███▏      | 173/553 [00:00<00:02, 183.96it/s]replace nan value:  35%|███▍      | 193/553 [00:01<00:01, 188.63it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 191.55it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:01, 196.79it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 193.33it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 188.10it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 189.45it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 188.06it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 188.82it/s]replace nan value:  64%|██████▍   | 353/553 [00:01<00:01, 189.53it/s]replace nan value:  68%|██████▊   | 374/553 [00:01<00:00, 193.12it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:00, 192.29it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 189.59it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 186.08it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 188.28it/s]replace nan value:  86%|████████▌ | 473/553 [00:02<00:00, 189.33it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 190.69it/s]replace nan value:  93%|█████████▎| 514/553 [00:02<00:00, 194.43it/s]replace nan value:  97%|█████████▋| 534/553 [00:02<00:00, 192.40it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 188.81it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.21it/s]  5%|▌         | 28/553 [00:00<00:03, 137.89it/s]  8%|▊         | 42/553 [00:00<00:03, 130.84it/s] 10%|█         | 56/553 [00:00<00:04, 121.62it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.38it/s] 15%|█▌        | 84/553 [00:00<00:03, 121.74it/s] 18%|█▊        | 97/553 [00:00<00:03, 123.29it/s] 20%|██        | 112/553 [00:00<00:03, 129.54it/s] 23%|██▎       | 126/553 [00:01<00:03, 125.66it/s] 26%|██▌       | 144/553 [00:01<00:02, 139.28it/s] 29%|██▉       | 161/553 [00:01<00:02, 147.90it/s] 32%|███▏      | 176/553 [00:01<00:02, 147.53it/s] 35%|███▍      | 192/553 [00:01<00:02, 147.98it/s] 38%|███▊      | 210/553 [00:01<00:02, 151.93it/s] 41%|████      | 226/553 [00:01<00:02, 142.62it/s] 44%|████▎     | 241/553 [00:01<00:02, 143.81it/s] 46%|████▋     | 256/553 [00:01<00:02, 137.36it/s] 49%|████▉     | 270/553 [00:01<00:02, 136.44it/s] 51%|█████▏    | 284/553 [00:02<00:02, 133.88it/s] 54%|█████▍    | 298/553 [00:02<00:01, 129.40it/s] 56%|█████▌    | 311/553 [00:02<00:01, 126.04it/s] 59%|█████▊    | 324/553 [00:02<00:01, 126.91it/s] 61%|██████    | 337/553 [00:02<00:01, 127.72it/s] 63%|██████▎   | 350/553 [00:02<00:01, 126.72it/s] 66%|██████▌   | 363/553 [00:02<00:01, 123.22it/s] 68%|██████▊   | 377/553 [00:02<00:01, 127.70it/s] 71%|███████   | 390/553 [00:02<00:01, 116.49it/s] 73%|███████▎  | 402/553 [00:03<00:01, 116.60it/s] 75%|███████▌  | 416/553 [00:03<00:01, 117.93it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.52it/s] 80%|████████  | 445/553 [00:03<00:00, 126.77it/s] 83%|████████▎ | 460/553 [00:03<00:00, 132.27it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.36it/s] 88%|████████▊ | 488/553 [00:03<00:00, 128.35it/s] 91%|█████████ | 501/553 [00:03<00:00, 121.18it/s] 93%|█████████▎| 516/553 [00:03<00:00, 127.37it/s] 96%|█████████▌| 529/553 [00:04<00:00, 112.85it/s] 98%|█████████▊| 541/553 [00:04<00:00, 113.42it/s]100%|██████████| 553/553 [00:04<00:00, 98.96it/s] 100%|██████████| 553/553 [00:04<00:00, 125.92it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 287.06it/s]extract the null data:  61%|██████    | 85/139 [00:00<00:00, 446.24it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 471.01it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 189.82it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 192.82it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 195.81it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 202.91it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 206.82it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 206.56it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 202.29it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.26it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.32it/s] 27%|██▋       | 38/139 [00:00<00:00, 125.67it/s] 37%|███▋      | 51/139 [00:00<00:00, 121.65it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.31it/s] 55%|█████▌    | 77/139 [00:00<00:00, 117.52it/s] 64%|██████▍   | 89/139 [00:00<00:00, 106.38it/s] 74%|███████▍  | 103/139 [00:00<00:00, 114.29it/s] 83%|████████▎ | 115/139 [00:00<00:00, 115.06it/s] 92%|█████████▏| 128/139 [00:01<00:00, 117.46it/s]100%|██████████| 139/139 [00:01<00:00, 117.55it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 269.88it/s]extract the null data:  48%|████▊     | 83/173 [00:00<00:00, 440.40it/s]extract the null data:  81%|████████  | 140/173 [00:00<00:00, 499.03it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 475.18it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 188.95it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 188.11it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 188.42it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 189.29it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 189.28it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 190.76it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 190.22it/s]replace nan value:  90%|█████████ | 156/173 [00:00<00:00, 189.94it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 189.40it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 126.37it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.91it/s] 24%|██▎       | 41/173 [00:00<00:01, 121.01it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.19it/s] 39%|███▉      | 68/173 [00:00<00:00, 126.64it/s] 47%|████▋     | 81/173 [00:00<00:00, 126.32it/s] 54%|█████▍    | 94/173 [00:00<00:00, 127.07it/s] 62%|██████▏   | 107/173 [00:00<00:00, 126.38it/s] 69%|██████▉   | 120/173 [00:00<00:00, 126.91it/s] 77%|███████▋  | 133/173 [00:01<00:00, 120.65it/s] 84%|████████▍ | 146/173 [00:01<00:00, 121.18it/s] 92%|█████████▏| 159/173 [00:01<00:00, 114.51it/s] 99%|█████████▉| 171/173 [00:01<00:00, 89.55it/s] 100%|██████████| 173/173 [00:01<00:00, 112.85it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.159, valid loss : 0.084, train acc : 0.647, valid acc : 0.926, train f1 : 0.489, valid f1 : 0.644
training process:   1%|          | 1/128 [01:00<2:08:35, 60.75s/it]Best score increase :0.000 -> 0.644
training process:   2%|▏         | 2/128 [01:49<1:52:38, 53.64s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:37<1:46:12, 50.98s/it]Best score increase :0.644 -> 0.671
training process:   3%|▎         | 4/128 [03:24<1:42:29, 49.59s/it]Best score increase :0.671 -> 0.679
epoch : 5, train loss : 0.048, valid loss : 0.053, train acc : 0.940, valid acc : 0.933, train f1 : 0.722, valid f1 : 0.690
training process:   4%|▍         | 5/128 [04:23<1:48:19, 52.84s/it]Best score increase :0.679 -> 0.690
training process:   5%|▍         | 6/128 [05:11<1:44:10, 51.23s/it]Best score increase :0.690 -> 0.709
training process:   5%|▌         | 7/128 [06:03<1:44:00, 51.57s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [06:53<1:42:08, 51.07s/it]Best score increase :0.709 -> 0.717
epoch : 9, train loss : 0.043, valid loss : 0.051, train acc : 0.946, valid acc : 0.937, train f1 : 0.758, valid f1 : 0.708
training process:   7%|▋         | 9/128 [07:56<1:48:38, 54.78s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:48<1:46:13, 54.02s/it]Best score increase :0.717 -> 0.727
training process:   9%|▊         | 11/128 [09:40<1:44:04, 53.37s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:33<1:42:44, 53.14s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.040, valid loss : 0.050, train acc : 0.950, valid acc : 0.939, train f1 : 0.781, valid f1 : 0.738
training process:  10%|█         | 13/128 [11:33<1:45:43, 55.16s/it]Best score increase :0.727 -> 0.738
training process:  11%|█         | 14/128 [12:24<1:42:25, 53.91s/it]Best score increase :0.738 -> 0.740
training process:  12%|█▏        | 15/128 [13:15<1:39:51, 53.03s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:06<1:38:06, 52.56s/it]Best score increase :0.740 -> 0.745
epoch : 17, train loss : 0.037, valid loss : 0.047, train acc : 0.952, valid acc : 0.939, train f1 : 0.797, valid f1 : 0.746
training process:  13%|█▎        | 17/128 [15:05<1:40:51, 54.52s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:59<1:39:14, 54.13s/it]Best score increase :0.745 -> 0.749
training process:  15%|█▍        | 19/128 [16:50<1:37:04, 53.44s/it]Best score increase :0.749 -> 0.762
training process:  16%|█▌        | 20/128 [17:43<1:35:46, 53.21s/it]Best score increase :0.762 -> 0.768
epoch : 21, train loss : 0.035, valid loss : 0.049, train acc : 0.955, valid acc : 0.942, train f1 : 0.811, valid f1 : 0.747
training process:  16%|█▋        | 21/128 [18:44<1:38:52, 55.45s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:36<1:36:15, 54.49s/it]Best score increase :0.768 -> 0.783
training process:  18%|█▊        | 23/128 [20:29<1:34:30, 54.00s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:21<1:32:45, 53.52s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.049, train acc : 0.957, valid acc : 0.945, train f1 : 0.825, valid f1 : 0.776
training process:  20%|█▉        | 25/128 [22:22<1:35:49, 55.82s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [23:13<1:32:12, 54.24s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [24:06<1:30:40, 53.87s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [25:00<1:29:41, 53.82s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.031, valid loss : 0.050, train acc : 0.959, valid acc : 0.945, train f1 : 0.833, valid f1 : 0.770
training process:  23%|██▎       | 29/128 [26:02<1:32:47, 56.23s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [26:53<1:29:30, 54.80s/it]Best score increase :0.783 -> 0.788
training process:  24%|██▍       | 31/128 [27:45<1:27:25, 54.07s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [28:37<1:25:32, 53.46s/it]Best score increase :0.788 -> 0.789
epoch : 33, train loss : 0.030, valid loss : 0.047, train acc : 0.962, valid acc : 0.947, train f1 : 0.848, valid f1 : 0.796
training process:  26%|██▌       | 33/128 [29:38<1:28:08, 55.67s/it]Best score increase :0.789 -> 0.796
training process:  27%|██▋       | 34/128 [30:28<1:24:34, 53.98s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [31:21<1:23:02, 53.58s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [32:13<1:21:17, 53.02s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.029, valid loss : 0.049, train acc : 0.963, valid acc : 0.947, train f1 : 0.854, valid f1 : 0.794
training process:  29%|██▉       | 37/128 [33:14<1:24:18, 55.59s/it]EarlyStopping counter : 4 out of 12
training process:  30%|██▉       | 38/128 [34:06<1:21:32, 54.36s/it]Best score increase :0.796 -> 0.805
training process:  30%|███       | 39/128 [34:58<1:19:32, 53.62s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [35:50<1:17:58, 53.17s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.027, valid loss : 0.049, train acc : 0.965, valid acc : 0.947, train f1 : 0.862, valid f1 : 0.798
training process:  32%|███▏      | 41/128 [36:52<1:20:57, 55.83s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [37:43<1:18:00, 54.43s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [38:34<1:15:51, 53.55s/it]Best score increase :0.805 -> 0.810
training process:  34%|███▍      | 44/128 [39:27<1:14:41, 53.35s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.026, valid loss : 0.049, train acc : 0.966, valid acc : 0.947, train f1 : 0.866, valid f1 : 0.798
training process:  35%|███▌      | 45/128 [40:28<1:16:42, 55.46s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [41:20<1:14:22, 54.42s/it]EarlyStopping counter : 3 out of 12
training process:  37%|███▋      | 47/128 [42:13<1:12:53, 54.00s/it]EarlyStopping counter : 4 out of 12
training process:  38%|███▊      | 48/128 [43:05<1:11:23, 53.54s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.025, valid loss : 0.050, train acc : 0.966, valid acc : 0.947, train f1 : 0.870, valid f1 : 0.798
training process:  38%|███▊      | 49/128 [44:06<1:13:32, 55.86s/it]EarlyStopping counter : 6 out of 12
training process:  39%|███▉      | 50/128 [44:59<1:11:12, 54.77s/it]EarlyStopping counter : 7 out of 12
training process:  40%|███▉      | 51/128 [45:50<1:09:05, 53.84s/it]EarlyStopping counter : 8 out of 12
training process:  41%|████      | 52/128 [46:43<1:07:40, 53.43s/it]Best score increase :0.810 -> 0.813
epoch : 53, train loss : 0.024, valid loss : 0.051, train acc : 0.968, valid acc : 0.951, train f1 : 0.876, valid f1 : 0.813
training process:  41%|████▏     | 53/128 [47:43<1:09:29, 55.60s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [48:34<1:06:32, 53.95s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [49:24<1:04:31, 53.03s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [50:16<1:03:10, 52.65s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.024, valid loss : 0.050, train acc : 0.969, valid acc : 0.948, train f1 : 0.881, valid f1 : 0.808
training process:  45%|████▍     | 57/128 [51:18<1:05:27, 55.32s/it]EarlyStopping counter : 5 out of 12
training process:  45%|████▌     | 58/128 [52:10<1:03:35, 54.51s/it]EarlyStopping counter : 6 out of 12
training process:  46%|████▌     | 59/128 [53:03<1:01:53, 53.82s/it]EarlyStopping counter : 7 out of 12
training process:  47%|████▋     | 60/128 [53:55<1:00:29, 53.37s/it]EarlyStopping counter : 8 out of 12
epoch : 61, train loss : 0.024, valid loss : 0.051, train acc : 0.969, valid acc : 0.949, train f1 : 0.883, valid f1 : 0.810
training process:  48%|████▊     | 61/128 [54:54<1:01:38, 55.20s/it]EarlyStopping counter : 9 out of 12
training process:  48%|████▊     | 62/128 [55:45<59:21, 53.96s/it]  EarlyStopping counter : 10 out of 12
training process:  49%|████▉     | 63/128 [56:37<57:46, 53.34s/it]EarlyStopping counter : 11 out of 12
training process:  50%|█████     | 64/128 [57:30<56:32, 53.01s/it]Best score increase :0.813 -> 0.815
epoch : 65, train loss : 0.023, valid loss : 0.056, train acc : 0.970, valid acc : 0.948, train f1 : 0.885, valid f1 : 0.809
training process:  51%|█████     | 65/128 [58:29<57:41, 54.94s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [59:19<55:13, 53.45s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:00:11<53:46, 52.90s/it]EarlyStopping counter : 3 out of 12
training process:  53%|█████▎    | 68/128 [1:01:03<52:39, 52.65s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.022, valid loss : 0.054, train acc : 0.970, valid acc : 0.949, train f1 : 0.887, valid f1 : 0.812
training process:  54%|█████▍    | 69/128 [1:02:03<53:59, 54.90s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▍    | 70/128 [1:02:55<52:18, 54.11s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▌    | 71/128 [1:03:48<51:01, 53.72s/it]Best score increase :0.815 -> 0.825
training process:  56%|█████▋    | 72/128 [1:04:39<49:27, 52.99s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.021, valid loss : 0.055, train acc : 0.971, valid acc : 0.949, train f1 : 0.892, valid f1 : 0.814
training process:  57%|█████▋    | 73/128 [1:05:42<51:09, 55.80s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:06:32<48:53, 54.33s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▊    | 75/128 [1:07:25<47:26, 53.72s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▉    | 76/128 [1:08:17<46:05, 53.19s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.022, valid loss : 0.054, train acc : 0.972, valid acc : 0.949, train f1 : 0.894, valid f1 : 0.814
training process:  60%|██████    | 77/128 [1:09:17<47:04, 55.38s/it]EarlyStopping counter : 6 out of 12
training process:  61%|██████    | 78/128 [1:10:10<45:33, 54.67s/it]EarlyStopping counter : 7 out of 12
training process:  62%|██████▏   | 79/128 [1:11:02<43:59, 53.87s/it]EarlyStopping counter : 8 out of 12
training process:  62%|██████▎   | 80/128 [1:11:55<42:54, 53.64s/it]EarlyStopping counter : 9 out of 12
epoch : 81, train loss : 0.020, valid loss : 0.054, train acc : 0.973, valid acc : 0.951, train f1 : 0.898, valid f1 : 0.820
training process:  63%|██████▎   | 81/128 [1:12:56<43:41, 55.77s/it]EarlyStopping counter : 10 out of 12
training process:  64%|██████▍   | 82/128 [1:13:50<42:19, 55.22s/it]Best score increase :0.825 -> 0.841
training process:  65%|██████▍   | 83/128 [1:14:41<40:34, 54.10s/it]EarlyStopping counter : 1 out of 12
training process:  66%|██████▌   | 84/128 [1:15:31<38:45, 52.85s/it]EarlyStopping counter : 2 out of 12
epoch : 85, train loss : 0.021, valid loss : 0.054, train acc : 0.973, valid acc : 0.950, train f1 : 0.899, valid f1 : 0.813
training process:  66%|██████▋   | 85/128 [1:16:26<38:16, 53.42s/it]EarlyStopping counter : 3 out of 12
training process:  67%|██████▋   | 86/128 [1:17:19<37:13, 53.17s/it]EarlyStopping counter : 4 out of 12
training process:  68%|██████▊   | 87/128 [1:18:08<35:37, 52.12s/it]EarlyStopping counter : 5 out of 12
training process:  69%|██████▉   | 88/128 [1:18:58<34:16, 51.41s/it]EarlyStopping counter : 6 out of 12
epoch : 89, train loss : 0.020, valid loss : 0.055, train acc : 0.973, valid acc : 0.949, train f1 : 0.899, valid f1 : 0.818
training process:  70%|██████▉   | 89/128 [1:19:55<34:27, 53.02s/it]EarlyStopping counter : 7 out of 12
training process:  70%|███████   | 90/128 [1:20:45<32:57, 52.05s/it]EarlyStopping counter : 8 out of 12
training process:  71%|███████   | 91/128 [1:21:37<32:05, 52.05s/it]EarlyStopping counter : 9 out of 12
training process:  72%|███████▏  | 92/128 [1:22:25<30:34, 50.95s/it]EarlyStopping counter : 10 out of 12
epoch : 93, train loss : 0.019, valid loss : 0.055, train acc : 0.974, valid acc : 0.951, train f1 : 0.901, valid f1 : 0.826
training process:  73%|███████▎  | 93/128 [1:23:17<29:57, 51.35s/it]EarlyStopping counter : 11 out of 12
training process:  73%|███████▎  | 93/128 [1:24:06<31:39, 54.27s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 93, best f1 score : 0.841
training process finished, best loss : 0.053 and best acc : 0.954, best f1 : 0.841, best epoch : 81

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.84      0.66      0.74       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.91      0.82      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.82, test loss : 2.336

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:18,  7.16s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.37s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.55s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.39s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.33s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:43,  7.31s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.33s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:29,  7.41s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:22,  7.39s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:15,  7.59s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:21<00:07,  7.41s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.29s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.37s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 18/306 [00:00<00:01, 173.81it/s] 12%|█▏        | 36/306 [00:00<00:01, 158.96it/s] 17%|█▋        | 52/306 [00:00<00:01, 138.91it/s] 22%|██▏       | 67/306 [00:00<00:01, 138.17it/s] 27%|██▋       | 84/306 [00:00<00:01, 143.03it/s] 32%|███▏      | 99/306 [00:00<00:01, 138.40it/s] 37%|███▋      | 113/306 [00:00<00:01, 125.81it/s] 44%|████▍     | 134/306 [00:00<00:01, 145.47it/s] 49%|████▉     | 150/306 [00:01<00:01, 146.60it/s] 54%|█████▍    | 165/306 [00:01<00:01, 126.41it/s] 63%|██████▎   | 192/306 [00:01<00:00, 158.69it/s] 68%|██████▊   | 209/306 [00:01<00:00, 153.09it/s] 74%|███████▎  | 225/306 [00:01<00:00, 131.60it/s] 82%|████████▏ | 251/306 [00:01<00:00, 161.03it/s] 88%|████████▊ | 269/306 [00:01<00:00, 161.55it/s] 93%|█████████▎| 286/306 [00:02<00:00, 133.18it/s]100%|██████████| 306/306 [00:02<00:00, 147.49it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 463.16it/s]extract the null data:  17%|█▋        | 96/553 [00:00<00:00, 473.52it/s]extract the null data:  26%|██▌       | 145/553 [00:00<00:00, 477.97it/s]extract the null data:  35%|███▍      | 193/553 [00:00<00:00, 471.34it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 468.68it/s]extract the null data:  53%|█████▎    | 292/553 [00:00<00:00, 480.82it/s]extract the null data:  63%|██████▎   | 346/553 [00:00<00:00, 498.09it/s]extract the null data:  72%|███████▏  | 397/553 [00:00<00:00, 499.69it/s]extract the null data:  81%|████████  | 447/553 [00:00<00:00, 490.86it/s]extract the null data:  90%|████████▉ | 497/553 [00:01<00:00, 486.18it/s]extract the null data:  99%|█████████▉| 547/553 [00:01<00:00, 487.94it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 485.30it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:02, 224.42it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 199.83it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:02, 187.61it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 184.41it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 181.38it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 182.50it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 182.94it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:02, 183.28it/s]replace nan value:  33%|███▎      | 181/553 [00:00<00:02, 183.12it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:01, 183.36it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 182.71it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 182.11it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:01, 181.32it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 191.23it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 200.70it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 196.39it/s]replace nan value:  62%|██████▏   | 343/553 [00:01<00:01, 191.28it/s]replace nan value:  66%|██████▌   | 363/553 [00:01<00:01, 185.20it/s]replace nan value:  69%|██████▉   | 382/553 [00:02<00:00, 183.22it/s]replace nan value:  73%|███████▎  | 401/553 [00:02<00:00, 181.06it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 181.29it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 179.14it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 178.76it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 177.45it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 175.92it/s]replace nan value:  92%|█████████▏| 511/553 [00:02<00:00, 174.91it/s]replace nan value:  96%|█████████▌| 529/553 [00:02<00:00, 174.88it/s]replace nan value:  99%|█████████▉| 548/553 [00:02<00:00, 176.48it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 183.09it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.25it/s]  5%|▍         | 27/553 [00:00<00:03, 133.54it/s]  7%|▋         | 41/553 [00:00<00:03, 135.21it/s] 10%|▉         | 55/553 [00:00<00:03, 127.00it/s] 12%|█▏        | 68/553 [00:00<00:04, 116.15it/s] 15%|█▌        | 84/553 [00:00<00:03, 125.82it/s] 18%|█▊        | 97/553 [00:00<00:03, 126.44it/s] 20%|██        | 112/553 [00:00<00:03, 131.35it/s] 23%|██▎       | 126/553 [00:00<00:03, 127.34it/s] 26%|██▌       | 144/553 [00:01<00:02, 141.60it/s] 29%|██▉       | 162/553 [00:01<00:02, 149.43it/s] 32%|███▏      | 178/553 [00:01<00:02, 148.34it/s] 35%|███▌      | 195/553 [00:01<00:02, 153.49it/s] 38%|███▊      | 212/553 [00:01<00:02, 158.00it/s] 41%|████      | 228/553 [00:01<00:02, 146.97it/s] 44%|████▍     | 243/553 [00:01<00:02, 143.91it/s] 47%|████▋     | 258/553 [00:01<00:02, 142.92it/s] 49%|████▉     | 273/553 [00:01<00:02, 139.89it/s] 52%|█████▏    | 288/553 [00:02<00:01, 141.57it/s] 55%|█████▍    | 303/553 [00:02<00:01, 133.74it/s] 57%|█████▋    | 317/553 [00:02<00:01, 125.26it/s] 60%|█████▉    | 330/553 [00:02<00:01, 125.51it/s] 62%|██████▏   | 345/553 [00:02<00:01, 128.58it/s] 65%|██████▍   | 358/553 [00:02<00:01, 128.00it/s] 67%|██████▋   | 373/553 [00:02<00:01, 133.75it/s] 70%|██████▉   | 387/553 [00:02<00:01, 125.20it/s] 72%|███████▏  | 400/553 [00:02<00:01, 118.64it/s] 75%|███████▌  | 415/553 [00:03<00:01, 125.23it/s] 77%|███████▋  | 428/553 [00:03<00:01, 116.13it/s] 81%|████████  | 446/553 [00:03<00:00, 131.42it/s] 83%|████████▎ | 461/553 [00:03<00:00, 135.70it/s] 86%|████████▌ | 475/553 [00:03<00:00, 135.53it/s] 88%|████████▊ | 489/553 [00:03<00:00, 128.58it/s] 91%|█████████ | 503/553 [00:03<00:00, 123.38it/s] 94%|█████████▍| 519/553 [00:03<00:00, 132.88it/s] 96%|█████████▋| 533/553 [00:04<00:00, 113.20it/s] 99%|█████████▉| 549/553 [00:04<00:00, 123.21it/s]100%|██████████| 553/553 [00:04<00:00, 129.39it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 278.42it/s]extract the null data:  60%|██████    | 84/139 [00:00<00:00, 441.40it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 490.75it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 460.66it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 188.11it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 191.37it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 194.19it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 192.93it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 191.91it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 191.89it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.70it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 192.73it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.67it/s] 17%|█▋        | 24/139 [00:00<00:00, 120.58it/s] 27%|██▋       | 38/139 [00:00<00:00, 128.11it/s] 37%|███▋      | 51/139 [00:00<00:00, 128.09it/s] 47%|████▋     | 66/139 [00:00<00:00, 134.64it/s] 58%|█████▊    | 80/139 [00:00<00:00, 128.75it/s] 67%|██████▋   | 93/139 [00:00<00:00, 115.75it/s] 76%|███████▋  | 106/139 [00:00<00:00, 117.97it/s] 88%|████████▊ | 122/139 [00:00<00:00, 125.95it/s] 97%|█████████▋| 135/139 [00:01<00:00, 122.50it/s]100%|██████████| 139/139 [00:01<00:00, 124.68it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 275.61it/s]extract the null data:  50%|█████     | 87/173 [00:00<00:00, 455.42it/s]extract the null data:  83%|████████▎ | 143/173 [00:00<00:00, 499.92it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 475.57it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 199.62it/s]replace nan value:  24%|██▎       | 41/173 [00:00<00:00, 201.28it/s]replace nan value:  36%|███▌      | 62/173 [00:00<00:00, 199.41it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 204.40it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 222.00it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 218.43it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 208.41it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.36it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 136.07it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.11it/s] 25%|██▍       | 43/173 [00:00<00:01, 129.00it/s] 34%|███▍      | 59/173 [00:00<00:00, 137.54it/s] 42%|████▏     | 73/173 [00:00<00:00, 135.73it/s] 50%|█████     | 87/173 [00:00<00:00, 131.89it/s] 58%|█████▊    | 101/173 [00:00<00:00, 132.64it/s] 67%|██████▋   | 116/173 [00:00<00:00, 135.92it/s] 75%|███████▌  | 130/173 [00:00<00:00, 130.37it/s] 83%|████████▎ | 144/173 [00:01<00:00, 132.93it/s] 91%|█████████▏| 158/173 [00:01<00:00, 127.90it/s] 99%|█████████▉| 171/173 [00:01<00:00, 96.99it/s] 100%|██████████| 173/173 [00:01<00:00, 120.52it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.139, valid loss : 0.111, train acc : 0.723, valid acc : 0.840, train f1 : 0.720, valid f1 : 0.667
training process:   1%|          | 1/128 [01:03<2:15:07, 63.84s/it]Best score increase :0.000 -> 0.667
training process:   2%|▏         | 2/128 [01:56<2:00:18, 57.29s/it]Best score increase :0.667 -> 0.678
training process:   2%|▏         | 3/128 [02:46<1:52:44, 54.12s/it]EarlyStopping counter : 1 out of 12
training process:   3%|▎         | 4/128 [03:38<1:49:54, 53.18s/it]EarlyStopping counter : 2 out of 12
epoch : 5, train loss : 0.095, valid loss : 0.089, train acc : 0.839, valid acc : 0.878, train f1 : 0.839, valid f1 : 0.711
training process:   4%|▍         | 5/128 [04:40<1:55:27, 56.32s/it]Best score increase :0.678 -> 0.711
training process:   5%|▍         | 6/128 [05:30<1:50:01, 54.11s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:21<1:46:56, 53.03s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:14<1:46:02, 53.02s/it]Best score increase :0.711 -> 0.714
epoch : 9, train loss : 0.084, valid loss : 0.092, train acc : 0.861, valid acc : 0.860, train f1 : 0.861, valid f1 : 0.697
training process:   7%|▋         | 9/128 [08:13<1:49:21, 55.14s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:05<1:45:58, 53.88s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:54<1:42:14, 52.43s/it]Best score increase :0.714 -> 0.739
training process:   9%|▉         | 12/128 [10:43<1:39:38, 51.54s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.076, valid loss : 0.085, train acc : 0.879, valid acc : 0.889, train f1 : 0.879, valid f1 : 0.737
training process:  10%|█         | 13/128 [11:39<1:41:33, 52.99s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:29<1:38:52, 52.04s/it]Best score increase :0.739 -> 0.741
training process:  12%|█▏        | 15/128 [13:19<1:36:56, 51.47s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:06<1:33:30, 50.09s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.068, valid loss : 0.092, train acc : 0.894, valid acc : 0.867, train f1 : 0.894, valid f1 : 0.715
training process:  13%|█▎        | 17/128 [15:03<1:36:08, 51.97s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [15:55<1:35:23, 52.04s/it]Best score increase :0.741 -> 0.743
training process:  15%|█▍        | 19/128 [16:44<1:32:57, 51.17s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [17:33<1:31:00, 50.56s/it]Best score increase :0.743 -> 0.759
epoch : 21, train loss : 0.061, valid loss : 0.075, train acc : 0.904, valid acc : 0.901, train f1 : 0.904, valid f1 : 0.754
training process:  16%|█▋        | 21/128 [18:33<1:35:19, 53.45s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:25<1:33:34, 52.97s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:17<1:31:54, 52.52s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:10<1:31:19, 52.69s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.058, valid loss : 0.078, train acc : 0.913, valid acc : 0.902, train f1 : 0.913, valid f1 : 0.762
training process:  20%|█▉        | 25/128 [22:10<1:34:20, 54.96s/it]Best score increase :0.759 -> 0.762
training process:  20%|██        | 26/128 [23:01<1:31:37, 53.90s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [23:54<1:29:48, 53.35s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [24:47<1:28:54, 53.35s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.052, valid loss : 0.084, train acc : 0.921, valid acc : 0.900, train f1 : 0.921, valid f1 : 0.762
training process:  23%|██▎       | 29/128 [25:46<1:30:58, 55.14s/it]EarlyStopping counter : 4 out of 12
training process:  23%|██▎       | 30/128 [26:36<1:27:40, 53.68s/it]Best score increase :0.762 -> 0.785
training process:  24%|██▍       | 31/128 [27:26<1:24:58, 52.57s/it]Best score increase :0.785 -> 0.788
training process:  25%|██▌       | 32/128 [28:18<1:23:33, 52.22s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.051, valid loss : 0.068, train acc : 0.920, valid acc : 0.921, train f1 : 0.920, valid f1 : 0.796
training process:  26%|██▌       | 33/128 [29:17<1:26:00, 54.32s/it]Best score increase :0.788 -> 0.796
training process:  27%|██▋       | 34/128 [30:09<1:24:10, 53.73s/it]Best score increase :0.796 -> 0.802
training process:  27%|██▋       | 35/128 [31:01<1:22:19, 53.11s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [31:55<1:21:52, 53.39s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.048, valid loss : 0.066, train acc : 0.928, valid acc : 0.925, train f1 : 0.928, valid f1 : 0.798
training process:  29%|██▉       | 37/128 [32:56<1:24:11, 55.51s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [33:49<1:22:06, 54.74s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:40<1:19:53, 53.86s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [35:31<1:17:37, 52.93s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.046, valid loss : 0.076, train acc : 0.932, valid acc : 0.908, train f1 : 0.932, valid f1 : 0.773
training process:  32%|███▏      | 41/128 [36:29<1:19:06, 54.56s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [37:22<1:17:28, 54.05s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [38:15<1:15:58, 53.62s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [39:06<1:13:53, 52.78s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.044, valid loss : 0.066, train acc : 0.938, valid acc : 0.916, train f1 : 0.938, valid f1 : 0.787
training process:  35%|███▌      | 45/128 [40:03<1:14:48, 54.07s/it]EarlyStopping counter : 11 out of 12
training process:  35%|███▌      | 45/128 [40:53<1:15:25, 54.52s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.802
training process finished, best loss : 0.064 and best acc : 0.928, best f1 : 0.802, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.61      0.77      0.68       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.86      0.82      7398
weighted avg       0.95      0.94      0.95      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.86, test loss : 2.969

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.93s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.74s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.70s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.71s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.76s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.78s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.70s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.74s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:22,  7.67s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.69s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.68s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.71s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 126.57it/s] 11%|█         | 34/306 [00:00<00:01, 163.78it/s] 17%|█▋        | 51/306 [00:00<00:01, 130.57it/s] 23%|██▎       | 70/306 [00:00<00:01, 146.15it/s] 28%|██▊       | 86/306 [00:00<00:01, 139.29it/s] 33%|███▎      | 101/306 [00:00<00:01, 125.13it/s] 40%|███▉      | 121/306 [00:00<00:01, 143.19it/s] 44%|████▍     | 136/306 [00:00<00:01, 139.15it/s] 49%|████▉     | 151/306 [00:01<00:01, 123.64it/s] 56%|█████▌    | 172/306 [00:01<00:00, 145.22it/s] 61%|██████▏   | 188/306 [00:01<00:00, 146.72it/s] 67%|██████▋   | 204/306 [00:01<00:00, 123.93it/s] 73%|███████▎  | 223/306 [00:01<00:00, 138.81it/s] 78%|███████▊  | 238/306 [00:01<00:00, 134.87it/s] 83%|████████▎ | 253/306 [00:01<00:00, 119.80it/s] 89%|████████▊ | 271/306 [00:02<00:00, 134.31it/s] 94%|█████████▍| 287/306 [00:02<00:00, 138.13it/s] 99%|█████████▊| 302/306 [00:02<00:00, 119.86it/s]100%|██████████| 306/306 [00:02<00:00, 133.39it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 57/553 [00:00<00:00, 565.44it/s]extract the null data:  21%|██        | 114/553 [00:00<00:00, 554.04it/s]extract the null data:  31%|███       | 170/553 [00:00<00:00, 555.60it/s]extract the null data:  41%|████      | 226/553 [00:00<00:00, 551.53it/s]extract the null data:  51%|█████     | 282/553 [00:00<00:00, 549.38it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 552.30it/s]extract the null data:  71%|███████   | 394/553 [00:00<00:00, 550.37it/s]extract the null data:  82%|████████▏ | 451/553 [00:00<00:00, 555.58it/s]extract the null data:  92%|█████████▏| 509/553 [00:00<00:00, 559.97it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 554.04it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 168.85it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 178.92it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 179.36it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 183.17it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 182.39it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 183.44it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 183.64it/s]replace nan value:  27%|██▋       | 150/553 [00:00<00:02, 187.54it/s]replace nan value:  31%|███       | 169/553 [00:00<00:02, 187.45it/s]replace nan value:  34%|███▍      | 188/553 [00:01<00:01, 186.13it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 186.31it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 185.60it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 183.00it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 180.43it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 183.87it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 181.12it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 185.49it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:01, 191.18it/s]replace nan value:  66%|██████▌   | 364/553 [00:01<00:00, 192.20it/s]replace nan value:  69%|██████▉   | 384/553 [00:02<00:00, 189.11it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 188.95it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 186.43it/s]replace nan value:  80%|███████▉  | 441/553 [00:02<00:00, 184.21it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 188.33it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 184.84it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 185.42it/s]replace nan value:  94%|█████████▎| 518/553 [00:02<00:00, 183.24it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 185.68it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 185.47it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.09it/s]  5%|▌         | 29/553 [00:00<00:03, 140.06it/s]  8%|▊         | 44/553 [00:00<00:03, 129.18it/s] 10%|█         | 58/553 [00:00<00:04, 119.46it/s] 13%|█▎        | 71/553 [00:00<00:04, 118.63it/s] 16%|█▌        | 87/553 [00:00<00:03, 131.15it/s] 18%|█▊        | 101/553 [00:00<00:03, 126.15it/s] 21%|██▏       | 118/553 [00:00<00:03, 138.28it/s] 24%|██▍       | 133/553 [00:01<00:03, 136.69it/s] 27%|██▋       | 151/553 [00:01<00:02, 146.96it/s] 30%|███       | 168/553 [00:01<00:02, 151.76it/s] 33%|███▎      | 184/553 [00:01<00:02, 148.88it/s] 36%|███▋      | 201/553 [00:01<00:02, 154.50it/s] 39%|███▉      | 217/553 [00:01<00:02, 152.81it/s] 42%|████▏     | 233/553 [00:01<00:02, 145.60it/s] 45%|████▌     | 249/553 [00:01<00:02, 145.34it/s] 48%|████▊     | 265/553 [00:01<00:01, 146.14it/s] 51%|█████     | 280/553 [00:01<00:01, 140.51it/s] 53%|█████▎    | 295/553 [00:02<00:01, 136.32it/s] 56%|█████▌    | 309/553 [00:02<00:01, 133.61it/s] 58%|█████▊    | 323/553 [00:02<00:01, 131.36it/s] 61%|██████    | 337/553 [00:02<00:01, 133.32it/s] 63%|██████▎   | 351/553 [00:02<00:01, 133.49it/s] 66%|██████▌   | 365/553 [00:02<00:01, 130.14it/s] 69%|██████▊   | 380/553 [00:02<00:01, 134.07it/s] 71%|███████   | 394/553 [00:02<00:01, 123.22it/s] 74%|███████▎  | 407/553 [00:02<00:01, 124.80it/s] 76%|███████▌  | 420/553 [00:03<00:01, 122.54it/s] 78%|███████▊  | 433/553 [00:03<00:01, 119.31it/s] 82%|████████▏ | 451/553 [00:03<00:00, 133.99it/s] 84%|████████▍ | 466/553 [00:03<00:00, 137.68it/s] 87%|████████▋ | 480/553 [00:03<00:00, 134.01it/s] 89%|████████▉ | 494/553 [00:03<00:00, 129.20it/s] 92%|█████████▏| 509/553 [00:03<00:00, 133.42it/s] 95%|█████████▍| 523/553 [00:03<00:00, 126.99it/s] 97%|█████████▋| 536/553 [00:04<00:00, 116.71it/s]100%|█████████▉| 551/553 [00:04<00:00, 106.83it/s]100%|██████████| 553/553 [00:04<00:00, 131.46it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 40/139 [00:00<00:00, 393.91it/s]extract the null data:  71%|███████   | 98/139 [00:00<00:00, 500.06it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 503.89it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 206.20it/s]replace nan value:  31%|███       | 43/139 [00:00<00:00, 209.93it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 205.74it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 204.94it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 207.56it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 208.10it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 206.97it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:01, 125.66it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.24it/s] 31%|███       | 43/139 [00:00<00:00, 141.38it/s] 42%|████▏     | 58/139 [00:00<00:00, 124.70it/s] 53%|█████▎    | 73/139 [00:00<00:00, 132.11it/s] 63%|██████▎   | 87/139 [00:00<00:00, 118.11it/s] 72%|███████▏  | 100/139 [00:00<00:00, 120.68it/s] 81%|████████▏ | 113/139 [00:00<00:00, 120.90it/s] 92%|█████████▏| 128/139 [00:01<00:00, 128.03it/s]100%|██████████| 139/139 [00:01<00:00, 126.95it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 305.82it/s]extract the null data:  51%|█████▏    | 89/173 [00:00<00:00, 463.46it/s]extract the null data:  90%|█████████ | 156/173 [00:00<00:00, 553.80it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 518.24it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 197.22it/s]replace nan value:  24%|██▎       | 41/173 [00:00<00:00, 201.07it/s]replace nan value:  36%|███▌      | 62/173 [00:00<00:00, 204.18it/s]replace nan value:  48%|████▊     | 83/173 [00:00<00:00, 201.49it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 191.43it/s]replace nan value:  72%|███████▏  | 124/173 [00:00<00:00, 190.54it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 190.96it/s]replace nan value:  95%|█████████▍| 164/173 [00:00<00:00, 189.93it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 192.36it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 135.65it/s] 16%|█▌        | 28/173 [00:00<00:01, 126.50it/s] 25%|██▌       | 44/173 [00:00<00:00, 139.16it/s] 35%|███▍      | 60/173 [00:00<00:00, 146.69it/s] 43%|████▎     | 75/173 [00:00<00:00, 142.65it/s] 53%|█████▎    | 91/173 [00:00<00:00, 147.75it/s] 61%|██████▏   | 106/173 [00:00<00:00, 144.26it/s] 71%|███████   | 122/173 [00:00<00:00, 145.38it/s] 79%|███████▉  | 137/173 [00:00<00:00, 145.83it/s] 88%|████████▊ | 152/173 [00:01<00:00, 146.60it/s] 97%|█████████▋| 167/173 [00:01<00:00, 118.62it/s]100%|██████████| 173/173 [00:01<00:00, 132.10it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.023, valid loss : 0.020, train acc : 0.464, valid acc : 0.735, train f1 : 0.403, valid f1 : 0.589
training process:   1%|          | 1/128 [01:02<2:11:59, 62.36s/it]Best score increase :0.000 -> 0.589
training process:   2%|▏         | 2/128 [01:53<1:57:25, 55.92s/it]Best score increase :0.589 -> 0.678
training process:   2%|▏         | 3/128 [02:45<1:52:52, 54.18s/it]Best score increase :0.678 -> 0.686
training process:   3%|▎         | 4/128 [03:39<1:51:16, 53.84s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.016, valid loss : 0.018, train acc : 0.863, valid acc : 0.875, train f1 : 0.694, valid f1 : 0.710
training process:   4%|▍         | 5/128 [04:40<1:55:56, 56.56s/it]Best score increase :0.686 -> 0.710
training process:   5%|▍         | 6/128 [05:32<1:51:32, 54.86s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:27<1:50:52, 54.98s/it]Best score increase :0.710 -> 0.714
training process:   6%|▋         | 8/128 [07:21<1:49:12, 54.60s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.014, valid loss : 0.018, train acc : 0.883, valid acc : 0.891, train f1 : 0.725, valid f1 : 0.722
training process:   7%|▋         | 9/128 [08:24<1:53:36, 57.28s/it]Best score increase :0.714 -> 0.722
training process:   8%|▊         | 10/128 [09:16<1:49:29, 55.68s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:10<1:47:22, 55.06s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [11:02<1:45:08, 54.38s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.013, valid loss : 0.017, train acc : 0.899, valid acc : 0.877, train f1 : 0.750, valid f1 : 0.715
training process:  10%|█         | 13/128 [12:03<1:47:52, 56.28s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [12:55<1:44:35, 55.05s/it]Best score increase :0.722 -> 0.731
training process:  12%|█▏        | 15/128 [13:47<1:41:57, 54.14s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:38<1:39:16, 53.19s/it]Best score increase :0.731 -> 0.735
epoch : 17, train loss : 0.012, valid loss : 0.017, train acc : 0.910, valid acc : 0.897, train f1 : 0.769, valid f1 : 0.745
training process:  13%|█▎        | 17/128 [15:38<1:41:50, 55.05s/it]Best score increase :0.735 -> 0.745
training process:  14%|█▍        | 18/128 [16:31<1:39:53, 54.49s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [17:25<1:38:38, 54.30s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [18:17<1:36:50, 53.80s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.012, valid loss : 0.019, train acc : 0.915, valid acc : 0.903, train f1 : 0.781, valid f1 : 0.751
training process:  16%|█▋        | 21/128 [19:19<1:39:59, 56.07s/it]Best score increase :0.745 -> 0.751
training process:  17%|█▋        | 22/128 [20:11<1:37:02, 54.93s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [21:03<1:34:51, 54.21s/it]Best score increase :0.751 -> 0.754
training process:  19%|█▉        | 24/128 [21:53<1:31:38, 52.87s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.011, valid loss : 0.019, train acc : 0.925, valid acc : 0.895, train f1 : 0.798, valid f1 : 0.744
training process:  20%|█▉        | 25/128 [22:53<1:34:26, 55.02s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [23:46<1:32:14, 54.26s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [24:38<1:30:23, 53.70s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [25:31<1:28:53, 53.34s/it]Best score increase :0.754 -> 0.765
epoch : 29, train loss : 0.010, valid loss : 0.021, train acc : 0.929, valid acc : 0.915, train f1 : 0.808, valid f1 : 0.764
training process:  23%|██▎       | 29/128 [26:30<1:31:12, 55.28s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [27:23<1:28:52, 54.41s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [28:19<1:28:46, 54.91s/it]Best score increase :0.765 -> 0.778
training process:  25%|██▌       | 32/128 [29:17<1:29:25, 55.89s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.010, valid loss : 0.019, train acc : 0.929, valid acc : 0.902, train f1 : 0.809, valid f1 : 0.756
training process:  26%|██▌       | 33/128 [30:20<1:31:51, 58.01s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [31:16<1:29:55, 57.40s/it]Best score increase :0.778 -> 0.792
training process:  27%|██▋       | 35/128 [32:09<1:27:01, 56.15s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [33:01<1:24:09, 54.89s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.010, valid loss : 0.021, train acc : 0.940, valid acc : 0.913, train f1 : 0.829, valid f1 : 0.769
training process:  29%|██▉       | 37/128 [34:00<1:25:13, 56.19s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [34:53<1:22:29, 55.00s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [35:46<1:20:49, 54.49s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [36:40<1:19:37, 54.29s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.009, valid loss : 0.022, train acc : 0.937, valid acc : 0.911, train f1 : 0.825, valid f1 : 0.771
training process:  32%|███▏      | 41/128 [37:42<1:22:02, 56.58s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [38:35<1:19:48, 55.68s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [39:30<1:18:35, 55.47s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [40:21<1:15:39, 54.05s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.022, train acc : 0.942, valid acc : 0.913, train f1 : 0.834, valid f1 : 0.771
training process:  35%|███▌      | 45/128 [41:21<1:17:10, 55.79s/it]EarlyStopping counter : 11 out of 12
training process:  35%|███▌      | 45/128 [42:15<1:17:57, 56.35s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.792
training process finished, best loss : 0.021 and best acc : 0.925, best f1 : 0.792, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.72      0.65       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.84      0.81      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.84, test loss : 0.984

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.27s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:21,  8.19s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:11,  7.96s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.89s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.85s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:46,  7.80s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:38,  7.79s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.90s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.97s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.96s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.91s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.91s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.92s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 78.41it/s]  8%|▊         | 23/306 [00:00<00:02, 119.30it/s] 12%|█▏        | 37/306 [00:00<00:02, 124.64it/s] 17%|█▋        | 51/306 [00:00<00:02, 126.27it/s] 21%|██        | 64/306 [00:00<00:02, 113.49it/s] 27%|██▋       | 82/306 [00:00<00:01, 132.82it/s] 31%|███▏      | 96/306 [00:00<00:01, 130.75it/s] 36%|███▌      | 110/306 [00:00<00:01, 112.84it/s] 42%|████▏     | 130/306 [00:01<00:01, 131.48it/s] 48%|████▊     | 146/306 [00:01<00:01, 137.28it/s] 53%|█████▎    | 161/306 [00:01<00:01, 117.45it/s] 59%|█████▉    | 182/306 [00:01<00:00, 139.30it/s] 64%|██████▍   | 197/306 [00:01<00:00, 136.87it/s] 69%|██████▉   | 212/306 [00:01<00:00, 116.73it/s] 76%|███████▌  | 233/306 [00:01<00:00, 135.25it/s] 81%|████████  | 248/306 [00:01<00:00, 136.18it/s] 86%|████████▌ | 263/306 [00:02<00:00, 117.52it/s] 92%|█████████▏| 283/306 [00:02<00:00, 135.91it/s] 97%|█████████▋| 298/306 [00:02<00:00, 134.52it/s]100%|██████████| 306/306 [00:02<00:00, 126.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 457.10it/s]extract the null data:  17%|█▋        | 94/553 [00:00<00:00, 465.17it/s]extract the null data:  25%|██▌       | 141/553 [00:00<00:00, 464.70it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:00, 464.98it/s]extract the null data:  43%|████▎     | 236/553 [00:00<00:00, 468.68it/s]extract the null data:  51%|█████     | 283/553 [00:00<00:00, 466.08it/s]extract the null data:  60%|█████▉    | 330/553 [00:00<00:00, 465.16it/s]extract the null data:  68%|██████▊   | 378/553 [00:00<00:00, 466.80it/s]extract the null data:  77%|███████▋  | 425/553 [00:00<00:00, 465.40it/s]extract the null data:  86%|████████▌ | 474/553 [00:01<00:00, 471.40it/s]extract the null data:  94%|█████████▍| 522/553 [00:01<00:00, 463.39it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 466.10it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 166.44it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.02it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:02, 169.67it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 168.96it/s]replace nan value:  16%|█▌        | 87/553 [00:00<00:02, 170.97it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 171.80it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 172.82it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 172.86it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:02, 174.24it/s]replace nan value:  32%|███▏      | 177/553 [00:01<00:02, 174.60it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:02, 173.67it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 174.03it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 173.33it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 172.92it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 173.59it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 173.11it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 172.95it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 173.01it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 172.73it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 172.81it/s]replace nan value:  68%|██████▊   | 375/553 [00:02<00:01, 172.80it/s]replace nan value:  71%|███████   | 393/553 [00:02<00:00, 171.99it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 171.53it/s]replace nan value:  78%|███████▊  | 429/553 [00:02<00:00, 170.10it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 171.57it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 172.36it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 172.76it/s]replace nan value:  91%|█████████ | 501/553 [00:02<00:00, 172.46it/s]replace nan value:  94%|█████████▍| 519/553 [00:03<00:00, 172.59it/s]replace nan value:  97%|█████████▋| 537/553 [00:03<00:00, 172.43it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 172.33it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.82it/s]  5%|▍         | 27/553 [00:00<00:03, 134.59it/s]  7%|▋         | 41/553 [00:00<00:03, 132.05it/s] 10%|▉         | 55/553 [00:00<00:04, 119.47it/s] 12%|█▏        | 68/553 [00:00<00:04, 109.08it/s] 15%|█▌        | 83/553 [00:00<00:03, 120.07it/s] 18%|█▊        | 97/553 [00:00<00:03, 121.89it/s] 20%|██        | 112/553 [00:00<00:03, 129.06it/s] 23%|██▎       | 126/553 [00:01<00:03, 125.68it/s] 26%|██▌       | 144/553 [00:01<00:02, 139.31it/s] 29%|██▉       | 161/553 [00:01<00:02, 147.98it/s] 32%|███▏      | 176/553 [00:01<00:02, 147.92it/s] 35%|███▍      | 192/553 [00:01<00:02, 148.81it/s] 38%|███▊      | 210/553 [00:01<00:02, 153.37it/s] 41%|████      | 226/553 [00:01<00:02, 144.65it/s] 44%|████▎     | 241/553 [00:01<00:02, 145.93it/s] 46%|████▋     | 256/553 [00:01<00:02, 139.14it/s] 49%|████▉     | 271/553 [00:02<00:02, 136.57it/s] 52%|█████▏    | 286/553 [00:02<00:01, 138.98it/s] 54%|█████▍    | 300/553 [00:02<00:01, 133.28it/s] 57%|█████▋    | 314/553 [00:02<00:01, 127.22it/s] 59%|█████▉    | 327/553 [00:02<00:01, 126.08it/s] 62%|██████▏   | 341/553 [00:02<00:01, 129.68it/s] 64%|██████▍   | 355/553 [00:02<00:01, 124.84it/s] 67%|██████▋   | 369/553 [00:02<00:01, 128.43it/s] 69%|██████▉   | 383/553 [00:02<00:01, 130.81it/s] 72%|███████▏  | 397/553 [00:03<00:01, 113.95it/s] 75%|███████▍  | 413/553 [00:03<00:01, 125.23it/s] 77%|███████▋  | 426/553 [00:03<00:01, 112.43it/s] 80%|███████▉  | 440/553 [00:03<00:00, 118.71it/s] 83%|████████▎ | 457/553 [00:03<00:00, 130.93it/s] 85%|████████▌ | 471/553 [00:03<00:00, 133.26it/s] 88%|████████▊ | 485/553 [00:03<00:00, 132.78it/s] 90%|█████████ | 499/553 [00:03<00:00, 122.64it/s] 93%|█████████▎| 514/553 [00:03<00:00, 127.33it/s] 95%|█████████▌| 527/553 [00:04<00:00, 113.70it/s] 97%|█████████▋| 539/553 [00:04<00:00, 113.15it/s]100%|█████████▉| 551/553 [00:04<00:00, 99.92it/s] 100%|██████████| 553/553 [00:04<00:00, 126.64it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 20/139 [00:00<00:00, 199.39it/s]extract the null data:  53%|█████▎    | 73/139 [00:00<00:00, 389.73it/s]extract the null data:  91%|█████████ | 126/139 [00:00<00:00, 451.44it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 423.17it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 189.22it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 186.67it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 184.39it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 185.57it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 185.44it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 184.82it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 184.68it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 185.30it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.44it/s] 17%|█▋        | 24/139 [00:00<00:00, 120.71it/s] 27%|██▋       | 37/139 [00:00<00:00, 124.69it/s] 36%|███▌      | 50/139 [00:00<00:00, 123.96it/s] 45%|████▌     | 63/139 [00:00<00:00, 120.90it/s] 55%|█████▍    | 76/139 [00:00<00:00, 120.35it/s] 64%|██████▍   | 89/139 [00:00<00:00, 106.14it/s] 73%|███████▎  | 102/139 [00:00<00:00, 112.72it/s] 82%|████████▏ | 114/139 [00:00<00:00, 112.71it/s] 91%|█████████▏| 127/139 [00:01<00:00, 116.38it/s]100%|██████████| 139/139 [00:01<00:00, 117.21it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 207.77it/s]extract the null data:  43%|████▎     | 75/173 [00:00<00:00, 398.31it/s]extract the null data:  73%|███████▎  | 127/173 [00:00<00:00, 451.90it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 437.95it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 183.56it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 183.15it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 187.79it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 187.18it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 188.05it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 188.69it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 187.96it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 187.48it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 183.02it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 185.58it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.29it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.39it/s] 23%|██▎       | 40/173 [00:00<00:01, 117.92it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.92it/s] 39%|███▉      | 68/173 [00:00<00:00, 128.08it/s] 47%|████▋     | 81/173 [00:00<00:00, 128.13it/s] 54%|█████▍    | 94/173 [00:00<00:00, 128.03it/s] 62%|██████▏   | 107/173 [00:00<00:00, 126.21it/s] 69%|██████▉   | 120/173 [00:00<00:00, 125.04it/s] 77%|███████▋  | 133/173 [00:01<00:00, 117.98it/s] 84%|████████▍ | 146/173 [00:01<00:00, 118.14it/s] 91%|█████████▏| 158/173 [00:01<00:00, 110.09it/s] 98%|█████████▊| 170/173 [00:01<00:00, 89.60it/s] 100%|██████████| 173/173 [00:01<00:00, 108.56it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.033, valid loss : 0.030, train acc : 0.571, valid acc : 0.198, train f1 : 0.481, valid f1 : 0.197
training process:   1%|          | 1/128 [01:04<2:15:53, 64.20s/it]Best score increase :0.000 -> 0.197
training process:   2%|▏         | 2/128 [01:58<2:02:14, 58.21s/it]Best score increase :0.197 -> 0.285
training process:   2%|▏         | 3/128 [02:47<1:52:55, 54.21s/it]Best score increase :0.285 -> 0.315
training process:   3%|▎         | 4/128 [03:38<1:49:15, 52.87s/it]Best score increase :0.315 -> 0.360
epoch : 5, train loss : 0.023, valid loss : 0.025, train acc : 0.673, valid acc : 0.461, train f1 : 0.637, valid f1 : 0.409
training process:   4%|▍         | 5/128 [04:40<1:54:59, 56.09s/it]Best score increase :0.360 -> 0.409
training process:   5%|▍         | 6/128 [05:31<1:50:32, 54.37s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:21<1:46:55, 53.02s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:11<1:43:53, 51.95s/it]Best score increase :0.409 -> 0.435
epoch : 9, train loss : 0.020, valid loss : 0.025, train acc : 0.729, valid acc : 0.485, train f1 : 0.707, valid f1 : 0.425
training process:   7%|▋         | 9/128 [08:10<1:47:52, 54.39s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:02<1:44:57, 53.37s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:52<1:42:08, 52.38s/it]Best score increase :0.435 -> 0.474
training process:   9%|▉         | 12/128 [10:41<1:39:17, 51.36s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.018, valid loss : 0.023, train acc : 0.760, valid acc : 0.586, train f1 : 0.746, valid f1 : 0.494
training process:  10%|█         | 13/128 [11:39<1:42:34, 53.51s/it]Best score increase :0.474 -> 0.494
training process:  11%|█         | 14/128 [12:30<1:40:00, 52.64s/it]Best score increase :0.494 -> 0.512
training process:  12%|█▏        | 15/128 [13:21<1:38:04, 52.08s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:07<1:34:18, 50.52s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.016, valid loss : 0.023, train acc : 0.792, valid acc : 0.586, train f1 : 0.783, valid f1 : 0.495
training process:  13%|█▎        | 17/128 [15:04<1:36:44, 52.29s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [15:54<1:34:31, 51.56s/it]Best score increase :0.512 -> 0.524
training process:  15%|█▍        | 19/128 [16:44<1:32:59, 51.19s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [17:34<1:31:28, 50.82s/it]Best score increase :0.524 -> 0.541
epoch : 21, train loss : 0.015, valid loss : 0.022, train acc : 0.819, valid acc : 0.663, train f1 : 0.813, valid f1 : 0.548
training process:  16%|█▋        | 21/128 [18:35<1:36:10, 53.93s/it]Best score increase :0.541 -> 0.548
training process:  17%|█▋        | 22/128 [19:29<1:35:04, 53.81s/it]Best score increase :0.548 -> 0.563
training process:  18%|█▊        | 23/128 [20:21<1:33:32, 53.46s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:13<1:31:39, 52.88s/it]Best score increase :0.563 -> 0.567
epoch : 25, train loss : 0.014, valid loss : 0.023, train acc : 0.834, valid acc : 0.670, train f1 : 0.830, valid f1 : 0.555
training process:  20%|█▉        | 25/128 [22:14<1:34:59, 55.33s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 26/128 [23:07<1:32:55, 54.66s/it]Best score increase :0.567 -> 0.572
training process:  21%|██        | 27/128 [24:00<1:31:13, 54.20s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:52<1:29:19, 53.60s/it]Best score increase :0.572 -> 0.577
epoch : 29, train loss : 0.012, valid loss : 0.022, train acc : 0.858, valid acc : 0.738, train f1 : 0.855, valid f1 : 0.605
training process:  23%|██▎       | 29/128 [25:53<1:31:50, 55.66s/it]Best score increase :0.577 -> 0.605
training process:  23%|██▎       | 30/128 [26:46<1:29:32, 54.82s/it]Best score increase :0.605 -> 0.623
training process:  24%|██▍       | 31/128 [27:39<1:27:43, 54.27s/it]Best score increase :0.623 -> 0.630
training process:  25%|██▌       | 32/128 [28:33<1:26:43, 54.20s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.012, valid loss : 0.020, train acc : 0.863, valid acc : 0.756, train f1 : 0.860, valid f1 : 0.621
training process:  26%|██▌       | 33/128 [29:35<1:29:40, 56.64s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [30:28<1:26:58, 55.51s/it]Best score increase :0.630 -> 0.681
training process:  27%|██▋       | 35/128 [31:19<1:23:53, 54.13s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [32:13<1:22:48, 54.01s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.011, valid loss : 0.021, train acc : 0.872, valid acc : 0.799, train f1 : 0.870, valid f1 : 0.657
training process:  29%|██▉       | 37/128 [33:13<1:24:59, 56.04s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [34:06<1:22:24, 54.94s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:59<1:20:52, 54.52s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [35:51<1:18:49, 53.74s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.011, valid loss : 0.021, train acc : 0.882, valid acc : 0.775, train f1 : 0.880, valid f1 : 0.638
training process:  32%|███▏      | 41/128 [36:52<1:20:53, 55.79s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [37:45<1:18:42, 54.91s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [38:38<1:16:58, 54.33s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [39:32<1:16:01, 54.30s/it]Best score increase :0.681 -> 0.685
epoch : 45, train loss : 0.010, valid loss : 0.020, train acc : 0.889, valid acc : 0.795, train f1 : 0.888, valid f1 : 0.654
training process:  35%|███▌      | 45/128 [40:31<1:17:09, 55.77s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [41:24<1:15:07, 54.97s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [42:17<1:13:18, 54.30s/it]EarlyStopping counter : 3 out of 12
training process:  38%|███▊      | 48/128 [43:10<1:11:47, 53.84s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.010, valid loss : 0.020, train acc : 0.889, valid acc : 0.797, train f1 : 0.888, valid f1 : 0.655
training process:  38%|███▊      | 49/128 [44:11<1:13:46, 56.04s/it]EarlyStopping counter : 5 out of 12
training process:  39%|███▉      | 50/128 [45:05<1:11:59, 55.38s/it]EarlyStopping counter : 6 out of 12
training process:  40%|███▉      | 51/128 [45:57<1:10:00, 54.56s/it]EarlyStopping counter : 7 out of 12
training process:  41%|████      | 52/128 [46:49<1:08:04, 53.74s/it]EarlyStopping counter : 8 out of 12
epoch : 53, train loss : 0.009, valid loss : 0.022, train acc : 0.902, valid acc : 0.763, train f1 : 0.902, valid f1 : 0.628
training process:  41%|████▏     | 53/128 [47:49<1:09:35, 55.67s/it]EarlyStopping counter : 9 out of 12
training process:  42%|████▏     | 54/128 [48:44<1:08:10, 55.27s/it]Best score increase :0.685 -> 0.695
training process:  43%|████▎     | 55/128 [49:35<1:05:50, 54.12s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [50:25<1:03:36, 53.01s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.009, valid loss : 0.021, train acc : 0.903, valid acc : 0.837, train f1 : 0.902, valid f1 : 0.694
training process:  45%|████▍     | 57/128 [51:25<1:05:00, 54.94s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [52:15<1:02:31, 53.60s/it]EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [53:04<59:48, 52.01s/it]  EarlyStopping counter : 5 out of 12
training process:  47%|████▋     | 60/128 [53:54<58:28, 51.60s/it]Best score increase :0.695 -> 0.698
epoch : 61, train loss : 0.009, valid loss : 0.020, train acc : 0.901, valid acc : 0.824, train f1 : 0.900, valid f1 : 0.681
training process:  48%|████▊     | 61/128 [54:54<1:00:09, 53.87s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 62/128 [55:42<57:24, 52.18s/it]  EarlyStopping counter : 2 out of 12
training process:  49%|████▉     | 63/128 [56:28<54:35, 50.40s/it]EarlyStopping counter : 3 out of 12
training process:  50%|█████     | 64/128 [57:16<53:08, 49.83s/it]EarlyStopping counter : 4 out of 12
epoch : 65, train loss : 0.009, valid loss : 0.019, train acc : 0.901, valid acc : 0.816, train f1 : 0.901, valid f1 : 0.675
training process:  51%|█████     | 65/128 [58:16<55:28, 52.83s/it]EarlyStopping counter : 5 out of 12
training process:  52%|█████▏    | 66/128 [59:04<52:53, 51.18s/it]EarlyStopping counter : 6 out of 12
training process:  52%|█████▏    | 67/128 [59:51<50:44, 49.91s/it]EarlyStopping counter : 7 out of 12
training process:  53%|█████▎    | 68/128 [1:00:40<49:53, 49.90s/it]EarlyStopping counter : 8 out of 12
epoch : 69, train loss : 0.009, valid loss : 0.020, train acc : 0.910, valid acc : 0.839, train f1 : 0.909, valid f1 : 0.696
training process:  54%|█████▍    | 69/128 [1:01:40<51:56, 52.82s/it]EarlyStopping counter : 9 out of 12
training process:  55%|█████▍    | 70/128 [1:02:31<50:23, 52.13s/it]EarlyStopping counter : 10 out of 12
training process:  55%|█████▌    | 71/128 [1:03:22<49:23, 51.99s/it]EarlyStopping counter : 11 out of 12
training process:  56%|█████▋    | 72/128 [1:04:13<48:14, 51.69s/it]Best score increase :0.698 -> 0.719
epoch : 73, train loss : 0.008, valid loss : 0.021, train acc : 0.916, valid acc : 0.847, train f1 : 0.915, valid f1 : 0.707
training process:  57%|█████▋    | 73/128 [1:05:13<49:36, 54.12s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:06:03<47:40, 52.98s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:06:53<45:54, 51.97s/it]Best score increase :0.719 -> 0.729
training process:  59%|█████▉    | 76/128 [1:07:45<44:57, 51.87s/it]EarlyStopping counter : 1 out of 12
epoch : 77, train loss : 0.009, valid loss : 0.020, train acc : 0.916, valid acc : 0.871, train f1 : 0.916, valid f1 : 0.733
training process:  60%|██████    | 77/128 [1:08:43<45:51, 53.95s/it]Best score increase :0.729 -> 0.733
training process:  61%|██████    | 78/128 [1:09:38<45:03, 54.08s/it]EarlyStopping counter : 1 out of 12
training process:  62%|██████▏   | 79/128 [1:10:31<43:56, 53.81s/it]EarlyStopping counter : 2 out of 12
training process:  62%|██████▎   | 80/128 [1:11:20<41:57, 52.46s/it]EarlyStopping counter : 3 out of 12
epoch : 81, train loss : 0.008, valid loss : 0.022, train acc : 0.919, valid acc : 0.829, train f1 : 0.918, valid f1 : 0.687
training process:  63%|██████▎   | 81/128 [1:12:24<43:49, 55.95s/it]EarlyStopping counter : 4 out of 12
training process:  64%|██████▍   | 82/128 [1:13:18<42:19, 55.20s/it]EarlyStopping counter : 5 out of 12
training process:  65%|██████▍   | 83/128 [1:14:11<41:01, 54.71s/it]EarlyStopping counter : 6 out of 12
training process:  66%|██████▌   | 84/128 [1:15:01<38:58, 53.15s/it]EarlyStopping counter : 7 out of 12
epoch : 85, train loss : 0.008, valid loss : 0.020, train acc : 0.921, valid acc : 0.847, train f1 : 0.921, valid f1 : 0.705
training process:  66%|██████▋   | 85/128 [1:16:01<39:30, 55.13s/it]EarlyStopping counter : 8 out of 12
training process:  67%|██████▋   | 86/128 [1:16:51<37:39, 53.80s/it]EarlyStopping counter : 9 out of 12
training process:  68%|██████▊   | 87/128 [1:17:42<36:01, 52.71s/it]EarlyStopping counter : 10 out of 12
training process:  69%|██████▉   | 88/128 [1:18:31<34:35, 51.88s/it]EarlyStopping counter : 11 out of 12
epoch : 89, train loss : 0.008, valid loss : 0.020, train acc : 0.922, valid acc : 0.833, train f1 : 0.922, valid f1 : 0.690
training process:  69%|██████▉   | 88/128 [1:19:38<36:12, 54.31s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 88, best f1 score : 0.733
training process finished, best loss : 0.020 and best acc : 0.871, best f1 : 0.733, best epoch : 76

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.38      0.88      0.53       580
           1       0.99      0.88      0.93      6818

    accuracy                           0.88      7398
   macro avg       0.68      0.88      0.73      7398
weighted avg       0.94      0.88      0.90      7398


# test acc : 0.88, test f1 : 0.73, test AUC : 0.88, test loss : 0.779

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.04s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:24,  8.41s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:17,  8.66s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:08,  8.62s/it]processing for feature importance:  42%|████▏     | 5/12 [00:43<01:01,  8.75s/it]processing for feature importance:  50%|█████     | 6/12 [00:52<00:53,  8.83s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:01<00:44,  8.99s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:09<00:35,  8.81s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:18<00:26,  8.70s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:26<00:16,  8.50s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:34<00:08,  8.38s/it]processing for feature importance: 100%|██████████| 12/12 [01:43<00:00,  8.57s/it]processing for feature importance: 100%|██████████| 12/12 [01:43<00:00,  8.63s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 188.92it/s] 14%|█▎        | 42/306 [00:00<00:01, 211.25it/s] 22%|██▏       | 68/306 [00:00<00:01, 225.11it/s] 30%|██▉       | 91/306 [00:00<00:00, 223.62it/s] 37%|███▋      | 114/306 [00:00<00:00, 210.54it/s] 44%|████▍     | 136/306 [00:00<00:00, 207.53it/s] 56%|█████▌    | 172/306 [00:00<00:00, 252.90it/s] 65%|██████▍   | 198/306 [00:00<00:00, 237.69it/s] 73%|███████▎  | 223/306 [00:00<00:00, 227.72it/s] 81%|████████  | 247/306 [00:01<00:00, 222.79it/s] 88%|████████▊ | 270/306 [00:01<00:00, 216.21it/s] 96%|█████████▌| 294/306 [00:01<00:00, 219.77it/s]100%|██████████| 306/306 [00:01<00:00, 221.92it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 65/553 [00:00<00:00, 643.53it/s]extract the null data:  24%|██▎       | 131/553 [00:00<00:00, 652.22it/s]extract the null data:  36%|███▌      | 197/553 [00:00<00:00, 654.52it/s]extract the null data:  48%|████▊     | 264/553 [00:00<00:00, 659.64it/s]extract the null data:  60%|█████▉    | 331/553 [00:00<00:00, 663.04it/s]extract the null data:  72%|███████▏  | 398/553 [00:00<00:00, 657.57it/s]extract the null data:  84%|████████▍ | 464/553 [00:00<00:00, 654.74it/s]extract the null data:  96%|█████████▌| 530/553 [00:00<00:00, 655.04it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 655.33it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 212.43it/s]replace nan value:   8%|▊         | 44/553 [00:00<00:02, 216.18it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:02, 219.63it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 218.63it/s]replace nan value:  20%|██        | 112/553 [00:00<00:02, 220.33it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:01, 222.58it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:01, 222.31it/s]replace nan value:  33%|███▎      | 181/553 [00:00<00:01, 221.98it/s]replace nan value:  37%|███▋      | 204/553 [00:00<00:01, 224.15it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 218.31it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 218.13it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 221.59it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 222.26it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 222.35it/s]replace nan value:  62%|██████▏   | 341/553 [00:01<00:00, 223.11it/s]replace nan value:  66%|██████▌   | 364/553 [00:01<00:00, 223.93it/s]replace nan value:  70%|██████▉   | 387/553 [00:01<00:00, 221.83it/s]replace nan value:  74%|███████▍  | 410/553 [00:01<00:00, 220.20it/s]replace nan value:  78%|███████▊  | 433/553 [00:01<00:00, 220.99it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 221.50it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 221.91it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 226.49it/s]replace nan value:  95%|█████████▌| 527/553 [00:02<00:00, 227.19it/s]replace nan value:  99%|█████████▉| 550/553 [00:02<00:00, 225.49it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 222.09it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 136.44it/s]  5%|▌         | 29/553 [00:00<00:03, 139.00it/s]  8%|▊         | 43/553 [00:00<00:03, 130.40it/s] 10%|█         | 57/553 [00:00<00:04, 119.22it/s] 13%|█▎        | 70/553 [00:00<00:04, 111.43it/s] 16%|█▌        | 86/553 [00:00<00:03, 125.30it/s] 18%|█▊        | 99/553 [00:00<00:03, 120.05it/s] 21%|██        | 116/553 [00:00<00:03, 132.83it/s] 24%|██▎       | 130/553 [00:01<00:03, 132.49it/s] 27%|██▋       | 149/553 [00:01<00:02, 146.62it/s] 30%|██▉       | 165/553 [00:01<00:02, 150.44it/s] 33%|███▎      | 181/553 [00:01<00:02, 151.53it/s] 36%|███▌      | 197/553 [00:01<00:02, 152.00it/s] 39%|███▊      | 214/553 [00:01<00:02, 155.31it/s] 42%|████▏     | 230/553 [00:01<00:02, 144.21it/s] 44%|████▍     | 245/553 [00:01<00:02, 143.45it/s] 47%|████▋     | 261/553 [00:01<00:01, 148.05it/s] 50%|████▉     | 276/553 [00:01<00:02, 138.40it/s] 53%|█████▎    | 292/553 [00:02<00:01, 138.45it/s] 55%|█████▌    | 306/553 [00:02<00:01, 128.78it/s] 58%|█████▊    | 320/553 [00:02<00:01, 130.88it/s] 61%|██████    | 335/553 [00:02<00:01, 135.94it/s] 63%|██████▎   | 350/553 [00:02<00:01, 138.54it/s] 66%|██████▌   | 364/553 [00:02<00:01, 137.20it/s] 69%|██████▊   | 380/553 [00:02<00:01, 142.99it/s] 71%|███████▏  | 395/553 [00:02<00:01, 132.25it/s] 74%|███████▍  | 411/553 [00:02<00:01, 139.15it/s] 77%|███████▋  | 426/553 [00:03<00:01, 126.98it/s] 80%|████████  | 443/553 [00:03<00:00, 137.38it/s] 83%|████████▎ | 461/553 [00:03<00:00, 147.90it/s] 86%|████████▋ | 477/553 [00:03<00:00, 150.41it/s] 89%|████████▉ | 493/553 [00:03<00:00, 140.83it/s] 92%|█████████▏| 509/553 [00:03<00:00, 145.21it/s] 95%|█████████▍| 524/553 [00:03<00:00, 135.64it/s] 97%|█████████▋| 538/553 [00:03<00:00, 128.75it/s]100%|█████████▉| 552/553 [00:04<00:00, 116.70it/s]100%|██████████| 553/553 [00:04<00:00, 135.39it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  32%|███▏      | 44/139 [00:00<00:00, 439.17it/s]extract the null data:  84%|████████▍ | 117/139 [00:00<00:00, 605.62it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 600.12it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 242.66it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 241.56it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 238.31it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 235.39it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 233.59it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 235.32it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 128.51it/s] 21%|██        | 29/139 [00:00<00:00, 136.17it/s] 32%|███▏      | 45/139 [00:00<00:00, 145.37it/s] 43%|████▎     | 60/139 [00:00<00:00, 131.49it/s] 54%|█████▍    | 75/139 [00:00<00:00, 134.34it/s] 64%|██████▍   | 89/139 [00:00<00:00, 121.11it/s] 76%|███████▌  | 105/139 [00:00<00:00, 128.51it/s] 88%|████████▊ | 122/139 [00:00<00:00, 137.47it/s] 98%|█████████▊| 136/139 [00:01<00:00, 136.43it/s]100%|██████████| 139/139 [00:01<00:00, 135.01it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 318.97it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 564.12it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 588.63it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 248.77it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 245.43it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 241.82it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 240.46it/s]replace nan value:  72%|███████▏  | 125/173 [00:00<00:00, 237.65it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 236.43it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 233.45it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 237.28it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 145.48it/s] 17%|█▋        | 30/173 [00:00<00:01, 132.32it/s] 28%|██▊       | 48/173 [00:00<00:00, 149.06it/s] 37%|███▋      | 64/173 [00:00<00:00, 152.59it/s] 46%|████▌     | 80/173 [00:00<00:00, 147.73it/s] 55%|█████▌    | 96/173 [00:00<00:00, 147.85it/s] 65%|██████▌   | 113/173 [00:00<00:00, 152.06it/s] 75%|███████▍  | 129/173 [00:00<00:00, 144.62it/s] 83%|████████▎ | 144/173 [00:00<00:00, 142.36it/s] 92%|█████████▏| 159/173 [00:01<00:00, 130.68it/s]100%|██████████| 173/173 [00:01<00:00, 100.10it/s]100%|██████████| 173/173 [00:01<00:00, 128.14it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.159, valid loss : 0.084, train f1 : 0.489, valid f1 : 0.644
training process - Deferred Re-weighting:   1%|          | 1/128 [00:58<2:03:19, 58.26s/it]Best score increase :0.000 -> 0.644
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:45<1:49:07, 51.97s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:32<1:42:58, 49.42s/it]Best score increase :0.644 -> 0.671
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:18<1:39:55, 48.35s/it]Best score increase :0.671 -> 0.680
epoch : 5, train loss : 0.048, valid loss : 0.053, train f1 : 0.722, valid f1 : 0.695
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:14<1:44:14, 50.85s/it]Best score increase :0.680 -> 0.695
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:00<1:40:34, 49.46s/it]Best score increase :0.695 -> 0.711
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:47<1:37:46, 48.48s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:34<1:36:03, 48.03s/it]Best score increase :0.711 -> 0.721
epoch : 9, train loss : 0.043, valid loss : 0.051, train f1 : 0.760, valid f1 : 0.706
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:28<1:38:45, 49.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:14<1:35:44, 48.68s/it]Best score increase :0.721 -> 0.731
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:00<1:33:21, 47.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [09:46<1:31:45, 47.46s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.039, valid loss : 0.050, train f1 : 0.783, valid f1 : 0.739
training process - Deferred Re-weighting:  10%|█         | 13/128 [10:42<1:35:41, 49.93s/it]Best score increase :0.731 -> 0.739
training process - Deferred Re-weighting:  11%|█         | 14/128 [11:30<1:33:56, 49.44s/it]Best score increase :0.739 -> 0.741
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:18<1:32:03, 48.88s/it]Best score increase :0.741 -> 0.744
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:05<1:30:19, 48.39s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.037, valid loss : 0.046, train f1 : 0.801, valid f1 : 0.748
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:01<1:33:49, 50.72s/it]Best score increase :0.744 -> 0.748
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [14:48<1:30:48, 49.53s/it]Best score increase :0.748 -> 0.750
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [15:34<1:28:14, 48.57s/it]Best score increase :0.750 -> 0.761
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [16:20<1:25:57, 47.76s/it]Best score increase :0.761 -> 0.772
epoch : 21, train loss : 0.034, valid loss : 0.049, train f1 : 0.814, valid f1 : 0.754
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [17:19<1:30:46, 50.90s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [18:09<1:29:56, 50.91s/it]Best score increase :0.772 -> 0.790
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [18:59<1:28:15, 50.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [19:49<1:27:21, 50.40s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.032, valid loss : 0.050, train f1 : 0.832, valid f1 : 0.780
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [20:48<1:30:40, 52.82s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [21:37<1:27:50, 51.67s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [22:27<1:26:19, 51.28s/it]Best score increase :0.790 -> 0.792
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [23:17<1:24:45, 50.85s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.030, valid loss : 0.050, train f1 : 0.842, valid f1 : 0.778
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [24:16<1:28:08, 53.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [25:08<1:26:14, 52.80s/it]Best score increase :0.792 -> 0.806
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [25:59<1:24:36, 52.34s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [26:51<1:23:42, 52.32s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.028, valid loss : 0.047, train f1 : 0.858, valid f1 : 0.806
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [27:53<1:27:26, 55.23s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [28:47<1:25:49, 54.78s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [29:40<1:24:06, 54.26s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [30:32<1:22:01, 53.49s/it]EarlyStopping counter : 6 out of 12
epoch : 37, train loss : 0.027, valid loss : 0.049, train f1 : 0.864, valid f1 : 0.809
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [31:34<1:25:02, 56.07s/it]Best score increase :0.806 -> 0.809
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [32:24<1:21:33, 54.37s/it]Best score increase :0.809 -> 0.818
training process - Deferred Re-weighting:  30%|███       | 39/128 [33:16<1:19:45, 53.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [34:07<1:17:24, 52.78s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.025, valid loss : 0.050, train f1 : 0.873, valid f1 : 0.811
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [35:06<1:19:22, 54.74s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [35:56<1:16:08, 53.12s/it]Best score increase :0.818 -> 0.823
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [36:48<1:15:03, 52.98s/it]Best score increase :0.823 -> 0.824
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [37:38<1:12:51, 52.05s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.024, valid loss : 0.051, train f1 : 0.879, valid f1 : 0.805
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [38:41<1:16:21, 55.20s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [39:32<1:13:43, 53.94s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [40:21<1:10:59, 52.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [41:10<1:08:32, 51.41s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.022, valid loss : 0.051, train f1 : 0.885, valid f1 : 0.812
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [42:08<1:10:33, 53.59s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [43:00<1:09:00, 53.09s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [43:52<1:07:24, 52.52s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [44:44<1:06:42, 52.67s/it]EarlyStopping counter : 9 out of 12
epoch : 53, train loss : 0.022, valid loss : 0.055, train f1 : 0.892, valid f1 : 0.836
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [45:44<1:08:28, 54.78s/it]Best score increase :0.824 -> 0.836
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [46:34<1:05:48, 53.35s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [47:26<1:04:11, 52.76s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [48:23<1:04:59, 54.17s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.022, valid loss : 0.056, train f1 : 0.893, valid f1 : 0.823
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [49:32<1:09:27, 58.70s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [50:30<1:08:03, 58.34s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [51:27<1:06:42, 58.01s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [52:24<1:05:16, 57.60s/it]EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.021, valid loss : 0.057, train f1 : 0.898, valid f1 : 0.826
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [53:29<1:07:02, 60.04s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [54:25<1:04:39, 58.79s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [55:21<1:02:30, 57.71s/it]Best score increase :0.836 -> 0.837
training process - Deferred Re-weighting:  50%|█████     | 64/128 [56:17<1:01:18, 57.48s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.020, valid loss : 0.062, train f1 : 0.905, valid f1 : 0.819
training process - Deferred Re-weighting:  51%|█████     | 65/128 [57:21<1:02:13, 59.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [58:18<1:00:26, 58.50s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [59:13<58:35, 57.64s/it]  EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:00:10<57:15, 57.27s/it]EarlyStopping counter : 5 out of 12
epoch : 69, train loss : 0.019, valid loss : 0.056, train f1 : 0.911, valid f1 : 0.840
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:01:18<59:39, 60.68s/it]Best score increase :0.837 -> 0.840
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:02:14<57:19, 59.30s/it]Best score increase :0.840 -> 0.843
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:03:12<55:45, 58.69s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:04:09<54:31, 58.42s/it]EarlyStopping counter : 2 out of 12
epoch : 73, train loss : 0.018, valid loss : 0.063, train f1 : 0.914, valid f1 : 0.830
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:05:15<55:32, 60.60s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:06:13<53:46, 59.75s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:07:12<52:38, 59.59s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:08:08<50:48, 58.63s/it]EarlyStopping counter : 6 out of 12
epoch : 77, train loss : 0.018, valid loss : 0.057, train f1 : 0.917, valid f1 : 0.838
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:09:14<51:33, 60.66s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:10:08<49:01, 58.83s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  62%|██████▏   | 79/128 [1:11:04<47:17, 57.90s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  62%|██████▎   | 80/128 [1:11:58<45:23, 56.75s/it]EarlyStopping counter : 10 out of 12
epoch : 81, train loss : 0.017, valid loss : 0.059, train f1 : 0.918, valid f1 : 0.841
training process - Deferred Re-weighting:  63%|██████▎   | 81/128 [1:12:58<45:11, 57.69s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  63%|██████▎   | 81/128 [1:13:50<42:50, 54.70s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 81, best f1 score : 0.844
training process finished, best loss : 0.059, best acc : 0.953, best f1 : 0.844, best epoch : 81

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.82      0.66      0.74       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.90      0.83      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.83, test loss : 2.461

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.93s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.08s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.05s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.11s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:55,  7.98s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:47,  7.97s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:40,  8.03s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:32,  8.03s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:24,  8.01s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:20<00:16,  8.00s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:28<00:08,  8.06s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.10s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.05s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 17/306 [00:00<00:01, 159.02it/s] 11%|█         | 33/306 [00:00<00:01, 147.55it/s] 16%|█▌        | 49/306 [00:00<00:01, 150.19it/s] 21%|██        | 65/306 [00:00<00:01, 153.78it/s] 26%|██▋       | 81/306 [00:00<00:01, 136.65it/s] 35%|███▍      | 106/306 [00:00<00:01, 171.13it/s] 42%|████▏     | 130/306 [00:00<00:00, 187.28it/s] 49%|████▉     | 150/306 [00:00<00:01, 153.44it/s] 56%|█████▌    | 171/306 [00:01<00:00, 167.23it/s] 62%|██████▏   | 189/306 [00:01<00:00, 153.51it/s] 67%|██████▋   | 206/306 [00:01<00:00, 156.09it/s] 73%|███████▎  | 223/306 [00:01<00:00, 158.28it/s] 78%|███████▊  | 240/306 [00:01<00:00, 139.90it/s] 86%|████████▌ | 262/306 [00:01<00:00, 155.80it/s] 91%|█████████ | 279/306 [00:01<00:00, 146.77it/s] 98%|█████████▊| 299/306 [00:01<00:00, 159.26it/s]100%|██████████| 306/306 [00:01<00:00, 156.52it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 59/553 [00:00<00:00, 583.62it/s]extract the null data:  22%|██▏       | 119/553 [00:00<00:00, 590.21it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 597.56it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 599.70it/s]extract the null data:  55%|█████▌    | 306/553 [00:00<00:00, 616.18it/s]extract the null data:  68%|██████▊   | 376/553 [00:00<00:00, 641.19it/s]extract the null data:  80%|███████▉  | 441/553 [00:00<00:00, 620.08it/s]extract the null data:  91%|█████████ | 504/553 [00:00<00:00, 613.99it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 610.52it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 190.93it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 194.90it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 196.97it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 198.89it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 199.69it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 201.58it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 201.27it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:01, 201.57it/s]replace nan value:  34%|███▎      | 186/553 [00:00<00:01, 201.54it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 202.41it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 203.76it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 200.56it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 198.86it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 197.58it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 195.94it/s]replace nan value:  60%|█████▉    | 330/553 [00:01<00:01, 195.62it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:01, 199.43it/s]replace nan value:  67%|██████▋   | 371/553 [00:01<00:00, 199.34it/s]replace nan value:  71%|███████   | 391/553 [00:01<00:00, 198.92it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 197.77it/s]replace nan value:  78%|███████▊  | 431/553 [00:02<00:00, 198.40it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 202.80it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 204.47it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 203.31it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 203.44it/s]replace nan value:  97%|█████████▋| 537/553 [00:02<00:00, 203.12it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 200.49it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.44it/s]  5%|▌         | 28/553 [00:00<00:03, 137.42it/s]  8%|▊         | 42/553 [00:00<00:03, 135.53it/s] 10%|█         | 56/553 [00:00<00:03, 127.21it/s] 12%|█▏        | 69/553 [00:00<00:04, 117.22it/s] 15%|█▌        | 85/553 [00:00<00:03, 130.14it/s] 18%|█▊        | 99/553 [00:00<00:03, 126.69it/s] 21%|██        | 117/553 [00:00<00:03, 140.90it/s] 24%|██▍       | 132/553 [00:00<00:02, 140.51it/s] 27%|██▋       | 151/553 [00:01<00:02, 151.95it/s] 31%|███       | 171/553 [00:01<00:02, 162.59it/s] 34%|███▍      | 188/553 [00:01<00:02, 158.50it/s] 38%|███▊      | 209/553 [00:01<00:02, 171.36it/s] 41%|████      | 227/553 [00:01<00:02, 162.89it/s] 44%|████▍     | 244/553 [00:01<00:01, 158.69it/s] 48%|████▊     | 263/553 [00:01<00:01, 166.60it/s] 51%|█████     | 280/553 [00:01<00:01, 154.78it/s] 54%|█████▎    | 296/553 [00:02<00:01, 149.77it/s] 56%|█████▋    | 312/553 [00:02<00:01, 143.82it/s] 59%|█████▉    | 327/553 [00:02<00:01, 143.64it/s] 62%|██████▏   | 344/553 [00:02<00:01, 149.25it/s] 65%|██████▌   | 360/553 [00:02<00:01, 133.06it/s] 68%|██████▊   | 376/553 [00:02<00:01, 137.73it/s] 71%|███████   | 391/553 [00:02<00:01, 124.19it/s] 73%|███████▎  | 404/553 [00:02<00:01, 124.83it/s] 75%|███████▌  | 417/553 [00:02<00:01, 122.11it/s] 78%|███████▊  | 430/553 [00:03<00:01, 117.76it/s] 81%|████████  | 448/553 [00:03<00:00, 132.75it/s] 84%|████████▎ | 463/553 [00:03<00:00, 135.96it/s] 86%|████████▋ | 478/553 [00:03<00:00, 132.99it/s] 89%|████████▉ | 492/553 [00:03<00:00, 128.37it/s] 91%|█████████▏| 505/553 [00:03<00:00, 126.18it/s] 94%|█████████▍| 520/553 [00:03<00:00, 130.75it/s] 97%|█████████▋| 534/553 [00:03<00:00, 112.20it/s] 99%|█████████▉| 548/553 [00:04<00:00, 118.94it/s]100%|██████████| 553/553 [00:04<00:00, 134.29it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 288.87it/s]extract the null data:  62%|██████▏   | 86/139 [00:00<00:00, 450.46it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 463.64it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 188.63it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 189.14it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 189.97it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 191.04it/s]replace nan value:  71%|███████   | 98/139 [00:00<00:00, 192.26it/s]replace nan value:  85%|████████▍ | 118/139 [00:00<00:00, 192.10it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 192.10it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 191.42it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.35it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.28it/s] 27%|██▋       | 38/139 [00:00<00:00, 125.00it/s] 37%|███▋      | 51/139 [00:00<00:00, 121.20it/s] 46%|████▌     | 64/139 [00:00<00:00, 121.77it/s] 55%|█████▌    | 77/139 [00:00<00:00, 118.68it/s] 64%|██████▍   | 89/139 [00:00<00:00, 112.07it/s] 76%|███████▌  | 105/139 [00:00<00:00, 120.95it/s] 88%|████████▊ | 122/139 [00:00<00:00, 130.50it/s] 98%|█████████▊| 136/139 [00:01<00:00, 131.08it/s]100%|██████████| 139/139 [00:01<00:00, 125.06it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  11%|█         | 19/173 [00:00<00:00, 189.77it/s]extract the null data:  43%|████▎     | 74/173 [00:00<00:00, 397.14it/s]extract the null data:  75%|███████▌  | 130/173 [00:00<00:00, 469.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 450.06it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 191.56it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 190.43it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 191.64it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 191.80it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 191.60it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 191.28it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 190.92it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 188.67it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 188.39it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.79it/s] 16%|█▌        | 27/173 [00:00<00:01, 109.89it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.85it/s] 32%|███▏      | 55/173 [00:00<00:00, 124.78it/s] 39%|███▉      | 68/173 [00:00<00:00, 124.63it/s] 47%|████▋     | 81/173 [00:00<00:00, 124.61it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.86it/s] 62%|██████▏   | 107/173 [00:00<00:00, 125.00it/s] 69%|██████▉   | 120/173 [00:00<00:00, 124.63it/s] 77%|███████▋  | 133/173 [00:01<00:00, 118.44it/s] 84%|████████▍ | 146/173 [00:01<00:00, 118.64it/s] 91%|█████████▏| 158/173 [00:01<00:00, 110.00it/s] 98%|█████████▊| 170/173 [00:01<00:00, 89.90it/s] 100%|██████████| 173/173 [00:01<00:00, 107.97it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.139, valid loss : 0.111, train f1 : 0.720, valid f1 : 0.667
training process - Deferred Re-weighting:   1%|          | 1/128 [01:02<2:12:50, 62.76s/it]Best score increase :0.000 -> 0.667
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:55<1:59:08, 56.73s/it]Best score increase :0.667 -> 0.678
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:47<1:53:47, 54.62s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:39<1:50:52, 53.65s/it]EarlyStopping counter : 2 out of 12
epoch : 5, train loss : 0.095, valid loss : 0.089, train f1 : 0.839, valid f1 : 0.712
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:38<1:54:10, 55.70s/it]Best score increase :0.678 -> 0.712
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:30<1:50:30, 54.35s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:22<1:47:40, 53.39s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:13<1:45:20, 52.67s/it]EarlyStopping counter : 3 out of 12
epoch : 9, train loss : 0.083, valid loss : 0.092, train f1 : 0.862, valid f1 : 0.695
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:13<1:49:23, 55.15s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:05<1:46:25, 54.11s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:58<1:44:58, 53.83s/it]Best score increase :0.712 -> 0.738
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:51<1:43:27, 53.51s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.075, valid loss : 0.086, train f1 : 0.880, valid f1 : 0.735
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:52<1:46:42, 55.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:44<1:43:39, 54.56s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:36<1:41:26, 53.86s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:28<1:39:30, 53.31s/it]Best score increase :0.738 -> 0.743
epoch : 17, train loss : 0.065, valid loss : 0.092, train f1 : 0.898, valid f1 : 0.719
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:26<1:41:31, 54.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:18<1:39:00, 54.00s/it]Best score increase :0.743 -> 0.753
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:11<1:37:09, 53.48s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:02<1:35:19, 52.96s/it]Best score increase :0.753 -> 0.773
epoch : 21, train loss : 0.058, valid loss : 0.073, train f1 : 0.909, valid f1 : 0.762
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:02<1:37:55, 54.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:58<1:37:27, 55.17s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:59<1:39:44, 57.00s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:56<1:39:01, 57.13s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.055, valid loss : 0.076, train f1 : 0.917, valid f1 : 0.774
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:05<1:44:04, 60.63s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:04<1:41:56, 59.96s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:04<1:41:11, 60.12s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [26:02<1:39:13, 59.53s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.049, valid loss : 0.082, train f1 : 0.927, valid f1 : 0.767
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:08<1:41:20, 61.42s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [28:04<1:37:35, 59.75s/it]Best score increase :0.773 -> 0.779
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [29:01<1:35:29, 59.07s/it]Best score increase :0.779 -> 0.800
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:53<1:31:05, 56.93s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.048, valid loss : 0.066, train f1 : 0.927, valid f1 : 0.804
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [30:57<1:33:10, 58.85s/it]Best score increase :0.800 -> 0.804
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [31:48<1:28:27, 56.46s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [32:40<1:25:37, 55.24s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [33:32<1:23:11, 54.26s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.044, valid loss : 0.063, train f1 : 0.935, valid f1 : 0.809
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [34:32<1:24:59, 56.04s/it]Best score increase :0.804 -> 0.809
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [35:23<1:21:34, 54.38s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [36:15<1:19:48, 53.81s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [37:06<1:17:38, 52.94s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.042, valid loss : 0.074, train f1 : 0.939, valid f1 : 0.775
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [38:07<1:20:17, 55.37s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [39:01<1:18:42, 54.92s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [39:49<1:15:04, 53.00s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:38<1:12:33, 51.83s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.039, valid loss : 0.062, train f1 : 0.944, valid f1 : 0.793
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:39<1:15:06, 54.30s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [42:28<1:12:08, 52.78s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [43:17<1:09:38, 51.59s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [44:06<1:07:52, 50.90s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.039, valid loss : 0.061, train f1 : 0.943, valid f1 : 0.796
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [45:02<1:15:04, 56.30s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.809
training process finished, best loss : 0.063, best acc : 0.930, best f1 : 0.809, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.78      0.67       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.87      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.87, test loss : 2.849

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.10s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:25,  8.51s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:18,  8.69s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:07,  8.46s/it]processing for feature importance:  42%|████▏     | 5/12 [00:42<00:58,  8.36s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:48,  8.16s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:39,  7.87s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:31,  7.75s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:23,  7.82s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:20<00:15,  7.75s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.75s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.97s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 10/306 [00:00<00:03, 96.83it/s] 10%|█         | 31/306 [00:00<00:01, 155.18it/s] 15%|█▌        | 47/306 [00:00<00:01, 143.94it/s] 20%|██        | 62/306 [00:00<00:01, 145.51it/s] 27%|██▋       | 82/306 [00:00<00:01, 158.68it/s] 32%|███▏      | 98/306 [00:00<00:01, 152.61it/s] 37%|███▋      | 114/306 [00:00<00:01, 151.79it/s] 47%|████▋     | 143/306 [00:00<00:00, 192.19it/s] 53%|█████▎    | 163/306 [00:00<00:00, 185.00it/s] 59%|█████▉    | 182/306 [00:01<00:00, 155.83it/s] 65%|██████▌   | 199/306 [00:01<00:00, 157.78it/s] 71%|███████   | 216/306 [00:01<00:00, 149.94it/s] 76%|███████▌  | 233/306 [00:01<00:00, 154.26it/s] 81%|████████▏ | 249/306 [00:01<00:00, 154.75it/s] 87%|████████▋ | 265/306 [00:01<00:00, 134.97it/s] 93%|█████████▎| 286/306 [00:01<00:00, 153.11it/s] 99%|█████████▉| 303/306 [00:01<00:00, 145.02it/s]100%|██████████| 306/306 [00:02<00:00, 151.75it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 50/553 [00:00<00:01, 495.14it/s]extract the null data:  18%|█▊        | 100/553 [00:00<00:00, 471.98it/s]extract the null data:  27%|██▋       | 148/553 [00:00<00:00, 473.50it/s]extract the null data:  36%|███▌      | 197/553 [00:00<00:00, 476.55it/s]extract the null data:  44%|████▍     | 245/553 [00:00<00:00, 475.47it/s]extract the null data:  53%|█████▎    | 295/553 [00:00<00:00, 482.39it/s]extract the null data:  63%|██████▎   | 349/553 [00:00<00:00, 498.70it/s]extract the null data:  72%|███████▏  | 400/553 [00:00<00:00, 499.73it/s]extract the null data:  81%|████████▏ | 450/553 [00:00<00:00, 493.92it/s]extract the null data:  91%|█████████ | 502/553 [00:01<00:00, 500.54it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 500.04it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 491.25it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 172.13it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:02, 180.97it/s]replace nan value:  10%|█         | 56/553 [00:00<00:02, 176.93it/s]replace nan value:  13%|█▎        | 74/553 [00:00<00:02, 173.63it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:02, 176.83it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 173.42it/s]replace nan value:  23%|██▎       | 129/553 [00:00<00:02, 168.77it/s]replace nan value:  27%|██▋       | 147/553 [00:00<00:02, 170.78it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:02, 170.46it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 171.00it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:02, 172.06it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 173.69it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 173.53it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 172.98it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 172.68it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 172.96it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 172.88it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:01, 169.68it/s]replace nan value:  62%|██████▏   | 345/553 [00:02<00:01, 170.17it/s]replace nan value:  66%|██████▌   | 363/553 [00:02<00:01, 169.96it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:01, 170.97it/s]replace nan value:  72%|███████▏  | 399/553 [00:02<00:00, 169.40it/s]replace nan value:  75%|███████▌  | 416/553 [00:02<00:00, 169.05it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 168.77it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 170.16it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 170.69it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 169.94it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 166.32it/s]replace nan value:  94%|█████████▍| 521/553 [00:03<00:00, 164.12it/s]replace nan value:  97%|█████████▋| 538/553 [00:03<00:00, 164.56it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 170.49it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.81it/s]  5%|▌         | 28/553 [00:00<00:03, 136.50it/s]  8%|▊         | 42/553 [00:00<00:03, 131.19it/s] 10%|█         | 56/553 [00:00<00:04, 121.47it/s] 12%|█▏        | 69/553 [00:00<00:04, 110.57it/s] 15%|█▌        | 84/553 [00:00<00:03, 121.01it/s] 18%|█▊        | 97/553 [00:00<00:03, 118.64it/s] 20%|█▉        | 110/553 [00:00<00:03, 121.46it/s] 22%|██▏       | 124/553 [00:01<00:03, 125.92it/s] 25%|██▌       | 140/553 [00:01<00:03, 133.51it/s] 28%|██▊       | 157/553 [00:01<00:02, 144.05it/s] 31%|███▏      | 173/553 [00:01<00:02, 147.15it/s] 34%|███▍      | 188/553 [00:01<00:02, 143.51it/s] 37%|███▋      | 206/553 [00:01<00:02, 151.50it/s] 40%|████      | 222/553 [00:01<00:02, 142.39it/s] 43%|████▎     | 238/553 [00:01<00:02, 146.15it/s] 46%|████▌     | 253/553 [00:01<00:02, 142.61it/s] 48%|████▊     | 268/553 [00:01<00:02, 139.46it/s] 51%|█████     | 283/553 [00:02<00:02, 134.24it/s] 54%|█████▎    | 297/553 [00:02<00:01, 131.82it/s] 56%|█████▌    | 311/553 [00:02<00:01, 129.57it/s] 59%|█████▊    | 324/553 [00:02<00:01, 129.50it/s] 61%|██████    | 338/553 [00:02<00:01, 130.63it/s] 64%|██████▎   | 352/553 [00:02<00:01, 131.16it/s] 66%|██████▌   | 366/553 [00:02<00:01, 124.89it/s] 69%|██████▊   | 380/553 [00:02<00:01, 128.89it/s] 71%|███████   | 393/553 [00:03<00:01, 118.41it/s] 73%|███████▎  | 406/553 [00:03<00:01, 121.38it/s] 76%|███████▌  | 419/553 [00:03<00:01, 118.09it/s] 78%|███████▊  | 431/553 [00:03<00:01, 115.22it/s] 81%|████████  | 449/553 [00:03<00:00, 131.63it/s] 84%|████████▍ | 464/553 [00:03<00:00, 134.57it/s] 86%|████████▋ | 478/553 [00:03<00:00, 133.13it/s] 89%|████████▉ | 492/553 [00:03<00:00, 128.62it/s] 91%|█████████▏| 505/553 [00:03<00:00, 126.28it/s] 94%|█████████▍| 520/553 [00:03<00:00, 132.20it/s] 97%|█████████▋| 534/553 [00:04<00:00, 114.81it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.04it/s]100%|██████████| 553/553 [00:04<00:00, 127.51it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 277.93it/s]extract the null data:  62%|██████▏   | 86/139 [00:00<00:00, 452.44it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 473.30it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 198.06it/s]replace nan value:  29%|██▉       | 41/139 [00:00<00:00, 201.82it/s]replace nan value:  45%|████▍     | 62/139 [00:00<00:00, 199.99it/s]replace nan value:  60%|█████▉    | 83/139 [00:00<00:00, 198.92it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 198.19it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 197.70it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 199.23it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 130.48it/s] 22%|██▏       | 30/139 [00:00<00:00, 140.37it/s] 33%|███▎      | 46/139 [00:00<00:00, 139.99it/s] 43%|████▎     | 60/139 [00:00<00:00, 128.57it/s] 54%|█████▍    | 75/139 [00:00<00:00, 132.49it/s] 64%|██████▍   | 89/139 [00:00<00:00, 121.27it/s] 76%|███████▌  | 105/139 [00:00<00:00, 127.70it/s] 88%|████████▊ | 122/139 [00:00<00:00, 136.57it/s] 98%|█████████▊| 136/139 [00:01<00:00, 135.67it/s]100%|██████████| 139/139 [00:01<00:00, 133.90it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  11%|█         | 19/173 [00:00<00:00, 187.82it/s]extract the null data:  43%|████▎     | 75/173 [00:00<00:00, 404.37it/s]extract the null data:  77%|███████▋  | 133/173 [00:00<00:00, 480.81it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 456.64it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 207.50it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 210.07it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 205.18it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 200.34it/s]replace nan value:  62%|██████▏   | 107/173 [00:00<00:00, 198.10it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 196.28it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 193.40it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 189.98it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 195.45it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 126.61it/s] 15%|█▌        | 26/173 [00:00<00:01, 113.39it/s] 24%|██▎       | 41/173 [00:00<00:01, 128.32it/s] 33%|███▎      | 57/173 [00:00<00:00, 139.90it/s] 42%|████▏     | 72/173 [00:00<00:00, 142.71it/s] 50%|█████     | 87/173 [00:00<00:00, 141.10it/s] 60%|█████▉    | 103/173 [00:00<00:00, 142.42it/s] 68%|██████▊   | 118/173 [00:00<00:00, 143.90it/s] 77%|███████▋  | 133/173 [00:00<00:00, 137.03it/s] 86%|████████▌ | 148/173 [00:01<00:00, 137.55it/s] 94%|█████████▎| 162/173 [00:01<00:00, 125.99it/s]100%|██████████| 173/173 [00:01<00:00, 123.09it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.009, train acc : 0.644, valid acc : 0.923, train f1 : 0.499, valid f1 : 0.685
training process:   1%|          | 1/128 [01:04<2:17:02, 64.74s/it]Best score increase :0.000 -> 0.685
training process:   2%|▏         | 2/128 [01:58<2:02:37, 58.40s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:54<1:59:38, 57.43s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:49<1:56:20, 56.29s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.937, valid acc : 0.935, train f1 : 0.705, valid f1 : 0.692
training process:   4%|▍         | 5/128 [04:57<2:04:24, 60.68s/it]Best score increase :0.685 -> 0.692
training process:   5%|▍         | 6/128 [05:57<2:02:38, 60.31s/it]Best score increase :0.692 -> 0.711
training process:   5%|▌         | 7/128 [06:54<1:59:37, 59.32s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:50<1:56:21, 58.18s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.004, train acc : 0.943, valid acc : 0.935, train f1 : 0.743, valid f1 : 0.702
training process:   7%|▋         | 9/128 [08:55<1:59:30, 60.25s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [09:53<1:57:08, 59.56s/it]Best score increase :0.711 -> 0.718
training process:   9%|▊         | 11/128 [10:49<1:54:10, 58.55s/it]Best score increase :0.718 -> 0.727
training process:   9%|▉         | 12/128 [11:39<1:48:02, 55.88s/it]Best score increase :0.727 -> 0.730
epoch : 13, train loss : 0.003, valid loss : 0.004, train acc : 0.948, valid acc : 0.937, train f1 : 0.769, valid f1 : 0.728
training process:  10%|█         | 13/128 [12:37<1:48:15, 56.48s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [13:28<1:44:27, 54.98s/it]Best score increase :0.730 -> 0.738
training process:  12%|█▏        | 15/128 [14:19<1:40:54, 53.58s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:09<1:38:28, 52.75s/it]Best score increase :0.738 -> 0.745
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.950, valid acc : 0.939, train f1 : 0.786, valid f1 : 0.745
training process:  13%|█▎        | 17/128 [16:08<1:40:52, 54.53s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [17:00<1:38:45, 53.87s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [17:54<1:37:41, 53.78s/it]Best score increase :0.745 -> 0.750
training process:  16%|█▌        | 20/128 [18:47<1:36:28, 53.60s/it]Best score increase :0.750 -> 0.764
epoch : 21, train loss : 0.003, valid loss : 0.003, train acc : 0.953, valid acc : 0.942, train f1 : 0.803, valid f1 : 0.749
training process:  16%|█▋        | 21/128 [19:47<1:38:52, 55.45s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [20:37<1:34:54, 53.72s/it]Best score increase :0.764 -> 0.777
training process:  18%|█▊        | 23/128 [21:26<1:31:37, 52.36s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:16<1:29:33, 51.67s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.956, valid acc : 0.945, train f1 : 0.821, valid f1 : 0.779
training process:  20%|█▉        | 25/128 [23:16<1:33:15, 54.33s/it]Best score increase :0.777 -> 0.779
training process:  20%|██        | 26/128 [24:05<1:29:35, 52.70s/it]Best score increase :0.779 -> 0.786
training process:  21%|██        | 27/128 [24:58<1:28:36, 52.64s/it]Best score increase :0.786 -> 0.789
training process:  22%|██▏       | 28/128 [25:49<1:27:04, 52.25s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.959, valid acc : 0.945, train f1 : 0.834, valid f1 : 0.772
training process:  23%|██▎       | 29/128 [26:51<1:31:10, 55.26s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [27:44<1:28:44, 54.33s/it]Best score increase :0.789 -> 0.794
training process:  24%|██▍       | 31/128 [28:34<1:25:39, 52.99s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [29:25<1:24:04, 52.54s/it]Best score increase :0.794 -> 0.801
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.961, valid acc : 0.949, train f1 : 0.843, valid f1 : 0.801
training process:  26%|██▌       | 33/128 [30:27<1:27:27, 55.24s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [31:15<1:23:33, 53.33s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [32:05<1:20:43, 52.08s/it]EarlyStopping counter : 3 out of 12
training process:  28%|██▊       | 36/128 [32:58<1:20:17, 52.37s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.963, valid acc : 0.950, train f1 : 0.852, valid f1 : 0.806
training process:  29%|██▉       | 37/128 [33:56<1:22:17, 54.26s/it]Best score increase :0.801 -> 0.806
training process:  30%|██▉       | 38/128 [34:45<1:18:48, 52.54s/it]Best score increase :0.806 -> 0.815
training process:  30%|███       | 39/128 [35:35<1:16:50, 51.80s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [36:25<1:15:25, 51.43s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.964, valid acc : 0.950, train f1 : 0.858, valid f1 : 0.808
training process:  32%|███▏      | 41/128 [37:23<1:17:21, 53.35s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [38:13<1:14:48, 52.19s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [39:03<1:13:03, 51.58s/it]Best score increase :0.815 -> 0.818
training process:  34%|███▍      | 44/128 [39:52<1:11:04, 50.77s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.964, valid acc : 0.951, train f1 : 0.862, valid f1 : 0.811
training process:  35%|███▌      | 45/128 [40:48<1:12:37, 52.50s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [41:38<1:10:42, 51.74s/it]EarlyStopping counter : 3 out of 12
training process:  37%|███▋      | 47/128 [42:28<1:08:58, 51.09s/it]EarlyStopping counter : 4 out of 12
training process:  38%|███▊      | 48/128 [43:16<1:06:53, 50.17s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.950, train f1 : 0.871, valid f1 : 0.803
training process:  38%|███▊      | 49/128 [44:15<1:09:26, 52.74s/it]EarlyStopping counter : 6 out of 12
training process:  39%|███▉      | 50/128 [45:07<1:08:33, 52.74s/it]EarlyStopping counter : 7 out of 12
training process:  40%|███▉      | 51/128 [46:00<1:07:33, 52.64s/it]EarlyStopping counter : 8 out of 12
training process:  41%|████      | 52/128 [46:52<1:06:26, 52.46s/it]Best score increase :0.818 -> 0.820
epoch : 53, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.954, train f1 : 0.878, valid f1 : 0.825
training process:  41%|████▏     | 53/128 [47:54<1:09:08, 55.32s/it]Best score increase :0.820 -> 0.825
training process:  42%|████▏     | 54/128 [48:47<1:07:27, 54.70s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [49:38<1:05:03, 53.47s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [50:30<1:03:41, 53.08s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.954, train f1 : 0.882, valid f1 : 0.831
training process:  45%|████▍     | 57/128 [51:38<1:08:15, 57.68s/it]Best score increase :0.825 -> 0.831
training process:  45%|████▌     | 58/128 [52:36<1:07:21, 57.74s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [53:32<1:05:36, 57.06s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [54:31<1:05:20, 57.66s/it]EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.954, train f1 : 0.883, valid f1 : 0.827
training process:  48%|████▊     | 61/128 [55:38<1:07:40, 60.61s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [56:37<1:06:06, 60.10s/it]EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [57:30<1:02:50, 58.01s/it]Best score increase :0.831 -> 0.835
training process:  50%|█████     | 64/128 [58:25<1:00:42, 56.91s/it]Best score increase :0.835 -> 0.839
epoch : 65, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.953, train f1 : 0.882, valid f1 : 0.826
training process:  51%|█████     | 65/128 [59:28<1:01:47, 58.84s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:00:19<58:22, 56.49s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:01:10<55:42, 54.80s/it]EarlyStopping counter : 3 out of 12
training process:  53%|█████▎    | 68/128 [1:02:00<53:23, 53.40s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.956, train f1 : 0.888, valid f1 : 0.839
training process:  54%|█████▍    | 69/128 [1:02:59<54:16, 55.20s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▍    | 70/128 [1:03:51<52:16, 54.09s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▌    | 71/128 [1:04:41<50:23, 53.04s/it]Best score increase :0.839 -> 0.845
training process:  56%|█████▋    | 72/128 [1:05:32<48:50, 52.34s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.954, train f1 : 0.894, valid f1 : 0.826
training process:  57%|█████▋    | 73/128 [1:06:32<50:08, 54.69s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:07:24<48:22, 53.76s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▊    | 75/128 [1:08:15<46:52, 53.07s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▉    | 76/128 [1:09:06<45:26, 52.44s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.955, train f1 : 0.896, valid f1 : 0.833
training process:  60%|██████    | 77/128 [1:10:08<46:52, 55.15s/it]EarlyStopping counter : 6 out of 12
training process:  61%|██████    | 78/128 [1:10:56<44:11, 53.03s/it]EarlyStopping counter : 7 out of 12
training process:  62%|██████▏   | 79/128 [1:11:45<42:26, 51.98s/it]EarlyStopping counter : 8 out of 12
training process:  62%|██████▎   | 80/128 [1:12:38<41:43, 52.16s/it]EarlyStopping counter : 9 out of 12
epoch : 81, train loss : 0.002, valid loss : 0.003, train acc : 0.971, valid acc : 0.956, train f1 : 0.892, valid f1 : 0.837
training process:  63%|██████▎   | 81/128 [1:13:35<41:59, 53.61s/it]EarlyStopping counter : 10 out of 12
training process:  64%|██████▍   | 82/128 [1:14:23<39:48, 51.93s/it]EarlyStopping counter : 11 out of 12
training process:  64%|██████▍   | 82/128 [1:15:12<42:11, 55.03s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 82, best f1 score : 0.845
training process finished, best loss : 0.003 and best acc : 0.956, best f1 : 0.845, best epoch : 70

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.66      0.66      0.66       580
           1       0.97      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.82      0.81      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.81, test AUC : 0.82, test loss : 0.170

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:35,  8.68s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:28,  8.83s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:19,  8.79s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:09,  8.69s/it]processing for feature importance:  42%|████▏     | 5/12 [00:43<00:59,  8.51s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:51,  8.58s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:43,  8.62s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:08<00:33,  8.50s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:16<00:24,  8.30s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:24<00:16,  8.26s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:32<00:08,  8.20s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.05s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.38s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 187.51it/s] 12%|█▏        | 38/306 [00:00<00:01, 152.37it/s] 18%|█▊        | 54/306 [00:00<00:01, 139.52it/s] 23%|██▎       | 70/306 [00:00<00:01, 144.62it/s] 28%|██▊       | 85/306 [00:00<00:01, 137.66it/s] 33%|███▎      | 102/306 [00:00<00:01, 146.75it/s] 39%|███▊      | 118/306 [00:00<00:01, 149.34it/s] 44%|████▍     | 134/306 [00:00<00:01, 130.54it/s] 51%|█████     | 155/306 [00:01<00:01, 147.64it/s] 56%|█████▌    | 171/306 [00:01<00:00, 141.93it/s] 61%|██████    | 186/306 [00:01<00:00, 140.62it/s] 66%|██████▌   | 201/306 [00:01<00:00, 140.73it/s] 71%|███████   | 216/306 [00:01<00:00, 129.68it/s] 78%|███████▊  | 239/306 [00:01<00:00, 152.78it/s] 83%|████████▎ | 255/306 [00:01<00:00, 148.64it/s] 89%|████████▊ | 271/306 [00:01<00:00, 138.13it/s] 98%|█████████▊| 299/306 [00:02<00:00, 174.30it/s]100%|██████████| 306/306 [00:02<00:00, 150.87it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 439.85it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 446.80it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:00, 453.63it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 456.84it/s]extract the null data:  42%|████▏     | 231/553 [00:00<00:00, 457.92it/s]extract the null data:  50%|█████     | 278/553 [00:00<00:00, 459.77it/s]extract the null data:  59%|█████▉    | 325/553 [00:00<00:00, 461.88it/s]extract the null data:  68%|██████▊   | 375/553 [00:00<00:00, 470.71it/s]extract the null data:  76%|███████▋  | 423/553 [00:00<00:00, 473.02it/s]extract the null data:  86%|████████▌ | 473/553 [00:01<00:00, 480.73it/s]extract the null data:  95%|█████████▍| 524/553 [00:01<00:00, 488.07it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 471.68it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 172.14it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:03, 168.05it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 171.24it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 174.12it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 175.87it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 176.87it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 178.03it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 180.29it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:02, 180.54it/s]replace nan value:  33%|███▎      | 184/553 [00:01<00:02, 181.79it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:01, 182.77it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 177.46it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 177.43it/s]replace nan value:  47%|████▋     | 258/553 [00:01<00:01, 177.57it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 178.78it/s]replace nan value:  54%|█████▎    | 296/553 [00:01<00:01, 181.04it/s]replace nan value:  57%|█████▋    | 315/553 [00:01<00:01, 180.41it/s]replace nan value:  60%|██████    | 334/553 [00:01<00:01, 180.53it/s]replace nan value:  64%|██████▍   | 353/553 [00:01<00:01, 179.60it/s]replace nan value:  67%|██████▋   | 371/553 [00:02<00:01, 175.27it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 175.30it/s]replace nan value:  74%|███████▎  | 407/553 [00:02<00:00, 175.84it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 174.33it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 174.82it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 177.16it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 178.10it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 177.34it/s]replace nan value:  93%|█████████▎| 517/553 [00:02<00:00, 177.49it/s]replace nan value:  97%|█████████▋| 535/553 [00:03<00:00, 177.03it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 176.12it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 177.35it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:04, 108.97it/s]  5%|▍         | 25/553 [00:00<00:04, 122.34it/s]  7%|▋         | 39/553 [00:00<00:04, 123.54it/s]  9%|▉         | 52/553 [00:00<00:04, 110.40it/s] 12%|█▏        | 64/553 [00:00<00:04, 101.49it/s] 14%|█▎        | 76/553 [00:00<00:04, 105.76it/s] 16%|█▋        | 90/553 [00:00<00:04, 115.35it/s] 18%|█▊        | 102/553 [00:00<00:03, 114.48it/s] 22%|██▏       | 119/553 [00:01<00:03, 129.96it/s] 24%|██▍       | 133/553 [00:01<00:03, 129.81it/s] 27%|██▋       | 151/553 [00:01<00:02, 141.01it/s] 30%|███       | 168/553 [00:01<00:02, 149.26it/s] 33%|███▎      | 184/553 [00:01<00:02, 145.99it/s] 36%|███▋      | 201/553 [00:01<00:02, 152.35it/s] 39%|███▉      | 217/553 [00:01<00:02, 149.54it/s] 42%|████▏     | 233/553 [00:01<00:02, 142.09it/s] 45%|████▍     | 248/553 [00:01<00:02, 143.07it/s] 48%|████▊     | 263/553 [00:01<00:02, 144.54it/s] 50%|█████     | 278/553 [00:02<00:02, 136.87it/s] 53%|█████▎    | 292/553 [00:02<00:01, 134.72it/s] 55%|█████▌    | 306/553 [00:02<00:01, 126.57it/s] 58%|█████▊    | 319/553 [00:02<00:01, 125.19it/s] 60%|██████    | 333/553 [00:02<00:01, 127.58it/s] 63%|██████▎   | 347/553 [00:02<00:01, 128.83it/s] 65%|██████▌   | 360/553 [00:02<00:01, 121.83it/s] 68%|██████▊   | 376/553 [00:02<00:01, 130.18it/s] 71%|███████   | 390/553 [00:03<00:01, 118.50it/s] 73%|███████▎  | 403/553 [00:03<00:01, 119.85it/s] 75%|███████▌  | 416/553 [00:03<00:01, 118.57it/s] 77%|███████▋  | 428/553 [00:03<00:01, 113.42it/s] 81%|████████  | 446/553 [00:03<00:00, 130.22it/s] 84%|████████▎ | 462/553 [00:03<00:00, 135.26it/s] 86%|████████▋ | 477/553 [00:03<00:00, 137.48it/s] 89%|████████▉ | 491/553 [00:03<00:00, 127.45it/s] 91%|█████████ | 504/553 [00:03<00:00, 125.53it/s] 94%|█████████▍| 519/553 [00:04<00:00, 130.25it/s] 96%|█████████▋| 533/553 [00:04<00:00, 110.46it/s] 99%|█████████▉| 549/553 [00:04<00:00, 120.83it/s]100%|██████████| 553/553 [00:04<00:00, 125.52it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 347.35it/s]extract the null data:  67%|██████▋   | 93/139 [00:00<00:00, 479.38it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 489.65it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 197.83it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 197.94it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 196.86it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 197.94it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 197.11it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 197.49it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.93it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.15it/s] 18%|█▊        | 25/139 [00:00<00:00, 120.27it/s] 28%|██▊       | 39/139 [00:00<00:00, 126.88it/s] 37%|███▋      | 52/139 [00:00<00:00, 119.11it/s] 47%|████▋     | 66/139 [00:00<00:00, 125.72it/s] 57%|█████▋    | 79/139 [00:00<00:00, 120.29it/s] 66%|██████▌   | 92/139 [00:00<00:00, 111.71it/s] 76%|███████▌  | 105/139 [00:00<00:00, 112.59it/s] 86%|████████▌ | 119/139 [00:01<00:00, 119.54it/s] 95%|█████████▍| 132/139 [00:01<00:00, 114.96it/s]100%|██████████| 139/139 [00:01<00:00, 119.46it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 217.60it/s]extract the null data:  43%|████▎     | 74/173 [00:00<00:00, 392.14it/s]extract the null data:  75%|███████▌  | 130/173 [00:00<00:00, 466.30it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 451.92it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 190.36it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 194.40it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 195.53it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 195.30it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 195.78it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 198.59it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 196.72it/s]replace nan value:  93%|█████████▎| 161/173 [00:00<00:00, 194.02it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 194.24it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.38it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.98it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.54it/s] 33%|███▎      | 57/173 [00:00<00:00, 130.26it/s] 41%|████      | 71/173 [00:00<00:00, 129.43it/s] 49%|████▉     | 85/173 [00:00<00:00, 127.61it/s] 57%|█████▋    | 98/173 [00:00<00:00, 127.66it/s] 65%|██████▌   | 113/173 [00:00<00:00, 130.79it/s] 73%|███████▎  | 127/173 [00:01<00:00, 125.02it/s] 82%|████████▏ | 141/173 [00:01<00:00, 128.53it/s] 89%|████████▉ | 154/173 [00:01<00:00, 122.77it/s] 97%|█████████▋| 167/173 [00:01<00:00, 100.13it/s]100%|██████████| 173/173 [00:01<00:00, 116.17it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.010, train acc : 0.712, valid acc : 0.768, train f1 : 0.708, valid f1 : 0.607
training process:   1%|          | 1/128 [01:05<2:18:35, 65.48s/it]Best score increase :0.000 -> 0.607
training process:   2%|▏         | 2/128 [01:58<2:02:19, 58.25s/it]Best score increase :0.607 -> 0.646
training process:   2%|▏         | 3/128 [02:52<1:56:54, 56.11s/it]Best score increase :0.646 -> 0.662
training process:   3%|▎         | 4/128 [03:44<1:52:27, 54.42s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.008, valid loss : 0.007, train acc : 0.824, valid acc : 0.858, train f1 : 0.824, valid f1 : 0.694
training process:   4%|▍         | 5/128 [04:45<1:56:49, 56.99s/it]Best score increase :0.662 -> 0.694
training process:   5%|▍         | 6/128 [05:37<1:52:29, 55.33s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:32<1:50:56, 55.01s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:24<1:48:34, 54.28s/it]EarlyStopping counter : 3 out of 12
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.847, valid acc : 0.840, train f1 : 0.847, valid f1 : 0.679
training process:   7%|▋         | 9/128 [08:26<1:52:33, 56.75s/it]EarlyStopping counter : 4 out of 12
training process:   8%|▊         | 10/128 [09:20<1:49:28, 55.67s/it]EarlyStopping counter : 5 out of 12
training process:   9%|▊         | 11/128 [10:13<1:47:08, 54.94s/it]Best score increase :0.694 -> 0.707
training process:   9%|▉         | 12/128 [11:05<1:44:29, 54.04s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.006, train acc : 0.868, valid acc : 0.866, train f1 : 0.868, valid f1 : 0.708
training process:  10%|█         | 13/128 [12:12<1:50:59, 57.91s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [13:10<1:50:28, 58.15s/it]Best score increase :0.707 -> 0.717
training process:  12%|█▏        | 15/128 [14:07<1:48:21, 57.54s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:04<1:47:28, 57.58s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.006, train acc : 0.886, valid acc : 0.852, train f1 : 0.886, valid f1 : 0.699
training process:  13%|█▎        | 17/128 [16:11<1:51:48, 60.44s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [17:10<1:49:43, 59.85s/it]Best score increase :0.717 -> 0.732
training process:  15%|█▍        | 19/128 [18:07<1:47:13, 59.03s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [19:02<1:44:19, 57.96s/it]Best score increase :0.732 -> 0.746
epoch : 21, train loss : 0.005, valid loss : 0.005, train acc : 0.898, valid acc : 0.893, train f1 : 0.898, valid f1 : 0.745
training process:  16%|█▋        | 21/128 [20:06<1:46:07, 59.51s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [20:57<1:40:42, 57.00s/it]Best score increase :0.746 -> 0.750
training process:  18%|█▊        | 23/128 [21:51<1:38:09, 56.09s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:42<1:34:53, 54.74s/it]Best score increase :0.750 -> 0.753
epoch : 25, train loss : 0.005, valid loss : 0.005, train acc : 0.908, valid acc : 0.887, train f1 : 0.908, valid f1 : 0.744
training process:  20%|█▉        | 25/128 [23:40<1:35:41, 55.75s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 26/128 [24:29<1:31:23, 53.76s/it]EarlyStopping counter : 2 out of 12
training process:  21%|██        | 27/128 [25:18<1:27:38, 52.06s/it]Best score increase :0.753 -> 0.756
training process:  22%|██▏       | 28/128 [26:07<1:25:20, 51.21s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.005, train acc : 0.917, valid acc : 0.899, train f1 : 0.917, valid f1 : 0.763
training process:  23%|██▎       | 29/128 [27:02<1:26:31, 52.44s/it]Best score increase :0.756 -> 0.763
training process:  23%|██▎       | 30/128 [27:51<1:23:51, 51.34s/it]Best score increase :0.763 -> 0.783
training process:  24%|██▍       | 31/128 [28:43<1:23:33, 51.69s/it]Best score increase :0.783 -> 0.788
training process:  25%|██▌       | 32/128 [29:33<1:21:35, 51.00s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.004, train acc : 0.917, valid acc : 0.917, train f1 : 0.917, valid f1 : 0.792
training process:  26%|██▌       | 33/128 [30:29<1:23:07, 52.50s/it]Best score increase :0.788 -> 0.792
training process:  27%|██▋       | 34/128 [31:17<1:20:21, 51.29s/it]Best score increase :0.792 -> 0.798
training process:  27%|██▋       | 35/128 [32:06<1:18:30, 50.65s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [32:54<1:16:09, 49.67s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.004, valid loss : 0.004, train acc : 0.925, valid acc : 0.917, train f1 : 0.925, valid f1 : 0.787
training process:  29%|██▉       | 37/128 [33:50<1:18:25, 51.71s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [34:38<1:15:38, 50.43s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [35:27<1:14:05, 49.95s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [36:13<1:11:50, 48.98s/it]Best score increase :0.798 -> 0.804
epoch : 41, train loss : 0.004, valid loss : 0.005, train acc : 0.930, valid acc : 0.903, train f1 : 0.930, valid f1 : 0.771
training process:  32%|███▏      | 41/128 [37:08<1:13:39, 50.80s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [37:57<1:12:00, 50.24s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [38:49<1:12:00, 50.83s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [39:40<1:10:59, 50.71s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.004, train acc : 0.934, valid acc : 0.906, train f1 : 0.934, valid f1 : 0.773
training process:  35%|███▌      | 45/128 [40:45<1:15:56, 54.90s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [41:37<1:13:52, 54.05s/it]EarlyStopping counter : 6 out of 12
training process:  37%|███▋      | 47/128 [42:29<1:12:17, 53.55s/it]EarlyStopping counter : 7 out of 12
training process:  38%|███▊      | 48/128 [43:20<1:10:24, 52.80s/it]EarlyStopping counter : 8 out of 12
epoch : 49, train loss : 0.003, valid loss : 0.004, train acc : 0.933, valid acc : 0.920, train f1 : 0.933, valid f1 : 0.795
training process:  38%|███▊      | 49/128 [44:20<1:12:29, 55.06s/it]EarlyStopping counter : 9 out of 12
training process:  39%|███▉      | 50/128 [45:10<1:09:35, 53.53s/it]Best score increase :0.804 -> 0.809
training process:  40%|███▉      | 51/128 [46:02<1:07:59, 52.98s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [46:54<1:06:44, 52.69s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.003, valid loss : 0.005, train acc : 0.939, valid acc : 0.898, train f1 : 0.939, valid f1 : 0.766
training process:  41%|████▏     | 53/128 [47:56<1:09:22, 55.50s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [48:47<1:06:49, 54.18s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [49:39<1:05:09, 53.55s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [50:31<1:03:25, 52.86s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.003, valid loss : 0.004, train acc : 0.936, valid acc : 0.920, train f1 : 0.936, valid f1 : 0.793
training process:  45%|████▍     | 57/128 [51:32<1:05:38, 55.48s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [52:26<1:04:01, 54.87s/it]EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [53:18<1:02:11, 54.07s/it]EarlyStopping counter : 9 out of 12
training process:  47%|████▋     | 60/128 [54:13<1:01:41, 54.43s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.003, valid loss : 0.004, train acc : 0.939, valid acc : 0.922, train f1 : 0.939, valid f1 : 0.800
training process:  48%|████▊     | 61/128 [55:17<1:03:49, 57.16s/it]EarlyStopping counter : 11 out of 12
training process:  48%|████▊     | 61/128 [56:08<1:01:40, 55.23s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.809
training process finished, best loss : 0.004 and best acc : 0.928, best f1 : 0.809, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.79      0.69       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.80      0.88      0.83      7398
weighted avg       0.95      0.94      0.95      7398


# test acc : 0.94, test f1 : 0.83, test AUC : 0.88, test loss : 0.194

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:34,  8.63s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.20s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:13,  8.21s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:02,  7.87s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.74s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.89s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:41,  8.21s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:05<00:33,  8.35s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:14<00:25,  8.48s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:22<00:16,  8.42s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:29<00:08,  8.15s/it]processing for feature importance: 100%|██████████| 12/12 [01:37<00:00,  8.11s/it]processing for feature importance: 100%|██████████| 12/12 [01:37<00:00,  8.16s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 34/306 [00:00<00:00, 336.92it/s] 22%|██▏       | 68/306 [00:00<00:00, 332.29it/s] 34%|███▍      | 104/306 [00:00<00:00, 344.19it/s] 46%|████▌     | 141/306 [00:00<00:00, 351.33it/s] 58%|█████▊    | 179/306 [00:00<00:00, 358.86it/s] 71%|███████   | 217/306 [00:00<00:00, 365.33it/s] 83%|████████▎ | 255/306 [00:00<00:00, 367.93it/s] 95%|█████████▌| 292/306 [00:00<00:00, 357.95it/s]100%|██████████| 306/306 [00:00<00:00, 351.88it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 40/553 [00:00<00:01, 395.87it/s]extract the null data:  15%|█▌        | 85/553 [00:00<00:01, 422.60it/s]extract the null data:  24%|██▎       | 130/553 [00:00<00:00, 433.99it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 445.94it/s]extract the null data:  41%|████      | 225/553 [00:00<00:00, 456.02it/s]extract the null data:  49%|████▉     | 273/553 [00:00<00:00, 463.50it/s]extract the null data:  58%|█████▊    | 321/553 [00:00<00:00, 467.06it/s]extract the null data:  67%|██████▋   | 369/553 [00:00<00:00, 470.39it/s]extract the null data:  75%|███████▌  | 417/553 [00:00<00:00, 466.52it/s]extract the null data:  84%|████████▍ | 465/553 [00:01<00:00, 468.76it/s]extract the null data:  93%|█████████▎| 512/553 [00:01<00:00, 421.46it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 445.31it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 162.65it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 163.50it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 162.92it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:04, 118.80it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:03, 118.66it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:03, 132.56it/s]replace nan value:  21%|██        | 115/553 [00:00<00:03, 139.43it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:02, 145.94it/s]replace nan value:  27%|██▋       | 150/553 [00:01<00:02, 154.18it/s]replace nan value:  30%|███       | 166/553 [00:01<00:02, 155.04it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 159.21it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:02, 156.26it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:02, 158.39it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:02, 154.86it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 158.02it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 160.11it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 162.38it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 163.18it/s]replace nan value:  58%|█████▊    | 318/553 [00:02<00:01, 163.26it/s]replace nan value:  61%|██████    | 335/553 [00:02<00:01, 164.57it/s]replace nan value:  64%|██████▎   | 352/553 [00:02<00:01, 160.16it/s]replace nan value:  67%|██████▋   | 369/553 [00:02<00:01, 156.18it/s]replace nan value:  70%|██████▉   | 386/553 [00:02<00:01, 157.59it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 159.46it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 138.46it/s]replace nan value:  79%|███████▉  | 436/553 [00:02<00:00, 146.15it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 150.88it/s]replace nan value:  85%|████████▍ | 469/553 [00:03<00:00, 153.25it/s]replace nan value:  88%|████████▊ | 486/553 [00:03<00:00, 156.75it/s]replace nan value:  91%|█████████ | 503/553 [00:03<00:00, 158.11it/s]replace nan value:  94%|█████████▍| 521/553 [00:03<00:00, 162.41it/s]replace nan value:  97%|█████████▋| 538/553 [00:03<00:00, 162.54it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 153.78it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 6/553 [00:00<00:09, 59.96it/s]  3%|▎         | 14/553 [00:00<00:07, 70.89it/s]  5%|▌         | 28/553 [00:00<00:05, 102.20it/s]  7%|▋         | 41/553 [00:00<00:04, 109.55it/s]  9%|▉         | 52/553 [00:00<00:04, 108.68it/s] 11%|█▏        | 63/553 [00:00<00:05, 95.32it/s]  14%|█▎        | 76/553 [00:00<00:04, 104.66it/s] 16%|█▋        | 90/553 [00:00<00:04, 113.07it/s] 18%|█▊        | 102/553 [00:00<00:04, 111.02it/s] 22%|██▏       | 119/553 [00:01<00:03, 126.41it/s] 24%|██▍       | 132/553 [00:01<00:03, 124.69it/s] 27%|██▋       | 149/553 [00:01<00:02, 135.33it/s] 30%|██▉       | 165/553 [00:01<00:02, 140.73it/s] 33%|███▎      | 180/553 [00:01<00:02, 137.12it/s] 35%|███▌      | 195/553 [00:01<00:02, 140.59it/s] 38%|███▊      | 210/553 [00:01<00:02, 138.66it/s] 41%|████      | 224/553 [00:01<00:02, 117.74it/s] 43%|████▎     | 238/553 [00:02<00:02, 120.61it/s] 45%|████▌     | 251/553 [00:02<00:02, 120.45it/s] 48%|████▊     | 265/553 [00:02<00:02, 124.68it/s] 50%|█████     | 278/553 [00:02<00:02, 110.38it/s] 53%|█████▎    | 292/553 [00:02<00:02, 114.40it/s] 55%|█████▌    | 305/553 [00:02<00:02, 116.66it/s] 57%|█████▋    | 317/553 [00:02<00:02, 113.45it/s] 60%|█████▉    | 331/553 [00:02<00:01, 118.78it/s] 62%|██████▏   | 345/553 [00:02<00:01, 113.80it/s] 65%|██████▍   | 357/553 [00:03<00:01, 114.92it/s] 67%|██████▋   | 373/553 [00:03<00:01, 126.44it/s] 70%|██████▉   | 386/553 [00:03<00:01, 122.49it/s] 72%|███████▏  | 399/553 [00:03<00:01, 114.02it/s] 75%|███████▌  | 415/553 [00:03<00:01, 122.23it/s] 77%|███████▋  | 428/553 [00:03<00:01, 115.85it/s] 80%|████████  | 445/553 [00:03<00:00, 129.99it/s] 83%|████████▎ | 460/553 [00:03<00:00, 134.06it/s] 86%|████████▌ | 475/553 [00:03<00:00, 135.95it/s] 88%|████████▊ | 489/553 [00:04<00:00, 130.49it/s] 91%|█████████ | 503/553 [00:04<00:00, 126.62it/s] 94%|█████████▍| 519/553 [00:04<00:00, 133.11it/s] 96%|█████████▋| 533/553 [00:04<00:00, 114.62it/s] 99%|█████████▉| 549/553 [00:04<00:00, 125.73it/s]100%|██████████| 553/553 [00:04<00:00, 119.02it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 366.48it/s]extract the null data:  73%|███████▎  | 101/139 [00:00<00:00, 526.60it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 524.04it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 205.38it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 206.77it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 152.04it/s]replace nan value:  60%|█████▉    | 83/139 [00:00<00:00, 166.10it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 179.14it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 185.51it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 182.88it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.07it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.03it/s] 29%|██▉       | 41/139 [00:00<00:00, 135.77it/s] 40%|███▉      | 55/139 [00:00<00:00, 123.64it/s] 50%|████▉     | 69/139 [00:00<00:00, 126.68it/s] 59%|█████▉    | 82/139 [00:00<00:00, 114.67it/s] 68%|██████▊   | 94/139 [00:00<00:00, 112.90it/s] 78%|███████▊  | 108/139 [00:00<00:00, 120.47it/s] 91%|█████████ | 126/139 [00:01<00:00, 133.84it/s]100%|██████████| 139/139 [00:01<00:00, 124.90it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 297.83it/s]extract the null data:  43%|████▎     | 75/173 [00:00<00:00, 383.47it/s]extract the null data:  66%|██████▌   | 114/173 [00:00<00:00, 348.91it/s]extract the null data:  87%|████████▋ | 150/173 [00:00<00:00, 345.92it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 368.40it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 207.49it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 200.48it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 207.61it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 204.77it/s]replace nan value:  62%|██████▏   | 107/173 [00:00<00:00, 207.48it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 207.96it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 203.67it/s]replace nan value:  98%|█████████▊| 170/173 [00:00<00:00, 199.12it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 202.85it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 136.40it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.33it/s] 26%|██▌       | 45/173 [00:00<00:00, 137.58it/s] 36%|███▌      | 62/173 [00:00<00:00, 147.76it/s] 45%|████▍     | 77/173 [00:00<00:00, 146.44it/s] 54%|█████▍    | 93/173 [00:00<00:00, 149.80it/s] 63%|██████▎   | 109/173 [00:00<00:00, 149.76it/s] 72%|███████▏  | 125/173 [00:00<00:00, 145.13it/s] 81%|████████  | 140/173 [00:00<00:00, 144.78it/s] 90%|████████▉ | 155/173 [00:01<00:00, 132.32it/s] 98%|█████████▊| 169/173 [00:01<00:00, 110.04it/s]100%|██████████| 173/173 [00:01<00:00, 126.73it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.453, valid acc : 0.597, train f1 : 0.396, valid f1 : 0.496
training process:   1%|          | 1/128 [01:03<2:14:35, 63.59s/it]Best score increase :0.000 -> 0.496
training process:   2%|▏         | 2/128 [01:57<2:01:01, 57.63s/it]Best score increase :0.496 -> 0.601
training process:   2%|▏         | 3/128 [02:51<1:56:55, 56.12s/it]Best score increase :0.601 -> 0.641
training process:   3%|▎         | 4/128 [03:45<1:53:58, 55.15s/it]Best score increase :0.641 -> 0.659
epoch : 5, train loss : 0.009, valid loss : 0.009, train acc : 0.829, valid acc : 0.848, train f1 : 0.660, valid f1 : 0.682
training process:   4%|▍         | 5/128 [04:44<1:56:20, 56.75s/it]Best score increase :0.659 -> 0.682
training process:   5%|▍         | 6/128 [05:43<1:56:51, 57.47s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:40<1:55:54, 57.48s/it]Best score increase :0.682 -> 0.692
training process:   6%|▋         | 8/128 [07:37<1:54:34, 57.28s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.008, valid loss : 0.009, train acc : 0.859, valid acc : 0.872, train f1 : 0.696, valid f1 : 0.704
training process:   7%|▋         | 9/128 [08:44<1:59:07, 60.06s/it]Best score increase :0.692 -> 0.704
training process:   8%|▊         | 10/128 [09:44<1:58:08, 60.07s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:42<1:56:17, 59.63s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [11:37<1:52:41, 58.29s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.008, train acc : 0.884, valid acc : 0.860, train f1 : 0.727, valid f1 : 0.698
training process:  10%|█         | 13/128 [12:45<1:56:48, 60.95s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [13:41<1:53:20, 59.66s/it]Best score increase :0.704 -> 0.715
training process:  12%|█▏        | 15/128 [14:35<1:49:02, 57.90s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:27<1:44:49, 56.16s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.007, valid loss : 0.008, train acc : 0.896, valid acc : 0.884, train f1 : 0.746, valid f1 : 0.732
training process:  13%|█▎        | 17/128 [16:28<1:46:26, 57.54s/it]Best score increase :0.715 -> 0.732
training process:  14%|█▍        | 18/128 [17:21<1:42:55, 56.14s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [18:13<1:39:49, 54.95s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [19:05<1:37:20, 54.08s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.008, train acc : 0.903, valid acc : 0.898, train f1 : 0.761, valid f1 : 0.748
training process:  16%|█▋        | 21/128 [20:05<1:39:21, 55.72s/it]Best score increase :0.732 -> 0.748
training process:  17%|█▋        | 22/128 [20:57<1:36:31, 54.64s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [21:50<1:34:45, 54.15s/it]Best score increase :0.748 -> 0.749
training process:  19%|█▉        | 24/128 [22:43<1:33:19, 53.84s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.008, train acc : 0.912, valid acc : 0.894, train f1 : 0.776, valid f1 : 0.746
training process:  20%|█▉        | 25/128 [23:45<1:36:31, 56.23s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [24:38<1:34:14, 55.44s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [25:31<1:32:11, 54.77s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [26:25<1:30:27, 54.28s/it]Best score increase :0.749 -> 0.764
epoch : 29, train loss : 0.005, valid loss : 0.009, train acc : 0.918, valid acc : 0.908, train f1 : 0.788, valid f1 : 0.757
training process:  23%|██▎       | 29/128 [27:26<1:32:54, 56.31s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [28:20<1:30:48, 55.59s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [29:13<1:28:51, 54.96s/it]Best score increase :0.764 -> 0.767
training process:  25%|██▌       | 32/128 [30:03<1:25:40, 53.55s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.008, train acc : 0.920, valid acc : 0.899, train f1 : 0.790, valid f1 : 0.752
training process:  26%|██▌       | 33/128 [30:59<1:25:57, 54.29s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [31:48<1:22:38, 52.75s/it]Best score increase :0.767 -> 0.787
training process:  27%|██▋       | 35/128 [32:40<1:21:04, 52.30s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [33:27<1:17:47, 50.73s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.008, train acc : 0.932, valid acc : 0.908, train f1 : 0.814, valid f1 : 0.765
training process:  29%|██▉       | 37/128 [34:23<1:19:23, 52.35s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [35:10<1:16:19, 50.89s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [35:58<1:14:02, 49.92s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [36:49<1:13:31, 50.13s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.005, valid loss : 0.008, train acc : 0.931, valid acc : 0.911, train f1 : 0.813, valid f1 : 0.770
training process:  32%|███▏      | 41/128 [37:44<1:14:57, 51.69s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [38:31<1:12:17, 50.44s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [39:18<1:09:52, 49.33s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [40:05<1:08:01, 48.59s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.005, valid loss : 0.008, train acc : 0.935, valid acc : 0.915, train f1 : 0.820, valid f1 : 0.778
training process:  35%|███▌      | 45/128 [41:00<1:09:40, 50.37s/it]EarlyStopping counter : 11 out of 12
training process:  35%|███▌      | 45/128 [41:47<1:17:04, 55.71s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.787
training process finished, best loss : 0.008 and best acc : 0.922, best f1 : 0.787, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.73      0.66       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.85      0.81      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.85, test loss : 0.461

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.28s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:11,  7.18s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:05,  7.28s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.36s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.31s/it]processing for feature importance:  50%|█████     | 6/12 [00:43<00:44,  7.35s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.29s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:28,  7.24s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:05<00:21,  7.23s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:12<00:14,  7.17s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:19<00:07,  7.16s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.17s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.23s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 197.15it/s] 14%|█▎        | 42/306 [00:00<00:01, 144.98it/s] 21%|██        | 64/306 [00:00<00:01, 171.61it/s] 29%|██▉       | 88/306 [00:00<00:01, 193.07it/s] 36%|███▌      | 109/306 [00:00<00:01, 176.04it/s] 42%|████▏     | 128/306 [00:00<00:01, 158.52it/s] 52%|█████▏    | 159/306 [00:00<00:00, 198.33it/s] 60%|█████▉    | 183/306 [00:00<00:00, 207.95it/s] 68%|██████▊   | 207/306 [00:01<00:00, 215.35it/s] 75%|███████▌  | 230/306 [00:01<00:00, 180.83it/s] 82%|████████▏ | 250/306 [00:01<00:00, 185.46it/s] 89%|████████▉ | 273/306 [00:01<00:00, 196.50it/s] 98%|█████████▊| 299/306 [00:01<00:00, 212.96it/s]100%|██████████| 306/306 [00:01<00:00, 189.92it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 43/553 [00:00<00:01, 427.74it/s]extract the null data:  16%|█▋        | 90/553 [00:00<00:01, 450.44it/s]extract the null data:  25%|██▍       | 136/553 [00:00<00:00, 452.72it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:00, 461.76it/s]extract the null data:  42%|████▏     | 231/553 [00:00<00:00, 453.67it/s]extract the null data:  51%|█████     | 280/553 [00:00<00:00, 463.49it/s]extract the null data:  59%|█████▉    | 327/553 [00:00<00:00, 465.37it/s]extract the null data:  68%|██████▊   | 376/553 [00:00<00:00, 472.80it/s]extract the null data:  77%|███████▋  | 425/553 [00:00<00:00, 475.57it/s]extract the null data:  86%|████████▌ | 473/553 [00:01<00:00, 469.59it/s]extract the null data:  95%|█████████▍| 523/553 [00:01<00:00, 476.56it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 467.61it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 164.17it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 168.46it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:02, 167.18it/s]replace nan value:  13%|█▎        | 70/553 [00:00<00:02, 169.03it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 170.29it/s]replace nan value:  19%|█▉        | 106/553 [00:00<00:02, 170.89it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 170.71it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 170.70it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 172.30it/s]replace nan value:  32%|███▏      | 178/553 [00:01<00:02, 172.33it/s]replace nan value:  35%|███▌      | 196/553 [00:01<00:02, 172.11it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 172.79it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 170.96it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 172.47it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 172.55it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 173.49it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 172.94it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 174.45it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 175.96it/s]replace nan value:  65%|██████▍   | 358/553 [00:02<00:01, 175.14it/s]replace nan value:  68%|██████▊   | 376/553 [00:02<00:01, 176.18it/s]replace nan value:  71%|███████▏  | 395/553 [00:02<00:00, 177.88it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 180.63it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 174.90it/s]replace nan value:  82%|████████▏ | 452/553 [00:02<00:00, 177.70it/s]replace nan value:  85%|████████▍ | 470/553 [00:02<00:00, 176.39it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 176.96it/s]replace nan value:  92%|█████████▏| 506/553 [00:02<00:00, 175.39it/s]replace nan value:  95%|█████████▍| 524/553 [00:03<00:00, 173.59it/s]replace nan value:  98%|█████████▊| 542/553 [00:03<00:00, 173.47it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 173.39it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.60it/s]  5%|▌         | 28/553 [00:00<00:03, 136.48it/s]  8%|▊         | 42/553 [00:00<00:03, 129.88it/s] 10%|█         | 56/553 [00:00<00:04, 120.58it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.50it/s] 15%|█▌        | 84/553 [00:00<00:03, 120.95it/s] 18%|█▊        | 97/553 [00:00<00:03, 123.14it/s] 20%|██        | 112/553 [00:00<00:03, 129.25it/s] 23%|██▎       | 126/553 [00:01<00:03, 125.16it/s] 26%|██▌       | 144/553 [00:01<00:02, 138.06it/s] 29%|██▉       | 161/553 [00:01<00:02, 146.48it/s] 32%|███▏      | 176/553 [00:01<00:02, 146.75it/s] 35%|███▍      | 192/553 [00:01<00:02, 147.98it/s] 38%|███▊      | 210/553 [00:01<00:02, 153.53it/s] 41%|████      | 226/553 [00:01<00:02, 144.94it/s] 44%|████▎     | 241/553 [00:01<00:02, 145.73it/s] 46%|████▋     | 256/553 [00:01<00:02, 137.93it/s] 49%|████▉     | 270/553 [00:01<00:02, 137.70it/s] 51%|█████▏    | 284/553 [00:02<00:01, 134.69it/s] 54%|█████▍    | 298/553 [00:02<00:01, 130.22it/s] 56%|█████▋    | 312/553 [00:02<00:01, 126.10it/s] 59%|█████▉    | 325/553 [00:02<00:01, 126.23it/s] 61%|██████    | 338/553 [00:02<00:01, 126.48it/s] 63%|██████▎   | 351/553 [00:02<00:01, 125.94it/s] 66%|██████▌   | 364/553 [00:02<00:01, 122.24it/s] 68%|██████▊   | 378/553 [00:02<00:01, 124.48it/s] 71%|███████   | 391/553 [00:02<00:01, 115.64it/s] 73%|███████▎  | 404/553 [00:03<00:01, 118.54it/s] 75%|███████▌  | 416/553 [00:03<00:01, 117.46it/s] 77%|███████▋  | 428/553 [00:03<00:01, 111.23it/s] 80%|████████  | 445/553 [00:03<00:00, 126.51it/s] 83%|████████▎ | 460/553 [00:03<00:00, 132.54it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.28it/s] 88%|████████▊ | 488/553 [00:03<00:00, 129.17it/s] 91%|█████████ | 502/553 [00:03<00:00, 121.94it/s] 93%|█████████▎| 517/553 [00:03<00:00, 128.32it/s] 96%|█████████▌| 531/553 [00:04<00:00, 108.25it/s] 99%|█████████▉| 547/553 [00:04<00:00, 118.66it/s]100%|██████████| 553/553 [00:04<00:00, 125.95it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 265.70it/s]extract the null data:  58%|█████▊    | 81/139 [00:00<00:00, 422.09it/s]extract the null data:  97%|█████████▋| 135/139 [00:00<00:00, 471.81it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 445.02it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 187.47it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 190.65it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 190.26it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 192.42it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 195.81it/s]replace nan value:  87%|████████▋ | 121/139 [00:00<00:00, 199.19it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 197.90it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.84it/s] 19%|█▊        | 26/139 [00:00<00:00, 126.56it/s] 29%|██▉       | 40/139 [00:00<00:00, 132.44it/s] 39%|███▉      | 54/139 [00:00<00:00, 124.18it/s] 48%|████▊     | 67/139 [00:00<00:00, 124.91it/s] 58%|█████▊    | 80/139 [00:00<00:00, 123.75it/s] 67%|██████▋   | 93/139 [00:00<00:00, 114.39it/s] 76%|███████▋  | 106/139 [00:00<00:00, 117.59it/s] 88%|████████▊ | 122/139 [00:00<00:00, 125.41it/s] 97%|█████████▋| 135/139 [00:01<00:00, 122.30it/s]100%|██████████| 139/139 [00:01<00:00, 123.82it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██▏       | 37/173 [00:00<00:00, 369.83it/s]extract the null data:  58%|█████▊    | 100/173 [00:00<00:00, 519.05it/s]extract the null data:  95%|█████████▌| 165/173 [00:00<00:00, 577.55it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 546.26it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 204.79it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 207.30it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 205.59it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 203.53it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 203.66it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 202.92it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 203.20it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 200.87it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 202.66it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 137.02it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.74it/s] 25%|██▍       | 43/173 [00:00<00:01, 129.64it/s] 34%|███▎      | 58/173 [00:00<00:00, 135.34it/s] 42%|████▏     | 72/173 [00:00<00:00, 133.53it/s] 50%|████▉     | 86/173 [00:00<00:00, 129.84it/s] 58%|█████▊    | 100/173 [00:00<00:00, 129.60it/s] 66%|██████▌   | 114/173 [00:00<00:00, 131.95it/s] 74%|███████▍  | 128/173 [00:00<00:00, 126.11it/s] 82%|████████▏ | 141/173 [00:01<00:00, 126.85it/s] 89%|████████▉ | 154/173 [00:01<00:00, 117.82it/s] 96%|█████████▌| 166/173 [00:01<00:00, 93.98it/s] 100%|██████████| 173/173 [00:01<00:00, 113.98it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.008, valid loss : 0.013, train acc : 0.632, valid acc : 0.343, train f1 : 0.589, valid f1 : 0.321
training process:   1%|          | 1/128 [00:59<2:06:31, 59.77s/it]Best score increase :0.000 -> 0.321
training process:   2%|▏         | 2/128 [01:52<1:56:34, 55.51s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:44<1:52:32, 54.02s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:38<1:51:22, 53.90s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.014, train acc : 0.625, valid acc : 0.354, train f1 : 0.568, valid f1 : 0.330
training process:   4%|▍         | 5/128 [04:39<1:55:36, 56.40s/it]Best score increase :0.321 -> 0.330
training process:   5%|▍         | 6/128 [05:28<1:49:58, 54.09s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:21<1:48:19, 53.72s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:14<1:47:02, 53.52s/it]Best score increase :0.330 -> 0.364
epoch : 9, train loss : 0.003, valid loss : 0.014, train acc : 0.679, valid acc : 0.416, train f1 : 0.640, valid f1 : 0.376
training process:   7%|▋         | 9/128 [08:17<1:51:38, 56.29s/it]Best score increase :0.364 -> 0.376
training process:   8%|▊         | 10/128 [09:05<1:46:07, 53.96s/it]Best score increase :0.376 -> 0.384
training process:   9%|▊         | 11/128 [09:59<1:45:11, 53.94s/it]Best score increase :0.384 -> 0.410
training process:   9%|▉         | 12/128 [10:53<1:44:05, 53.84s/it]Best score increase :0.410 -> 0.414
epoch : 13, train loss : 0.003, valid loss : 0.012, train acc : 0.717, valid acc : 0.494, train f1 : 0.694, valid f1 : 0.433
training process:  10%|█         | 13/128 [11:54<1:47:26, 56.06s/it]Best score increase :0.414 -> 0.433
training process:  11%|█         | 14/128 [12:47<1:44:39, 55.09s/it]Best score increase :0.433 -> 0.464
training process:  12%|█▏        | 15/128 [13:40<1:42:51, 54.62s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:31<1:39:57, 53.55s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.012, train acc : 0.759, valid acc : 0.535, train f1 : 0.745, valid f1 : 0.461
training process:  13%|█▎        | 17/128 [15:31<1:42:32, 55.43s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [16:20<1:38:07, 53.52s/it]Best score increase :0.464 -> 0.491
training process:  15%|█▍        | 19/128 [17:11<1:35:26, 52.54s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [17:59<1:32:31, 51.40s/it]Best score increase :0.491 -> 0.515
epoch : 21, train loss : 0.002, valid loss : 0.010, train acc : 0.795, valid acc : 0.642, train f1 : 0.787, valid f1 : 0.534
training process:  16%|█▋        | 21/128 [18:59<1:36:02, 53.85s/it]Best score increase :0.515 -> 0.534
training process:  17%|█▋        | 22/128 [19:52<1:34:38, 53.57s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [20:41<1:31:25, 52.24s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [21:30<1:28:38, 51.14s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.010, train acc : 0.815, valid acc : 0.633, train f1 : 0.810, valid f1 : 0.529
training process:  20%|█▉        | 25/128 [22:32<1:33:25, 54.42s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [23:21<1:30:02, 52.97s/it]Best score increase :0.534 -> 0.536
training process:  21%|██        | 27/128 [24:15<1:29:26, 53.13s/it]Best score increase :0.536 -> 0.539
training process:  22%|██▏       | 28/128 [25:08<1:28:45, 53.26s/it]Best score increase :0.539 -> 0.551
epoch : 29, train loss : 0.002, valid loss : 0.009, train acc : 0.844, valid acc : 0.707, train f1 : 0.841, valid f1 : 0.583
training process:  23%|██▎       | 29/128 [26:07<1:30:26, 54.81s/it]Best score increase :0.551 -> 0.583
training process:  23%|██▎       | 30/128 [26:55<1:26:33, 53.00s/it]Best score increase :0.583 -> 0.605
training process:  24%|██▍       | 31/128 [27:44<1:23:20, 51.56s/it]Best score increase :0.605 -> 0.613
training process:  25%|██▌       | 32/128 [28:36<1:22:50, 51.78s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.009, train acc : 0.851, valid acc : 0.726, train f1 : 0.847, valid f1 : 0.598
training process:  26%|██▌       | 33/128 [29:36<1:26:01, 54.33s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [30:27<1:23:28, 53.28s/it]Best score increase :0.613 -> 0.643
training process:  27%|██▋       | 35/128 [31:18<1:21:26, 52.54s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [32:08<1:19:14, 51.68s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.008, train acc : 0.863, valid acc : 0.762, train f1 : 0.861, valid f1 : 0.627
training process:  29%|██▉       | 37/128 [33:05<1:20:51, 53.31s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [33:56<1:19:02, 52.69s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:46<1:17:00, 51.92s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [35:34<1:14:35, 50.85s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.008, train acc : 0.870, valid acc : 0.744, train f1 : 0.869, valid f1 : 0.612
training process:  32%|███▏      | 41/128 [36:31<1:16:07, 52.50s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [37:23<1:14:59, 52.32s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [38:11<1:12:31, 51.19s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [38:58<1:09:48, 49.87s/it]Best score increase :0.643 -> 0.652
epoch : 45, train loss : 0.002, valid loss : 0.008, train acc : 0.880, valid acc : 0.763, train f1 : 0.879, valid f1 : 0.628
training process:  35%|███▌      | 45/128 [39:54<1:11:43, 51.85s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [40:44<1:09:49, 51.09s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [41:32<1:07:58, 50.35s/it]EarlyStopping counter : 3 out of 12
training process:  38%|███▊      | 48/128 [42:19<1:05:45, 49.32s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.008, train acc : 0.880, valid acc : 0.775, train f1 : 0.878, valid f1 : 0.638
training process:  38%|███▊      | 49/128 [43:15<1:07:16, 51.10s/it]EarlyStopping counter : 5 out of 12
training process:  39%|███▉      | 50/128 [44:02<1:05:08, 50.10s/it]Best score increase :0.652 -> 0.653
training process:  40%|███▉      | 51/128 [44:50<1:03:24, 49.40s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [45:40<1:02:52, 49.63s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.001, valid loss : 0.008, train acc : 0.889, valid acc : 0.753, train f1 : 0.887, valid f1 : 0.621
training process:  41%|████▏     | 53/128 [46:37<1:04:50, 51.88s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [47:27<1:03:04, 51.15s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [48:19<1:02:25, 51.31s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [49:09<1:01:15, 51.05s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.001, valid loss : 0.007, train acc : 0.894, valid acc : 0.802, train f1 : 0.893, valid f1 : 0.661
training process:  45%|████▍     | 57/128 [50:09<1:03:29, 53.65s/it]Best score increase :0.653 -> 0.661
training process:  45%|████▌     | 58/128 [50:59<1:01:21, 52.60s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [51:53<1:00:59, 53.04s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [52:44<59:16, 52.30s/it]  Best score increase :0.661 -> 0.663
epoch : 61, train loss : 0.001, valid loss : 0.008, train acc : 0.893, valid acc : 0.782, train f1 : 0.892, valid f1 : 0.644
training process:  48%|████▊     | 61/128 [53:46<1:01:48, 55.35s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 62/128 [54:37<59:31, 54.11s/it]  EarlyStopping counter : 2 out of 12
training process:  49%|████▉     | 63/128 [55:32<58:52, 54.34s/it]EarlyStopping counter : 3 out of 12
training process:  50%|█████     | 64/128 [56:25<57:28, 53.89s/it]EarlyStopping counter : 4 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.007, train acc : 0.894, valid acc : 0.794, train f1 : 0.893, valid f1 : 0.655
training process:  51%|█████     | 65/128 [57:23<58:02, 55.28s/it]EarlyStopping counter : 5 out of 12
training process:  52%|█████▏    | 66/128 [58:16<56:24, 54.59s/it]Best score increase :0.663 -> 0.670
training process:  52%|█████▏    | 67/128 [59:11<55:28, 54.57s/it]EarlyStopping counter : 1 out of 12
training process:  53%|█████▎    | 68/128 [1:00:02<53:31, 53.53s/it]EarlyStopping counter : 2 out of 12
epoch : 69, train loss : 0.001, valid loss : 0.007, train acc : 0.900, valid acc : 0.805, train f1 : 0.899, valid f1 : 0.665
training process:  54%|█████▍    | 69/128 [1:01:01<54:16, 55.20s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▍    | 70/128 [1:01:55<52:58, 54.81s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▌    | 71/128 [1:02:44<50:29, 53.14s/it]EarlyStopping counter : 5 out of 12
training process:  56%|█████▋    | 72/128 [1:03:33<48:27, 51.92s/it]Best score increase :0.670 -> 0.690
epoch : 73, train loss : 0.001, valid loss : 0.007, train acc : 0.905, valid acc : 0.815, train f1 : 0.905, valid f1 : 0.674
training process:  57%|█████▋    | 73/128 [1:04:34<49:58, 54.51s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:05:26<48:22, 53.74s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:06:20<47:30, 53.78s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▉    | 76/128 [1:07:12<46:19, 53.45s/it]EarlyStopping counter : 4 out of 12
epoch : 77, train loss : 0.001, valid loss : 0.007, train acc : 0.905, valid acc : 0.824, train f1 : 0.904, valid f1 : 0.683
training process:  60%|██████    | 77/128 [1:08:13<47:21, 55.71s/it]EarlyStopping counter : 5 out of 12
training process:  61%|██████    | 78/128 [1:09:04<45:09, 54.19s/it]Best score increase :0.690 -> 0.692
training process:  62%|██████▏   | 79/128 [1:09:57<43:54, 53.77s/it]EarlyStopping counter : 1 out of 12
training process:  62%|██████▎   | 80/128 [1:10:46<41:57, 52.45s/it]EarlyStopping counter : 2 out of 12
epoch : 81, train loss : 0.001, valid loss : 0.008, train acc : 0.908, valid acc : 0.788, train f1 : 0.907, valid f1 : 0.648
training process:  63%|██████▎   | 81/128 [1:11:44<42:25, 54.16s/it]EarlyStopping counter : 3 out of 12
training process:  64%|██████▍   | 82/128 [1:12:38<41:22, 53.97s/it]EarlyStopping counter : 4 out of 12
training process:  65%|██████▍   | 83/128 [1:13:30<40:01, 53.36s/it]EarlyStopping counter : 5 out of 12
training process:  66%|██████▌   | 84/128 [1:14:20<38:26, 52.42s/it]EarlyStopping counter : 6 out of 12
epoch : 85, train loss : 0.001, valid loss : 0.007, train acc : 0.912, valid acc : 0.819, train f1 : 0.911, valid f1 : 0.678
training process:  66%|██████▋   | 85/128 [1:15:18<38:40, 53.97s/it]EarlyStopping counter : 7 out of 12
training process:  67%|██████▋   | 86/128 [1:16:09<37:20, 53.34s/it]EarlyStopping counter : 8 out of 12
training process:  68%|██████▊   | 87/128 [1:17:00<35:48, 52.41s/it]EarlyStopping counter : 9 out of 12
training process:  69%|██████▉   | 88/128 [1:17:51<34:38, 51.97s/it]Best score increase :0.692 -> 0.698
epoch : 89, train loss : 0.001, valid loss : 0.007, train acc : 0.913, valid acc : 0.819, train f1 : 0.913, valid f1 : 0.679
training process:  70%|██████▉   | 89/128 [1:18:48<34:51, 53.62s/it]EarlyStopping counter : 1 out of 12
training process:  70%|███████   | 90/128 [1:19:42<33:54, 53.55s/it]EarlyStopping counter : 2 out of 12
training process:  71%|███████   | 91/128 [1:20:34<32:51, 53.30s/it]EarlyStopping counter : 3 out of 12
training process:  72%|███████▏  | 92/128 [1:21:26<31:41, 52.81s/it]EarlyStopping counter : 4 out of 12
epoch : 93, train loss : 0.001, valid loss : 0.008, train acc : 0.916, valid acc : 0.794, train f1 : 0.916, valid f1 : 0.654
training process:  73%|███████▎  | 93/128 [1:22:25<31:50, 54.58s/it]EarlyStopping counter : 5 out of 12
training process:  73%|███████▎  | 94/128 [1:23:18<30:46, 54.32s/it]Best score increase :0.698 -> 0.725
training process:  74%|███████▍  | 95/128 [1:24:10<29:29, 53.63s/it]EarlyStopping counter : 1 out of 12
training process:  75%|███████▌  | 96/128 [1:25:01<28:04, 52.63s/it]EarlyStopping counter : 2 out of 12
epoch : 97, train loss : 0.001, valid loss : 0.007, train acc : 0.913, valid acc : 0.813, train f1 : 0.913, valid f1 : 0.672
training process:  76%|███████▌  | 97/128 [1:26:02<28:31, 55.20s/it]EarlyStopping counter : 3 out of 12
training process:  77%|███████▋  | 98/128 [1:26:55<27:18, 54.62s/it]EarlyStopping counter : 4 out of 12
training process:  77%|███████▋  | 99/128 [1:27:50<26:28, 54.79s/it]EarlyStopping counter : 5 out of 12
training process:  78%|███████▊  | 100/128 [1:28:41<24:59, 53.56s/it]EarlyStopping counter : 6 out of 12
epoch : 101, train loss : 0.001, valid loss : 0.007, train acc : 0.917, valid acc : 0.789, train f1 : 0.917, valid f1 : 0.650
training process:  79%|███████▉  | 101/128 [1:29:43<25:17, 56.22s/it]EarlyStopping counter : 7 out of 12
training process:  80%|███████▉  | 102/128 [1:30:36<23:52, 55.09s/it]EarlyStopping counter : 8 out of 12
training process:  80%|████████  | 103/128 [1:31:29<22:43, 54.53s/it]EarlyStopping counter : 9 out of 12
training process:  81%|████████▏ | 104/128 [1:32:19<21:17, 53.24s/it]EarlyStopping counter : 10 out of 12
epoch : 105, train loss : 0.001, valid loss : 0.007, train acc : 0.917, valid acc : 0.847, train f1 : 0.916, valid f1 : 0.704
training process:  82%|████████▏ | 105/128 [1:33:18<21:03, 54.93s/it]EarlyStopping counter : 11 out of 12
training process:  82%|████████▏ | 105/128 [1:34:08<20:37, 53.80s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 105, best f1 score : 0.725
training process finished, best loss : 0.007 and best acc : 0.865, best f1 : 0.725, best epoch : 93

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.44      0.87      0.59       580
           1       0.99      0.91      0.95      6818

    accuracy                           0.90      7398
   macro avg       0.72      0.89      0.77      7398
weighted avg       0.95      0.90      0.92      7398


# test acc : 0.90, test f1 : 0.77, test AUC : 0.89, test loss : 0.354

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.32s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.48s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.66s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:02,  7.78s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.79s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.84s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.85s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.96s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.90s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.94s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.84s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.86s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.82s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 31/306 [00:00<00:00, 303.09it/s] 20%|██        | 62/306 [00:00<00:00, 254.12it/s] 32%|███▏      | 97/306 [00:00<00:00, 292.19it/s] 42%|████▏     | 129/306 [00:00<00:00, 300.01it/s] 52%|█████▏    | 160/306 [00:00<00:00, 273.67it/s] 62%|██████▏   | 191/306 [00:00<00:00, 276.89it/s] 72%|███████▏  | 220/306 [00:00<00:00, 263.14it/s] 81%|████████  | 247/306 [00:00<00:00, 261.85it/s] 90%|████████▉ | 274/306 [00:01<00:00, 259.43it/s] 98%|█████████▊| 301/306 [00:01<00:00, 257.82it/s]100%|██████████| 306/306 [00:01<00:00, 266.66it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 52/553 [00:00<00:00, 514.20it/s]extract the null data:  20%|█▉        | 108/553 [00:00<00:00, 538.57it/s]extract the null data:  29%|██▉       | 163/553 [00:00<00:00, 542.26it/s]extract the null data:  40%|███▉      | 221/553 [00:00<00:00, 555.70it/s]extract the null data:  50%|█████     | 278/553 [00:00<00:00, 558.74it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 556.69it/s]extract the null data:  71%|███████   | 390/553 [00:00<00:00, 547.51it/s]extract the null data:  80%|████████  | 445/553 [00:00<00:00, 542.20it/s]extract the null data:  91%|█████████ | 502/553 [00:00<00:00, 550.69it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 549.69it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 187.00it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 189.35it/s]replace nan value:  10%|█         | 58/553 [00:00<00:02, 188.25it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 187.17it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:02, 188.31it/s]replace nan value:  21%|██        | 117/553 [00:00<00:02, 190.15it/s]replace nan value:  25%|██▍       | 137/553 [00:00<00:02, 191.19it/s]replace nan value:  28%|██▊       | 157/553 [00:00<00:02, 192.87it/s]replace nan value:  32%|███▏      | 177/553 [00:00<00:01, 192.31it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:01, 192.50it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 191.38it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 190.26it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:01, 189.97it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 190.28it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 189.30it/s]replace nan value:  57%|█████▋    | 317/553 [00:01<00:01, 190.74it/s]replace nan value:  61%|██████    | 337/553 [00:01<00:01, 191.27it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:01, 190.88it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 192.12it/s]replace nan value:  72%|███████▏  | 397/553 [00:02<00:00, 189.93it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 190.89it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 192.12it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 192.17it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 193.22it/s]replace nan value:  90%|████████▉ | 497/553 [00:02<00:00, 190.50it/s]replace nan value:  93%|█████████▎| 517/553 [00:02<00:00, 192.31it/s]replace nan value:  97%|█████████▋| 537/553 [00:02<00:00, 191.43it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 190.88it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.69it/s]  5%|▌         | 29/553 [00:00<00:03, 143.00it/s]  8%|▊         | 44/553 [00:00<00:03, 132.55it/s] 10%|█         | 58/553 [00:00<00:04, 122.59it/s] 13%|█▎        | 71/553 [00:00<00:03, 121.00it/s] 16%|█▌        | 88/553 [00:00<00:03, 134.77it/s] 18%|█▊        | 102/553 [00:00<00:03, 129.06it/s] 22%|██▏       | 120/553 [00:00<00:03, 141.77it/s] 24%|██▍       | 135/553 [00:01<00:02, 140.56it/s] 28%|██▊       | 153/553 [00:01<00:02, 150.26it/s] 31%|███       | 170/553 [00:01<00:02, 155.69it/s] 34%|███▎      | 186/553 [00:01<00:02, 150.91it/s] 37%|███▋      | 204/553 [00:01<00:02, 157.68it/s] 40%|███▉      | 220/553 [00:01<00:02, 149.77it/s] 43%|████▎     | 236/553 [00:01<00:02, 152.21it/s] 46%|████▌     | 252/553 [00:01<00:02, 148.62it/s] 48%|████▊     | 267/553 [00:01<00:01, 144.94it/s] 51%|█████     | 282/553 [00:01<00:01, 140.76it/s] 54%|█████▎    | 297/553 [00:02<00:01, 135.63it/s] 56%|█████▌    | 311/553 [00:02<00:01, 133.21it/s] 59%|█████▉    | 325/553 [00:02<00:01, 134.67it/s] 61%|██████▏   | 339/553 [00:02<00:01, 134.62it/s] 64%|██████▍   | 353/553 [00:02<00:01, 133.94it/s] 66%|██████▋   | 367/553 [00:02<00:01, 130.75it/s] 69%|██████▉   | 382/553 [00:02<00:01, 136.05it/s] 72%|███████▏  | 396/553 [00:02<00:01, 123.25it/s] 74%|███████▍  | 410/553 [00:02<00:01, 127.08it/s] 76%|███████▋  | 423/553 [00:03<00:01, 120.19it/s] 79%|███████▉  | 436/553 [00:03<00:00, 120.75it/s] 82%|████████▏ | 453/553 [00:03<00:00, 132.56it/s] 85%|████████▍ | 469/553 [00:03<00:00, 139.92it/s] 88%|████████▊ | 484/553 [00:03<00:00, 137.97it/s] 90%|█████████ | 498/553 [00:03<00:00, 127.27it/s] 93%|█████████▎| 513/553 [00:03<00:00, 132.96it/s] 95%|█████████▌| 527/553 [00:03<00:00, 118.41it/s] 98%|█████████▊| 540/553 [00:04<00:00, 120.64it/s]100%|██████████| 553/553 [00:04<00:00, 106.37it/s]100%|██████████| 553/553 [00:04<00:00, 132.65it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 325.06it/s]extract the null data:  72%|███████▏  | 100/139 [00:00<00:00, 524.80it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 531.76it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 218.91it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 212.89it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 212.46it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 211.63it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 212.80it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 209.33it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 211.39it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.93it/s] 19%|█▊        | 26/139 [00:00<00:00, 129.16it/s] 29%|██▉       | 41/139 [00:00<00:00, 137.73it/s] 40%|███▉      | 55/139 [00:00<00:00, 125.27it/s] 49%|████▉     | 68/139 [00:00<00:00, 126.85it/s] 58%|█████▊    | 81/139 [00:00<00:00, 124.56it/s] 68%|██████▊   | 94/139 [00:00<00:00, 113.53it/s] 76%|███████▋  | 106/139 [00:00<00:00, 115.16it/s] 87%|████████▋ | 121/139 [00:00<00:00, 125.13it/s] 96%|█████████▋| 134/139 [00:01<00:00, 119.98it/s]100%|██████████| 139/139 [00:01<00:00, 123.48it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 259.43it/s]extract the null data:  52%|█████▏    | 90/173 [00:00<00:00, 480.42it/s]extract the null data:  89%|████████▉ | 154/173 [00:00<00:00, 550.48it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 514.58it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 211.57it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 212.99it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 211.99it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 210.89it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 209.22it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 208.85it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 208.72it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.63it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 208.76it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.77it/s] 16%|█▌        | 28/173 [00:00<00:01, 121.21it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.56it/s] 34%|███▎      | 58/173 [00:00<00:00, 136.57it/s] 42%|████▏     | 72/173 [00:00<00:00, 136.17it/s] 50%|████▉     | 86/173 [00:00<00:00, 133.78it/s] 58%|█████▊    | 100/173 [00:00<00:00, 135.07it/s] 66%|██████▋   | 115/173 [00:00<00:00, 138.94it/s] 75%|███████▍  | 129/173 [00:00<00:00, 129.87it/s] 83%|████████▎ | 143/173 [00:01<00:00, 127.40it/s] 90%|█████████ | 156/173 [00:01<00:00, 118.31it/s] 97%|█████████▋| 168/173 [00:01<00:00, 97.38it/s] 100%|██████████| 173/173 [00:01<00:00, 117.52it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.009, train f1 : 0.499, valid f1 : 0.685
training process - Deferred Re-weighting:   1%|          | 1/128 [00:57<2:01:08, 57.24s/it]Best score increase :0.000 -> 0.685
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:45<1:49:33, 52.17s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:35<1:46:24, 51.08s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:24<1:43:27, 50.06s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.004, train f1 : 0.705, valid f1 : 0.693
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:25<1:50:45, 54.03s/it]Best score increase :0.685 -> 0.693
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:17<1:48:31, 53.37s/it]Best score increase :0.693 -> 0.710
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:11<1:47:55, 53.51s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:00<1:44:23, 52.20s/it]Best score increase :0.710 -> 0.711
epoch : 9, train loss : 0.003, valid loss : 0.004, train f1 : 0.746, valid f1 : 0.703
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:00<1:48:31, 54.72s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:53<1:46:34, 54.19s/it]Best score increase :0.711 -> 0.719
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:46<1:44:56, 53.82s/it]Best score increase :0.719 -> 0.731
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:38<1:42:33, 53.05s/it]Best score increase :0.731 -> 0.733
epoch : 13, train loss : 0.003, valid loss : 0.003, train f1 : 0.772, valid f1 : 0.731
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:38<1:46:02, 55.33s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:31<1:43:53, 54.68s/it]Best score increase :0.733 -> 0.742
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:23<1:41:11, 53.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:14<1:38:48, 52.94s/it]Best score increase :0.742 -> 0.750
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.792, valid f1 : 0.748
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:15<1:42:38, 55.49s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:07<1:39:49, 54.45s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:00<1:37:57, 53.92s/it]Best score increase :0.750 -> 0.753
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:50<1:35:06, 52.83s/it]Best score increase :0.753 -> 0.769
epoch : 21, train loss : 0.003, valid loss : 0.003, train f1 : 0.812, valid f1 : 0.761
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:49<1:37:25, 54.63s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:41<1:35:12, 53.89s/it]Best score increase :0.769 -> 0.784
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:33<1:33:18, 53.32s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:26<1:31:56, 53.04s/it]Best score increase :0.784 -> 0.788
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.832, valid f1 : 0.791
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:23<1:33:00, 54.17s/it]Best score increase :0.788 -> 0.791
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:15<1:31:13, 53.66s/it]Best score increase :0.791 -> 0.804
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:05<1:28:21, 52.49s/it]Best score increase :0.804 -> 0.806
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:55<1:26:12, 51.73s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.847, valid f1 : 0.794
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:52<1:28:15, 53.49s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:45<1:27:08, 53.35s/it]Best score increase :0.806 -> 0.814
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:35<1:24:31, 52.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:22<1:21:06, 50.70s/it]Best score increase :0.814 -> 0.818
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.858, valid f1 : 0.819
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:21<1:23:59, 53.05s/it]Best score increase :0.818 -> 0.819
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [30:11<1:21:47, 52.21s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:00<1:19:28, 51.28s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:49<1:17:47, 50.73s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.866, valid f1 : 0.817
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:46<1:19:45, 52.58s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:36<1:17:37, 51.75s/it]Best score increase :0.819 -> 0.828
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:24<1:15:12, 50.70s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:13<1:13:38, 50.21s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.873, valid f1 : 0.819
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:13<1:16:58, 53.08s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [37:02<1:14:20, 51.86s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:51<1:12:08, 50.93s/it]Best score increase :0.828 -> 0.837
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:40<1:10:33, 50.40s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.880, valid f1 : 0.826
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [39:38<1:12:58, 52.75s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [40:28<1:10:44, 51.77s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:19<1:09:28, 51.46s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [42:09<1:08:21, 51.27s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train f1 : 0.886, valid f1 : 0.820
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [43:09<1:10:51, 53.81s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [43:59<1:08:30, 52.70s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [44:50<1:07:00, 52.21s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [45:42<1:05:50, 51.98s/it]EarlyStopping counter : 9 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train f1 : 0.892, valid f1 : 0.847
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [46:43<1:08:29, 54.79s/it]Best score increase :0.837 -> 0.847
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [47:34<1:06:00, 53.52s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [48:24<1:03:49, 52.46s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [49:17<1:03:08, 52.61s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.003, train f1 : 0.896, valid f1 : 0.838
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [50:17<1:04:55, 54.86s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [51:09<1:03:09, 54.13s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [52:00<1:01:11, 53.21s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [52:49<58:50, 51.92s/it]  EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.001, valid loss : 0.003, train f1 : 0.899, valid f1 : 0.835
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [53:51<1:01:09, 54.77s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [54:42<59:06, 53.74s/it]  EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [55:32<56:55, 52.55s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [56:23<55:45, 52.27s/it]EarlyStopping counter : 11 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.003, train f1 : 0.902, valid f1 : 0.836
training process - Deferred Re-weighting:  50%|█████     | 64/128 [57:24<57:24, 53.82s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 64, best f1 score : 0.847
training process finished, best loss : 0.003, best acc : 0.958, best f1 : 0.847, best epoch : 52

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.87      0.63      0.73       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.92      0.81      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.81, test loss : 0.140

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.66s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.75s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.90s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:04,  8.09s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:56,  8.09s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.07s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.91s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.84s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.80s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.86s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.93s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  8.07s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.96s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 118.16it/s] 10%|█         | 31/306 [00:00<00:01, 157.58it/s] 18%|█▊        | 54/306 [00:00<00:01, 188.59it/s] 25%|██▌       | 78/306 [00:00<00:01, 207.69it/s] 32%|███▏      | 99/306 [00:00<00:01, 178.40it/s] 39%|███▊      | 118/306 [00:00<00:01, 169.08it/s] 44%|████▍     | 136/306 [00:01<00:01, 104.70it/s] 49%|████▉     | 150/306 [00:01<00:01, 105.62it/s] 57%|█████▋    | 173/306 [00:01<00:01, 131.79it/s] 64%|██████▍   | 196/306 [00:01<00:00, 153.47it/s] 73%|███████▎  | 222/306 [00:01<00:00, 178.26it/s] 79%|███████▉  | 243/306 [00:01<00:00, 149.73it/s] 88%|████████▊ | 268/306 [00:01<00:00, 169.55it/s] 95%|█████████▍| 290/306 [00:01<00:00, 181.69it/s]100%|██████████| 306/306 [00:01<00:00, 160.78it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 474.80it/s]extract the null data:  17%|█▋        | 96/553 [00:00<00:00, 468.69it/s]extract the null data:  26%|██▌       | 145/553 [00:00<00:00, 476.57it/s]extract the null data:  36%|███▋      | 201/553 [00:00<00:00, 506.72it/s]extract the null data:  47%|████▋     | 258/553 [00:00<00:00, 528.50it/s]extract the null data:  56%|█████▌    | 311/553 [00:00<00:00, 509.08it/s]extract the null data:  66%|██████▋   | 367/553 [00:00<00:00, 523.91it/s]extract the null data:  76%|███████▌  | 420/553 [00:00<00:00, 522.86it/s]extract the null data:  86%|████████▌ | 475/553 [00:00<00:00, 530.15it/s]extract the null data:  96%|█████████▌| 531/553 [00:01<00:00, 535.87it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 519.39it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 174.66it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 177.46it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 178.20it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 179.71it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 179.12it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 180.60it/s]replace nan value:  23%|██▎       | 129/553 [00:00<00:02, 179.71it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 180.48it/s]replace nan value:  30%|███       | 167/553 [00:00<00:02, 179.35it/s]replace nan value:  33%|███▎      | 185/553 [00:01<00:02, 177.52it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:01, 178.80it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 178.05it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 178.97it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 176.11it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 176.72it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 176.22it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 174.39it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:01, 173.83it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:01, 175.57it/s]replace nan value:  66%|██████▋   | 367/553 [00:02<00:01, 176.45it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 175.74it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 172.53it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 172.29it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 172.52it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 176.61it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 176.48it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 175.44it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 174.46it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 174.62it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 175.61it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 176.19it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 126.62it/s]  5%|▍         | 27/553 [00:00<00:03, 132.60it/s]  7%|▋         | 41/553 [00:00<00:03, 131.52it/s] 10%|▉         | 55/553 [00:00<00:04, 123.36it/s] 12%|█▏        | 68/553 [00:00<00:04, 111.32it/s] 15%|█▌        | 83/553 [00:00<00:03, 121.38it/s] 17%|█▋        | 96/553 [00:00<00:03, 123.81it/s] 20%|█▉        | 109/553 [00:00<00:03, 124.73it/s] 22%|██▏       | 124/553 [00:00<00:03, 131.05it/s] 25%|██▌       | 140/553 [00:01<00:02, 138.56it/s] 29%|██▊       | 158/553 [00:01<00:02, 149.90it/s] 31%|███▏      | 174/553 [00:01<00:02, 148.36it/s] 34%|███▍      | 189/553 [00:01<00:02, 148.17it/s] 37%|███▋      | 207/553 [00:01<00:02, 154.93it/s] 40%|████      | 223/553 [00:01<00:02, 144.92it/s] 43%|████▎     | 239/553 [00:01<00:02, 146.79it/s] 46%|████▌     | 254/553 [00:01<00:02, 138.69it/s] 49%|████▊     | 269/553 [00:01<00:02, 137.88it/s] 51%|█████     | 283/553 [00:02<00:02, 132.60it/s] 54%|█████▎    | 297/553 [00:02<00:01, 128.86it/s] 56%|█████▌    | 310/553 [00:02<00:01, 127.68it/s] 58%|█████▊    | 323/553 [00:02<00:01, 123.59it/s] 61%|██████    | 337/553 [00:02<00:01, 126.13it/s] 63%|██████▎   | 350/553 [00:02<00:01, 125.44it/s] 66%|██████▌   | 363/553 [00:02<00:01, 122.29it/s] 68%|██████▊   | 377/553 [00:02<00:01, 126.54it/s] 71%|███████   | 390/553 [00:02<00:01, 116.06it/s] 73%|███████▎  | 402/553 [00:03<00:01, 116.68it/s] 75%|███████▌  | 416/553 [00:03<00:01, 118.75it/s] 77%|███████▋  | 428/553 [00:03<00:01, 113.13it/s] 80%|████████  | 445/553 [00:03<00:00, 128.31it/s] 83%|████████▎ | 460/553 [00:03<00:00, 133.36it/s] 86%|████████▌ | 474/553 [00:03<00:00, 135.11it/s] 88%|████████▊ | 488/553 [00:03<00:00, 129.02it/s] 91%|█████████ | 502/553 [00:03<00:00, 122.36it/s] 93%|█████████▎| 517/553 [00:03<00:00, 128.37it/s] 96%|█████████▌| 530/553 [00:04<00:00, 109.24it/s] 98%|█████████▊| 544/553 [00:04<00:00, 116.74it/s]100%|██████████| 553/553 [00:04<00:00, 126.41it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 32/139 [00:00<00:00, 319.17it/s]extract the null data:  68%|██████▊   | 94/139 [00:00<00:00, 492.76it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 495.58it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 192.19it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 189.90it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 191.06it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 191.50it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 191.32it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 190.30it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 190.73it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.56it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.86it/s] 28%|██▊       | 39/139 [00:00<00:00, 129.45it/s] 37%|███▋      | 52/139 [00:00<00:00, 120.37it/s] 47%|████▋     | 66/139 [00:00<00:00, 126.28it/s] 57%|█████▋    | 79/139 [00:00<00:00, 119.27it/s] 66%|██████▌   | 92/139 [00:00<00:00, 110.71it/s] 76%|███████▌  | 105/139 [00:00<00:00, 111.72it/s] 86%|████████▌ | 119/139 [00:01<00:00, 119.48it/s] 95%|█████████▍| 132/139 [00:01<00:00, 114.43it/s]100%|██████████| 139/139 [00:01<00:00, 118.99it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 296.18it/s]extract the null data:  52%|█████▏    | 90/173 [00:00<00:00, 469.27it/s]extract the null data:  86%|████████▌ | 148/173 [00:00<00:00, 517.35it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 494.79it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 189.08it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 189.54it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 191.96it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 193.73it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 193.10it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 191.50it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 190.78it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 190.83it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 191.21it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 129.25it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.76it/s] 24%|██▎       | 41/173 [00:00<00:01, 120.74it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.36it/s] 39%|███▉      | 68/173 [00:00<00:00, 127.38it/s] 47%|████▋     | 81/173 [00:00<00:00, 126.17it/s] 54%|█████▍    | 94/173 [00:00<00:00, 127.13it/s] 62%|██████▏   | 107/173 [00:00<00:00, 125.57it/s] 69%|██████▉   | 120/173 [00:00<00:00, 125.51it/s] 77%|███████▋  | 133/173 [00:01<00:00, 119.46it/s] 84%|████████▍ | 146/173 [00:01<00:00, 119.51it/s] 92%|█████████▏| 159/173 [00:01<00:00, 110.71it/s] 99%|█████████▉| 171/173 [00:01<00:00, 84.71it/s] 100%|██████████| 173/173 [00:01<00:00, 110.43it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.010, train f1 : 0.708, valid f1 : 0.607
training process - Deferred Re-weighting:   1%|          | 1/128 [01:02<2:11:54, 62.32s/it]Best score increase :0.000 -> 0.607
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:54<1:58:50, 56.60s/it]Best score increase :0.607 -> 0.646
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:46<1:52:50, 54.17s/it]Best score increase :0.646 -> 0.662
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:39<1:50:55, 53.67s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.008, valid loss : 0.007, train f1 : 0.824, valid f1 : 0.695
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:41<1:56:07, 56.64s/it]Best score increase :0.662 -> 0.695
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:33<1:52:33, 55.36s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:23<1:47:48, 53.46s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:17<1:47:07, 53.56s/it]EarlyStopping counter : 3 out of 12
epoch : 9, train loss : 0.007, valid loss : 0.007, train f1 : 0.848, valid f1 : 0.682
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:14<1:48:50, 54.88s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:04<1:44:25, 53.10s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:53<1:41:34, 52.09s/it]Best score increase :0.695 -> 0.709
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:46<1:41:00, 52.25s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.006, train f1 : 0.870, valid f1 : 0.713
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:48<1:45:45, 55.18s/it]Best score increase :0.709 -> 0.713
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:38<1:41:54, 53.64s/it]Best score increase :0.713 -> 0.720
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:28<1:39:11, 52.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:21<1:38:28, 52.75s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.006, train f1 : 0.892, valid f1 : 0.705
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:19<1:40:09, 54.14s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:08<1:36:36, 52.69s/it]Best score increase :0.720 -> 0.752
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:59<1:34:48, 52.18s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:46<1:31:06, 50.61s/it]Best score increase :0.752 -> 0.763
epoch : 21, train loss : 0.005, valid loss : 0.005, train f1 : 0.904, valid f1 : 0.748
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:43<1:33:29, 52.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:32<1:30:58, 51.50s/it]Best score increase :0.763 -> 0.767
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:22<1:29:15, 51.00s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:10<1:27:03, 50.23s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.005, train f1 : 0.913, valid f1 : 0.754
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:07<1:29:49, 52.32s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:55<1:26:41, 51.00s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:43<1:24:18, 50.08s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:32<1:22:41, 49.61s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.005, train f1 : 0.923, valid f1 : 0.774
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:30<1:26:02, 52.15s/it]Best score increase :0.767 -> 0.774
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:16<1:22:12, 50.34s/it]Best score increase :0.774 -> 0.786
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:03<1:19:31, 49.19s/it]Best score increase :0.786 -> 0.800
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:51<1:18:08, 48.84s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.004, train f1 : 0.924, valid f1 : 0.803
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [28:48<1:21:26, 51.44s/it]Best score increase :0.800 -> 0.803
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:43<1:22:16, 52.52s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:35<1:21:03, 52.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:26<1:19:27, 51.83s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.004, train f1 : 0.932, valid f1 : 0.800
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:27<1:22:59, 54.72s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:19<1:20:55, 53.95s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:10<1:18:43, 53.07s/it]Best score increase :0.803 -> 0.810
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:03<1:17:50, 53.08s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.005, train f1 : 0.936, valid f1 : 0.769
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:04<1:20:07, 55.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:56<1:18:01, 54.44s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:48<1:15:50, 53.53s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:41<1:14:40, 53.34s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.004, train f1 : 0.942, valid f1 : 0.781
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [39:43<1:17:26, 55.98s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [40:37<1:15:53, 55.54s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:28<1:13:08, 54.17s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [42:19<1:11:04, 53.31s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.003, valid loss : 0.004, train f1 : 0.940, valid f1 : 0.811
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [43:19<1:12:31, 55.09s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [44:09<1:09:37, 53.56s/it]Best score increase :0.810 -> 0.823
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [45:00<1:07:41, 52.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [45:51<1:06:30, 52.50s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.003, valid loss : 0.005, train f1 : 0.946, valid f1 : 0.781
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [46:51<1:08:08, 54.52s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [47:44<1:06:41, 54.07s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [48:36<1:05:07, 53.53s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [49:25<1:02:33, 52.13s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.003, valid loss : 0.004, train f1 : 0.944, valid f1 : 0.809
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [50:24<1:04:15, 54.30s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [51:12<1:00:54, 52.21s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [52:02<59:29, 51.73s/it]  EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [52:55<58:53, 51.96s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.003, valid loss : 0.004, train f1 : 0.946, valid f1 : 0.809
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [53:53<1:00:11, 53.90s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [54:42<1:00:05, 53.81s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.823
training process finished, best loss : 0.003, best acc : 0.936, best f1 : 0.823, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.78      0.71       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.87      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.87, test loss : 0.175

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.72s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.72s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.81s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:04,  8.04s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:56,  8.07s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:49,  8.17s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:40,  8.12s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:32,  8.01s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:24,  8.04s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.92s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.98s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.98s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  9%|▉         | 28/306 [00:00<00:01, 252.88it/s] 18%|█▊        | 54/306 [00:00<00:01, 239.90it/s] 25%|██▌       | 78/306 [00:00<00:01, 191.45it/s] 32%|███▏      | 98/306 [00:00<00:01, 177.18it/s] 39%|███▉      | 120/306 [00:00<00:00, 189.60it/s] 47%|████▋     | 143/306 [00:00<00:00, 201.33it/s] 54%|█████▎    | 164/306 [00:00<00:00, 197.39it/s] 60%|██████    | 185/306 [00:00<00:00, 170.78it/s] 68%|██████▊   | 209/306 [00:01<00:00, 186.16it/s] 75%|███████▌  | 231/306 [00:01<00:00, 194.85it/s] 82%|████████▏ | 252/306 [00:01<00:00, 192.20it/s] 89%|████████▉ | 272/306 [00:01<00:00, 170.66it/s] 97%|█████████▋| 297/306 [00:01<00:00, 189.46it/s]100%|██████████| 306/306 [00:01<00:00, 191.64it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 484.60it/s]extract the null data:  18%|█▊        | 101/553 [00:00<00:00, 503.30it/s]extract the null data:  28%|██▊       | 154/553 [00:00<00:00, 514.05it/s]extract the null data:  37%|███▋      | 206/553 [00:00<00:00, 512.92it/s]extract the null data:  47%|████▋     | 259/553 [00:00<00:00, 515.51it/s]extract the null data:  56%|█████▌    | 311/553 [00:00<00:00, 500.02it/s]extract the null data:  66%|██████▌   | 363/553 [00:00<00:00, 503.53it/s]extract the null data:  75%|███████▌  | 417/553 [00:00<00:00, 514.34it/s]extract the null data:  85%|████████▌ | 471/553 [00:00<00:00, 520.10it/s]extract the null data:  95%|█████████▍| 524/553 [00:01<00:00, 514.12it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 510.56it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 175.97it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:02, 179.92it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 176.53it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 176.36it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 176.57it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 176.55it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 178.03it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 174.80it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:02, 176.88it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 176.92it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 179.68it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 179.84it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 180.05it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 179.15it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 180.76it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 180.23it/s]replace nan value:  57%|█████▋    | 316/553 [00:01<00:01, 180.42it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 181.42it/s]replace nan value:  64%|██████▍   | 354/553 [00:01<00:01, 177.91it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:01, 179.85it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:00, 179.28it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 180.36it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 178.03it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 179.64it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 181.07it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 180.76it/s]replace nan value:  92%|█████████▏| 506/553 [00:02<00:00, 181.15it/s]replace nan value:  95%|█████████▍| 525/553 [00:02<00:00, 178.98it/s]replace nan value:  98%|█████████▊| 543/553 [00:03<00:00, 178.34it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 178.72it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.17it/s]  5%|▍         | 27/553 [00:00<00:03, 134.34it/s]  7%|▋         | 41/553 [00:00<00:03, 132.13it/s] 10%|▉         | 55/553 [00:00<00:04, 123.27it/s] 12%|█▏        | 68/553 [00:00<00:04, 111.58it/s] 15%|█▌        | 83/553 [00:00<00:03, 122.44it/s] 17%|█▋        | 96/553 [00:00<00:03, 124.30it/s] 20%|█▉        | 109/553 [00:00<00:03, 125.67it/s] 22%|██▏       | 124/553 [00:00<00:03, 131.27it/s] 25%|██▌       | 140/553 [00:01<00:02, 137.77it/s] 29%|██▊       | 158/553 [00:01<00:02, 147.57it/s] 31%|███▏      | 174/553 [00:01<00:02, 145.61it/s] 34%|███▍      | 189/553 [00:01<00:02, 146.00it/s] 37%|███▋      | 206/553 [00:01<00:02, 151.42it/s] 40%|████      | 222/553 [00:01<00:02, 141.02it/s] 43%|████▎     | 238/553 [00:01<00:02, 144.58it/s] 46%|████▌     | 253/553 [00:01<00:02, 141.11it/s] 48%|████▊     | 268/553 [00:01<00:02, 138.78it/s] 51%|█████     | 282/553 [00:02<00:02, 134.05it/s] 54%|█████▎    | 296/553 [00:02<00:01, 130.21it/s] 56%|█████▌    | 310/553 [00:02<00:01, 128.30it/s] 58%|█████▊    | 323/553 [00:02<00:01, 126.62it/s] 61%|██████    | 337/553 [00:02<00:01, 129.28it/s] 63%|██████▎   | 350/553 [00:02<00:01, 127.93it/s] 66%|██████▌   | 363/553 [00:02<00:01, 124.47it/s] 68%|██████▊   | 378/553 [00:02<00:01, 128.74it/s] 71%|███████   | 391/553 [00:02<00:01, 118.74it/s] 73%|███████▎  | 404/553 [00:03<00:01, 119.47it/s] 75%|███████▌  | 417/553 [00:03<00:01, 117.56it/s] 78%|███████▊  | 429/553 [00:03<00:01, 113.88it/s] 81%|████████  | 446/553 [00:03<00:00, 128.95it/s] 83%|████████▎ | 461/553 [00:03<00:00, 134.43it/s] 86%|████████▌ | 475/553 [00:03<00:00, 135.11it/s] 88%|████████▊ | 489/553 [00:03<00:00, 127.58it/s] 91%|█████████ | 502/553 [00:03<00:00, 122.70it/s] 93%|█████████▎| 517/553 [00:03<00:00, 128.89it/s] 96%|█████████▌| 531/553 [00:04<00:00, 109.04it/s] 99%|█████████▉| 547/553 [00:04<00:00, 120.10it/s]100%|██████████| 553/553 [00:04<00:00, 126.87it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 286.11it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 454.83it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 484.85it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 202.11it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 202.05it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 198.95it/s]replace nan value:  60%|█████▉    | 83/139 [00:00<00:00, 197.21it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 196.21it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 197.70it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 197.97it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.55it/s] 18%|█▊        | 25/139 [00:00<00:00, 120.60it/s] 28%|██▊       | 39/139 [00:00<00:00, 128.86it/s] 37%|███▋      | 52/139 [00:00<00:00, 119.85it/s] 47%|████▋     | 66/139 [00:00<00:00, 124.82it/s] 57%|█████▋    | 79/139 [00:00<00:00, 118.65it/s] 65%|██████▌   | 91/139 [00:00<00:00, 109.28it/s] 75%|███████▍  | 104/139 [00:00<00:00, 115.00it/s] 84%|████████▍ | 117/139 [00:00<00:00, 116.63it/s] 94%|█████████▍| 131/139 [00:01<00:00, 120.58it/s]100%|██████████| 139/139 [00:01<00:00, 120.96it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 209.76it/s]extract the null data:  47%|████▋     | 81/173 [00:00<00:00, 435.48it/s]extract the null data:  81%|████████  | 140/173 [00:00<00:00, 502.90it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 477.43it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 195.23it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 197.81it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 198.65it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 199.41it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 200.97it/s]replace nan value:  71%|███████   | 123/173 [00:00<00:00, 197.83it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 197.99it/s]replace nan value:  95%|█████████▍| 164/173 [00:00<00:00, 198.59it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 197.77it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.66it/s] 16%|█▌        | 28/173 [00:00<00:01, 115.18it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.82it/s] 32%|███▏      | 56/173 [00:00<00:00, 129.62it/s] 40%|████      | 70/173 [00:00<00:00, 128.91it/s] 49%|████▉     | 85/173 [00:00<00:00, 134.55it/s] 58%|█████▊    | 101/173 [00:00<00:00, 139.49it/s] 68%|██████▊   | 117/173 [00:00<00:00, 145.47it/s] 76%|███████▋  | 132/173 [00:00<00:00, 138.14it/s] 84%|████████▍ | 146/173 [00:01<00:00, 137.35it/s] 92%|█████████▏| 160/173 [00:01<00:00, 126.89it/s]100%|██████████| 173/173 [00:01<00:00, 98.54it/s] 100%|██████████| 173/173 [00:01<00:00, 121.52it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.453, valid loss : 0.331, train acc : 0.874, valid acc : 0.925, train f1 : 0.585, valid f1 : 0.602
training process:   1%|          | 1/128 [01:02<2:12:56, 62.80s/it]Best score increase :0.000 -> 0.602
training process:   2%|▏         | 2/128 [01:50<1:52:52, 53.75s/it]Best score increase :0.602 -> 0.617
training process:   2%|▏         | 3/128 [02:37<1:45:55, 50.85s/it]Best score increase :0.617 -> 0.663
training process:   3%|▎         | 4/128 [03:26<1:43:27, 50.06s/it]Best score increase :0.663 -> 0.685
epoch : 5, train loss : 0.192, valid loss : 0.204, train acc : 0.937, valid acc : 0.935, train f1 : 0.698, valid f1 : 0.691
training process:   4%|▍         | 5/128 [04:26<1:50:11, 53.76s/it]Best score increase :0.685 -> 0.691
training process:   5%|▍         | 6/128 [05:17<1:47:28, 52.86s/it]Best score increase :0.691 -> 0.715
training process:   5%|▌         | 7/128 [06:10<1:46:32, 52.83s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:04<1:46:10, 53.09s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.168, valid loss : 0.193, train acc : 0.943, valid acc : 0.936, train f1 : 0.738, valid f1 : 0.705
training process:   7%|▋         | 9/128 [08:01<1:47:42, 54.31s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [08:50<1:43:50, 52.80s/it]EarlyStopping counter : 4 out of 12
training process:   9%|▊         | 11/128 [09:41<1:41:52, 52.25s/it]Best score increase :0.715 -> 0.733
training process:   9%|▉         | 12/128 [10:34<1:41:14, 52.37s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.155, valid loss : 0.190, train acc : 0.946, valid acc : 0.938, train f1 : 0.759, valid f1 : 0.725
training process:  10%|█         | 13/128 [11:31<1:43:20, 53.92s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:26<1:42:41, 54.05s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [13:19<1:41:25, 53.85s/it]Best score increase :0.733 -> 0.754
training process:  12%|█▎        | 16/128 [14:11<1:39:35, 53.35s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.146, valid loss : 0.179, train acc : 0.949, valid acc : 0.940, train f1 : 0.779, valid f1 : 0.750
training process:  13%|█▎        | 17/128 [15:12<1:43:02, 55.70s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [16:06<1:40:55, 55.05s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [16:58<1:38:05, 53.99s/it]Best score increase :0.754 -> 0.768
training process:  16%|█▌        | 20/128 [17:50<1:36:08, 53.41s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.138, valid loss : 0.177, train acc : 0.952, valid acc : 0.942, train f1 : 0.799, valid f1 : 0.765
training process:  16%|█▋        | 21/128 [18:52<1:39:50, 55.98s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [19:40<1:35:09, 53.87s/it]Best score increase :0.768 -> 0.774
training process:  18%|█▊        | 23/128 [20:32<1:32:58, 53.13s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:23<1:30:54, 52.45s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.131, valid loss : 0.177, train acc : 0.954, valid acc : 0.942, train f1 : 0.811, valid f1 : 0.764
training process:  20%|█▉        | 25/128 [22:20<1:32:32, 53.90s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [23:08<1:28:35, 52.11s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [24:01<1:28:24, 52.52s/it]Best score increase :0.774 -> 0.778
training process:  22%|██▏       | 28/128 [24:53<1:26:49, 52.09s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.124, valid loss : 0.170, train acc : 0.957, valid acc : 0.944, train f1 : 0.822, valid f1 : 0.778
training process:  23%|██▎       | 29/128 [25:53<1:29:54, 54.49s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [26:43<1:26:46, 53.13s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [27:36<1:25:47, 53.07s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [28:27<1:24:18, 52.70s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.119, valid loss : 0.178, train acc : 0.958, valid acc : 0.944, train f1 : 0.830, valid f1 : 0.780
training process:  26%|██▌       | 33/128 [29:28<1:27:25, 55.21s/it]Best score increase :0.778 -> 0.780
training process:  27%|██▋       | 34/128 [30:19<1:24:22, 53.86s/it]Best score increase :0.780 -> 0.783
training process:  27%|██▋       | 35/128 [31:09<1:21:30, 52.59s/it]Best score increase :0.783 -> 0.785
training process:  28%|██▊       | 36/128 [32:00<1:19:47, 52.04s/it]Best score increase :0.785 -> 0.792
epoch : 37, train loss : 0.111, valid loss : 0.175, train acc : 0.960, valid acc : 0.945, train f1 : 0.839, valid f1 : 0.781
training process:  29%|██▉       | 37/128 [33:00<1:22:45, 54.57s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [33:54<1:21:26, 54.29s/it]Best score increase :0.792 -> 0.794
training process:  30%|███       | 39/128 [34:44<1:18:44, 53.09s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [35:34<1:16:32, 52.19s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.107, valid loss : 0.168, train acc : 0.962, valid acc : 0.947, train f1 : 0.850, valid f1 : 0.787
training process:  32%|███▏      | 41/128 [36:35<1:19:29, 54.82s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [37:25<1:16:25, 53.32s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [38:14<1:13:51, 52.14s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [39:05<1:12:19, 51.66s/it]Best score increase :0.794 -> 0.806
epoch : 45, train loss : 0.106, valid loss : 0.164, train acc : 0.962, valid acc : 0.948, train f1 : 0.851, valid f1 : 0.790
training process:  35%|███▌      | 45/128 [40:07<1:15:40, 54.71s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [40:56<1:12:40, 53.18s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [41:45<1:09:59, 51.85s/it]Best score increase :0.806 -> 0.820
training process:  38%|███▊      | 48/128 [42:35<1:08:16, 51.21s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.101, valid loss : 0.166, train acc : 0.964, valid acc : 0.951, train f1 : 0.859, valid f1 : 0.814
training process:  38%|███▊      | 49/128 [43:32<1:09:57, 53.13s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [44:22<1:07:53, 52.23s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [45:12<1:05:58, 51.41s/it]EarlyStopping counter : 4 out of 12
training process:  41%|████      | 52/128 [46:01<1:04:13, 50.70s/it]Best score increase :0.820 -> 0.822
epoch : 53, train loss : 0.097, valid loss : 0.163, train acc : 0.966, valid acc : 0.950, train f1 : 0.866, valid f1 : 0.803
training process:  41%|████▏     | 53/128 [47:00<1:06:29, 53.20s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [47:51<1:04:57, 52.68s/it]Best score increase :0.822 -> 0.834
training process:  43%|████▎     | 55/128 [48:42<1:03:29, 52.19s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [49:35<1:02:49, 52.36s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.094, valid loss : 0.164, train acc : 0.967, valid acc : 0.952, train f1 : 0.872, valid f1 : 0.820
training process:  45%|████▍     | 57/128 [50:32<1:03:42, 53.84s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [51:22<1:01:10, 52.44s/it]EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [52:15<1:00:36, 52.70s/it]EarlyStopping counter : 5 out of 12
training process:  47%|████▋     | 60/128 [53:04<58:28, 51.59s/it]  Best score increase :0.834 -> 0.839
epoch : 61, train loss : 0.090, valid loss : 0.161, train acc : 0.967, valid acc : 0.951, train f1 : 0.874, valid f1 : 0.821
training process:  48%|████▊     | 61/128 [54:01<59:26, 53.23s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 62/128 [54:51<57:19, 52.12s/it]EarlyStopping counter : 2 out of 12
training process:  49%|████▉     | 63/128 [55:40<55:33, 51.29s/it]EarlyStopping counter : 3 out of 12
training process:  50%|█████     | 64/128 [56:29<53:52, 50.51s/it]EarlyStopping counter : 4 out of 12
epoch : 65, train loss : 0.088, valid loss : 0.172, train acc : 0.969, valid acc : 0.956, train f1 : 0.883, valid f1 : 0.844
training process:  51%|█████     | 65/128 [57:27<55:27, 52.82s/it]Best score increase :0.839 -> 0.844
training process:  52%|█████▏    | 66/128 [58:15<53:06, 51.40s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 67/128 [59:04<51:28, 50.63s/it]EarlyStopping counter : 2 out of 12
training process:  53%|█████▎    | 68/128 [59:53<50:21, 50.35s/it]EarlyStopping counter : 3 out of 12
epoch : 69, train loss : 0.088, valid loss : 0.166, train acc : 0.969, valid acc : 0.955, train f1 : 0.881, valid f1 : 0.837
training process:  54%|█████▍    | 69/128 [1:00:50<51:27, 52.33s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▍    | 70/128 [1:01:39<49:32, 51.24s/it]Best score increase :0.844 -> 0.847
training process:  55%|█████▌    | 71/128 [1:02:28<48:04, 50.61s/it]EarlyStopping counter : 1 out of 12
training process:  56%|█████▋    | 72/128 [1:03:19<47:10, 50.55s/it]EarlyStopping counter : 2 out of 12
epoch : 73, train loss : 0.084, valid loss : 0.163, train acc : 0.971, valid acc : 0.955, train f1 : 0.890, valid f1 : 0.831
training process:  57%|█████▋    | 73/128 [1:04:19<48:58, 53.42s/it]EarlyStopping counter : 3 out of 12
training process:  58%|█████▊    | 74/128 [1:05:10<47:33, 52.85s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▊    | 75/128 [1:06:02<46:31, 52.68s/it]Best score increase :0.847 -> 0.852
training process:  59%|█████▉    | 76/128 [1:06:55<45:42, 52.75s/it]EarlyStopping counter : 1 out of 12
epoch : 77, train loss : 0.084, valid loss : 0.163, train acc : 0.970, valid acc : 0.950, train f1 : 0.889, valid f1 : 0.816
training process:  60%|██████    | 77/128 [1:07:54<46:19, 54.51s/it]EarlyStopping counter : 2 out of 12
training process:  61%|██████    | 78/128 [1:08:44<44:18, 53.18s/it]EarlyStopping counter : 3 out of 12
training process:  62%|██████▏   | 79/128 [1:09:35<42:46, 52.38s/it]EarlyStopping counter : 4 out of 12
training process:  62%|██████▎   | 80/128 [1:10:25<41:32, 51.92s/it]EarlyStopping counter : 5 out of 12
epoch : 81, train loss : 0.079, valid loss : 0.169, train acc : 0.972, valid acc : 0.957, train f1 : 0.894, valid f1 : 0.839
training process:  63%|██████▎   | 81/128 [1:11:26<42:41, 54.49s/it]EarlyStopping counter : 6 out of 12
training process:  64%|██████▍   | 82/128 [1:12:18<41:12, 53.75s/it]EarlyStopping counter : 7 out of 12
training process:  65%|██████▍   | 83/128 [1:13:10<40:00, 53.34s/it]EarlyStopping counter : 8 out of 12
training process:  66%|██████▌   | 84/128 [1:14:02<38:41, 52.77s/it]EarlyStopping counter : 9 out of 12
epoch : 85, train loss : 0.079, valid loss : 0.171, train acc : 0.972, valid acc : 0.957, train f1 : 0.894, valid f1 : 0.843
training process:  66%|██████▋   | 85/128 [1:15:03<39:37, 55.30s/it]EarlyStopping counter : 10 out of 12
training process:  67%|██████▋   | 86/128 [1:15:54<37:43, 53.90s/it]EarlyStopping counter : 11 out of 12
training process:  67%|██████▋   | 86/128 [1:16:44<37:28, 53.54s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 86, best f1 score : 0.853
training process finished, best loss : 0.170 and best acc : 0.957, best f1 : 0.853, best epoch : 78

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.53      0.66      0.59       580
           1       0.97      0.95      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.80      0.77      7398
weighted avg       0.94      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.77, test AUC : 0.80, test loss : 19.763

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.24s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:27,  8.76s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:17,  8.65s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:08,  8.58s/it]processing for feature importance:  42%|████▏     | 5/12 [00:43<01:00,  8.66s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:51,  8.52s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:59<00:42,  8.46s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:33,  8.31s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:16<00:25,  8.35s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:24<00:16,  8.34s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:32<00:08,  8.18s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.10s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.35s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 25/306 [00:00<00:01, 237.90it/s] 17%|█▋        | 53/306 [00:00<00:00, 258.33it/s] 26%|██▌       | 79/306 [00:00<00:00, 249.73it/s] 34%|███▍      | 105/306 [00:00<00:00, 251.24it/s] 43%|████▎     | 131/306 [00:00<00:00, 246.62it/s] 51%|█████▏    | 157/306 [00:00<00:00, 250.13it/s] 60%|█████▉    | 183/306 [00:00<00:00, 246.94it/s] 69%|██████▉   | 211/306 [00:00<00:00, 255.27it/s] 77%|███████▋  | 237/306 [00:00<00:00, 243.26it/s] 87%|████████▋ | 265/306 [00:01<00:00, 253.47it/s] 95%|█████████▌| 291/306 [00:01<00:00, 237.30it/s]100%|██████████| 306/306 [00:01<00:00, 246.34it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 41/553 [00:00<00:01, 401.27it/s]extract the null data:  15%|█▍        | 82/553 [00:00<00:01, 401.29it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:01, 407.71it/s]extract the null data:  30%|███       | 166/553 [00:00<00:00, 410.43it/s]extract the null data:  38%|███▊      | 208/553 [00:00<00:00, 413.23it/s]extract the null data:  45%|████▌     | 250/553 [00:00<00:00, 413.73it/s]extract the null data:  53%|█████▎    | 293/553 [00:00<00:00, 418.27it/s]extract the null data:  61%|██████    | 336/553 [00:00<00:00, 419.02it/s]extract the null data:  68%|██████▊   | 378/553 [00:00<00:00, 418.62it/s]extract the null data:  76%|███████▌  | 420/553 [00:01<00:00, 414.17it/s]extract the null data:  84%|████████▎ | 462/553 [00:01<00:00, 408.01it/s]extract the null data:  91%|█████████ | 503/553 [00:01<00:00, 405.87it/s]extract the null data:  98%|█████████▊| 544/553 [00:01<00:00, 403.53it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 409.09it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 147.33it/s]replace nan value:   6%|▌         | 31/553 [00:00<00:03, 151.00it/s]replace nan value:   8%|▊         | 47/553 [00:00<00:03, 146.93it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:03, 150.53it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:03, 152.32it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:02, 153.97it/s]replace nan value:  20%|██        | 112/553 [00:00<00:02, 156.04it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 156.00it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:02, 157.76it/s]replace nan value:  29%|██▉       | 161/553 [00:01<00:02, 158.36it/s]replace nan value:  32%|███▏      | 178/553 [00:01<00:02, 158.92it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:02, 159.08it/s]replace nan value:  38%|███▊      | 211/553 [00:01<00:02, 159.77it/s]replace nan value:  41%|████      | 227/553 [00:01<00:02, 159.65it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 159.59it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 157.56it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:01, 157.10it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 156.50it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 156.51it/s]replace nan value:  58%|█████▊    | 323/553 [00:02<00:01, 155.88it/s]replace nan value:  61%|██████▏   | 339/553 [00:02<00:01, 156.60it/s]replace nan value:  64%|██████▍   | 355/553 [00:02<00:01, 156.54it/s]replace nan value:  67%|██████▋   | 372/553 [00:02<00:01, 158.10it/s]replace nan value:  70%|███████   | 388/553 [00:02<00:01, 157.85it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 156.96it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 156.40it/s]replace nan value:  79%|███████▉  | 436/553 [00:02<00:00, 156.42it/s]replace nan value:  82%|████████▏ | 452/553 [00:02<00:00, 157.45it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 157.87it/s]replace nan value:  88%|████████▊ | 484/553 [00:03<00:00, 157.70it/s]replace nan value:  90%|█████████ | 500/553 [00:03<00:00, 157.48it/s]replace nan value:  93%|█████████▎| 516/553 [00:03<00:00, 157.69it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 157.56it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 158.93it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 156.74it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 118.70it/s]  5%|▍         | 26/553 [00:00<00:04, 128.59it/s]  7%|▋         | 40/553 [00:00<00:03, 128.34it/s] 10%|▉         | 53/553 [00:00<00:04, 117.23it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.66it/s] 14%|█▍        | 78/553 [00:00<00:04, 113.18it/s] 16%|█▋        | 91/553 [00:00<00:03, 117.64it/s] 19%|█▉        | 104/553 [00:00<00:03, 119.88it/s] 22%|██▏       | 119/553 [00:00<00:03, 128.32it/s] 24%|██▍       | 132/553 [00:01<00:03, 124.49it/s] 27%|██▋       | 149/553 [00:01<00:02, 136.74it/s] 30%|██▉       | 165/553 [00:01<00:02, 141.24it/s] 33%|███▎      | 180/553 [00:01<00:02, 142.88it/s] 35%|███▌      | 195/553 [00:01<00:02, 143.06it/s] 38%|███▊      | 211/553 [00:01<00:02, 145.41it/s] 41%|████      | 226/553 [00:01<00:02, 136.78it/s] 43%|████▎     | 240/553 [00:01<00:02, 137.38it/s] 46%|████▌     | 254/553 [00:01<00:02, 130.28it/s] 48%|████▊     | 268/553 [00:02<00:02, 131.23it/s] 51%|█████     | 282/553 [00:02<00:02, 127.00it/s] 53%|█████▎    | 295/553 [00:02<00:02, 124.37it/s] 56%|█████▌    | 308/553 [00:02<00:01, 122.67it/s] 58%|█████▊    | 321/553 [00:02<00:01, 119.28it/s] 60%|██████    | 334/553 [00:02<00:01, 120.96it/s] 63%|██████▎   | 347/553 [00:02<00:01, 122.83it/s] 65%|██████▌   | 360/553 [00:02<00:01, 115.54it/s] 68%|██████▊   | 376/553 [00:02<00:01, 123.16it/s] 70%|███████   | 389/553 [00:03<00:01, 117.76it/s] 73%|███████▎  | 401/553 [00:03<00:01, 109.73it/s] 75%|███████▌  | 415/553 [00:03<00:01, 114.44it/s] 77%|███████▋  | 427/553 [00:03<00:01, 107.76it/s] 80%|███████▉  | 442/553 [00:03<00:00, 117.74it/s] 83%|████████▎ | 457/553 [00:03<00:00, 126.04it/s] 85%|████████▌ | 471/553 [00:03<00:00, 128.34it/s] 88%|████████▊ | 484/553 [00:03<00:00, 127.96it/s] 90%|████████▉ | 497/553 [00:04<00:00, 116.43it/s] 93%|█████████▎| 512/553 [00:04<00:00, 122.44it/s] 95%|█████████▍| 525/553 [00:04<00:00, 111.14it/s] 97%|█████████▋| 537/553 [00:04<00:00, 106.64it/s]100%|█████████▉| 551/553 [00:04<00:00, 97.37it/s] 100%|██████████| 553/553 [00:04<00:00, 121.00it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 21/139 [00:00<00:00, 208.33it/s]extract the null data:  51%|█████     | 71/139 [00:00<00:00, 376.71it/s]extract the null data:  86%|████████▌ | 119/139 [00:00<00:00, 421.31it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 403.17it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 177.18it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 175.87it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 175.76it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 173.75it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 173.06it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 173.02it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 174.26it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 174.80it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 104.46it/s] 17%|█▋        | 23/139 [00:00<00:01, 112.03it/s] 27%|██▋       | 37/139 [00:00<00:00, 121.73it/s] 36%|███▌      | 50/139 [00:00<00:00, 121.11it/s] 45%|████▌     | 63/139 [00:00<00:00, 116.65it/s] 54%|█████▍    | 75/139 [00:00<00:00, 116.68it/s] 63%|██████▎   | 87/139 [00:00<00:00, 106.33it/s] 71%|███████   | 99/139 [00:00<00:00, 106.30it/s] 79%|███████▉  | 110/139 [00:00<00:00, 106.23it/s] 89%|████████▉ | 124/139 [00:01<00:00, 114.78it/s] 98%|█████████▊| 136/139 [00:01<00:00, 112.15it/s]100%|██████████| 139/139 [00:01<00:00, 113.20it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 279.23it/s]extract the null data:  45%|████▍     | 77/173 [00:00<00:00, 402.45it/s]extract the null data:  69%|██████▉   | 120/173 [00:00<00:00, 413.63it/s]extract the null data:  96%|█████████▌| 166/173 [00:00<00:00, 431.31it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 414.27it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 175.83it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 174.99it/s]replace nan value:  32%|███▏      | 55/173 [00:00<00:00, 180.37it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 185.59it/s]replace nan value:  54%|█████▍    | 94/173 [00:00<00:00, 182.95it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 180.97it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 178.71it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 177.69it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 175.14it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 177.71it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 129.77it/s] 15%|█▌        | 26/173 [00:00<00:01, 104.47it/s] 23%|██▎       | 39/173 [00:00<00:01, 113.08it/s] 31%|███       | 53/173 [00:00<00:00, 122.79it/s] 38%|███▊      | 66/173 [00:00<00:00, 121.39it/s] 46%|████▌     | 80/173 [00:00<00:00, 121.60it/s] 54%|█████▍    | 93/173 [00:00<00:00, 123.76it/s] 61%|██████▏   | 106/173 [00:00<00:00, 122.31it/s] 69%|██████▉   | 119/173 [00:00<00:00, 122.31it/s] 76%|███████▋  | 132/173 [00:01<00:00, 118.31it/s] 83%|████████▎ | 144/173 [00:01<00:00, 117.94it/s] 90%|█████████ | 156/173 [00:01<00:00, 107.88it/s] 97%|█████████▋| 167/173 [00:01<00:00, 86.04it/s] 100%|██████████| 173/173 [00:01<00:00, 105.75it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.550, valid loss : 0.433, train acc : 0.719, valid acc : 0.830, train f1 : 0.719, valid f1 : 0.654
training process:   1%|          | 1/128 [01:05<2:18:40, 65.52s/it]Best score increase :0.000 -> 0.654
training process:   2%|▏         | 2/128 [02:00<2:04:02, 59.07s/it]Best score increase :0.654 -> 0.691
training process:   2%|▏         | 3/128 [02:52<1:56:36, 55.97s/it]Best score increase :0.691 -> 0.695
training process:   3%|▎         | 4/128 [03:47<1:54:37, 55.46s/it]Best score increase :0.695 -> 0.698
epoch : 5, train loss : 0.404, valid loss : 0.388, train acc : 0.820, valid acc : 0.859, train f1 : 0.820, valid f1 : 0.701
training process:   4%|▍         | 5/128 [04:51<2:00:25, 58.74s/it]Best score increase :0.698 -> 0.701
training process:   5%|▍         | 6/128 [05:45<1:55:46, 56.93s/it]Best score increase :0.701 -> 0.710
training process:   5%|▌         | 7/128 [06:37<1:51:59, 55.53s/it]Best score increase :0.710 -> 0.717
training process:   6%|▋         | 8/128 [07:30<1:49:33, 54.78s/it]Best score increase :0.717 -> 0.725
epoch : 9, train loss : 0.346, valid loss : 0.376, train acc : 0.851, valid acc : 0.866, train f1 : 0.851, valid f1 : 0.713
training process:   7%|▋         | 9/128 [08:32<1:53:09, 57.06s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:27<1:50:55, 56.40s/it]Best score increase :0.725 -> 0.729
training process:   9%|▊         | 11/128 [10:19<1:47:25, 55.09s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:12<1:45:05, 54.36s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.314, valid loss : 0.357, train acc : 0.868, valid acc : 0.861, train f1 : 0.868, valid f1 : 0.705
training process:  10%|█         | 13/128 [12:11<1:46:53, 55.77s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [13:03<1:43:41, 54.57s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [13:52<1:39:33, 52.87s/it]Best score increase :0.729 -> 0.731
training process:  12%|█▎        | 16/128 [14:41<1:36:42, 51.81s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.289, valid loss : 0.354, train acc : 0.879, valid acc : 0.853, train f1 : 0.879, valid f1 : 0.698
training process:  13%|█▎        | 17/128 [15:39<1:38:53, 53.46s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [16:32<1:38:10, 53.55s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [17:25<1:36:56, 53.36s/it]EarlyStopping counter : 4 out of 12
training process:  16%|█▌        | 20/128 [18:18<1:35:47, 53.22s/it]EarlyStopping counter : 5 out of 12
epoch : 21, train loss : 0.256, valid loss : 0.329, train acc : 0.893, valid acc : 0.874, train f1 : 0.893, valid f1 : 0.725
training process:  16%|█▋        | 21/128 [19:20<1:39:26, 55.76s/it]EarlyStopping counter : 6 out of 12
training process:  17%|█▋        | 22/128 [20:10<1:35:46, 54.21s/it]EarlyStopping counter : 7 out of 12
training process:  18%|█▊        | 23/128 [21:05<1:35:06, 54.35s/it]Best score increase :0.731 -> 0.749
training process:  19%|█▉        | 24/128 [21:55<1:31:59, 53.07s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.244, valid loss : 0.319, train acc : 0.901, valid acc : 0.876, train f1 : 0.901, valid f1 : 0.727
training process:  20%|█▉        | 25/128 [22:57<1:35:34, 55.68s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [23:51<1:33:44, 55.15s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [24:44<1:32:02, 54.68s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [25:35<1:29:14, 53.55s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.233, valid loss : 0.320, train acc : 0.905, valid acc : 0.876, train f1 : 0.905, valid f1 : 0.733
training process:  23%|██▎       | 29/128 [26:36<1:32:01, 55.78s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [27:29<1:29:40, 54.91s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [28:18<1:25:37, 52.97s/it]Best score increase :0.749 -> 0.769
training process:  25%|██▌       | 32/128 [29:06<1:22:37, 51.64s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.214, valid loss : 0.282, train acc : 0.912, valid acc : 0.907, train f1 : 0.912, valid f1 : 0.774
training process:  26%|██▌       | 33/128 [30:07<1:26:03, 54.35s/it]Best score increase :0.769 -> 0.774
training process:  27%|██▋       | 34/128 [30:56<1:22:37, 52.74s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [31:43<1:19:22, 51.21s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [32:31<1:16:58, 50.20s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.210, valid loss : 0.299, train acc : 0.914, valid acc : 0.882, train f1 : 0.914, valid f1 : 0.738
training process:  29%|██▉       | 37/128 [33:32<1:20:46, 53.26s/it]EarlyStopping counter : 4 out of 12
training process:  30%|██▉       | 38/128 [34:20<1:17:27, 51.64s/it]EarlyStopping counter : 5 out of 12
training process:  30%|███       | 39/128 [35:07<1:14:57, 50.53s/it]EarlyStopping counter : 6 out of 12
training process:  31%|███▏      | 40/128 [35:55<1:12:48, 49.64s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.196, valid loss : 0.268, train acc : 0.920, valid acc : 0.905, train f1 : 0.920, valid f1 : 0.772
training process:  32%|███▏      | 41/128 [36:51<1:14:31, 51.39s/it]EarlyStopping counter : 8 out of 12
training process:  33%|███▎      | 42/128 [37:38<1:12:08, 50.33s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▎      | 43/128 [38:28<1:10:48, 49.98s/it]EarlyStopping counter : 10 out of 12
training process:  34%|███▍      | 44/128 [39:16<1:09:22, 49.56s/it]EarlyStopping counter : 11 out of 12
epoch : 45, train loss : 0.190, valid loss : 0.250, train acc : 0.923, valid acc : 0.913, train f1 : 0.923, valid f1 : 0.785
training process:  35%|███▌      | 45/128 [40:14<1:12:01, 52.07s/it]Best score increase :0.774 -> 0.785
training process:  36%|███▌      | 46/128 [41:03<1:09:50, 51.11s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [41:55<1:09:35, 51.55s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [42:45<1:07:59, 51.00s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.184, valid loss : 0.286, train acc : 0.928, valid acc : 0.898, train f1 : 0.928, valid f1 : 0.766
training process:  38%|███▊      | 49/128 [43:44<1:10:04, 53.23s/it]EarlyStopping counter : 4 out of 12
training process:  39%|███▉      | 50/128 [44:33<1:07:49, 52.17s/it]EarlyStopping counter : 5 out of 12
training process:  40%|███▉      | 51/128 [45:26<1:07:15, 52.41s/it]EarlyStopping counter : 6 out of 12
training process:  41%|████      | 52/128 [46:19<1:06:34, 52.56s/it]EarlyStopping counter : 7 out of 12
epoch : 53, train loss : 0.174, valid loss : 0.261, train acc : 0.931, valid acc : 0.901, train f1 : 0.931, valid f1 : 0.764
training process:  41%|████▏     | 53/128 [47:17<1:07:40, 54.14s/it]EarlyStopping counter : 8 out of 12
training process:  42%|████▏     | 54/128 [48:11<1:06:37, 54.02s/it]EarlyStopping counter : 9 out of 12
training process:  43%|████▎     | 55/128 [49:04<1:05:24, 53.76s/it]EarlyStopping counter : 10 out of 12
training process:  44%|████▍     | 56/128 [49:57<1:04:19, 53.61s/it]EarlyStopping counter : 11 out of 12
epoch : 57, train loss : 0.171, valid loss : 0.276, train acc : 0.932, valid acc : 0.900, train f1 : 0.932, valid f1 : 0.764
training process:  44%|████▍     | 56/128 [50:56<1:05:30, 54.59s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 56, best f1 score : 0.785
training process finished, best loss : 0.249 and best acc : 0.913, best f1 : 0.785, best epoch : 46

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.51      0.81      0.63       580
           1       0.98      0.93      0.96      6818

    accuracy                           0.92      7398
   macro avg       0.75      0.87      0.79      7398
weighted avg       0.95      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.79, test AUC : 0.87, test loss : 15.586

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.67s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.61s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.60s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.58s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:53,  7.58s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.60s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.66s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.75s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.81s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.78s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.78s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.72s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|▉         | 30/306 [00:00<00:00, 291.89it/s] 20%|██        | 62/306 [00:00<00:00, 303.32it/s] 31%|███       | 95/306 [00:00<00:00, 312.40it/s] 42%|████▏     | 129/306 [00:00<00:00, 321.30it/s] 53%|█████▎    | 162/306 [00:00<00:00, 321.57it/s] 64%|██████▎   | 195/306 [00:00<00:00, 323.87it/s] 75%|███████▌  | 230/306 [00:00<00:00, 331.54it/s] 87%|████████▋ | 265/306 [00:00<00:00, 336.80it/s] 98%|█████████▊| 300/306 [00:00<00:00, 339.05it/s]100%|██████████| 306/306 [00:00<00:00, 327.49it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 456.36it/s]extract the null data:  17%|█▋        | 95/553 [00:00<00:00, 473.26it/s]extract the null data:  26%|██▌       | 143/553 [00:00<00:00, 460.23it/s]extract the null data:  35%|███▍      | 191/553 [00:00<00:00, 463.91it/s]extract the null data:  43%|████▎     | 238/553 [00:00<00:00, 456.43it/s]extract the null data:  51%|█████▏    | 284/553 [00:00<00:00, 410.46it/s]extract the null data:  59%|█████▉    | 326/553 [00:00<00:00, 388.21it/s]extract the null data:  66%|██████▋   | 367/553 [00:00<00:00, 392.45it/s]extract the null data:  75%|███████▍  | 412/553 [00:00<00:00, 408.09it/s]extract the null data:  83%|████████▎ | 458/553 [00:01<00:00, 422.57it/s]extract the null data:  91%|█████████ | 503/553 [00:01<00:00, 428.62it/s]extract the null data:  99%|█████████▉| 548/553 [00:01<00:00, 434.61it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 428.14it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.18it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.08it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 166.58it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 166.50it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 166.91it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 168.84it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 170.43it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 171.55it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:02, 175.23it/s]replace nan value:  32%|███▏      | 178/553 [00:01<00:02, 179.94it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:01, 184.76it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 187.26it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 186.56it/s]replace nan value:  46%|████▋     | 256/553 [00:01<00:01, 187.26it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:01, 187.22it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 185.66it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 184.27it/s]replace nan value:  60%|██████    | 332/553 [00:01<00:01, 175.67it/s]replace nan value:  63%|██████▎   | 350/553 [00:01<00:01, 173.42it/s]replace nan value:  67%|██████▋   | 368/553 [00:02<00:01, 174.87it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:00, 177.11it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 179.59it/s]replace nan value:  77%|███████▋  | 424/553 [00:02<00:00, 178.73it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 181.48it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 183.64it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 184.20it/s]replace nan value:  91%|█████████ | 501/553 [00:02<00:00, 187.16it/s]replace nan value:  94%|█████████▍| 520/553 [00:02<00:00, 185.64it/s]replace nan value:  97%|█████████▋| 539/553 [00:03<00:00, 181.94it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 179.30it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 117.06it/s]  5%|▌         | 28/553 [00:00<00:03, 137.34it/s]  8%|▊         | 42/553 [00:00<00:03, 132.70it/s] 10%|█         | 56/553 [00:00<00:04, 123.74it/s] 12%|█▏        | 69/553 [00:00<00:04, 113.29it/s] 15%|█▌        | 84/553 [00:00<00:03, 124.02it/s] 18%|█▊        | 97/553 [00:00<00:03, 125.03it/s] 20%|██        | 112/553 [00:00<00:03, 130.96it/s] 23%|██▎       | 126/553 [00:01<00:03, 118.95it/s] 26%|██▌       | 144/553 [00:01<00:03, 135.11it/s] 29%|██▉       | 162/553 [00:01<00:02, 144.04it/s] 32%|███▏      | 178/553 [00:01<00:02, 145.70it/s] 35%|███▍      | 193/553 [00:01<00:02, 145.33it/s] 38%|███▊      | 210/553 [00:01<00:02, 150.99it/s] 41%|████      | 226/553 [00:01<00:02, 142.85it/s] 44%|████▍     | 242/553 [00:01<00:02, 143.41it/s] 46%|████▋     | 257/553 [00:01<00:02, 140.17it/s] 49%|████▉     | 272/553 [00:02<00:02, 135.34it/s] 52%|█████▏    | 287/553 [00:02<00:01, 138.05it/s] 54%|█████▍    | 301/553 [00:02<00:01, 131.61it/s] 57%|█████▋    | 315/553 [00:02<00:01, 126.78it/s] 59%|█████▉    | 328/553 [00:02<00:01, 126.51it/s] 62%|██████▏   | 343/553 [00:02<00:01, 131.96it/s] 65%|██████▍   | 357/553 [00:02<00:01, 120.77it/s] 67%|██████▋   | 370/553 [00:02<00:01, 122.47it/s] 69%|██████▉   | 383/553 [00:02<00:01, 121.19it/s] 72%|███████▏  | 396/553 [00:03<00:01, 107.68it/s] 74%|███████▍  | 408/553 [00:03<00:01, 107.79it/s] 76%|███████▌  | 420/553 [00:03<00:01, 103.18it/s] 78%|███████▊  | 431/553 [00:03<00:01, 99.56it/s]  81%|████████  | 447/553 [00:03<00:00, 114.12it/s] 83%|████████▎ | 460/553 [00:03<00:00, 116.77it/s] 86%|████████▌ | 473/553 [00:03<00:00, 118.75it/s] 88%|████████▊ | 486/553 [00:03<00:00, 116.19it/s] 90%|█████████ | 498/553 [00:03<00:00, 111.88it/s] 93%|█████████▎| 513/553 [00:04<00:00, 120.72it/s] 95%|█████████▌| 526/553 [00:04<00:00, 108.65it/s] 97%|█████████▋| 538/553 [00:04<00:00, 108.90it/s]100%|█████████▉| 551/553 [00:04<00:00, 97.93it/s] 100%|██████████| 553/553 [00:04<00:00, 122.15it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 288.88it/s]extract the null data:  64%|██████▍   | 89/139 [00:00<00:00, 469.19it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 479.69it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 193.90it/s]replace nan value:  29%|██▉       | 41/139 [00:00<00:00, 199.42it/s]replace nan value:  45%|████▍     | 62/139 [00:00<00:00, 200.77it/s]replace nan value:  60%|█████▉    | 83/139 [00:00<00:00, 201.41it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 197.48it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 194.86it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.89it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.06it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.00it/s] 28%|██▊       | 39/139 [00:00<00:00, 128.16it/s] 37%|███▋      | 52/139 [00:00<00:00, 111.76it/s] 46%|████▌     | 64/139 [00:00<00:00, 113.38it/s] 55%|█████▌    | 77/139 [00:00<00:00, 118.08it/s] 64%|██████▍   | 89/139 [00:00<00:00, 112.47it/s] 76%|███████▌  | 105/139 [00:00<00:00, 121.84it/s] 88%|████████▊ | 122/139 [00:00<00:00, 132.58it/s] 98%|█████████▊| 136/139 [00:01<00:00, 133.15it/s]100%|██████████| 139/139 [00:01<00:00, 124.99it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 23/173 [00:00<00:00, 226.56it/s]extract the null data:  48%|████▊     | 83/173 [00:00<00:00, 441.43it/s]extract the null data:  82%|████████▏ | 141/173 [00:00<00:00, 504.17it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 479.88it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   8%|▊         | 13/173 [00:00<00:01, 122.19it/s]replace nan value:  18%|█▊        | 32/173 [00:00<00:00, 159.94it/s]replace nan value:  30%|███       | 52/173 [00:00<00:00, 177.80it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 187.11it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 153.19it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 149.30it/s]replace nan value:  75%|███████▍  | 129/173 [00:00<00:00, 163.38it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 172.21it/s]replace nan value:  97%|█████████▋| 168/173 [00:01<00:00, 176.01it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 167.63it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 137.81it/s] 17%|█▋        | 29/173 [00:00<00:01, 122.55it/s] 26%|██▌       | 45/173 [00:00<00:00, 137.04it/s] 34%|███▍      | 59/173 [00:00<00:01, 104.74it/s] 43%|████▎     | 74/173 [00:00<00:00, 116.62it/s] 51%|█████▏    | 89/173 [00:00<00:00, 125.01it/s] 60%|██████    | 104/173 [00:00<00:00, 131.25it/s] 69%|██████▉   | 119/173 [00:00<00:00, 135.77it/s] 77%|███████▋  | 133/173 [00:01<00:00, 133.29it/s] 86%|████████▌ | 148/173 [00:01<00:00, 135.76it/s] 94%|█████████▎| 162/173 [00:01<00:00, 124.19it/s]100%|██████████| 173/173 [00:01<00:00, 117.51it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.085, valid loss : 0.079, train acc : 0.662, valid acc : 0.724, train f1 : 0.522, valid f1 : 0.570
training process:   1%|          | 1/128 [01:04<2:17:22, 64.90s/it]Best score increase :0.000 -> 0.570
training process:   2%|▏         | 2/128 [01:59<2:03:59, 59.05s/it]Best score increase :0.570 -> 0.668
training process:   2%|▏         | 3/128 [02:55<1:59:46, 57.50s/it]Best score increase :0.668 -> 0.672
training process:   3%|▎         | 4/128 [03:44<1:51:49, 54.11s/it]Best score increase :0.672 -> 0.684
epoch : 5, train loss : 0.064, valid loss : 0.067, train acc : 0.849, valid acc : 0.873, train f1 : 0.678, valid f1 : 0.708
training process:   4%|▍         | 5/128 [04:41<1:52:48, 55.03s/it]Best score increase :0.684 -> 0.708
training process:   5%|▍         | 6/128 [05:35<1:51:15, 54.72s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:24<1:46:57, 53.03s/it]Best score increase :0.708 -> 0.730
training process:   6%|▋         | 8/128 [07:19<1:47:02, 53.52s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.058, valid loss : 0.065, train acc : 0.873, valid acc : 0.890, train f1 : 0.708, valid f1 : 0.730
training process:   7%|▋         | 9/128 [08:23<1:52:36, 56.78s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [09:13<1:47:38, 54.73s/it]Best score increase :0.730 -> 0.747
training process:   9%|▊         | 11/128 [10:01<1:42:37, 52.63s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:49<1:39:21, 51.40s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.054, valid loss : 0.063, train acc : 0.890, valid acc : 0.896, train f1 : 0.734, valid f1 : 0.740
training process:  10%|█         | 13/128 [11:51<1:44:40, 54.61s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:44<1:42:49, 54.12s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [13:34<1:39:16, 52.71s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▎        | 16/128 [14:27<1:38:42, 52.88s/it]EarlyStopping counter : 6 out of 12
epoch : 17, train loss : 0.051, valid loss : 0.060, train acc : 0.896, valid acc : 0.891, train f1 : 0.745, valid f1 : 0.741
training process:  13%|█▎        | 17/128 [15:24<1:40:03, 54.09s/it]EarlyStopping counter : 7 out of 12
training process:  14%|█▍        | 18/128 [16:12<1:35:43, 52.21s/it]EarlyStopping counter : 8 out of 12
training process:  15%|█▍        | 19/128 [17:01<1:33:11, 51.30s/it]EarlyStopping counter : 9 out of 12
training process:  16%|█▌        | 20/128 [17:55<1:33:44, 52.08s/it]Best score increase :0.747 -> 0.770
epoch : 21, train loss : 0.048, valid loss : 0.058, train acc : 0.905, valid acc : 0.876, train f1 : 0.760, valid f1 : 0.722
training process:  16%|█▋        | 21/128 [18:56<1:37:28, 54.66s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:44<1:33:10, 52.74s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:35<1:31:24, 52.24s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:28<1:31:04, 52.54s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.045, valid loss : 0.058, train acc : 0.911, valid acc : 0.886, train f1 : 0.771, valid f1 : 0.733
training process:  20%|█▉        | 25/128 [22:29<1:34:43, 55.18s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [23:18<1:30:17, 53.11s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [24:10<1:29:11, 52.99s/it]EarlyStopping counter : 7 out of 12
training process:  22%|██▏       | 28/128 [25:01<1:27:06, 52.27s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.043, valid loss : 0.057, train acc : 0.919, valid acc : 0.894, train f1 : 0.787, valid f1 : 0.745
training process:  23%|██▎       | 29/128 [25:59<1:29:11, 54.05s/it]EarlyStopping counter : 9 out of 12
training process:  23%|██▎       | 30/128 [26:48<1:25:41, 52.46s/it]EarlyStopping counter : 10 out of 12
training process:  24%|██▍       | 31/128 [27:37<1:23:05, 51.40s/it]EarlyStopping counter : 11 out of 12
training process:  24%|██▍       | 31/128 [28:26<1:29:00, 55.06s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 31, best f1 score : 0.770
training process finished, best loss : 0.062 and best acc : 0.917, best f1 : 0.770, best epoch : 19

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.48      0.68      0.56       580
           1       0.97      0.94      0.95      6818

    accuracy                           0.92      7398
   macro avg       0.72      0.81      0.76      7398
weighted avg       0.93      0.92      0.92      7398


# test acc : 0.92, test f1 : 0.76, test AUC : 0.81, test loss : 3.964

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.76s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.72s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.77s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.93s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.82s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.79s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.77s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:30,  7.71s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.70s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.70s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.92s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.79s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.78s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 34/306 [00:00<00:00, 329.32it/s] 22%|██▏       | 67/306 [00:00<00:00, 312.62it/s] 32%|███▏      | 99/306 [00:00<00:00, 287.70it/s] 42%|████▏     | 128/306 [00:00<00:00, 282.99it/s] 51%|█████▏    | 157/306 [00:00<00:00, 281.38it/s] 61%|██████    | 186/306 [00:00<00:00, 277.71it/s] 70%|██████▉   | 214/306 [00:00<00:00, 274.54it/s] 80%|████████  | 246/306 [00:00<00:00, 287.86it/s] 90%|████████▉ | 275/306 [00:00<00:00, 279.97it/s]100%|██████████| 306/306 [00:01<00:00, 291.16it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 59/553 [00:00<00:00, 587.78it/s]extract the null data:  22%|██▏       | 120/553 [00:00<00:00, 598.05it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 610.79it/s]extract the null data:  44%|████▍     | 245/553 [00:00<00:00, 614.28it/s]extract the null data:  56%|█████▌    | 309/553 [00:00<00:00, 620.23it/s]extract the null data:  67%|██████▋   | 372/553 [00:00<00:00, 615.83it/s]extract the null data:  78%|███████▊  | 434/553 [00:00<00:00, 613.33it/s]extract the null data:  90%|████████▉ | 496/553 [00:00<00:00, 610.83it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 611.35it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 202.05it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 205.41it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:02, 206.07it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 207.01it/s]replace nan value:  19%|█▉        | 106/553 [00:00<00:02, 208.76it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 209.79it/s]replace nan value:  27%|██▋       | 150/553 [00:00<00:01, 210.68it/s]replace nan value:  31%|███       | 172/553 [00:00<00:01, 210.84it/s]replace nan value:  35%|███▌      | 194/553 [00:00<00:01, 212.22it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:01, 212.03it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 210.74it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 211.13it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 209.32it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 209.03it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 208.61it/s]replace nan value:  63%|██████▎   | 346/553 [00:01<00:00, 210.27it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 210.84it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 209.85it/s]replace nan value:  75%|███████▍  | 412/553 [00:01<00:00, 211.12it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 209.40it/s]replace nan value:  82%|████████▏ | 455/553 [00:02<00:00, 209.42it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 209.05it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 210.39it/s]replace nan value:  94%|█████████▍| 520/553 [00:02<00:00, 208.97it/s]replace nan value:  98%|█████████▊| 541/553 [00:02<00:00, 202.57it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 208.08it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 133.94it/s]  5%|▌         | 29/553 [00:00<00:03, 139.54it/s]  8%|▊         | 43/553 [00:00<00:03, 132.52it/s] 10%|█         | 57/553 [00:00<00:04, 122.66it/s] 13%|█▎        | 70/553 [00:00<00:04, 116.25it/s] 16%|█▌        | 87/553 [00:00<00:03, 131.69it/s] 18%|█▊        | 101/553 [00:00<00:03, 127.88it/s] 22%|██▏       | 120/553 [00:00<00:03, 143.83it/s] 24%|██▍       | 135/553 [00:00<00:02, 144.27it/s] 28%|██▊       | 154/553 [00:01<00:02, 156.03it/s] 31%|███       | 172/553 [00:01<00:02, 162.21it/s] 34%|███▍      | 189/553 [00:01<00:02, 158.81it/s] 38%|███▊      | 208/553 [00:01<00:02, 167.02it/s] 41%|████      | 225/553 [00:01<00:02, 158.40it/s] 44%|████▎     | 241/553 [00:01<00:01, 157.75it/s] 46%|████▋     | 257/553 [00:01<00:01, 151.92it/s] 49%|████▉     | 273/553 [00:01<00:01, 148.59it/s] 52%|█████▏    | 290/553 [00:01<00:01, 152.74it/s] 55%|█████▌    | 306/553 [00:02<00:01, 137.96it/s] 58%|█████▊    | 321/553 [00:02<00:01, 136.81it/s] 61%|██████    | 335/553 [00:02<00:01, 137.01it/s] 63%|██████▎   | 349/553 [00:02<00:01, 136.87it/s] 66%|██████▌   | 363/553 [00:02<00:01, 134.48it/s] 68%|██████▊   | 378/553 [00:02<00:01, 138.42it/s] 71%|███████   | 392/553 [00:02<00:01, 128.55it/s] 73%|███████▎  | 406/553 [00:02<00:01, 130.28it/s] 76%|███████▌  | 420/553 [00:02<00:01, 127.75it/s] 78%|███████▊  | 433/553 [00:03<00:00, 125.73it/s] 82%|████████▏ | 452/553 [00:03<00:00, 143.16it/s] 85%|████████▍ | 468/553 [00:03<00:00, 146.93it/s] 87%|████████▋ | 483/553 [00:03<00:00, 143.12it/s] 90%|█████████ | 498/553 [00:03<00:00, 133.09it/s] 93%|█████████▎| 514/553 [00:03<00:00, 137.62it/s] 95%|█████████▌| 528/553 [00:03<00:00, 123.39it/s] 98%|█████████▊| 542/553 [00:03<00:00, 125.34it/s]100%|██████████| 553/553 [00:04<00:00, 136.75it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 349.47it/s]extract the null data:  74%|███████▍  | 103/139 [00:00<00:00, 542.20it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 548.19it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 224.50it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 227.68it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 225.66it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 224.87it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 224.12it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 223.18it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 224.25it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:01, 125.22it/s] 19%|█▉        | 27/139 [00:00<00:00, 128.65it/s] 31%|███       | 43/139 [00:00<00:00, 141.69it/s] 42%|████▏     | 58/139 [00:00<00:00, 127.25it/s] 54%|█████▍    | 75/139 [00:00<00:00, 138.00it/s] 65%|██████▍   | 90/139 [00:00<00:00, 128.03it/s] 76%|███████▌  | 105/139 [00:00<00:00, 134.24it/s] 88%|████████▊ | 122/139 [00:00<00:00, 143.87it/s] 99%|█████████▊| 137/139 [00:00<00:00, 145.37it/s]100%|██████████| 139/139 [00:01<00:00, 138.71it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 42/173 [00:00<00:00, 418.35it/s]extract the null data:  64%|██████▍   | 111/173 [00:00<00:00, 575.95it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 584.54it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 224.86it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 222.91it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 224.78it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 224.72it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 223.71it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 216.05it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 213.06it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 216.03it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 135.79it/s] 16%|█▌        | 28/173 [00:00<00:01, 117.36it/s] 25%|██▍       | 43/173 [00:00<00:01, 128.55it/s] 34%|███▎      | 58/173 [00:00<00:00, 134.39it/s] 42%|████▏     | 72/173 [00:00<00:00, 133.65it/s] 50%|████▉     | 86/173 [00:00<00:00, 131.60it/s] 58%|█████▊    | 100/173 [00:00<00:00, 132.49it/s] 66%|██████▋   | 115/173 [00:00<00:00, 136.66it/s] 75%|███████▍  | 129/173 [00:00<00:00, 128.73it/s] 83%|████████▎ | 143/173 [00:01<00:00, 126.95it/s] 90%|█████████ | 156/173 [00:01<00:00, 118.23it/s] 97%|█████████▋| 168/173 [00:01<00:00, 101.51it/s]100%|██████████| 173/173 [00:01<00:00, 117.84it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.232, valid loss : 0.088, train acc : 0.681, valid acc : 0.508, train f1 : 0.675, valid f1 : 0.436
training process:   1%|          | 1/128 [00:59<2:05:15, 59.18s/it]Best score increase :0.000 -> 0.436
training process:   2%|▏         | 2/128 [01:45<1:47:54, 51.38s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:30<1:41:35, 48.77s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:16<1:38:38, 47.73s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.094, valid loss : 0.112, train acc : 0.636, valid acc : 0.309, train f1 : 0.585, valid f1 : 0.294
training process:   4%|▍         | 5/128 [04:12<1:44:00, 50.74s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:01<1:41:54, 50.12s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [05:53<1:41:56, 50.55s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [06:45<1:42:04, 51.04s/it]EarlyStopping counter : 7 out of 12
epoch : 9, train loss : 0.078, valid loss : 0.104, train acc : 0.704, valid acc : 0.403, train f1 : 0.675, valid f1 : 0.366
training process:   7%|▋         | 9/128 [07:46<1:47:19, 54.11s/it]EarlyStopping counter : 8 out of 12
training process:   8%|▊         | 10/128 [08:39<1:46:01, 53.91s/it]EarlyStopping counter : 9 out of 12
training process:   9%|▊         | 11/128 [09:28<1:42:13, 52.42s/it]EarlyStopping counter : 10 out of 12
training process:   9%|▉         | 12/128 [10:22<1:42:14, 52.89s/it]EarlyStopping counter : 11 out of 12
epoch : 13, train loss : 0.070, valid loss : 0.102, train acc : 0.744, valid acc : 0.450, train f1 : 0.727, valid f1 : 0.401
training process:   9%|▉         | 12/128 [11:22<1:49:55, 56.86s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 12, best f1 score : 0.436
training process finished, best loss : 0.088 and best acc : 0.508, best f1 : 0.436, best epoch : 0

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.13      0.92      0.23       580
           1       0.99      0.49      0.66      6818

    accuracy                           0.53      7398
   macro avg       0.56      0.71      0.45      7398
weighted avg       0.92      0.53      0.63      7398


# test acc : 0.53, test f1 : 0.45, test AUC : 0.71, test loss : 5.281

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.09s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:19,  7.99s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.83s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:01,  7.72s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.82s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.84s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.83s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:30,  7.75s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:22,  7.65s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.74s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.68s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.70s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.76s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 23/306 [00:00<00:01, 220.65it/s] 16%|█▌        | 48/306 [00:00<00:01, 232.08it/s] 24%|██▎       | 72/306 [00:00<00:01, 227.14it/s] 31%|███       | 95/306 [00:00<00:00, 216.94it/s] 40%|███▉      | 122/306 [00:00<00:00, 234.51it/s] 48%|████▊     | 146/306 [00:00<00:00, 226.00it/s] 55%|█████▌    | 169/306 [00:00<00:00, 220.15it/s] 63%|██████▎   | 192/306 [00:00<00:00, 213.37it/s] 70%|███████   | 215/306 [00:00<00:00, 215.82it/s] 78%|███████▊  | 238/306 [00:01<00:00, 217.98it/s] 85%|████████▍ | 260/306 [00:01<00:00, 213.57it/s] 92%|█████████▏| 282/306 [00:01<00:00, 212.54it/s] 99%|█████████▉| 304/306 [00:01<00:00, 211.79it/s]100%|██████████| 306/306 [00:01<00:00, 217.79it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:01, 430.00it/s]extract the null data:  16%|█▋        | 90/553 [00:00<00:01, 445.76it/s]extract the null data:  24%|██▍       | 135/553 [00:00<00:00, 442.57it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 444.66it/s]extract the null data:  41%|████      | 227/553 [00:00<00:00, 453.16it/s]extract the null data:  50%|████▉     | 274/553 [00:00<00:00, 458.36it/s]extract the null data:  58%|█████▊    | 321/553 [00:00<00:00, 460.79it/s]extract the null data:  67%|██████▋   | 368/553 [00:00<00:00, 462.99it/s]extract the null data:  75%|███████▌  | 415/553 [00:00<00:00, 461.97it/s]extract the null data:  84%|████████▎ | 462/553 [00:01<00:00, 458.42it/s]extract the null data:  92%|█████████▏| 508/553 [00:01<00:00, 457.82it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 455.73it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 165.61it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.15it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 173.79it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 173.09it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 172.64it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 172.30it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 172.75it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 173.40it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 175.39it/s]replace nan value:  32%|███▏      | 179/553 [00:01<00:02, 175.46it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:01, 177.92it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 178.75it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 177.24it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 179.45it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 176.05it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 175.04it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 177.44it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:01, 177.37it/s]replace nan value:  62%|██████▏   | 345/553 [00:01<00:01, 176.75it/s]replace nan value:  66%|██████▌   | 364/553 [00:02<00:01, 178.59it/s]replace nan value:  69%|██████▉   | 383/553 [00:02<00:00, 180.48it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 176.77it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 176.26it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 174.21it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 174.03it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 176.08it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 176.88it/s]replace nan value:  92%|█████████▏| 511/553 [00:02<00:00, 176.79it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 177.78it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 177.83it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 175.94it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 107.24it/s]  4%|▍         | 24/553 [00:00<00:04, 119.32it/s]  7%|▋         | 38/553 [00:00<00:04, 124.90it/s]  9%|▉         | 51/553 [00:00<00:04, 106.29it/s] 11%|█         | 62/553 [00:00<00:04, 99.42it/s]  13%|█▎        | 73/553 [00:00<00:04, 101.33it/s] 16%|█▌        | 87/553 [00:00<00:04, 111.26it/s] 18%|█▊        | 99/553 [00:00<00:04, 104.20it/s] 21%|██        | 114/553 [00:01<00:03, 115.11it/s] 23%|██▎       | 126/553 [00:01<00:03, 111.10it/s] 26%|██▌       | 142/553 [00:01<00:03, 122.05it/s] 29%|██▊       | 158/553 [00:01<00:03, 131.63it/s] 31%|███▏      | 173/553 [00:01<00:02, 135.01it/s] 34%|███▍      | 187/553 [00:01<00:02, 133.86it/s] 37%|███▋      | 204/553 [00:01<00:02, 142.97it/s] 40%|███▉      | 219/553 [00:01<00:02, 139.42it/s] 42%|████▏     | 234/553 [00:01<00:02, 137.66it/s] 45%|████▌     | 249/553 [00:02<00:02, 138.89it/s] 48%|████▊     | 265/553 [00:02<00:02, 140.96it/s] 51%|█████     | 280/553 [00:02<00:02, 134.49it/s] 53%|█████▎    | 294/553 [00:02<00:01, 132.31it/s] 56%|█████▌    | 308/553 [00:02<00:01, 129.40it/s] 58%|█████▊    | 321/553 [00:02<00:01, 125.66it/s] 61%|██████    | 335/553 [00:02<00:01, 128.20it/s] 63%|██████▎   | 348/553 [00:02<00:01, 128.68it/s] 65%|██████▌   | 361/553 [00:02<00:01, 122.65it/s] 68%|██████▊   | 376/553 [00:02<00:01, 129.91it/s] 71%|███████   | 390/553 [00:03<00:01, 119.22it/s] 73%|███████▎  | 403/553 [00:03<00:01, 119.78it/s] 75%|███████▌  | 416/553 [00:03<00:01, 119.61it/s] 78%|███████▊  | 429/553 [00:03<00:01, 114.63it/s] 81%|████████  | 446/553 [00:03<00:00, 129.07it/s] 84%|████████▎ | 462/553 [00:03<00:00, 134.98it/s] 86%|████████▋ | 477/553 [00:03<00:00, 137.22it/s] 89%|████████▉ | 491/553 [00:03<00:00, 127.89it/s] 91%|█████████ | 504/553 [00:04<00:00, 125.80it/s] 94%|█████████▍| 519/553 [00:04<00:00, 129.51it/s] 96%|█████████▋| 533/553 [00:04<00:00, 109.89it/s] 99%|█████████▉| 548/553 [00:04<00:00, 119.70it/s]100%|██████████| 553/553 [00:04<00:00, 122.28it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 279.08it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 428.73it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 492.03it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 459.63it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 196.44it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 193.75it/s]replace nan value:  44%|████▍     | 61/139 [00:00<00:00, 196.78it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 195.28it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 192.38it/s]replace nan value:  87%|████████▋ | 121/139 [00:00<00:00, 192.33it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 190.94it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.32it/s] 17%|█▋        | 24/139 [00:00<00:00, 120.91it/s] 27%|██▋       | 38/139 [00:00<00:00, 129.59it/s] 37%|███▋      | 51/139 [00:00<00:00, 123.34it/s] 46%|████▌     | 64/139 [00:00<00:00, 123.36it/s] 55%|█████▌    | 77/139 [00:00<00:00, 119.89it/s] 65%|██████▍   | 90/139 [00:00<00:00, 108.23it/s] 75%|███████▍  | 104/139 [00:00<00:00, 116.42it/s] 83%|████████▎ | 116/139 [00:00<00:00, 117.40it/s] 93%|█████████▎| 129/139 [00:01<00:00, 118.84it/s]100%|██████████| 139/139 [00:01<00:00, 119.66it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 275.91it/s]extract the null data:  49%|████▊     | 84/173 [00:00<00:00, 438.56it/s]extract the null data:  82%|████████▏ | 141/173 [00:00<00:00, 497.17it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 479.78it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 185.44it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 190.16it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 194.03it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 193.02it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 192.43it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 194.01it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 192.86it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 191.84it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 191.31it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.50it/s] 16%|█▌        | 28/173 [00:00<00:01, 113.92it/s] 24%|██▍       | 42/173 [00:00<00:01, 124.17it/s] 32%|███▏      | 56/173 [00:00<00:00, 129.78it/s] 40%|████      | 70/173 [00:00<00:00, 128.04it/s] 49%|████▊     | 84/173 [00:00<00:00, 128.76it/s] 57%|█████▋    | 98/173 [00:00<00:00, 129.85it/s] 65%|██████▌   | 113/173 [00:00<00:00, 133.18it/s] 73%|███████▎  | 127/173 [00:00<00:00, 126.92it/s] 81%|████████  | 140/173 [00:01<00:00, 125.64it/s] 88%|████████▊ | 153/173 [00:01<00:00, 119.53it/s] 96%|█████████▌| 166/173 [00:01<00:00, 93.49it/s] 100%|██████████| 173/173 [00:01<00:00, 112.27it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.453, valid loss : 0.331, train f1 : 0.585, valid f1 : 0.602
training process - Deferred Re-weighting:   1%|          | 1/128 [01:00<2:08:41, 60.80s/it]Best score increase :0.000 -> 0.602
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:50<1:53:24, 54.00s/it]Best score increase :0.602 -> 0.617
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:38<1:46:57, 51.34s/it]Best score increase :0.617 -> 0.663
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:27<1:44:26, 50.54s/it]Best score increase :0.663 -> 0.688
epoch : 5, train loss : 0.192, valid loss : 0.204, train f1 : 0.699, valid f1 : 0.691
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:25<1:49:18, 53.32s/it]Best score increase :0.688 -> 0.691
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:14<1:45:34, 51.92s/it]Best score increase :0.691 -> 0.717
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:03<1:42:37, 50.89s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:53<1:40:57, 50.48s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.167, valid loss : 0.192, train f1 : 0.739, valid f1 : 0.706
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:51<1:44:58, 52.93s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:40<1:41:28, 51.60s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:29<1:39:17, 50.92s/it]Best score increase :0.717 -> 0.733
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:19<1:37:57, 50.67s/it]Best score increase :0.733 -> 0.737
epoch : 13, train loss : 0.154, valid loss : 0.189, train f1 : 0.761, valid f1 : 0.731
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:18<1:41:32, 52.98s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:07<1:38:52, 52.04s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:56<1:36:05, 51.02s/it]Best score increase :0.737 -> 0.754
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:49<1:36:21, 51.62s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.144, valid loss : 0.178, train f1 : 0.783, valid f1 : 0.749
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:49<1:39:51, 53.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:40<1:37:38, 53.26s/it]Best score increase :0.754 -> 0.757
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:29<1:34:19, 51.92s/it]Best score increase :0.757 -> 0.772
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:21<1:33:32, 51.97s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.135, valid loss : 0.175, train f1 : 0.806, valid f1 : 0.770
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:22<1:37:30, 54.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:14<1:35:17, 53.94s/it]Best score increase :0.772 -> 0.781
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:04<1:32:00, 52.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:55<1:30:17, 52.09s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.126, valid loss : 0.175, train f1 : 0.816, valid f1 : 0.771
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:00<1:36:06, 55.98s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:56<1:35:06, 55.95s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:46<1:31:16, 54.23s/it]Best score increase :0.781 -> 0.788
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:36<1:28:19, 53.00s/it]Best score increase :0.788 -> 0.794
epoch : 29, train loss : 0.117, valid loss : 0.168, train f1 : 0.834, valid f1 : 0.792
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:41<1:33:30, 56.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:29<1:28:29, 54.18s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:19<1:25:30, 52.89s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:11<1:24:13, 52.64s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.110, valid loss : 0.173, train f1 : 0.843, valid f1 : 0.800
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:08<1:25:07, 53.76s/it]Best score increase :0.794 -> 0.800
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:54<1:20:54, 51.64s/it]Best score increase :0.800 -> 0.802
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:45<1:19:24, 51.23s/it]Best score increase :0.802 -> 0.804
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:32<1:16:31, 49.90s/it]Best score increase :0.804 -> 0.811
epoch : 37, train loss : 0.102, valid loss : 0.169, train f1 : 0.860, valid f1 : 0.805
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:29<1:19:17, 52.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:17<1:16:21, 50.90s/it]Best score increase :0.811 -> 0.813
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:03<1:13:20, 49.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [34:48<1:10:42, 48.21s/it]Best score increase :0.813 -> 0.821
epoch : 41, train loss : 0.096, valid loss : 0.163, train f1 : 0.872, valid f1 : 0.815
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [35:42<1:12:26, 49.96s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:28<1:09:45, 48.67s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:14<1:07:33, 47.69s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [37:59<1:05:56, 47.10s/it]Best score increase :0.821 -> 0.827
epoch : 45, train loss : 0.094, valid loss : 0.163, train f1 : 0.873, valid f1 : 0.806
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [38:53<1:08:02, 49.18s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [39:42<1:07:06, 49.10s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [40:28<1:05:00, 48.15s/it]Best score increase :0.827 -> 0.848
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [41:16<1:03:53, 47.92s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.089, valid loss : 0.171, train f1 : 0.883, valid f1 : 0.830
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [42:11<1:05:59, 50.13s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [43:02<1:05:27, 50.36s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [43:52<1:04:31, 50.28s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [44:43<1:04:02, 50.57s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.085, valid loss : 0.164, train f1 : 0.887, valid f1 : 0.829
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [45:42<1:06:12, 52.97s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [46:33<1:04:40, 52.44s/it]Best score increase :0.848 -> 0.855
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [47:23<1:02:58, 51.75s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [48:12<1:01:18, 51.09s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.082, valid loss : 0.166, train f1 : 0.894, valid f1 : 0.843
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [49:10<1:02:52, 53.13s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [50:03<1:01:45, 52.93s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [50:53<59:57, 52.14s/it]  EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [51:43<58:15, 51.40s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.077, valid loss : 0.167, train f1 : 0.900, valid f1 : 0.851
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [52:41<59:47, 53.54s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [53:34<58:26, 53.12s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [54:25<56:52, 52.50s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [55:17<56:05, 52.58s/it]EarlyStopping counter : 10 out of 12
epoch : 65, train loss : 0.076, valid loss : 0.186, train f1 : 0.904, valid f1 : 0.849
training process - Deferred Re-weighting:  51%|█████     | 65/128 [56:24<59:44, 56.89s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  51%|█████     | 65/128 [57:22<55:36, 52.96s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 65, best f1 score : 0.856
training process finished, best loss : 0.170, best acc : 0.959, best f1 : 0.856, best epoch : 59

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.68      0.60       580
           1       0.97      0.95      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.82      0.78      7398
weighted avg       0.94      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.78, test AUC : 0.82, test loss : 18.583

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:39,  9.00s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:27,  8.79s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:18,  8.69s/it]processing for feature importance:  33%|███▎      | 4/12 [00:35<01:11,  8.91s/it]processing for feature importance:  42%|████▏     | 5/12 [00:44<01:02,  8.88s/it]processing for feature importance:  50%|█████     | 6/12 [00:53<00:54,  9.07s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:03<00:46,  9.28s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:13<00:38,  9.60s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:22<00:27,  9.27s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:30<00:17,  8.98s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:39<00:08,  8.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:47<00:00,  8.79s/it]processing for feature importance: 100%|██████████| 12/12 [01:47<00:00,  8.98s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 215.32it/s] 14%|█▍        | 44/306 [00:00<00:01, 215.13it/s] 22%|██▏       | 66/306 [00:00<00:01, 178.97it/s] 33%|███▎      | 102/306 [00:00<00:00, 235.78it/s] 42%|████▏     | 127/306 [00:00<00:00, 239.25it/s] 50%|████▉     | 152/306 [00:00<00:00, 214.08it/s] 59%|█████▉    | 182/306 [00:00<00:00, 233.17it/s] 67%|██████▋   | 206/306 [00:00<00:00, 221.03it/s] 75%|███████▌  | 230/306 [00:01<00:00, 225.64it/s] 84%|████████▎ | 256/306 [00:01<00:00, 233.67it/s] 92%|█████████▏| 280/306 [00:01<00:00, 205.61it/s]100%|██████████| 306/306 [00:01<00:00, 224.42it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_CE_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 486.35it/s]extract the null data:  18%|█▊        | 98/553 [00:00<00:00, 471.97it/s]extract the null data:  26%|██▋       | 146/553 [00:00<00:00, 472.19it/s]extract the null data:  36%|███▌      | 197/553 [00:00<00:00, 484.63it/s]extract the null data:  45%|████▌     | 249/553 [00:00<00:00, 493.90it/s]extract the null data:  54%|█████▍    | 299/553 [00:00<00:00, 493.27it/s]extract the null data:  63%|██████▎   | 349/553 [00:00<00:00, 493.36it/s]extract the null data:  72%|███████▏  | 399/553 [00:00<00:00, 492.49it/s]extract the null data:  81%|████████  | 449/553 [00:00<00:00, 483.85it/s]extract the null data:  90%|█████████ | 498/553 [00:01<00:00, 477.38it/s]extract the null data:  99%|█████████▊| 546/553 [00:01<00:00, 466.60it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 478.94it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 165.51it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.52it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 172.28it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 172.73it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 173.62it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 173.02it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 173.35it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 175.15it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:02, 177.37it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 180.55it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:01, 178.71it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 176.90it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 175.63it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 174.56it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 175.85it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 177.41it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 177.68it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:01, 177.62it/s]replace nan value:  62%|██████▏   | 345/553 [00:01<00:01, 178.04it/s]replace nan value:  66%|██████▌   | 363/553 [00:02<00:01, 176.29it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:00, 175.36it/s]replace nan value:  72%|███████▏  | 399/553 [00:02<00:00, 175.07it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 175.11it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 173.88it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 175.29it/s]replace nan value:  85%|████████▌ | 471/553 [00:02<00:00, 175.64it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 174.96it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 175.56it/s]replace nan value:  95%|█████████▍| 525/553 [00:02<00:00, 176.20it/s]replace nan value:  98%|█████████▊| 543/553 [00:03<00:00, 175.01it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 175.31it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.04it/s]  5%|▍         | 27/553 [00:00<00:04, 130.79it/s]  7%|▋         | 41/553 [00:00<00:03, 130.71it/s] 10%|▉         | 55/553 [00:00<00:04, 122.13it/s] 12%|█▏        | 68/553 [00:00<00:04, 110.20it/s] 15%|█▌        | 83/553 [00:00<00:03, 121.02it/s] 17%|█▋        | 96/553 [00:00<00:03, 123.01it/s] 20%|█▉        | 109/553 [00:00<00:03, 123.91it/s] 22%|██▏       | 124/553 [00:00<00:03, 129.40it/s] 25%|██▌       | 140/553 [00:01<00:03, 136.15it/s] 29%|██▊       | 158/553 [00:01<00:02, 146.24it/s] 31%|███▏      | 174/553 [00:01<00:02, 145.61it/s] 34%|███▍      | 189/553 [00:01<00:02, 145.75it/s] 37%|███▋      | 207/553 [00:01<00:02, 153.85it/s] 40%|████      | 223/553 [00:01<00:02, 143.08it/s] 43%|████▎     | 239/553 [00:01<00:02, 145.50it/s] 46%|████▌     | 254/553 [00:01<00:02, 137.48it/s] 48%|████▊     | 268/553 [00:01<00:02, 138.12it/s] 51%|█████     | 282/553 [00:02<00:02, 134.53it/s] 54%|█████▎    | 296/553 [00:02<00:01, 130.15it/s] 56%|█████▌    | 310/553 [00:02<00:01, 127.11it/s] 58%|█████▊    | 323/553 [00:02<00:01, 124.84it/s] 61%|██████    | 337/553 [00:02<00:01, 126.66it/s] 63%|██████▎   | 350/553 [00:02<00:01, 124.92it/s] 66%|██████▌   | 363/553 [00:02<00:01, 121.18it/s] 68%|██████▊   | 377/553 [00:02<00:01, 125.73it/s] 71%|███████   | 390/553 [00:03<00:01, 115.06it/s] 73%|███████▎  | 402/553 [00:03<00:01, 116.14it/s] 75%|███████▌  | 416/553 [00:03<00:01, 117.72it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.21it/s] 80%|████████  | 445/553 [00:03<00:00, 126.49it/s] 83%|████████▎ | 460/553 [00:03<00:00, 131.81it/s] 86%|████████▌ | 475/553 [00:03<00:00, 134.25it/s] 88%|████████▊ | 489/553 [00:03<00:00, 126.01it/s] 91%|█████████ | 502/553 [00:03<00:00, 122.38it/s] 93%|█████████▎| 517/553 [00:03<00:00, 128.54it/s] 96%|█████████▌| 530/553 [00:04<00:00, 109.57it/s] 98%|█████████▊| 544/553 [00:04<00:00, 116.99it/s]100%|██████████| 553/553 [00:04<00:00, 125.60it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 296.63it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 451.80it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 467.57it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 194.04it/s]replace nan value:  29%|██▉       | 41/139 [00:00<00:00, 199.93it/s]replace nan value:  44%|████▍     | 61/139 [00:00<00:00, 196.29it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 194.62it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 195.02it/s]replace nan value:  87%|████████▋ | 121/139 [00:00<00:00, 192.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.41it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.15it/s] 18%|█▊        | 25/139 [00:00<00:00, 120.13it/s] 28%|██▊       | 39/139 [00:00<00:00, 126.70it/s] 37%|███▋      | 52/139 [00:00<00:00, 119.98it/s] 47%|████▋     | 66/139 [00:00<00:00, 126.12it/s] 57%|█████▋    | 79/139 [00:00<00:00, 119.52it/s] 66%|██████▌   | 92/139 [00:00<00:00, 110.87it/s] 76%|███████▌  | 105/139 [00:00<00:00, 110.92it/s] 86%|████████▌ | 119/139 [00:01<00:00, 117.62it/s] 94%|█████████▍| 131/139 [00:01<00:00, 115.78it/s]100%|██████████| 139/139 [00:01<00:00, 118.44it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 314.42it/s]extract the null data:  50%|████▉     | 86/173 [00:00<00:00, 444.30it/s]extract the null data:  83%|████████▎ | 143/173 [00:00<00:00, 498.69it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 477.96it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 187.12it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 184.34it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 188.97it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 191.23it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 189.31it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 190.85it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 190.87it/s]replace nan value:  91%|█████████▏| 158/173 [00:00<00:00, 189.68it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 188.84it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.53it/s] 16%|█▌        | 28/173 [00:00<00:01, 112.66it/s] 24%|██▍       | 42/173 [00:00<00:01, 122.98it/s] 32%|███▏      | 56/173 [00:00<00:00, 128.35it/s] 40%|████      | 70/173 [00:00<00:00, 126.60it/s] 49%|████▊     | 84/173 [00:00<00:00, 125.63it/s] 56%|█████▌    | 97/173 [00:00<00:00, 126.71it/s] 64%|██████▍   | 111/173 [00:00<00:00, 129.83it/s] 72%|███████▏  | 125/173 [00:01<00:00, 121.22it/s] 80%|███████▉  | 138/173 [00:01<00:00, 122.15it/s] 87%|████████▋ | 151/173 [00:01<00:00, 116.09it/s] 94%|█████████▍| 163/173 [00:01<00:00, 108.93it/s]100%|██████████| 173/173 [00:01<00:00, 109.70it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.550, valid loss : 0.433, train f1 : 0.719, valid f1 : 0.654
training process - Deferred Re-weighting:   1%|          | 1/128 [01:03<2:14:22, 63.49s/it]Best score increase :0.000 -> 0.654
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:52<1:56:03, 55.26s/it]Best score increase :0.654 -> 0.690
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:42<1:49:49, 52.72s/it]Best score increase :0.690 -> 0.695
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:35<1:49:10, 52.83s/it]Best score increase :0.695 -> 0.698
epoch : 5, train loss : 0.403, valid loss : 0.388, train f1 : 0.820, valid f1 : 0.700
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:40<1:56:57, 57.05s/it]Best score increase :0.698 -> 0.700
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:32<1:52:40, 55.41s/it]Best score increase :0.700 -> 0.710
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:24<1:49:36, 54.35s/it]Best score increase :0.710 -> 0.716
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:16<1:46:59, 53.50s/it]Best score increase :0.716 -> 0.726
epoch : 9, train loss : 0.344, valid loss : 0.377, train f1 : 0.853, valid f1 : 0.713
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:17<1:50:49, 55.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:10<1:47:56, 54.89s/it]Best score increase :0.726 -> 0.729
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:56<1:42:15, 52.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:45<1:39:03, 51.24s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.309, valid loss : 0.354, train f1 : 0.870, valid f1 : 0.706
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:48<1:45:08, 54.86s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:36<1:40:01, 52.65s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:22<1:35:26, 50.68s/it]Best score increase :0.729 -> 0.736
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:09<1:32:34, 49.59s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.281, valid loss : 0.351, train f1 : 0.882, valid f1 : 0.700
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:04<1:34:43, 51.20s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:49<1:30:47, 49.53s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:36<1:28:09, 48.53s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:23<1:26:56, 48.30s/it]EarlyStopping counter : 5 out of 12
epoch : 21, train loss : 0.246, valid loss : 0.321, train f1 : 0.897, valid f1 : 0.733
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:23<1:32:00, 51.59s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:08<1:27:55, 49.77s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:55<1:25:32, 48.88s/it]Best score increase :0.736 -> 0.758
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:41<1:23:22, 48.10s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.232, valid loss : 0.305, train f1 : 0.907, valid f1 : 0.739
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:36<1:26:04, 50.15s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:22<1:22:53, 48.76s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:07<1:20:18, 47.71s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [23:54<1:19:18, 47.59s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.218, valid loss : 0.304, train f1 : 0.912, valid f1 : 0.741
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [24:50<1:22:18, 49.89s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [25:36<1:19:48, 48.86s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [26:26<1:19:18, 49.06s/it]Best score increase :0.758 -> 0.789
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:18<1:20:03, 50.03s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.197, valid loss : 0.262, train f1 : 0.920, valid f1 : 0.785
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [28:20<1:25:10, 53.79s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:12<1:23:03, 53.01s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:03<1:21:30, 52.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [30:53<1:19:29, 51.85s/it]EarlyStopping counter : 5 out of 12
epoch : 37, train loss : 0.191, valid loss : 0.307, train f1 : 0.921, valid f1 : 0.731
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [31:54<1:22:32, 54.42s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [32:47<1:21:07, 54.08s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [33:40<1:19:39, 53.70s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [34:34<1:18:56, 53.83s/it]EarlyStopping counter : 9 out of 12
epoch : 41, train loss : 0.175, valid loss : 0.260, train f1 : 0.929, valid f1 : 0.778
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [35:38<1:22:22, 56.81s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:29<1:19:02, 55.15s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [37:18<1:16:24, 53.31s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 42, best f1 score : 0.789
training process finished, best loss : 0.237, best acc : 0.918, best f1 : 0.789, best epoch : 30

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.52      0.80      0.63       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.87      0.80      7398
weighted avg       0.95      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.87, test loss : 15.190

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.04s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.91s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.90s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.95s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.93s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:46,  7.75s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.77s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.78s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.98s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.92s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.87s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.90s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 10/306 [00:00<00:03, 96.99it/s] 11%|█▏        | 35/306 [00:00<00:01, 176.07it/s] 19%|█▉        | 59/306 [00:00<00:01, 196.29it/s] 26%|██▌       | 79/306 [00:00<00:01, 176.14it/s] 33%|███▎      | 101/306 [00:00<00:01, 189.15it/s] 41%|████      | 125/306 [00:00<00:00, 200.15it/s] 48%|████▊     | 146/306 [00:00<00:00, 180.83it/s] 55%|█████▍    | 168/306 [00:00<00:00, 189.99it/s] 62%|██████▏   | 190/306 [00:01<00:00, 193.00it/s] 69%|██████▊   | 210/306 [00:01<00:00, 179.97it/s] 75%|███████▌  | 231/306 [00:01<00:00, 187.26it/s] 82%|████████▏ | 251/306 [00:01<00:00, 170.87it/s] 90%|████████▉ | 274/306 [00:01<00:00, 185.46it/s] 96%|█████████▌| 294/306 [00:01<00:00, 186.88it/s]100%|██████████| 306/306 [00:01<00:00, 182.44it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 43/553 [00:00<00:01, 427.83it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 457.85it/s]extract the null data:  25%|██▌       | 139/553 [00:00<00:00, 466.17it/s]extract the null data:  34%|███▍      | 189/553 [00:00<00:00, 477.18it/s]extract the null data:  43%|████▎     | 239/553 [00:00<00:00, 485.29it/s]extract the null data:  52%|█████▏    | 288/553 [00:00<00:00, 485.09it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 488.78it/s]extract the null data:  72%|███████▏  | 396/553 [00:00<00:00, 517.08it/s]extract the null data:  83%|████████▎ | 458/553 [00:00<00:00, 548.70it/s]extract the null data:  95%|█████████▍| 523/553 [00:01<00:00, 579.33it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 525.55it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:02, 225.64it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 224.13it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 220.68it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 222.16it/s]replace nan value:  21%|██        | 115/553 [00:00<00:01, 223.10it/s]replace nan value:  25%|██▍       | 138/553 [00:00<00:01, 218.97it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:01, 217.82it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 212.08it/s]replace nan value:  37%|███▋      | 204/553 [00:00<00:01, 207.89it/s]replace nan value:  41%|████      | 225/553 [00:01<00:01, 204.41it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 203.58it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 204.73it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 208.37it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 204.72it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:01, 202.81it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:01, 200.91it/s]replace nan value:  67%|██████▋   | 373/553 [00:01<00:00, 199.80it/s]replace nan value:  71%|███████   | 393/553 [00:01<00:00, 198.18it/s]replace nan value:  75%|███████▍  | 413/553 [00:01<00:00, 198.46it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 197.37it/s]replace nan value:  82%|████████▏ | 455/553 [00:02<00:00, 203.55it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 203.64it/s]replace nan value:  90%|████████▉ | 497/553 [00:02<00:00, 202.42it/s]replace nan value:  94%|█████████▎| 518/553 [00:02<00:00, 198.15it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 197.34it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 205.28it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.67it/s]  5%|▌         | 29/553 [00:00<00:03, 144.03it/s]  8%|▊         | 44/553 [00:00<00:03, 133.94it/s] 10%|█         | 58/553 [00:00<00:03, 123.96it/s] 13%|█▎        | 71/553 [00:00<00:03, 121.59it/s] 16%|█▌        | 88/553 [00:00<00:03, 135.63it/s] 18%|█▊        | 102/553 [00:00<00:03, 130.00it/s] 22%|██▏       | 120/553 [00:00<00:03, 142.49it/s] 24%|██▍       | 135/553 [00:00<00:02, 142.51it/s] 28%|██▊       | 153/553 [00:01<00:02, 153.09it/s] 31%|███       | 171/553 [00:01<00:02, 160.81it/s] 34%|███▍      | 188/553 [00:01<00:02, 154.89it/s] 37%|███▋      | 207/553 [00:01<00:02, 163.68it/s] 41%|████      | 224/553 [00:01<00:02, 154.85it/s] 43%|████▎     | 240/553 [00:01<00:02, 155.72it/s] 46%|████▋     | 256/553 [00:01<00:02, 147.85it/s] 49%|████▉     | 271/553 [00:01<00:01, 145.09it/s] 52%|█████▏    | 287/553 [00:01<00:01, 148.05it/s] 55%|█████▍    | 302/553 [00:02<00:01, 141.85it/s] 57%|█████▋    | 317/553 [00:02<00:01, 135.71it/s] 60%|█████▉    | 331/553 [00:02<00:01, 136.59it/s] 63%|██████▎   | 346/553 [00:02<00:01, 138.78it/s] 65%|██████▌   | 360/553 [00:02<00:01, 132.13it/s] 68%|██████▊   | 377/553 [00:02<00:01, 141.70it/s] 71%|███████   | 392/553 [00:02<00:01, 132.64it/s] 73%|███████▎  | 406/553 [00:02<00:01, 133.65it/s] 76%|███████▌  | 420/553 [00:02<00:01, 126.70it/s] 78%|███████▊  | 433/553 [00:03<00:00, 122.59it/s] 82%|████████▏ | 451/553 [00:03<00:00, 135.23it/s] 84%|████████▍ | 465/553 [00:03<00:00, 134.24it/s] 87%|████████▋ | 479/553 [00:03<00:00, 130.86it/s] 89%|████████▉ | 493/553 [00:03<00:00, 124.46it/s] 92%|█████████▏| 506/553 [00:03<00:00, 123.82it/s] 94%|█████████▍| 520/553 [00:03<00:00, 127.01it/s] 96%|█████████▋| 533/553 [00:03<00:00, 111.08it/s] 99%|█████████▉| 549/553 [00:04<00:00, 123.19it/s]100%|██████████| 553/553 [00:04<00:00, 133.79it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 276.13it/s]extract the null data:  62%|██████▏   | 86/139 [00:00<00:00, 451.64it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 464.42it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 198.43it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 195.76it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 192.99it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 194.83it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 192.35it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 190.35it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 191.16it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.56it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.12it/s] 27%|██▋       | 38/139 [00:00<00:00, 125.39it/s] 37%|███▋      | 51/139 [00:00<00:00, 122.64it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.60it/s] 55%|█████▌    | 77/139 [00:00<00:00, 119.70it/s] 64%|██████▍   | 89/139 [00:00<00:00, 108.16it/s] 74%|███████▍  | 103/139 [00:00<00:00, 115.40it/s] 83%|████████▎ | 115/139 [00:00<00:00, 115.11it/s] 92%|█████████▏| 128/139 [00:01<00:00, 117.63it/s]100%|██████████| 139/139 [00:01<00:00, 118.17it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 217.37it/s]extract the null data:  47%|████▋     | 81/173 [00:00<00:00, 431.45it/s]extract the null data:  80%|███████▉  | 138/173 [00:00<00:00, 491.26it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 464.62it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 195.67it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 190.66it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 190.35it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 186.17it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 187.22it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 189.22it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 190.77it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 191.67it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 189.39it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 129.04it/s] 16%|█▌        | 27/173 [00:00<00:01, 111.39it/s] 23%|██▎       | 40/173 [00:00<00:01, 118.67it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.52it/s] 40%|███▉      | 69/173 [00:00<00:00, 126.88it/s] 48%|████▊     | 83/173 [00:00<00:00, 129.29it/s] 55%|█████▌    | 96/173 [00:00<00:00, 126.42it/s] 64%|██████▎   | 110/173 [00:00<00:00, 129.40it/s] 71%|███████   | 123/173 [00:00<00:00, 122.91it/s] 79%|███████▊  | 136/173 [00:01<00:00, 120.80it/s] 86%|████████▌ | 149/173 [00:01<00:00, 117.20it/s] 93%|█████████▎| 161/173 [00:01<00:00, 109.87it/s]100%|██████████| 173/173 [00:01<00:00, 83.67it/s] 100%|██████████| 173/173 [00:01<00:00, 109.96it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.087, valid loss : 0.065, train acc : 0.889, valid acc : 0.923, train f1 : 0.573, valid f1 : 0.591
training process:   1%|          | 1/128 [01:02<2:11:24, 62.09s/it]Best score increase :0.000 -> 0.591
training process:   2%|▏         | 2/128 [01:51<1:55:03, 54.79s/it]Best score increase :0.591 -> 0.637
training process:   2%|▏         | 3/128 [02:42<1:50:13, 52.91s/it]Best score increase :0.637 -> 0.687
training process:   3%|▎         | 4/128 [03:32<1:46:41, 51.62s/it]Best score increase :0.687 -> 0.706
epoch : 5, train loss : 0.048, valid loss : 0.056, train acc : 0.939, valid acc : 0.935, train f1 : 0.717, valid f1 : 0.703
training process:   4%|▍         | 5/128 [04:31<1:51:26, 54.36s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:19<1:46:28, 52.37s/it]Best score increase :0.706 -> 0.728
training process:   5%|▌         | 7/128 [06:11<1:44:56, 52.04s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:01<1:42:45, 51.38s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.043, valid loss : 0.053, train acc : 0.944, valid acc : 0.936, train f1 : 0.751, valid f1 : 0.716
training process:   7%|▋         | 9/128 [08:00<1:46:43, 53.81s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [08:51<1:44:02, 52.90s/it]Best score increase :0.728 -> 0.734
training process:   9%|▊         | 11/128 [09:40<1:41:18, 51.95s/it]Best score increase :0.734 -> 0.737
training process:   9%|▉         | 12/128 [10:34<1:41:19, 52.41s/it]Best score increase :0.737 -> 0.745
epoch : 13, train loss : 0.039, valid loss : 0.053, train acc : 0.948, valid acc : 0.939, train f1 : 0.771, valid f1 : 0.734
training process:  10%|█         | 13/128 [11:34<1:44:59, 54.78s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:27<1:42:49, 54.12s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [13:19<1:40:57, 53.61s/it]Best score increase :0.745 -> 0.756
training process:  12%|█▎        | 16/128 [14:12<1:39:43, 53.42s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.037, valid loss : 0.050, train acc : 0.951, valid acc : 0.942, train f1 : 0.789, valid f1 : 0.761
training process:  13%|█▎        | 17/128 [15:12<1:42:17, 55.29s/it]Best score increase :0.756 -> 0.761
training process:  14%|█▍        | 18/128 [16:04<1:39:47, 54.43s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:57<1:37:42, 53.78s/it]Best score increase :0.761 -> 0.775
training process:  16%|█▌        | 20/128 [17:49<1:36:07, 53.40s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.035, valid loss : 0.050, train acc : 0.954, valid acc : 0.943, train f1 : 0.807, valid f1 : 0.773
training process:  16%|█▋        | 21/128 [18:48<1:38:27, 55.21s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [19:39<1:35:03, 53.81s/it]Best score increase :0.775 -> 0.786
training process:  18%|█▊        | 23/128 [20:26<1:30:49, 51.90s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:14<1:27:30, 50.48s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.052, train acc : 0.956, valid acc : 0.945, train f1 : 0.820, valid f1 : 0.778
training process:  20%|█▉        | 25/128 [22:13<1:31:20, 53.21s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [23:00<1:27:14, 51.32s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [23:47<1:23:59, 49.90s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [24:34<1:21:42, 49.02s/it]Best score increase :0.786 -> 0.791
epoch : 29, train loss : 0.031, valid loss : 0.050, train acc : 0.958, valid acc : 0.947, train f1 : 0.828, valid f1 : 0.789
training process:  23%|██▎       | 29/128 [25:33<1:26:01, 52.14s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [26:21<1:23:19, 51.02s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [27:08<1:20:11, 49.61s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [27:53<1:17:18, 48.32s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.031, valid loss : 0.052, train acc : 0.959, valid acc : 0.947, train f1 : 0.835, valid f1 : 0.790
training process:  26%|██▌       | 33/128 [28:51<1:20:54, 51.10s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [29:37<1:17:50, 49.68s/it]Best score increase :0.791 -> 0.794
training process:  27%|██▋       | 35/128 [30:24<1:15:30, 48.72s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [31:10<1:13:38, 48.02s/it]Best score increase :0.794 -> 0.801
epoch : 37, train loss : 0.028, valid loss : 0.052, train acc : 0.962, valid acc : 0.946, train f1 : 0.849, valid f1 : 0.786
training process:  29%|██▉       | 37/128 [32:03<1:15:00, 49.45s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [32:50<1:13:11, 48.79s/it]Best score increase :0.801 -> 0.803
training process:  30%|███       | 39/128 [33:41<1:13:23, 49.48s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [34:30<1:12:13, 49.24s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.028, valid loss : 0.049, train acc : 0.963, valid acc : 0.948, train f1 : 0.855, valid f1 : 0.791
training process:  32%|███▏      | 41/128 [35:32<1:17:06, 53.18s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [36:24<1:15:39, 52.79s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [37:14<1:13:38, 51.99s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [38:05<1:12:29, 51.78s/it]Best score increase :0.803 -> 0.804
epoch : 45, train loss : 0.027, valid loss : 0.049, train acc : 0.963, valid acc : 0.947, train f1 : 0.853, valid f1 : 0.788
training process:  35%|███▌      | 45/128 [39:06<1:15:16, 54.41s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [39:58<1:13:32, 53.81s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [40:52<1:12:45, 53.89s/it]Best score increase :0.804 -> 0.827
training process:  38%|███▊      | 48/128 [41:44<1:10:52, 53.16s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.027, valid loss : 0.051, train acc : 0.965, valid acc : 0.952, train f1 : 0.864, valid f1 : 0.815
training process:  38%|███▊      | 49/128 [42:45<1:13:08, 55.55s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [43:38<1:11:05, 54.69s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [44:31<1:09:39, 54.28s/it]EarlyStopping counter : 4 out of 12
training process:  41%|████      | 52/128 [45:21<1:06:58, 52.88s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.025, valid loss : 0.051, train acc : 0.966, valid acc : 0.949, train f1 : 0.869, valid f1 : 0.799
training process:  41%|████▏     | 53/128 [46:21<1:08:52, 55.10s/it]EarlyStopping counter : 6 out of 12
training process:  42%|████▏     | 54/128 [47:13<1:06:59, 54.32s/it]Best score increase :0.827 -> 0.830
training process:  43%|████▎     | 55/128 [48:06<1:05:24, 53.76s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [48:56<1:03:17, 52.74s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.025, valid loss : 0.051, train acc : 0.967, valid acc : 0.952, train f1 : 0.870, valid f1 : 0.816
training process:  45%|████▍     | 57/128 [49:58<1:05:36, 55.44s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [50:52<1:04:04, 54.91s/it]EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [51:43<1:01:59, 53.90s/it]EarlyStopping counter : 5 out of 12
training process:  47%|████▋     | 60/128 [52:35<1:00:28, 53.35s/it]Best score increase :0.830 -> 0.833
epoch : 61, train loss : 0.024, valid loss : 0.051, train acc : 0.968, valid acc : 0.955, train f1 : 0.875, valid f1 : 0.830
training process:  48%|████▊     | 61/128 [53:36<1:02:03, 55.58s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 62/128 [54:33<1:01:41, 56.08s/it]EarlyStopping counter : 2 out of 12
training process:  49%|████▉     | 63/128 [55:29<1:00:45, 56.08s/it]EarlyStopping counter : 3 out of 12
training process:  50%|█████     | 64/128 [56:25<59:49, 56.08s/it]  EarlyStopping counter : 4 out of 12
epoch : 65, train loss : 0.023, valid loss : 0.057, train acc : 0.969, valid acc : 0.955, train f1 : 0.881, valid f1 : 0.835
training process:  51%|█████     | 65/128 [57:31<1:01:46, 58.83s/it]Best score increase :0.833 -> 0.835
training process:  52%|█████▏    | 66/128 [58:29<1:00:36, 58.66s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 67/128 [59:25<58:53, 57.93s/it]  EarlyStopping counter : 2 out of 12
training process:  53%|█████▎    | 68/128 [1:00:20<56:54, 56.90s/it]Best score increase :0.835 -> 0.838
epoch : 69, train loss : 0.023, valid loss : 0.053, train acc : 0.969, valid acc : 0.955, train f1 : 0.881, valid f1 : 0.834
training process:  54%|█████▍    | 69/128 [1:01:27<58:58, 59.98s/it]EarlyStopping counter : 1 out of 12
training process:  55%|█████▍    | 70/128 [1:02:23<56:45, 58.71s/it]Best score increase :0.838 -> 0.839
training process:  55%|█████▌    | 71/128 [1:03:17<54:40, 57.55s/it]EarlyStopping counter : 1 out of 12
training process:  56%|█████▋    | 72/128 [1:04:08<51:41, 55.39s/it]EarlyStopping counter : 2 out of 12
epoch : 73, train loss : 0.022, valid loss : 0.054, train acc : 0.972, valid acc : 0.955, train f1 : 0.894, valid f1 : 0.827
training process:  57%|█████▋    | 73/128 [1:05:09<52:18, 57.06s/it]EarlyStopping counter : 3 out of 12
training process:  58%|█████▊    | 74/128 [1:06:04<50:44, 56.39s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▊    | 75/128 [1:06:55<48:32, 54.95s/it]Best score increase :0.839 -> 0.843
training process:  59%|█████▉    | 76/128 [1:07:48<47:01, 54.26s/it]Best score increase :0.843 -> 0.844
epoch : 77, train loss : 0.022, valid loss : 0.051, train acc : 0.971, valid acc : 0.953, train f1 : 0.891, valid f1 : 0.821
training process:  60%|██████    | 77/128 [1:08:48<47:40, 56.08s/it]EarlyStopping counter : 1 out of 12
training process:  61%|██████    | 78/128 [1:09:42<46:13, 55.46s/it]EarlyStopping counter : 2 out of 12
training process:  62%|██████▏   | 79/128 [1:10:33<44:10, 54.09s/it]Best score increase :0.844 -> 0.847
training process:  62%|██████▎   | 80/128 [1:11:22<42:08, 52.67s/it]EarlyStopping counter : 1 out of 12
epoch : 81, train loss : 0.021, valid loss : 0.059, train acc : 0.972, valid acc : 0.955, train f1 : 0.894, valid f1 : 0.834
training process:  63%|██████▎   | 81/128 [1:12:22<42:51, 54.71s/it]EarlyStopping counter : 2 out of 12
training process:  64%|██████▍   | 82/128 [1:13:13<41:01, 53.50s/it]EarlyStopping counter : 3 out of 12
training process:  65%|██████▍   | 83/128 [1:14:03<39:29, 52.65s/it]EarlyStopping counter : 4 out of 12
training process:  66%|██████▌   | 84/128 [1:14:54<38:06, 51.97s/it]EarlyStopping counter : 5 out of 12
epoch : 85, train loss : 0.021, valid loss : 0.057, train acc : 0.972, valid acc : 0.955, train f1 : 0.897, valid f1 : 0.837
training process:  66%|██████▋   | 85/128 [1:15:52<38:35, 53.85s/it]EarlyStopping counter : 6 out of 12
training process:  67%|██████▋   | 86/128 [1:16:43<37:05, 53.00s/it]EarlyStopping counter : 7 out of 12
training process:  68%|██████▊   | 87/128 [1:17:33<35:42, 52.25s/it]EarlyStopping counter : 8 out of 12
training process:  69%|██████▉   | 88/128 [1:18:24<34:33, 51.83s/it]EarlyStopping counter : 9 out of 12
epoch : 89, train loss : 0.022, valid loss : 0.057, train acc : 0.973, valid acc : 0.956, train f1 : 0.897, valid f1 : 0.837
training process:  70%|██████▉   | 89/128 [1:19:21<34:34, 53.19s/it]EarlyStopping counter : 10 out of 12
training process:  70%|███████   | 90/128 [1:20:10<32:56, 52.01s/it]EarlyStopping counter : 11 out of 12
training process:  70%|███████   | 90/128 [1:20:59<34:11, 53.99s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 90, best f1 score : 0.847
training process finished, best loss : 0.055 and best acc : 0.956, best f1 : 0.847, best epoch : 78

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.64      0.65       580
           1       0.97      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.80      0.81      7398
weighted avg       0.94      0.95      0.94      7398


# test acc : 0.95, test f1 : 0.81, test AUC : 0.80, test loss : 4.376

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.83s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:20,  8.02s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.89s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.76s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.70s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:45,  7.67s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:37,  7.54s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.54s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.47s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:14,  7.49s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.54s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.69s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.65s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 204.43it/s] 14%|█▍        | 43/306 [00:00<00:01, 200.35it/s] 21%|██        | 64/306 [00:00<00:01, 200.43it/s] 28%|██▊       | 85/306 [00:00<00:01, 197.70it/s] 35%|███▍      | 107/306 [00:00<00:00, 204.27it/s] 42%|████▏     | 128/306 [00:00<00:00, 199.51it/s] 50%|█████     | 154/306 [00:00<00:00, 217.90it/s] 59%|█████▉    | 180/306 [00:00<00:00, 228.68it/s] 66%|██████▋   | 203/306 [00:00<00:00, 218.83it/s] 74%|███████▍  | 226/306 [00:01<00:00, 214.06it/s] 81%|████████  | 248/306 [00:01<00:00, 213.51it/s] 88%|████████▊ | 270/306 [00:01<00:00, 210.64it/s] 95%|█████████▌| 292/306 [00:01<00:00, 200.66it/s]100%|██████████| 306/306 [00:01<00:00, 207.62it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 458.19it/s]extract the null data:  18%|█▊        | 98/553 [00:00<00:00, 490.62it/s]extract the null data:  27%|██▋       | 148/553 [00:00<00:00, 493.77it/s]extract the null data:  36%|███▌      | 198/553 [00:00<00:00, 484.49it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:00, 478.89it/s]extract the null data:  53%|█████▎    | 295/553 [00:00<00:00, 473.24it/s]extract the null data:  62%|██████▏   | 343/553 [00:00<00:00, 474.83it/s]extract the null data:  71%|███████   | 391/553 [00:00<00:00, 472.93it/s]extract the null data:  80%|███████▉  | 440/553 [00:00<00:00, 475.89it/s]extract the null data:  88%|████████▊ | 488/553 [00:01<00:00, 470.68it/s]extract the null data:  97%|█████████▋| 538/553 [00:01<00:00, 478.60it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 479.37it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 174.87it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 175.11it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 170.93it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 170.07it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 171.36it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 173.75it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 175.82it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 178.42it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:02, 176.89it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 176.39it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:02, 175.71it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 175.53it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 172.77it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 171.04it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 172.31it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 171.99it/s]replace nan value:  56%|█████▌    | 308/553 [00:01<00:01, 169.94it/s]replace nan value:  59%|█████▉    | 326/553 [00:01<00:01, 169.83it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:01, 170.90it/s]replace nan value:  65%|██████▌   | 362/553 [00:02<00:01, 171.16it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:00, 174.37it/s]replace nan value:  72%|███████▏  | 399/553 [00:02<00:00, 175.37it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 171.14it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 171.82it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 171.80it/s]replace nan value:  85%|████████▌ | 472/553 [00:02<00:00, 175.47it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 187.98it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 196.31it/s]replace nan value:  97%|█████████▋| 538/553 [00:03<00:00, 202.47it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 178.56it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.21it/s]  6%|▌         | 32/553 [00:00<00:03, 156.44it/s]  9%|▊         | 48/553 [00:00<00:03, 129.97it/s] 11%|█         | 62/553 [00:00<00:03, 127.17it/s] 14%|█▍        | 77/553 [00:00<00:03, 131.32it/s] 16%|█▋        | 91/553 [00:00<00:03, 133.54it/s] 19%|█▉        | 105/553 [00:00<00:03, 134.98it/s] 22%|██▏       | 121/553 [00:00<00:03, 141.68it/s] 25%|██▍       | 136/553 [00:00<00:02, 141.63it/s] 28%|██▊       | 154/553 [00:01<00:02, 152.40it/s] 31%|███       | 172/553 [00:01<00:02, 159.20it/s] 34%|███▍      | 188/553 [00:01<00:02, 154.32it/s] 37%|███▋      | 207/553 [00:01<00:02, 162.08it/s] 41%|████      | 224/553 [00:01<00:02, 151.95it/s] 43%|████▎     | 240/553 [00:01<00:02, 152.76it/s] 46%|████▋     | 256/553 [00:01<00:02, 145.14it/s] 49%|████▉     | 271/553 [00:01<00:01, 141.88it/s] 52%|█████▏    | 286/553 [00:01<00:01, 143.78it/s] 54%|█████▍    | 301/553 [00:02<00:01, 138.32it/s] 57%|█████▋    | 315/553 [00:02<00:01, 132.32it/s] 59%|█████▉    | 329/553 [00:02<00:01, 130.82it/s] 62%|██████▏   | 345/553 [00:02<00:01, 133.50it/s] 65%|██████▍   | 359/553 [00:02<00:01, 128.77it/s] 68%|██████▊   | 375/553 [00:02<00:01, 137.03it/s] 70%|███████   | 389/553 [00:02<00:01, 127.94it/s] 73%|███████▎  | 402/553 [00:02<00:01, 122.77it/s] 75%|███████▌  | 416/553 [00:03<00:01, 124.40it/s] 78%|███████▊  | 429/553 [00:03<00:01, 119.42it/s] 81%|████████  | 448/553 [00:03<00:00, 136.05it/s] 84%|████████▎ | 463/553 [00:03<00:00, 138.19it/s] 86%|████████▋ | 478/553 [00:03<00:00, 136.33it/s] 89%|████████▉ | 492/553 [00:03<00:00, 131.83it/s] 92%|█████████▏| 506/553 [00:03<00:00, 129.58it/s] 94%|█████████▍| 521/553 [00:03<00:00, 130.45it/s] 97%|█████████▋| 535/553 [00:03<00:00, 116.06it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.00it/s]100%|██████████| 553/553 [00:04<00:00, 133.76it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 345.10it/s]extract the null data:  70%|██████▉   | 97/139 [00:00<00:00, 505.84it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 513.64it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 206.96it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 208.52it/s]replace nan value:  47%|████▋     | 65/139 [00:00<00:00, 214.02it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 213.10it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 214.21it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 219.10it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 215.33it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.47it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.48it/s] 27%|██▋       | 38/139 [00:00<00:00, 126.51it/s] 37%|███▋      | 51/139 [00:00<00:00, 122.77it/s] 46%|████▌     | 64/139 [00:00<00:00, 121.96it/s] 55%|█████▌    | 77/139 [00:00<00:00, 116.76it/s] 64%|██████▍   | 89/139 [00:00<00:00, 104.44it/s] 74%|███████▍  | 103/139 [00:00<00:00, 112.39it/s] 83%|████████▎ | 115/139 [00:00<00:00, 113.08it/s] 92%|█████████▏| 128/139 [00:01<00:00, 115.82it/s]100%|██████████| 139/139 [00:01<00:00, 116.67it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 218.34it/s]extract the null data:  42%|████▏     | 73/173 [00:00<00:00, 388.71it/s]extract the null data:  73%|███████▎  | 126/173 [00:00<00:00, 449.80it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 435.22it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 178.04it/s]replace nan value:  21%|██▏       | 37/173 [00:00<00:00, 180.29it/s]replace nan value:  32%|███▏      | 56/173 [00:00<00:00, 179.61it/s]replace nan value:  43%|████▎     | 74/173 [00:00<00:00, 178.55it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 178.57it/s]replace nan value:  64%|██████▍   | 111/173 [00:00<00:00, 180.74it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 180.39it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 178.56it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 177.76it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 178.83it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 125.84it/s] 16%|█▌        | 27/173 [00:00<00:01, 108.33it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.81it/s] 32%|███▏      | 55/173 [00:00<00:00, 125.11it/s] 39%|███▉      | 68/173 [00:00<00:00, 125.23it/s] 47%|████▋     | 81/173 [00:00<00:00, 123.97it/s] 55%|█████▍    | 95/173 [00:00<00:00, 125.88it/s] 62%|██████▏   | 108/173 [00:00<00:00, 126.35it/s] 70%|██████▉   | 121/173 [00:00<00:00, 125.86it/s] 77%|███████▋  | 134/173 [00:01<00:00, 120.33it/s] 85%|████████▍ | 147/173 [00:01<00:00, 121.41it/s] 92%|█████████▏| 160/173 [00:01<00:00, 109.01it/s] 99%|█████████▉| 172/173 [00:01<00:00, 82.40it/s] 100%|██████████| 173/173 [00:01<00:00, 108.83it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.108, train acc : 0.726, valid acc : 0.854, train f1 : 0.725, valid f1 : 0.675
training process:   1%|          | 1/128 [01:01<2:10:19, 61.57s/it]Best score increase :0.000 -> 0.675
training process:   2%|▏         | 2/128 [01:54<1:58:25, 56.39s/it]Best score increase :0.675 -> 0.704
training process:   2%|▏         | 3/128 [02:45<1:52:39, 54.08s/it]EarlyStopping counter : 1 out of 12
training process:   3%|▎         | 4/128 [03:37<1:50:08, 53.29s/it]EarlyStopping counter : 2 out of 12
epoch : 5, train loss : 0.097, valid loss : 0.102, train acc : 0.833, valid acc : 0.852, train f1 : 0.833, valid f1 : 0.697
training process:   4%|▍         | 5/128 [04:37<1:54:05, 55.66s/it]EarlyStopping counter : 3 out of 12
training process:   5%|▍         | 6/128 [05:30<1:50:59, 54.58s/it]Best score increase :0.704 -> 0.711
training process:   5%|▌         | 7/128 [06:22<1:48:50, 53.97s/it]Best score increase :0.711 -> 0.717
training process:   6%|▋         | 8/128 [07:11<1:44:49, 52.42s/it]Best score increase :0.717 -> 0.722
epoch : 9, train loss : 0.083, valid loss : 0.101, train acc : 0.863, valid acc : 0.866, train f1 : 0.863, valid f1 : 0.712
training process:   7%|▋         | 9/128 [08:10<1:47:59, 54.45s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:01<1:44:41, 53.23s/it]Best score increase :0.722 -> 0.748
training process:   9%|▊         | 11/128 [09:50<1:41:27, 52.03s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:42<1:40:30, 51.99s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.076, valid loss : 0.093, train acc : 0.876, valid acc : 0.865, train f1 : 0.876, valid f1 : 0.710
training process:  10%|█         | 13/128 [11:40<1:43:22, 53.93s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:32<1:41:14, 53.29s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [13:25<1:39:56, 53.07s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▎        | 16/128 [14:18<1:39:25, 53.26s/it]EarlyStopping counter : 6 out of 12
epoch : 17, train loss : 0.071, valid loss : 0.094, train acc : 0.887, valid acc : 0.864, train f1 : 0.887, valid f1 : 0.714
training process:  13%|█▎        | 17/128 [15:20<1:42:59, 55.67s/it]EarlyStopping counter : 7 out of 12
training process:  14%|█▍        | 18/128 [16:12<1:40:02, 54.57s/it]EarlyStopping counter : 8 out of 12
training process:  15%|█▍        | 19/128 [17:03<1:37:04, 53.43s/it]EarlyStopping counter : 9 out of 12
training process:  16%|█▌        | 20/128 [17:55<1:35:37, 53.12s/it]EarlyStopping counter : 10 out of 12
epoch : 21, train loss : 0.063, valid loss : 0.089, train acc : 0.902, valid acc : 0.880, train f1 : 0.902, valid f1 : 0.733
training process:  16%|█▋        | 21/128 [18:56<1:38:49, 55.41s/it]EarlyStopping counter : 11 out of 12
training process:  16%|█▋        | 21/128 [19:47<1:40:51, 56.56s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 21, best f1 score : 0.748
training process finished, best loss : 0.085 and best acc : 0.897, best f1 : 0.748, best epoch : 9

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.39      0.77      0.52       580
           1       0.98      0.90      0.94      6818

    accuracy                           0.89      7398
   macro avg       0.69      0.83      0.73      7398
weighted avg       0.93      0.89      0.90      7398


# test acc : 0.89, test f1 : 0.73, test AUC : 0.83, test loss : 5.458

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.65s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.62s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.73s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:04,  8.01s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.99s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.87s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:30,  7.67s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.72s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.79s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.91s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.99s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.85s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 105.09it/s] 11%|█▏        | 35/306 [00:00<00:01, 181.26it/s] 19%|█▉        | 58/306 [00:00<00:01, 201.33it/s] 26%|██▌       | 79/306 [00:00<00:01, 164.45it/s] 35%|███▍      | 107/306 [00:00<00:01, 194.77it/s] 42%|████▏     | 130/306 [00:00<00:00, 203.42it/s] 50%|████▉     | 152/306 [00:00<00:00, 175.59it/s] 58%|█████▊    | 176/306 [00:00<00:00, 190.17it/s] 64%|██████▍   | 196/306 [00:01<00:00, 181.61it/s] 70%|███████   | 215/306 [00:01<00:00, 179.94it/s] 79%|███████▉  | 241/306 [00:01<00:00, 201.51it/s] 86%|████████▌ | 263/306 [00:01<00:00, 204.08it/s] 93%|█████████▎| 284/306 [00:01<00:00, 185.51it/s]100%|██████████| 306/306 [00:01<00:00, 190.03it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 570.31it/s]extract the null data:  21%|██▏       | 118/553 [00:00<00:00, 585.64it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:00, 594.38it/s]extract the null data:  43%|████▎     | 240/553 [00:00<00:00, 599.22it/s]extract the null data:  54%|█████▍    | 301/553 [00:00<00:00, 602.19it/s]extract the null data:  65%|██████▌   | 362/553 [00:00<00:00, 602.60it/s]extract the null data:  76%|███████▋  | 423/553 [00:00<00:00, 602.76it/s]extract the null data:  88%|████████▊ | 484/553 [00:00<00:00, 600.77it/s]extract the null data:  99%|█████████▊| 545/553 [00:00<00:00, 596.64it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 596.42it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 194.03it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 204.46it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 210.46it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 208.27it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 207.17it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 205.54it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:01, 205.52it/s]replace nan value:  31%|███       | 170/553 [00:00<00:01, 206.64it/s]replace nan value:  35%|███▍      | 192/553 [00:00<00:01, 209.49it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 210.79it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 209.05it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:01, 207.00it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 206.90it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 206.11it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 204.32it/s]replace nan value:  62%|██████▏   | 341/553 [00:01<00:01, 204.21it/s]replace nan value:  65%|██████▌   | 362/553 [00:01<00:00, 200.30it/s]replace nan value:  69%|██████▉   | 383/553 [00:01<00:00, 201.49it/s]replace nan value:  73%|███████▎  | 404/553 [00:01<00:00, 201.96it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 202.41it/s]replace nan value:  81%|████████  | 446/553 [00:02<00:00, 203.21it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 203.78it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 203.46it/s]replace nan value:  92%|█████████▏| 509/553 [00:02<00:00, 201.81it/s]replace nan value:  96%|█████████▌| 530/553 [00:02<00:00, 202.37it/s]replace nan value: 100%|█████████▉| 552/553 [00:02<00:00, 207.51it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 205.32it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.01it/s]  5%|▍         | 27/553 [00:00<00:04, 131.48it/s]  7%|▋         | 41/553 [00:00<00:04, 126.86it/s] 10%|▉         | 54/553 [00:00<00:04, 113.76it/s] 12%|█▏        | 66/553 [00:00<00:04, 104.21it/s] 14%|█▍        | 79/553 [00:00<00:04, 110.00it/s] 17%|█▋        | 92/553 [00:00<00:04, 114.61it/s] 19%|█▉        | 104/553 [00:00<00:03, 114.42it/s] 22%|██▏       | 119/553 [00:01<00:03, 123.50it/s] 24%|██▍       | 132/553 [00:01<00:03, 119.72it/s] 27%|██▋       | 149/553 [00:01<00:03, 132.32it/s] 30%|██▉       | 164/553 [00:01<00:02, 135.77it/s] 32%|███▏      | 178/553 [00:01<00:02, 135.66it/s] 35%|███▍      | 193/553 [00:01<00:02, 138.07it/s] 38%|███▊      | 210/553 [00:01<00:02, 142.69it/s] 41%|████      | 225/553 [00:01<00:02, 134.68it/s] 43%|████▎     | 239/553 [00:01<00:02, 134.87it/s] 46%|████▌     | 253/553 [00:01<00:02, 130.81it/s] 48%|████▊     | 267/553 [00:02<00:02, 126.95it/s] 51%|█████     | 280/553 [00:02<00:02, 123.89it/s] 53%|█████▎    | 293/553 [00:02<00:02, 122.98it/s] 55%|█████▌    | 306/553 [00:02<00:02, 116.18it/s] 58%|█████▊    | 318/553 [00:02<00:02, 115.21it/s] 60%|█████▉    | 331/553 [00:02<00:01, 117.70it/s] 62%|██████▏   | 345/553 [00:02<00:01, 122.71it/s] 65%|██████▍   | 358/553 [00:02<00:01, 124.38it/s] 68%|██████▊   | 374/553 [00:02<00:01, 133.78it/s] 70%|███████   | 388/553 [00:03<00:01, 124.97it/s] 73%|███████▎  | 401/553 [00:03<00:01, 119.01it/s] 75%|███████▌  | 416/553 [00:03<00:01, 123.90it/s] 78%|███████▊  | 429/553 [00:03<00:01, 119.34it/s] 81%|████████  | 448/553 [00:03<00:00, 136.32it/s] 84%|████████▍ | 464/553 [00:03<00:00, 140.30it/s] 87%|████████▋ | 479/553 [00:03<00:00, 138.51it/s] 89%|████████▉ | 493/553 [00:03<00:00, 133.25it/s] 92%|█████████▏| 507/553 [00:04<00:00, 133.99it/s] 94%|█████████▍| 521/553 [00:04<00:00, 132.52it/s] 97%|█████████▋| 535/553 [00:04<00:00, 116.95it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.78it/s]100%|██████████| 553/553 [00:04<00:00, 124.32it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  28%|██▊       | 39/139 [00:00<00:00, 385.46it/s]extract the null data:  77%|███████▋  | 107/139 [00:00<00:00, 556.35it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 559.17it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 226.30it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 225.72it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 226.95it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 224.62it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 222.29it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 222.28it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 223.45it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.79it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.12it/s] 29%|██▉       | 41/139 [00:00<00:00, 137.47it/s] 40%|███▉      | 55/139 [00:00<00:00, 126.13it/s] 50%|████▉     | 69/139 [00:00<00:00, 128.79it/s] 59%|█████▉    | 82/139 [00:00<00:00, 124.83it/s] 68%|██████▊   | 95/139 [00:00<00:00, 115.68it/s] 77%|███████▋  | 107/139 [00:00<00:00, 115.62it/s] 88%|████████▊ | 122/139 [00:00<00:00, 124.73it/s] 97%|█████████▋| 135/139 [00:01<00:00, 122.43it/s]100%|██████████| 139/139 [00:01<00:00, 125.02it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 298.20it/s]extract the null data:  55%|█████▌    | 96/173 [00:00<00:00, 507.90it/s]extract the null data:  92%|█████████▏| 160/173 [00:00<00:00, 564.70it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 531.92it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 206.90it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 209.46it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 210.53it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 211.00it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 213.53it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 217.86it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 219.98it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 214.35it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 135.01it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.56it/s] 24%|██▍       | 42/173 [00:00<00:01, 126.91it/s] 33%|███▎      | 57/173 [00:00<00:00, 133.14it/s] 41%|████      | 71/173 [00:00<00:00, 134.26it/s] 49%|████▉     | 85/173 [00:00<00:00, 134.07it/s] 57%|█████▋    | 99/173 [00:00<00:00, 132.56it/s] 66%|██████▌   | 114/173 [00:00<00:00, 137.01it/s] 74%|███████▍  | 128/173 [00:00<00:00, 128.59it/s] 82%|████████▏ | 141/173 [00:01<00:00, 128.17it/s] 89%|████████▉ | 154/173 [00:01<00:00, 118.73it/s] 97%|█████████▋| 167/173 [00:01<00:00, 93.47it/s] 100%|██████████| 173/173 [00:01<00:00, 114.28it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.022, valid loss : 0.020, train acc : 0.710, valid acc : 0.802, train f1 : 0.549, valid f1 : 0.632
training process:   1%|          | 1/128 [01:01<2:10:56, 61.86s/it]Best score increase :0.000 -> 0.632
training process:   2%|▏         | 2/128 [01:47<1:49:27, 52.12s/it]Best score increase :0.632 -> 0.689
training process:   2%|▏         | 3/128 [02:31<1:41:38, 48.79s/it]Best score increase :0.689 -> 0.697
training process:   3%|▎         | 4/128 [03:17<1:38:16, 47.55s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.016, valid loss : 0.017, train acc : 0.863, valid acc : 0.867, train f1 : 0.695, valid f1 : 0.707
training process:   4%|▍         | 5/128 [04:16<1:45:36, 51.52s/it]Best score increase :0.697 -> 0.707
training process:   5%|▍         | 6/128 [05:03<1:42:04, 50.20s/it]Best score increase :0.707 -> 0.708
training process:   5%|▌         | 7/128 [05:49<1:38:23, 48.79s/it]Best score increase :0.708 -> 0.737
training process:   6%|▋         | 8/128 [06:34<1:35:11, 47.60s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.014, valid loss : 0.017, train acc : 0.881, valid acc : 0.891, train f1 : 0.723, valid f1 : 0.731
training process:   7%|▋         | 9/128 [07:32<1:40:29, 50.67s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [08:18<1:36:58, 49.31s/it]Best score increase :0.737 -> 0.744
training process:   9%|▊         | 11/128 [09:03<1:33:46, 48.09s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [09:48<1:31:16, 47.21s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.013, valid loss : 0.016, train acc : 0.898, valid acc : 0.894, train f1 : 0.749, valid f1 : 0.741
training process:  10%|█         | 13/128 [10:42<1:34:04, 49.09s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [11:29<1:32:06, 48.48s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [12:19<1:32:12, 48.96s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▎        | 16/128 [13:09<1:31:46, 49.17s/it]EarlyStopping counter : 6 out of 12
epoch : 17, train loss : 0.012, valid loss : 0.016, train acc : 0.903, valid acc : 0.890, train f1 : 0.758, valid f1 : 0.743
training process:  13%|█▎        | 17/128 [14:07<1:35:52, 51.82s/it]EarlyStopping counter : 7 out of 12
training process:  14%|█▍        | 18/128 [14:56<1:33:29, 50.99s/it]EarlyStopping counter : 8 out of 12
training process:  15%|█▍        | 19/128 [15:45<1:31:28, 50.35s/it]EarlyStopping counter : 9 out of 12
training process:  16%|█▌        | 20/128 [16:34<1:29:59, 50.00s/it]Best score increase :0.744 -> 0.776
epoch : 21, train loss : 0.012, valid loss : 0.016, train acc : 0.912, valid acc : 0.882, train f1 : 0.774, valid f1 : 0.731
training process:  16%|█▋        | 21/128 [17:31<1:33:11, 52.26s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [18:22<1:31:34, 51.83s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [19:13<1:29:58, 51.42s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [20:06<1:30:08, 52.00s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.011, valid loss : 0.016, train acc : 0.916, valid acc : 0.888, train f1 : 0.783, valid f1 : 0.741
training process:  20%|█▉        | 25/128 [21:08<1:34:32, 55.08s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [22:02<1:33:06, 54.77s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [22:53<1:30:03, 53.50s/it]EarlyStopping counter : 7 out of 12
training process:  22%|██▏       | 28/128 [23:42<1:26:48, 52.09s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.010, valid loss : 0.016, train acc : 0.923, valid acc : 0.902, train f1 : 0.798, valid f1 : 0.760
training process:  23%|██▎       | 29/128 [24:39<1:28:44, 53.78s/it]EarlyStopping counter : 9 out of 12
training process:  23%|██▎       | 30/128 [25:30<1:26:27, 52.94s/it]EarlyStopping counter : 10 out of 12
training process:  24%|██▍       | 31/128 [26:19<1:23:45, 51.81s/it]EarlyStopping counter : 11 out of 12
training process:  24%|██▍       | 31/128 [27:09<1:24:58, 52.56s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 31, best f1 score : 0.776
training process finished, best loss : 0.017 and best acc : 0.915, best f1 : 0.776, best epoch : 30

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.47      0.69      0.56       580
           1       0.97      0.93      0.95      6818

    accuracy                           0.92      7398
   macro avg       0.72      0.81      0.76      7398
weighted avg       0.93      0.92      0.92      7398


# test acc : 0.92, test f1 : 0.76, test AUC : 0.81, test loss : 1.056

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:31,  8.31s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:21,  8.12s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:13,  8.17s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:05,  8.19s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:57,  8.23s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:49,  8.21s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:58<00:42,  8.47s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:33,  8.37s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:14<00:24,  8.27s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:22<00:16,  8.19s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:30<00:08,  8.18s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.07s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.20s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 32/306 [00:00<00:00, 313.84it/s] 21%|██        | 65/306 [00:00<00:00, 307.90it/s] 31%|███▏      | 96/306 [00:00<00:00, 275.23it/s] 41%|████      | 124/306 [00:00<00:00, 255.89it/s] 49%|████▉     | 150/306 [00:00<00:00, 252.39it/s] 58%|█████▊    | 176/306 [00:00<00:00, 250.54it/s] 66%|██████▌   | 202/306 [00:00<00:00, 239.37it/s] 74%|███████▍  | 227/306 [00:00<00:00, 240.41it/s] 82%|████████▏ | 252/306 [00:00<00:00, 240.82it/s] 91%|█████████ | 277/306 [00:01<00:00, 228.34it/s] 99%|█████████▉| 303/306 [00:01<00:00, 235.96it/s]100%|██████████| 306/306 [00:01<00:00, 247.85it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 483.40it/s]extract the null data:  18%|█▊        | 99/553 [00:00<00:00, 488.43it/s]extract the null data:  27%|██▋       | 150/553 [00:00<00:00, 497.94it/s]extract the null data:  37%|███▋      | 202/553 [00:00<00:00, 506.42it/s]extract the null data:  46%|████▌     | 254/553 [00:00<00:00, 510.19it/s]extract the null data:  56%|█████▋    | 312/553 [00:00<00:00, 533.75it/s]extract the null data:  67%|██████▋   | 372/553 [00:00<00:00, 552.54it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 546.77it/s]extract the null data:  88%|████████▊ | 484/553 [00:00<00:00, 549.77it/s]extract the null data:  98%|█████████▊| 540/553 [00:01<00:00, 550.96it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 532.82it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:02, 179.35it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 175.60it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 174.78it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 175.81it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 177.18it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 177.12it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 174.47it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:02, 176.94it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:02, 174.93it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 174.94it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:02, 175.86it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 175.44it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 174.54it/s]replace nan value:  46%|████▌     | 253/553 [00:01<00:01, 174.77it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 173.95it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 175.15it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 176.47it/s]replace nan value:  59%|█████▉    | 326/553 [00:01<00:01, 178.09it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:01, 176.91it/s]replace nan value:  65%|██████▌   | 362/553 [00:02<00:01, 175.91it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:00, 178.04it/s]replace nan value:  72%|███████▏  | 399/553 [00:02<00:00, 175.80it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 175.99it/s]replace nan value:  79%|███████▉  | 436/553 [00:02<00:00, 177.36it/s]replace nan value:  82%|████████▏ | 455/553 [00:02<00:00, 179.58it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 181.33it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 179.06it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 180.07it/s]replace nan value:  96%|█████████▌| 531/553 [00:03<00:00, 179.28it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 178.55it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 176.82it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.46it/s]  5%|▍         | 27/553 [00:00<00:03, 133.96it/s]  7%|▋         | 41/553 [00:00<00:03, 132.85it/s] 10%|▉         | 55/553 [00:00<00:04, 123.17it/s] 12%|█▏        | 68/553 [00:00<00:04, 111.68it/s] 15%|█▍        | 82/553 [00:00<00:03, 119.14it/s] 17%|█▋        | 96/553 [00:00<00:03, 122.88it/s] 20%|█▉        | 109/553 [00:00<00:03, 124.57it/s] 22%|██▏       | 124/553 [00:00<00:03, 129.85it/s] 25%|██▌       | 140/553 [00:01<00:03, 137.47it/s] 29%|██▊       | 158/553 [00:01<00:02, 148.11it/s] 31%|███▏      | 174/553 [00:01<00:02, 146.32it/s] 34%|███▍      | 189/553 [00:01<00:02, 145.62it/s] 37%|███▋      | 207/553 [00:01<00:02, 153.83it/s] 40%|████      | 223/553 [00:01<00:02, 143.90it/s] 43%|████▎     | 239/553 [00:01<00:02, 147.06it/s] 46%|████▌     | 254/553 [00:01<00:02, 139.85it/s] 49%|████▊     | 269/553 [00:01<00:02, 139.80it/s] 51%|█████▏    | 284/553 [00:02<00:01, 135.52it/s] 54%|█████▍    | 298/553 [00:02<00:01, 132.66it/s] 56%|█████▋    | 312/553 [00:02<00:01, 128.79it/s] 59%|█████▉    | 326/553 [00:02<00:01, 130.81it/s] 61%|██████▏   | 340/553 [00:02<00:01, 132.42it/s] 64%|██████▍   | 354/553 [00:02<00:01, 128.89it/s] 66%|██████▋   | 367/553 [00:02<00:01, 128.44it/s] 69%|██████▉   | 382/553 [00:02<00:01, 134.51it/s] 72%|███████▏  | 396/553 [00:02<00:01, 122.37it/s] 74%|███████▍  | 409/553 [00:03<00:01, 124.15it/s] 76%|███████▋  | 422/553 [00:03<00:01, 119.85it/s] 79%|███████▊  | 435/553 [00:03<00:01, 116.73it/s] 82%|████████▏ | 453/553 [00:03<00:00, 129.04it/s] 85%|████████▍ | 469/553 [00:03<00:00, 136.34it/s] 87%|████████▋ | 483/553 [00:03<00:00, 133.72it/s] 90%|████████▉ | 497/553 [00:03<00:00, 124.55it/s] 93%|█████████▎| 512/553 [00:03<00:00, 129.97it/s] 95%|█████████▌| 526/553 [00:04<00:00, 115.77it/s] 97%|█████████▋| 538/553 [00:04<00:00, 113.36it/s]100%|█████████▉| 551/553 [00:04<00:00, 101.52it/s]100%|██████████| 553/553 [00:04<00:00, 127.86it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 339.15it/s]extract the null data:  71%|███████   | 99/139 [00:00<00:00, 521.50it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 532.33it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 217.45it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 212.10it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 208.36it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 212.12it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 212.61it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 213.07it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 212.75it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 125.65it/s] 21%|██        | 29/139 [00:00<00:00, 133.27it/s] 32%|███▏      | 45/139 [00:00<00:00, 142.48it/s] 43%|████▎     | 60/139 [00:00<00:00, 126.37it/s] 53%|█████▎    | 74/139 [00:00<00:00, 126.63it/s] 63%|██████▎   | 87/139 [00:00<00:00, 114.97it/s] 73%|███████▎  | 101/139 [00:00<00:00, 120.41it/s] 82%|████████▏ | 114/139 [00:00<00:00, 121.46it/s] 92%|█████████▏| 128/139 [00:01<00:00, 125.27it/s]100%|██████████| 139/139 [00:01<00:00, 126.09it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 279.12it/s]extract the null data:  55%|█████▍    | 95/173 [00:00<00:00, 507.35it/s]extract the null data:  90%|█████████ | 156/173 [00:00<00:00, 550.51it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 520.41it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 211.14it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 211.59it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 206.05it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 208.42it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 209.22it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 206.62it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 206.67it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 204.93it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.77it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 136.84it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.89it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.97it/s] 34%|███▍      | 59/173 [00:00<00:00, 139.99it/s] 43%|████▎     | 74/173 [00:00<00:00, 138.39it/s] 51%|█████     | 88/173 [00:00<00:00, 135.78it/s] 59%|█████▉    | 102/173 [00:00<00:00, 136.72it/s] 68%|██████▊   | 117/173 [00:00<00:00, 138.52it/s] 76%|███████▌  | 131/173 [00:00<00:00, 129.81it/s] 84%|████████▍ | 145/173 [00:01<00:00, 129.87it/s] 92%|█████████▏| 159/173 [00:01<00:00, 120.21it/s] 99%|█████████▉| 172/173 [00:01<00:00, 91.49it/s] 100%|██████████| 173/173 [00:01<00:00, 118.49it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.051, valid loss : 0.027, train acc : 0.644, valid acc : 0.311, train f1 : 0.626, valid f1 : 0.295
training process:   1%|          | 1/128 [00:59<2:05:39, 59.37s/it]Best score increase :0.000 -> 0.295
training process:   2%|▏         | 2/128 [01:48<1:51:38, 53.17s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:36<1:45:59, 50.88s/it]Best score increase :0.295 -> 0.301
training process:   3%|▎         | 4/128 [03:25<1:43:22, 50.02s/it]Best score increase :0.301 -> 0.315
epoch : 5, train loss : 0.023, valid loss : 0.029, train acc : 0.668, valid acc : 0.348, train f1 : 0.631, valid f1 : 0.326
training process:   4%|▍         | 5/128 [04:22<1:47:54, 52.64s/it]Best score increase :0.315 -> 0.326
training process:   5%|▍         | 6/128 [05:11<1:44:23, 51.34s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:02<1:43:35, 51.37s/it]Best score increase :0.326 -> 0.383
training process:   6%|▋         | 8/128 [06:51<1:41:19, 50.67s/it]Best score increase :0.383 -> 0.398
epoch : 9, train loss : 0.019, valid loss : 0.026, train acc : 0.738, valid acc : 0.457, train f1 : 0.718, valid f1 : 0.406
training process:   7%|▋         | 9/128 [07:48<1:44:14, 52.56s/it]Best score increase :0.398 -> 0.406
training process:   8%|▊         | 10/128 [08:37<1:41:24, 51.57s/it]Best score increase :0.406 -> 0.417
training process:   9%|▊         | 11/128 [09:30<1:41:27, 52.03s/it]Best score increase :0.417 -> 0.424
training process:   9%|▉         | 12/128 [10:19<1:38:34, 50.99s/it]Best score increase :0.424 -> 0.434
epoch : 13, train loss : 0.018, valid loss : 0.025, train acc : 0.770, valid acc : 0.503, train f1 : 0.758, valid f1 : 0.438
training process:  10%|█         | 13/128 [11:21<1:44:03, 54.29s/it]Best score increase :0.434 -> 0.438
training process:  11%|█         | 14/128 [12:11<1:40:46, 53.04s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [12:59<1:36:50, 51.42s/it]Best score increase :0.438 -> 0.490
training process:  12%|█▎        | 16/128 [13:49<1:35:19, 51.06s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.016, valid loss : 0.025, train acc : 0.794, valid acc : 0.508, train f1 : 0.786, valid f1 : 0.442
training process:  13%|█▎        | 17/128 [14:48<1:39:09, 53.60s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [15:41<1:37:46, 53.33s/it]Best score increase :0.490 -> 0.500
training process:  15%|█▍        | 19/128 [16:34<1:36:38, 53.20s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [17:27<1:35:30, 53.06s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.015, valid loss : 0.023, train acc : 0.823, valid acc : 0.598, train f1 : 0.818, valid f1 : 0.504
training process:  16%|█▋        | 21/128 [18:28<1:39:07, 55.59s/it]Best score increase :0.500 -> 0.504
training process:  17%|█▋        | 22/128 [19:19<1:35:54, 54.29s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [20:12<1:33:51, 53.64s/it]Best score increase :0.504 -> 0.548
training process:  19%|█▉        | 24/128 [21:02<1:31:05, 52.55s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.014, valid loss : 0.024, train acc : 0.831, valid acc : 0.582, train f1 : 0.827, valid f1 : 0.492
training process:  20%|█▉        | 25/128 [22:00<1:33:20, 54.38s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [22:52<1:30:57, 53.51s/it]Best score increase :0.548 -> 0.562
training process:  21%|██        | 27/128 [23:42<1:28:21, 52.49s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:31<1:25:58, 51.59s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.014, valid loss : 0.023, train acc : 0.843, valid acc : 0.644, train f1 : 0.838, valid f1 : 0.535
training process:  23%|██▎       | 29/128 [25:30<1:28:27, 53.61s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [26:19<1:25:41, 52.47s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [27:10<1:23:47, 51.83s/it]Best score increase :0.562 -> 0.575
training process:  25%|██▌       | 32/128 [28:01<1:22:45, 51.73s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.013, valid loss : 0.023, train acc : 0.854, valid acc : 0.719, train f1 : 0.851, valid f1 : 0.591
training process:  26%|██▌       | 33/128 [29:05<1:27:29, 55.26s/it]Best score increase :0.575 -> 0.591
training process:  27%|██▋       | 34/128 [29:56<1:24:39, 54.04s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [30:46<1:21:49, 52.79s/it]Best score increase :0.591 -> 0.608
training process:  28%|██▊       | 36/128 [31:35<1:19:17, 51.71s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.012, valid loss : 0.025, train acc : 0.861, valid acc : 0.663, train f1 : 0.859, valid f1 : 0.548
training process:  29%|██▉       | 37/128 [32:34<1:21:31, 53.75s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [33:23<1:18:45, 52.51s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [34:12<1:16:25, 51.52s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [35:02<1:14:41, 50.92s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.012, valid loss : 0.027, train acc : 0.867, valid acc : 0.737, train f1 : 0.865, valid f1 : 0.604
training process:  32%|███▏      | 41/128 [36:00<1:17:03, 53.15s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [36:49<1:14:25, 51.92s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [37:37<1:11:46, 50.66s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [38:25<1:09:58, 49.99s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.011, valid loss : 0.029, train acc : 0.874, valid acc : 0.766, train f1 : 0.872, valid f1 : 0.627
training process:  35%|███▌      | 45/128 [39:23<1:12:05, 52.11s/it]Best score increase :0.608 -> 0.627
training process:  36%|███▌      | 46/128 [40:11<1:09:34, 50.91s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [40:57<1:07:05, 49.69s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [41:46<1:05:44, 49.31s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.011, valid loss : 0.030, train acc : 0.879, valid acc : 0.722, train f1 : 0.878, valid f1 : 0.593
training process:  38%|███▊      | 49/128 [42:44<1:08:17, 51.87s/it]EarlyStopping counter : 4 out of 12
training process:  39%|███▉      | 50/128 [43:31<1:05:47, 50.60s/it]EarlyStopping counter : 5 out of 12
training process:  40%|███▉      | 51/128 [44:19<1:03:57, 49.83s/it]EarlyStopping counter : 6 out of 12
training process:  41%|████      | 52/128 [45:09<1:02:51, 49.63s/it]EarlyStopping counter : 7 out of 12
epoch : 53, train loss : 0.011, valid loss : 0.030, train acc : 0.886, valid acc : 0.750, train f1 : 0.884, valid f1 : 0.614
training process:  41%|████▏     | 53/128 [46:05<1:04:37, 51.69s/it]EarlyStopping counter : 8 out of 12
training process:  42%|████▏     | 54/128 [46:55<1:03:03, 51.13s/it]EarlyStopping counter : 9 out of 12
training process:  43%|████▎     | 55/128 [47:44<1:01:32, 50.58s/it]Best score increase :0.627 -> 0.635
training process:  44%|████▍     | 56/128 [48:32<59:32, 49.62s/it]  EarlyStopping counter : 1 out of 12
epoch : 57, train loss : 0.010, valid loss : 0.040, train acc : 0.888, valid acc : 0.749, train f1 : 0.887, valid f1 : 0.614
training process:  45%|████▍     | 57/128 [49:31<1:02:14, 52.60s/it]EarlyStopping counter : 2 out of 12
training process:  45%|████▌     | 58/128 [50:19<59:41, 51.17s/it]  EarlyStopping counter : 3 out of 12
training process:  46%|████▌     | 59/128 [51:12<59:25, 51.68s/it]EarlyStopping counter : 4 out of 12
training process:  47%|████▋     | 60/128 [52:00<57:24, 50.66s/it]EarlyStopping counter : 5 out of 12
epoch : 61, train loss : 0.010, valid loss : 0.043, train acc : 0.897, valid acc : 0.771, train f1 : 0.896, valid f1 : 0.632
training process:  48%|████▊     | 61/128 [52:59<59:10, 52.99s/it]EarlyStopping counter : 6 out of 12
training process:  48%|████▊     | 62/128 [53:52<58:22, 53.07s/it]EarlyStopping counter : 7 out of 12
training process:  49%|████▉     | 63/128 [54:39<55:35, 51.32s/it]EarlyStopping counter : 8 out of 12
training process:  50%|█████     | 64/128 [55:28<53:54, 50.54s/it]Best score increase :0.635 -> 0.657
epoch : 65, train loss : 0.010, valid loss : 0.039, train acc : 0.897, valid acc : 0.748, train f1 : 0.896, valid f1 : 0.613
training process:  51%|█████     | 65/128 [56:27<55:48, 53.15s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [57:14<53:09, 51.44s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [58:06<52:26, 51.58s/it]EarlyStopping counter : 3 out of 12
training process:  53%|█████▎    | 68/128 [58:56<50:59, 50.99s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.009, valid loss : 0.036, train acc : 0.902, valid acc : 0.776, train f1 : 0.902, valid f1 : 0.637
training process:  54%|█████▍    | 69/128 [59:57<53:05, 53.98s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▍    | 70/128 [1:00:44<50:14, 51.97s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▌    | 71/128 [1:01:31<47:59, 50.51s/it]EarlyStopping counter : 7 out of 12
training process:  56%|█████▋    | 72/128 [1:02:22<47:15, 50.64s/it]Best score increase :0.657 -> 0.669
epoch : 73, train loss : 0.009, valid loss : 0.031, train acc : 0.899, valid acc : 0.767, train f1 : 0.898, valid f1 : 0.629
training process:  57%|█████▋    | 73/128 [1:03:19<48:04, 52.44s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:04:10<46:46, 51.97s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:04:57<44:45, 50.66s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▉    | 76/128 [1:05:46<43:16, 49.94s/it]Best score increase :0.669 -> 0.682
epoch : 77, train loss : 0.009, valid loss : 0.045, train acc : 0.904, valid acc : 0.798, train f1 : 0.903, valid f1 : 0.657
training process:  60%|██████    | 77/128 [1:06:43<44:18, 52.12s/it]EarlyStopping counter : 1 out of 12
training process:  61%|██████    | 78/128 [1:07:30<42:10, 50.62s/it]EarlyStopping counter : 2 out of 12
training process:  62%|██████▏   | 79/128 [1:08:17<40:29, 49.58s/it]EarlyStopping counter : 3 out of 12
training process:  62%|██████▎   | 80/128 [1:09:05<39:11, 48.99s/it]EarlyStopping counter : 4 out of 12
epoch : 81, train loss : 0.009, valid loss : 0.044, train acc : 0.910, valid acc : 0.726, train f1 : 0.909, valid f1 : 0.594
training process:  63%|██████▎   | 81/128 [1:09:59<39:43, 50.71s/it]EarlyStopping counter : 5 out of 12
training process:  64%|██████▍   | 82/128 [1:10:48<38:21, 50.04s/it]EarlyStopping counter : 6 out of 12
training process:  65%|██████▍   | 83/128 [1:11:41<38:12, 50.95s/it]EarlyStopping counter : 7 out of 12
training process:  66%|██████▌   | 84/128 [1:12:35<38:06, 51.98s/it]EarlyStopping counter : 8 out of 12
epoch : 85, train loss : 0.009, valid loss : 0.034, train acc : 0.905, valid acc : 0.745, train f1 : 0.904, valid f1 : 0.611
training process:  66%|██████▋   | 85/128 [1:13:39<39:40, 55.35s/it]EarlyStopping counter : 9 out of 12
training process:  67%|██████▋   | 86/128 [1:14:33<38:31, 55.04s/it]EarlyStopping counter : 10 out of 12
training process:  68%|██████▊   | 87/128 [1:15:27<37:27, 54.81s/it]EarlyStopping counter : 11 out of 12
training process:  68%|██████▊   | 87/128 [1:16:19<35:58, 52.64s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 87, best f1 score : 0.682
training process finished, best loss : 0.044 and best acc : 0.824, best f1 : 0.682, best epoch : 75

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.32      0.90      0.47       580
           1       0.99      0.84      0.91      6818

    accuracy                           0.84      7398
   macro avg       0.65      0.87      0.69      7398
weighted avg       0.94      0.84      0.87      7398


# test acc : 0.84, test f1 : 0.69, test AUC : 0.87, test loss : 0.964

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:34,  8.59s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:24,  8.46s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.11s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:02,  7.86s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.82s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:47,  7.95s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:40,  8.13s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:32,  8.15s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:24,  8.13s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:16,  8.18s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:29<00:08,  8.10s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  7.87s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.03s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 20/306 [00:00<00:01, 193.53it/s] 13%|█▎        | 40/306 [00:00<00:01, 143.45it/s] 22%|██▏       | 68/306 [00:00<00:01, 193.76it/s] 29%|██▉       | 89/306 [00:00<00:01, 155.07it/s] 38%|███▊      | 116/306 [00:00<00:01, 185.36it/s] 45%|████▍     | 137/306 [00:00<00:01, 158.02it/s] 54%|█████▍    | 166/306 [00:00<00:00, 187.96it/s] 61%|██████    | 187/306 [00:01<00:00, 172.64it/s] 67%|██████▋   | 206/306 [00:01<00:00, 173.11it/s] 76%|███████▌  | 233/306 [00:01<00:00, 196.53it/s] 83%|████████▎ | 254/306 [00:01<00:00, 165.76it/s] 92%|█████████▏| 280/306 [00:01<00:00, 188.11it/s] 98%|█████████▊| 301/306 [00:01<00:00, 160.83it/s]100%|██████████| 306/306 [00:01<00:00, 172.42it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 575.73it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 550.63it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:00, 582.08it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 593.61it/s]extract the null data:  55%|█████▍    | 303/553 [00:00<00:00, 600.76it/s]extract the null data:  66%|██████▌   | 364/553 [00:00<00:00, 599.59it/s]extract the null data:  77%|███████▋  | 424/553 [00:00<00:00, 587.87it/s]extract the null data:  88%|████████▊ | 485/553 [00:00<00:00, 593.23it/s]extract the null data:  99%|█████████▊| 545/553 [00:00<00:00, 591.38it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 589.76it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 200.85it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 201.85it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:02, 199.68it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 200.13it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 202.16it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 204.86it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:01, 205.65it/s]replace nan value:  31%|███       | 169/553 [00:00<00:01, 206.93it/s]replace nan value:  34%|███▍      | 190/553 [00:00<00:01, 206.25it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:01, 209.19it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:01, 209.66it/s]replace nan value:  46%|████▋     | 256/553 [00:01<00:01, 210.98it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 208.88it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 208.51it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 207.59it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 209.52it/s]replace nan value:  66%|██████▌   | 363/553 [00:01<00:00, 207.51it/s]replace nan value:  69%|██████▉   | 384/553 [00:01<00:00, 203.44it/s]replace nan value:  73%|███████▎  | 405/553 [00:01<00:00, 198.87it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 194.37it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 192.42it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 192.70it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 197.14it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 198.98it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 200.53it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 200.05it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 202.49it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.73it/s]  5%|▌         | 29/553 [00:00<00:03, 141.56it/s]  8%|▊         | 44/553 [00:00<00:03, 133.35it/s] 10%|█         | 58/553 [00:00<00:04, 123.54it/s] 13%|█▎        | 71/553 [00:00<00:03, 122.41it/s] 16%|█▌        | 88/553 [00:00<00:03, 136.90it/s] 18%|█▊        | 102/553 [00:00<00:03, 131.50it/s] 22%|██▏       | 120/553 [00:00<00:03, 144.33it/s] 24%|██▍       | 135/553 [00:00<00:02, 142.47it/s] 28%|██▊       | 153/553 [00:01<00:02, 152.19it/s] 31%|███       | 171/553 [00:01<00:02, 159.85it/s] 34%|███▍      | 188/553 [00:01<00:02, 154.85it/s] 38%|███▊      | 208/553 [00:01<00:02, 165.12it/s] 41%|████      | 225/553 [00:01<00:02, 156.77it/s] 44%|████▎     | 241/553 [00:01<00:01, 157.19it/s] 46%|████▋     | 257/553 [00:01<00:01, 151.50it/s] 49%|████▉     | 273/553 [00:01<00:01, 145.76it/s] 52%|█████▏    | 289/553 [00:01<00:01, 149.41it/s] 55%|█████▌    | 305/553 [00:02<00:01, 141.41it/s] 58%|█████▊    | 320/553 [00:02<00:01, 133.39it/s] 61%|██████    | 335/553 [00:02<00:01, 136.16it/s] 63%|██████▎   | 349/553 [00:02<00:01, 135.69it/s] 66%|██████▌   | 363/553 [00:02<00:01, 133.65it/s] 68%|██████▊   | 378/553 [00:02<00:01, 137.06it/s] 71%|███████   | 392/553 [00:02<00:01, 126.73it/s] 73%|███████▎  | 406/553 [00:02<00:01, 128.82it/s] 76%|███████▌  | 420/553 [00:03<00:01, 126.83it/s] 78%|███████▊  | 433/553 [00:03<00:00, 123.72it/s] 82%|████████▏ | 452/553 [00:03<00:00, 141.51it/s] 84%|████████▍ | 467/553 [00:03<00:00, 139.46it/s] 87%|████████▋ | 482/553 [00:03<00:00, 130.82it/s] 90%|████████▉ | 496/553 [00:03<00:00, 117.32it/s] 92%|█████████▏| 510/553 [00:03<00:00, 121.23it/s] 95%|█████████▍| 523/553 [00:03<00:00, 116.53it/s] 97%|█████████▋| 535/553 [00:03<00:00, 110.99it/s]100%|█████████▉| 551/553 [00:04<00:00, 104.51it/s]100%|██████████| 553/553 [00:04<00:00, 133.40it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 32/139 [00:00<00:00, 318.31it/s]extract the null data:  71%|███████   | 99/139 [00:00<00:00, 522.94it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 532.46it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 221.55it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 216.63it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 216.97it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 218.77it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 216.27it/s]replace nan value:  97%|█████████▋| 135/139 [00:00<00:00, 216.03it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 216.47it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 138.79it/s] 21%|██        | 29/139 [00:00<00:00, 144.18it/s] 34%|███▍      | 47/139 [00:00<00:00, 156.23it/s] 45%|████▌     | 63/139 [00:00<00:00, 145.68it/s] 56%|█████▌    | 78/139 [00:00<00:00, 142.72it/s] 67%|██████▋   | 93/139 [00:00<00:00, 133.98it/s] 78%|███████▊  | 108/139 [00:00<00:00, 137.88it/s] 91%|█████████ | 126/139 [00:00<00:00, 146.79it/s]100%|██████████| 139/139 [00:00<00:00, 145.31it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 236.79it/s]extract the null data:  54%|█████▍    | 93/173 [00:00<00:00, 500.87it/s]extract the null data:  93%|█████████▎| 161/173 [00:00<00:00, 581.20it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 536.96it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 228.48it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 229.67it/s]replace nan value:  40%|████      | 70/173 [00:00<00:00, 228.65it/s]replace nan value:  54%|█████▍    | 93/173 [00:00<00:00, 225.15it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 226.50it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 224.27it/s]replace nan value:  94%|█████████▎| 162/173 [00:00<00:00, 222.33it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 223.42it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 137.20it/s] 16%|█▌        | 28/173 [00:00<00:01, 131.16it/s] 26%|██▌       | 45/173 [00:00<00:00, 147.41it/s] 36%|███▌      | 62/173 [00:00<00:00, 155.52it/s] 45%|████▌     | 78/173 [00:00<00:00, 155.83it/s] 54%|█████▍    | 94/173 [00:00<00:00, 156.45it/s] 65%|██████▍   | 112/173 [00:00<00:00, 161.94it/s] 75%|███████▍  | 129/173 [00:00<00:00, 152.32it/s] 84%|████████▍ | 145/173 [00:00<00:00, 149.01it/s] 92%|█████████▏| 160/173 [00:01<00:00, 137.98it/s]100%|██████████| 173/173 [00:01<00:00, 134.89it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.087, valid loss : 0.065, train f1 : 0.573, valid f1 : 0.591
training process - Deferred Re-weighting:   1%|          | 1/128 [01:00<2:08:33, 60.73s/it]Best score increase :0.000 -> 0.591
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:51<1:54:36, 54.58s/it]Best score increase :0.591 -> 0.638
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:42<1:50:39, 53.11s/it]Best score increase :0.638 -> 0.687
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:39<1:53:20, 54.84s/it]Best score increase :0.687 -> 0.705
epoch : 5, train loss : 0.048, valid loss : 0.056, train f1 : 0.717, valid f1 : 0.702
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:41<1:57:39, 57.39s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:34<1:53:47, 55.96s/it]Best score increase :0.705 -> 0.727
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:30<1:52:48, 55.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:28<1:53:06, 56.56s/it]Best score increase :0.727 -> 0.731
epoch : 9, train loss : 0.043, valid loss : 0.053, train f1 : 0.753, valid f1 : 0.715
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:31<1:56:06, 58.54s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:25<1:52:15, 57.08s/it]Best score increase :0.731 -> 0.736
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:16<1:47:27, 55.11s/it]Best score increase :0.736 -> 0.739
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:05<1:42:58, 53.27s/it]Best score increase :0.739 -> 0.746
epoch : 13, train loss : 0.039, valid loss : 0.053, train f1 : 0.775, valid f1 : 0.735
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:02<1:44:35, 54.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:55<1:42:32, 53.97s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:53<1:43:54, 55.17s/it]Best score increase :0.746 -> 0.762
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:48<1:43:06, 55.23s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.037, valid loss : 0.050, train f1 : 0.793, valid f1 : 0.769
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:53<1:47:19, 58.01s/it]Best score increase :0.762 -> 0.769
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:51<1:46:45, 58.24s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:48<1:45:08, 57.88s/it]Best score increase :0.769 -> 0.781
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:38<1:39:53, 55.49s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.035, valid loss : 0.049, train f1 : 0.812, valid f1 : 0.775
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:35<1:39:33, 55.83s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:28<1:36:54, 54.85s/it]Best score increase :0.781 -> 0.789
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:22<1:35:52, 54.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:15<1:34:05, 54.29s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.032, valid loss : 0.052, train f1 : 0.825, valid f1 : 0.790
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:17<1:37:10, 56.61s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:12<1:35:22, 56.10s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:09<1:34:49, 56.33s/it]Best score increase :0.789 -> 0.792
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [26:04<1:33:08, 55.89s/it]Best score increase :0.792 -> 0.800
epoch : 29, train loss : 0.030, valid loss : 0.050, train f1 : 0.841, valid f1 : 0.797
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:04<1:34:17, 57.14s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:58<1:31:41, 56.14s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:47<1:27:35, 54.18s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:37<1:24:29, 52.81s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.029, valid loss : 0.052, train f1 : 0.846, valid f1 : 0.798
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [30:41<1:28:53, 56.14s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [31:34<1:26:17, 55.08s/it]Best score increase :0.800 -> 0.805
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [32:28<1:24:55, 54.79s/it]Best score increase :0.805 -> 0.809
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [33:27<1:26:05, 56.15s/it]Best score increase :0.809 -> 0.820
epoch : 37, train loss : 0.027, valid loss : 0.052, train f1 : 0.866, valid f1 : 0.797
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [34:28<1:27:27, 57.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [35:27<1:26:56, 57.96s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [36:20<1:23:50, 56.52s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [37:11<1:20:34, 54.94s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.026, valid loss : 0.050, train f1 : 0.868, valid f1 : 0.813
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [38:09<1:20:53, 55.79s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [38:59<1:17:29, 54.06s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [39:59<1:19:03, 55.81s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:53<1:17:33, 55.40s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.025, valid loss : 0.051, train f1 : 0.873, valid f1 : 0.802
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [42:02<1:22:16, 59.48s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [42:58<1:19:53, 58.46s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [43:51<1:16:40, 56.80s/it]Best score increase :0.820 -> 0.842
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [44:49<1:15:56, 56.96s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.024, valid loss : 0.054, train f1 : 0.881, valid f1 : 0.826
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [45:49<1:16:20, 57.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [46:37<1:11:32, 55.03s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [47:26<1:08:12, 53.15s/it]Best score increase :0.842 -> 0.845
training process - Deferred Re-weighting:  41%|████      | 52/128 [48:23<1:08:46, 54.30s/it]EarlyStopping counter : 1 out of 12
epoch : 53, train loss : 0.023, valid loss : 0.053, train f1 : 0.888, valid f1 : 0.823
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [49:28<1:11:45, 57.40s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [50:25<1:10:36, 57.26s/it]Best score increase :0.845 -> 0.850
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [51:20<1:08:55, 56.66s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [52:13<1:06:38, 55.53s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.022, valid loss : 0.053, train f1 : 0.892, valid f1 : 0.838
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [53:18<1:09:08, 58.43s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [54:16<1:07:55, 58.23s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [55:08<1:04:59, 56.51s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [55:57<1:01:34, 54.34s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.020, valid loss : 0.055, train f1 : 0.901, valid f1 : 0.846
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [56:56<1:02:08, 55.65s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [57:51<1:01:04, 55.52s/it]Best score increase :0.850 -> 0.852
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [58:46<59:54, 55.29s/it]  EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [59:39<58:08, 54.51s/it]Best score increase :0.852 -> 0.859
epoch : 65, train loss : 0.020, valid loss : 0.063, train f1 : 0.904, valid f1 : 0.849
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:00:45<1:00:54, 58.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:01:43<59:53, 57.96s/it]  EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:02:37<57:52, 56.93s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:03:31<55:53, 55.90s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.020, valid loss : 0.057, train f1 : 0.904, valid f1 : 0.855
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:04:39<58:28, 59.46s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:05:31<55:20, 57.25s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:06:22<52:39, 55.42s/it]Best score increase :0.859 -> 0.864
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:07:12<50:19, 53.92s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.018, valid loss : 0.059, train f1 : 0.915, valid f1 : 0.854
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:08:16<52:04, 56.81s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:09:12<50:57, 56.62s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:10:11<50:31, 57.20s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:11:05<48:58, 56.51s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.018, valid loss : 0.060, train f1 : 0.914, valid f1 : 0.825
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:12:11<50:24, 59.29s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:13:09<49:01, 58.84s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  62%|██████▏   | 79/128 [1:14:03<46:44, 57.24s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  62%|██████▎   | 80/128 [1:14:55<44:41, 55.86s/it]EarlyStopping counter : 9 out of 12
epoch : 81, train loss : 0.017, valid loss : 0.070, train f1 : 0.920, valid f1 : 0.847
training process - Deferred Re-weighting:  63%|██████▎   | 81/128 [1:15:55<44:36, 56.96s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  64%|██████▍   | 82/128 [1:16:46<42:28, 55.41s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  64%|██████▍   | 82/128 [1:17:39<43:33, 56.82s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 82, best f1 score : 0.864
training process finished, best loss : 0.057, best acc : 0.962, best f1 : 0.864, best epoch : 70

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.74      0.64      0.69       580
           1       0.97      0.98      0.98      6818

    accuracy                           0.95      7398
   macro avg       0.85      0.81      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.81, test loss : 4.597

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.73s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:14,  7.48s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.48s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.59s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.67s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:46,  7.72s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.71s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.72s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.78s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.66s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.65s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.59s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.64s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 25/306 [00:00<00:01, 243.96it/s] 18%|█▊        | 55/306 [00:00<00:00, 275.19it/s] 27%|██▋       | 83/306 [00:00<00:01, 173.91it/s] 35%|███▍      | 107/306 [00:00<00:01, 191.62it/s] 42%|████▏     | 129/306 [00:00<00:01, 161.76it/s] 51%|█████     | 155/306 [00:00<00:00, 185.73it/s] 58%|█████▊    | 176/306 [00:00<00:00, 174.82it/s] 64%|██████▎   | 195/306 [00:01<00:00, 165.16it/s] 72%|███████▏  | 220/306 [00:01<00:00, 185.83it/s] 78%|███████▊  | 240/306 [00:01<00:00, 156.02it/s] 87%|████████▋ | 265/306 [00:01<00:00, 176.52it/s] 93%|█████████▎| 285/306 [00:01<00:00, 150.91it/s]100%|██████████| 306/306 [00:01<00:00, 178.47it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_Focal_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 61/553 [00:00<00:00, 604.66it/s]extract the null data:  22%|██▏       | 122/553 [00:00<00:00, 546.92it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 559.51it/s]extract the null data:  44%|████▍     | 243/553 [00:00<00:00, 585.27it/s]extract the null data:  55%|█████▍    | 302/553 [00:00<00:00, 581.11it/s]extract the null data:  65%|██████▌   | 361/553 [00:00<00:00, 570.76it/s]extract the null data:  76%|███████▌  | 419/553 [00:00<00:00, 566.44it/s]extract the null data:  86%|████████▌ | 476/553 [00:00<00:00, 552.95it/s]extract the null data:  96%|█████████▌| 532/553 [00:00<00:00, 542.28it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 560.25it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 201.46it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 192.43it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 190.65it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 192.40it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 193.58it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 197.40it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 199.26it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:01, 197.73it/s]replace nan value:  33%|███▎      | 184/553 [00:00<00:01, 196.80it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:01, 197.60it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 198.25it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 203.02it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 199.52it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 195.04it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 193.35it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:01, 194.67it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:00, 206.49it/s]replace nan value:  68%|██████▊   | 376/553 [00:01<00:00, 216.64it/s]replace nan value:  72%|███████▏  | 398/553 [00:01<00:00, 208.09it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 201.49it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 200.18it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 197.15it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 199.02it/s]replace nan value:  91%|█████████ | 502/553 [00:02<00:00, 198.80it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 194.03it/s]replace nan value:  98%|█████████▊| 542/553 [00:02<00:00, 195.72it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 198.85it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.26it/s]  5%|▌         | 29/553 [00:00<00:03, 144.32it/s]  8%|▊         | 44/553 [00:00<00:03, 134.52it/s] 10%|█         | 58/553 [00:00<00:04, 122.72it/s] 13%|█▎        | 71/553 [00:00<00:03, 122.58it/s] 16%|█▌        | 87/553 [00:00<00:03, 133.48it/s] 18%|█▊        | 101/553 [00:00<00:03, 128.23it/s] 22%|██▏       | 120/553 [00:00<00:03, 143.22it/s] 24%|██▍       | 135/553 [00:00<00:02, 140.61it/s] 28%|██▊       | 153/553 [00:01<00:02, 150.65it/s] 31%|███       | 172/553 [00:01<00:02, 160.64it/s] 34%|███▍      | 189/553 [00:01<00:02, 156.67it/s] 38%|███▊      | 208/553 [00:01<00:02, 165.51it/s] 41%|████      | 225/553 [00:01<00:02, 156.01it/s] 44%|████▎     | 241/553 [00:01<00:02, 154.37it/s] 46%|████▋     | 257/553 [00:01<00:01, 148.76it/s] 49%|████▉     | 272/553 [00:01<00:01, 145.41it/s] 52%|█████▏    | 289/553 [00:01<00:01, 149.94it/s] 55%|█████▌    | 305/553 [00:02<00:01, 141.09it/s] 58%|█████▊    | 320/553 [00:02<00:01, 132.37it/s] 61%|██████    | 335/553 [00:02<00:01, 136.20it/s] 63%|██████▎   | 349/553 [00:02<00:01, 136.94it/s] 66%|██████▌   | 363/553 [00:02<00:01, 135.24it/s] 68%|██████▊   | 378/553 [00:02<00:01, 138.26it/s] 71%|███████   | 392/553 [00:02<00:01, 127.93it/s] 73%|███████▎  | 405/553 [00:02<00:01, 128.13it/s] 76%|███████▌  | 418/553 [00:02<00:01, 126.46it/s] 78%|███████▊  | 431/553 [00:03<00:00, 124.13it/s] 81%|████████▏ | 450/553 [00:03<00:00, 142.16it/s] 84%|████████▍ | 465/553 [00:03<00:00, 143.22it/s] 87%|████████▋ | 480/553 [00:03<00:00, 139.30it/s] 90%|████████▉ | 495/553 [00:03<00:00, 133.03it/s] 93%|█████████▎| 512/553 [00:03<00:00, 140.44it/s] 95%|█████████▌| 527/553 [00:03<00:00, 124.45it/s] 98%|█████████▊| 540/553 [00:03<00:00, 125.23it/s]100%|██████████| 553/553 [00:04<00:00, 109.25it/s]100%|██████████| 553/553 [00:04<00:00, 135.93it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 338.82it/s]extract the null data:  76%|███████▋  | 106/139 [00:00<00:00, 559.43it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 559.99it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 202.67it/s]replace nan value:  31%|███       | 43/139 [00:00<00:00, 212.56it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 219.12it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 218.12it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 218.76it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 221.26it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 218.00it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.05it/s] 19%|█▉        | 27/139 [00:00<00:00, 132.13it/s] 32%|███▏      | 44/139 [00:00<00:00, 147.93it/s] 42%|████▏     | 59/139 [00:00<00:00, 135.10it/s] 54%|█████▍    | 75/139 [00:00<00:00, 141.76it/s] 65%|██████▍   | 90/139 [00:00<00:00, 124.49it/s] 76%|███████▌  | 105/139 [00:00<00:00, 128.28it/s] 88%|████████▊ | 122/139 [00:00<00:00, 138.45it/s] 99%|█████████▊| 137/139 [00:01<00:00, 136.06it/s]100%|██████████| 139/139 [00:01<00:00, 135.07it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 307.78it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 460.43it/s]extract the null data:  83%|████████▎ | 143/173 [00:00<00:00, 500.31it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 489.27it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 207.33it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 211.47it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 212.83it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 209.49it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 211.41it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 215.45it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 211.85it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 210.26it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 139.21it/s] 17%|█▋        | 29/173 [00:00<00:01, 124.51it/s] 27%|██▋       | 47/173 [00:00<00:00, 147.43it/s] 37%|███▋      | 64/173 [00:00<00:00, 155.80it/s] 46%|████▌     | 80/173 [00:00<00:00, 151.60it/s] 55%|█████▌    | 96/173 [00:00<00:00, 153.84it/s] 65%|██████▌   | 113/173 [00:00<00:00, 158.68it/s] 75%|███████▍  | 129/173 [00:00<00:00, 153.34it/s] 84%|████████▍ | 145/173 [00:00<00:00, 150.42it/s] 93%|█████████▎| 161/173 [00:01<00:00, 136.63it/s]100%|██████████| 173/173 [00:01<00:00, 133.99it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.108, train f1 : 0.725, valid f1 : 0.674
training process - Deferred Re-weighting:   1%|          | 1/128 [00:58<2:04:13, 58.69s/it]Best score increase :0.000 -> 0.674
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:45<1:48:30, 51.67s/it]Best score increase :0.674 -> 0.704
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:31<1:42:15, 49.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:20<1:41:17, 49.01s/it]EarlyStopping counter : 2 out of 12
epoch : 5, train loss : 0.097, valid loss : 0.103, train f1 : 0.832, valid f1 : 0.697
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:16<1:46:02, 51.73s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:03<1:41:42, 50.02s/it]Best score increase :0.704 -> 0.711
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:51<1:39:30, 49.34s/it]Best score increase :0.711 -> 0.716
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:37<1:36:19, 48.17s/it]Best score increase :0.716 -> 0.721
epoch : 9, train loss : 0.083, valid loss : 0.101, train f1 : 0.863, valid f1 : 0.713
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:34<1:40:54, 50.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:23<1:39:04, 50.38s/it]Best score increase :0.721 -> 0.750
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:11<1:36:51, 49.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [09:58<1:34:47, 49.03s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.075, valid loss : 0.092, train f1 : 0.878, valid f1 : 0.712
training process - Deferred Re-weighting:  10%|█         | 13/128 [10:58<1:40:19, 52.35s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [11:55<1:41:54, 53.64s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:52<1:43:03, 54.72s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:50<1:43:39, 55.53s/it]EarlyStopping counter : 6 out of 12
epoch : 17, train loss : 0.069, valid loss : 0.093, train f1 : 0.890, valid f1 : 0.714
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:56<1:48:59, 58.91s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:54<1:47:18, 58.53s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:46<1:42:39, 56.51s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:38<1:39:17, 55.16s/it]EarlyStopping counter : 10 out of 12
epoch : 21, train loss : 0.061, valid loss : 0.088, train f1 : 0.905, valid f1 : 0.737
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:38<1:41:12, 56.76s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:30<1:39:23, 55.74s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 21, best f1 score : 0.750
training process finished, best loss : 0.084, best acc : 0.899, best f1 : 0.750, best epoch : 9

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.40      0.76      0.53       580
           1       0.98      0.90      0.94      6818

    accuracy                           0.89      7398
   macro avg       0.69      0.83      0.73      7398
weighted avg       0.93      0.89      0.91      7398


# test acc : 0.89, test f1 : 0.73, test AUC : 0.83, test loss : 5.394

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.20s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.26s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.05s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.04s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:55,  7.95s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:47,  7.94s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:39,  8.00s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.85s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.76s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.78s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.81s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.90s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 26/306 [00:00<00:01, 235.99it/s] 16%|█▋        | 50/306 [00:00<00:01, 157.40it/s] 30%|███       | 92/306 [00:00<00:00, 247.69it/s] 40%|███▉      | 121/306 [00:00<00:00, 252.23it/s] 49%|████▊     | 149/306 [00:00<00:00, 201.03it/s] 56%|█████▌    | 172/306 [00:00<00:00, 207.60it/s] 64%|██████▎   | 195/306 [00:00<00:00, 177.42it/s] 72%|███████▏  | 219/306 [00:01<00:00, 190.88it/s] 78%|███████▊  | 240/306 [00:01<00:00, 164.97it/s] 86%|████████▋ | 264/306 [00:01<00:00, 181.80it/s] 93%|█████████▎| 284/306 [00:01<00:00, 156.23it/s]100%|██████████| 306/306 [00:01<00:00, 190.35it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 61/553 [00:00<00:00, 601.06it/s]extract the null data:  23%|██▎       | 125/553 [00:00<00:00, 623.16it/s]extract the null data:  35%|███▍      | 191/553 [00:00<00:00, 635.40it/s]extract the null data:  46%|████▋     | 257/553 [00:00<00:00, 641.50it/s]extract the null data:  58%|█████▊    | 323/553 [00:00<00:00, 644.74it/s]extract the null data:  70%|███████   | 389/553 [00:00<00:00, 648.08it/s]extract the null data:  82%|████████▏ | 454/553 [00:00<00:00, 644.83it/s]extract the null data:  94%|█████████▍| 519/553 [00:00<00:00, 641.53it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 638.64it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 204.98it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 206.94it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:02, 203.55it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 209.10it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 213.61it/s]replace nan value:  24%|██▎       | 131/553 [00:00<00:01, 216.92it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:01, 218.34it/s]replace nan value:  32%|███▏      | 177/553 [00:00<00:01, 219.39it/s]replace nan value:  36%|███▌      | 199/553 [00:00<00:01, 219.40it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 219.48it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 219.24it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 216.76it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 216.73it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 215.68it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:01, 215.66it/s]replace nan value:  64%|██████▍   | 353/553 [00:01<00:00, 214.73it/s]replace nan value:  68%|██████▊   | 376/553 [00:01<00:00, 216.79it/s]replace nan value:  72%|███████▏  | 399/553 [00:01<00:00, 217.88it/s]replace nan value:  76%|███████▌  | 421/553 [00:01<00:00, 217.80it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 217.75it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 216.87it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 216.48it/s]replace nan value:  92%|█████████▏| 509/553 [00:02<00:00, 216.73it/s]replace nan value:  96%|█████████▌| 531/553 [00:02<00:00, 217.68it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 218.31it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 216.36it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 141.30it/s]  6%|▌         | 31/553 [00:00<00:03, 151.73it/s]  8%|▊         | 47/553 [00:00<00:03, 128.97it/s] 11%|█         | 61/553 [00:00<00:03, 125.92it/s] 14%|█▎        | 76/553 [00:00<00:03, 133.26it/s] 16%|█▋        | 91/553 [00:00<00:03, 134.89it/s] 19%|█▉        | 106/553 [00:00<00:03, 138.60it/s] 22%|██▏       | 122/553 [00:00<00:03, 142.80it/s] 25%|██▌       | 140/553 [00:00<00:02, 151.29it/s] 29%|██▉       | 160/553 [00:01<00:02, 163.17it/s] 32%|███▏      | 177/553 [00:01<00:02, 163.98it/s] 35%|███▌      | 194/553 [00:01<00:02, 165.33it/s] 38%|███▊      | 212/553 [00:01<00:02, 169.40it/s] 41%|████▏     | 229/553 [00:01<00:02, 154.94it/s] 44%|████▍     | 245/553 [00:01<00:02, 152.22it/s] 47%|████▋     | 262/553 [00:01<00:01, 157.03it/s] 50%|█████     | 278/553 [00:01<00:01, 149.77it/s] 53%|█████▎    | 294/553 [00:01<00:01, 145.01it/s] 56%|█████▌    | 309/553 [00:02<00:01, 141.99it/s] 59%|█████▊    | 324/553 [00:02<00:01, 140.15it/s] 61%|██████▏   | 339/553 [00:02<00:01, 141.73it/s] 64%|██████▍   | 354/553 [00:02<00:01, 139.35it/s] 67%|██████▋   | 368/553 [00:02<00:01, 139.37it/s] 69%|██████▉   | 384/553 [00:02<00:01, 142.86it/s] 72%|███████▏  | 399/553 [00:02<00:01, 124.79it/s] 75%|███████▌  | 415/553 [00:02<00:01, 132.79it/s] 78%|███████▊  | 429/553 [00:03<00:00, 124.59it/s] 81%|████████  | 448/553 [00:03<00:00, 141.29it/s] 84%|████████▍ | 464/553 [00:03<00:00, 146.02it/s] 87%|████████▋ | 479/553 [00:03<00:00, 144.67it/s] 89%|████████▉ | 494/553 [00:03<00:00, 137.95it/s] 92%|█████████▏| 510/553 [00:03<00:00, 142.51it/s] 95%|█████████▍| 525/553 [00:03<00:00, 129.24it/s] 97%|█████████▋| 539/553 [00:03<00:00, 125.44it/s]100%|█████████▉| 552/553 [00:03<00:00, 113.47it/s]100%|██████████| 553/553 [00:03<00:00, 139.61it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 416.39it/s]extract the null data:  81%|████████▏ | 113/139 [00:00<00:00, 586.65it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 584.22it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 237.31it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 238.38it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 238.07it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 236.46it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 237.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 237.41it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:01, 125.62it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.37it/s] 32%|███▏      | 44/139 [00:00<00:00, 142.54it/s] 42%|████▏     | 59/139 [00:00<00:00, 130.91it/s] 54%|█████▍    | 75/139 [00:00<00:00, 136.88it/s] 64%|██████▍   | 89/139 [00:00<00:00, 126.90it/s] 76%|███████▌  | 105/139 [00:00<00:00, 134.37it/s] 88%|████████▊ | 122/139 [00:00<00:00, 144.41it/s] 99%|█████████▊| 137/139 [00:00<00:00, 145.89it/s]100%|██████████| 139/139 [00:00<00:00, 139.18it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 288.50it/s]extract the null data:  58%|█████▊    | 100/173 [00:00<00:00, 535.25it/s]extract the null data:  98%|█████████▊| 170/173 [00:00<00:00, 606.60it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 563.17it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 229.99it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 232.86it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 233.49it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 233.73it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 234.32it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 235.32it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 233.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 233.37it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 143.06it/s] 17%|█▋        | 30/173 [00:00<00:01, 127.19it/s] 27%|██▋       | 46/173 [00:00<00:00, 140.10it/s] 36%|███▌      | 62/173 [00:00<00:00, 145.10it/s] 45%|████▍     | 77/173 [00:00<00:00, 142.33it/s] 53%|█████▎    | 92/173 [00:00<00:00, 141.49it/s] 62%|██████▏   | 107/173 [00:00<00:00, 141.61it/s] 71%|███████   | 122/173 [00:00<00:00, 140.12it/s] 79%|███████▉  | 137/173 [00:00<00:00, 136.65it/s] 87%|████████▋ | 151/173 [00:01<00:00, 131.99it/s] 95%|█████████▌| 165/173 [00:01<00:00, 119.34it/s]100%|██████████| 173/173 [00:01<00:00, 122.88it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.007, train acc : 0.868, valid acc : 0.926, train f1 : 0.592, valid f1 : 0.607
training process:   1%|          | 1/128 [01:03<2:13:43, 63.18s/it]Best score increase :0.000 -> 0.607
training process:   2%|▏         | 2/128 [01:54<1:58:17, 56.33s/it]Best score increase :0.607 -> 0.626
training process:   2%|▏         | 3/128 [02:54<2:00:31, 57.85s/it]Best score increase :0.626 -> 0.668
training process:   3%|▎         | 4/128 [03:49<1:57:34, 56.89s/it]Best score increase :0.668 -> 0.688
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.937, valid acc : 0.935, train f1 : 0.704, valid f1 : 0.695
training process:   4%|▍         | 5/128 [04:48<1:58:19, 57.72s/it]Best score increase :0.688 -> 0.695
training process:   5%|▍         | 6/128 [05:48<1:58:48, 58.43s/it]Best score increase :0.695 -> 0.721
training process:   5%|▌         | 7/128 [06:38<1:52:05, 55.58s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:27<1:47:05, 53.55s/it]Best score increase :0.721 -> 0.722
epoch : 9, train loss : 0.003, valid loss : 0.004, train acc : 0.942, valid acc : 0.937, train f1 : 0.740, valid f1 : 0.712
training process:   7%|▋         | 9/128 [08:26<1:49:39, 55.29s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:22<1:48:45, 55.30s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [10:12<1:44:44, 53.71s/it]Best score increase :0.722 -> 0.738
training process:   9%|▉         | 12/128 [11:10<1:46:25, 55.05s/it]Best score increase :0.738 -> 0.741
epoch : 13, train loss : 0.003, valid loss : 0.004, train acc : 0.946, valid acc : 0.938, train f1 : 0.762, valid f1 : 0.730
training process:  10%|█         | 13/128 [12:18<1:52:51, 58.88s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [13:19<1:53:05, 59.53s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [14:14<1:49:56, 58.38s/it]Best score increase :0.741 -> 0.755
training process:  12%|█▎        | 16/128 [15:03<1:43:37, 55.51s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.949, valid acc : 0.941, train f1 : 0.781, valid f1 : 0.753
training process:  13%|█▎        | 17/128 [16:01<1:43:48, 56.11s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [16:59<1:43:52, 56.66s/it]Best score increase :0.755 -> 0.758
training process:  15%|█▍        | 19/128 [17:59<1:44:48, 57.69s/it]Best score increase :0.758 -> 0.770
training process:  16%|█▌        | 20/128 [18:59<1:45:21, 58.53s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train acc : 0.953, valid acc : 0.943, train f1 : 0.801, valid f1 : 0.772
training process:  16%|█▋        | 21/128 [20:09<1:50:21, 61.88s/it]Best score increase :0.770 -> 0.772
training process:  17%|█▋        | 22/128 [21:05<1:46:22, 60.21s/it]Best score increase :0.772 -> 0.776
training process:  18%|█▊        | 23/128 [22:00<1:42:30, 58.58s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:50<1:37:19, 56.14s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.003, valid loss : 0.003, train acc : 0.954, valid acc : 0.942, train f1 : 0.812, valid f1 : 0.766
training process:  20%|█▉        | 25/128 [23:49<1:37:46, 56.95s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [24:49<1:38:27, 57.92s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [25:50<1:38:55, 58.77s/it]Best score increase :0.776 -> 0.780
training process:  22%|██▏       | 28/128 [26:51<1:38:47, 59.28s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.957, valid acc : 0.944, train f1 : 0.825, valid f1 : 0.782
training process:  23%|██▎       | 29/128 [27:59<1:42:12, 61.95s/it]Best score increase :0.780 -> 0.782
training process:  23%|██▎       | 30/128 [28:56<1:38:39, 60.40s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [29:45<1:32:31, 57.24s/it]EarlyStopping counter : 2 out of 12
training process:  25%|██▌       | 32/128 [30:36<1:28:18, 55.19s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.959, valid acc : 0.944, train f1 : 0.833, valid f1 : 0.784
training process:  26%|██▌       | 33/128 [31:41<1:32:11, 58.22s/it]Best score increase :0.782 -> 0.784
training process:  27%|██▋       | 34/128 [32:41<1:31:54, 58.67s/it]Best score increase :0.784 -> 0.786
training process:  27%|██▋       | 35/128 [33:36<1:29:11, 57.54s/it]Best score increase :0.786 -> 0.787
training process:  28%|██▊       | 36/128 [34:36<1:29:28, 58.36s/it]Best score increase :0.787 -> 0.795
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.944, train f1 : 0.841, valid f1 : 0.781
training process:  29%|██▉       | 37/128 [35:44<1:32:46, 61.17s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [36:39<1:29:16, 59.52s/it]Best score increase :0.795 -> 0.799
training process:  30%|███       | 39/128 [37:31<1:24:38, 57.06s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [38:21<1:20:42, 55.03s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.962, valid acc : 0.947, train f1 : 0.852, valid f1 : 0.792
training process:  32%|███▏      | 41/128 [39:31<1:26:03, 59.35s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [40:32<1:25:54, 59.94s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [41:28<1:23:10, 58.71s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [42:29<1:23:17, 59.49s/it]Best score increase :0.799 -> 0.809
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.963, valid acc : 0.948, train f1 : 0.853, valid f1 : 0.794
training process:  35%|███▌      | 45/128 [43:35<1:24:49, 61.32s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [44:31<1:21:54, 59.93s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [45:25<1:18:28, 58.13s/it]Best score increase :0.809 -> 0.827
training process:  38%|███▊      | 48/128 [46:18<1:15:24, 56.56s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.965, valid acc : 0.952, train f1 : 0.862, valid f1 : 0.821
training process:  38%|███▊      | 49/128 [47:20<1:16:38, 58.21s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [48:17<1:15:06, 57.77s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [49:08<1:11:40, 55.84s/it]EarlyStopping counter : 4 out of 12
training process:  41%|████      | 52/128 [50:00<1:09:00, 54.48s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train acc : 0.966, valid acc : 0.952, train f1 : 0.869, valid f1 : 0.812
training process:  41%|████▏     | 53/128 [51:00<1:10:25, 56.33s/it]EarlyStopping counter : 6 out of 12
training process:  42%|████▏     | 54/128 [51:53<1:08:14, 55.34s/it]Best score increase :0.827 -> 0.840
training process:  43%|████▎     | 55/128 [52:45<1:06:00, 54.25s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [53:38<1:04:32, 53.79s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.954, train f1 : 0.876, valid f1 : 0.826
training process:  45%|████▍     | 57/128 [54:39<1:06:10, 55.93s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [55:31<1:04:01, 54.88s/it]EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [56:23<1:02:07, 54.03s/it]EarlyStopping counter : 5 out of 12
training process:  47%|████▋     | 60/128 [57:18<1:01:23, 54.17s/it]Best score increase :0.840 -> 0.847
epoch : 61, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.954, train f1 : 0.878, valid f1 : 0.833
training process:  48%|████▊     | 61/128 [58:21<1:03:32, 56.90s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 62/128 [59:16<1:01:54, 56.28s/it]EarlyStopping counter : 2 out of 12
training process:  49%|████▉     | 63/128 [1:00:11<1:00:42, 56.04s/it]EarlyStopping counter : 3 out of 12
training process:  50%|█████     | 64/128 [1:01:03<58:33, 54.89s/it]  EarlyStopping counter : 4 out of 12
epoch : 65, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.956, train f1 : 0.885, valid f1 : 0.843
training process:  51%|█████     | 65/128 [1:02:02<58:54, 56.10s/it]EarlyStopping counter : 5 out of 12
training process:  52%|█████▏    | 66/128 [1:02:56<57:07, 55.28s/it]EarlyStopping counter : 6 out of 12
training process:  52%|█████▏    | 67/128 [1:03:49<55:36, 54.70s/it]EarlyStopping counter : 7 out of 12
training process:  53%|█████▎    | 68/128 [1:04:44<54:46, 54.77s/it]EarlyStopping counter : 8 out of 12
epoch : 69, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.955, train f1 : 0.885, valid f1 : 0.837
training process:  54%|█████▍    | 69/128 [1:05:45<55:48, 56.75s/it]EarlyStopping counter : 9 out of 12
training process:  55%|█████▍    | 70/128 [1:06:41<54:28, 56.36s/it]EarlyStopping counter : 10 out of 12
training process:  55%|█████▌    | 71/128 [1:07:33<52:25, 55.18s/it]EarlyStopping counter : 11 out of 12
training process:  56%|█████▋    | 72/128 [1:08:24<50:15, 53.84s/it]Best score increase :0.847 -> 0.853
epoch : 73, train loss : 0.002, valid loss : 0.003, train acc : 0.971, valid acc : 0.955, train f1 : 0.891, valid f1 : 0.831
training process:  57%|█████▋    | 73/128 [1:09:24<51:08, 55.79s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:10:16<49:14, 54.72s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:11:09<47:46, 54.08s/it]Best score increase :0.853 -> 0.854
training process:  59%|█████▉    | 76/128 [1:12:04<47:05, 54.33s/it]EarlyStopping counter : 1 out of 12
epoch : 77, train loss : 0.002, valid loss : 0.003, train acc : 0.971, valid acc : 0.952, train f1 : 0.891, valid f1 : 0.823
training process:  60%|██████    | 77/128 [1:13:06<48:09, 56.66s/it]EarlyStopping counter : 2 out of 12
training process:  61%|██████    | 78/128 [1:13:59<46:17, 55.55s/it]EarlyStopping counter : 3 out of 12
training process:  62%|██████▏   | 79/128 [1:14:53<45:02, 55.15s/it]EarlyStopping counter : 4 out of 12
training process:  62%|██████▎   | 80/128 [1:15:44<43:08, 53.94s/it]EarlyStopping counter : 5 out of 12
epoch : 81, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.957, train f1 : 0.897, valid f1 : 0.842
training process:  63%|██████▎   | 81/128 [1:16:44<43:33, 55.61s/it]EarlyStopping counter : 6 out of 12
training process:  64%|██████▍   | 82/128 [1:17:37<42:08, 54.96s/it]Best score increase :0.854 -> 0.856
training process:  65%|██████▍   | 83/128 [1:18:31<41:01, 54.70s/it]EarlyStopping counter : 1 out of 12
training process:  66%|██████▌   | 84/128 [1:19:22<39:14, 53.52s/it]EarlyStopping counter : 2 out of 12
epoch : 85, train loss : 0.001, valid loss : 0.003, train acc : 0.972, valid acc : 0.958, train f1 : 0.894, valid f1 : 0.846
training process:  66%|██████▋   | 85/128 [1:20:26<40:38, 56.70s/it]EarlyStopping counter : 3 out of 12
training process:  67%|██████▋   | 86/128 [1:21:19<38:48, 55.44s/it]EarlyStopping counter : 4 out of 12
training process:  68%|██████▊   | 87/128 [1:22:11<37:19, 54.63s/it]EarlyStopping counter : 5 out of 12
training process:  69%|██████▉   | 88/128 [1:23:02<35:35, 53.38s/it]EarlyStopping counter : 6 out of 12
epoch : 89, train loss : 0.002, valid loss : 0.003, train acc : 0.973, valid acc : 0.958, train f1 : 0.898, valid f1 : 0.846
training process:  70%|██████▉   | 89/128 [1:24:03<36:10, 55.67s/it]EarlyStopping counter : 7 out of 12
training process:  70%|███████   | 90/128 [1:24:56<34:40, 54.76s/it]EarlyStopping counter : 8 out of 12
training process:  71%|███████   | 91/128 [1:25:47<33:08, 53.74s/it]EarlyStopping counter : 9 out of 12
training process:  72%|███████▏  | 92/128 [1:26:39<31:52, 53.13s/it]EarlyStopping counter : 10 out of 12
epoch : 93, train loss : 0.001, valid loss : 0.003, train acc : 0.973, valid acc : 0.959, train f1 : 0.897, valid f1 : 0.858
training process:  73%|███████▎  | 93/128 [1:27:41<32:39, 56.00s/it]Best score increase :0.856 -> 0.858
training process:  73%|███████▎  | 94/128 [1:28:34<31:08, 54.97s/it]EarlyStopping counter : 1 out of 12
training process:  74%|███████▍  | 95/128 [1:29:24<29:24, 53.48s/it]EarlyStopping counter : 2 out of 12
training process:  75%|███████▌  | 96/128 [1:30:15<28:11, 52.87s/it]EarlyStopping counter : 3 out of 12
epoch : 97, train loss : 0.001, valid loss : 0.003, train acc : 0.974, valid acc : 0.959, train f1 : 0.903, valid f1 : 0.854
training process:  76%|███████▌  | 97/128 [1:31:19<28:57, 56.04s/it]EarlyStopping counter : 4 out of 12
training process:  77%|███████▋  | 98/128 [1:32:13<27:42, 55.43s/it]EarlyStopping counter : 5 out of 12
training process:  77%|███████▋  | 99/128 [1:33:07<26:37, 55.07s/it]EarlyStopping counter : 6 out of 12
training process:  78%|███████▊  | 100/128 [1:34:02<25:37, 54.91s/it]EarlyStopping counter : 7 out of 12
epoch : 101, train loss : 0.001, valid loss : 0.003, train acc : 0.972, valid acc : 0.960, train f1 : 0.897, valid f1 : 0.858
training process:  79%|███████▉  | 101/128 [1:35:03<25:35, 56.86s/it]EarlyStopping counter : 8 out of 12
training process:  80%|███████▉  | 102/128 [1:35:53<23:46, 54.87s/it]Best score increase :0.858 -> 0.860
training process:  80%|████████  | 103/128 [1:36:47<22:44, 54.58s/it]EarlyStopping counter : 1 out of 12
training process:  81%|████████▏ | 104/128 [1:37:41<21:42, 54.29s/it]EarlyStopping counter : 2 out of 12
epoch : 105, train loss : 0.001, valid loss : 0.003, train acc : 0.975, valid acc : 0.959, train f1 : 0.905, valid f1 : 0.854
training process:  82%|████████▏ | 105/128 [1:38:41<21:27, 55.96s/it]EarlyStopping counter : 3 out of 12
training process:  83%|████████▎ | 106/128 [1:39:35<20:19, 55.41s/it]EarlyStopping counter : 4 out of 12
training process:  84%|████████▎ | 107/128 [1:40:27<19:02, 54.42s/it]EarlyStopping counter : 5 out of 12
training process:  84%|████████▍ | 108/128 [1:41:19<17:55, 53.75s/it]EarlyStopping counter : 6 out of 12
epoch : 109, train loss : 0.001, valid loss : 0.003, train acc : 0.974, valid acc : 0.958, train f1 : 0.903, valid f1 : 0.848
training process:  85%|████████▌ | 109/128 [1:42:20<17:44, 56.02s/it]EarlyStopping counter : 7 out of 12
training process:  86%|████████▌ | 110/128 [1:43:11<16:17, 54.29s/it]EarlyStopping counter : 8 out of 12
training process:  87%|████████▋ | 111/128 [1:44:04<15:17, 53.95s/it]EarlyStopping counter : 9 out of 12
training process:  88%|████████▊ | 112/128 [1:44:57<14:18, 53.67s/it]EarlyStopping counter : 10 out of 12
epoch : 113, train loss : 0.001, valid loss : 0.003, train acc : 0.975, valid acc : 0.958, train f1 : 0.906, valid f1 : 0.846
training process:  88%|████████▊ | 113/128 [1:45:55<13:45, 55.04s/it]EarlyStopping counter : 11 out of 12
training process:  88%|████████▊ | 113/128 [1:46:47<14:10, 56.71s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 113, best f1 score : 0.860
training process finished, best loss : 0.003 and best acc : 0.960, best f1 : 0.860, best epoch : 101

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.58      0.68      0.63       580
           1       0.97      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.82      0.80      7398
weighted avg       0.94      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.80, test AUC : 0.82, test loss : 0.314

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:17,  7.09s/it]processing for feature importance:  17%|█▋        | 2/12 [00:13<01:09,  6.97s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:03,  7.10s/it]processing for feature importance:  33%|███▎      | 4/12 [00:28<00:57,  7.20s/it]processing for feature importance:  42%|████▏     | 5/12 [00:35<00:50,  7.15s/it]processing for feature importance:  50%|█████     | 6/12 [00:43<00:43,  7.23s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:50<00:35,  7.15s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:57<00:29,  7.30s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:04<00:21,  7.32s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:12<00:14,  7.23s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:19<00:07,  7.20s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.18s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.19s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 120.02it/s] 11%|█         | 33/306 [00:00<00:01, 163.65it/s] 16%|█▋        | 50/306 [00:00<00:02, 120.65it/s] 21%|██        | 64/306 [00:00<00:02, 108.82it/s] 28%|██▊       | 87/306 [00:00<00:01, 140.96it/s] 34%|███▎      | 103/306 [00:00<00:01, 131.91it/s] 42%|████▏     | 129/306 [00:00<00:01, 165.10it/s] 48%|████▊     | 147/306 [00:01<00:01, 126.84it/s] 53%|█████▎    | 162/306 [00:01<00:01, 131.58it/s] 60%|█████▉    | 183/306 [00:01<00:00, 147.90it/s] 65%|██████▌   | 200/306 [00:01<00:00, 144.33it/s] 72%|███████▏  | 219/306 [00:01<00:00, 152.33it/s] 77%|███████▋  | 235/306 [00:01<00:00, 122.97it/s] 83%|████████▎ | 253/306 [00:01<00:00, 134.94it/s] 90%|████████▉ | 275/306 [00:01<00:00, 153.62it/s] 95%|█████████▌| 292/306 [00:02<00:00, 146.84it/s]100%|██████████| 306/306 [00:02<00:00, 142.91it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█▏        | 63/553 [00:00<00:00, 629.85it/s]extract the null data:  24%|██▍       | 133/553 [00:00<00:00, 666.04it/s]extract the null data:  36%|███▌      | 200/553 [00:00<00:00, 665.59it/s]extract the null data:  48%|████▊     | 267/553 [00:00<00:00, 660.76it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 662.47it/s]extract the null data:  73%|███████▎  | 401/553 [00:00<00:00, 660.13it/s]extract the null data:  85%|████████▍ | 468/553 [00:00<00:00, 663.21it/s]extract the null data:  97%|█████████▋| 536/553 [00:00<00:00, 668.11it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 664.02it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:02, 227.71it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 222.57it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 223.95it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 222.12it/s]replace nan value:  21%|██        | 115/553 [00:00<00:01, 224.78it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:01, 229.69it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:01, 233.36it/s]replace nan value:  34%|███▍      | 188/553 [00:00<00:01, 230.41it/s]replace nan value:  38%|███▊      | 212/553 [00:00<00:01, 230.30it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 226.01it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 223.51it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 226.05it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 225.48it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:00, 225.12it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:00, 226.16it/s]replace nan value:  68%|██████▊   | 375/553 [00:01<00:00, 225.17it/s]replace nan value:  72%|███████▏  | 398/553 [00:01<00:00, 222.85it/s]replace nan value:  76%|███████▌  | 421/553 [00:01<00:00, 223.82it/s]replace nan value:  81%|████████  | 446/553 [00:01<00:00, 229.67it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 229.37it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 228.24it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 228.03it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 224.66it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 226.11it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 148.42it/s]  6%|▌         | 32/553 [00:00<00:03, 159.42it/s]  9%|▊         | 48/553 [00:00<00:03, 132.62it/s] 11%|█         | 62/553 [00:00<00:03, 131.33it/s] 14%|█▍        | 77/553 [00:00<00:03, 136.46it/s] 17%|█▋        | 93/553 [00:00<00:03, 139.55it/s] 20%|█▉        | 109/553 [00:00<00:03, 143.12it/s] 23%|██▎       | 125/553 [00:00<00:02, 145.81it/s] 26%|██▌       | 144/553 [00:00<00:02, 156.77it/s] 29%|██▉       | 163/553 [00:01<00:02, 165.12it/s] 33%|███▎      | 181/553 [00:01<00:02, 167.23it/s] 36%|███▌      | 200/553 [00:01<00:02, 172.26it/s] 39%|███▉      | 218/553 [00:01<00:01, 169.78it/s] 43%|████▎     | 236/553 [00:01<00:01, 166.22it/s] 46%|████▌     | 253/553 [00:01<00:01, 159.10it/s] 49%|████▊     | 269/553 [00:01<00:01, 154.71it/s] 52%|█████▏    | 285/553 [00:01<00:01, 151.98it/s] 54%|█████▍    | 301/553 [00:01<00:01, 148.88it/s] 57%|█████▋    | 316/553 [00:02<00:01, 142.87it/s] 60%|█████▉    | 331/553 [00:02<00:01, 143.40it/s] 63%|██████▎   | 346/553 [00:02<00:01, 144.77it/s] 65%|██████▌   | 361/553 [00:02<00:01, 138.48it/s] 68%|██████▊   | 378/553 [00:02<00:01, 145.61it/s] 71%|███████   | 393/553 [00:02<00:01, 136.44it/s] 74%|███████▍  | 408/553 [00:02<00:01, 140.03it/s] 76%|███████▋  | 423/553 [00:02<00:00, 134.46it/s] 79%|███████▉  | 437/553 [00:02<00:00, 134.95it/s] 82%|████████▏ | 455/553 [00:03<00:00, 146.42it/s] 85%|████████▌ | 471/553 [00:03<00:00, 150.02it/s] 88%|████████▊ | 487/553 [00:03<00:00, 147.69it/s] 91%|█████████ | 502/553 [00:03<00:00, 140.42it/s] 94%|█████████▍| 519/553 [00:03<00:00, 145.63it/s] 97%|█████████▋| 534/553 [00:03<00:00, 126.11it/s]100%|█████████▉| 551/553 [00:03<00:00, 116.84it/s]100%|██████████| 553/553 [00:03<00:00, 143.60it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 369.66it/s]extract the null data:  81%|████████▏ | 113/139 [00:00<00:00, 595.97it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 585.45it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 243.44it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 243.41it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 243.35it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 247.34it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 249.62it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 247.09it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 131.93it/s] 21%|██        | 29/139 [00:00<00:00, 139.70it/s] 33%|███▎      | 46/139 [00:00<00:00, 150.11it/s] 45%|████▍     | 62/139 [00:00<00:00, 137.52it/s] 55%|█████▌    | 77/139 [00:00<00:00, 137.33it/s] 65%|██████▌   | 91/139 [00:00<00:00, 129.00it/s] 77%|███████▋  | 107/139 [00:00<00:00, 134.71it/s] 90%|████████▉ | 125/139 [00:00<00:00, 147.51it/s]100%|██████████| 139/139 [00:00<00:00, 142.47it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 376.61it/s]extract the null data:  65%|██████▍   | 112/173 [00:00<00:00, 587.87it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 607.01it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 247.26it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 244.82it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 243.34it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 244.97it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 247.51it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 247.91it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 245.37it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 146.39it/s] 17%|█▋        | 30/173 [00:00<00:01, 133.66it/s] 28%|██▊       | 48/173 [00:00<00:00, 149.33it/s] 38%|███▊      | 65/173 [00:00<00:00, 151.78it/s] 47%|████▋     | 81/173 [00:00<00:00, 154.47it/s] 56%|█████▌    | 97/173 [00:00<00:00, 155.88it/s] 66%|██████▌   | 114/173 [00:00<00:00, 158.78it/s] 75%|███████▌  | 130/173 [00:00<00:00, 149.78it/s] 84%|████████▍ | 146/173 [00:00<00:00, 143.68it/s] 93%|█████████▎| 161/173 [00:01<00:00, 132.39it/s]100%|██████████| 173/173 [00:01<00:00, 132.13it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.009, train acc : 0.715, valid acc : 0.791, train f1 : 0.715, valid f1 : 0.620
training process:   1%|          | 1/128 [01:02<2:12:29, 62.60s/it]Best score increase :0.000 -> 0.620
training process:   2%|▏         | 2/128 [01:55<1:59:45, 57.03s/it]Best score increase :0.620 -> 0.676
training process:   2%|▏         | 3/128 [02:47<1:53:48, 54.63s/it]Best score increase :0.676 -> 0.681
training process:   3%|▎         | 4/128 [03:38<1:49:34, 53.02s/it]Best score increase :0.681 -> 0.682
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.818, valid acc : 0.846, train f1 : 0.818, valid f1 : 0.686
training process:   4%|▍         | 5/128 [04:35<1:51:45, 54.51s/it]Best score increase :0.682 -> 0.686
training process:   5%|▍         | 6/128 [05:26<1:48:27, 53.34s/it]Best score increase :0.686 -> 0.699
training process:   5%|▌         | 7/128 [06:18<1:46:41, 52.91s/it]Best score increase :0.699 -> 0.708
training process:   6%|▋         | 8/128 [07:08<1:44:19, 52.16s/it]Best score increase :0.708 -> 0.712
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.850, valid acc : 0.854, train f1 : 0.850, valid f1 : 0.702
training process:   7%|▋         | 9/128 [08:11<1:50:11, 55.56s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:06<1:48:24, 55.13s/it]Best score increase :0.712 -> 0.717
training process:   9%|▊         | 11/128 [09:56<1:44:28, 53.58s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:46<1:41:37, 52.56s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.007, train acc : 0.869, valid acc : 0.850, train f1 : 0.869, valid f1 : 0.695
training process:  10%|█         | 13/128 [11:47<1:45:34, 55.09s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:56<1:52:32, 59.23s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [13:57<1:53:03, 60.03s/it]Best score increase :0.717 -> 0.722
training process:  12%|█▎        | 16/128 [15:00<1:53:22, 60.74s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.007, train acc : 0.877, valid acc : 0.842, train f1 : 0.877, valid f1 : 0.689
training process:  13%|█▎        | 17/128 [16:10<1:57:45, 63.65s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [17:05<1:51:31, 60.83s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [18:05<1:50:16, 60.71s/it]EarlyStopping counter : 4 out of 12
training process:  16%|█▌        | 20/128 [19:03<1:48:04, 60.04s/it]EarlyStopping counter : 5 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.006, train acc : 0.893, valid acc : 0.865, train f1 : 0.893, valid f1 : 0.716
training process:  16%|█▋        | 21/128 [20:04<1:47:31, 60.29s/it]EarlyStopping counter : 6 out of 12
training process:  17%|█▋        | 22/128 [20:58<1:42:56, 58.27s/it]EarlyStopping counter : 7 out of 12
training process:  18%|█▊        | 23/128 [21:53<1:40:18, 57.32s/it]Best score increase :0.722 -> 0.749
training process:  19%|█▉        | 24/128 [22:46<1:37:10, 56.06s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.006, train acc : 0.901, valid acc : 0.869, train f1 : 0.901, valid f1 : 0.721
training process:  20%|█▉        | 25/128 [23:50<1:40:24, 58.49s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [24:43<1:36:30, 56.77s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [25:34<1:32:28, 54.94s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [26:24<1:29:24, 53.64s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.006, train acc : 0.905, valid acc : 0.869, train f1 : 0.905, valid f1 : 0.726
training process:  23%|██▎       | 29/128 [27:28<1:33:35, 56.72s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [28:24<1:31:59, 56.32s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [29:19<1:30:50, 56.19s/it]Best score increase :0.749 -> 0.770
training process:  25%|██▌       | 32/128 [30:16<1:30:02, 56.27s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.005, train acc : 0.911, valid acc : 0.898, train f1 : 0.911, valid f1 : 0.760
training process:  26%|██▌       | 33/128 [31:18<1:31:41, 57.91s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [32:09<1:27:45, 56.01s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [33:05<1:26:45, 55.97s/it]EarlyStopping counter : 4 out of 12
training process:  28%|██▊       | 36/128 [34:00<1:25:25, 55.71s/it]EarlyStopping counter : 5 out of 12
epoch : 37, train loss : 0.004, valid loss : 0.006, train acc : 0.914, valid acc : 0.876, train f1 : 0.914, valid f1 : 0.732
training process:  29%|██▉       | 37/128 [35:02<1:27:16, 57.54s/it]EarlyStopping counter : 6 out of 12
training process:  30%|██▉       | 38/128 [35:59<1:26:00, 57.34s/it]EarlyStopping counter : 7 out of 12
training process:  30%|███       | 39/128 [36:52<1:23:21, 56.20s/it]EarlyStopping counter : 8 out of 12
training process:  31%|███▏      | 40/128 [37:44<1:20:33, 54.93s/it]EarlyStopping counter : 9 out of 12
epoch : 41, train loss : 0.004, valid loss : 0.005, train acc : 0.921, valid acc : 0.899, train f1 : 0.921, valid f1 : 0.764
training process:  32%|███▏      | 41/128 [38:47<1:23:07, 57.33s/it]EarlyStopping counter : 10 out of 12
training process:  33%|███▎      | 42/128 [39:41<1:20:34, 56.22s/it]EarlyStopping counter : 11 out of 12
training process:  33%|███▎      | 42/128 [40:35<1:23:07, 58.00s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 42, best f1 score : 0.770
training process finished, best loss : 0.005 and best acc : 0.906, best f1 : 0.770, best epoch : 30

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.45      0.80      0.58       580
           1       0.98      0.92      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.72      0.86      0.76      7398
weighted avg       0.94      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.76, test AUC : 0.86, test loss : 0.320

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.92s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  8.00s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.96s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.97s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:57,  8.25s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:49,  8.23s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:40,  8.11s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:32,  8.06s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:24,  8.14s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:16,  8.19s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:29<00:08,  8.18s/it]processing for feature importance: 100%|██████████| 12/12 [01:37<00:00,  8.20s/it]processing for feature importance: 100%|██████████| 12/12 [01:37<00:00,  8.14s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 115.91it/s] 10%|▉         | 30/306 [00:00<00:01, 153.03it/s] 16%|█▌        | 48/306 [00:00<00:01, 156.71it/s] 22%|██▏       | 66/306 [00:00<00:01, 163.44it/s] 29%|██▉       | 88/306 [00:00<00:01, 181.33it/s] 35%|███▍      | 107/306 [00:00<00:01, 167.40it/s] 42%|████▏     | 127/306 [00:00<00:01, 174.58it/s] 47%|████▋     | 145/306 [00:00<00:00, 168.53it/s] 54%|█████▍    | 165/306 [00:00<00:00, 176.96it/s] 60%|█████▉    | 183/306 [00:01<00:00, 164.87it/s] 67%|██████▋   | 205/306 [00:01<00:00, 179.75it/s] 73%|███████▎  | 224/306 [00:01<00:00, 167.89it/s] 79%|███████▉  | 242/306 [00:01<00:00, 170.60it/s] 85%|████████▍ | 260/306 [00:01<00:00, 160.40it/s] 91%|█████████ | 279/306 [00:01<00:00, 163.66it/s] 97%|█████████▋| 296/306 [00:01<00:00, 161.56it/s]100%|██████████| 306/306 [00:01<00:00, 169.28it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█▏        | 63/553 [00:00<00:00, 621.86it/s]extract the null data:  23%|██▎       | 128/553 [00:00<00:00, 635.28it/s]extract the null data:  35%|███▌      | 195/553 [00:00<00:00, 647.27it/s]extract the null data:  47%|████▋     | 262/553 [00:00<00:00, 654.83it/s]extract the null data:  59%|█████▉    | 329/553 [00:00<00:00, 658.16it/s]extract the null data:  72%|███████▏  | 396/553 [00:00<00:00, 658.94it/s]extract the null data:  84%|████████▍ | 465/553 [00:00<00:00, 667.90it/s]extract the null data:  97%|█████████▋| 535/553 [00:00<00:00, 675.63it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 661.98it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 215.48it/s]replace nan value:   8%|▊         | 44/553 [00:00<00:02, 216.82it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:02, 213.95it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 209.62it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 215.97it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:01, 219.69it/s]replace nan value:  28%|██▊       | 157/553 [00:00<00:01, 221.19it/s]replace nan value:  33%|███▎      | 181/553 [00:00<00:01, 224.85it/s]replace nan value:  37%|███▋      | 205/553 [00:00<00:01, 228.27it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 229.20it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 229.08it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:01, 228.89it/s]replace nan value:  54%|█████▍    | 298/553 [00:01<00:01, 228.36it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 227.35it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:00, 227.91it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 228.99it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 230.10it/s]replace nan value:  75%|███████▌  | 416/553 [00:01<00:00, 229.98it/s]replace nan value:  79%|███████▉  | 439/553 [00:01<00:00, 227.88it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 225.84it/s]replace nan value:  88%|████████▊ | 485/553 [00:02<00:00, 225.56it/s]replace nan value:  92%|█████████▏| 508/553 [00:02<00:00, 223.41it/s]replace nan value:  96%|█████████▌| 531/553 [00:02<00:00, 223.56it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 225.01it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 147.48it/s]  6%|▌         | 33/553 [00:00<00:03, 161.79it/s]  9%|▉         | 50/553 [00:00<00:03, 137.61it/s] 12%|█▏        | 65/553 [00:00<00:03, 131.30it/s] 14%|█▍        | 80/553 [00:00<00:03, 134.61it/s] 17%|█▋        | 96/553 [00:00<00:03, 141.75it/s] 20%|██        | 112/553 [00:00<00:03, 146.43it/s] 23%|██▎       | 127/553 [00:00<00:02, 143.96it/s] 27%|██▋       | 148/553 [00:00<00:02, 161.71it/s] 30%|███       | 167/553 [00:01<00:02, 168.36it/s] 33%|███▎      | 184/553 [00:01<00:02, 165.57it/s] 37%|███▋      | 203/553 [00:01<00:02, 172.44it/s] 40%|███▉      | 221/553 [00:01<00:02, 165.93it/s] 43%|████▎     | 239/553 [00:01<00:01, 167.66it/s] 46%|████▋     | 256/553 [00:01<00:01, 158.92it/s] 49%|████▉     | 273/553 [00:01<00:01, 156.25it/s] 52%|█████▏    | 290/553 [00:01<00:01, 159.23it/s] 56%|█████▌    | 307/553 [00:02<00:01, 144.20it/s] 58%|█████▊    | 322/553 [00:02<00:01, 142.86it/s] 61%|██████    | 338/553 [00:02<00:01, 146.65it/s] 64%|██████▍   | 353/553 [00:02<00:01, 145.95it/s] 67%|██████▋   | 368/553 [00:02<00:01, 143.71it/s] 69%|██████▉   | 384/553 [00:02<00:01, 147.14it/s] 72%|███████▏  | 399/553 [00:02<00:01, 128.73it/s] 75%|███████▌  | 416/553 [00:02<00:01, 134.73it/s] 78%|███████▊  | 430/553 [00:02<00:00, 130.83it/s] 82%|████████▏ | 451/553 [00:03<00:00, 149.12it/s] 85%|████████▍ | 469/553 [00:03<00:00, 155.77it/s] 88%|████████▊ | 485/553 [00:03<00:00, 149.35it/s] 91%|█████████ | 501/553 [00:03<00:00, 139.15it/s] 94%|█████████▎| 518/553 [00:03<00:00, 146.99it/s] 96%|█████████▋| 533/553 [00:03<00:00, 124.96it/s] 99%|█████████▉| 550/553 [00:03<00:00, 135.57it/s]100%|██████████| 553/553 [00:03<00:00, 144.11it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  28%|██▊       | 39/139 [00:00<00:00, 387.73it/s]extract the null data:  83%|████████▎ | 115/139 [00:00<00:00, 605.99it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 598.54it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▊        | 26/139 [00:00<00:00, 254.52it/s]replace nan value:  37%|███▋      | 52/139 [00:00<00:00, 251.69it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 253.75it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 252.50it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 252.06it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 251.88it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 131.71it/s] 21%|██        | 29/139 [00:00<00:00, 139.40it/s] 33%|███▎      | 46/139 [00:00<00:00, 151.03it/s] 45%|████▍     | 62/139 [00:00<00:00, 139.38it/s] 55%|█████▌    | 77/139 [00:00<00:00, 138.05it/s] 65%|██████▌   | 91/139 [00:00<00:00, 127.79it/s] 76%|███████▌  | 105/139 [00:00<00:00, 131.20it/s] 88%|████████▊ | 122/139 [00:00<00:00, 141.53it/s] 99%|█████████▊| 137/139 [00:00<00:00, 142.06it/s]100%|██████████| 139/139 [00:00<00:00, 139.44it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 379.76it/s]extract the null data:  65%|██████▌   | 113/173 [00:00<00:00, 596.38it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 608.15it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 240.63it/s]replace nan value:  29%|██▉       | 51/173 [00:00<00:00, 246.77it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 250.70it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 254.52it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 256.97it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 256.12it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 252.64it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 149.70it/s] 17%|█▋        | 30/173 [00:00<00:00, 144.28it/s] 29%|██▉       | 50/173 [00:00<00:00, 166.50it/s] 39%|███▊      | 67/173 [00:00<00:00, 165.01it/s] 49%|████▊     | 84/173 [00:00<00:00, 162.63it/s] 59%|█████▉    | 102/173 [00:00<00:00, 166.76it/s] 69%|██████▉   | 119/173 [00:00<00:00, 166.06it/s] 79%|███████▊  | 136/173 [00:00<00:00, 159.62it/s] 88%|████████▊ | 153/173 [00:00<00:00, 156.12it/s] 98%|█████████▊| 169/173 [00:01<00:00, 126.63it/s]100%|██████████| 173/173 [00:01<00:00, 143.40it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.645, valid acc : 0.689, train f1 : 0.512, valid f1 : 0.547
training process:   1%|          | 1/128 [01:02<2:11:51, 62.30s/it]Best score increase :0.000 -> 0.547
training process:   2%|▏         | 2/128 [01:55<1:59:51, 57.08s/it]Best score increase :0.547 -> 0.648
training process:   2%|▏         | 3/128 [02:46<1:52:36, 54.05s/it]Best score increase :0.648 -> 0.659
training process:   3%|▎         | 4/128 [03:33<1:46:30, 51.54s/it]Best score increase :0.659 -> 0.663
epoch : 5, train loss : 0.009, valid loss : 0.009, train acc : 0.832, valid acc : 0.855, train f1 : 0.662, valid f1 : 0.689
training process:   4%|▍         | 5/128 [04:31<1:50:23, 53.85s/it]Best score increase :0.663 -> 0.689
training process:   5%|▍         | 6/128 [05:21<1:46:56, 52.60s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:13<1:45:02, 52.09s/it]Best score increase :0.689 -> 0.715
training process:   6%|▋         | 8/128 [06:59<1:40:54, 50.45s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.008, valid loss : 0.008, train acc : 0.860, valid acc : 0.879, train f1 : 0.695, valid f1 : 0.718
training process:   7%|▋         | 9/128 [07:55<1:43:04, 51.97s/it]Best score increase :0.715 -> 0.718
training process:   8%|▊         | 10/128 [08:45<1:41:09, 51.44s/it]Best score increase :0.718 -> 0.736
training process:   9%|▊         | 11/128 [09:32<1:37:30, 50.00s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:19<1:35:17, 49.29s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.008, train acc : 0.881, valid acc : 0.890, train f1 : 0.723, valid f1 : 0.736
training process:  10%|█         | 13/128 [11:19<1:40:18, 52.34s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:15<1:41:41, 53.52s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [13:11<1:42:05, 54.21s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▎        | 16/128 [14:07<1:42:16, 54.79s/it]EarlyStopping counter : 6 out of 12
epoch : 17, train loss : 0.007, valid loss : 0.008, train acc : 0.888, valid acc : 0.880, train f1 : 0.736, valid f1 : 0.727
training process:  13%|█▎        | 17/128 [15:12<1:47:00, 57.84s/it]EarlyStopping counter : 7 out of 12
training process:  14%|█▍        | 18/128 [16:07<1:44:46, 57.15s/it]EarlyStopping counter : 8 out of 12
training process:  15%|█▍        | 19/128 [16:58<1:40:14, 55.18s/it]EarlyStopping counter : 9 out of 12
training process:  16%|█▌        | 20/128 [17:49<1:36:48, 53.78s/it]Best score increase :0.736 -> 0.763
epoch : 21, train loss : 0.006, valid loss : 0.007, train acc : 0.898, valid acc : 0.869, train f1 : 0.752, valid f1 : 0.716
training process:  16%|█▋        | 21/128 [18:45<1:37:09, 54.48s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:40<1:36:52, 54.84s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:36<1:36:20, 55.05s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:25<1:32:31, 53.38s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.007, train acc : 0.903, valid acc : 0.880, train f1 : 0.761, valid f1 : 0.726
training process:  20%|█▉        | 25/128 [22:26<1:35:36, 55.70s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [23:22<1:34:21, 55.50s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [24:13<1:31:16, 54.23s/it]EarlyStopping counter : 7 out of 12
training process:  22%|██▏       | 28/128 [25:07<1:30:22, 54.22s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.006, valid loss : 0.007, train acc : 0.913, valid acc : 0.888, train f1 : 0.778, valid f1 : 0.741
training process:  23%|██▎       | 29/128 [26:09<1:33:28, 56.65s/it]EarlyStopping counter : 9 out of 12
training process:  23%|██▎       | 30/128 [26:59<1:29:12, 54.62s/it]EarlyStopping counter : 10 out of 12
training process:  24%|██▍       | 31/128 [27:49<1:26:05, 53.25s/it]EarlyStopping counter : 11 out of 12
training process:  24%|██▍       | 31/128 [28:42<1:29:50, 55.57s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 31, best f1 score : 0.763
training process finished, best loss : 0.008 and best acc : 0.911, best f1 : 0.763, best epoch : 19

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.46      0.71      0.55       580
           1       0.97      0.93      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.71      0.82      0.75      7398
weighted avg       0.93      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.75, test AUC : 0.82, test loss : 0.522

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.32s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.30s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:09,  7.74s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.71s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:53,  7.59s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.51s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.53s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:29,  7.43s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.50s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:14,  7.44s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.40s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.52s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 79.14it/s] 12%|█▏        | 37/306 [00:00<00:01, 190.06it/s] 18%|█▊        | 56/306 [00:00<00:01, 153.69it/s] 24%|██▍       | 73/306 [00:00<00:01, 157.59it/s] 38%|███▊      | 116/306 [00:00<00:00, 245.13it/s] 48%|████▊     | 148/306 [00:00<00:00, 265.12it/s] 58%|█████▊    | 176/306 [00:00<00:00, 199.40it/s] 66%|██████▌   | 201/306 [00:00<00:00, 210.85it/s] 74%|███████▎  | 225/306 [00:01<00:00, 171.78it/s] 82%|████████▏ | 251/306 [00:01<00:00, 190.35it/s] 89%|████████▉ | 273/306 [00:01<00:00, 163.60it/s] 98%|█████████▊| 299/306 [00:01<00:00, 184.39it/s]100%|██████████| 306/306 [00:01<00:00, 187.22it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 576.31it/s]extract the null data:  22%|██▏       | 123/553 [00:00<00:00, 617.46it/s]extract the null data:  34%|███▎      | 186/553 [00:00<00:00, 620.59it/s]extract the null data:  46%|████▌     | 252/553 [00:00<00:00, 633.32it/s]extract the null data:  58%|█████▊    | 319/553 [00:00<00:00, 644.12it/s]extract the null data:  70%|██████▉   | 385/553 [00:00<00:00, 645.88it/s]extract the null data:  82%|████████▏ | 451/553 [00:00<00:00, 649.11it/s]extract the null data:  93%|█████████▎| 517/553 [00:00<00:00, 651.88it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 640.70it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 215.01it/s]replace nan value:   8%|▊         | 44/553 [00:00<00:02, 211.06it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:02, 206.40it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 212.03it/s]replace nan value:  20%|██        | 112/553 [00:00<00:02, 216.50it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:01, 220.42it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:01, 221.86it/s]replace nan value:  33%|███▎      | 181/553 [00:00<00:01, 222.51it/s]replace nan value:  37%|███▋      | 204/553 [00:00<00:01, 221.43it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 219.76it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 221.26it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 221.40it/s]replace nan value:  54%|█████▎    | 296/553 [00:01<00:01, 220.81it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:01, 220.15it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:00, 219.40it/s]replace nan value:  66%|██████▌   | 365/553 [00:01<00:00, 219.75it/s]replace nan value:  70%|██████▉   | 387/553 [00:01<00:00, 219.57it/s]replace nan value:  74%|███████▍  | 410/553 [00:01<00:00, 220.73it/s]replace nan value:  78%|███████▊  | 433/553 [00:01<00:00, 219.98it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 223.03it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 223.86it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 222.51it/s]replace nan value:  95%|█████████▌| 526/553 [00:02<00:00, 220.91it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 220.33it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 219.64it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 145.64it/s]  6%|▌         | 32/553 [00:00<00:03, 157.06it/s]  9%|▊         | 48/553 [00:00<00:03, 129.62it/s] 11%|█         | 62/553 [00:00<00:03, 128.66it/s] 14%|█▎        | 76/553 [00:00<00:03, 131.78it/s] 16%|█▋        | 90/553 [00:00<00:03, 131.98it/s] 19%|█▉        | 104/553 [00:00<00:03, 130.60it/s] 22%|██▏       | 122/553 [00:00<00:03, 140.23it/s] 25%|██▌       | 140/553 [00:00<00:02, 149.57it/s] 29%|██▉       | 160/553 [00:01<00:02, 162.48it/s] 32%|███▏      | 177/553 [00:01<00:02, 164.12it/s] 35%|███▌      | 194/553 [00:01<00:02, 165.18it/s] 38%|███▊      | 212/553 [00:01<00:02, 169.35it/s] 41%|████▏     | 229/553 [00:01<00:02, 156.92it/s] 44%|████▍     | 245/553 [00:01<00:02, 153.55it/s] 48%|████▊     | 263/553 [00:01<00:01, 159.54it/s] 51%|█████     | 280/553 [00:01<00:01, 148.60it/s] 54%|█████▎    | 296/553 [00:01<00:01, 144.21it/s] 56%|█████▌    | 311/553 [00:02<00:01, 141.62it/s] 59%|█████▉    | 326/553 [00:02<00:01, 142.07it/s] 62%|██████▏   | 342/553 [00:02<00:01, 145.21it/s] 65%|██████▍   | 357/553 [00:02<00:01, 139.46it/s] 68%|██████▊   | 374/553 [00:02<00:01, 145.81it/s] 70%|███████   | 389/553 [00:02<00:01, 134.25it/s] 73%|███████▎  | 403/553 [00:02<00:01, 130.05it/s] 75%|███████▌  | 417/553 [00:02<00:01, 130.66it/s] 78%|███████▊  | 431/553 [00:03<00:00, 127.21it/s] 82%|████████▏ | 451/553 [00:03<00:00, 145.00it/s] 84%|████████▍ | 467/553 [00:03<00:00, 148.87it/s] 87%|████████▋ | 483/553 [00:03<00:00, 146.42it/s] 90%|█████████ | 498/553 [00:03<00:00, 136.32it/s] 93%|█████████▎| 514/553 [00:03<00:00, 140.20it/s] 96%|█████████▌| 529/553 [00:03<00:00, 126.97it/s] 98%|█████████▊| 543/553 [00:03<00:00, 128.77it/s]100%|██████████| 553/553 [00:03<00:00, 139.86it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 41/139 [00:00<00:00, 408.68it/s]extract the null data:  83%|████████▎ | 115/139 [00:00<00:00, 602.46it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 594.51it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 249.08it/s]replace nan value:  37%|███▋      | 51/139 [00:00<00:00, 255.08it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 247.37it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 249.81it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 250.53it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 249.28it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 128.34it/s] 21%|██        | 29/139 [00:00<00:00, 136.19it/s] 33%|███▎      | 46/139 [00:00<00:00, 147.63it/s] 44%|████▍     | 61/139 [00:00<00:00, 134.07it/s] 55%|█████▍    | 76/139 [00:00<00:00, 137.14it/s] 65%|██████▍   | 90/139 [00:00<00:00, 123.53it/s] 76%|███████▌  | 105/139 [00:00<00:00, 128.19it/s] 88%|████████▊ | 122/139 [00:00<00:00, 137.01it/s] 98%|█████████▊| 136/139 [00:01<00:00, 135.42it/s]100%|██████████| 139/139 [00:01<00:00, 135.27it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 39/173 [00:00<00:00, 389.97it/s]extract the null data:  65%|██████▍   | 112/173 [00:00<00:00, 589.43it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 602.62it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 227.30it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 232.00it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 234.08it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 235.32it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 239.39it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 237.99it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 233.91it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 234.63it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 147.13it/s] 17%|█▋        | 30/173 [00:00<00:01, 132.41it/s] 27%|██▋       | 47/173 [00:00<00:00, 147.89it/s] 36%|███▋      | 63/173 [00:00<00:00, 151.51it/s] 46%|████▌     | 79/173 [00:00<00:00, 149.49it/s] 55%|█████▍    | 95/173 [00:00<00:00, 145.35it/s] 64%|██████▍   | 111/173 [00:00<00:00, 149.64it/s] 73%|███████▎  | 127/173 [00:00<00:00, 141.16it/s] 82%|████████▏ | 142/173 [00:00<00:00, 142.34it/s] 91%|█████████ | 157/173 [00:01<00:00, 127.72it/s] 99%|█████████▉| 171/173 [00:01<00:00, 97.75it/s] 100%|██████████| 173/173 [00:01<00:00, 126.22it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.012, train acc : 0.683, valid acc : 0.538, train f1 : 0.678, valid f1 : 0.454
training process:   1%|          | 1/128 [01:03<2:13:26, 63.04s/it]Best score increase :0.000 -> 0.454
training process:   2%|▏         | 2/128 [02:00<2:04:56, 59.49s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:53<1:57:43, 56.51s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:44<1:52:59, 54.67s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.015, train acc : 0.623, valid acc : 0.288, train f1 : 0.565, valid f1 : 0.277
training process:   4%|▍         | 5/128 [04:47<1:58:05, 57.61s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:44<1:56:21, 57.23s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [06:35<1:51:45, 55.42s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [07:32<1:51:43, 55.86s/it]EarlyStopping counter : 7 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.014, train acc : 0.688, valid acc : 0.377, train f1 : 0.655, valid f1 : 0.347
training process:   7%|▋         | 9/128 [08:34<1:54:45, 57.86s/it]EarlyStopping counter : 8 out of 12
training process:   8%|▊         | 10/128 [09:25<1:49:40, 55.76s/it]EarlyStopping counter : 9 out of 12
training process:   9%|▊         | 11/128 [10:16<1:45:23, 54.05s/it]EarlyStopping counter : 10 out of 12
training process:   9%|▉         | 12/128 [11:09<1:44:13, 53.91s/it]EarlyStopping counter : 11 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.014, train acc : 0.729, valid acc : 0.415, train f1 : 0.709, valid f1 : 0.376
training process:   9%|▉         | 12/128 [12:11<1:57:47, 60.93s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 12, best f1 score : 0.454
training process finished, best loss : 0.012 and best acc : 0.538, best f1 : 0.454, best epoch : 0

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.14      0.91      0.24       580
           1       0.99      0.51      0.67      6818

    accuracy                           0.54      7398
   macro avg       0.56      0.71      0.46      7398
weighted avg       0.92      0.54      0.64      7398


# test acc : 0.54, test f1 : 0.46, test AUC : 0.71, test loss : 0.714

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.19s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.71s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:08,  7.63s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.65s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.71s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:45,  7.66s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.64s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.52s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.64s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.53s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.48s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.59s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 79.29it/s]  6%|▌         | 17/306 [00:00<00:03, 80.41it/s]  8%|▊         | 26/306 [00:00<00:03, 81.09it/s] 12%|█▏        | 38/306 [00:00<00:02, 94.67it/s] 24%|██▍       | 74/306 [00:00<00:01, 185.98it/s] 32%|███▏      | 97/306 [00:00<00:01, 197.35it/s] 38%|███▊      | 117/306 [00:00<00:01, 166.59it/s] 45%|████▌     | 138/306 [00:00<00:00, 178.35it/s] 51%|█████▏    | 157/306 [00:01<00:01, 147.43it/s] 57%|█████▋    | 174/306 [00:01<00:01, 120.67it/s] 61%|██████▏   | 188/306 [00:01<00:00, 123.75it/s] 69%|██████▉   | 211/306 [00:01<00:00, 147.47it/s] 75%|███████▍  | 228/306 [00:01<00:00, 146.92it/s] 80%|███████▉  | 244/306 [00:01<00:00, 143.87it/s] 86%|████████▌ | 262/306 [00:01<00:00, 151.98it/s] 91%|█████████ | 278/306 [00:02<00:00, 122.26it/s] 95%|█████████▌| 292/306 [00:02<00:00, 108.32it/s]100%|██████████| 306/306 [00:02<00:00, 135.61it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 575.31it/s]extract the null data:  22%|██▏       | 119/553 [00:00<00:00, 592.15it/s]extract the null data:  33%|███▎      | 182/553 [00:00<00:00, 606.37it/s]extract the null data:  44%|████▍     | 244/553 [00:00<00:00, 608.68it/s]extract the null data:  56%|█████▌    | 309/553 [00:00<00:00, 622.42it/s]extract the null data:  68%|██████▊   | 377/553 [00:00<00:00, 640.77it/s]extract the null data:  80%|███████▉  | 442/553 [00:00<00:00, 626.38it/s]extract the null data:  92%|█████████▏| 507/553 [00:00<00:00, 631.11it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 624.17it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 217.68it/s]replace nan value:   8%|▊         | 44/553 [00:00<00:02, 209.69it/s]replace nan value:  12%|█▏        | 65/553 [00:00<00:02, 202.16it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 202.81it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 202.84it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 202.80it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:01, 203.25it/s]replace nan value:  31%|███       | 172/553 [00:00<00:01, 210.54it/s]replace nan value:  35%|███▌      | 194/553 [00:00<00:01, 212.36it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:01, 211.76it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 207.94it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 207.97it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 207.01it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 207.14it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 206.93it/s]replace nan value:  62%|██████▏   | 343/553 [00:01<00:01, 206.38it/s]replace nan value:  66%|██████▌   | 364/553 [00:01<00:00, 205.71it/s]replace nan value:  70%|██████▉   | 385/553 [00:01<00:00, 204.69it/s]replace nan value:  73%|███████▎  | 406/553 [00:01<00:00, 204.84it/s]replace nan value:  78%|███████▊  | 429/553 [00:02<00:00, 209.63it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 210.66it/s]replace nan value:  86%|████████▌ | 473/553 [00:02<00:00, 208.75it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 205.99it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 205.31it/s]replace nan value:  97%|█████████▋| 536/553 [00:02<00:00, 205.44it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 206.84it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.08it/s]  5%|▍         | 27/553 [00:00<00:04, 130.40it/s]  7%|▋         | 41/553 [00:00<00:04, 127.76it/s] 10%|▉         | 54/553 [00:00<00:04, 118.29it/s] 12%|█▏        | 66/553 [00:00<00:04, 111.97it/s] 14%|█▍        | 80/553 [00:00<00:04, 116.78it/s] 17%|█▋        | 94/553 [00:00<00:03, 121.45it/s] 20%|█▉        | 108/553 [00:00<00:03, 125.83it/s] 22%|██▏       | 124/553 [00:00<00:03, 133.73it/s] 25%|██▌       | 141/553 [00:01<00:02, 144.02it/s] 29%|██▉       | 161/553 [00:01<00:02, 157.11it/s] 32%|███▏      | 177/553 [00:01<00:02, 156.62it/s] 35%|███▍      | 193/553 [00:01<00:02, 157.34it/s] 38%|███▊      | 211/553 [00:01<00:02, 162.33it/s] 41%|████      | 228/553 [00:01<00:02, 154.40it/s] 44%|████▍     | 244/553 [00:01<00:02, 150.61it/s] 47%|████▋     | 262/553 [00:01<00:01, 157.64it/s] 50%|█████     | 278/553 [00:01<00:01, 149.39it/s] 53%|█████▎    | 294/553 [00:02<00:01, 143.72it/s] 56%|█████▌    | 309/553 [00:02<00:01, 139.61it/s] 59%|█████▊    | 324/553 [00:02<00:01, 137.99it/s] 61%|██████▏   | 339/553 [00:02<00:01, 140.71it/s] 64%|██████▍   | 354/553 [00:02<00:01, 137.84it/s] 67%|██████▋   | 368/553 [00:02<00:01, 138.29it/s] 69%|██████▉   | 384/553 [00:02<00:01, 141.92it/s] 72%|███████▏  | 399/553 [00:02<00:01, 124.12it/s] 75%|███████▌  | 416/553 [00:03<00:01, 130.87it/s] 78%|███████▊  | 430/553 [00:03<00:00, 126.49it/s] 81%|████████  | 449/553 [00:03<00:00, 142.49it/s] 84%|████████▍ | 465/553 [00:03<00:00, 145.60it/s] 87%|████████▋ | 480/553 [00:03<00:00, 141.11it/s] 90%|████████▉ | 495/553 [00:03<00:00, 134.40it/s] 93%|█████████▎| 512/553 [00:03<00:00, 140.96it/s] 95%|█████████▌| 527/553 [00:03<00:00, 124.97it/s] 98%|█████████▊| 541/553 [00:03<00:00, 127.73it/s]100%|██████████| 553/553 [00:04<00:00, 135.45it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 417.22it/s]extract the null data:  83%|████████▎ | 116/139 [00:00<00:00, 603.34it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 596.09it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 226.38it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 225.86it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 220.38it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 219.77it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 222.61it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 223.02it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 222.64it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:01, 125.70it/s] 19%|█▉        | 27/139 [00:00<00:00, 130.37it/s] 32%|███▏      | 44/139 [00:00<00:00, 143.63it/s] 42%|████▏     | 59/139 [00:00<00:00, 131.61it/s] 53%|█████▎    | 74/139 [00:00<00:00, 136.22it/s] 63%|██████▎   | 88/139 [00:00<00:00, 119.03it/s] 75%|███████▍  | 104/139 [00:00<00:00, 128.92it/s] 85%|████████▍ | 118/139 [00:00<00:00, 131.21it/s] 95%|█████████▍| 132/139 [00:01<00:00, 129.00it/s]100%|██████████| 139/139 [00:01<00:00, 132.18it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 357.76it/s]extract the null data:  60%|██████    | 104/173 [00:00<00:00, 546.04it/s]extract the null data:  99%|█████████▉| 171/173 [00:00<00:00, 597.32it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 565.30it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 224.23it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 232.17it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 233.60it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 232.34it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 230.26it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 228.20it/s]replace nan value:  96%|█████████▌| 166/173 [00:00<00:00, 224.01it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 227.06it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 141.21it/s] 17%|█▋        | 30/173 [00:00<00:01, 128.50it/s] 27%|██▋       | 47/173 [00:00<00:00, 143.27it/s] 36%|███▋      | 63/173 [00:00<00:00, 149.23it/s] 46%|████▌     | 79/173 [00:00<00:00, 147.26it/s] 54%|█████▍    | 94/173 [00:00<00:00, 146.53it/s] 63%|██████▎   | 109/173 [00:00<00:00, 146.09it/s] 72%|███████▏  | 124/173 [00:00<00:00, 139.54it/s] 80%|████████  | 139/173 [00:00<00:00, 139.81it/s] 89%|████████▉ | 154/173 [00:01<00:00, 132.03it/s] 97%|█████████▋| 168/173 [00:01<00:00, 110.40it/s]100%|██████████| 173/173 [00:01<00:00, 127.70it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.007, train f1 : 0.592, valid f1 : 0.607
training process - Deferred Re-weighting:   1%|          | 1/128 [01:06<2:20:50, 66.54s/it]Best score increase :0.000 -> 0.607
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:00<2:04:35, 59.33s/it]Best score increase :0.607 -> 0.625
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:57<2:01:11, 58.18s/it]Best score increase :0.625 -> 0.668
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:51<1:57:02, 56.63s/it]Best score increase :0.668 -> 0.688
epoch : 5, train loss : 0.004, valid loss : 0.004, train f1 : 0.703, valid f1 : 0.696
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:51<1:57:56, 57.53s/it]Best score increase :0.688 -> 0.696
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:46<1:55:45, 56.93s/it]Best score increase :0.696 -> 0.721
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:36<1:50:09, 54.62s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:26<1:46:14, 53.12s/it]Best score increase :0.721 -> 0.723
epoch : 9, train loss : 0.003, valid loss : 0.004, train f1 : 0.741, valid f1 : 0.714
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:25<1:48:59, 54.95s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:18<1:46:50, 54.33s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:15<1:47:15, 55.00s/it]Best score increase :0.723 -> 0.739
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:11<1:47:26, 55.58s/it]Best score increase :0.739 -> 0.742
epoch : 13, train loss : 0.003, valid loss : 0.004, train f1 : 0.766, valid f1 : 0.733
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:16<1:51:59, 58.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:14<1:50:22, 58.09s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:10<1:48:20, 57.53s/it]Best score increase :0.742 -> 0.759
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:00<1:43:18, 55.34s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.788, valid f1 : 0.756
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:59<1:44:12, 56.33s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:51<1:41:03, 55.12s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:48<1:40:53, 55.53s/it]Best score increase :0.759 -> 0.776
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:44<1:40:30, 55.83s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train f1 : 0.810, valid f1 : 0.775
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:49<1:44:09, 58.41s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:43<1:41:17, 57.34s/it]Best score increase :0.776 -> 0.779
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:34<1:36:54, 55.38s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:29<1:35:43, 55.23s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.820, valid f1 : 0.776
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:29<1:37:05, 56.56s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:17<1:31:58, 54.11s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:05<1:27:57, 52.25s/it]Best score increase :0.779 -> 0.790
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:59<1:28:06, 52.87s/it]Best score increase :0.790 -> 0.796
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.840, valid f1 : 0.793
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:03<1:32:22, 55.98s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:55<1:29:41, 54.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:52<1:29:36, 55.43s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:47<1:28:39, 55.41s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.846, valid f1 : 0.799
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [30:48<1:30:28, 57.14s/it]Best score increase :0.796 -> 0.799
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [31:42<1:27:51, 56.08s/it]Best score increase :0.799 -> 0.806
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [32:32<1:24:05, 54.26s/it]Best score increase :0.806 -> 0.813
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [33:21<1:21:02, 52.86s/it]Best score increase :0.813 -> 0.821
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.863, valid f1 : 0.813
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [34:23<1:23:58, 55.37s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [35:17<1:22:24, 54.94s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [36:13<1:22:19, 55.50s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [37:10<1:21:45, 55.75s/it]Best score increase :0.821 -> 0.825
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.875, valid f1 : 0.823
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [38:15<1:24:46, 58.46s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [39:06<1:20:51, 56.41s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [39:59<1:18:25, 55.36s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:53<1:16:46, 54.84s/it]Best score increase :0.825 -> 0.835
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.877, valid f1 : 0.817
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:50<1:17:01, 55.68s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [42:39<1:13:25, 53.73s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [43:32<1:12:10, 53.47s/it]Best score increase :0.835 -> 0.852
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [44:29<1:12:30, 54.39s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train f1 : 0.884, valid f1 : 0.831
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [45:33<1:15:24, 57.27s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [46:30<1:14:16, 57.14s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [47:26<1:13:01, 56.91s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [48:21<1:11:14, 56.24s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train f1 : 0.888, valid f1 : 0.833
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [49:21<1:11:58, 57.58s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [50:11<1:07:57, 55.10s/it]Best score increase :0.852 -> 0.858
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [51:00<1:05:00, 53.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [51:54<1:04:11, 53.50s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.003, train f1 : 0.894, valid f1 : 0.846
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [52:58<1:07:09, 56.75s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [53:53<1:05:26, 56.09s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [54:48<1:04:09, 55.78s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [55:44<1:03:17, 55.85s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.001, valid loss : 0.003, train f1 : 0.901, valid f1 : 0.852
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [56:45<1:04:03, 57.37s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [57:41<1:02:37, 56.93s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [58:30<59:15, 54.71s/it]  EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [59:19<56:36, 53.06s/it]EarlyStopping counter : 10 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.003, train f1 : 0.904, valid f1 : 0.853
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:00:18<57:20, 54.61s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:01:05<59:12, 56.40s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 65, best f1 score : 0.858
training process finished, best loss : 0.003, best acc : 0.959, best f1 : 0.858, best epoch : 53

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.68      0.61       580
           1       0.97      0.95      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.82      0.78      7398
weighted avg       0.94      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.78, test AUC : 0.82, test loss : 0.330

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.36s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.35s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.36s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<01:00,  7.57s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.47s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.37s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.45s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:30,  7.53s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:15,  7.56s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.41s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.46s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 12%|█▏        | 37/306 [00:00<00:00, 367.63it/s] 25%|██▍       | 76/306 [00:00<00:00, 377.68it/s] 38%|███▊      | 115/306 [00:00<00:00, 382.57it/s] 50%|█████     | 154/306 [00:00<00:00, 384.02it/s] 63%|██████▎   | 193/306 [00:00<00:00, 380.37it/s] 76%|███████▌  | 232/306 [00:00<00:00, 382.82it/s] 91%|█████████ | 277/306 [00:00<00:00, 404.32it/s]100%|██████████| 306/306 [00:00<00:00, 395.34it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : MLSTM_FCN-exp_clip_21_dist_3_LDAM_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 571.40it/s]extract the null data:  22%|██▏       | 119/553 [00:00<00:00, 588.69it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 608.54it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 615.30it/s]extract the null data:  56%|█████▌    | 309/553 [00:00<00:00, 618.89it/s]extract the null data:  67%|██████▋   | 371/553 [00:00<00:00, 617.73it/s]extract the null data:  78%|███████▊  | 433/553 [00:00<00:00, 615.32it/s]extract the null data:  90%|████████▉ | 495/553 [00:00<00:00, 607.47it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 607.80it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 195.98it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 193.57it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 194.06it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 199.07it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 201.85it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 205.02it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:01, 217.19it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:01, 224.53it/s]replace nan value:  36%|███▌      | 198/553 [00:00<00:01, 228.55it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 230.15it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 231.05it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 231.29it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 230.42it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 230.63it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:00, 230.64it/s]replace nan value:  66%|██████▌   | 366/553 [00:01<00:00, 230.54it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 231.46it/s]replace nan value:  75%|███████▍  | 414/553 [00:01<00:00, 232.37it/s]replace nan value:  79%|███████▉  | 438/553 [00:01<00:00, 231.86it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 233.45it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 233.50it/s]replace nan value:  92%|█████████▏| 510/553 [00:02<00:00, 231.57it/s]replace nan value:  97%|█████████▋| 534/553 [00:02<00:00, 231.28it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 225.02it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.85it/s]  6%|▌         | 32/553 [00:00<00:03, 155.69it/s]  9%|▊         | 48/553 [00:00<00:03, 130.81it/s] 11%|█         | 62/553 [00:00<00:03, 130.59it/s] 14%|█▍        | 77/553 [00:00<00:03, 135.92it/s] 17%|█▋        | 93/553 [00:00<00:03, 138.51it/s] 20%|█▉        | 109/553 [00:00<00:03, 143.20it/s] 23%|██▎       | 125/553 [00:00<00:02, 146.45it/s] 26%|██▌       | 144/553 [00:00<00:02, 157.42it/s] 29%|██▉       | 163/553 [00:01<00:02, 166.03it/s] 33%|███▎      | 181/553 [00:01<00:02, 167.31it/s] 36%|███▌      | 199/553 [00:01<00:02, 169.80it/s] 39%|███▉      | 217/553 [00:01<00:02, 166.57it/s] 42%|████▏     | 234/553 [00:01<00:02, 156.47it/s] 45%|████▌     | 250/553 [00:01<00:01, 156.79it/s] 48%|████▊     | 266/553 [00:01<00:01, 155.29it/s] 51%|█████     | 282/553 [00:01<00:01, 152.19it/s] 54%|█████▍    | 298/553 [00:01<00:01, 148.06it/s] 57%|█████▋    | 313/553 [00:02<00:01, 144.80it/s] 59%|█████▉    | 328/553 [00:02<00:01, 142.57it/s] 62%|██████▏   | 345/553 [00:02<00:01, 143.79it/s] 65%|██████▌   | 360/553 [00:02<00:01, 136.90it/s] 68%|██████▊   | 377/553 [00:02<00:01, 145.69it/s] 71%|███████   | 392/553 [00:02<00:01, 135.67it/s] 74%|███████▎  | 407/553 [00:02<00:01, 137.93it/s] 76%|███████▌  | 421/553 [00:02<00:00, 135.55it/s] 79%|███████▊  | 435/553 [00:02<00:00, 133.28it/s] 82%|████████▏ | 453/553 [00:03<00:00, 144.30it/s] 85%|████████▍ | 470/553 [00:03<00:00, 149.31it/s] 88%|████████▊ | 486/553 [00:03<00:00, 147.90it/s] 91%|█████████ | 501/553 [00:03<00:00, 137.39it/s] 94%|█████████▎| 518/553 [00:03<00:00, 144.54it/s] 96%|█████████▋| 533/553 [00:03<00:00, 123.94it/s]100%|█████████▉| 551/553 [00:03<00:00, 117.01it/s]100%|██████████| 553/553 [00:03<00:00, 142.51it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  35%|███▍      | 48/139 [00:00<00:00, 479.14it/s]extract the null data:  91%|█████████ | 126/139 [00:00<00:00, 655.08it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 639.84it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▊        | 26/139 [00:00<00:00, 257.44it/s]replace nan value:  37%|███▋      | 52/139 [00:00<00:00, 257.19it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 255.16it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 255.29it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 254.01it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 254.07it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 136.60it/s] 22%|██▏       | 30/139 [00:00<00:00, 143.98it/s] 35%|███▍      | 48/139 [00:00<00:00, 149.99it/s] 45%|████▌     | 63/139 [00:00<00:00, 142.07it/s] 56%|█████▌    | 78/139 [00:00<00:00, 139.93it/s] 66%|██████▌   | 92/139 [00:00<00:00, 133.45it/s] 77%|███████▋  | 107/139 [00:00<00:00, 137.02it/s] 90%|████████▉ | 125/139 [00:00<00:00, 149.15it/s]100%|██████████| 139/139 [00:00<00:00, 144.69it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  28%|██▊       | 48/173 [00:00<00:00, 477.40it/s]extract the null data:  72%|███████▏  | 125/173 [00:00<00:00, 647.53it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 651.43it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 26/173 [00:00<00:00, 256.41it/s]replace nan value:  30%|███       | 52/173 [00:00<00:00, 251.91it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 250.94it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 252.04it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 251.78it/s]replace nan value:  90%|█████████ | 156/173 [00:00<00:00, 248.98it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 248.82it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:01, 153.35it/s] 18%|█▊        | 32/173 [00:00<00:01, 132.73it/s] 29%|██▉       | 51/173 [00:00<00:00, 155.19it/s] 39%|███▊      | 67/173 [00:00<00:00, 150.92it/s] 48%|████▊     | 83/173 [00:00<00:00, 152.90it/s] 57%|█████▋    | 99/173 [00:00<00:00, 152.64it/s] 68%|██████▊   | 117/173 [00:00<00:00, 158.73it/s] 77%|███████▋  | 133/173 [00:00<00:00, 147.18it/s] 86%|████████▌ | 148/173 [00:00<00:00, 146.06it/s] 94%|█████████▍| 163/173 [00:01<00:00, 133.30it/s]100%|██████████| 173/173 [00:01<00:00, 132.69it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

----------------------------------------------------------------------------
           Layer (type)         Input Shape         Param #     Tr. Param #
============================================================================
           NoiseLayer-1         [2, 21, 12]               0               0
     SelfAttentionRnn-2         [2, 21, 12]         151,680         151,680
            ConvBlock-3         [2, 12, 21]           2,496           2,496
   SqueezeExciteBlock-4         [2, 64, 19]             512             512
            ConvBlock-5         [2, 64, 19]          24,960          24,960
   SqueezeExciteBlock-6        [2, 128, 17]           2,048           2,048
               Linear-7            [2, 256]          65,792          65,792
               Linear-8            [2, 256]          32,896          32,896
          BatchNorm1d-9            [2, 128]             256             256
           LeakyReLU-10            [2, 128]               0               0
              Linear-11            [2, 128]             258             258
============================================================================
Total params: 280,898
Trainable params: 280,898
Non-trainable params: 0
Batch size: 2
----------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.009, train f1 : 0.715, valid f1 : 0.620
training process - Deferred Re-weighting:   1%|          | 1/128 [00:53<1:53:06, 53.44s/it]Best score increase :0.000 -> 0.620
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:37<1:41:08, 48.16s/it]Best score increase :0.620 -> 0.677
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:22<1:37:08, 46.63s/it]Best score increase :0.677 -> 0.681
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:07<1:34:59, 45.97s/it]Best score increase :0.681 -> 0.682
epoch : 5, train loss : 0.008, valid loss : 0.008, train f1 : 0.818, valid f1 : 0.687
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:01<1:39:53, 48.73s/it]Best score increase :0.682 -> 0.687
training process - Deferred Re-weighting:   5%|▍         | 6/128 [04:51<1:39:52, 49.12s/it]Best score increase :0.687 -> 0.698
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:36<1:36:43, 47.96s/it]Best score increase :0.698 -> 0.708
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:22<1:34:22, 47.19s/it]Best score increase :0.708 -> 0.712
epoch : 9, train loss : 0.007, valid loss : 0.007, train f1 : 0.851, valid f1 : 0.702
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:15<1:37:11, 49.00s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:00<1:34:02, 47.82s/it]Best score increase :0.712 -> 0.718
training process - Deferred Re-weighting:   9%|▊         | 11/128 [08:46<1:31:56, 47.15s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [09:31<1:29:54, 46.51s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.007, train f1 : 0.870, valid f1 : 0.699
training process - Deferred Re-weighting:  10%|█         | 13/128 [10:26<1:34:10, 49.14s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [11:11<1:30:50, 47.81s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [11:57<1:29:24, 47.48s/it]Best score increase :0.718 -> 0.726
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [12:44<1:28:09, 47.23s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.007, train f1 : 0.881, valid f1 : 0.695
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [13:39<1:31:51, 49.66s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [14:25<1:28:41, 48.38s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [15:11<1:26:44, 47.75s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [16:00<1:26:42, 48.17s/it]EarlyStopping counter : 5 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.006, train f1 : 0.897, valid f1 : 0.723
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [16:55<1:29:37, 50.26s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [17:40<1:25:39, 48.49s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [18:32<1:26:56, 49.68s/it]Best score increase :0.726 -> 0.756
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [19:21<1:25:33, 49.36s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.006, train f1 : 0.907, valid f1 : 0.732
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [20:20<1:29:47, 52.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [21:08<1:26:54, 51.13s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [21:57<1:25:03, 50.53s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [22:46<1:23:25, 50.05s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.006, train f1 : 0.912, valid f1 : 0.735
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [23:43<1:25:55, 52.08s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [24:34<1:24:39, 51.83s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [25:26<1:23:52, 51.89s/it]Best score increase :0.756 -> 0.784
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [26:17<1:22:36, 51.63s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.005, train f1 : 0.920, valid f1 : 0.777
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [27:16<1:24:57, 53.66s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [28:08<1:23:37, 53.38s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [28:59<1:21:33, 52.61s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [29:50<1:19:48, 52.05s/it]EarlyStopping counter : 5 out of 12
epoch : 37, train loss : 0.004, valid loss : 0.006, train f1 : 0.922, valid f1 : 0.727
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [30:51<1:22:50, 54.62s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [31:42<1:20:37, 53.75s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [32:33<1:18:20, 52.82s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [33:22<1:15:52, 51.74s/it]EarlyStopping counter : 9 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.005, train f1 : 0.929, valid f1 : 0.765
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [34:21<1:18:03, 53.83s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [35:14<1:16:37, 53.46s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:04<1:13:51, 51.53s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 42, best f1 score : 0.784
training process finished, best loss : 0.005, best acc : 0.914, best f1 : 0.784, best epoch : 30

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.50      0.81      0.62       580
           1       0.98      0.93      0.96      6818

    accuracy                           0.92      7398
   macro avg       0.74      0.87      0.79      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.79, test AUC : 0.87, test loss : 0.293

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.67s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.70s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.80s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.87s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.81s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:45,  7.58s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.62s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.65s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.80s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.85s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.74s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.74s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 18/306 [00:00<00:01, 175.63it/s] 12%|█▏        | 37/306 [00:00<00:01, 179.75it/s] 18%|█▊        | 55/306 [00:00<00:01, 139.66it/s] 24%|██▎       | 72/306 [00:00<00:01, 144.23it/s] 28%|██▊       | 87/306 [00:00<00:01, 115.41it/s] 33%|███▎      | 100/306 [00:00<00:01, 104.56it/s] 42%|████▏     | 127/306 [00:00<00:01, 144.76it/s] 47%|████▋     | 144/306 [00:01<00:01, 136.99it/s] 52%|█████▏    | 160/306 [00:01<00:01, 142.31it/s] 58%|█████▊    | 176/306 [00:01<00:00, 130.57it/s] 62%|██████▏   | 190/306 [00:01<00:01, 112.66it/s] 66%|██████▋   | 203/306 [00:01<00:00, 111.93it/s] 75%|███████▍  | 229/306 [00:01<00:00, 144.25it/s] 80%|████████  | 245/306 [00:01<00:00, 136.40it/s] 86%|████████▌ | 262/306 [00:01<00:00, 143.40it/s] 91%|█████████ | 277/306 [00:02<00:00, 126.22it/s] 95%|█████████▌| 291/306 [00:02<00:00, 109.91it/s] 99%|█████████▉| 303/306 [00:02<00:00, 108.49it/s]100%|██████████| 306/306 [00:02<00:00, 127.31it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
