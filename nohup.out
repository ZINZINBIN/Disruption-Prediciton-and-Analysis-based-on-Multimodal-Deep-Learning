Terminated
./exp_multi_gb.sh: line 9: GB: command not found
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
Terminated
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4

extract the null data:   0%|          | 0/227 [00:00<?, ?it/s]
extract the null data:  24%|██▍       | 54/227 [00:00<00:00, 538.23it/s]
extract the null data:  50%|█████     | 114/227 [00:00<00:00, 570.00it/s]
extract the null data:  75%|███████▌  | 171/227 [00:00<00:00, 560.59it/s]
extract the null data: 100%|██████████| 227/227 [00:00<00:00, 570.58it/s]
# check | video data : 36135, 0D data : 36135

extract the null data:   0%|          | 0/57 [00:00<?, ?it/s]
extract the null data: 100%|██████████| 57/57 [00:00<00:00, 702.38it/s]
# check | video data : 9035, 0D data : 9035

extract the null data:   0%|          | 0/71 [00:00<?, ?it/s]
extract the null data:  97%|█████████▋| 69/71 [00:00<00:00, 683.50it/s]
extract the null data: 100%|██████████| 71/71 [00:00<00:00, 681.72it/s]
# check | video data : 11014, 0D data : 11014
train data : 36135, disrupt : 860, non-disrupt : 35275
valid data : 9035, disrupt : 216, non-disrupt : 8819
test data : 11014, disrupt : 276, non-disrupt : 10738

################# model summary #################

-----------------------------------------------------------------------------------
             Layer (type)              Input Shape         Param #     Tr. Param #
===================================================================================
           ViViTEncoder-1     [8, 3, 21, 128, 128]       3,429,888       3,429,888
   TStransformerEncoder-2              [8, 21, 12]         794,752         794,752
                 Linear-3                 [8, 256]          32,896          32,896
            BatchNorm1d-4                 [8, 128]             256             256
                   ReLU-5                 [8, 128]               0               0
                 Linear-6                 [8, 128]             258             258
===================================================================================
Total params: 4,258,050
Trainable params: 4,258,050
Non-trainable params: 0
-----------------------------------------------------------------------------------

################# training process #################


training process:   0%|          | 0/128 [00:00<?, ?it/s]
training process:   1%|          | 1/128 [06:11<13:07:16, 371.94s/it]epoch : 1, train loss : 0.012, valid loss : 0.014, train acc : 0.725, valid acc : 0.511, train f1 : 0.706, valid f1 : 0.376

training process:   2%|▏         | 2/128 [12:29<13:08:33, 375.50s/it]
training process:   2%|▏         | 3/128 [18:41<12:58:27, 373.66s/it]
training process:   3%|▎         | 4/128 [24:53<12:51:01, 373.08s/it]
training process:   4%|▍         | 5/128 [31:04<12:43:10, 372.28s/it]epoch : 5, train loss : 0.003, valid loss : 0.008, train acc : 0.955, valid acc : 0.839, train f1 : 0.955, valid f1 : 0.565

training process:   5%|▍         | 6/128 [37:15<12:36:26, 372.02s/it]
training process:   5%|▌         | 7/128 [43:29<12:31:21, 372.58s/it]
training process:   6%|▋         | 8/128 [49:42<12:25:31, 372.77s/it]
training process:   7%|▋         | 9/128 [55:53<12:18:01, 372.12s/it]epoch : 9, train loss : 0.002, valid loss : 0.009, train acc : 0.974, valid acc : 0.906, train f1 : 0.974, valid f1 : 0.633

training process:   8%|▊         | 10/128 [1:02:03<12:10:47, 371.59s/it]
training process:   9%|▊         | 11/128 [1:08:13<12:03:20, 370.94s/it]
training process:   9%|▉         | 12/128 [1:14:26<11:58:17, 371.53s/it]
training process:  10%|█         | 13/128 [1:20:37<11:51:46, 371.36s/it]epoch : 13, train loss : 0.001, valid loss : 0.011, train acc : 0.983, valid acc : 0.906, train f1 : 0.983, valid f1 : 0.631

training process:  11%|█         | 14/128 [1:26:46<11:44:21, 370.71s/it]
training process:  12%|█▏        | 15/128 [1:32:56<11:37:41, 370.46s/it]
training process:  12%|█▎        | 16/128 [1:39:06<11:31:15, 370.32s/it]
training process:  13%|█▎        | 17/128 [1:45:15<11:24:29, 370.00s/it]epoch : 17, train loss : 0.001, valid loss : 0.015, train acc : 0.988, valid acc : 0.951, train f1 : 0.988, valid f1 : 0.711

training process:  14%|█▍        | 18/128 [1:51:27<11:19:31, 370.65s/it]
training process:  15%|█▍        | 19/128 [1:57:40<11:14:30, 371.29s/it]
training process:  16%|█▌        | 20/128 [2:03:51<11:07:55, 371.07s/it]
training process:  16%|█▋        | 21/128 [2:10:01<11:01:08, 370.73s/it]epoch : 21, train loss : 0.001, valid loss : 0.015, train acc : 0.990, valid acc : 0.934, train f1 : 0.990, valid f1 : 0.676

training process:  17%|█▋        | 22/128 [2:16:09<10:53:51, 370.10s/it]
training process:  18%|█▊        | 23/128 [2:22:20<10:47:56, 370.25s/it]
training process:  19%|█▉        | 24/128 [2:28:30<10:41:59, 370.38s/it]
training process:  20%|█▉        | 25/128 [2:34:41<10:35:39, 370.28s/it]epoch : 25, train loss : 0.001, valid loss : 0.015, train acc : 0.992, valid acc : 0.939, train f1 : 0.992, valid f1 : 0.687

training process:  20%|██        | 26/128 [2:40:50<10:29:08, 370.08s/it]
training process:  21%|██        | 27/128 [2:47:00<10:22:59, 370.09s/it]
training process:  22%|██▏       | 28/128 [2:53:08<10:15:25, 369.25s/it]
training process:  23%|██▎       | 29/128 [2:59:16<10:09:02, 369.11s/it]epoch : 29, train loss : 0.001, valid loss : 0.017, train acc : 0.992, valid acc : 0.948, train f1 : 0.992, valid f1 : 0.706

training process:  23%|██▎       | 30/128 [3:05:28<10:04:15, 369.95s/it]
training process:  24%|██▍       | 31/128 [3:11:38<9:57:50, 369.80s/it] 
training process:  25%|██▌       | 32/128 [3:17:48<9:51:42, 369.82s/it]
training process:  26%|██▌       | 33/128 [3:24:01<9:47:23, 370.98s/it]epoch : 33, train loss : 0.001, valid loss : 0.017, train acc : 0.994, valid acc : 0.958, train f1 : 0.994, valid f1 : 0.735

training process:  27%|██▋       | 34/128 [3:30:14<9:41:57, 371.47s/it]
training process:  27%|██▋       | 35/128 [3:36:26<9:36:06, 371.68s/it]
training process:  28%|██▊       | 36/128 [3:42:35<9:28:35, 370.82s/it]
training process:  29%|██▉       | 37/128 [3:48:46<9:22:37, 370.96s/it]epoch : 37, train loss : 0.001, valid loss : 0.019, train acc : 0.995, valid acc : 0.956, train f1 : 0.995, valid f1 : 0.726

training process:  30%|██▉       | 38/128 [3:54:59<9:17:07, 371.42s/it]
training process:  30%|███       | 39/128 [4:01:10<9:10:55, 371.40s/it]
training process:  31%|███▏      | 40/128 [4:07:24<9:05:53, 372.20s/it]
training process:  32%|███▏      | 41/128 [4:13:36<8:59:31, 372.09s/it]epoch : 41, train loss : 0.001, valid loss : 0.022, train acc : 0.996, valid acc : 0.977, train f1 : 0.996, valid f1 : 0.813

training process:  33%|███▎      | 42/128 [4:19:46<8:52:25, 371.46s/it]
training process:  34%|███▎      | 43/128 [4:25:56<8:45:42, 371.09s/it]
training process:  34%|███▍      | 44/128 [4:32:07<8:39:33, 371.11s/it]
training process:  35%|███▌      | 45/128 [4:38:21<8:34:16, 371.77s/it]epoch : 45, train loss : 0.000, valid loss : 0.024, train acc : 0.996, valid acc : 0.948, train f1 : 0.996, valid f1 : 0.705

training process:  36%|███▌      | 46/128 [4:44:35<8:28:59, 372.43s/it]
training process:  37%|███▋      | 47/128 [4:50:49<8:23:29, 372.96s/it]
training process:  38%|███▊      | 48/128 [4:57:02<8:17:22, 373.03s/it]
training process:  38%|███▊      | 49/128 [5:03:13<8:10:20, 372.42s/it]epoch : 49, train loss : 0.000, valid loss : 0.022, train acc : 0.997, valid acc : 0.966, train f1 : 0.997, valid f1 : 0.762

training process:  39%|███▉      | 50/128 [5:09:24<8:03:29, 371.92s/it]
training process:  40%|███▉      | 51/128 [5:15:38<7:58:17, 372.69s/it]
training process:  41%|████      | 52/128 [5:21:52<7:52:24, 372.96s/it]
training process:  41%|████▏     | 53/128 [5:28:07<7:47:02, 373.63s/it]epoch : 53, train loss : 0.000, valid loss : 0.025, train acc : 0.997, valid acc : 0.952, train f1 : 0.997, valid f1 : 0.718

training process:  42%|████▏     | 54/128 [5:34:23<7:41:32, 374.23s/it]
training process:  43%|████▎     | 55/128 [5:40:37<7:35:20, 374.26s/it]
training process:  44%|████▍     | 56/128 [5:46:53<7:29:45, 374.79s/it]
training process:  45%|████▍     | 57/128 [5:53:07<7:23:16, 374.60s/it]epoch : 57, train loss : 0.000, valid loss : 0.026, train acc : 0.997, valid acc : 0.955, train f1 : 0.997, valid f1 : 0.724

training process:  45%|████▌     | 58/128 [5:59:21<7:16:51, 374.46s/it]
training process:  46%|████▌     | 59/128 [6:05:35<7:10:27, 374.31s/it]
training process:  47%|████▋     | 60/128 [6:11:48<7:03:36, 373.77s/it]
training process:  48%|████▊     | 61/128 [6:18:00<6:57:00, 373.45s/it]epoch : 61, train loss : 0.000, valid loss : 0.027, train acc : 0.997, valid acc : 0.953, train f1 : 0.997, valid f1 : 0.716

training process:  48%|████▊     | 62/128 [6:24:13<6:50:40, 373.34s/it]
training process:  49%|████▉     | 63/128 [6:30:29<6:45:04, 373.92s/it]
training process:  50%|█████     | 64/128 [6:36:42<6:38:29, 373.59s/it]
training process:  51%|█████     | 65/128 [6:42:58<6:33:06, 374.39s/it]epoch : 65, train loss : 0.001, valid loss : 0.028, train acc : 0.998, valid acc : 0.963, train f1 : 0.998, valid f1 : 0.747

training process:  52%|█████▏    | 66/128 [6:49:10<6:26:02, 373.59s/it]
training process:  52%|█████▏    | 67/128 [6:55:21<6:19:16, 373.06s/it]
training process:  53%|█████▎    | 68/128 [7:01:37<6:13:52, 373.88s/it]
training process:  54%|█████▍    | 69/128 [7:07:53<6:08:11, 374.43s/it]epoch : 69, train loss : 0.000, valid loss : 0.030, train acc : 0.998, valid acc : 0.969, train f1 : 0.998, valid f1 : 0.765

training process:  55%|█████▍    | 70/128 [7:14:10<6:02:35, 375.10s/it]
training process:  55%|█████▌    | 71/128 [7:20:23<5:55:53, 374.62s/it]
training process:  56%|█████▋    | 72/128 [7:26:39<5:50:04, 375.07s/it]
training process:  57%|█████▋    | 73/128 [7:32:57<5:44:28, 375.80s/it]epoch : 73, train loss : 0.000, valid loss : 0.031, train acc : 0.998, valid acc : 0.951, train f1 : 0.998, valid f1 : 0.705

training process:  58%|█████▊    | 74/128 [7:39:14<5:38:41, 376.32s/it]
training process:  59%|█████▊    | 75/128 [7:45:32<5:32:46, 376.72s/it]
training process:  59%|█████▉    | 76/128 [7:51:46<5:25:56, 376.08s/it]
training process:  60%|██████    | 77/128 [7:57:58<5:18:32, 374.75s/it]epoch : 77, train loss : 0.000, valid loss : 0.029, train acc : 0.998, valid acc : 0.956, train f1 : 0.998, valid f1 : 0.721

training process:  61%|██████    | 78/128 [8:04:09<5:11:25, 373.71s/it]
training process:  62%|██████▏   | 79/128 [8:10:26<5:05:48, 374.45s/it]
training process:  62%|██████▎   | 80/128 [8:16:39<4:59:21, 374.19s/it]
training process:  63%|██████▎   | 81/128 [8:22:54<4:53:18, 374.43s/it]epoch : 81, train loss : 0.000, valid loss : 0.029, train acc : 0.998, valid acc : 0.955, train f1 : 0.998, valid f1 : 0.720

training process:  64%|██████▍   | 82/128 [8:29:08<4:47:00, 374.37s/it]
training process:  65%|██████▍   | 83/128 [8:35:21<4:40:29, 373.98s/it]
training process:  66%|██████▌   | 84/128 [8:41:46<4:36:30, 377.05s/it]
training process:  66%|██████▋   | 85/128 [8:48:58<4:42:07, 393.67s/it]epoch : 85, train loss : 0.000, valid loss : 0.026, train acc : 0.998, valid acc : 0.954, train f1 : 0.998, valid f1 : 0.722

training process:  67%|██████▋   | 86/128 [8:56:21<4:45:53, 408.42s/it]
training process:  68%|██████▊   | 87/128 [9:03:46<4:46:37, 419.44s/it]
training process:  69%|██████▉   | 88/128 [9:11:11<4:44:44, 427.11s/it]
training process:  70%|██████▉   | 89/128 [9:18:41<4:42:07, 434.04s/it]epoch : 89, train loss : 0.000, valid loss : 0.031, train acc : 0.998, valid acc : 0.954, train f1 : 0.998, valid f1 : 0.714

training process:  70%|███████   | 90/128 [9:26:04<4:36:30, 436.59s/it]
training process:  71%|███████   | 91/128 [9:33:24<4:29:55, 437.71s/it]
training process:  72%|███████▏  | 92/128 [9:40:48<4:23:40, 439.46s/it]
training process:  73%|███████▎  | 93/128 [9:48:12<4:17:07, 440.79s/it]epoch : 93, train loss : 0.000, valid loss : 0.032, train acc : 0.998, valid acc : 0.959, train f1 : 0.998, valid f1 : 0.725

training process:  73%|███████▎  | 94/128 [9:55:34<4:10:00, 441.20s/it]
training process:  74%|███████▍  | 95/128 [10:02:59<4:03:17, 442.36s/it]
training process:  75%|███████▌  | 96/128 [10:10:22<3:56:02, 442.57s/it]
training process:  76%|███████▌  | 97/128 [10:17:43<3:48:29, 442.25s/it]epoch : 97, train loss : 0.000, valid loss : 0.034, train acc : 0.999, valid acc : 0.964, train f1 : 0.999, valid f1 : 0.744

training process:  77%|███████▋  | 98/128 [10:25:44<3:46:52, 453.74s/it]
training process:  77%|███████▋  | 99/128 [10:34:05<3:46:12, 468.03s/it]
training process:  78%|███████▊  | 100/128 [10:42:25<3:42:53, 477.64s/it]
training process:  79%|███████▉  | 101/128 [10:50:55<3:39:14, 487.21s/it]epoch : 101, train loss : 0.000, valid loss : 0.033, train acc : 0.999, valid acc : 0.961, train f1 : 0.999, valid f1 : 0.735

training process:  80%|███████▉  | 102/128 [10:59:09<3:32:02, 489.32s/it]
training process:  80%|████████  | 103/128 [11:07:27<3:24:59, 491.97s/it]
training process:  81%|████████▏ | 104/128 [11:15:49<3:18:00, 495.01s/it]
training process:  82%|████████▏ | 105/128 [11:24:05<3:09:48, 495.15s/it]epoch : 105, train loss : 0.000, valid loss : 0.035, train acc : 0.999, valid acc : 0.969, train f1 : 0.999, valid f1 : 0.767

training process:  83%|████████▎ | 106/128 [11:31:37<2:56:52, 482.37s/it]
training process:  84%|████████▎ | 107/128 [11:42:08<3:04:22, 526.78s/it]
training process:  84%|████████▍ | 108/128 [11:55:37<3:23:51, 611.57s/it]
training process:  85%|████████▌ | 109/128 [12:09:47<3:36:16, 682.98s/it]epoch : 109, train loss : 0.000, valid loss : 0.034, train acc : 0.999, valid acc : 0.967, train f1 : 0.999, valid f1 : 0.759

training process:  86%|████████▌ | 110/128 [12:23:53<3:39:34, 731.93s/it]
training process:  87%|████████▋ | 111/128 [12:38:10<3:37:58, 769.35s/it]
training process:  88%|████████▊ | 112/128 [12:51:03<3:25:27, 770.49s/it]
training process:  88%|████████▊ | 113/128 [13:03:51<3:12:27, 769.84s/it]epoch : 113, train loss : 0.000, valid loss : 0.039, train acc : 0.999, valid acc : 0.969, train f1 : 0.999, valid f1 : 0.762

training process:  89%|████████▉ | 114/128 [13:17:28<3:02:57, 784.08s/it]
training process:  90%|████████▉ | 115/128 [13:30:21<2:49:09, 780.74s/it]
training process:  91%|█████████ | 116/128 [13:43:19<2:35:56, 779.69s/it]
training process:  91%|█████████▏| 117/128 [13:55:59<2:21:53, 773.92s/it]epoch : 117, train loss : 0.000, valid loss : 0.036, train acc : 0.999, valid acc : 0.965, train f1 : 0.999, valid f1 : 0.752

training process:  92%|█████████▏| 118/128 [14:08:43<2:08:28, 770.90s/it]
training process:  93%|█████████▎| 119/128 [14:21:01<1:54:09, 761.01s/it]
training process:  94%|█████████▍| 120/128 [14:33:14<1:40:21, 752.72s/it]
training process:  95%|█████████▍| 121/128 [14:45:02<1:26:14, 739.28s/it]epoch : 121, train loss : 0.000, valid loss : 0.037, train acc : 0.999, valid acc : 0.966, train f1 : 0.999, valid f1 : 0.753
training process:  95%|█████████▌| 122/128 [14:57:13<1:13:40, 736.70s/it]bash: ./exp_la_r2plus1d.sh: Permission denied
training process:  96%|█████████▌| 123/128 [15:09:27<1:01:19, 735.99s/it]training process:  97%|█████████▋| 124/128 [15:21:16<48:31, 727.90s/it]  training process:  98%|█████████▊| 125/128 [15:33:05<36:06, 722.28s/it]epoch : 125, train loss : 0.000, valid loss : 0.041, train acc : 1.000, valid acc : 0.971, train f1 : 1.000, valid f1 : 0.772
training process:  98%|█████████▊| 126/128 [15:45:07<24:04, 722.01s/it]training process:  99%|█████████▉| 127/128 [15:56:52<11:56, 716.88s/it]training process: 100%|██████████| 128/128 [16:09:32<00:00, 729.78s/it]training process: 100%|██████████| 128/128 [16:09:32<00:00, 454.47s/it]
training process finished, best loss : 0.022 and best acc : 0.977, best f1 : 0.813, best epoch : 40

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.66      0.80      0.72       276
           1       0.99      0.99      0.99     10738

    accuracy                           0.98     11014
   macro avg       0.83      0.89      0.86     11014
weighted avg       0.99      0.98      0.99     11014


# test acc : 0.98, test f1 : 0.86, test AUC : 0.89, test loss : 1.654

################# Visualization process #################

/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
extract the null data:   0%|          | 0/227 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 42/227 [00:00<00:00, 410.25it/s]extract the null data:  40%|███▉      | 90/227 [00:00<00:00, 446.92it/s]extract the null data:  61%|██████    | 139/227 [00:00<00:00, 465.37it/s]extract the null data:  82%|████████▏ | 186/227 [00:00<00:00, 410.14it/s]extract the null data: 100%|██████████| 227/227 [00:00<00:00, 432.99it/s]
# check | video data : 36013, 0D data : 36013
extract the null data:   0%|          | 0/57 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 13/57 [00:00<00:00, 103.63it/s]extract the null data:  46%|████▌     | 26/57 [00:00<00:00, 117.12it/s]extract the null data:  74%|███████▎  | 42/57 [00:00<00:00, 130.00it/s]extract the null data: 100%|██████████| 57/57 [00:00<00:00, 143.37it/s]
# check | video data : 9002, 0D data : 9002
extract the null data:   0%|          | 0/71 [00:00<?, ?it/s]extract the null data:  76%|███████▌  | 54/71 [00:00<00:00, 535.09it/s]extract the null data: 100%|██████████| 71/71 [00:00<00:00, 476.77it/s]
# check | video data : 10968, 0D data : 10968
train data : 36013, disrupt : 860, non-disrupt : 35153
valid data : 9002, disrupt : 216, non-disrupt : 8786
test data : 10968, disrupt : 276, non-disrupt : 10692

################# model summary #################

-----------------------------------------------------------------------------------
             Layer (type)              Input Shape         Param #     Tr. Param #
===================================================================================
           ViViTEncoder-1     [8, 3, 21, 128, 128]       3,429,888       3,429,888
   TStransformerEncoder-2              [8, 21, 12]         794,752         794,752
                 Linear-3                 [8, 256]          32,896          32,896
            BatchNorm1d-4                 [8, 128]             256             256
                   ReLU-5                 [8, 128]               0               0
                 Linear-6                 [8, 128]             258             258
===================================================================================
Total params: 4,258,050
Trainable params: 4,258,050
Non-trainable params: 0
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.016, train acc : 0.666, valid acc : 0.365, train f1 : 0.624, valid f1 : 0.294
training process:   1%|          | 1/128 [20:28<43:20:04, 1228.38s/it]training process:   2%|▏         | 2/128 [41:05<43:10:06, 1233.39s/it]training process:   2%|▏         | 3/128 [1:02:01<43:10:57, 1243.66s/it]training process:   3%|▎         | 4/128 [1:22:40<42:46:22, 1241.80s/it]epoch : 5, train loss : 0.003, valid loss : 0.011, train acc : 0.945, valid acc : 0.767, train f1 : 0.945, valid f1 : 0.514
training process:   4%|▍         | 5/128 [1:43:12<42:18:24, 1238.25s/it]training process:   5%|▍         | 6/128 [2:03:38<41:49:40, 1234.27s/it]