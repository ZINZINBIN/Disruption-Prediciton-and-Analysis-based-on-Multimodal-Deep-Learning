############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 551.53it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 575.41it/s]extract the null data:  32%|███▏      | 175/553 [00:00<00:00, 579.98it/s]extract the null data:  42%|████▏     | 234/553 [00:00<00:00, 573.93it/s]extract the null data:  53%|█████▎    | 294/553 [00:00<00:00, 582.16it/s]extract the null data:  64%|██████▍   | 354/553 [00:00<00:00, 587.65it/s]extract the null data:  75%|███████▌  | 415/553 [00:00<00:00, 593.54it/s]extract the null data:  86%|████████▌ | 475/553 [00:00<00:00, 532.18it/s]extract the null data:  97%|█████████▋| 536/553 [00:00<00:00, 552.27it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 565.26it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 197.13it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 175.65it/s]replace nan value:  10%|█         | 58/553 [00:00<00:03, 141.21it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:03, 133.89it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:03, 138.45it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 161.72it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:02, 177.98it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:02, 190.19it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:01, 197.31it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:01, 202.75it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 206.12it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 164.82it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:02, 145.74it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 160.47it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 174.69it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 168.48it/s]replace nan value:  61%|██████▏   | 339/553 [00:02<00:01, 162.33it/s]replace nan value:  65%|██████▍   | 358/553 [00:02<00:01, 169.18it/s]replace nan value:  68%|██████▊   | 376/553 [00:02<00:01, 157.74it/s]replace nan value:  71%|███████   | 393/553 [00:02<00:01, 147.31it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 164.44it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 158.83it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 156.45it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 164.38it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 168.97it/s]replace nan value:  92%|█████████▏| 506/553 [00:03<00:00, 152.13it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 135.39it/s]replace nan value:  97%|█████████▋| 537/553 [00:03<00:00, 123.69it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 159.00it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|▏         | 7/553 [00:00<00:08, 64.74it/s]  4%|▍         | 24/553 [00:00<00:04, 120.98it/s]  7%|▋         | 40/553 [00:00<00:03, 133.88it/s] 10%|▉         | 54/553 [00:00<00:03, 127.23it/s] 12%|█▏        | 67/553 [00:00<00:04, 120.77it/s] 15%|█▍        | 82/553 [00:00<00:03, 128.12it/s] 17%|█▋        | 95/553 [00:00<00:03, 120.09it/s] 20%|█▉        | 108/553 [00:00<00:03, 121.51it/s] 22%|██▏       | 124/553 [00:00<00:03, 131.41it/s] 25%|██▌       | 141/553 [00:01<00:02, 140.66it/s] 29%|██▉       | 161/553 [00:01<00:02, 154.03it/s] 32%|███▏      | 178/553 [00:01<00:02, 156.28it/s] 35%|███▌      | 196/553 [00:01<00:02, 162.11it/s] 39%|███▊      | 214/553 [00:01<00:02, 164.65it/s] 42%|████▏     | 231/553 [00:01<00:02, 118.38it/s] 45%|████▍     | 248/553 [00:01<00:02, 129.98it/s] 48%|████▊     | 264/553 [00:01<00:02, 136.93it/s] 50%|█████     | 279/553 [00:02<00:02, 135.48it/s] 53%|█████▎    | 294/553 [00:02<00:01, 135.97it/s] 56%|█████▌    | 309/553 [00:02<00:01, 135.13it/s] 58%|█████▊    | 323/553 [00:02<00:01, 119.75it/s] 61%|██████▏   | 339/553 [00:02<00:01, 128.51it/s] 64%|██████▍   | 353/553 [00:02<00:01, 130.46it/s] 66%|██████▋   | 367/553 [00:02<00:01, 131.13it/s] 69%|██████▉   | 384/553 [00:02<00:01, 139.02it/s] 72%|███████▏  | 399/553 [00:03<00:01, 123.48it/s] 75%|███████▌  | 415/553 [00:03<00:01, 132.35it/s] 78%|███████▊  | 429/553 [00:03<00:01, 123.88it/s] 81%|████████  | 448/553 [00:03<00:00, 140.95it/s] 84%|████████▍ | 464/553 [00:03<00:00, 145.73it/s] 87%|████████▋ | 479/553 [00:03<00:00, 144.23it/s] 89%|████████▉ | 494/553 [00:03<00:00, 137.74it/s] 92%|█████████▏| 510/553 [00:03<00:00, 142.56it/s] 95%|█████████▍| 525/553 [00:03<00:00, 130.01it/s] 97%|█████████▋| 539/553 [00:04<00:00, 126.73it/s]100%|█████████▉| 552/553 [00:04<00:00, 91.33it/s] 100%|██████████| 553/553 [00:04<00:00, 127.99it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   9%|▉         | 13/139 [00:00<00:00, 129.99it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 457.40it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 502.00it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 457.07it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 231.46it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 231.75it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 224.58it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 226.04it/s]replace nan value:  85%|████████▍ | 118/139 [00:00<00:00, 226.12it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 226.35it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 127.49it/s] 20%|██        | 28/139 [00:00<00:00, 139.95it/s] 31%|███       | 43/139 [00:00<00:00, 128.66it/s] 40%|████      | 56/139 [00:00<00:00, 119.82it/s] 50%|████▉     | 69/139 [00:00<00:00, 105.45it/s] 60%|█████▉    | 83/139 [00:00<00:00, 114.76it/s] 68%|██████▊   | 95/139 [00:00<00:00, 116.24it/s] 78%|███████▊  | 109/139 [00:00<00:00, 122.87it/s] 88%|████████▊ | 123/139 [00:01<00:00, 121.14it/s] 98%|█████████▊| 136/139 [00:01<00:00, 116.06it/s]100%|██████████| 139/139 [00:01<00:00, 119.75it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 25/173 [00:00<00:00, 248.96it/s]extract the null data:  46%|████▌     | 80/173 [00:00<00:00, 425.13it/s]extract the null data:  80%|███████▉  | 138/173 [00:00<00:00, 493.00it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 487.48it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 223.66it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 188.79it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 146.51it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 130.56it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 156.13it/s]replace nan value:  71%|███████   | 122/173 [00:00<00:00, 154.56it/s]replace nan value:  82%|████████▏ | 142/173 [00:00<00:00, 164.09it/s]replace nan value:  92%|█████████▏| 159/173 [00:01<00:00, 138.77it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 144.93it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▌         | 9/173 [00:00<00:01, 89.58it/s] 10%|█         | 18/173 [00:00<00:01, 86.55it/s] 16%|█▌        | 27/173 [00:00<00:01, 81.86it/s] 26%|██▌       | 45/173 [00:00<00:01, 117.31it/s] 33%|███▎      | 57/173 [00:00<00:01, 111.62it/s] 40%|███▉      | 69/173 [00:00<00:00, 105.56it/s] 46%|████▌     | 80/173 [00:00<00:00, 98.08it/s]  54%|█████▍    | 94/173 [00:00<00:00, 108.60it/s] 65%|██████▍   | 112/173 [00:01<00:00, 127.66it/s] 73%|███████▎  | 126/173 [00:01<00:00, 113.82it/s] 80%|████████  | 139/173 [00:01<00:00, 116.93it/s] 88%|████████▊ | 153/173 [00:01<00:00, 121.87it/s] 96%|█████████▌| 166/173 [00:01<00:00, 85.00it/s] 100%|██████████| 173/173 [00:01<00:00, 98.41it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.480, valid loss : 0.404, train acc : 0.890, valid acc : 0.918, train f1 : 0.514, valid f1 : 0.518
training process:   1%|          | 1/128 [01:31<3:12:37, 91.00s/it]Best score increase :0.000 -> 0.518
training process:   2%|▏         | 2/128 [02:53<3:00:38, 86.02s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [04:14<2:54:49, 83.92s/it]Best score increase :0.518 -> 0.579
training process:   3%|▎         | 4/128 [05:48<3:01:37, 87.88s/it]Best score increase :0.579 -> 0.686
epoch : 5, train loss : 0.222, valid loss : 0.220, train acc : 0.939, valid acc : 0.940, train f1 : 0.709, valid f1 : 0.739
training process:   4%|▍         | 5/128 [07:38<3:16:12, 95.71s/it]Best score increase :0.686 -> 0.739
training process:   5%|▍         | 6/128 [09:15<3:15:09, 95.98s/it]Best score increase :0.739 -> 0.762
training process:   5%|▌         | 7/128 [11:10<3:26:27, 102.38s/it]Best score increase :0.762 -> 0.793
training process:   6%|▋         | 8/128 [12:59<3:28:46, 104.39s/it]Best score increase :0.793 -> 0.802
epoch : 9, train loss : 0.162, valid loss : 0.168, train acc : 0.953, valid acc : 0.952, train f1 : 0.799, valid f1 : 0.799
training process:   7%|▋         | 9/128 [14:50<3:31:02, 106.41s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [16:13<3:15:35, 99.45s/it]Best score increase :0.802 -> 0.805
training process:   9%|▊         | 11/128 [18:04<3:20:48, 102.98s/it]Best score increase :0.805 -> 0.823
training process:   9%|▉         | 12/128 [19:46<3:18:27, 102.65s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.144, valid loss : 0.153, train acc : 0.957, valid acc : 0.954, train f1 : 0.820, valid f1 : 0.810
training process:  10%|█         | 13/128 [21:36<3:20:31, 104.63s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [23:02<3:08:22, 99.14s/it] Best score increase :0.823 -> 0.836
training process:  12%|█▏        | 15/128 [24:41<3:06:47, 99.18s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [26:14<3:01:35, 97.28s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.136, valid loss : 0.144, train acc : 0.958, valid acc : 0.957, train f1 : 0.828, valid f1 : 0.825
training process:  13%|█▎        | 17/128 [28:06<3:08:04, 101.67s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [29:31<2:57:23, 96.76s/it] EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [30:34<2:37:16, 86.58s/it]Best score increase :0.836 -> 0.841
training process:  16%|█▌        | 20/128 [31:38<2:23:45, 79.87s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.131, valid loss : 0.146, train acc : 0.959, valid acc : 0.956, train f1 : 0.836, valid f1 : 0.817
training process:  16%|█▋        | 21/128 [32:50<2:18:12, 77.50s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [33:55<2:10:05, 73.64s/it]EarlyStopping counter : 3 out of 12
training process:  18%|█▊        | 23/128 [35:00<2:04:05, 70.91s/it]EarlyStopping counter : 4 out of 12
training process:  19%|█▉        | 24/128 [36:05<2:00:12, 69.35s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.126, valid loss : 0.134, train acc : 0.960, valid acc : 0.960, train f1 : 0.841, valid f1 : 0.846
training process:  20%|█▉        | 25/128 [37:23<2:03:25, 71.90s/it]Best score increase :0.841 -> 0.846
training process:  20%|██        | 26/128 [38:27<1:57:56, 69.38s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [39:30<1:53:37, 67.50s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [40:35<1:51:07, 66.67s/it]Best score increase :0.846 -> 0.850
epoch : 29, train loss : 0.124, valid loss : 0.134, train acc : 0.961, valid acc : 0.958, train f1 : 0.844, valid f1 : 0.846
training process:  23%|██▎       | 29/128 [41:49<1:53:40, 68.90s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [42:50<1:48:52, 66.65s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [43:56<1:47:13, 66.32s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [45:03<1:46:42, 66.70s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.120, valid loss : 0.129, train acc : 0.961, valid acc : 0.959, train f1 : 0.848, valid f1 : 0.847
training process:  26%|██▌       | 33/128 [46:17<1:49:01, 68.85s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [47:33<1:51:09, 70.95s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [48:39<1:47:47, 69.55s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [50:06<1:54:26, 74.63s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.117, valid loss : 0.128, train acc : 0.962, valid acc : 0.960, train f1 : 0.853, valid f1 : 0.848
training process:  29%|██▉       | 37/128 [51:31<1:58:07, 77.88s/it]EarlyStopping counter : 9 out of 12
training process:  30%|██▉       | 38/128 [52:56<2:00:04, 80.05s/it]EarlyStopping counter : 10 out of 12
training process:  30%|███       | 39/128 [54:29<2:04:33, 83.98s/it]EarlyStopping counter : 11 out of 12
training process:  30%|███       | 39/128 [55:47<2:07:20, 85.84s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 39, best f1 score : 0.850
training process finished, best loss : 0.136 and best acc : 0.959, best f1 : 0.850, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.72      0.66      0.69       580
           1       0.97      0.98      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.84      0.82      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.82, test loss : 8.680

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:12<02:21, 12.85s/it]processing for feature importance:  17%|█▋        | 2/12 [00:25<02:08, 12.83s/it]processing for feature importance:  25%|██▌       | 3/12 [00:35<01:45, 11.68s/it]processing for feature importance:  33%|███▎      | 4/12 [00:48<01:34, 11.83s/it]processing for feature importance:  42%|████▏     | 5/12 [01:00<01:24, 12.11s/it]processing for feature importance:  50%|█████     | 6/12 [01:12<01:11, 11.99s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:25<01:00, 12.20s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:41<00:53, 13.43s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:54<00:40, 13.36s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:08<00:27, 13.68s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:22<00:13, 13.59s/it]processing for feature importance: 100%|██████████| 12/12 [02:36<00:00, 13.89s/it]processing for feature importance: 100%|██████████| 12/12 [02:36<00:00, 13.05s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  2%|▏         | 7/306 [00:00<00:04, 68.77it/s]  6%|▌         | 19/306 [00:00<00:02, 98.03it/s]  9%|▉         | 29/306 [00:00<00:02, 95.09it/s] 13%|█▎        | 40/306 [00:00<00:02, 97.07it/s] 20%|█▉        | 61/306 [00:00<00:01, 135.59it/s] 29%|██▉       | 89/306 [00:00<00:01, 182.65it/s] 36%|███▋      | 111/306 [00:00<00:01, 193.66it/s] 46%|████▌     | 140/306 [00:00<00:00, 221.87it/s] 53%|█████▎    | 163/306 [00:00<00:00, 195.97it/s] 60%|██████    | 184/306 [00:01<00:00, 156.06it/s] 66%|██████▌   | 202/306 [00:01<00:00, 133.20it/s] 71%|███████   | 217/306 [00:01<00:00, 122.31it/s] 75%|███████▌  | 231/306 [00:01<00:00, 115.03it/s] 80%|███████▉  | 244/306 [00:01<00:00, 109.74it/s] 84%|████████▎ | 256/306 [00:01<00:00, 106.45it/s] 87%|████████▋ | 267/306 [00:02<00:00, 105.20it/s] 91%|█████████ | 278/306 [00:02<00:00, 90.77it/s]  94%|█████████▍| 288/306 [00:02<00:00, 91.32it/s]100%|██████████| 306/306 [00:02<00:00, 127.50it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   4%|▎         | 20/553 [00:00<00:02, 197.01it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:02, 206.04it/s]extract the null data:  14%|█▎        | 75/553 [00:00<00:01, 245.64it/s]extract the null data:  18%|█▊        | 100/553 [00:00<00:01, 244.12it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:01, 270.31it/s]extract the null data:  30%|██▉       | 165/553 [00:00<00:01, 289.43it/s]extract the null data:  35%|███▌      | 195/553 [00:00<00:01, 284.14it/s]extract the null data:  41%|████      | 226/553 [00:00<00:01, 289.99it/s]extract the null data:  46%|████▋     | 257/553 [00:00<00:01, 294.69it/s]extract the null data:  53%|█████▎    | 292/553 [00:01<00:00, 309.85it/s]extract the null data:  64%|██████▍   | 355/553 [00:01<00:00, 404.77it/s]extract the null data:  72%|███████▏  | 396/553 [00:01<00:00, 385.59it/s]extract the null data:  79%|███████▊  | 435/553 [00:01<00:00, 355.49it/s]extract the null data:  85%|████████▌ | 472/553 [00:01<00:00, 339.57it/s]extract the null data:  92%|█████████▏| 507/553 [00:01<00:00, 315.89it/s]extract the null data:  98%|█████████▊| 540/553 [00:01<00:00, 279.19it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 301.03it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 10/553 [00:00<00:06, 87.40it/s]replace nan value:   5%|▍         | 25/553 [00:00<00:04, 121.58it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:03, 127.94it/s]replace nan value:  11%|█         | 61/553 [00:00<00:03, 146.09it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 168.61it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 173.93it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 154.12it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:02, 171.12it/s]replace nan value:  30%|███       | 167/553 [00:01<00:02, 182.70it/s]replace nan value:  34%|███▎      | 186/553 [00:01<00:02, 155.22it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:02, 134.06it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:02, 121.73it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:02, 140.59it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:02, 129.63it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:02, 124.66it/s]replace nan value:  51%|█████     | 283/553 [00:02<00:02, 119.36it/s]replace nan value:  54%|█████▎    | 296/553 [00:02<00:02, 115.34it/s]replace nan value:  56%|█████▌    | 308/553 [00:02<00:02, 115.12it/s]replace nan value:  58%|█████▊    | 320/553 [00:02<00:02, 111.73it/s]replace nan value:  60%|██████    | 332/553 [00:02<00:02, 110.47it/s]replace nan value:  63%|██████▎   | 350/553 [00:02<00:01, 128.65it/s]replace nan value:  67%|██████▋   | 372/553 [00:02<00:01, 152.25it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:00, 165.40it/s]replace nan value:  74%|███████▍  | 410/553 [00:02<00:00, 169.01it/s]replace nan value:  78%|███████▊  | 431/553 [00:02<00:00, 179.86it/s]replace nan value:  81%|████████▏ | 450/553 [00:03<00:00, 173.05it/s]replace nan value:  85%|████████▍ | 468/553 [00:03<00:00, 140.07it/s]replace nan value:  88%|████████▊ | 484/553 [00:03<00:00, 129.13it/s]replace nan value:  91%|█████████▏| 505/553 [00:03<00:00, 148.20it/s]replace nan value:  95%|█████████▌| 526/553 [00:03<00:00, 163.64it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 176.66it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 146.01it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 4/553 [00:00<00:16, 33.26it/s]  2%|▏         | 10/553 [00:00<00:12, 41.94it/s]  3%|▎         | 18/553 [00:00<00:09, 55.98it/s]  4%|▍         | 24/553 [00:00<00:10, 52.70it/s]  6%|▌         | 31/553 [00:00<00:09, 57.54it/s]  7%|▋         | 39/553 [00:00<00:08, 63.75it/s]  8%|▊         | 46/553 [00:00<00:08, 57.92it/s] 10%|█         | 57/553 [00:00<00:07, 68.53it/s] 12%|█▏        | 64/553 [00:01<00:07, 67.03it/s] 13%|█▎        | 71/553 [00:01<00:07, 62.91it/s] 14%|█▍        | 79/553 [00:01<00:07, 66.65it/s] 17%|█▋        | 92/553 [00:01<00:05, 83.54it/s] 19%|█▉        | 107/553 [00:01<00:04, 101.26it/s] 22%|██▏       | 122/553 [00:01<00:03, 114.53it/s] 24%|██▍       | 134/553 [00:01<00:03, 107.46it/s] 26%|██▋       | 146/553 [00:01<00:03, 106.54it/s] 28%|██▊       | 157/553 [00:01<00:04, 98.19it/s]  31%|███       | 169/553 [00:02<00:03, 101.63it/s] 33%|███▎      | 180/553 [00:02<00:03, 95.04it/s]  36%|███▌      | 197/553 [00:02<00:03, 113.03it/s] 39%|███▉      | 215/553 [00:02<00:02, 124.11it/s] 41%|████▏     | 229/553 [00:02<00:02, 127.66it/s] 44%|████▍     | 244/553 [00:02<00:02, 132.34it/s] 47%|████▋     | 262/553 [00:02<00:02, 144.20it/s] 50%|█████     | 277/553 [00:02<00:02, 126.90it/s] 53%|█████▎    | 291/553 [00:03<00:02, 114.07it/s] 55%|█████▍    | 303/553 [00:03<00:02, 111.93it/s] 57%|█████▋    | 316/553 [00:03<00:02, 114.28it/s] 60%|█████▉    | 331/553 [00:03<00:01, 121.98it/s] 63%|██████▎   | 346/553 [00:03<00:01, 129.06it/s] 65%|██████▌   | 360/553 [00:03<00:01, 124.96it/s] 68%|██████▊   | 377/553 [00:03<00:01, 135.12it/s] 71%|███████   | 391/553 [00:03<00:01, 126.92it/s] 73%|███████▎  | 404/553 [00:03<00:01, 111.92it/s] 75%|███████▌  | 416/553 [00:04<00:01, 113.39it/s] 77%|███████▋  | 428/553 [00:04<00:01, 109.61it/s] 81%|████████  | 446/553 [00:04<00:00, 127.57it/s] 84%|████████▎ | 462/553 [00:04<00:00, 135.11it/s] 86%|████████▌ | 476/553 [00:04<00:00, 116.79it/s] 88%|████████▊ | 489/553 [00:04<00:00, 94.87it/s]  90%|█████████ | 500/553 [00:04<00:00, 81.36it/s] 92%|█████████▏| 510/553 [00:05<00:00, 79.24it/s] 94%|█████████▍| 519/553 [00:05<00:00, 73.13it/s] 95%|█████████▌| 527/553 [00:05<00:00, 61.39it/s] 97%|█████████▋| 534/553 [00:05<00:00, 62.50it/s] 98%|█████████▊| 541/553 [00:05<00:00, 61.35it/s]100%|█████████▉| 551/553 [00:05<00:00, 54.57it/s]100%|██████████| 553/553 [00:05<00:00, 92.86it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   1%|          | 1/139 [00:00<00:24,  5.60it/s]extract the null data:  18%|█▊        | 25/139 [00:00<00:01, 109.16it/s]extract the null data:  31%|███       | 43/139 [00:00<00:00, 131.53it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 212.99it/s]extract the null data:  81%|████████  | 112/139 [00:00<00:00, 240.21it/s]extract the null data:  99%|█████████▉| 138/139 [00:00<00:00, 236.00it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 190.55it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:   6%|▋         | 9/139 [00:00<00:01, 79.53it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:01, 90.27it/s]replace nan value:  24%|██▎       | 33/139 [00:00<00:01, 101.40it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 111.62it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 111.41it/s]replace nan value:  51%|█████     | 71/139 [00:00<00:00, 115.79it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 119.05it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 114.09it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 117.92it/s]replace nan value:  87%|████████▋ | 121/139 [00:01<00:00, 98.41it/s] replace nan value:  95%|█████████▍| 132/139 [00:01<00:00, 93.72it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 102.07it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  3%|▎         | 4/139 [00:00<00:03, 36.25it/s]  9%|▉         | 13/139 [00:00<00:02, 58.69it/s] 14%|█▎        | 19/139 [00:00<00:02, 49.92it/s] 23%|██▎       | 32/139 [00:00<00:01, 74.42it/s] 33%|███▎      | 46/139 [00:00<00:00, 93.21it/s] 42%|████▏     | 58/139 [00:00<00:00, 101.19it/s] 50%|████▉     | 69/139 [00:00<00:00, 103.19it/s] 58%|█████▊    | 80/139 [00:00<00:00, 90.44it/s]  65%|██████▍   | 90/139 [00:01<00:00, 79.96it/s] 71%|███████   | 99/139 [00:01<00:00, 71.32it/s] 77%|███████▋  | 107/139 [00:01<00:00, 65.56it/s] 82%|████████▏ | 114/139 [00:01<00:00, 60.36it/s] 87%|████████▋ | 121/139 [00:01<00:00, 56.64it/s] 94%|█████████▍| 131/139 [00:01<00:00, 66.21it/s]100%|██████████| 139/139 [00:01<00:00, 73.91it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   8%|▊         | 14/173 [00:00<00:01, 139.17it/s]extract the null data:  35%|███▌      | 61/173 [00:00<00:00, 331.46it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 384.25it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 408.96it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 394.38it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 230.09it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 192.89it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 156.55it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 156.55it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 121.85it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 87.24it/s] replace nan value:  73%|███████▎  | 127/173 [00:01<00:00, 77.13it/s]replace nan value:  79%|███████▊  | 136/173 [00:01<00:00, 73.87it/s]replace nan value:  84%|████████▍ | 145/173 [00:01<00:00, 74.59it/s]replace nan value:  88%|████████▊ | 153/173 [00:01<00:00, 73.29it/s]replace nan value:  93%|█████████▎| 161/173 [00:01<00:00, 64.87it/s]replace nan value:  97%|█████████▋| 168/173 [00:01<00:00, 60.21it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 88.00it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  3%|▎         | 5/173 [00:00<00:03, 47.05it/s]  8%|▊         | 14/173 [00:00<00:02, 65.38it/s] 12%|█▏        | 21/173 [00:00<00:03, 47.94it/s] 16%|█▌        | 27/173 [00:00<00:03, 44.79it/s] 19%|█▉        | 33/173 [00:00<00:03, 46.15it/s] 23%|██▎       | 39/173 [00:00<00:02, 49.09it/s] 27%|██▋       | 46/173 [00:00<00:02, 53.68it/s] 30%|███       | 52/173 [00:01<00:02, 54.65it/s] 34%|███▍      | 59/173 [00:01<00:01, 58.15it/s] 38%|███▊      | 65/173 [00:01<00:02, 51.14it/s] 42%|████▏     | 73/173 [00:01<00:01, 54.92it/s] 46%|████▌     | 79/173 [00:01<00:01, 55.43it/s] 49%|████▉     | 85/173 [00:01<00:01, 54.66it/s] 53%|█████▎    | 91/173 [00:01<00:01, 55.73it/s] 56%|█████▌    | 97/173 [00:01<00:01, 50.68it/s] 60%|██████    | 104/173 [00:01<00:01, 53.63it/s] 65%|██████▌   | 113/173 [00:02<00:00, 61.11it/s] 69%|██████▉   | 120/173 [00:02<00:00, 61.77it/s] 76%|███████▌  | 131/173 [00:02<00:00, 73.69it/s] 84%|████████▍ | 145/173 [00:02<00:00, 91.24it/s] 90%|████████▉ | 155/173 [00:02<00:00, 90.87it/s] 95%|█████████▌| 165/173 [00:02<00:00, 66.84it/s]100%|██████████| 173/173 [00:03<00:00, 52.55it/s]100%|██████████| 173/173 [00:03<00:00, 57.55it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.632, valid loss : 0.506, train acc : 0.647, valid acc : 0.757, train f1 : 0.646, valid f1 : 0.586
training process:   1%|          | 1/128 [02:04<4:22:56, 124.23s/it]Best score increase :0.000 -> 0.586
training process:   2%|▏         | 2/128 [03:43<3:50:16, 109.65s/it]Best score increase :0.586 -> 0.627
training process:   2%|▏         | 3/128 [05:13<3:29:06, 100.37s/it]Best score increase :0.627 -> 0.723
training process:   3%|▎         | 4/128 [06:39<3:15:56, 94.81s/it] Best score increase :0.723 -> 0.757
epoch : 5, train loss : 0.370, valid loss : 0.292, train acc : 0.840, valid acc : 0.903, train f1 : 0.839, valid f1 : 0.752
training process:   4%|▍         | 5/128 [08:32<3:27:51, 101.39s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [10:10<3:24:12, 100.43s/it]Best score increase :0.757 -> 0.763
training process:   5%|▌         | 7/128 [11:57<3:26:27, 102.38s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [13:28<3:17:22, 98.68s/it] EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.326, valid loss : 0.247, train acc : 0.858, valid acc : 0.928, train f1 : 0.858, valid f1 : 0.797
training process:   7%|▋         | 9/128 [15:13<3:19:54, 100.79s/it]Best score increase :0.763 -> 0.797
training process:   8%|▊         | 10/128 [16:50<3:16:05, 99.70s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [18:28<3:13:17, 99.12s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [20:07<3:11:18, 98.95s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.296, valid loss : 0.320, train acc : 0.868, valid acc : 0.872, train f1 : 0.868, valid f1 : 0.727
training process:  10%|█         | 13/128 [22:00<3:18:07, 103.37s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [23:32<3:09:41, 99.83s/it] EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [25:06<3:05:00, 98.24s/it]EarlyStopping counter : 6 out of 12
training process:  12%|█▎        | 16/128 [26:40<3:00:54, 96.91s/it]EarlyStopping counter : 7 out of 12
epoch : 17, train loss : 0.277, valid loss : 0.269, train acc : 0.882, valid acc : 0.897, train f1 : 0.882, valid f1 : 0.759
training process:  13%|█▎        | 17/128 [28:22<3:01:54, 98.33s/it]EarlyStopping counter : 8 out of 12
training process:  14%|█▍        | 18/128 [29:57<2:58:27, 97.34s/it]EarlyStopping counter : 9 out of 12
training process:  15%|█▍        | 19/128 [31:22<2:50:18, 93.75s/it]EarlyStopping counter : 10 out of 12
training process:  16%|█▌        | 20/128 [33:00<2:51:04, 95.04s/it]EarlyStopping counter : 11 out of 12
epoch : 21, train loss : 0.263, valid loss : 0.285, train acc : 0.888, valid acc : 0.894, train f1 : 0.888, valid f1 : 0.760
training process:  16%|█▌        | 20/128 [34:57<3:08:45, 104.87s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 20, best f1 score : 0.797
training process finished, best loss : 0.247 and best acc : 0.928, best f1 : 0.797, best epoch : 8

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.46      0.76      0.57       580
           1       0.98      0.92      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.72      0.84      0.76      7398
weighted avg       0.94      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.76, test AUC : 0.84, test loss : 15.776

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:15<02:49, 15.45s/it]processing for feature importance:  17%|█▋        | 2/12 [00:28<02:22, 14.28s/it]processing for feature importance:  25%|██▌       | 3/12 [00:43<02:10, 14.54s/it]processing for feature importance:  33%|███▎      | 4/12 [00:59<01:59, 14.90s/it]processing for feature importance:  42%|████▏     | 5/12 [01:14<01:44, 14.86s/it]processing for feature importance:  50%|█████     | 6/12 [01:28<01:28, 14.70s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:42<01:12, 14.54s/it]processing for feature importance:  67%|██████▋   | 8/12 [02:00<01:02, 15.69s/it]processing for feature importance:  75%|███████▌  | 9/12 [02:15<00:46, 15.44s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:30<00:30, 15.38s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:45<00:15, 15.02s/it]processing for feature importance: 100%|██████████| 12/12 [02:58<00:00, 14.61s/it]processing for feature importance: 100%|██████████| 12/12 [02:58<00:00, 14.90s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  2%|▏         | 7/306 [00:00<00:04, 60.15it/s]  6%|▌         | 19/306 [00:00<00:03, 93.12it/s] 10%|█         | 31/306 [00:00<00:02, 104.86it/s] 15%|█▌        | 46/306 [00:00<00:02, 115.13it/s] 22%|██▏       | 66/306 [00:00<00:01, 140.27it/s] 26%|██▋       | 81/306 [00:00<00:01, 136.08it/s] 31%|███       | 95/306 [00:00<00:02, 93.92it/s]  35%|███▍      | 107/306 [00:01<00:02, 92.92it/s] 40%|███▉      | 122/306 [00:01<00:01, 105.66it/s] 48%|████▊     | 148/306 [00:01<00:01, 139.34it/s] 55%|█████▌    | 169/306 [00:01<00:00, 157.18it/s] 61%|██████    | 187/306 [00:01<00:00, 162.89it/s] 67%|██████▋   | 206/306 [00:01<00:00, 169.84it/s] 76%|███████▋  | 234/306 [00:01<00:00, 200.76it/s] 83%|████████▎ | 255/306 [00:01<00:00, 199.60it/s] 91%|█████████ | 278/306 [00:01<00:00, 208.31it/s]100%|██████████| 306/306 [00:01<00:00, 157.49it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 451.85it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:02, 212.39it/s]extract the null data:  22%|██▏       | 120/553 [00:00<00:02, 181.16it/s]extract the null data:  26%|██▌       | 142/553 [00:00<00:02, 155.65it/s]extract the null data:  29%|██▉       | 161/553 [00:00<00:02, 157.82it/s]extract the null data:  33%|███▎      | 180/553 [00:01<00:02, 165.03it/s]extract the null data:  41%|████      | 228/553 [00:01<00:01, 242.39it/s]extract the null data:  46%|████▋     | 256/553 [00:01<00:01, 220.31it/s]extract the null data:  51%|█████     | 281/553 [00:01<00:01, 205.04it/s]extract the null data:  55%|█████▍    | 304/553 [00:01<00:01, 194.63it/s]extract the null data:  59%|█████▉    | 325/553 [00:01<00:01, 181.14it/s]extract the null data:  62%|██████▏   | 344/553 [00:01<00:01, 183.02it/s]extract the null data:  66%|██████▌   | 364/553 [00:01<00:01, 176.64it/s]extract the null data:  73%|███████▎  | 401/553 [00:02<00:00, 225.63it/s]extract the null data:  82%|████████▏ | 453/553 [00:02<00:00, 303.97it/s]extract the null data:  88%|████████▊ | 487/553 [00:02<00:00, 312.33it/s]extract the null data:  95%|█████████▍| 523/553 [00:02<00:00, 315.28it/s]extract the null data: 100%|██████████| 553/553 [00:02<00:00, 229.92it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 11/553 [00:00<00:05, 107.93it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:05, 94.99it/s] replace nan value:   6%|▌         | 33/553 [00:00<00:05, 98.97it/s]replace nan value:   8%|▊         | 44/553 [00:00<00:05, 96.79it/s]replace nan value:  10%|█         | 56/553 [00:00<00:04, 102.79it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:05, 85.47it/s] replace nan value:  14%|█▍        | 78/553 [00:00<00:05, 88.69it/s]replace nan value:  16%|█▌        | 88/553 [00:01<00:06, 68.68it/s]replace nan value:  17%|█▋        | 96/553 [00:01<00:06, 71.10it/s]replace nan value:  19%|█▉        | 104/553 [00:01<00:06, 65.40it/s]replace nan value:  20%|██        | 112/553 [00:01<00:06, 68.67it/s]replace nan value:  22%|██▏       | 120/553 [00:01<00:06, 65.01it/s]replace nan value:  23%|██▎       | 127/553 [00:01<00:07, 60.76it/s]replace nan value:  25%|██▌       | 141/553 [00:01<00:05, 79.34it/s]replace nan value:  28%|██▊       | 154/553 [00:01<00:04, 90.72it/s]replace nan value:  30%|██▉       | 164/553 [00:02<00:04, 84.83it/s]replace nan value:  31%|███▏      | 173/553 [00:02<00:05, 69.86it/s]replace nan value:  33%|███▎      | 181/553 [00:02<00:05, 64.46it/s]replace nan value:  34%|███▍      | 188/553 [00:02<00:05, 62.01it/s]replace nan value:  35%|███▌      | 195/553 [00:02<00:06, 57.41it/s]replace nan value:  38%|███▊      | 208/553 [00:02<00:04, 71.52it/s]replace nan value:  40%|████      | 222/553 [00:02<00:03, 87.43it/s]replace nan value:  42%|████▏     | 232/553 [00:03<00:03, 84.66it/s]replace nan value:  44%|████▎     | 241/553 [00:03<00:03, 78.37it/s]replace nan value:  47%|████▋     | 261/553 [00:03<00:02, 108.15it/s]replace nan value:  51%|█████     | 283/553 [00:03<00:01, 135.79it/s]replace nan value:  54%|█████▍    | 298/553 [00:03<00:02, 111.04it/s]replace nan value:  56%|█████▌    | 311/553 [00:03<00:02, 97.76it/s] replace nan value:  58%|█████▊    | 322/553 [00:03<00:02, 77.51it/s]replace nan value:  60%|██████    | 332/553 [00:04<00:02, 80.97it/s]replace nan value:  62%|██████▏   | 342/553 [00:04<00:02, 81.73it/s]replace nan value:  63%|██████▎   | 351/553 [00:04<00:02, 82.90it/s]replace nan value:  65%|██████▌   | 360/553 [00:04<00:02, 81.51it/s]replace nan value:  67%|██████▋   | 369/553 [00:04<00:02, 70.38it/s]replace nan value:  68%|██████▊   | 377/553 [00:04<00:02, 72.27it/s]replace nan value:  70%|██████▉   | 385/553 [00:04<00:02, 69.46it/s]replace nan value:  71%|███████   | 393/553 [00:04<00:02, 61.49it/s]replace nan value:  72%|███████▏  | 400/553 [00:05<00:02, 60.76it/s]replace nan value:  74%|███████▍  | 410/553 [00:05<00:02, 69.56it/s]replace nan value:  76%|███████▌  | 418/553 [00:05<00:01, 72.15it/s]replace nan value:  77%|███████▋  | 427/553 [00:05<00:01, 75.14it/s]replace nan value:  79%|███████▉  | 438/553 [00:05<00:01, 81.56it/s]replace nan value:  81%|████████  | 448/553 [00:05<00:01, 82.96it/s]replace nan value:  83%|████████▎ | 457/553 [00:05<00:01, 75.52it/s]replace nan value:  84%|████████▍ | 465/553 [00:05<00:01, 67.22it/s]replace nan value:  86%|████████▌ | 473/553 [00:06<00:01, 69.87it/s]replace nan value:  87%|████████▋ | 481/553 [00:06<00:01, 70.42it/s]replace nan value:  89%|████████▊ | 490/553 [00:06<00:00, 74.60it/s]replace nan value:  90%|█████████ | 498/553 [00:06<00:00, 70.85it/s]replace nan value:  92%|█████████▏| 507/553 [00:06<00:00, 75.36it/s]replace nan value:  94%|█████████▎| 518/553 [00:06<00:00, 83.13it/s]replace nan value:  96%|█████████▌| 529/553 [00:06<00:00, 84.78it/s]replace nan value:  97%|█████████▋| 538/553 [00:06<00:00, 74.93it/s]replace nan value:  99%|█████████▊| 546/553 [00:07<00:00, 68.36it/s]replace nan value: 100%|██████████| 553/553 [00:07<00:00, 78.13it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 5/553 [00:00<00:11, 47.45it/s]  2%|▏         | 12/553 [00:00<00:09, 54.29it/s]  3%|▎         | 18/553 [00:00<00:11, 47.18it/s]  5%|▍         | 25/553 [00:00<00:09, 54.11it/s]  6%|▋         | 35/553 [00:00<00:07, 67.87it/s]  8%|▊         | 43/553 [00:00<00:07, 65.23it/s]  9%|▉         | 50/553 [00:00<00:07, 66.47it/s] 10%|█         | 57/553 [00:00<00:08, 61.79it/s] 12%|█▏        | 64/553 [00:01<00:09, 53.36it/s] 13%|█▎        | 70/553 [00:01<00:08, 54.41it/s] 14%|█▍        | 78/553 [00:01<00:08, 56.39it/s] 16%|█▌        | 87/553 [00:01<00:07, 64.03it/s] 17%|█▋        | 94/553 [00:01<00:07, 60.39it/s] 18%|█▊        | 101/553 [00:01<00:08, 52.42it/s] 20%|█▉        | 108/553 [00:01<00:08, 55.57it/s] 21%|██        | 114/553 [00:01<00:07, 55.55it/s] 22%|██▏       | 120/553 [00:02<00:08, 51.09it/s] 23%|██▎       | 126/553 [00:02<00:08, 48.60it/s] 25%|██▌       | 139/553 [00:02<00:06, 68.33it/s] 27%|██▋       | 150/553 [00:02<00:05, 78.92it/s] 29%|██▉       | 160/553 [00:02<00:04, 84.29it/s] 31%|███▏      | 174/553 [00:02<00:03, 99.59it/s] 34%|███▍      | 187/553 [00:02<00:03, 103.62it/s] 36%|███▌      | 198/553 [00:02<00:03, 90.10it/s]  38%|███▊      | 208/553 [00:03<00:04, 81.58it/s] 39%|███▉      | 217/553 [00:03<00:05, 65.54it/s] 41%|████      | 225/553 [00:03<00:05, 56.84it/s] 42%|████▏     | 232/553 [00:03<00:05, 54.27it/s] 44%|████▎     | 241/553 [00:03<00:05, 60.84it/s] 45%|████▍     | 248/553 [00:03<00:05, 58.96it/s] 47%|████▋     | 262/553 [00:03<00:03, 77.57it/s] 49%|████▉     | 271/553 [00:04<00:03, 78.35it/s] 51%|█████▏    | 284/553 [00:04<00:02, 91.57it/s] 54%|█████▎    | 296/553 [00:04<00:02, 97.68it/s] 56%|█████▌    | 309/553 [00:04<00:02, 104.42it/s] 58%|█████▊    | 320/553 [00:04<00:02, 101.41it/s] 60%|█████▉    | 331/553 [00:04<00:02, 79.01it/s]  61%|██████▏   | 340/553 [00:04<00:02, 73.34it/s] 63%|██████▎   | 348/553 [00:05<00:02, 69.49it/s] 65%|██████▍   | 358/553 [00:05<00:02, 75.90it/s] 67%|██████▋   | 370/553 [00:05<00:02, 86.48it/s] 69%|██████▊   | 380/553 [00:05<00:02, 73.45it/s] 70%|███████   | 389/553 [00:05<00:02, 62.97it/s] 72%|███████▏  | 396/553 [00:05<00:02, 55.20it/s] 73%|███████▎  | 403/553 [00:06<00:03, 48.27it/s] 74%|███████▍  | 409/553 [00:06<00:02, 49.43it/s] 75%|███████▌  | 415/553 [00:06<00:02, 47.00it/s] 76%|███████▌  | 420/553 [00:06<00:03, 40.39it/s] 77%|███████▋  | 425/553 [00:06<00:03, 41.43it/s] 78%|███████▊  | 433/553 [00:06<00:02, 48.34it/s] 81%|████████  | 448/553 [00:06<00:01, 68.68it/s] 83%|████████▎ | 458/553 [00:06<00:01, 72.75it/s] 85%|████████▍ | 469/553 [00:07<00:01, 79.96it/s] 86%|████████▋ | 478/553 [00:07<00:00, 77.02it/s] 88%|████████▊ | 486/553 [00:07<00:00, 67.97it/s] 89%|████████▉ | 494/553 [00:07<00:00, 60.00it/s] 91%|█████████ | 501/553 [00:07<00:01, 50.45it/s] 92%|█████████▏| 507/553 [00:07<00:01, 44.30it/s] 93%|█████████▎| 514/553 [00:07<00:00, 48.90it/s] 94%|█████████▍| 521/553 [00:08<00:00, 53.41it/s] 95%|█████████▌| 527/553 [00:08<00:00, 46.98it/s] 96%|█████████▋| 533/553 [00:08<00:00, 48.94it/s] 98%|█████████▊| 542/553 [00:08<00:00, 57.43it/s] 99%|█████████▉| 549/553 [00:08<00:00, 54.08it/s]100%|██████████| 553/553 [00:08<00:00, 61.76it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   1%|          | 1/139 [00:00<00:26,  5.12it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:01, 86.04it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 109.71it/s]extract the null data:  60%|█████▉    | 83/139 [00:00<00:00, 187.81it/s]extract the null data:  85%|████████▍ | 118/139 [00:00<00:00, 231.01it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 178.02it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 16/139 [00:00<00:00, 129.13it/s]replace nan value:  21%|██        | 29/139 [00:00<00:00, 116.67it/s]replace nan value:  29%|██▉       | 41/139 [00:00<00:00, 108.16it/s]replace nan value:  37%|███▋      | 52/139 [00:00<00:00, 87.23it/s] replace nan value:  45%|████▍     | 62/139 [00:00<00:01, 73.04it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 83.84it/s]replace nan value:  62%|██████▏   | 86/139 [00:00<00:00, 92.68it/s]replace nan value:  69%|██████▉   | 96/139 [00:01<00:00, 84.55it/s]replace nan value:  76%|███████▌  | 105/139 [00:01<00:00, 84.40it/s]replace nan value:  82%|████████▏ | 114/139 [00:01<00:00, 78.28it/s]replace nan value:  88%|████████▊ | 123/139 [00:01<00:00, 66.87it/s]replace nan value:  94%|█████████▍| 131/139 [00:01<00:00, 62.72it/s]replace nan value:  99%|█████████▉| 138/139 [00:01<00:00, 57.46it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 75.93it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  2%|▏         | 3/139 [00:00<00:05, 24.35it/s]  6%|▌         | 8/139 [00:00<00:03, 38.11it/s] 15%|█▌        | 21/139 [00:00<00:01, 77.33it/s] 26%|██▌       | 36/139 [00:00<00:01, 98.45it/s] 33%|███▎      | 46/139 [00:00<00:01, 70.05it/s] 39%|███▉      | 54/139 [00:00<00:01, 52.52it/s] 44%|████▍     | 61/139 [00:01<00:01, 48.76it/s] 51%|█████     | 71/139 [00:01<00:01, 58.06it/s] 56%|█████▌    | 78/139 [00:01<00:01, 55.45it/s] 63%|██████▎   | 88/139 [00:01<00:00, 57.47it/s] 71%|███████   | 98/139 [00:01<00:00, 66.60it/s] 79%|███████▉  | 110/139 [00:01<00:00, 79.21it/s] 90%|████████▉ | 125/139 [00:01<00:00, 96.39it/s] 98%|█████████▊| 136/139 [00:02<00:00, 79.77it/s]100%|██████████| 139/139 [00:02<00:00, 67.84it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:37,  4.53it/s]extract the null data:  29%|██▉       | 51/173 [00:00<00:00, 198.45it/s]extract the null data:  54%|█████▍    | 94/173 [00:00<00:00, 280.82it/s]extract the null data:  75%|███████▌  | 130/173 [00:00<00:00, 246.75it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 297.56it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 248.51it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   8%|▊         | 13/173 [00:00<00:01, 126.53it/s]replace nan value:  17%|█▋        | 29/173 [00:00<00:00, 144.07it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 138.84it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:01, 114.73it/s]replace nan value:  40%|████      | 70/173 [00:00<00:01, 99.35it/s] replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 92.91it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 88.56it/s]replace nan value:  58%|█████▊    | 101/173 [00:01<00:00, 84.19it/s]replace nan value:  64%|██████▎   | 110/173 [00:01<00:00, 81.90it/s]replace nan value:  69%|██████▉   | 119/173 [00:01<00:00, 73.51it/s]replace nan value:  73%|███████▎  | 127/173 [00:01<00:00, 71.47it/s]replace nan value:  78%|███████▊  | 135/173 [00:01<00:00, 72.97it/s]replace nan value:  83%|████████▎ | 143/173 [00:01<00:00, 67.84it/s]replace nan value:  88%|████████▊ | 152/173 [00:01<00:00, 72.15it/s]replace nan value:  95%|█████████▍| 164/173 [00:01<00:00, 83.61it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 88.13it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  4%|▍         | 7/173 [00:00<00:02, 66.05it/s]  8%|▊         | 14/173 [00:00<00:02, 62.13it/s] 12%|█▏        | 21/173 [00:00<00:03, 49.45it/s] 16%|█▌        | 27/173 [00:00<00:03, 45.23it/s] 18%|█▊        | 32/173 [00:00<00:03, 44.55it/s] 22%|██▏       | 38/173 [00:00<00:02, 47.21it/s] 30%|███       | 52/173 [00:00<00:01, 71.18it/s] 35%|███▍      | 60/173 [00:01<00:01, 65.65it/s] 40%|███▉      | 69/173 [00:01<00:01, 67.90it/s] 46%|████▌     | 80/173 [00:01<00:01, 77.74it/s] 51%|█████▏    | 89/173 [00:01<00:01, 62.97it/s] 55%|█████▌    | 96/173 [00:01<00:01, 59.25it/s] 62%|██████▏   | 108/173 [00:01<00:00, 72.23it/s] 67%|██████▋   | 116/173 [00:01<00:00, 71.31it/s] 72%|███████▏  | 124/173 [00:02<00:00, 56.72it/s] 76%|███████▌  | 131/173 [00:02<00:00, 51.68it/s] 84%|████████▍ | 146/173 [00:02<00:00, 71.69it/s] 91%|█████████ | 157/173 [00:02<00:00, 79.68it/s] 96%|█████████▌| 166/173 [00:02<00:00, 74.13it/s]100%|██████████| 173/173 [00:02<00:00, 64.86it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.098, valid loss : 0.093, train acc : 0.650, valid acc : 0.676, train f1 : 0.490, valid f1 : 0.526
training process:   1%|          | 1/128 [02:23<5:04:29, 143.85s/it]Best score increase :0.000 -> 0.526
training process:   2%|▏         | 2/128 [04:18<4:26:06, 126.72s/it]Best score increase :0.526 -> 0.587
training process:   2%|▏         | 3/128 [06:17<4:16:39, 123.20s/it]Best score increase :0.587 -> 0.686
training process:   3%|▎         | 4/128 [08:01<3:59:14, 115.76s/it]Best score increase :0.686 -> 0.711
epoch : 5, train loss : 0.061, valid loss : 0.061, train acc : 0.870, valid acc : 0.867, train f1 : 0.704, valid f1 : 0.705
training process:   4%|▍         | 5/128 [10:12<4:08:03, 121.00s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [12:06<4:01:42, 118.88s/it]Best score increase :0.711 -> 0.755
training process:   5%|▌         | 7/128 [14:01<3:56:55, 117.48s/it]Best score increase :0.755 -> 0.767
training process:   6%|▋         | 8/128 [15:59<3:55:04, 117.53s/it]Best score increase :0.767 -> 0.782
epoch : 9, train loss : 0.053, valid loss : 0.057, train acc : 0.904, valid acc : 0.929, train f1 : 0.755, valid f1 : 0.795
training process:   7%|▋         | 9/128 [18:09<4:00:49, 121.43s/it]Best score increase :0.782 -> 0.795
training process:   8%|▊         | 10/128 [20:01<3:53:28, 118.71s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [21:54<3:47:37, 116.73s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [24:01<3:51:54, 119.95s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.050, valid loss : 0.053, train acc : 0.913, valid acc : 0.930, train f1 : 0.771, valid f1 : 0.801
training process:  10%|█         | 13/128 [26:11<3:55:33, 122.90s/it]Best score increase :0.795 -> 0.801
training process:  11%|█         | 14/128 [28:00<3:45:39, 118.77s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [29:46<3:36:34, 114.99s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [31:35<3:31:20, 113.22s/it]Best score increase :0.801 -> 0.812
epoch : 17, train loss : 0.048, valid loss : 0.053, train acc : 0.918, valid acc : 0.939, train f1 : 0.782, valid f1 : 0.820
training process:  13%|█▎        | 17/128 [33:41<3:36:14, 116.89s/it]Best score increase :0.812 -> 0.820
training process:  14%|█▍        | 18/128 [35:21<3:25:02, 111.84s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [36:57<3:14:40, 107.16s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [38:35<3:07:57, 104.42s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.047, valid loss : 0.057, train acc : 0.922, valid acc : 0.944, train f1 : 0.787, valid f1 : 0.820
training process:  16%|█▋        | 21/128 [40:30<3:11:59, 107.66s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [42:09<3:05:37, 105.08s/it]Best score increase :0.820 -> 0.822
training process:  18%|█▊        | 23/128 [43:49<3:00:51, 103.34s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [45:25<2:55:43, 101.38s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.045, valid loss : 0.049, train acc : 0.927, valid acc : 0.928, train f1 : 0.799, valid f1 : 0.805
training process:  20%|█▉        | 25/128 [47:19<3:00:12, 104.97s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [49:10<3:01:38, 106.85s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [50:47<2:55:08, 104.04s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [52:29<2:52:07, 103.28s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.044, valid loss : 0.048, train acc : 0.929, valid acc : 0.926, train f1 : 0.802, valid f1 : 0.803
training process:  23%|██▎       | 29/128 [54:30<2:59:05, 108.54s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [56:05<2:50:38, 104.47s/it]EarlyStopping counter : 8 out of 12
training process:  24%|██▍       | 31/128 [57:31<2:40:01, 98.98s/it] EarlyStopping counter : 9 out of 12
training process:  25%|██▌       | 32/128 [59:05<2:36:03, 97.54s/it]Best score increase :0.822 -> 0.825
epoch : 33, train loss : 0.043, valid loss : 0.047, train acc : 0.931, valid acc : 0.927, train f1 : 0.807, valid f1 : 0.808
training process:  26%|██▌       | 33/128 [1:00:39<2:32:50, 96.54s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [1:02:02<2:24:41, 92.36s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [1:03:24<2:18:22, 89.28s/it]Best score increase :0.825 -> 0.835
training process:  28%|██▊       | 36/128 [1:04:45<2:13:13, 86.88s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.041, valid loss : 0.048, train acc : 0.933, valid acc : 0.934, train f1 : 0.812, valid f1 : 0.818
training process:  29%|██▉       | 37/128 [1:06:30<2:19:42, 92.12s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [1:07:57<2:16:14, 90.83s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [1:09:30<2:15:35, 91.41s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [1:10:59<2:12:49, 90.57s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.041, valid loss : 0.047, train acc : 0.934, valid acc : 0.929, train f1 : 0.815, valid f1 : 0.811
training process:  32%|███▏      | 41/128 [1:12:44<2:17:37, 94.92s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [1:14:13<2:13:41, 93.28s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [1:15:44<2:11:12, 92.62s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [1:17:16<2:09:02, 92.17s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.041, valid loss : 0.049, train acc : 0.937, valid acc : 0.945, train f1 : 0.822, valid f1 : 0.839
training process:  35%|███▌      | 45/128 [1:19:02<2:13:30, 96.51s/it]Best score increase :0.835 -> 0.839
training process:  36%|███▌      | 46/128 [1:20:29<2:07:57, 93.62s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [1:22:04<2:07:06, 94.15s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [1:23:42<2:07:01, 95.27s/it]Best score increase :0.839 -> 0.841
epoch : 49, train loss : 0.040, valid loss : 0.046, train acc : 0.940, valid acc : 0.928, train f1 : 0.827, valid f1 : 0.812
training process:  38%|███▊      | 49/128 [1:25:28<2:09:42, 98.51s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [1:27:04<2:06:47, 97.53s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [1:28:31<2:01:09, 94.40s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [1:30:20<2:05:18, 98.93s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.039, valid loss : 0.050, train acc : 0.939, valid acc : 0.945, train f1 : 0.827, valid f1 : 0.839
training process:  41%|████▏     | 53/128 [1:32:19<2:10:58, 104.79s/it]EarlyStopping counter : 5 out of 12
training process:  42%|████▏     | 54/128 [1:34:08<2:10:58, 106.20s/it]EarlyStopping counter : 6 out of 12
training process:  43%|████▎     | 55/128 [1:36:08<2:14:05, 110.21s/it]EarlyStopping counter : 7 out of 12
training process:  44%|████▍     | 56/128 [1:38:23<2:21:18, 117.75s/it]EarlyStopping counter : 8 out of 12
epoch : 57, train loss : 0.039, valid loss : 0.048, train acc : 0.941, valid acc : 0.940, train f1 : 0.831, valid f1 : 0.831
training process:  45%|████▍     | 57/128 [1:40:39<2:25:43, 123.14s/it]EarlyStopping counter : 9 out of 12
training process:  45%|████▌     | 58/128 [1:42:30<2:19:32, 119.61s/it]EarlyStopping counter : 10 out of 12
training process:  46%|████▌     | 59/128 [1:44:38<2:20:14, 121.95s/it]Best score increase :0.841 -> 0.842
training process:  47%|████▋     | 60/128 [1:46:52<2:22:35, 125.82s/it]EarlyStopping counter : 1 out of 12
epoch : 61, train loss : 0.038, valid loss : 0.046, train acc : 0.941, valid acc : 0.921, train f1 : 0.830, valid f1 : 0.802
training process:  48%|████▊     | 61/128 [1:49:32<2:31:44, 135.88s/it]EarlyStopping counter : 2 out of 12
training process:  48%|████▊     | 62/128 [1:51:40<2:26:48, 133.46s/it]EarlyStopping counter : 3 out of 12
training process:  49%|████▉     | 63/128 [1:53:58<2:26:09, 134.92s/it]EarlyStopping counter : 4 out of 12
training process:  50%|█████     | 64/128 [1:56:13<2:23:48, 134.82s/it]EarlyStopping counter : 5 out of 12
epoch : 65, train loss : 0.037, valid loss : 0.053, train acc : 0.942, valid acc : 0.947, train f1 : 0.834, valid f1 : 0.841
training process:  51%|█████     | 65/128 [1:58:44<2:26:46, 139.78s/it]EarlyStopping counter : 6 out of 12
training process:  52%|█████▏    | 66/128 [2:00:55<2:21:39, 137.09s/it]EarlyStopping counter : 7 out of 12
training process:  52%|█████▏    | 67/128 [2:03:11<2:19:11, 136.90s/it]EarlyStopping counter : 8 out of 12
training process:  53%|█████▎    | 68/128 [2:05:29<2:17:07, 137.12s/it]EarlyStopping counter : 9 out of 12
epoch : 69, train loss : 0.038, valid loss : 0.048, train acc : 0.945, valid acc : 0.942, train f1 : 0.840, valid f1 : 0.835
training process:  54%|█████▍    | 69/128 [2:08:06<2:20:51, 143.24s/it]EarlyStopping counter : 10 out of 12
training process:  55%|█████▍    | 70/128 [2:10:18<2:15:01, 139.69s/it]EarlyStopping counter : 11 out of 12
training process:  55%|█████▍    | 70/128 [2:12:32<1:49:49, 113.61s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 70, best f1 score : 0.842
training process finished, best loss : 0.051 and best acc : 0.947, best f1 : 0.842, best epoch : 58

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.52      0.79      0.63       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.86      0.79      7398
weighted avg       0.95      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.79, test AUC : 0.86, test loss : 3.037

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:19<03:34, 19.50s/it]processing for feature importance:  17%|█▋        | 2/12 [00:39<03:15, 19.51s/it]processing for feature importance:  25%|██▌       | 3/12 [00:58<02:57, 19.67s/it]processing for feature importance:  33%|███▎      | 4/12 [01:16<02:32, 19.03s/it]processing for feature importance:  42%|████▏     | 5/12 [01:34<02:09, 18.50s/it]processing for feature importance:  50%|█████     | 6/12 [01:54<01:53, 18.91s/it]processing for feature importance:  58%|█████▊    | 7/12 [02:12<01:33, 18.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [02:31<01:15, 18.89s/it]processing for feature importance:  75%|███████▌  | 9/12 [02:52<00:58, 19.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [03:08<00:36, 18.45s/it]processing for feature importance:  92%|█████████▏| 11/12 [03:26<00:18, 18.15s/it]processing for feature importance: 100%|██████████| 12/12 [03:46<00:00, 18.75s/it]processing for feature importance: 100%|██████████| 12/12 [03:46<00:00, 18.86s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:01, 149.39it/s] 10%|▉         | 30/306 [00:00<00:01, 148.57it/s] 15%|█▌        | 47/306 [00:00<00:01, 156.10it/s] 21%|██        | 64/306 [00:00<00:01, 159.96it/s] 27%|██▋       | 82/306 [00:00<00:01, 165.54it/s] 32%|███▏      | 99/306 [00:00<00:01, 154.52it/s] 38%|███▊      | 116/306 [00:00<00:01, 158.28it/s] 44%|████▍     | 134/306 [00:00<00:01, 157.56it/s] 49%|████▉     | 150/306 [00:00<00:01, 154.58it/s] 58%|█████▊    | 178/306 [00:01<00:00, 189.56it/s] 68%|██████▊   | 207/306 [00:01<00:00, 216.82it/s] 75%|███████▍  | 229/306 [00:01<00:00, 214.55it/s] 82%|████████▏ | 251/306 [00:01<00:00, 202.13it/s] 92%|█████████▏| 282/306 [00:01<00:00, 231.98it/s]100%|██████████| 306/306 [00:01<00:00, 195.12it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   6%|▋         | 35/553 [00:00<00:01, 348.58it/s]extract the null data:  13%|█▎        | 71/553 [00:00<00:01, 351.39it/s]extract the null data:  19%|█▉        | 107/553 [00:00<00:01, 272.83it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:01, 284.99it/s]extract the null data:  32%|███▏      | 175/553 [00:00<00:01, 309.40it/s]extract the null data:  39%|███▊      | 213/553 [00:00<00:01, 331.46it/s]extract the null data:  46%|████▌     | 252/553 [00:00<00:00, 348.04it/s]extract the null data:  52%|█████▏    | 288/553 [00:00<00:00, 351.65it/s]extract the null data:  59%|█████▊    | 324/553 [00:00<00:00, 351.93it/s]extract the null data:  65%|██████▌   | 360/553 [00:01<00:00, 352.17it/s]extract the null data:  72%|███████▏  | 397/553 [00:01<00:00, 354.02it/s]extract the null data:  78%|███████▊  | 433/553 [00:01<00:00, 351.66it/s]extract the null data:  85%|████████▍ | 469/553 [00:01<00:00, 348.47it/s]extract the null data:  91%|█████████ | 504/553 [00:01<00:00, 337.84it/s]extract the null data:  97%|█████████▋| 538/553 [00:01<00:00, 306.05it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 324.20it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   1%|          | 6/553 [00:00<00:09, 59.31it/s]replace nan value:   3%|▎         | 14/553 [00:00<00:07, 70.95it/s]replace nan value:   5%|▍         | 26/553 [00:00<00:05, 90.61it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:05, 91.71it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:05, 91.96it/s]replace nan value:  10%|█         | 57/553 [00:00<00:05, 95.49it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:04, 100.72it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:04, 114.46it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:03, 115.82it/s]replace nan value:  20%|██        | 112/553 [00:01<00:03, 123.64it/s]replace nan value:  23%|██▎       | 128/553 [00:01<00:03, 132.04it/s]replace nan value:  26%|██▌       | 143/553 [00:01<00:02, 136.83it/s]replace nan value:  28%|██▊       | 157/553 [00:01<00:03, 130.52it/s]replace nan value:  31%|███       | 172/553 [00:01<00:02, 135.80it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 139.00it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:02, 143.34it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:02, 127.10it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:02, 130.97it/s]replace nan value:  45%|████▌     | 249/553 [00:02<00:02, 137.98it/s]replace nan value:  48%|████▊     | 264/553 [00:02<00:02, 130.15it/s]replace nan value:  50%|█████     | 279/553 [00:02<00:02, 134.96it/s]replace nan value:  53%|█████▎    | 294/553 [00:02<00:01, 138.91it/s]replace nan value:  56%|█████▌    | 309/553 [00:02<00:01, 139.19it/s]replace nan value:  59%|█████▊    | 324/553 [00:02<00:01, 127.02it/s]replace nan value:  61%|██████    | 338/553 [00:02<00:01, 113.32it/s]replace nan value:  64%|██████▍   | 354/553 [00:02<00:01, 124.58it/s]replace nan value:  67%|██████▋   | 370/553 [00:02<00:01, 133.07it/s]replace nan value:  70%|██████▉   | 386/553 [00:03<00:01, 138.29it/s]replace nan value:  73%|███████▎  | 401/553 [00:03<00:01, 139.72it/s]replace nan value:  75%|███████▌  | 416/553 [00:03<00:00, 139.98it/s]replace nan value:  78%|███████▊  | 431/553 [00:03<00:00, 141.08it/s]replace nan value:  81%|████████  | 446/553 [00:03<00:00, 141.84it/s]replace nan value:  83%|████████▎ | 461/553 [00:03<00:00, 139.88it/s]replace nan value:  86%|████████▌ | 476/553 [00:03<00:00, 142.73it/s]replace nan value:  89%|████████▉ | 492/553 [00:03<00:00, 146.31it/s]replace nan value:  92%|█████████▏| 507/553 [00:03<00:00, 142.60it/s]replace nan value:  94%|█████████▍| 522/553 [00:04<00:00, 134.50it/s]replace nan value:  97%|█████████▋| 537/553 [00:04<00:00, 137.85it/s]replace nan value: 100%|█████████▉| 552/553 [00:04<00:00, 139.66it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 129.07it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 9/553 [00:00<00:06, 85.46it/s]  4%|▍         | 23/553 [00:00<00:04, 115.55it/s]  7%|▋         | 37/553 [00:00<00:04, 123.57it/s]  9%|▉         | 50/553 [00:00<00:04, 100.90it/s] 11%|█         | 61/553 [00:00<00:05, 97.92it/s]  13%|█▎        | 72/553 [00:00<00:04, 101.39it/s] 16%|█▌        | 86/553 [00:00<00:04, 111.08it/s] 18%|█▊        | 98/553 [00:00<00:04, 109.41it/s] 20%|██        | 113/553 [00:01<00:03, 119.15it/s] 23%|██▎       | 126/553 [00:01<00:03, 115.22it/s] 26%|██▌       | 143/553 [00:01<00:03, 128.11it/s] 29%|██▉       | 160/553 [00:01<00:02, 137.96it/s] 31%|███▏      | 174/553 [00:01<00:02, 136.20it/s] 34%|███▍      | 188/553 [00:01<00:02, 126.41it/s] 37%|███▋      | 204/553 [00:01<00:02, 134.41it/s] 39%|███▉      | 218/553 [00:01<00:02, 131.67it/s] 42%|████▏     | 232/553 [00:01<00:02, 124.82it/s] 44%|████▍     | 245/553 [00:02<00:02, 119.17it/s] 47%|████▋     | 259/553 [00:02<00:02, 123.83it/s] 49%|████▉     | 272/553 [00:02<00:02, 117.07it/s] 51%|█████▏    | 284/553 [00:02<00:02, 107.84it/s] 53%|█████▎    | 295/553 [00:02<00:02, 87.32it/s]  55%|█████▌    | 305/553 [00:02<00:03, 77.95it/s] 57%|█████▋    | 314/553 [00:02<00:03, 68.70it/s] 58%|█████▊    | 322/553 [00:03<00:03, 66.21it/s] 59%|█████▉    | 329/553 [00:03<00:03, 61.13it/s] 61%|██████    | 337/553 [00:03<00:03, 64.49it/s] 62%|██████▏   | 345/553 [00:03<00:03, 61.07it/s] 64%|██████▍   | 353/553 [00:03<00:03, 61.63it/s] 65%|██████▌   | 360/553 [00:03<00:03, 55.01it/s] 67%|██████▋   | 369/553 [00:03<00:02, 62.74it/s] 69%|██████▉   | 382/553 [00:03<00:02, 78.69it/s] 71%|███████   | 391/553 [00:04<00:02, 78.28it/s] 73%|███████▎  | 402/553 [00:04<00:01, 86.02it/s] 75%|███████▍  | 414/553 [00:04<00:01, 94.29it/s] 77%|███████▋  | 424/553 [00:04<00:01, 78.00it/s] 79%|███████▊  | 435/553 [00:04<00:01, 85.78it/s] 81%|████████  | 449/553 [00:04<00:01, 98.18it/s] 83%|████████▎ | 460/553 [00:04<00:01, 87.91it/s] 85%|████████▍ | 470/553 [00:04<00:01, 82.49it/s] 87%|████████▋ | 479/553 [00:05<00:01, 70.62it/s] 88%|████████▊ | 488/553 [00:05<00:00, 73.83it/s] 90%|█████████ | 498/553 [00:05<00:00, 79.65it/s] 93%|█████████▎| 512/553 [00:05<00:00, 93.67it/s] 94%|█████████▍| 522/553 [00:05<00:00, 74.13it/s] 96%|█████████▌| 531/553 [00:05<00:00, 62.32it/s] 98%|█████████▊| 540/553 [00:06<00:00, 67.51it/s]100%|█████████▉| 551/553 [00:06<00:00, 58.73it/s]100%|██████████| 553/553 [00:06<00:00, 87.75it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   5%|▌         | 7/139 [00:00<00:02, 60.49it/s]extract the null data:  28%|██▊       | 39/139 [00:00<00:00, 197.39it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 297.65it/s]extract the null data:  90%|████████▉ | 125/139 [00:00<00:00, 348.01it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 304.66it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:   7%|▋         | 10/139 [00:00<00:01, 97.84it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:01, 95.79it/s]replace nan value:  23%|██▎       | 32/139 [00:00<00:01, 98.29it/s]replace nan value:  31%|███       | 43/139 [00:00<00:00, 101.00it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 94.90it/s] replace nan value:  47%|████▋     | 65/139 [00:00<00:00, 93.92it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 97.34it/s]replace nan value:  62%|██████▏   | 86/139 [00:00<00:00, 94.92it/s]replace nan value:  69%|██████▉   | 96/139 [00:01<00:00, 94.88it/s]replace nan value:  76%|███████▋  | 106/139 [00:01<00:00, 95.55it/s]replace nan value:  83%|████████▎ | 116/139 [00:01<00:00, 96.14it/s]replace nan value:  91%|█████████ | 126/139 [00:01<00:00, 93.09it/s]replace nan value:  99%|█████████▊| 137/139 [00:01<00:00, 92.80it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 95.80it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  7%|▋         | 10/139 [00:00<00:01, 96.54it/s] 14%|█▍        | 20/139 [00:00<00:01, 77.22it/s] 24%|██▍       | 34/139 [00:00<00:01, 100.44it/s] 33%|███▎      | 46/139 [00:00<00:00, 100.06it/s] 41%|████      | 57/139 [00:00<00:00, 99.22it/s]  52%|█████▏    | 72/139 [00:00<00:00, 114.51it/s] 60%|██████    | 84/139 [00:00<00:00, 109.08it/s] 69%|██████▉   | 96/139 [00:00<00:00, 102.22it/s] 78%|███████▊  | 108/139 [00:01<00:00, 106.11it/s] 89%|████████▉ | 124/139 [00:01<00:00, 118.87it/s] 99%|█████████▊| 137/139 [00:01<00:00, 115.14it/s]100%|██████████| 139/139 [00:01<00:00, 107.87it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  10%|▉         | 17/173 [00:00<00:00, 161.60it/s]extract the null data:  35%|███▌      | 61/173 [00:00<00:00, 318.79it/s]extract the null data:  62%|██████▏   | 107/173 [00:00<00:00, 379.74it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 368.91it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 356.64it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|▉         | 17/173 [00:00<00:00, 160.86it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 160.76it/s]replace nan value:  29%|██▉       | 51/173 [00:00<00:00, 162.52it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 162.91it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 164.94it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 165.76it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 164.43it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 164.15it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 164.88it/s]replace nan value:  98%|█████████▊| 170/173 [00:01<00:00, 149.81it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 158.22it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 122.09it/s] 15%|█▌        | 26/173 [00:00<00:01, 99.26it/s]  21%|██▏       | 37/173 [00:00<00:01, 95.23it/s] 27%|██▋       | 47/173 [00:00<00:01, 90.30it/s] 35%|███▌      | 61/173 [00:00<00:01, 102.63it/s] 42%|████▏     | 72/173 [00:00<00:00, 102.45it/s] 49%|████▉     | 85/173 [00:00<00:00, 109.32it/s] 57%|█████▋    | 99/173 [00:00<00:00, 116.03it/s] 65%|██████▌   | 113/173 [00:01<00:00, 120.52it/s] 73%|███████▎  | 126/173 [00:01<00:00, 85.60it/s]  79%|███████▊  | 136/173 [00:01<00:00, 80.27it/s] 84%|████████▍ | 145/173 [00:01<00:00, 75.54it/s] 89%|████████▉ | 154/173 [00:01<00:00, 75.04it/s] 94%|█████████▎| 162/173 [00:01<00:00, 69.89it/s] 98%|█████████▊| 170/173 [00:01<00:00, 66.54it/s]100%|██████████| 173/173 [00:02<00:00, 84.80it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.251, valid loss : 0.119, train acc : 0.488, valid acc : 0.084, train f1 : 0.363, valid f1 : 0.078
training process:   1%|          | 1/128 [01:42<3:37:56, 102.96s/it]Best score increase :0.000 -> 0.078
training process:   2%|▏         | 2/128 [03:10<3:17:02, 93.83s/it] EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [04:37<3:08:47, 90.62s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [06:06<3:06:03, 90.03s/it]Best score increase :0.078 -> 0.114
epoch : 5, train loss : 0.124, valid loss : 0.116, train acc : 0.574, valid acc : 0.314, train f1 : 0.482, valid f1 : 0.298
training process:   4%|▍         | 5/128 [07:47<3:12:39, 93.98s/it]Best score increase :0.114 -> 0.298
training process:   5%|▍         | 6/128 [09:09<3:02:45, 89.88s/it]Best score increase :0.298 -> 0.396
training process:   5%|▌         | 7/128 [10:35<2:58:34, 88.55s/it]Best score increase :0.396 -> 0.398
training process:   6%|▋         | 8/128 [12:06<2:59:10, 89.59s/it]Best score increase :0.398 -> 0.400
epoch : 9, train loss : 0.092, valid loss : 0.107, train acc : 0.720, valid acc : 0.446, train f1 : 0.698, valid f1 : 0.398
training process:   7%|▋         | 9/128 [13:46<3:04:12, 92.87s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [15:15<3:00:01, 91.54s/it]Best score increase :0.400 -> 0.410
training process:   9%|▊         | 11/128 [16:44<2:57:08, 90.85s/it]Best score increase :0.410 -> 0.465
training process:   9%|▉         | 12/128 [18:10<2:52:51, 89.41s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.077, valid loss : 0.095, train acc : 0.761, valid acc : 0.550, train f1 : 0.747, valid f1 : 0.470
training process:  10%|█         | 13/128 [19:53<2:58:46, 93.27s/it]Best score increase :0.465 -> 0.470
training process:  11%|█         | 14/128 [21:23<2:55:28, 92.36s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [22:40<2:45:05, 87.66s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [23:53<2:35:41, 83.41s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.070, valid loss : 0.078, train acc : 0.782, valid acc : 0.670, train f1 : 0.772, valid f1 : 0.554
training process:  13%|█▎        | 17/128 [25:37<2:45:51, 89.66s/it]Best score increase :0.470 -> 0.554
training process:  14%|█▍        | 18/128 [26:50<2:34:46, 84.42s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [27:52<2:21:23, 77.83s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [29:00<2:14:38, 74.80s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.067, valid loss : 0.084, train acc : 0.801, valid acc : 0.642, train f1 : 0.794, valid f1 : 0.534
training process:  16%|█▋        | 21/128 [30:21<2:16:44, 76.68s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [31:30<2:11:26, 74.40s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [32:27<2:01:05, 69.20s/it]EarlyStopping counter : 6 out of 12
training process:  19%|█▉        | 24/128 [33:21<1:52:00, 64.62s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.063, valid loss : 0.077, train acc : 0.816, valid acc : 0.680, train f1 : 0.809, valid f1 : 0.562
training process:  20%|█▉        | 25/128 [34:25<1:50:26, 64.34s/it]Best score increase :0.554 -> 0.562
training process:  20%|██        | 26/128 [35:35<1:52:32, 66.20s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [36:29<1:45:09, 62.47s/it]Best score increase :0.562 -> 0.567
training process:  22%|██▏       | 28/128 [37:23<1:40:10, 60.11s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.058, valid loss : 0.074, train acc : 0.831, valid acc : 0.715, train f1 : 0.827, valid f1 : 0.588
training process:  23%|██▎       | 29/128 [38:27<1:40:47, 61.09s/it]Best score increase :0.567 -> 0.588
training process:  23%|██▎       | 30/128 [39:20<1:35:53, 58.71s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [40:13<1:31:55, 56.86s/it]EarlyStopping counter : 2 out of 12
training process:  25%|██▌       | 32/128 [41:07<1:29:40, 56.05s/it]Best score increase :0.588 -> 0.613
epoch : 33, train loss : 0.056, valid loss : 0.077, train acc : 0.843, valid acc : 0.697, train f1 : 0.839, valid f1 : 0.575
training process:  26%|██▌       | 33/128 [42:08<1:31:14, 57.62s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [43:01<1:28:01, 56.18s/it]Best score increase :0.613 -> 0.645
training process:  27%|██▋       | 35/128 [43:54<1:25:28, 55.14s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [44:48<1:24:12, 54.92s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.054, valid loss : 0.064, train acc : 0.852, valid acc : 0.772, train f1 : 0.850, valid f1 : 0.633
training process:  29%|██▉       | 37/128 [45:51<1:26:46, 57.22s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [46:44<1:23:55, 55.95s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [47:45<1:25:19, 57.52s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [48:39<1:23:02, 56.62s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.052, valid loss : 0.080, train acc : 0.862, valid acc : 0.695, train f1 : 0.860, valid f1 : 0.574
training process:  32%|███▏      | 41/128 [49:44<1:25:26, 58.92s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [50:39<1:22:58, 57.89s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [51:35<1:21:05, 57.24s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [52:30<1:19:27, 56.76s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.050, valid loss : 0.078, train acc : 0.865, valid acc : 0.680, train f1 : 0.864, valid f1 : 0.563
training process:  35%|███▌      | 45/128 [53:42<1:24:44, 61.26s/it]EarlyStopping counter : 11 out of 12
training process:  36%|███▌      | 46/128 [54:47<1:25:08, 62.30s/it]Best score increase :0.645 -> 0.663
training process:  37%|███▋      | 47/128 [55:48<1:23:31, 61.86s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [56:51<1:23:03, 62.29s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.048, valid loss : 0.063, train acc : 0.874, valid acc : 0.798, train f1 : 0.872, valid f1 : 0.657
training process:  38%|███▊      | 49/128 [58:03<1:25:55, 65.26s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [59:04<1:23:15, 64.05s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [1:00:04<1:20:37, 62.83s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [1:01:12<1:21:16, 64.17s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.049, valid loss : 0.063, train acc : 0.876, valid acc : 0.796, train f1 : 0.875, valid f1 : 0.655
training process:  41%|████▏     | 53/128 [1:02:49<1:32:34, 74.06s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [1:04:12<1:34:52, 76.92s/it]EarlyStopping counter : 8 out of 12
training process:  43%|████▎     | 55/128 [1:05:41<1:37:45, 80.35s/it]EarlyStopping counter : 9 out of 12
training process:  44%|████▍     | 56/128 [1:07:16<1:41:43, 84.77s/it]EarlyStopping counter : 10 out of 12
epoch : 57, train loss : 0.047, valid loss : 0.068, train acc : 0.878, valid acc : 0.761, train f1 : 0.877, valid f1 : 0.624
training process:  45%|████▍     | 57/128 [1:08:58<1:46:30, 90.00s/it]EarlyStopping counter : 11 out of 12
training process:  45%|████▍     | 57/128 [1:10:25<1:27:42, 74.13s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 57, best f1 score : 0.664
training process finished, best loss : 0.061 and best acc : 0.805, best f1 : 0.664, best epoch : 51

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.29      0.91      0.44       580
           1       0.99      0.81      0.89      6818

    accuracy                           0.82      7398
   macro avg       0.64      0.86      0.66      7398
weighted avg       0.94      0.82      0.85      7398


# test acc : 0.82, test f1 : 0.66, test AUC : 0.86, test loss : 3.821

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:07, 11.58s/it]processing for feature importance:  17%|█▋        | 2/12 [00:24<02:03, 12.40s/it]processing for feature importance:  25%|██▌       | 3/12 [00:38<01:57, 13.01s/it]processing for feature importance:  33%|███▎      | 4/12 [00:52<01:46, 13.37s/it]processing for feature importance:  42%|████▏     | 5/12 [01:07<01:37, 13.90s/it]processing for feature importance:  50%|█████     | 6/12 [01:18<01:17, 12.96s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:32<01:06, 13.25s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:46<00:55, 13.79s/it]processing for feature importance:  75%|███████▌  | 9/12 [02:00<00:40, 13.65s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:13<00:26, 13.49s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:26<00:13, 13.20s/it]processing for feature importance: 100%|██████████| 12/12 [02:37<00:00, 12.57s/it]processing for feature importance: 100%|██████████| 12/12 [02:37<00:00, 13.09s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 203.01it/s] 14%|█▎        | 42/306 [00:00<00:01, 187.76it/s] 20%|█▉        | 61/306 [00:00<00:01, 176.95it/s] 26%|██▌       | 79/306 [00:00<00:01, 172.26it/s] 32%|███▏      | 97/306 [00:00<00:01, 170.65it/s] 38%|███▊      | 115/306 [00:00<00:01, 164.97it/s] 43%|████▎     | 133/306 [00:00<00:01, 168.34it/s] 49%|████▉     | 150/306 [00:00<00:00, 162.99it/s] 55%|█████▍    | 167/306 [00:00<00:00, 163.16it/s] 60%|██████    | 185/306 [00:01<00:00, 162.53it/s] 67%|██████▋   | 204/306 [00:01<00:00, 158.44it/s] 72%|███████▏  | 220/306 [00:01<00:00, 150.54it/s] 82%|████████▏ | 251/306 [00:01<00:00, 193.80it/s] 91%|█████████ | 277/306 [00:01<00:00, 210.84it/s]100%|██████████| 306/306 [00:01<00:00, 186.17it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 43/553 [00:00<00:01, 420.12it/s]extract the null data:  16%|█▌        | 86/553 [00:00<00:01, 425.70it/s]extract the null data:  23%|██▎       | 129/553 [00:00<00:01, 420.22it/s]extract the null data:  31%|███       | 172/553 [00:00<00:00, 422.40it/s]extract the null data:  39%|███▉      | 218/553 [00:00<00:00, 433.43it/s]extract the null data:  48%|████▊     | 264/553 [00:00<00:00, 439.73it/s]extract the null data:  56%|█████▌    | 309/553 [00:00<00:00, 440.45it/s]extract the null data:  64%|██████▍   | 354/553 [00:00<00:00, 416.72it/s]extract the null data:  72%|███████▏  | 396/553 [00:00<00:00, 417.29it/s]extract the null data:  79%|███████▉  | 438/553 [00:01<00:00, 416.29it/s]extract the null data:  87%|████████▋ | 483/553 [00:01<00:00, 424.68it/s]extract the null data:  95%|█████████▌| 526/553 [00:01<00:00, 424.81it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 425.51it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 159.95it/s]replace nan value:   6%|▌         | 32/553 [00:00<00:03, 159.60it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:03, 149.32it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:03, 145.70it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:03, 150.13it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:02, 155.07it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 158.07it/s]replace nan value:  24%|██▎       | 131/553 [00:00<00:02, 159.18it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 161.52it/s]replace nan value:  30%|██▉       | 165/553 [00:01<00:02, 159.70it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 160.31it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:02, 162.43it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:02, 163.05it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:02, 156.72it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 152.00it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 156.08it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 158.26it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 160.77it/s]replace nan value:  57%|█████▋    | 317/553 [00:02<00:01, 158.29it/s]replace nan value:  60%|██████    | 333/553 [00:02<00:01, 156.49it/s]replace nan value:  63%|██████▎   | 349/553 [00:02<00:01, 154.09it/s]replace nan value:  66%|██████▌   | 365/553 [00:02<00:01, 152.69it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:01, 151.85it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 155.01it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 159.09it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 161.20it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 163.94it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 164.65it/s]replace nan value:  88%|████████▊ | 484/553 [00:03<00:00, 128.50it/s]replace nan value:  90%|█████████ | 499/553 [00:03<00:00, 132.31it/s]replace nan value:  93%|█████████▎| 514/553 [00:03<00:00, 135.18it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 141.29it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 147.41it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 153.05it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 10/553 [00:00<00:05, 99.94it/s]  5%|▍         | 25/553 [00:00<00:04, 128.32it/s]  7%|▋         | 39/553 [00:00<00:03, 132.80it/s] 10%|▉         | 53/553 [00:00<00:04, 116.12it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.35it/s] 14%|█▍        | 78/553 [00:00<00:04, 113.85it/s] 17%|█▋        | 92/553 [00:00<00:03, 120.22it/s] 19%|█▉        | 105/553 [00:00<00:04, 93.29it/s] 21%|██        | 116/553 [00:01<00:05, 82.65it/s] 23%|██▎       | 126/553 [00:01<00:06, 69.91it/s] 24%|██▍       | 134/553 [00:01<00:06, 68.64it/s] 26%|██▌       | 143/553 [00:01<00:05, 72.33it/s] 27%|██▋       | 151/553 [00:01<00:05, 72.84it/s] 30%|███       | 168/553 [00:01<00:04, 96.08it/s] 33%|███▎      | 182/553 [00:01<00:03, 105.58it/s] 36%|███▌      | 198/553 [00:02<00:02, 118.89it/s] 38%|███▊      | 212/553 [00:02<00:02, 118.96it/s] 41%|████      | 225/553 [00:02<00:02, 118.91it/s] 43%|████▎     | 240/553 [00:02<00:02, 126.06it/s] 46%|████▌     | 253/553 [00:02<00:02, 126.99it/s] 48%|████▊     | 266/553 [00:02<00:02, 116.37it/s] 50%|█████     | 278/553 [00:02<00:02, 116.79it/s] 53%|█████▎    | 291/553 [00:02<00:02, 119.50it/s] 55%|█████▍    | 304/553 [00:02<00:02, 102.04it/s] 57%|█████▋    | 315/553 [00:03<00:02, 101.54it/s] 59%|█████▉    | 327/553 [00:03<00:02, 105.61it/s] 61%|██████    | 338/553 [00:03<00:02, 106.23it/s] 63%|██████▎   | 349/553 [00:03<00:02, 92.43it/s]  65%|██████▍   | 359/553 [00:03<00:02, 89.90it/s] 68%|██████▊   | 375/553 [00:03<00:01, 104.44it/s] 70%|██████▉   | 386/553 [00:03<00:01, 103.72it/s] 72%|███████▏  | 397/553 [00:03<00:01, 100.28it/s] 74%|███████▍  | 408/553 [00:04<00:01, 98.07it/s]  76%|███████▌  | 418/553 [00:04<00:01, 93.69it/s] 77%|███████▋  | 428/553 [00:04<00:01, 94.37it/s] 80%|████████  | 445/553 [00:04<00:00, 113.26it/s] 83%|████████▎ | 460/553 [00:04<00:00, 121.89it/s] 86%|████████▌ | 474/553 [00:04<00:00, 126.15it/s] 88%|████████▊ | 487/553 [00:04<00:00, 122.17it/s] 90%|█████████ | 500/553 [00:04<00:00, 111.05it/s] 93%|█████████▎| 514/553 [00:04<00:00, 115.62it/s] 95%|█████████▌| 526/553 [00:05<00:00, 103.13it/s] 97%|█████████▋| 537/553 [00:05<00:00, 100.25it/s]100%|█████████▉| 551/553 [00:05<00:00, 89.90it/s] 100%|██████████| 553/553 [00:05<00:00, 102.67it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 20/139 [00:00<00:00, 198.02it/s]extract the null data:  46%|████▌     | 64/139 [00:00<00:00, 336.07it/s]extract the null data:  78%|███████▊  | 109/139 [00:00<00:00, 387.07it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 379.01it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 178.49it/s]replace nan value:  27%|██▋       | 37/139 [00:00<00:00, 180.80it/s]replace nan value:  40%|████      | 56/139 [00:00<00:00, 180.01it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 180.53it/s]replace nan value:  68%|██████▊   | 94/139 [00:00<00:00, 178.66it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 179.76it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 181.21it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 180.41it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.36it/s] 17%|█▋        | 23/139 [00:00<00:01, 113.04it/s] 26%|██▌       | 36/139 [00:00<00:00, 120.33it/s] 35%|███▌      | 49/139 [00:00<00:00, 118.52it/s] 44%|████▍     | 61/139 [00:00<00:00, 113.32it/s] 53%|█████▎    | 73/139 [00:00<00:00, 113.28it/s] 61%|██████    | 85/139 [00:00<00:00, 107.77it/s] 69%|██████▉   | 96/139 [00:00<00:00, 103.51it/s] 77%|███████▋  | 107/139 [00:00<00:00, 103.46it/s] 88%|████████▊ | 122/139 [00:01<00:00, 113.64it/s] 96%|█████████▋| 134/139 [00:01<00:00, 112.03it/s]100%|██████████| 139/139 [00:01<00:00, 112.41it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   6%|▌         | 10/173 [00:00<00:01, 99.89it/s]extract the null data:  34%|███▎      | 58/173 [00:00<00:00, 321.80it/s]extract the null data:  62%|██████▏   | 108/173 [00:00<00:00, 400.71it/s]extract the null data:  90%|█████████ | 156/173 [00:00<00:00, 431.56it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 394.05it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 175.13it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 172.72it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 162.62it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 168.71it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 173.56it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 171.93it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 136.50it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 145.01it/s]replace nan value:  94%|█████████▎| 162/173 [00:01<00:00, 150.95it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 156.08it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 137.16it/s] 17%|█▋        | 29/173 [00:00<00:01, 115.01it/s] 25%|██▌       | 44/173 [00:00<00:01, 128.52it/s] 34%|███▎      | 58/173 [00:00<00:00, 132.40it/s] 42%|████▏     | 72/173 [00:00<00:00, 132.09it/s] 50%|████▉     | 86/173 [00:00<00:00, 130.80it/s] 58%|█████▊    | 100/173 [00:00<00:00, 131.75it/s] 67%|██████▋   | 116/173 [00:00<00:00, 136.24it/s] 75%|███████▌  | 130/173 [00:00<00:00, 131.16it/s] 83%|████████▎ | 144/173 [00:01<00:00, 128.88it/s] 91%|█████████ | 157/173 [00:01<00:00, 117.03it/s] 98%|█████████▊| 169/173 [00:01<00:00, 97.55it/s] 100%|██████████| 173/173 [00:01<00:00, 115.44it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.480, valid loss : 0.404, train f1 : 0.514, valid f1 : 0.518
training process - Deferred Re-weighting:   1%|          | 1/128 [00:56<1:58:34, 56.02s/it]Best score increase :0.000 -> 0.518
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:02<2:10:36, 62.20s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:06<2:11:43, 63.23s/it]Best score increase :0.518 -> 0.579
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:16<2:16:05, 65.85s/it]Best score increase :0.579 -> 0.686
epoch : 5, train loss : 0.222, valid loss : 0.220, train f1 : 0.710, valid f1 : 0.742
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:34<2:23:48, 70.15s/it]Best score increase :0.686 -> 0.742
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:39<2:19:04, 68.40s/it]Best score increase :0.742 -> 0.767
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:46<2:17:11, 68.03s/it]Best score increase :0.767 -> 0.797
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:03<2:21:25, 70.71s/it]Best score increase :0.797 -> 0.807
epoch : 9, train loss : 0.160, valid loss : 0.166, train f1 : 0.802, valid f1 : 0.799
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:31<2:31:10, 76.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [11:35<2:22:31, 72.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [12:42<2:17:43, 70.63s/it]Best score increase :0.807 -> 0.825
training process - Deferred Re-weighting:   9%|▉         | 12/128 [13:48<2:14:07, 69.37s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.142, valid loss : 0.151, train f1 : 0.822, valid f1 : 0.819
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:58<2:13:03, 69.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [15:56<2:05:12, 65.90s/it]Best score increase :0.825 -> 0.837
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [17:04<2:05:50, 66.82s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:57<1:56:54, 62.63s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.135, valid loss : 0.142, train f1 : 0.829, valid f1 : 0.823
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:58<1:54:54, 62.11s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [19:52<1:49:04, 59.49s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [20:43<1:43:42, 57.09s/it]Best score increase :0.837 -> 0.840
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [21:34<1:39:06, 55.06s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.129, valid loss : 0.144, train f1 : 0.839, valid f1 : 0.820
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [22:32<1:39:47, 55.96s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [23:23<1:36:40, 54.72s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [24:15<1:34:09, 53.80s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [25:17<1:37:22, 56.18s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.123, valid loss : 0.132, train f1 : 0.846, valid f1 : 0.846
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [26:18<1:38:51, 57.59s/it]Best score increase :0.840 -> 0.846
training process - Deferred Re-weighting:  20%|██        | 26/128 [27:11<1:35:53, 56.40s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [28:04<1:33:17, 55.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [28:54<1:29:23, 53.63s/it]Best score increase :0.846 -> 0.852
epoch : 29, train loss : 0.121, valid loss : 0.133, train f1 : 0.847, valid f1 : 0.853
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [29:51<1:30:25, 54.81s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [30:42<1:27:29, 53.57s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [31:33<1:25:23, 52.82s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [32:25<1:24:02, 52.52s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.116, valid loss : 0.126, train f1 : 0.853, valid f1 : 0.848
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [33:35<1:31:23, 57.72s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [34:41<1:34:28, 60.30s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:49<1:36:49, 62.47s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:56<1:37:56, 63.87s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.112, valid loss : 0.127, train f1 : 0.859, valid f1 : 0.852
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [38:15<1:43:40, 68.36s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [39:22<1:42:04, 68.05s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [40:27<1:39:43, 67.23s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [41:33<1:34:50, 63.94s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 39, best f1 score : 0.853
training process finished, best loss : 0.133, best acc : 0.959, best f1 : 0.853, best epoch : 28

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.67      0.66       580
           1       0.97      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.82      0.82      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.82, test AUC : 0.82, test loss : 8.976

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:32,  8.39s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.03s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:18,  8.77s/it]processing for feature importance:  33%|███▎      | 4/12 [00:35<01:13,  9.20s/it]processing for feature importance:  42%|████▏     | 5/12 [00:45<01:07,  9.59s/it]processing for feature importance:  50%|█████     | 6/12 [00:55<00:57,  9.55s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:04<00:47,  9.54s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:13<00:36,  9.08s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:22<00:27,  9.07s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:30<00:17,  8.99s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:39<00:09,  9.02s/it]processing for feature importance: 100%|██████████| 12/12 [01:49<00:00,  9.17s/it]processing for feature importance: 100%|██████████| 12/12 [01:49<00:00,  9.13s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 219.63it/s] 24%|██▍       | 73/306 [00:00<00:00, 386.12it/s] 41%|████      | 124/306 [00:00<00:00, 439.01it/s] 57%|█████▋    | 175/306 [00:00<00:00, 463.64it/s] 73%|███████▎  | 223/306 [00:00<00:00, 469.42it/s] 89%|████████▊ | 271/306 [00:00<00:00, 470.09it/s]100%|██████████| 306/306 [00:00<00:00, 422.82it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 36/553 [00:00<00:01, 358.20it/s]extract the null data:  14%|█▍        | 78/553 [00:00<00:01, 394.15it/s]extract the null data:  22%|██▏       | 122/553 [00:00<00:01, 413.87it/s]extract the null data:  30%|██▉       | 165/553 [00:00<00:00, 417.43it/s]extract the null data:  37%|███▋      | 207/553 [00:00<00:00, 412.88it/s]extract the null data:  45%|████▌     | 249/553 [00:00<00:00, 413.78it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 332.79it/s]extract the null data:  59%|█████▉    | 327/553 [00:00<00:00, 302.57it/s]extract the null data:  67%|██████▋   | 370/553 [00:01<00:00, 333.22it/s]extract the null data:  73%|███████▎  | 406/553 [00:01<00:00, 322.43it/s]extract the null data:  80%|███████▉  | 440/553 [00:01<00:00, 325.66it/s]extract the null data:  88%|████████▊ | 484/553 [00:01<00:00, 356.15it/s]extract the null data:  95%|█████████▌| 528/553 [00:01<00:00, 376.90it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 359.40it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 152.91it/s]replace nan value:   6%|▌         | 32/553 [00:00<00:03, 154.76it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:03, 156.14it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:03, 144.29it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:03, 135.56it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:03, 145.55it/s]replace nan value:  20%|██        | 113/553 [00:00<00:02, 150.58it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 155.88it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 160.53it/s]replace nan value:  30%|██▉       | 165/553 [00:01<00:02, 162.97it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 162.85it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:02, 163.24it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:02, 162.79it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 162.38it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 161.36it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 157.78it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 160.10it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 155.31it/s]replace nan value:  57%|█████▋    | 317/553 [00:02<00:01, 148.12it/s]replace nan value:  60%|██████    | 332/553 [00:02<00:01, 142.74it/s]replace nan value:  63%|██████▎   | 349/553 [00:02<00:01, 147.89it/s]replace nan value:  66%|██████▌   | 364/553 [00:02<00:01, 142.96it/s]replace nan value:  69%|██████▊   | 379/553 [00:02<00:01, 140.03it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:01, 138.17it/s]replace nan value:  74%|███████▍  | 408/553 [00:02<00:01, 134.92it/s]replace nan value:  77%|███████▋  | 424/553 [00:02<00:00, 140.04it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 136.83it/s]replace nan value:  82%|████████▏ | 453/553 [00:03<00:00, 129.89it/s]replace nan value:  84%|████████▍ | 467/553 [00:03<00:00, 129.90it/s]replace nan value:  87%|████████▋ | 482/553 [00:03<00:00, 133.98it/s]replace nan value:  90%|█████████ | 498/553 [00:03<00:00, 139.51it/s]replace nan value:  93%|█████████▎| 514/553 [00:03<00:00, 144.88it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 148.53it/s]replace nan value:  99%|█████████▊| 545/553 [00:03<00:00, 141.74it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 146.94it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 9/553 [00:00<00:06, 82.62it/s]  4%|▍         | 21/553 [00:00<00:05, 100.09it/s]  6%|▋         | 35/553 [00:00<00:04, 115.30it/s]  8%|▊         | 47/553 [00:00<00:05, 86.37it/s]  10%|█         | 57/553 [00:00<00:05, 88.05it/s] 12%|█▏        | 67/553 [00:00<00:05, 84.08it/s] 14%|█▍        | 77/553 [00:00<00:05, 87.63it/s] 16%|█▋        | 91/553 [00:00<00:04, 98.65it/s] 18%|█▊        | 102/553 [00:01<00:04, 96.66it/s] 21%|██        | 114/553 [00:01<00:04, 102.68it/s] 23%|██▎       | 125/553 [00:01<00:04, 99.66it/s]  25%|██▍       | 138/553 [00:01<00:03, 106.56it/s] 27%|██▋       | 150/553 [00:01<00:03, 110.31it/s] 29%|██▉       | 163/553 [00:01<00:03, 112.72it/s] 32%|███▏      | 178/553 [00:01<00:03, 121.56it/s] 35%|███▍      | 191/553 [00:01<00:02, 121.06it/s] 37%|███▋      | 204/553 [00:01<00:02, 122.15it/s] 39%|███▉      | 217/553 [00:02<00:02, 118.01it/s] 42%|████▏     | 230/553 [00:02<00:02, 118.03it/s] 44%|████▍     | 244/553 [00:02<00:02, 122.55it/s] 46%|████▋     | 257/553 [00:02<00:02, 112.59it/s] 49%|████▊     | 269/553 [00:02<00:02, 108.90it/s] 51%|█████     | 282/553 [00:02<00:02, 105.69it/s] 53%|█████▎    | 294/553 [00:02<00:02, 106.67it/s] 55%|█████▌    | 306/553 [00:02<00:02, 107.23it/s] 58%|█████▊    | 318/553 [00:02<00:02, 108.71it/s] 60%|█████▉    | 330/553 [00:03<00:02, 110.04it/s] 62%|██████▏   | 344/553 [00:03<00:01, 118.38it/s] 64%|██████▍   | 356/553 [00:03<00:01, 111.79it/s] 67%|██████▋   | 369/553 [00:03<00:01, 114.28it/s] 69%|██████▉   | 381/553 [00:03<00:01, 97.85it/s]  71%|███████   | 392/553 [00:03<00:02, 71.49it/s] 73%|███████▎  | 401/553 [00:03<00:02, 74.05it/s] 75%|███████▍  | 414/553 [00:04<00:01, 84.17it/s] 77%|███████▋  | 424/553 [00:04<00:01, 85.23it/s] 78%|███████▊  | 434/553 [00:04<00:01, 80.69it/s] 80%|████████  | 443/553 [00:04<00:01, 78.89it/s] 82%|████████▏ | 452/553 [00:04<00:01, 80.65it/s] 83%|████████▎ | 461/553 [00:04<00:01, 70.55it/s] 86%|████████▌ | 474/553 [00:04<00:00, 84.31it/s] 88%|████████▊ | 486/553 [00:04<00:00, 90.93it/s] 90%|████████▉ | 496/553 [00:05<00:00, 81.27it/s] 92%|█████████▏| 510/553 [00:05<00:00, 94.63it/s] 94%|█████████▍| 521/553 [00:05<00:00, 90.15it/s] 96%|█████████▌| 531/553 [00:05<00:00, 80.66it/s] 98%|█████████▊| 542/553 [00:05<00:00, 84.88it/s]100%|█████████▉| 551/553 [00:05<00:00, 63.75it/s]100%|██████████| 553/553 [00:05<00:00, 94.01it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   4%|▎         | 5/139 [00:00<00:03, 44.31it/s]extract the null data:  39%|███▉      | 54/139 [00:00<00:00, 292.05it/s]extract the null data:  68%|██████▊   | 95/139 [00:00<00:00, 326.97it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 317.38it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 302.87it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 177.44it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 178.55it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 157.75it/s]replace nan value:  51%|█████     | 71/139 [00:00<00:00, 107.66it/s]replace nan value:  62%|██████▏   | 86/139 [00:00<00:00, 118.06it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 134.21it/s]replace nan value:  88%|████████▊ | 122/139 [00:00<00:00, 144.80it/s]replace nan value:  99%|█████████▉| 138/139 [00:01<00:00, 134.53it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 135.81it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 126.18it/s] 20%|██        | 28/139 [00:00<00:00, 132.65it/s] 30%|███       | 42/139 [00:00<00:00, 111.67it/s] 39%|███▉      | 54/139 [00:00<00:00, 104.28it/s] 48%|████▊     | 67/139 [00:00<00:00, 111.10it/s] 57%|█████▋    | 79/139 [00:00<00:00, 96.04it/s]  65%|██████▍   | 90/139 [00:00<00:00, 75.14it/s] 71%|███████   | 99/139 [00:01<00:00, 74.39it/s] 78%|███████▊  | 108/139 [00:01<00:00, 76.22it/s] 88%|████████▊ | 123/139 [00:01<00:00, 93.96it/s] 97%|█████████▋| 135/139 [00:01<00:00, 100.65it/s]100%|██████████| 139/139 [00:01<00:00, 96.96it/s] 
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   9%|▉         | 16/173 [00:00<00:00, 159.35it/s]extract the null data:  32%|███▏      | 55/173 [00:00<00:00, 291.70it/s]extract the null data:  59%|█████▉    | 102/173 [00:00<00:00, 371.33it/s]extract the null data:  86%|████████▌ | 148/173 [00:00<00:00, 404.77it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 374.06it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|▉         | 17/173 [00:00<00:00, 166.02it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 148.31it/s]replace nan value:  28%|██▊       | 49/173 [00:00<00:00, 142.93it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 133.61it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 129.67it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 127.13it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 124.77it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 121.98it/s]replace nan value:  76%|███████▌  | 131/173 [00:01<00:00, 107.28it/s]replace nan value:  83%|████████▎ | 143/173 [00:01<00:00, 97.93it/s] replace nan value:  89%|████████▉ | 154/173 [00:01<00:00, 96.59it/s]replace nan value:  96%|█████████▌| 166/173 [00:01<00:00, 101.71it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 117.01it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.66it/s] 16%|█▌        | 28/173 [00:00<00:01, 113.13it/s] 23%|██▎       | 40/173 [00:00<00:01, 91.74it/s]  30%|███       | 52/173 [00:00<00:01, 98.84it/s] 36%|███▋      | 63/173 [00:00<00:01, 89.67it/s] 43%|████▎     | 75/173 [00:00<00:01, 95.19it/s] 49%|████▉     | 85/173 [00:00<00:01, 87.94it/s] 57%|█████▋    | 99/173 [00:01<00:00, 100.12it/s] 64%|██████▎   | 110/173 [00:01<00:00, 95.08it/s] 71%|███████   | 122/173 [00:01<00:00, 98.68it/s] 78%|███████▊  | 135/173 [00:01<00:00, 104.61it/s] 84%|████████▍ | 146/173 [00:01<00:00, 101.87it/s] 91%|█████████ | 157/173 [00:01<00:00, 97.29it/s]  97%|█████████▋| 167/173 [00:01<00:00, 73.73it/s]100%|██████████| 173/173 [00:01<00:00, 90.38it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.632, valid loss : 0.506, train f1 : 0.646, valid f1 : 0.586
training process - Deferred Re-weighting:   1%|          | 1/128 [01:31<3:12:54, 91.14s/it]Best score increase :0.000 -> 0.586
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:43<2:48:20, 80.17s/it]Best score increase :0.586 -> 0.627
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:58<2:42:25, 77.97s/it]Best score increase :0.627 -> 0.723
training process - Deferred Re-weighting:   3%|▎         | 4/128 [05:16<2:40:45, 77.79s/it]Best score increase :0.723 -> 0.757
epoch : 5, train loss : 0.369, valid loss : 0.291, train f1 : 0.840, valid f1 : 0.755
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:44<2:47:09, 81.54s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [08:02<2:43:30, 80.41s/it]Best score increase :0.757 -> 0.764
training process - Deferred Re-weighting:   5%|▌         | 7/128 [09:18<2:38:48, 78.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [10:27<2:31:46, 75.89s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.324, valid loss : 0.248, train f1 : 0.859, valid f1 : 0.796
training process - Deferred Re-weighting:   7%|▋         | 9/128 [11:56<2:38:22, 79.86s/it]Best score increase :0.764 -> 0.796
training process - Deferred Re-weighting:   8%|▊         | 10/128 [13:14<2:36:08, 79.40s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [14:33<2:34:08, 79.05s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [15:43<2:27:29, 76.28s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.291, valid loss : 0.330, train f1 : 0.870, valid f1 : 0.720
training process - Deferred Re-weighting:  10%|█         | 13/128 [17:12<2:33:53, 80.29s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [18:28<2:29:52, 78.89s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [19:46<2:27:58, 78.57s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [20:55<2:21:45, 75.94s/it]EarlyStopping counter : 7 out of 12
epoch : 17, train loss : 0.271, valid loss : 0.276, train f1 : 0.884, valid f1 : 0.757
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [22:24<2:27:12, 79.57s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [23:38<2:23:21, 78.20s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [24:55<2:21:21, 77.81s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [26:07<2:16:43, 75.96s/it]EarlyStopping counter : 11 out of 12
epoch : 21, train loss : 0.256, valid loss : 0.290, train f1 : 0.891, valid f1 : 0.752
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [27:27<2:28:15, 82.37s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 20, best f1 score : 0.796
training process finished, best loss : 0.248, best acc : 0.927, best f1 : 0.796, best epoch : 8

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.46      0.76      0.57       580
           1       0.98      0.92      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.72      0.84      0.76      7398
weighted avg       0.94      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.76, test AUC : 0.84, test loss : 15.728

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:49,  9.96s/it]processing for feature importance:  17%|█▋        | 2/12 [00:21<01:48, 10.90s/it]processing for feature importance:  25%|██▌       | 3/12 [00:32<01:37, 10.86s/it]processing for feature importance:  33%|███▎      | 4/12 [00:43<01:27, 10.90s/it]processing for feature importance:  42%|████▏     | 5/12 [00:56<01:20, 11.56s/it]processing for feature importance:  50%|█████     | 6/12 [01:08<01:11, 12.00s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:22<01:02, 12.53s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:36<00:52, 13.03s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:48<00:38, 12.77s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:58<00:23, 11.77s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:07<00:10, 10.92s/it]processing for feature importance: 100%|██████████| 12/12 [02:15<00:00, 10.16s/it]processing for feature importance: 100%|██████████| 12/12 [02:15<00:00, 11.31s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 15%|█▌        | 46/306 [00:00<00:00, 451.77it/s] 30%|███       | 92/306 [00:00<00:00, 456.12it/s] 45%|████▌     | 138/306 [00:00<00:00, 457.18it/s] 60%|██████    | 185/306 [00:00<00:00, 458.82it/s] 75%|███████▌  | 231/306 [00:00<00:00, 457.46it/s] 91%|█████████ | 278/306 [00:00<00:00, 460.89it/s]100%|██████████| 306/306 [00:00<00:00, 459.09it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 55/553 [00:00<00:00, 545.74it/s]extract the null data:  20%|██        | 112/553 [00:00<00:00, 559.71it/s]extract the null data:  31%|███       | 171/553 [00:00<00:00, 570.74it/s]extract the null data:  41%|████▏     | 229/553 [00:00<00:00, 535.85it/s]extract the null data:  52%|█████▏    | 288/553 [00:00<00:00, 551.51it/s]extract the null data:  63%|██████▎   | 346/553 [00:00<00:00, 558.20it/s]extract the null data:  73%|███████▎  | 404/553 [00:00<00:00, 562.66it/s]extract the null data:  84%|████████▎ | 462/553 [00:00<00:00, 567.73it/s]extract the null data:  94%|█████████▍| 521/553 [00:00<00:00, 565.83it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 558.30it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 187.03it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 193.76it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 194.66it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 196.89it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 198.77it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 198.75it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 200.16it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:01, 201.42it/s]replace nan value:  33%|███▎      | 184/553 [00:00<00:01, 201.08it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:01, 201.03it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 201.77it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 201.06it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 192.77it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 194.95it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 196.22it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 196.29it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:01, 197.01it/s]replace nan value:  67%|██████▋   | 369/553 [00:01<00:00, 197.66it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 198.20it/s]replace nan value:  74%|███████▍  | 410/553 [00:02<00:00, 189.21it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 189.74it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 193.03it/s]replace nan value:  85%|████████▌ | 472/553 [00:02<00:00, 195.82it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 188.08it/s]replace nan value:  93%|█████████▎| 513/553 [00:02<00:00, 191.70it/s]replace nan value:  96%|█████████▋| 533/553 [00:02<00:00, 193.58it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 195.37it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 195.85it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.66it/s]  5%|▌         | 29/553 [00:00<00:03, 143.44it/s]  8%|▊         | 44/553 [00:00<00:03, 132.26it/s] 10%|█         | 58/553 [00:00<00:04, 122.06it/s] 13%|█▎        | 71/553 [00:00<00:03, 120.67it/s] 16%|█▌        | 86/553 [00:00<00:03, 129.30it/s] 18%|█▊        | 100/553 [00:00<00:03, 119.85it/s] 21%|██▏       | 118/553 [00:00<00:03, 136.17it/s] 24%|██▍       | 132/553 [00:01<00:03, 134.90it/s] 27%|██▋       | 151/553 [00:01<00:02, 147.44it/s] 30%|███       | 166/553 [00:01<00:02, 132.67it/s] 33%|███▎      | 182/553 [00:01<00:02, 137.50it/s] 36%|███▌      | 199/553 [00:01<00:02, 146.23it/s] 39%|███▉      | 216/553 [00:01<00:02, 151.08it/s] 42%|████▏     | 232/553 [00:01<00:02, 119.14it/s] 44%|████▍     | 246/553 [00:01<00:02, 115.83it/s] 47%|████▋     | 259/553 [00:02<00:02, 116.28it/s] 49%|████▉     | 272/553 [00:02<00:02, 118.21it/s] 52%|█████▏    | 288/553 [00:02<00:02, 128.86it/s] 55%|█████▍    | 302/553 [00:02<00:01, 126.40it/s] 57%|█████▋    | 315/553 [00:02<00:01, 123.75it/s] 59%|█████▉    | 329/553 [00:02<00:01, 126.52it/s] 62%|██████▏   | 345/553 [00:02<00:01, 131.86it/s] 65%|██████▍   | 359/553 [00:02<00:01, 128.49it/s] 68%|██████▊   | 376/553 [00:02<00:01, 135.58it/s] 71%|███████   | 390/553 [00:03<00:01, 126.10it/s] 73%|███████▎  | 404/553 [00:03<00:01, 129.71it/s] 76%|███████▌  | 418/553 [00:03<00:01, 127.33it/s] 78%|███████▊  | 431/553 [00:03<00:00, 124.22it/s] 82%|████████▏ | 451/553 [00:03<00:00, 133.72it/s] 84%|████████▍ | 465/553 [00:03<00:00, 116.80it/s] 86%|████████▋ | 477/553 [00:03<00:00, 116.80it/s] 88%|████████▊ | 489/553 [00:03<00:00, 115.25it/s] 91%|█████████ | 501/553 [00:03<00:00, 114.07it/s] 93%|█████████▎| 517/553 [00:04<00:00, 124.53it/s] 96%|█████████▌| 530/553 [00:04<00:00, 107.74it/s] 99%|█████████▊| 545/553 [00:04<00:00, 117.80it/s]100%|██████████| 553/553 [00:04<00:00, 124.04it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 329.59it/s]extract the null data:  71%|███████   | 99/139 [00:00<00:00, 520.30it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 529.56it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 211.34it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 213.04it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 212.65it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 211.78it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 211.52it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 175.32it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.22it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.67it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.60it/s] 28%|██▊       | 39/139 [00:00<00:00, 129.51it/s] 37%|███▋      | 52/139 [00:00<00:00, 121.18it/s] 48%|████▊     | 67/139 [00:00<00:00, 130.40it/s] 59%|█████▉    | 82/139 [00:00<00:00, 133.25it/s] 69%|██████▉   | 96/139 [00:00<00:00, 115.59it/s] 78%|███████▊  | 108/139 [00:00<00:00, 113.00it/s] 90%|████████▉ | 125/139 [00:01<00:00, 127.85it/s]100%|██████████| 139/139 [00:01<00:00, 126.15it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 317.10it/s]extract the null data:  42%|████▏     | 72/173 [00:00<00:00, 364.94it/s]extract the null data:  79%|███████▉  | 137/173 [00:00<00:00, 458.69it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 459.98it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 209.23it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 209.47it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 211.91it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 211.10it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 212.12it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 213.39it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 201.90it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 201.69it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.41it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:01, 152.92it/s] 18%|█▊        | 32/173 [00:00<00:01, 129.88it/s] 29%|██▉       | 51/173 [00:00<00:00, 153.44it/s] 39%|███▊      | 67/173 [00:00<00:00, 150.50it/s] 48%|████▊     | 83/173 [00:00<00:00, 150.84it/s] 57%|█████▋    | 99/173 [00:00<00:00, 148.34it/s] 67%|██████▋   | 116/173 [00:00<00:00, 153.06it/s] 76%|███████▋  | 132/173 [00:00<00:00, 143.76it/s] 85%|████████▍ | 147/173 [00:01<00:00, 142.61it/s] 94%|█████████▎| 162/173 [00:01<00:00, 129.58it/s]100%|██████████| 173/173 [00:01<00:00, 129.41it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.098, valid loss : 0.085, train acc : 0.896, valid acc : 0.917, train f1 : 0.519, valid f1 : 0.523
training process:   1%|          | 1/128 [01:21<2:52:04, 81.29s/it]Best score increase :0.000 -> 0.523
training process:   2%|▏         | 2/128 [02:17<2:19:51, 66.60s/it]Best score increase :0.523 -> 0.587
training process:   2%|▏         | 3/128 [03:12<2:08:02, 61.46s/it]Best score increase :0.587 -> 0.679
training process:   3%|▎         | 4/128 [04:09<2:03:01, 59.52s/it]Best score increase :0.679 -> 0.732
epoch : 5, train loss : 0.050, valid loss : 0.053, train acc : 0.941, valid acc : 0.942, train f1 : 0.737, valid f1 : 0.752
training process:   4%|▍         | 5/128 [05:16<2:07:40, 62.28s/it]Best score increase :0.732 -> 0.752
training process:   5%|▍         | 6/128 [06:14<2:03:23, 60.68s/it]Best score increase :0.752 -> 0.772
training process:   5%|▌         | 7/128 [07:21<2:06:38, 62.80s/it]Best score increase :0.772 -> 0.782
training process:   6%|▋         | 8/128 [08:28<2:08:08, 64.07s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.042, valid loss : 0.046, train acc : 0.951, valid acc : 0.948, train f1 : 0.796, valid f1 : 0.783
training process:   7%|▋         | 9/128 [09:47<2:16:13, 68.69s/it]Best score increase :0.782 -> 0.783
training process:   8%|▊         | 10/128 [10:55<2:15:09, 68.72s/it]Best score increase :0.783 -> 0.805
training process:   9%|▊         | 11/128 [12:00<2:11:31, 67.45s/it]Best score increase :0.805 -> 0.821
training process:   9%|▉         | 12/128 [13:08<2:10:40, 67.59s/it]Best score increase :0.821 -> 0.824
epoch : 13, train loss : 0.038, valid loss : 0.043, train acc : 0.956, valid acc : 0.954, train f1 : 0.819, valid f1 : 0.817
training process:  10%|█         | 13/128 [14:27<2:16:30, 71.22s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [15:31<2:11:10, 69.04s/it]Best score increase :0.824 -> 0.835
training process:  12%|█▏        | 15/128 [16:39<2:09:06, 68.56s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [17:45<2:06:29, 67.77s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.037, valid loss : 0.040, train acc : 0.957, valid acc : 0.956, train f1 : 0.825, valid f1 : 0.825
training process:  13%|█▎        | 17/128 [18:59<2:08:55, 69.69s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [20:06<2:06:23, 68.94s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [21:14<2:04:48, 68.70s/it]Best score increase :0.835 -> 0.839
training process:  16%|█▌        | 20/128 [22:20<2:02:01, 67.79s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.035, valid loss : 0.041, train acc : 0.958, valid acc : 0.954, train f1 : 0.830, valid f1 : 0.814
training process:  16%|█▋        | 21/128 [23:44<2:09:21, 72.53s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [24:56<2:08:17, 72.61s/it]EarlyStopping counter : 3 out of 12
training process:  18%|█▊        | 23/128 [26:07<2:05:57, 71.98s/it]EarlyStopping counter : 4 out of 12
training process:  19%|█▉        | 24/128 [27:18<2:04:15, 71.69s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.034, valid loss : 0.038, train acc : 0.959, valid acc : 0.957, train f1 : 0.836, valid f1 : 0.836
training process:  20%|█▉        | 25/128 [28:35<2:05:55, 73.35s/it]EarlyStopping counter : 6 out of 12
training process:  20%|██        | 26/128 [29:45<2:02:42, 72.18s/it]EarlyStopping counter : 7 out of 12
training process:  21%|██        | 27/128 [30:53<1:59:35, 71.04s/it]EarlyStopping counter : 8 out of 12
training process:  22%|██▏       | 28/128 [31:58<1:55:17, 69.17s/it]Best score increase :0.839 -> 0.846
epoch : 29, train loss : 0.033, valid loss : 0.037, train acc : 0.959, valid acc : 0.958, train f1 : 0.839, valid f1 : 0.845
training process:  23%|██▎       | 29/128 [33:30<2:05:39, 76.16s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [34:53<2:07:52, 78.29s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [36:12<2:06:47, 78.43s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [37:27<2:03:35, 77.25s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.033, valid loss : 0.036, train acc : 0.961, valid acc : 0.958, train f1 : 0.846, valid f1 : 0.845
training process:  26%|██▌       | 33/128 [39:05<2:12:27, 83.66s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [40:22<2:07:33, 81.42s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [41:32<2:01:08, 78.15s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [42:45<1:57:20, 76.53s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.032, valid loss : 0.035, train acc : 0.961, valid acc : 0.958, train f1 : 0.849, valid f1 : 0.844
training process:  29%|██▉       | 37/128 [44:06<1:58:16, 77.98s/it]EarlyStopping counter : 9 out of 12
training process:  30%|██▉       | 38/128 [45:21<1:55:39, 77.11s/it]EarlyStopping counter : 10 out of 12
training process:  30%|███       | 39/128 [46:26<1:48:57, 73.45s/it]Best score increase :0.846 -> 0.852
training process:  31%|███▏      | 40/128 [47:35<1:45:31, 71.95s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.031, valid loss : 0.035, train acc : 0.962, valid acc : 0.958, train f1 : 0.851, valid f1 : 0.852
training process:  32%|███▏      | 41/128 [48:56<1:48:20, 74.72s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [50:08<1:45:57, 73.92s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [51:19<1:43:26, 73.02s/it]Best score increase :0.852 -> 0.855
training process:  34%|███▍      | 44/128 [52:28<1:40:29, 71.77s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.031, valid loss : 0.035, train acc : 0.963, valid acc : 0.959, train f1 : 0.854, valid f1 : 0.850
training process:  35%|███▌      | 45/128 [53:43<1:40:58, 72.99s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [54:42<1:33:40, 68.55s/it]EarlyStopping counter : 3 out of 12
training process:  37%|███▋      | 47/128 [55:37<1:27:20, 64.69s/it]Best score increase :0.855 -> 0.858
training process:  38%|███▊      | 48/128 [56:37<1:24:21, 63.27s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.030, valid loss : 0.034, train acc : 0.963, valid acc : 0.960, train f1 : 0.855, valid f1 : 0.851
training process:  38%|███▊      | 49/128 [57:41<1:23:26, 63.37s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [58:32<1:17:30, 59.62s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [59:20<1:11:58, 56.09s/it]Best score increase :0.858 -> 0.860
training process:  41%|████      | 52/128 [1:00:10<1:08:52, 54.37s/it]EarlyStopping counter : 1 out of 12
epoch : 53, train loss : 0.030, valid loss : 0.034, train acc : 0.964, valid acc : 0.960, train f1 : 0.860, valid f1 : 0.849
training process:  41%|████▏     | 53/128 [1:01:06<1:08:32, 54.84s/it]EarlyStopping counter : 2 out of 12
training process:  42%|████▏     | 54/128 [1:01:58<1:06:30, 53.92s/it]Best score increase :0.860 -> 0.861
training process:  43%|████▎     | 55/128 [1:02:46<1:03:23, 52.11s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [1:03:31<1:00:13, 50.18s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.029, valid loss : 0.033, train acc : 0.964, valid acc : 0.961, train f1 : 0.860, valid f1 : 0.853
training process:  45%|████▍     | 57/128 [1:04:28<1:01:42, 52.15s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [1:05:13<58:22, 50.04s/it]  EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [1:05:59<56:06, 48.79s/it]EarlyStopping counter : 5 out of 12
training process:  47%|████▋     | 60/128 [1:06:45<54:12, 47.83s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.029, valid loss : 0.034, train acc : 0.964, valid acc : 0.963, train f1 : 0.861, valid f1 : 0.869
training process:  48%|████▊     | 61/128 [1:07:38<55:09, 49.40s/it]Best score increase :0.861 -> 0.869
training process:  48%|████▊     | 62/128 [1:08:23<52:58, 48.16s/it]EarlyStopping counter : 1 out of 12
training process:  49%|████▉     | 63/128 [1:09:08<51:07, 47.19s/it]EarlyStopping counter : 2 out of 12
training process:  50%|█████     | 64/128 [1:09:52<49:32, 46.44s/it]EarlyStopping counter : 3 out of 12
epoch : 65, train loss : 0.029, valid loss : 0.035, train acc : 0.965, valid acc : 0.958, train f1 : 0.865, valid f1 : 0.848
training process:  51%|█████     | 65/128 [1:10:46<51:03, 48.62s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 66/128 [1:11:31<49:05, 47.51s/it]EarlyStopping counter : 5 out of 12
training process:  52%|█████▏    | 67/128 [1:12:16<47:25, 46.64s/it]EarlyStopping counter : 6 out of 12
training process:  53%|█████▎    | 68/128 [1:13:04<46:59, 46.99s/it]EarlyStopping counter : 7 out of 12
epoch : 69, train loss : 0.029, valid loss : 0.033, train acc : 0.965, valid acc : 0.963, train f1 : 0.865, valid f1 : 0.861
training process:  54%|█████▍    | 69/128 [1:13:57<48:09, 48.97s/it]EarlyStopping counter : 8 out of 12
training process:  55%|█████▍    | 70/128 [1:14:43<46:24, 48.00s/it]EarlyStopping counter : 9 out of 12
training process:  55%|█████▌    | 71/128 [1:15:28<44:43, 47.08s/it]EarlyStopping counter : 10 out of 12
training process:  56%|█████▋    | 72/128 [1:16:13<43:26, 46.54s/it]EarlyStopping counter : 11 out of 12
epoch : 73, train loss : 0.028, valid loss : 0.032, train acc : 0.966, valid acc : 0.964, train f1 : 0.870, valid f1 : 0.871
training process:  57%|█████▋    | 73/128 [1:17:06<44:24, 48.45s/it]Best score increase :0.869 -> 0.871
training process:  58%|█████▊    | 74/128 [1:17:52<42:58, 47.75s/it]EarlyStopping counter : 1 out of 12
training process:  59%|█████▊    | 75/128 [1:18:40<42:13, 47.79s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▉    | 76/128 [1:19:28<41:34, 47.97s/it]EarlyStopping counter : 3 out of 12
epoch : 77, train loss : 0.028, valid loss : 0.033, train acc : 0.966, valid acc : 0.961, train f1 : 0.868, valid f1 : 0.859
training process:  60%|██████    | 77/128 [1:20:24<42:41, 50.22s/it]EarlyStopping counter : 4 out of 12
training process:  61%|██████    | 78/128 [1:21:11<41:04, 49.30s/it]EarlyStopping counter : 5 out of 12
training process:  62%|██████▏   | 79/128 [1:21:58<39:45, 48.68s/it]EarlyStopping counter : 6 out of 12
training process:  62%|██████▎   | 80/128 [1:22:51<39:54, 49.89s/it]EarlyStopping counter : 7 out of 12
epoch : 81, train loss : 0.028, valid loss : 0.032, train acc : 0.967, valid acc : 0.962, train f1 : 0.872, valid f1 : 0.860
training process:  63%|██████▎   | 81/128 [1:23:56<42:44, 54.56s/it]EarlyStopping counter : 8 out of 12
training process:  64%|██████▍   | 82/128 [1:24:52<42:03, 54.87s/it]EarlyStopping counter : 9 out of 12
training process:  65%|██████▍   | 83/128 [1:25:49<41:37, 55.51s/it]EarlyStopping counter : 10 out of 12
training process:  66%|██████▌   | 84/128 [1:26:51<42:05, 57.39s/it]EarlyStopping counter : 11 out of 12
epoch : 85, train loss : 0.028, valid loss : 0.033, train acc : 0.966, valid acc : 0.962, train f1 : 0.871, valid f1 : 0.868
training process:  66%|██████▌   | 84/128 [1:28:13<46:13, 63.02s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 84, best f1 score : 0.871
training process finished, best loss : 0.032 and best acc : 0.964, best f1 : 0.871, best epoch : 72

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.67      0.64       580
           1       0.97      0.97      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.80      0.82      0.81      7398
weighted avg       0.94      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.82, test loss : 3.310

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:45,  9.58s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:41, 10.15s/it]processing for feature importance:  25%|██▌       | 3/12 [00:30<01:32, 10.27s/it]processing for feature importance:  33%|███▎      | 4/12 [00:40<01:21, 10.17s/it]processing for feature importance:  42%|████▏     | 5/12 [00:51<01:12, 10.34s/it]processing for feature importance:  50%|█████     | 6/12 [01:01<01:02, 10.38s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:11<00:50, 10.06s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:21<00:40, 10.20s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:32<00:31, 10.57s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:43<00:20, 10.47s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:54<00:10, 10.69s/it]processing for feature importance: 100%|██████████| 12/12 [02:05<00:00, 10.74s/it]processing for feature importance: 100%|██████████| 12/12 [02:05<00:00, 10.44s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 12%|█▏        | 36/306 [00:00<00:00, 351.96it/s] 24%|██▎       | 72/306 [00:00<00:00, 353.28it/s] 35%|███▌      | 108/306 [00:00<00:00, 347.53it/s] 48%|████▊     | 146/306 [00:00<00:00, 359.04it/s] 60%|██████    | 184/306 [00:00<00:00, 364.77it/s] 72%|███████▏  | 221/306 [00:00<00:00, 360.99it/s] 84%|████████▍ | 258/306 [00:00<00:00, 356.48it/s] 96%|█████████▌| 294/306 [00:00<00:00, 352.44it/s]100%|██████████| 306/306 [00:00<00:00, 354.57it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 64/553 [00:00<00:00, 633.58it/s]extract the null data:  23%|██▎       | 128/553 [00:00<00:00, 612.43it/s]extract the null data:  34%|███▍      | 190/553 [00:00<00:00, 609.06it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 571.88it/s]extract the null data:  56%|█████▋    | 312/553 [00:00<00:00, 583.60it/s]extract the null data:  68%|██████▊   | 374/553 [00:00<00:00, 593.59it/s]extract the null data:  78%|███████▊  | 434/553 [00:00<00:00, 593.38it/s]extract the null data:  89%|████████▉ | 494/553 [00:00<00:00, 593.61it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 594.40it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 185.33it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 191.31it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 182.26it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:02, 187.27it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 189.78it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 199.71it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 202.37it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:01, 203.80it/s]replace nan value:  33%|███▎      | 184/553 [00:00<00:01, 205.07it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:01, 205.77it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 204.84it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 200.72it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 200.29it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 188.04it/s]replace nan value:  56%|█████▌    | 311/553 [00:01<00:01, 194.74it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:01, 194.53it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:01, 193.33it/s]replace nan value:  67%|██████▋   | 371/553 [00:01<00:01, 178.97it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:00, 185.12it/s]replace nan value:  75%|███████▍  | 413/553 [00:02<00:00, 189.95it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 195.43it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 199.87it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 202.10it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 201.40it/s]replace nan value:  94%|█████████▍| 519/553 [00:02<00:00, 201.12it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 195.75it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 195.85it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 141.91it/s]  5%|▌         | 30/553 [00:00<00:04, 120.58it/s]  8%|▊         | 43/553 [00:00<00:04, 114.51it/s] 10%|█         | 56/553 [00:00<00:04, 116.30it/s] 12%|█▏        | 68/553 [00:00<00:04, 110.36it/s] 15%|█▌        | 84/553 [00:00<00:03, 123.36it/s] 18%|█▊        | 98/553 [00:00<00:03, 124.59it/s] 21%|██        | 115/553 [00:00<00:03, 135.69it/s] 23%|██▎       | 129/553 [00:01<00:03, 135.25it/s] 27%|██▋       | 149/553 [00:01<00:02, 151.64it/s] 30%|██▉       | 165/553 [00:01<00:02, 153.62it/s] 33%|███▎      | 181/553 [00:01<00:02, 153.69it/s] 36%|███▌      | 197/553 [00:01<00:02, 148.02it/s] 39%|███▊      | 214/553 [00:01<00:02, 153.73it/s] 42%|████▏     | 230/553 [00:01<00:02, 143.49it/s] 44%|████▍     | 246/553 [00:01<00:02, 146.17it/s] 47%|████▋     | 262/553 [00:01<00:01, 148.89it/s] 50%|█████     | 278/553 [00:02<00:01, 141.45it/s] 53%|█████▎    | 293/553 [00:02<00:01, 135.64it/s] 56%|█████▌    | 307/553 [00:02<00:01, 130.41it/s] 58%|█████▊    | 321/553 [00:02<00:01, 128.58it/s] 61%|██████    | 336/553 [00:02<00:01, 133.30it/s] 63%|██████▎   | 350/553 [00:02<00:01, 133.05it/s] 66%|██████▌   | 364/553 [00:02<00:01, 131.26it/s] 68%|██████▊   | 378/553 [00:02<00:01, 132.74it/s] 71%|███████   | 392/553 [00:02<00:01, 121.54it/s] 73%|███████▎  | 405/553 [00:03<00:01, 123.51it/s] 76%|███████▌  | 418/553 [00:03<00:01, 116.52it/s] 78%|███████▊  | 430/553 [00:03<00:01, 116.00it/s] 81%|████████  | 449/553 [00:03<00:00, 135.07it/s] 84%|████████▍ | 464/553 [00:03<00:00, 136.60it/s] 86%|████████▋ | 478/553 [00:03<00:00, 136.09it/s] 89%|████████▉ | 492/553 [00:03<00:00, 131.86it/s] 92%|█████████▏| 506/553 [00:03<00:00, 130.40it/s] 94%|█████████▍| 521/553 [00:03<00:00, 131.08it/s] 97%|█████████▋| 535/553 [00:04<00:00, 114.61it/s]100%|█████████▉| 551/553 [00:04<00:00, 109.22it/s]100%|██████████| 553/553 [00:04<00:00, 130.31it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 328.17it/s]extract the null data:  72%|███████▏  | 100/139 [00:00<00:00, 528.72it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 530.00it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 210.73it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 207.55it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 211.48it/s]replace nan value:  64%|██████▍   | 89/139 [00:00<00:00, 217.45it/s]replace nan value:  80%|███████▉  | 111/139 [00:00<00:00, 216.89it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 215.87it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 214.66it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 102.55it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.81it/s] 32%|███▏      | 45/139 [00:00<00:00, 149.85it/s] 44%|████▍     | 61/139 [00:00<00:00, 139.11it/s] 55%|█████▌    | 77/139 [00:00<00:00, 140.92it/s] 66%|██████▌   | 92/139 [00:00<00:00, 131.40it/s] 76%|███████▋  | 106/139 [00:00<00:00, 124.77it/s] 86%|████████▌ | 119/139 [00:00<00:00, 107.92it/s] 94%|█████████▍| 131/139 [00:01<00:00, 105.72it/s]100%|██████████| 139/139 [00:01<00:00, 122.32it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   8%|▊         | 14/173 [00:00<00:01, 139.74it/s]extract the null data:  46%|████▌     | 80/173 [00:00<00:00, 444.69it/s]extract the null data:  80%|████████  | 139/173 [00:00<00:00, 497.71it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 410.67it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   5%|▌         | 9/173 [00:00<00:01, 87.19it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:01, 97.52it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:01, 112.99it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 143.98it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 171.98it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 188.98it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 193.04it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 199.02it/s]replace nan value:  95%|█████████▌| 165/173 [00:00<00:00, 202.99it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 175.86it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.69it/s] 16%|█▌        | 28/173 [00:00<00:01, 120.76it/s] 25%|██▍       | 43/173 [00:00<00:00, 131.02it/s] 34%|███▎      | 58/173 [00:00<00:00, 136.21it/s] 43%|████▎     | 74/173 [00:00<00:00, 144.27it/s] 51%|█████▏    | 89/173 [00:00<00:00, 145.64it/s] 61%|██████    | 105/173 [00:00<00:00, 148.39it/s] 69%|██████▉   | 120/173 [00:00<00:00, 125.57it/s] 77%|███████▋  | 134/173 [00:01<00:00, 95.27it/s]  84%|████████▍ | 145/173 [00:01<00:00, 84.99it/s] 90%|█████████ | 156/173 [00:01<00:00, 89.11it/s] 96%|█████████▌| 166/173 [00:01<00:00, 83.04it/s]100%|██████████| 173/173 [00:01<00:00, 105.30it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.157, valid loss : 0.130, train acc : 0.658, valid acc : 0.757, train f1 : 0.657, valid f1 : 0.589
training process:   1%|          | 1/128 [01:18<2:46:26, 78.64s/it]Best score increase :0.000 -> 0.589
training process:   2%|▏         | 2/128 [02:22<2:26:56, 69.97s/it]Best score increase :0.589 -> 0.616
training process:   2%|▏         | 3/128 [03:26<2:20:24, 67.40s/it]Best score increase :0.616 -> 0.705
training process:   3%|▎         | 4/128 [04:35<2:20:16, 67.87s/it]Best score increase :0.705 -> 0.739
epoch : 5, train loss : 0.092, valid loss : 0.081, train acc : 0.846, valid acc : 0.895, train f1 : 0.846, valid f1 : 0.745
training process:   4%|▍         | 5/128 [05:51<2:25:10, 70.82s/it]Best score increase :0.739 -> 0.745
training process:   5%|▍         | 6/128 [06:59<2:21:41, 69.69s/it]Best score increase :0.745 -> 0.768
training process:   5%|▌         | 7/128 [08:08<2:20:41, 69.76s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:19<2:20:06, 70.06s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.082, valid loss : 0.070, train acc : 0.863, valid acc : 0.926, train f1 : 0.863, valid f1 : 0.793
training process:   7%|▋         | 9/128 [10:39<2:24:44, 72.98s/it]Best score increase :0.768 -> 0.793
training process:   8%|▊         | 10/128 [11:54<2:24:55, 73.69s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [13:14<2:27:26, 75.61s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [14:23<2:22:31, 73.72s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.075, valid loss : 0.092, train acc : 0.872, valid acc : 0.866, train f1 : 0.872, valid f1 : 0.719
training process:  10%|█         | 13/128 [15:51<2:29:16, 77.88s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [17:05<2:25:52, 76.77s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [18:19<2:23:02, 75.95s/it]EarlyStopping counter : 6 out of 12
training process:  12%|█▎        | 16/128 [19:28<2:18:12, 74.04s/it]EarlyStopping counter : 7 out of 12
epoch : 17, train loss : 0.070, valid loss : 0.068, train acc : 0.883, valid acc : 0.920, train f1 : 0.883, valid f1 : 0.791
training process:  13%|█▎        | 17/128 [20:49<2:20:49, 76.12s/it]EarlyStopping counter : 8 out of 12
training process:  14%|█▍        | 18/128 [21:58<2:15:15, 73.78s/it]Best score increase :0.793 -> 0.802
training process:  15%|█▍        | 19/128 [23:01<2:08:16, 70.61s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [24:02<2:01:56, 67.74s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.066, valid loss : 0.094, train acc : 0.887, valid acc : 0.859, train f1 : 0.887, valid f1 : 0.716
training process:  16%|█▋        | 21/128 [25:14<2:02:55, 68.93s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [26:09<1:54:26, 64.78s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [27:03<1:48:02, 61.74s/it]EarlyStopping counter : 5 out of 12
training process:  19%|█▉        | 24/128 [28:02<1:45:16, 60.73s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.065, valid loss : 0.085, train acc : 0.893, valid acc : 0.878, train f1 : 0.893, valid f1 : 0.737
training process:  20%|█▉        | 25/128 [29:10<1:48:16, 63.08s/it]EarlyStopping counter : 7 out of 12
training process:  20%|██        | 26/128 [30:06<1:43:23, 60.82s/it]EarlyStopping counter : 8 out of 12
training process:  21%|██        | 27/128 [31:10<1:44:14, 61.92s/it]EarlyStopping counter : 9 out of 12
training process:  22%|██▏       | 28/128 [32:14<1:44:09, 62.50s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.062, valid loss : 0.070, train acc : 0.901, valid acc : 0.923, train f1 : 0.901, valid f1 : 0.801
training process:  23%|██▎       | 29/128 [33:24<1:46:27, 64.52s/it]EarlyStopping counter : 11 out of 12
training process:  23%|██▎       | 29/128 [34:16<1:57:01, 70.92s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 29, best f1 score : 0.802
training process finished, best loss : 0.066 and best acc : 0.927, best f1 : 0.802, best epoch : 17

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.46      0.77      0.58       580
           1       0.98      0.92      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.72      0.85      0.76      7398
weighted avg       0.94      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.76, test AUC : 0.85, test loss : 3.650

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.97s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:23,  8.35s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:14,  8.31s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:06,  8.30s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:57,  8.27s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:49,  8.22s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:58<00:43,  8.61s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:34,  8.74s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:16<00:26,  8.83s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:25<00:17,  8.66s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:35<00:09,  9.05s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.55s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 18%|█▊        | 56/306 [00:00<00:00, 558.32it/s] 38%|███▊      | 116/306 [00:00<00:00, 578.14it/s] 57%|█████▋    | 175/306 [00:00<00:00, 578.98it/s] 76%|███████▌  | 233/306 [00:00<00:00, 576.98it/s] 95%|█████████▌| 291/306 [00:00<00:00, 568.10it/s]100%|██████████| 306/306 [00:00<00:00, 570.47it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 550.15it/s]extract the null data:  20%|██        | 113/553 [00:00<00:00, 558.41it/s]extract the null data:  31%|███       | 172/553 [00:00<00:00, 570.24it/s]extract the null data:  42%|████▏     | 230/553 [00:00<00:00, 567.18it/s]extract the null data:  52%|█████▏    | 287/553 [00:00<00:00, 566.59it/s]extract the null data:  62%|██████▏   | 344/553 [00:00<00:00, 564.89it/s]extract the null data:  73%|███████▎  | 401/553 [00:00<00:00, 493.01it/s]extract the null data:  82%|████████▏ | 452/553 [00:00<00:00, 451.97it/s]extract the null data:  91%|█████████ | 504/553 [00:00<00:00, 469.54it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 511.96it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 161.05it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 154.66it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 157.78it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:03, 159.85it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 162.28it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 162.54it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 163.71it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 164.72it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:02, 163.55it/s]replace nan value:  31%|███       | 172/553 [00:01<00:02, 170.04it/s]replace nan value:  35%|███▍      | 193/553 [00:01<00:02, 179.93it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 183.53it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 187.67it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 188.20it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 189.71it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 193.46it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 195.42it/s]replace nan value:  60%|██████    | 334/553 [00:01<00:01, 195.12it/s]replace nan value:  64%|██████▍   | 355/553 [00:01<00:01, 197.40it/s]replace nan value:  68%|██████▊   | 376/553 [00:02<00:00, 198.75it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 193.33it/s]replace nan value:  75%|███████▌  | 416/553 [00:02<00:00, 181.79it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 175.28it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 172.65it/s]replace nan value:  85%|████████▌ | 471/553 [00:02<00:00, 170.75it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 167.69it/s]replace nan value:  92%|█████████▏| 506/553 [00:02<00:00, 164.34it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 162.22it/s]replace nan value:  98%|█████████▊| 540/553 [00:03<00:00, 162.17it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 174.70it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.30it/s]  5%|▍         | 26/553 [00:00<00:04, 127.74it/s]  7%|▋         | 40/553 [00:00<00:04, 127.49it/s] 10%|▉         | 53/553 [00:00<00:04, 117.48it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.21it/s] 14%|█▍        | 78/553 [00:00<00:04, 112.57it/s] 16%|█▋        | 91/553 [00:00<00:04, 114.55it/s] 19%|█▊        | 103/553 [00:00<00:03, 115.29it/s] 21%|██▏       | 118/553 [00:00<00:03, 125.18it/s] 24%|██▎       | 131/553 [00:01<00:03, 121.72it/s] 27%|██▋       | 148/553 [00:01<00:03, 134.82it/s] 29%|██▉       | 163/553 [00:01<00:02, 137.57it/s] 32%|███▏      | 178/553 [00:01<00:02, 139.81it/s] 35%|███▌      | 194/553 [00:01<00:02, 144.22it/s] 38%|███▊      | 210/553 [00:01<00:02, 147.33it/s] 41%|████      | 225/553 [00:01<00:02, 140.52it/s] 43%|████▎     | 240/553 [00:01<00:02, 140.67it/s] 46%|████▌     | 255/553 [00:01<00:02, 133.60it/s] 49%|████▊     | 269/553 [00:02<00:02, 133.25it/s] 51%|█████     | 283/553 [00:02<00:02, 127.80it/s] 54%|█████▎    | 296/553 [00:02<00:02, 125.48it/s] 56%|█████▌    | 309/553 [00:02<00:01, 124.84it/s] 58%|█████▊    | 322/553 [00:02<00:01, 121.98it/s] 61%|██████    | 335/553 [00:02<00:01, 123.30it/s] 63%|██████▎   | 348/553 [00:02<00:01, 123.56it/s] 65%|██████▌   | 361/553 [00:02<00:01, 119.37it/s] 68%|██████▊   | 376/553 [00:02<00:01, 126.39it/s] 70%|███████   | 389/553 [00:03<00:01, 119.49it/s] 73%|███████▎  | 402/553 [00:03<00:01, 113.42it/s] 75%|███████▌  | 415/553 [00:03<00:01, 117.54it/s] 77%|███████▋  | 427/553 [00:03<00:01, 109.29it/s] 80%|███████▉  | 442/553 [00:03<00:00, 119.30it/s] 83%|████████▎ | 457/553 [00:03<00:00, 127.09it/s] 85%|████████▌ | 471/553 [00:03<00:00, 129.01it/s] 88%|████████▊ | 485/553 [00:03<00:00, 128.69it/s] 90%|█████████ | 498/553 [00:03<00:00, 118.21it/s] 93%|█████████▎| 512/553 [00:04<00:00, 123.94it/s] 95%|█████████▍| 525/553 [00:04<00:00, 112.69it/s] 97%|█████████▋| 537/553 [00:04<00:00, 107.79it/s]100%|█████████▉| 551/553 [00:04<00:00, 97.12it/s] 100%|██████████| 553/553 [00:04<00:00, 121.71it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 276.99it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 416.90it/s]extract the null data:  97%|█████████▋| 135/139 [00:00<00:00, 474.89it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 448.40it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 192.78it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 187.66it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 184.59it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 185.50it/s]replace nan value:  70%|██████▉   | 97/139 [00:00<00:00, 184.62it/s]replace nan value:  83%|████████▎ | 116/139 [00:00<00:00, 184.02it/s]replace nan value:  97%|█████████▋| 135/139 [00:00<00:00, 184.90it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 185.31it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.22it/s] 17%|█▋        | 24/139 [00:00<00:00, 119.64it/s] 27%|██▋       | 38/139 [00:00<00:00, 127.36it/s] 37%|███▋      | 51/139 [00:00<00:00, 122.89it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.93it/s] 55%|█████▌    | 77/139 [00:00<00:00, 118.21it/s] 64%|██████▍   | 89/139 [00:00<00:00, 106.59it/s] 74%|███████▍  | 103/139 [00:00<00:00, 115.01it/s] 83%|████████▎ | 115/139 [00:00<00:00, 115.06it/s] 92%|█████████▏| 128/139 [00:01<00:00, 118.00it/s]100%|██████████| 139/139 [00:01<00:00, 118.26it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 236.83it/s]extract the null data:  46%|████▌     | 79/173 [00:00<00:00, 417.71it/s]extract the null data:  76%|███████▋  | 132/173 [00:00<00:00, 465.40it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 446.87it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 188.04it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 188.84it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 186.83it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 185.73it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 186.94it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 185.59it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 184.73it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 184.91it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 182.20it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 184.58it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.30it/s] 16%|█▌        | 28/173 [00:00<00:01, 125.97it/s] 25%|██▌       | 44/173 [00:00<00:00, 137.16it/s] 35%|███▍      | 60/173 [00:00<00:00, 143.79it/s] 43%|████▎     | 75/173 [00:00<00:00, 139.67it/s] 52%|█████▏    | 90/173 [00:00<00:00, 142.81it/s] 61%|██████    | 105/173 [00:00<00:00, 139.55it/s] 69%|██████▉   | 120/173 [00:00<00:00, 140.17it/s] 78%|███████▊  | 135/173 [00:00<00:00, 134.81it/s] 86%|████████▌ | 149/173 [00:01<00:00, 130.54it/s] 94%|█████████▍| 163/173 [00:01<00:00, 125.45it/s]100%|██████████| 173/173 [00:01<00:00, 122.96it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.024, valid loss : 0.023, train acc : 0.683, valid acc : 0.762, train f1 : 0.511, valid f1 : 0.573
training process:   1%|          | 1/128 [00:58<2:04:16, 58.71s/it]Best score increase :0.000 -> 0.573
training process:   2%|▏         | 2/128 [01:49<1:54:01, 54.30s/it]Best score increase :0.573 -> 0.601
training process:   2%|▏         | 3/128 [02:40<1:49:54, 52.76s/it]Best score increase :0.601 -> 0.669
training process:   3%|▎         | 4/128 [03:31<1:47:35, 52.06s/it]Best score increase :0.669 -> 0.732
epoch : 5, train loss : 0.015, valid loss : 0.016, train acc : 0.879, valid acc : 0.868, train f1 : 0.715, valid f1 : 0.709
training process:   4%|▍         | 5/128 [04:31<1:52:23, 54.82s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:23<1:49:19, 53.77s/it]Best score increase :0.732 -> 0.759
training process:   5%|▌         | 7/128 [06:14<1:46:47, 52.95s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:05<1:44:44, 52.37s/it]Best score increase :0.759 -> 0.783
epoch : 9, train loss : 0.014, valid loss : 0.015, train acc : 0.904, valid acc : 0.931, train f1 : 0.755, valid f1 : 0.797
training process:   7%|▋         | 9/128 [08:04<1:47:56, 54.42s/it]Best score increase :0.783 -> 0.797
training process:   8%|▊         | 10/128 [08:56<1:45:24, 53.60s/it]Best score increase :0.797 -> 0.798
training process:   9%|▊         | 11/128 [09:48<1:43:33, 53.10s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:40<1:41:52, 52.69s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.013, valid loss : 0.015, train acc : 0.914, valid acc : 0.921, train f1 : 0.771, valid f1 : 0.787
training process:  10%|█         | 13/128 [11:40<1:45:36, 55.10s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:32<1:42:53, 54.15s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [13:22<1:39:41, 52.93s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▎        | 16/128 [14:13<1:37:46, 52.38s/it]Best score increase :0.798 -> 0.806
epoch : 17, train loss : 0.012, valid loss : 0.015, train acc : 0.918, valid acc : 0.933, train f1 : 0.781, valid f1 : 0.805
training process:  13%|█▎        | 17/128 [15:14<1:41:12, 54.71s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [16:04<1:38:11, 53.56s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [16:57<1:36:32, 53.14s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [17:48<1:34:50, 52.69s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.012, valid loss : 0.017, train acc : 0.920, valid acc : 0.941, train f1 : 0.785, valid f1 : 0.814
training process:  16%|█▋        | 21/128 [18:50<1:38:53, 55.46s/it]Best score increase :0.806 -> 0.814
training process:  17%|█▋        | 22/128 [19:45<1:37:41, 55.29s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [20:39<1:36:08, 54.94s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [21:35<1:35:28, 55.08s/it]Best score increase :0.814 -> 0.817
epoch : 25, train loss : 0.012, valid loss : 0.015, train acc : 0.928, valid acc : 0.922, train f1 : 0.800, valid f1 : 0.797
training process:  20%|█▉        | 25/128 [22:37<1:38:16, 57.25s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 26/128 [23:32<1:36:17, 56.64s/it]EarlyStopping counter : 2 out of 12
training process:  21%|██        | 27/128 [24:24<1:32:47, 55.12s/it]EarlyStopping counter : 3 out of 12
training process:  22%|██▏       | 28/128 [25:18<1:31:29, 54.90s/it]EarlyStopping counter : 4 out of 12
epoch : 29, train loss : 0.012, valid loss : 0.015, train acc : 0.931, valid acc : 0.909, train f1 : 0.808, valid f1 : 0.777
training process:  23%|██▎       | 29/128 [26:20<1:34:09, 57.07s/it]EarlyStopping counter : 5 out of 12
training process:  23%|██▎       | 30/128 [27:14<1:31:47, 56.19s/it]EarlyStopping counter : 6 out of 12
training process:  24%|██▍       | 31/128 [28:10<1:30:29, 55.98s/it]EarlyStopping counter : 7 out of 12
training process:  25%|██▌       | 32/128 [29:03<1:28:24, 55.26s/it]EarlyStopping counter : 8 out of 12
epoch : 33, train loss : 0.011, valid loss : 0.014, train acc : 0.931, valid acc : 0.904, train f1 : 0.807, valid f1 : 0.773
training process:  26%|██▌       | 33/128 [30:07<1:31:40, 57.90s/it]EarlyStopping counter : 9 out of 12
training process:  27%|██▋       | 34/128 [31:03<1:29:49, 57.34s/it]EarlyStopping counter : 10 out of 12
training process:  27%|██▋       | 35/128 [31:58<1:27:28, 56.44s/it]Best score increase :0.817 -> 0.820
training process:  28%|██▊       | 36/128 [32:52<1:25:25, 55.71s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.011, valid loss : 0.015, train acc : 0.933, valid acc : 0.923, train f1 : 0.812, valid f1 : 0.799
training process:  29%|██▉       | 37/128 [33:53<1:26:53, 57.29s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [34:47<1:24:34, 56.38s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [35:41<1:22:34, 55.67s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [36:34<1:20:38, 54.98s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.011, valid loss : 0.016, train acc : 0.936, valid acc : 0.923, train f1 : 0.818, valid f1 : 0.799
training process:  32%|███▏      | 41/128 [37:36<1:22:37, 56.98s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [38:30<1:20:22, 56.07s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [39:21<1:17:28, 54.69s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [40:15<1:16:01, 54.30s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.011, valid loss : 0.016, train acc : 0.935, valid acc : 0.929, train f1 : 0.817, valid f1 : 0.811
training process:  35%|███▌      | 45/128 [41:17<1:18:15, 56.57s/it]EarlyStopping counter : 10 out of 12
training process:  36%|███▌      | 46/128 [42:10<1:15:48, 55.47s/it]EarlyStopping counter : 11 out of 12
training process:  36%|███▌      | 46/128 [43:04<1:16:47, 56.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 46, best f1 score : 0.820
training process finished, best loss : 0.016 and best acc : 0.938, best f1 : 0.820, best epoch : 34

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.49      0.77      0.60       580
           1       0.98      0.93      0.95      6818

    accuracy                           0.92      7398
   macro avg       0.73      0.85      0.77      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.77, test AUC : 0.85, test loss : 0.872

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.82s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.79s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.41s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.39s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:53,  7.61s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.55s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.50s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.58s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:23,  7.73s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.66s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.78s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.84s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.67s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 25/306 [00:00<00:01, 244.46it/s] 16%|█▋        | 50/306 [00:00<00:01, 211.37it/s] 24%|██▎       | 72/306 [00:00<00:01, 175.92it/s] 32%|███▏      | 97/306 [00:00<00:01, 197.50it/s] 39%|███▊      | 118/306 [00:00<00:00, 195.29it/s] 45%|████▌     | 138/306 [00:00<00:00, 171.48it/s] 51%|█████▏    | 157/306 [00:00<00:00, 172.62it/s] 60%|█████▉    | 183/306 [00:00<00:00, 196.56it/s] 67%|██████▋   | 204/306 [00:01<00:00, 175.97it/s] 73%|███████▎  | 223/306 [00:01<00:00, 160.28it/s] 79%|███████▉  | 243/306 [00:01<00:00, 166.55it/s] 87%|████████▋ | 266/306 [00:01<00:00, 178.13it/s] 93%|█████████▎| 285/306 [00:01<00:00, 172.21it/s] 99%|█████████▉| 303/306 [00:01<00:00, 157.14it/s]100%|██████████| 306/306 [00:01<00:00, 175.86it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 68/553 [00:00<00:00, 679.23it/s]extract the null data:  25%|██▌       | 140/553 [00:00<00:00, 698.22it/s]extract the null data:  38%|███▊      | 210/553 [00:00<00:00, 694.84it/s]extract the null data:  51%|█████     | 280/553 [00:00<00:00, 692.57it/s]extract the null data:  63%|██████▎   | 351/553 [00:00<00:00, 695.96it/s]extract the null data:  76%|███████▋  | 423/553 [00:00<00:00, 702.51it/s]extract the null data:  89%|████████▉ | 494/553 [00:00<00:00, 690.33it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 691.50it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 24/553 [00:00<00:02, 239.64it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:02, 239.47it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 234.91it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:01, 230.83it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:01, 231.55it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:01, 236.74it/s]replace nan value:  31%|███       | 170/553 [00:00<00:01, 238.46it/s]replace nan value:  35%|███▌      | 194/553 [00:00<00:01, 238.73it/s]replace nan value:  39%|███▉      | 218/553 [00:00<00:01, 232.90it/s]replace nan value:  44%|████▍     | 242/553 [00:01<00:01, 223.61it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 222.77it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 223.01it/s]replace nan value:  56%|█████▌    | 311/553 [00:01<00:01, 219.38it/s]replace nan value:  60%|██████    | 334/553 [00:01<00:00, 221.44it/s]replace nan value:  65%|██████▍   | 358/553 [00:01<00:00, 225.54it/s]replace nan value:  69%|██████▉   | 384/553 [00:01<00:00, 235.01it/s]replace nan value:  74%|███████▍  | 409/553 [00:01<00:00, 239.04it/s]replace nan value:  78%|███████▊  | 434/553 [00:01<00:00, 239.77it/s]replace nan value:  83%|████████▎ | 459/553 [00:01<00:00, 241.64it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 242.42it/s]replace nan value:  92%|█████████▏| 509/553 [00:02<00:00, 242.27it/s]replace nan value:  97%|█████████▋| 534/553 [00:02<00:00, 241.45it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 233.53it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 116.45it/s]  5%|▍         | 26/553 [00:00<00:04, 118.20it/s]  7%|▋         | 41/553 [00:00<00:03, 129.88it/s] 10%|▉         | 55/553 [00:00<00:03, 125.93it/s] 12%|█▏        | 68/553 [00:00<00:04, 116.27it/s] 15%|█▌        | 84/553 [00:00<00:03, 129.11it/s] 18%|█▊        | 98/553 [00:00<00:03, 129.99it/s] 21%|██        | 115/553 [00:00<00:03, 139.95it/s] 24%|██▎       | 130/553 [00:00<00:03, 139.10it/s] 27%|██▋       | 150/553 [00:01<00:02, 156.37it/s] 31%|███       | 169/553 [00:01<00:02, 164.23it/s] 34%|███▎      | 186/553 [00:01<00:02, 160.74it/s] 37%|███▋      | 205/553 [00:01<00:02, 168.20it/s] 40%|████      | 222/553 [00:01<00:02, 157.76it/s] 43%|████▎     | 240/553 [00:01<00:01, 161.43it/s] 46%|████▋     | 257/553 [00:01<00:01, 154.75it/s] 49%|████▉     | 273/553 [00:01<00:01, 150.29it/s] 52%|█████▏    | 290/553 [00:01<00:01, 153.69it/s] 55%|█████▌    | 306/553 [00:02<00:01, 139.30it/s] 58%|█████▊    | 321/553 [00:02<00:01, 134.79it/s] 61%|██████    | 335/553 [00:02<00:01, 135.14it/s] 63%|██████▎   | 349/553 [00:02<00:01, 136.07it/s] 66%|██████▌   | 363/553 [00:02<00:01, 134.91it/s] 69%|██████▊   | 379/553 [00:02<00:01, 140.11it/s] 71%|███████   | 394/553 [00:02<00:01, 130.35it/s] 74%|███████▍  | 409/553 [00:02<00:01, 134.23it/s] 76%|███████▋  | 423/553 [00:03<00:01, 127.47it/s] 79%|███████▉  | 436/553 [00:03<00:00, 127.11it/s] 82%|████████▏ | 453/553 [00:03<00:00, 138.79it/s] 85%|████████▍ | 470/553 [00:03<00:00, 143.36it/s] 88%|████████▊ | 485/553 [00:03<00:00, 142.75it/s] 90%|█████████ | 500/553 [00:03<00:00, 131.65it/s] 93%|█████████▎| 517/553 [00:03<00:00, 140.42it/s] 96%|█████████▌| 532/553 [00:03<00:00, 117.89it/s] 99%|█████████▉| 549/553 [00:03<00:00, 130.54it/s]100%|██████████| 553/553 [00:04<00:00, 136.52it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 369.56it/s]extract the null data:  77%|███████▋  | 107/139 [00:00<00:00, 560.86it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 564.13it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 227.18it/s]replace nan value:  34%|███▍      | 47/139 [00:00<00:00, 232.11it/s]replace nan value:  51%|█████     | 71/139 [00:00<00:00, 232.70it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 229.30it/s]replace nan value:  85%|████████▍ | 118/139 [00:00<00:00, 229.17it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 229.71it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:01, 124.85it/s] 20%|██        | 28/139 [00:00<00:00, 132.89it/s] 32%|███▏      | 44/139 [00:00<00:00, 141.14it/s] 42%|████▏     | 59/139 [00:00<00:00, 126.11it/s] 52%|█████▏    | 72/139 [00:00<00:00, 127.29it/s] 61%|██████    | 85/139 [00:00<00:00, 126.13it/s] 71%|███████   | 98/139 [00:00<00:00, 126.05it/s] 81%|████████  | 112/139 [00:00<00:00, 128.96it/s] 92%|█████████▏| 128/139 [00:00<00:00, 138.09it/s]100%|██████████| 139/139 [00:01<00:00, 133.81it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 33/173 [00:00<00:00, 327.39it/s]extract the null data:  60%|█████▉    | 103/173 [00:00<00:00, 543.19it/s]extract the null data:  99%|█████████▉| 171/173 [00:00<00:00, 601.38it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 564.83it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 219.75it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 217.24it/s]replace nan value:  39%|███▊      | 67/173 [00:00<00:00, 222.41it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 224.35it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 224.45it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 223.60it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 224.41it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 222.21it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.52it/s] 16%|█▌        | 28/173 [00:00<00:01, 123.23it/s] 26%|██▌       | 45/173 [00:00<00:00, 141.12it/s] 36%|███▋      | 63/173 [00:00<00:00, 154.00it/s] 46%|████▌     | 79/173 [00:00<00:00, 155.13it/s] 55%|█████▍    | 95/173 [00:00<00:00, 153.52it/s] 64%|██████▍   | 111/173 [00:00<00:00, 150.47it/s] 73%|███████▎  | 127/173 [00:00<00:00, 137.92it/s] 83%|████████▎ | 143/173 [00:00<00:00, 142.17it/s] 91%|█████████▏| 158/173 [00:01<00:00, 134.31it/s] 99%|█████████▉| 172/173 [00:01<00:00, 104.05it/s]100%|██████████| 173/173 [00:01<00:00, 129.73it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.054, valid loss : 0.041, train acc : 0.490, valid acc : 0.084, train f1 : 0.362, valid f1 : 0.078
training process:   1%|          | 1/128 [01:07<2:23:24, 67.76s/it]Best score increase :0.000 -> 0.078
training process:   2%|▏         | 2/128 [02:02<2:06:22, 60.18s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:58<2:01:26, 58.30s/it]Best score increase :0.078 -> 0.264
training process:   3%|▎         | 4/128 [03:56<2:00:20, 58.23s/it]Best score increase :0.264 -> 0.330
epoch : 5, train loss : 0.026, valid loss : 0.031, train acc : 0.691, valid acc : 0.419, train f1 : 0.661, valid f1 : 0.378
training process:   4%|▍         | 5/128 [05:01<2:04:02, 60.51s/it]Best score increase :0.330 -> 0.378
training process:   5%|▍         | 6/128 [05:56<1:59:15, 58.65s/it]Best score increase :0.378 -> 0.429
training process:   5%|▌         | 7/128 [06:48<1:53:43, 56.40s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:42<1:51:13, 55.61s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.021, valid loss : 0.028, train acc : 0.746, valid acc : 0.493, train f1 : 0.729, valid f1 : 0.431
training process:   7%|▋         | 9/128 [08:57<2:02:44, 61.88s/it]Best score increase :0.429 -> 0.431
training process:   8%|▊         | 10/128 [10:00<2:02:16, 62.17s/it]Best score increase :0.431 -> 0.482
training process:   9%|▊         | 11/128 [10:58<1:58:58, 61.01s/it]Best score increase :0.482 -> 0.509
training process:   9%|▉         | 12/128 [12:13<2:05:46, 65.06s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.019, valid loss : 0.026, train acc : 0.782, valid acc : 0.604, train f1 : 0.771, valid f1 : 0.508
training process:  10%|█         | 13/128 [13:29<2:11:08, 68.42s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [14:24<2:02:19, 64.38s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [15:27<2:00:29, 63.98s/it]Best score increase :0.509 -> 0.516
training process:  12%|█▎        | 16/128 [16:33<2:00:42, 64.66s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.017, valid loss : 0.021, train acc : 0.798, valid acc : 0.706, train f1 : 0.791, valid f1 : 0.582
training process:  13%|█▎        | 17/128 [17:53<2:08:07, 69.25s/it]Best score increase :0.516 -> 0.582
training process:  14%|█▍        | 18/128 [19:02<2:06:35, 69.05s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [20:06<2:02:57, 67.69s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [21:18<2:04:06, 68.95s/it]Best score increase :0.582 -> 0.589
epoch : 21, train loss : 0.016, valid loss : 0.027, train acc : 0.815, valid acc : 0.576, train f1 : 0.810, valid f1 : 0.488
training process:  16%|█▋        | 21/128 [22:36<2:07:44, 71.63s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [23:46<2:05:32, 71.06s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [24:49<2:00:13, 68.70s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [25:43<1:51:28, 64.31s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.016, valid loss : 0.021, train acc : 0.829, valid acc : 0.663, train f1 : 0.824, valid f1 : 0.550
training process:  20%|█▉        | 25/128 [26:45<1:49:20, 63.69s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [27:40<1:43:26, 60.85s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [28:30<1:37:21, 57.84s/it]EarlyStopping counter : 7 out of 12
training process:  22%|██▏       | 28/128 [29:19<1:31:50, 55.10s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.015, valid loss : 0.021, train acc : 0.839, valid acc : 0.668, train f1 : 0.835, valid f1 : 0.554
training process:  23%|██▎       | 29/128 [30:18<1:32:43, 56.20s/it]EarlyStopping counter : 9 out of 12
training process:  23%|██▎       | 30/128 [31:08<1:28:39, 54.28s/it]Best score increase :0.589 -> 0.625
training process:  24%|██▍       | 31/128 [31:58<1:25:56, 53.16s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [32:49<1:23:59, 52.50s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.014, valid loss : 0.020, train acc : 0.852, valid acc : 0.688, train f1 : 0.849, valid f1 : 0.569
training process:  26%|██▌       | 33/128 [33:46<1:25:23, 53.94s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 34/128 [34:37<1:22:58, 52.96s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 35/128 [35:26<1:20:26, 51.89s/it]EarlyStopping counter : 5 out of 12
training process:  28%|██▊       | 36/128 [36:15<1:17:58, 50.85s/it]EarlyStopping counter : 6 out of 12
epoch : 37, train loss : 0.014, valid loss : 0.018, train acc : 0.858, valid acc : 0.746, train f1 : 0.856, valid f1 : 0.612
training process:  29%|██▉       | 37/128 [37:11<1:19:31, 52.43s/it]EarlyStopping counter : 7 out of 12
training process:  30%|██▉       | 38/128 [37:59<1:16:31, 51.01s/it]EarlyStopping counter : 8 out of 12
training process:  30%|███       | 39/128 [38:48<1:15:01, 50.58s/it]EarlyStopping counter : 9 out of 12
training process:  31%|███▏      | 40/128 [39:38<1:13:38, 50.21s/it]EarlyStopping counter : 10 out of 12
epoch : 41, train loss : 0.014, valid loss : 0.017, train acc : 0.866, valid acc : 0.793, train f1 : 0.864, valid f1 : 0.652
training process:  32%|███▏      | 41/128 [40:36<1:16:19, 52.64s/it]Best score increase :0.625 -> 0.652
training process:  33%|███▎      | 42/128 [41:27<1:14:51, 52.23s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [42:18<1:13:19, 51.76s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [43:08<1:11:41, 51.21s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.013, valid loss : 0.018, train acc : 0.869, valid acc : 0.736, train f1 : 0.867, valid f1 : 0.604
training process:  35%|███▌      | 45/128 [44:07<1:14:02, 53.52s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [44:58<1:12:08, 52.78s/it]EarlyStopping counter : 5 out of 12
training process:  37%|███▋      | 47/128 [45:46<1:09:18, 51.34s/it]EarlyStopping counter : 6 out of 12
training process:  38%|███▊      | 48/128 [46:31<1:06:05, 49.57s/it]EarlyStopping counter : 7 out of 12
epoch : 49, train loss : 0.012, valid loss : 0.021, train acc : 0.875, valid acc : 0.712, train f1 : 0.873, valid f1 : 0.587
training process:  38%|███▊      | 49/128 [47:27<1:07:50, 51.53s/it]EarlyStopping counter : 8 out of 12
training process:  39%|███▉      | 50/128 [48:20<1:07:19, 51.79s/it]EarlyStopping counter : 9 out of 12
training process:  40%|███▉      | 51/128 [49:14<1:07:33, 52.65s/it]EarlyStopping counter : 10 out of 12
training process:  41%|████      | 52/128 [50:09<1:07:21, 53.18s/it]EarlyStopping counter : 11 out of 12
epoch : 53, train loss : 0.013, valid loss : 0.017, train acc : 0.879, valid acc : 0.781, train f1 : 0.878, valid f1 : 0.641
training process:  41%|████      | 52/128 [51:13<1:14:51, 59.10s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 52, best f1 score : 0.652
training process finished, best loss : 0.017 and best acc : 0.793, best f1 : 0.652, best epoch : 40

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.31      0.91      0.46       580
           1       0.99      0.83      0.90      6818

    accuracy                           0.83      7398
   macro avg       0.65      0.87      0.68      7398
weighted avg       0.94      0.83      0.87      7398


# test acc : 0.83, test f1 : 0.68, test AUC : 0.87, test loss : 1.055

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:34,  8.60s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:27,  8.76s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:19,  8.84s/it]processing for feature importance:  33%|███▎      | 4/12 [00:35<01:10,  8.85s/it]processing for feature importance:  42%|████▏     | 5/12 [00:43<01:00,  8.66s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:51,  8.57s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:43,  8.60s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:08<00:33,  8.46s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:16<00:24,  8.22s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:24<00:16,  8.12s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:32<00:08,  8.25s/it]processing for feature importance: 100%|██████████| 12/12 [01:41<00:00,  8.21s/it]processing for feature importance: 100%|██████████| 12/12 [01:41<00:00,  8.42s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 10/306 [00:00<00:03, 92.01it/s]  7%|▋         | 20/306 [00:00<00:03, 85.61it/s] 10%|▉         | 30/306 [00:00<00:03, 90.93it/s] 13%|█▎        | 40/306 [00:00<00:03, 88.42it/s] 16%|█▌        | 49/306 [00:00<00:02, 88.19it/s] 19%|█▉        | 58/306 [00:00<00:02, 86.22it/s] 22%|██▏       | 68/306 [00:00<00:02, 88.58it/s] 25%|██▌       | 77/306 [00:00<00:02, 87.37it/s] 28%|██▊       | 86/306 [00:00<00:02, 87.08it/s] 31%|███       | 95/306 [00:01<00:02, 86.31it/s] 34%|███▍      | 105/306 [00:01<00:02, 88.09it/s] 37%|███▋      | 114/306 [00:01<00:02, 87.04it/s] 41%|████      | 124/306 [00:01<00:02, 88.58it/s] 43%|████▎     | 133/306 [00:01<00:01, 87.58it/s] 46%|████▋     | 142/306 [00:01<00:01, 88.08it/s] 49%|████▉     | 151/306 [00:01<00:01, 87.01it/s] 52%|█████▏    | 160/306 [00:01<00:01, 87.73it/s] 55%|█████▌    | 169/306 [00:01<00:01, 85.65it/s] 58%|█████▊    | 179/306 [00:02<00:01, 87.19it/s] 61%|██████▏   | 188/306 [00:02<00:01, 86.30it/s] 64%|██████▍   | 197/306 [00:02<00:01, 86.69it/s] 67%|██████▋   | 206/306 [00:02<00:01, 85.71it/s] 71%|███████   | 216/306 [00:02<00:01, 87.71it/s] 74%|███████▎  | 225/306 [00:02<00:00, 85.62it/s] 76%|███████▋  | 234/306 [00:02<00:00, 86.61it/s] 79%|███████▉  | 243/306 [00:02<00:00, 86.18it/s] 83%|████████▎ | 253/306 [00:02<00:00, 87.28it/s] 86%|████████▌ | 262/306 [00:03<00:00, 86.64it/s] 89%|████████▊ | 271/306 [00:03<00:00, 87.58it/s] 92%|█████████▏| 280/306 [00:03<00:00, 87.15it/s] 95%|█████████▍| 290/306 [00:03<00:00, 88.94it/s] 98%|█████████▊| 299/306 [00:03<00:00, 87.69it/s]100%|██████████| 306/306 [00:03<00:00, 87.44it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 36/553 [00:00<00:01, 359.33it/s]extract the null data:  13%|█▎        | 74/553 [00:00<00:01, 365.96it/s]extract the null data:  21%|██        | 115/553 [00:00<00:01, 383.10it/s]extract the null data:  29%|██▉       | 159/553 [00:00<00:00, 404.89it/s]extract the null data:  37%|███▋      | 205/553 [00:00<00:00, 424.61it/s]extract the null data:  45%|████▍     | 248/553 [00:00<00:00, 424.69it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 415.84it/s]extract the null data:  60%|██████    | 333/553 [00:00<00:00, 407.12it/s]extract the null data:  68%|██████▊   | 378/553 [00:00<00:00, 418.16it/s]extract the null data:  76%|███████▋  | 423/553 [00:01<00:00, 426.02it/s]extract the null data:  84%|████████▍ | 466/553 [00:01<00:00, 423.91it/s]extract the null data:  92%|█████████▏| 509/553 [00:01<00:00, 424.22it/s]extract the null data: 100%|█████████▉| 552/553 [00:01<00:00, 420.76it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 414.09it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 157.99it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 160.66it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 156.06it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:03, 156.73it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 158.54it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 159.95it/s]replace nan value:  21%|██        | 117/553 [00:00<00:02, 161.88it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 159.45it/s]replace nan value:  27%|██▋       | 151/553 [00:00<00:02, 161.54it/s]replace nan value:  30%|███       | 168/553 [00:01<00:02, 163.95it/s]replace nan value:  33%|███▎      | 185/553 [00:01<00:02, 163.98it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:02, 163.96it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:02, 165.15it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 159.33it/s]replace nan value:  46%|████▌     | 253/553 [00:01<00:01, 160.87it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 162.13it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 163.23it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 162.79it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 164.04it/s]replace nan value:  61%|██████    | 338/553 [00:02<00:01, 162.61it/s]replace nan value:  64%|██████▍   | 355/553 [00:02<00:01, 163.65it/s]replace nan value:  67%|██████▋   | 372/553 [00:02<00:01, 164.65it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 166.20it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 166.43it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 165.41it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 165.41it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 166.68it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 165.33it/s]replace nan value:  89%|████████▉ | 491/553 [00:03<00:00, 164.48it/s]replace nan value:  92%|█████████▏| 508/553 [00:03<00:00, 165.26it/s]replace nan value:  95%|█████████▍| 525/553 [00:03<00:00, 164.92it/s]replace nan value:  98%|█████████▊| 542/553 [00:03<00:00, 164.69it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 162.97it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.31it/s]  5%|▍         | 27/553 [00:00<00:03, 131.54it/s]  7%|▋         | 41/553 [00:00<00:04, 125.97it/s] 10%|▉         | 54/553 [00:00<00:04, 116.13it/s] 12%|█▏        | 66/553 [00:00<00:04, 108.56it/s] 14%|█▍        | 80/553 [00:00<00:04, 114.13it/s] 17%|█▋        | 93/553 [00:00<00:03, 118.18it/s] 19%|█▉        | 107/553 [00:00<00:03, 124.19it/s] 22%|██▏       | 122/553 [00:01<00:03, 126.78it/s] 25%|██▍       | 137/553 [00:01<00:03, 132.88it/s] 28%|██▊       | 154/553 [00:01<00:02, 142.70it/s] 31%|███       | 171/553 [00:01<00:02, 150.03it/s] 34%|███▍      | 187/553 [00:01<00:02, 148.90it/s] 37%|███▋      | 205/553 [00:01<00:02, 156.31it/s] 40%|███▉      | 221/553 [00:01<00:02, 144.55it/s] 43%|████▎     | 236/553 [00:01<00:02, 144.06it/s] 45%|████▌     | 251/553 [00:01<00:02, 139.40it/s] 48%|████▊     | 266/553 [00:01<00:02, 135.99it/s] 51%|█████     | 280/553 [00:02<00:02, 132.62it/s] 53%|█████▎    | 294/553 [00:02<00:01, 130.65it/s] 56%|█████▌    | 308/553 [00:02<00:01, 125.52it/s] 58%|█████▊    | 321/553 [00:02<00:01, 121.86it/s] 60%|██████    | 334/553 [00:02<00:01, 123.89it/s] 63%|██████▎   | 348/553 [00:02<00:01, 124.95it/s] 65%|██████▌   | 361/553 [00:02<00:01, 120.29it/s] 68%|██████▊   | 376/553 [00:02<00:01, 128.04it/s] 70%|███████   | 389/553 [00:02<00:01, 121.98it/s] 73%|███████▎  | 402/553 [00:03<00:01, 115.88it/s] 75%|███████▌  | 416/553 [00:03<00:01, 118.11it/s] 77%|███████▋  | 428/553 [00:03<00:01, 113.12it/s] 80%|████████  | 445/553 [00:03<00:00, 127.33it/s] 83%|████████▎ | 460/553 [00:03<00:00, 133.00it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.85it/s] 88%|████████▊ | 488/553 [00:03<00:00, 127.60it/s] 91%|█████████ | 501/553 [00:03<00:00, 122.45it/s] 93%|█████████▎| 517/553 [00:04<00:00, 130.55it/s] 96%|█████████▌| 531/553 [00:04<00:00, 112.05it/s] 99%|█████████▉| 547/553 [00:04<00:00, 122.89it/s]100%|██████████| 553/553 [00:04<00:00, 125.76it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 266.79it/s]extract the null data:  60%|██████    | 84/139 [00:00<00:00, 439.94it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 460.87it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 191.39it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 176.67it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 185.74it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 186.79it/s]replace nan value:  71%|███████   | 98/139 [00:00<00:00, 168.69it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 180.06it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 182.70it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 181.16it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  4%|▍         | 6/139 [00:00<00:02, 58.23it/s] 10%|█         | 14/139 [00:00<00:01, 65.44it/s] 15%|█▌        | 21/139 [00:00<00:01, 60.34it/s] 22%|██▏       | 31/139 [00:00<00:01, 70.42it/s] 29%|██▉       | 40/139 [00:00<00:01, 75.31it/s] 35%|███▍      | 48/139 [00:00<00:01, 75.14it/s] 40%|████      | 56/139 [00:00<00:01, 73.35it/s] 51%|█████     | 71/139 [00:00<00:00, 91.67it/s] 60%|█████▉    | 83/139 [00:01<00:00, 93.64it/s] 67%|██████▋   | 93/139 [00:01<00:00, 81.54it/s] 73%|███████▎  | 102/139 [00:01<00:00, 80.28it/s] 80%|███████▉  | 111/139 [00:01<00:00, 73.71it/s] 87%|████████▋ | 121/139 [00:01<00:00, 79.97it/s] 94%|█████████▎| 130/139 [00:01<00:00, 72.50it/s]100%|██████████| 139/139 [00:01<00:00, 78.66it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 306.57it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 480.07it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 527.94it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 501.93it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 197.45it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 196.99it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 139.78it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 129.20it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 115.88it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 113.35it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 109.21it/s]replace nan value:  73%|███████▎  | 127/173 [00:01<00:00, 106.10it/s]replace nan value:  80%|███████▉  | 138/173 [00:01<00:00, 106.55it/s]replace nan value:  86%|████████▌ | 149/173 [00:01<00:00, 106.94it/s]replace nan value:  92%|█████████▏| 160/173 [00:01<00:00, 103.23it/s]replace nan value:  99%|█████████▉| 171/173 [00:01<00:00, 103.42it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 115.55it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▌         | 9/173 [00:00<00:01, 85.89it/s] 10%|█         | 18/173 [00:00<00:01, 78.70it/s] 16%|█▌        | 28/173 [00:00<00:01, 86.84it/s] 26%|██▌       | 45/173 [00:00<00:01, 115.59it/s] 36%|███▌      | 62/173 [00:00<00:00, 132.26it/s] 45%|████▍     | 77/173 [00:00<00:00, 135.24it/s] 53%|█████▎    | 92/173 [00:00<00:00, 138.77it/s] 62%|██████▏   | 107/173 [00:00<00:00, 141.69it/s] 71%|███████   | 122/173 [00:00<00:00, 141.88it/s] 79%|███████▉  | 137/173 [00:01<00:00, 107.76it/s] 87%|████████▋ | 150/173 [00:01<00:00, 101.26it/s] 94%|█████████▎| 162/173 [00:01<00:00, 93.52it/s] 100%|██████████| 173/173 [00:01<00:00, 79.88it/s]100%|██████████| 173/173 [00:01<00:00, 103.85it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.098, valid loss : 0.085, train f1 : 0.519, valid f1 : 0.523
training process - Deferred Re-weighting:   1%|          | 1/128 [01:01<2:09:10, 61.03s/it]Best score increase :0.000 -> 0.523
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:57<2:02:13, 58.20s/it]Best score increase :0.523 -> 0.587
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:05<2:11:03, 62.91s/it]Best score increase :0.587 -> 0.679
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:11<2:12:25, 64.07s/it]Best score increase :0.679 -> 0.732
epoch : 5, train loss : 0.050, valid loss : 0.053, train f1 : 0.738, valid f1 : 0.752
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:13<2:09:54, 63.37s/it]Best score increase :0.732 -> 0.752
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:31<2:18:51, 68.29s/it]Best score increase :0.752 -> 0.773
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:29<2:10:59, 64.96s/it]Best score increase :0.773 -> 0.785
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:46<2:17:27, 68.73s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.041, valid loss : 0.046, train f1 : 0.798, valid f1 : 0.783
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:49<2:12:45, 66.93s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:44<2:04:21, 63.24s/it]Best score increase :0.785 -> 0.806
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:42<2:00:03, 61.57s/it]Best score increase :0.806 -> 0.822
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:55<2:06:06, 65.23s/it]Best score increase :0.822 -> 0.827
epoch : 13, train loss : 0.038, valid loss : 0.042, train f1 : 0.822, valid f1 : 0.822
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:09<2:09:38, 67.64s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [15:16<2:08:38, 67.70s/it]Best score increase :0.827 -> 0.837
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [16:09<1:58:58, 63.17s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:02<1:52:14, 60.13s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.036, valid loss : 0.040, train f1 : 0.827, valid f1 : 0.823
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:11<1:56:02, 62.73s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [19:14<1:55:22, 62.93s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [20:13<1:52:13, 61.78s/it]Best score increase :0.837 -> 0.839
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [21:11<1:48:54, 60.51s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.035, valid loss : 0.040, train f1 : 0.835, valid f1 : 0.818
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [22:15<1:49:49, 61.59s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [23:16<1:48:22, 61.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [24:07<1:42:12, 58.41s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [25:00<1:38:30, 56.83s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.037, train f1 : 0.845, valid f1 : 0.838
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [26:11<1:44:44, 61.02s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [27:11<1:43:03, 60.62s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [28:07<1:39:55, 59.36s/it]Best score increase :0.839 -> 0.841
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [29:01<1:36:15, 57.76s/it]Best score increase :0.841 -> 0.850
epoch : 29, train loss : 0.033, valid loss : 0.036, train f1 : 0.844, valid f1 : 0.850
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [30:04<1:37:50, 59.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [31:00<1:35:02, 58.19s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [31:51<1:30:48, 56.17s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [32:50<1:31:13, 57.02s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.032, valid loss : 0.035, train f1 : 0.851, valid f1 : 0.852
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [33:53<1:32:56, 58.70s/it]Best score increase :0.850 -> 0.852
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [34:44<1:28:24, 56.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:31<1:22:48, 53.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:20<1:20:09, 52.27s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.031, valid loss : 0.035, train f1 : 0.853, valid f1 : 0.857
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [37:27<1:25:52, 56.62s/it]Best score increase :0.852 -> 0.857
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [38:14<1:20:27, 53.64s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [39:02<1:17:12, 52.05s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [39:51<1:15:14, 51.30s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.030, valid loss : 0.034, train f1 : 0.860, valid f1 : 0.859
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [40:51<1:17:54, 53.74s/it]Best score increase :0.857 -> 0.859
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [41:53<1:20:37, 56.25s/it]Best score increase :0.859 -> 0.865
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [42:44<1:17:20, 54.60s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [43:37<1:15:54, 54.22s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.030, valid loss : 0.034, train f1 : 0.861, valid f1 : 0.857
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [44:43<1:19:53, 57.75s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [45:33<1:15:44, 55.42s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [46:33<1:16:45, 56.86s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [47:27<1:14:43, 56.04s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.029, valid loss : 0.033, train f1 : 0.864, valid f1 : 0.858
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [48:40<1:20:17, 60.99s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [49:49<1:22:19, 63.33s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [50:42<1:17:28, 60.37s/it]Best score increase :0.865 -> 0.873
training process - Deferred Re-weighting:  41%|████      | 52/128 [51:30<1:11:43, 56.63s/it]EarlyStopping counter : 1 out of 12
epoch : 53, train loss : 0.028, valid loss : 0.034, train f1 : 0.867, valid f1 : 0.849
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [52:41<1:16:19, 61.06s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [53:40<1:14:14, 60.20s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [54:31<1:09:55, 57.48s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [55:23<1:07:15, 56.05s/it]EarlyStopping counter : 5 out of 12
epoch : 57, train loss : 0.028, valid loss : 0.036, train f1 : 0.874, valid f1 : 0.843
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [56:35<1:11:55, 60.78s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [57:33<1:09:40, 59.72s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [58:30<1:07:53, 59.03s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [59:31<1:07:26, 59.50s/it]EarlyStopping counter : 9 out of 12
epoch : 61, train loss : 0.028, valid loss : 0.033, train f1 : 0.871, valid f1 : 0.874
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:00:32<1:06:58, 59.98s/it]Best score increase :0.873 -> 0.874
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:01:31<1:05:41, 59.72s/it]Best score increase :0.874 -> 0.880
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:02:36<1:06:26, 61.33s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:03:38<1:05:45, 61.65s/it]EarlyStopping counter : 2 out of 12
epoch : 65, train loss : 0.027, valid loss : 0.037, train f1 : 0.876, valid f1 : 0.853
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:04:57<1:10:09, 66.82s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:06:15<1:12:29, 70.16s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:07:22<1:10:24, 69.25s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:08:39<1:11:35, 71.58s/it]EarlyStopping counter : 6 out of 12
epoch : 69, train loss : 0.027, valid loss : 0.034, train f1 : 0.872, valid f1 : 0.859
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:10:09<1:15:38, 76.92s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:11:14<1:11:04, 73.53s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:12:24<1:08:51, 72.48s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:13:18<1:02:27, 66.93s/it]EarlyStopping counter : 10 out of 12
epoch : 73, train loss : 0.026, valid loss : 0.033, train f1 : 0.880, valid f1 : 0.883
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:14:41<1:05:34, 71.53s/it]Best score increase :0.880 -> 0.883
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:15:54<1:04:54, 72.12s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:17:08<1:04:05, 72.55s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:18:23<1:03:36, 73.40s/it]EarlyStopping counter : 3 out of 12
epoch : 77, train loss : 0.026, valid loss : 0.033, train f1 : 0.884, valid f1 : 0.881
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:19:52<1:06:17, 77.99s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:21:03<1:03:22, 76.04s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  62%|██████▏   | 79/128 [1:22:19<1:01:58, 75.88s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  62%|██████▎   | 80/128 [1:23:30<59:40, 74.59s/it]  EarlyStopping counter : 7 out of 12
epoch : 81, train loss : 0.026, valid loss : 0.035, train f1 : 0.885, valid f1 : 0.861
training process - Deferred Re-weighting:  63%|██████▎   | 81/128 [1:24:57<1:01:20, 78.32s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  64%|██████▍   | 82/128 [1:26:14<59:35, 77.73s/it]  EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  65%|██████▍   | 83/128 [1:27:28<57:39, 76.88s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  66%|██████▌   | 84/128 [1:28:45<56:15, 76.73s/it]EarlyStopping counter : 11 out of 12
epoch : 85, train loss : 0.026, valid loss : 0.040, train f1 : 0.882, valid f1 : 0.874
training process - Deferred Re-weighting:  66%|██████▌   | 84/128 [1:30:17<47:17, 64.50s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 84, best f1 score : 0.883
training process finished, best loss : 0.033, best acc : 0.966, best f1 : 0.883, best epoch : 72

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.61      0.70      0.65       580
           1       0.97      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.83      0.81      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.83, test loss : 3.674

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:12<02:22, 12.94s/it]processing for feature importance:  17%|█▋        | 2/12 [00:23<01:54, 11.40s/it]processing for feature importance:  25%|██▌       | 3/12 [00:35<01:47, 11.97s/it]processing for feature importance:  33%|███▎      | 4/12 [00:49<01:39, 12.45s/it]processing for feature importance:  42%|████▏     | 5/12 [01:01<01:28, 12.59s/it]processing for feature importance:  50%|█████     | 6/12 [01:14<01:14, 12.49s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:25<00:59, 11.96s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:37<00:48, 12.13s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:50<00:36, 12.28s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:02<00:24, 12.31s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:15<00:12, 12.50s/it]processing for feature importance: 100%|██████████| 12/12 [02:25<00:00, 11.76s/it]processing for feature importance: 100%|██████████| 12/12 [02:25<00:00, 12.13s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  2%|▏         | 7/306 [00:00<00:04, 67.31it/s]  6%|▌         | 17/306 [00:00<00:03, 85.24it/s]  9%|▉         | 27/306 [00:00<00:03, 90.69it/s] 12%|█▏        | 38/306 [00:00<00:02, 96.82it/s] 16%|█▌        | 48/306 [00:00<00:02, 91.86it/s] 19%|█▉        | 58/306 [00:00<00:02, 91.99it/s] 22%|██▏       | 68/306 [00:00<00:02, 90.95it/s] 25%|██▌       | 78/306 [00:00<00:03, 74.53it/s] 29%|██▉       | 88/306 [00:01<00:02, 80.23it/s] 32%|███▏      | 98/306 [00:01<00:02, 83.25it/s] 35%|███▍      | 107/306 [00:01<00:02, 82.84it/s] 38%|███▊      | 117/306 [00:01<00:02, 87.11it/s] 42%|████▏     | 127/306 [00:01<00:01, 90.11it/s] 45%|████▍     | 137/306 [00:01<00:01, 89.27it/s] 48%|████▊     | 147/306 [00:01<00:01, 91.24it/s] 51%|█████▏    | 157/306 [00:01<00:01, 91.41it/s] 55%|█████▍    | 167/306 [00:01<00:01, 92.82it/s] 58%|█████▊    | 177/306 [00:02<00:01, 80.77it/s] 61%|██████    | 186/306 [00:02<00:01, 80.93it/s] 64%|██████▍   | 197/306 [00:02<00:01, 87.45it/s] 67%|██████▋   | 206/306 [00:02<00:01, 85.75it/s] 71%|███████   | 217/306 [00:02<00:00, 89.39it/s] 74%|███████▍  | 227/306 [00:02<00:00, 87.38it/s] 79%|███████▉  | 241/306 [00:02<00:00, 100.61it/s] 82%|████████▏ | 252/306 [00:02<00:00, 98.72it/s]  86%|████████▌ | 262/306 [00:02<00:00, 99.00it/s] 89%|████████▉ | 272/306 [00:03<00:00, 90.29it/s] 94%|█████████▍| 289/306 [00:03<00:00, 110.13it/s] 98%|█████████▊| 301/306 [00:03<00:00, 104.18it/s]100%|██████████| 306/306 [00:03<00:00, 91.32it/s] 
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   5%|▍         | 27/553 [00:00<00:01, 268.20it/s]extract the null data:  11%|█         | 59/553 [00:00<00:01, 282.18it/s]extract the null data:  16%|█▌        | 88/553 [00:00<00:01, 282.20it/s]extract the null data:  22%|██▏       | 119/553 [00:00<00:01, 264.62it/s]extract the null data:  29%|██▉       | 161/553 [00:00<00:01, 314.21it/s]extract the null data:  35%|███▍      | 193/553 [00:00<00:01, 280.94it/s]extract the null data:  40%|████      | 222/553 [00:00<00:01, 249.65it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:01, 249.73it/s]extract the null data:  50%|█████     | 277/553 [00:01<00:01, 240.55it/s]extract the null data:  55%|█████▍    | 302/553 [00:01<00:01, 240.99it/s]extract the null data:  59%|█████▉    | 327/553 [00:01<00:00, 242.73it/s]extract the null data:  65%|██████▌   | 362/553 [00:01<00:00, 270.09it/s]extract the null data:  75%|███████▍  | 414/553 [00:01<00:00, 341.10it/s]extract the null data:  84%|████████▍ | 465/553 [00:01<00:00, 389.29it/s]extract the null data:  92%|█████████▏| 511/553 [00:01<00:00, 409.01it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 312.95it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 291.73it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 167.22it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 172.18it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 172.53it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:04, 110.32it/s]replace nan value:  16%|█▌        | 87/553 [00:00<00:04, 116.33it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:03, 118.99it/s]replace nan value:  21%|██        | 114/553 [00:00<00:03, 118.42it/s]replace nan value:  23%|██▎       | 128/553 [00:01<00:03, 123.84it/s]replace nan value:  26%|██▌       | 143/553 [00:01<00:03, 130.57it/s]replace nan value:  28%|██▊       | 157/553 [00:01<00:03, 120.91it/s]replace nan value:  31%|███       | 170/553 [00:01<00:03, 119.66it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:03, 99.37it/s] replace nan value:  35%|███▌      | 194/553 [00:01<00:03, 94.68it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:03, 102.35it/s]replace nan value:  41%|████      | 226/553 [00:01<00:02, 123.38it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:02, 137.03it/s]replace nan value:  47%|████▋     | 262/553 [00:02<00:01, 148.08it/s]replace nan value:  51%|█████     | 281/553 [00:02<00:01, 159.05it/s]replace nan value:  54%|█████▍    | 300/553 [00:02<00:01, 166.83it/s]replace nan value:  58%|█████▊    | 319/553 [00:02<00:01, 171.96it/s]replace nan value:  61%|██████    | 338/553 [00:02<00:01, 174.80it/s]replace nan value:  64%|██████▍   | 356/553 [00:02<00:01, 175.65it/s]replace nan value:  68%|██████▊   | 374/553 [00:02<00:01, 174.27it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:00, 172.28it/s]replace nan value:  74%|███████▍  | 410/553 [00:02<00:00, 173.65it/s]replace nan value:  77%|███████▋  | 428/553 [00:03<00:00, 172.86it/s]replace nan value:  81%|████████  | 446/553 [00:03<00:00, 169.34it/s]replace nan value:  84%|████████▎ | 463/553 [00:03<00:00, 155.13it/s]replace nan value:  87%|████████▋ | 479/553 [00:03<00:00, 112.97it/s]replace nan value:  90%|████████▉ | 497/553 [00:03<00:00, 126.18it/s]replace nan value:  93%|█████████▎| 512/553 [00:03<00:00, 123.75it/s]replace nan value:  96%|█████████▌| 529/553 [00:03<00:00, 133.40it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 131.92it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 137.26it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 117.40it/s]  4%|▍         | 24/553 [00:00<00:04, 105.88it/s]  6%|▋         | 35/553 [00:00<00:05, 102.71it/s]  8%|▊         | 46/553 [00:00<00:05, 100.57it/s] 10%|█         | 58/553 [00:00<00:04, 103.29it/s] 12%|█▏        | 69/553 [00:00<00:04, 104.32it/s] 15%|█▌        | 84/553 [00:00<00:04, 116.89it/s] 18%|█▊        | 97/553 [00:00<00:03, 120.28it/s] 20%|█▉        | 110/553 [00:00<00:03, 122.88it/s] 22%|██▏       | 124/553 [00:01<00:03, 126.74it/s] 25%|██▌       | 140/553 [00:01<00:03, 134.43it/s] 28%|██▊       | 157/553 [00:01<00:02, 143.58it/s] 31%|███▏      | 173/553 [00:01<00:02, 146.19it/s] 34%|███▍      | 188/553 [00:01<00:02, 138.56it/s] 37%|███▋      | 205/553 [00:01<00:02, 146.13it/s] 40%|███▉      | 220/553 [00:01<00:02, 136.74it/s] 42%|████▏     | 234/553 [00:01<00:02, 136.30it/s] 45%|████▌     | 249/553 [00:01<00:02, 135.25it/s] 48%|████▊     | 264/553 [00:02<00:02, 138.40it/s] 50%|█████     | 278/553 [00:02<00:02, 126.65it/s] 53%|█████▎    | 292/553 [00:02<00:02, 126.46it/s] 55%|█████▌    | 305/553 [00:02<00:01, 125.26it/s] 58%|█████▊    | 318/553 [00:02<00:02, 117.09it/s] 60%|█████▉    | 331/553 [00:02<00:01, 119.57it/s] 62%|██████▏   | 345/553 [00:02<00:01, 121.70it/s] 65%|██████▍   | 358/553 [00:02<00:01, 122.08it/s] 67%|██████▋   | 373/553 [00:02<00:01, 129.36it/s] 70%|██████▉   | 387/553 [00:03<00:01, 120.50it/s] 72%|███████▏  | 400/553 [00:03<00:01, 112.39it/s] 75%|███████▌  | 415/553 [00:03<00:01, 119.10it/s] 77%|███████▋  | 428/553 [00:03<00:01, 110.04it/s] 80%|████████  | 444/553 [00:03<00:00, 122.10it/s] 83%|████████▎ | 459/553 [00:03<00:00, 128.08it/s] 86%|████████▌ | 473/553 [00:03<00:00, 130.00it/s] 88%|████████▊ | 487/553 [00:03<00:00, 125.60it/s] 90%|█████████ | 500/553 [00:04<00:00, 116.97it/s] 93%|█████████▎| 515/553 [00:04<00:00, 123.79it/s] 95%|█████████▌| 528/553 [00:04<00:00, 109.60it/s] 98%|█████████▊| 540/553 [00:04<00:00, 110.85it/s]100%|█████████▉| 552/553 [00:04<00:00, 98.42it/s] 100%|██████████| 553/553 [00:04<00:00, 120.98it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 279.00it/s]extract the null data:  61%|██████    | 85/139 [00:00<00:00, 447.82it/s]extract the null data:  99%|█████████▉| 138/139 [00:00<00:00, 484.67it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 457.67it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 183.70it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 186.47it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 168.77it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 137.85it/s]replace nan value:  68%|██████▊   | 94/139 [00:00<00:00, 151.35it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 121.12it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 121.44it/s]replace nan value:  99%|█████████▊| 137/139 [00:01<00:00, 111.36it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 129.31it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  4%|▎         | 5/139 [00:00<00:03, 43.11it/s] 10%|█         | 14/139 [00:00<00:01, 67.99it/s] 21%|██        | 29/139 [00:00<00:01, 100.55it/s] 33%|███▎      | 46/139 [00:00<00:00, 124.03it/s] 42%|████▏     | 59/139 [00:00<00:00, 120.52it/s] 53%|█████▎    | 74/139 [00:00<00:00, 128.03it/s] 63%|██████▎   | 87/139 [00:00<00:00, 120.25it/s] 73%|███████▎  | 101/139 [00:00<00:00, 124.05it/s] 83%|████████▎ | 115/139 [00:00<00:00, 127.53it/s] 93%|█████████▎| 129/139 [00:01<00:00, 131.06it/s]100%|██████████| 139/139 [00:01<00:00, 120.96it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 317.52it/s]extract the null data:  40%|███▉      | 69/173 [00:00<00:00, 315.24it/s]extract the null data:  58%|█████▊    | 101/173 [00:00<00:00, 287.32it/s]extract the null data:  75%|███████▌  | 130/173 [00:00<00:00, 282.38it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 325.45it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 189.69it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 137.96it/s]replace nan value:  31%|███       | 53/173 [00:00<00:00, 122.55it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 111.75it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 131.37it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 150.89it/s]replace nan value:  72%|███████▏  | 125/173 [00:00<00:00, 166.42it/s]replace nan value:  86%|████████▌ | 148/173 [00:00<00:00, 184.01it/s]replace nan value:  99%|█████████▉| 171/173 [00:01<00:00, 194.99it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 161.32it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▍         | 8/173 [00:00<00:02, 76.61it/s]  9%|▉         | 16/173 [00:00<00:02, 65.39it/s] 13%|█▎        | 23/173 [00:00<00:02, 58.41it/s] 20%|██        | 35/173 [00:00<00:01, 77.65it/s] 26%|██▌       | 45/173 [00:00<00:01, 80.13it/s] 32%|███▏      | 55/173 [00:00<00:01, 85.18it/s] 40%|████      | 70/173 [00:00<00:00, 103.96it/s] 49%|████▉     | 85/173 [00:00<00:00, 116.24it/s] 57%|█████▋    | 99/173 [00:01<00:00, 122.65it/s] 65%|██████▍   | 112/173 [00:01<00:00, 117.21it/s] 72%|███████▏  | 124/173 [00:01<00:00, 105.15it/s] 78%|███████▊  | 135/173 [00:01<00:00, 99.91it/s]  86%|████████▌ | 148/173 [00:01<00:00, 107.81it/s] 92%|█████████▏| 160/173 [00:01<00:00, 104.03it/s] 99%|█████████▉| 171/173 [00:01<00:00, 72.36it/s] 100%|██████████| 173/173 [00:01<00:00, 89.19it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.157, valid loss : 0.130, train f1 : 0.657, valid f1 : 0.589
training process - Deferred Re-weighting:   1%|          | 1/128 [01:25<3:01:05, 85.55s/it]Best score increase :0.000 -> 0.589
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:53<3:02:59, 87.14s/it]Best score increase :0.589 -> 0.616
training process - Deferred Re-weighting:   2%|▏         | 3/128 [04:03<2:44:34, 78.99s/it]Best score increase :0.616 -> 0.705
training process - Deferred Re-weighting:   3%|▎         | 4/128 [05:10<2:33:38, 74.34s/it]Best score increase :0.705 -> 0.739
epoch : 5, train loss : 0.092, valid loss : 0.081, train f1 : 0.846, valid f1 : 0.746
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:32<2:38:08, 77.15s/it]Best score increase :0.739 -> 0.746
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:40<2:30:54, 74.22s/it]Best score increase :0.746 -> 0.771
training process - Deferred Re-weighting:   5%|▌         | 7/128 [08:44<2:22:27, 70.64s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:47<2:16:22, 68.19s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.081, valid loss : 0.070, train f1 : 0.864, valid f1 : 0.794
training process - Deferred Re-weighting:   7%|▋         | 9/128 [11:04<2:20:39, 70.92s/it]Best score increase :0.771 -> 0.794
training process - Deferred Re-weighting:   8%|▊         | 10/128 [12:07<2:15:03, 68.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [13:13<2:12:16, 67.84s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [14:20<2:10:30, 67.51s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.074, valid loss : 0.096, train f1 : 0.874, valid f1 : 0.705
training process - Deferred Re-weighting:  10%|█         | 13/128 [15:58<2:27:01, 76.71s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [17:25<2:31:31, 79.75s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [18:34<2:24:06, 76.51s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [19:45<2:20:02, 75.02s/it]EarlyStopping counter : 7 out of 12
epoch : 17, train loss : 0.069, valid loss : 0.066, train f1 : 0.885, valid f1 : 0.802
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [21:11<2:24:55, 78.33s/it]Best score increase :0.794 -> 0.802
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [22:36<2:26:54, 80.14s/it]Best score increase :0.802 -> 0.807
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [23:49<2:21:45, 78.04s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [25:05<2:19:18, 77.40s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.065, valid loss : 0.089, train f1 : 0.891, valid f1 : 0.725
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [26:18<2:16:05, 76.31s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [27:15<2:04:33, 70.51s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [28:06<1:53:11, 64.68s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [29:12<1:52:39, 64.99s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.063, valid loss : 0.086, train f1 : 0.897, valid f1 : 0.734
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [30:17<1:51:42, 65.07s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [31:17<1:47:56, 63.49s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [32:22<1:47:37, 63.93s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [33:27<1:46:58, 64.18s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.059, valid loss : 0.064, train f1 : 0.904, valid f1 : 0.821
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [34:37<1:48:58, 66.05s/it]Best score increase :0.807 -> 0.821
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [35:43<1:47:36, 65.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [36:42<1:43:28, 64.00s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [37:54<1:45:52, 66.17s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.058, valid loss : 0.106, train f1 : 0.907, valid f1 : 0.694
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [38:54<1:41:47, 64.29s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [39:47<1:35:29, 60.95s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [40:41<1:31:24, 58.98s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [41:35<1:28:09, 57.49s/it]EarlyStopping counter : 7 out of 12
epoch : 37, train loss : 0.055, valid loss : 0.087, train f1 : 0.915, valid f1 : 0.749
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [42:35<1:28:25, 58.30s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [43:27<1:24:34, 56.39s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [44:27<1:24:57, 57.27s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [45:24<1:24:04, 57.32s/it]EarlyStopping counter : 11 out of 12
epoch : 41, train loss : 0.052, valid loss : 0.099, train f1 : 0.918, valid f1 : 0.716
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [46:29<1:42:16, 69.74s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 40, best f1 score : 0.821
training process finished, best loss : 0.064, best acc : 0.936, best f1 : 0.821, best epoch : 28

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.48      0.78      0.59       580
           1       0.98      0.93      0.95      6818

    accuracy                           0.92      7398
   macro avg       0.73      0.85      0.77      7398
weighted avg       0.94      0.92      0.92      7398


# test acc : 0.92, test f1 : 0.77, test AUC : 0.85, test loss : 3.341

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.44s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.46s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:09,  7.74s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.90s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.82s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.78s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.81s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.72s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.76s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.86s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.87s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.81s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  2%|▏         | 7/306 [00:00<00:04, 63.72it/s]  5%|▍         | 15/306 [00:00<00:04, 65.46it/s]  8%|▊         | 25/306 [00:00<00:03, 76.06it/s] 13%|█▎        | 40/306 [00:00<00:02, 100.33it/s] 17%|█▋        | 51/306 [00:00<00:02, 100.98it/s] 20%|██        | 62/306 [00:00<00:02, 90.95it/s]  25%|██▍       | 75/306 [00:00<00:02, 100.40it/s] 32%|███▏      | 98/306 [00:00<00:01, 132.12it/s] 37%|███▋      | 112/306 [00:01<00:01, 123.27it/s] 41%|████      | 125/306 [00:01<00:01, 111.34it/s] 49%|████▉     | 150/306 [00:01<00:01, 146.50it/s] 59%|█████▉    | 182/306 [00:01<00:00, 192.30it/s] 66%|██████▋   | 203/306 [00:01<00:00, 173.28it/s] 76%|███████▋  | 234/306 [00:01<00:00, 204.92it/s] 86%|████████▌ | 262/306 [00:01<00:00, 224.07it/s] 93%|█████████▎| 286/306 [00:01<00:00, 195.79it/s]100%|██████████| 306/306 [00:02<00:00, 148.66it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 578.77it/s]extract the null data:  21%|██▏       | 118/553 [00:00<00:00, 586.96it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 599.58it/s]extract the null data:  44%|████▍     | 242/553 [00:00<00:00, 605.23it/s]extract the null data:  55%|█████▍    | 304/553 [00:00<00:00, 609.73it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 612.23it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 608.59it/s]extract the null data:  88%|████████▊ | 489/553 [00:00<00:00, 608.25it/s]extract the null data:  99%|█████████▉| 550/553 [00:00<00:00, 606.23it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 603.81it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 202.87it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:02, 207.20it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 207.18it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 208.69it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 210.37it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 211.78it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 192.57it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:01, 200.91it/s]replace nan value:  36%|███▌      | 197/553 [00:00<00:01, 204.50it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 208.72it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 211.32it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 210.15it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 210.87it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 212.87it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 213.47it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:01, 172.81it/s]replace nan value:  67%|██████▋   | 370/553 [00:01<00:01, 176.27it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 187.49it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 196.62it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 201.60it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 207.27it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 209.60it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 220.27it/s]replace nan value:  96%|█████████▌| 531/553 [00:02<00:00, 224.36it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 206.18it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 149.85it/s]  6%|▌         | 32/553 [00:00<00:03, 160.41it/s]  9%|▉         | 49/553 [00:00<00:03, 131.88it/s] 11%|█▏        | 63/553 [00:00<00:03, 130.37it/s] 14%|█▍        | 78/553 [00:00<00:03, 132.81it/s] 17%|█▋        | 93/553 [00:00<00:03, 134.76it/s] 19%|█▉        | 107/553 [00:00<00:03, 123.12it/s] 22%|██▏       | 123/553 [00:00<00:03, 132.56it/s] 25%|██▌       | 140/553 [00:01<00:02, 142.69it/s] 29%|██▉       | 160/553 [00:01<00:02, 156.83it/s] 32%|███▏      | 176/553 [00:01<00:02, 157.37it/s] 35%|███▌      | 194/553 [00:01<00:02, 161.87it/s] 39%|███▊      | 213/553 [00:01<00:02, 167.35it/s] 42%|████▏     | 230/553 [00:01<00:02, 142.04it/s] 44%|████▍     | 246/553 [00:01<00:02, 146.59it/s] 48%|████▊     | 264/553 [00:01<00:01, 151.76it/s] 51%|█████     | 280/553 [00:01<00:01, 145.10it/s] 53%|█████▎    | 295/553 [00:02<00:01, 143.10it/s] 56%|█████▌    | 310/553 [00:02<00:01, 140.85it/s] 59%|█████▉    | 325/553 [00:02<00:01, 141.94it/s] 61%|██████▏   | 340/553 [00:02<00:01, 142.20it/s] 64%|██████▍   | 355/553 [00:02<00:01, 138.42it/s] 67%|██████▋   | 372/553 [00:02<00:01, 145.36it/s] 70%|██████▉   | 387/553 [00:02<00:01, 136.36it/s] 73%|███████▎  | 401/553 [00:02<00:01, 128.62it/s] 75%|███████▌  | 416/553 [00:02<00:01, 131.54it/s] 78%|███████▊  | 430/553 [00:03<00:00, 127.58it/s] 80%|████████  | 444/553 [00:03<00:00, 129.98it/s] 83%|████████▎ | 458/553 [00:03<00:00, 121.49it/s] 86%|████████▌ | 475/553 [00:03<00:00, 132.73it/s] 88%|████████▊ | 489/553 [00:03<00:00, 130.88it/s] 91%|█████████ | 503/553 [00:03<00:00, 129.36it/s] 94%|█████████▎| 518/553 [00:03<00:00, 133.83it/s] 96%|█████████▌| 532/553 [00:03<00:00, 111.48it/s] 99%|█████████▉| 550/553 [00:04<00:00, 128.31it/s]100%|██████████| 553/553 [00:04<00:00, 134.48it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  14%|█▎        | 19/139 [00:00<00:00, 187.78it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 474.34it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 484.75it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  10%|█         | 14/139 [00:00<00:01, 120.25it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 184.83it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 155.86it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 150.27it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 147.53it/s]replace nan value:  76%|███████▋  | 106/139 [00:00<00:00, 142.48it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 142.36it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 150.88it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  6%|▋         | 9/139 [00:00<00:01, 86.67it/s] 13%|█▎        | 18/139 [00:00<00:01, 73.66it/s] 23%|██▎       | 32/139 [00:00<00:01, 100.13it/s] 33%|███▎      | 46/139 [00:00<00:00, 112.63it/s] 42%|████▏     | 58/139 [00:00<00:00, 104.23it/s] 53%|█████▎    | 74/139 [00:00<00:00, 112.05it/s] 63%|██████▎   | 87/139 [00:00<00:00, 113.88it/s] 71%|███████   | 99/139 [00:00<00:00, 110.36it/s] 80%|███████▉  | 111/139 [00:01<00:00, 109.61it/s] 91%|█████████▏| 127/139 [00:01<00:00, 120.45it/s]100%|██████████| 139/139 [00:01<00:00, 111.59it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 216.98it/s]extract the null data:  45%|████▌     | 78/173 [00:00<00:00, 415.83it/s]extract the null data:  69%|██████▉   | 120/173 [00:00<00:00, 413.10it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 445.38it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   9%|▉         | 16/173 [00:00<00:00, 159.79it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 201.99it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 177.92it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 162.12it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 185.16it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 193.63it/s]replace nan value:  86%|████████▌ | 148/173 [00:00<00:00, 189.93it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 199.56it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 189.60it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 138.64it/s] 17%|█▋        | 29/173 [00:00<00:01, 122.02it/s] 26%|██▌       | 45/173 [00:00<00:00, 137.32it/s] 36%|███▌      | 62/173 [00:00<00:00, 146.39it/s] 45%|████▌     | 78/173 [00:00<00:00, 150.81it/s] 54%|█████▍    | 94/173 [00:00<00:00, 145.71it/s] 63%|██████▎   | 109/173 [00:00<00:00, 144.17it/s] 72%|███████▏  | 124/173 [00:00<00:00, 137.74it/s] 80%|███████▉  | 138/173 [00:00<00:00, 137.59it/s] 88%|████████▊ | 152/173 [00:01<00:00, 130.62it/s] 96%|█████████▌| 166/173 [00:01<00:00, 100.61it/s]100%|██████████| 173/173 [00:01<00:00, 121.79it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.008, train acc : 0.889, valid acc : 0.918, train f1 : 0.514, valid f1 : 0.521
training process:   1%|          | 1/128 [01:12<2:32:45, 72.17s/it]Best score increase :0.000 -> 0.521
training process:   2%|▏         | 2/128 [02:11<2:15:06, 64.34s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:12<2:11:19, 63.04s/it]Best score increase :0.521 -> 0.566
training process:   3%|▎         | 4/128 [04:11<2:06:47, 61.35s/it]Best score increase :0.566 -> 0.687
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.939, valid acc : 0.939, train f1 : 0.709, valid f1 : 0.739
training process:   4%|▍         | 5/128 [05:17<2:09:36, 63.22s/it]Best score increase :0.687 -> 0.739
training process:   5%|▍         | 6/128 [06:17<2:05:49, 61.88s/it]Best score increase :0.739 -> 0.768
training process:   5%|▌         | 7/128 [07:09<1:58:42, 58.86s/it]Best score increase :0.768 -> 0.794
training process:   6%|▋         | 8/128 [07:59<1:52:00, 56.01s/it]Best score increase :0.794 -> 0.808
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.953, valid acc : 0.952, train f1 : 0.800, valid f1 : 0.802
training process:   7%|▋         | 9/128 [08:55<1:50:59, 55.96s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:48<1:48:19, 55.08s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [10:46<1:49:13, 56.01s/it]Best score increase :0.808 -> 0.824
training process:   9%|▉         | 12/128 [11:34<1:43:21, 53.46s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.003, train acc : 0.957, valid acc : 0.954, train f1 : 0.823, valid f1 : 0.812
training process:  10%|█         | 13/128 [12:31<1:44:52, 54.72s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [13:20<1:40:25, 52.85s/it]Best score increase :0.824 -> 0.836
training process:  12%|█▏        | 15/128 [14:22<1:44:30, 55.49s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:16<1:42:45, 55.05s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.958, valid acc : 0.957, train f1 : 0.830, valid f1 : 0.825
training process:  13%|█▎        | 17/128 [16:33<1:54:24, 61.84s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [17:26<1:48:18, 59.08s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [18:22<1:45:36, 58.14s/it]Best score increase :0.836 -> 0.840
training process:  16%|█▌        | 20/128 [19:33<1:51:35, 62.00s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train acc : 0.959, valid acc : 0.957, train f1 : 0.835, valid f1 : 0.822
training process:  16%|█▋        | 21/128 [20:49<1:57:58, 66.16s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [21:55<1:56:56, 66.19s/it]EarlyStopping counter : 3 out of 12
training process:  18%|█▊        | 23/128 [23:09<2:00:10, 68.67s/it]EarlyStopping counter : 4 out of 12
training process:  19%|█▉        | 24/128 [24:20<2:00:09, 69.32s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.960, train f1 : 0.841, valid f1 : 0.848
training process:  20%|█▉        | 25/128 [25:37<2:02:42, 71.48s/it]Best score increase :0.840 -> 0.848
training process:  20%|██        | 26/128 [26:51<2:02:49, 72.25s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [27:50<1:54:55, 68.27s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [28:52<1:50:40, 66.40s/it]Best score increase :0.848 -> 0.852
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.961, valid acc : 0.959, train f1 : 0.846, valid f1 : 0.847
training process:  23%|██▎       | 29/128 [30:10<1:55:23, 69.94s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [31:29<1:58:41, 72.67s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [32:26<1:49:54, 67.98s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [33:37<1:50:11, 68.87s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.002, train acc : 0.962, valid acc : 0.961, train f1 : 0.851, valid f1 : 0.851
training process:  26%|██▌       | 33/128 [34:46<1:49:14, 69.00s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [35:57<1:48:48, 69.45s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [37:03<1:46:12, 68.52s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [38:15<1:46:40, 69.57s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.002, train acc : 0.963, valid acc : 0.960, train f1 : 0.856, valid f1 : 0.850
training process:  29%|██▉       | 37/128 [39:41<1:52:57, 74.47s/it]EarlyStopping counter : 9 out of 12
training process:  30%|██▉       | 38/128 [40:45<1:46:45, 71.17s/it]EarlyStopping counter : 10 out of 12
training process:  30%|███       | 39/128 [41:58<1:46:32, 71.83s/it]EarlyStopping counter : 11 out of 12
training process:  30%|███       | 39/128 [42:58<1:38:04, 66.11s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 39, best f1 score : 0.852
training process finished, best loss : 0.003 and best acc : 0.959, best f1 : 0.852, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.67      0.67       580
           1       0.97      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.82      0.82      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.82, test AUC : 0.82, test loss : 0.170

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:12<02:18, 12.61s/it]processing for feature importance:  17%|█▋        | 2/12 [00:25<02:09, 12.95s/it]processing for feature importance:  25%|██▌       | 3/12 [00:37<01:53, 12.56s/it]processing for feature importance:  33%|███▎      | 4/12 [00:52<01:45, 13.23s/it]processing for feature importance:  42%|████▏     | 5/12 [01:01<01:23, 11.93s/it]processing for feature importance:  50%|█████     | 6/12 [01:09<01:03, 10.65s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:17<00:48,  9.77s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:29<00:41, 10.31s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:41<00:32, 10.79s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:53<00:22, 11.35s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:04<00:11, 11.29s/it]processing for feature importance: 100%|██████████| 12/12 [02:16<00:00, 11.49s/it]processing for feature importance: 100%|██████████| 12/12 [02:16<00:00, 11.41s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 78.54it/s]  9%|▉         | 27/306 [00:00<00:02, 129.96it/s] 13%|█▎        | 41/306 [00:00<00:02, 129.84it/s] 24%|██▍       | 74/306 [00:00<00:01, 204.19it/s] 31%|███       | 95/306 [00:00<00:01, 154.85it/s] 37%|███▋      | 113/306 [00:00<00:01, 104.82it/s] 42%|████▏     | 130/306 [00:01<00:01, 116.73it/s] 47%|████▋     | 145/306 [00:01<00:01, 114.09it/s] 55%|█████▍    | 168/306 [00:01<00:00, 138.98it/s] 60%|██████    | 184/306 [00:01<00:00, 136.48it/s] 65%|██████▌   | 200/306 [00:01<00:00, 124.81it/s] 77%|███████▋  | 237/306 [00:01<00:00, 176.50it/s] 84%|████████▍ | 257/306 [00:01<00:00, 127.47it/s] 89%|████████▉ | 273/306 [00:02<00:00, 117.15it/s] 94%|█████████▍| 287/306 [00:02<00:00, 107.05it/s]100%|██████████| 306/306 [00:02<00:00, 123.11it/s]100%|██████████| 306/306 [00:02<00:00, 128.18it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 55/553 [00:00<00:00, 549.80it/s]extract the null data:  20%|█▉        | 110/553 [00:00<00:00, 504.91it/s]extract the null data:  31%|███       | 170/553 [00:00<00:00, 543.13it/s]extract the null data:  41%|████      | 228/553 [00:00<00:00, 556.23it/s]extract the null data:  52%|█████▏    | 286/553 [00:00<00:00, 564.52it/s]extract the null data:  62%|██████▏   | 343/553 [00:00<00:00, 539.40it/s]extract the null data:  73%|███████▎  | 405/553 [00:00<00:00, 562.82it/s]extract the null data:  85%|████████▍ | 468/553 [00:00<00:00, 582.07it/s]extract the null data:  95%|█████████▌| 528/553 [00:00<00:00, 585.39it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 563.82it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 193.97it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 200.64it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 200.63it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 193.49it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 158.78it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:03, 136.18it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 149.82it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 144.48it/s]replace nan value:  31%|███       | 171/553 [00:01<00:02, 147.57it/s]replace nan value:  35%|███▍      | 191/553 [00:01<00:02, 159.94it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:02, 165.52it/s]replace nan value:  41%|████      | 226/553 [00:01<00:02, 161.81it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 177.57it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 188.81it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 187.76it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 194.70it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 199.70it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:00, 203.79it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:00, 199.52it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 204.31it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 207.40it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 209.70it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 155.67it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 142.95it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 128.88it/s]replace nan value:  94%|█████████▍| 521/553 [00:03<00:00, 145.88it/s]replace nan value:  98%|█████████▊| 542/553 [00:03<00:00, 159.55it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 170.37it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 145.06it/s]  5%|▌         | 30/553 [00:00<00:04, 110.46it/s]  8%|▊         | 43/553 [00:00<00:04, 114.69it/s] 10%|▉         | 55/553 [00:00<00:04, 104.36it/s] 12%|█▏        | 66/553 [00:00<00:05, 94.11it/s]  14%|█▍        | 80/553 [00:00<00:04, 106.12it/s] 17%|█▋        | 92/553 [00:00<00:04, 109.65it/s] 19%|█▉        | 107/553 [00:00<00:03, 121.11it/s] 22%|██▏       | 122/553 [00:01<00:03, 129.39it/s] 25%|██▍       | 136/553 [00:01<00:03, 115.03it/s] 27%|██▋       | 148/553 [00:01<00:03, 113.49it/s] 29%|██▉       | 160/553 [00:01<00:03, 105.23it/s] 31%|███       | 171/553 [00:01<00:04, 92.97it/s]  33%|███▎      | 181/553 [00:01<00:05, 74.39it/s] 34%|███▍      | 190/553 [00:01<00:04, 75.25it/s] 36%|███▌      | 199/553 [00:02<00:04, 71.64it/s] 39%|███▉      | 217/553 [00:02<00:03, 91.80it/s] 41%|████      | 228/553 [00:02<00:03, 95.70it/s] 44%|████▍     | 244/553 [00:02<00:02, 108.85it/s] 47%|████▋     | 262/553 [00:02<00:02, 126.74it/s] 50%|████▉     | 276/553 [00:02<00:02, 127.10it/s] 53%|█████▎    | 292/553 [00:02<00:01, 133.44it/s] 55%|█████▌    | 306/553 [00:02<00:01, 129.83it/s] 58%|█████▊    | 320/553 [00:02<00:01, 131.63it/s] 60%|██████    | 334/553 [00:03<00:01, 118.77it/s] 63%|██████▎   | 349/553 [00:03<00:01, 125.02it/s] 65%|██████▌   | 362/553 [00:03<00:01, 126.16it/s] 68%|██████▊   | 376/553 [00:03<00:01, 123.22it/s] 70%|███████   | 389/553 [00:03<00:01, 87.98it/s]  72%|███████▏  | 400/553 [00:03<00:01, 86.13it/s] 75%|███████▌  | 415/553 [00:03<00:01, 97.97it/s] 77%|███████▋  | 426/553 [00:04<00:01, 92.60it/s] 79%|███████▉  | 437/553 [00:04<00:01, 95.95it/s] 82%|████████▏ | 455/553 [00:04<00:00, 116.72it/s] 85%|████████▍ | 468/553 [00:04<00:00, 113.12it/s] 87%|████████▋ | 480/553 [00:04<00:00, 107.29it/s] 89%|████████▉ | 492/553 [00:04<00:00, 96.00it/s]  92%|█████████▏| 506/553 [00:04<00:00, 105.88it/s] 94%|█████████▍| 521/553 [00:04<00:00, 115.49it/s] 97%|█████████▋| 534/553 [00:05<00:00, 107.56it/s]100%|█████████▉| 551/553 [00:05<00:00, 104.04it/s]100%|██████████| 553/553 [00:05<00:00, 105.91it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 365.51it/s]extract the null data:  76%|███████▌  | 105/139 [00:00<00:00, 545.34it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 547.71it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 189.56it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 197.42it/s]replace nan value:  45%|████▍     | 62/139 [00:00<00:00, 159.39it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 151.63it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 134.22it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 128.94it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 127.94it/s]replace nan value:  98%|█████████▊| 136/139 [00:01<00:00, 117.59it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 136.54it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  4%|▍         | 6/139 [00:00<00:02, 50.76it/s] 10%|█         | 14/139 [00:00<00:02, 57.87it/s] 14%|█▍        | 20/139 [00:00<00:02, 49.55it/s] 24%|██▎       | 33/139 [00:00<00:01, 74.91it/s] 32%|███▏      | 45/139 [00:00<00:01, 88.92it/s] 40%|███▉      | 55/139 [00:00<00:00, 86.94it/s] 47%|████▋     | 65/139 [00:00<00:00, 88.58it/s] 54%|█████▍    | 75/139 [00:00<00:00, 79.47it/s] 60%|██████    | 84/139 [00:01<00:00, 76.24it/s] 68%|██████▊   | 95/139 [00:01<00:00, 84.96it/s] 78%|███████▊  | 108/139 [00:01<00:00, 96.01it/s] 90%|████████▉ | 125/139 [00:01<00:00, 116.17it/s]100%|██████████| 139/139 [00:01<00:00, 91.96it/s] 
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 23/173 [00:00<00:00, 226.75it/s]extract the null data:  49%|████▊     | 84/173 [00:00<00:00, 449.43it/s]extract the null data:  86%|████████▌ | 149/173 [00:00<00:00, 501.65it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 439.70it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 195.34it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 207.54it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 212.83it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 208.36it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 216.86it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 218.26it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 210.51it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 200.56it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 141.64it/s] 17%|█▋        | 30/173 [00:00<00:01, 131.05it/s] 25%|██▌       | 44/173 [00:00<00:01, 127.24it/s] 34%|███▍      | 59/173 [00:00<00:00, 134.93it/s] 43%|████▎     | 74/173 [00:00<00:00, 139.60it/s] 51%|█████▏    | 89/173 [00:00<00:00, 141.17it/s] 60%|██████    | 104/173 [00:00<00:00, 109.99it/s] 68%|██████▊   | 117/173 [00:00<00:00, 103.16it/s] 75%|███████▍  | 129/173 [00:01<00:00, 76.28it/s]  80%|████████  | 139/173 [00:01<00:00, 67.09it/s] 85%|████████▍ | 147/173 [00:01<00:00, 67.90it/s] 90%|████████▉ | 155/173 [00:01<00:00, 61.55it/s] 94%|█████████▎| 162/173 [00:01<00:00, 54.95it/s] 97%|█████████▋| 168/173 [00:02<00:00, 44.98it/s]100%|██████████| 173/173 [00:02<00:00, 41.66it/s]100%|██████████| 173/173 [00:02<00:00, 75.21it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : 0.010, train acc : 0.648, valid acc : 0.748, train f1 : 0.647, valid f1 : 0.578
training process:   1%|          | 1/128 [01:38<3:27:37, 98.09s/it]Best score increase :0.000 -> 0.578
training process:   2%|▏         | 2/128 [02:57<3:02:49, 87.06s/it]Best score increase :0.578 -> 0.621
training process:   2%|▏         | 3/128 [04:14<2:51:41, 82.41s/it]Best score increase :0.621 -> 0.717
training process:   3%|▎         | 4/128 [05:10<2:28:47, 71.99s/it]Best score increase :0.717 -> 0.752
epoch : 5, train loss : 0.007, valid loss : 0.006, train acc : 0.839, valid acc : 0.899, train f1 : 0.838, valid f1 : 0.748
training process:   4%|▍         | 5/128 [06:11<2:19:24, 68.01s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [07:05<2:08:43, 63.30s/it]Best score increase :0.752 -> 0.758
training process:   5%|▌         | 7/128 [07:55<1:59:13, 59.12s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [08:45<1:52:07, 56.06s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.006, valid loss : 0.005, train acc : 0.860, valid acc : 0.921, train f1 : 0.860, valid f1 : 0.787
training process:   7%|▋         | 9/128 [09:43<1:52:16, 56.61s/it]Best score increase :0.758 -> 0.787
training process:   8%|▊         | 10/128 [10:32<1:46:36, 54.20s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [11:21<1:42:38, 52.63s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [12:11<1:40:25, 51.94s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.006, train acc : 0.869, valid acc : 0.868, train f1 : 0.869, valid f1 : 0.723
training process:  10%|█         | 13/128 [13:09<1:43:11, 53.84s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [13:59<1:40:11, 52.73s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [14:50<1:37:57, 52.01s/it]EarlyStopping counter : 6 out of 12
training process:  12%|█▎        | 16/128 [15:40<1:36:19, 51.60s/it]EarlyStopping counter : 7 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.005, train acc : 0.881, valid acc : 0.887, train f1 : 0.881, valid f1 : 0.747
training process:  13%|█▎        | 17/128 [16:40<1:39:51, 53.98s/it]EarlyStopping counter : 8 out of 12
training process:  14%|█▍        | 18/128 [17:31<1:37:29, 53.17s/it]EarlyStopping counter : 9 out of 12
training process:  15%|█▍        | 19/128 [18:19<1:33:34, 51.51s/it]EarlyStopping counter : 10 out of 12
training process:  16%|█▌        | 20/128 [19:09<1:31:54, 51.06s/it]EarlyStopping counter : 11 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.005, train acc : 0.888, valid acc : 0.890, train f1 : 0.888, valid f1 : 0.756
training process:  16%|█▌        | 20/128 [20:12<1:49:05, 60.60s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 20, best f1 score : 0.787
training process finished, best loss : 0.005 and best acc : 0.921, best f1 : 0.787, best epoch : 8

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.44      0.79      0.56       580
           1       0.98      0.91      0.95      6818

    accuracy                           0.90      7398
   macro avg       0.71      0.85      0.76      7398
weighted avg       0.94      0.90      0.92      7398


# test acc : 0.90, test f1 : 0.76, test AUC : 0.85, test loss : 0.308

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.76s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.66s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.69s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.56s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.61s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:44,  7.48s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:37,  7.57s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.65s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:23,  7.74s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.88s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.88s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.81s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.72s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  9%|▉         | 29/306 [00:00<00:01, 273.97it/s] 19%|█▊        | 57/306 [00:00<00:01, 158.09it/s] 33%|███▎      | 102/306 [00:00<00:00, 250.06it/s] 43%|████▎     | 133/306 [00:00<00:00, 219.78it/s] 52%|█████▏    | 159/306 [00:00<00:00, 198.79it/s] 59%|█████▉    | 182/306 [00:00<00:00, 182.52it/s] 70%|██████▉   | 214/306 [00:01<00:00, 212.56it/s] 78%|███████▊  | 238/306 [00:01<00:00, 208.53it/s] 85%|████████▌ | 261/306 [00:01<00:00, 190.64it/s] 92%|█████████▏| 282/306 [00:01<00:00, 175.32it/s] 98%|█████████▊| 301/306 [00:01<00:00, 170.14it/s]100%|██████████| 306/306 [00:01<00:00, 191.22it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:00, 534.81it/s]extract the null data:  20%|█▉        | 110/553 [00:00<00:00, 548.42it/s]extract the null data:  30%|██▉       | 165/553 [00:00<00:00, 537.75it/s]extract the null data:  40%|███▉      | 219/553 [00:00<00:00, 526.01it/s]extract the null data:  49%|████▉     | 272/553 [00:00<00:00, 509.40it/s]extract the null data:  59%|█████▉    | 326/553 [00:00<00:00, 518.46it/s]extract the null data:  68%|██████▊   | 378/553 [00:00<00:00, 517.83it/s]extract the null data:  78%|███████▊  | 430/553 [00:00<00:00, 516.63it/s]extract the null data:  87%|████████▋ | 482/553 [00:00<00:00, 515.47it/s]extract the null data:  97%|█████████▋| 534/553 [00:01<00:00, 513.96it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 520.15it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 174.08it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 177.01it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 179.66it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 179.67it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 179.01it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 181.37it/s]replace nan value:  23%|██▎       | 129/553 [00:00<00:02, 181.74it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 182.30it/s]replace nan value:  30%|███       | 167/553 [00:00<00:02, 155.92it/s]replace nan value:  33%|███▎      | 185/553 [00:01<00:02, 161.28it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 166.88it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 170.77it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 156.63it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 166.77it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 153.78it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 159.11it/s]replace nan value:  57%|█████▋    | 316/553 [00:01<00:01, 165.98it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 170.71it/s]replace nan value:  64%|██████▍   | 354/553 [00:02<00:01, 175.02it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:01, 178.67it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:00, 179.83it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 182.30it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 183.54it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 186.28it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 183.57it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 182.22it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 182.73it/s]replace nan value:  95%|█████████▌| 526/553 [00:03<00:00, 183.63it/s]replace nan value:  99%|█████████▊| 545/553 [00:03<00:00, 183.09it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 174.13it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 108.22it/s]  5%|▍         | 25/553 [00:00<00:04, 120.96it/s]  7%|▋         | 39/553 [00:00<00:04, 122.97it/s]  9%|▉         | 52/553 [00:00<00:04, 108.42it/s] 12%|█▏        | 64/553 [00:00<00:04, 103.36it/s] 14%|█▍        | 78/553 [00:00<00:04, 111.54it/s] 16%|█▋        | 90/553 [00:00<00:04, 92.94it/s]  18%|█▊        | 100/553 [00:00<00:04, 91.97it/s] 21%|██        | 115/553 [00:01<00:04, 106.14it/s] 23%|██▎       | 128/553 [00:01<00:03, 111.38it/s] 26%|██▋       | 146/553 [00:01<00:03, 128.98it/s] 29%|██▉       | 162/553 [00:01<00:02, 137.07it/s] 32%|███▏      | 178/553 [00:01<00:02, 141.74it/s] 35%|███▌      | 195/553 [00:01<00:02, 147.62it/s] 38%|███▊      | 211/553 [00:01<00:02, 150.39it/s] 41%|████      | 227/553 [00:01<00:02, 136.84it/s] 44%|████▍     | 242/553 [00:01<00:02, 135.61it/s] 46%|████▋     | 256/553 [00:02<00:02, 104.11it/s] 48%|████▊     | 268/553 [00:02<00:02, 103.75it/s] 51%|█████     | 280/553 [00:02<00:02, 102.39it/s] 53%|█████▎    | 293/553 [00:02<00:02, 107.84it/s] 55%|█████▌    | 306/553 [00:02<00:02, 107.32it/s] 58%|█████▊    | 318/553 [00:02<00:02, 109.87it/s] 60%|█████▉    | 330/553 [00:02<00:01, 112.47it/s] 62%|██████▏   | 345/553 [00:02<00:01, 117.42it/s] 65%|██████▍   | 357/553 [00:03<00:01, 116.00it/s] 67%|██████▋   | 372/553 [00:03<00:01, 124.15it/s] 70%|██████▉   | 385/553 [00:03<00:01, 120.68it/s] 72%|███████▏  | 398/553 [00:03<00:01, 109.43it/s] 75%|███████▍  | 414/553 [00:03<00:01, 118.01it/s] 77%|███████▋  | 427/553 [00:03<00:01, 108.60it/s] 80%|███████▉  | 442/553 [00:03<00:00, 118.76it/s] 83%|████████▎ | 457/553 [00:03<00:00, 126.71it/s] 85%|████████▌ | 471/553 [00:04<00:00, 128.61it/s] 88%|████████▊ | 485/553 [00:04<00:00, 121.74it/s] 90%|█████████ | 498/553 [00:04<00:00, 114.15it/s] 93%|█████████▎| 513/553 [00:04<00:00, 120.81it/s] 95%|█████████▌| 526/553 [00:04<00:00, 108.39it/s] 97%|█████████▋| 538/553 [00:04<00:00, 107.52it/s]100%|█████████▉| 551/553 [00:04<00:00, 95.59it/s] 100%|██████████| 553/553 [00:04<00:00, 114.53it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 275.22it/s]extract the null data:  56%|█████▌    | 78/139 [00:00<00:00, 405.82it/s]extract the null data:  92%|█████████▏| 128/139 [00:00<00:00, 445.86it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 429.20it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 170.80it/s]replace nan value:  27%|██▋       | 37/139 [00:00<00:00, 176.58it/s]replace nan value:  40%|███▉      | 55/139 [00:00<00:00, 174.43it/s]replace nan value:  53%|█████▎    | 73/139 [00:00<00:00, 175.31it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 173.60it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 173.50it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 175.27it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 175.47it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 105.79it/s] 17%|█▋        | 23/139 [00:00<00:01, 112.94it/s] 26%|██▌       | 36/139 [00:00<00:00, 119.38it/s] 35%|███▍      | 48/139 [00:00<00:00, 118.07it/s] 43%|████▎     | 60/139 [00:00<00:00, 113.56it/s] 53%|█████▎    | 73/139 [00:00<00:00, 116.77it/s] 61%|██████    | 85/139 [00:00<00:00, 105.46it/s] 69%|██████▉   | 96/139 [00:00<00:00, 105.71it/s] 78%|███████▊  | 109/139 [00:00<00:00, 109.48it/s] 91%|█████████ | 126/139 [00:01<00:00, 123.33it/s]100%|██████████| 139/139 [00:01<00:00, 117.59it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:21,  8.09it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 168.58it/s]extract the null data:  34%|███▎      | 58/173 [00:00<00:00, 206.10it/s]extract the null data:  59%|█████▉    | 102/173 [00:00<00:00, 292.27it/s]extract the null data:  89%|████████▉ | 154/173 [00:00<00:00, 370.34it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 303.83it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   8%|▊         | 14/173 [00:00<00:01, 137.65it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 171.18it/s]replace nan value:  30%|███       | 52/173 [00:00<00:00, 174.67it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 179.16it/s]replace nan value:  51%|█████▏    | 89/173 [00:00<00:00, 177.48it/s]replace nan value:  62%|██████▏   | 107/173 [00:00<00:00, 177.32it/s]replace nan value:  72%|███████▏  | 125/173 [00:00<00:00, 178.16it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 182.16it/s]replace nan value:  95%|█████████▍| 164/173 [00:00<00:00, 179.85it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 176.51it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 129.79it/s] 16%|█▌        | 27/173 [00:00<00:01, 119.71it/s] 24%|██▍       | 42/173 [00:00<00:00, 132.61it/s] 32%|███▏      | 56/173 [00:00<00:01, 109.98it/s] 39%|███▉      | 68/173 [00:00<00:00, 109.57it/s] 48%|████▊     | 83/173 [00:00<00:00, 120.57it/s] 56%|█████▌    | 97/173 [00:00<00:00, 125.35it/s] 65%|██████▍   | 112/173 [00:00<00:00, 130.07it/s] 73%|███████▎  | 126/173 [00:01<00:00, 124.68it/s] 81%|████████  | 140/173 [00:01<00:00, 128.97it/s] 89%|████████▉ | 154/173 [00:01<00:00, 124.48it/s] 97%|█████████▋| 167/173 [00:01<00:00, 93.29it/s] 100%|██████████| 173/173 [00:01<00:00, 110.77it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : 0.013, train acc : 0.623, valid acc : 0.652, train f1 : 0.476, valid f1 : 0.511
training process:   1%|          | 1/128 [01:25<3:00:12, 85.14s/it]Best score increase :0.000 -> 0.511
training process:   2%|▏         | 2/128 [02:20<2:22:31, 67.87s/it]Best score increase :0.511 -> 0.571
training process:   2%|▏         | 3/128 [03:13<2:06:40, 60.80s/it]Best score increase :0.571 -> 0.666
training process:   3%|▎         | 4/128 [04:07<2:00:05, 58.11s/it]Best score increase :0.666 -> 0.688
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.855, valid acc : 0.844, train f1 : 0.689, valid f1 : 0.682
training process:   4%|▍         | 5/128 [05:06<2:00:05, 58.58s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:59<1:54:51, 56.49s/it]Best score increase :0.688 -> 0.734
training process:   5%|▌         | 7/128 [06:52<1:51:42, 55.39s/it]Best score increase :0.734 -> 0.750
training process:   6%|▋         | 8/128 [07:45<1:49:09, 54.58s/it]Best score increase :0.750 -> 0.771
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.899, valid acc : 0.921, train f1 : 0.748, valid f1 : 0.783
training process:   7%|▋         | 9/128 [08:49<1:54:37, 57.80s/it]Best score increase :0.771 -> 0.783
training process:   8%|▊         | 10/128 [09:45<1:51:59, 56.95s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:38<1:49:14, 56.02s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [11:32<1:46:58, 55.34s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.007, train acc : 0.908, valid acc : 0.927, train f1 : 0.763, valid f1 : 0.798
training process:  10%|█         | 13/128 [12:32<1:48:55, 56.83s/it]Best score increase :0.783 -> 0.798
training process:  11%|█         | 14/128 [13:24<1:45:04, 55.31s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [14:16<1:42:04, 54.20s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [15:17<1:45:04, 56.29s/it]Best score increase :0.798 -> 0.806
epoch : 17, train loss : 0.006, valid loss : 0.007, train acc : 0.913, valid acc : 0.936, train f1 : 0.774, valid f1 : 0.815
training process:  13%|█▎        | 17/128 [16:18<1:46:59, 57.83s/it]Best score increase :0.806 -> 0.815
training process:  14%|█▍        | 18/128 [17:11<1:42:57, 56.16s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [18:03<1:39:37, 54.84s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [18:52<1:35:39, 53.14s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.007, train acc : 0.919, valid acc : 0.942, train f1 : 0.783, valid f1 : 0.817
training process:  16%|█▋        | 21/128 [19:49<1:36:51, 54.31s/it]Best score increase :0.815 -> 0.817
training process:  17%|█▋        | 22/128 [20:39<1:33:51, 53.12s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [21:30<1:31:48, 52.47s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [22:22<1:30:27, 52.19s/it]Best score increase :0.817 -> 0.819
epoch : 25, train loss : 0.006, valid loss : 0.006, train acc : 0.923, valid acc : 0.926, train f1 : 0.791, valid f1 : 0.801
training process:  20%|█▉        | 25/128 [23:25<1:35:24, 55.58s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 26/128 [24:30<1:39:01, 58.25s/it]EarlyStopping counter : 2 out of 12
training process:  21%|██        | 27/128 [25:28<1:38:23, 58.45s/it]EarlyStopping counter : 3 out of 12
training process:  22%|██▏       | 28/128 [26:27<1:37:32, 58.53s/it]EarlyStopping counter : 4 out of 12
epoch : 29, train loss : 0.006, valid loss : 0.006, train acc : 0.927, valid acc : 0.921, train f1 : 0.798, valid f1 : 0.795
training process:  23%|██▎       | 29/128 [27:34<1:40:48, 61.10s/it]EarlyStopping counter : 5 out of 12
training process:  23%|██▎       | 30/128 [28:39<1:41:28, 62.13s/it]EarlyStopping counter : 6 out of 12
training process:  24%|██▍       | 31/128 [29:40<1:39:50, 61.76s/it]EarlyStopping counter : 7 out of 12
training process:  25%|██▌       | 32/128 [30:38<1:37:15, 60.79s/it]Best score increase :0.819 -> 0.820
epoch : 33, train loss : 0.006, valid loss : 0.006, train acc : 0.929, valid acc : 0.920, train f1 : 0.803, valid f1 : 0.797
training process:  26%|██▌       | 33/128 [31:48<1:40:38, 63.56s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [32:47<1:37:12, 62.05s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [33:46<1:35:01, 61.30s/it]Best score increase :0.820 -> 0.826
training process:  28%|██▊       | 36/128 [34:46<1:33:12, 60.79s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.006, train acc : 0.929, valid acc : 0.929, train f1 : 0.806, valid f1 : 0.811
training process:  29%|██▉       | 37/128 [35:57<1:36:40, 63.75s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [36:54<1:32:48, 61.87s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [37:51<1:29:41, 60.47s/it]Best score increase :0.826 -> 0.830
training process:  31%|███▏      | 40/128 [38:50<1:28:06, 60.07s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.005, valid loss : 0.006, train acc : 0.930, valid acc : 0.922, train f1 : 0.807, valid f1 : 0.801
training process:  32%|███▏      | 41/128 [39:57<1:30:01, 62.09s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [40:56<1:27:24, 60.98s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [41:59<1:27:16, 61.61s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [43:00<1:25:59, 61.42s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.005, valid loss : 0.006, train acc : 0.932, valid acc : 0.939, train f1 : 0.812, valid f1 : 0.830
training process:  35%|███▌      | 45/128 [44:11<1:29:10, 64.46s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 46/128 [45:17<1:28:37, 64.84s/it]EarlyStopping counter : 7 out of 12
training process:  37%|███▋      | 47/128 [46:29<1:30:26, 66.99s/it]EarlyStopping counter : 8 out of 12
training process:  38%|███▊      | 48/128 [47:38<1:30:11, 67.65s/it]Best score increase :0.830 -> 0.839
epoch : 49, train loss : 0.005, valid loss : 0.006, train acc : 0.936, valid acc : 0.924, train f1 : 0.821, valid f1 : 0.806
training process:  38%|███▊      | 49/128 [48:55<1:32:41, 70.40s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [50:04<1:31:01, 70.02s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [51:10<1:28:21, 68.86s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [52:13<1:24:54, 67.03s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.005, valid loss : 0.006, train acc : 0.935, valid acc : 0.944, train f1 : 0.819, valid f1 : 0.837
training process:  41%|████▏     | 53/128 [53:41<1:31:36, 73.29s/it]EarlyStopping counter : 5 out of 12
training process:  42%|████▏     | 54/128 [55:14<1:37:34, 79.11s/it]EarlyStopping counter : 6 out of 12
training process:  43%|████▎     | 55/128 [56:47<1:41:32, 83.47s/it]EarlyStopping counter : 7 out of 12
training process:  44%|████▍     | 56/128 [58:12<1:40:45, 83.96s/it]EarlyStopping counter : 8 out of 12
epoch : 57, train loss : 0.005, valid loss : 0.006, train acc : 0.938, valid acc : 0.939, train f1 : 0.824, valid f1 : 0.832
training process:  45%|████▍     | 57/128 [59:54<1:45:30, 89.17s/it]EarlyStopping counter : 9 out of 12
training process:  45%|████▌     | 58/128 [1:01:29<1:46:11, 91.03s/it]EarlyStopping counter : 10 out of 12
training process:  46%|████▌     | 59/128 [1:03:00<1:44:46, 91.11s/it]EarlyStopping counter : 11 out of 12
training process:  46%|████▌     | 59/128 [1:04:25<1:15:21, 65.52s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 59, best f1 score : 0.839
training process finished, best loss : 0.006 and best acc : 0.946, best f1 : 0.839, best epoch : 47

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.52      0.79      0.63       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.87      0.80      7398
weighted avg       0.95      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.87, test loss : 0.385

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:13<02:24, 13.16s/it]processing for feature importance:  17%|█▋        | 2/12 [00:25<02:05, 12.57s/it]processing for feature importance:  25%|██▌       | 3/12 [00:36<01:48, 12.06s/it]processing for feature importance:  33%|███▎      | 4/12 [00:48<01:34, 11.84s/it]processing for feature importance:  42%|████▏     | 5/12 [01:00<01:23, 11.92s/it]processing for feature importance:  50%|█████     | 6/12 [01:13<01:13, 12.22s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:26<01:02, 12.51s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:38<00:49, 12.42s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:51<00:38, 12.73s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:04<00:25, 12.75s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:17<00:12, 12.86s/it]processing for feature importance: 100%|██████████| 12/12 [02:29<00:00, 12.37s/it]processing for feature importance: 100%|██████████| 12/12 [02:29<00:00, 12.42s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 84.08it/s]  6%|▌         | 18/306 [00:00<00:03, 86.48it/s] 10%|█         | 31/306 [00:00<00:02, 105.13it/s] 14%|█▍        | 43/306 [00:00<00:02, 107.02it/s] 18%|█▊        | 54/306 [00:00<00:02, 101.85it/s] 21%|██        | 65/306 [00:00<00:02, 96.95it/s]  25%|██▍       | 75/306 [00:00<00:02, 92.81it/s] 29%|██▉       | 88/306 [00:00<00:02, 100.02it/s] 32%|███▏      | 99/306 [00:00<00:02, 101.28it/s] 36%|███▌      | 110/306 [00:01<00:02, 97.59it/s] 43%|████▎     | 132/306 [00:01<00:01, 128.48it/s] 48%|████▊     | 146/306 [00:01<00:01, 129.07it/s] 54%|█████▍    | 166/306 [00:01<00:00, 146.70it/s] 60%|██████    | 185/306 [00:01<00:00, 157.93it/s] 68%|██████▊   | 208/306 [00:01<00:00, 173.10it/s] 74%|███████▍  | 226/306 [00:01<00:00, 171.16it/s] 83%|████████▎ | 253/306 [00:01<00:00, 195.98it/s] 89%|████████▉ | 273/306 [00:02<00:00, 162.92it/s] 95%|█████████▌| 291/306 [00:02<00:00, 149.56it/s]100%|██████████| 306/306 [00:02<00:00, 137.14it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 39/553 [00:00<00:01, 386.62it/s]extract the null data:  14%|█▍        | 78/553 [00:00<00:01, 276.96it/s]extract the null data:  20%|█▉        | 108/553 [00:00<00:01, 239.20it/s]extract the null data:  24%|██▍       | 134/553 [00:00<00:01, 228.95it/s]extract the null data:  29%|██▉       | 160/553 [00:00<00:01, 233.06it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:01, 216.46it/s]extract the null data:  37%|███▋      | 207/553 [00:00<00:01, 218.41it/s]extract the null data:  44%|████▍     | 243/553 [00:00<00:01, 256.92it/s]extract the null data:  50%|█████     | 278/553 [00:01<00:00, 281.61it/s]extract the null data:  58%|█████▊    | 318/553 [00:01<00:00, 314.34it/s]extract the null data:  65%|██████▍   | 357/553 [00:01<00:00, 335.81it/s]extract the null data:  72%|███████▏  | 398/553 [00:01<00:00, 355.93it/s]extract the null data:  80%|███████▉  | 441/553 [00:01<00:00, 376.97it/s]extract the null data:  87%|████████▋ | 481/553 [00:01<00:00, 383.38it/s]extract the null data:  95%|█████████▌| 526/553 [00:01<00:00, 401.83it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 314.45it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 162.46it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 164.62it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 149.83it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:03, 154.40it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 158.41it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 155.17it/s]replace nan value:  21%|██        | 117/553 [00:00<00:02, 152.82it/s]replace nan value:  24%|██▍       | 133/553 [00:00<00:03, 115.08it/s]replace nan value:  26%|██▋       | 146/553 [00:01<00:03, 111.50it/s]replace nan value:  30%|██▉       | 164/553 [00:01<00:03, 127.40it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 139.60it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:02, 146.73it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:02, 158.19it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:02, 153.74it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 162.60it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 160.43it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 162.04it/s]replace nan value:  55%|█████▌    | 305/553 [00:02<00:01, 163.06it/s]replace nan value:  58%|█████▊    | 322/553 [00:02<00:01, 164.45it/s]replace nan value:  61%|██████▏   | 339/553 [00:02<00:01, 165.25it/s]replace nan value:  64%|██████▍   | 356/553 [00:02<00:01, 138.55it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:01, 145.14it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:01, 155.71it/s]replace nan value:  74%|███████▍  | 410/553 [00:02<00:00, 161.93it/s]replace nan value:  77%|███████▋  | 428/553 [00:02<00:00, 166.24it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 172.01it/s]replace nan value:  84%|████████▍ | 466/553 [00:03<00:00, 176.46it/s]replace nan value:  88%|████████▊ | 485/553 [00:03<00:00, 178.64it/s]replace nan value:  91%|█████████ | 503/553 [00:03<00:00, 171.34it/s]replace nan value:  94%|█████████▍| 521/553 [00:03<00:00, 171.78it/s]replace nan value:  97%|█████████▋| 539/553 [00:03<00:00, 172.06it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 156.45it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 4/553 [00:00<00:15, 34.56it/s]  4%|▎         | 20/553 [00:00<00:05, 95.10it/s]  6%|▌         | 33/553 [00:00<00:04, 106.21it/s]  8%|▊         | 44/553 [00:00<00:05, 94.53it/s]  10%|█         | 56/553 [00:00<00:05, 98.09it/s] 12%|█▏        | 66/553 [00:00<00:05, 93.70it/s] 14%|█▍        | 80/553 [00:00<00:04, 105.51it/s] 17%|█▋        | 94/553 [00:00<00:03, 114.77it/s] 20%|█▉        | 109/553 [00:01<00:03, 122.03it/s] 22%|██▏       | 124/553 [00:01<00:03, 128.27it/s] 25%|██▌       | 140/553 [00:01<00:03, 137.14it/s] 28%|██▊       | 157/553 [00:01<00:02, 146.24it/s] 31%|███▏      | 174/553 [00:01<00:02, 147.23it/s] 34%|███▍      | 190/553 [00:01<00:02, 149.81it/s] 38%|███▊      | 208/553 [00:01<00:02, 156.76it/s] 41%|████      | 224/553 [00:01<00:02, 138.31it/s] 43%|████▎     | 239/553 [00:01<00:02, 130.62it/s] 46%|████▌     | 253/553 [00:02<00:02, 131.68it/s] 48%|████▊     | 267/553 [00:02<00:02, 131.91it/s] 51%|█████     | 281/553 [00:02<00:02, 96.14it/s]  53%|█████▎    | 293/553 [00:02<00:03, 84.88it/s] 55%|█████▍    | 303/553 [00:02<00:02, 85.55it/s] 57%|█████▋    | 313/553 [00:02<00:02, 82.62it/s] 58%|█████▊    | 323/553 [00:02<00:02, 85.82it/s] 60%|██████    | 334/553 [00:03<00:02, 90.73it/s] 62%|██████▏   | 345/553 [00:03<00:02, 94.08it/s] 64%|██████▍   | 355/553 [00:03<00:02, 77.60it/s] 66%|██████▌   | 364/553 [00:03<00:02, 72.96it/s] 68%|██████▊   | 378/553 [00:03<00:01, 88.10it/s] 70%|███████   | 388/553 [00:03<00:01, 86.32it/s] 72%|███████▏  | 399/553 [00:03<00:01, 89.70it/s] 75%|███████▌  | 415/553 [00:03<00:01, 104.87it/s] 77%|███████▋  | 426/553 [00:04<00:01, 101.62it/s] 80%|███████▉  | 440/553 [00:04<00:01, 111.65it/s] 83%|████████▎ | 457/553 [00:04<00:00, 126.71it/s] 85%|████████▍ | 470/553 [00:04<00:00, 127.30it/s] 88%|████████▊ | 484/553 [00:04<00:00, 129.01it/s] 90%|█████████ | 498/553 [00:04<00:00, 118.63it/s] 93%|█████████▎| 512/553 [00:04<00:00, 122.86it/s] 95%|█████████▍| 525/553 [00:04<00:00, 113.39it/s] 97%|█████████▋| 537/553 [00:04<00:00, 102.54it/s]100%|█████████▉| 551/553 [00:05<00:00, 89.49it/s] 100%|██████████| 553/553 [00:05<00:00, 106.62it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 16/139 [00:00<00:00, 158.44it/s]extract the null data:  43%|████▎     | 60/139 [00:00<00:00, 321.73it/s]extract the null data:  67%|██████▋   | 93/139 [00:00<00:00, 298.08it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 339.94it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:   9%|▉         | 13/139 [00:00<00:00, 126.43it/s]replace nan value:  23%|██▎       | 32/139 [00:00<00:00, 160.74it/s]replace nan value:  35%|███▌      | 49/139 [00:00<00:00, 142.67it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 139.84it/s]replace nan value:  60%|█████▉    | 83/139 [00:00<00:00, 136.19it/s]replace nan value:  70%|██████▉   | 97/139 [00:00<00:00, 100.47it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 101.23it/s]replace nan value:  89%|████████▉ | 124/139 [00:01<00:00, 109.36it/s]replace nan value:  98%|█████████▊| 136/139 [00:01<00:00, 111.81it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 119.12it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.52it/s] 17%|█▋        | 24/139 [00:00<00:01, 96.19it/s]  24%|██▍       | 34/139 [00:00<00:01, 86.51it/s] 32%|███▏      | 44/139 [00:00<00:01, 83.47it/s] 38%|███▊      | 53/139 [00:00<00:01, 71.19it/s] 44%|████▍     | 61/139 [00:00<00:01, 68.63it/s] 50%|█████     | 70/139 [00:00<00:00, 70.44it/s] 56%|█████▌    | 78/139 [00:01<00:00, 65.94it/s] 61%|██████    | 85/139 [00:01<00:00, 65.07it/s] 66%|██████▌   | 92/139 [00:01<00:00, 57.63it/s] 71%|███████   | 99/139 [00:01<00:00, 58.92it/s] 77%|███████▋  | 107/139 [00:01<00:00, 60.88it/s] 83%|████████▎ | 115/139 [00:01<00:00, 65.61it/s] 89%|████████▉ | 124/139 [00:01<00:00, 67.53it/s] 94%|█████████▍| 131/139 [00:01<00:00, 63.81it/s] 99%|█████████▉| 138/139 [00:02<00:00, 64.03it/s]100%|██████████| 139/139 [00:02<00:00, 68.62it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:22,  7.65it/s]extract the null data:  25%|██▍       | 43/173 [00:00<00:00, 222.05it/s]extract the null data:  50%|████▉     | 86/173 [00:00<00:00, 309.85it/s]extract the null data:  77%|███████▋  | 134/173 [00:00<00:00, 373.22it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 332.49it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   9%|▊         | 15/173 [00:00<00:01, 149.57it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 168.67it/s]replace nan value:  29%|██▉       | 51/173 [00:00<00:00, 154.91it/s]replace nan value:  39%|███▊      | 67/173 [00:00<00:00, 133.81it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 128.09it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 116.23it/s]replace nan value:  62%|██████▏   | 107/173 [00:00<00:00, 109.40it/s]replace nan value:  69%|██████▉   | 119/173 [00:01<00:00, 98.63it/s] replace nan value:  76%|███████▌  | 131/173 [00:01<00:00, 103.67it/s]replace nan value:  82%|████████▏ | 142/173 [00:01<00:00, 99.64it/s] replace nan value:  88%|████████▊ | 153/173 [00:01<00:00, 96.10it/s]replace nan value:  95%|█████████▍| 164/173 [00:01<00:00, 94.51it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 109.90it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▍         | 8/173 [00:00<00:02, 79.92it/s] 11%|█         | 19/173 [00:00<00:01, 93.44it/s] 17%|█▋        | 29/173 [00:00<00:01, 90.15it/s] 26%|██▌       | 45/173 [00:00<00:01, 114.87it/s] 35%|███▍      | 60/173 [00:00<00:00, 124.59it/s] 43%|████▎     | 75/173 [00:00<00:00, 128.72it/s] 53%|█████▎    | 91/173 [00:00<00:00, 137.83it/s] 61%|██████    | 105/173 [00:00<00:00, 124.10it/s] 68%|██████▊   | 118/173 [00:01<00:00, 108.23it/s] 75%|███████▌  | 130/173 [00:01<00:00, 109.56it/s] 82%|████████▏ | 142/173 [00:01<00:00, 109.48it/s] 89%|████████▉ | 154/173 [00:01<00:00, 92.80it/s]  95%|█████████▍| 164/173 [00:01<00:00, 94.33it/s]100%|██████████| 173/173 [00:01<00:00, 99.25it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.016, train acc : 0.488, valid acc : 0.084, train f1 : 0.364, valid f1 : 0.078
training process:   1%|          | 1/128 [01:35<3:23:05, 95.95s/it]Best score increase :0.000 -> 0.078
training process:   2%|▏         | 2/128 [02:46<2:50:11, 81.05s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:58<2:39:42, 76.66s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [05:09<2:34:06, 74.57s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.005, valid loss : 0.016, train acc : 0.512, valid acc : 0.143, train f1 : 0.360, valid f1 : 0.142
training process:   4%|▍         | 5/128 [06:33<2:40:16, 78.18s/it]Best score increase :0.078 -> 0.142
training process:   5%|▍         | 6/128 [07:46<2:35:01, 76.24s/it]Best score increase :0.142 -> 0.332
training process:   5%|▌         | 7/128 [08:59<2:31:32, 75.14s/it]Best score increase :0.332 -> 0.362
training process:   6%|▋         | 8/128 [10:13<2:29:53, 74.95s/it]Best score increase :0.362 -> 0.379
epoch : 9, train loss : 0.004, valid loss : 0.015, train acc : 0.700, valid acc : 0.400, train f1 : 0.671, valid f1 : 0.365
training process:   7%|▋         | 9/128 [11:37<2:33:45, 77.53s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [12:49<2:29:06, 75.82s/it]Best score increase :0.379 -> 0.384
training process:   9%|▊         | 11/128 [14:03<2:27:06, 75.44s/it]Best score increase :0.384 -> 0.438
training process:   9%|▉         | 12/128 [15:11<2:21:20, 73.11s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.013, train acc : 0.744, valid acc : 0.531, train f1 : 0.726, valid f1 : 0.457
training process:  10%|█         | 13/128 [16:32<2:24:47, 75.55s/it]Best score increase :0.438 -> 0.457
training process:  11%|█         | 14/128 [17:47<2:23:23, 75.47s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [18:53<2:16:46, 72.63s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [20:00<2:12:07, 70.78s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.011, train acc : 0.765, valid acc : 0.616, train f1 : 0.754, valid f1 : 0.516
training process:  13%|█▎        | 17/128 [21:26<2:19:23, 75.34s/it]Best score increase :0.457 -> 0.516
training process:  14%|█▍        | 18/128 [22:31<2:12:36, 72.33s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [23:36<2:07:03, 69.94s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [24:38<2:02:05, 67.83s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.012, train acc : 0.789, valid acc : 0.576, train f1 : 0.780, valid f1 : 0.489
training process:  16%|█▋        | 21/128 [25:52<2:04:15, 69.68s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [27:04<2:03:57, 70.17s/it]Best score increase :0.516 -> 0.524
training process:  18%|█▊        | 23/128 [28:15<2:03:27, 70.55s/it]Best score increase :0.524 -> 0.534
training process:  19%|█▉        | 24/128 [29:31<2:04:48, 72.00s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.011, train acc : 0.805, valid acc : 0.628, train f1 : 0.797, valid f1 : 0.525
training process:  20%|█▉        | 25/128 [30:53<2:08:55, 75.10s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [32:05<2:05:59, 74.11s/it]Best score increase :0.534 -> 0.537
training process:  21%|██        | 27/128 [33:13<2:02:02, 72.50s/it]Best score increase :0.537 -> 0.546
training process:  22%|██▏       | 28/128 [34:20<1:58:03, 70.84s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.010, train acc : 0.822, valid acc : 0.674, train f1 : 0.817, valid f1 : 0.558
training process:  23%|██▎       | 29/128 [35:40<2:01:19, 73.53s/it]Best score increase :0.546 -> 0.558
training process:  23%|██▎       | 30/128 [36:52<1:59:08, 72.95s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [37:53<1:52:01, 69.30s/it]EarlyStopping counter : 2 out of 12
training process:  25%|██▌       | 32/128 [38:55<1:47:31, 67.20s/it]Best score increase :0.558 -> 0.567
epoch : 33, train loss : 0.002, valid loss : 0.011, train acc : 0.835, valid acc : 0.645, train f1 : 0.830, valid f1 : 0.536
training process:  26%|██▌       | 33/128 [40:10<1:50:14, 69.63s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [41:12<1:45:24, 67.29s/it]Best score increase :0.567 -> 0.609
training process:  27%|██▋       | 35/128 [42:16<1:42:46, 66.30s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [43:20<1:40:40, 65.66s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.009, train acc : 0.843, valid acc : 0.716, train f1 : 0.840, valid f1 : 0.590
training process:  29%|██▉       | 37/128 [44:34<1:43:18, 68.11s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [45:39<1:40:50, 67.23s/it]Best score increase :0.609 -> 0.612
training process:  30%|███       | 39/128 [46:52<1:42:22, 69.02s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [47:55<1:38:22, 67.07s/it]Best score increase :0.612 -> 0.621
epoch : 41, train loss : 0.002, valid loss : 0.011, train acc : 0.853, valid acc : 0.651, train f1 : 0.850, valid f1 : 0.541
training process:  32%|███▏      | 41/128 [49:08<1:39:54, 68.90s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [50:12<1:36:34, 67.37s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [51:14<1:33:24, 65.94s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [52:19<1:31:44, 65.53s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.010, train acc : 0.858, valid acc : 0.663, train f1 : 0.856, valid f1 : 0.550
training process:  35%|███▌      | 45/128 [53:34<1:34:21, 68.22s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [54:42<1:33:21, 68.31s/it]Best score increase :0.621 -> 0.657
training process:  37%|███▋      | 47/128 [55:53<1:33:13, 69.05s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [57:07<1:34:10, 70.63s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.009, train acc : 0.868, valid acc : 0.759, train f1 : 0.866, valid f1 : 0.624
training process:  38%|███▊      | 49/128 [58:32<1:38:40, 74.94s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [59:36<1:33:03, 71.59s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [1:00:38<1:28:15, 68.77s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [1:01:44<1:26:04, 67.95s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.009, train acc : 0.871, valid acc : 0.765, train f1 : 0.869, valid f1 : 0.629
training process:  41%|████▏     | 53/128 [1:03:01<1:28:12, 70.56s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [1:04:07<1:25:17, 69.16s/it]EarlyStopping counter : 8 out of 12
training process:  43%|████▎     | 55/128 [1:05:05<1:20:16, 65.98s/it]EarlyStopping counter : 9 out of 12
training process:  44%|████▍     | 56/128 [1:06:10<1:18:34, 65.48s/it]EarlyStopping counter : 10 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.009, train acc : 0.870, valid acc : 0.762, train f1 : 0.869, valid f1 : 0.626
training process:  45%|████▍     | 57/128 [1:07:25<1:20:52, 68.34s/it]EarlyStopping counter : 11 out of 12
training process:  45%|████▍     | 57/128 [1:08:44<1:25:38, 72.37s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 57, best f1 score : 0.657
training process finished, best loss : 0.008 and best acc : 0.797, best f1 : 0.657, best epoch : 51

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.27      0.92      0.42       580
           1       0.99      0.79      0.88      6818

    accuracy                           0.80      7398
   macro avg       0.63      0.86      0.65      7398
weighted avg       0.94      0.80      0.84      7398


# test acc : 0.80, test f1 : 0.65, test AUC : 0.86, test loss : 0.501

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:39,  9.02s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:36,  9.63s/it]processing for feature importance:  25%|██▌       | 3/12 [00:29<01:31, 10.18s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:16,  9.62s/it]processing for feature importance:  42%|████▏     | 5/12 [00:48<01:07,  9.66s/it]processing for feature importance:  50%|█████     | 6/12 [00:57<00:57,  9.54s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:07<00:48,  9.71s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:18<00:40, 10.05s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:28<00:30, 10.01s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:38<00:20, 10.09s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:48<00:10, 10.12s/it]processing for feature importance: 100%|██████████| 12/12 [01:59<00:00, 10.21s/it]processing for feature importance: 100%|██████████| 12/12 [01:59<00:00,  9.95s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 15%|█▌        | 46/306 [00:00<00:00, 455.52it/s] 32%|███▏      | 98/306 [00:00<00:00, 491.30it/s] 48%|████▊     | 148/306 [00:00<00:00, 491.27it/s] 65%|██████▍   | 198/306 [00:00<00:00, 472.40it/s] 80%|████████  | 246/306 [00:00<00:00, 390.78it/s] 95%|█████████▌| 291/306 [00:00<00:00, 407.71it/s]100%|██████████| 306/306 [00:00<00:00, 430.19it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 42/553 [00:00<00:01, 419.13it/s]extract the null data:  15%|█▌        | 84/553 [00:00<00:01, 407.27it/s]extract the null data:  23%|██▎       | 125/553 [00:00<00:01, 387.82it/s]extract the null data:  30%|██▉       | 165/553 [00:00<00:00, 391.62it/s]extract the null data:  37%|███▋      | 205/553 [00:00<00:00, 374.89it/s]extract the null data:  44%|████▍     | 243/553 [00:00<00:00, 365.83it/s]extract the null data:  52%|█████▏    | 285/553 [00:00<00:00, 382.40it/s]extract the null data:  59%|█████▊    | 324/553 [00:00<00:00, 384.16it/s]extract the null data:  66%|██████▌   | 365/553 [00:00<00:00, 391.45it/s]extract the null data:  73%|███████▎  | 405/553 [00:01<00:00, 391.35it/s]extract the null data:  80%|████████  | 445/553 [00:01<00:00, 392.98it/s]extract the null data:  88%|████████▊ | 488/553 [00:01<00:00, 401.75it/s]extract the null data:  96%|█████████▌| 529/553 [00:01<00:00, 398.42it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 390.53it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:04, 132.27it/s]replace nan value:   5%|▌         | 29/553 [00:00<00:04, 129.12it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:03, 143.53it/s]replace nan value:  11%|█         | 62/553 [00:00<00:03, 149.43it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:03, 151.01it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:02, 154.59it/s]replace nan value:  20%|██        | 112/553 [00:00<00:02, 157.46it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 158.06it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 157.58it/s]replace nan value:  29%|██▉       | 161/553 [00:01<00:02, 159.94it/s]replace nan value:  32%|███▏      | 178/553 [00:01<00:02, 159.46it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:02, 162.52it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:02, 163.49it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 163.46it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 165.38it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 163.43it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 160.42it/s]replace nan value:  54%|█████▍    | 298/553 [00:01<00:01, 161.40it/s]replace nan value:  57%|█████▋    | 315/553 [00:01<00:01, 161.78it/s]replace nan value:  60%|██████    | 332/553 [00:02<00:01, 155.59it/s]replace nan value:  63%|██████▎   | 349/553 [00:02<00:01, 158.69it/s]replace nan value:  66%|██████▌   | 365/553 [00:02<00:01, 158.15it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:01, 157.53it/s]replace nan value:  72%|███████▏  | 397/553 [00:02<00:00, 158.02it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 158.97it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 158.63it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 160.06it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 159.78it/s]replace nan value:  87%|████████▋ | 481/553 [00:03<00:00, 160.19it/s]replace nan value:  90%|█████████ | 498/553 [00:03<00:00, 161.22it/s]replace nan value:  93%|█████████▎| 515/553 [00:03<00:00, 160.97it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 158.69it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 159.68it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 158.00it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.77it/s]  5%|▍         | 26/553 [00:00<00:04, 129.53it/s]  7%|▋         | 40/553 [00:00<00:03, 128.63it/s] 10%|▉         | 53/553 [00:00<00:04, 117.78it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.01it/s] 14%|█▍        | 78/553 [00:00<00:04, 112.86it/s] 16%|█▋        | 91/553 [00:00<00:04, 115.45it/s] 19%|█▊        | 103/553 [00:00<00:03, 116.35it/s] 22%|██▏       | 119/553 [00:00<00:03, 128.10it/s] 24%|██▍       | 132/553 [00:01<00:03, 122.92it/s] 27%|██▋       | 148/553 [00:01<00:03, 133.36it/s] 29%|██▉       | 163/553 [00:01<00:02, 136.42it/s] 32%|███▏      | 178/553 [00:01<00:02, 138.04it/s] 35%|███▍      | 193/553 [00:01<00:02, 141.22it/s] 38%|███▊      | 210/553 [00:01<00:02, 146.59it/s] 41%|████      | 225/553 [00:01<00:02, 137.13it/s] 43%|████▎     | 239/553 [00:01<00:02, 137.05it/s] 46%|████▌     | 253/553 [00:01<00:02, 132.91it/s] 48%|████▊     | 267/553 [00:02<00:02, 129.38it/s] 51%|█████     | 281/553 [00:02<00:02, 128.50it/s] 53%|█████▎    | 294/553 [00:02<00:02, 124.74it/s] 56%|█████▌    | 307/553 [00:02<00:02, 120.13it/s] 58%|█████▊    | 320/553 [00:02<00:01, 118.50it/s] 60%|██████    | 332/553 [00:02<00:02, 103.87it/s] 62%|██████▏   | 345/553 [00:02<00:01, 110.11it/s] 65%|██████▍   | 357/553 [00:02<00:01, 109.20it/s] 67%|██████▋   | 371/553 [00:02<00:01, 117.25it/s] 69%|██████▉   | 384/553 [00:03<00:01, 118.64it/s] 72%|███████▏  | 397/553 [00:03<00:01, 105.48it/s] 75%|███████▍  | 412/553 [00:03<00:01, 116.62it/s] 77%|███████▋  | 425/553 [00:03<00:01, 104.80it/s] 79%|███████▉  | 438/553 [00:03<00:01, 110.99it/s] 82%|████████▏ | 454/553 [00:03<00:00, 122.46it/s] 85%|████████▍ | 469/553 [00:03<00:00, 122.93it/s] 87%|████████▋ | 482/553 [00:03<00:00, 120.80it/s] 90%|████████▉ | 495/553 [00:04<00:00, 111.59it/s] 92%|█████████▏| 508/553 [00:04<00:00, 115.68it/s] 94%|█████████▍| 521/553 [00:04<00:00, 114.47it/s] 96%|█████████▋| 533/553 [00:04<00:00, 101.73it/s] 99%|█████████▉| 548/553 [00:04<00:00, 112.95it/s]100%|██████████| 553/553 [00:04<00:00, 118.18it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 21/139 [00:00<00:00, 209.49it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 429.55it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 469.64it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 206.74it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 218.53it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 215.16it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 214.54it/s]replace nan value:  80%|███████▉  | 111/139 [00:00<00:00, 216.75it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 212.72it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 213.75it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.18it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.61it/s] 29%|██▉       | 41/139 [00:00<00:00, 137.60it/s] 40%|███▉      | 55/139 [00:00<00:00, 126.73it/s] 49%|████▉     | 68/139 [00:00<00:00, 127.57it/s] 58%|█████▊    | 81/139 [00:00<00:00, 124.64it/s] 68%|██████▊   | 94/139 [00:00<00:00, 112.26it/s] 77%|███████▋  | 107/139 [00:00<00:00, 114.91it/s] 88%|████████▊ | 122/139 [00:00<00:00, 124.31it/s] 97%|█████████▋| 135/139 [00:01<00:00, 121.68it/s]100%|██████████| 139/139 [00:01<00:00, 123.82it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 25/173 [00:00<00:00, 249.90it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 470.22it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 539.55it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 508.80it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 173.85it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 193.63it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 198.08it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 200.73it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 208.87it/s]replace nan value:  72%|███████▏  | 125/173 [00:00<00:00, 207.61it/s]replace nan value:  84%|████████▍ | 146/173 [00:00<00:00, 207.17it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 204.52it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 202.23it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 134.45it/s] 16%|█▌        | 28/173 [00:00<00:01, 117.92it/s] 25%|██▍       | 43/173 [00:00<00:01, 129.28it/s] 35%|███▌      | 61/173 [00:00<00:00, 144.00it/s] 44%|████▍     | 76/173 [00:00<00:00, 145.21it/s] 53%|█████▎    | 92/173 [00:00<00:00, 146.54it/s] 62%|██████▏   | 108/173 [00:00<00:00, 148.50it/s] 71%|███████   | 123/173 [00:00<00:00, 145.17it/s] 80%|███████▉  | 138/173 [00:00<00:00, 146.37it/s] 88%|████████▊ | 153/173 [00:01<00:00, 139.68it/s] 97%|█████████▋| 168/173 [00:01<00:00, 111.79it/s]100%|██████████| 173/173 [00:01<00:00, 127.40it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.008, train f1 : 0.514, valid f1 : 0.521
training process - Deferred Re-weighting:   1%|          | 1/128 [01:02<2:12:58, 62.83s/it]Best score increase :0.000 -> 0.521
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:53<1:56:43, 55.58s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:50<1:57:21, 56.33s/it]Best score increase :0.521 -> 0.566
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:48<1:57:32, 56.87s/it]Best score increase :0.566 -> 0.687
epoch : 5, train loss : 0.004, valid loss : 0.004, train f1 : 0.711, valid f1 : 0.744
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:55<2:04:19, 60.65s/it]Best score increase :0.687 -> 0.744
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:57<2:04:05, 61.03s/it]Best score increase :0.744 -> 0.769
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:51<1:58:50, 58.93s/it]Best score increase :0.769 -> 0.796
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:51<1:58:12, 59.11s/it]Best score increase :0.796 -> 0.811
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.803, valid f1 : 0.802
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:59<2:02:36, 61.82s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:55<1:58:15, 60.13s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:51<1:54:36, 58.77s/it]Best score increase :0.811 -> 0.825
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:53<1:55:22, 59.68s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.003, train f1 : 0.826, valid f1 : 0.816
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:00<1:58:54, 62.04s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:57<1:54:48, 60.42s/it]Best score increase :0.825 -> 0.834
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:53<1:51:30, 59.21s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:01<1:55:36, 61.93s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.832, valid f1 : 0.830
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:21<2:04:13, 67.15s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:24<2:00:51, 65.92s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:22<1:55:30, 63.58s/it]Best score increase :0.834 -> 0.841
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:24<1:53:47, 63.21s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train f1 : 0.841, valid f1 : 0.824
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [21:33<1:55:52, 64.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [22:31<1:50:52, 62.76s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [23:22<1:43:47, 59.31s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [24:15<1:39:16, 57.28s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.002, train f1 : 0.849, valid f1 : 0.846
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [25:09<1:36:52, 56.43s/it]Best score increase :0.841 -> 0.846
training process - Deferred Re-weighting:  20%|██        | 26/128 [25:57<1:31:19, 53.72s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [26:47<1:28:45, 52.73s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [27:38<1:26:50, 52.10s/it]Best score increase :0.846 -> 0.856
epoch : 29, train loss : 0.002, valid loss : 0.002, train f1 : 0.848, valid f1 : 0.851
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [28:36<1:28:51, 53.86s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [29:23<1:24:51, 51.96s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [30:13<1:23:12, 51.47s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [31:06<1:23:04, 51.92s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.002, train f1 : 0.855, valid f1 : 0.849
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [31:58<1:22:15, 51.95s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [32:45<1:18:58, 50.41s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [33:29<1:14:52, 48.31s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [34:13<1:12:08, 47.05s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.002, train f1 : 0.860, valid f1 : 0.854
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [35:10<1:15:49, 50.00s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [36:05<1:17:13, 51.48s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [37:04<1:19:44, 53.76s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [38:01<1:20:15, 54.72s/it]Best score increase :0.856 -> 0.857
epoch : 41, train loss : 0.002, valid loss : 0.002, train f1 : 0.864, valid f1 : 0.855
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [39:03<1:22:47, 57.10s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [39:56<1:20:05, 55.87s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [40:53<1:19:39, 56.22s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [41:48<1:17:57, 55.68s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.002, train f1 : 0.867, valid f1 : 0.863
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [42:49<1:19:12, 57.26s/it]Best score increase :0.857 -> 0.863
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [43:47<1:18:43, 57.61s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [44:45<1:17:52, 57.69s/it]Best score increase :0.863 -> 0.865
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [45:38<1:15:01, 56.27s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.002, train f1 : 0.871, valid f1 : 0.863
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [46:46<1:18:36, 59.70s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [47:36<1:13:56, 56.87s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [48:24<1:09:38, 54.27s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [49:12<1:06:29, 52.49s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.002, train f1 : 0.871, valid f1 : 0.847
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [50:12<1:08:25, 54.74s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [51:02<1:05:42, 53.28s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [51:53<1:03:45, 52.41s/it]Best score increase :0.865 -> 0.873
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [52:44<1:02:27, 52.04s/it]EarlyStopping counter : 1 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.002, train f1 : 0.876, valid f1 : 0.855
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [53:45<1:04:41, 54.66s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [54:42<1:04:36, 55.38s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [55:32<1:01:50, 53.78s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [56:21<59:31, 52.52s/it]  EarlyStopping counter : 5 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.002, train f1 : 0.877, valid f1 : 0.877
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [57:18<1:00:07, 53.84s/it]Best score increase :0.873 -> 0.877
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [58:06<57:21, 52.14s/it]  EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [58:55<55:22, 51.12s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [59:46<54:21, 50.97s/it]EarlyStopping counter : 3 out of 12
epoch : 65, train loss : 0.002, valid loss : 0.002, train f1 : 0.881, valid f1 : 0.860
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:00:45<56:17, 53.61s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:01:38<54:59, 53.22s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:02:30<53:53, 53.00s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:03:18<51:32, 51.55s/it]EarlyStopping counter : 7 out of 12
epoch : 69, train loss : 0.002, valid loss : 0.002, train f1 : 0.881, valid f1 : 0.870
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:04:19<53:20, 54.25s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:05:12<52:07, 53.93s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:06:02<49:58, 52.61s/it]Best score increase :0.877 -> 0.879
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:06:52<48:28, 51.95s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.002, valid loss : 0.002, train f1 : 0.887, valid f1 : 0.879
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:07:52<49:48, 54.33s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:08:46<48:47, 54.22s/it]Best score increase :0.879 -> 0.881
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:09:34<46:12, 52.32s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:10:25<45:02, 51.98s/it]EarlyStopping counter : 2 out of 12
epoch : 77, train loss : 0.002, valid loss : 0.002, train f1 : 0.887, valid f1 : 0.868
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:11:22<45:31, 53.55s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:12:10<43:14, 51.88s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  62%|██████▏   | 79/128 [1:13:04<42:56, 52.58s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  62%|██████▎   | 80/128 [1:13:56<41:56, 52.42s/it]EarlyStopping counter : 6 out of 12
epoch : 81, train loss : 0.002, valid loss : 0.002, train f1 : 0.889, valid f1 : 0.873
training process - Deferred Re-weighting:  63%|██████▎   | 81/128 [1:14:53<41:57, 53.57s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  64%|██████▍   | 82/128 [1:15:45<40:46, 53.18s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  65%|██████▍   | 83/128 [1:16:33<38:47, 51.72s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  66%|██████▌   | 84/128 [1:17:21<37:06, 50.59s/it]EarlyStopping counter : 10 out of 12
epoch : 85, train loss : 0.002, valid loss : 0.002, train f1 : 0.882, valid f1 : 0.865
training process - Deferred Re-weighting:  66%|██████▋   | 85/128 [1:18:29<40:02, 55.88s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  66%|██████▋   | 85/128 [1:19:28<40:12, 56.10s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 85, best f1 score : 0.881
training process finished, best loss : 0.002, best acc : 0.965, best f1 : 0.881, best epoch : 73

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.74      0.69       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.85      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.85, test loss : 0.168

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:52, 10.27s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:36,  9.66s/it]processing for feature importance:  25%|██▌       | 3/12 [00:29<01:30, 10.01s/it]processing for feature importance:  33%|███▎      | 4/12 [00:39<01:19,  9.98s/it]processing for feature importance:  42%|████▏     | 5/12 [00:49<01:09,  9.98s/it]processing for feature importance:  50%|█████     | 6/12 [01:00<01:01, 10.25s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:11<00:51, 10.35s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:21<00:40, 10.20s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:31<00:30, 10.33s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:42<00:20, 10.38s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:52<00:10, 10.23s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.71s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.32s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 16%|█▋        | 50/306 [00:00<00:00, 499.45it/s] 34%|███▍      | 104/306 [00:00<00:00, 522.38it/s] 51%|█████▏    | 157/306 [00:00<00:00, 525.18it/s] 69%|██████▊   | 210/306 [00:00<00:00, 516.68it/s] 86%|████████▌ | 262/306 [00:00<00:00, 502.23it/s]100%|██████████| 306/306 [00:00<00:00, 514.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 485.21it/s]extract the null data:  18%|█▊        | 98/553 [00:00<00:00, 478.25it/s]extract the null data:  26%|██▋       | 146/553 [00:00<00:00, 420.26it/s]extract the null data:  36%|███▌      | 198/553 [00:00<00:00, 455.32it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 477.90it/s]extract the null data:  54%|█████▍    | 300/553 [00:00<00:00, 478.86it/s]extract the null data:  63%|██████▎   | 349/553 [00:00<00:00, 459.78it/s]extract the null data:  72%|███████▏  | 399/553 [00:00<00:00, 469.87it/s]extract the null data:  81%|████████  | 448/553 [00:00<00:00, 475.23it/s]extract the null data:  90%|████████▉ | 496/553 [00:01<00:00, 476.25it/s]extract the null data:  98%|█████████▊| 544/553 [00:01<00:00, 449.78it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 461.09it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.71it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.61it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 158.13it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 162.38it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 166.02it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 167.56it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:02, 170.23it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 171.33it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:02, 172.72it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:02, 174.34it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:02, 175.04it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:01, 174.68it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:01, 173.97it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 172.31it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 172.45it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 171.60it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 170.64it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 171.00it/s]replace nan value:  61%|██████    | 338/553 [00:01<00:01, 171.03it/s]replace nan value:  64%|██████▍   | 356/553 [00:02<00:01, 162.67it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:01, 157.60it/s]replace nan value:  71%|███████   | 390/553 [00:02<00:01, 160.08it/s]replace nan value:  74%|███████▍  | 408/553 [00:02<00:00, 163.59it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 164.69it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 167.74it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 169.68it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 171.80it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 175.59it/s]replace nan value:  93%|█████████▎| 516/553 [00:03<00:00, 154.50it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 149.76it/s]replace nan value:  99%|█████████▉| 550/553 [00:03<00:00, 156.78it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 166.06it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 126.57it/s]  5%|▍         | 27/553 [00:00<00:03, 133.33it/s]  7%|▋         | 41/553 [00:00<00:03, 130.75it/s] 10%|▉         | 55/553 [00:00<00:04, 120.03it/s] 12%|█▏        | 68/553 [00:00<00:04, 105.52it/s] 15%|█▍        | 82/553 [00:00<00:04, 115.11it/s] 17%|█▋        | 94/553 [00:00<00:04, 107.49it/s] 20%|█▉        | 108/553 [00:00<00:03, 116.43it/s] 22%|██▏       | 122/553 [00:01<00:03, 119.41it/s] 25%|██▍       | 138/553 [00:01<00:03, 129.35it/s] 28%|██▊       | 155/553 [00:01<00:02, 140.05it/s] 31%|███       | 171/553 [00:01<00:02, 145.24it/s] 34%|███▎      | 186/553 [00:01<00:02, 143.12it/s] 37%|███▋      | 202/553 [00:01<00:02, 141.05it/s] 39%|███▉      | 217/553 [00:01<00:02, 126.22it/s] 42%|████▏     | 230/553 [00:01<00:02, 124.61it/s] 44%|████▍     | 244/553 [00:01<00:02, 127.83it/s] 47%|████▋     | 259/553 [00:02<00:02, 133.43it/s] 49%|████▉     | 273/553 [00:02<00:02, 123.36it/s] 52%|█████▏    | 286/553 [00:02<00:02, 121.89it/s] 54%|█████▍    | 299/553 [00:02<00:02, 117.73it/s] 56%|█████▌    | 311/553 [00:02<00:02, 116.45it/s] 59%|█████▊    | 324/553 [00:02<00:01, 119.18it/s] 61%|██████    | 337/553 [00:02<00:01, 122.14it/s] 63%|██████▎   | 350/553 [00:02<00:01, 122.38it/s] 66%|██████▌   | 363/553 [00:02<00:01, 108.57it/s] 68%|██████▊   | 377/553 [00:03<00:01, 116.04it/s] 70%|███████   | 389/553 [00:03<00:01, 112.31it/s] 73%|███████▎  | 401/553 [00:03<00:01, 107.22it/s] 75%|███████▌  | 415/553 [00:03<00:01, 115.16it/s] 77%|███████▋  | 427/553 [00:03<00:01, 108.33it/s] 80%|███████▉  | 442/553 [00:03<00:00, 119.36it/s] 82%|████████▏ | 456/553 [00:03<00:00, 124.31it/s] 85%|████████▍ | 470/553 [00:03<00:00, 125.54it/s] 87%|████████▋ | 483/553 [00:03<00:00, 126.58it/s] 90%|████████▉ | 496/553 [00:04<00:00, 116.77it/s] 92%|█████████▏| 511/553 [00:04<00:00, 125.10it/s] 95%|█████████▍| 524/553 [00:04<00:00, 115.39it/s] 97%|█████████▋| 536/553 [00:04<00:00, 108.60it/s]100%|█████████▉| 551/553 [00:04<00:00, 99.71it/s] 100%|██████████| 553/553 [00:04<00:00, 119.32it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 25/139 [00:00<00:00, 249.15it/s]extract the null data:  58%|█████▊    | 81/139 [00:00<00:00, 429.46it/s]extract the null data:  98%|█████████▊| 136/139 [00:00<00:00, 482.25it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 451.79it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 202.64it/s]replace nan value:  31%|███       | 43/139 [00:00<00:00, 209.05it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 204.26it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 202.12it/s]replace nan value:  76%|███████▋  | 106/139 [00:00<00:00, 199.39it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 195.74it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 197.64it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.55it/s] 17%|█▋        | 24/139 [00:00<00:00, 117.78it/s] 27%|██▋       | 38/139 [00:00<00:00, 124.41it/s] 37%|███▋      | 51/139 [00:00<00:00, 120.68it/s] 46%|████▌     | 64/139 [00:00<00:00, 105.72it/s] 55%|█████▌    | 77/139 [00:00<00:00, 112.32it/s] 64%|██████▍   | 89/139 [00:00<00:00, 108.01it/s] 76%|███████▌  | 105/139 [00:00<00:00, 117.84it/s] 88%|████████▊ | 122/139 [00:01<00:00, 128.32it/s] 97%|█████████▋| 135/139 [00:01<00:00, 128.11it/s]100%|██████████| 139/139 [00:01<00:00, 121.46it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|██        | 35/173 [00:00<00:00, 349.45it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 477.87it/s]extract the null data:  85%|████████▍ | 147/173 [00:00<00:00, 508.10it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 492.33it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 183.74it/s]replace nan value:  24%|██▎       | 41/173 [00:00<00:00, 200.18it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 208.00it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 209.16it/s]replace nan value:  61%|██████▏   | 106/173 [00:00<00:00, 208.84it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 180.12it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 183.49it/s]replace nan value:  96%|█████████▌| 166/173 [00:00<00:00, 184.36it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 190.88it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 133.22it/s] 16%|█▌        | 28/173 [00:00<00:01, 107.99it/s] 24%|██▎       | 41/173 [00:00<00:01, 115.98it/s] 34%|███▍      | 59/173 [00:00<00:00, 136.97it/s] 43%|████▎     | 74/173 [00:00<00:00, 140.24it/s] 51%|█████▏    | 89/173 [00:00<00:00, 141.25it/s] 60%|██████    | 104/173 [00:00<00:00, 142.30it/s] 69%|██████▉   | 119/173 [00:00<00:00, 144.45it/s] 77%|███████▋  | 134/173 [00:00<00:00, 139.21it/s] 86%|████████▌ | 149/173 [00:01<00:00, 133.93it/s] 94%|█████████▍| 163/173 [00:01<00:00, 127.67it/s]100%|██████████| 173/173 [00:01<00:00, 117.08it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : 0.010, train f1 : 0.647, valid f1 : 0.578
training process - Deferred Re-weighting:   1%|          | 1/128 [01:09<2:26:31, 69.22s/it]Best score increase :0.000 -> 0.578
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:06<2:11:01, 62.40s/it]Best score increase :0.578 -> 0.621
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:06<2:06:58, 60.95s/it]Best score increase :0.621 -> 0.717
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:05<2:04:42, 60.34s/it]Best score increase :0.717 -> 0.752
epoch : 5, train loss : 0.007, valid loss : 0.006, train f1 : 0.839, valid f1 : 0.748
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:19<2:13:35, 65.17s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:18<2:08:10, 63.04s/it]Best score increase :0.752 -> 0.759
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:15<2:03:43, 61.35s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:15<2:01:37, 60.81s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.006, valid loss : 0.005, train f1 : 0.861, valid f1 : 0.789
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:20<2:03:13, 62.13s/it]Best score increase :0.759 -> 0.789
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:19<2:00:07, 61.08s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:16<1:56:26, 59.71s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:12<1:53:42, 58.81s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.006, train f1 : 0.871, valid f1 : 0.718
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:21<1:58:29, 61.82s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:20<1:55:44, 60.92s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:18<1:53:10, 60.09s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:15<1:50:23, 59.14s/it]EarlyStopping counter : 7 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.005, train f1 : 0.884, valid f1 : 0.743
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:24<1:54:58, 62.15s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:20<1:50:35, 60.32s/it]Best score increase :0.789 -> 0.791
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:15<1:46:43, 58.75s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:11<1:44:08, 57.86s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.005, train f1 : 0.892, valid f1 : 0.757
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [21:20<1:49:09, 61.21s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [22:21<1:48:05, 61.19s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [23:18<1:44:45, 59.86s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [24:14<1:41:45, 58.71s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.006, train f1 : 0.897, valid f1 : 0.722
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [25:23<1:46:08, 61.83s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [26:21<1:42:56, 60.55s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [27:19<1:40:54, 59.94s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [28:16<1:38:17, 58.98s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.005, train f1 : 0.906, valid f1 : 0.757
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [29:24<1:41:41, 61.63s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [30:32<1:44:15, 63.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 29, best f1 score : 0.791
training process finished, best loss : 0.004, best acc : 0.920, best f1 : 0.791, best epoch : 17

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.44      0.78      0.56       580
           1       0.98      0.91      0.95      6818

    accuracy                           0.90      7398
   macro avg       0.71      0.85      0.75      7398
weighted avg       0.94      0.90      0.92      7398


# test acc : 0.90, test f1 : 0.75, test AUC : 0.85, test loss : 0.261

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:05, 11.37s/it]processing for feature importance:  17%|█▋        | 2/12 [00:22<01:51, 11.17s/it]processing for feature importance:  25%|██▌       | 3/12 [00:33<01:39, 11.09s/it]processing for feature importance:  33%|███▎      | 4/12 [00:43<01:25, 10.73s/it]processing for feature importance:  42%|████▏     | 5/12 [00:54<01:14, 10.69s/it]processing for feature importance:  50%|█████     | 6/12 [01:02<00:59,  9.89s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:13<00:51, 10.24s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:23<00:41, 10.30s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:34<00:31, 10.49s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:45<00:21, 10.63s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:56<00:10, 10.59s/it]processing for feature importance: 100%|██████████| 12/12 [02:06<00:00, 10.36s/it]processing for feature importance: 100%|██████████| 12/12 [02:06<00:00, 10.51s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 17%|█▋        | 52/306 [00:00<00:00, 517.34it/s] 35%|███▌      | 108/306 [00:00<00:00, 541.37it/s] 53%|█████▎    | 163/306 [00:00<00:00, 508.64it/s] 72%|███████▏  | 221/306 [00:00<00:00, 533.69it/s] 91%|█████████ | 279/306 [00:00<00:00, 546.82it/s]100%|██████████| 306/306 [00:00<00:00, 538.58it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 42/553 [00:00<00:01, 414.17it/s]extract the null data:  15%|█▌        | 84/553 [00:00<00:01, 333.67it/s]extract the null data:  22%|██▏       | 119/553 [00:00<00:01, 319.11it/s]extract the null data:  30%|███       | 167/553 [00:00<00:01, 365.52it/s]extract the null data:  37%|███▋      | 205/553 [00:00<00:01, 336.92it/s]extract the null data:  43%|████▎     | 240/553 [00:00<00:00, 333.90it/s]extract the null data:  50%|████▉     | 274/553 [00:00<00:00, 318.16it/s]extract the null data:  56%|█████▌    | 307/553 [00:00<00:00, 304.77it/s]extract the null data:  61%|██████▏   | 339/553 [00:01<00:00, 308.84it/s]extract the null data:  73%|███████▎  | 402/553 [00:01<00:00, 398.54it/s]extract the null data:  84%|████████▍ | 465/553 [00:01<00:00, 463.14it/s]extract the null data:  95%|█████████▍| 524/553 [00:01<00:00, 499.71it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 396.10it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:02, 222.01it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 197.18it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:02, 201.71it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 205.02it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 207.74it/s]replace nan value:  24%|██▍       | 133/553 [00:00<00:02, 208.60it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:01, 210.15it/s]replace nan value:  32%|███▏      | 177/553 [00:00<00:01, 211.10it/s]replace nan value:  36%|███▌      | 199/553 [00:00<00:01, 194.37it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:02, 148.27it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:02, 129.23it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:02, 123.51it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:02, 114.56it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:02, 111.28it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:02, 107.91it/s]replace nan value:  55%|█████▍    | 302/553 [00:02<00:02, 108.84it/s]replace nan value:  57%|█████▋    | 314/553 [00:02<00:02, 105.84it/s]replace nan value:  59%|█████▉    | 325/553 [00:02<00:02, 106.64it/s]replace nan value:  61%|██████    | 336/553 [00:02<00:02, 102.71it/s]replace nan value:  63%|██████▎   | 347/553 [00:02<00:01, 104.11it/s]replace nan value:  66%|██████▌   | 364/553 [00:02<00:01, 121.35it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:01, 145.20it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 162.64it/s]replace nan value:  77%|███████▋  | 427/553 [00:02<00:00, 175.42it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 186.70it/s]replace nan value:  85%|████████▍ | 470/553 [00:03<00:00, 191.33it/s]replace nan value:  89%|████████▉ | 491/553 [00:03<00:00, 196.30it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 194.02it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 196.83it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 158.71it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 143.79it/s]  6%|▌         | 31/553 [00:00<00:03, 152.99it/s]  8%|▊         | 47/553 [00:00<00:03, 129.28it/s] 11%|█         | 61/553 [00:00<00:04, 122.85it/s] 14%|█▎        | 76/553 [00:00<00:03, 130.60it/s] 16%|█▋        | 91/553 [00:00<00:03, 132.61it/s] 19%|█▉        | 106/553 [00:00<00:03, 136.27it/s] 22%|██▏       | 120/553 [00:00<00:03, 130.66it/s] 24%|██▍       | 134/553 [00:01<00:03, 118.67it/s] 28%|██▊       | 153/553 [00:01<00:02, 136.05it/s] 31%|███       | 172/553 [00:01<00:02, 148.83it/s] 34%|███▍      | 188/553 [00:01<00:02, 148.58it/s] 38%|███▊      | 208/553 [00:01<00:02, 160.63it/s] 41%|████      | 225/553 [00:01<00:02, 153.98it/s] 44%|████▎     | 241/553 [00:01<00:02, 155.33it/s] 46%|████▋     | 257/553 [00:01<00:02, 118.71it/s] 49%|████▉     | 271/553 [00:02<00:02, 97.74it/s]  51%|█████     | 283/553 [00:02<00:02, 90.07it/s] 53%|█████▎    | 294/553 [00:02<00:03, 84.40it/s] 55%|█████▍    | 304/553 [00:02<00:02, 85.24it/s] 57%|█████▋    | 316/553 [00:02<00:02, 92.55it/s] 60%|█████▉    | 331/553 [00:02<00:02, 105.25it/s] 63%|██████▎   | 346/553 [00:02<00:01, 116.62it/s] 65%|██████▍   | 359/553 [00:02<00:01, 117.88it/s] 68%|██████▊   | 376/553 [00:03<00:01, 128.54it/s] 71%|███████   | 390/553 [00:03<00:01, 121.28it/s] 73%|███████▎  | 404/553 [00:03<00:01, 126.00it/s] 75%|███████▌  | 417/553 [00:03<00:01, 126.67it/s] 78%|███████▊  | 430/553 [00:03<00:01, 122.82it/s] 81%|████████  | 449/553 [00:03<00:00, 140.43it/s] 84%|████████▍ | 465/553 [00:03<00:00, 143.64it/s] 87%|████████▋ | 480/553 [00:03<00:00, 139.53it/s] 90%|████████▉ | 495/553 [00:03<00:00, 133.47it/s] 93%|█████████▎| 512/553 [00:04<00:00, 139.95it/s] 95%|█████████▌| 527/553 [00:04<00:00, 123.82it/s] 98%|█████████▊| 541/553 [00:04<00:00, 126.21it/s]100%|██████████| 553/553 [00:04<00:00, 122.77it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 328.73it/s]extract the null data:  70%|██████▉   | 97/139 [00:00<00:00, 507.31it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 509.75it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 209.42it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 209.18it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 208.96it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 201.59it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 196.87it/s]replace nan value:  92%|█████████▏| 128/139 [00:00<00:00, 206.58it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 198.09it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:01, 125.43it/s] 19%|█▉        | 27/139 [00:00<00:00, 127.78it/s] 29%|██▉       | 40/139 [00:00<00:00, 127.99it/s] 38%|███▊      | 53/139 [00:00<00:00, 117.39it/s] 50%|████▉     | 69/139 [00:00<00:00, 130.61it/s] 60%|█████▉    | 83/139 [00:00<00:00, 131.56it/s] 70%|██████▉   | 97/139 [00:00<00:00, 118.80it/s] 80%|███████▉  | 111/139 [00:00<00:00, 123.54it/s] 92%|█████████▏| 128/139 [00:00<00:00, 135.25it/s]100%|██████████| 139/139 [00:01<00:00, 130.67it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   6%|▋         | 11/173 [00:00<00:01, 99.62it/s]extract the null data:  49%|████▊     | 84/173 [00:00<00:00, 452.66it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 526.40it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 483.31it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 194.55it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 213.90it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 190.17it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 203.16it/s]replace nan value:  64%|██████▍   | 111/173 [00:00<00:00, 210.40it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 214.57it/s]replace nan value:  90%|█████████ | 156/173 [00:00<00:00, 215.21it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 208.78it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 135.66it/s] 16%|█▌        | 28/173 [00:00<00:01, 119.73it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.63it/s] 34%|███▎      | 58/173 [00:00<00:00, 137.37it/s] 42%|████▏     | 72/173 [00:00<00:00, 136.50it/s] 50%|████▉     | 86/173 [00:00<00:00, 114.97it/s] 57%|█████▋    | 99/173 [00:00<00:00, 100.77it/s] 68%|██████▊   | 117/173 [00:00<00:00, 119.60it/s] 76%|███████▌  | 131/173 [00:01<00:00, 122.89it/s] 84%|████████▍ | 146/173 [00:01<00:00, 129.34it/s] 92%|█████████▏| 160/173 [00:01<00:00, 124.39it/s]100%|██████████| 173/173 [00:01<00:00, 99.58it/s] 100%|██████████| 173/173 [00:01<00:00, 115.59it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.457, valid loss : 0.357, train acc : 0.890, valid acc : 0.915, train f1 : 0.542, valid f1 : 0.556
training process:   1%|          | 1/128 [01:07<2:22:41, 67.41s/it]Best score increase :0.000 -> 0.556
training process:   2%|▏         | 2/128 [01:56<1:59:06, 56.72s/it]Best score increase :0.556 -> 0.584
training process:   2%|▏         | 3/128 [02:46<1:51:53, 53.71s/it]Best score increase :0.584 -> 0.669
training process:   3%|▎         | 4/128 [03:37<1:48:26, 52.47s/it]Best score increase :0.669 -> 0.739
epoch : 5, train loss : 0.219, valid loss : 0.209, train acc : 0.942, valid acc : 0.942, train f1 : 0.747, valid f1 : 0.759
training process:   4%|▍         | 5/128 [04:35<1:51:58, 54.62s/it]Best score increase :0.739 -> 0.759
training process:   5%|▍         | 6/128 [05:24<1:47:19, 52.78s/it]Best score increase :0.759 -> 0.767
training process:   5%|▌         | 7/128 [06:16<1:45:33, 52.34s/it]Best score increase :0.767 -> 0.782
training process:   6%|▋         | 8/128 [07:14<1:48:02, 54.02s/it]Best score increase :0.782 -> 0.794
epoch : 9, train loss : 0.166, valid loss : 0.168, train acc : 0.952, valid acc : 0.951, train f1 : 0.803, valid f1 : 0.796
training process:   7%|▋         | 9/128 [08:25<1:57:48, 59.40s/it]Best score increase :0.794 -> 0.796
training process:   8%|▊         | 10/128 [09:39<2:05:42, 63.92s/it]Best score increase :0.796 -> 0.798
training process:   9%|▊         | 11/128 [10:38<2:02:03, 62.59s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:35<1:57:36, 60.83s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.150, valid loss : 0.157, train acc : 0.955, valid acc : 0.951, train f1 : 0.812, valid f1 : 0.799
training process:  10%|█         | 13/128 [12:45<2:01:34, 63.43s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [13:41<1:56:19, 61.23s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [14:41<1:55:00, 61.06s/it]Best score increase :0.798 -> 0.803
training process:  12%|█▎        | 16/128 [15:42<1:53:36, 60.86s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.144, valid loss : 0.148, train acc : 0.956, valid acc : 0.954, train f1 : 0.818, valid f1 : 0.811
training process:  13%|█▎        | 17/128 [16:53<1:58:14, 63.92s/it]Best score increase :0.803 -> 0.811
training process:  14%|█▍        | 18/128 [17:54<1:55:26, 62.97s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [18:55<1:53:26, 62.44s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [19:53<1:50:20, 61.30s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.135, valid loss : 0.148, train acc : 0.958, valid acc : 0.953, train f1 : 0.830, valid f1 : 0.804
training process:  16%|█▋        | 21/128 [20:56<1:50:14, 61.82s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [21:46<1:42:52, 58.23s/it]Best score increase :0.811 -> 0.830
training process:  18%|█▊        | 23/128 [22:35<1:36:56, 55.39s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [23:24<1:32:46, 53.52s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.131, valid loss : 0.138, train acc : 0.960, valid acc : 0.958, train f1 : 0.837, valid f1 : 0.834
training process:  20%|█▉        | 25/128 [24:23<1:34:31, 55.06s/it]Best score increase :0.830 -> 0.834
training process:  20%|██        | 26/128 [25:12<1:30:20, 53.15s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [26:00<1:26:51, 51.60s/it]Best score increase :0.834 -> 0.839
training process:  22%|██▏       | 28/128 [26:48<1:24:33, 50.73s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.126, valid loss : 0.135, train acc : 0.960, valid acc : 0.958, train f1 : 0.838, valid f1 : 0.836
training process:  23%|██▎       | 29/128 [27:44<1:26:23, 52.36s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [28:32<1:23:12, 50.95s/it]Best score increase :0.839 -> 0.843
training process:  24%|██▍       | 31/128 [29:18<1:19:52, 49.41s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [30:04<1:17:37, 48.52s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.125, valid loss : 0.134, train acc : 0.960, valid acc : 0.956, train f1 : 0.840, valid f1 : 0.825
training process:  26%|██▌       | 33/128 [31:01<1:20:35, 50.90s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 34/128 [31:48<1:17:56, 49.75s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 35/128 [32:36<1:16:25, 49.30s/it]EarlyStopping counter : 5 out of 12
training process:  28%|██▊       | 36/128 [33:24<1:15:04, 48.96s/it]EarlyStopping counter : 6 out of 12
epoch : 37, train loss : 0.121, valid loss : 0.135, train acc : 0.962, valid acc : 0.956, train f1 : 0.849, valid f1 : 0.825
training process:  29%|██▉       | 37/128 [34:50<1:30:57, 59.97s/it]EarlyStopping counter : 7 out of 12
training process:  30%|██▉       | 38/128 [35:55<1:32:26, 61.63s/it]EarlyStopping counter : 8 out of 12
training process:  30%|███       | 39/128 [37:04<1:34:25, 63.65s/it]EarlyStopping counter : 9 out of 12
training process:  31%|███▏      | 40/128 [38:09<1:34:11, 64.22s/it]EarlyStopping counter : 10 out of 12
epoch : 41, train loss : 0.118, valid loss : 0.133, train acc : 0.962, valid acc : 0.958, train f1 : 0.850, valid f1 : 0.833
training process:  32%|███▏      | 41/128 [39:26<1:38:40, 68.05s/it]EarlyStopping counter : 11 out of 12
training process:  33%|███▎      | 42/128 [40:34<1:37:17, 67.88s/it]Best score increase :0.843 -> 0.845
training process:  34%|███▎      | 43/128 [41:45<1:37:32, 68.85s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [42:54<1:36:21, 68.82s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.116, valid loss : 0.128, train acc : 0.962, valid acc : 0.958, train f1 : 0.851, valid f1 : 0.836
training process:  35%|███▌      | 45/128 [44:14<1:39:49, 72.16s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [45:22<1:37:06, 71.05s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [46:32<1:35:15, 70.57s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [47:36<1:31:43, 68.80s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.116, valid loss : 0.131, train acc : 0.962, valid acc : 0.957, train f1 : 0.854, valid f1 : 0.827
training process:  38%|███▊      | 49/128 [48:55<1:34:37, 71.87s/it]EarlyStopping counter : 7 out of 12
training process:  39%|███▉      | 50/128 [50:00<1:30:27, 69.58s/it]EarlyStopping counter : 8 out of 12
training process:  40%|███▉      | 51/128 [51:07<1:28:31, 68.98s/it]EarlyStopping counter : 9 out of 12
training process:  41%|████      | 52/128 [52:05<1:23:10, 65.66s/it]EarlyStopping counter : 10 out of 12
epoch : 53, train loss : 0.111, valid loss : 0.125, train acc : 0.964, valid acc : 0.959, train f1 : 0.858, valid f1 : 0.839
training process:  41%|████▏     | 53/128 [53:14<1:23:09, 66.53s/it]EarlyStopping counter : 11 out of 12
training process:  41%|████▏     | 53/128 [54:13<1:16:44, 61.39s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 53, best f1 score : 0.845
training process finished, best loss : 0.127 and best acc : 0.960, best f1 : 0.845, best epoch : 41

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.91      0.62      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.94      0.81      0.86      7398
weighted avg       0.96      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.81, test loss : 7.840

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:35,  8.65s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:32,  9.30s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:28,  9.87s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:17,  9.74s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:04,  9.20s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:55,  9.22s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:05<00:45,  9.17s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:14<00:36,  9.20s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:23<00:27,  9.30s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:32<00:18,  9.02s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:42<00:09,  9.27s/it]processing for feature importance: 100%|██████████| 12/12 [01:50<00:00,  9.03s/it]processing for feature importance: 100%|██████████| 12/12 [01:50<00:00,  9.21s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 219.48it/s] 14%|█▍        | 44/306 [00:00<00:01, 199.86it/s] 21%|██        | 65/306 [00:00<00:01, 202.87it/s] 33%|███▎      | 102/306 [00:00<00:00, 254.12it/s] 46%|████▋     | 142/306 [00:00<00:00, 303.09it/s] 62%|██████▏   | 191/306 [00:00<00:00, 363.05it/s] 79%|███████▉  | 242/306 [00:00<00:00, 409.31it/s] 93%|█████████▎| 284/306 [00:00<00:00, 344.62it/s]100%|██████████| 306/306 [00:01<00:00, 284.11it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   6%|▌         | 32/553 [00:00<00:01, 283.47it/s]extract the null data:  16%|█▌        | 87/553 [00:00<00:01, 429.00it/s]extract the null data:  26%|██▌       | 145/553 [00:00<00:00, 494.05it/s]extract the null data:  35%|███▌      | 195/553 [00:00<00:00, 381.16it/s]extract the null data:  43%|████▎     | 237/553 [00:00<00:00, 342.28it/s]extract the null data:  50%|████▉     | 274/553 [00:00<00:00, 325.85it/s]extract the null data:  56%|█████▌    | 309/553 [00:00<00:00, 309.57it/s]extract the null data:  62%|██████▏   | 341/553 [00:01<00:00, 308.76it/s]extract the null data:  67%|██████▋   | 373/553 [00:01<00:00, 290.05it/s]extract the null data:  73%|███████▎  | 403/553 [00:01<00:00, 281.92it/s]extract the null data:  83%|████████▎ | 459/553 [00:01<00:00, 355.33it/s]extract the null data:  94%|█████████▎| 518/553 [00:01<00:00, 418.94it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 366.83it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 191.11it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 189.44it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 190.26it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 190.76it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 191.76it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 194.16it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 175.20it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 181.77it/s]replace nan value:  33%|███▎      | 180/553 [00:00<00:02, 185.99it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:01, 188.17it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 189.84it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 191.53it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 191.49it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 191.95it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 191.66it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 192.05it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 191.50it/s]replace nan value:  65%|██████▌   | 360/553 [00:01<00:01, 190.25it/s]replace nan value:  69%|██████▊   | 380/553 [00:02<00:00, 190.14it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 188.33it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 188.13it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 189.03it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 188.68it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 191.50it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 193.43it/s]replace nan value:  94%|█████████▎| 518/553 [00:02<00:00, 194.51it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 193.48it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 190.13it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.53it/s]  5%|▌         | 28/553 [00:00<00:03, 138.03it/s]  8%|▊         | 42/553 [00:00<00:03, 131.51it/s] 10%|█         | 56/553 [00:00<00:04, 116.00it/s] 12%|█▏        | 68/553 [00:00<00:04, 108.99it/s] 15%|█▌        | 83/553 [00:00<00:03, 121.09it/s] 18%|█▊        | 97/553 [00:00<00:03, 123.95it/s] 20%|█▉        | 110/553 [00:00<00:04, 105.09it/s] 22%|██▏       | 122/553 [00:01<00:04, 104.50it/s] 25%|██▍       | 138/553 [00:01<00:03, 118.83it/s] 28%|██▊       | 156/553 [00:01<00:02, 134.40it/s] 31%|███▏      | 173/553 [00:01<00:02, 142.49it/s] 34%|███▍      | 188/553 [00:01<00:02, 140.70it/s] 37%|███▋      | 207/553 [00:01<00:02, 146.38it/s] 40%|████      | 222/553 [00:01<00:02, 139.82it/s] 43%|████▎     | 239/553 [00:01<00:02, 145.80it/s] 46%|████▌     | 254/553 [00:01<00:02, 139.62it/s] 49%|████▊     | 269/553 [00:02<00:02, 113.72it/s] 51%|█████     | 282/553 [00:02<00:02, 95.13it/s]  54%|█████▎    | 296/553 [00:02<00:02, 102.96it/s] 56%|█████▌    | 310/553 [00:02<00:02, 110.24it/s] 58%|█████▊    | 323/553 [00:02<00:02, 114.74it/s] 61%|██████    | 338/553 [00:02<00:01, 122.84it/s] 64%|██████▎   | 352/553 [00:02<00:01, 126.22it/s] 66%|██████▌   | 366/553 [00:02<00:01, 123.60it/s] 69%|██████▊   | 379/553 [00:03<00:01, 118.13it/s] 71%|███████   | 392/553 [00:03<00:01, 113.41it/s] 73%|███████▎  | 405/553 [00:03<00:01, 116.96it/s] 75%|███████▌  | 417/553 [00:03<00:01, 117.64it/s] 78%|███████▊  | 429/553 [00:03<00:01, 110.64it/s] 81%|████████  | 447/553 [00:03<00:00, 129.37it/s] 84%|████████▎ | 462/553 [00:03<00:00, 134.50it/s] 86%|████████▋ | 477/553 [00:03<00:00, 138.23it/s] 89%|████████▉ | 492/553 [00:04<00:00, 128.82it/s] 92%|█████████▏| 506/553 [00:04<00:00, 127.65it/s] 94%|█████████▍| 521/553 [00:04<00:00, 128.86it/s] 97%|█████████▋| 535/553 [00:04<00:00, 114.36it/s]100%|█████████▉| 551/553 [00:04<00:00, 106.50it/s]100%|██████████| 553/553 [00:04<00:00, 120.90it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  11%|█         | 15/139 [00:00<00:00, 148.40it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 450.66it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 481.25it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 213.22it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 212.69it/s]replace nan value:  48%|████▊     | 67/139 [00:00<00:00, 217.50it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 221.57it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 224.01it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 224.81it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 221.79it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:01, 125.96it/s] 19%|█▉        | 27/139 [00:00<00:00, 128.00it/s] 31%|███       | 43/139 [00:00<00:00, 141.08it/s] 42%|████▏     | 58/139 [00:00<00:00, 124.87it/s] 53%|█████▎    | 73/139 [00:00<00:00, 132.58it/s] 63%|██████▎   | 87/139 [00:00<00:00, 118.60it/s] 72%|███████▏  | 100/139 [00:00<00:00, 120.53it/s] 84%|████████▍ | 117/139 [00:00<00:00, 132.49it/s] 95%|█████████▍| 132/139 [00:01<00:00, 134.32it/s]100%|██████████| 139/139 [00:01<00:00, 132.63it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 289.27it/s]extract the null data:  55%|█████▌    | 96/173 [00:00<00:00, 509.88it/s]extract the null data:  94%|█████████▍| 163/173 [00:00<00:00, 581.57it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 544.27it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 229.90it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 231.28it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 232.16it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 232.22it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 232.35it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 231.89it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 229.98it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 230.69it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 139.11it/s] 17%|█▋        | 29/173 [00:00<00:01, 121.60it/s] 28%|██▊       | 48/173 [00:00<00:00, 148.11it/s] 38%|███▊      | 65/173 [00:00<00:00, 153.80it/s] 47%|████▋     | 81/173 [00:00<00:00, 152.06it/s] 56%|█████▌    | 97/173 [00:00<00:00, 128.56it/s] 67%|██████▋   | 116/173 [00:00<00:00, 142.11it/s] 76%|███████▌  | 131/173 [00:00<00:00, 134.48it/s] 84%|████████▍ | 145/173 [00:01<00:00, 128.21it/s] 92%|█████████▏| 159/173 [00:01<00:00, 107.37it/s] 99%|█████████▉| 171/173 [00:01<00:00, 81.82it/s] 100%|██████████| 173/173 [00:01<00:00, 114.37it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.577, valid loss : 0.406, train acc : 0.706, valid acc : 0.840, train f1 : 0.706, valid f1 : 0.656
training process:   1%|          | 1/128 [01:22<2:54:24, 82.40s/it]Best score increase :0.000 -> 0.656
training process:   2%|▏         | 2/128 [02:30<2:35:07, 73.87s/it]Best score increase :0.656 -> 0.700
training process:   2%|▏         | 3/128 [03:36<2:26:55, 70.52s/it]Best score increase :0.700 -> 0.741
training process:   3%|▎         | 4/128 [04:43<2:22:12, 68.81s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.366, valid loss : 0.308, train acc : 0.839, valid acc : 0.885, train f1 : 0.839, valid f1 : 0.731
training process:   4%|▍         | 5/128 [06:04<2:30:42, 73.52s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [07:07<2:22:15, 69.96s/it]Best score increase :0.741 -> 0.755
training process:   5%|▌         | 7/128 [08:10<2:16:30, 67.69s/it]Best score increase :0.755 -> 0.772
training process:   6%|▋         | 8/128 [09:17<2:14:37, 67.31s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.314, valid loss : 0.242, train acc : 0.865, valid acc : 0.921, train f1 : 0.865, valid f1 : 0.790
training process:   7%|▋         | 9/128 [10:37<2:21:21, 71.27s/it]Best score increase :0.772 -> 0.790
training process:   8%|▊         | 10/128 [11:42<2:16:38, 69.48s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [12:47<2:12:26, 67.92s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [13:52<2:09:38, 67.05s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.295, valid loss : 0.247, train acc : 0.871, valid acc : 0.913, train f1 : 0.871, valid f1 : 0.784
training process:  10%|█         | 13/128 [15:12<2:16:13, 71.07s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [16:13<2:09:05, 67.95s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [17:14<2:04:17, 66.00s/it]EarlyStopping counter : 6 out of 12
training process:  12%|█▎        | 16/128 [18:14<1:59:51, 64.21s/it]Best score increase :0.790 -> 0.798
epoch : 17, train loss : 0.279, valid loss : 0.222, train acc : 0.881, valid acc : 0.922, train f1 : 0.881, valid f1 : 0.796
training process:  13%|█▎        | 17/128 [19:25<2:02:21, 66.14s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [20:24<1:57:30, 64.10s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [21:24<1:54:08, 62.83s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [22:26<1:52:14, 62.35s/it]Best score increase :0.798 -> 0.810
epoch : 21, train loss : 0.260, valid loss : 0.211, train acc : 0.889, valid acc : 0.924, train f1 : 0.889, valid f1 : 0.803
training process:  16%|█▋        | 21/128 [23:38<1:56:32, 65.35s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [24:45<1:56:29, 65.94s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [25:47<1:53:07, 64.64s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [26:45<1:48:27, 62.57s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.250, valid loss : 0.239, train acc : 0.897, valid acc : 0.909, train f1 : 0.897, valid f1 : 0.783
training process:  20%|█▉        | 25/128 [27:52<1:49:42, 63.91s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [28:50<1:45:46, 62.22s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [29:48<1:42:54, 61.14s/it]EarlyStopping counter : 7 out of 12
training process:  22%|██▏       | 28/128 [30:46<1:40:14, 60.15s/it]Best score increase :0.810 -> 0.816
epoch : 29, train loss : 0.244, valid loss : 0.213, train acc : 0.897, valid acc : 0.926, train f1 : 0.897, valid f1 : 0.808
training process:  23%|██▎       | 29/128 [31:56<1:43:56, 62.99s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [32:56<1:41:20, 62.05s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [33:55<1:38:46, 61.10s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [34:53<1:36:21, 60.22s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.230, valid loss : 0.251, train acc : 0.905, valid acc : 0.902, train f1 : 0.905, valid f1 : 0.773
training process:  26%|██▌       | 33/128 [36:02<1:39:41, 62.97s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [37:00<1:36:17, 61.46s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [37:58<1:33:39, 60.42s/it]Best score increase :0.816 -> 0.823
training process:  28%|██▊       | 36/128 [38:58<1:32:35, 60.39s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.236, valid loss : 0.227, train acc : 0.902, valid acc : 0.910, train f1 : 0.902, valid f1 : 0.784
training process:  29%|██▉       | 37/128 [40:09<1:36:08, 63.39s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [41:05<1:31:43, 61.15s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [42:03<1:29:19, 60.22s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [43:00<1:27:04, 59.37s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.223, valid loss : 0.232, train acc : 0.908, valid acc : 0.913, train f1 : 0.908, valid f1 : 0.790
training process:  32%|███▏      | 41/128 [44:11<1:30:59, 62.75s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [45:11<1:29:00, 62.09s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [46:14<1:28:06, 62.20s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [47:13<1:25:59, 61.42s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.219, valid loss : 0.221, train acc : 0.909, valid acc : 0.921, train f1 : 0.909, valid f1 : 0.805
training process:  35%|███▌      | 45/128 [48:25<1:28:58, 64.32s/it]EarlyStopping counter : 10 out of 12
training process:  36%|███▌      | 46/128 [49:25<1:26:24, 63.23s/it]EarlyStopping counter : 11 out of 12
training process:  36%|███▌      | 46/128 [50:30<1:30:02, 65.88s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 46, best f1 score : 0.823
training process finished, best loss : 0.182 and best acc : 0.935, best f1 : 0.823, best epoch : 34

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.51      0.80      0.62       580
           1       0.98      0.93      0.96      6818

    accuracy                           0.92      7398
   macro avg       0.75      0.87      0.79      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.79, test AUC : 0.87, test loss : 11.722

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:07, 11.59s/it]processing for feature importance:  17%|█▋        | 2/12 [00:23<01:58, 11.90s/it]processing for feature importance:  25%|██▌       | 3/12 [00:34<01:42, 11.39s/it]processing for feature importance:  33%|███▎      | 4/12 [00:45<01:30, 11.36s/it]processing for feature importance:  42%|████▏     | 5/12 [00:57<01:19, 11.37s/it]processing for feature importance:  50%|█████     | 6/12 [01:08<01:08, 11.41s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:20<00:56, 11.38s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:31<00:45, 11.32s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:41<00:33, 11.14s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:51<00:21, 10.68s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:02<00:10, 10.69s/it]processing for feature importance: 100%|██████████| 12/12 [02:14<00:00, 11.06s/it]processing for feature importance: 100%|██████████| 12/12 [02:14<00:00, 11.18s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 32/306 [00:00<00:00, 315.99it/s] 28%|██▊       | 85/306 [00:00<00:00, 440.92it/s] 42%|████▏     | 130/306 [00:00<00:00, 351.61it/s] 56%|█████▌    | 172/306 [00:00<00:00, 371.92it/s] 69%|██████▉   | 211/306 [00:00<00:00, 317.86it/s] 80%|████████  | 245/306 [00:00<00:00, 287.18it/s] 90%|█████████ | 276/306 [00:00<00:00, 271.91it/s]100%|█████████▉| 305/306 [00:01<00:00, 259.58it/s]100%|██████████| 306/306 [00:01<00:00, 298.75it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 483.33it/s]extract the null data:  18%|█▊        | 98/553 [00:00<00:00, 481.81it/s]extract the null data:  27%|██▋       | 148/553 [00:00<00:00, 486.30it/s]extract the null data:  36%|███▌      | 197/553 [00:00<00:00, 487.31it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 484.64it/s]extract the null data:  53%|█████▎    | 295/553 [00:00<00:00, 467.33it/s]extract the null data:  62%|██████▏   | 342/553 [00:00<00:00, 429.47it/s]extract the null data:  71%|███████   | 392/553 [00:00<00:00, 448.43it/s]extract the null data:  80%|███████▉  | 442/553 [00:00<00:00, 461.32it/s]extract the null data:  89%|████████▉ | 492/553 [00:01<00:00, 471.28it/s]extract the null data:  98%|█████████▊| 542/553 [00:01<00:00, 477.01it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 469.51it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 176.99it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 177.20it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 173.56it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 174.30it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 175.52it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 176.57it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 176.77it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 177.30it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:02, 178.44it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 141.37it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:02, 140.72it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:02, 129.77it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:02, 139.14it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:02, 137.91it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:02, 128.87it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:02, 118.04it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:02, 128.42it/s]replace nan value:  56%|█████▌    | 307/553 [00:02<00:01, 136.10it/s]replace nan value:  58%|█████▊    | 323/553 [00:02<00:01, 141.84it/s]replace nan value:  61%|██████▏   | 340/553 [00:02<00:01, 149.10it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 154.86it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:01, 155.95it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:01, 156.35it/s]replace nan value:  73%|███████▎  | 405/553 [00:02<00:00, 150.65it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 157.14it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 146.34it/s]replace nan value:  83%|████████▎ | 457/553 [00:03<00:00, 154.81it/s]replace nan value:  86%|████████▌ | 475/553 [00:03<00:00, 160.56it/s]replace nan value:  89%|████████▉ | 492/553 [00:03<00:00, 156.95it/s]replace nan value:  92%|█████████▏| 510/553 [00:03<00:00, 162.96it/s]replace nan value:  95%|█████████▌| 528/553 [00:03<00:00, 167.16it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 173.51it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 154.31it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.89it/s]  5%|▍         | 27/553 [00:00<00:03, 134.86it/s]  7%|▋         | 41/553 [00:00<00:03, 132.43it/s] 10%|▉         | 55/553 [00:00<00:04, 121.88it/s] 12%|█▏        | 68/553 [00:00<00:04, 110.96it/s] 14%|█▍        | 80/553 [00:00<00:04, 112.78it/s] 17%|█▋        | 92/553 [00:00<00:04, 114.42it/s] 19%|█▉        | 105/553 [00:00<00:03, 118.44it/s] 22%|██▏       | 120/553 [00:00<00:03, 127.68it/s] 24%|██▍       | 133/553 [00:01<00:03, 127.29it/s] 27%|██▋       | 150/553 [00:01<00:02, 138.72it/s] 30%|██▉       | 165/553 [00:01<00:02, 141.96it/s] 33%|███▎      | 180/553 [00:01<00:02, 143.44it/s] 35%|███▌      | 195/553 [00:01<00:02, 145.19it/s] 38%|███▊      | 211/553 [00:01<00:02, 149.45it/s] 41%|████      | 226/553 [00:01<00:02, 140.58it/s] 44%|████▎     | 241/553 [00:01<00:02, 142.05it/s] 46%|████▋     | 256/553 [00:01<00:02, 135.79it/s] 49%|████▉     | 270/553 [00:02<00:02, 135.96it/s] 51%|█████▏    | 284/553 [00:02<00:02, 133.01it/s] 54%|█████▍    | 298/553 [00:02<00:02, 108.34it/s] 56%|█████▌    | 310/553 [00:02<00:02, 94.13it/s]  58%|█████▊    | 323/553 [00:02<00:02, 100.33it/s] 61%|██████    | 335/553 [00:02<00:02, 104.46it/s] 63%|██████▎   | 347/553 [00:02<00:01, 106.78it/s] 65%|██████▍   | 359/553 [00:02<00:01, 99.17it/s]  68%|██████▊   | 374/553 [00:03<00:01, 111.86it/s] 70%|██████▉   | 386/553 [00:03<00:01, 106.11it/s] 72%|███████▏  | 397/553 [00:03<00:01, 100.82it/s] 75%|███████▍  | 413/553 [00:03<00:01, 116.11it/s] 77%|███████▋  | 426/553 [00:03<00:01, 86.06it/s]  79%|███████▉  | 437/553 [00:03<00:01, 80.74it/s] 81%|████████  | 447/553 [00:03<00:01, 84.05it/s] 83%|████████▎ | 457/553 [00:04<00:01, 78.09it/s] 84%|████████▍ | 466/553 [00:04<00:01, 76.08it/s] 86%|████████▌ | 475/553 [00:04<00:01, 74.33it/s] 87%|████████▋ | 483/553 [00:04<00:00, 70.16it/s] 89%|████████▉ | 493/553 [00:04<00:00, 76.88it/s] 91%|█████████▏| 505/553 [00:04<00:00, 86.48it/s] 94%|█████████▍| 519/553 [00:04<00:00, 100.40it/s] 96%|█████████▌| 530/553 [00:04<00:00, 84.02it/s]  98%|█████████▊| 544/553 [00:05<00:00, 96.37it/s]100%|██████████| 553/553 [00:05<00:00, 106.03it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 257.16it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 432.03it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 462.65it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 196.56it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 194.63it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 192.79it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 191.36it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 192.51it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 182.38it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 188.47it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.75it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.29it/s] 27%|██▋       | 38/139 [00:00<00:00, 125.26it/s] 37%|███▋      | 51/139 [00:00<00:00, 121.69it/s] 47%|████▋     | 65/139 [00:00<00:00, 127.13it/s] 56%|█████▌    | 78/139 [00:00<00:00, 110.64it/s] 65%|██████▍   | 90/139 [00:00<00:00, 108.49it/s] 76%|███████▌  | 105/139 [00:00<00:00, 117.51it/s] 84%|████████▍ | 117/139 [00:01<00:00, 115.00it/s] 94%|█████████▎| 130/139 [00:01<00:00, 116.98it/s]100%|██████████| 139/139 [00:01<00:00, 118.56it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 287.10it/s]extract the null data:  49%|████▊     | 84/173 [00:00<00:00, 440.44it/s]extract the null data:  80%|████████  | 139/173 [00:00<00:00, 489.17it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 473.44it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 196.86it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 194.00it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 186.32it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 186.16it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 187.36it/s]replace nan value:  68%|██████▊   | 117/173 [00:00<00:00, 153.73it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 149.92it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 159.44it/s]replace nan value:  99%|█████████▉| 172/173 [00:01<00:00, 167.48it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 169.89it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  6%|▌         | 10/173 [00:00<00:02, 80.60it/s] 11%|█         | 19/173 [00:00<00:02, 64.27it/s] 18%|█▊        | 31/173 [00:00<00:01, 84.55it/s] 28%|██▊       | 48/173 [00:00<00:01, 113.15it/s] 37%|███▋      | 64/173 [00:00<00:00, 127.35it/s] 46%|████▌     | 79/173 [00:00<00:00, 133.81it/s] 54%|█████▍    | 93/173 [00:00<00:00, 135.31it/s] 62%|██████▏   | 108/173 [00:00<00:00, 137.03it/s] 71%|███████   | 122/173 [00:01<00:00, 137.40it/s] 79%|███████▊  | 136/173 [00:01<00:00, 129.42it/s] 87%|████████▋ | 150/173 [00:01<00:00, 128.25it/s] 94%|█████████▍| 163/173 [00:01<00:00, 124.98it/s]100%|██████████| 173/173 [00:01<00:00, 112.76it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.088, valid loss : 0.080, train acc : 0.638, valid acc : 0.750, train f1 : 0.504, valid f1 : 0.591
training process:   1%|          | 1/128 [01:10<2:28:56, 70.37s/it]Best score increase :0.000 -> 0.591
training process:   2%|▏         | 2/128 [02:11<2:16:02, 64.78s/it]Best score increase :0.591 -> 0.626
training process:   2%|▏         | 3/128 [03:11<2:10:14, 62.51s/it]Best score increase :0.626 -> 0.708
training process:   3%|▎         | 4/128 [04:09<2:05:46, 60.86s/it]Best score increase :0.708 -> 0.728
epoch : 5, train loss : 0.057, valid loss : 0.058, train acc : 0.883, valid acc : 0.880, train f1 : 0.725, valid f1 : 0.722
training process:   4%|▍         | 5/128 [05:17<2:10:26, 63.63s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [06:17<2:06:42, 62.31s/it]Best score increase :0.728 -> 0.776
training process:   5%|▌         | 7/128 [07:17<2:04:02, 61.51s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [08:25<2:06:58, 63.48s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.052, valid loss : 0.053, train acc : 0.908, valid acc : 0.907, train f1 : 0.761, valid f1 : 0.763
training process:   7%|▋         | 9/128 [09:43<2:14:49, 67.98s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [10:47<2:11:41, 66.96s/it]EarlyStopping counter : 4 out of 12
training process:   9%|▊         | 11/128 [11:50<2:08:04, 65.68s/it]Best score increase :0.776 -> 0.803
training process:   9%|▉         | 12/128 [12:53<2:05:06, 64.71s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.049, valid loss : 0.052, train acc : 0.916, valid acc : 0.927, train f1 : 0.775, valid f1 : 0.796
training process:  10%|█         | 13/128 [14:03<2:07:11, 66.36s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [15:06<2:04:08, 65.34s/it]Best score increase :0.803 -> 0.818
training process:  12%|█▏        | 15/128 [16:10<2:02:35, 65.09s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [17:05<1:55:51, 62.06s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.048, valid loss : 0.049, train acc : 0.918, valid acc : 0.926, train f1 : 0.780, valid f1 : 0.797
training process:  13%|█▎        | 17/128 [18:10<1:56:12, 62.82s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [19:07<1:52:10, 61.19s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [20:04<1:48:37, 59.79s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [21:02<1:46:56, 59.42s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.045, valid loss : 0.051, train acc : 0.921, valid acc : 0.940, train f1 : 0.788, valid f1 : 0.821
training process:  16%|█▋        | 21/128 [22:06<1:48:10, 60.66s/it]Best score increase :0.818 -> 0.821
training process:  17%|█▋        | 22/128 [23:02<1:44:49, 59.33s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [23:56<1:40:50, 57.62s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [25:02<1:44:25, 60.25s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.044, valid loss : 0.044, train acc : 0.924, valid acc : 0.900, train f1 : 0.795, valid f1 : 0.765
training process:  20%|█▉        | 25/128 [26:08<1:46:18, 61.93s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [27:00<1:40:08, 58.91s/it]Best score increase :0.821 -> 0.827
training process:  21%|██        | 27/128 [27:53<1:36:21, 57.24s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [28:50<1:35:11, 57.12s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.044, valid loss : 0.046, train acc : 0.930, valid acc : 0.934, train f1 : 0.805, valid f1 : 0.814
training process:  23%|██▎       | 29/128 [29:56<1:38:36, 59.77s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [30:49<1:34:27, 57.83s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [31:37<1:28:38, 54.83s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [32:22<1:23:03, 51.91s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.043, valid loss : 0.044, train acc : 0.930, valid acc : 0.928, train f1 : 0.806, valid f1 : 0.805
training process:  26%|██▌       | 33/128 [33:16<1:23:05, 52.48s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [34:00<1:18:19, 49.99s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [34:45<1:14:55, 48.34s/it]Best score increase :0.827 -> 0.831
training process:  28%|██▊       | 36/128 [35:29<1:12:24, 47.23s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.042, valid loss : 0.046, train acc : 0.932, valid acc : 0.939, train f1 : 0.809, valid f1 : 0.825
training process:  29%|██▉       | 37/128 [36:28<1:16:51, 50.68s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [37:22<1:17:31, 51.68s/it]Best score increase :0.831 -> 0.833
training process:  30%|███       | 39/128 [38:18<1:18:35, 52.98s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [39:14<1:18:55, 53.81s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.041, valid loss : 0.049, train acc : 0.931, valid acc : 0.941, train f1 : 0.808, valid f1 : 0.825
training process:  32%|███▏      | 41/128 [40:17<1:22:10, 56.68s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [41:13<1:20:45, 56.34s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [42:13<1:21:32, 57.55s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [43:09<1:20:03, 57.18s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.040, valid loss : 0.042, train acc : 0.932, valid acc : 0.920, train f1 : 0.813, valid f1 : 0.797
training process:  35%|███▌      | 45/128 [44:14<1:22:14, 59.45s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [45:08<1:18:55, 57.75s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [46:01<1:16:12, 56.45s/it]EarlyStopping counter : 9 out of 12
training process:  38%|███▊      | 48/128 [46:57<1:15:07, 56.34s/it]EarlyStopping counter : 10 out of 12
epoch : 49, train loss : 0.040, valid loss : 0.047, train acc : 0.935, valid acc : 0.942, train f1 : 0.818, valid f1 : 0.828
training process:  38%|███▊      | 49/128 [48:01<1:16:51, 58.37s/it]EarlyStopping counter : 11 out of 12
training process:  38%|███▊      | 49/128 [49:00<1:19:00, 60.01s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 49, best f1 score : 0.833
training process finished, best loss : 0.049 and best acc : 0.945, best f1 : 0.833, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.63      0.79      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.88      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.88, test loss : 2.889

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:02, 11.12s/it]processing for feature importance:  17%|█▋        | 2/12 [00:22<01:51, 11.12s/it]processing for feature importance:  25%|██▌       | 3/12 [00:31<01:34, 10.46s/it]processing for feature importance:  33%|███▎      | 4/12 [00:41<01:21, 10.21s/it]processing for feature importance:  42%|████▏     | 5/12 [00:53<01:15, 10.79s/it]processing for feature importance:  50%|█████     | 6/12 [01:05<01:06, 11.04s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:15<00:54, 10.92s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:25<00:41, 10.46s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:36<00:32, 10.67s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:46<00:21, 10.53s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:56<00:10, 10.43s/it]processing for feature importance: 100%|██████████| 12/12 [02:06<00:00, 10.34s/it]processing for feature importance: 100%|██████████| 12/12 [02:06<00:00, 10.58s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|█         | 32/306 [00:00<00:00, 316.09it/s] 22%|██▏       | 67/306 [00:00<00:00, 334.69it/s] 33%|███▎      | 102/306 [00:00<00:00, 340.43it/s] 45%|████▌     | 138/306 [00:00<00:00, 344.94it/s] 57%|█████▋    | 173/306 [00:00<00:00, 289.18it/s] 71%|███████   | 217/306 [00:00<00:00, 333.67it/s] 85%|████████▌ | 261/306 [00:00<00:00, 364.69it/s] 98%|█████████▊| 301/306 [00:00<00:00, 374.85it/s]100%|██████████| 306/306 [00:00<00:00, 349.68it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:01, 501.85it/s]extract the null data:  19%|█▊        | 103/553 [00:00<00:00, 509.43it/s]extract the null data:  28%|██▊       | 156/553 [00:00<00:00, 518.40it/s]extract the null data:  38%|███▊      | 210/553 [00:00<00:00, 525.23it/s]extract the null data:  48%|████▊     | 263/553 [00:00<00:00, 523.15it/s]extract the null data:  57%|█████▋    | 316/553 [00:00<00:00, 517.48it/s]extract the null data:  67%|██████▋   | 368/553 [00:00<00:00, 516.71it/s]extract the null data:  76%|███████▌  | 421/553 [00:00<00:00, 519.62it/s]extract the null data:  86%|████████▌ | 473/553 [00:00<00:00, 477.36it/s]extract the null data:  95%|█████████▍| 524/553 [00:01<00:00, 485.94it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 503.34it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 12/553 [00:00<00:04, 116.02it/s]replace nan value:   5%|▌         | 30/553 [00:00<00:03, 148.80it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:03, 158.88it/s]replace nan value:  12%|█▏        | 65/553 [00:00<00:02, 162.82it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 163.72it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 164.75it/s]replace nan value:  21%|██        | 116/553 [00:00<00:02, 164.75it/s]replace nan value:  24%|██▍       | 133/553 [00:00<00:02, 165.43it/s]replace nan value:  27%|██▋       | 150/553 [00:00<00:02, 166.03it/s]replace nan value:  30%|███       | 167/553 [00:01<00:02, 166.76it/s]replace nan value:  33%|███▎      | 184/553 [00:01<00:02, 166.21it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:02, 167.92it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 168.10it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 168.36it/s]replace nan value:  46%|████▌     | 253/553 [00:01<00:01, 161.18it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:02, 130.24it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:02, 114.80it/s]replace nan value:  54%|█████▍    | 298/553 [00:02<00:02, 104.63it/s]replace nan value:  56%|█████▌    | 310/553 [00:02<00:02, 99.14it/s] replace nan value:  59%|█████▉    | 327/553 [00:02<00:01, 114.61it/s]replace nan value:  62%|██████▏   | 345/553 [00:02<00:01, 130.15it/s]replace nan value:  66%|██████▌   | 363/553 [00:02<00:01, 142.20it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:01, 150.13it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:01, 154.55it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 158.63it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 158.98it/s]replace nan value:  81%|████████  | 449/553 [00:03<00:00, 156.64it/s]replace nan value:  84%|████████▍ | 467/553 [00:03<00:00, 162.74it/s]replace nan value:  88%|████████▊ | 485/553 [00:03<00:00, 167.01it/s]replace nan value:  91%|█████████ | 504/553 [00:03<00:00, 171.21it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 172.88it/s]replace nan value:  98%|█████████▊| 540/553 [00:03<00:00, 174.51it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 152.42it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.53it/s]  5%|▍         | 27/553 [00:00<00:03, 134.39it/s]  7%|▋         | 41/553 [00:00<00:03, 131.54it/s] 10%|▉         | 55/553 [00:00<00:04, 121.41it/s] 12%|█▏        | 68/553 [00:00<00:04, 109.71it/s] 14%|█▍        | 80/553 [00:00<00:04, 111.99it/s] 17%|█▋        | 94/553 [00:00<00:03, 118.25it/s] 20%|█▉        | 108/553 [00:00<00:03, 123.42it/s] 22%|██▏       | 122/553 [00:00<00:03, 127.52it/s] 24%|██▍       | 135/553 [00:01<00:03, 113.20it/s] 27%|██▋       | 147/553 [00:01<00:03, 113.41it/s] 29%|██▉       | 163/553 [00:01<00:03, 124.82it/s] 32%|███▏      | 178/553 [00:01<00:02, 131.87it/s] 35%|███▍      | 192/553 [00:01<00:02, 129.01it/s] 37%|███▋      | 206/553 [00:01<00:03, 114.14it/s] 40%|███▉      | 219/553 [00:01<00:02, 116.30it/s] 42%|████▏     | 231/553 [00:01<00:02, 112.10it/s] 44%|████▍     | 245/553 [00:02<00:02, 118.54it/s] 47%|████▋     | 258/553 [00:02<00:02, 106.81it/s] 49%|████▉     | 271/553 [00:02<00:02, 111.63it/s] 52%|█████▏    | 286/553 [00:02<00:02, 121.05it/s] 54%|█████▍    | 299/553 [00:02<00:02, 120.98it/s] 56%|█████▋    | 312/553 [00:02<00:02, 118.78it/s] 59%|█████▉    | 326/553 [00:02<00:01, 122.80it/s] 61%|██████▏   | 340/553 [00:02<00:01, 125.54it/s] 64%|██████▍   | 353/553 [00:02<00:01, 125.64it/s] 66%|██████▌   | 366/553 [00:03<00:01, 121.61it/s] 69%|██████▊   | 380/553 [00:03<00:01, 126.64it/s] 71%|███████   | 393/553 [00:03<00:01, 116.19it/s] 73%|███████▎  | 406/553 [00:03<00:01, 119.07it/s] 76%|███████▌  | 419/553 [00:03<00:01, 109.19it/s] 78%|███████▊  | 431/553 [00:03<00:01, 94.06it/s]  81%|████████  | 449/553 [00:03<00:00, 113.56it/s] 84%|████████▍ | 464/553 [00:03<00:00, 120.35it/s] 86%|████████▋ | 477/553 [00:04<00:00, 115.52it/s] 89%|████████▊ | 490/553 [00:04<00:00, 113.25it/s] 91%|█████████ | 502/553 [00:04<00:00, 113.29it/s] 93%|█████████▎| 515/553 [00:04<00:00, 111.15it/s] 95%|█████████▌| 527/553 [00:04<00:00, 91.27it/s]  97%|█████████▋| 539/553 [00:04<00:00, 97.46it/s]100%|█████████▉| 551/553 [00:04<00:00, 91.28it/s]100%|██████████| 553/553 [00:04<00:00, 113.95it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 296.13it/s]extract the null data:  55%|█████▍    | 76/139 [00:00<00:00, 376.07it/s]extract the null data:  91%|█████████▏| 127/139 [00:00<00:00, 433.75it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 419.65it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 194.15it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 191.84it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 180.56it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 174.97it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 181.54it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 186.25it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 186.71it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 129.57it/s] 19%|█▉        | 27/139 [00:00<00:00, 131.72it/s] 31%|███       | 43/139 [00:00<00:00, 144.26it/s] 42%|████▏     | 58/139 [00:00<00:00, 126.38it/s] 53%|█████▎    | 73/139 [00:00<00:00, 131.36it/s] 63%|██████▎   | 87/139 [00:00<00:00, 115.14it/s] 71%|███████   | 99/139 [00:00<00:00, 102.30it/s] 79%|███████▉  | 110/139 [00:01<00:00, 89.25it/s] 91%|█████████ | 126/139 [00:01<00:00, 105.61it/s]100%|██████████| 139/139 [00:01<00:00, 114.70it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 287.46it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 462.41it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 513.67it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 490.83it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 202.15it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 197.04it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 199.18it/s]replace nan value:  48%|████▊     | 83/173 [00:00<00:00, 198.15it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 196.74it/s]replace nan value:  72%|███████▏  | 124/173 [00:00<00:00, 198.31it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 199.88it/s]replace nan value:  95%|█████████▌| 165/173 [00:00<00:00, 197.62it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 197.15it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.35it/s] 16%|█▌        | 28/173 [00:00<00:01, 112.79it/s] 24%|██▍       | 42/173 [00:00<00:01, 121.38it/s] 32%|███▏      | 55/173 [00:00<00:01, 101.35it/s] 40%|███▉      | 69/173 [00:00<00:00, 112.73it/s] 47%|████▋     | 81/173 [00:00<00:00, 102.62it/s] 53%|█████▎    | 92/173 [00:00<00:00, 90.35it/s]  59%|█████▉    | 102/173 [00:01<00:00, 85.26it/s] 64%|██████▍   | 111/173 [00:01<00:00, 85.07it/s] 69%|██████▉   | 120/173 [00:01<00:00, 82.85it/s] 77%|███████▋  | 134/173 [00:01<00:00, 96.78it/s] 86%|████████▌ | 149/173 [00:01<00:00, 107.75it/s] 93%|█████████▎| 161/173 [00:01<00:00, 110.11it/s]100%|██████████| 173/173 [00:01<00:00, 89.53it/s] 100%|██████████| 173/173 [00:01<00:00, 97.17it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.232, valid loss : 0.117, train acc : 0.524, valid acc : 0.158, train f1 : 0.435, valid f1 : 0.158
training process:   1%|          | 1/128 [01:09<2:27:02, 69.47s/it]Best score increase :0.000 -> 0.158
training process:   2%|▏         | 2/128 [02:07<2:11:50, 62.78s/it]Best score increase :0.158 -> 0.263
training process:   2%|▏         | 3/128 [03:10<2:11:11, 62.97s/it]Best score increase :0.263 -> 0.334
training process:   3%|▎         | 4/128 [04:11<2:08:20, 62.10s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.106, valid loss : 0.101, train acc : 0.648, valid acc : 0.345, train f1 : 0.601, valid f1 : 0.323
training process:   4%|▍         | 5/128 [05:18<2:11:04, 63.94s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [06:17<2:06:32, 62.23s/it]Best score increase :0.334 -> 0.401
training process:   5%|▌         | 7/128 [07:25<2:09:18, 64.12s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [08:36<2:12:36, 66.30s/it]Best score increase :0.401 -> 0.451
epoch : 9, train loss : 0.085, valid loss : 0.078, train acc : 0.724, valid acc : 0.575, train f1 : 0.704, valid f1 : 0.487
training process:   7%|▋         | 9/128 [09:58<2:21:14, 71.22s/it]Best score increase :0.451 -> 0.487
training process:   8%|▊         | 10/128 [11:10<2:20:18, 71.34s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [12:21<2:19:19, 71.45s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [13:33<2:17:53, 71.32s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.076, valid loss : 0.083, train acc : 0.759, valid acc : 0.543, train f1 : 0.747, valid f1 : 0.465
training process:  10%|█         | 13/128 [14:56<2:24:02, 75.15s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [16:08<2:20:47, 74.10s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [17:19<2:17:47, 73.17s/it]Best score increase :0.487 -> 0.540
training process:  12%|█▎        | 16/128 [18:31<2:15:54, 72.80s/it]Best score increase :0.540 -> 0.568
epoch : 17, train loss : 0.067, valid loss : 0.063, train acc : 0.796, valid acc : 0.700, train f1 : 0.788, valid f1 : 0.573
training process:  13%|█▎        | 17/128 [19:54<2:20:16, 75.83s/it]Best score increase :0.568 -> 0.573
training process:  14%|█▍        | 18/128 [21:03<2:15:24, 73.86s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [22:13<2:11:43, 72.51s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [23:19<2:07:25, 70.79s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.063, valid loss : 0.068, train acc : 0.814, valid acc : 0.687, train f1 : 0.808, valid f1 : 0.564
training process:  16%|█▋        | 21/128 [24:40<2:11:34, 73.78s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [25:40<2:02:45, 69.49s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [26:43<1:58:19, 67.62s/it]Best score increase :0.573 -> 0.575
training process:  19%|█▉        | 24/128 [27:42<1:52:31, 64.92s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.061, valid loss : 0.078, train acc : 0.822, valid acc : 0.645, train f1 : 0.817, valid f1 : 0.537
training process:  20%|█▉        | 25/128 [28:51<1:53:54, 66.35s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [29:53<1:50:20, 64.91s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [30:54<1:47:13, 63.69s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [31:54<1:44:22, 62.62s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.058, valid loss : 0.073, train acc : 0.827, valid acc : 0.677, train f1 : 0.823, valid f1 : 0.559
training process:  23%|██▎       | 29/128 [33:05<1:47:45, 65.31s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [34:15<1:48:35, 66.48s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [35:13<1:43:37, 64.10s/it]EarlyStopping counter : 8 out of 12
training process:  25%|██▌       | 32/128 [36:14<1:41:09, 63.22s/it]EarlyStopping counter : 9 out of 12
epoch : 33, train loss : 0.055, valid loss : 0.070, train acc : 0.843, valid acc : 0.703, train f1 : 0.839, valid f1 : 0.578
training process:  26%|██▌       | 33/128 [37:25<1:43:45, 65.53s/it]Best score increase :0.575 -> 0.578
training process:  27%|██▋       | 34/128 [38:25<1:39:54, 63.78s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [39:21<1:35:13, 61.44s/it]Best score increase :0.578 -> 0.642
training process:  28%|██▊       | 36/128 [40:21<1:33:26, 60.94s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.056, valid loss : 0.072, train acc : 0.846, valid acc : 0.699, train f1 : 0.843, valid f1 : 0.575
training process:  29%|██▉       | 37/128 [41:30<1:36:19, 63.51s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [42:30<1:33:39, 62.44s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [43:30<1:31:26, 61.65s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [44:30<1:29:49, 61.24s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.052, valid loss : 0.069, train acc : 0.854, valid acc : 0.733, train f1 : 0.851, valid f1 : 0.601
training process:  32%|███▏      | 41/128 [45:35<1:30:25, 62.36s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [46:38<1:29:40, 62.57s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [47:40<1:28:11, 62.25s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [48:38<1:25:24, 61.00s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.051, valid loss : 0.067, train acc : 0.859, valid acc : 0.736, train f1 : 0.856, valid f1 : 0.604
training process:  35%|███▌      | 45/128 [49:48<1:28:16, 63.81s/it]EarlyStopping counter : 10 out of 12
training process:  36%|███▌      | 46/128 [50:43<1:23:35, 61.17s/it]EarlyStopping counter : 11 out of 12
training process:  36%|███▌      | 46/128 [51:37<1:32:01, 67.34s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 46, best f1 score : 0.642
training process finished, best loss : 0.057 and best acc : 0.785, best f1 : 0.642, best epoch : 34

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.29      0.93      0.44       580
           1       0.99      0.80      0.89      6818

    accuracy                           0.81      7398
   macro avg       0.64      0.86      0.66      7398
weighted avg       0.94      0.81      0.85      7398


# test acc : 0.81, test f1 : 0.66, test AUC : 0.86, test loss : 3.181

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:32,  8.37s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:29,  8.90s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:20,  8.90s/it]processing for feature importance:  33%|███▎      | 4/12 [00:36<01:15,  9.43s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:06,  9.55s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:58,  9.76s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:06<00:49,  9.89s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:15<00:37,  9.49s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:23<00:26,  8.92s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:31<00:17,  8.59s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:39<00:08,  8.59s/it]processing for feature importance: 100%|██████████| 12/12 [01:47<00:00,  8.39s/it]processing for feature importance: 100%|██████████| 12/12 [01:47<00:00,  8.96s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 34/306 [00:00<00:00, 310.43it/s] 22%|██▏       | 66/306 [00:00<00:00, 308.92it/s] 32%|███▏      | 97/306 [00:00<00:00, 296.49it/s] 42%|████▏     | 127/306 [00:00<00:00, 292.60it/s] 52%|█████▏    | 159/306 [00:00<00:00, 299.39it/s] 63%|██████▎   | 194/306 [00:00<00:00, 302.87it/s] 74%|███████▎  | 225/306 [00:00<00:00, 300.07it/s] 84%|████████▍ | 257/306 [00:00<00:00, 298.92it/s] 94%|█████████▍| 287/306 [00:01<00:00, 246.62it/s]100%|██████████| 306/306 [00:01<00:00, 269.18it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 474.14it/s]extract the null data:  17%|█▋        | 96/553 [00:00<00:00, 476.26it/s]extract the null data:  26%|██▌       | 144/553 [00:00<00:00, 466.26it/s]extract the null data:  35%|███▍      | 193/553 [00:00<00:00, 474.43it/s]extract the null data:  44%|████▍     | 242/553 [00:00<00:00, 478.28it/s]extract the null data:  52%|█████▏    | 290/553 [00:00<00:00, 470.59it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 472.92it/s]extract the null data:  70%|███████   | 388/553 [00:00<00:00, 480.78it/s]extract the null data:  79%|███████▉  | 437/553 [00:00<00:00, 476.80it/s]extract the null data:  88%|████████▊ | 486/553 [00:01<00:00, 477.70it/s]extract the null data:  97%|█████████▋| 534/553 [00:01<00:00, 472.24it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 472.89it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 159.59it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 161.06it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 160.20it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:03, 134.38it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:03, 122.65it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:03, 133.29it/s]replace nan value:  21%|██        | 114/553 [00:00<00:03, 141.83it/s]replace nan value:  24%|██▎       | 131/553 [00:00<00:02, 148.87it/s]replace nan value:  27%|██▋       | 148/553 [00:01<00:02, 153.20it/s]replace nan value:  30%|██▉       | 165/553 [00:01<00:02, 156.90it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 160.61it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:02, 163.87it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:02, 164.83it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:01, 164.45it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 165.02it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 164.01it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 157.72it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 159.97it/s]replace nan value:  58%|█████▊    | 319/553 [00:02<00:01, 161.26it/s]replace nan value:  61%|██████    | 336/553 [00:02<00:01, 161.31it/s]replace nan value:  64%|██████▍   | 353/553 [00:02<00:01, 161.50it/s]replace nan value:  67%|██████▋   | 370/553 [00:02<00:01, 160.05it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:01, 158.54it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 153.66it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 150.61it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 148.32it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 141.98it/s]replace nan value:  84%|████████▍ | 467/553 [00:03<00:00, 147.27it/s]replace nan value:  88%|████████▊ | 484/553 [00:03<00:00, 151.22it/s]replace nan value:  90%|█████████ | 500/553 [00:03<00:00, 153.52it/s]replace nan value:  93%|█████████▎| 516/553 [00:03<00:00, 154.98it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 154.35it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 155.08it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 153.73it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 9/553 [00:00<00:06, 88.07it/s]  4%|▍         | 24/553 [00:00<00:04, 122.00it/s]  7%|▋         | 39/553 [00:00<00:04, 127.95it/s]  9%|▉         | 52/553 [00:00<00:05, 89.69it/s]  11%|█▏        | 63/553 [00:00<00:05, 91.06it/s] 14%|█▎        | 75/553 [00:00<00:04, 98.15it/s] 16%|█▌        | 89/553 [00:00<00:04, 107.31it/s] 18%|█▊        | 101/553 [00:00<00:04, 105.18it/s] 21%|██        | 116/553 [00:01<00:03, 117.35it/s] 23%|██▎       | 129/553 [00:01<00:03, 115.49it/s] 26%|██▌       | 145/553 [00:01<00:03, 127.63it/s] 29%|██▉       | 161/553 [00:01<00:02, 135.58it/s] 32%|███▏      | 175/553 [00:01<00:02, 136.35it/s] 34%|███▍      | 189/553 [00:01<00:02, 124.23it/s] 37%|███▋      | 202/553 [00:01<00:03, 102.49it/s] 39%|███▉      | 215/553 [00:01<00:03, 108.24it/s] 41%|████      | 228/553 [00:02<00:02, 112.83it/s] 44%|████▍     | 242/553 [00:02<00:02, 115.90it/s] 46%|████▌     | 254/553 [00:02<00:02, 113.84it/s] 48%|████▊     | 268/553 [00:02<00:02, 119.64it/s] 51%|█████     | 281/553 [00:02<00:02, 120.21it/s] 53%|█████▎    | 294/553 [00:02<00:02, 91.63it/s]  55%|█████▌    | 305/553 [00:02<00:03, 80.96it/s] 57%|█████▋    | 315/553 [00:03<00:03, 73.44it/s] 59%|█████▉    | 326/553 [00:03<00:02, 79.13it/s] 61%|██████    | 338/553 [00:03<00:02, 87.68it/s] 63%|██████▎   | 349/553 [00:03<00:02, 93.00it/s] 65%|██████▌   | 360/553 [00:03<00:02, 94.28it/s] 68%|██████▊   | 376/553 [00:03<00:01, 108.03it/s] 70%|███████   | 388/553 [00:03<00:01, 106.72it/s] 72%|███████▏  | 399/553 [00:03<00:01, 91.80it/s]  75%|███████▍  | 414/553 [00:03<00:01, 104.73it/s] 77%|███████▋  | 426/553 [00:04<00:01, 98.70it/s]  79%|███████▉  | 439/553 [00:04<00:01, 106.26it/s] 82%|████████▏ | 454/553 [00:04<00:00, 117.47it/s] 84%|████████▍ | 467/553 [00:04<00:00, 97.21it/s]  87%|████████▋ | 479/553 [00:04<00:00, 100.71it/s] 89%|████████▊ | 490/553 [00:04<00:00, 102.04it/s] 91%|█████████ | 501/553 [00:04<00:00, 80.27it/s]  93%|█████████▎| 514/553 [00:05<00:00, 88.51it/s] 95%|█████████▍| 524/553 [00:05<00:00, 73.17it/s] 96%|█████████▋| 533/553 [00:05<00:00, 69.14it/s] 99%|█████████▉| 548/553 [00:05<00:00, 85.44it/s]100%|██████████| 553/553 [00:05<00:00, 98.49it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 268.28it/s]extract the null data:  55%|█████▌    | 77/139 [00:00<00:00, 402.50it/s]extract the null data:  94%|█████████▍| 131/139 [00:00<00:00, 462.56it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 435.98it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 186.29it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 168.37it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 173.39it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 176.72it/s]replace nan value:  68%|██████▊   | 94/139 [00:00<00:00, 169.24it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 173.16it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 177.51it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 175.62it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.88it/s] 16%|█▌        | 22/139 [00:00<00:01, 105.83it/s] 26%|██▌       | 36/139 [00:00<00:00, 119.03it/s] 35%|███▌      | 49/139 [00:00<00:00, 119.73it/s] 44%|████▍     | 61/139 [00:00<00:00, 110.08it/s] 54%|█████▍    | 75/139 [00:00<00:00, 119.42it/s] 63%|██████▎   | 88/139 [00:00<00:00, 84.01it/s]  75%|███████▍  | 104/139 [00:00<00:00, 100.47it/s] 85%|████████▍ | 118/139 [00:01<00:00, 109.05it/s] 94%|█████████▍| 131/139 [00:01<00:00, 113.59it/s]100%|██████████| 139/139 [00:01<00:00, 109.30it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   6%|▋         | 11/173 [00:00<00:01, 107.82it/s]extract the null data:  26%|██▌       | 45/173 [00:00<00:00, 220.59it/s]extract the null data:  39%|███▊      | 67/173 [00:00<00:00, 214.36it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 221.52it/s]extract the null data:  69%|██████▉   | 119/173 [00:00<00:00, 236.68it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 246.56it/s]extract the null data:  99%|█████████▉| 172/173 [00:00<00:00, 237.90it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 228.84it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   6%|▌         | 10/173 [00:00<00:01, 97.00it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:01, 88.87it/s]replace nan value:  17%|█▋        | 30/173 [00:00<00:01, 92.54it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:01, 89.12it/s]replace nan value:  32%|███▏      | 55/173 [00:00<00:01, 108.97it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 131.61it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 144.79it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 153.98it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 162.32it/s]replace nan value:  84%|████████▍ | 146/173 [00:01<00:00, 166.95it/s]replace nan value:  95%|█████████▍| 164/173 [00:01<00:00, 169.37it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 142.10it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 127.98it/s] 15%|█▌        | 26/173 [00:00<00:01, 116.02it/s] 24%|██▍       | 42/173 [00:00<00:00, 132.61it/s] 34%|███▎      | 58/173 [00:00<00:00, 141.93it/s] 42%|████▏     | 73/173 [00:00<00:00, 139.53it/s] 51%|█████     | 88/173 [00:00<00:00, 137.91it/s] 60%|█████▉    | 103/173 [00:00<00:00, 137.83it/s] 68%|██████▊   | 118/173 [00:00<00:00, 132.68it/s] 76%|███████▋  | 132/173 [00:00<00:00, 130.74it/s] 84%|████████▍ | 146/173 [00:01<00:00, 130.51it/s] 92%|█████████▏| 160/173 [00:01<00:00, 121.57it/s]100%|██████████| 173/173 [00:01<00:00, 92.19it/s] 100%|██████████| 173/173 [00:01<00:00, 118.55it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.457, valid loss : 0.357, train f1 : 0.542, valid f1 : 0.556
training process - Deferred Re-weighting:   1%|          | 1/128 [01:26<3:02:48, 86.36s/it]Best score increase :0.000 -> 0.556
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:39<2:45:26, 78.78s/it]Best score increase :0.556 -> 0.584
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:53<2:39:16, 76.45s/it]Best score increase :0.584 -> 0.669
training process - Deferred Re-weighting:   3%|▎         | 4/128 [05:05<2:34:42, 74.86s/it]Best score increase :0.669 -> 0.739
epoch : 5, train loss : 0.218, valid loss : 0.208, train f1 : 0.748, valid f1 : 0.763
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:28<2:39:03, 77.59s/it]Best score increase :0.739 -> 0.763
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:38<2:32:23, 74.95s/it]Best score increase :0.763 -> 0.766
training process - Deferred Re-weighting:   5%|▌         | 7/128 [08:51<2:30:03, 74.41s/it]Best score increase :0.766 -> 0.782
training process - Deferred Re-weighting:   6%|▋         | 8/128 [10:04<2:27:52, 73.94s/it]Best score increase :0.782 -> 0.795
epoch : 9, train loss : 0.165, valid loss : 0.167, train f1 : 0.804, valid f1 : 0.794
training process - Deferred Re-weighting:   7%|▋         | 9/128 [11:30<2:34:14, 77.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [12:37<2:26:16, 74.38s/it]Best score increase :0.795 -> 0.798
training process - Deferred Re-weighting:   9%|▊         | 11/128 [13:46<2:22:05, 72.87s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [14:58<2:20:04, 72.45s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.148, valid loss : 0.155, train f1 : 0.813, valid f1 : 0.801
training process - Deferred Re-weighting:  10%|█         | 13/128 [16:23<2:26:06, 76.23s/it]Best score increase :0.798 -> 0.801
training process - Deferred Re-weighting:  11%|█         | 14/128 [17:30<2:19:29, 73.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [18:39<2:15:49, 72.12s/it]Best score increase :0.801 -> 0.805
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [19:48<2:12:58, 71.23s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.142, valid loss : 0.146, train f1 : 0.821, valid f1 : 0.814
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [21:14<2:20:14, 75.81s/it]Best score increase :0.805 -> 0.814
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [22:27<2:17:14, 74.86s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [23:34<2:11:39, 72.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [24:44<2:09:20, 71.86s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.133, valid loss : 0.144, train f1 : 0.834, valid f1 : 0.809
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [26:05<2:12:58, 74.56s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [27:06<2:04:21, 70.39s/it]Best score increase :0.814 -> 0.833
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [28:06<1:57:46, 67.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [29:07<1:53:10, 65.30s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.128, valid loss : 0.134, train f1 : 0.841, valid f1 : 0.845
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [30:21<1:56:53, 68.09s/it]Best score increase :0.833 -> 0.845
training process - Deferred Re-weighting:  20%|██        | 26/128 [31:20<1:51:03, 65.33s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [32:21<1:47:53, 64.09s/it]Best score increase :0.845 -> 0.848
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [33:21<1:44:37, 62.78s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.123, valid loss : 0.131, train f1 : 0.845, valid f1 : 0.840
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [34:35<1:49:09, 66.15s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [35:46<1:50:30, 67.66s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [36:47<1:45:56, 65.53s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [37:47<1:42:24, 64.01s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.120, valid loss : 0.136, train f1 : 0.847, valid f1 : 0.825
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [38:58<1:44:35, 66.06s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [39:56<1:39:50, 63.73s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [40:55<1:36:24, 62.20s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [41:56<1:34:45, 61.80s/it]Best score increase :0.848 -> 0.856
epoch : 37, train loss : 0.115, valid loss : 0.134, train f1 : 0.858, valid f1 : 0.828
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [43:06<1:37:18, 64.16s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [44:08<1:35:24, 63.61s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [45:11<1:34:19, 63.59s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [46:11<1:31:32, 62.42s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.112, valid loss : 0.127, train f1 : 0.856, valid f1 : 0.835
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [47:22<1:34:10, 64.94s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [48:22<1:30:53, 63.41s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [49:20<1:27:46, 61.96s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [50:19<1:25:29, 61.07s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.109, valid loss : 0.128, train f1 : 0.859, valid f1 : 0.830
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [51:29<1:28:08, 63.72s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [52:31<1:26:15, 63.11s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [53:32<1:24:18, 62.45s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [54:31<1:33:57, 69.60s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.856
training process finished, best loss : 0.130, best acc : 0.959, best f1 : 0.856, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.80      0.71      0.75       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.89      0.85      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.85, test loss : 8.597

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:47,  9.79s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:44, 10.43s/it]processing for feature importance:  25%|██▌       | 3/12 [00:30<01:30, 10.11s/it]processing for feature importance:  33%|███▎      | 4/12 [00:41<01:22, 10.34s/it]processing for feature importance:  42%|████▏     | 5/12 [00:51<01:12, 10.38s/it]processing for feature importance:  50%|█████     | 6/12 [01:01<01:01, 10.20s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:11<00:50, 10.04s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:21<00:41, 10.29s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:32<00:31, 10.43s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:42<00:20, 10.19s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:51<00:09,  9.74s/it]processing for feature importance: 100%|██████████| 12/12 [02:00<00:00,  9.81s/it]processing for feature importance: 100%|██████████| 12/12 [02:00<00:00, 10.08s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 13%|█▎        | 41/306 [00:00<00:00, 400.08it/s] 27%|██▋       | 82/306 [00:00<00:00, 291.13it/s] 37%|███▋      | 113/306 [00:00<00:00, 223.92it/s] 49%|████▊     | 149/306 [00:00<00:00, 262.27it/s] 58%|█████▊    | 178/306 [00:00<00:00, 255.04it/s] 67%|██████▋   | 206/306 [00:00<00:00, 229.82it/s] 80%|████████  | 245/306 [00:00<00:00, 271.41it/s] 97%|█████████▋| 297/306 [00:01<00:00, 337.88it/s]100%|██████████| 306/306 [00:01<00:00, 288.09it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 39/553 [00:00<00:01, 383.32it/s]extract the null data:  15%|█▌        | 83/553 [00:00<00:01, 414.81it/s]extract the null data:  23%|██▎       | 129/553 [00:00<00:00, 434.49it/s]extract the null data:  32%|███▏      | 178/553 [00:00<00:00, 454.05it/s]extract the null data:  41%|████      | 226/553 [00:00<00:00, 462.45it/s]extract the null data:  50%|████▉     | 274/553 [00:00<00:00, 465.53it/s]extract the null data:  58%|█████▊    | 321/553 [00:00<00:00, 461.84it/s]extract the null data:  67%|██████▋   | 368/553 [00:00<00:00, 408.83it/s]extract the null data:  75%|███████▌  | 416/553 [00:00<00:00, 427.79it/s]extract the null data:  84%|████████▎ | 462/553 [00:01<00:00, 435.46it/s]extract the null data:  92%|█████████▏| 507/553 [00:01<00:00, 413.95it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 424.20it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 432.17it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 149.96it/s]replace nan value:   6%|▌         | 32/553 [00:00<00:03, 157.92it/s]replace nan value:   9%|▉         | 49/553 [00:00<00:03, 160.46it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:03, 161.21it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 162.12it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 163.33it/s]replace nan value:  21%|██        | 117/553 [00:00<00:02, 154.87it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 158.37it/s]replace nan value:  27%|██▋       | 151/553 [00:00<00:02, 161.40it/s]replace nan value:  31%|███       | 169/553 [00:01<00:02, 165.46it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 169.08it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 169.11it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:02, 165.16it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 164.87it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 163.91it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 164.54it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 165.21it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 164.74it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 163.93it/s]replace nan value:  61%|██████▏   | 340/553 [00:02<00:01, 162.32it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 162.05it/s]replace nan value:  68%|██████▊   | 374/553 [00:02<00:01, 127.84it/s]replace nan value:  70%|███████   | 388/553 [00:02<00:01, 126.49it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:01, 133.75it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 143.02it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 149.37it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 156.42it/s]replace nan value:  86%|████████▌ | 473/553 [00:03<00:00, 155.79it/s]replace nan value:  88%|████████▊ | 489/553 [00:03<00:00, 135.43it/s]replace nan value:  91%|█████████ | 504/553 [00:03<00:00, 118.39it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 132.25it/s]replace nan value:  98%|█████████▊| 540/553 [00:03<00:00, 142.77it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 152.20it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 126.90it/s]  5%|▍         | 26/553 [00:00<00:04, 127.27it/s]  7%|▋         | 40/553 [00:00<00:03, 128.49it/s] 10%|▉         | 53/553 [00:00<00:05, 92.44it/s]  12%|█▏        | 64/553 [00:00<00:05, 93.39it/s] 14%|█▍        | 77/553 [00:00<00:04, 102.59it/s] 16%|█▌        | 88/553 [00:00<00:04, 101.80it/s] 18%|█▊        | 99/553 [00:00<00:04, 98.28it/s]  21%|██        | 115/553 [00:01<00:03, 114.67it/s] 23%|██▎       | 127/553 [00:01<00:03, 113.92it/s] 26%|██▌       | 144/553 [00:01<00:03, 129.04it/s] 29%|██▉       | 161/553 [00:01<00:02, 140.08it/s] 32%|███▏      | 176/553 [00:01<00:02, 141.44it/s] 35%|███▍      | 192/553 [00:01<00:02, 143.13it/s] 38%|███▊      | 209/553 [00:01<00:02, 150.47it/s] 41%|████      | 225/553 [00:01<00:02, 140.90it/s] 43%|████▎     | 240/553 [00:01<00:02, 141.88it/s] 46%|████▌     | 255/553 [00:02<00:02, 100.11it/s] 48%|████▊     | 267/553 [00:02<00:03, 83.62it/s]  50%|█████     | 278/553 [00:02<00:03, 88.64it/s] 53%|█████▎    | 292/553 [00:02<00:02, 94.82it/s] 55%|█████▍    | 303/553 [00:02<00:02, 86.54it/s] 57%|█████▋    | 314/553 [00:02<00:02, 91.57it/s] 59%|█████▉    | 327/553 [00:02<00:02, 99.53it/s] 61%|██████▏   | 340/553 [00:03<00:02, 103.81it/s] 63%|██████▎   | 351/553 [00:03<00:02, 99.39it/s]  65%|██████▌   | 362/553 [00:03<00:02, 89.65it/s] 67%|██████▋   | 373/553 [00:03<00:01, 94.11it/s] 70%|██████▉   | 385/553 [00:03<00:01, 95.04it/s] 71%|███████▏  | 395/553 [00:03<00:01, 83.01it/s] 74%|███████▍  | 408/553 [00:03<00:01, 94.27it/s] 76%|███████▌  | 419/553 [00:03<00:01, 97.28it/s] 78%|███████▊  | 430/553 [00:04<00:01, 100.21it/s] 81%|████████  | 448/553 [00:04<00:00, 120.02it/s] 84%|████████▎ | 463/553 [00:04<00:00, 126.78it/s] 86%|████████▋ | 477/553 [00:04<00:00, 130.34it/s] 89%|████████▉ | 491/553 [00:04<00:00, 120.48it/s] 91%|█████████ | 504/553 [00:04<00:00, 119.62it/s] 94%|█████████▍| 519/553 [00:04<00:00, 120.01it/s] 96%|█████████▌| 532/553 [00:04<00:00, 99.23it/s]  99%|█████████▉| 548/553 [00:05<00:00, 111.92it/s]100%|██████████| 553/553 [00:05<00:00, 106.47it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 276.70it/s]extract the null data:  60%|█████▉    | 83/139 [00:00<00:00, 433.76it/s]extract the null data:  97%|█████████▋| 135/139 [00:00<00:00, 470.26it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 424.49it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:   7%|▋         | 10/139 [00:00<00:01, 97.18it/s]replace nan value:  21%|██        | 29/139 [00:00<00:00, 149.40it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 166.81it/s]replace nan value:  47%|████▋     | 65/139 [00:00<00:00, 134.35it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 151.01it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 161.89it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 145.89it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 131.38it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 141.51it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.35it/s] 17%|█▋        | 24/139 [00:00<00:00, 119.37it/s] 26%|██▌       | 36/139 [00:00<00:00, 108.30it/s] 35%|███▌      | 49/139 [00:00<00:00, 113.96it/s] 44%|████▍     | 61/139 [00:00<00:00, 111.41it/s] 53%|█████▎    | 74/139 [00:00<00:00, 115.34it/s] 62%|██████▏   | 86/139 [00:00<00:00, 94.07it/s]  69%|██████▉   | 96/139 [00:00<00:00, 91.96it/s] 78%|███████▊  | 109/139 [00:01<00:00, 100.10it/s] 91%|█████████ | 126/139 [00:01<00:00, 116.41it/s]100%|██████████| 139/139 [00:01<00:00, 111.17it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 206.95it/s]extract the null data:  43%|████▎     | 75/173 [00:00<00:00, 400.30it/s]extract the null data:  77%|███████▋  | 133/173 [00:00<00:00, 479.33it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 460.51it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 192.32it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 192.19it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 190.77it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 189.21it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 189.75it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 191.02it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 190.44it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 182.00it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 186.58it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 125.03it/s] 15%|█▌        | 26/173 [00:00<00:01, 115.61it/s] 25%|██▍       | 43/173 [00:00<00:00, 136.30it/s] 34%|███▍      | 59/173 [00:00<00:00, 145.04it/s] 43%|████▎     | 74/173 [00:00<00:00, 145.37it/s] 51%|█████▏    | 89/173 [00:00<00:00, 144.14it/s] 60%|██████    | 104/173 [00:00<00:00, 143.84it/s] 69%|██████▉   | 119/173 [00:00<00:00, 144.75it/s] 77%|███████▋  | 134/173 [00:00<00:00, 139.32it/s] 86%|████████▌ | 148/173 [00:01<00:00, 114.93it/s] 93%|█████████▎| 161/173 [00:01<00:00, 109.28it/s]100%|██████████| 173/173 [00:01<00:00, 90.15it/s] 100%|██████████| 173/173 [00:01<00:00, 118.27it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.577, valid loss : 0.406, train f1 : 0.706, valid f1 : 0.656
training process - Deferred Re-weighting:   1%|          | 1/128 [01:16<2:40:54, 76.02s/it]Best score increase :0.000 -> 0.656
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:20<2:24:49, 68.96s/it]Best score increase :0.656 -> 0.700
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:21<2:16:15, 65.41s/it]Best score increase :0.700 -> 0.741
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:18<2:08:54, 62.37s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.366, valid loss : 0.307, train f1 : 0.839, valid f1 : 0.732
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:30<2:14:34, 65.65s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:32<2:11:08, 64.50s/it]Best score increase :0.741 -> 0.755
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:30<2:05:37, 62.29s/it]Best score increase :0.755 -> 0.772
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:29<2:02:24, 61.20s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.312, valid loss : 0.238, train f1 : 0.866, valid f1 : 0.791
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:41<2:07:57, 64.51s/it]Best score increase :0.772 -> 0.791
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:42<2:04:59, 63.56s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:44<2:03:05, 63.12s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:42<1:58:57, 61.53s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.292, valid loss : 0.239, train f1 : 0.873, valid f1 : 0.791
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:50<2:01:36, 63.45s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:48<1:57:25, 61.80s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:48<1:55:10, 61.16s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:41<1:49:59, 58.92s/it]Best score increase :0.791 -> 0.797
epoch : 17, train loss : 0.275, valid loss : 0.229, train f1 : 0.885, valid f1 : 0.793
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:38<1:48:00, 58.38s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:29<1:42:29, 55.90s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:18<1:38:09, 54.03s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:06<1:34:01, 52.23s/it]Best score increase :0.797 -> 0.812
epoch : 21, train loss : 0.254, valid loss : 0.207, train f1 : 0.893, valid f1 : 0.802
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [21:05<1:36:46, 54.26s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [21:55<1:33:17, 52.80s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [22:46<1:31:44, 52.42s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [23:40<1:31:31, 52.80s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.243, valid loss : 0.242, train f1 : 0.901, valid f1 : 0.779
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [24:56<1:42:46, 59.87s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [25:50<1:38:39, 58.03s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [26:47<1:37:12, 57.74s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [27:41<1:34:19, 56.59s/it]Best score increase :0.812 -> 0.821
epoch : 29, train loss : 0.235, valid loss : 0.210, train f1 : 0.901, valid f1 : 0.811
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [28:46<1:37:44, 59.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [29:44<1:36:05, 58.83s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [30:40<1:33:33, 57.87s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [31:33<1:30:34, 56.61s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.219, valid loss : 0.241, train f1 : 0.909, valid f1 : 0.786
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [32:37<1:32:43, 58.56s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [33:32<1:30:04, 57.49s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [34:28<1:28:47, 57.29s/it]Best score increase :0.821 -> 0.833
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [35:25<1:27:23, 56.99s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.224, valid loss : 0.248, train f1 : 0.908, valid f1 : 0.774
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [36:30<1:30:10, 59.46s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [37:29<1:28:55, 59.28s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [38:27<1:27:16, 58.84s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [39:24<1:25:35, 58.36s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.208, valid loss : 0.223, train f1 : 0.916, valid f1 : 0.799
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [40:38<1:31:30, 63.11s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [41:34<1:27:23, 60.97s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [42:30<1:24:06, 59.37s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [43:25<1:21:26, 58.17s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.202, valid loss : 0.198, train f1 : 0.917, valid f1 : 0.825
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [44:29<1:23:01, 60.02s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [45:23<1:19:28, 58.15s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [46:18<1:22:32, 60.39s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 46, best f1 score : 0.833
training process finished, best loss : 0.174, best acc : 0.940, best f1 : 0.833, best epoch : 34

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.80      0.65       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.87      0.81      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.81, test AUC : 0.87, test loss : 10.951

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:45,  9.61s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:28,  8.87s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:19,  8.79s/it]processing for feature importance:  33%|███▎      | 4/12 [00:36<01:12,  9.06s/it]processing for feature importance:  42%|████▏     | 5/12 [00:44<01:02,  8.95s/it]processing for feature importance:  50%|█████     | 6/12 [00:52<00:51,  8.59s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:42,  8.43s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:09<00:34,  8.52s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:18<00:26,  8.73s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:28<00:18,  9.08s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:37<00:08,  8.91s/it]processing for feature importance: 100%|██████████| 12/12 [01:45<00:00,  8.78s/it]processing for feature importance: 100%|██████████| 12/12 [01:45<00:00,  8.81s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 13%|█▎        | 39/306 [00:00<00:00, 381.26it/s] 25%|██▌       | 78/306 [00:00<00:00, 381.22it/s] 38%|███▊      | 117/306 [00:00<00:00, 381.57it/s] 51%|█████     | 156/306 [00:00<00:00, 384.39it/s] 64%|██████▎   | 195/306 [00:00<00:00, 383.81it/s] 77%|███████▋  | 235/306 [00:00<00:00, 387.82it/s] 90%|████████▉ | 275/306 [00:00<00:00, 390.99it/s]100%|██████████| 306/306 [00:00<00:00, 387.94it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 573.65it/s]extract the null data:  22%|██▏       | 121/553 [00:00<00:00, 601.98it/s]extract the null data:  33%|███▎      | 182/553 [00:00<00:00, 583.41it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 582.03it/s]extract the null data:  54%|█████▍    | 300/553 [00:00<00:00, 576.17it/s]extract the null data:  65%|██████▍   | 358/553 [00:00<00:00, 567.59it/s]extract the null data:  75%|███████▌  | 415/553 [00:00<00:00, 563.63it/s]extract the null data:  85%|████████▌ | 472/553 [00:00<00:00, 563.42it/s]extract the null data:  96%|█████████▌| 529/553 [00:00<00:00, 560.70it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 569.48it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 189.43it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 191.45it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 190.78it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:02, 192.90it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 192.82it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 195.49it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 194.07it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 194.29it/s]replace nan value:  33%|███▎      | 180/553 [00:00<00:01, 195.69it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:01, 194.06it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 193.01it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 192.87it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 193.72it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 194.88it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 195.08it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 195.27it/s]replace nan value:  62%|██████▏   | 341/553 [00:01<00:01, 196.94it/s]replace nan value:  65%|██████▌   | 362/553 [00:01<00:00, 200.14it/s]replace nan value:  69%|██████▉   | 383/553 [00:01<00:00, 198.01it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 193.05it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 192.99it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 194.74it/s]replace nan value:  84%|████████▎ | 463/553 [00:02<00:00, 195.61it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 195.98it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 198.17it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 198.35it/s]replace nan value:  99%|█████████▊| 546/553 [00:02<00:00, 203.50it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 195.69it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.03it/s]  5%|▍         | 25/553 [00:00<00:04, 122.31it/s]  7%|▋         | 39/553 [00:00<00:04, 124.00it/s]  9%|▉         | 52/553 [00:00<00:04, 110.13it/s] 12%|█▏        | 64/553 [00:00<00:04, 101.57it/s] 14%|█▎        | 76/553 [00:00<00:04, 105.62it/s] 16%|█▌        | 89/553 [00:00<00:04, 109.35it/s] 18%|█▊        | 101/553 [00:00<00:04, 104.59it/s] 21%|██        | 116/553 [00:01<00:03, 115.62it/s] 23%|██▎       | 128/553 [00:01<00:03, 115.12it/s] 26%|██▌       | 143/553 [00:01<00:03, 124.47it/s] 29%|██▉       | 159/553 [00:01<00:02, 134.62it/s] 31%|███▏      | 173/553 [00:01<00:02, 134.01it/s] 34%|███▍      | 187/553 [00:01<00:02, 127.33it/s] 37%|███▋      | 202/553 [00:01<00:02, 130.54it/s] 39%|███▉      | 216/553 [00:01<00:02, 131.67it/s] 42%|████▏     | 230/553 [00:01<00:02, 122.03it/s] 44%|████▍     | 243/553 [00:02<00:02, 123.63it/s] 46%|████▋     | 256/553 [00:02<00:02, 119.57it/s] 49%|████▊     | 269/553 [00:02<00:02, 120.50it/s] 51%|█████     | 282/553 [00:02<00:02, 117.14it/s] 53%|█████▎    | 294/553 [00:02<00:02, 114.48it/s] 55%|█████▌    | 306/553 [00:02<00:02, 109.61it/s] 58%|█████▊    | 318/553 [00:02<00:02, 108.00it/s] 59%|█████▉    | 329/553 [00:02<00:02, 107.79it/s] 62%|██████▏   | 342/553 [00:02<00:01, 113.69it/s] 64%|██████▍   | 354/553 [00:03<00:01, 114.17it/s] 66%|██████▌   | 366/553 [00:03<00:01, 113.98it/s] 69%|██████▊   | 380/553 [00:03<00:01, 120.41it/s] 71%|███████   | 393/553 [00:03<00:01, 110.76it/s] 73%|███████▎  | 406/553 [00:03<00:01, 114.41it/s] 76%|███████▌  | 418/553 [00:03<00:01, 112.03it/s] 78%|███████▊  | 430/553 [00:03<00:01, 109.88it/s] 81%|████████  | 448/553 [00:03<00:00, 126.96it/s] 84%|████████▎ | 462/553 [00:03<00:00, 130.44it/s] 86%|████████▌ | 476/553 [00:04<00:00, 132.18it/s] 89%|████████▊ | 490/553 [00:04<00:00, 123.06it/s] 91%|█████████ | 503/553 [00:04<00:00, 118.72it/s] 94%|█████████▎| 518/553 [00:04<00:00, 125.62it/s] 96%|█████████▌| 531/553 [00:04<00:00, 105.44it/s] 99%|█████████▉| 547/553 [00:04<00:00, 116.07it/s]100%|██████████| 553/553 [00:04<00:00, 116.00it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  28%|██▊       | 39/139 [00:00<00:00, 387.87it/s]extract the null data:  69%|██████▉   | 96/139 [00:00<00:00, 493.70it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 501.31it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 206.10it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 202.64it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 200.75it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 199.62it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 200.14it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 206.14it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 203.10it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.69it/s] 17%|█▋        | 24/139 [00:00<00:00, 117.22it/s] 27%|██▋       | 38/139 [00:00<00:00, 124.43it/s] 37%|███▋      | 51/139 [00:00<00:00, 118.53it/s] 45%|████▌     | 63/139 [00:00<00:00, 117.63it/s] 54%|█████▍    | 75/139 [00:00<00:00, 116.25it/s] 63%|██████▎   | 87/139 [00:00<00:00, 108.83it/s] 71%|███████   | 99/139 [00:00<00:00, 111.93it/s] 81%|████████▏ | 113/139 [00:00<00:00, 119.86it/s] 92%|█████████▏| 128/139 [00:01<00:00, 128.65it/s]100%|██████████| 139/139 [00:01<00:00, 121.77it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 317.75it/s]extract the null data:  49%|████▉     | 85/173 [00:00<00:00, 441.98it/s]extract the null data:  83%|████████▎ | 144/173 [00:00<00:00, 508.49it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 488.80it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 202.66it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 201.97it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 204.20it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 212.91it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 203.07it/s]replace nan value:  75%|███████▍  | 129/173 [00:00<00:00, 203.11it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 200.91it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 197.43it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 201.36it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.68it/s] 16%|█▌        | 27/173 [00:00<00:01, 111.60it/s] 24%|██▎       | 41/173 [00:00<00:01, 122.76it/s] 32%|███▏      | 56/173 [00:00<00:00, 132.49it/s] 40%|████      | 70/173 [00:00<00:00, 130.45it/s] 49%|████▊     | 84/173 [00:00<00:00, 129.22it/s] 57%|█████▋    | 98/173 [00:00<00:00, 130.96it/s] 65%|██████▌   | 113/173 [00:00<00:00, 131.96it/s] 73%|███████▎  | 127/173 [00:01<00:00, 124.10it/s] 81%|████████  | 140/173 [00:01<00:00, 123.92it/s] 88%|████████▊ | 153/173 [00:01<00:00, 117.28it/s] 95%|█████████▌| 165/173 [00:01<00:00, 106.30it/s]100%|██████████| 173/173 [00:01<00:00, 112.04it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.096, valid loss : 0.075, train acc : 0.895, valid acc : 0.918, train f1 : 0.557, valid f1 : 0.584
training process:   1%|          | 1/128 [00:59<2:05:25, 59.25s/it]Best score increase :0.000 -> 0.584
training process:   2%|▏         | 2/128 [01:50<1:54:12, 54.39s/it]Best score increase :0.584 -> 0.645
training process:   2%|▏         | 3/128 [02:40<1:49:30, 52.57s/it]Best score increase :0.645 -> 0.712
training process:   3%|▎         | 4/128 [03:31<1:47:13, 51.89s/it]Best score increase :0.712 -> 0.766
epoch : 5, train loss : 0.048, valid loss : 0.049, train acc : 0.945, valid acc : 0.946, train f1 : 0.763, valid f1 : 0.779
training process:   4%|▍         | 5/128 [04:30<1:51:41, 54.49s/it]Best score increase :0.766 -> 0.779
training process:   5%|▍         | 6/128 [05:23<1:49:34, 53.89s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:25<1:54:07, 56.59s/it]Best score increase :0.779 -> 0.785
training process:   6%|▋         | 8/128 [07:23<1:54:05, 57.05s/it]Best score increase :0.785 -> 0.796
epoch : 9, train loss : 0.041, valid loss : 0.043, train acc : 0.953, valid acc : 0.950, train f1 : 0.807, valid f1 : 0.788
training process:   7%|▋         | 9/128 [08:24<1:55:51, 58.41s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:30<1:59:06, 60.56s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [10:31<1:58:25, 60.73s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [11:33<1:58:11, 61.14s/it]Best score increase :0.796 -> 0.806
epoch : 13, train loss : 0.038, valid loss : 0.040, train acc : 0.956, valid acc : 0.952, train f1 : 0.819, valid f1 : 0.808
training process:  10%|█         | 13/128 [12:36<1:58:09, 61.65s/it]Best score increase :0.806 -> 0.808
training process:  11%|█         | 14/128 [13:29<1:52:01, 58.96s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [14:21<1:47:27, 57.05s/it]Best score increase :0.808 -> 0.813
training process:  12%|█▎        | 16/128 [15:16<1:45:17, 56.41s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.037, valid loss : 0.039, train acc : 0.957, valid acc : 0.953, train f1 : 0.825, valid f1 : 0.807
training process:  13%|█▎        | 17/128 [16:29<1:53:40, 61.45s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [17:18<1:45:53, 57.76s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [18:13<1:43:01, 56.71s/it]EarlyStopping counter : 4 out of 12
training process:  16%|█▌        | 20/128 [19:12<1:43:13, 57.35s/it]Best score increase :0.813 -> 0.815
epoch : 21, train loss : 0.035, valid loss : 0.040, train acc : 0.958, valid acc : 0.954, train f1 : 0.835, valid f1 : 0.811
training process:  16%|█▋        | 21/128 [20:05<1:40:00, 56.08s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [20:53<1:34:48, 53.67s/it]Best score increase :0.815 -> 0.830
training process:  18%|█▊        | 23/128 [21:43<1:32:09, 52.66s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:32<1:29:38, 51.71s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.034, valid loss : 0.037, train acc : 0.960, valid acc : 0.956, train f1 : 0.840, valid f1 : 0.841
training process:  20%|█▉        | 25/128 [23:35<1:34:25, 55.01s/it]Best score increase :0.830 -> 0.841
training process:  20%|██        | 26/128 [24:25<1:30:52, 53.46s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [25:12<1:26:54, 51.63s/it]Best score increase :0.841 -> 0.842
training process:  22%|██▏       | 28/128 [26:01<1:24:37, 50.77s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.033, valid loss : 0.036, train acc : 0.961, valid acc : 0.958, train f1 : 0.845, valid f1 : 0.835
training process:  23%|██▎       | 29/128 [27:12<1:33:52, 56.90s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [28:11<1:33:40, 57.36s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [28:57<1:27:19, 54.01s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [29:46<1:23:57, 52.48s/it]Best score increase :0.842 -> 0.844
epoch : 33, train loss : 0.032, valid loss : 0.037, train acc : 0.961, valid acc : 0.958, train f1 : 0.845, valid f1 : 0.834
training process:  26%|██▌       | 33/128 [30:48<1:27:30, 55.27s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [31:37<1:23:41, 53.42s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [32:32<1:23:50, 54.10s/it]EarlyStopping counter : 3 out of 12
training process:  28%|██▊       | 36/128 [33:25<1:22:21, 53.71s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.031, valid loss : 0.037, train acc : 0.962, valid acc : 0.958, train f1 : 0.851, valid f1 : 0.836
training process:  29%|██▉       | 37/128 [34:19<1:21:41, 53.86s/it]EarlyStopping counter : 5 out of 12
training process:  30%|██▉       | 38/128 [35:12<1:20:24, 53.61s/it]EarlyStopping counter : 6 out of 12
training process:  30%|███       | 39/128 [36:06<1:19:28, 53.58s/it]EarlyStopping counter : 7 out of 12
training process:  31%|███▏      | 40/128 [37:02<1:19:52, 54.46s/it]EarlyStopping counter : 8 out of 12
epoch : 41, train loss : 0.031, valid loss : 0.038, train acc : 0.962, valid acc : 0.956, train f1 : 0.853, valid f1 : 0.828
training process:  32%|███▏      | 41/128 [38:08<1:23:37, 57.68s/it]EarlyStopping counter : 9 out of 12
training process:  33%|███▎      | 42/128 [39:05<1:22:39, 57.67s/it]Best score increase :0.844 -> 0.848
training process:  34%|███▎      | 43/128 [40:02<1:21:07, 57.26s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [40:58<1:19:46, 56.99s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.030, valid loss : 0.035, train acc : 0.963, valid acc : 0.958, train f1 : 0.855, valid f1 : 0.841
training process:  35%|███▌      | 45/128 [41:56<1:19:15, 57.29s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [42:47<1:15:42, 55.39s/it]Best score increase :0.848 -> 0.850
training process:  37%|███▋      | 47/128 [43:36<1:12:13, 53.50s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [44:24<1:09:13, 51.92s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.030, valid loss : 0.038, train acc : 0.963, valid acc : 0.958, train f1 : 0.857, valid f1 : 0.833
training process:  38%|███▊      | 49/128 [45:22<1:10:42, 53.70s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [46:10<1:07:42, 52.08s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [46:56<1:04:16, 50.09s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [47:41<1:01:32, 48.58s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.029, valid loss : 0.035, train acc : 0.964, valid acc : 0.959, train f1 : 0.862, valid f1 : 0.843
training process:  41%|████▏     | 53/128 [48:35<1:02:54, 50.32s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [49:22<1:00:51, 49.35s/it]EarlyStopping counter : 8 out of 12
training process:  43%|████▎     | 55/128 [50:11<59:42, 49.07s/it]  EarlyStopping counter : 9 out of 12
training process:  44%|████▍     | 56/128 [51:04<1:00:31, 50.44s/it]Best score increase :0.850 -> 0.853
epoch : 57, train loss : 0.029, valid loss : 0.035, train acc : 0.965, valid acc : 0.960, train f1 : 0.866, valid f1 : 0.853
training process:  45%|████▍     | 57/128 [52:08<1:04:27, 54.47s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [53:11<1:06:25, 56.93s/it]Best score increase :0.853 -> 0.855
training process:  46%|████▌     | 59/128 [54:12<1:06:42, 58.01s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [55:16<1:08:05, 60.08s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.029, valid loss : 0.038, train acc : 0.966, valid acc : 0.958, train f1 : 0.870, valid f1 : 0.835
training process:  48%|████▊     | 61/128 [56:20<1:08:06, 60.99s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [57:16<1:05:40, 59.70s/it]EarlyStopping counter : 4 out of 12
training process:  49%|████▉     | 63/128 [58:14<1:04:11, 59.25s/it]EarlyStopping counter : 5 out of 12
training process:  50%|█████     | 64/128 [59:10<1:02:10, 58.28s/it]EarlyStopping counter : 6 out of 12
epoch : 65, train loss : 0.028, valid loss : 0.034, train acc : 0.966, valid acc : 0.961, train f1 : 0.868, valid f1 : 0.858
training process:  51%|█████     | 65/128 [1:00:11<1:01:54, 58.95s/it]Best score increase :0.855 -> 0.858
training process:  52%|█████▏    | 66/128 [1:01:04<59:07, 57.22s/it]  EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 67/128 [1:01:57<56:52, 55.95s/it]EarlyStopping counter : 2 out of 12
training process:  53%|█████▎    | 68/128 [1:02:55<56:24, 56.40s/it]EarlyStopping counter : 3 out of 12
epoch : 69, train loss : 0.028, valid loss : 0.037, train acc : 0.966, valid acc : 0.959, train f1 : 0.870, valid f1 : 0.840
training process:  54%|█████▍    | 69/128 [1:03:57<57:15, 58.23s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▍    | 70/128 [1:04:49<54:24, 56.28s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▌    | 71/128 [1:05:42<52:40, 55.45s/it]EarlyStopping counter : 6 out of 12
training process:  56%|█████▋    | 72/128 [1:06:38<51:49, 55.52s/it]EarlyStopping counter : 7 out of 12
epoch : 73, train loss : 0.028, valid loss : 0.037, train acc : 0.966, valid acc : 0.960, train f1 : 0.868, valid f1 : 0.845
training process:  57%|█████▋    | 73/128 [1:07:41<53:03, 57.88s/it]EarlyStopping counter : 8 out of 12
training process:  58%|█████▊    | 74/128 [1:08:35<50:51, 56.52s/it]EarlyStopping counter : 9 out of 12
training process:  59%|█████▊    | 75/128 [1:09:28<49:05, 55.58s/it]EarlyStopping counter : 10 out of 12
training process:  59%|█████▉    | 76/128 [1:10:18<46:37, 53.79s/it]EarlyStopping counter : 11 out of 12
epoch : 77, train loss : 0.028, valid loss : 0.038, train acc : 0.966, valid acc : 0.960, train f1 : 0.871, valid f1 : 0.842
training process:  59%|█████▉    | 76/128 [1:11:12<48:43, 56.22s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 76, best f1 score : 0.858
training process finished, best loss : 0.034 and best acc : 0.961, best f1 : 0.858, best epoch : 64

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.88      0.69      0.77       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.93      0.84      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.84, test loss : 2.090

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:18,  7.14s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:11,  7.20s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:05,  7.22s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.41s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.35s/it]processing for feature importance:  50%|█████     | 6/12 [00:43<00:43,  7.33s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:50<00:36,  7.25s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:29,  7.32s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:05<00:21,  7.26s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:12<00:14,  7.24s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:19<00:07,  7.15s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.18s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.24s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 14%|█▎        | 42/306 [00:00<00:00, 418.22it/s] 27%|██▋       | 84/306 [00:00<00:00, 417.17it/s] 41%|████      | 126/306 [00:00<00:00, 418.35it/s] 55%|█████▌    | 169/306 [00:00<00:00, 419.89it/s] 69%|██████▉   | 211/306 [00:00<00:00, 413.17it/s] 83%|████████▎ | 254/306 [00:00<00:00, 416.72it/s] 97%|█████████▋| 296/306 [00:00<00:00, 415.23it/s]100%|██████████| 306/306 [00:00<00:00, 416.18it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 476.34it/s]extract the null data:  18%|█▊        | 98/553 [00:00<00:00, 487.55it/s]extract the null data:  27%|██▋       | 147/553 [00:00<00:00, 485.00it/s]extract the null data:  35%|███▌      | 196/553 [00:00<00:00, 480.45it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 484.71it/s]extract the null data:  53%|█████▎    | 295/553 [00:00<00:00, 486.24it/s]extract the null data:  62%|██████▏   | 344/553 [00:00<00:00, 486.95it/s]extract the null data:  71%|███████   | 393/553 [00:00<00:00, 484.65it/s]extract the null data:  80%|███████▉  | 442/553 [00:00<00:00, 480.33it/s]extract the null data:  89%|████████▉ | 491/553 [00:01<00:00, 475.18it/s]extract the null data:  97%|█████████▋| 539/553 [00:01<00:00, 474.57it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 480.05it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 165.06it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 167.33it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:02, 168.25it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 167.18it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 169.30it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 169.85it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:02, 170.48it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 170.45it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:02, 171.05it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:02, 170.44it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:02, 173.66it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 172.86it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 173.48it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 171.02it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 168.42it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 171.06it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 150.33it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 156.14it/s]replace nan value:  61%|██████    | 338/553 [00:02<00:01, 157.65it/s]replace nan value:  64%|██████▍   | 355/553 [00:02<00:01, 160.08it/s]replace nan value:  67%|██████▋   | 372/553 [00:02<00:01, 161.43it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:01, 161.95it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 163.03it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 164.23it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 162.17it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 165.13it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 165.98it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 165.76it/s]replace nan value:  92%|█████████▏| 510/553 [00:03<00:00, 168.38it/s]replace nan value:  95%|█████████▌| 527/553 [00:03<00:00, 168.06it/s]replace nan value:  99%|█████████▊| 546/553 [00:03<00:00, 172.75it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 167.04it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 136.45it/s]  5%|▌         | 29/553 [00:00<00:03, 144.16it/s]  8%|▊         | 44/553 [00:00<00:03, 132.18it/s] 10%|█         | 58/553 [00:00<00:04, 123.65it/s] 13%|█▎        | 71/553 [00:00<00:03, 120.86it/s] 16%|█▌        | 86/553 [00:00<00:03, 128.32it/s] 18%|█▊        | 99/553 [00:00<00:03, 122.96it/s] 21%|██        | 116/553 [00:00<00:03, 135.99it/s] 24%|██▎       | 130/553 [00:00<00:03, 136.08it/s] 27%|██▋       | 150/553 [00:01<00:02, 152.04it/s] 30%|███       | 168/553 [00:01<00:02, 159.87it/s] 33%|███▎      | 185/553 [00:01<00:02, 156.09it/s] 37%|███▋      | 203/553 [00:01<00:02, 162.58it/s] 40%|███▉      | 220/553 [00:01<00:02, 142.95it/s] 42%|████▏     | 235/553 [00:01<00:02, 133.97it/s] 45%|████▌     | 250/553 [00:01<00:02, 137.33it/s] 48%|████▊     | 265/553 [00:01<00:02, 139.93it/s] 51%|█████     | 280/553 [00:02<00:02, 135.98it/s] 53%|█████▎    | 294/553 [00:02<00:01, 135.44it/s] 56%|█████▌    | 308/553 [00:02<00:01, 133.86it/s] 58%|█████▊    | 322/553 [00:02<00:01, 131.84it/s] 61%|██████    | 337/553 [00:02<00:01, 134.93it/s] 63%|██████▎   | 351/553 [00:02<00:01, 135.74it/s] 66%|██████▌   | 365/553 [00:02<00:01, 132.26it/s] 69%|██████▊   | 380/553 [00:02<00:01, 136.60it/s] 71%|███████   | 394/553 [00:02<00:01, 125.91it/s] 74%|███████▍  | 408/553 [00:02<00:01, 129.21it/s] 76%|███████▋  | 422/553 [00:03<00:01, 127.19it/s] 79%|███████▊  | 435/553 [00:03<00:00, 123.94it/s] 82%|████████▏ | 453/553 [00:03<00:00, 137.07it/s] 85%|████████▍ | 470/553 [00:03<00:00, 142.09it/s] 88%|████████▊ | 485/553 [00:03<00:00, 142.31it/s] 90%|█████████ | 500/553 [00:03<00:00, 130.80it/s] 93%|█████████▎| 516/553 [00:03<00:00, 138.24it/s] 96%|█████████▌| 531/553 [00:03<00:00, 117.67it/s] 99%|█████████▉| 548/553 [00:04<00:00, 129.00it/s]100%|██████████| 553/553 [00:04<00:00, 132.84it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 349.59it/s]extract the null data:  65%|██████▌   | 91/139 [00:00<00:00, 470.75it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 521.24it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 220.95it/s]replace nan value:  34%|███▍      | 47/139 [00:00<00:00, 203.60it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 202.02it/s]replace nan value:  64%|██████▍   | 89/139 [00:00<00:00, 197.87it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 198.96it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 185.09it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 194.11it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.42it/s] 19%|█▉        | 27/139 [00:00<00:00, 130.14it/s] 32%|███▏      | 44/139 [00:00<00:00, 145.14it/s] 42%|████▏     | 59/139 [00:00<00:00, 134.49it/s] 54%|█████▍    | 75/139 [00:00<00:00, 139.56it/s] 65%|██████▍   | 90/139 [00:00<00:00, 124.30it/s] 76%|███████▌  | 105/139 [00:00<00:00, 128.74it/s] 88%|████████▊ | 122/139 [00:00<00:00, 135.77it/s] 98%|█████████▊| 136/139 [00:01<00:00, 134.58it/s]100%|██████████| 139/139 [00:01<00:00, 134.25it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 275.52it/s]extract the null data:  47%|████▋     | 82/173 [00:00<00:00, 425.43it/s]extract the null data:  79%|███████▉  | 137/173 [00:00<00:00, 479.19it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 460.72it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 191.38it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 186.50it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 187.02it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 189.71it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 188.75it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 191.96it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 189.57it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 189.65it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 189.78it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  6%|▌         | 10/173 [00:00<00:01, 87.17it/s] 12%|█▏        | 20/173 [00:00<00:01, 91.61it/s] 18%|█▊        | 32/173 [00:00<00:01, 103.54it/s] 29%|██▉       | 50/173 [00:00<00:00, 132.29it/s] 38%|███▊      | 65/173 [00:00<00:00, 135.72it/s] 46%|████▌     | 80/173 [00:00<00:00, 139.64it/s] 55%|█████▍    | 95/173 [00:00<00:00, 140.82it/s] 64%|██████▍   | 111/173 [00:00<00:00, 145.76it/s] 73%|███████▎  | 126/173 [00:00<00:00, 139.79it/s] 82%|████████▏ | 141/173 [00:01<00:00, 142.38it/s] 90%|█████████ | 156/173 [00:01<00:00, 130.21it/s] 98%|█████████▊| 170/173 [00:01<00:00, 108.39it/s]100%|██████████| 173/173 [00:01<00:00, 120.15it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.096, train acc : 0.711, valid acc : 0.867, train f1 : 0.711, valid f1 : 0.680
training process:   1%|          | 1/128 [01:17<2:44:01, 77.49s/it]Best score increase :0.000 -> 0.680
training process:   2%|▏         | 2/128 [02:11<2:13:57, 63.79s/it]Best score increase :0.680 -> 0.719
training process:   2%|▏         | 3/128 [03:07<2:05:24, 60.20s/it]Best score increase :0.719 -> 0.746
training process:   3%|▎         | 4/128 [04:00<1:58:13, 57.20s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.092, valid loss : 0.092, train acc : 0.844, valid acc : 0.866, train f1 : 0.844, valid f1 : 0.710
training process:   4%|▍         | 5/128 [05:00<1:59:53, 58.48s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [05:52<1:53:49, 55.98s/it]EarlyStopping counter : 3 out of 12
training process:   5%|▌         | 7/128 [06:45<1:51:20, 55.21s/it]Best score increase :0.746 -> 0.758
training process:   6%|▋         | 8/128 [07:38<1:48:58, 54.49s/it]Best score increase :0.758 -> 0.771
epoch : 9, train loss : 0.079, valid loss : 0.061, train acc : 0.870, valid acc : 0.925, train f1 : 0.870, valid f1 : 0.795
training process:   7%|▋         | 9/128 [08:42<1:53:46, 57.36s/it]Best score increase :0.771 -> 0.795
training process:   8%|▊         | 10/128 [09:35<1:50:05, 55.98s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:30<1:49:01, 55.91s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [11:27<1:48:37, 56.19s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.075, valid loss : 0.070, train acc : 0.874, valid acc : 0.907, train f1 : 0.874, valid f1 : 0.775
training process:  10%|█         | 13/128 [12:33<1:53:02, 58.98s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [13:27<1:49:18, 57.53s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [14:22<1:46:49, 56.72s/it]Best score increase :0.795 -> 0.802
training process:  12%|█▎        | 16/128 [15:20<1:46:32, 57.08s/it]Best score increase :0.802 -> 0.821
epoch : 17, train loss : 0.071, valid loss : 0.058, train acc : 0.884, valid acc : 0.930, train f1 : 0.884, valid f1 : 0.809
training process:  13%|█▎        | 17/128 [16:25<1:49:56, 59.43s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [17:20<1:46:58, 58.35s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [18:14<1:43:24, 56.92s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [19:14<1:44:03, 57.81s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.066, valid loss : 0.057, train acc : 0.890, valid acc : 0.932, train f1 : 0.890, valid f1 : 0.817
training process:  16%|█▋        | 21/128 [20:18<1:46:30, 59.72s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [21:07<1:39:42, 56.43s/it]EarlyStopping counter : 6 out of 12
training process:  18%|█▊        | 23/128 [21:57<1:35:14, 54.42s/it]EarlyStopping counter : 7 out of 12
training process:  19%|█▉        | 24/128 [22:44<1:30:38, 52.30s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.064, valid loss : 0.071, train acc : 0.898, valid acc : 0.902, train f1 : 0.898, valid f1 : 0.775
training process:  20%|█▉        | 25/128 [23:40<1:31:32, 53.33s/it]EarlyStopping counter : 9 out of 12
training process:  20%|██        | 26/128 [24:29<1:28:35, 52.11s/it]EarlyStopping counter : 10 out of 12
training process:  21%|██        | 27/128 [25:19<1:26:56, 51.65s/it]EarlyStopping counter : 11 out of 12
training process:  21%|██        | 27/128 [26:11<1:37:57, 58.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 27, best f1 score : 0.821
training process finished, best loss : 0.052 and best acc : 0.939, best f1 : 0.821, best epoch : 15

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.77      0.67       580
           1       0.98      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.86      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.86, test loss : 3.185

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.16s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.01s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.94s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.98s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.87s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.86s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:38,  7.79s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:30,  7.72s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.76s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.70s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.67s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.71s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.79s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 17%|█▋        | 52/306 [00:00<00:00, 501.09it/s] 35%|███▍      | 107/306 [00:00<00:00, 527.49it/s] 53%|█████▎    | 163/306 [00:00<00:00, 539.64it/s] 72%|███████▏  | 219/306 [00:00<00:00, 544.40it/s] 90%|████████▉ | 275/306 [00:00<00:00, 546.77it/s]100%|██████████| 306/306 [00:00<00:00, 541.68it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 59/553 [00:00<00:00, 589.18it/s]extract the null data:  22%|██▏       | 121/553 [00:00<00:00, 603.99it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:00, 613.82it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 607.26it/s]extract the null data:  56%|█████▌    | 307/553 [00:00<00:00, 601.39it/s]extract the null data:  67%|██████▋   | 368/553 [00:00<00:00, 599.50it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 594.57it/s]extract the null data:  88%|████████▊ | 489/553 [00:00<00:00, 598.41it/s]extract the null data:  99%|█████████▉| 549/553 [00:00<00:00, 590.50it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 596.53it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 182.46it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 190.38it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 193.94it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 196.91it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 197.30it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 201.02it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 200.04it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:01, 203.53it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 204.34it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:01, 203.01it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 200.65it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 199.70it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 197.94it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 197.95it/s]replace nan value:  56%|█████▌    | 308/553 [00:01<00:01, 198.44it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 199.35it/s]replace nan value:  63%|██████▎   | 350/553 [00:01<00:01, 200.26it/s]replace nan value:  67%|██████▋   | 371/553 [00:01<00:00, 200.68it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 200.36it/s]replace nan value:  75%|███████▍  | 413/553 [00:02<00:00, 198.67it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 198.47it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 199.64it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 198.87it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 199.74it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 200.31it/s]replace nan value:  97%|█████████▋| 537/553 [00:02<00:00, 200.55it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 199.45it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 139.45it/s]  5%|▌         | 29/553 [00:00<00:03, 142.26it/s]  8%|▊         | 44/553 [00:00<00:03, 132.56it/s] 10%|█         | 58/553 [00:00<00:04, 122.64it/s] 13%|█▎        | 71/553 [00:00<00:03, 120.61it/s] 16%|█▌        | 87/553 [00:00<00:03, 132.61it/s] 18%|█▊        | 101/553 [00:00<00:03, 127.54it/s] 22%|██▏       | 120/553 [00:00<00:03, 142.63it/s] 24%|██▍       | 135/553 [00:01<00:02, 140.08it/s] 28%|██▊       | 153/553 [00:01<00:02, 150.42it/s] 31%|███       | 171/553 [00:01<00:02, 158.10it/s] 34%|███▍      | 187/553 [00:01<00:02, 153.50it/s] 37%|███▋      | 205/553 [00:01<00:02, 160.91it/s] 40%|████      | 222/553 [00:01<00:02, 150.41it/s] 43%|████▎     | 239/553 [00:01<00:02, 153.94it/s] 46%|████▌     | 255/553 [00:01<00:02, 145.88it/s] 49%|████▉     | 270/553 [00:01<00:01, 145.25it/s] 52%|█████▏    | 285/553 [00:01<00:01, 143.32it/s] 54%|█████▍    | 300/553 [00:02<00:01, 139.84it/s] 57%|█████▋    | 315/553 [00:02<00:01, 134.16it/s] 59%|█████▉    | 329/553 [00:02<00:01, 132.81it/s] 62%|██████▏   | 345/553 [00:02<00:01, 135.29it/s] 65%|██████▍   | 359/553 [00:02<00:01, 129.94it/s] 68%|██████▊   | 376/553 [00:02<00:01, 136.13it/s] 71%|███████   | 390/553 [00:02<00:01, 126.33it/s] 73%|███████▎  | 403/553 [00:02<00:01, 126.70it/s] 75%|███████▌  | 416/553 [00:03<00:01, 125.24it/s] 78%|███████▊  | 429/553 [00:03<00:01, 120.74it/s] 81%|████████  | 448/553 [00:03<00:00, 136.85it/s] 84%|████████▍ | 464/553 [00:03<00:00, 140.24it/s] 87%|████████▋ | 479/553 [00:03<00:00, 138.36it/s] 89%|████████▉ | 493/553 [00:03<00:00, 133.82it/s] 92%|█████████▏| 508/553 [00:03<00:00, 136.88it/s] 94%|█████████▍| 522/553 [00:03<00:00, 131.51it/s] 97%|█████████▋| 536/553 [00:03<00:00, 120.18it/s]100%|█████████▉| 551/553 [00:04<00:00, 110.84it/s]100%|██████████| 553/553 [00:04<00:00, 134.38it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 354.98it/s]extract the null data:  76%|███████▋  | 106/139 [00:00<00:00, 555.94it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 556.68it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 226.40it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 222.73it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 217.49it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 218.06it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 215.72it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 228.06it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 223.28it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 12%|█▏        | 16/139 [00:00<00:00, 145.12it/s] 25%|██▌       | 35/139 [00:00<00:00, 168.94it/s] 37%|███▋      | 52/139 [00:00<00:00, 161.61it/s] 50%|█████     | 70/139 [00:00<00:00, 167.32it/s] 63%|██████▎   | 87/139 [00:00<00:00, 152.39it/s] 74%|███████▍  | 103/139 [00:00<00:00, 154.40it/s] 86%|████████▋ | 120/139 [00:00<00:00, 159.08it/s] 99%|█████████▊| 137/139 [00:00<00:00, 158.41it/s]100%|██████████| 139/139 [00:00<00:00, 159.17it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 33/173 [00:00<00:00, 326.12it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 562.07it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 583.23it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 26/173 [00:00<00:00, 256.71it/s]replace nan value:  30%|███       | 52/173 [00:00<00:00, 257.80it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 258.76it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 256.63it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 254.78it/s]replace nan value:  90%|█████████ | 156/173 [00:00<00:00, 254.59it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 254.98it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 148.59it/s] 17%|█▋        | 30/173 [00:00<00:01, 132.08it/s] 27%|██▋       | 47/173 [00:00<00:00, 147.42it/s] 37%|███▋      | 64/173 [00:00<00:00, 152.82it/s] 46%|████▌     | 80/173 [00:00<00:00, 149.48it/s] 55%|█████▌    | 96/173 [00:00<00:00, 148.55it/s] 65%|██████▌   | 113/173 [00:00<00:00, 152.89it/s] 75%|███████▍  | 129/173 [00:00<00:00, 146.49it/s] 83%|████████▎ | 144/173 [00:00<00:00, 142.29it/s] 92%|█████████▏| 159/173 [00:01<00:00, 131.15it/s]100%|██████████| 173/173 [00:01<00:00, 101.68it/s]100%|██████████| 173/173 [00:01<00:00, 129.22it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.022, valid loss : 0.020, train acc : 0.676, valid acc : 0.823, train f1 : 0.528, valid f1 : 0.645
training process:   1%|          | 1/128 [00:56<1:59:25, 56.42s/it]Best score increase :0.000 -> 0.645
training process:   2%|▏         | 2/128 [01:41<1:44:43, 49.87s/it]Best score increase :0.645 -> 0.659
training process:   2%|▏         | 3/128 [02:25<1:38:27, 47.26s/it]Best score increase :0.659 -> 0.732
training process:   3%|▎         | 4/128 [03:12<1:36:53, 46.88s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.014, valid loss : 0.014, train acc : 0.890, valid acc : 0.880, train f1 : 0.734, valid f1 : 0.729
training process:   4%|▍         | 5/128 [04:10<1:44:46, 51.11s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [05:04<1:45:26, 51.86s/it]Best score increase :0.732 -> 0.789
training process:   5%|▌         | 7/128 [05:53<1:42:57, 51.06s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [06:42<1:40:38, 50.32s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.013, valid loss : 0.014, train acc : 0.912, valid acc : 0.913, train f1 : 0.770, valid f1 : 0.773
training process:   7%|▋         | 9/128 [07:39<1:44:04, 52.48s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [08:31<1:42:57, 52.35s/it]EarlyStopping counter : 4 out of 12
training process:   9%|▊         | 11/128 [09:21<1:40:54, 51.75s/it]Best score increase :0.789 -> 0.806
training process:   9%|▉         | 12/128 [10:11<1:38:32, 50.97s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.012, valid loss : 0.014, train acc : 0.918, valid acc : 0.924, train f1 : 0.780, valid f1 : 0.791
training process:  10%|█         | 13/128 [11:12<1:43:43, 54.12s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:05<1:41:56, 53.65s/it]Best score increase :0.806 -> 0.815
training process:  12%|█▏        | 15/128 [12:54<1:38:42, 52.41s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [13:43<1:35:51, 51.35s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.012, valid loss : 0.013, train acc : 0.921, valid acc : 0.930, train f1 : 0.785, valid f1 : 0.804
training process:  13%|█▎        | 17/128 [14:43<1:39:41, 53.88s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [15:32<1:36:00, 52.37s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [16:21<1:33:37, 51.54s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [17:12<1:32:09, 51.20s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.012, valid loss : 0.014, train acc : 0.924, valid acc : 0.939, train f1 : 0.795, valid f1 : 0.819
training process:  16%|█▋        | 21/128 [18:13<1:36:33, 54.15s/it]Best score increase :0.815 -> 0.819
training process:  17%|█▋        | 22/128 [19:06<1:35:07, 53.85s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [19:55<1:31:52, 52.50s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [20:44<1:28:52, 51.27s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.011, valid loss : 0.012, train acc : 0.927, valid acc : 0.894, train f1 : 0.800, valid f1 : 0.759
training process:  20%|█▉        | 25/128 [21:42<1:31:42, 53.42s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [22:32<1:28:51, 52.27s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [23:19<1:25:47, 50.96s/it]EarlyStopping counter : 6 out of 12
training process:  22%|██▏       | 28/128 [24:10<1:24:58, 50.99s/it]EarlyStopping counter : 7 out of 12
epoch : 29, train loss : 0.011, valid loss : 0.012, train acc : 0.934, valid acc : 0.927, train f1 : 0.814, valid f1 : 0.806
training process:  23%|██▎       | 29/128 [25:14<1:30:24, 54.79s/it]EarlyStopping counter : 8 out of 12
training process:  23%|██▎       | 30/128 [26:06<1:27:48, 53.76s/it]EarlyStopping counter : 9 out of 12
training process:  24%|██▍       | 31/128 [26:55<1:24:45, 52.43s/it]Best score increase :0.819 -> 0.828
training process:  25%|██▌       | 32/128 [27:47<1:23:49, 52.39s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.011, valid loss : 0.012, train acc : 0.933, valid acc : 0.934, train f1 : 0.814, valid f1 : 0.820
training process:  26%|██▌       | 33/128 [28:45<1:25:31, 54.01s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [29:39<1:24:44, 54.09s/it]Best score increase :0.828 -> 0.833
training process:  27%|██▋       | 35/128 [30:30<1:22:10, 53.01s/it]Best score increase :0.833 -> 0.839
training process:  28%|██▊       | 36/128 [31:21<1:20:36, 52.57s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.011, valid loss : 0.013, train acc : 0.936, valid acc : 0.943, train f1 : 0.819, valid f1 : 0.835
training process:  29%|██▉       | 37/128 [32:21<1:22:54, 54.67s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [33:15<1:21:46, 54.52s/it]Best score increase :0.839 -> 0.841
training process:  30%|███       | 39/128 [34:09<1:20:34, 54.32s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [35:02<1:19:08, 53.96s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.015, train acc : 0.936, valid acc : 0.945, train f1 : 0.821, valid f1 : 0.836
training process:  32%|███▏      | 41/128 [36:04<1:21:49, 56.44s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [36:56<1:18:55, 55.06s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [37:50<1:17:45, 54.89s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [38:45<1:16:38, 54.75s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.010, valid loss : 0.012, train acc : 0.936, valid acc : 0.922, train f1 : 0.822, valid f1 : 0.804
training process:  35%|███▌      | 45/128 [39:51<1:20:19, 58.06s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [40:47<1:18:45, 57.63s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [41:46<1:18:06, 57.85s/it]EarlyStopping counter : 9 out of 12
training process:  38%|███▊      | 48/128 [42:40<1:15:31, 56.65s/it]EarlyStopping counter : 10 out of 12
epoch : 49, train loss : 0.010, valid loss : 0.013, train acc : 0.939, valid acc : 0.944, train f1 : 0.829, valid f1 : 0.839
training process:  38%|███▊      | 49/128 [43:47<1:18:42, 59.77s/it]EarlyStopping counter : 11 out of 12
training process:  38%|███▊      | 49/128 [44:45<1:12:10, 54.81s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 49, best f1 score : 0.841
training process finished, best loss : 0.014 and best acc : 0.948, best f1 : 0.841, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.77      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.87      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.87, test loss : 0.852

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.92s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.06s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.02s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.12s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:58,  8.38s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:49,  8.30s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:41,  8.33s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:33,  8.35s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:13<00:24,  8.16s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:22<00:16,  8.26s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:30<00:08,  8.17s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.54s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.31s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 20/306 [00:00<00:01, 196.52it/s] 13%|█▎        | 40/306 [00:00<00:01, 168.48it/s] 19%|█▉        | 58/306 [00:00<00:01, 162.72it/s] 25%|██▍       | 75/306 [00:00<00:01, 164.52it/s] 38%|███▊      | 117/306 [00:00<00:00, 249.36it/s] 47%|████▋     | 143/306 [00:00<00:00, 223.23it/s] 55%|█████▍    | 167/306 [00:00<00:00, 217.93it/s] 62%|██████▏   | 190/306 [00:00<00:00, 178.61it/s] 70%|██████▉   | 214/306 [00:01<00:00, 191.96it/s] 77%|███████▋  | 235/306 [00:01<00:00, 175.71it/s] 83%|████████▎ | 255/306 [00:01<00:00, 179.95it/s] 90%|████████▉ | 274/306 [00:01<00:00, 169.86it/s] 96%|█████████▋| 295/306 [00:01<00:00, 176.20it/s]100%|██████████| 306/306 [00:01<00:00, 181.39it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 36/553 [00:00<00:01, 356.89it/s]extract the null data:  15%|█▌        | 84/553 [00:00<00:01, 424.75it/s]extract the null data:  24%|██▍       | 133/553 [00:00<00:00, 454.16it/s]extract the null data:  34%|███▎      | 186/553 [00:00<00:00, 480.94it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 504.03it/s]extract the null data:  53%|█████▎    | 292/553 [00:00<00:00, 498.51it/s]extract the null data:  62%|██████▏   | 343/553 [00:00<00:00, 500.98it/s]extract the null data:  71%|███████   | 394/553 [00:00<00:00, 496.56it/s]extract the null data:  80%|████████  | 444/553 [00:00<00:00, 497.52it/s]extract the null data:  90%|████████▉ | 495/553 [00:01<00:00, 499.17it/s]extract the null data:  99%|█████████▊| 545/553 [00:01<00:00, 481.23it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 482.03it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 160.50it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 162.06it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 163.09it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 162.62it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 162.66it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 165.48it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 163.00it/s]replace nan value:  25%|██▍       | 137/553 [00:00<00:02, 164.57it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:02, 166.00it/s]replace nan value:  31%|███▏      | 173/553 [00:01<00:02, 170.65it/s]replace nan value:  35%|███▍      | 191/553 [00:01<00:02, 170.07it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 172.15it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 172.91it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 173.64it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 172.23it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 172.98it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 174.36it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 176.87it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 176.07it/s]replace nan value:  64%|██████▍   | 354/553 [00:02<00:01, 176.01it/s]replace nan value:  67%|██████▋   | 372/553 [00:02<00:01, 175.73it/s]replace nan value:  71%|███████   | 391/553 [00:02<00:00, 178.26it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 177.38it/s]replace nan value:  77%|███████▋  | 427/553 [00:02<00:00, 177.76it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 174.96it/s]replace nan value:  84%|████████▎ | 463/553 [00:02<00:00, 175.85it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 177.61it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 172.87it/s]replace nan value:  94%|█████████▎| 518/553 [00:03<00:00, 173.18it/s]replace nan value:  97%|█████████▋| 536/553 [00:03<00:00, 170.53it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 171.23it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 132.53it/s]  5%|▌         | 29/553 [00:00<00:03, 138.06it/s]  8%|▊         | 43/553 [00:00<00:03, 128.68it/s] 10%|█         | 56/553 [00:00<00:04, 123.93it/s] 12%|█▏        | 69/553 [00:00<00:04, 112.09it/s] 15%|█▌        | 84/553 [00:00<00:03, 121.93it/s] 18%|█▊        | 97/553 [00:00<00:03, 123.91it/s] 20%|██        | 113/553 [00:00<00:03, 131.69it/s] 23%|██▎       | 127/553 [00:01<00:03, 128.02it/s] 26%|██▌       | 145/553 [00:01<00:02, 142.86it/s] 29%|██▉       | 162/553 [00:01<00:02, 148.14it/s] 32%|███▏      | 178/553 [00:01<00:02, 149.42it/s] 35%|███▌      | 194/553 [00:01<00:02, 148.90it/s] 38%|███▊      | 211/553 [00:01<00:02, 153.01it/s] 41%|████      | 227/553 [00:01<00:02, 145.16it/s] 44%|████▍     | 242/553 [00:01<00:02, 143.11it/s] 46%|████▋     | 257/553 [00:01<00:02, 139.69it/s] 49%|████▉     | 272/553 [00:01<00:02, 135.22it/s] 52%|█████▏    | 287/553 [00:02<00:01, 138.81it/s] 54%|█████▍    | 301/553 [00:02<00:01, 130.46it/s] 57%|█████▋    | 315/553 [00:02<00:01, 125.28it/s] 59%|█████▉    | 328/553 [00:02<00:01, 125.44it/s] 62%|██████▏   | 343/553 [00:02<00:01, 131.53it/s] 65%|██████▍   | 357/553 [00:02<00:01, 124.73it/s] 67%|██████▋   | 373/553 [00:02<00:01, 132.17it/s] 70%|██████▉   | 387/553 [00:02<00:01, 122.70it/s] 72%|███████▏  | 400/553 [00:03<00:01, 115.27it/s] 75%|███████▌  | 415/553 [00:03<00:01, 122.46it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.81it/s] 80%|████████  | 445/553 [00:03<00:00, 126.68it/s] 83%|████████▎ | 461/553 [00:03<00:00, 133.98it/s] 86%|████████▌ | 475/553 [00:03<00:00, 134.92it/s] 88%|████████▊ | 489/553 [00:03<00:00, 128.35it/s] 91%|█████████ | 503/553 [00:03<00:00, 123.35it/s] 94%|█████████▎| 518/553 [00:03<00:00, 130.01it/s] 96%|█████████▌| 532/553 [00:04<00:00, 110.25it/s] 99%|█████████▉| 548/553 [00:04<00:00, 121.12it/s]100%|██████████| 553/553 [00:04<00:00, 127.40it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 25/139 [00:00<00:00, 247.13it/s]extract the null data:  60%|██████    | 84/139 [00:00<00:00, 444.31it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 468.52it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 197.39it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 198.41it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 195.57it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 198.14it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 197.57it/s]replace nan value:  87%|████████▋ | 121/139 [00:00<00:00, 195.89it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.79it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.69it/s] 17%|█▋        | 24/139 [00:00<00:00, 120.48it/s] 28%|██▊       | 39/139 [00:00<00:00, 131.75it/s] 38%|███▊      | 53/139 [00:00<00:00, 131.32it/s] 48%|████▊     | 67/139 [00:00<00:00, 133.77it/s] 58%|█████▊    | 81/139 [00:00<00:00, 135.38it/s] 68%|██████▊   | 95/139 [00:00<00:00, 125.33it/s] 78%|███████▊  | 109/139 [00:00<00:00, 125.92it/s] 91%|█████████ | 126/139 [00:00<00:00, 136.20it/s]100%|██████████| 139/139 [00:01<00:00, 132.40it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 266.41it/s]extract the null data:  49%|████▉     | 85/173 [00:00<00:00, 446.03it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 516.49it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 485.23it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 193.34it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 190.40it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 190.81it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 194.66it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 193.17it/s]replace nan value:  71%|███████   | 122/173 [00:00<00:00, 195.63it/s]replace nan value:  82%|████████▏ | 142/173 [00:00<00:00, 194.57it/s]replace nan value:  94%|█████████▎| 162/173 [00:00<00:00, 191.16it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 191.09it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 139.20it/s] 17%|█▋        | 29/173 [00:00<00:01, 126.25it/s] 27%|██▋       | 46/173 [00:00<00:00, 140.99it/s] 36%|███▋      | 63/173 [00:00<00:00, 150.54it/s] 46%|████▌     | 79/173 [00:00<00:00, 148.77it/s] 54%|█████▍    | 94/173 [00:00<00:00, 145.97it/s] 63%|██████▎   | 109/173 [00:00<00:00, 146.29it/s] 72%|███████▏  | 124/173 [00:00<00:00, 142.07it/s] 80%|████████  | 139/173 [00:00<00:00, 141.62it/s] 89%|████████▉ | 154/173 [00:01<00:00, 135.86it/s] 97%|█████████▋| 168/173 [00:01<00:00, 109.13it/s]100%|██████████| 173/173 [00:01<00:00, 127.29it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.047, valid loss : 0.036, train acc : 0.515, valid acc : 0.122, train f1 : 0.409, valid f1 : 0.120
training process:   1%|          | 1/128 [01:03<2:14:18, 63.45s/it]Best score increase :0.000 -> 0.120
training process:   2%|▏         | 2/128 [01:58<2:02:51, 58.51s/it]Best score increase :0.120 -> 0.278
training process:   2%|▏         | 3/128 [02:54<1:59:43, 57.47s/it]Best score increase :0.278 -> 0.381
training process:   3%|▎         | 4/128 [03:51<1:58:13, 57.21s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.024, valid loss : 0.028, train acc : 0.662, valid acc : 0.323, train f1 : 0.620, valid f1 : 0.306
training process:   4%|▍         | 5/128 [04:53<2:00:38, 58.85s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [05:51<1:58:55, 58.49s/it]Best score increase :0.381 -> 0.393
training process:   5%|▌         | 7/128 [06:48<1:56:58, 58.01s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:42<1:53:29, 56.75s/it]Best score increase :0.393 -> 0.455
epoch : 9, train loss : 0.020, valid loss : 0.020, train acc : 0.741, valid acc : 0.598, train f1 : 0.724, valid f1 : 0.502
training process:   7%|▋         | 9/128 [08:52<2:00:41, 60.85s/it]Best score increase :0.455 -> 0.502
training process:   8%|▊         | 10/128 [09:53<1:59:45, 60.89s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:56<2:00:03, 61.57s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [11:55<1:57:59, 61.03s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.019, valid loss : 0.022, train acc : 0.775, valid acc : 0.580, train f1 : 0.765, valid f1 : 0.491
training process:  10%|█         | 13/128 [13:06<2:02:37, 63.98s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [14:08<2:00:14, 63.29s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [15:09<1:57:41, 62.49s/it]Best score increase :0.502 -> 0.567
training process:  12%|█▎        | 16/128 [16:09<1:55:42, 61.99s/it]Best score increase :0.567 -> 0.595
epoch : 17, train loss : 0.017, valid loss : 0.018, train acc : 0.811, valid acc : 0.765, train f1 : 0.804, valid f1 : 0.621
training process:  13%|█▎        | 17/128 [17:19<1:59:04, 64.36s/it]Best score increase :0.595 -> 0.621
training process:  14%|█▍        | 18/128 [18:27<1:59:59, 65.45s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [19:22<1:52:58, 62.19s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [20:15<1:47:06, 59.51s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.016, valid loss : 0.020, train acc : 0.825, valid acc : 0.738, train f1 : 0.820, valid f1 : 0.603
training process:  16%|█▋        | 21/128 [21:17<1:47:25, 60.23s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [22:11<1:43:20, 58.50s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [23:03<1:38:56, 56.54s/it]Best score increase :0.621 -> 0.624
training process:  19%|█▉        | 24/128 [24:01<1:38:29, 56.82s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.015, valid loss : 0.024, train acc : 0.832, valid acc : 0.652, train f1 : 0.828, valid f1 : 0.543
training process:  20%|█▉        | 25/128 [25:08<1:43:02, 60.03s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [26:05<1:40:11, 58.93s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [26:57<1:35:38, 56.81s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [27:45<1:30:18, 54.18s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.015, valid loss : 0.022, train acc : 0.839, valid acc : 0.752, train f1 : 0.836, valid f1 : 0.617
training process:  23%|██▎       | 29/128 [28:49<1:34:23, 57.20s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [29:56<1:38:28, 60.29s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [30:42<1:30:15, 55.83s/it]EarlyStopping counter : 8 out of 12
training process:  25%|██▌       | 32/128 [31:27<1:24:15, 52.66s/it]EarlyStopping counter : 9 out of 12
epoch : 33, train loss : 0.014, valid loss : 0.022, train acc : 0.852, valid acc : 0.756, train f1 : 0.850, valid f1 : 0.620
training process:  26%|██▌       | 33/128 [32:21<1:23:49, 52.94s/it]EarlyStopping counter : 10 out of 12
training process:  27%|██▋       | 34/128 [33:06<1:19:20, 50.64s/it]EarlyStopping counter : 11 out of 12
training process:  27%|██▋       | 35/128 [33:53<1:16:35, 49.42s/it]Best score increase :0.624 -> 0.646
training process:  28%|██▊       | 36/128 [34:39<1:14:23, 48.52s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.014, valid loss : 0.023, train acc : 0.854, valid acc : 0.752, train f1 : 0.852, valid f1 : 0.616
training process:  29%|██▉       | 37/128 [35:32<1:15:50, 50.01s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [36:18<1:13:10, 48.79s/it]Best score increase :0.646 -> 0.667
training process:  30%|███       | 39/128 [37:12<1:14:30, 50.23s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [38:04<1:14:19, 50.68s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.013, valid loss : 0.024, train acc : 0.863, valid acc : 0.746, train f1 : 0.861, valid f1 : 0.612
training process:  32%|███▏      | 41/128 [39:07<1:19:08, 54.58s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [39:54<1:14:48, 52.19s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [40:40<1:11:29, 50.46s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [41:27<1:08:53, 49.21s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.013, valid loss : 0.023, train acc : 0.868, valid acc : 0.824, train f1 : 0.866, valid f1 : 0.679
training process:  35%|███▌      | 45/128 [42:34<1:15:34, 54.63s/it]Best score increase :0.667 -> 0.679
training process:  36%|███▌      | 46/128 [43:33<1:16:21, 55.88s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [44:20<1:12:03, 53.38s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [45:09<1:09:11, 51.89s/it]Best score increase :0.679 -> 0.688
epoch : 49, train loss : 0.013, valid loss : 0.023, train acc : 0.872, valid acc : 0.819, train f1 : 0.870, valid f1 : 0.675
training process:  38%|███▊      | 49/128 [46:04<1:09:40, 52.91s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [46:51<1:06:38, 51.26s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [47:40<1:04:42, 50.43s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [48:29<1:03:17, 49.97s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.013, valid loss : 0.024, train acc : 0.873, valid acc : 0.767, train f1 : 0.872, valid f1 : 0.628
training process:  41%|████▏     | 53/128 [49:26<1:05:02, 52.03s/it]EarlyStopping counter : 5 out of 12
training process:  42%|████▏     | 54/128 [50:17<1:03:58, 51.87s/it]EarlyStopping counter : 6 out of 12
training process:  43%|████▎     | 55/128 [51:06<1:02:04, 51.01s/it]EarlyStopping counter : 7 out of 12
training process:  44%|████▍     | 56/128 [51:54<1:00:07, 50.10s/it]EarlyStopping counter : 8 out of 12
epoch : 57, train loss : 0.013, valid loss : 0.023, train acc : 0.882, valid acc : 0.816, train f1 : 0.880, valid f1 : 0.673
training process:  45%|████▍     | 57/128 [52:50<1:01:17, 51.80s/it]EarlyStopping counter : 9 out of 12
training process:  45%|████▌     | 58/128 [53:39<59:19, 50.85s/it]  EarlyStopping counter : 10 out of 12
training process:  46%|████▌     | 59/128 [54:26<57:15, 49.79s/it]EarlyStopping counter : 11 out of 12
training process:  46%|████▌     | 59/128 [55:18<1:04:40, 56.24s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 59, best f1 score : 0.688
training process finished, best loss : 0.023 and best acc : 0.831, best f1 : 0.688, best epoch : 47

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.31      0.92      0.47       580
           1       0.99      0.83      0.90      6818

    accuracy                           0.84      7398
   macro avg       0.65      0.87      0.69      7398
weighted avg       0.94      0.84      0.87      7398


# test acc : 0.84, test f1 : 0.69, test AUC : 0.87, test loss : 0.858

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.39s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:12,  7.27s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:05,  7.33s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.36s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.35s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.35s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.32s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:29,  7.40s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:22,  7.38s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:13<00:14,  7.39s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:20<00:07,  7.33s/it]processing for feature importance: 100%|██████████| 12/12 [01:27<00:00,  7.27s/it]processing for feature importance: 100%|██████████| 12/12 [01:27<00:00,  7.33s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 13%|█▎        | 40/306 [00:00<00:00, 394.26it/s] 26%|██▌       | 80/306 [00:00<00:00, 393.59it/s] 40%|███▉      | 121/306 [00:00<00:00, 397.21it/s] 53%|█████▎    | 161/306 [00:00<00:00, 390.04it/s] 66%|██████▌   | 201/306 [00:00<00:00, 390.64it/s] 79%|███████▉  | 241/306 [00:00<00:00, 393.32it/s] 92%|█████████▏| 281/306 [00:00<00:00, 392.07it/s]100%|██████████| 306/306 [00:00<00:00, 392.78it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 68/553 [00:00<00:00, 670.79it/s]extract the null data:  25%|██▍       | 136/553 [00:00<00:00, 663.79it/s]extract the null data:  37%|███▋      | 203/553 [00:00<00:00, 642.70it/s]extract the null data:  49%|████▉     | 272/553 [00:00<00:00, 659.15it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 646.56it/s]extract the null data:  73%|███████▎  | 403/553 [00:00<00:00, 640.11it/s]extract the null data:  85%|████████▍ | 468/553 [00:00<00:00, 639.56it/s]extract the null data:  96%|█████████▌| 532/553 [00:00<00:00, 610.78it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 628.39it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 191.31it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 200.57it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 202.93it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 212.67it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 211.51it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 214.84it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:01, 219.16it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:01, 214.57it/s]replace nan value:  36%|███▌      | 197/553 [00:00<00:01, 215.14it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 220.04it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 215.83it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 222.40it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 224.44it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 219.33it/s]replace nan value:  61%|██████    | 338/553 [00:01<00:00, 223.13it/s]replace nan value:  65%|██████▌   | 361/553 [00:01<00:00, 219.26it/s]replace nan value:  69%|██████▉   | 384/553 [00:01<00:00, 220.12it/s]replace nan value:  74%|███████▎  | 407/553 [00:01<00:00, 222.58it/s]replace nan value:  78%|███████▊  | 430/553 [00:01<00:00, 214.40it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 219.20it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 219.27it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 215.17it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 217.84it/s]replace nan value:  98%|█████████▊| 544/553 [00:02<00:00, 214.21it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 216.13it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.76it/s]  5%|▌         | 28/553 [00:00<00:03, 136.29it/s]  8%|▊         | 42/553 [00:00<00:03, 130.37it/s] 10%|█         | 56/553 [00:00<00:04, 121.04it/s] 12%|█▏        | 69/553 [00:00<00:04, 109.25it/s] 15%|█▌        | 84/553 [00:00<00:03, 120.61it/s] 18%|█▊        | 97/553 [00:00<00:03, 121.09it/s] 20%|██        | 112/553 [00:00<00:03, 127.73it/s] 23%|██▎       | 125/553 [00:01<00:03, 125.78it/s] 25%|██▌       | 141/553 [00:01<00:03, 133.25it/s] 29%|██▊       | 158/553 [00:01<00:02, 143.52it/s] 31%|███▏      | 174/553 [00:01<00:02, 147.80it/s] 34%|███▍      | 190/553 [00:01<00:02, 150.91it/s] 38%|███▊      | 209/553 [00:01<00:02, 162.01it/s] 41%|████      | 226/553 [00:01<00:02, 151.79it/s] 44%|████▍     | 242/553 [00:01<00:02, 151.92it/s] 47%|████▋     | 258/553 [00:01<00:01, 150.06it/s] 50%|████▉     | 274/553 [00:01<00:01, 145.90it/s] 53%|█████▎    | 291/553 [00:02<00:01, 149.16it/s] 55%|█████▌    | 306/553 [00:02<00:01, 135.43it/s] 58%|█████▊    | 320/553 [00:02<00:01, 132.86it/s] 61%|██████    | 335/553 [00:02<00:01, 136.48it/s] 63%|██████▎   | 349/553 [00:02<00:01, 134.81it/s] 66%|██████▌   | 363/553 [00:02<00:01, 133.53it/s] 69%|██████▊   | 379/553 [00:02<00:01, 139.05it/s] 71%|███████   | 393/553 [00:02<00:01, 127.74it/s] 74%|███████▎  | 407/553 [00:02<00:01, 130.28it/s] 76%|███████▌  | 421/553 [00:03<00:01, 127.62it/s] 78%|███████▊  | 434/553 [00:03<00:00, 125.37it/s] 82%|████████▏ | 453/553 [00:03<00:00, 138.91it/s] 85%|████████▍ | 469/553 [00:03<00:00, 144.13it/s] 88%|████████▊ | 484/553 [00:03<00:00, 142.05it/s] 90%|█████████ | 499/553 [00:03<00:00, 130.44it/s] 93%|█████████▎| 514/553 [00:03<00:00, 134.96it/s] 95%|█████████▌| 528/553 [00:03<00:00, 120.67it/s] 98%|█████████▊| 541/553 [00:04<00:00, 120.75it/s]100%|██████████| 553/553 [00:04<00:00, 132.27it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 367.26it/s]extract the null data:  78%|███████▊  | 108/139 [00:00<00:00, 566.00it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 569.84it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 230.53it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 233.15it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 242.73it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 233.32it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 234.29it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 236.99it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 130.11it/s] 22%|██▏       | 30/139 [00:00<00:00, 140.77it/s] 35%|███▍      | 48/139 [00:00<00:00, 148.59it/s] 45%|████▌     | 63/139 [00:00<00:00, 138.66it/s] 55%|█████▌    | 77/139 [00:00<00:00, 136.97it/s] 65%|██████▌   | 91/139 [00:00<00:00, 123.67it/s] 76%|███████▌  | 105/139 [00:00<00:00, 127.38it/s] 88%|████████▊ | 122/139 [00:00<00:00, 137.75it/s] 98%|█████████▊| 136/139 [00:01<00:00, 136.02it/s]100%|██████████| 139/139 [00:01<00:00, 136.28it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 42/173 [00:00<00:00, 415.89it/s]extract the null data:  68%|██████▊   | 118/173 [00:00<00:00, 616.06it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 625.18it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 26/173 [00:00<00:00, 252.50it/s]replace nan value:  30%|███       | 52/173 [00:00<00:00, 247.31it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 249.15it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 253.65it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 246.45it/s]replace nan value:  90%|█████████ | 156/173 [00:00<00:00, 246.94it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 247.78it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 144.88it/s] 17%|█▋        | 30/173 [00:00<00:01, 132.79it/s] 27%|██▋       | 46/173 [00:00<00:00, 143.37it/s] 35%|███▌      | 61/173 [00:00<00:00, 145.05it/s] 44%|████▍     | 76/173 [00:00<00:00, 144.68it/s] 53%|█████▎    | 92/173 [00:00<00:00, 147.37it/s] 62%|██████▏   | 108/173 [00:00<00:00, 150.81it/s] 72%|███████▏  | 124/173 [00:00<00:00, 149.12it/s] 81%|████████  | 140/173 [00:00<00:00, 150.86it/s] 90%|█████████ | 156/173 [00:01<00:00, 140.22it/s] 99%|█████████▉| 171/173 [00:01<00:00, 106.82it/s]100%|██████████| 173/173 [00:01<00:00, 131.48it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.096, valid loss : 0.075, train f1 : 0.557, valid f1 : 0.584
training process - Deferred Re-weighting:   1%|          | 1/128 [00:55<1:58:22, 55.93s/it]Best score increase :0.000 -> 0.584
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:42<1:46:07, 50.54s/it]Best score increase :0.584 -> 0.645
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:29<1:41:42, 48.82s/it]Best score increase :0.645 -> 0.712
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:19<1:42:14, 49.48s/it]Best score increase :0.712 -> 0.766
epoch : 5, train loss : 0.048, valid loss : 0.048, train f1 : 0.763, valid f1 : 0.779
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:14<1:45:16, 51.35s/it]Best score increase :0.766 -> 0.779
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:03<1:42:22, 50.35s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:56<1:43:19, 51.24s/it]Best score increase :0.779 -> 0.785
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:45<1:41:33, 50.78s/it]Best score increase :0.785 -> 0.797
epoch : 9, train loss : 0.041, valid loss : 0.043, train f1 : 0.808, valid f1 : 0.789
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:45<1:45:52, 53.39s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:33<1:42:05, 51.91s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:24<1:40:52, 51.73s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:15<1:39:30, 51.47s/it]Best score increase :0.797 -> 0.805
epoch : 13, train loss : 0.038, valid loss : 0.040, train f1 : 0.820, valid f1 : 0.815
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:14<1:43:05, 53.79s/it]Best score increase :0.805 -> 0.815
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:02<1:38:41, 51.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:50<1:35:26, 50.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:37<1:32:31, 49.57s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.037, valid loss : 0.039, train f1 : 0.828, valid f1 : 0.810
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:33<1:35:26, 51.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:21<1:32:47, 50.62s/it]Best score increase :0.815 -> 0.818
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:09<1:30:29, 49.82s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [16:57<1:28:19, 49.07s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.034, valid loss : 0.039, train f1 : 0.837, valid f1 : 0.819
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [17:54<1:31:42, 51.43s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [18:41<1:28:47, 50.26s/it]Best score increase :0.818 -> 0.837
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:29<1:26:35, 49.48s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:16<1:24:44, 48.89s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.037, train f1 : 0.844, valid f1 : 0.846
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:13<1:28:05, 51.31s/it]Best score increase :0.837 -> 0.846
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:00<1:24:50, 49.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [22:49<1:23:22, 49.53s/it]Best score increase :0.846 -> 0.850
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [23:36<1:21:42, 49.02s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.032, valid loss : 0.036, train f1 : 0.849, valid f1 : 0.838
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [24:33<1:24:34, 51.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [25:19<1:21:24, 49.84s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [26:07<1:19:28, 49.16s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [26:54<1:17:24, 48.38s/it]Best score increase :0.850 -> 0.851
epoch : 33, train loss : 0.031, valid loss : 0.038, train f1 : 0.851, valid f1 : 0.829
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [27:49<1:19:52, 50.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [28:41<1:19:57, 51.03s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [29:30<1:18:09, 50.43s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [30:25<1:19:19, 51.73s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.030, valid loss : 0.039, train f1 : 0.856, valid f1 : 0.830
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [31:49<1:33:15, 61.49s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:01<1:36:52, 64.58s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:15<1:39:55, 67.36s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:23<1:39:05, 67.56s/it]Best score increase :0.851 -> 0.855
epoch : 41, train loss : 0.029, valid loss : 0.036, train f1 : 0.860, valid f1 : 0.839
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:41<1:42:37, 70.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [37:50<1:40:32, 70.15s/it]Best score increase :0.855 -> 0.859
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [38:58<1:38:20, 69.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:08<1:37:39, 69.76s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.028, valid loss : 0.036, train f1 : 0.860, valid f1 : 0.840
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:23<1:38:43, 71.37s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [42:23<1:32:44, 67.86s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [43:22<1:28:04, 65.24s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [44:21<1:24:36, 63.46s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.029, valid loss : 0.038, train f1 : 0.865, valid f1 : 0.838
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [45:35<1:27:36, 66.54s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [46:34<1:23:21, 64.12s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [47:34<1:20:51, 63.00s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [48:37<1:19:47, 62.99s/it]EarlyStopping counter : 10 out of 12
epoch : 53, train loss : 0.028, valid loss : 0.036, train f1 : 0.872, valid f1 : 0.846
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [49:46<1:20:51, 64.69s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [50:45<1:11:49, 57.46s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 53, best f1 score : 0.859
training process finished, best loss : 0.035, best acc : 0.961, best f1 : 0.859, best epoch : 41

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.85      0.68      0.76       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.91      0.84      0.87      7398
weighted avg       0.96      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.84, test loss : 2.178

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:35,  8.72s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:28,  8.86s/it]processing for feature importance:  25%|██▌       | 3/12 [00:27<01:25,  9.48s/it]processing for feature importance:  33%|███▎      | 4/12 [00:37<01:16,  9.58s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:05,  9.40s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:57,  9.61s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:05<00:46,  9.37s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:14<00:36,  9.24s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:23<00:27,  9.20s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:33<00:19,  9.52s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:43<00:09,  9.51s/it]processing for feature importance: 100%|██████████| 12/12 [01:52<00:00,  9.40s/it]processing for feature importance: 100%|██████████| 12/12 [01:52<00:00,  9.38s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:02, 141.92it/s] 10%|▉         | 30/306 [00:00<00:02, 127.16it/s] 15%|█▌        | 46/306 [00:00<00:01, 139.66it/s] 20%|█▉        | 61/306 [00:00<00:02, 116.85it/s] 25%|██▍       | 76/306 [00:00<00:01, 125.80it/s] 30%|███       | 92/306 [00:00<00:01, 131.55it/s] 35%|███▍      | 106/306 [00:00<00:01, 130.75it/s] 40%|███▉      | 122/306 [00:00<00:01, 138.96it/s] 46%|████▋     | 142/306 [00:01<00:01, 156.40it/s] 52%|█████▏    | 158/306 [00:01<00:00, 150.53it/s] 57%|█████▋    | 174/306 [00:01<00:00, 152.94it/s] 63%|██████▎   | 192/306 [00:01<00:00, 158.63it/s] 68%|██████▊   | 208/306 [00:01<00:00, 147.96it/s] 73%|███████▎  | 223/306 [00:01<00:00, 147.14it/s] 78%|███████▊  | 238/306 [00:01<00:00, 144.96it/s] 83%|████████▎ | 253/306 [00:01<00:00, 139.28it/s] 88%|████████▊ | 269/306 [00:01<00:00, 144.39it/s] 94%|█████████▍| 287/306 [00:02<00:00, 151.92it/s] 99%|█████████▉| 303/306 [00:02<00:00, 141.10it/s]100%|██████████| 306/306 [00:02<00:00, 142.71it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:00, 531.38it/s]extract the null data:  20%|██        | 112/553 [00:00<00:00, 555.64it/s]extract the null data:  31%|███       | 172/553 [00:00<00:00, 574.51it/s]extract the null data:  42%|████▏     | 230/553 [00:00<00:00, 572.15it/s]extract the null data:  52%|█████▏    | 288/553 [00:00<00:00, 560.07it/s]extract the null data:  62%|██████▏   | 345/553 [00:00<00:00, 561.21it/s]extract the null data:  73%|███████▎  | 402/553 [00:00<00:00, 559.39it/s]extract the null data:  83%|████████▎ | 458/553 [00:00<00:00, 556.78it/s]extract the null data:  93%|█████████▎| 516/553 [00:00<00:00, 563.02it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 560.68it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:02, 178.36it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:02, 182.12it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 186.86it/s]replace nan value:  14%|█▎        | 76/553 [00:00<00:02, 185.96it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:02, 188.74it/s]replace nan value:  21%|██        | 116/553 [00:00<00:02, 190.75it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 190.62it/s]replace nan value:  28%|██▊       | 157/553 [00:00<00:02, 193.94it/s]replace nan value:  32%|███▏      | 177/553 [00:00<00:01, 194.65it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:01, 192.27it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 193.96it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 192.19it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:01, 191.22it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 193.96it/s]replace nan value:  54%|█████▍    | 298/553 [00:01<00:01, 189.02it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 190.56it/s]replace nan value:  61%|██████    | 338/553 [00:01<00:01, 191.79it/s]replace nan value:  65%|██████▍   | 358/553 [00:01<00:01, 189.19it/s]replace nan value:  68%|██████▊   | 378/553 [00:01<00:00, 190.21it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 187.61it/s]replace nan value:  76%|███████▌  | 418/553 [00:02<00:00, 188.59it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 187.59it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 187.43it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 188.76it/s]replace nan value:  90%|████████▉ | 496/553 [00:02<00:00, 190.08it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 188.95it/s]replace nan value:  97%|█████████▋| 536/553 [00:02<00:00, 190.10it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 190.24it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.93it/s]  5%|▌         | 28/553 [00:00<00:03, 139.64it/s]  8%|▊         | 42/553 [00:00<00:03, 133.29it/s] 10%|█         | 56/553 [00:00<00:03, 124.65it/s] 12%|█▏        | 69/553 [00:00<00:04, 113.68it/s] 15%|█▌        | 84/553 [00:00<00:03, 124.24it/s] 18%|█▊        | 98/553 [00:00<00:03, 124.29it/s] 21%|██        | 114/553 [00:00<00:03, 134.24it/s] 23%|██▎       | 128/553 [00:00<00:03, 132.52it/s] 27%|██▋       | 147/553 [00:01<00:02, 147.64it/s] 30%|██▉       | 164/553 [00:01<00:02, 153.06it/s] 33%|███▎      | 180/553 [00:01<00:02, 154.17it/s] 35%|███▌      | 196/553 [00:01<00:02, 155.02it/s] 39%|███▊      | 213/553 [00:01<00:02, 158.63it/s] 41%|████▏     | 229/553 [00:01<00:02, 147.90it/s] 44%|████▍     | 244/553 [00:01<00:02, 144.78it/s] 47%|████▋     | 260/553 [00:01<00:01, 147.98it/s] 50%|████▉     | 275/553 [00:01<00:01, 143.73it/s] 52%|█████▏    | 290/553 [00:02<00:01, 144.38it/s] 55%|█████▌    | 305/553 [00:02<00:01, 136.31it/s] 58%|█████▊    | 319/553 [00:02<00:01, 127.35it/s] 60%|██████    | 333/553 [00:02<00:01, 129.99it/s] 63%|██████▎   | 348/553 [00:02<00:01, 131.70it/s] 65%|██████▌   | 362/553 [00:02<00:01, 127.08it/s] 68%|██████▊   | 377/553 [00:02<00:01, 132.57it/s] 71%|███████   | 391/553 [00:02<00:01, 122.41it/s] 73%|███████▎  | 404/553 [00:02<00:01, 123.82it/s] 75%|███████▌  | 417/553 [00:03<00:01, 121.55it/s] 78%|███████▊  | 430/553 [00:03<00:01, 117.56it/s] 81%|████████  | 448/553 [00:03<00:00, 133.07it/s] 84%|████████▍ | 464/553 [00:03<00:00, 138.10it/s] 86%|████████▋ | 478/553 [00:03<00:00, 136.47it/s] 89%|████████▉ | 492/553 [00:03<00:00, 130.81it/s] 92%|█████████▏| 506/553 [00:03<00:00, 128.89it/s] 94%|█████████▍| 520/553 [00:03<00:00, 131.80it/s] 97%|█████████▋| 534/553 [00:04<00:00, 114.83it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.37it/s]100%|██████████| 553/553 [00:04<00:00, 131.03it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 366.31it/s]extract the null data:  73%|███████▎  | 102/139 [00:00<00:00, 529.40it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 527.58it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 211.71it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 214.71it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 207.52it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 207.06it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 207.83it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 207.88it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 208.48it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.60it/s] 18%|█▊        | 25/139 [00:00<00:00, 124.09it/s] 29%|██▉       | 40/139 [00:00<00:00, 134.41it/s] 39%|███▉      | 54/139 [00:00<00:00, 127.23it/s] 48%|████▊     | 67/139 [00:00<00:00, 127.72it/s] 58%|█████▊    | 80/139 [00:00<00:00, 127.16it/s] 67%|██████▋   | 93/139 [00:00<00:00, 117.13it/s] 76%|███████▋  | 106/139 [00:00<00:00, 119.94it/s] 88%|████████▊ | 122/139 [00:00<00:00, 127.89it/s] 97%|█████████▋| 135/139 [00:01<00:00, 124.18it/s]100%|██████████| 139/139 [00:01<00:00, 125.97it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 20/173 [00:00<00:00, 199.79it/s]extract the null data:  49%|████▊     | 84/173 [00:00<00:00, 455.46it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 550.47it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 511.94it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 199.12it/s]replace nan value:  24%|██▎       | 41/173 [00:00<00:00, 204.99it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 212.95it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 209.88it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 210.70it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 210.74it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 208.47it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 205.79it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 207.75it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.21it/s] 16%|█▌        | 28/173 [00:00<00:01, 116.66it/s] 24%|██▍       | 42/173 [00:00<00:01, 125.16it/s] 34%|███▎      | 58/173 [00:00<00:00, 135.54it/s] 42%|████▏     | 72/173 [00:00<00:00, 134.22it/s] 50%|████▉     | 86/173 [00:00<00:00, 132.11it/s] 58%|█████▊    | 101/173 [00:00<00:00, 134.54it/s] 67%|██████▋   | 116/173 [00:00<00:00, 136.99it/s] 75%|███████▌  | 130/173 [00:00<00:00, 132.03it/s] 83%|████████▎ | 144/173 [00:01<00:00, 130.08it/s] 91%|█████████▏| 158/173 [00:01<00:00, 117.70it/s] 98%|█████████▊| 170/173 [00:01<00:00, 98.63it/s] 100%|██████████| 173/173 [00:01<00:00, 115.93it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.096, train f1 : 0.711, valid f1 : 0.680
training process - Deferred Re-weighting:   1%|          | 1/128 [01:03<2:15:17, 63.92s/it]Best score increase :0.000 -> 0.680
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:55<1:59:08, 56.74s/it]Best score increase :0.680 -> 0.719
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:48<1:54:13, 54.83s/it]Best score increase :0.719 -> 0.746
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:40<1:51:08, 53.78s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.092, valid loss : 0.093, train f1 : 0.844, valid f1 : 0.707
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:38<1:53:36, 55.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:34<1:52:56, 55.55s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:27<1:50:13, 54.66s/it]Best score increase :0.746 -> 0.758
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:19<1:47:50, 53.92s/it]Best score increase :0.758 -> 0.769
epoch : 9, train loss : 0.078, valid loss : 0.059, train f1 : 0.871, valid f1 : 0.799
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:22<1:52:13, 56.58s/it]Best score increase :0.769 -> 0.799
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:15<1:49:19, 55.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:07<1:46:07, 54.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:02<1:45:26, 54.54s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.074, valid loss : 0.069, train f1 : 0.876, valid f1 : 0.779
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:03<1:48:22, 56.54s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:57<1:46:17, 55.94s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:51<1:44:17, 55.38s/it]Best score increase :0.799 -> 0.802
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:42<1:40:58, 54.10s/it]Best score increase :0.802 -> 0.818
epoch : 17, train loss : 0.070, valid loss : 0.059, train f1 : 0.886, valid f1 : 0.808
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:45<1:44:46, 56.64s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:37<1:41:27, 55.34s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:29<1:38:45, 54.36s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:23<1:37:31, 54.18s/it]Best score increase :0.818 -> 0.824
epoch : 21, train loss : 0.065, valid loss : 0.057, train f1 : 0.895, valid f1 : 0.818
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:23<1:39:50, 55.98s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:16<1:37:23, 55.13s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:09<1:35:11, 54.40s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:02<1:33:27, 53.91s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.062, valid loss : 0.074, train f1 : 0.902, valid f1 : 0.769
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:02<1:35:53, 55.86s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:58<1:34:57, 55.86s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:49<1:31:31, 54.37s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:40<1:29:06, 53.47s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.059, valid loss : 0.059, train f1 : 0.905, valid f1 : 0.818
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:41<1:31:35, 55.51s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:32<1:28:30, 54.19s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:21<1:25:13, 52.71s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [29:10<1:31:18, 56.48s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 31, best f1 score : 0.824
training process finished, best loss : 0.055, best acc : 0.939, best f1 : 0.824, best epoch : 19

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.55      0.79      0.65       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.87      0.80      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.87, test loss : 3.314

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.70s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:15,  7.54s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.81s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.74s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.96s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.89s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.86s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.84s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.75s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.70s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.75s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.77s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 17%|█▋        | 52/306 [00:00<00:00, 517.57it/s] 35%|███▌      | 108/306 [00:00<00:00, 541.93it/s] 54%|█████▎    | 164/306 [00:00<00:00, 549.81it/s] 72%|███████▏  | 221/306 [00:00<00:00, 555.12it/s] 91%|█████████ | 278/306 [00:00<00:00, 559.77it/s]100%|██████████| 306/306 [00:00<00:00, 554.31it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 577.39it/s]extract the null data:  21%|██▏       | 118/553 [00:00<00:00, 573.52it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 579.86it/s]extract the null data:  43%|████▎     | 236/553 [00:00<00:00, 583.60it/s]extract the null data:  53%|█████▎    | 295/553 [00:00<00:00, 578.73it/s]extract the null data:  64%|██████▍   | 354/553 [00:00<00:00, 581.43it/s]extract the null data:  75%|███████▍  | 413/553 [00:00<00:00, 582.76it/s]extract the null data:  86%|████████▌ | 474/553 [00:00<00:00, 588.45it/s]extract the null data:  97%|█████████▋| 534/553 [00:00<00:00, 591.02it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 586.05it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 192.74it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 198.83it/s]replace nan value:  11%|█         | 61/553 [00:00<00:02, 198.78it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 200.76it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 201.95it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 201.91it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:02, 202.74it/s]replace nan value:  30%|███       | 166/553 [00:00<00:01, 203.13it/s]replace nan value:  34%|███▍      | 187/553 [00:00<00:01, 203.73it/s]replace nan value:  38%|███▊      | 208/553 [00:01<00:01, 203.37it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 202.19it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 202.72it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 198.26it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 195.01it/s]replace nan value:  56%|█████▌    | 311/553 [00:01<00:01, 192.18it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:01, 191.37it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:01, 189.73it/s]replace nan value:  67%|██████▋   | 370/553 [00:01<00:00, 189.14it/s]replace nan value:  70%|███████   | 389/553 [00:01<00:00, 189.21it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 190.97it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 195.55it/s]replace nan value:  82%|████████▏ | 452/553 [00:02<00:00, 200.04it/s]replace nan value:  86%|████████▌ | 473/553 [00:02<00:00, 201.00it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 200.54it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 199.09it/s]replace nan value:  97%|█████████▋| 535/553 [00:02<00:00, 194.49it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 197.18it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 134.46it/s]  5%|▌         | 29/553 [00:00<00:03, 141.35it/s]  8%|▊         | 44/553 [00:00<00:03, 131.87it/s] 10%|█         | 58/553 [00:00<00:04, 123.01it/s] 13%|█▎        | 71/553 [00:00<00:03, 121.87it/s] 16%|█▌        | 88/553 [00:00<00:03, 136.16it/s] 18%|█▊        | 102/553 [00:00<00:03, 130.62it/s] 22%|██▏       | 120/553 [00:00<00:03, 143.42it/s] 24%|██▍       | 135/553 [00:00<00:02, 143.19it/s] 28%|██▊       | 153/553 [00:01<00:02, 153.50it/s] 31%|███       | 171/553 [00:01<00:02, 160.65it/s] 34%|███▍      | 188/553 [00:01<00:02, 156.06it/s] 37%|███▋      | 207/553 [00:01<00:02, 165.26it/s] 41%|████      | 224/553 [00:01<00:02, 155.20it/s] 43%|████▎     | 240/553 [00:01<00:02, 155.93it/s] 46%|████▋     | 256/553 [00:01<00:01, 148.77it/s] 49%|████▉     | 272/553 [00:01<00:01, 145.63it/s] 52%|█████▏    | 289/553 [00:01<00:01, 151.14it/s] 55%|█████▌    | 305/553 [00:02<00:01, 143.28it/s] 58%|█████▊    | 320/553 [00:02<00:01, 133.30it/s] 61%|██████    | 335/553 [00:02<00:01, 136.60it/s] 63%|██████▎   | 349/553 [00:02<00:01, 134.92it/s] 66%|██████▌   | 363/553 [00:02<00:01, 131.68it/s] 68%|██████▊   | 378/553 [00:02<00:01, 134.93it/s] 71%|███████   | 392/553 [00:02<00:01, 125.40it/s] 73%|███████▎  | 405/553 [00:02<00:01, 126.55it/s] 76%|███████▌  | 418/553 [00:03<00:01, 124.91it/s] 78%|███████▊  | 431/553 [00:03<00:00, 122.27it/s] 81%|████████▏ | 450/553 [00:03<00:00, 140.80it/s] 84%|████████▍ | 465/553 [00:03<00:00, 142.34it/s] 87%|████████▋ | 480/553 [00:03<00:00, 135.99it/s] 89%|████████▉ | 494/553 [00:03<00:00, 130.42it/s] 92%|█████████▏| 509/553 [00:03<00:00, 134.46it/s] 95%|█████████▍| 523/553 [00:03<00:00, 124.84it/s] 97%|█████████▋| 536/553 [00:03<00:00, 115.94it/s]100%|█████████▉| 551/553 [00:04<00:00, 107.74it/s]100%|██████████| 553/553 [00:04<00:00, 134.85it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 38/139 [00:00<00:00, 378.84it/s]extract the null data:  76%|███████▋  | 106/139 [00:00<00:00, 553.17it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 550.21it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 219.01it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 224.38it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 223.42it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 222.46it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 215.28it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 210.29it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 215.32it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.18it/s] 18%|█▊        | 25/139 [00:00<00:00, 124.16it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.49it/s] 39%|███▉      | 54/139 [00:00<00:00, 124.95it/s] 48%|████▊     | 67/139 [00:00<00:00, 124.43it/s] 58%|█████▊    | 80/139 [00:00<00:00, 123.56it/s] 67%|██████▋   | 93/139 [00:00<00:00, 112.94it/s] 76%|███████▋  | 106/139 [00:00<00:00, 116.41it/s] 88%|████████▊ | 122/139 [00:00<00:00, 127.18it/s] 97%|█████████▋| 135/139 [00:01<00:00, 125.28it/s]100%|██████████| 139/139 [00:01<00:00, 124.62it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 40/173 [00:00<00:00, 394.11it/s]extract the null data:  64%|██████▎   | 110/173 [00:00<00:00, 569.72it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 588.00it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 234.92it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 233.62it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 230.40it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 227.96it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 227.01it/s]replace nan value:  82%|████████▏ | 142/173 [00:00<00:00, 224.58it/s]replace nan value:  95%|█████████▌| 165/173 [00:00<00:00, 220.30it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 223.27it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.08it/s] 16%|█▌        | 28/173 [00:00<00:01, 120.12it/s] 25%|██▍       | 43/173 [00:00<00:00, 132.25it/s] 34%|███▍      | 59/173 [00:00<00:00, 141.20it/s] 43%|████▎     | 74/173 [00:00<00:00, 141.11it/s] 51%|█████▏    | 89/173 [00:00<00:00, 139.82it/s] 60%|██████    | 104/173 [00:00<00:00, 138.89it/s] 69%|██████▉   | 119/173 [00:00<00:00, 138.93it/s] 77%|███████▋  | 133/173 [00:00<00:00, 131.01it/s] 85%|████████▍ | 147/173 [00:01<00:00, 131.60it/s] 93%|█████████▎| 161/173 [00:01<00:00, 117.88it/s]100%|██████████| 173/173 [00:01<00:00, 118.98it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.007, train acc : 0.889, valid acc : 0.913, train f1 : 0.545, valid f1 : 0.559
training process:   1%|          | 1/128 [00:58<2:03:20, 58.27s/it]Best score increase :0.000 -> 0.559
training process:   2%|▏         | 2/128 [01:49<1:53:06, 53.86s/it]Best score increase :0.559 -> 0.588
training process:   2%|▏         | 3/128 [02:38<1:48:11, 51.93s/it]Best score increase :0.588 -> 0.677
training process:   3%|▎         | 4/128 [03:29<1:46:07, 51.35s/it]Best score increase :0.677 -> 0.746
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.942, valid acc : 0.942, train f1 : 0.754, valid f1 : 0.766
training process:   4%|▍         | 5/128 [04:27<1:50:17, 53.80s/it]Best score increase :0.746 -> 0.766
training process:   5%|▍         | 6/128 [05:18<1:47:15, 52.75s/it]Best score increase :0.766 -> 0.773
training process:   5%|▌         | 7/128 [06:06<1:43:20, 51.24s/it]Best score increase :0.773 -> 0.785
training process:   6%|▋         | 8/128 [06:55<1:40:58, 50.49s/it]Best score increase :0.785 -> 0.795
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.952, valid acc : 0.950, train f1 : 0.804, valid f1 : 0.795
training process:   7%|▋         | 9/128 [08:00<1:49:33, 55.24s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:52<1:46:49, 54.32s/it]Best score increase :0.795 -> 0.799
training process:   9%|▊         | 11/128 [09:44<1:44:23, 53.54s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:35<1:41:44, 52.62s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.003, train acc : 0.955, valid acc : 0.951, train f1 : 0.814, valid f1 : 0.800
training process:  10%|█         | 13/128 [11:34<1:44:27, 54.50s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:25<1:41:43, 53.54s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [13:17<1:39:50, 53.02s/it]Best score increase :0.799 -> 0.808
training process:  12%|█▎        | 16/128 [14:07<1:37:40, 52.33s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.956, valid acc : 0.954, train f1 : 0.820, valid f1 : 0.812
training process:  13%|█▎        | 17/128 [15:06<1:40:24, 54.28s/it]Best score increase :0.808 -> 0.812
training process:  14%|█▍        | 18/128 [15:59<1:38:56, 53.97s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:52<1:37:17, 53.55s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:42<1:34:25, 52.46s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train acc : 0.958, valid acc : 0.953, train f1 : 0.832, valid f1 : 0.805
training process:  16%|█▋        | 21/128 [18:38<1:35:38, 53.63s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [19:26<1:31:38, 51.88s/it]Best score increase :0.812 -> 0.830
training process:  18%|█▊        | 23/128 [20:15<1:29:06, 50.92s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:06<1:28:08, 50.85s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.957, train f1 : 0.838, valid f1 : 0.832
training process:  20%|█▉        | 25/128 [22:04<1:31:01, 53.03s/it]Best score increase :0.830 -> 0.832
training process:  20%|██        | 26/128 [22:55<1:29:06, 52.41s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [23:44<1:26:50, 51.59s/it]Best score increase :0.832 -> 0.841
training process:  22%|██▏       | 28/128 [24:35<1:25:41, 51.41s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.959, valid acc : 0.958, train f1 : 0.838, valid f1 : 0.838
training process:  23%|██▎       | 29/128 [25:37<1:29:57, 54.52s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [26:27<1:26:59, 53.26s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [27:15<1:23:26, 51.62s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [28:03<1:20:57, 50.59s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.958, train f1 : 0.841, valid f1 : 0.832
training process:  26%|██▌       | 33/128 [28:59<1:22:33, 52.14s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [29:47<1:19:28, 50.73s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [30:36<1:18:06, 50.39s/it]EarlyStopping counter : 8 out of 12
training process:  28%|██▊       | 36/128 [31:26<1:16:52, 50.13s/it]Best score increase :0.841 -> 0.844
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.962, valid acc : 0.956, train f1 : 0.851, valid f1 : 0.825
training process:  29%|██▉       | 37/128 [32:23<1:19:17, 52.28s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [33:11<1:16:41, 51.13s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [34:01<1:15:21, 50.81s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [34:50<1:13:36, 50.18s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.962, valid acc : 0.956, train f1 : 0.852, valid f1 : 0.828
training process:  32%|███▏      | 41/128 [35:48<1:16:14, 52.58s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [36:39<1:14:24, 51.92s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [37:32<1:14:11, 52.37s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [38:24<1:13:08, 52.24s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.002, train acc : 0.962, valid acc : 0.958, train f1 : 0.851, valid f1 : 0.835
training process:  35%|███▌      | 45/128 [39:25<1:15:49, 54.81s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [40:16<1:13:26, 53.74s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [41:08<1:11:39, 53.08s/it]EarlyStopping counter : 11 out of 12
training process:  37%|███▋      | 47/128 [41:59<1:12:21, 53.60s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.844
training process finished, best loss : 0.002 and best acc : 0.958, best f1 : 0.844, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.85      0.66      0.74       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.91      0.82      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.82, test loss : 0.157

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.51s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.86s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.79s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.79s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.63s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.71s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.73s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.74s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.75s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.73s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.69s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.72s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 34/306 [00:00<00:00, 335.23it/s] 23%|██▎       | 69/306 [00:00<00:00, 342.34it/s] 34%|███▍      | 104/306 [00:00<00:00, 342.68it/s] 46%|████▌     | 140/306 [00:00<00:00, 346.29it/s] 57%|█████▋    | 175/306 [00:00<00:00, 346.97it/s] 69%|██████▊   | 210/306 [00:00<00:00, 347.10it/s] 81%|████████  | 247/306 [00:00<00:00, 353.48it/s] 93%|█████████▎| 285/306 [00:00<00:00, 361.70it/s]100%|██████████| 306/306 [00:00<00:00, 356.11it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 42/553 [00:00<00:01, 415.49it/s]extract the null data:  15%|█▌        | 84/553 [00:00<00:01, 415.56it/s]extract the null data:  23%|██▎       | 126/553 [00:00<00:01, 417.26it/s]extract the null data:  31%|███       | 169/553 [00:00<00:00, 420.29it/s]extract the null data:  38%|███▊      | 212/553 [00:00<00:00, 420.89it/s]extract the null data:  46%|████▌     | 255/553 [00:00<00:00, 417.80it/s]extract the null data:  54%|█████▍    | 298/553 [00:00<00:00, 419.05it/s]extract the null data:  61%|██████▏   | 340/553 [00:00<00:00, 397.60it/s]extract the null data:  69%|██████▉   | 382/553 [00:00<00:00, 402.94it/s]extract the null data:  77%|███████▋  | 424/553 [00:01<00:00, 405.38it/s]extract the null data:  84%|████████▍ | 467/553 [00:01<00:00, 410.29it/s]extract the null data:  92%|█████████▏| 509/553 [00:01<00:00, 411.16it/s]extract the null data: 100%|█████████▉| 551/553 [00:01<00:00, 409.56it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 411.30it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 154.16it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 157.54it/s]replace nan value:   9%|▉         | 49/553 [00:00<00:03, 158.12it/s]replace nan value:  12%|█▏        | 65/553 [00:00<00:03, 158.70it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 159.52it/s]replace nan value:  18%|█▊        | 98/553 [00:00<00:02, 158.63it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 158.75it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 158.28it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 158.19it/s]replace nan value:  29%|██▉       | 162/553 [00:01<00:02, 153.02it/s]replace nan value:  32%|███▏      | 178/553 [00:01<00:02, 152.90it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:02, 154.74it/s]replace nan value:  38%|███▊      | 210/553 [00:01<00:02, 155.64it/s]replace nan value:  41%|████      | 226/553 [00:01<00:02, 148.39it/s]replace nan value:  44%|████▍     | 242/553 [00:01<00:02, 150.51it/s]replace nan value:  47%|████▋     | 258/553 [00:01<00:01, 152.16it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 153.70it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 155.30it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 157.39it/s]replace nan value:  58%|█████▊    | 323/553 [00:02<00:01, 157.91it/s]replace nan value:  61%|██████▏   | 339/553 [00:02<00:01, 157.20it/s]replace nan value:  64%|██████▍   | 355/553 [00:02<00:01, 156.27it/s]replace nan value:  67%|██████▋   | 371/553 [00:02<00:01, 149.22it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:01, 151.01it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 152.49it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 153.50it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 153.72it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 155.26it/s]replace nan value:  84%|████████▍ | 467/553 [00:03<00:00, 156.44it/s]replace nan value:  87%|████████▋ | 483/553 [00:03<00:00, 156.08it/s]replace nan value:  90%|█████████ | 499/553 [00:03<00:00, 155.24it/s]replace nan value:  93%|█████████▎| 515/553 [00:03<00:00, 148.78it/s]replace nan value:  96%|█████████▌| 531/553 [00:03<00:00, 149.49it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 152.00it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 154.25it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 107.59it/s]  4%|▍         | 24/553 [00:00<00:04, 109.98it/s]  6%|▋         | 35/553 [00:00<00:05, 95.93it/s]   8%|▊         | 45/553 [00:00<00:05, 88.96it/s] 10%|█         | 57/553 [00:00<00:05, 94.79it/s] 12%|█▏        | 67/553 [00:00<00:05, 95.86it/s] 14%|█▍        | 80/553 [00:00<00:04, 103.57it/s] 17%|█▋        | 93/553 [00:00<00:04, 109.60it/s] 19%|█▉        | 106/553 [00:01<00:03, 115.48it/s] 22%|██▏       | 121/553 [00:01<00:03, 122.72it/s] 24%|██▍       | 134/553 [00:01<00:03, 122.43it/s] 27%|██▋       | 149/553 [00:01<00:03, 128.70it/s] 30%|██▉       | 164/553 [00:01<00:02, 133.89it/s] 32%|███▏      | 178/553 [00:01<00:02, 134.44it/s] 35%|███▍      | 192/553 [00:01<00:02, 135.36it/s] 38%|███▊      | 208/553 [00:01<00:02, 139.96it/s] 40%|████      | 223/553 [00:01<00:02, 131.15it/s] 43%|████▎     | 237/553 [00:01<00:02, 133.16it/s] 45%|████▌     | 251/553 [00:02<00:02, 131.67it/s] 48%|████▊     | 265/553 [00:02<00:02, 132.20it/s] 50%|█████     | 279/553 [00:02<00:02, 128.51it/s] 53%|█████▎    | 292/553 [00:02<00:02, 127.41it/s] 55%|█████▌    | 305/553 [00:02<00:01, 124.25it/s] 58%|█████▊    | 318/553 [00:02<00:02, 115.05it/s] 60%|█████▉    | 331/553 [00:02<00:01, 117.33it/s] 62%|██████▏   | 345/553 [00:02<00:01, 119.23it/s] 65%|██████▍   | 358/553 [00:02<00:01, 118.38it/s] 67%|██████▋   | 373/553 [00:03<00:01, 124.62it/s] 70%|██████▉   | 386/553 [00:03<00:01, 117.45it/s] 72%|███████▏  | 398/553 [00:03<00:01, 109.50it/s] 75%|███████▍  | 413/553 [00:03<00:01, 119.67it/s] 77%|███████▋  | 426/553 [00:03<00:01, 104.92it/s] 80%|███████▉  | 440/553 [00:03<00:01, 112.26it/s] 82%|████████▏ | 456/553 [00:03<00:00, 123.11it/s] 85%|████████▍ | 470/553 [00:03<00:00, 125.36it/s] 87%|████████▋ | 483/553 [00:04<00:00, 123.24it/s] 90%|████████▉ | 496/553 [00:04<00:00, 113.21it/s] 92%|█████████▏| 510/553 [00:04<00:00, 120.08it/s] 95%|█████████▍| 523/553 [00:04<00:00, 112.63it/s] 97%|█████████▋| 535/553 [00:04<00:00, 103.64it/s] 99%|█████████▉| 550/553 [00:04<00:00, 114.37it/s]100%|██████████| 553/553 [00:04<00:00, 116.36it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 23/139 [00:00<00:00, 229.81it/s]extract the null data:  53%|█████▎    | 74/139 [00:00<00:00, 392.33it/s]extract the null data:  88%|████████▊ | 122/139 [00:00<00:00, 431.71it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 399.55it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 175.01it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 176.14it/s]replace nan value:  40%|███▉      | 55/139 [00:00<00:00, 178.35it/s]replace nan value:  53%|█████▎    | 73/139 [00:00<00:00, 170.61it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 173.48it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 174.18it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 175.21it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 175.10it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 104.60it/s] 17%|█▋        | 23/139 [00:00<00:01, 111.53it/s] 26%|██▌       | 36/139 [00:00<00:00, 118.62it/s] 35%|███▍      | 48/139 [00:00<00:00, 115.87it/s] 43%|████▎     | 60/139 [00:00<00:00, 111.35it/s] 53%|█████▎    | 73/139 [00:00<00:00, 115.66it/s] 61%|██████    | 85/139 [00:00<00:00, 108.51it/s] 69%|██████▉   | 96/139 [00:00<00:00, 103.37it/s] 77%|███████▋  | 107/139 [00:00<00:00, 102.05it/s] 88%|████████▊ | 122/139 [00:01<00:00, 111.80it/s] 96%|█████████▋| 134/139 [00:01<00:00, 110.03it/s]100%|██████████| 139/139 [00:01<00:00, 111.22it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 256.63it/s]extract the null data:  39%|███▊      | 67/173 [00:00<00:00, 343.24it/s]extract the null data:  66%|██████▋   | 115/173 [00:00<00:00, 404.54it/s]extract the null data:  95%|█████████▍| 164/173 [00:00<00:00, 437.82it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 409.22it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 171.48it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 171.57it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 173.31it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 173.87it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 174.15it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 174.40it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 174.59it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 174.92it/s]replace nan value:  94%|█████████▎| 162/173 [00:00<00:00, 173.90it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 173.33it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 126.67it/s] 15%|█▌        | 26/173 [00:00<00:01, 102.85it/s] 22%|██▏       | 38/173 [00:00<00:01, 109.17it/s] 30%|███       | 52/173 [00:00<00:01, 119.20it/s] 38%|███▊      | 65/173 [00:00<00:00, 117.32it/s] 45%|████▌     | 78/173 [00:00<00:00, 120.66it/s] 53%|█████▎    | 91/173 [00:00<00:00, 119.89it/s] 60%|██████    | 104/173 [00:00<00:00, 115.92it/s] 68%|██████▊   | 118/173 [00:01<00:00, 117.80it/s] 75%|███████▌  | 130/173 [00:01<00:00, 116.82it/s] 82%|████████▏ | 142/173 [00:01<00:00, 116.76it/s] 89%|████████▉ | 154/173 [00:01<00:00, 106.69it/s] 95%|█████████▌| 165/173 [00:01<00:00, 97.12it/s] 100%|██████████| 173/173 [00:01<00:00, 102.95it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.008, train acc : 0.707, valid acc : 0.827, train f1 : 0.706, valid f1 : 0.647
training process:   1%|          | 1/128 [01:06<2:20:19, 66.29s/it]Best score increase :0.000 -> 0.647
training process:   2%|▏         | 2/128 [01:57<2:01:06, 57.67s/it]Best score increase :0.647 -> 0.689
training process:   2%|▏         | 3/128 [02:47<1:52:53, 54.19s/it]Best score increase :0.689 -> 0.727
training process:   3%|▎         | 4/128 [03:38<1:49:22, 52.92s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.007, valid loss : 0.006, train acc : 0.837, valid acc : 0.880, train f1 : 0.837, valid f1 : 0.724
training process:   4%|▍         | 5/128 [04:37<1:52:45, 55.00s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [05:26<1:47:47, 53.01s/it]Best score increase :0.727 -> 0.743
training process:   5%|▌         | 7/128 [06:16<1:44:59, 52.06s/it]Best score increase :0.743 -> 0.762
training process:   6%|▋         | 8/128 [07:08<1:44:08, 52.07s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.006, valid loss : 0.005, train acc : 0.866, valid acc : 0.916, train f1 : 0.866, valid f1 : 0.783
training process:   7%|▋         | 9/128 [08:08<1:47:34, 54.24s/it]Best score increase :0.762 -> 0.783
training process:   8%|▊         | 10/128 [09:01<1:46:09, 53.98s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:49<1:41:49, 52.22s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [10:38<1:38:51, 51.13s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.005, train acc : 0.872, valid acc : 0.909, train f1 : 0.872, valid f1 : 0.780
training process:  10%|█         | 13/128 [11:34<1:41:13, 52.82s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [12:22<1:37:30, 51.32s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [13:12<1:35:41, 50.81s/it]EarlyStopping counter : 6 out of 12
training process:  12%|█▎        | 16/128 [13:59<1:32:55, 49.78s/it]EarlyStopping counter : 7 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.004, train acc : 0.882, valid acc : 0.919, train f1 : 0.882, valid f1 : 0.793
training process:  13%|█▎        | 17/128 [14:58<1:37:00, 52.44s/it]Best score increase :0.783 -> 0.793
training process:  14%|█▍        | 18/128 [15:51<1:36:31, 52.65s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:43<1:34:59, 52.29s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:31<1:32:03, 51.14s/it]Best score increase :0.793 -> 0.798
epoch : 21, train loss : 0.005, valid loss : 0.004, train acc : 0.890, valid acc : 0.920, train f1 : 0.890, valid f1 : 0.799
training process:  16%|█▋        | 21/128 [18:28<1:34:07, 52.78s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:17<1:31:18, 51.69s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:06<1:28:59, 50.85s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [20:53<1:26:11, 49.73s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.004, train acc : 0.897, valid acc : 0.911, train f1 : 0.897, valid f1 : 0.786
training process:  20%|█▉        | 25/128 [21:48<1:28:23, 51.49s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [22:41<1:27:52, 51.69s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [23:32<1:26:58, 51.67s/it]EarlyStopping counter : 7 out of 12
training process:  22%|██▏       | 28/128 [24:22<1:25:13, 51.14s/it]Best score increase :0.798 -> 0.817
epoch : 29, train loss : 0.005, valid loss : 0.004, train acc : 0.898, valid acc : 0.918, train f1 : 0.898, valid f1 : 0.796
training process:  23%|██▎       | 29/128 [25:19<1:27:06, 52.79s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [26:09<1:25:01, 52.06s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [27:03<1:25:05, 52.63s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [27:55<1:24:03, 52.54s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.005, train acc : 0.904, valid acc : 0.896, train f1 : 0.904, valid f1 : 0.767
training process:  26%|██▌       | 33/128 [28:57<1:27:30, 55.27s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [29:51<1:26:01, 54.91s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [30:47<1:25:41, 55.29s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [31:43<1:24:56, 55.40s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.004, train acc : 0.901, valid acc : 0.904, train f1 : 0.901, valid f1 : 0.776
training process:  29%|██▉       | 37/128 [32:43<1:25:57, 56.68s/it]EarlyStopping counter : 9 out of 12
training process:  30%|██▉       | 38/128 [33:38<1:24:20, 56.22s/it]EarlyStopping counter : 10 out of 12
training process:  30%|███       | 39/128 [34:31<1:21:59, 55.27s/it]EarlyStopping counter : 11 out of 12
training process:  30%|███       | 39/128 [35:22<1:20:43, 54.42s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 39, best f1 score : 0.817
training process finished, best loss : 0.004 and best acc : 0.933, best f1 : 0.817, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.50      0.80      0.62       580
           1       0.98      0.93      0.96      6818

    accuracy                           0.92      7398
   macro avg       0.74      0.87      0.79      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.79, test AUC : 0.87, test loss : 0.233

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.16s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.21s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:11,  7.96s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.80s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.83s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.83s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.89s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:32,  8.00s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.99s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:16,  8.03s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.83s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.85s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.91s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 12%|█▏        | 36/306 [00:00<00:00, 358.10it/s] 24%|██▍       | 73/306 [00:00<00:00, 361.37it/s] 36%|███▌      | 110/306 [00:00<00:00, 363.30it/s] 48%|████▊     | 147/306 [00:00<00:00, 352.11it/s] 60%|██████    | 184/306 [00:00<00:00, 355.65it/s] 72%|███████▏  | 220/306 [00:00<00:00, 348.37it/s] 83%|████████▎ | 255/306 [00:00<00:00, 344.49it/s] 95%|█████████▍| 290/306 [00:00<00:00, 343.66it/s]100%|██████████| 306/306 [00:00<00:00, 350.37it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 443.39it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 447.16it/s]extract the null data:  25%|██▍       | 137/553 [00:00<00:00, 449.12it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:00, 455.53it/s]extract the null data:  42%|████▏     | 230/553 [00:00<00:00, 450.33it/s]extract the null data:  50%|█████     | 277/553 [00:00<00:00, 455.31it/s]extract the null data:  58%|█████▊    | 323/553 [00:00<00:00, 456.68it/s]extract the null data:  67%|██████▋   | 369/553 [00:00<00:00, 455.11it/s]extract the null data:  75%|███████▌  | 415/553 [00:00<00:00, 451.14it/s]extract the null data:  83%|████████▎ | 461/553 [00:01<00:00, 451.50it/s]extract the null data:  92%|█████████▏| 507/553 [00:01<00:00, 450.64it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 448.05it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 450.91it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 159.68it/s]replace nan value:   6%|▌         | 32/553 [00:00<00:03, 158.74it/s]replace nan value:   9%|▉         | 49/553 [00:00<00:03, 160.83it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:03, 160.27it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 160.62it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 158.84it/s]replace nan value:  21%|██        | 117/553 [00:00<00:02, 160.76it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 159.65it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 164.27it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 167.73it/s]replace nan value:  34%|███▍      | 188/553 [00:01<00:02, 170.07it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:02, 170.96it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 169.24it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 168.90it/s]replace nan value:  47%|████▋     | 258/553 [00:01<00:01, 168.28it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:01, 168.60it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 168.61it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 168.40it/s]replace nan value:  59%|█████▉    | 326/553 [00:01<00:01, 168.49it/s]replace nan value:  62%|██████▏   | 344/553 [00:02<00:01, 169.10it/s]replace nan value:  65%|██████▌   | 362/553 [00:02<00:01, 169.63it/s]replace nan value:  69%|██████▊   | 380/553 [00:02<00:01, 171.03it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 169.39it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 168.64it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 167.27it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 169.35it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 173.73it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 175.98it/s]replace nan value:  92%|█████████▏| 506/553 [00:03<00:00, 173.09it/s]replace nan value:  95%|█████████▍| 524/553 [00:03<00:00, 173.13it/s]replace nan value:  98%|█████████▊| 542/553 [00:03<00:00, 173.57it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 168.35it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 106.97it/s]  5%|▍         | 25/553 [00:00<00:04, 120.68it/s]  7%|▋         | 39/553 [00:00<00:04, 121.34it/s]  9%|▉         | 52/553 [00:00<00:04, 107.85it/s] 11%|█▏        | 63/553 [00:00<00:04, 99.06it/s]  13%|█▎        | 74/553 [00:00<00:04, 100.73it/s] 16%|█▌        | 86/553 [00:00<00:04, 105.84it/s] 18%|█▊        | 97/553 [00:00<00:04, 105.68it/s] 20%|█▉        | 109/553 [00:01<00:04, 109.20it/s] 22%|██▏       | 122/553 [00:01<00:03, 112.50it/s] 24%|██▍       | 135/553 [00:01<00:03, 115.92it/s] 27%|██▋       | 150/553 [00:01<00:03, 125.05it/s] 30%|██▉       | 164/553 [00:01<00:03, 128.56it/s] 32%|███▏      | 178/553 [00:01<00:02, 128.08it/s] 35%|███▍      | 192/553 [00:01<00:02, 129.58it/s] 38%|███▊      | 210/553 [00:01<00:02, 140.83it/s] 41%|████      | 225/553 [00:01<00:02, 137.00it/s] 43%|████▎     | 240/553 [00:01<00:02, 139.84it/s] 46%|████▌     | 255/553 [00:02<00:02, 134.26it/s] 49%|████▊     | 269/553 [00:02<00:02, 135.52it/s] 51%|█████     | 283/553 [00:02<00:02, 131.75it/s] 54%|█████▎    | 297/553 [00:02<00:01, 129.38it/s] 56%|█████▌    | 310/553 [00:02<00:01, 128.84it/s] 58%|█████▊    | 323/553 [00:02<00:01, 126.66it/s] 61%|██████    | 337/553 [00:02<00:01, 129.58it/s] 63%|██████▎   | 350/553 [00:02<00:01, 128.65it/s] 66%|██████▌   | 363/553 [00:02<00:01, 126.11it/s] 68%|██████▊   | 378/553 [00:03<00:01, 130.74it/s] 71%|███████   | 392/553 [00:03<00:01, 122.13it/s] 73%|███████▎  | 405/553 [00:03<00:01, 122.31it/s] 76%|███████▌  | 418/553 [00:03<00:01, 119.75it/s] 78%|███████▊  | 431/553 [00:03<00:01, 116.14it/s] 81%|████████  | 449/553 [00:03<00:00, 132.43it/s] 84%|████████▍ | 464/553 [00:03<00:00, 134.95it/s] 86%|████████▋ | 478/553 [00:03<00:00, 133.07it/s] 89%|████████▉ | 492/553 [00:03<00:00, 128.31it/s] 91%|█████████▏| 505/553 [00:04<00:00, 124.89it/s] 94%|█████████▍| 520/553 [00:04<00:00, 129.68it/s] 97%|█████████▋| 534/553 [00:04<00:00, 113.17it/s] 99%|█████████▉| 550/553 [00:04<00:00, 123.46it/s]100%|██████████| 553/553 [00:04<00:00, 121.78it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 355.69it/s]extract the null data:  63%|██████▎   | 88/139 [00:00<00:00, 451.25it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 476.37it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 192.67it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 194.43it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 190.51it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 196.22it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 196.60it/s]replace nan value:  87%|████████▋ | 121/139 [00:00<00:00, 195.00it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.32it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.39it/s] 17%|█▋        | 23/139 [00:00<00:01, 113.89it/s] 27%|██▋       | 37/139 [00:00<00:00, 123.69it/s] 36%|███▌      | 50/139 [00:00<00:00, 123.59it/s] 45%|████▌     | 63/139 [00:00<00:00, 119.99it/s] 55%|█████▍    | 76/139 [00:00<00:00, 119.67it/s] 63%|██████▎   | 88/139 [00:00<00:00, 104.38it/s] 73%|███████▎  | 102/139 [00:00<00:00, 113.05it/s] 82%|████████▏ | 114/139 [00:00<00:00, 114.54it/s] 91%|█████████▏| 127/139 [00:01<00:00, 118.37it/s]100%|██████████| 139/139 [00:01<00:00, 117.44it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 265.91it/s]extract the null data:  47%|████▋     | 81/173 [00:00<00:00, 421.60it/s]extract the null data:  77%|███████▋  | 134/173 [00:00<00:00, 470.51it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 453.29it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 182.51it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 186.98it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 186.89it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 187.40it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 188.92it/s]replace nan value:  68%|██████▊   | 117/173 [00:00<00:00, 189.82it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 190.26it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 190.65it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 188.73it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.40it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.16it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.42it/s] 33%|███▎      | 57/173 [00:00<00:00, 130.36it/s] 41%|████      | 71/173 [00:00<00:00, 127.04it/s] 49%|████▊     | 84/173 [00:00<00:00, 124.61it/s] 56%|█████▌    | 97/173 [00:00<00:00, 124.14it/s] 65%|██████▍   | 112/173 [00:00<00:00, 129.84it/s] 73%|███████▎  | 126/173 [00:01<00:00, 118.99it/s] 80%|████████  | 139/173 [00:01<00:00, 118.99it/s] 88%|████████▊ | 152/173 [00:01<00:00, 115.88it/s] 95%|█████████▍| 164/173 [00:01<00:00, 104.87it/s]100%|██████████| 173/173 [00:01<00:00, 108.75it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.621, valid acc : 0.720, train f1 : 0.495, valid f1 : 0.570
training process:   1%|          | 1/128 [00:45<1:36:19, 45.51s/it]Best score increase :0.000 -> 0.570
training process:   2%|▏         | 2/128 [01:36<1:41:57, 48.56s/it]Best score increase :0.570 -> 0.598
training process:   2%|▏         | 3/128 [02:25<1:42:01, 48.97s/it]Best score increase :0.598 -> 0.675
training process:   3%|▎         | 4/128 [03:17<1:43:25, 50.04s/it]Best score increase :0.675 -> 0.710
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.869, valid acc : 0.862, train f1 : 0.710, valid f1 : 0.705
training process:   4%|▍         | 5/128 [04:15<1:48:13, 52.79s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:07<1:47:20, 52.79s/it]Best score increase :0.710 -> 0.760
training process:   5%|▌         | 7/128 [05:58<1:44:59, 52.06s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [06:51<1:44:59, 52.50s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.900, valid acc : 0.901, train f1 : 0.751, valid f1 : 0.756
training process:   7%|▋         | 9/128 [07:52<1:49:08, 55.03s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [08:45<1:47:13, 54.53s/it]Best score increase :0.760 -> 0.762
training process:   9%|▊         | 11/128 [09:37<1:44:45, 53.73s/it]Best score increase :0.762 -> 0.799
training process:   9%|▉         | 12/128 [10:28<1:42:17, 52.91s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.007, train acc : 0.910, valid acc : 0.923, train f1 : 0.767, valid f1 : 0.790
training process:  10%|█         | 13/128 [11:27<1:44:39, 54.60s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:21<1:43:22, 54.41s/it]Best score increase :0.799 -> 0.811
training process:  12%|█▏        | 15/128 [13:12<1:40:32, 53.38s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:03<1:38:43, 52.89s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.006, train acc : 0.913, valid acc : 0.922, train f1 : 0.774, valid f1 : 0.792
training process:  13%|█▎        | 17/128 [15:02<1:40:49, 54.50s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [15:52<1:37:29, 53.18s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [16:43<1:35:41, 52.68s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [17:34<1:33:40, 52.04s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.006, train acc : 0.916, valid acc : 0.938, train f1 : 0.782, valid f1 : 0.818
training process:  16%|█▋        | 21/128 [18:33<1:36:33, 54.14s/it]Best score increase :0.811 -> 0.818
training process:  17%|█▋        | 22/128 [19:24<1:33:50, 53.11s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [20:14<1:31:18, 52.17s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [21:05<1:30:00, 51.93s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.006, train acc : 0.921, valid acc : 0.888, train f1 : 0.789, valid f1 : 0.748
training process:  20%|█▉        | 25/128 [22:03<1:32:30, 53.89s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [22:55<1:30:26, 53.20s/it]Best score increase :0.818 -> 0.822
training process:  21%|██        | 27/128 [23:45<1:28:06, 52.34s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:37<1:26:38, 51.99s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.006, valid loss : 0.006, train acc : 0.925, valid acc : 0.929, train f1 : 0.797, valid f1 : 0.806
training process:  23%|██▎       | 29/128 [25:35<1:29:08, 54.03s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [26:26<1:26:34, 53.01s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [27:15<1:23:34, 51.69s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [28:01<1:20:09, 50.10s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.006, valid loss : 0.006, train acc : 0.926, valid acc : 0.922, train f1 : 0.802, valid f1 : 0.797
training process:  26%|██▌       | 33/128 [28:56<1:21:36, 51.54s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [29:50<1:22:01, 52.36s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [30:37<1:18:42, 50.78s/it]Best score increase :0.822 -> 0.827
training process:  28%|██▊       | 36/128 [31:23<1:15:29, 49.24s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.006, train acc : 0.929, valid acc : 0.936, train f1 : 0.806, valid f1 : 0.819
training process:  29%|██▉       | 37/128 [32:17<1:16:48, 50.64s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [33:08<1:16:02, 50.69s/it]Best score increase :0.827 -> 0.830
training process:  30%|███       | 39/128 [33:53<1:12:58, 49.20s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [34:39<1:10:33, 48.11s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.005, valid loss : 0.006, train acc : 0.928, valid acc : 0.939, train f1 : 0.804, valid f1 : 0.822
training process:  32%|███▏      | 41/128 [35:34<1:12:44, 50.17s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [36:19<1:09:48, 48.71s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [37:05<1:07:39, 47.75s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [37:52<1:06:30, 47.50s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.005, valid loss : 0.005, train acc : 0.929, valid acc : 0.914, train f1 : 0.808, valid f1 : 0.788
training process:  35%|███▌      | 45/128 [38:46<1:08:32, 49.55s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [39:32<1:06:13, 48.45s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [40:24<1:06:56, 49.59s/it]EarlyStopping counter : 9 out of 12
training process:  38%|███▊      | 48/128 [41:14<1:06:08, 49.61s/it]EarlyStopping counter : 10 out of 12
epoch : 49, train loss : 0.005, valid loss : 0.006, train acc : 0.931, valid acc : 0.940, train f1 : 0.810, valid f1 : 0.825
training process:  38%|███▊      | 49/128 [42:14<1:09:44, 52.97s/it]EarlyStopping counter : 11 out of 12
training process:  38%|███▊      | 49/128 [43:07<1:09:31, 52.81s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 49, best f1 score : 0.830
training process finished, best loss : 0.006 and best acc : 0.943, best f1 : 0.830, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.79      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.80      0.88      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.88, test loss : 0.378

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.78s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.70s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.51s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.54s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:53,  7.60s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:46,  7.73s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.84s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:31,  7.88s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:22,  7.66s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.60s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.76s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.86s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.74s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 100.98it/s]  7%|▋         | 22/306 [00:00<00:03, 88.03it/s]  10%|█         | 32/306 [00:00<00:02, 92.14it/s] 14%|█▎        | 42/306 [00:00<00:03, 87.27it/s] 17%|█▋        | 51/306 [00:00<00:02, 87.55it/s] 21%|██        | 63/306 [00:00<00:02, 96.31it/s] 24%|██▍       | 73/306 [00:00<00:02, 90.79it/s] 27%|██▋       | 84/306 [00:00<00:02, 94.86it/s] 31%|███       | 94/306 [00:01<00:02, 90.14it/s] 35%|███▍      | 107/306 [00:01<00:02, 98.34it/s] 38%|███▊      | 117/306 [00:01<00:02, 92.70it/s] 42%|████▏     | 127/306 [00:01<00:01, 91.85it/s] 45%|████▍     | 137/306 [00:01<00:01, 92.82it/s] 48%|████▊     | 147/306 [00:01<00:01, 88.92it/s] 52%|█████▏    | 158/306 [00:01<00:01, 92.92it/s] 55%|█████▍    | 168/306 [00:01<00:01, 89.09it/s] 58%|█████▊    | 178/306 [00:01<00:01, 91.74it/s] 61%|██████▏   | 188/306 [00:02<00:01, 88.19it/s] 64%|██████▍   | 197/306 [00:02<00:01, 88.31it/s] 68%|██████▊   | 207/306 [00:02<00:01, 89.75it/s] 71%|███████   | 217/306 [00:02<00:01, 86.95it/s] 75%|███████▍  | 229/306 [00:02<00:00, 94.89it/s] 78%|███████▊  | 239/306 [00:02<00:00, 90.36it/s] 82%|████████▏ | 252/306 [00:02<00:00, 99.00it/s] 86%|████████▌ | 263/306 [00:02<00:00, 92.81it/s] 90%|████████▉ | 275/306 [00:02<00:00, 97.73it/s] 93%|█████████▎| 285/306 [00:03<00:00, 92.33it/s] 96%|█████████▋| 295/306 [00:03<00:00, 90.59it/s]100%|█████████▉| 305/306 [00:03<00:00, 91.86it/s]100%|██████████| 306/306 [00:03<00:00, 91.85it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 43/553 [00:00<00:01, 427.23it/s]extract the null data:  16%|█▋        | 90/553 [00:00<00:01, 448.30it/s]extract the null data:  25%|██▌       | 139/553 [00:00<00:00, 463.15it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:00, 471.96it/s]extract the null data:  43%|████▎     | 239/553 [00:00<00:00, 485.42it/s]extract the null data:  52%|█████▏    | 289/553 [00:00<00:00, 487.71it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 481.09it/s]extract the null data:  70%|███████   | 388/553 [00:00<00:00, 486.09it/s]extract the null data:  79%|███████▉  | 439/553 [00:00<00:00, 493.13it/s]extract the null data:  88%|████████▊ | 489/553 [00:01<00:00, 495.01it/s]extract the null data:  98%|█████████▊| 541/553 [00:01<00:00, 502.56it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 485.23it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 157.23it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 167.93it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:02, 168.41it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 168.57it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 168.93it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 171.33it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 172.93it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 175.31it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:02, 177.49it/s]replace nan value:  32%|███▏      | 177/553 [00:01<00:02, 177.16it/s]replace nan value:  35%|███▌      | 196/553 [00:01<00:01, 178.51it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 179.81it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 179.42it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 180.95it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 181.58it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 181.28it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 182.49it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 181.36it/s]replace nan value:  63%|██████▎   | 347/553 [00:01<00:01, 181.18it/s]replace nan value:  66%|██████▌   | 366/553 [00:02<00:01, 180.14it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 178.35it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 177.61it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 176.24it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 176.77it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 174.97it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 176.02it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 175.93it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 178.39it/s]replace nan value:  96%|█████████▌| 530/553 [00:02<00:00, 175.67it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 177.51it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 176.76it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 132.84it/s]  5%|▌         | 29/553 [00:00<00:03, 137.88it/s]  8%|▊         | 43/553 [00:00<00:03, 130.54it/s] 10%|█         | 57/553 [00:00<00:04, 120.93it/s] 13%|█▎        | 70/553 [00:00<00:04, 113.05it/s] 16%|█▌        | 86/553 [00:00<00:03, 125.61it/s] 18%|█▊        | 99/553 [00:00<00:03, 120.12it/s] 21%|██        | 116/553 [00:00<00:03, 132.52it/s] 24%|██▎       | 130/553 [00:01<00:03, 131.34it/s] 27%|██▋       | 148/553 [00:01<00:02, 144.95it/s] 30%|██▉       | 165/553 [00:01<00:02, 149.72it/s] 33%|███▎      | 181/553 [00:01<00:02, 150.04it/s] 36%|███▌      | 197/553 [00:01<00:02, 151.70it/s] 39%|███▊      | 214/553 [00:01<00:02, 156.85it/s] 42%|████▏     | 230/553 [00:01<00:02, 145.48it/s] 44%|████▍     | 245/553 [00:01<00:02, 144.83it/s] 47%|████▋     | 261/553 [00:01<00:01, 147.83it/s] 50%|████▉     | 276/553 [00:01<00:02, 138.23it/s] 53%|█████▎    | 291/553 [00:02<00:01, 140.73it/s] 55%|█████▌    | 306/553 [00:02<00:01, 127.80it/s] 58%|█████▊    | 320/553 [00:02<00:01, 126.77it/s] 60%|██████    | 334/553 [00:02<00:01, 128.72it/s] 63%|██████▎   | 348/553 [00:02<00:01, 129.63it/s] 65%|██████▌   | 362/553 [00:02<00:01, 125.59it/s] 68%|██████▊   | 376/553 [00:02<00:01, 128.67it/s] 70%|███████   | 389/553 [00:02<00:01, 122.97it/s] 73%|███████▎  | 402/553 [00:03<00:01, 117.53it/s] 75%|███████▌  | 416/553 [00:03<00:01, 118.49it/s] 77%|███████▋  | 428/553 [00:03<00:01, 113.23it/s] 80%|████████  | 444/553 [00:03<00:00, 125.49it/s] 83%|████████▎ | 459/553 [00:03<00:00, 132.03it/s] 86%|████████▌ | 474/553 [00:03<00:00, 135.15it/s] 88%|████████▊ | 488/553 [00:03<00:00, 129.72it/s] 91%|█████████ | 502/553 [00:03<00:00, 123.60it/s] 93%|█████████▎| 517/553 [00:03<00:00, 130.00it/s] 96%|█████████▌| 531/553 [00:04<00:00, 110.49it/s] 99%|█████████▉| 547/553 [00:04<00:00, 120.02it/s]100%|██████████| 553/553 [00:04<00:00, 128.01it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 278.76it/s]extract the null data:  60%|██████    | 84/139 [00:00<00:00, 440.82it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 468.11it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 196.90it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 198.49it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 199.16it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 198.54it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 196.62it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 196.60it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.97it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.34it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.18it/s] 29%|██▉       | 40/139 [00:00<00:00, 131.67it/s] 39%|███▉      | 54/139 [00:00<00:00, 123.92it/s] 48%|████▊     | 67/139 [00:00<00:00, 124.58it/s] 58%|█████▊    | 80/139 [00:00<00:00, 122.46it/s] 67%|██████▋   | 93/139 [00:00<00:00, 113.14it/s] 76%|███████▋  | 106/139 [00:00<00:00, 115.99it/s] 87%|████████▋ | 121/139 [00:00<00:00, 125.34it/s] 96%|█████████▋| 134/139 [00:01<00:00, 119.62it/s]100%|██████████| 139/139 [00:01<00:00, 122.00it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 237.05it/s]extract the null data:  47%|████▋     | 82/173 [00:00<00:00, 437.27it/s]extract the null data:  79%|███████▊  | 136/173 [00:00<00:00, 482.38it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 465.69it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 187.96it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 183.09it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 186.54it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 189.32it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 190.88it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 191.19it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 193.10it/s]replace nan value:  91%|█████████▏| 158/173 [00:00<00:00, 192.77it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 189.89it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.71it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.63it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.80it/s] 33%|███▎      | 57/173 [00:00<00:00, 131.43it/s] 41%|████      | 71/173 [00:00<00:00, 130.34it/s] 49%|████▉     | 85/173 [00:00<00:00, 130.25it/s] 57%|█████▋    | 99/173 [00:00<00:00, 130.73it/s] 66%|██████▌   | 114/173 [00:00<00:00, 135.65it/s] 74%|███████▍  | 128/173 [00:00<00:00, 128.78it/s] 82%|████████▏ | 142/173 [00:01<00:00, 130.49it/s] 90%|█████████ | 156/173 [00:01<00:00, 116.87it/s] 97%|█████████▋| 168/173 [00:01<00:00, 95.92it/s] 100%|██████████| 173/173 [00:01<00:00, 114.04it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.015, train acc : 0.525, valid acc : 0.157, train f1 : 0.437, valid f1 : 0.157
training process:   1%|          | 1/128 [01:08<2:24:18, 68.18s/it]Best score increase :0.000 -> 0.157
training process:   2%|▏         | 2/128 [02:04<2:08:59, 61.42s/it]Best score increase :0.157 -> 0.231
training process:   2%|▏         | 3/128 [03:01<2:03:21, 59.21s/it]Best score increase :0.231 -> 0.283
training process:   3%|▎         | 4/128 [03:57<1:59:26, 57.79s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.014, train acc : 0.618, valid acc : 0.286, train f1 : 0.556, valid f1 : 0.275
training process:   4%|▍         | 5/128 [05:02<2:04:26, 60.70s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [05:55<1:57:39, 57.87s/it]Best score increase :0.283 -> 0.355
training process:   5%|▌         | 7/128 [06:50<1:55:08, 57.09s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:46<1:52:59, 56.49s/it]Best score increase :0.355 -> 0.408
epoch : 9, train loss : 0.003, valid loss : 0.011, train acc : 0.699, valid acc : 0.526, train f1 : 0.672, valid f1 : 0.454
training process:   7%|▋         | 9/128 [08:55<2:00:00, 60.51s/it]Best score increase :0.408 -> 0.454
training process:   8%|▊         | 10/128 [09:52<1:57:03, 59.52s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:52<1:56:03, 59.51s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [11:46<1:51:45, 57.80s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.012, train acc : 0.740, valid acc : 0.487, train f1 : 0.724, valid f1 : 0.427
training process:  10%|█         | 13/128 [12:49<1:53:56, 59.45s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [13:47<1:51:58, 58.93s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [14:46<1:51:21, 59.13s/it]Best score increase :0.454 -> 0.522
training process:  12%|█▎        | 16/128 [15:45<1:50:01, 58.95s/it]Best score increase :0.522 -> 0.549
epoch : 17, train loss : 0.003, valid loss : 0.009, train acc : 0.783, valid acc : 0.671, train f1 : 0.773, valid f1 : 0.552
training process:  13%|█▎        | 17/128 [16:52<1:53:57, 61.60s/it]Best score increase :0.549 -> 0.552
training process:  14%|█▍        | 18/128 [17:52<1:51:34, 60.85s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [18:50<1:49:04, 60.04s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [19:43<1:44:14, 57.91s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.009, train acc : 0.802, valid acc : 0.654, train f1 : 0.795, valid f1 : 0.541
training process:  16%|█▋        | 21/128 [20:41<1:43:21, 57.95s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [21:36<1:40:50, 57.08s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [22:31<1:38:49, 56.47s/it]EarlyStopping counter : 6 out of 12
training process:  19%|█▉        | 24/128 [23:29<1:38:38, 56.91s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.011, train acc : 0.812, valid acc : 0.624, train f1 : 0.806, valid f1 : 0.522
training process:  20%|█▉        | 25/128 [24:35<1:42:42, 59.83s/it]EarlyStopping counter : 8 out of 12
training process:  20%|██        | 26/128 [25:34<1:41:22, 59.63s/it]EarlyStopping counter : 9 out of 12
training process:  21%|██        | 27/128 [26:34<1:40:13, 59.54s/it]EarlyStopping counter : 10 out of 12
training process:  22%|██▏       | 28/128 [27:27<1:35:53, 57.53s/it]Best score increase :0.552 -> 0.569
epoch : 29, train loss : 0.002, valid loss : 0.010, train acc : 0.821, valid acc : 0.659, train f1 : 0.816, valid f1 : 0.547
training process:  23%|██▎       | 29/128 [28:33<1:39:09, 60.09s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [29:33<1:38:08, 60.09s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [30:38<1:39:43, 61.69s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [31:32<1:34:48, 59.25s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.009, train acc : 0.835, valid acc : 0.679, train f1 : 0.831, valid f1 : 0.561
training process:  26%|██▌       | 33/128 [32:43<1:39:29, 62.83s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [33:44<1:37:48, 62.43s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [34:36<1:31:32, 59.06s/it]Best score increase :0.569 -> 0.629
training process:  28%|██▊       | 36/128 [35:28<1:27:31, 57.08s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.010, train acc : 0.839, valid acc : 0.681, train f1 : 0.836, valid f1 : 0.562
training process:  29%|██▉       | 37/128 [36:31<1:29:00, 58.69s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [37:30<1:28:30, 59.01s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [38:27<1:26:35, 58.38s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [39:20<1:23:16, 56.78s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.009, train acc : 0.847, valid acc : 0.711, train f1 : 0.844, valid f1 : 0.584
training process:  32%|███▏      | 41/128 [40:27<1:26:46, 59.85s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [41:21<1:23:10, 58.02s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [42:20<1:22:30, 58.25s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [43:13<1:19:31, 56.81s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.009, train acc : 0.852, valid acc : 0.715, train f1 : 0.849, valid f1 : 0.587
training process:  35%|███▌      | 45/128 [44:28<1:26:01, 62.18s/it]EarlyStopping counter : 10 out of 12
training process:  36%|███▌      | 46/128 [45:29<1:24:26, 61.78s/it]EarlyStopping counter : 11 out of 12
training process:  36%|███▌      | 46/128 [46:32<1:22:58, 60.72s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 46, best f1 score : 0.629
training process finished, best loss : 0.008 and best acc : 0.771, best f1 : 0.629, best epoch : 34

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.28      0.92      0.43       580
           1       0.99      0.80      0.89      6818

    accuracy                           0.81      7398
   macro avg       0.64      0.86      0.66      7398
weighted avg       0.94      0.81      0.85      7398


# test acc : 0.81, test f1 : 0.66, test AUC : 0.86, test loss : 0.448

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:40,  9.10s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:40, 10.02s/it]processing for feature importance:  25%|██▌       | 3/12 [00:29<01:30, 10.04s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:15,  9.38s/it]processing for feature importance:  42%|████▏     | 5/12 [00:47<01:04,  9.23s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:55,  9.20s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:06<00:47,  9.46s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:15<00:38,  9.52s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:25<00:28,  9.56s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:35<00:19,  9.55s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:45<00:09,  9.68s/it]processing for feature importance: 100%|██████████| 12/12 [01:54<00:00,  9.52s/it]processing for feature importance: 100%|██████████| 12/12 [01:54<00:00,  9.52s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 12%|█▏        | 38/306 [00:00<00:00, 372.44it/s] 25%|██▍       | 76/306 [00:00<00:01, 196.85it/s] 33%|███▎      | 101/306 [00:00<00:01, 172.29it/s] 40%|███▉      | 121/306 [00:00<00:01, 175.82it/s] 46%|████▌     | 141/306 [00:00<00:00, 167.26it/s] 52%|█████▏    | 159/306 [00:00<00:00, 154.62it/s] 58%|█████▊    | 178/306 [00:01<00:00, 162.93it/s] 65%|██████▍   | 198/306 [00:01<00:00, 171.90it/s] 71%|███████   | 216/306 [00:01<00:00, 157.08it/s] 76%|███████▌  | 233/306 [00:01<00:00, 158.60it/s] 82%|████████▏ | 250/306 [00:01<00:00, 145.62it/s] 88%|████████▊ | 268/306 [00:01<00:00, 153.08it/s] 93%|█████████▎| 286/306 [00:01<00:00, 158.42it/s] 99%|█████████▉| 303/306 [00:01<00:00, 144.59it/s]100%|██████████| 306/306 [00:01<00:00, 163.80it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 463.20it/s]extract the null data:  17%|█▋        | 94/553 [00:00<00:01, 442.83it/s]extract the null data:  25%|██▌       | 141/553 [00:00<00:00, 451.12it/s]extract the null data:  35%|███▍      | 191/553 [00:00<00:00, 468.47it/s]extract the null data:  44%|████▍     | 242/553 [00:00<00:00, 482.09it/s]extract the null data:  53%|█████▎    | 293/553 [00:00<00:00, 490.53it/s]extract the null data:  62%|██████▏   | 343/553 [00:00<00:00, 493.45it/s]extract the null data:  71%|███████   | 393/553 [00:00<00:00, 487.18it/s]extract the null data:  81%|████████  | 446/553 [00:00<00:00, 499.30it/s]extract the null data:  91%|█████████ | 503/553 [00:01<00:00, 518.70it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 499.81it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 208.94it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 208.80it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:02, 204.99it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 200.51it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 188.01it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 180.10it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 169.33it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 168.08it/s]replace nan value:  32%|███▏      | 178/553 [00:00<00:02, 164.29it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:02, 159.51it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:02, 160.90it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 163.20it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 167.02it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 169.99it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 171.06it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 169.58it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 168.68it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 169.43it/s]replace nan value:  64%|██████▍   | 353/553 [00:02<00:01, 169.52it/s]replace nan value:  67%|██████▋   | 371/553 [00:02<00:01, 170.22it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 170.52it/s]replace nan value:  74%|███████▎  | 407/553 [00:02<00:00, 171.38it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 172.50it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 173.18it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 174.69it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 174.70it/s]replace nan value:  90%|████████▉ | 497/553 [00:02<00:00, 174.32it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 175.29it/s]replace nan value:  96%|█████████▋| 533/553 [00:03<00:00, 174.73it/s]replace nan value: 100%|█████████▉| 551/553 [00:03<00:00, 174.78it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 173.51it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.37it/s]  5%|▌         | 28/553 [00:00<00:03, 135.01it/s]  8%|▊         | 42/553 [00:00<00:04, 120.17it/s] 10%|▉         | 55/553 [00:00<00:04, 117.11it/s] 12%|█▏        | 67/553 [00:00<00:04, 109.86it/s] 14%|█▍        | 80/553 [00:00<00:04, 115.83it/s] 17%|█▋        | 93/553 [00:00<00:03, 118.83it/s] 20%|█▉        | 108/553 [00:00<00:03, 124.81it/s] 22%|██▏       | 122/553 [00:00<00:03, 127.58it/s] 25%|██▍       | 136/553 [00:01<00:03, 130.19it/s] 28%|██▊       | 153/553 [00:01<00:02, 140.22it/s] 31%|███       | 169/553 [00:01<00:02, 144.97it/s] 33%|███▎      | 184/553 [00:01<00:02, 141.84it/s] 36%|███▌      | 199/553 [00:01<00:02, 142.99it/s] 39%|███▉      | 215/553 [00:01<00:02, 145.58it/s] 42%|████▏     | 230/553 [00:01<00:02, 135.86it/s] 44%|████▍     | 244/553 [00:01<00:02, 135.61it/s] 47%|████▋     | 260/553 [00:01<00:02, 141.01it/s] 50%|████▉     | 275/553 [00:02<00:02, 136.19it/s] 52%|█████▏    | 289/553 [00:02<00:01, 135.31it/s] 55%|█████▍    | 303/553 [00:02<00:01, 129.19it/s] 57%|█████▋    | 317/553 [00:02<00:01, 123.39it/s] 60%|█████▉    | 330/553 [00:02<00:01, 124.35it/s] 62%|██████▏   | 345/553 [00:02<00:01, 127.00it/s] 65%|██████▍   | 358/553 [00:02<00:01, 125.76it/s] 67%|██████▋   | 373/553 [00:02<00:01, 132.26it/s] 70%|██████▉   | 387/553 [00:02<00:01, 122.22it/s] 72%|███████▏  | 400/553 [00:03<00:01, 114.00it/s] 75%|███████▌  | 415/553 [00:03<00:01, 121.22it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.13it/s] 80%|████████  | 445/553 [00:03<00:00, 125.88it/s] 83%|████████▎ | 459/553 [00:03<00:00, 129.57it/s] 86%|████████▌ | 473/553 [00:03<00:00, 131.44it/s] 88%|████████▊ | 487/553 [00:03<00:00, 126.35it/s] 90%|█████████ | 500/553 [00:03<00:00, 118.47it/s] 93%|█████████▎| 515/553 [00:04<00:00, 124.72it/s] 95%|█████████▌| 528/553 [00:04<00:00, 111.39it/s] 98%|█████████▊| 540/553 [00:04<00:00, 113.05it/s]100%|█████████▉| 552/553 [00:04<00:00, 99.42it/s] 100%|██████████| 553/553 [00:04<00:00, 124.31it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 259.88it/s]extract the null data:  55%|█████▌    | 77/139 [00:00<00:00, 405.87it/s]extract the null data:  94%|█████████▎| 130/139 [00:00<00:00, 459.50it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 436.84it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 190.22it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 187.59it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 186.66it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 187.57it/s]replace nan value:  70%|██████▉   | 97/139 [00:00<00:00, 187.80it/s]replace nan value:  83%|████████▎ | 116/139 [00:00<00:00, 187.42it/s]replace nan value:  97%|█████████▋| 135/139 [00:00<00:00, 187.27it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 187.75it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.71it/s] 19%|█▊        | 26/139 [00:00<00:00, 130.65it/s] 31%|███       | 43/139 [00:00<00:00, 145.12it/s] 42%|████▏     | 58/139 [00:00<00:00, 131.29it/s] 53%|█████▎    | 74/139 [00:00<00:00, 137.44it/s] 63%|██████▎   | 88/139 [00:00<00:00, 120.84it/s] 75%|███████▍  | 104/139 [00:00<00:00, 129.47it/s] 85%|████████▍ | 118/139 [00:00<00:00, 131.60it/s] 95%|█████████▍| 132/139 [00:01<00:00, 130.13it/s]100%|██████████| 139/139 [00:01<00:00, 132.47it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 219.27it/s]extract the null data:  44%|████▍     | 76/173 [00:00<00:00, 406.22it/s]extract the null data:  77%|███████▋  | 133/173 [00:00<00:00, 479.85it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 476.27it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 223.69it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 229.33it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 231.85it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 231.98it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 234.68it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 233.83it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 215.58it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 222.06it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 133.54it/s] 16%|█▌        | 28/173 [00:00<00:01, 113.88it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.32it/s] 32%|███▏      | 56/173 [00:00<00:00, 128.33it/s] 40%|███▉      | 69/173 [00:00<00:00, 125.58it/s] 48%|████▊     | 83/173 [00:00<00:00, 129.21it/s] 56%|█████▌    | 97/173 [00:00<00:00, 127.83it/s] 65%|██████▍   | 112/173 [00:00<00:00, 132.72it/s] 73%|███████▎  | 126/173 [00:00<00:00, 126.59it/s] 82%|████████▏ | 142/173 [00:01<00:00, 134.73it/s] 90%|█████████ | 156/173 [00:01<00:00, 124.55it/s] 98%|█████████▊| 169/173 [00:01<00:00, 104.70it/s]100%|██████████| 173/173 [00:01<00:00, 117.15it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.007, train f1 : 0.545, valid f1 : 0.559
training process - Deferred Re-weighting:   1%|          | 1/128 [01:26<3:03:15, 86.58s/it]Best score increase :0.000 -> 0.559
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:38<2:43:11, 77.71s/it]Best score increase :0.559 -> 0.588
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:44<2:31:15, 72.60s/it]Best score increase :0.588 -> 0.677
training process - Deferred Re-weighting:   3%|▎         | 4/128 [05:14<2:43:56, 79.33s/it]Best score increase :0.677 -> 0.746
epoch : 5, train loss : 0.004, valid loss : 0.004, train f1 : 0.755, valid f1 : 0.768
training process - Deferred Re-weighting:   4%|▍         | 5/128 [07:01<3:03:10, 89.35s/it]Best score increase :0.746 -> 0.768
training process - Deferred Re-weighting:   5%|▍         | 6/128 [08:31<3:02:08, 89.58s/it]Best score increase :0.768 -> 0.776
training process - Deferred Re-weighting:   5%|▌         | 7/128 [10:03<3:02:04, 90.29s/it]Best score increase :0.776 -> 0.786
training process - Deferred Re-weighting:   6%|▋         | 8/128 [11:31<2:59:24, 89.70s/it]Best score increase :0.786 -> 0.794
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.805, valid f1 : 0.795
training process - Deferred Re-weighting:   7%|▋         | 9/128 [13:04<2:59:49, 90.67s/it]Best score increase :0.794 -> 0.795
training process - Deferred Re-weighting:   8%|▊         | 10/128 [14:30<2:55:19, 89.15s/it]Best score increase :0.795 -> 0.800
training process - Deferred Re-weighting:   9%|▊         | 11/128 [15:55<2:51:18, 87.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [17:13<2:44:35, 85.13s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.003, train f1 : 0.815, valid f1 : 0.801
training process - Deferred Re-weighting:  10%|█         | 13/128 [18:53<2:51:38, 89.55s/it]Best score increase :0.800 -> 0.801
training process - Deferred Re-weighting:  11%|█         | 14/128 [20:13<2:44:23, 86.52s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [21:33<2:39:24, 84.64s/it]Best score increase :0.801 -> 0.806
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [22:50<2:33:52, 82.44s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.822, valid f1 : 0.814
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [24:23<2:38:13, 85.52s/it]Best score increase :0.806 -> 0.814
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [25:48<2:36:15, 85.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [27:09<2:32:33, 83.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [28:32<2:30:43, 83.73s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train f1 : 0.834, valid f1 : 0.811
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [29:51<2:26:52, 82.36s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [30:59<2:17:57, 78.09s/it]Best score increase :0.814 -> 0.834
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [32:07<2:11:24, 75.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [33:11<2:04:14, 71.68s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.842, valid f1 : 0.837
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [34:32<2:07:48, 74.45s/it]Best score increase :0.834 -> 0.837
training process - Deferred Re-weighting:  20%|██        | 26/128 [35:35<2:01:01, 71.19s/it]Best score increase :0.837 -> 0.840
training process - Deferred Re-weighting:  21%|██        | 27/128 [36:42<1:57:37, 69.87s/it]Best score increase :0.840 -> 0.845
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [37:48<1:54:18, 68.59s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.845, valid f1 : 0.839
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [39:04<1:56:53, 70.84s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [40:03<1:49:47, 67.22s/it]Best score increase :0.845 -> 0.852
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [41:16<1:51:25, 68.92s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [42:21<1:48:44, 67.97s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.848, valid f1 : 0.826
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [43:29<1:47:28, 67.88s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [44:35<1:45:24, 67.29s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [45:44<1:45:08, 67.84s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [46:54<1:45:01, 68.49s/it]Best score increase :0.852 -> 0.856
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.857, valid f1 : 0.827
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [48:14<1:49:13, 72.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [49:27<1:48:34, 72.39s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [50:32<1:44:03, 70.15s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [51:50<1:46:06, 72.35s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.002, train f1 : 0.857, valid f1 : 0.838
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [53:09<1:47:52, 74.39s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [54:24<1:47:01, 74.67s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [55:36<1:44:28, 73.75s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [56:56<1:45:50, 75.60s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.002, train f1 : 0.861, valid f1 : 0.831
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [58:15<1:46:13, 76.79s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [59:27<1:42:54, 75.30s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [1:00:40<1:40:48, 74.67s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [1:01:49<1:36:58, 72.73s/it]Best score increase :0.856 -> 0.863
epoch : 49, train loss : 0.002, valid loss : 0.002, train f1 : 0.865, valid f1 : 0.836
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [1:03:09<1:38:54, 75.12s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [1:04:20<1:35:50, 73.73s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [1:05:30<1:33:24, 72.78s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [1:06:47<1:33:45, 74.03s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.002, train f1 : 0.869, valid f1 : 0.847
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [1:07:53<1:29:31, 71.61s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [1:08:44<1:20:43, 65.45s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:09:49<1:19:17, 65.17s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [1:10:55<1:18:36, 65.50s/it]Best score increase :0.863 -> 0.873
epoch : 57, train loss : 0.002, valid loss : 0.002, train f1 : 0.870, valid f1 : 0.871
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [1:11:52<1:14:36, 63.04s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [1:12:42<1:08:51, 59.03s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:13:32<1:04:52, 56.41s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:14:28<1:03:42, 56.21s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.002, train f1 : 0.875, valid f1 : 0.852
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:15:34<1:06:00, 59.12s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:16:24<1:02:02, 56.40s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:17:14<59:04, 54.53s/it]  EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:18:02<55:56, 52.45s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.002, valid loss : 0.002, train f1 : 0.878, valid f1 : 0.872
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:18:58<56:17, 53.61s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:19:48<54:08, 52.40s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:20:37<52:25, 51.57s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:21:26<1:14:09, 72.94s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 67, best f1 score : 0.873
training process finished, best loss : 0.002, best acc : 0.963, best f1 : 0.873, best epoch : 55

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.75      0.73      0.74       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.86      0.85      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.85, test loss : 0.154

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:19,  7.24s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.42s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.47s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.42s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.49s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.44s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.55s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:30,  7.51s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.55s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:15,  7.70s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.61s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.64s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.55s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:01, 148.21it/s] 10%|▉         | 30/306 [00:00<00:02, 125.59it/s] 14%|█▍        | 44/306 [00:00<00:02, 130.84it/s] 19%|█▉        | 58/306 [00:00<00:02, 114.97it/s] 25%|██▍       | 76/306 [00:00<00:01, 134.17it/s] 30%|██▉       | 91/306 [00:00<00:01, 134.31it/s] 34%|███▍      | 105/306 [00:00<00:01, 122.07it/s] 39%|███▊      | 118/306 [00:00<00:01, 124.13it/s] 43%|████▎     | 131/306 [00:01<00:01, 120.23it/s] 47%|████▋     | 145/306 [00:01<00:01, 125.68it/s] 52%|█████▏    | 160/306 [00:01<00:01, 128.66it/s] 57%|█████▋    | 173/306 [00:01<00:01, 111.55it/s] 61%|██████▏   | 188/306 [00:01<00:00, 119.59it/s] 66%|██████▋   | 203/306 [00:01<00:00, 124.07it/s] 71%|███████   | 216/306 [00:01<00:00, 124.51it/s] 75%|███████▌  | 230/306 [00:01<00:00, 128.34it/s] 80%|███████▉  | 244/306 [00:01<00:00, 112.87it/s] 85%|████████▍ | 260/306 [00:02<00:00, 121.95it/s] 90%|████████▉ | 275/306 [00:02<00:00, 126.89it/s] 94%|█████████▍| 289/306 [00:02<00:00, 124.83it/s] 99%|█████████▊| 302/306 [00:02<00:00, 125.75it/s]100%|██████████| 306/306 [00:02<00:00, 124.92it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:01, 432.68it/s]extract the null data:  16%|█▌        | 89/553 [00:00<00:01, 439.05it/s]extract the null data:  24%|██▍       | 134/553 [00:00<00:00, 442.67it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 447.97it/s]extract the null data:  41%|████      | 226/553 [00:00<00:00, 451.28it/s]extract the null data:  50%|████▉     | 274/553 [00:00<00:00, 459.21it/s]extract the null data:  58%|█████▊    | 320/553 [00:00<00:00, 458.98it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 458.55it/s]extract the null data:  75%|███████▍  | 412/553 [00:00<00:00, 457.40it/s]extract the null data:  83%|████████▎ | 458/553 [00:01<00:00, 453.75it/s]extract the null data:  91%|█████████ | 504/553 [00:01<00:00, 453.39it/s]extract the null data:  99%|█████████▉| 550/553 [00:01<00:00, 453.72it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 452.38it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 162.27it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 164.30it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 164.84it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 165.39it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 165.77it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 166.06it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 166.74it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 165.06it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:02, 165.94it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 167.03it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 167.15it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 167.82it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 167.72it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 167.48it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 167.46it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 167.68it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 168.36it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 168.11it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 168.63it/s]replace nan value:  61%|██████▏   | 340/553 [00:02<00:01, 168.65it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 167.43it/s]replace nan value:  68%|██████▊   | 374/553 [00:02<00:01, 168.00it/s]replace nan value:  71%|███████   | 391/553 [00:02<00:00, 167.11it/s]replace nan value:  74%|███████▍  | 408/553 [00:02<00:00, 167.58it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 166.97it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 167.43it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 168.35it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 168.61it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 168.67it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 168.92it/s]replace nan value:  95%|█████████▌| 528/553 [00:03<00:00, 168.22it/s]replace nan value:  99%|█████████▊| 545/553 [00:03<00:00, 168.33it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 167.17it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.75it/s]  5%|▍         | 27/553 [00:00<00:03, 132.45it/s]  7%|▋         | 41/553 [00:00<00:03, 130.19it/s] 10%|▉         | 55/553 [00:00<00:04, 120.09it/s] 12%|█▏        | 68/553 [00:00<00:04, 108.17it/s] 15%|█▌        | 83/553 [00:00<00:03, 118.83it/s] 17%|█▋        | 96/553 [00:00<00:03, 121.61it/s] 20%|█▉        | 109/553 [00:00<00:03, 122.87it/s] 22%|██▏       | 124/553 [00:01<00:03, 127.75it/s] 25%|██▌       | 139/553 [00:01<00:03, 133.97it/s] 28%|██▊       | 156/553 [00:01<00:02, 143.61it/s] 31%|███       | 172/553 [00:01<00:02, 146.67it/s] 34%|███▍      | 187/553 [00:01<00:02, 143.07it/s] 37%|███▋      | 204/553 [00:01<00:02, 149.49it/s] 40%|███▉      | 220/553 [00:01<00:02, 141.25it/s] 42%|████▏     | 235/553 [00:01<00:02, 141.84it/s] 45%|████▌     | 250/553 [00:01<00:02, 139.83it/s] 48%|████▊     | 265/553 [00:01<00:02, 138.72it/s] 50%|█████     | 279/553 [00:02<00:02, 132.87it/s] 53%|█████▎    | 293/553 [00:02<00:01, 130.37it/s] 56%|█████▌    | 307/553 [00:02<00:01, 124.23it/s] 58%|█████▊    | 320/553 [00:02<00:01, 120.86it/s] 60%|██████    | 333/553 [00:02<00:01, 121.90it/s] 63%|██████▎   | 347/553 [00:02<00:01, 124.95it/s] 65%|██████▌   | 360/553 [00:02<00:01, 118.41it/s] 68%|██████▊   | 376/553 [00:02<00:01, 125.86it/s] 70%|███████   | 389/553 [00:03<00:01, 120.68it/s] 73%|███████▎  | 402/553 [00:03<00:01, 115.31it/s] 75%|███████▌  | 416/553 [00:03<00:01, 116.76it/s] 77%|███████▋  | 428/553 [00:03<00:01, 111.89it/s] 80%|████████  | 445/553 [00:03<00:00, 125.82it/s] 83%|████████▎ | 460/553 [00:03<00:00, 130.92it/s] 86%|████████▌ | 474/553 [00:03<00:00, 132.79it/s] 88%|████████▊ | 488/553 [00:03<00:00, 125.68it/s] 91%|█████████ | 501/553 [00:03<00:00, 118.46it/s] 93%|█████████▎| 515/553 [00:04<00:00, 124.13it/s] 95%|█████████▌| 528/553 [00:04<00:00, 110.16it/s] 98%|█████████▊| 540/553 [00:04<00:00, 111.29it/s]100%|█████████▉| 552/553 [00:04<00:00, 98.33it/s] 100%|██████████| 553/553 [00:04<00:00, 123.92it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 256.87it/s]extract the null data:  57%|█████▋    | 79/139 [00:00<00:00, 416.03it/s]extract the null data:  95%|█████████▍| 132/139 [00:00<00:00, 463.85it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 438.57it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 184.19it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 185.52it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 185.14it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 184.20it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 184.06it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 183.01it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 182.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 183.62it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.46it/s] 17%|█▋        | 23/139 [00:00<00:01, 113.35it/s] 27%|██▋       | 37/139 [00:00<00:00, 121.61it/s] 36%|███▌      | 50/139 [00:00<00:00, 120.85it/s] 45%|████▌     | 63/139 [00:00<00:00, 117.71it/s] 54%|█████▍    | 75/139 [00:00<00:00, 117.54it/s] 63%|██████▎   | 87/139 [00:00<00:00, 107.77it/s] 71%|███████   | 99/139 [00:00<00:00, 108.42it/s] 79%|███████▉  | 110/139 [00:00<00:00, 108.14it/s] 90%|████████▉ | 125/139 [00:01<00:00, 117.33it/s] 99%|█████████▊| 137/139 [00:01<00:00, 116.95it/s]100%|██████████| 139/139 [00:01<00:00, 115.25it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 276.89it/s]extract the null data:  46%|████▌     | 80/173 [00:00<00:00, 418.50it/s]extract the null data:  77%|███████▋  | 133/173 [00:00<00:00, 467.27it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 454.89it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 184.50it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 183.66it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 182.84it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 178.40it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 180.57it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 182.18it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 181.53it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 181.20it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 178.14it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 180.22it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.06it/s] 16%|█▌        | 27/173 [00:00<00:01, 109.52it/s] 23%|██▎       | 40/173 [00:00<00:01, 117.29it/s] 32%|███▏      | 55/173 [00:00<00:00, 125.50it/s] 39%|███▉      | 68/173 [00:00<00:00, 124.67it/s] 47%|████▋     | 81/173 [00:00<00:00, 123.90it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.15it/s] 62%|██████▏   | 107/173 [00:00<00:00, 123.87it/s] 69%|██████▉   | 120/173 [00:00<00:00, 124.24it/s] 77%|███████▋  | 133/173 [00:01<00:00, 118.49it/s] 84%|████████▍ | 145/173 [00:01<00:00, 118.75it/s] 91%|█████████ | 157/173 [00:01<00:00, 108.35it/s] 98%|█████████▊| 169/173 [00:01<00:00, 89.90it/s] 100%|██████████| 173/173 [00:01<00:00, 107.96it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.008, train f1 : 0.706, valid f1 : 0.647
training process - Deferred Re-weighting:   1%|          | 1/128 [01:34<3:19:27, 94.24s/it]Best score increase :0.000 -> 0.647
training process - Deferred Re-weighting:   2%|▏         | 2/128 [03:00<3:08:00, 89.53s/it]Best score increase :0.647 -> 0.689
training process - Deferred Re-weighting:   2%|▏         | 3/128 [04:32<3:08:42, 90.58s/it]Best score increase :0.689 -> 0.727
training process - Deferred Re-weighting:   3%|▎         | 4/128 [06:00<3:05:04, 89.55s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.007, valid loss : 0.006, train f1 : 0.837, valid f1 : 0.725
training process - Deferred Re-weighting:   4%|▍         | 5/128 [07:22<2:58:26, 87.04s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [08:44<2:53:06, 85.14s/it]Best score increase :0.727 -> 0.744
training process - Deferred Re-weighting:   5%|▌         | 7/128 [10:12<2:53:45, 86.17s/it]Best score increase :0.744 -> 0.763
training process - Deferred Re-weighting:   6%|▋         | 8/128 [11:41<2:54:05, 87.05s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.006, valid loss : 0.005, train f1 : 0.866, valid f1 : 0.787
training process - Deferred Re-weighting:   7%|▋         | 9/128 [13:18<2:58:57, 90.23s/it]Best score increase :0.763 -> 0.787
training process - Deferred Re-weighting:   8%|▊         | 10/128 [14:43<2:54:13, 88.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [16:07<2:50:06, 87.23s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [17:32<2:47:21, 86.56s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.004, train f1 : 0.873, valid f1 : 0.789
training process - Deferred Re-weighting:  10%|█         | 13/128 [19:02<2:47:30, 87.40s/it]Best score increase :0.787 -> 0.789
training process - Deferred Re-weighting:  11%|█         | 14/128 [20:25<2:43:48, 86.22s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [21:56<2:44:51, 87.53s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [23:14<2:38:19, 84.81s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.004, train f1 : 0.885, valid f1 : 0.793
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [24:38<2:36:17, 84.48s/it]Best score increase :0.789 -> 0.793
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [26:08<2:38:10, 86.27s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [27:17<2:27:13, 81.04s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [28:33<2:22:55, 79.40s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.004, train f1 : 0.893, valid f1 : 0.798
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [29:51<2:20:46, 78.94s/it]Best score increase :0.793 -> 0.798
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [31:16<2:22:44, 80.80s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [32:33<2:19:13, 79.56s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [33:41<2:12:10, 76.26s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.004, train f1 : 0.902, valid f1 : 0.790
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [35:01<2:12:53, 77.42s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [36:14<2:09:01, 75.90s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [37:31<2:08:38, 76.42s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [38:47<2:07:11, 76.32s/it]Best score increase :0.798 -> 0.827
epoch : 29, train loss : 0.005, valid loss : 0.004, train f1 : 0.902, valid f1 : 0.807
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [40:01<2:04:29, 75.45s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [41:32<2:11:07, 80.28s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [43:04<2:15:10, 83.61s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [44:30<2:15:17, 84.56s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.005, train f1 : 0.909, valid f1 : 0.783
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [46:00<2:16:20, 86.11s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [47:20<2:12:02, 84.28s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [48:42<2:09:25, 83.50s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [50:16<2:13:04, 86.78s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.004, valid loss : 0.005, train f1 : 0.908, valid f1 : 0.751
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [51:41<2:10:28, 86.02s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [53:08<2:09:46, 86.51s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [54:30<2:06:10, 85.06s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [55:59<2:07:46, 86.14s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 39, best f1 score : 0.827
training process finished, best loss : 0.003, best acc : 0.940, best f1 : 0.827, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.78      0.64       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.86      0.80      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.86, test loss : 0.209

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.68s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.84s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.82s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:01,  7.72s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.78s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.84s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.57s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:22,  7.66s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.69s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.58s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.78s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 126.29it/s]  9%|▉         | 27/306 [00:00<00:02, 125.53it/s] 13%|█▎        | 40/306 [00:00<00:02, 124.68it/s] 17%|█▋        | 53/306 [00:00<00:02, 124.66it/s] 22%|██▏       | 66/306 [00:00<00:02, 109.55it/s] 26%|██▌       | 79/306 [00:00<00:02, 111.87it/s] 30%|███       | 92/306 [00:00<00:01, 114.40it/s] 34%|███▍      | 104/306 [00:00<00:01, 111.80it/s] 38%|███▊      | 117/306 [00:01<00:01, 116.98it/s] 42%|████▏     | 130/306 [00:01<00:01, 119.36it/s] 47%|████▋     | 143/306 [00:01<00:01, 120.09it/s] 51%|█████▏    | 157/306 [00:01<00:01, 124.76it/s] 56%|█████▌    | 170/306 [00:01<00:01, 112.21it/s] 60%|██████    | 185/306 [00:01<00:01, 119.06it/s] 65%|██████▌   | 199/306 [00:01<00:00, 121.54it/s] 69%|██████▉   | 212/306 [00:01<00:00, 117.68it/s] 73%|███████▎  | 224/306 [00:01<00:00, 117.53it/s] 77%|███████▋  | 236/306 [00:02<00:00, 109.72it/s] 82%|████████▏ | 251/306 [00:02<00:00, 117.27it/s] 87%|████████▋ | 265/306 [00:02<00:00, 121.32it/s] 91%|█████████ | 278/306 [00:02<00:00, 112.30it/s] 95%|█████████▌| 291/306 [00:02<00:00, 115.71it/s] 99%|█████████▉| 303/306 [00:02<00:00, 112.12it/s]100%|██████████| 306/306 [00:02<00:00, 115.97it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 469.56it/s]extract the null data:  18%|█▊        | 97/553 [00:00<00:00, 486.34it/s]extract the null data:  27%|██▋       | 150/553 [00:00<00:00, 502.85it/s]extract the null data:  36%|███▋      | 201/553 [00:00<00:00, 492.55it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 471.89it/s]extract the null data:  54%|█████▍    | 299/553 [00:00<00:00, 472.62it/s]extract the null data:  64%|██████▎   | 352/553 [00:00<00:00, 490.27it/s]extract the null data:  73%|███████▎  | 404/553 [00:00<00:00, 499.49it/s]extract the null data:  82%|████████▏ | 456/553 [00:00<00:00, 503.93it/s]extract the null data:  92%|█████████▏| 507/553 [00:01<00:00, 503.06it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 488.96it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 158.95it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 162.84it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 165.26it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 168.69it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 171.18it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 171.97it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 175.90it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 171.70it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:02, 168.38it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:02, 168.26it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:02, 171.37it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 180.17it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:01, 178.10it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 182.49it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 180.26it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 175.94it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 174.52it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 175.89it/s]replace nan value:  63%|██████▎   | 347/553 [00:01<00:01, 178.54it/s]replace nan value:  66%|██████▌   | 366/553 [00:02<00:01, 180.89it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 180.80it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 178.32it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 177.19it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 176.74it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 177.47it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 174.37it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 173.25it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 172.22it/s]replace nan value:  96%|█████████▌| 531/553 [00:03<00:00, 176.09it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 175.38it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 174.71it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 10/553 [00:00<00:05, 98.99it/s]  4%|▍         | 24/553 [00:00<00:04, 116.23it/s]  7%|▋         | 38/553 [00:00<00:04, 122.57it/s]  9%|▉         | 51/553 [00:00<00:04, 105.56it/s] 11%|█         | 62/553 [00:00<00:04, 99.14it/s]  13%|█▎        | 73/553 [00:00<00:04, 100.47it/s] 15%|█▌        | 85/553 [00:00<00:04, 105.99it/s] 18%|█▊        | 97/553 [00:00<00:04, 106.30it/s] 20%|█▉        | 109/553 [00:01<00:04, 109.18it/s] 22%|██▏       | 122/553 [00:01<00:03, 114.04it/s] 24%|██▍       | 135/553 [00:01<00:03, 118.28it/s] 27%|██▋       | 151/553 [00:01<00:03, 129.57it/s] 30%|███       | 168/553 [00:01<00:02, 141.24it/s] 33%|███▎      | 183/553 [00:01<00:02, 138.24it/s] 36%|███▌      | 199/553 [00:01<00:02, 143.07it/s] 39%|███▉      | 215/553 [00:01<00:02, 146.24it/s] 42%|████▏     | 230/553 [00:01<00:02, 138.31it/s] 44%|████▍     | 244/553 [00:01<00:02, 137.89it/s] 47%|████▋     | 258/553 [00:02<00:02, 137.00it/s] 49%|████▉     | 272/553 [00:02<00:02, 132.03it/s] 52%|█████▏    | 287/553 [00:02<00:01, 136.22it/s] 54%|█████▍    | 301/553 [00:02<00:01, 128.27it/s] 57%|█████▋    | 314/553 [00:02<00:01, 123.64it/s] 59%|█████▉    | 327/553 [00:02<00:01, 123.06it/s] 62%|██████▏   | 341/553 [00:02<00:01, 127.44it/s] 64%|██████▍   | 354/553 [00:02<00:01, 124.48it/s] 66%|██████▋   | 367/553 [00:02<00:01, 124.27it/s] 69%|██████▉   | 382/553 [00:03<00:01, 130.49it/s] 72%|███████▏  | 396/553 [00:03<00:01, 117.83it/s] 74%|███████▍  | 409/553 [00:03<00:01, 120.76it/s] 76%|███████▋  | 422/553 [00:03<00:01, 117.56it/s] 78%|███████▊  | 434/553 [00:03<00:01, 114.23it/s] 82%|████████▏ | 451/553 [00:03<00:00, 127.83it/s] 84%|████████▍ | 465/553 [00:03<00:00, 130.88it/s] 87%|████████▋ | 479/553 [00:03<00:00, 128.70it/s] 89%|████████▉ | 492/553 [00:03<00:00, 124.14it/s] 91%|█████████▏| 505/553 [00:04<00:00, 121.45it/s] 94%|█████████▍| 520/553 [00:04<00:00, 125.53it/s] 96%|█████████▋| 533/553 [00:04<00:00, 108.22it/s] 99%|█████████▉| 549/553 [00:04<00:00, 119.67it/s]100%|██████████| 553/553 [00:04<00:00, 121.26it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 279.31it/s]extract the null data:  64%|██████▍   | 89/139 [00:00<00:00, 469.45it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 493.21it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 184.49it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 184.94it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 182.46it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 187.55it/s]replace nan value:  71%|███████   | 98/139 [00:00<00:00, 193.81it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 196.76it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.88it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 192.64it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.36it/s] 18%|█▊        | 25/139 [00:00<00:00, 118.28it/s] 28%|██▊       | 39/139 [00:00<00:00, 126.51it/s] 37%|███▋      | 52/139 [00:00<00:00, 116.15it/s] 47%|████▋     | 66/139 [00:00<00:00, 121.37it/s] 57%|█████▋    | 79/139 [00:00<00:00, 118.93it/s] 65%|██████▌   | 91/139 [00:00<00:00, 113.56it/s] 76%|███████▌  | 105/139 [00:00<00:00, 120.16it/s] 87%|████████▋ | 121/139 [00:00<00:00, 131.35it/s] 97%|█████████▋| 135/139 [00:01<00:00, 129.77it/s]100%|██████████| 139/139 [00:01<00:00, 124.92it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  11%|█         | 19/173 [00:00<00:00, 188.56it/s]extract the null data:  47%|████▋     | 82/173 [00:00<00:00, 444.26it/s]extract the null data:  77%|███████▋  | 134/173 [00:00<00:00, 476.02it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 456.51it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 183.17it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 187.73it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 192.43it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 197.48it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 201.74it/s]replace nan value:  71%|███████   | 122/173 [00:00<00:00, 202.16it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 195.25it/s]replace nan value:  94%|█████████▍| 163/173 [00:00<00:00, 190.16it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 191.67it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 126.38it/s] 16%|█▌        | 27/173 [00:00<00:01, 111.92it/s] 24%|██▎       | 41/173 [00:00<00:01, 121.32it/s] 32%|███▏      | 56/173 [00:00<00:00, 130.76it/s] 40%|████      | 70/173 [00:00<00:00, 127.04it/s] 48%|████▊     | 83/173 [00:00<00:00, 126.95it/s] 55%|█████▌    | 96/173 [00:00<00:00, 125.72it/s] 64%|██████▎   | 110/173 [00:00<00:00, 129.31it/s] 71%|███████   | 123/173 [00:00<00:00, 122.61it/s] 79%|███████▊  | 136/173 [00:01<00:00, 120.63it/s] 86%|████████▌ | 149/173 [00:01<00:00, 117.41it/s] 93%|█████████▎| 161/173 [00:01<00:00, 114.38it/s]100%|██████████| 173/173 [00:01<00:00, 91.29it/s] 100%|██████████| 173/173 [00:01<00:00, 113.34it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.459, valid loss : 0.387, train acc : 0.903, valid acc : 0.914, train f1 : 0.516, valid f1 : 0.500
training process:   1%|          | 1/128 [01:37<3:25:21, 97.02s/it]Best score increase :0.000 -> 0.500
training process:   2%|▏         | 2/128 [03:02<3:09:02, 90.02s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [04:16<2:52:59, 83.04s/it]Best score increase :0.500 -> 0.501
training process:   3%|▎         | 4/128 [05:43<2:54:48, 84.59s/it]Best score increase :0.501 -> 0.511
epoch : 5, train loss : 0.265, valid loss : 0.263, train acc : 0.921, valid acc : 0.922, train f1 : 0.517, valid f1 : 0.569
training process:   4%|▍         | 5/128 [07:20<3:02:03, 88.81s/it]Best score increase :0.511 -> 0.569
training process:   5%|▍         | 6/128 [08:40<2:54:33, 85.85s/it]Best score increase :0.569 -> 0.596
training process:   5%|▌         | 7/128 [10:00<2:49:41, 84.15s/it]Best score increase :0.596 -> 0.645
training process:   6%|▋         | 8/128 [11:26<2:49:29, 84.75s/it]Best score increase :0.645 -> 0.660
epoch : 9, train loss : 0.195, valid loss : 0.200, train acc : 0.939, valid acc : 0.942, train f1 : 0.720, valid f1 : 0.755
training process:   7%|▋         | 9/128 [13:05<2:56:40, 89.08s/it]Best score increase :0.660 -> 0.755
training process:   8%|▊         | 10/128 [14:37<2:56:45, 89.88s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [16:05<2:54:09, 89.31s/it]Best score increase :0.755 -> 0.758
training process:   9%|▉         | 12/128 [17:25<2:47:12, 86.48s/it]Best score increase :0.758 -> 0.772
epoch : 13, train loss : 0.166, valid loss : 0.177, train acc : 0.949, valid acc : 0.949, train f1 : 0.781, valid f1 : 0.784
training process:  10%|█         | 13/128 [18:35<2:36:27, 81.63s/it]Best score increase :0.772 -> 0.784
training process:  11%|█         | 14/128 [19:35<2:22:25, 74.96s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [20:40<2:15:34, 71.98s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [21:45<2:10:37, 69.98s/it]Best score increase :0.784 -> 0.791
epoch : 17, train loss : 0.152, valid loss : 0.165, train acc : 0.953, valid acc : 0.951, train f1 : 0.803, valid f1 : 0.804
training process:  13%|█▎        | 17/128 [22:58<2:11:12, 70.92s/it]Best score increase :0.791 -> 0.804
training process:  14%|█▍        | 18/128 [24:07<2:08:58, 70.35s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [25:11<2:04:12, 68.37s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [26:13<1:59:35, 66.44s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.145, valid loss : 0.158, train acc : 0.953, valid acc : 0.953, train f1 : 0.809, valid f1 : 0.809
training process:  16%|█▋        | 21/128 [27:27<2:02:37, 68.76s/it]Best score increase :0.804 -> 0.809
training process:  17%|█▋        | 22/128 [28:34<2:00:24, 68.16s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [29:41<1:58:29, 67.71s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [30:45<1:55:35, 66.68s/it]Best score increase :0.809 -> 0.811
epoch : 25, train loss : 0.139, valid loss : 0.155, train acc : 0.956, valid acc : 0.953, train f1 : 0.819, valid f1 : 0.812
training process:  20%|█▉        | 25/128 [31:54<1:55:52, 67.50s/it]Best score increase :0.811 -> 0.812
training process:  20%|██        | 26/128 [32:56<1:51:48, 65.77s/it]Best score increase :0.812 -> 0.814
training process:  21%|██        | 27/128 [33:56<1:47:42, 63.99s/it]Best score increase :0.814 -> 0.816
training process:  22%|██▏       | 28/128 [34:49<1:41:27, 60.88s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.131, valid loss : 0.155, train acc : 0.958, valid acc : 0.953, train f1 : 0.831, valid f1 : 0.807
training process:  23%|██▎       | 29/128 [36:00<1:45:22, 63.87s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [37:02<1:43:24, 63.31s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [37:59<1:39:11, 61.35s/it]Best score increase :0.816 -> 0.818
training process:  25%|██▌       | 32/128 [38:58<1:36:48, 60.51s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.128, valid loss : 0.146, train acc : 0.960, valid acc : 0.952, train f1 : 0.838, valid f1 : 0.817
training process:  26%|██▌       | 33/128 [40:06<1:39:33, 62.87s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [41:01<1:34:56, 60.60s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [41:57<1:31:49, 59.24s/it]EarlyStopping counter : 4 out of 12
training process:  28%|██▊       | 36/128 [42:53<1:29:11, 58.17s/it]EarlyStopping counter : 5 out of 12
epoch : 37, train loss : 0.125, valid loss : 0.153, train acc : 0.961, valid acc : 0.953, train f1 : 0.844, valid f1 : 0.809
training process:  29%|██▉       | 37/128 [43:57<1:31:04, 60.05s/it]EarlyStopping counter : 6 out of 12
training process:  30%|██▉       | 38/128 [44:55<1:29:05, 59.39s/it]Best score increase :0.818 -> 0.820
training process:  30%|███       | 39/128 [45:55<1:28:26, 59.62s/it]Best score increase :0.820 -> 0.824
training process:  31%|███▏      | 40/128 [46:49<1:24:41, 57.74s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.124, valid loss : 0.153, train acc : 0.961, valid acc : 0.954, train f1 : 0.844, valid f1 : 0.816
training process:  32%|███▏      | 41/128 [47:51<1:25:41, 59.10s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [48:46<1:22:57, 57.87s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [49:36<1:18:33, 55.46s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [50:24<1:14:22, 53.13s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.120, valid loss : 0.147, train acc : 0.963, valid acc : 0.954, train f1 : 0.854, valid f1 : 0.828
training process:  35%|███▌      | 45/128 [51:17<1:13:46, 53.33s/it]Best score increase :0.824 -> 0.828
training process:  36%|███▌      | 46/128 [52:03<1:09:48, 51.08s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [52:51<1:07:36, 50.08s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [53:41<1:06:40, 50.00s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.119, valid loss : 0.147, train acc : 0.962, valid acc : 0.956, train f1 : 0.850, valid f1 : 0.821
training process:  38%|███▊      | 49/128 [54:39<1:08:57, 52.37s/it]EarlyStopping counter : 4 out of 12
training process:  39%|███▉      | 50/128 [55:29<1:07:14, 51.73s/it]Best score increase :0.828 -> 0.834
training process:  40%|███▉      | 51/128 [56:20<1:06:17, 51.65s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [57:11<1:05:03, 51.36s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.117, valid loss : 0.142, train acc : 0.963, valid acc : 0.956, train f1 : 0.855, valid f1 : 0.823
training process:  41%|████▏     | 53/128 [58:10<1:07:10, 53.74s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [59:02<1:05:30, 53.11s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [59:53<1:03:50, 52.47s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [1:00:44<1:02:24, 52.00s/it]Best score increase :0.834 -> 0.841
epoch : 57, train loss : 0.113, valid loss : 0.138, train acc : 0.964, valid acc : 0.956, train f1 : 0.861, valid f1 : 0.834
training process:  45%|████▍     | 57/128 [1:01:45<1:04:51, 54.81s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [1:02:48<1:06:39, 57.14s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 59/128 [1:03:56<1:09:39, 60.57s/it]EarlyStopping counter : 3 out of 12
training process:  47%|████▋     | 60/128 [1:05:02<1:10:29, 62.20s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.112, valid loss : 0.142, train acc : 0.965, valid acc : 0.957, train f1 : 0.862, valid f1 : 0.830
training process:  48%|████▊     | 61/128 [1:06:20<1:14:32, 66.76s/it]EarlyStopping counter : 5 out of 12
training process:  48%|████▊     | 62/128 [1:07:46<1:19:45, 72.50s/it]EarlyStopping counter : 6 out of 12
training process:  49%|████▉     | 63/128 [1:09:08<1:21:44, 75.46s/it]EarlyStopping counter : 7 out of 12
training process:  50%|█████     | 64/128 [1:10:44<1:26:57, 81.52s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.113, valid loss : 0.150, train acc : 0.965, valid acc : 0.955, train f1 : 0.863, valid f1 : 0.814
training process:  51%|█████     | 65/128 [1:12:27<1:32:32, 88.14s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 66/128 [1:13:29<1:22:50, 80.17s/it]EarlyStopping counter : 10 out of 12
training process:  52%|█████▏    | 67/128 [1:14:43<1:19:38, 78.33s/it]EarlyStopping counter : 11 out of 12
training process:  52%|█████▏    | 67/128 [1:15:51<1:09:03, 67.93s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 67, best f1 score : 0.841
training process finished, best loss : 0.134 and best acc : 0.957, best f1 : 0.841, best epoch : 55

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.62      0.61       580
           1       0.97      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.79      0.79      7398
weighted avg       0.94      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.79, test AUC : 0.79, test loss : 9.917

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:38,  9.00s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:27,  8.78s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:17,  8.60s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:07,  8.38s/it]processing for feature importance:  42%|████▏     | 5/12 [00:42<00:57,  8.25s/it]processing for feature importance:  50%|█████     | 6/12 [00:50<00:49,  8.18s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:58<00:41,  8.30s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:32,  8.17s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:14<00:24,  8.13s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:23<00:16,  8.23s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:31<00:08,  8.25s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.24s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.30s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 209.78it/s] 14%|█▎        | 42/306 [00:00<00:01, 136.35it/s] 19%|█▉        | 58/306 [00:00<00:01, 141.01it/s] 24%|██▍       | 73/306 [00:00<00:01, 120.65it/s] 28%|██▊       | 87/306 [00:00<00:01, 125.99it/s] 33%|███▎      | 101/306 [00:00<00:01, 127.83it/s] 38%|███▊      | 115/306 [00:00<00:01, 121.26it/s] 42%|████▏     | 130/306 [00:00<00:01, 127.66it/s] 49%|████▉     | 150/306 [00:01<00:01, 146.14it/s] 54%|█████▍    | 165/306 [00:01<00:01, 138.00it/s] 59%|█████▉    | 180/306 [00:01<00:00, 139.44it/s] 64%|██████▍   | 196/306 [00:01<00:00, 141.08it/s] 69%|██████▉   | 211/306 [00:01<00:00, 138.69it/s] 74%|███████▍  | 227/306 [00:01<00:00, 143.50it/s] 79%|███████▉  | 242/306 [00:01<00:00, 128.13it/s] 85%|████████▍ | 260/306 [00:01<00:00, 138.60it/s] 90%|████████▉ | 275/306 [00:02<00:00, 141.14it/s] 95%|█████████▍| 290/306 [00:02<00:00, 130.83it/s] 99%|█████████▉| 304/306 [00:02<00:00, 132.15it/s]100%|██████████| 306/306 [00:02<00:00, 135.49it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 37/553 [00:00<00:01, 367.51it/s]extract the null data:  14%|█▍        | 77/553 [00:00<00:01, 384.93it/s]extract the null data:  21%|██        | 117/553 [00:00<00:01, 387.38it/s]extract the null data:  29%|██▊       | 158/553 [00:00<00:01, 393.64it/s]extract the null data:  36%|███▌      | 198/553 [00:00<00:00, 391.11it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 402.71it/s]extract the null data:  51%|█████     | 283/553 [00:00<00:00, 406.07it/s]extract the null data:  59%|█████▉    | 327/553 [00:00<00:00, 416.48it/s]extract the null data:  67%|██████▋   | 369/553 [00:00<00:00, 413.01it/s]extract the null data:  74%|███████▍  | 411/553 [00:01<00:00, 402.24it/s]extract the null data:  82%|████████▏ | 452/553 [00:01<00:00, 394.74it/s]extract the null data:  89%|████████▉ | 494/553 [00:01<00:00, 401.66it/s]extract the null data:  97%|█████████▋| 535/553 [00:01<00:00, 396.86it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 398.35it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 162.54it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 166.98it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:03, 163.30it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:03, 160.20it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 158.64it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 157.56it/s]replace nan value:  21%|██▏       | 118/553 [00:00<00:02, 157.23it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 157.69it/s]replace nan value:  27%|██▋       | 150/553 [00:00<00:02, 155.06it/s]replace nan value:  30%|███       | 166/553 [00:01<00:02, 153.56it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 153.87it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:02, 156.14it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:02, 156.80it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:02, 157.97it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 158.40it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 158.90it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 154.86it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 152.20it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 157.03it/s]replace nan value:  60%|██████    | 332/553 [00:02<00:01, 161.62it/s]replace nan value:  63%|██████▎   | 349/553 [00:02<00:01, 162.88it/s]replace nan value:  66%|██████▌   | 366/553 [00:02<00:01, 157.00it/s]replace nan value:  69%|██████▉   | 382/553 [00:02<00:01, 155.73it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:01, 151.51it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 151.34it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 151.11it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 155.74it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 158.96it/s]replace nan value:  87%|████████▋ | 481/553 [00:03<00:00, 161.07it/s]replace nan value:  90%|█████████ | 498/553 [00:03<00:00, 159.82it/s]replace nan value:  93%|█████████▎| 515/553 [00:03<00:00, 160.21it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 158.89it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 160.63it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 157.47it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.37it/s]  5%|▍         | 26/553 [00:00<00:04, 128.02it/s]  7%|▋         | 40/553 [00:00<00:04, 127.15it/s] 10%|▉         | 53/553 [00:00<00:04, 116.73it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.15it/s] 14%|█▍        | 78/553 [00:00<00:04, 113.13it/s] 16%|█▋        | 91/553 [00:00<00:03, 117.03it/s] 19%|█▉        | 104/553 [00:00<00:03, 119.30it/s] 22%|██▏       | 120/553 [00:00<00:03, 129.37it/s] 24%|██▍       | 134/553 [00:01<00:03, 128.13it/s] 27%|██▋       | 150/553 [00:01<00:02, 136.24it/s] 30%|███       | 167/553 [00:01<00:02, 144.47it/s] 33%|███▎      | 182/553 [00:01<00:02, 142.77it/s] 36%|███▌      | 197/553 [00:01<00:02, 144.69it/s] 39%|███▊      | 214/553 [00:01<00:02, 150.21it/s] 42%|████▏     | 230/553 [00:01<00:02, 138.69it/s] 44%|████▍     | 245/553 [00:01<00:02, 137.00it/s] 47%|████▋     | 259/553 [00:01<00:02, 137.50it/s] 49%|████▉     | 273/553 [00:02<00:02, 131.13it/s] 52%|█████▏    | 288/553 [00:02<00:01, 134.92it/s] 55%|█████▍    | 302/553 [00:02<00:01, 128.38it/s] 57%|█████▋    | 315/553 [00:02<00:01, 123.73it/s] 59%|█████▉    | 328/553 [00:02<00:01, 123.81it/s] 62%|██████▏   | 343/553 [00:02<00:01, 130.12it/s] 65%|██████▍   | 357/553 [00:02<00:01, 123.73it/s] 67%|██████▋   | 372/553 [00:02<00:01, 130.11it/s] 70%|██████▉   | 386/553 [00:02<00:01, 120.79it/s] 72%|███████▏  | 399/553 [00:03<00:01, 108.92it/s] 75%|███████▍  | 414/553 [00:03<00:01, 118.65it/s] 77%|███████▋  | 427/553 [00:03<00:01, 109.27it/s] 80%|████████  | 443/553 [00:03<00:00, 120.73it/s] 83%|████████▎ | 458/553 [00:03<00:00, 126.76it/s] 85%|████████▌ | 472/553 [00:03<00:00, 129.59it/s] 88%|████████▊ | 486/553 [00:03<00:00, 124.67it/s] 90%|█████████ | 499/553 [00:03<00:00, 117.26it/s] 93%|█████████▎| 514/553 [00:04<00:00, 123.33it/s] 95%|█████████▌| 527/553 [00:04<00:00, 111.16it/s] 97%|█████████▋| 539/553 [00:04<00:00, 111.86it/s]100%|█████████▉| 551/553 [00:04<00:00, 97.20it/s] 100%|██████████| 553/553 [00:04<00:00, 123.00it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 258.70it/s]extract the null data:  55%|█████▍    | 76/139 [00:00<00:00, 396.81it/s]extract the null data:  91%|█████████ | 126/139 [00:00<00:00, 441.09it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 420.75it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 174.70it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 171.06it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 163.96it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 166.65it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 169.21it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 167.67it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 165.23it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 167.24it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 129.15it/s] 19%|█▉        | 27/139 [00:00<00:00, 134.97it/s] 32%|███▏      | 44/139 [00:00<00:00, 145.59it/s] 42%|████▏     | 59/139 [00:00<00:00, 136.16it/s] 53%|█████▎    | 74/139 [00:00<00:00, 140.48it/s] 64%|██████▍   | 89/139 [00:00<00:00, 122.06it/s] 75%|███████▍  | 104/139 [00:00<00:00, 127.69it/s] 85%|████████▍ | 118/139 [00:00<00:00, 128.78it/s] 95%|█████████▍| 132/139 [00:01<00:00, 126.18it/s]100%|██████████| 139/139 [00:01<00:00, 132.17it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 2/173 [00:00<00:08, 19.86it/s]extract the null data:  27%|██▋       | 47/173 [00:00<00:00, 271.50it/s]extract the null data:  55%|█████▌    | 96/173 [00:00<00:00, 370.47it/s]extract the null data:  83%|████████▎ | 144/173 [00:00<00:00, 410.74it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 372.45it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 173.79it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 173.60it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 175.20it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 178.95it/s]replace nan value:  54%|█████▍    | 93/173 [00:00<00:00, 185.21it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 189.66it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 186.46it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 180.01it/s]replace nan value:  98%|█████████▊| 170/173 [00:00<00:00, 173.11it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 178.21it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 125.26it/s] 15%|█▌        | 26/173 [00:00<00:01, 103.74it/s] 23%|██▎       | 39/173 [00:00<00:01, 112.23it/s] 31%|███       | 53/173 [00:00<00:00, 122.12it/s] 38%|███▊      | 66/173 [00:00<00:00, 121.72it/s] 46%|████▌     | 80/173 [00:00<00:00, 123.99it/s] 55%|█████▍    | 95/173 [00:00<00:00, 130.45it/s] 64%|██████▍   | 111/173 [00:00<00:00, 138.59it/s] 72%|███████▏  | 125/173 [00:00<00:00, 133.60it/s] 81%|████████  | 140/173 [00:01<00:00, 137.19it/s] 89%|████████▉ | 154/173 [00:01<00:00, 128.88it/s] 97%|█████████▋| 168/173 [00:01<00:00, 104.36it/s]100%|██████████| 173/173 [00:01<00:00, 116.34it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.623, valid loss : 0.467, train acc : 0.648, valid acc : 0.784, train f1 : 0.642, valid f1 : 0.600
training process:   1%|          | 1/128 [01:23<2:56:03, 83.18s/it]Best score increase :0.000 -> 0.600
training process:   2%|▏         | 2/128 [02:28<2:32:34, 72.66s/it]Best score increase :0.600 -> 0.660
training process:   2%|▏         | 3/128 [03:30<2:21:08, 67.75s/it]Best score increase :0.660 -> 0.705
training process:   3%|▎         | 4/128 [04:35<2:18:06, 66.83s/it]Best score increase :0.705 -> 0.725
epoch : 5, train loss : 0.387, valid loss : 0.319, train acc : 0.823, valid acc : 0.886, train f1 : 0.822, valid f1 : 0.728
training process:   4%|▍         | 5/128 [05:47<2:20:58, 68.76s/it]Best score increase :0.725 -> 0.728
training process:   5%|▍         | 6/128 [07:01<2:23:22, 70.51s/it]Best score increase :0.728 -> 0.771
training process:   5%|▌         | 7/128 [08:22<2:29:01, 73.90s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:30<2:24:07, 72.07s/it]Best score increase :0.771 -> 0.788
epoch : 9, train loss : 0.339, valid loss : 0.266, train acc : 0.850, valid acc : 0.911, train f1 : 0.850, valid f1 : 0.768
training process:   7%|▋         | 9/128 [10:50<2:27:30, 74.37s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [11:59<2:23:08, 72.78s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [13:06<2:18:13, 70.88s/it]Best score increase :0.788 -> 0.801
training process:   9%|▉         | 12/128 [14:14<2:15:27, 70.07s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.310, valid loss : 0.258, train acc : 0.862, valid acc : 0.918, train f1 : 0.862, valid f1 : 0.786
training process:  10%|█         | 13/128 [15:25<2:14:45, 70.31s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [16:24<2:07:11, 66.94s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [17:22<2:00:52, 64.18s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [18:20<1:56:46, 62.56s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.293, valid loss : 0.258, train acc : 0.874, valid acc : 0.911, train f1 : 0.874, valid f1 : 0.781
training process:  13%|█▎        | 17/128 [19:30<1:59:25, 64.55s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [20:33<1:57:27, 64.07s/it]Best score increase :0.801 -> 0.805
training process:  15%|█▍        | 19/128 [21:32<1:54:05, 62.80s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [22:34<1:52:17, 62.38s/it]Best score increase :0.805 -> 0.815
epoch : 21, train loss : 0.280, valid loss : 0.233, train acc : 0.881, valid acc : 0.919, train f1 : 0.880, valid f1 : 0.796
training process:  16%|█▋        | 21/128 [23:48<1:57:25, 65.84s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [24:47<1:52:35, 63.73s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [25:43<1:47:41, 61.54s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [26:44<1:46:24, 61.39s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.264, valid loss : 0.204, train acc : 0.890, valid acc : 0.933, train f1 : 0.890, valid f1 : 0.818
training process:  20%|█▉        | 25/128 [27:47<1:46:25, 61.99s/it]Best score increase :0.815 -> 0.818
training process:  20%|██        | 26/128 [28:40<1:40:50, 59.32s/it]Best score increase :0.818 -> 0.829
training process:  21%|██        | 27/128 [29:35<1:37:17, 57.80s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [30:27<1:33:32, 56.12s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.258, valid loss : 0.247, train acc : 0.892, valid acc : 0.908, train f1 : 0.892, valid f1 : 0.782
training process:  23%|██▎       | 29/128 [31:31<1:36:28, 58.47s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [32:26<1:33:42, 57.37s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [33:21<1:31:31, 56.61s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [34:15<1:29:44, 56.09s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.250, valid loss : 0.218, train acc : 0.898, valid acc : 0.919, train f1 : 0.898, valid f1 : 0.800
training process:  26%|██▌       | 33/128 [35:24<1:34:50, 59.90s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [36:17<1:30:24, 57.71s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [37:09<1:27:02, 56.16s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [38:04<1:25:26, 55.72s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.235, valid loss : 0.233, train acc : 0.902, valid acc : 0.914, train f1 : 0.902, valid f1 : 0.791
training process:  29%|██▉       | 37/128 [39:07<1:27:44, 57.85s/it]EarlyStopping counter : 11 out of 12
training process:  29%|██▉       | 37/128 [40:01<1:38:26, 64.90s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.829
training process finished, best loss : 0.191 and best acc : 0.939, best f1 : 0.829, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.82      0.69       580
           1       0.98      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.89      0.83      7398
weighted avg       0.95      0.94      0.95      7398


# test acc : 0.94, test f1 : 0.83, test AUC : 0.89, test loss : 11.615

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.25s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.87s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.98s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:01,  7.73s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.66s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:45,  7.61s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:37,  7.51s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.52s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.47s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:14,  7.46s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.37s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.36s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.54s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 81.54it/s]  7%|▋         | 20/306 [00:00<00:03, 91.23it/s] 10%|▉         | 30/306 [00:00<00:02, 92.80it/s] 14%|█▎        | 42/306 [00:00<00:02, 98.62it/s] 17%|█▋        | 52/306 [00:00<00:02, 93.82it/s] 20%|██        | 62/306 [00:00<00:02, 93.64it/s] 24%|██▍       | 73/306 [00:00<00:02, 95.38it/s] 27%|██▋       | 83/306 [00:00<00:02, 96.51it/s] 30%|███       | 93/306 [00:00<00:02, 91.15it/s] 34%|███▎      | 103/306 [00:01<00:02, 93.22it/s] 38%|███▊      | 115/306 [00:01<00:01, 98.81it/s] 42%|████▏     | 127/306 [00:01<00:01, 104.16it/s] 45%|████▌     | 138/306 [00:01<00:01, 96.06it/s]  49%|████▊     | 149/306 [00:01<00:01, 97.86it/s] 53%|█████▎    | 161/306 [00:01<00:01, 102.67it/s] 56%|█████▌    | 172/306 [00:01<00:01, 103.78it/s] 60%|█████▉    | 183/306 [00:01<00:01, 96.02it/s]  63%|██████▎   | 193/306 [00:01<00:01, 96.59it/s] 66%|██████▋   | 203/306 [00:02<00:01, 96.80it/s] 70%|██████▉   | 214/306 [00:02<00:00, 98.97it/s] 73%|███████▎  | 224/306 [00:02<00:00, 92.99it/s] 76%|███████▋  | 234/306 [00:02<00:00, 94.76it/s] 80%|███████▉  | 244/306 [00:02<00:00, 95.23it/s] 83%|████████▎ | 254/306 [00:02<00:00, 94.13it/s] 86%|████████▋ | 264/306 [00:02<00:00, 90.68it/s] 90%|████████▉ | 274/306 [00:02<00:00, 92.26it/s] 93%|█████████▎| 284/306 [00:02<00:00, 93.96it/s] 96%|█████████▌| 294/306 [00:03<00:00, 91.43it/s] 99%|█████████▉| 304/306 [00:03<00:00, 91.96it/s]100%|██████████| 306/306 [00:03<00:00, 95.08it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 474.81it/s]extract the null data:  17%|█▋        | 96/553 [00:00<00:00, 471.44it/s]extract the null data:  26%|██▌       | 144/553 [00:00<00:00, 473.44it/s]extract the null data:  35%|███▌      | 195/553 [00:00<00:00, 485.98it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 491.51it/s]extract the null data:  54%|█████▎    | 296/553 [00:00<00:00, 491.24it/s]extract the null data:  63%|██████▎   | 347/553 [00:00<00:00, 496.71it/s]extract the null data:  72%|███████▏  | 397/553 [00:00<00:00, 495.98it/s]extract the null data:  81%|████████  | 447/553 [00:00<00:00, 491.35it/s]extract the null data:  90%|████████▉ | 497/553 [00:01<00:00, 488.04it/s]extract the null data:  99%|█████████▊| 546/553 [00:01<00:00, 483.56it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 485.89it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 168.78it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:02, 172.90it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 174.10it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 175.41it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 177.56it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 178.48it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 180.77it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 184.29it/s]replace nan value:  30%|███       | 168/553 [00:00<00:02, 188.07it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:01, 186.61it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 188.75it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 185.52it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 182.11it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 182.74it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 185.78it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 185.43it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 185.52it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 187.78it/s]replace nan value:  65%|██████▌   | 361/553 [00:01<00:01, 186.97it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:00, 188.22it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 188.55it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 190.07it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 187.81it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 189.15it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 187.21it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 189.12it/s]replace nan value:  94%|█████████▎| 518/553 [00:02<00:00, 187.05it/s]replace nan value:  97%|█████████▋| 537/553 [00:02<00:00, 185.84it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 184.94it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.83it/s]  5%|▌         | 28/553 [00:00<00:03, 138.53it/s]  8%|▊         | 42/553 [00:00<00:03, 132.79it/s] 10%|█         | 56/553 [00:00<00:04, 123.92it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.71it/s] 15%|█▌        | 84/553 [00:00<00:03, 122.07it/s] 18%|█▊        | 98/553 [00:00<00:03, 122.90it/s] 21%|██        | 114/553 [00:00<00:03, 131.96it/s] 23%|██▎       | 128/553 [00:01<00:03, 130.53it/s] 27%|██▋       | 147/553 [00:01<00:02, 145.83it/s] 30%|██▉       | 164/553 [00:01<00:02, 151.75it/s] 33%|███▎      | 181/553 [00:01<00:02, 153.34it/s] 36%|███▌      | 197/553 [00:01<00:02, 153.86it/s] 39%|███▉      | 215/553 [00:01<00:02, 158.87it/s] 42%|████▏     | 231/553 [00:01<00:02, 147.51it/s] 44%|████▍     | 246/553 [00:01<00:02, 147.65it/s] 47%|████▋     | 262/553 [00:01<00:01, 150.91it/s] 50%|█████     | 278/553 [00:01<00:01, 141.80it/s] 53%|█████▎    | 293/553 [00:02<00:01, 136.70it/s] 56%|█████▌    | 307/553 [00:02<00:01, 131.43it/s] 58%|█████▊    | 321/553 [00:02<00:01, 129.62it/s] 61%|██████    | 335/553 [00:02<00:01, 131.82it/s] 63%|██████▎   | 349/553 [00:02<00:01, 131.20it/s] 66%|██████▌   | 363/553 [00:02<00:01, 129.67it/s] 69%|██████▊   | 379/553 [00:02<00:01, 136.34it/s] 71%|███████   | 393/553 [00:02<00:01, 125.66it/s] 74%|███████▎  | 407/553 [00:03<00:01, 127.66it/s] 76%|███████▌  | 420/553 [00:03<00:01, 124.51it/s] 78%|███████▊  | 433/553 [00:03<00:00, 121.89it/s] 82%|████████▏ | 451/553 [00:03<00:00, 136.81it/s] 84%|████████▍ | 466/553 [00:03<00:00, 140.20it/s] 87%|████████▋ | 481/553 [00:03<00:00, 136.74it/s] 90%|████████▉ | 495/553 [00:03<00:00, 127.69it/s] 92%|█████████▏| 511/553 [00:03<00:00, 134.58it/s] 95%|█████████▍| 525/553 [00:03<00:00, 121.87it/s] 97%|█████████▋| 538/553 [00:04<00:00, 116.85it/s]100%|█████████▉| 551/553 [00:04<00:00, 103.49it/s]100%|██████████| 553/553 [00:04<00:00, 131.01it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 31/139 [00:00<00:00, 306.59it/s]extract the null data:  65%|██████▍   | 90/139 [00:00<00:00, 471.58it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 484.00it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 206.79it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 203.58it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 193.94it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 192.50it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 194.03it/s]replace nan value:  90%|████████▉ | 125/139 [00:00<00:00, 199.19it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 198.78it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 129.15it/s] 22%|██▏       | 30/139 [00:00<00:00, 140.11it/s] 35%|███▍      | 48/139 [00:00<00:00, 151.13it/s] 46%|████▌     | 64/139 [00:00<00:00, 144.60it/s] 57%|█████▋    | 79/139 [00:00<00:00, 138.95it/s] 67%|██████▋   | 93/139 [00:00<00:00, 126.95it/s] 77%|███████▋  | 107/139 [00:00<00:00, 129.10it/s] 89%|████████▉ | 124/139 [00:00<00:00, 138.78it/s]100%|██████████| 139/139 [00:01<00:00, 139.88it/s]100%|██████████| 139/139 [00:01<00:00, 138.02it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 209.74it/s]extract the null data:  42%|████▏     | 73/173 [00:00<00:00, 389.37it/s]extract the null data:  76%|███████▋  | 132/173 [00:00<00:00, 478.03it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 467.74it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 236.73it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 215.54it/s]replace nan value:  40%|████      | 70/173 [00:00<00:00, 216.00it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 213.41it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 211.48it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 202.20it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 200.74it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.42it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.83it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.19it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.05it/s] 35%|███▌      | 61/173 [00:00<00:00, 144.72it/s] 44%|████▍     | 76/173 [00:00<00:00, 145.12it/s] 53%|█████▎    | 92/173 [00:00<00:00, 145.67it/s] 62%|██████▏   | 108/173 [00:00<00:00, 147.22it/s] 71%|███████   | 123/173 [00:00<00:00, 141.55it/s] 80%|███████▉  | 138/173 [00:00<00:00, 142.83it/s] 88%|████████▊ | 153/173 [00:01<00:00, 136.16it/s] 97%|█████████▋| 167/173 [00:01<00:00, 108.68it/s]100%|██████████| 173/173 [00:01<00:00, 125.90it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.095, valid loss : 0.090, train acc : 0.762, valid acc : 0.729, train f1 : 0.551, valid f1 : 0.555
training process:   1%|          | 1/128 [01:08<2:25:14, 68.62s/it]Best score increase :0.000 -> 0.555
training process:   2%|▏         | 2/128 [02:05<2:09:58, 61.90s/it]Best score increase :0.555 -> 0.610
training process:   2%|▏         | 3/128 [03:01<2:03:21, 59.21s/it]Best score increase :0.610 -> 0.655
training process:   3%|▎         | 4/128 [03:59<2:00:51, 58.48s/it]Best score increase :0.655 -> 0.666
epoch : 5, train loss : 0.063, valid loss : 0.065, train acc : 0.836, valid acc : 0.910, train f1 : 0.665, valid f1 : 0.754
training process:   4%|▍         | 5/128 [05:04<2:05:02, 60.99s/it]Best score increase :0.666 -> 0.754
training process:   5%|▍         | 6/128 [06:03<2:02:12, 60.10s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [07:00<1:59:10, 59.09s/it]Best score increase :0.754 -> 0.757
training process:   6%|▋         | 8/128 [07:51<1:53:30, 56.75s/it]Best score increase :0.757 -> 0.786
epoch : 9, train loss : 0.055, valid loss : 0.056, train acc : 0.906, valid acc : 0.901, train f1 : 0.754, valid f1 : 0.753
training process:   7%|▋         | 9/128 [08:55<1:56:44, 58.86s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:50<1:53:47, 57.86s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [10:46<1:51:44, 57.31s/it]Best score increase :0.786 -> 0.807
training process:   9%|▉         | 12/128 [11:44<1:51:01, 57.43s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.052, valid loss : 0.055, train acc : 0.918, valid acc : 0.933, train f1 : 0.776, valid f1 : 0.803
training process:  10%|█         | 13/128 [12:52<1:56:19, 60.69s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [14:02<2:00:10, 63.25s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [14:53<1:52:23, 59.68s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [15:47<1:48:26, 58.10s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.049, valid loss : 0.056, train acc : 0.923, valid acc : 0.945, train f1 : 0.787, valid f1 : 0.826
training process:  13%|█▎        | 17/128 [16:51<1:50:30, 59.74s/it]Best score increase :0.807 -> 0.826
training process:  14%|█▍        | 18/128 [17:39<1:42:52, 56.12s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [18:26<1:37:05, 53.44s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [19:16<1:34:14, 52.36s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.047, valid loss : 0.050, train acc : 0.922, valid acc : 0.936, train f1 : 0.788, valid f1 : 0.816
training process:  16%|█▋        | 21/128 [20:13<1:36:00, 53.84s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [21:09<1:36:08, 54.42s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [22:04<1:35:46, 54.73s/it]Best score increase :0.826 -> 0.834
training process:  19%|█▉        | 24/128 [23:03<1:36:55, 55.92s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.045, valid loss : 0.050, train acc : 0.927, valid acc : 0.942, train f1 : 0.798, valid f1 : 0.828
training process:  20%|█▉        | 25/128 [24:09<1:41:10, 58.94s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [25:09<1:40:41, 59.23s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [26:07<1:39:17, 58.99s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [27:06<1:38:01, 58.81s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.044, valid loss : 0.047, train acc : 0.930, valid acc : 0.941, train f1 : 0.805, valid f1 : 0.827
training process:  23%|██▎       | 29/128 [28:14<1:41:44, 61.67s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [29:12<1:39:05, 60.67s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [30:05<1:34:10, 58.25s/it]EarlyStopping counter : 8 out of 12
training process:  25%|██▌       | 32/128 [30:54<1:28:55, 55.58s/it]EarlyStopping counter : 9 out of 12
epoch : 33, train loss : 0.045, valid loss : 0.047, train acc : 0.931, valid acc : 0.947, train f1 : 0.805, valid f1 : 0.841
training process:  26%|██▌       | 33/128 [31:52<1:29:03, 56.25s/it]Best score increase :0.834 -> 0.841
training process:  27%|██▋       | 34/128 [32:47<1:27:35, 55.91s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [33:36<1:23:13, 53.69s/it]Best score increase :0.841 -> 0.849
training process:  28%|██▊       | 36/128 [34:24<1:20:05, 52.23s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.043, valid loss : 0.052, train acc : 0.931, valid acc : 0.952, train f1 : 0.807, valid f1 : 0.844
training process:  29%|██▉       | 37/128 [35:27<1:23:43, 55.20s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [36:22<1:22:49, 55.22s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [37:19<1:22:37, 55.70s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [38:17<1:22:45, 56.43s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.043, valid loss : 0.049, train acc : 0.935, valid acc : 0.954, train f1 : 0.817, valid f1 : 0.854
training process:  32%|███▏      | 41/128 [39:25<1:26:47, 59.85s/it]Best score increase :0.849 -> 0.854
training process:  33%|███▎      | 42/128 [40:22<1:24:50, 59.19s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [41:21<1:23:52, 59.21s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [42:19<1:22:14, 58.74s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.042, valid loss : 0.045, train acc : 0.937, valid acc : 0.947, train f1 : 0.822, valid f1 : 0.844
training process:  35%|███▌      | 45/128 [43:27<1:24:51, 61.35s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [44:18<1:19:47, 58.39s/it]EarlyStopping counter : 5 out of 12
training process:  37%|███▋      | 47/128 [45:05<1:14:18, 55.05s/it]EarlyStopping counter : 6 out of 12
training process:  38%|███▊      | 48/128 [45:53<1:10:22, 52.78s/it]EarlyStopping counter : 7 out of 12
epoch : 49, train loss : 0.042, valid loss : 0.044, train acc : 0.940, valid acc : 0.947, train f1 : 0.825, valid f1 : 0.844
training process:  38%|███▊      | 49/128 [46:49<1:10:41, 53.68s/it]EarlyStopping counter : 8 out of 12
training process:  39%|███▉      | 50/128 [47:41<1:09:23, 53.38s/it]EarlyStopping counter : 9 out of 12
training process:  40%|███▉      | 51/128 [48:36<1:08:52, 53.67s/it]EarlyStopping counter : 10 out of 12
training process:  41%|████      | 52/128 [49:33<1:09:15, 54.67s/it]EarlyStopping counter : 11 out of 12
epoch : 53, train loss : 0.041, valid loss : 0.047, train acc : 0.936, valid acc : 0.954, train f1 : 0.820, valid f1 : 0.856
training process:  41%|████▏     | 53/128 [50:38<1:12:20, 57.88s/it]Best score increase :0.854 -> 0.856
training process:  42%|████▏     | 54/128 [51:36<1:11:24, 57.89s/it]Best score increase :0.856 -> 0.858
training process:  43%|████▎     | 55/128 [52:34<1:10:21, 57.83s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [53:30<1:08:58, 57.48s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.040, valid loss : 0.043, train acc : 0.941, valid acc : 0.949, train f1 : 0.830, valid f1 : 0.849
training process:  45%|████▍     | 57/128 [54:36<1:11:05, 60.08s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [55:34<1:09:16, 59.37s/it]EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [56:25<1:05:21, 56.83s/it]EarlyStopping counter : 5 out of 12
training process:  47%|████▋     | 60/128 [57:16<1:02:21, 55.02s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.039, valid loss : 0.045, train acc : 0.939, valid acc : 0.954, train f1 : 0.826, valid f1 : 0.858
training process:  48%|████▊     | 61/128 [58:13<1:02:13, 55.73s/it]EarlyStopping counter : 7 out of 12
training process:  48%|████▊     | 62/128 [59:02<59:10, 53.79s/it]  EarlyStopping counter : 8 out of 12
training process:  49%|████▉     | 63/128 [59:53<57:15, 52.85s/it]EarlyStopping counter : 9 out of 12
training process:  50%|█████     | 64/128 [1:00:46<56:17, 52.77s/it]EarlyStopping counter : 10 out of 12
epoch : 65, train loss : 0.040, valid loss : 0.045, train acc : 0.942, valid acc : 0.955, train f1 : 0.830, valid f1 : 0.861
training process:  51%|█████     | 65/128 [1:01:44<57:17, 54.56s/it]Best score increase :0.858 -> 0.861
training process:  52%|█████▏    | 66/128 [1:02:41<56:57, 55.13s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 67/128 [1:03:41<57:34, 56.63s/it]EarlyStopping counter : 2 out of 12
training process:  53%|█████▎    | 68/128 [1:04:39<57:07, 57.13s/it]EarlyStopping counter : 3 out of 12
epoch : 69, train loss : 0.039, valid loss : 0.044, train acc : 0.946, valid acc : 0.954, train f1 : 0.840, valid f1 : 0.860
training process:  54%|█████▍    | 69/128 [1:05:49<59:47, 60.81s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▍    | 70/128 [1:06:54<1:00:02, 62.12s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▌    | 71/128 [1:07:53<58:07, 61.18s/it]  EarlyStopping counter : 6 out of 12
training process:  56%|█████▋    | 72/128 [1:08:50<56:01, 60.02s/it]Best score increase :0.861 -> 0.862
epoch : 73, train loss : 0.040, valid loss : 0.044, train acc : 0.943, valid acc : 0.954, train f1 : 0.833, valid f1 : 0.861
training process:  57%|█████▋    | 73/128 [1:10:01<57:51, 63.11s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:10:55<54:27, 60.52s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:11:46<50:54, 57.63s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▉    | 76/128 [1:12:39<48:47, 56.29s/it]EarlyStopping counter : 4 out of 12
epoch : 77, train loss : 0.039, valid loss : 0.043, train acc : 0.944, valid acc : 0.953, train f1 : 0.835, valid f1 : 0.858
training process:  60%|██████    | 77/128 [1:13:41<49:23, 58.10s/it]EarlyStopping counter : 5 out of 12
training process:  61%|██████    | 78/128 [1:14:35<47:11, 56.63s/it]EarlyStopping counter : 6 out of 12
training process:  62%|██████▏   | 79/128 [1:15:27<45:10, 55.31s/it]Best score increase :0.862 -> 0.866
training process:  62%|██████▎   | 80/128 [1:16:18<43:15, 54.06s/it]EarlyStopping counter : 1 out of 12
epoch : 81, train loss : 0.039, valid loss : 0.041, train acc : 0.945, valid acc : 0.951, train f1 : 0.837, valid f1 : 0.856
training process:  63%|██████▎   | 81/128 [1:17:17<43:35, 55.65s/it]EarlyStopping counter : 2 out of 12
training process:  64%|██████▍   | 82/128 [1:18:14<42:54, 55.97s/it]EarlyStopping counter : 3 out of 12
training process:  65%|██████▍   | 83/128 [1:19:07<41:22, 55.18s/it]EarlyStopping counter : 4 out of 12
training process:  66%|██████▌   | 84/128 [1:20:00<39:54, 54.42s/it]EarlyStopping counter : 5 out of 12
epoch : 85, train loss : 0.038, valid loss : 0.046, train acc : 0.944, valid acc : 0.957, train f1 : 0.837, valid f1 : 0.865
training process:  66%|██████▋   | 85/128 [1:21:01<40:30, 56.52s/it]EarlyStopping counter : 6 out of 12
training process:  67%|██████▋   | 86/128 [1:21:53<38:32, 55.05s/it]EarlyStopping counter : 7 out of 12
training process:  68%|██████▊   | 87/128 [1:22:47<37:20, 54.64s/it]EarlyStopping counter : 8 out of 12
training process:  69%|██████▉   | 88/128 [1:23:44<36:56, 55.42s/it]EarlyStopping counter : 9 out of 12
epoch : 89, train loss : 0.039, valid loss : 0.043, train acc : 0.943, valid acc : 0.951, train f1 : 0.836, valid f1 : 0.852
training process:  70%|██████▉   | 89/128 [1:24:49<37:51, 58.26s/it]EarlyStopping counter : 10 out of 12
training process:  70%|███████   | 90/128 [1:25:59<39:08, 61.81s/it]EarlyStopping counter : 11 out of 12
training process:  70%|███████   | 90/128 [1:27:07<36:47, 58.08s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 90, best f1 score : 0.867
training process finished, best loss : 0.045 and best acc : 0.957, best f1 : 0.867, best epoch : 83

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.66      0.79      0.72       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.88      0.85      7398
weighted avg       0.96      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.88, test loss : 2.970

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.16s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.26s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:14,  8.23s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:06,  8.28s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:57,  8.20s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:49,  8.22s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:41,  8.27s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:33,  8.31s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:14<00:25,  8.37s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:22<00:16,  8.37s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:32<00:08,  8.57s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.52s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.37s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  2%|▏         | 7/306 [00:00<00:04, 68.37it/s]  8%|▊         | 24/306 [00:00<00:02, 122.92it/s] 12%|█▏        | 37/306 [00:00<00:02, 113.22it/s] 17%|█▋        | 51/306 [00:00<00:02, 122.00it/s] 23%|██▎       | 70/306 [00:00<00:01, 144.42it/s] 28%|██▊       | 85/306 [00:00<00:01, 124.63it/s] 32%|███▏      | 98/306 [00:00<00:01, 125.75it/s] 37%|███▋      | 113/306 [00:00<00:01, 129.21it/s] 42%|████▏     | 127/306 [00:01<00:01, 120.83it/s] 46%|████▌     | 140/306 [00:01<00:01, 123.15it/s] 52%|█████▏    | 158/306 [00:01<00:01, 137.94it/s] 57%|█████▋    | 173/306 [00:01<00:01, 127.46it/s] 61%|██████    | 187/306 [00:01<00:00, 129.91it/s] 66%|██████▌   | 201/306 [00:01<00:00, 130.78it/s] 70%|███████   | 215/306 [00:01<00:00, 129.00it/s] 75%|███████▍  | 229/306 [00:01<00:00, 131.69it/s] 79%|███████▉  | 243/306 [00:01<00:00, 116.97it/s] 84%|████████▍ | 258/306 [00:02<00:00, 123.72it/s] 89%|████████▉ | 273/306 [00:02<00:00, 129.23it/s] 94%|█████████▍| 287/306 [00:02<00:00, 122.58it/s] 98%|█████████▊| 300/306 [00:02<00:00, 124.01it/s]100%|██████████| 306/306 [00:02<00:00, 126.98it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 61/553 [00:00<00:00, 608.48it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:00, 619.47it/s]extract the null data:  34%|███▎      | 186/553 [00:00<00:00, 607.18it/s]extract the null data:  45%|████▌     | 249/553 [00:00<00:00, 612.10it/s]extract the null data:  56%|█████▋    | 312/553 [00:00<00:00, 618.18it/s]extract the null data:  68%|██████▊   | 376/553 [00:00<00:00, 622.29it/s]extract the null data:  79%|███████▉  | 439/553 [00:00<00:00, 624.02it/s]extract the null data:  91%|█████████ | 503/553 [00:00<00:00, 626.53it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 619.93it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 197.76it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 204.44it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 206.26it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 206.85it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 208.48it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 209.91it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:01, 211.34it/s]replace nan value:  31%|███       | 172/553 [00:00<00:01, 215.69it/s]replace nan value:  35%|███▌      | 194/553 [00:00<00:01, 214.84it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:01, 213.13it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 214.24it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 212.44it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 213.37it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 212.13it/s]replace nan value:  59%|█████▉    | 326/553 [00:01<00:01, 210.21it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:00, 210.31it/s]replace nan value:  67%|██████▋   | 370/553 [00:01<00:00, 209.82it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 211.34it/s]replace nan value:  75%|███████▍  | 414/553 [00:01<00:00, 212.54it/s]replace nan value:  79%|███████▉  | 436/553 [00:02<00:00, 210.47it/s]replace nan value:  83%|████████▎ | 459/553 [00:02<00:00, 213.39it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 215.05it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 211.00it/s]replace nan value:  95%|█████████▍| 525/553 [00:02<00:00, 211.00it/s]replace nan value:  99%|█████████▉| 547/553 [00:02<00:00, 211.98it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 211.17it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.27it/s]  6%|▌         | 31/553 [00:00<00:03, 150.36it/s]  8%|▊         | 47/553 [00:00<00:04, 125.45it/s] 11%|█         | 60/553 [00:00<00:04, 120.27it/s] 14%|█▎        | 75/553 [00:00<00:03, 128.89it/s] 16%|█▋        | 90/553 [00:00<00:03, 134.86it/s] 19%|█▉        | 104/553 [00:00<00:03, 132.32it/s] 22%|██▏       | 121/553 [00:00<00:03, 142.69it/s] 25%|██▍       | 136/553 [00:00<00:02, 143.17it/s] 27%|██▋       | 152/553 [00:01<00:03, 132.72it/s] 31%|███       | 170/553 [00:01<00:02, 144.95it/s] 33%|███▎      | 185/553 [00:01<00:02, 143.49it/s] 37%|███▋      | 204/553 [00:01<00:02, 155.81it/s] 40%|███▉      | 220/553 [00:01<00:02, 151.01it/s] 43%|████▎     | 236/553 [00:01<00:02, 153.29it/s] 46%|████▌     | 252/553 [00:01<00:01, 150.66it/s] 48%|████▊     | 268/553 [00:01<00:01, 148.96it/s] 51%|█████     | 283/553 [00:01<00:01, 143.15it/s] 54%|█████▍    | 298/553 [00:02<00:01, 141.25it/s] 57%|█████▋    | 313/553 [00:02<00:01, 137.93it/s] 59%|█████▉    | 327/553 [00:02<00:01, 136.21it/s] 62%|██████▏   | 342/553 [00:02<00:01, 139.97it/s] 65%|██████▍   | 357/553 [00:02<00:01, 133.07it/s] 68%|██████▊   | 374/553 [00:02<00:01, 141.11it/s] 70%|███████   | 389/553 [00:02<00:01, 129.14it/s] 73%|███████▎  | 403/553 [00:02<00:01, 125.08it/s] 75%|███████▌  | 416/553 [00:03<00:01, 125.52it/s] 78%|███████▊  | 429/553 [00:03<00:01, 121.70it/s] 81%|████████  | 448/553 [00:03<00:00, 138.54it/s] 84%|████████▍ | 464/553 [00:03<00:00, 141.77it/s] 87%|████████▋ | 479/553 [00:03<00:00, 140.25it/s] 89%|████████▉ | 494/553 [00:03<00:00, 133.88it/s] 92%|█████████▏| 509/553 [00:03<00:00, 137.52it/s] 95%|█████████▍| 523/553 [00:03<00:00, 129.49it/s] 97%|█████████▋| 537/553 [00:03<00:00, 119.11it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.99it/s]100%|██████████| 553/553 [00:04<00:00, 134.24it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 299.71it/s]extract the null data:  72%|███████▏  | 100/139 [00:00<00:00, 530.76it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 539.92it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 233.04it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 230.74it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 232.03it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 231.59it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 227.18it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 227.25it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 126.16it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.34it/s] 31%|███       | 43/139 [00:00<00:00, 141.84it/s] 42%|████▏     | 58/139 [00:00<00:00, 125.51it/s] 53%|█████▎    | 74/139 [00:00<00:00, 134.20it/s] 63%|██████▎   | 88/139 [00:00<00:00, 122.32it/s] 76%|███████▌  | 105/139 [00:00<00:00, 131.77it/s] 88%|████████▊ | 122/139 [00:00<00:00, 140.61it/s] 99%|█████████▊| 137/139 [00:01<00:00, 141.83it/s]100%|██████████| 139/139 [00:01<00:00, 135.85it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 33/173 [00:00<00:00, 327.80it/s]extract the null data:  58%|█████▊    | 101/173 [00:00<00:00, 532.17it/s]extract the null data:  99%|█████████▉| 172/173 [00:00<00:00, 611.30it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 569.81it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 224.50it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 230.16it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 230.91it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 231.38it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 234.86it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 233.51it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 232.19it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 231.59it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.47it/s] 16%|█▌        | 28/173 [00:00<00:01, 121.84it/s] 25%|██▍       | 43/173 [00:00<00:00, 132.59it/s] 34%|███▍      | 59/173 [00:00<00:00, 141.18it/s] 43%|████▎     | 74/173 [00:00<00:00, 139.66it/s] 51%|█████▏    | 89/173 [00:00<00:00, 138.01it/s] 60%|█████▉    | 103/173 [00:00<00:00, 135.93it/s] 68%|██████▊   | 118/173 [00:00<00:00, 137.87it/s] 76%|███████▋  | 132/173 [00:00<00:00, 134.48it/s] 84%|████████▍ | 146/173 [00:01<00:00, 132.28it/s] 92%|█████████▏| 160/173 [00:01<00:00, 120.21it/s]100%|██████████| 173/173 [00:01<00:00, 92.05it/s] 100%|██████████| 173/173 [00:01<00:00, 119.40it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.224, valid loss : 0.125, train acc : 0.510, valid acc : 0.097, train f1 : 0.414, valid f1 : 0.093
training process:   1%|          | 1/128 [01:25<3:00:25, 85.24s/it]Best score increase :0.000 -> 0.093
training process:   2%|▏         | 2/128 [02:32<2:37:03, 74.79s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:42<2:31:16, 72.62s/it]Best score increase :0.093 -> 0.156
training process:   3%|▎         | 4/128 [04:51<2:27:02, 71.15s/it]Best score increase :0.156 -> 0.279
epoch : 5, train loss : 0.111, valid loss : 0.122, train acc : 0.624, valid acc : 0.321, train f1 : 0.565, valid f1 : 0.304
training process:   4%|▍         | 5/128 [06:08<2:30:18, 73.32s/it]Best score increase :0.279 -> 0.304
training process:   5%|▍         | 6/128 [07:21<2:28:25, 73.00s/it]Best score increase :0.304 -> 0.368
training process:   5%|▌         | 7/128 [08:47<2:35:55, 77.32s/it]Best score increase :0.368 -> 0.407
training process:   6%|▋         | 8/128 [10:21<2:45:02, 82.52s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.087, valid loss : 0.096, train acc : 0.717, valid acc : 0.494, train f1 : 0.694, valid f1 : 0.432
training process:   7%|▋         | 9/128 [11:58<2:52:53, 87.17s/it]Best score increase :0.407 -> 0.432
training process:   8%|▊         | 10/128 [13:25<2:51:32, 87.23s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [14:54<2:51:12, 87.80s/it]Best score increase :0.432 -> 0.474
training process:   9%|▉         | 12/128 [16:25<2:51:06, 88.50s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.076, valid loss : 0.079, train acc : 0.756, valid acc : 0.604, train f1 : 0.741, valid f1 : 0.508
training process:  10%|█         | 13/128 [18:05<2:56:51, 92.28s/it]Best score increase :0.474 -> 0.508
training process:  11%|█         | 14/128 [19:24<2:47:19, 88.07s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [20:24<2:30:17, 79.80s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [21:25<2:17:51, 73.85s/it]Best score increase :0.508 -> 0.510
epoch : 17, train loss : 0.070, valid loss : 0.084, train acc : 0.781, valid acc : 0.596, train f1 : 0.770, valid f1 : 0.503
training process:  13%|█▎        | 17/128 [22:34<2:14:09, 72.52s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [23:34<2:06:13, 68.85s/it]Best score increase :0.510 -> 0.518
training process:  15%|█▍        | 19/128 [24:33<1:59:50, 65.97s/it]Best score increase :0.518 -> 0.553
training process:  16%|█▌        | 20/128 [25:36<1:56:38, 64.80s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.066, valid loss : 0.068, train acc : 0.800, valid acc : 0.699, train f1 : 0.793, valid f1 : 0.576
training process:  16%|█▋        | 21/128 [26:49<1:59:55, 67.25s/it]Best score increase :0.553 -> 0.576
training process:  17%|█▋        | 22/128 [27:50<1:55:49, 65.56s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [28:51<1:52:21, 64.21s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [29:52<1:49:44, 63.31s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.060, valid loss : 0.071, train acc : 0.822, valid acc : 0.687, train f1 : 0.817, valid f1 : 0.568
training process:  20%|█▉        | 25/128 [31:06<1:53:46, 66.28s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [32:10<1:51:48, 65.77s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [33:11<1:48:06, 64.23s/it]Best score increase :0.576 -> 0.604
training process:  22%|██▏       | 28/128 [34:12<1:45:35, 63.35s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.058, valid loss : 0.080, train acc : 0.830, valid acc : 0.654, train f1 : 0.826, valid f1 : 0.544
training process:  23%|██▎       | 29/128 [35:24<1:48:33, 65.79s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [36:26<1:45:34, 64.63s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [37:25<1:41:51, 63.01s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [38:26<1:40:04, 62.54s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.055, valid loss : 0.071, train acc : 0.840, valid acc : 0.699, train f1 : 0.837, valid f1 : 0.577
training process:  26%|██▌       | 33/128 [39:39<1:43:47, 65.55s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [40:39<1:40:01, 63.85s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [41:41<1:38:07, 63.31s/it]EarlyStopping counter : 8 out of 12
training process:  28%|██▊       | 36/128 [42:47<1:38:15, 64.08s/it]EarlyStopping counter : 9 out of 12
epoch : 37, train loss : 0.053, valid loss : 0.064, train acc : 0.852, valid acc : 0.739, train f1 : 0.848, valid f1 : 0.608
training process:  29%|██▉       | 37/128 [44:07<1:44:24, 68.84s/it]Best score increase :0.604 -> 0.608
training process:  30%|██▉       | 38/128 [45:17<1:43:50, 69.23s/it]Best score increase :0.608 -> 0.649
training process:  30%|███       | 39/128 [46:18<1:39:16, 66.93s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [47:18<1:35:11, 64.91s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.053, valid loss : 0.069, train acc : 0.854, valid acc : 0.715, train f1 : 0.851, valid f1 : 0.589
training process:  32%|███▏      | 41/128 [48:24<1:34:33, 65.21s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [49:21<1:29:35, 62.51s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [50:19<1:27:01, 61.43s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [51:21<1:26:00, 61.43s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.049, valid loss : 0.071, train acc : 0.866, valid acc : 0.716, train f1 : 0.864, valid f1 : 0.591
training process:  35%|███▌      | 45/128 [52:39<1:31:50, 66.40s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [53:57<1:35:22, 69.78s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [55:16<1:38:08, 72.70s/it]EarlyStopping counter : 9 out of 12
training process:  38%|███▊      | 48/128 [56:32<1:38:11, 73.64s/it]EarlyStopping counter : 10 out of 12
epoch : 49, train loss : 0.048, valid loss : 0.058, train acc : 0.866, valid acc : 0.799, train f1 : 0.864, valid f1 : 0.656
training process:  38%|███▊      | 49/128 [57:56<1:41:07, 76.81s/it]Best score increase :0.649 -> 0.656
training process:  39%|███▉      | 50/128 [58:58<1:34:10, 72.44s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [1:00:07<1:31:28, 71.28s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [1:01:03<1:24:35, 66.78s/it]Best score increase :0.656 -> 0.662
epoch : 53, train loss : 0.049, valid loss : 0.056, train acc : 0.869, valid acc : 0.803, train f1 : 0.867, valid f1 : 0.662
training process:  41%|████▏     | 53/128 [1:02:08<1:22:37, 66.10s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [1:03:03<1:17:41, 62.99s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [1:03:55<1:12:35, 59.66s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [1:04:49<1:09:18, 57.75s/it]Best score increase :0.662 -> 0.682
epoch : 57, train loss : 0.047, valid loss : 0.059, train acc : 0.875, valid acc : 0.808, train f1 : 0.874, valid f1 : 0.665
training process:  45%|████▍     | 57/128 [1:05:50<1:09:43, 58.93s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [1:06:46<1:07:43, 58.06s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 59/128 [1:07:44<1:06:39, 57.97s/it]EarlyStopping counter : 3 out of 12
training process:  47%|████▋     | 60/128 [1:08:43<1:06:05, 58.31s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.045, valid loss : 0.056, train acc : 0.880, valid acc : 0.822, train f1 : 0.879, valid f1 : 0.679
training process:  48%|████▊     | 61/128 [1:09:50<1:07:58, 60.87s/it]EarlyStopping counter : 5 out of 12
training process:  48%|████▊     | 62/128 [1:10:48<1:06:07, 60.12s/it]EarlyStopping counter : 6 out of 12
training process:  49%|████▉     | 63/128 [1:11:47<1:04:36, 59.64s/it]EarlyStopping counter : 7 out of 12
training process:  50%|█████     | 64/128 [1:12:45<1:03:01, 59.08s/it]Best score increase :0.682 -> 0.686
epoch : 65, train loss : 0.045, valid loss : 0.058, train acc : 0.885, valid acc : 0.825, train f1 : 0.884, valid f1 : 0.682
training process:  51%|█████     | 65/128 [1:13:52<1:04:43, 61.64s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:14:51<1:02:45, 60.74s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:15:50<1:01:13, 60.22s/it]Best score increase :0.686 -> 0.700
training process:  53%|█████▎    | 68/128 [1:16:49<59:47, 59.80s/it]  EarlyStopping counter : 1 out of 12
epoch : 69, train loss : 0.044, valid loss : 0.055, train acc : 0.887, valid acc : 0.843, train f1 : 0.886, valid f1 : 0.701
training process:  54%|█████▍    | 69/128 [1:17:56<1:00:56, 61.98s/it]EarlyStopping counter : 2 out of 12
training process:  55%|█████▍    | 70/128 [1:18:55<59:13, 61.26s/it]  EarlyStopping counter : 3 out of 12
training process:  55%|█████▌    | 71/128 [1:19:54<57:25, 60.44s/it]Best score increase :0.700 -> 0.714
training process:  56%|█████▋    | 72/128 [1:20:53<55:58, 59.97s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.044, valid loss : 0.063, train acc : 0.886, valid acc : 0.803, train f1 : 0.885, valid f1 : 0.662
training process:  57%|█████▋    | 73/128 [1:22:01<57:10, 62.37s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:23:00<55:17, 61.44s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▊    | 75/128 [1:23:57<53:01, 60.03s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▉    | 76/128 [1:24:53<50:57, 58.79s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.043, valid loss : 0.059, train acc : 0.892, valid acc : 0.834, train f1 : 0.891, valid f1 : 0.691
training process:  60%|██████    | 77/128 [1:25:55<50:54, 59.90s/it]EarlyStopping counter : 6 out of 12
training process:  61%|██████    | 78/128 [1:26:49<48:28, 58.16s/it]Best score increase :0.714 -> 0.720
training process:  62%|██████▏   | 79/128 [1:27:44<46:42, 57.18s/it]EarlyStopping counter : 1 out of 12
training process:  62%|██████▎   | 80/128 [1:28:39<45:09, 56.44s/it]EarlyStopping counter : 2 out of 12
epoch : 81, train loss : 0.042, valid loss : 0.058, train acc : 0.889, valid acc : 0.840, train f1 : 0.888, valid f1 : 0.697
training process:  63%|██████▎   | 81/128 [1:29:42<45:47, 58.47s/it]EarlyStopping counter : 3 out of 12
training process:  64%|██████▍   | 82/128 [1:30:37<43:52, 57.23s/it]EarlyStopping counter : 4 out of 12
training process:  65%|██████▍   | 83/128 [1:31:31<42:23, 56.53s/it]EarlyStopping counter : 5 out of 12
training process:  66%|██████▌   | 84/128 [1:32:23<40:24, 55.09s/it]EarlyStopping counter : 6 out of 12
epoch : 85, train loss : 0.040, valid loss : 0.058, train acc : 0.896, valid acc : 0.841, train f1 : 0.895, valid f1 : 0.699
training process:  66%|██████▋   | 85/128 [1:33:27<41:22, 57.74s/it]EarlyStopping counter : 7 out of 12
training process:  67%|██████▋   | 86/128 [1:34:18<38:56, 55.64s/it]EarlyStopping counter : 8 out of 12
training process:  68%|██████▊   | 87/128 [1:35:12<37:45, 55.24s/it]EarlyStopping counter : 9 out of 12
training process:  69%|██████▉   | 88/128 [1:36:06<36:30, 54.77s/it]EarlyStopping counter : 10 out of 12
epoch : 89, train loss : 0.040, valid loss : 0.061, train acc : 0.899, valid acc : 0.814, train f1 : 0.898, valid f1 : 0.671
training process:  70%|██████▉   | 89/128 [1:37:08<37:03, 57.02s/it]EarlyStopping counter : 11 out of 12
training process:  70%|██████▉   | 89/128 [1:38:01<42:57, 66.08s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 89, best f1 score : 0.720
training process finished, best loss : 0.058 and best acc : 0.861, best f1 : 0.720, best epoch : 77

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.33      0.88      0.48       580
           1       0.99      0.85      0.91      6818

    accuracy                           0.85      7398
   macro avg       0.66      0.86      0.70      7398
weighted avg       0.94      0.85      0.88      7398


# test acc : 0.85, test f1 : 0.70, test AUC : 0.86, test loss : 3.560

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.12s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:15,  7.60s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.52s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<00:59,  7.41s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:51,  7.43s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.52s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.53s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:31,  7.89s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.87s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.75s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.69s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.62s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.64s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 174.80it/s] 18%|█▊        | 54/306 [00:00<00:00, 264.62it/s] 26%|██▋       | 81/306 [00:00<00:01, 191.20it/s] 34%|███▍      | 105/306 [00:00<00:00, 205.40it/s] 42%|████▏     | 127/306 [00:00<00:00, 187.64it/s] 50%|████▉     | 152/306 [00:00<00:00, 202.69it/s] 57%|█████▋    | 174/306 [00:00<00:00, 199.44it/s] 68%|██████▊   | 208/306 [00:00<00:00, 238.61it/s] 76%|███████▌  | 233/306 [00:01<00:00, 217.15it/s] 84%|████████▎ | 256/306 [00:01<00:00, 201.02it/s] 93%|█████████▎| 286/306 [00:01<00:00, 225.24it/s]100%|██████████| 306/306 [00:01<00:00, 203.35it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 590.39it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:00, 614.75it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:00, 622.83it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 619.59it/s]extract the null data:  57%|█████▋    | 313/553 [00:00<00:00, 619.49it/s]extract the null data:  68%|██████▊   | 376/553 [00:00<00:00, 622.75it/s]extract the null data:  79%|███████▉  | 439/553 [00:00<00:00, 621.52it/s]extract the null data:  91%|█████████ | 502/553 [00:00<00:00, 613.78it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 616.15it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 208.87it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:02, 213.49it/s]replace nan value:  12%|█▏        | 65/553 [00:00<00:02, 213.96it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 216.37it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 217.45it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:01, 213.43it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:01, 216.01it/s]replace nan value:  32%|███▏      | 178/553 [00:00<00:01, 218.29it/s]replace nan value:  36%|███▌      | 200/553 [00:00<00:01, 217.38it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 216.72it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 217.49it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 219.64it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 222.33it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 220.74it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:00, 220.90it/s]replace nan value:  65%|██████▍   | 359/553 [00:01<00:00, 218.48it/s]replace nan value:  69%|██████▉   | 381/553 [00:01<00:00, 218.34it/s]replace nan value:  73%|███████▎  | 403/553 [00:01<00:00, 217.98it/s]replace nan value:  77%|███████▋  | 425/553 [00:01<00:00, 217.41it/s]replace nan value:  81%|████████  | 448/553 [00:02<00:00, 219.34it/s]replace nan value:  85%|████████▍ | 470/553 [00:02<00:00, 217.92it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 218.67it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 217.92it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 218.91it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 217.78it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 146.56it/s]  6%|▌         | 31/553 [00:00<00:03, 153.70it/s]  8%|▊         | 47/553 [00:00<00:03, 128.09it/s] 11%|█         | 61/553 [00:00<00:03, 124.64it/s] 14%|█▍        | 77/553 [00:00<00:03, 132.15it/s] 16%|█▋        | 91/553 [00:00<00:03, 134.36it/s] 19%|█▉        | 106/553 [00:00<00:03, 138.21it/s] 22%|██▏       | 122/553 [00:00<00:03, 142.47it/s] 25%|██▌       | 140/553 [00:00<00:02, 151.59it/s] 29%|██▉       | 159/553 [00:01<00:02, 162.26it/s] 32%|███▏      | 176/553 [00:01<00:02, 162.26it/s] 35%|███▍      | 193/553 [00:01<00:02, 164.48it/s] 38%|███▊      | 212/553 [00:01<00:01, 170.76it/s] 42%|████▏     | 230/553 [00:01<00:02, 156.41it/s] 44%|████▍     | 246/553 [00:01<00:01, 156.71it/s] 48%|████▊     | 263/553 [00:01<00:01, 158.74it/s] 51%|█████     | 280/553 [00:01<00:01, 148.30it/s] 54%|█████▎    | 296/553 [00:01<00:01, 142.89it/s] 56%|█████▌    | 311/553 [00:02<00:01, 139.66it/s] 59%|█████▉    | 326/553 [00:02<00:01, 140.92it/s] 62%|██████▏   | 341/553 [00:02<00:01, 140.87it/s] 64%|██████▍   | 356/553 [00:02<00:01, 137.09it/s] 67%|██████▋   | 372/553 [00:02<00:01, 143.40it/s] 70%|██████▉   | 387/553 [00:02<00:01, 133.44it/s] 73%|███████▎  | 401/553 [00:02<00:01, 125.11it/s] 75%|███████▌  | 416/553 [00:02<00:01, 129.19it/s] 78%|███████▊  | 430/553 [00:03<00:00, 124.80it/s] 81%|████████  | 449/553 [00:03<00:00, 141.78it/s] 84%|████████▍ | 465/553 [00:03<00:00, 145.29it/s] 87%|████████▋ | 480/553 [00:03<00:00, 141.31it/s] 90%|████████▉ | 495/553 [00:03<00:00, 134.70it/s] 93%|█████████▎| 512/553 [00:03<00:00, 141.52it/s] 95%|█████████▌| 527/553 [00:03<00:00, 126.33it/s] 98%|█████████▊| 541/553 [00:03<00:00, 128.76it/s]100%|██████████| 553/553 [00:03<00:00, 138.99it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 366.79it/s]extract the null data:  76%|███████▌  | 105/139 [00:00<00:00, 549.48it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 549.54it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 221.32it/s]replace nan value:  34%|███▍      | 47/139 [00:00<00:00, 227.41it/s]replace nan value:  51%|█████     | 71/139 [00:00<00:00, 228.74it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 231.10it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 233.99it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 232.65it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 130.63it/s] 21%|██        | 29/139 [00:00<00:00, 138.46it/s] 33%|███▎      | 46/139 [00:00<00:00, 146.10it/s] 44%|████▍     | 61/139 [00:00<00:00, 132.38it/s] 55%|█████▍    | 76/139 [00:00<00:00, 135.57it/s] 65%|██████▍   | 90/139 [00:00<00:00, 124.60it/s] 76%|███████▋  | 106/139 [00:00<00:00, 132.68it/s] 89%|████████▉ | 124/139 [00:00<00:00, 144.06it/s]100%|██████████| 139/139 [00:00<00:00, 139.45it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 299.26it/s]extract the null data:  58%|█████▊    | 101/173 [00:00<00:00, 539.30it/s]extract the null data:  98%|█████████▊| 170/173 [00:00<00:00, 605.14it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 564.25it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 233.10it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 230.35it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 228.89it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 208.66it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 213.87it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 208.26it/s]replace nan value:  95%|█████████▌| 165/173 [00:00<00:00, 219.85it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 218.80it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 148.32it/s] 17%|█▋        | 30/173 [00:00<00:01, 133.02it/s] 27%|██▋       | 47/173 [00:00<00:00, 148.08it/s] 37%|███▋      | 64/173 [00:00<00:00, 152.37it/s] 46%|████▌     | 80/173 [00:00<00:00, 148.70it/s] 55%|█████▌    | 96/173 [00:00<00:00, 149.59it/s] 65%|██████▌   | 113/173 [00:00<00:00, 153.46it/s] 75%|███████▍  | 129/173 [00:00<00:00, 146.80it/s] 83%|████████▎ | 144/173 [00:00<00:00, 143.73it/s] 92%|█████████▏| 159/173 [00:01<00:00, 133.49it/s]100%|██████████| 173/173 [00:01<00:00, 101.74it/s]100%|██████████| 173/173 [00:01<00:00, 129.66it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.459, valid loss : 0.387, train f1 : 0.516, valid f1 : 0.500
training process - Deferred Re-weighting:   1%|          | 1/128 [01:33<3:18:20, 93.70s/it]Best score increase :0.000 -> 0.500
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:48<2:53:46, 82.75s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [04:07<2:48:16, 80.77s/it]Best score increase :0.500 -> 0.501
training process - Deferred Re-weighting:   3%|▎         | 4/128 [05:30<2:49:22, 81.96s/it]Best score increase :0.501 -> 0.511
epoch : 5, train loss : 0.264, valid loss : 0.262, train f1 : 0.518, valid f1 : 0.568
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:50<2:46:23, 81.17s/it]Best score increase :0.511 -> 0.568
training process - Deferred Re-weighting:   5%|▍         | 6/128 [08:06<2:41:01, 79.19s/it]Best score increase :0.568 -> 0.603
training process - Deferred Re-weighting:   5%|▌         | 7/128 [09:28<2:42:08, 80.40s/it]Best score increase :0.603 -> 0.650
training process - Deferred Re-weighting:   6%|▋         | 8/128 [10:39<2:34:36, 77.31s/it]Best score increase :0.650 -> 0.673
epoch : 9, train loss : 0.193, valid loss : 0.197, train f1 : 0.728, valid f1 : 0.763
training process - Deferred Re-weighting:   7%|▋         | 9/128 [12:07<2:39:47, 80.57s/it]Best score increase :0.673 -> 0.763
training process - Deferred Re-weighting:   8%|▊         | 10/128 [13:17<2:32:17, 77.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [14:36<2:31:53, 77.90s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [15:51<2:28:44, 76.93s/it]Best score increase :0.763 -> 0.778
epoch : 13, train loss : 0.163, valid loss : 0.174, train f1 : 0.789, valid f1 : 0.788
training process - Deferred Re-weighting:  10%|█         | 13/128 [17:11<2:29:00, 77.74s/it]Best score increase :0.778 -> 0.788
training process - Deferred Re-weighting:  11%|█         | 14/128 [18:08<2:15:45, 71.45s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [19:08<2:08:26, 68.20s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [20:10<2:03:43, 66.29s/it]Best score increase :0.788 -> 0.793
epoch : 17, train loss : 0.149, valid loss : 0.162, train f1 : 0.806, valid f1 : 0.805
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [21:20<2:04:38, 67.37s/it]Best score increase :0.793 -> 0.805
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [22:22<2:00:32, 65.75s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [23:21<1:55:53, 63.80s/it]Best score increase :0.805 -> 0.810
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [24:22<1:53:28, 63.05s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.142, valid loss : 0.154, train f1 : 0.816, valid f1 : 0.815
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [25:31<1:55:38, 64.85s/it]Best score increase :0.810 -> 0.815
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [26:30<1:51:19, 63.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [27:31<1:49:19, 62.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [28:32<1:47:22, 61.95s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.135, valid loss : 0.152, train f1 : 0.829, valid f1 : 0.816
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [29:41<1:49:39, 63.88s/it]Best score increase :0.815 -> 0.816
training process - Deferred Re-weighting:  20%|██        | 26/128 [30:40<1:46:16, 62.51s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [31:40<1:44:02, 61.81s/it]Best score increase :0.816 -> 0.823
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [32:37<1:40:49, 60.49s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.127, valid loss : 0.152, train f1 : 0.842, valid f1 : 0.812
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [33:44<1:42:47, 62.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [34:42<1:39:29, 60.92s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [35:39<1:36:55, 59.95s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [36:34<1:33:25, 58.39s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.123, valid loss : 0.142, train f1 : 0.845, valid f1 : 0.831
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [37:38<1:35:14, 60.15s/it]Best score increase :0.823 -> 0.831
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [38:41<1:35:13, 60.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [39:39<1:33:02, 60.03s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [40:35<1:30:15, 58.86s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.120, valid loss : 0.146, train f1 : 0.852, valid f1 : 0.815
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [41:43<1:33:18, 61.52s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [42:39<1:29:58, 59.99s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [43:29<1:24:36, 57.04s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [44:18<1:19:57, 54.52s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.118, valid loss : 0.150, train f1 : 0.855, valid f1 : 0.819
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [45:17<1:20:50, 55.75s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [46:07<1:17:32, 54.10s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [46:55<1:14:11, 52.37s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [47:44<1:11:56, 51.39s/it]Best score increase :0.831 -> 0.834
epoch : 45, train loss : 0.114, valid loss : 0.149, train f1 : 0.862, valid f1 : 0.831
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [48:41<1:13:24, 53.07s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [49:32<1:11:38, 52.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [50:21<1:09:11, 51.25s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [51:10<1:07:31, 50.64s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.112, valid loss : 0.152, train f1 : 0.861, valid f1 : 0.814
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [52:08<1:09:32, 52.82s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [52:56<1:06:44, 51.34s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [53:45<1:05:00, 50.66s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [54:36<1:04:15, 50.73s/it]EarlyStopping counter : 8 out of 12
epoch : 53, train loss : 0.109, valid loss : 0.141, train f1 : 0.866, valid f1 : 0.816
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [55:33<1:05:53, 52.71s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [56:22<1:03:40, 51.63s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [57:11<1:01:45, 50.76s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [58:00<1:00:14, 50.20s/it]Best score increase :0.834 -> 0.851
epoch : 57, train loss : 0.104, valid loss : 0.136, train f1 : 0.868, valid f1 : 0.840
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [58:57<1:01:49, 52.25s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [59:48<1:00:41, 52.02s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:00:40<59:39, 51.88s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:01:30<58:19, 51.46s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.101, valid loss : 0.154, train f1 : 0.875, valid f1 : 0.815
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:02:28<59:28, 53.27s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:03:18<57:31, 52.30s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:04:07<55:38, 51.36s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:04:55<53:46, 50.41s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.103, valid loss : 0.143, train f1 : 0.874, valid f1 : 0.821
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:05:54<55:42, 53.05s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:06:45<54:11, 52.44s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:07:35<52:28, 51.62s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:08:23<1:02:16, 61.25s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 67, best f1 score : 0.851
training process finished, best loss : 0.138, best acc : 0.956, best f1 : 0.851, best epoch : 55

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.55      0.70      0.62       580
           1       0.97      0.95      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.83      0.79      7398
weighted avg       0.94      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.79, test AUC : 0.83, test loss : 11.020

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.77s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.71s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.62s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.68s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.62s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.69s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.75s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:31,  7.77s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.78s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.79s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.84s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.76s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 24/306 [00:00<00:01, 231.69it/s] 16%|█▌        | 48/306 [00:00<00:01, 169.35it/s] 24%|██▎       | 72/306 [00:00<00:01, 187.07it/s] 30%|███       | 92/306 [00:00<00:01, 169.53it/s] 36%|███▌      | 110/306 [00:00<00:01, 163.06it/s] 42%|████▏     | 128/306 [00:00<00:01, 167.57it/s] 49%|████▊     | 149/306 [00:00<00:00, 175.51it/s] 55%|█████▍    | 167/306 [00:00<00:00, 168.17it/s] 61%|██████    | 187/306 [00:01<00:00, 176.72it/s] 67%|██████▋   | 205/306 [00:01<00:00, 163.65it/s] 74%|███████▎  | 225/306 [00:01<00:00, 171.65it/s] 79%|███████▉  | 243/306 [00:01<00:00, 163.07it/s] 87%|████████▋ | 266/306 [00:01<00:00, 179.50it/s] 93%|█████████▎| 285/306 [00:01<00:00, 167.62it/s]100%|██████████| 306/306 [00:01<00:00, 173.77it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 466.27it/s]extract the null data:  17%|█▋        | 96/553 [00:00<00:00, 477.57it/s]extract the null data:  27%|██▋       | 148/553 [00:00<00:00, 495.09it/s]extract the null data:  36%|███▌      | 200/553 [00:00<00:00, 501.66it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 499.38it/s]extract the null data:  54%|█████▍    | 301/553 [00:00<00:00, 490.07it/s]extract the null data:  63%|██████▎   | 351/553 [00:00<00:00, 485.92it/s]extract the null data:  72%|███████▏  | 400/553 [00:00<00:00, 473.38it/s]extract the null data:  81%|████████  | 448/553 [00:00<00:00, 471.79it/s]extract the null data:  90%|████████▉ | 496/553 [00:01<00:00, 473.41it/s]extract the null data:  99%|█████████▊| 546/553 [00:01<00:00, 479.67it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 482.56it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 173.11it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:03, 171.83it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 170.07it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 168.92it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 168.84it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 169.48it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 170.47it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 170.72it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 173.07it/s]replace nan value:  33%|███▎      | 180/553 [00:01<00:02, 175.41it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:02, 175.56it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:01, 176.56it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:01, 176.73it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 175.57it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 176.34it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 175.75it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 174.36it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 174.99it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 175.66it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 175.40it/s]replace nan value:  69%|██████▊   | 379/553 [00:02<00:00, 176.81it/s]replace nan value:  72%|███████▏  | 397/553 [00:02<00:00, 177.16it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 175.29it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 173.80it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 173.80it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 174.90it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 175.98it/s]replace nan value:  92%|█████████▏| 506/553 [00:02<00:00, 177.24it/s]replace nan value:  95%|█████████▍| 524/553 [00:03<00:00, 177.34it/s]replace nan value:  98%|█████████▊| 542/553 [00:03<00:00, 177.95it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 175.04it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.65it/s]  5%|▌         | 28/553 [00:00<00:03, 138.43it/s]  8%|▊         | 42/553 [00:00<00:03, 134.16it/s] 10%|█         | 56/553 [00:00<00:03, 126.21it/s] 12%|█▏        | 69/553 [00:00<00:04, 115.74it/s] 15%|█▌        | 85/553 [00:00<00:03, 127.76it/s] 18%|█▊        | 98/553 [00:00<00:03, 126.37it/s] 21%|██        | 115/553 [00:00<00:03, 136.56it/s] 23%|██▎       | 129/553 [00:00<00:03, 135.97it/s] 27%|██▋       | 148/553 [00:01<00:02, 149.92it/s] 30%|██▉       | 165/553 [00:01<00:02, 154.62it/s] 33%|███▎      | 181/553 [00:01<00:02, 154.81it/s] 36%|███▌      | 198/553 [00:01<00:02, 157.65it/s] 39%|███▉      | 215/553 [00:01<00:02, 159.77it/s] 42%|████▏     | 232/553 [00:01<00:02, 148.86it/s] 45%|████▍     | 248/553 [00:01<00:02, 149.83it/s] 48%|████▊     | 264/553 [00:01<00:01, 148.03it/s] 50%|█████     | 279/553 [00:01<00:01, 139.92it/s] 53%|█████▎    | 294/553 [00:02<00:01, 136.33it/s] 56%|█████▌    | 308/553 [00:02<00:01, 132.11it/s] 58%|█████▊    | 322/553 [00:02<00:01, 128.57it/s] 61%|██████    | 337/553 [00:02<00:01, 132.03it/s] 63%|██████▎   | 351/553 [00:02<00:01, 132.98it/s] 66%|██████▌   | 365/553 [00:02<00:01, 129.90it/s] 69%|██████▊   | 380/553 [00:02<00:01, 134.26it/s] 71%|███████   | 394/553 [00:02<00:01, 123.59it/s] 74%|███████▍  | 408/553 [00:02<00:01, 127.23it/s] 76%|███████▌  | 421/553 [00:03<00:01, 124.17it/s] 78%|███████▊  | 434/553 [00:03<00:00, 123.06it/s] 82%|████████▏ | 452/553 [00:03<00:00, 138.67it/s] 85%|████████▍ | 468/553 [00:03<00:00, 143.18it/s] 87%|████████▋ | 483/553 [00:03<00:00, 138.51it/s] 90%|████████▉ | 497/553 [00:03<00:00, 127.99it/s] 93%|█████████▎| 512/553 [00:03<00:00, 133.51it/s] 95%|█████████▌| 526/553 [00:03<00:00, 119.51it/s] 97%|█████████▋| 539/553 [00:04<00:00, 119.09it/s]100%|█████████▉| 552/553 [00:04<00:00, 107.55it/s]100%|██████████| 553/553 [00:04<00:00, 132.59it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 363.64it/s]extract the null data:  71%|███████   | 99/139 [00:00<00:00, 512.39it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 523.96it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 213.68it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 217.58it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 219.05it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 219.85it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 222.72it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 220.42it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 220.06it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:01, 125.74it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.02it/s] 31%|███       | 43/139 [00:00<00:00, 142.54it/s] 42%|████▏     | 58/139 [00:00<00:00, 124.01it/s] 53%|█████▎    | 73/139 [00:00<00:00, 131.68it/s] 63%|██████▎   | 87/139 [00:00<00:00, 117.72it/s] 72%|███████▏  | 100/139 [00:00<00:00, 120.46it/s] 81%|████████▏ | 113/139 [00:00<00:00, 121.89it/s] 91%|█████████▏| 127/139 [00:01<00:00, 126.87it/s]100%|██████████| 139/139 [00:01<00:00, 126.93it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|█▉        | 34/173 [00:00<00:00, 336.50it/s]extract the null data:  58%|█████▊    | 100/173 [00:00<00:00, 524.95it/s]extract the null data:  95%|█████████▌| 165/173 [00:00<00:00, 581.27it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 548.58it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 207.14it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 210.44it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 210.89it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 211.32it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 211.99it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 212.28it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 212.83it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 211.34it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 136.32it/s] 17%|█▋        | 29/173 [00:00<00:01, 121.24it/s] 27%|██▋       | 46/173 [00:00<00:00, 140.32it/s] 36%|███▋      | 63/173 [00:00<00:00, 150.69it/s] 46%|████▌     | 79/173 [00:00<00:00, 152.68it/s] 55%|█████▍    | 95/173 [00:00<00:00, 151.99it/s] 65%|██████▌   | 113/173 [00:00<00:00, 156.33it/s] 75%|███████▍  | 129/173 [00:00<00:00, 151.91it/s] 84%|████████▍ | 145/173 [00:00<00:00, 147.74it/s] 92%|█████████▏| 160/173 [00:01<00:00, 136.62it/s]100%|██████████| 173/173 [00:01<00:00, 132.47it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.623, valid loss : 0.467, train f1 : 0.642, valid f1 : 0.600
training process - Deferred Re-weighting:   1%|          | 1/128 [01:00<2:08:28, 60.70s/it]Best score increase :0.000 -> 0.600
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:51<1:54:47, 54.66s/it]Best score increase :0.600 -> 0.660
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:43<1:51:19, 53.44s/it]Best score increase :0.660 -> 0.705
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:34<1:48:37, 52.56s/it]Best score increase :0.705 -> 0.725
epoch : 5, train loss : 0.387, valid loss : 0.318, train f1 : 0.822, valid f1 : 0.729
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:33<1:52:28, 54.87s/it]Best score increase :0.725 -> 0.729
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:21<1:47:13, 52.74s/it]Best score increase :0.729 -> 0.772
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:11<1:44:35, 51.87s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:01<1:42:17, 51.14s/it]Best score increase :0.772 -> 0.790
epoch : 9, train loss : 0.337, valid loss : 0.265, train f1 : 0.852, valid f1 : 0.768
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:57<1:44:13, 52.55s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:44<1:40:13, 50.96s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:32<1:37:45, 50.13s/it]Best score increase :0.790 -> 0.807
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:22<1:36:22, 49.85s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.306, valid loss : 0.257, train f1 : 0.865, valid f1 : 0.786
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:18<1:39:18, 51.81s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:06<1:36:16, 50.67s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:54<1:34:13, 50.03s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:42<1:31:51, 49.21s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.288, valid loss : 0.260, train f1 : 0.877, valid f1 : 0.778
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:37<1:34:17, 50.97s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:24<1:31:05, 49.69s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:12<1:29:32, 49.29s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:00<1:28:06, 48.95s/it]Best score increase :0.807 -> 0.817
epoch : 21, train loss : 0.273, valid loss : 0.224, train f1 : 0.883, valid f1 : 0.801
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [17:56<1:30:57, 51.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [18:47<1:30:06, 51.01s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:36<1:28:05, 50.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:24<1:26:04, 49.66s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.256, valid loss : 0.208, train f1 : 0.893, valid f1 : 0.812
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:23<1:30:06, 52.49s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:13<1:28:04, 51.81s/it]Best score increase :0.817 -> 0.835
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:01<1:25:04, 50.54s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [23:49<1:23:00, 49.81s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.249, valid loss : 0.273, train f1 : 0.896, valid f1 : 0.753
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [24:47<1:26:30, 52.43s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [25:36<1:23:43, 51.26s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [26:23<1:21:00, 50.11s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:12<1:19:34, 49.73s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.238, valid loss : 0.185, train f1 : 0.903, valid f1 : 0.821
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [28:10<1:22:25, 52.06s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [28:58<1:19:37, 50.83s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [29:45<1:17:20, 49.90s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [30:34<1:16:11, 49.69s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.220, valid loss : 0.210, train f1 : 0.908, valid f1 : 0.806
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [31:33<1:19:30, 52.42s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:23<1:19:38, 52.52s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.836
training process finished, best loss : 0.162, best acc : 0.943, best f1 : 0.836, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.81      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.80      0.89      0.84      7398
weighted avg       0.96      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.89, test loss : 10.868

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.46s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.84s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.78s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.71s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.67s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:45,  7.64s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.64s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.91s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.97s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.92s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.83s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.71s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.76s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  9%|▉         | 29/306 [00:00<00:00, 286.08it/s] 19%|█▉        | 58/306 [00:00<00:01, 165.44it/s] 30%|██▉       | 91/306 [00:00<00:00, 216.57it/s] 38%|███▊      | 117/306 [00:00<00:00, 195.90it/s] 47%|████▋     | 143/306 [00:00<00:00, 212.40it/s] 55%|█████▍    | 167/306 [00:00<00:00, 188.82it/s] 62%|██████▏   | 191/306 [00:00<00:00, 196.02it/s] 69%|██████▉   | 212/306 [00:01<00:00, 176.81it/s] 77%|███████▋  | 235/306 [00:01<00:00, 184.42it/s] 83%|████████▎ | 255/306 [00:01<00:00, 169.12it/s] 92%|█████████▏| 282/306 [00:01<00:00, 192.53it/s] 99%|█████████▉| 303/306 [00:01<00:00, 169.22it/s]100%|██████████| 306/306 [00:01<00:00, 186.23it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 52/553 [00:00<00:00, 518.46it/s]extract the null data:  19%|█▉        | 107/553 [00:00<00:00, 535.19it/s]extract the null data:  29%|██▉       | 162/553 [00:00<00:00, 540.45it/s]extract the null data:  40%|███▉      | 219/553 [00:00<00:00, 550.75it/s]extract the null data:  50%|████▉     | 275/553 [00:00<00:00, 541.65it/s]extract the null data:  60%|█████▉    | 330/553 [00:00<00:00, 542.59it/s]extract the null data:  70%|██████▉   | 385/553 [00:00<00:00, 540.14it/s]extract the null data:  80%|███████▉  | 440/553 [00:00<00:00, 536.49it/s]extract the null data:  89%|████████▉ | 494/553 [00:00<00:00, 525.25it/s]extract the null data:  99%|█████████▉| 547/553 [00:01<00:00, 522.49it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 532.61it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 185.20it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 183.67it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 183.14it/s]replace nan value:  14%|█▎        | 76/553 [00:00<00:02, 184.15it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:02, 186.04it/s]replace nan value:  21%|██        | 115/553 [00:00<00:02, 187.88it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 186.93it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:02, 189.07it/s]replace nan value:  31%|███▏      | 173/553 [00:00<00:02, 188.89it/s]replace nan value:  35%|███▍      | 192/553 [00:01<00:01, 188.59it/s]replace nan value:  38%|███▊      | 211/553 [00:01<00:01, 188.66it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 190.23it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 189.67it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 188.50it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 188.36it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 189.47it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 190.29it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:01, 190.93it/s]replace nan value:  67%|██████▋   | 369/553 [00:01<00:00, 191.09it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 191.37it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 192.82it/s]replace nan value:  78%|███████▊  | 429/553 [00:02<00:00, 192.06it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 193.05it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 193.12it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 193.64it/s]replace nan value:  92%|█████████▏| 509/553 [00:02<00:00, 191.12it/s]replace nan value:  96%|█████████▌| 529/553 [00:02<00:00, 189.05it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 190.38it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 189.56it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 136.00it/s]  5%|▌         | 29/553 [00:00<00:03, 139.50it/s]  8%|▊         | 43/553 [00:00<00:03, 129.16it/s] 10%|█         | 56/553 [00:00<00:04, 123.21it/s] 12%|█▏        | 69/553 [00:00<00:04, 113.29it/s] 15%|█▌        | 85/553 [00:00<00:03, 125.47it/s] 18%|█▊        | 98/553 [00:00<00:03, 123.75it/s] 21%|██        | 114/553 [00:00<00:03, 133.22it/s] 23%|██▎       | 128/553 [00:01<00:03, 130.96it/s] 26%|██▋       | 146/553 [00:01<00:02, 144.47it/s] 29%|██▉       | 163/553 [00:01<00:02, 150.03it/s] 32%|███▏      | 179/553 [00:01<00:02, 152.83it/s] 35%|███▌      | 195/553 [00:01<00:02, 154.39it/s] 39%|███▊      | 213/553 [00:01<00:02, 158.43it/s] 41%|████▏     | 229/553 [00:01<00:02, 148.73it/s] 44%|████▍     | 245/553 [00:01<00:02, 146.04it/s] 47%|████▋     | 261/553 [00:01<00:01, 149.33it/s] 50%|█████     | 277/553 [00:01<00:01, 142.60it/s] 53%|█████▎    | 292/553 [00:02<00:01, 141.86it/s] 56%|█████▌    | 307/553 [00:02<00:01, 134.31it/s] 58%|█████▊    | 321/553 [00:02<00:01, 131.73it/s] 61%|██████    | 335/553 [00:02<00:01, 133.27it/s] 63%|██████▎   | 349/553 [00:02<00:01, 131.64it/s] 66%|██████▌   | 363/553 [00:02<00:01, 128.92it/s] 68%|██████▊   | 378/553 [00:02<00:01, 132.33it/s] 71%|███████   | 392/553 [00:02<00:01, 124.25it/s] 73%|███████▎  | 405/553 [00:02<00:01, 125.31it/s] 76%|███████▌  | 418/553 [00:03<00:01, 123.38it/s] 78%|███████▊  | 431/553 [00:03<00:01, 120.73it/s] 81%|████████▏ | 450/553 [00:03<00:00, 138.82it/s] 84%|████████▍ | 465/553 [00:03<00:00, 139.75it/s] 87%|████████▋ | 480/553 [00:03<00:00, 135.99it/s] 89%|████████▉ | 494/553 [00:03<00:00, 130.92it/s] 92%|█████████▏| 509/553 [00:03<00:00, 134.84it/s] 95%|█████████▍| 523/553 [00:03<00:00, 124.29it/s] 97%|█████████▋| 536/553 [00:04<00:00, 114.24it/s]100%|█████████▉| 551/553 [00:04<00:00, 104.73it/s]100%|██████████| 553/553 [00:04<00:00, 131.26it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 257.91it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 463.53it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 479.45it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 206.90it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 204.73it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 205.81it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 209.27it/s]replace nan value:  76%|███████▋  | 106/139 [00:00<00:00, 208.69it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 206.60it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 206.37it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 119.71it/s] 18%|█▊        | 25/139 [00:00<00:00, 125.24it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.66it/s] 39%|███▉      | 54/139 [00:00<00:00, 127.05it/s] 48%|████▊     | 67/139 [00:00<00:00, 127.60it/s] 58%|█████▊    | 80/139 [00:00<00:00, 125.06it/s] 67%|██████▋   | 93/139 [00:00<00:00, 115.25it/s] 76%|███████▋  | 106/139 [00:00<00:00, 117.76it/s] 88%|████████▊ | 122/139 [00:00<00:00, 125.64it/s] 97%|█████████▋| 135/139 [00:01<00:00, 122.89it/s]100%|██████████| 139/139 [00:01<00:00, 124.76it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 316.16it/s]extract the null data:  54%|█████▍    | 94/173 [00:00<00:00, 493.45it/s]extract the null data:  90%|████████▉ | 155/173 [00:00<00:00, 545.19it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 517.62it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 206.27it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 205.10it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 202.70it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 202.86it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 203.48it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 202.57it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 200.46it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 197.43it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 200.35it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 134.76it/s] 16%|█▌        | 28/173 [00:00<00:01, 117.78it/s] 24%|██▍       | 42/173 [00:00<00:01, 125.35it/s] 33%|███▎      | 57/173 [00:00<00:00, 131.97it/s] 41%|████      | 71/173 [00:00<00:00, 131.28it/s] 49%|████▉     | 85/173 [00:00<00:00, 129.11it/s] 57%|█████▋    | 98/173 [00:00<00:00, 129.28it/s] 65%|██████▌   | 113/173 [00:00<00:00, 134.19it/s] 73%|███████▎  | 127/173 [00:00<00:00, 127.49it/s] 81%|████████  | 140/173 [00:01<00:00, 127.53it/s] 88%|████████▊ | 153/173 [00:01<00:00, 119.59it/s] 96%|█████████▌| 166/173 [00:01<00:00, 94.01it/s] 100%|██████████| 173/173 [00:01<00:00, 113.45it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.093, valid loss : 0.081, train acc : 0.907, valid acc : 0.915, train f1 : 0.513, valid f1 : 0.504
training process:   1%|          | 1/128 [00:41<1:26:53, 41.05s/it]Best score increase :0.000 -> 0.504
training process:   2%|▏         | 2/128 [01:27<1:33:02, 44.30s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:15<1:35:25, 45.81s/it]Best score increase :0.504 -> 0.523
training process:   3%|▎         | 4/128 [03:03<1:36:46, 46.82s/it]Best score increase :0.523 -> 0.598
epoch : 5, train loss : 0.057, valid loss : 0.060, train acc : 0.930, valid acc : 0.931, train f1 : 0.643, valid f1 : 0.682
training process:   4%|▍         | 5/128 [04:00<1:43:05, 50.29s/it]Best score increase :0.598 -> 0.682
training process:   5%|▍         | 6/128 [04:48<1:40:40, 49.51s/it]Best score increase :0.682 -> 0.714
training process:   5%|▌         | 7/128 [05:37<1:39:40, 49.43s/it]Best score increase :0.714 -> 0.732
training process:   6%|▋         | 8/128 [06:25<1:38:09, 49.08s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.047, valid loss : 0.053, train acc : 0.944, valid acc : 0.941, train f1 : 0.758, valid f1 : 0.784
training process:   7%|▋         | 9/128 [07:21<1:41:17, 51.07s/it]Best score increase :0.732 -> 0.784
training process:   8%|▊         | 10/128 [08:07<1:37:51, 49.76s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [08:56<1:36:12, 49.34s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [09:45<1:35:04, 49.18s/it]Best score increase :0.784 -> 0.796
epoch : 13, train loss : 0.043, valid loss : 0.048, train acc : 0.953, valid acc : 0.947, train f1 : 0.804, valid f1 : 0.769
training process:  10%|█         | 13/128 [10:40<1:38:09, 51.21s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [11:30<1:36:14, 50.65s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [12:20<1:35:11, 50.55s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [13:11<1:34:23, 50.56s/it]Best score increase :0.796 -> 0.806
epoch : 17, train loss : 0.040, valid loss : 0.048, train acc : 0.955, valid acc : 0.949, train f1 : 0.817, valid f1 : 0.780
training process:  13%|█▎        | 17/128 [14:08<1:37:13, 52.56s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:00<1:36:13, 52.49s/it]Best score increase :0.806 -> 0.807
training process:  15%|█▍        | 19/128 [15:47<1:32:26, 50.88s/it]Best score increase :0.807 -> 0.815
training process:  16%|█▌        | 20/128 [16:36<1:30:13, 50.13s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.038, valid loss : 0.042, train acc : 0.956, valid acc : 0.954, train f1 : 0.823, valid f1 : 0.813
training process:  16%|█▋        | 21/128 [17:34<1:33:29, 52.43s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [18:22<1:30:37, 51.29s/it]Best score increase :0.815 -> 0.821
training process:  18%|█▊        | 23/128 [19:10<1:27:50, 50.19s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [19:58<1:25:50, 49.52s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.036, valid loss : 0.042, train acc : 0.959, valid acc : 0.954, train f1 : 0.835, valid f1 : 0.814
training process:  20%|█▉        | 25/128 [20:58<1:30:25, 52.67s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [21:46<1:27:02, 51.20s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [22:34<1:24:42, 50.33s/it]Best score increase :0.821 -> 0.824
training process:  22%|██▏       | 28/128 [23:23<1:23:28, 50.09s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.034, valid loss : 0.043, train acc : 0.960, valid acc : 0.954, train f1 : 0.840, valid f1 : 0.805
training process:  23%|██▎       | 29/128 [24:25<1:28:08, 53.42s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [25:13<1:24:33, 51.77s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [26:03<1:23:04, 51.39s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [26:52<1:20:58, 50.61s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.034, valid loss : 0.037, train acc : 0.961, valid acc : 0.956, train f1 : 0.844, valid f1 : 0.824
training process:  26%|██▌       | 33/128 [27:48<1:22:49, 52.31s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [28:36<1:20:04, 51.12s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [29:25<1:18:14, 50.47s/it]EarlyStopping counter : 8 out of 12
training process:  28%|██▊       | 36/128 [30:13<1:16:03, 49.61s/it]EarlyStopping counter : 9 out of 12
epoch : 37, train loss : 0.033, valid loss : 0.040, train acc : 0.961, valid acc : 0.956, train f1 : 0.848, valid f1 : 0.821
training process:  29%|██▉       | 37/128 [31:07<1:17:27, 51.07s/it]EarlyStopping counter : 10 out of 12
training process:  30%|██▉       | 38/128 [31:54<1:14:21, 49.57s/it]EarlyStopping counter : 11 out of 12
training process:  30%|██▉       | 38/128 [32:47<1:17:39, 51.77s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 38, best f1 score : 0.825
training process finished, best loss : 0.038 and best acc : 0.956, best f1 : 0.825, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.72      0.58      0.64       580
           1       0.96      0.98      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.84      0.78      0.81      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.81, test AUC : 0.78, test loss : 2.646

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.73s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.85s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:08,  7.64s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.61s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.62s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.67s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.66s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.63s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.69s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.64s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.61s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.58s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.64s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 133.73it/s] 12%|█▏        | 36/306 [00:00<00:01, 183.40it/s] 18%|█▊        | 55/306 [00:00<00:01, 176.10it/s] 24%|██▍       | 73/306 [00:00<00:01, 173.48it/s] 30%|███       | 93/306 [00:00<00:01, 177.80it/s] 36%|███▋      | 111/306 [00:00<00:01, 165.40it/s] 44%|████▍     | 134/306 [00:00<00:00, 182.28it/s] 50%|█████     | 153/306 [00:00<00:00, 168.21it/s] 57%|█████▋    | 173/306 [00:00<00:00, 176.83it/s] 62%|██████▏   | 191/306 [00:01<00:00, 166.81it/s] 70%|██████▉   | 213/306 [00:01<00:00, 175.73it/s] 75%|███████▌  | 231/306 [00:01<00:00, 169.78it/s] 82%|████████▏ | 250/306 [00:01<00:00, 174.94it/s] 88%|████████▊ | 268/306 [00:01<00:00, 166.45it/s] 95%|█████████▍| 290/306 [00:01<00:00, 176.07it/s]100%|██████████| 306/306 [00:01<00:00, 171.06it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 555.79it/s]extract the null data:  21%|██        | 114/553 [00:00<00:00, 564.15it/s]extract the null data:  32%|███▏      | 178/553 [00:00<00:00, 598.22it/s]extract the null data:  44%|████▍     | 243/553 [00:00<00:00, 616.65it/s]extract the null data:  55%|█████▌    | 305/553 [00:00<00:00, 612.85it/s]extract the null data:  67%|██████▋   | 368/553 [00:00<00:00, 617.39it/s]extract the null data:  78%|███████▊  | 430/553 [00:00<00:00, 614.05it/s]extract the null data:  89%|████████▉ | 492/553 [00:00<00:00, 601.47it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 604.60it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 200.34it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 195.53it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 191.77it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 191.57it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 193.66it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 200.05it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:02, 199.27it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:01, 197.90it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 197.47it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:01, 193.46it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 197.04it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 201.91it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 200.36it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 198.87it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 196.65it/s]replace nan value:  60%|█████▉    | 330/553 [00:01<00:01, 195.50it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:01, 200.31it/s]replace nan value:  67%|██████▋   | 373/553 [00:01<00:00, 201.33it/s]replace nan value:  71%|███████   | 394/553 [00:01<00:00, 197.03it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 195.14it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 195.19it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 195.17it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 198.51it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 197.41it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 194.70it/s]replace nan value:  97%|█████████▋| 535/553 [00:02<00:00, 194.73it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 196.52it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.44it/s]  5%|▌         | 30/553 [00:00<00:03, 148.41it/s]  8%|▊         | 45/553 [00:00<00:03, 130.20it/s] 11%|█         | 59/553 [00:00<00:04, 121.71it/s] 13%|█▎        | 72/553 [00:00<00:03, 122.89it/s] 16%|█▌        | 88/553 [00:00<00:03, 133.86it/s] 18%|█▊        | 102/553 [00:00<00:03, 129.22it/s] 22%|██▏       | 120/553 [00:00<00:03, 142.90it/s] 24%|██▍       | 135/553 [00:00<00:02, 142.70it/s] 28%|██▊       | 153/553 [00:01<00:02, 153.39it/s] 31%|███       | 171/553 [00:01<00:02, 160.85it/s] 34%|███▍      | 188/553 [00:01<00:02, 156.64it/s] 38%|███▊      | 208/553 [00:01<00:02, 166.61it/s] 41%|████      | 225/553 [00:01<00:02, 155.21it/s] 44%|████▎     | 241/553 [00:01<00:02, 153.76it/s] 46%|████▋     | 257/553 [00:01<00:02, 146.90it/s] 49%|████▉     | 272/553 [00:01<00:01, 141.29it/s] 52%|█████▏    | 287/553 [00:01<00:01, 141.14it/s] 55%|█████▍    | 302/553 [00:02<00:01, 134.36it/s] 57%|█████▋    | 316/553 [00:02<00:01, 126.93it/s] 59%|█████▉    | 329/553 [00:02<00:01, 127.14it/s] 62%|██████▏   | 345/553 [00:02<00:01, 130.71it/s] 65%|██████▍   | 359/553 [00:02<00:01, 128.45it/s] 68%|██████▊   | 375/553 [00:02<00:01, 135.79it/s] 70%|███████   | 389/553 [00:02<00:01, 126.74it/s] 73%|███████▎  | 402/553 [00:02<00:01, 121.32it/s] 75%|███████▌  | 416/553 [00:03<00:01, 123.50it/s] 78%|███████▊  | 429/553 [00:03<00:01, 119.25it/s] 81%|████████  | 448/553 [00:03<00:00, 135.63it/s] 84%|████████▍ | 464/553 [00:03<00:00, 139.27it/s] 87%|████████▋ | 479/553 [00:03<00:00, 136.69it/s] 89%|████████▉ | 493/553 [00:03<00:00, 132.13it/s] 92%|█████████▏| 507/553 [00:03<00:00, 132.91it/s] 94%|█████████▍| 521/553 [00:03<00:00, 130.48it/s] 97%|█████████▋| 535/553 [00:03<00:00, 115.85it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.70it/s]100%|██████████| 553/553 [00:04<00:00, 133.27it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 41/139 [00:00<00:00, 404.53it/s]extract the null data:  77%|███████▋  | 107/139 [00:00<00:00, 551.29it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 544.79it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 209.17it/s]replace nan value:  31%|███       | 43/139 [00:00<00:00, 210.91it/s]replace nan value:  47%|████▋     | 65/139 [00:00<00:00, 206.82it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 210.35it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 212.84it/s]replace nan value:  94%|█████████▍| 131/139 [00:00<00:00, 211.95it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 211.24it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.03it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.18it/s] 29%|██▉       | 40/139 [00:00<00:00, 132.90it/s] 39%|███▉      | 54/139 [00:00<00:00, 124.40it/s] 48%|████▊     | 67/139 [00:00<00:00, 122.90it/s] 58%|█████▊    | 80/139 [00:00<00:00, 123.31it/s] 67%|██████▋   | 93/139 [00:00<00:00, 117.97it/s] 77%|███████▋  | 107/139 [00:00<00:00, 124.35it/s] 90%|████████▉ | 125/139 [00:00<00:00, 138.36it/s]100%|██████████| 139/139 [00:01<00:00, 130.56it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 358.75it/s]extract the null data:  56%|█████▌    | 97/173 [00:00<00:00, 502.04it/s]extract the null data:  93%|█████████▎| 161/173 [00:00<00:00, 562.35it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 536.55it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 210.87it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 210.69it/s]replace nan value:  39%|███▊      | 67/173 [00:00<00:00, 215.27it/s]replace nan value:  51%|█████▏    | 89/173 [00:00<00:00, 214.97it/s]replace nan value:  64%|██████▍   | 111/173 [00:00<00:00, 216.20it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 216.18it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 213.35it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 212.41it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 136.09it/s] 16%|█▌        | 28/173 [00:00<00:01, 120.99it/s] 25%|██▍       | 43/173 [00:00<00:00, 133.04it/s] 34%|███▍      | 59/173 [00:00<00:00, 140.52it/s] 43%|████▎     | 74/173 [00:00<00:00, 137.63it/s] 51%|█████     | 88/173 [00:00<00:00, 133.10it/s] 59%|█████▉    | 102/173 [00:00<00:00, 131.85it/s] 67%|██████▋   | 116/173 [00:00<00:00, 133.45it/s] 75%|███████▌  | 130/173 [00:00<00:00, 129.47it/s] 83%|████████▎ | 143/173 [00:01<00:00, 128.55it/s] 90%|█████████ | 156/173 [00:01<00:00, 119.31it/s] 98%|█████████▊| 169/173 [00:01<00:00, 98.15it/s] 100%|██████████| 173/173 [00:01<00:00, 116.53it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.157, valid loss : 0.129, train acc : 0.648, valid acc : 0.754, train f1 : 0.643, valid f1 : 0.582
training process:   1%|          | 1/128 [00:59<2:06:49, 59.92s/it]Best score increase :0.000 -> 0.582
training process:   2%|▏         | 2/128 [01:52<1:56:55, 55.68s/it]Best score increase :0.582 -> 0.680
training process:   2%|▏         | 3/128 [02:40<1:48:41, 52.18s/it]Best score increase :0.680 -> 0.717
training process:   3%|▎         | 4/128 [03:31<1:46:37, 51.60s/it]Best score increase :0.717 -> 0.736
epoch : 5, train loss : 0.095, valid loss : 0.078, train acc : 0.834, valid acc : 0.904, train f1 : 0.834, valid f1 : 0.755
training process:   4%|▍         | 5/128 [04:31<1:51:53, 54.58s/it]Best score increase :0.736 -> 0.755
training process:   5%|▍         | 6/128 [05:20<1:47:02, 52.64s/it]Best score increase :0.755 -> 0.789
training process:   5%|▌         | 7/128 [06:11<1:45:05, 52.11s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:02<1:43:53, 51.95s/it]Best score increase :0.789 -> 0.806
epoch : 9, train loss : 0.082, valid loss : 0.065, train acc : 0.863, valid acc : 0.929, train f1 : 0.863, valid f1 : 0.802
training process:   7%|▋         | 9/128 [08:01<1:47:05, 54.00s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:48<1:42:01, 51.87s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:35<1:38:34, 50.55s/it]Best score increase :0.806 -> 0.812
training process:   9%|▉         | 12/128 [10:24<1:36:45, 50.05s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.077, valid loss : 0.067, train acc : 0.872, valid acc : 0.921, train f1 : 0.872, valid f1 : 0.792
training process:  10%|█         | 13/128 [11:20<1:39:27, 51.89s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:10<1:37:14, 51.18s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [12:58<1:34:31, 50.19s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [13:48<1:33:43, 50.21s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.073, valid loss : 0.065, train acc : 0.878, valid acc : 0.920, train f1 : 0.878, valid f1 : 0.793
training process:  13%|█▎        | 17/128 [14:47<1:37:37, 52.77s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [15:36<1:34:36, 51.60s/it]EarlyStopping counter : 7 out of 12
training process:  15%|█▍        | 19/128 [16:24<1:31:57, 50.62s/it]EarlyStopping counter : 8 out of 12
training process:  16%|█▌        | 20/128 [17:13<1:30:01, 50.01s/it]Best score increase :0.812 -> 0.824
epoch : 21, train loss : 0.071, valid loss : 0.059, train acc : 0.885, valid acc : 0.928, train f1 : 0.885, valid f1 : 0.810
training process:  16%|█▋        | 21/128 [18:09<1:32:41, 51.98s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [18:57<1:29:24, 50.60s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [19:46<1:27:47, 50.17s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [20:36<1:26:46, 50.06s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.066, valid loss : 0.052, train acc : 0.893, valid acc : 0.937, train f1 : 0.893, valid f1 : 0.824
training process:  20%|█▉        | 25/128 [21:33<1:29:51, 52.34s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [22:22<1:27:23, 51.41s/it]Best score increase :0.824 -> 0.835
training process:  21%|██        | 27/128 [23:12<1:25:33, 50.82s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:01<1:23:37, 50.18s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.065, valid loss : 0.055, train acc : 0.894, valid acc : 0.929, train f1 : 0.894, valid f1 : 0.812
training process:  23%|██▎       | 29/128 [24:57<1:26:05, 52.17s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [25:46<1:23:36, 51.19s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [26:37<1:22:16, 50.89s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [27:30<1:22:52, 51.80s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.063, valid loss : 0.049, train acc : 0.900, valid acc : 0.939, train f1 : 0.900, valid f1 : 0.832
training process:  26%|██▌       | 33/128 [28:34<1:27:50, 55.48s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [29:41<1:32:08, 58.81s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [30:49<1:35:36, 61.68s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [31:58<1:37:46, 63.77s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.060, valid loss : 0.054, train acc : 0.905, valid acc : 0.927, train f1 : 0.905, valid f1 : 0.810
training process:  29%|██▉       | 37/128 [33:19<1:44:25, 68.85s/it]EarlyStopping counter : 11 out of 12
training process:  29%|██▉       | 37/128 [34:27<1:24:46, 55.89s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.835
training process finished, best loss : 0.047 and best acc : 0.941, best f1 : 0.835, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.80      0.72       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.88      0.85      7398
weighted avg       0.96      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.88, test loss : 2.948

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:50, 10.03s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:42, 10.21s/it]processing for feature importance:  25%|██▌       | 3/12 [00:31<01:35, 10.66s/it]processing for feature importance:  33%|███▎      | 4/12 [00:42<01:27, 10.94s/it]processing for feature importance:  42%|████▏     | 5/12 [00:53<01:14, 10.67s/it]processing for feature importance:  50%|█████     | 6/12 [01:03<01:04, 10.70s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:15<00:55, 11.16s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:27<00:45, 11.40s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:39<00:34, 11.35s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:51<00:23, 11.54s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:01<00:11, 11.31s/it]processing for feature importance: 100%|██████████| 12/12 [02:11<00:00, 10.85s/it]processing for feature importance: 100%|██████████| 12/12 [02:11<00:00, 10.97s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 82.61it/s] 11%|█▏        | 35/306 [00:00<00:01, 182.95it/s] 18%|█▊        | 54/306 [00:00<00:01, 165.18it/s] 26%|██▋       | 81/306 [00:00<00:01, 203.08it/s] 33%|███▎      | 102/306 [00:00<00:01, 166.26it/s] 45%|████▍     | 137/306 [00:00<00:00, 214.32it/s] 52%|█████▏    | 160/306 [00:00<00:00, 176.61it/s] 60%|██████    | 184/306 [00:01<00:00, 188.43it/s] 67%|██████▋   | 205/306 [00:01<00:00, 181.79it/s] 74%|███████▎  | 225/306 [00:01<00:00, 176.55it/s] 80%|████████  | 246/306 [00:01<00:00, 185.01it/s] 87%|████████▋ | 266/306 [00:01<00:00, 166.26it/s] 96%|█████████▌| 293/306 [00:01<00:00, 191.47it/s]100%|██████████| 306/306 [00:01<00:00, 175.03it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 55/553 [00:00<00:00, 542.98it/s]extract the null data:  21%|██        | 115/553 [00:00<00:00, 572.75it/s]extract the null data:  31%|███▏      | 173/553 [00:00<00:00, 571.93it/s]extract the null data:  42%|████▏     | 232/553 [00:00<00:00, 578.50it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 579.18it/s]extract the null data:  63%|██████▎   | 349/553 [00:00<00:00, 576.59it/s]extract the null data:  74%|███████▍  | 409/553 [00:00<00:00, 582.09it/s]extract the null data:  85%|████████▍ | 468/553 [00:00<00:00, 577.37it/s]extract the null data:  96%|█████████▌| 529/553 [00:00<00:00, 584.20it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 577.53it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 188.24it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 193.03it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 194.48it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:02, 194.81it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 198.19it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 201.00it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 201.73it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:01, 197.00it/s]replace nan value:  33%|███▎      | 183/553 [00:00<00:01, 194.27it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:01, 196.93it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 194.42it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 194.12it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 192.06it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 193.31it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 193.54it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 191.23it/s]replace nan value:  62%|██████▏   | 345/553 [00:01<00:01, 195.16it/s]replace nan value:  66%|██████▌   | 365/553 [00:01<00:00, 193.98it/s]replace nan value:  70%|██████▉   | 385/553 [00:01<00:00, 195.64it/s]replace nan value:  73%|███████▎  | 405/553 [00:02<00:00, 195.19it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 192.59it/s]replace nan value:  81%|████████  | 446/553 [00:02<00:00, 195.34it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 195.02it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 196.80it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 197.47it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 198.59it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 199.83it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 195.76it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.99it/s]  5%|▌         | 30/553 [00:00<00:03, 149.51it/s]  8%|▊         | 45/553 [00:00<00:03, 132.41it/s] 11%|█         | 59/553 [00:00<00:03, 124.16it/s] 13%|█▎        | 72/553 [00:00<00:03, 124.55it/s] 16%|█▌        | 89/553 [00:00<00:03, 135.40it/s] 19%|█▊        | 103/553 [00:00<00:03, 131.87it/s] 22%|██▏       | 121/553 [00:00<00:03, 143.31it/s] 25%|██▍       | 136/553 [00:00<00:02, 144.27it/s] 28%|██▊       | 155/553 [00:01<00:02, 156.86it/s] 31%|███▏      | 173/553 [00:01<00:02, 161.74it/s] 34%|███▍      | 190/553 [00:01<00:02, 159.04it/s] 38%|███▊      | 209/553 [00:01<00:02, 166.42it/s] 41%|████      | 226/553 [00:01<00:02, 154.16it/s] 44%|████▍     | 242/553 [00:01<00:02, 153.68it/s] 47%|████▋     | 258/553 [00:01<00:02, 147.24it/s] 49%|████▉     | 273/553 [00:01<00:01, 143.23it/s] 52%|█████▏    | 290/553 [00:01<00:01, 148.34it/s] 55%|█████▌    | 305/553 [00:02<00:01, 139.82it/s] 58%|█████▊    | 320/553 [00:02<00:01, 131.28it/s] 60%|██████    | 334/553 [00:02<00:01, 133.28it/s] 63%|██████▎   | 349/553 [00:02<00:01, 134.52it/s] 66%|██████▌   | 363/553 [00:02<00:01, 133.11it/s] 68%|██████▊   | 378/553 [00:02<00:01, 137.60it/s] 71%|███████   | 392/553 [00:02<00:01, 128.11it/s] 73%|███████▎  | 406/553 [00:02<00:01, 130.46it/s] 76%|███████▌  | 420/553 [00:03<00:01, 127.56it/s] 78%|███████▊  | 433/553 [00:03<00:00, 125.05it/s] 82%|████████▏ | 452/553 [00:03<00:00, 141.86it/s] 84%|████████▍ | 467/553 [00:03<00:00, 144.09it/s] 87%|████████▋ | 482/553 [00:03<00:00, 140.22it/s] 90%|████████▉ | 497/553 [00:03<00:00, 132.21it/s] 93%|█████████▎| 513/553 [00:03<00:00, 137.64it/s] 95%|█████████▌| 527/553 [00:03<00:00, 123.38it/s] 98%|█████████▊| 541/553 [00:03<00:00, 125.83it/s]100%|██████████| 553/553 [00:04<00:00, 136.24it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 339.19it/s]extract the null data:  74%|███████▍  | 103/139 [00:00<00:00, 543.56it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 541.02it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 223.98it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 222.43it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 221.52it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 218.79it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 221.07it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 220.31it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 220.56it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 126.47it/s] 19%|█▉        | 27/139 [00:00<00:00, 128.45it/s] 31%|███       | 43/139 [00:00<00:00, 140.94it/s] 42%|████▏     | 58/139 [00:00<00:00, 123.38it/s] 53%|█████▎    | 73/139 [00:00<00:00, 130.71it/s] 63%|██████▎   | 87/139 [00:00<00:00, 123.02it/s] 73%|███████▎  | 102/139 [00:00<00:00, 129.08it/s] 84%|████████▍ | 117/139 [00:00<00:00, 134.74it/s] 95%|█████████▍| 132/139 [00:00<00:00, 136.68it/s]100%|██████████| 139/139 [00:01<00:00, 134.60it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 39/173 [00:00<00:00, 387.71it/s]extract the null data:  62%|██████▏   | 108/173 [00:00<00:00, 562.97it/s]extract the null data:  99%|█████████▉| 171/173 [00:00<00:00, 592.18it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 566.99it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 222.24it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 221.70it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 216.75it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 217.74it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 215.53it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 217.62it/s]replace nan value:  91%|█████████▏| 158/173 [00:00<00:00, 215.93it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 216.61it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 137.36it/s] 17%|█▋        | 29/173 [00:00<00:01, 122.50it/s] 27%|██▋       | 46/173 [00:00<00:00, 138.76it/s] 36%|███▌      | 62/173 [00:00<00:00, 144.22it/s] 45%|████▍     | 77/173 [00:00<00:00, 141.23it/s] 53%|█████▎    | 92/173 [00:00<00:00, 140.05it/s] 62%|██████▏   | 107/173 [00:00<00:00, 139.77it/s] 71%|███████   | 122/173 [00:00<00:00, 138.57it/s] 79%|███████▊  | 136/173 [00:00<00:00, 132.85it/s] 87%|████████▋ | 150/173 [00:01<00:00, 129.74it/s] 95%|█████████▍| 164/173 [00:01<00:00, 119.06it/s]100%|██████████| 173/173 [00:01<00:00, 120.88it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.024, valid loss : 0.023, train acc : 0.783, valid acc : 0.747, train f1 : 0.560, valid f1 : 0.563
training process:   1%|          | 1/128 [00:59<2:06:46, 59.89s/it]Best score increase :0.000 -> 0.563
training process:   2%|▏         | 2/128 [01:48<1:52:02, 53.35s/it]Best score increase :0.563 -> 0.640
training process:   2%|▏         | 3/128 [02:36<1:45:43, 50.75s/it]Best score increase :0.640 -> 0.669
training process:   3%|▎         | 4/128 [03:23<1:42:18, 49.50s/it]Best score increase :0.669 -> 0.677
epoch : 5, train loss : 0.016, valid loss : 0.017, train acc : 0.832, valid acc : 0.906, train f1 : 0.662, valid f1 : 0.750
training process:   4%|▍         | 5/128 [04:22<1:48:18, 52.83s/it]Best score increase :0.677 -> 0.750
training process:   5%|▍         | 6/128 [05:14<1:46:25, 52.34s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:04<1:44:03, 51.60s/it]Best score increase :0.750 -> 0.755
training process:   6%|▋         | 8/128 [06:52<1:40:57, 50.48s/it]Best score increase :0.755 -> 0.782
epoch : 9, train loss : 0.014, valid loss : 0.015, train acc : 0.901, valid acc : 0.905, train f1 : 0.747, valid f1 : 0.759
training process:   7%|▋         | 9/128 [07:51<1:45:26, 53.16s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:41<1:42:40, 52.21s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:31<1:40:45, 51.67s/it]Best score increase :0.782 -> 0.805
training process:   9%|▉         | 12/128 [10:21<1:38:28, 50.93s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.013, valid loss : 0.015, train acc : 0.911, valid acc : 0.936, train f1 : 0.767, valid f1 : 0.810
training process:  10%|█         | 13/128 [11:19<1:41:53, 53.16s/it]Best score increase :0.805 -> 0.810
training process:  11%|█         | 14/128 [12:09<1:39:22, 52.30s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [12:59<1:37:19, 51.67s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [13:53<1:37:20, 52.15s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.012, valid loss : 0.015, train acc : 0.921, valid acc : 0.944, train f1 : 0.785, valid f1 : 0.824
training process:  13%|█▎        | 17/128 [14:55<1:41:56, 55.10s/it]Best score increase :0.810 -> 0.824
training process:  14%|█▍        | 18/128 [15:44<1:37:45, 53.32s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:37<1:36:47, 53.28s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:25<1:33:07, 51.74s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.012, valid loss : 0.014, train acc : 0.920, valid acc : 0.939, train f1 : 0.786, valid f1 : 0.822
training process:  16%|█▋        | 21/128 [18:24<1:36:09, 53.92s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [19:16<1:34:22, 53.42s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [20:08<1:32:32, 52.88s/it]Best score increase :0.824 -> 0.831
training process:  19%|█▉        | 24/128 [20:56<1:29:17, 51.52s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.012, valid loss : 0.014, train acc : 0.924, valid acc : 0.939, train f1 : 0.795, valid f1 : 0.823
training process:  20%|█▉        | 25/128 [21:56<1:32:28, 53.87s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [22:46<1:29:48, 52.83s/it]Best score increase :0.831 -> 0.833
training process:  21%|██        | 27/128 [23:35<1:26:57, 51.66s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:27<1:26:14, 51.74s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.011, valid loss : 0.014, train acc : 0.927, valid acc : 0.944, train f1 : 0.801, valid f1 : 0.831
training process:  23%|██▎       | 29/128 [25:24<1:28:06, 53.39s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [26:15<1:25:56, 52.62s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [27:05<1:23:49, 51.85s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [27:55<1:22:10, 51.36s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.012, valid loss : 0.013, train acc : 0.928, valid acc : 0.943, train f1 : 0.802, valid f1 : 0.832
training process:  26%|██▌       | 33/128 [28:56<1:25:50, 54.21s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [29:55<1:27:04, 55.58s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [30:50<1:25:56, 55.45s/it]Best score increase :0.833 -> 0.837
training process:  28%|██▊       | 36/128 [31:44<1:24:18, 54.98s/it]Best score increase :0.837 -> 0.841
epoch : 37, train loss : 0.011, valid loss : 0.015, train acc : 0.929, valid acc : 0.948, train f1 : 0.805, valid f1 : 0.836
training process:  29%|██▉       | 37/128 [32:54<1:30:10, 59.45s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [33:51<1:28:05, 58.73s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [34:56<1:29:46, 60.52s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [36:07<1:33:23, 63.67s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.011, valid loss : 0.014, train acc : 0.935, valid acc : 0.947, train f1 : 0.816, valid f1 : 0.840
training process:  32%|███▏      | 41/128 [37:23<1:37:43, 67.39s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [38:31<1:37:07, 67.76s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [39:39<1:35:47, 67.62s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [40:43<1:33:25, 66.74s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.011, valid loss : 0.013, train acc : 0.934, valid acc : 0.939, train f1 : 0.815, valid f1 : 0.829
training process:  35%|███▌      | 45/128 [42:00<1:36:38, 69.86s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [43:07<1:34:02, 68.81s/it]Best score increase :0.841 -> 0.849
training process:  37%|███▋      | 47/128 [44:15<1:32:30, 68.53s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [45:20<1:29:59, 67.50s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.011, valid loss : 0.014, train acc : 0.937, valid acc : 0.947, train f1 : 0.820, valid f1 : 0.842
training process:  38%|███▊      | 49/128 [46:42<1:34:44, 71.96s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [47:48<1:31:16, 70.22s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [48:50<1:26:40, 67.54s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [49:50<1:22:46, 65.35s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.010, valid loss : 0.014, train acc : 0.937, valid acc : 0.951, train f1 : 0.821, valid f1 : 0.849
training process:  41%|████▏     | 53/128 [51:06<1:25:45, 68.60s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [52:10<1:22:46, 67.12s/it]EarlyStopping counter : 8 out of 12
training process:  43%|████▎     | 55/128 [53:11<1:19:37, 65.45s/it]EarlyStopping counter : 9 out of 12
training process:  44%|████▍     | 56/128 [54:14<1:17:37, 64.68s/it]EarlyStopping counter : 10 out of 12
epoch : 57, train loss : 0.010, valid loss : 0.013, train acc : 0.940, valid acc : 0.945, train f1 : 0.829, valid f1 : 0.842
training process:  45%|████▍     | 57/128 [55:32<1:21:16, 68.68s/it]EarlyStopping counter : 11 out of 12
training process:  45%|████▍     | 57/128 [56:35<1:10:30, 59.58s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 57, best f1 score : 0.849
training process finished, best loss : 0.014 and best acc : 0.951, best f1 : 0.849, best epoch : 52

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.74      0.75      0.75       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.86      0.86      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.86, test loss : 0.883

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.13s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.20s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:15,  8.39s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:06,  8.36s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:58,  8.36s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:52,  8.71s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:59<00:42,  8.59s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:34,  8.54s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:16<00:25,  8.47s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:23<00:16,  8.17s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:31<00:08,  8.16s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.12s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.32s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 16%|█▌        | 49/306 [00:00<00:00, 489.28it/s] 33%|███▎      | 100/306 [00:00<00:00, 500.51it/s] 50%|████▉     | 152/306 [00:00<00:00, 507.72it/s] 67%|██████▋   | 204/306 [00:00<00:00, 511.54it/s] 84%|████████▍ | 257/306 [00:00<00:00, 514.50it/s]100%|██████████| 306/306 [00:00<00:00, 516.29it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 573.59it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 574.74it/s]extract the null data:  31%|███▏      | 174/553 [00:00<00:00, 569.16it/s]extract the null data:  42%|████▏     | 234/553 [00:00<00:00, 579.00it/s]extract the null data:  54%|█████▍    | 298/553 [00:00<00:00, 597.63it/s]extract the null data:  66%|██████▌   | 363/553 [00:00<00:00, 614.78it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 625.49it/s]extract the null data:  89%|████████▉ | 491/553 [00:00<00:00, 623.14it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 605.53it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 187.53it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 193.47it/s]replace nan value:  11%|█         | 61/553 [00:00<00:02, 202.82it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 208.78it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 211.82it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 211.32it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:01, 212.01it/s]replace nan value:  31%|███       | 171/553 [00:00<00:01, 212.19it/s]replace nan value:  35%|███▍      | 193/553 [00:00<00:01, 209.57it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 211.62it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 214.92it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 217.01it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 222.81it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 226.65it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:00, 230.24it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:00, 232.72it/s]replace nan value:  69%|██████▉   | 382/553 [00:01<00:00, 236.65it/s]replace nan value:  74%|███████▎  | 407/553 [00:01<00:00, 239.69it/s]replace nan value:  78%|███████▊  | 431/553 [00:01<00:00, 238.61it/s]replace nan value:  82%|████████▏ | 455/553 [00:02<00:00, 198.35it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 195.11it/s]replace nan value:  90%|████████▉ | 497/553 [00:02<00:00, 194.17it/s]replace nan value:  94%|█████████▎| 518/553 [00:02<00:00, 196.82it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 202.48it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 212.76it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 147.92it/s]  5%|▌         | 30/553 [00:00<00:03, 147.25it/s]  8%|▊         | 45/553 [00:00<00:03, 131.04it/s] 11%|█         | 59/553 [00:00<00:04, 122.88it/s] 13%|█▎        | 72/553 [00:00<00:03, 123.37it/s] 16%|█▌        | 89/553 [00:00<00:03, 134.63it/s] 19%|█▊        | 103/553 [00:00<00:03, 132.72it/s] 22%|██▏       | 121/553 [00:00<00:02, 144.76it/s] 25%|██▍       | 136/553 [00:00<00:02, 144.47it/s] 28%|██▊       | 154/553 [00:01<00:02, 154.01it/s] 31%|███       | 172/553 [00:01<00:02, 159.09it/s] 34%|███▍      | 188/553 [00:01<00:02, 153.40it/s] 37%|███▋      | 207/553 [00:01<00:02, 163.33it/s] 41%|████      | 224/553 [00:01<00:02, 155.72it/s] 43%|████▎     | 240/553 [00:01<00:01, 156.75it/s] 46%|████▋     | 256/553 [00:01<00:02, 147.97it/s] 49%|████▉     | 271/553 [00:01<00:01, 144.00it/s] 52%|█████▏    | 286/553 [00:01<00:01, 145.45it/s] 54%|█████▍    | 301/553 [00:02<00:01, 141.18it/s] 57%|█████▋    | 316/553 [00:02<00:01, 135.27it/s] 60%|█████▉    | 330/553 [00:02<00:01, 135.73it/s] 62%|██████▏   | 345/553 [00:02<00:01, 136.26it/s] 65%|██████▍   | 359/553 [00:02<00:01, 130.98it/s] 68%|██████▊   | 376/553 [00:02<00:01, 137.25it/s] 71%|███████   | 390/553 [00:02<00:01, 127.38it/s] 73%|███████▎  | 404/553 [00:02<00:01, 130.58it/s] 76%|███████▌  | 418/553 [00:02<00:01, 127.18it/s] 78%|███████▊  | 431/553 [00:03<00:00, 124.25it/s] 81%|████████▏ | 450/553 [00:03<00:00, 141.26it/s] 84%|████████▍ | 465/553 [00:03<00:00, 141.86it/s] 87%|████████▋ | 480/553 [00:03<00:00, 137.39it/s] 89%|████████▉ | 494/553 [00:03<00:00, 133.05it/s] 92%|█████████▏| 509/553 [00:03<00:00, 136.65it/s] 95%|█████████▍| 523/553 [00:03<00:00, 129.38it/s] 97%|█████████▋| 537/553 [00:03<00:00, 120.96it/s]100%|█████████▉| 551/553 [00:04<00:00, 109.02it/s]100%|██████████| 553/553 [00:04<00:00, 135.72it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 31/139 [00:00<00:00, 306.30it/s]extract the null data:  67%|██████▋   | 93/139 [00:00<00:00, 487.47it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 504.41it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 225.33it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 226.58it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 222.40it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 219.32it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 217.55it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 216.50it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 218.81it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 11%|█         | 15/139 [00:00<00:00, 140.41it/s] 22%|██▏       | 31/139 [00:00<00:00, 151.27it/s] 35%|███▍      | 48/139 [00:00<00:00, 158.53it/s] 46%|████▌     | 64/139 [00:00<00:00, 150.97it/s] 58%|█████▊    | 80/139 [00:00<00:00, 145.57it/s] 68%|██████▊   | 95/139 [00:00<00:00, 135.22it/s] 78%|███████▊  | 109/139 [00:00<00:00, 133.94it/s] 91%|█████████▏| 127/139 [00:00<00:00, 145.71it/s]100%|██████████| 139/139 [00:00<00:00, 146.04it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▍       | 43/173 [00:00<00:00, 429.60it/s]extract the null data:  65%|██████▍   | 112/173 [00:00<00:00, 580.61it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 581.82it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 213.13it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 209.96it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 212.55it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 221.59it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 225.44it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 221.53it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 216.75it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 215.92it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.19it/s] 16%|█▌        | 28/173 [00:00<00:01, 123.17it/s] 25%|██▍       | 43/173 [00:00<00:00, 134.20it/s] 34%|███▍      | 59/173 [00:00<00:00, 142.14it/s] 43%|████▎     | 74/173 [00:00<00:00, 141.39it/s] 51%|█████▏    | 89/173 [00:00<00:00, 137.42it/s] 60%|█████▉    | 103/173 [00:00<00:00, 134.28it/s] 68%|██████▊   | 118/173 [00:00<00:00, 135.33it/s] 76%|███████▋  | 132/173 [00:00<00:00, 130.82it/s] 84%|████████▍ | 146/173 [00:01<00:00, 131.35it/s] 92%|█████████▏| 160/173 [00:01<00:00, 121.78it/s]100%|██████████| 173/173 [00:01<00:00, 92.77it/s] 100%|██████████| 173/173 [00:01<00:00, 119.48it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.048, valid loss : 0.043, train acc : 0.508, valid acc : 0.086, train f1 : 0.395, valid f1 : 0.080
training process:   1%|          | 1/128 [00:58<2:03:07, 58.17s/it]Best score increase :0.000 -> 0.080
training process:   2%|▏         | 2/128 [01:46<1:49:52, 52.32s/it]Best score increase :0.080 -> 0.166
training process:   2%|▏         | 3/128 [02:34<1:45:19, 50.55s/it]Best score increase :0.166 -> 0.300
training process:   3%|▎         | 4/128 [03:23<1:42:42, 49.69s/it]Best score increase :0.300 -> 0.361
epoch : 5, train loss : 0.027, valid loss : 0.031, train acc : 0.664, valid acc : 0.371, train f1 : 0.624, valid f1 : 0.343
training process:   4%|▍         | 5/128 [04:21<1:48:31, 52.94s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:10<1:44:50, 51.56s/it]Best score increase :0.361 -> 0.392
training process:   5%|▌         | 7/128 [05:59<1:41:54, 50.53s/it]Best score increase :0.392 -> 0.426
training process:   6%|▋         | 8/128 [06:51<1:42:05, 51.05s/it]Best score increase :0.426 -> 0.449
epoch : 9, train loss : 0.021, valid loss : 0.024, train acc : 0.731, valid acc : 0.539, train f1 : 0.713, valid f1 : 0.463
training process:   7%|▋         | 9/128 [07:51<1:46:53, 53.90s/it]Best score increase :0.449 -> 0.463
training process:   8%|▊         | 10/128 [08:40<1:42:50, 52.29s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:29<1:40:12, 51.39s/it]Best score increase :0.463 -> 0.516
training process:   9%|▉         | 12/128 [10:19<1:38:33, 50.98s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.019, valid loss : 0.019, train acc : 0.772, valid acc : 0.644, train f1 : 0.760, valid f1 : 0.535
training process:  10%|█         | 13/128 [11:17<1:41:50, 53.14s/it]Best score increase :0.516 -> 0.535
training process:  11%|█         | 14/128 [12:04<1:37:29, 51.31s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [12:52<1:34:42, 50.29s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [13:43<1:33:54, 50.31s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.018, valid loss : 0.020, train acc : 0.800, valid acc : 0.617, train f1 : 0.793, valid f1 : 0.517
training process:  13%|█▎        | 17/128 [14:40<1:36:52, 52.36s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [15:31<1:35:34, 52.13s/it]Best score increase :0.535 -> 0.572
training process:  15%|█▍        | 19/128 [16:21<1:33:30, 51.47s/it]Best score increase :0.572 -> 0.585
training process:  16%|█▌        | 20/128 [17:16<1:34:10, 52.32s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.017, valid loss : 0.016, train acc : 0.814, valid acc : 0.731, train f1 : 0.809, valid f1 : 0.599
training process:  16%|█▋        | 21/128 [18:13<1:36:14, 53.97s/it]Best score increase :0.585 -> 0.599
training process:  17%|█▋        | 22/128 [19:07<1:34:55, 53.73s/it]Best score increase :0.599 -> 0.636
training process:  18%|█▊        | 23/128 [19:58<1:32:53, 53.08s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [20:51<1:31:47, 52.96s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.015, valid loss : 0.016, train acc : 0.834, valid acc : 0.745, train f1 : 0.830, valid f1 : 0.610
training process:  20%|█▉        | 25/128 [21:53<1:35:34, 55.67s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [22:42<1:31:22, 53.75s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [23:30<1:27:26, 51.94s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [24:18<1:24:52, 50.92s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.015, valid loss : 0.018, train acc : 0.843, valid acc : 0.697, train f1 : 0.840, valid f1 : 0.574
training process:  23%|██▎       | 29/128 [25:21<1:29:40, 54.35s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [26:13<1:27:50, 53.78s/it]EarlyStopping counter : 8 out of 12
training process:  24%|██▍       | 31/128 [27:01<1:23:52, 51.88s/it]EarlyStopping counter : 9 out of 12
training process:  25%|██▌       | 32/128 [27:49<1:21:18, 50.82s/it]EarlyStopping counter : 10 out of 12
epoch : 33, train loss : 0.014, valid loss : 0.016, train acc : 0.853, valid acc : 0.778, train f1 : 0.851, valid f1 : 0.639
training process:  26%|██▌       | 33/128 [28:52<1:26:30, 54.63s/it]Best score increase :0.636 -> 0.639
training process:  27%|██▋       | 34/128 [29:49<1:26:41, 55.34s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [30:42<1:24:25, 54.47s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [31:32<1:21:35, 53.22s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.014, valid loss : 0.015, train acc : 0.862, valid acc : 0.815, train f1 : 0.860, valid f1 : 0.673
training process:  29%|██▉       | 37/128 [32:40<1:27:21, 57.60s/it]Best score increase :0.639 -> 0.673
training process:  30%|██▉       | 38/128 [33:36<1:25:33, 57.04s/it]Best score increase :0.673 -> 0.695
training process:  30%|███       | 39/128 [34:31<1:24:00, 56.64s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [35:28<1:22:56, 56.55s/it]Best score increase :0.695 -> 0.707
epoch : 41, train loss : 0.014, valid loss : 0.019, train acc : 0.860, valid acc : 0.706, train f1 : 0.858, valid f1 : 0.582
training process:  32%|███▏      | 41/128 [36:34<1:26:03, 59.35s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [37:30<1:23:35, 58.32s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [38:26<1:21:41, 57.67s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [39:30<1:23:41, 59.78s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.013, valid loss : 0.016, train acc : 0.873, valid acc : 0.780, train f1 : 0.871, valid f1 : 0.641
training process:  35%|███▌      | 45/128 [40:47<1:29:28, 64.68s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [41:56<1:30:31, 66.23s/it]EarlyStopping counter : 6 out of 12
training process:  37%|███▋      | 47/128 [42:56<1:26:47, 64.28s/it]EarlyStopping counter : 7 out of 12
training process:  38%|███▊      | 48/128 [43:53<1:22:34, 61.93s/it]EarlyStopping counter : 8 out of 12
epoch : 49, train loss : 0.013, valid loss : 0.015, train acc : 0.873, valid acc : 0.851, train f1 : 0.872, valid f1 : 0.710
training process:  38%|███▊      | 49/128 [45:00<1:23:49, 63.66s/it]Best score increase :0.707 -> 0.710
training process:  39%|███▉      | 50/128 [45:55<1:19:23, 61.07s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [46:53<1:16:58, 59.98s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [47:49<1:14:41, 58.97s/it]Best score increase :0.710 -> 0.726
epoch : 53, train loss : 0.013, valid loss : 0.014, train acc : 0.879, valid acc : 0.852, train f1 : 0.878, valid f1 : 0.713
training process:  41%|████▏     | 53/128 [49:00<1:18:07, 62.50s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [49:57<1:15:00, 60.81s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [50:47<1:10:06, 57.62s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [51:41<1:07:38, 56.36s/it]Best score increase :0.726 -> 0.736
epoch : 57, train loss : 0.012, valid loss : 0.014, train acc : 0.881, valid acc : 0.854, train f1 : 0.880, valid f1 : 0.715
training process:  45%|████▍     | 57/128 [52:47<1:10:23, 59.49s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [53:44<1:08:33, 58.76s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 59/128 [54:41<1:06:52, 58.15s/it]EarlyStopping counter : 3 out of 12
training process:  47%|████▋     | 60/128 [55:39<1:05:42, 57.98s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.012, valid loss : 0.014, train acc : 0.884, valid acc : 0.891, train f1 : 0.882, valid f1 : 0.761
training process:  48%|████▊     | 61/128 [56:46<1:07:50, 60.75s/it]Best score increase :0.736 -> 0.761
training process:  48%|████▊     | 62/128 [57:44<1:05:58, 59.97s/it]EarlyStopping counter : 1 out of 12
training process:  49%|████▉     | 63/128 [58:43<1:04:34, 59.61s/it]EarlyStopping counter : 2 out of 12
training process:  50%|█████     | 64/128 [59:39<1:02:25, 58.53s/it]EarlyStopping counter : 3 out of 12
epoch : 65, train loss : 0.012, valid loss : 0.015, train acc : 0.889, valid acc : 0.838, train f1 : 0.888, valid f1 : 0.697
training process:  51%|█████     | 65/128 [1:00:42<1:02:58, 59.98s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 66/128 [1:01:41<1:01:29, 59.50s/it]EarlyStopping counter : 5 out of 12
training process:  52%|█████▏    | 67/128 [1:02:30<57:32, 56.59s/it]  EarlyStopping counter : 6 out of 12
training process:  53%|█████▎    | 68/128 [1:03:20<54:22, 54.38s/it]EarlyStopping counter : 7 out of 12
epoch : 69, train loss : 0.012, valid loss : 0.014, train acc : 0.889, valid acc : 0.885, train f1 : 0.888, valid f1 : 0.754
training process:  54%|█████▍    | 69/128 [1:04:17<54:23, 55.31s/it]EarlyStopping counter : 8 out of 12
training process:  55%|█████▍    | 70/128 [1:05:09<52:27, 54.27s/it]EarlyStopping counter : 9 out of 12
training process:  55%|█████▌    | 71/128 [1:05:58<50:01, 52.66s/it]Best score increase :0.761 -> 0.789
training process:  56%|█████▋    | 72/128 [1:06:46<47:46, 51.19s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.012, valid loss : 0.016, train acc : 0.890, valid acc : 0.814, train f1 : 0.889, valid f1 : 0.675
training process:  57%|█████▋    | 73/128 [1:07:42<48:26, 52.84s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:08:32<46:40, 51.86s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▊    | 75/128 [1:09:20<44:49, 50.74s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▉    | 76/128 [1:10:07<42:56, 49.56s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.012, valid loss : 0.015, train acc : 0.891, valid acc : 0.846, train f1 : 0.890, valid f1 : 0.708
training process:  60%|██████    | 77/128 [1:11:04<44:10, 51.96s/it]EarlyStopping counter : 6 out of 12
training process:  61%|██████    | 78/128 [1:11:52<42:19, 50.78s/it]EarlyStopping counter : 7 out of 12
training process:  62%|██████▏   | 79/128 [1:12:41<41:01, 50.24s/it]EarlyStopping counter : 8 out of 12
training process:  62%|██████▎   | 80/128 [1:13:31<40:04, 50.10s/it]EarlyStopping counter : 9 out of 12
epoch : 81, train loss : 0.011, valid loss : 0.015, train acc : 0.892, valid acc : 0.881, train f1 : 0.892, valid f1 : 0.748
training process:  63%|██████▎   | 81/128 [1:14:29<41:02, 52.39s/it]EarlyStopping counter : 10 out of 12
training process:  64%|██████▍   | 82/128 [1:15:18<39:18, 51.28s/it]EarlyStopping counter : 11 out of 12
training process:  64%|██████▍   | 82/128 [1:16:06<42:41, 55.69s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 82, best f1 score : 0.789
training process finished, best loss : 0.015 and best acc : 0.913, best f1 : 0.789, best epoch : 70

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.45      0.86      0.59       580
           1       0.99      0.91      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.72      0.89      0.77      7398
weighted avg       0.95      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.77, test AUC : 0.89, test loss : 0.796

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.72s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.74s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:12,  8.07s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.08s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:56,  8.09s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.03s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.80s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.84s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.76s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.81s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.83s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.91s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|▉         | 30/306 [00:00<00:00, 292.50it/s] 27%|██▋       | 82/306 [00:00<00:00, 423.24it/s] 41%|████      | 125/306 [00:00<00:00, 403.58it/s] 54%|█████▍    | 166/306 [00:00<00:00, 347.00it/s] 66%|██████▌   | 202/306 [00:00<00:00, 340.94it/s] 78%|███████▊  | 239/306 [00:00<00:00, 341.54it/s] 90%|████████▉ | 274/306 [00:00<00:00, 319.67it/s]100%|██████████| 306/306 [00:00<00:00, 338.92it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 445.40it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 454.79it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:00, 455.25it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 458.08it/s]extract the null data:  42%|████▏     | 231/553 [00:00<00:00, 458.10it/s]extract the null data:  50%|█████     | 277/553 [00:00<00:00, 458.58it/s]extract the null data:  58%|█████▊    | 323/553 [00:00<00:00, 458.03it/s]extract the null data:  67%|██████▋   | 369/553 [00:00<00:00, 449.48it/s]extract the null data:  75%|███████▌  | 415/553 [00:00<00:00, 451.57it/s]extract the null data:  84%|████████▎ | 462/553 [00:01<00:00, 454.41it/s]extract the null data:  92%|█████████▏| 508/553 [00:01<00:00, 455.65it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 454.78it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 165.30it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 167.42it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 166.79it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 167.09it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 166.47it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 166.94it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 169.40it/s]replace nan value:  25%|██▍       | 138/553 [00:00<00:02, 169.83it/s]replace nan value:  28%|██▊       | 156/553 [00:00<00:02, 170.83it/s]replace nan value:  31%|███▏      | 174/553 [00:01<00:02, 170.57it/s]replace nan value:  35%|███▍      | 192/553 [00:01<00:02, 170.93it/s]replace nan value:  38%|███▊      | 210/553 [00:01<00:01, 171.60it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 170.75it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 170.05it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 170.71it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 173.69it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 173.30it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:01, 173.43it/s]replace nan value:  61%|██████    | 337/553 [00:01<00:01, 172.70it/s]replace nan value:  64%|██████▍   | 355/553 [00:02<00:01, 171.16it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:01, 171.82it/s]replace nan value:  71%|███████   | 391/553 [00:02<00:00, 171.48it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 171.53it/s]replace nan value:  77%|███████▋  | 427/553 [00:02<00:00, 170.75it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 171.74it/s]replace nan value:  84%|████████▎ | 463/553 [00:02<00:00, 171.70it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 171.94it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 171.33it/s]replace nan value:  93%|█████████▎| 517/553 [00:03<00:00, 170.59it/s]replace nan value:  97%|█████████▋| 535/553 [00:03<00:00, 170.45it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 169.70it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 170.59it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.31it/s]  5%|▍         | 26/553 [00:00<00:04, 130.98it/s]  7%|▋         | 40/553 [00:00<00:03, 130.68it/s] 10%|▉         | 54/553 [00:00<00:04, 119.04it/s] 12%|█▏        | 67/553 [00:00<00:04, 111.57it/s] 14%|█▍        | 80/553 [00:00<00:04, 117.03it/s] 17%|█▋        | 93/553 [00:00<00:03, 120.62it/s] 19%|█▉        | 107/553 [00:00<00:03, 126.29it/s] 22%|██▏       | 122/553 [00:00<00:03, 128.53it/s] 25%|██▍       | 137/553 [00:01<00:03, 134.43it/s] 28%|██▊       | 153/553 [00:01<00:02, 140.18it/s] 31%|███       | 169/553 [00:01<00:02, 145.00it/s] 33%|███▎      | 184/553 [00:01<00:02, 141.39it/s] 36%|███▋      | 201/553 [00:01<00:02, 147.65it/s] 39%|███▉      | 216/553 [00:01<00:02, 147.19it/s] 42%|████▏     | 231/553 [00:01<00:02, 137.68it/s] 44%|████▍     | 245/553 [00:01<00:02, 138.22it/s] 47%|████▋     | 260/553 [00:01<00:02, 141.15it/s] 50%|████▉     | 275/553 [00:02<00:02, 135.89it/s] 52%|█████▏    | 290/553 [00:02<00:01, 137.61it/s] 55%|█████▍    | 304/553 [00:02<00:01, 129.70it/s] 58%|█████▊    | 318/553 [00:02<00:01, 121.57it/s] 60%|█████▉    | 331/553 [00:02<00:01, 123.60it/s] 62%|██████▏   | 345/553 [00:02<00:01, 124.76it/s] 65%|██████▍   | 358/553 [00:02<00:01, 123.79it/s] 67%|██████▋   | 373/553 [00:02<00:01, 130.14it/s] 70%|██████▉   | 387/553 [00:02<00:01, 121.56it/s] 72%|███████▏  | 400/553 [00:03<00:01, 114.32it/s] 75%|███████▌  | 415/553 [00:03<00:01, 121.05it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.38it/s] 80%|████████  | 445/553 [00:03<00:00, 126.46it/s] 83%|████████▎ | 460/553 [00:03<00:00, 131.12it/s] 86%|████████▌ | 474/553 [00:03<00:00, 133.15it/s] 88%|████████▊ | 488/553 [00:03<00:00, 127.57it/s] 91%|█████████ | 501/553 [00:03<00:00, 119.13it/s] 93%|█████████▎| 516/553 [00:04<00:00, 125.50it/s] 96%|█████████▌| 529/553 [00:04<00:00, 112.46it/s] 98%|█████████▊| 541/553 [00:04<00:00, 113.44it/s]100%|██████████| 553/553 [00:04<00:00, 99.06it/s] 100%|██████████| 553/553 [00:04<00:00, 124.98it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 287.17it/s]extract the null data:  61%|██████    | 85/139 [00:00<00:00, 444.04it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 486.24it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 458.76it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 189.85it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 194.21it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 190.08it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 190.42it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 190.04it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 190.55it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 188.95it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 189.88it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.13it/s] 17%|█▋        | 24/139 [00:00<00:00, 116.28it/s] 27%|██▋       | 37/139 [00:00<00:00, 122.12it/s] 36%|███▌      | 50/139 [00:00<00:00, 121.93it/s] 45%|████▌     | 63/139 [00:00<00:00, 118.80it/s] 54%|█████▍    | 75/139 [00:00<00:00, 118.38it/s] 63%|██████▎   | 87/139 [00:00<00:00, 108.24it/s] 71%|███████   | 99/139 [00:00<00:00, 108.81it/s] 80%|███████▉  | 111/139 [00:00<00:00, 111.04it/s] 91%|█████████ | 126/139 [00:01<00:00, 118.79it/s]100%|██████████| 139/139 [00:01<00:00, 121.16it/s]100%|██████████| 139/139 [00:01<00:00, 116.88it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 317.89it/s]extract the null data:  52%|█████▏    | 90/173 [00:00<00:00, 467.49it/s]extract the null data:  82%|████████▏ | 142/173 [00:00<00:00, 490.10it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 478.48it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 184.99it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 188.59it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 186.62it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 186.43it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 188.59it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 186.76it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 185.64it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 185.46it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 185.44it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 186.15it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.26it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.27it/s] 24%|██▎       | 41/173 [00:00<00:01, 120.60it/s] 32%|███▏      | 55/173 [00:00<00:00, 125.84it/s] 39%|███▉      | 68/173 [00:00<00:00, 126.24it/s] 47%|████▋     | 81/173 [00:00<00:00, 126.74it/s] 55%|█████▍    | 95/173 [00:00<00:00, 127.16it/s] 62%|██████▏   | 108/173 [00:00<00:00, 126.81it/s] 70%|██████▉   | 121/173 [00:00<00:00, 126.83it/s] 77%|███████▋  | 134/173 [00:01<00:00, 121.39it/s] 85%|████████▍ | 147/173 [00:01<00:00, 121.34it/s] 92%|█████████▏| 160/173 [00:01<00:00, 109.06it/s] 99%|█████████▉| 172/173 [00:01<00:00, 82.61it/s] 100%|██████████| 173/173 [00:01<00:00, 109.65it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.093, valid loss : 0.081, train f1 : 0.513, valid f1 : 0.504
training process - Deferred Re-weighting:   1%|          | 1/128 [00:41<1:28:38, 41.88s/it]Best score increase :0.000 -> 0.504
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:29<1:35:22, 45.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:22<1:41:15, 48.60s/it]Best score increase :0.504 -> 0.523
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:10<1:40:19, 48.55s/it]Best score increase :0.523 -> 0.598
epoch : 5, train loss : 0.057, valid loss : 0.060, train f1 : 0.644, valid f1 : 0.687
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:10<1:47:33, 52.47s/it]Best score increase :0.598 -> 0.687
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:00<1:45:32, 51.90s/it]Best score increase :0.687 -> 0.718
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:51<1:43:43, 51.43s/it]Best score increase :0.718 -> 0.736
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:39<1:41:03, 50.53s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.047, valid loss : 0.053, train f1 : 0.763, valid f1 : 0.786
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:37<1:44:17, 52.58s/it]Best score increase :0.736 -> 0.786
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:26<1:41:24, 51.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:16<1:39:45, 51.16s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:07<1:38:41, 51.04s/it]Best score increase :0.786 -> 0.801
epoch : 13, train loss : 0.042, valid loss : 0.048, train f1 : 0.807, valid f1 : 0.772
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:06<1:42:42, 53.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [11:56<1:39:31, 52.38s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:47<1:37:55, 52.00s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:37<1:35:42, 51.28s/it]Best score increase :0.801 -> 0.807
epoch : 17, train loss : 0.040, valid loss : 0.049, train f1 : 0.822, valid f1 : 0.774
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:36<1:39:09, 53.60s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:27<1:37:00, 52.91s/it]Best score increase :0.807 -> 0.811
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:19<1:35:46, 52.72s/it]Best score increase :0.811 -> 0.815
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:10<1:34:01, 52.23s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.038, valid loss : 0.041, train f1 : 0.826, valid f1 : 0.822
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:09<1:36:48, 54.29s/it]Best score increase :0.815 -> 0.822
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:01<1:34:28, 53.48s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:53<1:33:00, 53.14s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:46<1:31:39, 52.88s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.036, valid loss : 0.042, train f1 : 0.840, valid f1 : 0.816
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:46<1:34:26, 55.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:39<1:32:34, 54.46s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:30<1:29:59, 53.46s/it]Best score increase :0.822 -> 0.827
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:21<1:27:44, 52.65s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.033, valid loss : 0.042, train f1 : 0.847, valid f1 : 0.810
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:21<1:30:31, 54.86s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:10<1:27:06, 53.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:02<1:25:13, 52.72s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:54<1:24:10, 52.61s/it]Best score increase :0.827 -> 0.834
epoch : 33, train loss : 0.032, valid loss : 0.036, train f1 : 0.852, valid f1 : 0.835
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [28:54<1:26:48, 54.82s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:45<1:23:57, 53.59s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:36<1:21:58, 52.89s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:27<1:20:01, 52.19s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.032, valid loss : 0.038, train f1 : 0.856, valid f1 : 0.826
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:24<1:21:40, 53.85s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:14<1:18:41, 52.47s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:03<1:16:39, 51.68s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [34:55<1:15:42, 51.62s/it]Best score increase :0.834 -> 0.841
epoch : 41, train loss : 0.031, valid loss : 0.043, train f1 : 0.860, valid f1 : 0.813
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [35:54<1:17:58, 53.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:46<1:16:22, 53.28s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:37<1:14:45, 52.77s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:29<1:13:18, 52.37s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.030, valid loss : 0.037, train f1 : 0.863, valid f1 : 0.843
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [39:27<1:14:54, 54.15s/it]Best score increase :0.841 -> 0.843
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [40:18<1:12:45, 53.24s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:10<1:11:06, 52.67s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [41:59<1:08:58, 51.73s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.029, valid loss : 0.046, train f1 : 0.868, valid f1 : 0.804
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [42:56<1:10:10, 53.29s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [43:49<1:09:15, 53.27s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [44:41<1:07:36, 52.68s/it]Best score increase :0.843 -> 0.846
training process - Deferred Re-weighting:  41%|████      | 52/128 [45:32<1:06:24, 52.43s/it]EarlyStopping counter : 1 out of 12
epoch : 53, train loss : 0.028, valid loss : 0.036, train f1 : 0.869, valid f1 : 0.843
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [46:32<1:08:03, 54.45s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [47:22<1:05:43, 53.29s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [48:14<1:04:11, 52.76s/it]Best score increase :0.846 -> 0.849
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [49:04<1:02:24, 52.01s/it]Best score increase :0.849 -> 0.863
epoch : 57, train loss : 0.027, valid loss : 0.034, train f1 : 0.879, valid f1 : 0.857
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [50:03<1:04:05, 54.17s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [50:53<1:01:37, 52.82s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [51:44<1:00:12, 52.35s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [52:35<58:57, 52.02s/it]  EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.026, valid loss : 0.046, train f1 : 0.880, valid f1 : 0.823
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [53:34<1:00:22, 54.07s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [54:26<58:49, 53.47s/it]  EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [55:18<57:15, 52.85s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [56:08<55:38, 52.16s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.026, valid loss : 0.036, train f1 : 0.880, valid f1 : 0.843
training process - Deferred Re-weighting:  51%|█████     | 65/128 [57:07<57:00, 54.30s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [58:00<55:28, 53.68s/it]Best score increase :0.863 -> 0.867
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [58:52<54:08, 53.25s/it]Best score increase :0.867 -> 0.871
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [59:42<52:19, 52.32s/it]EarlyStopping counter : 1 out of 12
epoch : 69, train loss : 0.025, valid loss : 0.034, train f1 : 0.883, valid f1 : 0.853
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:00:42<53:40, 54.58s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:01:34<52:02, 53.83s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:02:25<50:22, 53.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:03:16<48:46, 52.25s/it]EarlyStopping counter : 5 out of 12
epoch : 73, train loss : 0.026, valid loss : 0.034, train f1 : 0.882, valid f1 : 0.857
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:04:17<50:16, 54.85s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:05:09<48:39, 54.07s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:06:01<47:12, 53.45s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:06:52<45:50, 52.90s/it]EarlyStopping counter : 9 out of 12
epoch : 77, train loss : 0.025, valid loss : 0.033, train f1 : 0.891, valid f1 : 0.864
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:07:53<46:59, 55.28s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:08:46<45:18, 54.37s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:09:36<44:37, 53.55s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 78, best f1 score : 0.871
training process finished, best loss : 0.032, best acc : 0.963, best f1 : 0.871, best epoch : 66

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.71      0.67       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.80      0.84      0.82      7398
weighted avg       0.95      0.94      0.95      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.84, test loss : 2.707

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.71s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.93s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.99s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.78s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.68s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:45,  7.65s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.69s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.62s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:22,  7.56s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.54s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.40s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.25s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.55s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  9%|▉         | 29/306 [00:00<00:00, 282.10it/s] 20%|█▉        | 60/306 [00:00<00:00, 297.56it/s] 29%|██▉       | 90/306 [00:00<00:00, 266.59it/s] 39%|███▊      | 118/306 [00:00<00:00, 269.94it/s] 48%|████▊     | 148/306 [00:00<00:00, 279.87it/s] 58%|█████▊    | 177/306 [00:00<00:00, 274.05it/s] 67%|██████▋   | 205/306 [00:00<00:00, 263.32it/s] 76%|███████▋  | 234/306 [00:00<00:00, 270.65it/s] 86%|████████▌ | 262/306 [00:00<00:00, 262.66it/s] 95%|█████████▌| 291/306 [00:01<00:00, 264.29it/s]100%|██████████| 306/306 [00:01<00:00, 273.11it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 557.92it/s]extract the null data:  21%|██        | 115/553 [00:00<00:00, 576.39it/s]extract the null data:  31%|███▏      | 173/553 [00:00<00:00, 575.87it/s]extract the null data:  42%|████▏     | 232/553 [00:00<00:00, 579.08it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 580.03it/s]extract the null data:  63%|██████▎   | 350/553 [00:00<00:00, 580.06it/s]extract the null data:  74%|███████▍  | 409/553 [00:00<00:00, 577.90it/s]extract the null data:  84%|████████▍ | 467/553 [00:00<00:00, 576.64it/s]extract the null data:  96%|█████████▌| 529/553 [00:00<00:00, 587.79it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 581.82it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 206.11it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:02, 209.33it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 209.00it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 208.91it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 207.46it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 206.02it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:01, 206.73it/s]replace nan value:  31%|███       | 171/553 [00:00<00:01, 210.23it/s]replace nan value:  35%|███▌      | 194/553 [00:00<00:01, 213.55it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 217.63it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 215.15it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 204.10it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 190.37it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 182.61it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 177.00it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 172.50it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:01, 169.05it/s]replace nan value:  68%|██████▊   | 374/553 [00:01<00:01, 166.66it/s]replace nan value:  71%|███████   | 391/553 [00:02<00:00, 164.02it/s]replace nan value:  74%|███████▍  | 408/553 [00:02<00:00, 164.84it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 162.36it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 162.30it/s]replace nan value:  83%|████████▎ | 459/553 [00:02<00:00, 162.39it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 161.70it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 161.13it/s]replace nan value:  92%|█████████▏| 510/553 [00:02<00:00, 160.20it/s]replace nan value:  95%|█████████▌| 527/553 [00:02<00:00, 158.58it/s]replace nan value:  98%|█████████▊| 544/553 [00:03<00:00, 159.40it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 180.44it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 117.06it/s]  5%|▍         | 26/553 [00:00<00:04, 127.11it/s]  7%|▋         | 40/553 [00:00<00:04, 126.82it/s] 10%|▉         | 53/553 [00:00<00:04, 116.92it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.09it/s] 14%|█▍        | 78/553 [00:00<00:04, 113.34it/s] 16%|█▋        | 91/553 [00:00<00:03, 117.24it/s] 19%|█▊        | 103/553 [00:00<00:03, 117.89it/s] 22%|██▏       | 119/553 [00:00<00:03, 128.71it/s] 24%|██▍       | 132/553 [00:01<00:03, 123.99it/s] 27%|██▋       | 148/553 [00:01<00:03, 132.29it/s] 29%|██▉       | 163/553 [00:01<00:02, 135.80it/s] 32%|███▏      | 178/553 [00:01<00:02, 137.41it/s] 35%|███▍      | 193/553 [00:01<00:02, 140.77it/s] 38%|███▊      | 209/553 [00:01<00:02, 146.36it/s] 41%|████      | 224/553 [00:01<00:02, 136.27it/s] 43%|████▎     | 239/553 [00:01<00:02, 138.23it/s] 46%|████▌     | 253/553 [00:01<00:02, 134.39it/s] 48%|████▊     | 267/553 [00:02<00:02, 131.92it/s] 51%|█████     | 281/553 [00:02<00:02, 130.79it/s] 53%|█████▎    | 295/553 [00:02<00:02, 127.47it/s] 56%|█████▌    | 308/553 [00:02<00:01, 125.27it/s] 58%|█████▊    | 321/553 [00:02<00:01, 122.44it/s] 61%|██████    | 335/553 [00:02<00:01, 125.46it/s] 63%|██████▎   | 348/553 [00:02<00:01, 124.58it/s] 65%|██████▌   | 361/553 [00:02<00:01, 119.46it/s] 68%|██████▊   | 376/553 [00:02<00:01, 126.51it/s] 70%|███████   | 389/553 [00:03<00:01, 121.06it/s] 73%|███████▎  | 402/553 [00:03<00:01, 115.24it/s] 75%|███████▌  | 416/553 [00:03<00:01, 116.52it/s] 77%|███████▋  | 428/553 [00:03<00:01, 111.51it/s] 80%|████████  | 445/553 [00:03<00:00, 125.74it/s] 83%|████████▎ | 460/553 [00:03<00:00, 130.80it/s] 86%|████████▌ | 474/553 [00:03<00:00, 132.11it/s] 88%|████████▊ | 488/553 [00:03<00:00, 125.58it/s] 91%|█████████ | 501/553 [00:03<00:00, 118.76it/s] 93%|█████████▎| 516/553 [00:04<00:00, 125.40it/s] 96%|█████████▌| 529/553 [00:04<00:00, 112.16it/s] 98%|█████████▊| 541/553 [00:04<00:00, 113.20it/s]100%|██████████| 553/553 [00:04<00:00, 98.87it/s] 100%|██████████| 553/553 [00:04<00:00, 122.63it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 267.09it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 419.41it/s]extract the null data:  96%|█████████▌| 133/139 [00:00<00:00, 465.83it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 441.58it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 188.66it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 185.71it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 186.74it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 185.35it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 184.44it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 185.31it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 186.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 186.38it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.95it/s] 18%|█▊        | 25/139 [00:00<00:00, 118.88it/s] 28%|██▊       | 39/139 [00:00<00:00, 126.22it/s] 37%|███▋      | 52/139 [00:00<00:00, 118.34it/s] 47%|████▋     | 66/139 [00:00<00:00, 123.77it/s] 57%|█████▋    | 79/139 [00:00<00:00, 116.73it/s] 65%|██████▌   | 91/139 [00:00<00:00, 106.96it/s] 75%|███████▍  | 104/139 [00:00<00:00, 112.23it/s] 83%|████████▎ | 116/139 [00:01<00:00, 113.57it/s] 93%|█████████▎| 129/139 [00:01<00:00, 115.45it/s]100%|██████████| 139/139 [00:01<00:00, 116.73it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  11%|█         | 19/173 [00:00<00:00, 188.73it/s]extract the null data:  41%|████      | 71/173 [00:00<00:00, 381.23it/s]extract the null data:  72%|███████▏  | 124/173 [00:00<00:00, 446.09it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 433.04it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 181.05it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 182.98it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 184.40it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 180.05it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 175.93it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 174.75it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 172.07it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 170.10it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 168.99it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 173.11it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 129.81it/s] 15%|█▌        | 26/173 [00:00<00:01, 104.38it/s] 23%|██▎       | 39/173 [00:00<00:01, 112.36it/s] 31%|███       | 54/173 [00:00<00:00, 123.15it/s] 39%|███▉      | 68/173 [00:00<00:00, 126.18it/s] 48%|████▊     | 83/173 [00:00<00:00, 131.04it/s] 56%|█████▌    | 97/173 [00:00<00:00, 132.35it/s] 65%|██████▌   | 113/173 [00:00<00:00, 136.85it/s] 73%|███████▎  | 127/173 [00:00<00:00, 132.61it/s] 82%|████████▏ | 141/173 [00:01<00:00, 134.33it/s] 90%|████████▉ | 155/173 [00:01<00:00, 124.43it/s] 97%|█████████▋| 168/173 [00:01<00:00, 101.69it/s]100%|██████████| 173/173 [00:01<00:00, 115.98it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.157, valid loss : 0.129, train f1 : 0.643, valid f1 : 0.582
training process - Deferred Re-weighting:   1%|          | 1/128 [01:01<2:09:28, 61.17s/it]Best score increase :0.000 -> 0.582
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:45<1:47:49, 51.35s/it]Best score increase :0.582 -> 0.680
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:30<1:40:57, 48.46s/it]Best score increase :0.680 -> 0.717
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:17<1:38:32, 47.68s/it]Best score increase :0.717 -> 0.736
epoch : 5, train loss : 0.095, valid loss : 0.077, train f1 : 0.835, valid f1 : 0.758
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:09<1:41:16, 49.40s/it]Best score increase :0.736 -> 0.758
training process - Deferred Re-weighting:   5%|▍         | 6/128 [04:54<1:37:27, 47.93s/it]Best score increase :0.758 -> 0.790
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:40<1:35:23, 47.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:26<1:33:20, 46.67s/it]Best score increase :0.790 -> 0.809
epoch : 9, train loss : 0.082, valid loss : 0.065, train f1 : 0.864, valid f1 : 0.800
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:22<1:38:55, 49.87s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:12<1:37:41, 49.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:02<1:37:32, 50.02s/it]Best score increase :0.809 -> 0.813
training process - Deferred Re-weighting:   9%|▉         | 12/128 [09:54<1:37:25, 50.39s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.076, valid loss : 0.066, train f1 : 0.873, valid f1 : 0.792
training process - Deferred Re-weighting:  10%|█         | 13/128 [10:51<1:40:49, 52.60s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [11:41<1:38:26, 51.81s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:34<1:38:10, 52.13s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:24<1:35:44, 51.29s/it]Best score increase :0.813 -> 0.817
epoch : 17, train loss : 0.072, valid loss : 0.067, train f1 : 0.880, valid f1 : 0.788
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:21<1:38:24, 53.20s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:13<1:36:51, 52.83s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:06<1:35:42, 52.68s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [16:55<1:33:04, 51.71s/it]Best score increase :0.817 -> 0.826
epoch : 21, train loss : 0.069, valid loss : 0.058, train f1 : 0.888, valid f1 : 0.809
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [17:53<1:35:43, 53.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [18:44<1:33:26, 52.89s/it]Best score increase :0.826 -> 0.832
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:33<1:30:32, 51.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:22<1:27:49, 50.67s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.064, valid loss : 0.050, train f1 : 0.895, valid f1 : 0.823
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:20<1:31:12, 53.13s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:10<1:28:35, 52.12s/it]Best score increase :0.832 -> 0.838
training process - Deferred Re-weighting:  21%|██        | 27/128 [22:59<1:26:16, 51.25s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [23:51<1:25:40, 51.41s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.063, valid loss : 0.055, train f1 : 0.900, valid f1 : 0.814
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [24:49<1:27:48, 53.22s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [25:38<1:25:08, 52.13s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [26:26<1:21:58, 50.71s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:16<1:21:13, 50.77s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.061, valid loss : 0.043, train f1 : 0.904, valid f1 : 0.843
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [28:18<1:25:19, 53.89s/it]Best score increase :0.838 -> 0.843
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:11<1:24:16, 53.80s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:03<1:22:17, 53.09s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [30:53<1:19:55, 52.13s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.057, valid loss : 0.052, train f1 : 0.911, valid f1 : 0.815
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [31:55<1:23:32, 55.08s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [32:46<1:20:47, 53.86s/it]Best score increase :0.843 -> 0.847
training process - Deferred Re-weighting:  30%|███       | 39/128 [33:36<1:18:12, 52.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [34:26<1:16:26, 52.12s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.059, valid loss : 0.071, train f1 : 0.905, valid f1 : 0.757
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [35:26<1:18:49, 54.36s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:17<1:16:24, 53.31s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:08<1:14:46, 52.78s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:00<1:13:27, 52.47s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.055, valid loss : 0.040, train f1 : 0.912, valid f1 : 0.858
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [39:02<1:16:37, 55.39s/it]Best score increase :0.847 -> 0.858
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [39:54<1:14:04, 54.20s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [40:48<1:13:04, 54.14s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [41:39<1:11:05, 53.32s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.052, valid loss : 0.045, train f1 : 0.918, valid f1 : 0.840
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [42:38<1:12:29, 55.06s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [43:30<1:10:14, 54.03s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [44:22<1:08:29, 53.37s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [45:13<1:06:49, 52.76s/it]EarlyStopping counter : 7 out of 12
epoch : 53, train loss : 0.053, valid loss : 0.052, train f1 : 0.915, valid f1 : 0.815
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [46:14<1:09:01, 55.22s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [47:05<1:06:27, 53.88s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [47:55<1:04:07, 52.70s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [48:44<1:02:06, 51.75s/it]EarlyStopping counter : 11 out of 12
epoch : 57, train loss : 0.051, valid loss : 0.062, train f1 : 0.922, valid f1 : 0.790
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [49:43<1:03:56, 53.28s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 56, best f1 score : 0.858
training process finished, best loss : 0.040, best acc : 0.952, best f1 : 0.858, best epoch : 44

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.69      0.79      0.74       580
           1       0.98      0.97      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.84      0.88      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.88, test loss : 2.351

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.01s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.90s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.89s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.84s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.98s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.87s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.93s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.82s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.72s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.67s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.70s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.72s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.80s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 84.55it/s] 11%|█         | 34/306 [00:00<00:01, 173.59it/s] 17%|█▋        | 52/306 [00:00<00:01, 151.74it/s] 25%|██▍       | 76/306 [00:00<00:01, 178.61it/s] 31%|███       | 95/306 [00:00<00:01, 167.18it/s] 38%|███▊      | 117/306 [00:00<00:01, 178.75it/s] 44%|████▍     | 136/306 [00:00<00:00, 170.82it/s] 51%|█████▏    | 157/306 [00:00<00:00, 179.92it/s] 58%|█████▊    | 176/306 [00:01<00:00, 167.35it/s] 66%|██████▋   | 203/306 [00:01<00:00, 195.12it/s] 73%|███████▎  | 224/306 [00:01<00:00, 167.49it/s] 81%|████████▏ | 249/306 [00:01<00:00, 184.74it/s] 88%|████████▊ | 269/306 [00:01<00:00, 162.82it/s] 96%|█████████▌| 294/306 [00:01<00:00, 180.50it/s]100%|██████████| 306/306 [00:01<00:00, 166.89it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 445.70it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 451.92it/s]extract the null data:  25%|██▍       | 137/553 [00:00<00:00, 445.86it/s]extract the null data:  35%|███▍      | 191/553 [00:00<00:00, 482.01it/s]extract the null data:  46%|████▌     | 254/553 [00:00<00:00, 533.22it/s]extract the null data:  56%|█████▋    | 312/553 [00:00<00:00, 545.97it/s]extract the null data:  66%|██████▋   | 367/553 [00:00<00:00, 525.65it/s]extract the null data:  76%|███████▌  | 420/553 [00:00<00:00, 509.20it/s]extract the null data:  85%|████████▌ | 472/553 [00:00<00:00, 491.50it/s]extract the null data:  94%|█████████▍| 522/553 [00:01<00:00, 468.86it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 478.86it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 143.42it/s]replace nan value:   5%|▌         | 30/553 [00:00<00:03, 146.51it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:03, 148.42it/s]replace nan value:  11%|█         | 62/553 [00:00<00:03, 150.31it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:03, 150.38it/s]replace nan value:  17%|█▋        | 94/553 [00:00<00:03, 147.52it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:03, 147.48it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 147.76it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 149.14it/s]replace nan value:  28%|██▊       | 155/553 [00:01<00:02, 148.97it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 149.03it/s]replace nan value:  33%|███▎      | 185/553 [00:01<00:02, 146.60it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:02, 147.93it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:02, 150.19it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:02, 151.29it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 152.06it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 152.37it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 151.97it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 152.78it/s]replace nan value:  57%|█████▋    | 313/553 [00:02<00:01, 152.35it/s]replace nan value:  59%|█████▉    | 329/553 [00:02<00:01, 153.31it/s]replace nan value:  62%|██████▏   | 345/553 [00:02<00:01, 155.01it/s]replace nan value:  65%|██████▌   | 361/553 [00:02<00:01, 154.97it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:01, 158.85it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:01, 158.96it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 160.68it/s]replace nan value:  77%|███████▋  | 428/553 [00:02<00:00, 159.83it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 158.22it/s]replace nan value:  83%|████████▎ | 461/553 [00:03<00:00, 160.29it/s]replace nan value:  86%|████████▋ | 478/553 [00:03<00:00, 162.71it/s]replace nan value:  90%|████████▉ | 495/553 [00:03<00:00, 162.44it/s]replace nan value:  93%|█████████▎| 513/553 [00:03<00:00, 166.29it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 167.12it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 168.74it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 155.34it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.64it/s]  5%|▍         | 25/553 [00:00<00:04, 125.08it/s]  7%|▋         | 39/553 [00:00<00:03, 130.12it/s] 10%|▉         | 53/553 [00:00<00:04, 116.73it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.97it/s] 14%|█▍        | 78/553 [00:00<00:04, 114.28it/s] 16%|█▋        | 91/553 [00:00<00:03, 118.36it/s] 19%|█▉        | 104/553 [00:00<00:03, 120.69it/s] 22%|██▏       | 120/553 [00:00<00:03, 131.68it/s] 24%|██▍       | 134/553 [00:01<00:03, 129.54it/s] 27%|██▋       | 150/553 [00:01<00:02, 137.37it/s] 30%|███       | 167/553 [00:01<00:02, 145.07it/s] 33%|███▎      | 182/553 [00:01<00:02, 142.97it/s] 36%|███▌      | 197/553 [00:01<00:02, 144.94it/s] 39%|███▊      | 214/553 [00:01<00:02, 149.67it/s] 41%|████▏     | 229/553 [00:01<00:02, 141.53it/s] 44%|████▍     | 244/553 [00:01<00:02, 136.61it/s] 47%|████▋     | 258/553 [00:01<00:02, 137.35it/s] 49%|████▉     | 272/553 [00:02<00:02, 131.47it/s] 52%|█████▏    | 286/553 [00:02<00:02, 133.43it/s] 54%|█████▍    | 300/553 [00:02<00:01, 128.91it/s] 57%|█████▋    | 313/553 [00:02<00:01, 122.51it/s] 59%|█████▉    | 327/553 [00:02<00:01, 123.51it/s] 62%|██████▏   | 341/553 [00:02<00:01, 126.08it/s] 64%|██████▍   | 354/553 [00:02<00:01, 122.83it/s] 66%|██████▋   | 367/553 [00:02<00:01, 123.07it/s] 69%|██████▉   | 381/553 [00:02<00:01, 126.92it/s] 71%|███████   | 394/553 [00:03<00:01, 114.26it/s] 74%|███████▎  | 407/553 [00:03<00:01, 117.02it/s] 76%|███████▌  | 419/553 [00:03<00:01, 113.75it/s] 78%|███████▊  | 431/553 [00:03<00:01, 110.53it/s] 81%|████████  | 448/553 [00:03<00:00, 124.21it/s] 84%|████████▎ | 463/553 [00:03<00:00, 129.36it/s] 86%|████████▋ | 477/553 [00:03<00:00, 131.87it/s] 89%|████████▉ | 491/553 [00:03<00:00, 121.57it/s] 91%|█████████ | 504/553 [00:03<00:00, 120.18it/s] 94%|█████████▍| 519/553 [00:04<00:00, 125.02it/s] 96%|█████████▌| 532/553 [00:04<00:00, 105.13it/s] 99%|█████████▉| 548/553 [00:04<00:00, 116.60it/s]100%|██████████| 553/553 [00:04<00:00, 123.35it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 258.21it/s]extract the null data:  62%|██████▏   | 86/139 [00:00<00:00, 456.06it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 477.65it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 200.24it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 187.69it/s]replace nan value:  45%|████▍     | 62/139 [00:00<00:00, 190.61it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 199.39it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 194.21it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 190.46it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 192.23it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.34it/s] 17%|█▋        | 24/139 [00:00<00:00, 117.97it/s] 27%|██▋       | 38/139 [00:00<00:00, 126.28it/s] 37%|███▋      | 51/139 [00:00<00:00, 121.27it/s] 46%|████▌     | 64/139 [00:00<00:00, 120.67it/s] 55%|█████▌    | 77/139 [00:00<00:00, 116.19it/s] 64%|██████▍   | 89/139 [00:00<00:00, 104.75it/s] 74%|███████▍  | 103/139 [00:00<00:00, 113.08it/s] 83%|████████▎ | 115/139 [00:00<00:00, 114.23it/s] 93%|█████████▎| 129/139 [00:01<00:00, 120.72it/s]100%|██████████| 139/139 [00:01<00:00, 119.17it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   9%|▊         | 15/173 [00:00<00:01, 149.59it/s]extract the null data:  38%|███▊      | 66/173 [00:00<00:00, 358.53it/s]extract the null data:  66%|██████▋   | 115/173 [00:00<00:00, 417.96it/s]extract the null data:  94%|█████████▍| 163/173 [00:00<00:00, 439.37it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 406.24it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 179.23it/s]replace nan value:  21%|██▏       | 37/173 [00:00<00:00, 183.83it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 188.12it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 191.76it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 188.13it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 185.78it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 183.20it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 182.32it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 178.40it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 182.94it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.07it/s] 16%|█▌        | 27/173 [00:00<00:01, 114.29it/s] 23%|██▎       | 40/173 [00:00<00:01, 120.07it/s] 32%|███▏      | 55/173 [00:00<00:00, 126.79it/s] 39%|███▉      | 68/173 [00:00<00:00, 124.88it/s] 47%|████▋     | 81/173 [00:00<00:00, 123.85it/s] 54%|█████▍    | 94/173 [00:00<00:00, 124.81it/s] 62%|██████▏   | 107/173 [00:00<00:00, 124.84it/s] 70%|██████▉   | 121/173 [00:00<00:00, 127.66it/s] 77%|███████▋  | 134/173 [00:01<00:00, 120.83it/s] 85%|████████▍ | 147/173 [00:01<00:00, 120.10it/s] 92%|█████████▏| 160/173 [00:01<00:00, 108.25it/s] 99%|█████████▉| 172/173 [00:01<00:00, 81.33it/s] 100%|██████████| 173/173 [00:01<00:00, 108.62it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.008, train acc : 0.902, valid acc : 0.914, train f1 : 0.517, valid f1 : 0.500
training process:   1%|          | 1/128 [01:03<2:15:26, 63.98s/it]Best score increase :0.000 -> 0.500
training process:   2%|▏         | 2/128 [01:56<2:00:02, 57.16s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:47<1:53:46, 54.61s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:38<1:49:56, 53.20s/it]Best score increase :0.500 -> 0.505
epoch : 5, train loss : 0.005, valid loss : 0.005, train acc : 0.921, valid acc : 0.919, train f1 : 0.511, valid f1 : 0.543
training process:   4%|▍         | 5/128 [04:38<1:54:03, 55.64s/it]Best score increase :0.505 -> 0.543
training process:   5%|▍         | 6/128 [05:31<1:50:55, 54.56s/it]Best score increase :0.543 -> 0.585
training process:   5%|▌         | 7/128 [06:27<1:51:16, 55.18s/it]Best score increase :0.585 -> 0.632
training process:   6%|▋         | 8/128 [07:20<1:48:27, 54.23s/it]Best score increase :0.632 -> 0.662
epoch : 9, train loss : 0.004, valid loss : 0.004, train acc : 0.939, valid acc : 0.941, train f1 : 0.720, valid f1 : 0.751
training process:   7%|▋         | 9/128 [08:22<1:52:22, 56.66s/it]Best score increase :0.662 -> 0.751
training process:   8%|▊         | 10/128 [09:14<1:48:49, 55.33s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [10:07<1:46:37, 54.68s/it]Best score increase :0.751 -> 0.761
training process:   9%|▉         | 12/128 [10:59<1:44:06, 53.85s/it]Best score increase :0.761 -> 0.775
epoch : 13, train loss : 0.003, valid loss : 0.003, train acc : 0.949, valid acc : 0.948, train f1 : 0.785, valid f1 : 0.786
training process:  10%|█         | 13/128 [11:57<1:45:22, 54.98s/it]Best score increase :0.775 -> 0.786
training process:  11%|█         | 14/128 [12:47<1:41:32, 53.44s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:38<1:39:30, 52.84s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:28<1:37:09, 52.05s/it]Best score increase :0.786 -> 0.792
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.953, valid acc : 0.950, train f1 : 0.805, valid f1 : 0.801
training process:  13%|█▎        | 17/128 [15:29<1:40:57, 54.58s/it]Best score increase :0.792 -> 0.801
training process:  14%|█▍        | 18/128 [16:23<1:39:48, 54.44s/it]Best score increase :0.801 -> 0.807
training process:  15%|█▍        | 19/128 [17:14<1:37:17, 53.56s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [18:06<1:35:09, 52.87s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train acc : 0.954, valid acc : 0.953, train f1 : 0.813, valid f1 : 0.809
training process:  16%|█▋        | 21/128 [19:04<1:37:23, 54.61s/it]Best score increase :0.807 -> 0.809
training process:  17%|█▋        | 22/128 [19:56<1:34:59, 53.76s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [20:48<1:32:54, 53.09s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [21:40<1:31:30, 52.79s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.003, valid loss : 0.003, train acc : 0.956, valid acc : 0.951, train f1 : 0.823, valid f1 : 0.809
training process:  20%|█▉        | 25/128 [22:39<1:34:10, 54.86s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [23:33<1:32:30, 54.41s/it]Best score increase :0.809 -> 0.816
training process:  21%|██        | 27/128 [24:24<1:30:15, 53.62s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [25:17<1:28:59, 53.40s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.958, valid acc : 0.953, train f1 : 0.833, valid f1 : 0.810
training process:  23%|██▎       | 29/128 [26:18<1:31:52, 55.68s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [27:12<1:29:44, 54.94s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [28:07<1:29:09, 55.15s/it]Best score increase :0.816 -> 0.819
training process:  25%|██▌       | 32/128 [29:03<1:28:41, 55.43s/it]Best score increase :0.819 -> 0.820
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.953, train f1 : 0.841, valid f1 : 0.824
training process:  26%|██▌       | 33/128 [30:05<1:30:53, 57.41s/it]Best score increase :0.820 -> 0.824
training process:  27%|██▋       | 34/128 [31:01<1:29:04, 56.86s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [31:53<1:26:01, 55.51s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [32:44<1:22:49, 54.02s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.961, valid acc : 0.951, train f1 : 0.844, valid f1 : 0.805
training process:  29%|██▉       | 37/128 [33:45<1:25:11, 56.17s/it]EarlyStopping counter : 4 out of 12
training process:  30%|██▉       | 38/128 [34:37<1:22:10, 54.78s/it]EarlyStopping counter : 5 out of 12
training process:  30%|███       | 39/128 [35:28<1:19:46, 53.78s/it]EarlyStopping counter : 6 out of 12
training process:  31%|███▏      | 40/128 [36:21<1:18:41, 53.65s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.961, valid acc : 0.952, train f1 : 0.846, valid f1 : 0.811
training process:  32%|███▏      | 41/128 [37:22<1:21:02, 55.90s/it]EarlyStopping counter : 8 out of 12
training process:  33%|███▎      | 42/128 [38:15<1:18:53, 55.04s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▎      | 43/128 [39:08<1:16:42, 54.14s/it]EarlyStopping counter : 10 out of 12
training process:  34%|███▍      | 44/128 [39:58<1:14:11, 52.99s/it]EarlyStopping counter : 11 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.963, valid acc : 0.955, train f1 : 0.854, valid f1 : 0.831
training process:  35%|███▌      | 45/128 [40:55<1:14:56, 54.17s/it]Best score increase :0.824 -> 0.831
training process:  36%|███▌      | 46/128 [41:49<1:14:02, 54.17s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [42:37<1:10:41, 52.37s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [43:25<1:08:10, 51.13s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.962, valid acc : 0.953, train f1 : 0.853, valid f1 : 0.815
training process:  38%|███▊      | 49/128 [44:25<1:10:51, 53.82s/it]EarlyStopping counter : 4 out of 12
training process:  39%|███▉      | 50/128 [45:14<1:07:45, 52.12s/it]Best score increase :0.831 -> 0.833
training process:  40%|███▉      | 51/128 [46:02<1:05:17, 50.87s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [46:47<1:02:29, 49.33s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train acc : 0.963, valid acc : 0.955, train f1 : 0.858, valid f1 : 0.820
training process:  41%|████▏     | 53/128 [47:42<1:03:30, 50.80s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [48:32<1:02:28, 50.66s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [49:20<1:00:45, 49.94s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [50:06<58:34, 48.81s/it]  Best score increase :0.833 -> 0.842
epoch : 57, train loss : 0.002, valid loss : 0.003, train acc : 0.965, valid acc : 0.955, train f1 : 0.863, valid f1 : 0.832
training process:  45%|████▍     | 57/128 [51:01<59:52, 50.60s/it]EarlyStopping counter : 1 out of 12
training process:  45%|████▌     | 58/128 [51:48<57:55, 49.65s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 59/128 [52:35<56:01, 48.72s/it]EarlyStopping counter : 3 out of 12
training process:  47%|████▋     | 60/128 [53:22<54:46, 48.33s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.003, train acc : 0.964, valid acc : 0.955, train f1 : 0.862, valid f1 : 0.826
training process:  48%|████▊     | 61/128 [54:17<56:09, 50.30s/it]EarlyStopping counter : 5 out of 12
training process:  48%|████▊     | 62/128 [55:04<54:05, 49.17s/it]EarlyStopping counter : 6 out of 12
training process:  49%|████▉     | 63/128 [55:49<52:06, 48.10s/it]EarlyStopping counter : 7 out of 12
training process:  50%|█████     | 64/128 [56:36<50:50, 47.66s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.002, valid loss : 0.003, train acc : 0.965, valid acc : 0.955, train f1 : 0.863, valid f1 : 0.820
training process:  51%|█████     | 65/128 [57:32<52:33, 50.06s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 66/128 [58:20<51:14, 49.58s/it]EarlyStopping counter : 10 out of 12
training process:  52%|█████▏    | 67/128 [59:13<51:15, 50.41s/it]EarlyStopping counter : 11 out of 12
training process:  52%|█████▏    | 67/128 [1:00:05<54:42, 53.81s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 67, best f1 score : 0.842
training process finished, best loss : 0.003 and best acc : 0.957, best f1 : 0.842, best epoch : 55

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.62      0.61       580
           1       0.97      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.79      0.79      7398
weighted avg       0.94      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.79, test AUC : 0.79, test loss : 0.184

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.80s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.87s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.90s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:01,  7.73s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.76s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  8.00s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.90s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.81s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.72s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.91s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.81s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.72s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.81s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 24/306 [00:00<00:01, 235.30it/s] 16%|█▌        | 49/306 [00:00<00:01, 239.95it/s] 24%|██▍       | 73/306 [00:00<00:00, 239.27it/s] 32%|███▏      | 97/306 [00:00<00:00, 217.56it/s] 40%|███▉      | 122/306 [00:00<00:00, 225.26it/s] 48%|████▊     | 146/306 [00:00<00:00, 228.21it/s] 56%|█████▌    | 170/306 [00:00<00:00, 231.12it/s] 63%|██████▎   | 194/306 [00:00<00:00, 216.40it/s] 71%|███████   | 216/306 [00:00<00:00, 216.07it/s] 78%|███████▊  | 239/306 [00:01<00:00, 220.02it/s] 86%|████████▌ | 262/306 [00:01<00:00, 209.40it/s] 97%|█████████▋| 296/306 [00:01<00:00, 245.84it/s]100%|██████████| 306/306 [00:01<00:00, 232.47it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 458.97it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 452.19it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:00, 448.08it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 447.00it/s]extract the null data:  41%|████      | 228/553 [00:00<00:00, 447.40it/s]extract the null data:  49%|████▉     | 273/553 [00:00<00:00, 447.40it/s]extract the null data:  58%|█████▊    | 319/553 [00:00<00:00, 448.30it/s]extract the null data:  66%|██████▌   | 364/553 [00:00<00:00, 446.58it/s]extract the null data:  74%|███████▍  | 409/553 [00:00<00:00, 445.15it/s]extract the null data:  82%|████████▏ | 454/553 [00:01<00:00, 444.31it/s]extract the null data:  90%|█████████ | 499/553 [00:01<00:00, 444.55it/s]extract the null data:  98%|█████████▊| 544/553 [00:01<00:00, 443.24it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 445.44it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 154.92it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 159.82it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 161.94it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:03, 158.25it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 158.33it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 159.72it/s]replace nan value:  21%|██        | 117/553 [00:00<00:02, 161.61it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 162.48it/s]replace nan value:  27%|██▋       | 151/553 [00:00<00:02, 163.66it/s]replace nan value:  30%|███       | 168/553 [00:01<00:02, 164.29it/s]replace nan value:  33%|███▎      | 185/553 [00:01<00:02, 164.30it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:02, 165.64it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:02, 165.47it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 165.07it/s]replace nan value:  46%|████▌     | 253/553 [00:01<00:01, 164.81it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 165.09it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 165.87it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 165.41it/s]replace nan value:  58%|█████▊    | 321/553 [00:01<00:01, 165.16it/s]replace nan value:  61%|██████    | 338/553 [00:02<00:01, 165.63it/s]replace nan value:  64%|██████▍   | 355/553 [00:02<00:01, 165.68it/s]replace nan value:  67%|██████▋   | 372/553 [00:02<00:01, 166.10it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 165.25it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 164.88it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 165.15it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 164.80it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 165.28it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 165.00it/s]replace nan value:  89%|████████▉ | 491/553 [00:02<00:00, 164.21it/s]replace nan value:  92%|█████████▏| 508/553 [00:03<00:00, 163.83it/s]replace nan value:  95%|█████████▍| 525/553 [00:03<00:00, 163.51it/s]replace nan value:  98%|█████████▊| 542/553 [00:03<00:00, 162.73it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 163.74it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.07it/s]  5%|▍         | 27/553 [00:00<00:04, 130.82it/s]  7%|▋         | 41/553 [00:00<00:03, 128.30it/s] 10%|▉         | 54/553 [00:00<00:04, 118.21it/s] 12%|█▏        | 66/553 [00:00<00:04, 110.14it/s] 14%|█▍        | 80/553 [00:00<00:04, 115.12it/s] 17%|█▋        | 93/553 [00:00<00:03, 116.55it/s] 19%|█▉        | 107/553 [00:00<00:03, 122.54it/s] 22%|██▏       | 122/553 [00:01<00:03, 125.03it/s] 25%|██▍       | 137/553 [00:01<00:03, 130.88it/s] 28%|██▊       | 153/553 [00:01<00:02, 138.22it/s] 31%|███       | 169/553 [00:01<00:02, 144.16it/s] 33%|███▎      | 184/553 [00:01<00:02, 140.22it/s] 36%|███▋      | 201/553 [00:01<00:02, 147.05it/s] 39%|███▉      | 216/553 [00:01<00:02, 145.94it/s] 42%|████▏     | 231/553 [00:01<00:02, 135.84it/s] 44%|████▍     | 245/553 [00:01<00:02, 135.58it/s] 47%|████▋     | 260/553 [00:01<00:02, 138.23it/s] 50%|████▉     | 274/553 [00:02<00:02, 131.46it/s] 52%|█████▏    | 289/553 [00:02<00:01, 134.69it/s] 55%|█████▍    | 303/553 [00:02<00:01, 126.60it/s] 57%|█████▋    | 316/553 [00:02<00:01, 119.79it/s] 59%|█████▉    | 329/553 [00:02<00:01, 120.43it/s] 62%|██████▏   | 344/553 [00:02<00:01, 127.17it/s] 65%|██████▍   | 357/553 [00:02<00:01, 120.59it/s] 67%|██████▋   | 372/553 [00:02<00:01, 127.40it/s] 70%|██████▉   | 385/553 [00:03<00:01, 121.88it/s] 72%|███████▏  | 398/553 [00:03<00:01, 111.11it/s] 75%|███████▍  | 414/553 [00:03<00:01, 118.36it/s] 77%|███████▋  | 427/553 [00:03<00:01, 108.58it/s] 80%|███████▉  | 442/553 [00:03<00:00, 118.50it/s] 83%|████████▎ | 458/553 [00:03<00:00, 126.36it/s] 85%|████████▌ | 472/553 [00:03<00:00, 129.43it/s] 88%|████████▊ | 486/553 [00:03<00:00, 127.00it/s] 90%|█████████ | 499/553 [00:03<00:00, 118.65it/s] 93%|█████████▎| 513/553 [00:04<00:00, 123.35it/s] 95%|█████████▌| 526/553 [00:04<00:00, 111.14it/s] 97%|█████████▋| 538/553 [00:04<00:00, 109.35it/s]100%|█████████▉| 551/553 [00:04<00:00, 98.33it/s] 100%|██████████| 553/553 [00:04<00:00, 122.75it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 257.89it/s]extract the null data:  56%|█████▌    | 78/139 [00:00<00:00, 407.50it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 451.73it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 428.96it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 179.50it/s]replace nan value:  27%|██▋       | 37/139 [00:00<00:00, 180.56it/s]replace nan value:  40%|████      | 56/139 [00:00<00:00, 183.45it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 184.85it/s]replace nan value:  68%|██████▊   | 94/139 [00:00<00:00, 183.40it/s]replace nan value:  81%|████████▏ | 113/139 [00:00<00:00, 181.48it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 181.42it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 181.80it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.07it/s] 17%|█▋        | 23/139 [00:00<00:01, 112.97it/s] 27%|██▋       | 37/139 [00:00<00:00, 122.19it/s] 36%|███▌      | 50/139 [00:00<00:00, 121.14it/s] 45%|████▌     | 63/139 [00:00<00:00, 117.50it/s] 54%|█████▍    | 75/139 [00:00<00:00, 117.36it/s] 63%|██████▎   | 87/139 [00:00<00:00, 107.37it/s] 71%|███████   | 99/139 [00:00<00:00, 107.91it/s] 79%|███████▉  | 110/139 [00:00<00:00, 107.75it/s] 89%|████████▉ | 124/139 [00:01<00:00, 116.60it/s] 98%|█████████▊| 136/139 [00:01<00:00, 114.85it/s]100%|██████████| 139/139 [00:01<00:00, 114.89it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 239.88it/s]extract the null data:  43%|████▎     | 75/173 [00:00<00:00, 397.28it/s]extract the null data:  73%|███████▎  | 126/173 [00:00<00:00, 446.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 434.58it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 181.65it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 181.46it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 181.72it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 181.80it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 181.22it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 181.04it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 180.01it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 180.29it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 177.32it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 179.59it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.98it/s] 16%|█▌        | 27/173 [00:00<00:01, 119.62it/s] 25%|██▍       | 43/173 [00:00<00:00, 135.15it/s] 34%|███▍      | 59/173 [00:00<00:00, 142.98it/s] 43%|████▎     | 74/173 [00:00<00:00, 143.11it/s] 51%|█████▏    | 89/173 [00:00<00:00, 141.48it/s] 60%|██████    | 104/173 [00:00<00:00, 139.85it/s] 69%|██████▉   | 119/173 [00:00<00:00, 140.31it/s] 77%|███████▋  | 134/173 [00:00<00:00, 135.07it/s] 86%|████████▌ | 148/173 [00:01<00:00, 134.37it/s] 94%|█████████▎| 162/173 [00:01<00:00, 122.96it/s]100%|██████████| 173/173 [00:01<00:00, 122.16it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : 0.009, train acc : 0.651, valid acc : 0.770, train f1 : 0.647, valid f1 : 0.591
training process:   1%|          | 1/128 [01:03<2:13:41, 63.16s/it]Best score increase :0.000 -> 0.591
training process:   2%|▏         | 2/128 [01:55<1:58:49, 56.58s/it]Best score increase :0.591 -> 0.657
training process:   2%|▏         | 3/128 [02:46<1:53:06, 54.29s/it]Best score increase :0.657 -> 0.694
training process:   3%|▎         | 4/128 [03:41<1:52:25, 54.40s/it]Best score increase :0.694 -> 0.715
epoch : 5, train loss : 0.008, valid loss : 0.006, train acc : 0.821, valid acc : 0.872, train f1 : 0.821, valid f1 : 0.711
training process:   4%|▍         | 5/128 [04:40<1:55:15, 56.22s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:31<1:50:46, 54.48s/it]Best score increase :0.715 -> 0.759
training process:   5%|▌         | 7/128 [06:24<1:48:50, 53.97s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:16<1:46:16, 53.13s/it]Best score increase :0.759 -> 0.771
epoch : 9, train loss : 0.007, valid loss : 0.005, train acc : 0.848, valid acc : 0.901, train f1 : 0.848, valid f1 : 0.754
training process:   7%|▋         | 9/128 [08:16<1:49:40, 55.30s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:07<1:46:30, 54.16s/it]Best score increase :0.771 -> 0.778
training process:   9%|▊         | 11/128 [10:00<1:44:34, 53.63s/it]Best score increase :0.778 -> 0.786
training process:   9%|▉         | 12/128 [10:52<1:42:53, 53.22s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.005, train acc : 0.860, valid acc : 0.908, train f1 : 0.860, valid f1 : 0.771
training process:  10%|█         | 13/128 [11:54<1:46:54, 55.78s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:44<1:42:46, 54.09s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [13:36<1:40:30, 53.37s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [14:27<1:38:47, 52.93s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.005, train acc : 0.875, valid acc : 0.895, train f1 : 0.875, valid f1 : 0.759
training process:  13%|█▎        | 17/128 [15:29<1:42:27, 55.38s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [16:19<1:39:02, 54.02s/it]Best score increase :0.786 -> 0.796
training process:  15%|█▍        | 19/128 [17:11<1:36:42, 53.23s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [18:03<1:35:31, 53.07s/it]Best score increase :0.796 -> 0.807
epoch : 21, train loss : 0.006, valid loss : 0.005, train acc : 0.880, valid acc : 0.909, train f1 : 0.880, valid f1 : 0.780
training process:  16%|█▋        | 21/128 [19:05<1:39:07, 55.59s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:56<1:35:56, 54.31s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:50<1:34:33, 54.03s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:43<1:33:28, 53.93s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.004, train acc : 0.888, valid acc : 0.924, train f1 : 0.888, valid f1 : 0.802
training process:  20%|█▉        | 25/128 [22:43<1:35:46, 55.80s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [23:34<1:32:12, 54.24s/it]Best score increase :0.807 -> 0.811
training process:  21%|██        | 27/128 [24:26<1:30:14, 53.61s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [25:18<1:28:39, 53.19s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.005, train acc : 0.892, valid acc : 0.896, train f1 : 0.892, valid f1 : 0.764
training process:  23%|██▎       | 29/128 [26:20<1:31:58, 55.74s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [27:11<1:28:54, 54.43s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [28:04<1:27:11, 53.93s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [28:56<1:25:11, 53.24s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.004, train acc : 0.896, valid acc : 0.909, train f1 : 0.896, valid f1 : 0.783
training process:  26%|██▌       | 33/128 [29:55<1:27:07, 55.03s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [30:44<1:23:28, 53.28s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [31:35<1:21:11, 52.39s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [32:23<1:18:34, 51.25s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.004, train acc : 0.902, valid acc : 0.909, train f1 : 0.902, valid f1 : 0.784
training process:  29%|██▉       | 37/128 [33:20<1:20:24, 53.01s/it]EarlyStopping counter : 11 out of 12
training process:  29%|██▉       | 37/128 [34:10<1:24:02, 55.41s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.811
training process finished, best loss : 0.004 and best acc : 0.929, best f1 : 0.811, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.55      0.83      0.66       580
           1       0.99      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.77      0.89      0.81      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.81, test AUC : 0.89, test loss : 0.230

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.75s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.72s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.62s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:02,  7.76s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.94s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.91s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.85s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.80s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.78s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.81s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.85s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.93s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.84s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 26/306 [00:00<00:01, 232.00it/s] 16%|█▋        | 50/306 [00:00<00:01, 227.09it/s] 26%|██▌       | 80/306 [00:00<00:00, 257.31it/s] 35%|███▍      | 106/306 [00:00<00:00, 256.79it/s] 44%|████▍     | 134/306 [00:00<00:00, 262.92it/s] 53%|█████▎    | 161/306 [00:00<00:00, 240.92it/s] 61%|██████    | 186/306 [00:00<00:00, 240.36it/s] 75%|███████▍  | 229/306 [00:00<00:00, 296.29it/s] 85%|████████▍ | 260/306 [00:00<00:00, 271.31it/s] 94%|█████████▍| 288/306 [00:01<00:00, 268.79it/s]100%|██████████| 306/306 [00:01<00:00, 258.88it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:01, 500.64it/s]extract the null data:  18%|█▊        | 102/553 [00:00<00:00, 502.78it/s]extract the null data:  28%|██▊       | 153/553 [00:00<00:00, 505.59it/s]extract the null data:  37%|███▋      | 206/553 [00:00<00:00, 511.79it/s]extract the null data:  47%|████▋     | 258/553 [00:00<00:00, 514.51it/s]extract the null data:  56%|█████▋    | 312/553 [00:00<00:00, 520.50it/s]extract the null data:  66%|██████▌   | 365/553 [00:00<00:00, 521.09it/s]extract the null data:  76%|███████▌  | 418/553 [00:00<00:00, 520.86it/s]extract the null data:  85%|████████▌ | 471/553 [00:00<00:00, 520.21it/s]extract the null data:  95%|█████████▍| 524/553 [00:01<00:00, 513.93it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 513.67it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 167.39it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 169.91it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 170.18it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 170.41it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 174.05it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 175.27it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 177.14it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 178.25it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:02, 178.53it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 179.21it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 179.93it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 179.61it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 179.81it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:01, 179.12it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 180.15it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 178.94it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 178.28it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:01, 178.16it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:01, 178.49it/s]replace nan value:  66%|██████▋   | 367/553 [00:02<00:01, 175.62it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 175.80it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 174.29it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 173.71it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 174.10it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 177.02it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 177.80it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 176.56it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 176.68it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 176.08it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 176.80it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 176.52it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.91it/s]  5%|▌         | 28/553 [00:00<00:03, 134.77it/s]  8%|▊         | 42/553 [00:00<00:03, 129.77it/s] 10%|▉         | 55/553 [00:00<00:04, 122.39it/s] 12%|█▏        | 68/553 [00:00<00:04, 111.06it/s] 15%|█▌        | 83/553 [00:00<00:03, 121.99it/s] 18%|█▊        | 97/553 [00:00<00:03, 123.47it/s] 20%|██        | 112/553 [00:00<00:03, 130.19it/s] 23%|██▎       | 126/553 [00:01<00:03, 126.23it/s] 26%|██▌       | 144/553 [00:01<00:02, 139.71it/s] 29%|██▉       | 162/553 [00:01<00:02, 147.29it/s] 32%|███▏      | 178/553 [00:01<00:02, 148.24it/s] 35%|███▌      | 194/553 [00:01<00:02, 150.40it/s] 38%|███▊      | 211/553 [00:01<00:02, 153.00it/s] 41%|████      | 227/553 [00:01<00:02, 145.24it/s] 44%|████▍     | 242/553 [00:01<00:02, 143.26it/s] 46%|████▋     | 257/553 [00:01<00:02, 140.25it/s] 49%|████▉     | 272/553 [00:02<00:02, 135.77it/s] 52%|█████▏    | 287/553 [00:02<00:01, 138.47it/s] 54%|█████▍    | 301/553 [00:02<00:01, 131.68it/s] 57%|█████▋    | 315/553 [00:02<00:01, 126.12it/s] 59%|█████▉    | 328/553 [00:02<00:01, 126.05it/s] 62%|██████▏   | 343/553 [00:02<00:01, 131.95it/s] 65%|██████▍   | 357/553 [00:02<00:01, 125.06it/s] 67%|██████▋   | 373/553 [00:02<00:01, 131.85it/s] 70%|██████▉   | 387/553 [00:02<00:01, 122.89it/s] 72%|███████▏  | 400/553 [00:03<00:01, 114.65it/s] 75%|███████▌  | 415/553 [00:03<00:01, 121.61it/s] 77%|███████▋  | 428/553 [00:03<00:01, 113.34it/s] 80%|████████  | 445/553 [00:03<00:00, 127.46it/s] 83%|████████▎ | 461/553 [00:03<00:00, 134.72it/s] 86%|████████▌ | 475/553 [00:03<00:00, 135.52it/s] 88%|████████▊ | 489/553 [00:03<00:00, 128.41it/s] 91%|█████████ | 503/553 [00:03<00:00, 123.12it/s] 94%|█████████▎| 518/553 [00:03<00:00, 130.16it/s] 96%|█████████▌| 532/553 [00:04<00:00, 109.55it/s] 99%|█████████▉| 548/553 [00:04<00:00, 120.79it/s]100%|██████████| 553/553 [00:04<00:00, 127.33it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 346.77it/s]extract the null data:  67%|██████▋   | 93/139 [00:00<00:00, 483.36it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 496.55it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 195.49it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 195.84it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 194.81it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 195.87it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 194.51it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 191.66it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.12it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.83it/s] 17%|█▋        | 24/139 [00:00<00:00, 119.43it/s] 27%|██▋       | 38/139 [00:00<00:00, 126.39it/s] 37%|███▋      | 51/139 [00:00<00:00, 122.11it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.58it/s] 55%|█████▌    | 77/139 [00:00<00:00, 119.16it/s] 64%|██████▍   | 89/139 [00:00<00:00, 107.14it/s] 74%|███████▍  | 103/139 [00:00<00:00, 114.98it/s] 83%|████████▎ | 115/139 [00:00<00:00, 115.29it/s] 92%|█████████▏| 128/139 [00:01<00:00, 118.28it/s]100%|██████████| 139/139 [00:01<00:00, 118.40it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 358.36it/s]extract the null data:  55%|█████▍    | 95/173 [00:00<00:00, 489.72it/s]extract the null data:  90%|████████▉ | 155/173 [00:00<00:00, 535.81it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 515.72it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 194.68it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 194.52it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 195.07it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 195.32it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 194.82it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 194.45it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 194.02it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 193.10it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 193.11it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 129.84it/s] 16%|█▌        | 27/173 [00:00<00:01, 112.05it/s] 24%|██▎       | 41/173 [00:00<00:01, 121.84it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.99it/s] 39%|███▉      | 68/173 [00:00<00:00, 127.99it/s] 47%|████▋     | 81/173 [00:00<00:00, 127.67it/s] 55%|█████▍    | 95/173 [00:00<00:00, 127.73it/s] 62%|██████▏   | 108/173 [00:00<00:00, 127.69it/s] 70%|██████▉   | 121/173 [00:00<00:00, 127.79it/s] 77%|███████▋  | 134/173 [00:01<00:00, 121.27it/s] 85%|████████▍ | 147/173 [00:01<00:00, 121.59it/s] 92%|█████████▏| 160/173 [00:01<00:00, 109.98it/s] 99%|█████████▉| 172/173 [00:01<00:00, 82.19it/s] 100%|██████████| 173/173 [00:01<00:00, 110.10it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : 0.012, train acc : 0.734, valid acc : 0.720, train f1 : 0.538, valid f1 : 0.552
training process:   1%|          | 1/128 [00:59<2:05:26, 59.26s/it]Best score increase :0.000 -> 0.552
training process:   2%|▏         | 2/128 [01:47<1:51:13, 52.96s/it]Best score increase :0.552 -> 0.602
training process:   2%|▏         | 3/128 [02:36<1:46:19, 51.04s/it]Best score increase :0.602 -> 0.639
training process:   3%|▎         | 4/128 [03:28<1:46:18, 51.44s/it]Best score increase :0.639 -> 0.640
epoch : 5, train loss : 0.008, valid loss : 0.009, train acc : 0.817, valid acc : 0.905, train f1 : 0.649, valid f1 : 0.746
training process:   4%|▍         | 5/128 [04:31<1:53:36, 55.42s/it]Best score increase :0.640 -> 0.746
training process:   5%|▍         | 6/128 [05:22<1:49:58, 54.09s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:14<1:47:40, 53.40s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:06<1:46:02, 53.02s/it]Best score increase :0.746 -> 0.777
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.900, valid acc : 0.892, train f1 : 0.747, valid f1 : 0.741
training process:   7%|▋         | 9/128 [08:06<1:49:29, 55.21s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:59<1:47:20, 54.58s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:48<1:42:52, 52.76s/it]Best score increase :0.777 -> 0.804
training process:   9%|▉         | 12/128 [10:36<1:38:55, 51.17s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.007, train acc : 0.913, valid acc : 0.928, train f1 : 0.768, valid f1 : 0.796
training process:  10%|█         | 13/128 [11:32<1:40:50, 52.62s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:20<1:37:42, 51.42s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [13:10<1:35:45, 50.84s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [14:04<1:36:35, 51.75s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.007, train acc : 0.918, valid acc : 0.942, train f1 : 0.782, valid f1 : 0.820
training process:  13%|█▎        | 17/128 [15:05<1:40:51, 54.52s/it]Best score increase :0.804 -> 0.820
training process:  14%|█▍        | 18/128 [15:57<1:38:48, 53.90s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:50<1:37:19, 53.57s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:40<1:34:41, 52.61s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.007, train acc : 0.919, valid acc : 0.931, train f1 : 0.784, valid f1 : 0.807
training process:  16%|█▋        | 21/128 [18:41<1:37:59, 54.94s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [19:37<1:37:44, 55.33s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [20:29<1:35:26, 54.54s/it]Best score increase :0.820 -> 0.828
training process:  19%|█▉        | 24/128 [21:25<1:35:09, 54.89s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.006, train acc : 0.924, valid acc : 0.938, train f1 : 0.794, valid f1 : 0.821
training process:  20%|█▉        | 25/128 [22:28<1:38:30, 57.39s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [23:19<1:34:20, 55.49s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [24:18<1:34:50, 56.34s/it]Best score increase :0.828 -> 0.830
training process:  22%|██▏       | 28/128 [25:13<1:33:28, 56.08s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.006, valid loss : 0.006, train acc : 0.928, valid acc : 0.935, train f1 : 0.802, valid f1 : 0.817
training process:  23%|██▎       | 29/128 [26:15<1:35:05, 57.63s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [27:06<1:31:14, 55.86s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [27:56<1:27:33, 54.16s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [28:48<1:25:30, 53.44s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.006, valid loss : 0.006, train acc : 0.927, valid acc : 0.942, train f1 : 0.800, valid f1 : 0.830
training process:  26%|██▌       | 33/128 [29:48<1:27:45, 55.43s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [30:38<1:24:05, 53.67s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [31:28<1:21:41, 52.70s/it]Best score increase :0.830 -> 0.846
training process:  28%|██▊       | 36/128 [32:22<1:21:19, 53.04s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.006, valid loss : 0.007, train acc : 0.928, valid acc : 0.950, train f1 : 0.802, valid f1 : 0.839
training process:  29%|██▉       | 37/128 [33:21<1:22:56, 54.68s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [34:12<1:20:35, 53.72s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [35:04<1:18:49, 53.15s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [35:56<1:17:23, 52.76s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.006, valid loss : 0.006, train acc : 0.932, valid acc : 0.951, train f1 : 0.811, valid f1 : 0.849
training process:  32%|███▏      | 41/128 [36:53<1:18:17, 54.00s/it]Best score increase :0.846 -> 0.849
training process:  33%|███▎      | 42/128 [37:41<1:14:47, 52.17s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [38:29<1:12:26, 51.13s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [39:21<1:11:38, 51.17s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.005, valid loss : 0.006, train acc : 0.935, valid acc : 0.944, train f1 : 0.817, valid f1 : 0.837
training process:  35%|███▌      | 45/128 [40:15<1:12:08, 52.15s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [41:02<1:09:11, 50.63s/it]Best score increase :0.849 -> 0.854
training process:  37%|███▋      | 47/128 [41:50<1:07:21, 49.89s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [42:36<1:05:00, 48.75s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.005, valid loss : 0.006, train acc : 0.937, valid acc : 0.946, train f1 : 0.820, valid f1 : 0.843
training process:  38%|███▊      | 49/128 [43:32<1:07:06, 50.97s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [44:19<1:04:20, 49.50s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [45:05<1:02:17, 48.53s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [45:52<1:00:54, 48.09s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.005, valid loss : 0.006, train acc : 0.933, valid acc : 0.952, train f1 : 0.815, valid f1 : 0.853
training process:  41%|████▏     | 53/128 [46:49<1:03:24, 50.72s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [47:36<1:01:07, 49.56s/it]EarlyStopping counter : 8 out of 12
training process:  43%|████▎     | 55/128 [48:22<59:15, 48.71s/it]  EarlyStopping counter : 9 out of 12
training process:  44%|████▍     | 56/128 [49:12<58:57, 49.14s/it]EarlyStopping counter : 10 out of 12
epoch : 57, train loss : 0.005, valid loss : 0.005, train acc : 0.938, valid acc : 0.945, train f1 : 0.825, valid f1 : 0.842
training process:  45%|████▍     | 57/128 [50:09<1:00:52, 51.44s/it]EarlyStopping counter : 11 out of 12
training process:  45%|████▍     | 57/128 [50:58<1:03:29, 53.66s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 57, best f1 score : 0.855
training process finished, best loss : 0.006 and best acc : 0.954, best f1 : 0.855, best epoch : 53

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.72      0.75      0.74       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.85      0.86      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.86, test loss : 0.414

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.75s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.83s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:12,  8.04s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.91s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.94s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.92s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.89s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.90s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.92s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.94s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.95s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.94s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.92s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 25/306 [00:00<00:01, 242.34it/s] 19%|█▉        | 58/306 [00:00<00:00, 292.86it/s] 29%|██▉       | 88/306 [00:00<00:00, 287.56it/s] 38%|███▊      | 117/306 [00:00<00:00, 274.53it/s] 51%|█████     | 156/306 [00:00<00:00, 307.49it/s] 61%|██████    | 187/306 [00:00<00:00, 296.11it/s] 72%|███████▏  | 221/306 [00:00<00:00, 304.30it/s] 83%|████████▎ | 255/306 [00:00<00:00, 314.17it/s] 94%|█████████▍| 287/306 [00:00<00:00, 304.25it/s]100%|██████████| 306/306 [00:01<00:00, 292.65it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 50/553 [00:00<00:01, 499.19it/s]extract the null data:  18%|█▊        | 102/553 [00:00<00:00, 506.02it/s]extract the null data:  28%|██▊       | 155/553 [00:00<00:00, 513.11it/s]extract the null data:  37%|███▋      | 207/553 [00:00<00:00, 509.64it/s]extract the null data:  47%|████▋     | 261/553 [00:00<00:00, 516.73it/s]extract the null data:  57%|█████▋    | 313/553 [00:00<00:00, 511.63it/s]extract the null data:  66%|██████▌   | 365/553 [00:00<00:00, 502.33it/s]extract the null data:  76%|███████▌  | 418/553 [00:00<00:00, 508.75it/s]extract the null data:  85%|████████▍ | 470/553 [00:00<00:00, 511.84it/s]extract the null data:  94%|█████████▍| 522/553 [00:01<00:00, 513.18it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 510.24it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 174.81it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 176.73it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 177.11it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 179.50it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 181.24it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 181.11it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 179.59it/s]replace nan value:  27%|██▋       | 149/553 [00:00<00:02, 180.15it/s]replace nan value:  30%|███       | 168/553 [00:00<00:02, 180.60it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 180.27it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:01, 179.83it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 179.49it/s]replace nan value:  44%|████▍     | 242/553 [00:01<00:01, 179.29it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 178.47it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 175.59it/s]replace nan value:  54%|█████▎    | 296/553 [00:01<00:01, 175.84it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 176.56it/s]replace nan value:  60%|██████    | 332/553 [00:01<00:01, 176.89it/s]replace nan value:  63%|██████▎   | 350/553 [00:01<00:01, 177.30it/s]replace nan value:  67%|██████▋   | 368/553 [00:02<00:01, 177.91it/s]replace nan value:  70%|██████▉   | 386/553 [00:02<00:00, 178.27it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 178.62it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 178.83it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 178.64it/s]replace nan value:  83%|████████▎ | 459/553 [00:02<00:00, 179.65it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 179.47it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 178.46it/s]replace nan value:  93%|█████████▎| 514/553 [00:02<00:00, 181.18it/s]replace nan value:  96%|█████████▋| 533/553 [00:02<00:00, 182.14it/s]replace nan value: 100%|█████████▉| 552/553 [00:03<00:00, 179.84it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 178.93it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 126.62it/s]  5%|▌         | 28/553 [00:00<00:03, 137.34it/s]  8%|▊         | 42/553 [00:00<00:03, 132.51it/s] 10%|█         | 56/553 [00:00<00:03, 124.32it/s] 12%|█▏        | 69/553 [00:00<00:04, 114.04it/s] 15%|█▌        | 84/553 [00:00<00:03, 123.70it/s] 18%|█▊        | 97/553 [00:00<00:03, 125.53it/s] 20%|██        | 112/553 [00:00<00:03, 132.01it/s] 23%|██▎       | 126/553 [00:00<00:03, 127.92it/s] 26%|██▌       | 144/553 [00:01<00:02, 141.65it/s] 29%|██▉       | 162/553 [00:01<00:02, 149.20it/s] 32%|███▏      | 178/553 [00:01<00:02, 149.65it/s] 35%|███▌      | 194/553 [00:01<00:02, 151.70it/s] 38%|███▊      | 211/553 [00:01<00:02, 155.18it/s] 41%|████      | 227/553 [00:01<00:02, 148.29it/s] 44%|████▍     | 242/553 [00:01<00:02, 144.66it/s] 46%|████▋     | 257/553 [00:01<00:02, 141.19it/s] 49%|████▉     | 272/553 [00:01<00:02, 136.47it/s] 52%|█████▏    | 288/553 [00:02<00:01, 141.33it/s] 55%|█████▍    | 303/553 [00:02<00:01, 133.65it/s] 57%|█████▋    | 317/553 [00:02<00:01, 126.65it/s] 60%|█████▉    | 330/553 [00:02<00:01, 127.30it/s] 62%|██████▏   | 345/553 [00:02<00:01, 129.65it/s] 65%|██████▍   | 359/553 [00:02<00:01, 124.82it/s] 68%|██████▊   | 375/553 [00:02<00:01, 132.71it/s] 70%|███████   | 389/553 [00:02<00:01, 123.51it/s] 73%|███████▎  | 402/553 [00:03<00:01, 118.10it/s] 75%|███████▌  | 416/553 [00:03<00:01, 120.01it/s] 78%|███████▊  | 429/553 [00:03<00:01, 116.52it/s] 81%|████████  | 447/553 [00:03<00:00, 133.27it/s] 84%|████████▎ | 462/553 [00:03<00:00, 136.26it/s] 86%|████████▋ | 477/553 [00:03<00:00, 138.51it/s] 89%|████████▉ | 492/553 [00:03<00:00, 128.53it/s] 92%|█████████▏| 506/553 [00:03<00:00, 126.12it/s] 94%|█████████▍| 521/553 [00:03<00:00, 127.35it/s] 97%|█████████▋| 534/553 [00:04<00:00, 113.95it/s] 99%|█████████▉| 549/553 [00:04<00:00, 123.06it/s]100%|██████████| 553/553 [00:04<00:00, 129.07it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 354.60it/s]extract the null data:  69%|██████▉   | 96/139 [00:00<00:00, 497.14it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 512.82it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 215.06it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 211.01it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 203.77it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 202.46it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 201.17it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 199.70it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 202.02it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.98it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.38it/s] 28%|██▊       | 39/139 [00:00<00:00, 128.36it/s] 37%|███▋      | 52/139 [00:00<00:00, 119.75it/s] 47%|████▋     | 66/139 [00:00<00:00, 125.83it/s] 57%|█████▋    | 79/139 [00:00<00:00, 125.93it/s] 66%|██████▌   | 92/139 [00:00<00:00, 120.93it/s] 76%|███████▋  | 106/139 [00:00<00:00, 125.45it/s] 88%|████████▊ | 123/139 [00:00<00:00, 137.01it/s] 99%|█████████▊| 137/139 [00:01<00:00, 137.10it/s]100%|██████████| 139/139 [00:01<00:00, 129.61it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 33/173 [00:00<00:00, 329.65it/s]extract the null data:  57%|█████▋    | 98/173 [00:00<00:00, 514.08it/s]extract the null data:  93%|█████████▎| 161/173 [00:00<00:00, 565.60it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 537.03it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 195.25it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 197.30it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 198.67it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 196.94it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 198.64it/s]replace nan value:  71%|███████   | 123/173 [00:00<00:00, 202.40it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 203.45it/s]replace nan value:  95%|█████████▌| 165/173 [00:00<00:00, 200.40it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 199.05it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.74it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.59it/s] 24%|██▍       | 42/173 [00:00<00:01, 122.61it/s] 32%|███▏      | 56/173 [00:00<00:00, 127.99it/s] 40%|███▉      | 69/173 [00:00<00:00, 124.91it/s] 48%|████▊     | 83/173 [00:00<00:00, 127.84it/s] 55%|█████▌    | 96/173 [00:00<00:00, 125.99it/s] 64%|██████▎   | 110/173 [00:00<00:00, 129.80it/s] 72%|███████▏  | 124/173 [00:00<00:00, 122.52it/s] 79%|███████▉  | 137/173 [00:01<00:00, 124.07it/s] 87%|████████▋ | 150/173 [00:01<00:00, 123.74it/s] 94%|█████████▍| 163/173 [00:01<00:00, 120.56it/s]100%|██████████| 173/173 [00:01<00:00, 115.22it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.016, train acc : 0.510, valid acc : 0.104, train f1 : 0.417, valid f1 : 0.100
training process:   1%|          | 1/128 [00:59<2:05:51, 59.46s/it]Best score increase :0.000 -> 0.100
training process:   2%|▏         | 2/128 [01:49<1:52:46, 53.70s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:37<1:46:50, 51.29s/it]Best score increase :0.100 -> 0.111
training process:   3%|▎         | 4/128 [03:26<1:44:17, 50.46s/it]Best score increase :0.111 -> 0.207
epoch : 5, train loss : 0.005, valid loss : 0.017, train acc : 0.583, valid acc : 0.254, train f1 : 0.498, valid f1 : 0.248
training process:   4%|▍         | 5/128 [04:27<1:51:23, 54.34s/it]Best score increase :0.207 -> 0.248
training process:   5%|▍         | 6/128 [05:19<1:48:53, 53.55s/it]Best score increase :0.248 -> 0.308
training process:   5%|▌         | 7/128 [06:10<1:45:51, 52.49s/it]Best score increase :0.308 -> 0.378
training process:   6%|▋         | 8/128 [07:00<1:43:16, 51.63s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.013, train acc : 0.703, valid acc : 0.462, train f1 : 0.676, valid f1 : 0.409
training process:   7%|▋         | 9/128 [07:58<1:46:20, 53.62s/it]Best score increase :0.378 -> 0.409
training process:   8%|▊         | 10/128 [08:50<1:44:55, 53.35s/it]Best score increase :0.409 -> 0.412
training process:   9%|▊         | 11/128 [09:39<1:41:27, 52.03s/it]Best score increase :0.412 -> 0.449
training process:   9%|▉         | 12/128 [10:28<1:38:51, 51.14s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.011, train acc : 0.744, valid acc : 0.556, train f1 : 0.727, valid f1 : 0.475
training process:  10%|█         | 13/128 [11:29<1:43:14, 53.87s/it]Best score increase :0.449 -> 0.475
training process:  11%|█         | 14/128 [12:22<1:42:15, 53.82s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:12<1:38:44, 52.42s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:00<1:35:29, 51.16s/it]Best score increase :0.475 -> 0.498
epoch : 17, train loss : 0.003, valid loss : 0.012, train acc : 0.769, valid acc : 0.565, train f1 : 0.757, valid f1 : 0.482
training process:  13%|█▎        | 17/128 [14:58<1:38:36, 53.30s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:51<1:37:40, 53.27s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [16:39<1:33:56, 51.72s/it]Best score increase :0.498 -> 0.531
training process:  16%|█▌        | 20/128 [17:30<1:32:33, 51.42s/it]Best score increase :0.531 -> 0.537
epoch : 21, train loss : 0.003, valid loss : 0.009, train acc : 0.789, valid acc : 0.658, train f1 : 0.781, valid f1 : 0.547
training process:  16%|█▋        | 21/128 [18:29<1:35:53, 53.77s/it]Best score increase :0.537 -> 0.547
training process:  17%|█▋        | 22/128 [19:18<1:32:28, 52.34s/it]Best score increase :0.547 -> 0.549
training process:  18%|█▊        | 23/128 [20:07<1:29:45, 51.29s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [20:55<1:27:23, 50.41s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.010, train acc : 0.809, valid acc : 0.653, train f1 : 0.803, valid f1 : 0.543
training process:  20%|█▉        | 25/128 [21:54<1:30:31, 52.73s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [22:42<1:27:19, 51.37s/it]Best score increase :0.549 -> 0.559
training process:  21%|██        | 27/128 [23:31<1:25:33, 50.83s/it]Best score increase :0.559 -> 0.592
training process:  22%|██▏       | 28/128 [24:21<1:24:00, 50.40s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.011, train acc : 0.821, valid acc : 0.625, train f1 : 0.816, valid f1 : 0.523
training process:  23%|██▎       | 29/128 [25:20<1:27:38, 53.12s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [26:13<1:26:41, 53.07s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [27:14<1:29:22, 55.29s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [28:11<1:29:36, 56.00s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.009, train acc : 0.834, valid acc : 0.677, train f1 : 0.830, valid f1 : 0.561
training process:  26%|██▌       | 33/128 [29:17<1:33:24, 59.00s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [30:14<1:31:32, 58.44s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [31:13<1:30:38, 58.48s/it]EarlyStopping counter : 8 out of 12
training process:  28%|██▊       | 36/128 [32:08<1:28:07, 57.47s/it]EarlyStopping counter : 9 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.008, train acc : 0.843, valid acc : 0.725, train f1 : 0.839, valid f1 : 0.597
training process:  29%|██▉       | 37/128 [33:17<1:32:12, 60.79s/it]Best score increase :0.592 -> 0.597
training process:  30%|██▉       | 38/128 [34:13<1:29:12, 59.48s/it]Best score increase :0.597 -> 0.649
training process:  30%|███       | 39/128 [35:10<1:26:52, 58.56s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [36:05<1:24:23, 57.54s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.009, train acc : 0.847, valid acc : 0.701, train f1 : 0.845, valid f1 : 0.579
training process:  32%|███▏      | 41/128 [37:09<1:26:25, 59.60s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [38:05<1:24:03, 58.64s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [38:58<1:20:19, 56.70s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [39:56<1:20:01, 57.16s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.010, train acc : 0.858, valid acc : 0.688, train f1 : 0.856, valid f1 : 0.569
training process:  35%|███▌      | 45/128 [41:04<1:23:47, 60.57s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [41:59<1:20:12, 58.69s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [42:55<1:18:22, 58.06s/it]EarlyStopping counter : 9 out of 12
training process:  38%|███▊      | 48/128 [43:50<1:16:03, 57.04s/it]EarlyStopping counter : 10 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.007, train acc : 0.861, valid acc : 0.788, train f1 : 0.859, valid f1 : 0.649
training process:  38%|███▊      | 49/128 [44:54<1:17:56, 59.20s/it]EarlyStopping counter : 11 out of 12
training process:  38%|███▊      | 49/128 [45:50<1:13:54, 56.13s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 49, best f1 score : 0.649
training process finished, best loss : 0.007 and best acc : 0.789, best f1 : 0.649, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.27      0.92      0.41       580
           1       0.99      0.78      0.88      6818

    accuracy                           0.79      7398
   macro avg       0.63      0.85      0.64      7398
weighted avg       0.93      0.79      0.84      7398


# test acc : 0.79, test f1 : 0.64, test AUC : 0.85, test loss : 0.461

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.26s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.06s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.86s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.76s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.75s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.16s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:41,  8.39s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:34,  8.71s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:14<00:26,  8.68s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:24<00:17,  8.81s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:33<00:08,  8.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.89s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.51s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 24/306 [00:00<00:01, 221.63it/s] 15%|█▌        | 47/306 [00:00<00:01, 193.01it/s] 25%|██▌       | 78/306 [00:00<00:00, 234.95it/s] 33%|███▎      | 102/306 [00:00<00:00, 226.04it/s] 42%|████▏     | 130/306 [00:00<00:00, 243.51it/s] 51%|█████▏    | 157/306 [00:00<00:00, 251.63it/s] 60%|█████▉    | 183/306 [00:00<00:00, 216.98it/s] 77%|███████▋  | 235/306 [00:00<00:00, 299.32it/s] 87%|████████▋ | 267/306 [00:01<00:00, 296.30it/s] 97%|█████████▋| 298/306 [00:01<00:00, 254.48it/s]100%|██████████| 306/306 [00:01<00:00, 253.38it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 57/553 [00:00<00:00, 560.27it/s]extract the null data:  21%|██        | 117/553 [00:00<00:00, 578.25it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:00, 593.85it/s]extract the null data:  43%|████▎     | 239/553 [00:00<00:00, 581.14it/s]extract the null data:  54%|█████▍    | 299/553 [00:00<00:00, 585.69it/s]extract the null data:  65%|██████▍   | 359/553 [00:00<00:00, 589.85it/s]extract the null data:  76%|███████▌  | 419/553 [00:00<00:00, 592.42it/s]extract the null data:  87%|████████▋ | 479/553 [00:00<00:00, 594.45it/s]extract the null data:  97%|█████████▋| 539/553 [00:00<00:00, 592.30it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 588.44it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 191.11it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 191.84it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 190.05it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 192.63it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 195.48it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:02, 199.05it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 201.86it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:01, 203.05it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 203.11it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:01, 202.69it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 202.07it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 201.22it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 200.63it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 199.05it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 196.86it/s]replace nan value:  60%|█████▉    | 330/553 [00:01<00:01, 196.53it/s]replace nan value:  63%|██████▎   | 350/553 [00:01<00:01, 196.77it/s]replace nan value:  67%|██████▋   | 371/553 [00:01<00:00, 198.03it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 198.71it/s]replace nan value:  75%|███████▍  | 413/553 [00:02<00:00, 199.95it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 199.75it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 200.51it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 200.20it/s]replace nan value:  90%|████████▉ | 496/553 [00:02<00:00, 199.88it/s]replace nan value:  93%|█████████▎| 517/553 [00:02<00:00, 200.59it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 199.48it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 198.98it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 141.84it/s]  6%|▌         | 31/553 [00:00<00:03, 150.44it/s]  8%|▊         | 47/553 [00:00<00:03, 127.83it/s] 11%|█         | 61/553 [00:00<00:03, 123.99it/s] 14%|█▎        | 76/553 [00:00<00:03, 131.35it/s] 16%|█▋        | 91/553 [00:00<00:03, 132.28it/s] 19%|█▉        | 106/553 [00:00<00:03, 135.88it/s] 22%|██▏       | 122/553 [00:00<00:03, 139.49it/s] 25%|██▌       | 139/553 [00:01<00:02, 146.21it/s] 29%|██▊       | 158/553 [00:01<00:02, 156.31it/s] 31%|███▏      | 174/553 [00:01<00:02, 155.48it/s] 35%|███▍      | 191/553 [00:01<00:02, 157.96it/s] 38%|███▊      | 210/553 [00:01<00:02, 164.14it/s] 41%|████      | 227/553 [00:01<00:02, 156.74it/s] 44%|████▍     | 243/553 [00:01<00:02, 153.94it/s] 47%|████▋     | 259/553 [00:01<00:01, 152.20it/s] 50%|████▉     | 275/553 [00:01<00:01, 148.83it/s] 53%|█████▎    | 291/553 [00:01<00:01, 148.34it/s] 55%|█████▌    | 306/553 [00:02<00:01, 135.66it/s] 58%|█████▊    | 320/553 [00:02<00:01, 133.66it/s] 61%|██████    | 335/553 [00:02<00:01, 136.21it/s] 63%|██████▎   | 349/553 [00:02<00:01, 135.19it/s] 66%|██████▌   | 363/553 [00:02<00:01, 133.40it/s] 68%|██████▊   | 378/553 [00:02<00:01, 137.63it/s] 71%|███████   | 392/553 [00:02<00:01, 128.27it/s] 73%|███████▎  | 405/553 [00:02<00:01, 127.17it/s] 76%|███████▌  | 418/553 [00:02<00:01, 125.30it/s] 78%|███████▊  | 431/553 [00:03<00:00, 122.72it/s] 81%|████████▏ | 450/553 [00:03<00:00, 140.91it/s] 84%|████████▍ | 465/553 [00:03<00:00, 142.29it/s] 87%|████████▋ | 480/553 [00:03<00:00, 138.38it/s] 89%|████████▉ | 494/553 [00:03<00:00, 133.45it/s] 92%|█████████▏| 509/553 [00:03<00:00, 138.03it/s] 95%|█████████▍| 523/553 [00:03<00:00, 129.57it/s] 97%|█████████▋| 537/553 [00:03<00:00, 120.55it/s]100%|█████████▉| 551/553 [00:04<00:00, 110.33it/s]100%|██████████| 553/553 [00:04<00:00, 136.17it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 355.49it/s]extract the null data:  73%|███████▎  | 102/139 [00:00<00:00, 532.24it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 541.80it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 219.73it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 218.88it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 218.77it/s]replace nan value:  64%|██████▍   | 89/139 [00:00<00:00, 219.65it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 222.20it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 225.20it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 222.65it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 129.10it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.30it/s] 29%|██▉       | 41/139 [00:00<00:00, 136.28it/s] 40%|███▉      | 55/139 [00:00<00:00, 126.20it/s] 50%|████▉     | 69/139 [00:00<00:00, 130.06it/s] 60%|█████▉    | 83/139 [00:00<00:00, 124.96it/s] 69%|██████▉   | 96/139 [00:00<00:00, 118.09it/s] 78%|███████▊  | 108/139 [00:00<00:00, 116.78it/s] 89%|████████▉ | 124/139 [00:00<00:00, 126.80it/s] 99%|█████████▊| 137/139 [00:01<00:00, 126.48it/s]100%|██████████| 139/139 [00:01<00:00, 126.11it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 309.27it/s]extract the null data:  58%|█████▊    | 100/173 [00:00<00:00, 528.56it/s]extract the null data:  98%|█████████▊| 169/173 [00:00<00:00, 597.97it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 558.80it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 219.10it/s]replace nan value:  26%|██▌       | 45/173 [00:00<00:00, 220.09it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 220.04it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 217.36it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 219.19it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 218.00it/s]replace nan value:  91%|█████████▏| 158/173 [00:00<00:00, 215.57it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 215.73it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 137.70it/s] 17%|█▋        | 29/173 [00:00<00:01, 123.10it/s] 27%|██▋       | 46/173 [00:00<00:00, 138.63it/s] 36%|███▌      | 62/173 [00:00<00:00, 143.21it/s] 45%|████▍     | 77/173 [00:00<00:00, 140.76it/s] 53%|█████▎    | 92/173 [00:00<00:00, 139.32it/s] 61%|██████▏   | 106/173 [00:00<00:00, 139.44it/s] 69%|██████▉   | 120/173 [00:00<00:00, 138.46it/s] 77%|███████▋  | 134/173 [00:00<00:00, 131.45it/s] 86%|████████▌ | 148/173 [00:01<00:00, 130.48it/s] 94%|█████████▎| 162/173 [00:01<00:00, 119.63it/s]100%|██████████| 173/173 [00:01<00:00, 120.16it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.008, train f1 : 0.517, valid f1 : 0.500
training process - Deferred Re-weighting:   1%|          | 1/128 [00:39<1:24:01, 39.70s/it]Best score increase :0.000 -> 0.500
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:28<1:34:36, 45.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:20<1:40:51, 48.41s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:10<1:40:43, 48.74s/it]Best score increase :0.500 -> 0.505
epoch : 5, train loss : 0.005, valid loss : 0.005, train f1 : 0.511, valid f1 : 0.554
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:06<1:45:20, 51.39s/it]Best score increase :0.505 -> 0.554
training process - Deferred Re-weighting:   5%|▍         | 6/128 [04:54<1:42:38, 50.48s/it]Best score increase :0.554 -> 0.588
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:42<1:39:39, 49.42s/it]Best score increase :0.588 -> 0.646
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:31<1:38:48, 49.41s/it]Best score increase :0.646 -> 0.672
epoch : 9, train loss : 0.004, valid loss : 0.004, train f1 : 0.729, valid f1 : 0.764
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:31<1:44:36, 52.75s/it]Best score increase :0.672 -> 0.764
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:22<1:42:49, 52.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:15<1:41:54, 52.26s/it]Best score increase :0.764 -> 0.765
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:07<1:40:57, 52.22s/it]Best score increase :0.765 -> 0.781
epoch : 13, train loss : 0.003, valid loss : 0.003, train f1 : 0.791, valid f1 : 0.789
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:08<1:45:28, 55.03s/it]Best score increase :0.781 -> 0.789
training process - Deferred Re-weighting:  11%|█         | 14/128 [11:59<1:42:09, 53.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:50<1:39:27, 52.81s/it]Best score increase :0.789 -> 0.790
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:40<1:37:07, 52.03s/it]Best score increase :0.790 -> 0.795
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.809, valid f1 : 0.803
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:40<1:40:42, 54.44s/it]Best score increase :0.795 -> 0.803
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:31<1:38:09, 53.54s/it]Best score increase :0.803 -> 0.806
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:22<1:35:39, 52.66s/it]Best score increase :0.806 -> 0.809
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:13<1:33:42, 52.06s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train f1 : 0.819, valid f1 : 0.811
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:14<1:37:39, 54.76s/it]Best score increase :0.809 -> 0.811
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:04<1:34:27, 53.46s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:54<1:31:48, 52.46s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:49<1:31:55, 53.03s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.003, valid loss : 0.003, train f1 : 0.831, valid f1 : 0.809
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:53<1:36:41, 56.32s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:46<1:33:59, 55.29s/it]Best score increase :0.811 -> 0.818
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:41<1:33:02, 55.27s/it]Best score increase :0.818 -> 0.821
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:34<1:31:18, 54.79s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.843, valid f1 : 0.812
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:38<1:34:32, 57.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:36<1:34:04, 57.59s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:32<1:32:38, 57.31s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:28<1:30:55, 56.83s/it]Best score increase :0.821 -> 0.826
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.848, valid f1 : 0.832
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:34<1:34:09, 59.47s/it]Best score increase :0.826 -> 0.832
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [30:22<1:27:38, 55.95s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:11<1:23:32, 53.89s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:58<1:19:33, 51.89s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.851, valid f1 : 0.818
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:58<1:22:38, 54.49s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:46<1:18:48, 52.54s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:34<1:15:34, 50.94s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:21<1:13:14, 49.94s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.858, valid f1 : 0.816
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:20<1:16:01, 52.44s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [37:09<1:13:56, 51.58s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [38:00<1:12:41, 51.31s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:52<1:12:04, 51.49s/it]EarlyStopping counter : 11 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.863, valid f1 : 0.828
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [39:53<1:16:09, 54.40s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 44, best f1 score : 0.832
training process finished, best loss : 0.003, best acc : 0.954, best f1 : 0.832, best epoch : 32

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.62      0.61       580
           1       0.97      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.79      0.79      7398
weighted avg       0.94      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.79, test AUC : 0.79, test loss : 0.198

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.57s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:15,  7.52s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.40s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.34s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.33s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.43s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:37,  7.41s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:30,  7.56s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.64s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:15,  7.57s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.49s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.46s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.47s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 17%|█▋        | 53/306 [00:00<00:00, 525.95it/s] 35%|███▍      | 106/306 [00:00<00:00, 515.71it/s] 52%|█████▏    | 158/306 [00:00<00:00, 498.31it/s] 68%|██████▊   | 208/306 [00:00<00:00, 496.23it/s] 84%|████████▍ | 258/306 [00:00<00:00, 493.72it/s]100%|██████████| 306/306 [00:00<00:00, 497.04it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 574.38it/s]extract the null data:  21%|██        | 117/553 [00:00<00:00, 583.09it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 586.95it/s]extract the null data:  43%|████▎     | 238/553 [00:00<00:00, 595.54it/s]extract the null data:  54%|█████▍    | 298/553 [00:00<00:00, 593.05it/s]extract the null data:  65%|██████▍   | 358/553 [00:00<00:00, 594.72it/s]extract the null data:  76%|███████▌  | 418/553 [00:00<00:00, 590.08it/s]extract the null data:  86%|████████▋ | 478/553 [00:00<00:00, 577.24it/s]extract the null data:  97%|█████████▋| 537/553 [00:00<00:00, 580.92it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 584.60it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 192.35it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 194.05it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 192.23it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 193.92it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 163.16it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 175.44it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 181.46it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:02, 187.50it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 191.16it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:01, 194.73it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 197.51it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 197.06it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 195.73it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 195.49it/s]replace nan value:  55%|█████▌    | 305/553 [00:01<00:01, 198.04it/s]replace nan value:  59%|█████▉    | 326/553 [00:01<00:01, 199.81it/s]replace nan value:  63%|██████▎   | 347/553 [00:01<00:01, 200.85it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 200.24it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 198.86it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 197.92it/s]replace nan value:  78%|███████▊  | 429/553 [00:02<00:00, 195.87it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 191.96it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 192.43it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 191.59it/s]replace nan value:  92%|█████████▏| 509/553 [00:02<00:00, 190.37it/s]replace nan value:  96%|█████████▌| 529/553 [00:02<00:00, 190.77it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 189.22it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 191.59it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.23it/s]  5%|▌         | 29/553 [00:00<00:03, 142.52it/s]  8%|▊         | 44/553 [00:00<00:03, 128.74it/s] 10%|█         | 58/553 [00:00<00:04, 120.23it/s] 13%|█▎        | 71/553 [00:00<00:04, 117.93it/s] 16%|█▌        | 88/553 [00:00<00:03, 132.13it/s] 18%|█▊        | 102/553 [00:00<00:03, 126.16it/s] 22%|██▏       | 120/553 [00:00<00:03, 139.20it/s] 24%|██▍       | 135/553 [00:01<00:03, 132.08it/s] 28%|██▊       | 153/553 [00:01<00:02, 143.82it/s] 31%|███       | 171/553 [00:01<00:02, 151.62it/s] 34%|███▍      | 187/553 [00:01<00:02, 141.57it/s] 37%|███▋      | 204/553 [00:01<00:02, 148.27it/s] 40%|███▉      | 220/553 [00:01<00:02, 142.43it/s] 43%|████▎     | 236/553 [00:01<00:02, 146.49it/s] 45%|████▌     | 251/553 [00:01<00:02, 143.18it/s] 48%|████▊     | 266/553 [00:01<00:02, 141.79it/s] 51%|█████     | 281/553 [00:02<00:01, 138.57it/s] 53%|█████▎    | 295/553 [00:02<00:01, 134.74it/s] 56%|█████▌    | 309/553 [00:02<00:02, 120.67it/s] 58%|█████▊    | 322/553 [00:02<00:01, 121.08it/s] 61%|██████    | 335/553 [00:02<00:01, 123.41it/s] 63%|██████▎   | 349/553 [00:02<00:01, 124.90it/s] 65%|██████▌   | 362/553 [00:02<00:01, 107.42it/s] 68%|██████▊   | 375/553 [00:02<00:01, 110.87it/s] 70%|██████▉   | 387/553 [00:02<00:01, 109.75it/s] 72%|███████▏  | 399/553 [00:03<00:01, 105.63it/s] 75%|███████▍  | 414/553 [00:03<00:01, 114.29it/s] 77%|███████▋  | 426/553 [00:03<00:01, 96.47it/s]  80%|███████▉  | 441/553 [00:03<00:01, 108.60it/s] 83%|████████▎ | 458/553 [00:03<00:00, 121.80it/s] 86%|████████▌ | 474/553 [00:03<00:00, 129.52it/s] 88%|████████▊ | 488/553 [00:03<00:00, 126.44it/s] 91%|█████████ | 501/553 [00:03<00:00, 121.64it/s] 93%|█████████▎| 516/553 [00:04<00:00, 129.24it/s] 96%|█████████▌| 530/553 [00:04<00:00, 112.25it/s] 99%|█████████▊| 545/553 [00:04<00:00, 121.28it/s]100%|██████████| 553/553 [00:04<00:00, 124.27it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 296.56it/s]extract the null data:  71%|███████   | 98/139 [00:00<00:00, 517.17it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 516.72it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 212.82it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 212.25it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 207.79it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 207.16it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 206.43it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 208.40it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 208.50it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.68it/s] 19%|█▊        | 26/139 [00:00<00:00, 129.46it/s] 29%|██▉       | 41/139 [00:00<00:00, 136.42it/s] 40%|███▉      | 55/139 [00:00<00:00, 124.31it/s] 49%|████▉     | 68/139 [00:00<00:00, 125.50it/s] 58%|█████▊    | 81/139 [00:00<00:00, 124.41it/s] 68%|██████▊   | 94/139 [00:00<00:00, 113.17it/s] 77%|███████▋  | 107/139 [00:00<00:00, 114.72it/s] 86%|████████▌ | 119/139 [00:00<00:00, 114.34it/s] 95%|█████████▍| 132/139 [00:01<00:00, 118.11it/s]100%|██████████| 139/139 [00:01<00:00, 122.90it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 375.51it/s]extract the null data:  60%|██████    | 104/173 [00:00<00:00, 541.34it/s]extract the null data:  98%|█████████▊| 169/173 [00:00<00:00, 589.76it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 559.50it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 203.36it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 209.33it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 207.89it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 207.75it/s]replace nan value:  61%|██████▏   | 106/173 [00:00<00:00, 207.01it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 204.98it/s]replace nan value:  86%|████████▌ | 148/173 [00:00<00:00, 203.17it/s]replace nan value:  98%|█████████▊| 169/173 [00:00<00:00, 200.11it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 203.48it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 122.15it/s] 15%|█▌        | 26/173 [00:00<00:01, 116.01it/s] 24%|██▍       | 42/173 [00:00<00:00, 133.60it/s] 34%|███▍      | 59/173 [00:00<00:00, 145.08it/s] 43%|████▎     | 75/173 [00:00<00:00, 145.38it/s] 53%|█████▎    | 92/173 [00:00<00:00, 147.61it/s] 62%|██████▏   | 108/173 [00:00<00:00, 149.01it/s] 71%|███████   | 123/173 [00:00<00:00, 145.51it/s] 80%|███████▉  | 138/173 [00:00<00:00, 145.64it/s] 88%|████████▊ | 153/173 [00:01<00:00, 138.82it/s] 97%|█████████▋| 167/173 [00:01<00:00, 110.79it/s]100%|██████████| 173/173 [00:01<00:00, 127.50it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : 0.009, train f1 : 0.647, valid f1 : 0.591
training process - Deferred Re-weighting:   1%|          | 1/128 [01:00<2:07:16, 60.13s/it]Best score increase :0.000 -> 0.591
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:47<1:49:58, 52.37s/it]Best score increase :0.591 -> 0.657
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:34<1:44:30, 50.17s/it]Best score increase :0.657 -> 0.694
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:25<1:44:09, 50.40s/it]Best score increase :0.694 -> 0.715
epoch : 5, train loss : 0.008, valid loss : 0.006, train f1 : 0.821, valid f1 : 0.713
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:23<1:49:01, 53.19s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:14<1:46:28, 52.36s/it]Best score increase :0.715 -> 0.759
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:04<1:43:58, 51.56s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:00<1:46:02, 53.02s/it]Best score increase :0.759 -> 0.776
epoch : 9, train loss : 0.007, valid loss : 0.005, train f1 : 0.849, valid f1 : 0.756
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:02<1:50:43, 55.83s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:59<1:50:27, 56.16s/it]Best score increase :0.776 -> 0.778
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:54<1:48:57, 55.88s/it]Best score increase :0.778 -> 0.792
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:47<1:46:16, 54.97s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.005, train f1 : 0.863, valid f1 : 0.766
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:54<1:52:17, 58.59s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:49<1:49:31, 57.65s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:45<1:47:15, 56.95s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:43<1:47:07, 57.39s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.005, train f1 : 0.878, valid f1 : 0.755
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:43<1:47:36, 58.17s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:33<1:42:03, 55.67s/it]Best score increase :0.792 -> 0.795
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:22<1:37:44, 53.80s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:15<1:36:14, 53.47s/it]Best score increase :0.795 -> 0.810
epoch : 21, train loss : 0.005, valid loss : 0.004, train f1 : 0.883, valid f1 : 0.787
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:13<1:37:48, 54.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:04<1:34:59, 53.77s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:55<1:32:34, 52.90s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:48<1:31:30, 52.79s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.004, train f1 : 0.893, valid f1 : 0.792
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:50<1:35:35, 55.68s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:43<1:33:22, 54.93s/it]Best score increase :0.810 -> 0.818
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:35<1:30:44, 53.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:25<1:27:53, 52.74s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.006, train f1 : 0.897, valid f1 : 0.732
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:26<1:31:24, 55.39s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:17<1:28:14, 54.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:07<1:25:10, 52.69s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:56<1:22:23, 51.49s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.004, train f1 : 0.902, valid f1 : 0.805
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:53<1:24:19, 53.26s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [30:45<1:22:42, 52.80s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:36<1:21:07, 52.34s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [32:29<1:20:26, 52.47s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.004, valid loss : 0.004, train f1 : 0.910, valid f1 : 0.793
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:31<1:23:53, 55.31s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [34:24<1:24:36, 55.78s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.818
training process finished, best loss : 0.004, best acc : 0.933, best f1 : 0.818, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.83      0.68       580
           1       0.98      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.89      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.89, test loss : 0.213

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.07s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.93s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.10s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.06s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:55,  7.99s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.00s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:39,  7.97s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.83s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.89s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.95s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:08,  8.02s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.94s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.97s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 190.93it/s] 13%|█▎        | 41/306 [00:00<00:01, 165.08it/s] 22%|██▏       | 67/306 [00:00<00:01, 194.24it/s] 28%|██▊       | 87/306 [00:00<00:01, 190.55it/s] 35%|███▍      | 107/306 [00:00<00:01, 190.29it/s] 47%|████▋     | 143/306 [00:00<00:00, 242.40it/s] 55%|█████▍    | 168/306 [00:00<00:00, 234.06it/s] 63%|██████▎   | 192/306 [00:00<00:00, 196.36it/s] 72%|███████▏  | 221/306 [00:01<00:00, 214.51it/s] 80%|███████▉  | 244/306 [00:01<00:00, 196.23it/s] 88%|████████▊ | 268/306 [00:01<00:00, 206.65it/s] 95%|█████████▍| 290/306 [00:01<00:00, 207.45it/s]100%|██████████| 306/306 [00:01<00:00, 202.01it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:00, 508.49it/s]extract the null data:  19%|█▉        | 104/553 [00:00<00:00, 516.47it/s]extract the null data:  29%|██▊       | 158/553 [00:00<00:00, 522.86it/s]extract the null data:  38%|███▊      | 211/553 [00:00<00:00, 524.89it/s]extract the null data:  48%|████▊     | 264/553 [00:00<00:00, 520.21it/s]extract the null data:  57%|█████▋    | 317/553 [00:00<00:00, 522.40it/s]extract the null data:  67%|██████▋   | 370/553 [00:00<00:00, 523.22it/s]extract the null data:  76%|███████▋  | 423/553 [00:00<00:00, 523.07it/s]extract the null data:  86%|████████▌ | 476/553 [00:00<00:00, 523.16it/s]extract the null data:  96%|█████████▌| 529/553 [00:01<00:00, 520.85it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 520.07it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.85it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 174.70it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 177.24it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 175.26it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 175.52it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 176.85it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 177.69it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:02, 178.39it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:02, 178.41it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 178.71it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:01, 178.74it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 179.27it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 178.88it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 179.00it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 179.54it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 179.64it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 179.09it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 179.55it/s]replace nan value:  63%|██████▎   | 347/553 [00:01<00:01, 177.85it/s]replace nan value:  66%|██████▌   | 365/553 [00:02<00:01, 176.76it/s]replace nan value:  69%|██████▉   | 383/553 [00:02<00:00, 176.38it/s]replace nan value:  73%|███████▎  | 401/553 [00:02<00:00, 174.73it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 174.46it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 173.32it/s]replace nan value:  82%|████████▏ | 455/553 [00:02<00:00, 173.96it/s]replace nan value:  86%|████████▌ | 473/553 [00:02<00:00, 174.61it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 177.06it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 183.16it/s]replace nan value:  96%|█████████▌| 531/553 [00:02<00:00, 182.41it/s]replace nan value:  99%|█████████▉| 550/553 [00:03<00:00, 183.76it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 178.08it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 118.01it/s]  5%|▍         | 27/553 [00:00<00:03, 131.92it/s]  7%|▋         | 41/553 [00:00<00:03, 130.05it/s] 10%|▉         | 54/553 [00:00<00:04, 118.72it/s] 12%|█▏        | 66/553 [00:00<00:04, 110.18it/s] 14%|█▍        | 80/553 [00:00<00:04, 116.57it/s] 17%|█▋        | 94/553 [00:00<00:03, 121.21it/s] 20%|█▉        | 108/553 [00:00<00:03, 124.97it/s] 22%|██▏       | 122/553 [00:00<00:03, 127.73it/s] 25%|██▍       | 137/553 [00:01<00:03, 133.10it/s] 28%|██▊       | 153/553 [00:01<00:02, 140.02it/s] 31%|███       | 170/553 [00:01<00:02, 147.03it/s] 33%|███▎      | 185/553 [00:01<00:02, 141.68it/s] 37%|███▋      | 202/553 [00:01<00:02, 145.87it/s] 39%|███▉      | 217/553 [00:01<00:02, 144.72it/s] 42%|████▏     | 232/553 [00:01<00:02, 137.56it/s] 44%|████▍     | 246/553 [00:01<00:02, 137.60it/s] 47%|████▋     | 261/553 [00:01<00:02, 140.14it/s] 50%|████▉     | 276/553 [00:02<00:02, 131.27it/s] 53%|█████▎    | 291/553 [00:02<00:01, 134.42it/s] 55%|█████▌    | 305/553 [00:02<00:01, 128.34it/s] 58%|█████▊    | 318/553 [00:02<00:01, 119.70it/s] 60%|█████▉    | 331/553 [00:02<00:01, 121.30it/s] 62%|██████▏   | 345/553 [00:02<00:01, 122.47it/s] 65%|██████▍   | 358/553 [00:02<00:01, 121.43it/s] 67%|██████▋   | 373/553 [00:02<00:01, 127.41it/s] 70%|██████▉   | 386/553 [00:02<00:01, 119.92it/s] 72%|███████▏  | 399/553 [00:03<00:01, 109.72it/s] 75%|███████▌  | 415/553 [00:03<00:01, 117.93it/s] 77%|███████▋  | 427/553 [00:03<00:01, 108.92it/s] 80%|███████▉  | 442/553 [00:03<00:00, 119.38it/s] 83%|████████▎ | 458/553 [00:03<00:00, 127.22it/s] 85%|████████▌ | 472/553 [00:03<00:00, 130.25it/s] 88%|████████▊ | 486/553 [00:03<00:00, 127.76it/s] 90%|█████████ | 499/553 [00:03<00:00, 119.24it/s] 93%|█████████▎| 513/553 [00:04<00:00, 124.41it/s] 95%|█████████▌| 526/553 [00:04<00:00, 111.99it/s] 97%|█████████▋| 538/553 [00:04<00:00, 109.96it/s]100%|█████████▉| 551/553 [00:04<00:00, 98.16it/s] 100%|██████████| 553/553 [00:04<00:00, 123.32it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 31/139 [00:00<00:00, 307.82it/s]extract the null data:  69%|██████▉   | 96/139 [00:00<00:00, 507.17it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 517.80it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 195.04it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 194.19it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 194.49it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 194.80it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 194.26it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 193.09it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 194.16it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.66it/s] 17%|█▋        | 24/139 [00:00<00:00, 116.91it/s] 27%|██▋       | 37/139 [00:00<00:00, 122.37it/s] 36%|███▌      | 50/139 [00:00<00:00, 120.81it/s] 45%|████▌     | 63/139 [00:00<00:00, 117.44it/s] 54%|█████▍    | 75/139 [00:00<00:00, 116.10it/s] 63%|██████▎   | 87/139 [00:00<00:00, 106.33it/s] 71%|███████   | 99/139 [00:00<00:00, 107.32it/s] 79%|███████▉  | 110/139 [00:00<00:00, 107.68it/s] 89%|████████▉ | 124/139 [00:01<00:00, 116.93it/s] 98%|█████████▊| 136/139 [00:01<00:00, 114.66it/s]100%|██████████| 139/139 [00:01<00:00, 114.77it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 23/173 [00:00<00:00, 228.44it/s]extract the null data:  46%|████▌     | 79/173 [00:00<00:00, 420.50it/s]extract the null data:  78%|███████▊  | 135/173 [00:00<00:00, 481.10it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 467.20it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 196.07it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 197.84it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 199.72it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 201.19it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 200.01it/s]replace nan value:  72%|███████▏  | 124/173 [00:00<00:00, 200.31it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 201.36it/s]replace nan value:  96%|█████████▌| 166/173 [00:00<00:00, 194.88it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 196.89it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 125.18it/s] 16%|█▌        | 27/173 [00:00<00:01, 108.72it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.18it/s] 31%|███       | 54/173 [00:00<00:00, 124.37it/s] 39%|███▊      | 67/173 [00:00<00:00, 123.63it/s] 46%|████▌     | 80/173 [00:00<00:00, 121.77it/s] 54%|█████▍    | 93/173 [00:00<00:00, 123.78it/s] 61%|██████▏   | 106/173 [00:00<00:00, 121.89it/s] 69%|██████▉   | 119/173 [00:00<00:00, 121.47it/s] 76%|███████▋  | 132/173 [00:01<00:00, 117.08it/s] 83%|████████▎ | 144/173 [00:01<00:00, 116.73it/s] 90%|█████████ | 156/173 [00:01<00:00, 106.86it/s] 97%|█████████▋| 167/173 [00:01<00:00, 85.53it/s] 100%|██████████| 173/173 [00:01<00:00, 105.74it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.503, valid loss : 0.395, train acc : 0.890, valid acc : 0.913, train f1 : 0.555, valid f1 : 0.542
training process:   1%|          | 1/128 [00:46<1:37:54, 46.26s/it]Best score increase :0.000 -> 0.542
training process:   2%|▏         | 2/128 [01:37<1:42:41, 48.90s/it]Best score increase :0.542 -> 0.578
training process:   2%|▏         | 3/128 [02:28<1:44:05, 49.96s/it]Best score increase :0.578 -> 0.657
training process:   3%|▎         | 4/128 [03:19<1:44:35, 50.61s/it]Best score increase :0.657 -> 0.742
epoch : 5, train loss : 0.253, valid loss : 0.226, train acc : 0.940, valid acc : 0.942, train f1 : 0.746, valid f1 : 0.765
training process:   4%|▍         | 5/128 [04:21<1:51:37, 54.45s/it]Best score increase :0.742 -> 0.765
training process:   5%|▍         | 6/128 [05:12<1:48:51, 53.54s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:08<1:49:18, 54.21s/it]Best score increase :0.765 -> 0.787
training process:   6%|▋         | 8/128 [07:05<1:50:12, 55.10s/it]Best score increase :0.787 -> 0.796
epoch : 9, train loss : 0.176, valid loss : 0.170, train acc : 0.951, valid acc : 0.949, train f1 : 0.802, valid f1 : 0.795
training process:   7%|▋         | 9/128 [08:10<1:55:38, 58.31s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:08<1:54:06, 58.02s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [10:04<1:52:21, 57.62s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [11:00<1:50:15, 57.03s/it]Best score increase :0.796 -> 0.803
epoch : 13, train loss : 0.153, valid loss : 0.151, train acc : 0.953, valid acc : 0.952, train f1 : 0.809, valid f1 : 0.809
training process:  10%|█         | 13/128 [12:06<1:54:14, 59.61s/it]Best score increase :0.803 -> 0.809
training process:  11%|█         | 14/128 [12:59<1:49:54, 57.85s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:52<1:45:56, 56.26s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:43<1:42:02, 54.67s/it]Best score increase :0.809 -> 0.825
epoch : 17, train loss : 0.142, valid loss : 0.144, train acc : 0.955, valid acc : 0.954, train f1 : 0.817, valid f1 : 0.813
training process:  13%|█▎        | 17/128 [15:43<1:43:54, 56.17s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [16:32<1:39:16, 54.15s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [17:22<1:35:53, 52.78s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [18:10<1:32:38, 51.46s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.137, valid loss : 0.141, train acc : 0.957, valid acc : 0.953, train f1 : 0.824, valid f1 : 0.809
training process:  16%|█▋        | 21/128 [19:09<1:35:58, 53.82s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [20:01<1:33:40, 53.02s/it]EarlyStopping counter : 6 out of 12
training process:  18%|█▊        | 23/128 [20:51<1:31:32, 52.31s/it]EarlyStopping counter : 7 out of 12
training process:  19%|█▉        | 24/128 [21:40<1:28:56, 51.31s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.133, valid loss : 0.136, train acc : 0.959, valid acc : 0.955, train f1 : 0.834, valid f1 : 0.820
training process:  20%|█▉        | 25/128 [22:40<1:32:19, 53.78s/it]EarlyStopping counter : 9 out of 12
training process:  20%|██        | 26/128 [23:30<1:29:48, 52.83s/it]EarlyStopping counter : 10 out of 12
training process:  21%|██        | 27/128 [24:20<1:27:33, 52.02s/it]EarlyStopping counter : 11 out of 12
training process:  21%|██        | 27/128 [25:11<1:34:13, 55.97s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 27, best f1 score : 0.825
training process finished, best loss : 0.133 and best acc : 0.957, best f1 : 0.825, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.78      0.57      0.66       580
           1       0.96      0.99      0.98      6818

    accuracy                           0.95      7398
   macro avg       0.87      0.78      0.82      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.82, test AUC : 0.78, test loss : 9.135

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:33,  8.48s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:24,  8.45s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:14,  8.26s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:06,  8.29s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:56,  8.13s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:49,  8.17s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:40,  8.19s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:05<00:32,  8.07s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:13<00:24,  8.02s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:15,  7.99s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:28<00:07,  7.81s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  7.86s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.05s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 33/306 [00:00<00:00, 325.93it/s] 22%|██▏       | 67/306 [00:00<00:00, 332.14it/s] 33%|███▎      | 101/306 [00:00<00:00, 333.12it/s] 44%|████▍     | 135/306 [00:00<00:00, 321.22it/s] 55%|█████▍    | 168/306 [00:00<00:00, 322.73it/s] 68%|██████▊   | 209/306 [00:00<00:00, 349.38it/s] 83%|████████▎ | 255/306 [00:00<00:00, 371.97it/s] 98%|█████████▊| 300/306 [00:00<00:00, 385.51it/s]100%|██████████| 306/306 [00:00<00:00, 354.14it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 579.01it/s]extract the null data:  22%|██▏       | 120/553 [00:00<00:00, 602.93it/s]extract the null data:  33%|███▎      | 181/553 [00:00<00:00, 605.50it/s]extract the null data:  44%|████▍     | 244/553 [00:00<00:00, 611.65it/s]extract the null data:  55%|█████▌    | 306/553 [00:00<00:00, 607.01it/s]extract the null data:  67%|██████▋   | 369/553 [00:00<00:00, 612.39it/s]extract the null data:  78%|███████▊  | 431/553 [00:00<00:00, 609.37it/s]extract the null data:  89%|████████▉ | 492/553 [00:00<00:00, 601.74it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 602.90it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 604.67it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 199.12it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 201.53it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 202.35it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 202.02it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 203.76it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 204.32it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:01, 205.91it/s]replace nan value:  30%|███       | 167/553 [00:00<00:01, 205.73it/s]replace nan value:  34%|███▍      | 188/553 [00:00<00:01, 206.49it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 207.36it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:01, 206.61it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 206.88it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 206.14it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 206.25it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 205.90it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 206.78it/s]replace nan value:  64%|██████▍   | 356/553 [00:01<00:00, 206.72it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 206.85it/s]replace nan value:  72%|███████▏  | 398/553 [00:01<00:00, 206.65it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 206.63it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 206.38it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 206.05it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 205.69it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 204.37it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 203.31it/s]replace nan value:  99%|█████████▊| 545/553 [00:02<00:00, 204.16it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 205.23it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.43it/s]  5%|▌         | 29/553 [00:00<00:03, 144.69it/s]  8%|▊         | 44/553 [00:00<00:03, 133.40it/s] 10%|█         | 58/553 [00:00<00:03, 123.80it/s] 13%|█▎        | 71/553 [00:00<00:03, 121.92it/s] 16%|█▌        | 88/553 [00:00<00:03, 136.35it/s] 18%|█▊        | 102/553 [00:00<00:03, 130.32it/s] 22%|██▏       | 119/553 [00:00<00:03, 141.04it/s] 24%|██▍       | 134/553 [00:00<00:02, 139.68it/s] 28%|██▊       | 153/553 [00:01<00:02, 152.69it/s] 31%|███       | 171/553 [00:01<00:02, 160.62it/s] 34%|███▍      | 188/553 [00:01<00:02, 155.49it/s] 37%|███▋      | 207/553 [00:01<00:02, 164.80it/s] 41%|████      | 224/553 [00:01<00:02, 155.24it/s] 44%|████▎     | 241/553 [00:01<00:01, 156.40it/s] 46%|████▋     | 257/553 [00:01<00:01, 150.26it/s] 49%|████▉     | 273/553 [00:01<00:01, 145.93it/s] 52%|█████▏    | 289/553 [00:01<00:01, 149.57it/s] 55%|█████▌    | 305/553 [00:02<00:01, 141.49it/s] 58%|█████▊    | 320/553 [00:02<00:01, 131.62it/s] 61%|██████    | 335/553 [00:02<00:01, 135.32it/s] 63%|██████▎   | 349/553 [00:02<00:01, 134.62it/s] 66%|██████▌   | 363/553 [00:02<00:01, 132.95it/s] 68%|██████▊   | 378/553 [00:02<00:01, 136.20it/s] 71%|███████   | 392/553 [00:02<00:01, 126.32it/s] 73%|███████▎  | 405/553 [00:02<00:01, 126.69it/s] 76%|███████▌  | 418/553 [00:03<00:01, 124.86it/s] 78%|███████▊  | 431/553 [00:03<00:01, 122.00it/s] 81%|████████▏ | 450/553 [00:03<00:00, 140.72it/s] 84%|████████▍ | 465/553 [00:03<00:00, 141.76it/s] 87%|████████▋ | 480/553 [00:03<00:00, 138.12it/s] 89%|████████▉ | 494/553 [00:03<00:00, 133.17it/s] 92%|█████████▏| 509/553 [00:03<00:00, 137.20it/s] 95%|█████████▍| 523/553 [00:03<00:00, 128.76it/s] 97%|█████████▋| 537/553 [00:03<00:00, 119.23it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.56it/s]100%|██████████| 553/553 [00:04<00:00, 135.30it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  31%|███       | 43/139 [00:00<00:00, 428.64it/s]extract the null data:  80%|███████▉  | 111/139 [00:00<00:00, 571.69it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 571.14it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 219.17it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 220.76it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 218.13it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 215.19it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 215.95it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 216.14it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 216.56it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.20it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.75it/s] 30%|███       | 42/139 [00:00<00:00, 141.55it/s] 41%|████      | 57/139 [00:00<00:00, 124.71it/s] 52%|█████▏    | 72/139 [00:00<00:00, 132.44it/s] 62%|██████▏   | 86/139 [00:00<00:00, 124.72it/s] 71%|███████   | 99/139 [00:00<00:00, 118.09it/s] 81%|████████▏ | 113/139 [00:00<00:00, 122.40it/s] 92%|█████████▏| 128/139 [00:01<00:00, 129.85it/s]100%|██████████| 139/139 [00:01<00:00, 128.71it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 44/173 [00:00<00:00, 435.02it/s]extract the null data:  66%|██████▋   | 115/173 [00:00<00:00, 595.94it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 601.93it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 220.37it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 222.38it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 222.12it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 220.23it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 219.08it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 215.92it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 216.88it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 217.69it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.73it/s] 16%|█▌        | 28/173 [00:00<00:01, 121.10it/s] 25%|██▍       | 43/173 [00:00<00:00, 131.27it/s] 34%|███▎      | 58/173 [00:00<00:00, 136.97it/s] 42%|████▏     | 72/173 [00:00<00:00, 136.14it/s] 50%|████▉     | 86/173 [00:00<00:00, 133.75it/s] 58%|█████▊    | 100/173 [00:00<00:00, 134.73it/s] 66%|██████▋   | 115/173 [00:00<00:00, 139.04it/s] 75%|███████▍  | 129/173 [00:00<00:00, 132.39it/s] 83%|████████▎ | 143/173 [00:01<00:00, 132.65it/s] 91%|█████████ | 157/173 [00:01<00:00, 122.63it/s] 98%|█████████▊| 170/173 [00:01<00:00, 106.85it/s]100%|██████████| 173/173 [00:01<00:00, 121.44it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.590, valid loss : 0.489, train acc : 0.684, valid acc : 0.796, train f1 : 0.683, valid f1 : 0.621
training process:   1%|          | 1/128 [00:55<1:58:17, 55.89s/it]Best score increase :0.000 -> 0.621
training process:   2%|▏         | 2/128 [01:44<1:48:12, 51.53s/it]Best score increase :0.621 -> 0.688
training process:   2%|▏         | 3/128 [02:29<1:41:37, 48.78s/it]Best score increase :0.688 -> 0.755
training process:   3%|▎         | 4/128 [03:16<1:39:05, 47.94s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.361, valid loss : 0.299, train acc : 0.842, valid acc : 0.906, train f1 : 0.841, valid f1 : 0.763
training process:   4%|▍         | 5/128 [04:12<1:44:21, 50.91s/it]Best score increase :0.755 -> 0.763
training process:   5%|▍         | 6/128 [05:05<1:44:57, 51.62s/it]Best score increase :0.763 -> 0.781
training process:   5%|▌         | 7/128 [05:57<1:44:07, 51.63s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [06:50<1:43:54, 51.95s/it]Best score increase :0.781 -> 0.802
epoch : 9, train loss : 0.322, valid loss : 0.252, train acc : 0.863, valid acc : 0.923, train f1 : 0.863, valid f1 : 0.795
training process:   7%|▋         | 9/128 [07:50<1:48:08, 54.52s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:42<1:45:55, 53.86s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:34<1:43:47, 53.23s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [10:26<1:42:33, 53.05s/it]EarlyStopping counter : 4 out of 12
epoch : 13, train loss : 0.295, valid loss : 0.196, train acc : 0.879, valid acc : 0.942, train f1 : 0.879, valid f1 : 0.824
training process:  10%|█         | 13/128 [11:27<1:46:16, 55.45s/it]Best score increase :0.802 -> 0.824
training process:  11%|█         | 14/128 [12:19<1:42:51, 54.13s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:09<1:40:01, 53.11s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:02<1:38:43, 52.89s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.279, valid loss : 0.283, train acc : 0.885, valid acc : 0.895, train f1 : 0.885, valid f1 : 0.756
training process:  13%|█▎        | 17/128 [15:03<1:42:24, 55.35s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [15:58<1:41:27, 55.34s/it]EarlyStopping counter : 5 out of 12
training process:  15%|█▍        | 19/128 [16:56<1:41:43, 55.99s/it]EarlyStopping counter : 6 out of 12
training process:  16%|█▌        | 20/128 [17:53<1:41:40, 56.49s/it]EarlyStopping counter : 7 out of 12
epoch : 21, train loss : 0.260, valid loss : 0.223, train acc : 0.894, valid acc : 0.918, train f1 : 0.894, valid f1 : 0.787
training process:  16%|█▋        | 21/128 [19:02<1:47:11, 60.11s/it]EarlyStopping counter : 8 out of 12
training process:  17%|█▋        | 22/128 [20:01<1:45:52, 59.93s/it]EarlyStopping counter : 9 out of 12
training process:  18%|█▊        | 23/128 [21:00<1:44:03, 59.46s/it]EarlyStopping counter : 10 out of 12
training process:  19%|█▉        | 24/128 [21:57<1:42:00, 58.85s/it]EarlyStopping counter : 11 out of 12
epoch : 25, train loss : 0.254, valid loss : 0.224, train acc : 0.896, valid acc : 0.913, train f1 : 0.896, valid f1 : 0.781
training process:  19%|█▉        | 24/128 [23:06<1:40:07, 57.76s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 24, best f1 score : 0.825
training process finished, best loss : 0.204 and best acc : 0.941, best f1 : 0.825, best epoch : 15

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.77      0.67       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.86      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.86, test loss : 12.000

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:36,  8.81s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:31,  9.12s/it]processing for feature importance:  25%|██▌       | 3/12 [00:27<01:22,  9.16s/it]processing for feature importance:  33%|███▎      | 4/12 [00:36<01:11,  8.96s/it]processing for feature importance:  42%|████▏     | 5/12 [00:44<01:01,  8.80s/it]processing for feature importance:  50%|█████     | 6/12 [00:53<00:52,  8.78s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:01<00:42,  8.58s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:10<00:34,  8.65s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:19<00:26,  8.77s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:27<00:17,  8.56s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:35<00:08,  8.42s/it]processing for feature importance: 100%|██████████| 12/12 [01:43<00:00,  8.39s/it]processing for feature importance: 100%|██████████| 12/12 [01:43<00:00,  8.65s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 120.40it/s] 14%|█▍        | 43/306 [00:00<00:01, 220.91it/s] 22%|██▏       | 66/306 [00:00<00:01, 219.09it/s] 29%|██▉       | 89/306 [00:00<00:01, 185.02it/s] 37%|███▋      | 112/306 [00:00<00:00, 196.89it/s] 43%|████▎     | 133/306 [00:00<00:00, 198.63it/s] 51%|█████     | 156/306 [00:00<00:00, 207.59it/s] 58%|█████▊    | 179/306 [00:00<00:00, 214.09it/s] 66%|██████▌   | 201/306 [00:01<00:00, 183.73it/s] 75%|███████▌  | 230/306 [00:01<00:00, 210.58it/s] 83%|████████▎ | 253/306 [00:01<00:00, 181.69it/s] 95%|█████████▍| 290/306 [00:01<00:00, 227.78it/s]100%|██████████| 306/306 [00:01<00:00, 204.79it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 442.26it/s]extract the null data:  16%|█▋        | 90/553 [00:00<00:01, 440.88it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:00, 454.65it/s]extract the null data:  34%|███▎      | 186/553 [00:00<00:00, 460.71it/s]extract the null data:  42%|████▏     | 234/553 [00:00<00:00, 465.13it/s]extract the null data:  51%|█████     | 281/553 [00:00<00:00, 462.48it/s]extract the null data:  59%|█████▉    | 328/553 [00:00<00:00, 457.03it/s]extract the null data:  68%|██████▊   | 374/553 [00:00<00:00, 456.16it/s]extract the null data:  76%|███████▌  | 420/553 [00:00<00:00, 454.82it/s]extract the null data:  84%|████████▍ | 466/553 [00:01<00:00, 455.53it/s]extract the null data:  93%|█████████▎| 514/553 [00:01<00:00, 460.20it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 457.18it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.51it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 165.75it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 164.92it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 165.34it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 167.07it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 166.95it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 167.35it/s]replace nan value:  25%|██▍       | 138/553 [00:00<00:02, 168.22it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 168.15it/s]replace nan value:  31%|███       | 172/553 [00:01<00:02, 168.68it/s]replace nan value:  34%|███▍      | 190/553 [00:01<00:02, 170.94it/s]replace nan value:  38%|███▊      | 208/553 [00:01<00:02, 170.95it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 169.35it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 169.44it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 166.90it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 167.15it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 167.47it/s]replace nan value:  56%|█████▌    | 311/553 [00:01<00:01, 167.60it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 167.83it/s]replace nan value:  62%|██████▏   | 345/553 [00:02<00:01, 167.89it/s]replace nan value:  65%|██████▌   | 362/553 [00:02<00:01, 164.80it/s]replace nan value:  69%|██████▊   | 380/553 [00:02<00:01, 166.48it/s]replace nan value:  72%|███████▏  | 397/553 [00:02<00:00, 161.83it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 162.69it/s]replace nan value:  78%|███████▊  | 431/553 [00:02<00:00, 159.34it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 162.66it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 163.24it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 163.66it/s]replace nan value:  90%|█████████ | 500/553 [00:03<00:00, 163.38it/s]replace nan value:  93%|█████████▎| 517/553 [00:03<00:00, 164.01it/s]replace nan value:  97%|█████████▋| 534/553 [00:03<00:00, 164.69it/s]replace nan value: 100%|█████████▉| 551/553 [00:03<00:00, 164.70it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 165.95it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.38it/s]  5%|▍         | 27/553 [00:00<00:04, 130.24it/s]  7%|▋         | 41/553 [00:00<00:03, 129.52it/s] 10%|▉         | 54/553 [00:00<00:04, 118.48it/s] 12%|█▏        | 66/553 [00:00<00:04, 109.93it/s] 14%|█▍        | 80/553 [00:00<00:04, 115.13it/s] 17%|█▋        | 94/553 [00:00<00:03, 120.21it/s] 20%|█▉        | 108/553 [00:00<00:03, 125.01it/s] 22%|██▏       | 122/553 [00:00<00:03, 127.90it/s] 25%|██▍       | 136/553 [00:01<00:03, 131.32it/s] 27%|██▋       | 152/553 [00:01<00:02, 138.86it/s] 31%|███       | 169/553 [00:01<00:02, 145.89it/s] 33%|███▎      | 184/553 [00:01<00:02, 141.68it/s] 36%|███▌      | 200/553 [00:01<00:02, 146.74it/s] 39%|███▉      | 215/553 [00:01<00:02, 146.27it/s] 42%|████▏     | 230/553 [00:01<00:02, 136.83it/s] 44%|████▍     | 244/553 [00:01<00:02, 135.75it/s] 47%|████▋     | 258/553 [00:01<00:02, 136.10it/s] 49%|████▉     | 272/553 [00:02<00:02, 133.57it/s] 52%|█████▏    | 289/553 [00:02<00:01, 142.28it/s] 55%|█████▍    | 304/553 [00:02<00:01, 137.84it/s] 58%|█████▊    | 318/553 [00:02<00:01, 130.91it/s] 60%|██████    | 332/553 [00:02<00:01, 133.22it/s] 63%|██████▎   | 347/553 [00:02<00:01, 136.07it/s] 65%|██████▌   | 361/553 [00:02<00:01, 129.06it/s] 68%|██████▊   | 377/553 [00:02<00:01, 135.58it/s] 71%|███████   | 391/553 [00:02<00:01, 125.14it/s] 73%|███████▎  | 405/553 [00:03<00:01, 126.07it/s] 76%|███████▌  | 418/553 [00:03<00:01, 123.56it/s] 78%|███████▊  | 431/553 [00:03<00:01, 120.32it/s] 81%|████████▏ | 450/553 [00:03<00:00, 137.92it/s] 84%|████████▍ | 465/553 [00:03<00:00, 139.34it/s] 87%|████████▋ | 480/553 [00:03<00:00, 136.15it/s] 89%|████████▉ | 494/553 [00:03<00:00, 131.28it/s] 92%|█████████▏| 509/553 [00:03<00:00, 135.46it/s] 95%|█████████▍| 523/553 [00:03<00:00, 126.94it/s] 97%|█████████▋| 536/553 [00:04<00:00, 118.19it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.13it/s]100%|██████████| 553/553 [00:04<00:00, 129.11it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 40/139 [00:00<00:00, 398.96it/s]extract the null data:  78%|███████▊  | 108/139 [00:00<00:00, 562.00it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 566.11it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 226.80it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 218.38it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 213.41it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 212.36it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 213.00it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 211.69it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 213.40it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.68it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.68it/s] 29%|██▉       | 41/139 [00:00<00:00, 136.77it/s] 40%|███▉      | 55/139 [00:00<00:00, 125.58it/s] 50%|████▉     | 69/139 [00:00<00:00, 128.65it/s] 60%|█████▉    | 83/139 [00:00<00:00, 129.39it/s] 70%|██████▉   | 97/139 [00:00<00:00, 127.78it/s] 79%|███████▉  | 110/139 [00:00<00:00, 127.44it/s] 91%|█████████▏| 127/139 [00:00<00:00, 137.80it/s]100%|██████████| 139/139 [00:01<00:00, 133.49it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 256.64it/s]extract the null data:  53%|█████▎    | 91/173 [00:00<00:00, 484.59it/s]extract the null data:  89%|████████▉ | 154/173 [00:00<00:00, 548.10it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 516.45it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 202.46it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 203.80it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 204.54it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 205.18it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 205.90it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 210.96it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 213.67it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 206.83it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.96it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.30it/s] 16%|█▌        | 27/173 [00:00<00:01, 109.04it/s] 24%|██▎       | 41/173 [00:00<00:01, 120.06it/s] 32%|███▏      | 55/173 [00:00<00:00, 126.88it/s] 39%|███▉      | 68/173 [00:00<00:00, 127.00it/s] 47%|████▋     | 81/173 [00:00<00:00, 125.86it/s] 54%|█████▍    | 94/173 [00:00<00:00, 126.17it/s] 62%|██████▏   | 107/173 [00:00<00:00, 124.77it/s] 69%|██████▉   | 120/173 [00:00<00:00, 125.32it/s] 77%|███████▋  | 133/173 [00:01<00:00, 118.99it/s] 84%|████████▍ | 146/173 [00:01<00:00, 119.28it/s] 91%|█████████▏| 158/173 [00:01<00:00, 111.22it/s] 98%|█████████▊| 170/173 [00:01<00:00, 90.18it/s] 100%|██████████| 173/173 [00:01<00:00, 108.57it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.090, valid loss : 0.079, train acc : 0.643, valid acc : 0.714, train f1 : 0.504, valid f1 : 0.564
training process:   1%|          | 1/128 [01:02<2:12:15, 62.48s/it]Best score increase :0.000 -> 0.564
training process:   2%|▏         | 2/128 [01:55<1:59:37, 56.97s/it]Best score increase :0.564 -> 0.689
training process:   2%|▏         | 3/128 [02:47<1:53:37, 54.54s/it]Best score increase :0.689 -> 0.744
training process:   3%|▎         | 4/128 [03:38<1:49:44, 53.10s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.060, valid loss : 0.058, train acc : 0.883, valid acc : 0.919, train f1 : 0.723, valid f1 : 0.780
training process:   4%|▍         | 5/128 [04:39<1:54:44, 55.97s/it]Best score increase :0.744 -> 0.780
training process:   5%|▍         | 6/128 [05:30<1:50:25, 54.30s/it]Best score increase :0.780 -> 0.793
training process:   5%|▌         | 7/128 [06:20<1:46:45, 52.94s/it]Best score increase :0.793 -> 0.803
training process:   6%|▋         | 8/128 [07:10<1:44:21, 52.18s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.053, valid loss : 0.053, train acc : 0.912, valid acc : 0.922, train f1 : 0.768, valid f1 : 0.786
training process:   7%|▋         | 9/128 [08:11<1:48:41, 54.80s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [09:05<1:47:04, 54.44s/it]Best score increase :0.803 -> 0.805
training process:   9%|▊         | 11/128 [09:58<1:45:32, 54.12s/it]Best score increase :0.805 -> 0.812
training process:   9%|▉         | 12/128 [10:50<1:43:15, 53.41s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.050, valid loss : 0.051, train acc : 0.918, valid acc : 0.930, train f1 : 0.779, valid f1 : 0.804
training process:  10%|█         | 13/128 [11:49<1:45:31, 55.05s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:41<1:43:18, 54.37s/it]Best score increase :0.812 -> 0.819
training process:  12%|█▏        | 15/128 [13:32<1:39:59, 53.09s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:27<1:40:15, 53.71s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.048, valid loss : 0.051, train acc : 0.919, valid acc : 0.938, train f1 : 0.782, valid f1 : 0.818
training process:  13%|█▎        | 17/128 [15:29<1:44:05, 56.27s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [16:24<1:42:39, 55.99s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [17:16<1:39:21, 54.69s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [18:07<1:36:22, 53.54s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.047, valid loss : 0.050, train acc : 0.921, valid acc : 0.941, train f1 : 0.786, valid f1 : 0.826
training process:  16%|█▋        | 21/128 [19:02<1:36:09, 53.92s/it]Best score increase :0.819 -> 0.826
training process:  17%|█▋        | 22/128 [19:50<1:32:28, 52.34s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [20:42<1:31:09, 52.09s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [21:28<1:27:28, 50.47s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.045, valid loss : 0.049, train acc : 0.925, valid acc : 0.941, train f1 : 0.797, valid f1 : 0.824
training process:  20%|█▉        | 25/128 [22:24<1:29:00, 51.85s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [23:11<1:26:00, 50.59s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [24:01<1:24:40, 50.30s/it]EarlyStopping counter : 6 out of 12
training process:  22%|██▏       | 28/128 [24:51<1:23:51, 50.31s/it]EarlyStopping counter : 7 out of 12
epoch : 29, train loss : 0.044, valid loss : 0.048, train acc : 0.929, valid acc : 0.940, train f1 : 0.804, valid f1 : 0.824
training process:  23%|██▎       | 29/128 [25:51<1:27:52, 53.26s/it]EarlyStopping counter : 8 out of 12
training process:  23%|██▎       | 30/128 [26:40<1:24:34, 51.78s/it]Best score increase :0.826 -> 0.840
training process:  24%|██▍       | 31/128 [27:28<1:21:50, 50.63s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [28:14<1:19:04, 49.42s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.043, valid loss : 0.053, train acc : 0.929, valid acc : 0.947, train f1 : 0.805, valid f1 : 0.832
training process:  26%|██▌       | 33/128 [29:09<1:20:49, 51.05s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 34/128 [29:55<1:17:41, 49.59s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 35/128 [30:42<1:15:42, 48.84s/it]EarlyStopping counter : 5 out of 12
training process:  28%|██▊       | 36/128 [31:30<1:14:15, 48.43s/it]EarlyStopping counter : 6 out of 12
epoch : 37, train loss : 0.041, valid loss : 0.046, train acc : 0.930, valid acc : 0.942, train f1 : 0.809, valid f1 : 0.831
training process:  29%|██▉       | 37/128 [32:27<1:17:28, 51.08s/it]EarlyStopping counter : 7 out of 12
training process:  30%|██▉       | 38/128 [33:20<1:17:34, 51.72s/it]Best score increase :0.840 -> 0.844
training process:  30%|███       | 39/128 [34:11<1:16:05, 51.29s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [35:01<1:14:59, 51.13s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.041, valid loss : 0.044, train acc : 0.933, valid acc : 0.943, train f1 : 0.812, valid f1 : 0.838
training process:  32%|███▏      | 41/128 [36:03<1:18:40, 54.26s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [36:54<1:16:17, 53.23s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [37:49<1:16:27, 53.97s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [38:49<1:17:48, 55.58s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.041, valid loss : 0.046, train acc : 0.935, valid acc : 0.947, train f1 : 0.817, valid f1 : 0.841
training process:  35%|███▌      | 45/128 [39:56<1:21:49, 59.15s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [40:55<1:20:30, 58.91s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [41:52<1:19:03, 58.57s/it]Best score increase :0.844 -> 0.847
training process:  38%|███▊      | 48/128 [42:52<1:18:33, 58.91s/it]Best score increase :0.847 -> 0.848
epoch : 49, train loss : 0.039, valid loss : 0.045, train acc : 0.936, valid acc : 0.949, train f1 : 0.821, valid f1 : 0.845
training process:  38%|███▊      | 49/128 [43:58<1:20:32, 61.17s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [44:56<1:18:11, 60.15s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [45:55<1:16:34, 59.67s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [46:48<1:13:18, 57.87s/it]Best score increase :0.848 -> 0.851
epoch : 53, train loss : 0.039, valid loss : 0.048, train acc : 0.936, valid acc : 0.951, train f1 : 0.821, valid f1 : 0.848
training process:  41%|████▏     | 53/128 [47:50<1:13:50, 59.07s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [48:43<1:10:19, 57.02s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [49:35<1:07:45, 55.69s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [50:26<1:05:13, 54.35s/it]Best score increase :0.851 -> 0.852
epoch : 57, train loss : 0.039, valid loss : 0.053, train acc : 0.938, valid acc : 0.955, train f1 : 0.824, valid f1 : 0.854
training process:  45%|████▍     | 57/128 [51:25<1:05:48, 55.62s/it]Best score increase :0.852 -> 0.854
training process:  45%|████▌     | 58/128 [52:17<1:03:41, 54.59s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [53:09<1:01:45, 53.71s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [53:59<59:34, 52.56s/it]  EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.039, valid loss : 0.046, train acc : 0.937, valid acc : 0.948, train f1 : 0.823, valid f1 : 0.844
training process:  48%|████▊     | 61/128 [54:57<1:00:37, 54.30s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [55:50<59:12, 53.83s/it]  EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [56:41<57:34, 53.15s/it]EarlyStopping counter : 6 out of 12
training process:  50%|█████     | 64/128 [57:33<56:21, 52.83s/it]EarlyStopping counter : 7 out of 12
epoch : 65, train loss : 0.038, valid loss : 0.045, train acc : 0.941, valid acc : 0.949, train f1 : 0.831, valid f1 : 0.849
training process:  51%|█████     | 65/128 [58:33<57:41, 54.94s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 66/128 [59:25<55:50, 54.04s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 67/128 [1:00:16<53:50, 52.97s/it]EarlyStopping counter : 10 out of 12
training process:  53%|█████▎    | 68/128 [1:01:06<52:16, 52.27s/it]EarlyStopping counter : 11 out of 12
epoch : 69, train loss : 0.037, valid loss : 0.044, train acc : 0.942, valid acc : 0.947, train f1 : 0.833, valid f1 : 0.847
training process:  53%|█████▎    | 68/128 [1:02:07<54:49, 54.82s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 68, best f1 score : 0.854
training process finished, best loss : 0.053 and best acc : 0.955, best f1 : 0.854, best epoch : 56

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.69      0.77      0.72       580
           1       0.98      0.97      0.98      6818

    accuracy                           0.95      7398
   macro avg       0.83      0.87      0.85      7398
weighted avg       0.96      0.95      0.96      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.87, test loss : 3.056

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.83s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.73s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.92s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.94s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:56,  8.08s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.85s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.67s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:30,  7.63s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.84s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.94s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.92s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.88s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.86s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 187.44it/s] 17%|█▋        | 52/306 [00:00<00:00, 264.11it/s] 29%|██▉       | 89/306 [00:00<00:00, 309.81it/s] 45%|████▍     | 137/306 [00:00<00:00, 372.88it/s] 57%|█████▋    | 175/306 [00:00<00:00, 296.96it/s] 68%|██████▊   | 207/306 [00:00<00:00, 291.98it/s] 81%|████████  | 248/306 [00:00<00:00, 323.85it/s] 95%|█████████▌| 291/306 [00:00<00:00, 353.93it/s]100%|██████████| 306/306 [00:01<00:00, 300.67it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 597.28it/s]extract the null data:  22%|██▏       | 123/553 [00:00<00:00, 614.31it/s]extract the null data:  34%|███▎      | 186/553 [00:00<00:00, 617.64it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 626.80it/s]extract the null data:  57%|█████▋    | 314/553 [00:00<00:00, 624.19it/s]extract the null data:  68%|██████▊   | 377/553 [00:00<00:00, 622.66it/s]extract the null data:  80%|███████▉  | 440/553 [00:00<00:00, 617.32it/s]extract the null data:  91%|█████████ | 502/553 [00:00<00:00, 617.83it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 616.97it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 184.80it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 191.12it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 194.78it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 201.90it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 208.17it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 212.58it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:01, 213.65it/s]replace nan value:  31%|███       | 170/553 [00:00<00:01, 212.53it/s]replace nan value:  35%|███▍      | 192/553 [00:00<00:01, 209.21it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 207.52it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:01, 206.21it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 204.90it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 202.52it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 203.12it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 199.26it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 200.59it/s]replace nan value:  65%|██████▌   | 360/553 [00:01<00:00, 201.95it/s]replace nan value:  69%|██████▉   | 381/553 [00:01<00:00, 202.52it/s]replace nan value:  73%|███████▎  | 402/553 [00:01<00:00, 201.89it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 201.58it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 200.35it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 199.95it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 201.51it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 202.65it/s]replace nan value:  96%|█████████▌| 529/553 [00:02<00:00, 205.62it/s]replace nan value: 100%|█████████▉| 551/553 [00:02<00:00, 209.48it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 204.37it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 149.43it/s]  6%|▌         | 32/553 [00:00<00:03, 160.91it/s]  9%|▉         | 49/553 [00:00<00:03, 134.82it/s] 11%|█▏        | 63/553 [00:00<00:03, 131.29it/s] 14%|█▍        | 77/553 [00:00<00:03, 133.84it/s] 17%|█▋        | 92/553 [00:00<00:03, 137.63it/s] 19%|█▉        | 107/553 [00:00<00:03, 139.61it/s] 22%|██▏       | 122/553 [00:00<00:03, 142.48it/s] 25%|██▌       | 140/553 [00:00<00:02, 150.97it/s] 29%|██▉       | 160/553 [00:01<00:02, 163.34it/s] 32%|███▏      | 177/553 [00:01<00:02, 163.57it/s] 35%|███▌      | 195/553 [00:01<00:02, 167.80it/s] 39%|███▊      | 214/553 [00:01<00:01, 173.21it/s] 42%|████▏     | 232/553 [00:01<00:01, 163.34it/s] 45%|████▌     | 249/553 [00:01<00:01, 164.06it/s] 48%|████▊     | 266/553 [00:01<00:01, 162.76it/s] 51%|█████     | 283/553 [00:01<00:01, 156.64it/s] 54%|█████▍    | 299/553 [00:01<00:01, 153.41it/s] 57%|█████▋    | 315/553 [00:02<00:01, 147.62it/s] 60%|█████▉    | 330/553 [00:02<00:01, 146.63it/s] 63%|██████▎   | 346/553 [00:02<00:01, 149.57it/s] 65%|██████▌   | 362/553 [00:02<00:01, 143.95it/s] 69%|██████▊   | 379/553 [00:02<00:01, 149.66it/s] 71%|███████▏  | 395/553 [00:02<00:01, 136.31it/s] 74%|███████▍  | 411/553 [00:02<00:01, 141.77it/s] 77%|███████▋  | 426/553 [00:02<00:00, 129.72it/s] 80%|████████  | 444/553 [00:02<00:00, 141.45it/s] 84%|████████▎ | 462/553 [00:03<00:00, 148.92it/s] 86%|████████▋ | 478/553 [00:03<00:00, 146.18it/s] 89%|████████▉ | 493/553 [00:03<00:00, 139.34it/s] 92%|█████████▏| 508/553 [00:03<00:00, 135.45it/s] 94%|█████████▍| 522/553 [00:03<00:00, 120.44it/s] 97%|█████████▋| 535/553 [00:03<00:00, 106.77it/s]100%|█████████▉| 551/553 [00:03<00:00, 103.58it/s]100%|██████████| 553/553 [00:03<00:00, 140.45it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 355.12it/s]extract the null data:  75%|███████▍  | 104/139 [00:00<00:00, 545.05it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 553.78it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 227.52it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 228.37it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 223.37it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 221.58it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 222.12it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 223.21it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 223.50it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 129.98it/s] 19%|█▉        | 27/139 [00:00<00:00, 132.21it/s] 31%|███       | 43/139 [00:00<00:00, 143.87it/s] 42%|████▏     | 58/139 [00:00<00:00, 125.89it/s] 53%|█████▎    | 74/139 [00:00<00:00, 131.68it/s] 63%|██████▎   | 88/139 [00:00<00:00, 114.85it/s] 74%|███████▍  | 103/139 [00:00<00:00, 123.26it/s] 83%|████████▎ | 116/139 [00:00<00:00, 123.74it/s] 93%|█████████▎| 129/139 [00:01<00:00, 125.31it/s]100%|██████████| 139/139 [00:01<00:00, 126.97it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▍       | 43/173 [00:00<00:00, 426.97it/s]extract the null data:  64%|██████▍   | 111/173 [00:00<00:00, 573.75it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 586.28it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 219.23it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 218.28it/s]replace nan value:  39%|███▊      | 67/173 [00:00<00:00, 219.25it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 221.79it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 219.17it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 219.12it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 216.92it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 217.48it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 135.53it/s] 16%|█▌        | 28/173 [00:00<00:01, 119.94it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.01it/s] 34%|███▎      | 58/173 [00:00<00:00, 136.54it/s] 42%|████▏     | 72/173 [00:00<00:00, 136.97it/s] 50%|████▉     | 86/173 [00:00<00:00, 134.73it/s] 58%|█████▊    | 100/173 [00:00<00:00, 135.94it/s] 67%|██████▋   | 116/173 [00:00<00:00, 139.11it/s] 75%|███████▌  | 130/173 [00:00<00:00, 133.45it/s] 83%|████████▎ | 144/173 [00:01<00:00, 129.48it/s] 91%|█████████ | 157/173 [00:01<00:00, 118.39it/s] 98%|█████████▊| 169/173 [00:01<00:00, 98.27it/s] 100%|██████████| 173/173 [00:01<00:00, 117.30it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.231, valid loss : 0.122, train acc : 0.510, valid acc : 0.091, train f1 : 0.400, valid f1 : 0.086
training process:   1%|          | 1/128 [00:56<2:00:22, 56.87s/it]Best score increase :0.000 -> 0.086
training process:   2%|▏         | 2/128 [01:42<1:45:42, 50.34s/it]Best score increase :0.086 -> 0.106
training process:   2%|▏         | 3/128 [02:30<1:42:42, 49.30s/it]Best score increase :0.106 -> 0.131
training process:   3%|▎         | 4/128 [03:19<1:41:33, 49.14s/it]Best score increase :0.131 -> 0.210
epoch : 5, train loss : 0.100, valid loss : 0.108, train acc : 0.633, valid acc : 0.292, train f1 : 0.580, valid f1 : 0.280
training process:   4%|▍         | 5/128 [04:18<1:47:45, 52.57s/it]Best score increase :0.210 -> 0.280
training process:   5%|▍         | 6/128 [05:08<1:45:02, 51.66s/it]Best score increase :0.280 -> 0.376
training process:   5%|▌         | 7/128 [05:58<1:43:03, 51.10s/it]Best score increase :0.376 -> 0.392
training process:   6%|▋         | 8/128 [06:48<1:41:54, 50.95s/it]Best score increase :0.392 -> 0.477
epoch : 9, train loss : 0.078, valid loss : 0.080, train acc : 0.723, valid acc : 0.583, train f1 : 0.703, valid f1 : 0.492
training process:   7%|▋         | 9/128 [07:49<1:47:14, 54.07s/it]Best score increase :0.477 -> 0.492
training process:   8%|▊         | 10/128 [08:39<1:43:47, 52.78s/it]Best score increase :0.492 -> 0.493
training process:   9%|▊         | 11/128 [09:29<1:40:58, 51.79s/it]Best score increase :0.493 -> 0.503
training process:   9%|▉         | 12/128 [10:19<1:39:12, 51.32s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.068, valid loss : 0.066, train acc : 0.778, valid acc : 0.723, train f1 : 0.768, valid f1 : 0.593
training process:  10%|█         | 13/128 [11:20<1:43:56, 54.23s/it]Best score increase :0.503 -> 0.593
training process:  11%|█         | 14/128 [12:11<1:41:08, 53.23s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:02<1:39:14, 52.70s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [13:53<1:37:31, 52.24s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.062, valid loss : 0.078, train acc : 0.800, valid acc : 0.653, train f1 : 0.793, valid f1 : 0.542
training process:  13%|█▎        | 17/128 [14:53<1:40:33, 54.35s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [15:44<1:38:13, 53.58s/it]Best score increase :0.593 -> 0.622
training process:  15%|█▍        | 19/128 [16:36<1:36:09, 52.94s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [17:28<1:34:40, 52.59s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.056, valid loss : 0.068, train acc : 0.828, valid acc : 0.735, train f1 : 0.823, valid f1 : 0.603
training process:  16%|█▋        | 21/128 [18:26<1:37:06, 54.46s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [19:18<1:34:55, 53.73s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [20:11<1:33:36, 53.49s/it]Best score increase :0.622 -> 0.654
training process:  19%|█▉        | 24/128 [21:04<1:32:09, 53.17s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.056, valid loss : 0.063, train acc : 0.831, valid acc : 0.781, train f1 : 0.827, valid f1 : 0.640
training process:  20%|█▉        | 25/128 [22:05<1:35:16, 55.50s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [22:57<1:32:48, 54.60s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [23:47<1:29:30, 53.17s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [24:37<1:27:14, 52.34s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.052, valid loss : 0.074, train acc : 0.846, valid acc : 0.705, train f1 : 0.843, valid f1 : 0.580
training process:  23%|██▎       | 29/128 [25:37<1:29:56, 54.51s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [26:28<1:27:10, 53.37s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [27:17<1:24:20, 52.17s/it]EarlyStopping counter : 8 out of 12
training process:  25%|██▌       | 32/128 [28:08<1:22:58, 51.86s/it]EarlyStopping counter : 9 out of 12
epoch : 33, train loss : 0.050, valid loss : 0.061, train acc : 0.856, valid acc : 0.805, train f1 : 0.854, valid f1 : 0.663
training process:  26%|██▌       | 33/128 [29:09<1:26:14, 54.47s/it]Best score increase :0.654 -> 0.663
training process:  27%|██▋       | 34/128 [29:59<1:23:16, 53.16s/it]Best score increase :0.663 -> 0.696
training process:  27%|██▋       | 35/128 [30:48<1:20:38, 52.03s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [31:41<1:20:02, 52.20s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.050, valid loss : 0.068, train acc : 0.860, valid acc : 0.752, train f1 : 0.858, valid f1 : 0.618
training process:  29%|██▉       | 37/128 [32:41<1:22:54, 54.67s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [33:34<1:20:55, 53.95s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:26<1:19:28, 53.58s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [35:15<1:16:36, 52.23s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.046, valid loss : 0.061, train acc : 0.871, valid acc : 0.808, train f1 : 0.869, valid f1 : 0.667
training process:  32%|███▏      | 41/128 [36:14<1:18:29, 54.14s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [37:04<1:16:00, 53.03s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [37:57<1:14:49, 52.81s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [38:47<1:12:59, 52.14s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.046, valid loss : 0.063, train acc : 0.873, valid acc : 0.811, train f1 : 0.871, valid f1 : 0.669
training process:  35%|███▌      | 45/128 [39:47<1:15:20, 54.46s/it]EarlyStopping counter : 11 out of 12
training process:  35%|███▌      | 45/128 [40:37<1:14:55, 54.17s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.696
training process finished, best loss : 0.060 and best acc : 0.842, best f1 : 0.696, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.39      0.89      0.55       580
           1       0.99      0.88      0.93      6818

    accuracy                           0.88      7398
   macro avg       0.69      0.89      0.74      7398
weighted avg       0.94      0.88      0.90      7398


# test acc : 0.88, test f1 : 0.74, test AUC : 0.89, test loss : 2.717

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.90s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.94s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.91s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.89s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.91s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.12s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.91s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.79s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.72s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.77s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.80s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.81s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.85s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  9%|▉         | 28/306 [00:00<00:00, 279.63it/s] 24%|██▍       | 74/306 [00:00<00:00, 381.83it/s] 37%|███▋      | 113/306 [00:00<00:00, 281.18it/s] 50%|█████     | 154/306 [00:00<00:00, 316.11it/s] 64%|██████▍   | 196/306 [00:00<00:00, 347.68it/s] 79%|███████▉  | 243/306 [00:00<00:00, 384.24it/s] 93%|█████████▎| 284/306 [00:00<00:00, 313.33it/s]100%|██████████| 306/306 [00:00<00:00, 331.77it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 576.94it/s]extract the null data:  22%|██▏       | 120/553 [00:00<00:00, 600.68it/s]extract the null data:  33%|███▎      | 181/553 [00:00<00:00, 602.76it/s]extract the null data:  44%|████▍     | 243/553 [00:00<00:00, 608.43it/s]extract the null data:  55%|█████▌    | 305/553 [00:00<00:00, 609.35it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 601.71it/s]extract the null data:  77%|███████▋  | 427/553 [00:00<00:00, 599.46it/s]extract the null data:  88%|████████▊ | 489/553 [00:00<00:00, 605.20it/s]extract the null data: 100%|█████████▉| 551/553 [00:00<00:00, 606.31it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 603.78it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 197.68it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 195.92it/s]replace nan value:  11%|█         | 61/553 [00:00<00:02, 199.70it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 199.23it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 201.79it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 203.75it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 201.81it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:01, 199.19it/s]replace nan value:  34%|███▎      | 186/553 [00:00<00:01, 201.74it/s]replace nan value:  38%|███▊      | 208/553 [00:01<00:01, 204.32it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 202.95it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 202.42it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 201.44it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 208.18it/s]replace nan value:  57%|█████▋    | 315/553 [00:01<00:01, 206.06it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 204.30it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:00, 201.15it/s]replace nan value:  68%|██████▊   | 378/553 [00:01<00:00, 198.46it/s]replace nan value:  72%|███████▏  | 400/553 [00:01<00:00, 203.40it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 201.71it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 200.17it/s]replace nan value:  84%|████████▎ | 463/553 [00:02<00:00, 199.48it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 199.45it/s]replace nan value:  91%|█████████▏| 505/553 [00:02<00:00, 203.31it/s]replace nan value:  95%|█████████▌| 526/553 [00:02<00:00, 201.53it/s]replace nan value:  99%|█████████▉| 547/553 [00:02<00:00, 200.48it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 201.35it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.26it/s]  5%|▌         | 29/553 [00:00<00:03, 145.06it/s]  8%|▊         | 44/553 [00:00<00:03, 133.03it/s] 10%|█         | 58/553 [00:00<00:04, 122.11it/s] 13%|█▎        | 71/553 [00:00<00:04, 120.19it/s] 16%|█▌        | 88/553 [00:00<00:03, 134.11it/s] 18%|█▊        | 102/553 [00:00<00:03, 128.30it/s] 22%|██▏       | 120/553 [00:00<00:03, 141.32it/s] 24%|██▍       | 135/553 [00:01<00:02, 140.78it/s] 28%|██▊       | 153/553 [00:01<00:02, 150.96it/s] 31%|███       | 171/553 [00:01<00:02, 158.76it/s] 34%|███▍      | 188/553 [00:01<00:02, 153.87it/s] 37%|███▋      | 207/553 [00:01<00:02, 162.89it/s] 41%|████      | 224/553 [00:01<00:02, 153.00it/s] 43%|████▎     | 240/553 [00:01<00:02, 153.68it/s] 46%|████▋     | 256/553 [00:01<00:02, 146.51it/s] 49%|████▉     | 271/553 [00:01<00:01, 143.20it/s] 52%|█████▏    | 287/553 [00:01<00:01, 147.22it/s] 55%|█████▍    | 302/553 [00:02<00:01, 140.65it/s] 57%|█████▋    | 317/553 [00:02<00:01, 133.31it/s] 60%|█████▉    | 331/553 [00:02<00:01, 133.59it/s] 62%|██████▏   | 345/553 [00:02<00:01, 134.52it/s] 65%|██████▍   | 359/553 [00:02<00:01, 129.94it/s] 68%|██████▊   | 376/553 [00:02<00:01, 136.30it/s] 71%|███████   | 390/553 [00:02<00:01, 123.41it/s] 73%|███████▎  | 403/553 [00:02<00:01, 124.99it/s] 75%|███████▌  | 416/553 [00:03<00:01, 125.15it/s] 78%|███████▊  | 429/553 [00:03<00:01, 120.06it/s] 81%|████████  | 448/553 [00:03<00:00, 136.43it/s] 84%|████████▍ | 464/553 [00:03<00:00, 140.11it/s] 87%|████████▋ | 479/553 [00:03<00:00, 138.25it/s] 89%|████████▉ | 493/553 [00:03<00:00, 132.45it/s] 92%|█████████▏| 507/553 [00:03<00:00, 132.95it/s] 94%|█████████▍| 521/553 [00:03<00:00, 131.08it/s] 97%|█████████▋| 535/553 [00:03<00:00, 116.97it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.39it/s]100%|██████████| 553/553 [00:04<00:00, 133.88it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 355.16it/s]extract the null data:  76%|███████▌  | 105/139 [00:00<00:00, 546.76it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 550.36it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 224.10it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 222.80it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 222.49it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 219.17it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 219.00it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 220.12it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 220.59it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.04it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.37it/s] 29%|██▉       | 41/139 [00:00<00:00, 136.22it/s] 40%|███▉      | 55/139 [00:00<00:00, 126.16it/s] 50%|████▉     | 69/139 [00:00<00:00, 128.42it/s] 59%|█████▉    | 82/139 [00:00<00:00, 124.42it/s] 68%|██████▊   | 95/139 [00:00<00:00, 115.91it/s] 77%|███████▋  | 107/139 [00:00<00:00, 115.51it/s] 88%|████████▊ | 123/139 [00:00<00:00, 126.35it/s] 98%|█████████▊| 136/139 [00:01<00:00, 123.37it/s]100%|██████████| 139/139 [00:01<00:00, 124.69it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 374.62it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 553.10it/s]extract the null data:  99%|█████████▉| 171/173 [00:00<00:00, 594.60it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 565.25it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 213.63it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 210.58it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 212.25it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 213.79it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 215.18it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 214.44it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 211.06it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 210.17it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.92it/s] 16%|█▌        | 28/173 [00:00<00:01, 116.96it/s] 24%|██▍       | 42/173 [00:00<00:01, 126.26it/s] 34%|███▎      | 58/173 [00:00<00:00, 136.02it/s] 42%|████▏     | 72/173 [00:00<00:00, 135.80it/s] 50%|████▉     | 86/173 [00:00<00:00, 133.80it/s] 58%|█████▊    | 100/173 [00:00<00:00, 134.50it/s] 67%|██████▋   | 116/173 [00:00<00:00, 138.13it/s] 75%|███████▌  | 130/173 [00:00<00:00, 132.71it/s] 83%|████████▎ | 144/173 [00:01<00:00, 130.88it/s] 91%|█████████▏| 158/173 [00:01<00:00, 120.02it/s] 99%|█████████▉| 171/173 [00:01<00:00, 89.95it/s] 100%|██████████| 173/173 [00:01<00:00, 116.83it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.503, valid loss : 0.395, train f1 : 0.555, valid f1 : 0.542
training process - Deferred Re-weighting:   1%|          | 1/128 [00:38<1:20:42, 38.13s/it]Best score increase :0.000 -> 0.542
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:23<1:28:54, 42.34s/it]Best score increase :0.542 -> 0.578
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:10<1:32:52, 44.58s/it]Best score increase :0.578 -> 0.657
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:01<1:36:50, 46.86s/it]Best score increase :0.657 -> 0.742
epoch : 5, train loss : 0.252, valid loss : 0.225, train f1 : 0.747, valid f1 : 0.767
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:00<1:45:31, 51.48s/it]Best score increase :0.742 -> 0.767
training process - Deferred Re-weighting:   5%|▍         | 6/128 [04:52<1:44:59, 51.64s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:44<1:44:29, 51.81s/it]Best score increase :0.767 -> 0.785
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:38<1:44:32, 52.27s/it]Best score increase :0.785 -> 0.796
epoch : 9, train loss : 0.174, valid loss : 0.168, train f1 : 0.803, valid f1 : 0.797
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:37<1:48:13, 54.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:29<1:45:53, 53.84s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:20<1:43:04, 52.86s/it]Best score increase :0.796 -> 0.799
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:13<1:42:30, 53.02s/it]Best score increase :0.799 -> 0.806
epoch : 13, train loss : 0.151, valid loss : 0.149, train f1 : 0.811, valid f1 : 0.810
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:14<1:45:52, 55.24s/it]Best score increase :0.806 -> 0.810
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:05<1:42:29, 53.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:57<1:40:28, 53.35s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:50<1:39:29, 53.30s/it]Best score increase :0.810 -> 0.827
epoch : 17, train loss : 0.140, valid loss : 0.142, train f1 : 0.819, valid f1 : 0.818
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:49<1:41:59, 55.13s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:39<1:38:20, 53.64s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:31<1:36:03, 52.87s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:21<1:33:49, 52.13s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.134, valid loss : 0.140, train f1 : 0.828, valid f1 : 0.810
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:20<1:36:44, 54.25s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:10<1:33:26, 52.89s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:00<1:31:06, 52.06s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:51<1:29:58, 51.91s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.131, valid loss : 0.131, train f1 : 0.840, valid f1 : 0.826
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:52<1:33:33, 54.50s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:43<1:31:03, 53.56s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:34<1:28:34, 52.62s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:24<1:26:13, 51.74s/it]Best score increase :0.827 -> 0.830
epoch : 29, train loss : 0.124, valid loss : 0.132, train f1 : 0.845, valid f1 : 0.831
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:22<1:28:46, 53.81s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:12<1:25:48, 52.54s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:03<1:24:30, 52.27s/it]Best score increase :0.830 -> 0.843
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:55<1:23:08, 51.96s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.122, valid loss : 0.123, train f1 : 0.850, valid f1 : 0.845
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [28:55<1:26:10, 54.42s/it]Best score increase :0.843 -> 0.845
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:45<1:23:18, 53.18s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:35<1:21:07, 52.34s/it]Best score increase :0.845 -> 0.855
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:26<1:19:19, 51.74s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.118, valid loss : 0.120, train f1 : 0.851, valid f1 : 0.845
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:25<1:21:47, 53.93s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:15<1:19:26, 52.96s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:06<1:17:16, 52.10s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [34:57<1:16:07, 51.91s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.115, valid loss : 0.116, train f1 : 0.856, valid f1 : 0.860
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [35:57<1:18:46, 54.33s/it]Best score increase :0.855 -> 0.860
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:48<1:16:23, 53.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:38<1:14:12, 52.38s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:31<1:13:30, 52.50s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.112, valid loss : 0.116, train f1 : 0.861, valid f1 : 0.852
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [39:31<1:15:48, 54.80s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [40:23<1:13:35, 53.85s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:13<1:11:06, 52.67s/it]Best score increase :0.860 -> 0.867
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [42:05<1:10:09, 52.62s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.109, valid loss : 0.112, train f1 : 0.861, valid f1 : 0.864
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [43:07<1:12:47, 55.28s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [43:59<1:10:40, 54.37s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [44:49<1:08:06, 53.07s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [45:41<1:06:57, 52.87s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.107, valid loss : 0.120, train f1 : 0.870, valid f1 : 0.845
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [46:41<1:08:28, 54.78s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [47:30<1:05:28, 53.09s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [48:19<1:03:21, 52.07s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [49:09<1:01:43, 51.44s/it]EarlyStopping counter : 9 out of 12
epoch : 57, train loss : 0.105, valid loss : 0.119, train f1 : 0.865, valid f1 : 0.853
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [50:07<1:02:56, 53.19s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [50:56<1:00:52, 52.18s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [51:48<1:02:31, 53.60s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 58, best f1 score : 0.868
training process finished, best loss : 0.114, best acc : 0.965, best f1 : 0.868, best epoch : 50

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.89      0.69      0.78       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.93      0.84      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.84, test loss : 7.268

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.91s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.72s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.57s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.57s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.59s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.65s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:37,  7.50s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:29,  7.42s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.33s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:14,  7.23s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:21<00:07,  7.19s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.12s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.37s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 16%|█▋        | 50/306 [00:00<00:00, 497.17it/s] 33%|███▎      | 100/306 [00:00<00:00, 333.64it/s] 46%|████▌     | 140/306 [00:00<00:00, 354.38it/s] 60%|██████    | 184/306 [00:00<00:00, 381.49it/s] 77%|███████▋  | 236/306 [00:00<00:00, 424.79it/s] 92%|█████████▏| 281/306 [00:00<00:00, 350.60it/s]100%|██████████| 306/306 [00:00<00:00, 376.25it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_CE_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:00, 503.92it/s]extract the null data:  19%|█▊        | 103/553 [00:00<00:00, 512.58it/s]extract the null data:  28%|██▊       | 157/553 [00:00<00:00, 523.10it/s]extract the null data:  38%|███▊      | 210/553 [00:00<00:00, 518.33it/s]extract the null data:  48%|████▊     | 264/553 [00:00<00:00, 522.87it/s]extract the null data:  57%|█████▋    | 317/553 [00:00<00:00, 521.57it/s]extract the null data:  67%|██████▋   | 370/553 [00:00<00:00, 519.51it/s]extract the null data:  76%|███████▋  | 423/553 [00:00<00:00, 519.43it/s]extract the null data:  86%|████████▌ | 475/553 [00:00<00:00, 517.73it/s]extract the null data:  95%|█████████▌| 528/553 [00:01<00:00, 518.80it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 518.39it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 180.82it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 184.77it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 181.11it/s]replace nan value:  14%|█▎        | 76/553 [00:00<00:02, 182.08it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:02, 182.25it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 180.83it/s]replace nan value:  24%|██▍       | 133/553 [00:00<00:02, 182.10it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:02, 185.22it/s]replace nan value:  31%|███       | 172/553 [00:00<00:02, 186.47it/s]replace nan value:  35%|███▍      | 191/553 [00:01<00:01, 185.74it/s]replace nan value:  38%|███▊      | 210/553 [00:01<00:01, 185.79it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 185.29it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 183.87it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 184.20it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 183.75it/s]replace nan value:  55%|█████▌    | 305/553 [00:01<00:01, 184.34it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 184.92it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:01, 187.03it/s]replace nan value:  66%|██████▌   | 364/553 [00:01<00:01, 187.94it/s]replace nan value:  69%|██████▉   | 384/553 [00:02<00:00, 189.91it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 188.51it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 186.23it/s]replace nan value:  80%|███████▉  | 441/553 [00:02<00:00, 184.31it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 185.53it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 187.10it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 189.30it/s]replace nan value:  94%|█████████▍| 520/553 [00:02<00:00, 191.83it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 189.64it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 185.76it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.16it/s]  5%|▌         | 29/553 [00:00<00:03, 138.41it/s]  8%|▊         | 43/553 [00:00<00:03, 130.67it/s] 10%|█         | 57/553 [00:00<00:04, 121.25it/s] 13%|█▎        | 70/553 [00:00<00:04, 115.08it/s] 16%|█▌        | 86/553 [00:00<00:03, 127.95it/s] 18%|█▊        | 100/553 [00:00<00:03, 123.79it/s] 21%|██▏       | 118/553 [00:00<00:03, 139.54it/s] 24%|██▍       | 133/553 [00:01<00:03, 138.52it/s] 27%|██▋       | 151/553 [00:01<00:02, 149.16it/s] 31%|███       | 169/553 [00:01<00:02, 157.40it/s] 33%|███▎      | 185/553 [00:01<00:02, 149.93it/s] 37%|███▋      | 202/553 [00:01<00:02, 153.74it/s] 39%|███▉      | 218/553 [00:01<00:02, 152.20it/s] 42%|████▏     | 234/553 [00:01<00:02, 146.54it/s] 45%|████▌     | 249/553 [00:01<00:02, 144.22it/s] 48%|████▊     | 265/553 [00:01<00:01, 144.02it/s] 51%|█████     | 280/553 [00:02<00:01, 137.13it/s] 53%|█████▎    | 294/553 [00:02<00:01, 135.35it/s] 56%|█████▌    | 308/553 [00:02<00:01, 131.79it/s] 58%|█████▊    | 322/553 [00:02<00:01, 128.93it/s] 61%|██████    | 336/553 [00:02<00:01, 131.08it/s] 63%|██████▎   | 350/553 [00:02<00:01, 130.65it/s] 66%|██████▌   | 364/553 [00:02<00:01, 128.15it/s] 68%|██████▊   | 378/553 [00:02<00:01, 130.27it/s] 71%|███████   | 392/553 [00:02<00:01, 121.67it/s] 73%|███████▎  | 405/553 [00:03<00:01, 122.48it/s] 76%|███████▌  | 418/553 [00:03<00:01, 119.90it/s] 78%|███████▊  | 431/553 [00:03<00:01, 117.24it/s] 81%|████████  | 449/553 [00:03<00:00, 133.75it/s] 84%|████████▍ | 464/553 [00:03<00:00, 136.24it/s] 86%|████████▋ | 478/553 [00:03<00:00, 135.21it/s] 89%|████████▉ | 492/553 [00:03<00:00, 129.97it/s] 92%|█████████▏| 506/553 [00:03<00:00, 127.74it/s] 94%|█████████▍| 521/553 [00:03<00:00, 128.54it/s] 97%|█████████▋| 534/553 [00:04<00:00, 115.28it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.19it/s]100%|██████████| 553/553 [00:04<00:00, 130.39it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 347.90it/s]extract the null data:  71%|███████   | 98/139 [00:00<00:00, 513.35it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 521.84it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 204.82it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 206.92it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 205.10it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 206.92it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 205.28it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 202.05it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 203.93it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.49it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.31it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.34it/s] 39%|███▉      | 54/139 [00:00<00:00, 125.26it/s] 48%|████▊     | 67/139 [00:00<00:00, 125.31it/s] 58%|█████▊    | 80/139 [00:00<00:00, 124.06it/s] 67%|██████▋   | 93/139 [00:00<00:00, 113.09it/s] 76%|███████▋  | 106/139 [00:00<00:00, 115.51it/s] 88%|████████▊ | 122/139 [00:00<00:00, 123.62it/s] 97%|█████████▋| 135/139 [00:01<00:00, 121.52it/s]100%|██████████| 139/139 [00:01<00:00, 123.35it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██▏       | 37/173 [00:00<00:00, 369.35it/s]extract the null data:  58%|█████▊    | 101/173 [00:00<00:00, 527.59it/s]extract the null data:  97%|█████████▋| 168/173 [00:00<00:00, 589.96it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 559.18it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 222.69it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 222.63it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 219.12it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 216.46it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 216.23it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 215.71it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 214.55it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 215.02it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 136.58it/s] 17%|█▋        | 29/173 [00:00<00:01, 119.42it/s] 26%|██▌       | 45/173 [00:00<00:00, 134.21it/s] 35%|███▌      | 61/173 [00:00<00:00, 139.02it/s] 44%|████▍     | 76/173 [00:00<00:00, 135.84it/s] 52%|█████▏    | 90/173 [00:00<00:00, 135.54it/s] 60%|██████    | 104/173 [00:00<00:00, 131.82it/s] 68%|██████▊   | 118/173 [00:00<00:00, 133.75it/s] 76%|███████▋  | 132/173 [00:01<00:00, 128.84it/s] 84%|████████▍ | 145/173 [00:01<00:00, 128.05it/s] 91%|█████████▏| 158/173 [00:01<00:00, 118.49it/s] 98%|█████████▊| 170/173 [00:01<00:00, 97.92it/s] 100%|██████████| 173/173 [00:01<00:00, 117.40it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.590, valid loss : 0.489, train f1 : 0.683, valid f1 : 0.621
training process - Deferred Re-weighting:   1%|          | 1/128 [01:00<2:09:03, 60.97s/it]Best score increase :0.000 -> 0.621
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:51<1:55:34, 55.04s/it]Best score increase :0.621 -> 0.688
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:42<1:50:26, 53.01s/it]Best score increase :0.688 -> 0.755
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:34<1:48:56, 52.72s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.361, valid loss : 0.300, train f1 : 0.842, valid f1 : 0.764
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:34<1:53:09, 55.20s/it]Best score increase :0.755 -> 0.764
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:24<1:48:45, 53.49s/it]Best score increase :0.764 -> 0.781
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:15<1:45:58, 52.55s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:07<1:44:57, 52.48s/it]Best score increase :0.781 -> 0.801
epoch : 9, train loss : 0.320, valid loss : 0.251, train f1 : 0.864, valid f1 : 0.797
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:08<1:49:10, 55.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:59<1:45:43, 53.76s/it]Best score increase :0.801 -> 0.806
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:50<1:43:26, 53.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:42<1:41:42, 52.61s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.291, valid loss : 0.190, train f1 : 0.880, valid f1 : 0.822
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:42<1:45:10, 54.87s/it]Best score increase :0.806 -> 0.822
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:33<1:42:08, 53.75s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:25<1:40:07, 53.16s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:16<1:38:14, 52.63s/it]Best score increase :0.822 -> 0.825
epoch : 17, train loss : 0.274, valid loss : 0.295, train f1 : 0.888, valid f1 : 0.747
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:16<1:41:39, 54.95s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:07<1:38:37, 53.80s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:57<1:35:13, 52.41s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:47<1:33:17, 51.83s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.254, valid loss : 0.230, train f1 : 0.896, valid f1 : 0.779
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:47<1:36:40, 54.21s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:37<1:33:41, 53.03s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:26<1:30:40, 51.82s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:16<1:28:53, 51.28s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.246, valid loss : 0.229, train f1 : 0.899, valid f1 : 0.775
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:14<1:31:31, 53.31s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:04<1:29:03, 52.39s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:54<1:26:37, 51.46s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:47<1:32:43, 55.08s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 27, best f1 score : 0.825
training process finished, best loss : 0.203, best acc : 0.941, best f1 : 0.825, best epoch : 15

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.80      0.69       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.88      0.83      7398
weighted avg       0.95      0.94      0.95      7398


# test acc : 0.94, test f1 : 0.83, test AUC : 0.88, test loss : 11.950

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.71s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.81s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.81s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.88s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.78s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.77s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.92s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.90s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.75s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.75s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.78s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.75s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.79s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 25/306 [00:00<00:01, 246.50it/s] 19%|█▉        | 59/306 [00:00<00:00, 299.06it/s] 31%|███       | 94/306 [00:00<00:00, 321.15it/s] 42%|████▏     | 127/306 [00:00<00:00, 237.39it/s] 54%|█████▍    | 166/306 [00:00<00:00, 280.32it/s] 64%|██████▍   | 197/306 [00:00<00:00, 274.38it/s] 77%|███████▋  | 236/306 [00:00<00:00, 306.37it/s] 88%|████████▊ | 269/306 [00:00<00:00, 261.45it/s] 98%|█████████▊| 300/306 [00:01<00:00, 271.75it/s]100%|██████████| 306/306 [00:01<00:00, 274.72it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 50/553 [00:00<00:01, 497.31it/s]extract the null data:  18%|█▊        | 101/553 [00:00<00:00, 502.94it/s]extract the null data:  27%|██▋       | 152/553 [00:00<00:00, 497.39it/s]extract the null data:  37%|███▋      | 202/553 [00:00<00:00, 486.83it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 478.35it/s]extract the null data:  54%|█████▍    | 299/553 [00:00<00:00, 468.78it/s]extract the null data:  63%|██████▎   | 346/553 [00:00<00:00, 461.58it/s]extract the null data:  71%|███████   | 394/553 [00:00<00:00, 465.02it/s]extract the null data:  80%|███████▉  | 441/553 [00:00<00:00, 462.08it/s]extract the null data:  88%|████████▊ | 488/553 [00:01<00:00, 458.37it/s]extract the null data:  97%|█████████▋| 534/553 [00:01<00:00, 452.45it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 466.15it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.36it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 167.93it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:02, 167.40it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 167.90it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 167.13it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 170.31it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:02, 174.79it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 173.10it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:02, 173.18it/s]replace nan value:  32%|███▏      | 177/553 [00:01<00:02, 173.43it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:02, 173.39it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 175.47it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 173.04it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 171.38it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 169.74it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 169.10it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 169.20it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 169.91it/s]replace nan value:  61%|██████    | 338/553 [00:01<00:01, 170.46it/s]replace nan value:  64%|██████▍   | 356/553 [00:02<00:01, 169.07it/s]replace nan value:  68%|██████▊   | 375/553 [00:02<00:01, 173.41it/s]replace nan value:  71%|███████   | 393/553 [00:02<00:00, 173.20it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 172.27it/s]replace nan value:  78%|███████▊  | 429/553 [00:02<00:00, 170.36it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 169.40it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 170.22it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 171.22it/s]replace nan value:  91%|█████████ | 501/553 [00:02<00:00, 170.75it/s]replace nan value:  94%|█████████▍| 519/553 [00:03<00:00, 169.33it/s]replace nan value:  97%|█████████▋| 536/553 [00:03<00:00, 167.05it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 166.50it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 170.34it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.56it/s]  5%|▍         | 27/553 [00:00<00:03, 134.32it/s]  7%|▋         | 41/553 [00:00<00:03, 131.26it/s] 10%|▉         | 55/553 [00:00<00:04, 120.26it/s] 12%|█▏        | 68/553 [00:00<00:04, 108.59it/s] 15%|█▌        | 83/553 [00:00<00:03, 118.92it/s] 17%|█▋        | 96/553 [00:00<00:03, 121.22it/s] 20%|█▉        | 109/553 [00:00<00:03, 122.68it/s] 22%|██▏       | 124/553 [00:01<00:03, 128.35it/s] 25%|██▌       | 140/553 [00:01<00:03, 135.41it/s] 28%|██▊       | 157/553 [00:01<00:02, 144.90it/s] 31%|███       | 172/553 [00:01<00:02, 144.25it/s] 34%|███▍      | 187/553 [00:01<00:02, 140.52it/s] 37%|███▋      | 203/553 [00:01<00:02, 145.53it/s] 39%|███▉      | 218/553 [00:01<00:02, 143.47it/s] 42%|████▏     | 233/553 [00:01<00:02, 137.74it/s] 45%|████▍     | 247/553 [00:01<00:02, 138.25it/s] 47%|████▋     | 262/553 [00:01<00:02, 140.73it/s] 50%|█████     | 277/553 [00:02<00:02, 133.35it/s] 53%|█████▎    | 292/553 [00:02<00:01, 132.78it/s] 55%|█████▌    | 306/553 [00:02<00:01, 124.44it/s] 58%|█████▊    | 319/553 [00:02<00:01, 122.05it/s] 60%|██████    | 332/553 [00:02<00:01, 123.88it/s] 62%|██████▏   | 345/553 [00:02<00:01, 125.26it/s] 65%|██████▍   | 358/553 [00:02<00:01, 123.57it/s] 67%|██████▋   | 373/553 [00:02<00:01, 130.54it/s] 70%|██████▉   | 387/553 [00:02<00:01, 122.11it/s] 72%|███████▏  | 400/553 [00:03<00:01, 114.92it/s] 75%|███████▌  | 415/553 [00:03<00:01, 121.78it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.76it/s] 80%|████████  | 445/553 [00:03<00:00, 126.36it/s] 83%|████████▎ | 460/553 [00:03<00:00, 131.10it/s] 86%|████████▌ | 475/553 [00:03<00:00, 133.65it/s] 88%|████████▊ | 489/553 [00:03<00:00, 126.21it/s] 91%|█████████ | 502/553 [00:03<00:00, 121.23it/s] 93%|█████████▎| 517/553 [00:04<00:00, 126.90it/s] 96%|█████████▌| 530/553 [00:04<00:00, 107.77it/s] 98%|█████████▊| 544/553 [00:04<00:00, 114.60it/s]100%|██████████| 553/553 [00:04<00:00, 124.65it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 23/139 [00:00<00:00, 229.82it/s]extract the null data:  54%|█████▍    | 75/139 [00:00<00:00, 396.39it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 458.76it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 434.04it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 194.81it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 189.80it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 188.45it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 182.59it/s]replace nan value:  70%|██████▉   | 97/139 [00:00<00:00, 184.72it/s]replace nan value:  84%|████████▍ | 117/139 [00:00<00:00, 186.67it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 187.12it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 186.88it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 105.09it/s] 17%|█▋        | 23/139 [00:00<00:01, 112.28it/s] 27%|██▋       | 37/139 [00:00<00:00, 121.78it/s] 36%|███▌      | 50/139 [00:00<00:00, 121.47it/s] 45%|████▌     | 63/139 [00:00<00:00, 118.25it/s] 54%|█████▍    | 75/139 [00:00<00:00, 117.92it/s] 63%|██████▎   | 87/139 [00:00<00:00, 108.44it/s] 71%|███████   | 99/139 [00:00<00:00, 110.94it/s] 80%|███████▉  | 111/139 [00:00<00:00, 112.19it/s] 90%|████████▉ | 125/139 [00:01<00:00, 119.27it/s] 99%|█████████▉| 138/139 [00:01<00:00, 118.03it/s]100%|██████████| 139/139 [00:01<00:00, 116.23it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 305.94it/s]extract the null data:  52%|█████▏    | 90/173 [00:00<00:00, 470.41it/s]extract the null data:  87%|████████▋ | 150/173 [00:00<00:00, 526.86it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 499.87it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 194.45it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 189.64it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 189.06it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 191.23it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 191.72it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 191.99it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 190.77it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 189.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 189.77it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.59it/s] 16%|█▌        | 28/173 [00:00<00:01, 113.44it/s] 24%|██▎       | 41/173 [00:00<00:01, 119.76it/s] 32%|███▏      | 55/173 [00:00<00:00, 126.55it/s] 40%|███▉      | 69/173 [00:00<00:00, 126.35it/s] 48%|████▊     | 83/173 [00:00<00:00, 128.39it/s] 55%|█████▌    | 96/173 [00:00<00:00, 125.75it/s] 64%|██████▍   | 111/173 [00:00<00:00, 132.10it/s] 72%|███████▏  | 125/173 [00:00<00:00, 129.26it/s] 81%|████████  | 140/173 [00:01<00:00, 134.35it/s] 89%|████████▉ | 154/173 [00:01<00:00, 127.99it/s] 97%|█████████▋| 167/173 [00:01<00:00, 102.93it/s]100%|██████████| 173/173 [00:01<00:00, 116.91it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.103, valid loss : 0.081, train acc : 0.891, valid acc : 0.913, train f1 : 0.553, valid f1 : 0.541
training process:   1%|          | 1/128 [00:59<2:05:10, 59.14s/it]Best score increase :0.000 -> 0.541
training process:   2%|▏         | 2/128 [01:48<1:52:00, 53.34s/it]Best score increase :0.541 -> 0.613
training process:   2%|▏         | 3/128 [02:37<1:47:30, 51.60s/it]Best score increase :0.613 -> 0.695
training process:   3%|▎         | 4/128 [03:25<1:43:24, 50.04s/it]Best score increase :0.695 -> 0.746
epoch : 5, train loss : 0.050, valid loss : 0.048, train acc : 0.940, valid acc : 0.943, train f1 : 0.744, valid f1 : 0.761
training process:   4%|▍         | 5/128 [04:23<1:48:38, 52.99s/it]Best score increase :0.746 -> 0.761
training process:   5%|▍         | 6/128 [05:16<1:47:51, 53.05s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:09<1:46:24, 52.77s/it]Best score increase :0.761 -> 0.778
training process:   6%|▋         | 8/128 [07:00<1:44:49, 52.41s/it]Best score increase :0.778 -> 0.795
epoch : 9, train loss : 0.042, valid loss : 0.042, train acc : 0.951, valid acc : 0.950, train f1 : 0.799, valid f1 : 0.796
training process:   7%|▋         | 9/128 [08:01<1:49:03, 54.98s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:54<1:46:51, 54.34s/it]Best score increase :0.795 -> 0.798
training process:   9%|▊         | 11/128 [09:42<1:42:00, 52.31s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:33<1:40:39, 52.07s/it]Best score increase :0.798 -> 0.815
epoch : 13, train loss : 0.038, valid loss : 0.039, train acc : 0.956, valid acc : 0.954, train f1 : 0.821, valid f1 : 0.813
training process:  10%|█         | 13/128 [11:35<1:45:23, 54.98s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:26<1:42:15, 53.82s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [13:18<1:40:39, 53.45s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [14:11<1:39:06, 53.09s/it]Best score increase :0.815 -> 0.832
epoch : 17, train loss : 0.036, valid loss : 0.038, train acc : 0.958, valid acc : 0.955, train f1 : 0.833, valid f1 : 0.815
training process:  13%|█▎        | 17/128 [15:10<1:41:26, 54.83s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:59<1:37:29, 53.18s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [16:49<1:34:57, 52.27s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [17:38<1:32:13, 51.24s/it]Best score increase :0.832 -> 0.834
epoch : 21, train loss : 0.035, valid loss : 0.037, train acc : 0.959, valid acc : 0.956, train f1 : 0.837, valid f1 : 0.816
training process:  16%|█▋        | 21/128 [18:34<1:34:10, 52.81s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:26<1:32:40, 52.45s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:17<1:31:03, 52.04s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:06<1:28:24, 51.01s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.035, train acc : 0.961, valid acc : 0.958, train f1 : 0.844, valid f1 : 0.828
training process:  20%|█▉        | 25/128 [22:02<1:30:13, 52.56s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [22:51<1:27:44, 51.62s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [23:41<1:25:57, 51.07s/it]EarlyStopping counter : 7 out of 12
training process:  22%|██▏       | 28/128 [24:31<1:24:25, 50.65s/it]EarlyStopping counter : 8 out of 12
epoch : 29, train loss : 0.032, valid loss : 0.037, train acc : 0.961, valid acc : 0.955, train f1 : 0.848, valid f1 : 0.815
training process:  23%|██▎       | 29/128 [25:28<1:26:59, 52.72s/it]EarlyStopping counter : 9 out of 12
training process:  23%|██▎       | 30/128 [26:18<1:24:24, 51.68s/it]EarlyStopping counter : 10 out of 12
training process:  24%|██▍       | 31/128 [27:07<1:22:22, 50.95s/it]Best score increase :0.834 -> 0.844
training process:  25%|██▌       | 32/128 [27:56<1:20:53, 50.56s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.031, valid loss : 0.037, train acc : 0.962, valid acc : 0.956, train f1 : 0.853, valid f1 : 0.818
training process:  26%|██▌       | 33/128 [28:54<1:23:30, 52.74s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [29:43<1:20:49, 51.59s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [30:32<1:18:48, 50.84s/it]Best score increase :0.844 -> 0.845
training process:  28%|██▊       | 36/128 [31:22<1:17:21, 50.45s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.030, valid loss : 0.032, train acc : 0.962, valid acc : 0.960, train f1 : 0.853, valid f1 : 0.845
training process:  29%|██▉       | 37/128 [32:22<1:21:03, 53.44s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [33:11<1:18:01, 52.02s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [34:01<1:16:28, 51.55s/it]Best score increase :0.845 -> 0.863
training process:  31%|███▏      | 40/128 [34:52<1:15:03, 51.18s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.030, valid loss : 0.033, train acc : 0.963, valid acc : 0.961, train f1 : 0.856, valid f1 : 0.848
training process:  32%|███▏      | 41/128 [35:49<1:16:51, 53.01s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [36:37<1:13:53, 51.55s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [37:29<1:13:16, 51.72s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [38:20<1:11:57, 51.40s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.030, valid loss : 0.032, train acc : 0.963, valid acc : 0.962, train f1 : 0.857, valid f1 : 0.855
training process:  35%|███▌      | 45/128 [39:19<1:14:06, 53.57s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 46/128 [40:09<1:11:45, 52.51s/it]EarlyStopping counter : 7 out of 12
training process:  37%|███▋      | 47/128 [41:00<1:10:30, 52.23s/it]EarlyStopping counter : 8 out of 12
training process:  38%|███▊      | 48/128 [41:52<1:09:36, 52.21s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.029, valid loss : 0.031, train acc : 0.965, valid acc : 0.962, train f1 : 0.863, valid f1 : 0.854
training process:  38%|███▊      | 49/128 [42:52<1:11:34, 54.36s/it]EarlyStopping counter : 10 out of 12
training process:  39%|███▉      | 50/128 [43:42<1:09:15, 53.27s/it]EarlyStopping counter : 11 out of 12
training process:  39%|███▉      | 50/128 [44:34<1:09:31, 53.48s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 50, best f1 score : 0.863
training process finished, best loss : 0.032 and best acc : 0.964, best f1 : 0.863, best epoch : 46

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.92      0.65      0.76       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.82      0.87      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.82, test loss : 1.962

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.25s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.04s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.93s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.84s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.92s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:48,  8.02s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.87s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.91s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.93s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.87s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.90s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.95s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.93s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 14%|█▎        | 42/306 [00:00<00:00, 415.27it/s] 29%|██▉       | 89/306 [00:00<00:00, 442.62it/s] 44%|████▍     | 136/306 [00:00<00:00, 451.74it/s] 60%|██████    | 184/306 [00:00<00:00, 456.12it/s] 75%|███████▌  | 230/306 [00:00<00:00, 451.79it/s] 90%|█████████ | 276/306 [00:00<00:00, 435.40it/s]100%|██████████| 306/306 [00:00<00:00, 448.31it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 61/553 [00:00<00:00, 606.54it/s]extract the null data:  22%|██▏       | 123/553 [00:00<00:00, 608.99it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 612.37it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:00, 612.89it/s]extract the null data:  56%|█████▌    | 310/553 [00:00<00:00, 617.94it/s]extract the null data:  68%|██████▊   | 374/553 [00:00<00:00, 624.72it/s]extract the null data:  79%|███████▉  | 437/553 [00:00<00:00, 620.84it/s]extract the null data:  90%|█████████ | 500/553 [00:00<00:00, 618.17it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 615.47it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 198.42it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 199.28it/s]replace nan value:  11%|█         | 61/553 [00:00<00:02, 200.14it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 201.39it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 201.38it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 205.07it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:01, 206.10it/s]replace nan value:  30%|███       | 167/553 [00:00<00:01, 206.58it/s]replace nan value:  34%|███▍      | 188/553 [00:00<00:01, 204.60it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 204.11it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:01, 201.99it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 199.05it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 199.93it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 200.22it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 201.99it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 204.23it/s]replace nan value:  64%|██████▍   | 356/553 [00:01<00:00, 204.02it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 203.58it/s]replace nan value:  72%|███████▏  | 398/553 [00:01<00:00, 203.51it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 205.31it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 205.19it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 205.75it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 203.43it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 201.86it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 201.72it/s]replace nan value:  99%|█████████▊| 545/553 [00:02<00:00, 202.01it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 202.62it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.35it/s]  5%|▌         | 29/553 [00:00<00:03, 142.47it/s]  8%|▊         | 44/553 [00:00<00:03, 131.85it/s] 10%|█         | 58/553 [00:00<00:04, 121.80it/s] 13%|█▎        | 71/553 [00:00<00:04, 120.03it/s] 16%|█▌        | 88/553 [00:00<00:03, 134.41it/s] 18%|█▊        | 102/553 [00:00<00:03, 128.95it/s] 22%|██▏       | 120/553 [00:00<00:03, 141.64it/s] 24%|██▍       | 135/553 [00:01<00:02, 141.46it/s] 28%|██▊       | 153/553 [00:01<00:02, 152.23it/s] 31%|███       | 171/553 [00:01<00:02, 159.43it/s] 34%|███▍      | 188/553 [00:01<00:02, 154.29it/s] 37%|███▋      | 207/553 [00:01<00:02, 163.30it/s] 41%|████      | 224/553 [00:01<00:02, 153.77it/s] 44%|████▎     | 241/553 [00:01<00:02, 155.43it/s] 46%|████▋     | 257/553 [00:01<00:01, 149.52it/s] 49%|████▉     | 273/553 [00:01<00:01, 146.05it/s] 52%|█████▏    | 290/553 [00:01<00:01, 150.40it/s] 55%|█████▌    | 306/553 [00:02<00:01, 135.58it/s] 58%|█████▊    | 320/553 [00:02<00:01, 131.22it/s] 61%|██████    | 335/553 [00:02<00:01, 134.91it/s] 63%|██████▎   | 349/553 [00:02<00:01, 134.04it/s] 66%|██████▌   | 363/553 [00:02<00:01, 132.00it/s] 68%|██████▊   | 378/553 [00:02<00:01, 135.62it/s] 71%|███████   | 392/553 [00:02<00:01, 126.04it/s] 73%|███████▎  | 405/553 [00:02<00:01, 126.32it/s] 76%|███████▌  | 418/553 [00:03<00:01, 124.15it/s] 78%|███████▊  | 431/553 [00:03<00:01, 121.28it/s] 81%|████████▏ | 450/553 [00:03<00:00, 139.61it/s] 84%|████████▍ | 465/553 [00:03<00:00, 140.77it/s] 87%|████████▋ | 480/553 [00:03<00:00, 137.11it/s] 89%|████████▉ | 494/553 [00:03<00:00, 131.66it/s] 92%|█████████▏| 509/553 [00:03<00:00, 135.36it/s] 95%|█████████▍| 523/553 [00:03<00:00, 127.18it/s] 97%|█████████▋| 536/553 [00:03<00:00, 117.58it/s]100%|█████████▉| 551/553 [00:04<00:00, 107.85it/s]100%|██████████| 553/553 [00:04<00:00, 134.29it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 355.89it/s]extract the null data:  75%|███████▍  | 104/139 [00:00<00:00, 542.89it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 545.20it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 218.99it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 217.53it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 217.45it/s]replace nan value:  64%|██████▍   | 89/139 [00:00<00:00, 220.37it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 219.58it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 217.87it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 218.50it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.09it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.16it/s] 30%|███       | 42/139 [00:00<00:00, 139.90it/s] 40%|████      | 56/139 [00:00<00:00, 125.86it/s] 51%|█████     | 71/139 [00:00<00:00, 132.16it/s] 61%|██████    | 85/139 [00:00<00:00, 126.01it/s] 71%|███████   | 98/139 [00:00<00:00, 118.94it/s] 80%|███████▉  | 111/139 [00:00<00:00, 117.31it/s] 91%|█████████ | 126/139 [00:01<00:00, 123.29it/s]100%|██████████| 139/139 [00:01<00:00, 126.99it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 357.48it/s]extract the null data:  60%|██████    | 104/173 [00:00<00:00, 545.06it/s]extract the null data:  98%|█████████▊| 170/173 [00:00<00:00, 596.55it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 564.21it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 219.66it/s]replace nan value:  26%|██▌       | 45/173 [00:00<00:00, 223.16it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 220.27it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 219.86it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 219.34it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 221.51it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 220.89it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 219.60it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 136.64it/s] 17%|█▋        | 29/173 [00:00<00:01, 119.33it/s] 26%|██▌       | 45/173 [00:00<00:00, 135.61it/s] 36%|███▌      | 62/173 [00:00<00:00, 144.84it/s] 45%|████▌     | 78/173 [00:00<00:00, 148.64it/s] 54%|█████▍    | 94/173 [00:00<00:00, 151.32it/s] 64%|██████▍   | 111/173 [00:00<00:00, 155.59it/s] 73%|███████▎  | 127/173 [00:00<00:00, 149.70it/s] 83%|████████▎ | 143/173 [00:00<00:00, 149.52it/s] 92%|█████████▏| 159/173 [00:01<00:00, 137.02it/s]100%|██████████| 173/173 [00:01<00:00, 106.87it/s]100%|██████████| 173/173 [00:01<00:00, 130.89it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.145, valid loss : 0.121, train acc : 0.697, valid acc : 0.830, train f1 : 0.694, valid f1 : 0.655
training process:   1%|          | 1/128 [00:57<2:02:00, 57.64s/it]Best score increase :0.000 -> 0.655
training process:   2%|▏         | 2/128 [01:49<1:53:42, 54.15s/it]Best score increase :0.655 -> 0.701
training process:   2%|▏         | 3/128 [02:39<1:48:47, 52.22s/it]Best score increase :0.701 -> 0.762
training process:   3%|▎         | 4/128 [03:31<1:47:58, 52.24s/it]Best score increase :0.762 -> 0.775
epoch : 5, train loss : 0.088, valid loss : 0.084, train acc : 0.853, valid acc : 0.900, train f1 : 0.853, valid f1 : 0.761
training process:   4%|▍         | 5/128 [04:31<1:52:32, 54.90s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:22<1:48:56, 53.58s/it]Best score increase :0.775 -> 0.796
training process:   5%|▌         | 7/128 [06:12<1:46:06, 52.61s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:04<1:44:42, 52.36s/it]Best score increase :0.796 -> 0.812
epoch : 9, train loss : 0.079, valid loss : 0.059, train acc : 0.870, valid acc : 0.934, train f1 : 0.870, valid f1 : 0.811
training process:   7%|▋         | 9/128 [08:05<1:49:17, 55.11s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:56<1:45:47, 53.79s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:48<1:43:37, 53.14s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [10:40<1:42:10, 52.85s/it]EarlyStopping counter : 4 out of 12
epoch : 13, train loss : 0.073, valid loss : 0.050, train acc : 0.883, valid acc : 0.944, train f1 : 0.883, valid f1 : 0.827
training process:  10%|█         | 13/128 [11:41<1:46:01, 55.32s/it]Best score increase :0.812 -> 0.827
training process:  11%|█         | 14/128 [12:33<1:43:17, 54.36s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:25<1:41:15, 53.76s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:15<1:37:45, 52.37s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.070, valid loss : 0.081, train acc : 0.891, valid acc : 0.884, train f1 : 0.891, valid f1 : 0.744
training process:  13%|█▎        | 17/128 [15:13<1:40:19, 54.23s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [16:04<1:37:17, 53.07s/it]EarlyStopping counter : 5 out of 12
training process:  15%|█▍        | 19/128 [16:54<1:35:10, 52.39s/it]EarlyStopping counter : 6 out of 12
training process:  16%|█▌        | 20/128 [17:43<1:32:28, 51.38s/it]EarlyStopping counter : 7 out of 12
epoch : 21, train loss : 0.066, valid loss : 0.057, train acc : 0.896, valid acc : 0.917, train f1 : 0.896, valid f1 : 0.780
training process:  16%|█▋        | 21/128 [18:44<1:36:19, 54.02s/it]EarlyStopping counter : 8 out of 12
training process:  17%|█▋        | 22/128 [19:35<1:34:03, 53.24s/it]EarlyStopping counter : 9 out of 12
training process:  18%|█▊        | 23/128 [20:27<1:32:34, 52.90s/it]EarlyStopping counter : 10 out of 12
training process:  19%|█▉        | 24/128 [21:19<1:30:59, 52.50s/it]EarlyStopping counter : 11 out of 12
epoch : 25, train loss : 0.064, valid loss : 0.056, train acc : 0.899, valid acc : 0.916, train f1 : 0.899, valid f1 : 0.781
training process:  19%|█▉        | 24/128 [22:19<1:36:43, 55.80s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 24, best f1 score : 0.827
training process finished, best loss : 0.050 and best acc : 0.944, best f1 : 0.827, best epoch : 12

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.75      0.71       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.83      0.86      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.86, test loss : 2.699

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.54s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.78s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.89s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.99s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.94s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.93s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.79s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.76s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.78s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.75s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.68s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.65s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.77s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 13%|█▎        | 40/306 [00:00<00:00, 358.46it/s] 29%|██▉       | 89/306 [00:00<00:00, 431.27it/s] 45%|████▌     | 138/306 [00:00<00:00, 453.28it/s] 60%|██████    | 184/306 [00:00<00:00, 350.23it/s] 77%|███████▋  | 237/306 [00:00<00:00, 402.99it/s] 92%|█████████▏| 281/306 [00:00<00:00, 378.00it/s]100%|██████████| 306/306 [00:00<00:00, 394.92it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 52/553 [00:00<00:00, 518.54it/s]extract the null data:  19%|█▉        | 107/553 [00:00<00:00, 534.19it/s]extract the null data:  29%|██▉       | 162/553 [00:00<00:00, 540.27it/s]extract the null data:  40%|████      | 222/553 [00:00<00:00, 560.40it/s]extract the null data:  50%|█████     | 279/553 [00:00<00:00, 546.73it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 532.29it/s]extract the null data:  70%|███████   | 388/553 [00:00<00:00, 523.95it/s]extract the null data:  80%|███████▉  | 442/553 [00:00<00:00, 528.02it/s]extract the null data:  90%|████████▉ | 497/553 [00:00<00:00, 533.21it/s]extract the null data: 100%|█████████▉| 552/553 [00:01<00:00, 536.07it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 535.57it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 170.79it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:02, 179.60it/s]replace nan value:  10%|█         | 56/553 [00:00<00:02, 180.67it/s]replace nan value:  14%|█▎        | 75/553 [00:00<00:02, 183.12it/s]replace nan value:  17%|█▋        | 94/553 [00:00<00:02, 180.90it/s]replace nan value:  20%|██        | 113/553 [00:00<00:02, 182.62it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:02, 180.67it/s]replace nan value:  27%|██▋       | 151/553 [00:00<00:02, 183.20it/s]replace nan value:  31%|███       | 170/553 [00:00<00:02, 184.42it/s]replace nan value:  34%|███▍      | 189/553 [00:01<00:01, 182.89it/s]replace nan value:  38%|███▊      | 208/553 [00:01<00:01, 184.23it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 184.04it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 184.98it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 188.62it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 188.76it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 188.95it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 186.11it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 185.99it/s]replace nan value:  65%|██████▌   | 361/553 [00:01<00:01, 185.77it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:00, 187.51it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 188.10it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 187.00it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 183.76it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 183.27it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 183.43it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 184.38it/s]replace nan value:  93%|█████████▎| 514/553 [00:02<00:00, 182.51it/s]replace nan value:  96%|█████████▋| 533/553 [00:02<00:00, 180.77it/s]replace nan value: 100%|█████████▉| 552/553 [00:03<00:00, 180.26it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 183.79it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 133.29it/s]  5%|▌         | 28/553 [00:00<00:03, 136.77it/s]  8%|▊         | 42/553 [00:00<00:03, 130.98it/s] 10%|█         | 56/553 [00:00<00:04, 123.47it/s] 12%|█▏        | 69/553 [00:00<00:04, 114.09it/s] 15%|█▌        | 85/553 [00:00<00:03, 125.99it/s] 18%|█▊        | 98/553 [00:00<00:03, 123.60it/s] 21%|██        | 114/553 [00:00<00:03, 133.30it/s] 23%|██▎       | 128/553 [00:00<00:03, 132.08it/s] 27%|██▋       | 147/553 [00:01<00:02, 146.72it/s] 29%|██▉       | 163/553 [00:01<00:02, 147.73it/s] 32%|███▏      | 179/553 [00:01<00:02, 149.75it/s] 35%|███▌      | 195/553 [00:01<00:02, 150.84it/s] 38%|███▊      | 212/553 [00:01<00:02, 155.62it/s] 41%|████      | 228/553 [00:01<00:02, 146.67it/s] 44%|████▍     | 243/553 [00:01<00:02, 145.54it/s] 47%|████▋     | 258/553 [00:01<00:02, 142.62it/s] 49%|████▉     | 273/553 [00:01<00:02, 139.86it/s] 52%|█████▏    | 289/553 [00:02<00:01, 143.85it/s] 55%|█████▍    | 304/553 [00:02<00:01, 136.04it/s] 58%|█████▊    | 318/553 [00:02<00:01, 127.67it/s] 60%|██████    | 332/553 [00:02<00:01, 128.87it/s] 63%|██████▎   | 346/553 [00:02<00:01, 131.57it/s] 65%|██████▌   | 360/553 [00:02<00:01, 123.56it/s] 68%|██████▊   | 376/553 [00:02<00:01, 131.34it/s] 71%|███████   | 390/553 [00:02<00:01, 120.46it/s] 73%|███████▎  | 403/553 [00:03<00:01, 121.60it/s] 75%|███████▌  | 416/553 [00:03<00:01, 121.11it/s] 78%|███████▊  | 429/553 [00:03<00:01, 116.16it/s] 81%|████████  | 447/553 [00:03<00:00, 132.00it/s] 84%|████████▎ | 462/553 [00:03<00:00, 135.17it/s] 86%|████████▋ | 477/553 [00:03<00:00, 138.07it/s] 89%|████████▉ | 491/553 [00:03<00:00, 127.60it/s] 91%|█████████ | 504/553 [00:03<00:00, 126.06it/s] 94%|█████████▍| 519/553 [00:03<00:00, 130.45it/s] 96%|█████████▋| 533/553 [00:04<00:00, 111.83it/s] 99%|█████████▉| 549/553 [00:04<00:00, 122.53it/s]100%|██████████| 553/553 [00:04<00:00, 129.41it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 327.53it/s]extract the null data:  68%|██████▊   | 95/139 [00:00<00:00, 497.47it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 509.03it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 206.11it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 207.42it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 204.30it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 202.66it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 199.33it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 201.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 203.14it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.72it/s] 17%|█▋        | 24/139 [00:00<00:00, 120.41it/s] 27%|██▋       | 38/139 [00:00<00:00, 126.89it/s] 37%|███▋      | 51/139 [00:00<00:00, 123.47it/s] 46%|████▌     | 64/139 [00:00<00:00, 124.28it/s] 55%|█████▌    | 77/139 [00:00<00:00, 120.80it/s] 65%|██████▍   | 90/139 [00:00<00:00, 108.78it/s] 75%|███████▍  | 104/139 [00:00<00:00, 116.58it/s] 84%|████████▍ | 117/139 [00:00<00:00, 118.02it/s] 94%|█████████▎| 130/139 [00:01<00:00, 121.23it/s]100%|██████████| 139/139 [00:01<00:00, 120.45it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 299.11it/s]extract the null data:  50%|█████     | 87/173 [00:00<00:00, 456.19it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 538.23it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 512.33it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 206.66it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 211.26it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 208.97it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 205.90it/s]replace nan value:  62%|██████▏   | 107/173 [00:00<00:00, 204.96it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 206.38it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 205.24it/s]replace nan value:  98%|█████████▊| 170/173 [00:00<00:00, 202.57it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 204.69it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.78it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.91it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.15it/s] 32%|███▏      | 56/173 [00:00<00:00, 128.80it/s] 40%|████      | 70/173 [00:00<00:00, 127.15it/s] 49%|████▊     | 84/173 [00:00<00:00, 126.57it/s] 57%|█████▋    | 98/173 [00:00<00:00, 128.34it/s] 65%|██████▌   | 113/173 [00:00<00:00, 131.74it/s] 73%|███████▎  | 127/173 [00:01<00:00, 126.28it/s] 81%|████████  | 140/173 [00:01<00:00, 126.31it/s] 88%|████████▊ | 153/173 [00:01<00:00, 122.19it/s] 96%|█████████▌| 166/173 [00:01<00:00, 100.89it/s]100%|██████████| 173/173 [00:01<00:00, 115.68it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.022, valid loss : 0.020, train acc : 0.733, valid acc : 0.836, train f1 : 0.555, valid f1 : 0.657
training process:   1%|          | 1/128 [00:59<2:05:09, 59.13s/it]Best score increase :0.000 -> 0.657
training process:   2%|▏         | 2/128 [01:48<1:52:21, 53.50s/it]Best score increase :0.657 -> 0.693
training process:   2%|▏         | 3/128 [02:37<1:47:20, 51.52s/it]Best score increase :0.693 -> 0.736
training process:   3%|▎         | 4/128 [03:25<1:43:39, 50.16s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.015, valid loss : 0.014, train acc : 0.885, valid acc : 0.914, train f1 : 0.726, valid f1 : 0.777
training process:   4%|▍         | 5/128 [04:23<1:48:14, 52.80s/it]Best score increase :0.736 -> 0.777
training process:   5%|▍         | 6/128 [05:15<1:46:34, 52.42s/it]Best score increase :0.777 -> 0.793
training process:   5%|▌         | 7/128 [06:05<1:44:14, 51.69s/it]Best score increase :0.793 -> 0.803
training process:   6%|▋         | 8/128 [06:54<1:42:01, 51.02s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.013, valid loss : 0.014, train acc : 0.910, valid acc : 0.929, train f1 : 0.765, valid f1 : 0.800
training process:   7%|▋         | 9/128 [07:53<1:46:02, 53.46s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [08:44<1:43:34, 52.66s/it]Best score increase :0.803 -> 0.813
training process:   9%|▊         | 11/128 [09:34<1:41:07, 51.86s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:26<1:40:02, 51.75s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.013, valid loss : 0.013, train acc : 0.917, valid acc : 0.931, train f1 : 0.778, valid f1 : 0.804
training process:  10%|█         | 13/128 [11:27<1:44:35, 54.57s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:16<1:40:57, 53.13s/it]Best score increase :0.813 -> 0.824
training process:  12%|█▏        | 15/128 [13:06<1:38:07, 52.10s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [13:57<1:36:20, 51.61s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.012, valid loss : 0.014, train acc : 0.922, valid acc : 0.941, train f1 : 0.790, valid f1 : 0.821
training process:  13%|█▎        | 17/128 [14:56<1:39:53, 53.99s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [15:46<1:36:36, 52.70s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [16:39<1:35:42, 52.68s/it]Best score increase :0.824 -> 0.831
training process:  16%|█▌        | 20/128 [17:31<1:34:47, 52.66s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.012, valid loss : 0.013, train acc : 0.925, valid acc : 0.943, train f1 : 0.796, valid f1 : 0.828
training process:  16%|█▋        | 21/128 [18:30<1:37:14, 54.52s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [19:21<1:34:43, 53.62s/it]Best score increase :0.831 -> 0.834
training process:  18%|█▊        | 23/128 [20:13<1:32:51, 53.06s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:03<1:30:02, 51.95s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.011, valid loss : 0.013, train acc : 0.930, valid acc : 0.947, train f1 : 0.808, valid f1 : 0.837
training process:  20%|█▉        | 25/128 [22:01<1:32:21, 53.80s/it]Best score increase :0.834 -> 0.837
training process:  20%|██        | 26/128 [22:52<1:30:23, 53.17s/it]Best score increase :0.837 -> 0.838
training process:  21%|██        | 27/128 [23:42<1:27:35, 52.04s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:32<1:25:39, 51.39s/it]Best score increase :0.838 -> 0.846
epoch : 29, train loss : 0.011, valid loss : 0.015, train acc : 0.934, valid acc : 0.953, train f1 : 0.816, valid f1 : 0.850
training process:  23%|██▎       | 29/128 [25:30<1:28:16, 53.50s/it]Best score increase :0.846 -> 0.850
training process:  23%|██▎       | 30/128 [26:20<1:25:37, 52.42s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [27:10<1:23:40, 51.76s/it]EarlyStopping counter : 2 out of 12
training process:  25%|██▌       | 32/128 [28:01<1:22:32, 51.58s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.011, valid loss : 0.015, train acc : 0.935, valid acc : 0.951, train f1 : 0.819, valid f1 : 0.846
training process:  26%|██▌       | 33/128 [29:00<1:24:57, 53.66s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 34/128 [29:50<1:22:31, 52.67s/it]Best score increase :0.850 -> 0.852
training process:  27%|██▋       | 35/128 [30:41<1:20:32, 51.97s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [31:31<1:18:46, 51.38s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.010, valid loss : 0.013, train acc : 0.935, valid acc : 0.948, train f1 : 0.818, valid f1 : 0.845
training process:  29%|██▉       | 37/128 [32:32<1:22:19, 54.28s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [33:23<1:20:09, 53.44s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:13<1:17:45, 52.42s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [35:03<1:15:39, 51.59s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.013, train acc : 0.940, valid acc : 0.946, train f1 : 0.828, valid f1 : 0.841
training process:  32%|███▏      | 41/128 [36:00<1:17:17, 53.31s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [36:48<1:14:00, 51.64s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [37:38<1:12:38, 51.27s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [38:27<1:10:43, 50.52s/it]Best score increase :0.852 -> 0.854
epoch : 45, train loss : 0.010, valid loss : 0.014, train acc : 0.940, valid acc : 0.951, train f1 : 0.829, valid f1 : 0.851
training process:  35%|███▌      | 45/128 [39:22<1:11:33, 51.73s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [40:09<1:09:03, 50.54s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [41:01<1:08:29, 50.74s/it]EarlyStopping counter : 3 out of 12
training process:  38%|███▊      | 48/128 [41:46<1:05:30, 49.13s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.010, valid loss : 0.014, train acc : 0.943, valid acc : 0.951, train f1 : 0.836, valid f1 : 0.851
training process:  38%|███▊      | 49/128 [42:40<1:06:29, 50.51s/it]EarlyStopping counter : 5 out of 12
training process:  39%|███▉      | 50/128 [43:26<1:03:51, 49.13s/it]Best score increase :0.854 -> 0.863
training process:  40%|███▉      | 51/128 [44:16<1:03:36, 49.57s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [45:03<1:01:40, 48.69s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.010, valid loss : 0.016, train acc : 0.940, valid acc : 0.958, train f1 : 0.830, valid f1 : 0.860
training process:  41%|████▏     | 53/128 [46:01<1:04:20, 51.48s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [46:50<1:02:37, 50.77s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [47:38<1:00:50, 50.01s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [48:28<59:47, 49.83s/it]  EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.010, valid loss : 0.018, train acc : 0.944, valid acc : 0.958, train f1 : 0.838, valid f1 : 0.857
training process:  45%|████▍     | 57/128 [49:22<1:00:33, 51.18s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [50:10<58:43, 50.34s/it]  EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [50:59<57:15, 49.79s/it]EarlyStopping counter : 9 out of 12
training process:  47%|████▋     | 60/128 [51:47<55:57, 49.38s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.010, valid loss : 0.014, train acc : 0.941, valid acc : 0.956, train f1 : 0.831, valid f1 : 0.863
training process:  48%|████▊     | 61/128 [52:48<58:57, 52.79s/it]EarlyStopping counter : 11 out of 12
training process:  48%|████▊     | 61/128 [53:40<58:57, 52.80s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.863
training process finished, best loss : 0.014 and best acc : 0.956, best f1 : 0.863, best epoch : 60

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.64      0.77      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.87      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.87, test loss : 0.857

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.98s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.78s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.79s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:01,  7.75s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.86s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.89s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.90s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.81s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.82s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.78s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.74s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.74s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.80s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 26/306 [00:00<00:01, 255.60it/s] 20%|█▉        | 60/306 [00:00<00:00, 301.78it/s] 31%|███▏      | 96/306 [00:00<00:00, 324.45it/s] 42%|████▏     | 129/306 [00:00<00:00, 253.91it/s] 52%|█████▏    | 158/306 [00:00<00:00, 263.02it/s] 62%|██████▏   | 190/306 [00:00<00:00, 279.91it/s] 74%|███████▍  | 227/306 [00:00<00:00, 306.00it/s] 85%|████████▍ | 259/306 [00:00<00:00, 258.51it/s] 96%|█████████▋| 295/306 [00:01<00:00, 284.43it/s]100%|██████████| 306/306 [00:01<00:00, 282.77it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 43/553 [00:00<00:01, 429.27it/s]extract the null data:  16%|█▌        | 88/553 [00:00<00:01, 435.91it/s]extract the null data:  24%|██▍       | 133/553 [00:00<00:00, 439.26it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 448.42it/s]extract the null data:  41%|████      | 227/553 [00:00<00:00, 453.39it/s]extract the null data:  50%|████▉     | 276/553 [00:00<00:00, 464.95it/s]extract the null data:  59%|█████▉    | 328/553 [00:00<00:00, 481.67it/s]extract the null data:  69%|██████▉   | 382/553 [00:00<00:00, 499.44it/s]extract the null data:  80%|███████▉  | 442/553 [00:00<00:00, 529.06it/s]extract the null data:  92%|█████████▏| 506/553 [00:01<00:00, 560.39it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 509.62it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 193.01it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 194.84it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 196.16it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 195.33it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 194.65it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 194.84it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 189.95it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 188.93it/s]replace nan value:  32%|███▏      | 179/553 [00:00<00:01, 188.26it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:01, 187.45it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 188.54it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 192.38it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 190.43it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 188.70it/s]replace nan value:  54%|█████▍    | 298/553 [00:01<00:01, 188.89it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 191.52it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 195.76it/s]replace nan value:  65%|██████▍   | 359/553 [00:01<00:01, 190.95it/s]replace nan value:  69%|██████▊   | 379/553 [00:01<00:00, 188.81it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 186.48it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 186.78it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 188.70it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 189.42it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 186.68it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 183.96it/s]replace nan value:  93%|█████████▎| 514/553 [00:02<00:00, 183.65it/s]replace nan value:  96%|█████████▋| 533/553 [00:02<00:00, 183.43it/s]replace nan value: 100%|█████████▉| 552/553 [00:02<00:00, 183.55it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 188.81it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.56it/s]  5%|▌         | 29/553 [00:00<00:03, 139.58it/s]  8%|▊         | 43/553 [00:00<00:03, 132.90it/s] 10%|█         | 57/553 [00:00<00:04, 123.95it/s] 13%|█▎        | 70/553 [00:00<00:04, 117.39it/s] 16%|█▌        | 86/553 [00:00<00:03, 130.26it/s] 18%|█▊        | 100/553 [00:00<00:03, 125.45it/s] 21%|██▏       | 118/553 [00:00<00:03, 140.15it/s] 24%|██▍       | 133/553 [00:01<00:03, 138.24it/s] 27%|██▋       | 151/553 [00:01<00:02, 147.97it/s] 31%|███       | 169/553 [00:01<00:02, 156.19it/s] 33%|███▎      | 185/553 [00:01<00:02, 152.68it/s] 37%|███▋      | 202/553 [00:01<00:02, 155.85it/s] 39%|███▉      | 218/553 [00:01<00:02, 152.52it/s] 42%|████▏     | 234/553 [00:01<00:02, 146.25it/s] 45%|████▌     | 249/553 [00:01<00:02, 143.81it/s] 48%|████▊     | 265/553 [00:01<00:02, 143.48it/s] 51%|█████     | 280/553 [00:01<00:01, 136.54it/s] 53%|█████▎    | 294/553 [00:02<00:01, 133.47it/s] 56%|█████▌    | 308/553 [00:02<00:01, 130.78it/s] 58%|█████▊    | 322/553 [00:02<00:01, 127.69it/s] 61%|██████    | 336/553 [00:02<00:01, 130.19it/s] 63%|██████▎   | 350/553 [00:02<00:01, 130.14it/s] 66%|██████▌   | 364/553 [00:02<00:01, 127.64it/s] 68%|██████▊   | 378/553 [00:02<00:01, 130.18it/s] 71%|███████   | 392/553 [00:02<00:01, 118.65it/s] 73%|███████▎  | 405/553 [00:03<00:01, 117.26it/s] 75%|███████▌  | 417/553 [00:03<00:01, 114.04it/s] 78%|███████▊  | 429/553 [00:03<00:01, 108.99it/s] 80%|████████  | 445/553 [00:03<00:00, 121.92it/s] 83%|████████▎ | 459/553 [00:03<00:00, 125.71it/s] 85%|████████▌ | 472/553 [00:03<00:00, 126.10it/s] 88%|████████▊ | 485/553 [00:03<00:00, 124.53it/s] 90%|█████████ | 498/553 [00:03<00:00, 115.76it/s] 93%|█████████▎| 512/553 [00:03<00:00, 122.11it/s] 95%|█████████▍| 525/553 [00:04<00:00, 110.85it/s] 97%|█████████▋| 537/553 [00:04<00:00, 105.61it/s]100%|█████████▉| 551/553 [00:04<00:00, 96.11it/s] 100%|██████████| 553/553 [00:04<00:00, 126.62it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 24/139 [00:00<00:00, 237.19it/s]extract the null data:  52%|█████▏    | 72/139 [00:00<00:00, 378.62it/s]extract the null data:  86%|████████▋ | 120/139 [00:00<00:00, 421.51it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 405.02it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 178.21it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 173.77it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 173.72it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 173.58it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 173.03it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 172.32it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 172.45it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 173.37it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 102.23it/s] 17%|█▋        | 23/139 [00:00<00:01, 111.20it/s] 26%|██▌       | 36/139 [00:00<00:00, 119.31it/s] 35%|███▍      | 48/139 [00:00<00:00, 119.27it/s] 43%|████▎     | 60/139 [00:00<00:00, 113.32it/s] 53%|█████▎    | 73/139 [00:00<00:00, 116.66it/s] 61%|██████    | 85/139 [00:00<00:00, 109.15it/s] 70%|██████▉   | 97/139 [00:00<00:00, 104.81it/s] 78%|███████▊  | 108/139 [00:00<00:00, 102.54it/s] 88%|████████▊ | 122/139 [00:01<00:00, 111.68it/s] 96%|█████████▋| 134/139 [00:01<00:00, 109.93it/s]100%|██████████| 139/139 [00:01<00:00, 111.81it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 258.89it/s]extract the null data:  44%|████▍     | 76/173 [00:00<00:00, 396.53it/s]extract the null data:  71%|███████   | 122/173 [00:00<00:00, 423.88it/s]extract the null data:  98%|█████████▊| 169/173 [00:00<00:00, 439.31it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 417.87it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 170.33it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 169.36it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 170.76it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 171.97it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 172.96it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 172.63it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 172.09it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 172.24it/s]replace nan value:  94%|█████████▎| 162/173 [00:00<00:00, 170.87it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 170.74it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 129.01it/s] 15%|█▌        | 26/173 [00:00<00:01, 102.82it/s] 23%|██▎       | 39/173 [00:00<00:01, 111.15it/s] 31%|███       | 53/173 [00:00<00:00, 121.48it/s] 38%|███▊      | 66/173 [00:00<00:00, 120.79it/s] 46%|████▌     | 80/173 [00:00<00:00, 121.41it/s] 54%|█████▍    | 93/173 [00:00<00:00, 123.67it/s] 61%|██████▏   | 106/173 [00:00<00:00, 121.39it/s] 69%|██████▉   | 119/173 [00:00<00:00, 120.40it/s] 76%|███████▋  | 132/173 [00:01<00:00, 115.81it/s] 83%|████████▎ | 144/173 [00:01<00:00, 115.31it/s] 90%|█████████ | 156/173 [00:01<00:00, 104.92it/s] 97%|█████████▋| 167/173 [00:01<00:00, 83.51it/s] 100%|██████████| 173/173 [00:01<00:00, 103.82it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.048, valid loss : 0.043, train acc : 0.505, valid acc : 0.084, train f1 : 0.376, valid f1 : 0.077
training process:   1%|          | 1/128 [01:01<2:10:10, 61.50s/it]Best score increase :0.000 -> 0.077
training process:   2%|▏         | 2/128 [01:50<1:53:52, 54.22s/it]Best score increase :0.077 -> 0.153
training process:   2%|▏         | 3/128 [02:40<1:49:15, 52.44s/it]Best score increase :0.153 -> 0.287
training process:   3%|▎         | 4/128 [03:30<1:46:09, 51.37s/it]Best score increase :0.287 -> 0.352
epoch : 5, train loss : 0.023, valid loss : 0.026, train acc : 0.687, valid acc : 0.427, train f1 : 0.656, valid f1 : 0.384
training process:   4%|▍         | 5/128 [04:28<1:50:17, 53.80s/it]Best score increase :0.352 -> 0.384
training process:   5%|▍         | 6/128 [05:19<1:47:29, 52.86s/it]Best score increase :0.384 -> 0.489
training process:   5%|▌         | 7/128 [06:10<1:45:22, 52.25s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:02<1:43:55, 51.96s/it]Best score increase :0.489 -> 0.516
epoch : 9, train loss : 0.019, valid loss : 0.022, train acc : 0.746, valid acc : 0.594, train f1 : 0.731, valid f1 : 0.500
training process:   7%|▋         | 9/128 [08:01<1:47:48, 54.36s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:53<1:45:21, 53.57s/it]Best score increase :0.516 -> 0.533
training process:   9%|▊         | 11/128 [09:45<1:43:15, 52.95s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:34<1:40:23, 51.92s/it]Best score increase :0.533 -> 0.539
epoch : 13, train loss : 0.017, valid loss : 0.017, train acc : 0.792, valid acc : 0.774, train f1 : 0.783, valid f1 : 0.635
training process:  10%|█         | 13/128 [11:35<1:44:36, 54.58s/it]Best score increase :0.539 -> 0.635
training process:  11%|█         | 14/128 [12:25<1:40:58, 53.15s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:15<1:38:10, 52.13s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:04<1:35:32, 51.18s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.016, valid loss : 0.020, train acc : 0.812, valid acc : 0.699, train f1 : 0.807, valid f1 : 0.573
training process:  13%|█▎        | 17/128 [15:01<1:37:59, 52.97s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [15:50<1:35:09, 51.90s/it]EarlyStopping counter : 5 out of 12
training process:  15%|█▍        | 19/128 [16:40<1:33:25, 51.43s/it]Best score increase :0.635 -> 0.656
training process:  16%|█▌        | 20/128 [17:30<1:31:21, 50.75s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.015, valid loss : 0.019, train acc : 0.839, valid acc : 0.782, train f1 : 0.835, valid f1 : 0.641
training process:  16%|█▋        | 21/128 [18:27<1:34:02, 52.74s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [19:17<1:31:34, 51.84s/it]EarlyStopping counter : 3 out of 12
training process:  18%|█▊        | 23/128 [20:06<1:29:13, 50.99s/it]EarlyStopping counter : 4 out of 12
training process:  19%|█▉        | 24/128 [20:55<1:27:24, 50.43s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.014, valid loss : 0.019, train acc : 0.839, valid acc : 0.809, train f1 : 0.836, valid f1 : 0.665
training process:  20%|█▉        | 25/128 [21:52<1:30:06, 52.49s/it]Best score increase :0.656 -> 0.665
training process:  20%|██        | 26/128 [22:41<1:27:22, 51.40s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [23:30<1:25:29, 50.78s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [24:19<1:23:42, 50.22s/it]Best score increase :0.665 -> 0.682
epoch : 29, train loss : 0.014, valid loss : 0.020, train acc : 0.857, valid acc : 0.757, train f1 : 0.854, valid f1 : 0.621
training process:  23%|██▎       | 29/128 [25:17<1:26:49, 52.62s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [26:07<1:24:26, 51.70s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [26:59<1:23:32, 51.68s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [27:52<1:23:33, 52.22s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.013, valid loss : 0.018, train acc : 0.864, valid acc : 0.842, train f1 : 0.862, valid f1 : 0.697
training process:  26%|██▌       | 33/128 [28:55<1:27:39, 55.36s/it]Best score increase :0.682 -> 0.697
training process:  27%|██▋       | 34/128 [29:48<1:25:57, 54.86s/it]Best score increase :0.697 -> 0.700
training process:  27%|██▋       | 35/128 [30:41<1:24:00, 54.20s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [31:33<1:21:55, 53.43s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.013, valid loss : 0.018, train acc : 0.868, valid acc : 0.812, train f1 : 0.865, valid f1 : 0.668
training process:  29%|██▉       | 37/128 [32:34<1:24:33, 55.75s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [33:24<1:21:09, 54.10s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:17<1:19:38, 53.69s/it]Best score increase :0.700 -> 0.738
training process:  31%|███▏      | 40/128 [35:08<1:17:47, 53.04s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.012, valid loss : 0.018, train acc : 0.876, valid acc : 0.824, train f1 : 0.875, valid f1 : 0.679
training process:  32%|███▏      | 41/128 [36:11<1:20:55, 55.81s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [37:03<1:18:32, 54.80s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [37:55<1:16:19, 53.88s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [38:45<1:13:55, 52.80s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.012, valid loss : 0.018, train acc : 0.879, valid acc : 0.849, train f1 : 0.877, valid f1 : 0.707
training process:  35%|███▌      | 45/128 [39:46<1:16:29, 55.30s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 46/128 [40:36<1:13:22, 53.69s/it]EarlyStopping counter : 7 out of 12
training process:  37%|███▋      | 47/128 [41:27<1:11:27, 52.94s/it]EarlyStopping counter : 8 out of 12
training process:  38%|███▊      | 48/128 [42:18<1:09:35, 52.20s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.012, valid loss : 0.018, train acc : 0.882, valid acc : 0.931, train f1 : 0.880, valid f1 : 0.817
training process:  38%|███▊      | 49/128 [43:19<1:12:05, 54.75s/it]Best score increase :0.738 -> 0.817
training process:  39%|███▉      | 50/128 [44:09<1:09:21, 53.35s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [45:01<1:08:10, 53.13s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [45:53<1:06:38, 52.61s/it]EarlyStopping counter : 3 out of 12
epoch : 53, train loss : 0.012, valid loss : 0.018, train acc : 0.884, valid acc : 0.820, train f1 : 0.883, valid f1 : 0.677
training process:  41%|████▏     | 53/128 [46:52<1:08:23, 54.71s/it]EarlyStopping counter : 4 out of 12
training process:  42%|████▏     | 54/128 [47:44<1:06:27, 53.88s/it]EarlyStopping counter : 5 out of 12
training process:  43%|████▎     | 55/128 [48:35<1:04:22, 52.91s/it]EarlyStopping counter : 6 out of 12
training process:  44%|████▍     | 56/128 [49:26<1:02:50, 52.36s/it]EarlyStopping counter : 7 out of 12
epoch : 57, train loss : 0.011, valid loss : 0.018, train acc : 0.889, valid acc : 0.849, train f1 : 0.888, valid f1 : 0.707
training process:  45%|████▍     | 57/128 [50:27<1:05:10, 55.08s/it]EarlyStopping counter : 8 out of 12
training process:  45%|████▌     | 58/128 [51:19<1:03:12, 54.18s/it]EarlyStopping counter : 9 out of 12
training process:  46%|████▌     | 59/128 [52:09<1:00:33, 52.65s/it]EarlyStopping counter : 10 out of 12
training process:  47%|████▋     | 60/128 [52:59<59:05, 52.13s/it]  EarlyStopping counter : 11 out of 12
epoch : 61, train loss : 0.011, valid loss : 0.018, train acc : 0.894, valid acc : 0.835, train f1 : 0.893, valid f1 : 0.692
training process:  47%|████▋     | 60/128 [54:00<1:01:12, 54.01s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 60, best f1 score : 0.817
training process finished, best loss : 0.018 and best acc : 0.931, best f1 : 0.817, best epoch : 48

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.84      0.68       580
           1       0.99      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.89      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.89, test loss : 0.760

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.84s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.90s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.82s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.75s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.84s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.82s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.79s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.79s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.79s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.63s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:25<00:07,  7.67s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.76s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 116.56it/s] 20%|█▉        | 60/306 [00:00<00:00, 311.57it/s] 30%|███       | 92/306 [00:00<00:00, 305.60it/s] 46%|████▌     | 141/306 [00:00<00:00, 375.05it/s] 59%|█████▉    | 180/306 [00:00<00:00, 333.16it/s] 70%|███████   | 215/306 [00:00<00:00, 332.31it/s] 86%|████████▌ | 262/306 [00:00<00:00, 373.27it/s] 98%|█████████▊| 301/306 [00:00<00:00, 357.24it/s]100%|██████████| 306/306 [00:00<00:00, 341.18it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 66/553 [00:00<00:00, 655.38it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:00, 657.69it/s]extract the null data:  36%|███▌      | 200/553 [00:00<00:00, 667.50it/s]extract the null data:  48%|████▊     | 267/553 [00:00<00:00, 664.42it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 664.86it/s]extract the null data:  73%|███████▎  | 401/553 [00:00<00:00, 665.02it/s]extract the null data:  85%|████████▍ | 469/553 [00:00<00:00, 668.12it/s]extract the null data:  97%|█████████▋| 536/553 [00:00<00:00, 668.37it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 665.48it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 219.43it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 225.72it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 226.61it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:02, 228.24it/s]replace nan value:  21%|██        | 116/553 [00:00<00:01, 227.13it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:01, 227.21it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:01, 229.71it/s]replace nan value:  34%|███▍      | 187/553 [00:00<00:01, 230.15it/s]replace nan value:  38%|███▊      | 211/553 [00:00<00:01, 230.61it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 231.05it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 232.84it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 234.46it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 233.68it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:00, 228.95it/s]replace nan value:  64%|██████▍   | 354/553 [00:01<00:00, 225.28it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 225.41it/s]replace nan value:  72%|███████▏  | 400/553 [00:01<00:00, 226.66it/s]replace nan value:  76%|███████▋  | 423/553 [00:01<00:00, 221.22it/s]replace nan value:  81%|████████  | 447/553 [00:01<00:00, 226.09it/s]replace nan value:  85%|████████▌ | 471/553 [00:02<00:00, 228.54it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 226.71it/s]replace nan value:  94%|█████████▎| 518/553 [00:02<00:00, 228.94it/s]replace nan value:  98%|█████████▊| 542/553 [00:02<00:00, 230.44it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 228.56it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 16/553 [00:00<00:03, 155.51it/s]  6%|▌         | 33/553 [00:00<00:03, 163.70it/s]  9%|▉         | 50/553 [00:00<00:03, 139.84it/s] 12%|█▏        | 65/553 [00:00<00:03, 131.47it/s] 14%|█▍        | 80/553 [00:00<00:03, 135.32it/s] 18%|█▊        | 97/553 [00:00<00:03, 142.80it/s] 21%|██        | 114/553 [00:00<00:02, 150.11it/s] 24%|██▎       | 130/553 [00:00<00:02, 148.61it/s] 27%|██▋       | 150/553 [00:00<00:02, 162.54it/s] 31%|███       | 170/553 [00:01<00:02, 172.30it/s] 34%|███▍      | 188/553 [00:01<00:02, 165.95it/s] 38%|███▊      | 208/553 [00:01<00:01, 173.82it/s] 41%|████      | 226/553 [00:01<00:01, 163.79it/s] 44%|████▍     | 243/553 [00:01<00:01, 161.82it/s] 47%|████▋     | 260/553 [00:01<00:01, 160.66it/s] 50%|█████     | 277/553 [00:01<00:01, 153.98it/s] 53%|█████▎    | 293/553 [00:01<00:01, 150.06it/s] 56%|█████▌    | 309/553 [00:02<00:01, 144.20it/s] 59%|█████▊    | 324/553 [00:02<00:01, 142.03it/s] 61%|██████▏   | 339/553 [00:02<00:01, 143.67it/s] 64%|██████▍   | 354/553 [00:02<00:01, 140.60it/s] 67%|██████▋   | 369/553 [00:02<00:01, 141.00it/s] 70%|██████▉   | 385/553 [00:02<00:01, 141.31it/s] 72%|███████▏  | 400/553 [00:02<00:01, 129.07it/s] 75%|███████▌  | 416/553 [00:02<00:01, 133.53it/s] 78%|███████▊  | 430/553 [00:02<00:00, 127.81it/s] 81%|████████  | 449/553 [00:03<00:00, 141.78it/s] 84%|████████▍ | 465/553 [00:03<00:00, 145.41it/s] 87%|████████▋ | 480/553 [00:03<00:00, 141.63it/s] 90%|████████▉ | 495/553 [00:03<00:00, 137.95it/s] 93%|█████████▎| 512/553 [00:03<00:00, 145.01it/s] 95%|█████████▌| 527/553 [00:03<00:00, 130.49it/s] 98%|█████████▊| 542/553 [00:03<00:00, 133.58it/s]100%|██████████| 553/553 [00:03<00:00, 143.21it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  34%|███▍      | 47/139 [00:00<00:00, 465.27it/s]extract the null data:  86%|████████▌ | 119/139 [00:00<00:00, 613.86it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 608.00it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▊        | 26/139 [00:00<00:00, 256.69it/s]replace nan value:  37%|███▋      | 52/139 [00:00<00:00, 249.10it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 248.64it/s]replace nan value:  73%|███████▎  | 102/139 [00:00<00:00, 246.48it/s]replace nan value:  92%|█████████▏| 128/139 [00:00<00:00, 250.57it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 250.32it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 132.25it/s] 21%|██        | 29/139 [00:00<00:00, 141.11it/s] 33%|███▎      | 46/139 [00:00<00:00, 149.91it/s] 44%|████▍     | 61/139 [00:00<00:00, 134.44it/s] 55%|█████▍    | 76/139 [00:00<00:00, 138.30it/s] 65%|██████▍   | 90/139 [00:00<00:00, 125.48it/s] 76%|███████▌  | 105/139 [00:00<00:00, 129.19it/s] 88%|████████▊ | 122/139 [00:00<00:00, 136.65it/s] 98%|█████████▊| 136/139 [00:01<00:00, 133.95it/s]100%|██████████| 139/139 [00:01<00:00, 135.62it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 359.26it/s]extract the null data:  62%|██████▏   | 108/173 [00:00<00:00, 570.72it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 587.78it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   9%|▉         | 16/173 [00:00<00:01, 148.26it/s]replace nan value:  19%|█▉        | 33/173 [00:00<00:00, 146.52it/s]replace nan value:  31%|███       | 53/173 [00:00<00:00, 168.08it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 177.64it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 181.74it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 186.29it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 186.32it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 187.53it/s]replace nan value:  98%|█████████▊| 170/173 [00:00<00:00, 185.51it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 179.75it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 137.86it/s] 17%|█▋        | 29/173 [00:00<00:01, 125.16it/s] 27%|██▋       | 47/173 [00:00<00:00, 147.11it/s] 37%|███▋      | 64/173 [00:00<00:00, 155.13it/s] 46%|████▌     | 80/173 [00:00<00:00, 151.64it/s] 55%|█████▌    | 96/173 [00:00<00:00, 154.16it/s] 66%|██████▌   | 114/173 [00:00<00:00, 161.93it/s] 76%|███████▌  | 131/173 [00:00<00:00, 152.88it/s] 85%|████████▍ | 147/173 [00:00<00:00, 153.12it/s] 94%|█████████▍| 163/173 [00:01<00:00, 139.10it/s]100%|██████████| 173/173 [00:01<00:00, 134.42it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.103, valid loss : 0.081, train f1 : 0.553, valid f1 : 0.541
training process - Deferred Re-weighting:   1%|          | 1/128 [00:44<1:33:28, 44.16s/it]Best score increase :0.000 -> 0.541
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:34<1:39:51, 47.55s/it]Best score increase :0.541 -> 0.613
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:26<1:43:19, 49.60s/it]Best score increase :0.613 -> 0.695
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:16<1:43:10, 49.92s/it]Best score increase :0.695 -> 0.746
epoch : 5, train loss : 0.050, valid loss : 0.048, train f1 : 0.744, valid f1 : 0.760
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:15<1:48:55, 53.13s/it]Best score increase :0.746 -> 0.760
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:05<1:45:51, 52.06s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:56<1:44:22, 51.76s/it]Best score increase :0.760 -> 0.779
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:47<1:42:50, 51.42s/it]Best score increase :0.779 -> 0.796
epoch : 9, train loss : 0.042, valid loss : 0.041, train f1 : 0.801, valid f1 : 0.795
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:48<1:47:52, 54.39s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:39<1:45:10, 53.48s/it]Best score increase :0.796 -> 0.799
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:31<1:43:18, 52.97s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:21<1:40:56, 52.21s/it]Best score increase :0.799 -> 0.817
epoch : 13, train loss : 0.038, valid loss : 0.038, train f1 : 0.822, valid f1 : 0.816
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:21<1:44:20, 54.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:10<1:40:08, 52.71s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:01<1:38:28, 52.29s/it]Best score increase :0.817 -> 0.818
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:51<1:36:28, 51.68s/it]Best score increase :0.818 -> 0.839
epoch : 17, train loss : 0.036, valid loss : 0.038, train f1 : 0.835, valid f1 : 0.816
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:50<1:39:48, 53.95s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:40<1:36:23, 52.58s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:30<1:34:23, 51.96s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:20<1:32:12, 51.23s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.034, valid loss : 0.037, train f1 : 0.840, valid f1 : 0.815
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:19<1:35:38, 53.63s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:10<1:33:22, 52.85s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:00<1:30:58, 51.98s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:54<1:30:56, 52.47s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.033, valid loss : 0.033, train f1 : 0.848, valid f1 : 0.845
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:58<1:36:06, 55.98s/it]Best score increase :0.839 -> 0.845
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:51<1:33:56, 55.26s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:43<1:31:16, 54.23s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:34<1:28:45, 53.25s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.031, valid loss : 0.038, train f1 : 0.852, valid f1 : 0.814
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:36<1:32:03, 55.79s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:34<1:32:07, 56.41s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:31<1:31:44, 56.75s/it]Best score increase :0.845 -> 0.849
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:29<1:31:10, 56.99s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.030, valid loss : 0.037, train f1 : 0.858, valid f1 : 0.819
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:29<1:31:50, 58.00s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [30:20<1:27:16, 55.71s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:10<1:23:57, 54.17s/it]Best score increase :0.849 -> 0.858
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [32:01<1:21:17, 53.02s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.030, valid loss : 0.032, train f1 : 0.856, valid f1 : 0.855
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:02<1:24:22, 55.63s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:56<1:22:48, 55.21s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:46<1:19:27, 53.57s/it]Best score increase :0.858 -> 0.871
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:38<1:17:49, 53.06s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.029, valid loss : 0.033, train f1 : 0.862, valid f1 : 0.851
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:38<1:19:49, 55.05s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [37:30<1:17:39, 54.18s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [38:21<1:15:26, 53.25s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [39:12<1:13:45, 52.68s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.029, valid loss : 0.033, train f1 : 0.865, valid f1 : 0.863
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [40:14<1:16:40, 55.42s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [41:07<1:14:34, 54.57s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:58<1:12:11, 53.48s/it]Best score increase :0.871 -> 0.873
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [42:50<1:10:52, 53.16s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.028, valid loss : 0.031, train f1 : 0.871, valid f1 : 0.867
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [43:52<1:13:37, 55.91s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [44:45<1:11:29, 54.99s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [45:36<1:08:49, 53.63s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [46:28<1:07:34, 53.35s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.027, valid loss : 0.035, train f1 : 0.874, valid f1 : 0.847
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [47:32<1:10:20, 56.28s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [48:25<1:08:15, 55.35s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [49:17<1:06:06, 54.33s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [50:11<1:05:13, 54.35s/it]EarlyStopping counter : 9 out of 12
epoch : 57, train loss : 0.027, valid loss : 0.034, train f1 : 0.872, valid f1 : 0.862
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [51:12<1:06:36, 56.29s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [52:05<1:04:23, 55.20s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [52:56<1:03:54, 54.77s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 58, best f1 score : 0.873
training process finished, best loss : 0.032, best acc : 0.964, best f1 : 0.873, best epoch : 46

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.89      0.70      0.78       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.93      0.85      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.85, test loss : 1.875

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.79s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.84s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.89s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.89s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.82s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.86s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.98s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.90s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.95s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.98s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.94s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.92s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 10%|▉         | 30/306 [00:00<00:01, 270.97it/s] 24%|██▍       | 73/306 [00:00<00:00, 358.11it/s] 36%|███▋      | 111/306 [00:00<00:00, 365.05it/s] 48%|████▊     | 148/306 [00:00<00:00, 309.54it/s] 66%|██████▋   | 203/306 [00:00<00:00, 377.35it/s] 79%|███████▉  | 243/306 [00:00<00:00, 297.73it/s] 99%|█████████▉| 303/306 [00:00<00:00, 373.76it/s]100%|██████████| 306/306 [00:00<00:00, 352.00it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_Focal_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 598.51it/s]extract the null data:  22%|██▏       | 122/553 [00:00<00:00, 607.39it/s]extract the null data:  33%|███▎      | 183/553 [00:00<00:00, 598.97it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 607.72it/s]extract the null data:  56%|█████▌    | 307/553 [00:00<00:00, 606.28it/s]extract the null data:  67%|██████▋   | 368/553 [00:00<00:00, 589.47it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 592.70it/s]extract the null data:  89%|████████▉ | 491/553 [00:00<00:00, 601.11it/s]extract the null data: 100%|█████████▉| 552/553 [00:00<00:00, 592.29it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 596.66it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 196.06it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 196.86it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 196.28it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 202.04it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 203.14it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 205.15it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:01, 208.10it/s]replace nan value:  30%|███       | 167/553 [00:00<00:01, 205.87it/s]replace nan value:  34%|███▍      | 189/553 [00:00<00:01, 208.23it/s]replace nan value:  38%|███▊      | 211/553 [00:01<00:01, 209.90it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 207.46it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 208.43it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 209.09it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 206.30it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:01, 208.03it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 206.66it/s]replace nan value:  65%|██████▌   | 361/553 [00:01<00:00, 205.98it/s]replace nan value:  69%|██████▉   | 383/553 [00:01<00:00, 208.76it/s]replace nan value:  73%|███████▎  | 404/553 [00:01<00:00, 202.38it/s]replace nan value:  77%|███████▋  | 426/553 [00:02<00:00, 204.62it/s]replace nan value:  81%|████████  | 448/553 [00:02<00:00, 206.17it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 203.86it/s]replace nan value:  89%|████████▊ | 490/553 [00:02<00:00, 204.29it/s]replace nan value:  92%|█████████▏| 511/553 [00:02<00:00, 203.19it/s]replace nan value:  96%|█████████▌| 532/553 [00:02<00:00, 201.14it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 202.12it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 204.85it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 136.98it/s]  5%|▌         | 29/553 [00:00<00:03, 143.67it/s]  8%|▊         | 44/553 [00:00<00:03, 134.40it/s] 10%|█         | 58/553 [00:00<00:04, 123.70it/s] 13%|█▎        | 71/553 [00:00<00:03, 122.27it/s] 16%|█▌        | 88/553 [00:00<00:03, 136.14it/s] 18%|█▊        | 102/553 [00:00<00:03, 129.94it/s] 22%|██▏       | 120/553 [00:00<00:03, 143.54it/s] 24%|██▍       | 135/553 [00:00<00:02, 142.74it/s] 28%|██▊       | 153/553 [00:01<00:02, 153.00it/s] 31%|███       | 172/553 [00:01<00:02, 161.26it/s] 34%|███▍      | 189/553 [00:01<00:02, 156.71it/s] 38%|███▊      | 208/553 [00:01<00:02, 165.19it/s] 41%|████      | 225/553 [00:01<00:02, 155.89it/s] 44%|████▎     | 241/553 [00:01<00:02, 155.34it/s] 46%|████▋     | 257/553 [00:01<00:01, 150.69it/s] 49%|████▉     | 273/553 [00:01<00:01, 147.63it/s] 52%|█████▏    | 290/553 [00:01<00:01, 151.80it/s] 55%|█████▌    | 306/553 [00:02<00:01, 138.25it/s] 58%|█████▊    | 321/553 [00:02<00:01, 135.85it/s] 61%|██████    | 336/553 [00:02<00:01, 139.02it/s] 63%|██████▎   | 351/553 [00:02<00:01, 139.64it/s] 66%|██████▌   | 366/553 [00:02<00:01, 134.79it/s] 69%|██████▉   | 383/553 [00:02<00:01, 143.15it/s] 72%|███████▏  | 398/553 [00:02<00:01, 125.58it/s] 75%|███████▍  | 414/553 [00:02<00:01, 133.47it/s] 77%|███████▋  | 428/553 [00:03<00:01, 121.13it/s] 81%|████████  | 447/553 [00:03<00:00, 137.97it/s] 84%|████████▎ | 462/553 [00:03<00:00, 140.53it/s] 86%|████████▋ | 478/553 [00:03<00:00, 139.74it/s] 89%|████████▉ | 493/553 [00:03<00:00, 133.36it/s] 92%|█████████▏| 507/553 [00:03<00:00, 134.37it/s] 94%|█████████▍| 521/553 [00:03<00:00, 132.29it/s] 97%|█████████▋| 535/553 [00:03<00:00, 118.43it/s]100%|█████████▉| 551/553 [00:04<00:00, 109.80it/s]100%|██████████| 553/553 [00:04<00:00, 136.44it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  41%|████      | 57/139 [00:00<00:00, 565.14it/s]extract the null data:  88%|████████▊ | 123/139 [00:00<00:00, 618.01it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 614.46it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 219.54it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 223.05it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 219.50it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 220.42it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 222.03it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 220.38it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 220.69it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 127.45it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.51it/s] 30%|███       | 42/139 [00:00<00:00, 140.81it/s] 41%|████      | 57/139 [00:00<00:00, 127.32it/s] 53%|█████▎    | 73/139 [00:00<00:00, 137.02it/s] 63%|██████▎   | 87/139 [00:00<00:00, 122.64it/s] 73%|███████▎  | 101/139 [00:00<00:00, 125.91it/s] 82%|████████▏ | 114/139 [00:00<00:00, 124.91it/s] 93%|█████████▎| 129/139 [00:00<00:00, 129.76it/s]100%|██████████| 139/139 [00:01<00:00, 130.39it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 41/173 [00:00<00:00, 404.85it/s]extract the null data:  65%|██████▌   | 113/173 [00:00<00:00, 586.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 601.33it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 221.87it/s]replace nan value:  27%|██▋       | 47/173 [00:00<00:00, 228.47it/s]replace nan value:  40%|████      | 70/173 [00:00<00:00, 225.23it/s]replace nan value:  54%|█████▍    | 93/173 [00:00<00:00, 224.58it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 226.44it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 221.35it/s]replace nan value:  94%|█████████▎| 162/173 [00:00<00:00, 223.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 222.72it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 144.29it/s] 17%|█▋        | 30/173 [00:00<00:01, 128.05it/s] 28%|██▊       | 48/173 [00:00<00:00, 147.84it/s] 38%|███▊      | 65/173 [00:00<00:00, 151.34it/s] 47%|████▋     | 81/173 [00:00<00:00, 154.14it/s] 57%|█████▋    | 98/173 [00:00<00:00, 156.52it/s] 67%|██████▋   | 116/173 [00:00<00:00, 161.01it/s] 77%|███████▋  | 133/173 [00:00<00:00, 149.29it/s] 86%|████████▌ | 149/173 [00:01<00:00, 145.22it/s] 95%|█████████▍| 164/173 [00:01<00:00, 134.66it/s]100%|██████████| 173/173 [00:01<00:00, 134.13it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.145, valid loss : 0.121, train f1 : 0.694, valid f1 : 0.655
training process - Deferred Re-weighting:   1%|          | 1/128 [00:59<2:05:41, 59.38s/it]Best score increase :0.000 -> 0.655
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:47<1:50:10, 52.46s/it]Best score increase :0.655 -> 0.701
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:35<1:45:04, 50.44s/it]Best score increase :0.701 -> 0.762
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:23<1:43:00, 49.84s/it]Best score increase :0.762 -> 0.775
epoch : 5, train loss : 0.088, valid loss : 0.084, train f1 : 0.853, valid f1 : 0.759
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:21<1:47:41, 52.53s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:10<1:44:30, 51.40s/it]Best score increase :0.775 -> 0.799
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:03<1:44:47, 51.97s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:56<1:44:42, 52.36s/it]Best score increase :0.799 -> 0.814
epoch : 9, train loss : 0.079, valid loss : 0.058, train f1 : 0.871, valid f1 : 0.809
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:54<1:47:16, 54.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:46<1:45:14, 53.51s/it]Best score increase :0.814 -> 0.816
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:37<1:42:54, 52.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:31<1:42:19, 52.92s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.073, valid loss : 0.048, train f1 : 0.884, valid f1 : 0.827
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:28<1:44:02, 54.28s/it]Best score increase :0.816 -> 0.827
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:18<1:40:43, 53.02s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:10<1:39:06, 52.62s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:01<1:37:09, 52.05s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.069, valid loss : 0.083, train f1 : 0.892, valid f1 : 0.737
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:58<1:39:13, 53.64s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:47<1:35:40, 52.18s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:36<1:33:08, 51.27s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:28<1:32:49, 51.57s/it]EarlyStopping counter : 7 out of 12
epoch : 21, train loss : 0.065, valid loss : 0.058, train f1 : 0.898, valid f1 : 0.779
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:25<1:34:52, 53.20s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:15<1:32:22, 52.29s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:04<1:29:26, 51.11s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:52<1:27:17, 50.36s/it]EarlyStopping counter : 11 out of 12
epoch : 25, train loss : 0.062, valid loss : 0.058, train f1 : 0.903, valid f1 : 0.779
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:52<1:34:45, 54.67s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 24, best f1 score : 0.827
training process finished, best loss : 0.048, best acc : 0.944, best f1 : 0.827, best epoch : 12

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.68      0.74      0.71       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.83      0.86      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.86, test loss : 2.611

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.16s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.80s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.68s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.64s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.71s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.67s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.70s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.66s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.75s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.77s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.64s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.84s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.75s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 181.69it/s] 17%|█▋        | 53/306 [00:00<00:00, 272.16it/s] 27%|██▋       | 83/306 [00:00<00:00, 282.70it/s] 37%|███▋      | 112/306 [00:00<00:00, 239.07it/s] 51%|█████     | 155/306 [00:00<00:00, 298.86it/s] 61%|██████    | 187/306 [00:00<00:00, 299.56it/s] 71%|███████   | 218/306 [00:00<00:00, 261.38it/s] 87%|████████▋ | 266/306 [00:00<00:00, 317.36it/s] 98%|█████████▊| 300/306 [00:01<00:00, 288.53it/s]100%|██████████| 306/306 [00:01<00:00, 272.42it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:00, 531.64it/s]extract the null data:  20%|█▉        | 108/553 [00:00<00:00, 535.27it/s]extract the null data:  29%|██▉       | 162/553 [00:00<00:00, 536.63it/s]extract the null data:  40%|███▉      | 219/553 [00:00<00:00, 546.43it/s]extract the null data:  50%|████▉     | 274/553 [00:00<00:00, 542.23it/s]extract the null data:  59%|█████▉    | 329/553 [00:00<00:00, 538.46it/s]extract the null data:  70%|██████▉   | 385/553 [00:00<00:00, 545.16it/s]extract the null data:  80%|███████▉  | 440/553 [00:00<00:00, 545.68it/s]extract the null data:  90%|████████▉ | 496/553 [00:00<00:00, 547.43it/s]extract the null data: 100%|█████████▉| 551/553 [00:01<00:00, 541.52it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 541.85it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 187.62it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 187.57it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 184.07it/s]replace nan value:  14%|█▎        | 76/553 [00:00<00:02, 185.71it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:02, 187.63it/s]replace nan value:  21%|██        | 115/553 [00:00<00:02, 186.97it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 188.09it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 189.56it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:02, 188.96it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:01, 190.34it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 189.83it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 188.75it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 188.25it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 188.74it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 189.06it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 188.71it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 188.79it/s]replace nan value:  63%|██████▎   | 347/553 [00:01<00:01, 187.03it/s]replace nan value:  66%|██████▌   | 366/553 [00:01<00:01, 183.99it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 184.16it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 183.51it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 181.89it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 181.38it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 181.24it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 180.99it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 179.86it/s]replace nan value:  93%|█████████▎| 517/553 [00:02<00:00, 178.86it/s]replace nan value:  97%|█████████▋| 535/553 [00:02<00:00, 177.76it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 177.10it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 184.54it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 133.18it/s]  5%|▌         | 29/553 [00:00<00:03, 137.88it/s]  8%|▊         | 43/553 [00:00<00:03, 130.47it/s] 10%|█         | 57/553 [00:00<00:04, 121.78it/s] 13%|█▎        | 70/553 [00:00<00:04, 115.18it/s] 16%|█▌        | 86/553 [00:00<00:03, 127.76it/s] 18%|█▊        | 99/553 [00:00<00:03, 123.04it/s] 21%|██        | 116/553 [00:00<00:03, 136.03it/s] 24%|██▎       | 130/553 [00:01<00:03, 134.68it/s] 27%|██▋       | 148/553 [00:01<00:02, 147.79it/s] 30%|██▉       | 165/553 [00:01<00:02, 151.86it/s] 33%|███▎      | 181/553 [00:01<00:02, 151.66it/s] 36%|███▌      | 197/553 [00:01<00:02, 152.54it/s] 39%|███▊      | 214/553 [00:01<00:02, 157.06it/s] 42%|████▏     | 230/553 [00:01<00:02, 144.94it/s] 44%|████▍     | 245/553 [00:01<00:02, 144.37it/s] 47%|████▋     | 261/553 [00:01<00:01, 148.62it/s] 50%|████▉     | 276/553 [00:01<00:01, 140.61it/s] 53%|█████▎    | 292/553 [00:02<00:01, 140.78it/s] 56%|█████▌    | 307/553 [00:02<00:01, 132.15it/s] 58%|█████▊    | 321/553 [00:02<00:01, 128.70it/s] 61%|██████    | 335/553 [00:02<00:01, 131.46it/s] 63%|██████▎   | 349/553 [00:02<00:01, 128.94it/s] 65%|██████▌   | 362/553 [00:02<00:01, 125.19it/s] 68%|██████▊   | 377/553 [00:02<00:01, 130.59it/s] 71%|███████   | 391/553 [00:02<00:01, 120.59it/s] 73%|███████▎  | 404/553 [00:03<00:01, 122.74it/s] 75%|███████▌  | 417/553 [00:03<00:01, 120.98it/s] 78%|███████▊  | 430/553 [00:03<00:01, 118.11it/s] 81%|████████  | 448/553 [00:03<00:00, 134.09it/s] 84%|████████▍ | 464/553 [00:03<00:00, 139.57it/s] 87%|████████▋ | 479/553 [00:03<00:00, 136.63it/s] 89%|████████▉ | 493/553 [00:03<00:00, 131.17it/s] 92%|█████████▏| 507/553 [00:03<00:00, 131.71it/s] 94%|█████████▍| 521/553 [00:03<00:00, 129.85it/s] 97%|█████████▋| 535/553 [00:04<00:00, 105.83it/s] 99%|█████████▉| 547/553 [00:04<00:00, 105.49it/s]100%|██████████| 553/553 [00:04<00:00, 128.32it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 32/139 [00:00<00:00, 317.57it/s]extract the null data:  68%|██████▊   | 94/139 [00:00<00:00, 491.51it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 498.19it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 197.28it/s]replace nan value:  29%|██▉       | 41/139 [00:00<00:00, 198.92it/s]replace nan value:  44%|████▍     | 61/139 [00:00<00:00, 196.38it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 197.60it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 195.32it/s]replace nan value:  87%|████████▋ | 121/139 [00:00<00:00, 193.60it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 194.80it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.74it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.77it/s] 28%|██▊       | 39/139 [00:00<00:00, 130.23it/s] 38%|███▊      | 53/139 [00:00<00:00, 122.75it/s] 48%|████▊     | 67/139 [00:00<00:00, 122.27it/s] 58%|█████▊    | 80/139 [00:00<00:00, 117.74it/s] 66%|██████▌   | 92/139 [00:00<00:00, 108.77it/s] 76%|███████▌  | 105/139 [00:00<00:00, 110.27it/s] 85%|████████▍ | 118/139 [00:01<00:00, 115.75it/s] 94%|█████████▎| 130/139 [00:01<00:00, 116.78it/s]100%|██████████| 139/139 [00:01<00:00, 118.99it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 20/173 [00:00<00:00, 199.32it/s]extract the null data:  43%|████▎     | 75/173 [00:00<00:00, 404.26it/s]extract the null data:  76%|███████▌  | 131/173 [00:00<00:00, 474.64it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 453.70it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 188.06it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 191.81it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 192.79it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 192.44it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 192.50it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 191.35it/s]replace nan value:  80%|████████  | 139/173 [00:00<00:00, 194.00it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 192.82it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 191.16it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.31it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.70it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.89it/s] 33%|███▎      | 57/173 [00:00<00:00, 131.55it/s] 41%|████      | 71/173 [00:00<00:00, 131.45it/s] 49%|████▉     | 85/173 [00:00<00:00, 130.11it/s] 57%|█████▋    | 99/173 [00:00<00:00, 130.15it/s] 66%|██████▌   | 114/173 [00:00<00:00, 134.64it/s] 74%|███████▍  | 128/173 [00:01<00:00, 125.14it/s] 82%|████████▏ | 141/173 [00:01<00:00, 124.67it/s] 89%|████████▉ | 154/173 [00:01<00:00, 115.25it/s] 96%|█████████▌| 166/173 [00:01<00:00, 91.34it/s] 100%|██████████| 173/173 [00:01<00:00, 111.54it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.008, train acc : 0.889, valid acc : 0.914, train f1 : 0.556, valid f1 : 0.549
training process:   1%|          | 1/128 [01:01<2:10:33, 61.68s/it]Best score increase :0.000 -> 0.549
training process:   2%|▏         | 2/128 [01:51<1:55:28, 54.99s/it]Best score increase :0.549 -> 0.590
training process:   2%|▏         | 3/128 [02:41<1:49:28, 52.55s/it]Best score increase :0.590 -> 0.673
training process:   3%|▎         | 4/128 [03:34<1:48:27, 52.48s/it]Best score increase :0.673 -> 0.747
epoch : 5, train loss : 0.005, valid loss : 0.004, train acc : 0.940, valid acc : 0.944, train f1 : 0.757, valid f1 : 0.774
training process:   4%|▍         | 5/128 [04:31<1:51:20, 54.32s/it]Best score increase :0.747 -> 0.774
training process:   5%|▍         | 6/128 [05:24<1:49:48, 54.00s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:14<1:45:54, 52.52s/it]Best score increase :0.774 -> 0.785
training process:   6%|▋         | 8/128 [07:08<1:46:10, 53.09s/it]Best score increase :0.785 -> 0.797
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.950, valid acc : 0.950, train f1 : 0.802, valid f1 : 0.799
training process:   7%|▋         | 9/128 [08:09<1:50:20, 55.64s/it]Best score increase :0.797 -> 0.799
training process:   8%|▊         | 10/128 [09:02<1:47:20, 54.58s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:51<1:43:08, 52.89s/it]Best score increase :0.799 -> 0.801
training process:   9%|▉         | 12/128 [10:41<1:40:35, 52.03s/it]Best score increase :0.801 -> 0.810
epoch : 13, train loss : 0.003, valid loss : 0.003, train acc : 0.953, valid acc : 0.951, train f1 : 0.811, valid f1 : 0.806
training process:  10%|█         | 13/128 [11:45<1:47:02, 55.85s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:40<1:45:07, 55.33s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [13:34<1:43:35, 55.00s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [14:27<1:41:41, 54.47s/it]Best score increase :0.810 -> 0.824
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.955, valid acc : 0.954, train f1 : 0.819, valid f1 : 0.813
training process:  13%|█▎        | 17/128 [15:32<1:46:47, 57.73s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [16:24<1:42:15, 55.77s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [17:16<1:39:19, 54.68s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [18:07<1:36:49, 53.79s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train acc : 0.957, valid acc : 0.953, train f1 : 0.825, valid f1 : 0.809
training process:  16%|█▋        | 21/128 [19:07<1:38:59, 55.51s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [19:56<1:34:27, 53.47s/it]EarlyStopping counter : 6 out of 12
training process:  18%|█▊        | 23/128 [20:44<1:30:41, 51.82s/it]EarlyStopping counter : 7 out of 12
training process:  19%|█▉        | 24/128 [21:33<1:28:18, 50.94s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.003, valid loss : 0.003, train acc : 0.959, valid acc : 0.956, train f1 : 0.836, valid f1 : 0.822
training process:  20%|█▉        | 25/128 [22:34<1:32:56, 54.14s/it]EarlyStopping counter : 9 out of 12
training process:  20%|██        | 26/128 [23:23<1:29:30, 52.66s/it]EarlyStopping counter : 10 out of 12
training process:  21%|██        | 27/128 [24:12<1:26:25, 51.35s/it]Best score increase :0.824 -> 0.827
training process:  22%|██▏       | 28/128 [25:00<1:24:09, 50.50s/it]Best score increase :0.827 -> 0.828
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.957, train f1 : 0.841, valid f1 : 0.829
training process:  23%|██▎       | 29/128 [25:58<1:27:05, 52.78s/it]Best score increase :0.828 -> 0.829
training process:  23%|██▎       | 30/128 [26:47<1:24:17, 51.61s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [27:35<1:21:39, 50.51s/it]Best score increase :0.829 -> 0.834
training process:  25%|██▌       | 32/128 [28:24<1:20:06, 50.07s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.957, train f1 : 0.844, valid f1 : 0.828
training process:  26%|██▌       | 33/128 [29:22<1:23:06, 52.49s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [30:11<1:20:26, 51.34s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [30:59<1:17:54, 50.26s/it]Best score increase :0.834 -> 0.842
training process:  28%|██▊       | 36/128 [31:46<1:15:49, 49.46s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.002, train acc : 0.961, valid acc : 0.959, train f1 : 0.845, valid f1 : 0.838
training process:  29%|██▉       | 37/128 [32:45<1:19:18, 52.29s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [33:34<1:16:48, 51.20s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [34:25<1:15:49, 51.12s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [35:15<1:14:48, 51.00s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.002, train acc : 0.963, valid acc : 0.959, train f1 : 0.853, valid f1 : 0.842
training process:  32%|███▏      | 41/128 [36:13<1:16:51, 53.00s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [37:02<1:14:07, 51.71s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [37:53<1:13:00, 51.54s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [38:44<1:11:51, 51.33s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.002, train acc : 0.963, valid acc : 0.960, train f1 : 0.856, valid f1 : 0.842
training process:  35%|███▌      | 45/128 [39:42<1:13:47, 53.35s/it]EarlyStopping counter : 10 out of 12
training process:  36%|███▌      | 46/128 [40:30<1:10:51, 51.85s/it]Best score increase :0.842 -> 0.851
training process:  37%|███▋      | 47/128 [41:22<1:09:52, 51.76s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [42:12<1:08:34, 51.43s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.002, train acc : 0.963, valid acc : 0.960, train f1 : 0.856, valid f1 : 0.843
training process:  38%|███▊      | 49/128 [43:11<1:10:25, 53.49s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [44:00<1:07:45, 52.12s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [44:54<1:07:33, 52.65s/it]Best score increase :0.851 -> 0.857
training process:  41%|████      | 52/128 [45:49<1:07:42, 53.45s/it]EarlyStopping counter : 1 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.002, train acc : 0.964, valid acc : 0.959, train f1 : 0.859, valid f1 : 0.837
training process:  41%|████▏     | 53/128 [46:51<1:10:13, 56.18s/it]EarlyStopping counter : 2 out of 12
training process:  42%|████▏     | 54/128 [47:48<1:09:26, 56.31s/it]EarlyStopping counter : 3 out of 12
training process:  43%|████▎     | 55/128 [48:45<1:08:38, 56.42s/it]EarlyStopping counter : 4 out of 12
training process:  44%|████▍     | 56/128 [49:41<1:07:45, 56.46s/it]EarlyStopping counter : 5 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.002, train acc : 0.964, valid acc : 0.960, train f1 : 0.859, valid f1 : 0.840
training process:  45%|████▍     | 57/128 [50:44<1:09:06, 58.40s/it]EarlyStopping counter : 6 out of 12
training process:  45%|████▌     | 58/128 [51:37<1:06:15, 56.79s/it]EarlyStopping counter : 7 out of 12
training process:  46%|████▌     | 59/128 [52:31<1:04:26, 56.04s/it]EarlyStopping counter : 8 out of 12
training process:  47%|████▋     | 60/128 [53:22<1:01:31, 54.29s/it]EarlyStopping counter : 9 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.002, train acc : 0.964, valid acc : 0.961, train f1 : 0.861, valid f1 : 0.849
training process:  48%|████▊     | 61/128 [54:22<1:02:47, 56.23s/it]EarlyStopping counter : 10 out of 12
training process:  48%|████▊     | 62/128 [55:11<59:16, 53.88s/it]  EarlyStopping counter : 11 out of 12
training process:  49%|████▉     | 63/128 [56:00<56:45, 52.39s/it]Best score increase :0.857 -> 0.860
training process:  50%|█████     | 64/128 [56:50<55:06, 51.66s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.002, valid loss : 0.002, train acc : 0.964, valid acc : 0.964, train f1 : 0.862, valid f1 : 0.866
training process:  51%|█████     | 65/128 [57:49<56:34, 53.88s/it]Best score increase :0.860 -> 0.866
training process:  52%|█████▏    | 66/128 [58:36<53:38, 51.91s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 67/128 [59:28<52:41, 51.82s/it]Best score increase :0.866 -> 0.867
training process:  53%|█████▎    | 68/128 [1:00:18<51:27, 51.46s/it]EarlyStopping counter : 1 out of 12
epoch : 69, train loss : 0.002, valid loss : 0.002, train acc : 0.964, valid acc : 0.964, train f1 : 0.861, valid f1 : 0.864
training process:  54%|█████▍    | 69/128 [1:01:18<53:05, 53.99s/it]EarlyStopping counter : 2 out of 12
training process:  55%|█████▍    | 70/128 [1:02:08<51:06, 52.87s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▌    | 71/128 [1:03:00<49:49, 52.45s/it]EarlyStopping counter : 4 out of 12
training process:  56%|█████▋    | 72/128 [1:03:52<48:47, 52.27s/it]EarlyStopping counter : 5 out of 12
epoch : 73, train loss : 0.002, valid loss : 0.002, train acc : 0.965, valid acc : 0.963, train f1 : 0.867, valid f1 : 0.865
training process:  57%|█████▋    | 73/128 [1:04:54<50:40, 55.28s/it]EarlyStopping counter : 6 out of 12
training process:  58%|█████▊    | 74/128 [1:05:45<48:30, 53.90s/it]EarlyStopping counter : 7 out of 12
training process:  59%|█████▊    | 75/128 [1:06:36<46:51, 53.05s/it]EarlyStopping counter : 8 out of 12
training process:  59%|█████▉    | 76/128 [1:07:25<44:55, 51.84s/it]Best score increase :0.867 -> 0.869
epoch : 77, train loss : 0.002, valid loss : 0.002, train acc : 0.966, valid acc : 0.963, train f1 : 0.868, valid f1 : 0.863
training process:  60%|██████    | 77/128 [1:08:21<45:15, 53.25s/it]EarlyStopping counter : 1 out of 12
training process:  61%|██████    | 78/128 [1:09:10<43:18, 51.96s/it]EarlyStopping counter : 2 out of 12
training process:  62%|██████▏   | 79/128 [1:09:59<41:41, 51.04s/it]EarlyStopping counter : 3 out of 12
training process:  62%|██████▎   | 80/128 [1:10:48<40:17, 50.37s/it]EarlyStopping counter : 4 out of 12
epoch : 81, train loss : 0.002, valid loss : 0.002, train acc : 0.966, valid acc : 0.961, train f1 : 0.866, valid f1 : 0.852
training process:  63%|██████▎   | 81/128 [1:11:46<41:19, 52.77s/it]EarlyStopping counter : 5 out of 12
training process:  64%|██████▍   | 82/128 [1:12:37<39:55, 52.07s/it]EarlyStopping counter : 6 out of 12
training process:  65%|██████▍   | 83/128 [1:13:27<38:35, 51.45s/it]EarlyStopping counter : 7 out of 12
training process:  66%|██████▌   | 84/128 [1:14:17<37:26, 51.06s/it]EarlyStopping counter : 8 out of 12
epoch : 85, train loss : 0.002, valid loss : 0.002, train acc : 0.966, valid acc : 0.963, train f1 : 0.869, valid f1 : 0.862
training process:  66%|██████▋   | 85/128 [1:15:15<38:11, 53.28s/it]EarlyStopping counter : 9 out of 12
training process:  67%|██████▋   | 86/128 [1:16:07<36:51, 52.65s/it]EarlyStopping counter : 10 out of 12
training process:  68%|██████▊   | 87/128 [1:16:58<35:39, 52.19s/it]EarlyStopping counter : 11 out of 12
training process:  68%|██████▊   | 87/128 [1:17:48<36:40, 53.66s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 87, best f1 score : 0.869
training process finished, best loss : 0.002 and best acc : 0.964, best f1 : 0.869, best epoch : 75

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.92      0.67      0.78       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.94      0.83      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.83, test loss : 0.134

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.15s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.27s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:14,  8.26s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:05,  8.16s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:56,  8.03s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.05s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:40,  8.08s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:32,  8.06s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:13<00:25,  8.37s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:22<00:16,  8.43s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:31<00:08,  8.50s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.47s/it]processing for feature importance: 100%|██████████| 12/12 [01:39<00:00,  8.29s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 15%|█▌        | 47/306 [00:00<00:00, 463.98it/s] 31%|███       | 94/306 [00:00<00:00, 401.75it/s] 44%|████▍     | 135/306 [00:00<00:00, 317.93it/s] 59%|█████▉    | 181/306 [00:00<00:00, 362.64it/s] 72%|███████▏  | 220/306 [00:00<00:00, 286.20it/s] 88%|████████▊ | 270/306 [00:00<00:00, 338.63it/s]100%|██████████| 306/306 [00:00<00:00, 334.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 552.89it/s]extract the null data:  20%|██        | 113/553 [00:00<00:00, 561.97it/s]extract the null data:  31%|███       | 171/553 [00:00<00:00, 567.26it/s]extract the null data:  41%|████      | 228/553 [00:00<00:00, 564.52it/s]extract the null data:  52%|█████▏    | 285/553 [00:00<00:00, 550.48it/s]extract the null data:  62%|██████▏   | 341/553 [00:00<00:00, 549.26it/s]extract the null data:  72%|███████▏  | 399/553 [00:00<00:00, 557.64it/s]extract the null data:  82%|████████▏ | 455/553 [00:00<00:00, 557.93it/s]extract the null data:  92%|█████████▏| 511/553 [00:00<00:00, 552.87it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 556.64it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 192.97it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 191.52it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 191.63it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 193.03it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 192.16it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 194.37it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 195.88it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 195.77it/s]replace nan value:  33%|███▎      | 180/553 [00:00<00:01, 196.02it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:01, 196.51it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 195.32it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 196.11it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 196.64it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 196.36it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 195.57it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 195.46it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 195.19it/s]replace nan value:  65%|██████▌   | 360/553 [00:01<00:00, 194.76it/s]replace nan value:  69%|██████▊   | 380/553 [00:01<00:00, 193.99it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 193.26it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 193.40it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 194.88it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 194.50it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 194.48it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 194.37it/s]replace nan value:  94%|█████████▍| 520/553 [00:02<00:00, 194.09it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 194.33it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 194.69it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.81it/s]  5%|▌         | 29/553 [00:00<00:03, 141.15it/s]  8%|▊         | 44/553 [00:00<00:03, 131.68it/s] 10%|█         | 58/553 [00:00<00:04, 122.38it/s] 13%|█▎        | 71/553 [00:00<00:04, 120.18it/s] 16%|█▌        | 88/553 [00:00<00:03, 133.69it/s] 18%|█▊        | 102/553 [00:00<00:03, 127.56it/s] 22%|██▏       | 120/553 [00:00<00:03, 140.16it/s] 24%|██▍       | 135/553 [00:01<00:02, 140.97it/s] 28%|██▊       | 154/553 [00:01<00:02, 153.69it/s] 31%|███       | 172/553 [00:01<00:02, 160.23it/s] 34%|███▍      | 189/553 [00:01<00:02, 156.58it/s] 38%|███▊      | 208/553 [00:01<00:02, 164.01it/s] 41%|████      | 225/553 [00:01<00:02, 154.57it/s] 44%|████▎     | 241/553 [00:01<00:02, 154.98it/s] 46%|████▋     | 257/553 [00:01<00:01, 149.22it/s] 49%|████▉     | 273/553 [00:01<00:01, 145.25it/s] 52%|█████▏    | 289/553 [00:01<00:01, 148.98it/s] 55%|█████▍    | 304/553 [00:02<00:01, 139.96it/s] 58%|█████▊    | 319/553 [00:02<00:01, 129.32it/s] 60%|██████    | 333/553 [00:02<00:01, 131.62it/s] 63%|██████▎   | 348/553 [00:02<00:01, 133.10it/s] 65%|██████▌   | 362/553 [00:02<00:01, 129.18it/s] 68%|██████▊   | 378/553 [00:02<00:01, 134.63it/s] 71%|███████   | 392/553 [00:02<00:01, 125.43it/s] 73%|███████▎  | 405/553 [00:02<00:01, 125.81it/s] 76%|███████▌  | 418/553 [00:03<00:01, 123.32it/s] 78%|███████▊  | 431/553 [00:03<00:01, 120.39it/s] 81%|████████▏ | 450/553 [00:03<00:00, 138.13it/s] 84%|████████▍ | 465/553 [00:03<00:00, 139.30it/s] 87%|████████▋ | 480/553 [00:03<00:00, 135.29it/s] 89%|████████▉ | 494/553 [00:03<00:00, 130.64it/s] 92%|█████████▏| 509/553 [00:03<00:00, 134.15it/s] 95%|█████████▍| 523/553 [00:03<00:00, 125.76it/s] 97%|█████████▋| 536/553 [00:03<00:00, 116.50it/s]100%|█████████▉| 551/553 [00:04<00:00, 106.59it/s]100%|██████████| 553/553 [00:04<00:00, 133.55it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 329.89it/s]extract the null data:  71%|███████   | 99/139 [00:00<00:00, 523.12it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 528.14it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 213.91it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 214.65it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 212.63it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 211.23it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 212.30it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 210.83it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 212.02it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 119.36it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.37it/s] 29%|██▉       | 41/139 [00:00<00:00, 136.02it/s] 40%|███▉      | 55/139 [00:00<00:00, 127.25it/s] 51%|█████     | 71/139 [00:00<00:00, 135.29it/s] 61%|██████    | 85/139 [00:00<00:00, 132.36it/s] 71%|███████   | 99/139 [00:00<00:00, 127.48it/s] 81%|████████▏ | 113/139 [00:00<00:00, 130.85it/s] 93%|█████████▎| 129/139 [00:00<00:00, 138.03it/s]100%|██████████| 139/139 [00:01<00:00, 134.73it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|█▉        | 34/173 [00:00<00:00, 339.74it/s]extract the null data:  59%|█████▉    | 102/173 [00:00<00:00, 538.62it/s]extract the null data:  97%|█████████▋| 167/173 [00:00<00:00, 585.71it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 554.68it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 212.04it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 214.13it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 212.39it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 211.50it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 212.95it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 211.45it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 209.73it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 210.09it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 135.03it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.63it/s] 25%|██▍       | 43/173 [00:00<00:01, 129.46it/s] 34%|███▎      | 58/173 [00:00<00:00, 134.77it/s] 42%|████▏     | 72/173 [00:00<00:00, 133.90it/s] 50%|████▉     | 86/173 [00:00<00:00, 131.72it/s] 58%|█████▊    | 100/173 [00:00<00:00, 131.88it/s] 66%|██████▋   | 115/173 [00:00<00:00, 137.30it/s] 75%|███████▍  | 129/173 [00:00<00:00, 129.09it/s] 83%|████████▎ | 143/173 [00:01<00:00, 126.71it/s] 90%|█████████ | 156/173 [00:01<00:00, 116.95it/s] 97%|█████████▋| 168/173 [00:01<00:00, 97.98it/s] 100%|██████████| 173/173 [00:01<00:00, 116.66it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.010, train acc : 0.684, valid acc : 0.785, train f1 : 0.684, valid f1 : 0.613
training process:   1%|          | 1/128 [00:58<2:02:49, 58.02s/it]Best score increase :0.000 -> 0.613
training process:   2%|▏         | 2/128 [01:47<1:51:12, 52.96s/it]Best score increase :0.613 -> 0.673
training process:   2%|▏         | 3/128 [02:37<1:47:38, 51.67s/it]Best score increase :0.673 -> 0.735
training process:   3%|▎         | 4/128 [03:28<1:46:19, 51.45s/it]Best score increase :0.735 -> 0.737
epoch : 5, train loss : 0.007, valid loss : 0.006, train acc : 0.840, valid acc : 0.897, train f1 : 0.840, valid f1 : 0.752
training process:   4%|▍         | 5/128 [04:29<1:52:34, 54.91s/it]Best score increase :0.737 -> 0.752
training process:   5%|▍         | 6/128 [05:22<1:50:21, 54.27s/it]Best score increase :0.752 -> 0.766
training process:   5%|▌         | 7/128 [06:14<1:47:57, 53.53s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:04<1:44:56, 52.47s/it]Best score increase :0.766 -> 0.797
epoch : 9, train loss : 0.006, valid loss : 0.005, train acc : 0.860, valid acc : 0.918, train f1 : 0.860, valid f1 : 0.790
training process:   7%|▋         | 9/128 [08:02<1:47:08, 54.02s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [08:56<1:46:10, 53.99s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [09:48<1:44:17, 53.48s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [10:43<1:43:56, 53.77s/it]EarlyStopping counter : 4 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.004, train acc : 0.878, valid acc : 0.939, train f1 : 0.878, valid f1 : 0.820
training process:  10%|█         | 13/128 [11:46<1:48:36, 56.66s/it]Best score increase :0.797 -> 0.820
training process:  11%|█         | 14/128 [12:34<1:42:51, 54.14s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:27<1:40:56, 53.60s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:17<1:38:19, 52.68s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.005, train acc : 0.883, valid acc : 0.893, train f1 : 0.883, valid f1 : 0.754
training process:  13%|█▎        | 17/128 [15:13<1:39:30, 53.79s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [16:04<1:36:42, 52.75s/it]EarlyStopping counter : 5 out of 12
training process:  15%|█▍        | 19/128 [16:54<1:34:14, 51.87s/it]EarlyStopping counter : 6 out of 12
training process:  16%|█▌        | 20/128 [17:43<1:31:58, 51.10s/it]EarlyStopping counter : 7 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.004, train acc : 0.895, valid acc : 0.910, train f1 : 0.895, valid f1 : 0.777
training process:  16%|█▋        | 21/128 [18:41<1:34:41, 53.10s/it]EarlyStopping counter : 8 out of 12
training process:  17%|█▋        | 22/128 [19:31<1:32:22, 52.29s/it]EarlyStopping counter : 9 out of 12
training process:  18%|█▊        | 23/128 [20:20<1:29:53, 51.36s/it]EarlyStopping counter : 10 out of 12
training process:  19%|█▉        | 24/128 [21:09<1:27:51, 50.69s/it]EarlyStopping counter : 11 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.004, train acc : 0.896, valid acc : 0.910, train f1 : 0.896, valid f1 : 0.777
training process:  19%|█▉        | 24/128 [22:05<1:35:45, 55.25s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 24, best f1 score : 0.820
training process finished, best loss : 0.004 and best acc : 0.937, best f1 : 0.820, best epoch : 15

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.55      0.78      0.64       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.86      0.80      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.86, test loss : 0.236

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.37s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.32s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.49s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.49s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.44s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.46s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.53s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:30,  7.55s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.66s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:15,  7.63s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.69s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.71s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.58s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█         | 33/306 [00:00<00:00, 326.73it/s] 26%|██▌       | 80/306 [00:00<00:00, 388.18it/s] 40%|███▉      | 121/306 [00:00<00:00, 396.05it/s] 53%|█████▎    | 161/306 [00:00<00:00, 380.13it/s] 70%|██████▉   | 214/306 [00:00<00:00, 430.92it/s] 84%|████████▍ | 258/306 [00:00<00:00, 416.89it/s] 98%|█████████▊| 301/306 [00:00<00:00, 417.10it/s]100%|██████████| 306/306 [00:00<00:00, 404.44it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 552.96it/s]extract the null data:  20%|██        | 113/553 [00:00<00:00, 559.79it/s]extract the null data:  31%|███       | 171/553 [00:00<00:00, 567.81it/s]extract the null data:  41%|████▏     | 229/553 [00:00<00:00, 568.73it/s]extract the null data:  52%|█████▏    | 286/553 [00:00<00:00, 563.90it/s]extract the null data:  62%|██████▏   | 343/553 [00:00<00:00, 543.47it/s]extract the null data:  72%|███████▏  | 398/553 [00:00<00:00, 532.59it/s]extract the null data:  82%|████████▏ | 452/553 [00:00<00:00, 524.80it/s]extract the null data:  92%|█████████▏| 508/553 [00:00<00:00, 534.50it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 543.53it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 182.29it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 187.79it/s]replace nan value:  10%|█         | 58/553 [00:00<00:02, 187.28it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 186.99it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:02, 188.19it/s]replace nan value:  21%|██        | 116/553 [00:00<00:02, 188.70it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 190.42it/s]replace nan value:  28%|██▊       | 156/553 [00:00<00:02, 191.39it/s]replace nan value:  32%|███▏      | 176/553 [00:00<00:01, 191.27it/s]replace nan value:  35%|███▌      | 196/553 [00:01<00:01, 190.85it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:01, 191.12it/s]replace nan value:  43%|████▎     | 236/553 [00:01<00:01, 188.04it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 186.50it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 185.55it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 186.93it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 187.72it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 189.53it/s]replace nan value:  64%|██████▍   | 353/553 [00:01<00:01, 190.83it/s]replace nan value:  67%|██████▋   | 373/553 [00:01<00:00, 191.28it/s]replace nan value:  71%|███████   | 393/553 [00:02<00:00, 189.93it/s]replace nan value:  75%|███████▍  | 413/553 [00:02<00:00, 191.13it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 189.65it/s]replace nan value:  82%|████████▏ | 452/553 [00:02<00:00, 187.99it/s]replace nan value:  85%|████████▌ | 471/553 [00:02<00:00, 185.90it/s]replace nan value:  89%|████████▊ | 490/553 [00:02<00:00, 185.39it/s]replace nan value:  92%|█████████▏| 509/553 [00:02<00:00, 184.40it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 183.31it/s]replace nan value:  99%|█████████▉| 547/553 [00:02<00:00, 181.71it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 186.87it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 10/553 [00:00<00:05, 98.46it/s]  4%|▍         | 24/553 [00:00<00:04, 119.08it/s]  7%|▋         | 38/553 [00:00<00:04, 125.33it/s]  9%|▉         | 51/553 [00:00<00:04, 105.87it/s] 11%|█         | 62/553 [00:00<00:04, 99.08it/s]  13%|█▎        | 73/553 [00:00<00:04, 100.84it/s] 16%|█▌        | 86/553 [00:00<00:04, 108.50it/s] 18%|█▊        | 98/553 [00:00<00:04, 106.01it/s] 20%|██        | 113/553 [00:01<00:03, 116.02it/s] 23%|██▎       | 125/553 [00:01<00:03, 114.43it/s] 25%|██▌       | 141/553 [00:01<00:03, 124.59it/s] 29%|██▊       | 158/553 [00:01<00:02, 135.29it/s] 31%|███▏      | 173/553 [00:01<00:02, 137.72it/s] 34%|███▍      | 187/553 [00:01<00:02, 132.37it/s] 37%|███▋      | 202/553 [00:01<00:02, 136.61it/s] 39%|███▉      | 216/553 [00:01<00:02, 137.03it/s] 42%|████▏     | 230/553 [00:01<00:02, 126.82it/s] 44%|████▍     | 244/553 [00:02<00:02, 125.69it/s] 47%|████▋     | 258/553 [00:02<00:02, 127.44it/s] 49%|████▉     | 271/553 [00:02<00:02, 122.52it/s] 51%|█████▏    | 284/553 [00:02<00:02, 122.99it/s] 54%|█████▎    | 297/553 [00:02<00:02, 117.14it/s] 56%|█████▌    | 310/553 [00:02<00:02, 117.09it/s] 58%|█████▊    | 322/553 [00:02<00:02, 115.05it/s] 60%|██████    | 334/553 [00:02<00:01, 114.82it/s] 63%|██████▎   | 346/553 [00:02<00:01, 116.14it/s] 65%|██████▍   | 358/553 [00:03<00:01, 113.10it/s] 67%|██████▋   | 372/553 [00:03<00:01, 119.45it/s] 70%|██████▉   | 385/553 [00:03<00:01, 117.03it/s] 72%|███████▏  | 397/553 [00:03<00:01, 108.78it/s] 75%|███████▍  | 414/553 [00:03<00:01, 119.51it/s] 77%|███████▋  | 427/553 [00:03<00:01, 110.82it/s] 80%|████████  | 443/553 [00:03<00:00, 123.38it/s] 83%|████████▎ | 459/553 [00:03<00:00, 132.01it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.95it/s] 88%|████████▊ | 488/553 [00:04<00:00, 129.74it/s] 91%|█████████ | 502/553 [00:04<00:00, 124.17it/s] 93%|█████████▎| 517/553 [00:04<00:00, 131.03it/s] 96%|█████████▌| 531/553 [00:04<00:00, 111.29it/s] 99%|█████████▉| 547/553 [00:04<00:00, 122.50it/s]100%|██████████| 553/553 [00:04<00:00, 118.89it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 329.03it/s]extract the null data:  71%|███████   | 98/139 [00:00<00:00, 515.50it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 529.45it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 208.17it/s]replace nan value:  31%|███       | 43/139 [00:00<00:00, 210.26it/s]replace nan value:  47%|████▋     | 65/139 [00:00<00:00, 209.85it/s]replace nan value:  62%|██████▏   | 86/139 [00:00<00:00, 208.97it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 207.42it/s]replace nan value:  92%|█████████▏| 128/139 [00:00<00:00, 206.92it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 207.90it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.95it/s] 18%|█▊        | 25/139 [00:00<00:00, 123.82it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.58it/s] 39%|███▉      | 54/139 [00:00<00:00, 124.90it/s] 48%|████▊     | 67/139 [00:00<00:00, 125.75it/s] 58%|█████▊    | 80/139 [00:00<00:00, 123.97it/s] 67%|██████▋   | 93/139 [00:00<00:00, 117.40it/s] 77%|███████▋  | 107/139 [00:00<00:00, 122.88it/s] 89%|████████▉ | 124/139 [00:00<00:00, 136.01it/s]100%|██████████| 139/139 [00:01<00:00, 138.74it/s]100%|██████████| 139/139 [00:01<00:00, 129.67it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 266.95it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 488.02it/s]extract the null data:  91%|█████████▏| 158/173 [00:00<00:00, 564.03it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 525.25it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 209.01it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 208.32it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 212.34it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 210.83it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 210.10it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 208.55it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 206.94it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 203.89it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 207.08it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 133.08it/s] 16%|█▌        | 28/173 [00:00<00:01, 116.31it/s] 24%|██▍       | 42/173 [00:00<00:01, 125.21it/s] 33%|███▎      | 57/173 [00:00<00:00, 132.40it/s] 41%|████      | 71/173 [00:00<00:00, 131.23it/s] 49%|████▉     | 85/173 [00:00<00:00, 130.85it/s] 57%|█████▋    | 99/173 [00:00<00:00, 131.10it/s] 66%|██████▌   | 114/173 [00:00<00:00, 135.70it/s] 74%|███████▍  | 128/173 [00:00<00:00, 127.65it/s] 82%|████████▏ | 141/173 [00:01<00:00, 127.36it/s] 89%|████████▉ | 154/173 [00:01<00:00, 118.40it/s] 96%|█████████▌| 166/173 [00:01<00:00, 94.21it/s] 100%|██████████| 173/173 [00:01<00:00, 113.64it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.614, valid acc : 0.679, train f1 : 0.488, valid f1 : 0.541
training process:   1%|          | 1/128 [01:01<2:09:17, 61.08s/it]Best score increase :0.000 -> 0.541
training process:   2%|▏         | 2/128 [01:54<1:58:33, 56.46s/it]Best score increase :0.541 -> 0.667
training process:   2%|▏         | 3/128 [02:43<1:51:07, 53.34s/it]Best score increase :0.667 -> 0.734
training process:   3%|▎         | 4/128 [03:35<1:48:42, 52.60s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.874, valid acc : 0.915, train f1 : 0.714, valid f1 : 0.775
training process:   4%|▍         | 5/128 [04:37<1:54:52, 56.03s/it]Best score increase :0.734 -> 0.775
training process:   5%|▍         | 6/128 [05:32<1:53:18, 55.73s/it]Best score increase :0.775 -> 0.794
training process:   5%|▌         | 7/128 [06:24<1:50:05, 54.59s/it]Best score increase :0.794 -> 0.798
training process:   6%|▋         | 8/128 [07:16<1:47:12, 53.61s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.906, valid acc : 0.916, train f1 : 0.761, valid f1 : 0.779
training process:   7%|▋         | 9/128 [08:18<1:51:42, 56.32s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [09:12<1:49:06, 55.48s/it]Best score increase :0.798 -> 0.807
training process:   9%|▊         | 11/128 [10:04<1:46:14, 54.49s/it]Best score increase :0.807 -> 0.810
training process:   9%|▉         | 12/128 [10:57<1:44:20, 53.97s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.007, train acc : 0.913, valid acc : 0.926, train f1 : 0.773, valid f1 : 0.797
training process:  10%|█         | 13/128 [11:54<1:45:21, 54.97s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:43<1:41:02, 53.18s/it]Best score increase :0.810 -> 0.819
training process:  12%|█▏        | 15/128 [13:35<1:39:24, 52.78s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:26<1:37:15, 52.11s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.006, train acc : 0.915, valid acc : 0.936, train f1 : 0.778, valid f1 : 0.815
training process:  13%|█▎        | 17/128 [15:23<1:39:20, 53.70s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [16:11<1:35:16, 51.97s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [17:02<1:34:00, 51.75s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [17:53<1:32:30, 51.40s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.006, train acc : 0.917, valid acc : 0.939, train f1 : 0.781, valid f1 : 0.821
training process:  16%|█▋        | 21/128 [18:50<1:34:41, 53.10s/it]Best score increase :0.819 -> 0.821
training process:  17%|█▋        | 22/128 [19:37<1:30:52, 51.44s/it]Best score increase :0.821 -> 0.823
training process:  18%|█▊        | 23/128 [20:26<1:28:34, 50.61s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [21:15<1:26:52, 50.12s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.006, train acc : 0.923, valid acc : 0.934, train f1 : 0.794, valid f1 : 0.812
training process:  20%|█▉        | 25/128 [22:12<1:29:21, 52.05s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [22:59<1:26:23, 50.82s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [23:47<1:24:04, 49.94s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [24:37<1:23:05, 49.85s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.006, valid loss : 0.006, train acc : 0.925, valid acc : 0.938, train f1 : 0.797, valid f1 : 0.820
training process:  23%|██▎       | 29/128 [25:38<1:27:57, 53.30s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [26:31<1:26:38, 53.04s/it]Best score increase :0.823 -> 0.840
training process:  24%|██▍       | 31/128 [27:23<1:25:29, 52.88s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [28:16<1:24:16, 52.68s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.006, valid loss : 0.007, train acc : 0.926, valid acc : 0.946, train f1 : 0.799, valid f1 : 0.832
training process:  26%|██▌       | 33/128 [29:13<1:25:38, 54.09s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 34/128 [30:05<1:23:51, 53.53s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 35/128 [30:57<1:22:03, 52.95s/it]EarlyStopping counter : 5 out of 12
training process:  28%|██▊       | 36/128 [31:50<1:21:30, 53.16s/it]EarlyStopping counter : 6 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.006, train acc : 0.929, valid acc : 0.940, train f1 : 0.807, valid f1 : 0.827
training process:  29%|██▉       | 37/128 [32:52<1:24:16, 55.57s/it]EarlyStopping counter : 7 out of 12
training process:  30%|██▉       | 38/128 [33:42<1:21:13, 54.15s/it]Best score increase :0.840 -> 0.843
training process:  30%|███       | 39/128 [34:34<1:19:09, 53.36s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [35:24<1:17:01, 52.52s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.005, valid loss : 0.005, train acc : 0.930, valid acc : 0.937, train f1 : 0.807, valid f1 : 0.826
training process:  32%|███▏      | 41/128 [36:26<1:19:52, 55.09s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [37:16<1:17:09, 53.83s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [38:07<1:14:45, 52.77s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [38:56<1:12:27, 51.76s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.005, valid loss : 0.006, train acc : 0.931, valid acc : 0.943, train f1 : 0.812, valid f1 : 0.835
training process:  35%|███▌      | 45/128 [39:55<1:14:20, 53.74s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [40:45<1:12:00, 52.69s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [41:37<1:10:54, 52.53s/it]EarlyStopping counter : 9 out of 12
training process:  38%|███▊      | 48/128 [42:29<1:09:50, 52.38s/it]Best score increase :0.843 -> 0.847
epoch : 49, train loss : 0.005, valid loss : 0.006, train acc : 0.933, valid acc : 0.946, train f1 : 0.816, valid f1 : 0.842
training process:  38%|███▊      | 49/128 [43:26<1:10:53, 53.84s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [44:17<1:08:38, 52.80s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [45:06<1:06:36, 51.90s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [46:02<1:07:02, 52.93s/it]Best score increase :0.847 -> 0.849
epoch : 53, train loss : 0.005, valid loss : 0.006, train acc : 0.933, valid acc : 0.948, train f1 : 0.815, valid f1 : 0.842
training process:  41%|████▏     | 53/128 [47:05<1:10:01, 56.02s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [47:58<1:07:55, 55.07s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [48:52<1:06:46, 54.89s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [49:49<1:06:25, 55.36s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.005, valid loss : 0.007, train acc : 0.936, valid acc : 0.954, train f1 : 0.821, valid f1 : 0.853
training process:  45%|████▍     | 57/128 [50:50<1:07:30, 57.04s/it]Best score increase :0.849 -> 0.853
training process:  45%|████▌     | 58/128 [51:46<1:06:22, 56.89s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [52:45<1:05:55, 57.32s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [53:41<1:04:35, 56.99s/it]EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.005, valid loss : 0.006, train acc : 0.936, valid acc : 0.947, train f1 : 0.820, valid f1 : 0.843
training process:  48%|████▊     | 61/128 [54:42<1:05:06, 58.31s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [55:31<1:00:56, 55.40s/it]EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [56:22<58:44, 54.23s/it]  EarlyStopping counter : 6 out of 12
training process:  50%|█████     | 64/128 [57:15<57:23, 53.80s/it]EarlyStopping counter : 7 out of 12
epoch : 65, train loss : 0.005, valid loss : 0.006, train acc : 0.938, valid acc : 0.949, train f1 : 0.826, valid f1 : 0.848
training process:  51%|█████     | 65/128 [58:16<58:36, 55.81s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 66/128 [59:07<56:16, 54.47s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 67/128 [59:57<54:08, 53.26s/it]EarlyStopping counter : 10 out of 12
training process:  53%|█████▎    | 68/128 [1:00:48<52:27, 52.46s/it]EarlyStopping counter : 11 out of 12
epoch : 69, train loss : 0.005, valid loss : 0.006, train acc : 0.939, valid acc : 0.939, train f1 : 0.829, valid f1 : 0.830
training process:  53%|█████▎    | 68/128 [1:01:48<54:32, 54.54s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 68, best f1 score : 0.853
training process finished, best loss : 0.007 and best acc : 0.954, best f1 : 0.853, best epoch : 56

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.77      0.71       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.87      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.87, test loss : 0.405

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.67s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:15,  7.56s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.71s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.63s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.47s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:44,  7.46s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:36,  7.39s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:29,  7.41s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.38s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:14,  7.41s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.49s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.53s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.50s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 13%|█▎        | 39/306 [00:00<00:00, 389.75it/s] 27%|██▋       | 83/306 [00:00<00:00, 408.77it/s] 46%|████▌     | 141/306 [00:00<00:00, 485.21it/s] 62%|██████▏   | 190/306 [00:00<00:00, 470.00it/s] 78%|███████▊  | 238/306 [00:00<00:00, 459.59it/s] 94%|█████████▍| 288/306 [00:00<00:00, 469.75it/s]100%|██████████| 306/306 [00:00<00:00, 461.26it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:01, 434.19it/s]extract the null data:  16%|█▌        | 89/553 [00:00<00:01, 439.55it/s]extract the null data:  24%|██▍       | 135/553 [00:00<00:00, 444.73it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 464.22it/s]extract the null data:  42%|████▏     | 232/553 [00:00<00:00, 448.95it/s]extract the null data:  50%|█████     | 277/553 [00:00<00:00, 448.40it/s]extract the null data:  58%|█████▊    | 323/553 [00:00<00:00, 449.82it/s]extract the null data:  67%|██████▋   | 372/553 [00:00<00:00, 461.77it/s]extract the null data:  76%|███████▌  | 419/553 [00:00<00:00, 462.59it/s]extract the null data:  84%|████████▍ | 466/553 [00:01<00:00, 459.64it/s]extract the null data:  93%|█████████▎| 512/553 [00:01<00:00, 456.87it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 455.27it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 165.71it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 172.41it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 176.30it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 175.63it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 178.10it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 178.95it/s]replace nan value:  23%|██▎       | 129/553 [00:00<00:02, 173.96it/s]replace nan value:  27%|██▋       | 147/553 [00:00<00:02, 174.08it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:02, 173.69it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 172.94it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:02, 173.36it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 171.05it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 170.44it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 166.21it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 166.48it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 167.35it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 165.25it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 163.04it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 164.86it/s]replace nan value:  65%|██████▍   | 358/553 [00:02<00:01, 167.13it/s]replace nan value:  68%|██████▊   | 376/553 [00:02<00:01, 169.09it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:00, 169.48it/s]replace nan value:  75%|███████▍  | 412/553 [00:02<00:00, 170.72it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 169.74it/s]replace nan value:  81%|████████  | 448/553 [00:02<00:00, 172.29it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 172.30it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 169.23it/s]replace nan value:  91%|█████████ | 502/553 [00:02<00:00, 169.59it/s]replace nan value:  94%|█████████▍| 520/553 [00:03<00:00, 170.59it/s]replace nan value:  97%|█████████▋| 538/553 [00:03<00:00, 170.00it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 170.30it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 131.83it/s]  5%|▌         | 29/553 [00:00<00:03, 136.62it/s]  8%|▊         | 43/553 [00:00<00:03, 128.78it/s] 10%|█         | 56/553 [00:00<00:04, 122.72it/s] 12%|█▏        | 69/553 [00:00<00:04, 112.65it/s] 15%|█▌        | 84/553 [00:00<00:03, 122.62it/s] 18%|█▊        | 97/553 [00:00<00:03, 124.09it/s] 20%|██        | 112/553 [00:00<00:03, 130.40it/s] 23%|██▎       | 126/553 [00:01<00:03, 126.20it/s] 26%|██▌       | 143/553 [00:01<00:03, 136.53it/s] 29%|██▉       | 161/553 [00:01<00:02, 145.38it/s] 32%|███▏      | 176/553 [00:01<00:02, 145.21it/s] 35%|███▍      | 192/553 [00:01<00:02, 145.98it/s] 38%|███▊      | 210/553 [00:01<00:02, 151.55it/s] 41%|████      | 226/553 [00:01<00:02, 142.51it/s] 44%|████▎     | 241/553 [00:01<00:02, 141.27it/s] 46%|████▋     | 256/553 [00:01<00:02, 134.99it/s] 49%|████▉     | 270/553 [00:02<00:02, 135.01it/s] 51%|█████▏    | 284/553 [00:02<00:02, 133.28it/s] 54%|█████▍    | 298/553 [00:02<00:01, 129.43it/s] 56%|█████▌    | 311/553 [00:02<00:01, 125.76it/s] 59%|█████▊    | 324/553 [00:02<00:01, 126.76it/s] 61%|██████    | 338/553 [00:02<00:01, 128.30it/s] 63%|██████▎   | 351/553 [00:02<00:01, 128.29it/s] 66%|██████▌   | 364/553 [00:02<00:01, 124.66it/s] 68%|██████▊   | 378/553 [00:02<00:01, 127.43it/s] 71%|███████   | 391/553 [00:02<00:01, 118.18it/s] 73%|███████▎  | 404/553 [00:03<00:01, 118.87it/s] 75%|███████▌  | 416/553 [00:03<00:01, 117.74it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.82it/s] 80%|████████  | 445/553 [00:03<00:00, 127.68it/s] 83%|████████▎ | 460/553 [00:03<00:00, 132.77it/s] 86%|████████▌ | 475/553 [00:03<00:00, 135.08it/s] 88%|████████▊ | 489/553 [00:03<00:00, 127.63it/s] 91%|█████████ | 502/553 [00:03<00:00, 122.93it/s] 93%|█████████▎| 516/553 [00:03<00:00, 126.59it/s] 96%|█████████▌| 529/553 [00:04<00:00, 113.27it/s] 98%|█████████▊| 541/553 [00:04<00:00, 114.55it/s]100%|██████████| 553/553 [00:04<00:00, 100.16it/s]100%|██████████| 553/553 [00:04<00:00, 126.14it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 266.18it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 419.17it/s]extract the null data:  95%|█████████▍| 132/139 [00:00<00:00, 462.63it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 439.61it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 187.14it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 186.56it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 181.15it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 182.33it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 183.03it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 185.28it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 186.35it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 185.27it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.24it/s] 18%|█▊        | 25/139 [00:00<00:00, 123.08it/s] 28%|██▊       | 39/139 [00:00<00:00, 129.40it/s] 37%|███▋      | 52/139 [00:00<00:00, 120.23it/s] 47%|████▋     | 66/139 [00:00<00:00, 125.15it/s] 57%|█████▋    | 79/139 [00:00<00:00, 124.37it/s] 66%|██████▌   | 92/139 [00:00<00:00, 119.18it/s] 76%|███████▋  | 106/139 [00:00<00:00, 122.93it/s] 88%|████████▊ | 122/139 [00:00<00:00, 132.84it/s] 98%|█████████▊| 136/139 [00:01<00:00, 132.95it/s]100%|██████████| 139/139 [00:01<00:00, 128.14it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  10%|█         | 18/173 [00:00<00:00, 179.17it/s]extract the null data:  41%|████      | 71/173 [00:00<00:00, 381.65it/s]extract the null data:  72%|███████▏  | 125/173 [00:00<00:00, 452.91it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 437.48it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 184.88it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 187.72it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 190.57it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 189.39it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 188.99it/s]replace nan value:  68%|██████▊   | 117/173 [00:00<00:00, 190.02it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 188.41it/s]replace nan value:  90%|█████████ | 156/173 [00:00<00:00, 187.63it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 187.37it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.53it/s] 16%|█▌        | 27/173 [00:00<00:01, 111.07it/s] 23%|██▎       | 40/173 [00:00<00:01, 118.50it/s] 32%|███▏      | 55/173 [00:00<00:00, 129.10it/s] 40%|████      | 70/173 [00:00<00:00, 135.07it/s] 49%|████▉     | 85/173 [00:00<00:00, 138.64it/s] 58%|█████▊    | 100/173 [00:00<00:00, 141.31it/s] 67%|██████▋   | 116/173 [00:00<00:00, 145.47it/s] 76%|███████▌  | 131/173 [00:00<00:00, 138.72it/s] 84%|████████▍ | 145/173 [00:01<00:00, 138.70it/s] 92%|█████████▏| 159/173 [00:01<00:00, 128.34it/s]100%|██████████| 173/173 [00:01<00:00, 99.07it/s] 100%|██████████| 173/173 [00:01<00:00, 121.91it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.016, train acc : 0.511, valid acc : 0.096, train f1 : 0.403, valid f1 : 0.091
training process:   1%|          | 1/128 [00:58<2:04:47, 58.96s/it]Best score increase :0.000 -> 0.091
training process:   2%|▏         | 2/128 [01:46<1:50:01, 52.39s/it]Best score increase :0.091 -> 0.098
training process:   2%|▏         | 3/128 [02:35<1:45:52, 50.82s/it]Best score increase :0.098 -> 0.099
training process:   3%|▎         | 4/128 [03:25<1:44:24, 50.52s/it]Best score increase :0.099 -> 0.139
epoch : 5, train loss : 0.004, valid loss : 0.015, train acc : 0.598, valid acc : 0.215, train f1 : 0.525, valid f1 : 0.213
training process:   4%|▍         | 5/128 [04:27<1:51:34, 54.42s/it]Best score increase :0.139 -> 0.213
training process:   5%|▍         | 6/128 [05:19<1:49:24, 53.81s/it]Best score increase :0.213 -> 0.300
training process:   5%|▌         | 7/128 [06:12<1:47:55, 53.52s/it]Best score increase :0.300 -> 0.334
training process:   6%|▋         | 8/128 [07:03<1:45:33, 52.78s/it]Best score increase :0.334 -> 0.427
epoch : 9, train loss : 0.003, valid loss : 0.011, train acc : 0.697, valid acc : 0.536, train f1 : 0.670, valid f1 : 0.460
training process:   7%|▋         | 9/128 [08:05<1:50:09, 55.54s/it]Best score increase :0.427 -> 0.460
training process:   8%|▊         | 10/128 [08:56<1:46:43, 54.26s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:48<1:44:04, 53.37s/it]Best score increase :0.460 -> 0.472
training process:   9%|▉         | 12/128 [10:36<1:40:02, 51.75s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.009, train acc : 0.757, valid acc : 0.678, train f1 : 0.743, valid f1 : 0.559
training process:  10%|█         | 13/128 [11:33<1:42:40, 53.57s/it]Best score increase :0.472 -> 0.559
training process:  11%|█         | 14/128 [12:22<1:38:39, 51.92s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:10<1:35:44, 50.83s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [13:58<1:33:33, 50.12s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.003, valid loss : 0.011, train acc : 0.783, valid acc : 0.574, train f1 : 0.774, valid f1 : 0.487
training process:  13%|█▎        | 17/128 [14:57<1:37:33, 52.74s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [15:49<1:35:55, 52.32s/it]Best score increase :0.559 -> 0.612
training process:  15%|█▍        | 19/128 [16:38<1:33:32, 51.49s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [17:29<1:32:33, 51.42s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.009, train acc : 0.813, valid acc : 0.715, train f1 : 0.806, valid f1 : 0.587
training process:  16%|█▋        | 21/128 [18:30<1:36:47, 54.27s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [19:24<1:35:33, 54.09s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [20:18<1:34:35, 54.05s/it]Best score increase :0.612 -> 0.642
training process:  19%|█▉        | 24/128 [21:07<1:30:50, 52.41s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.008, train acc : 0.820, valid acc : 0.766, train f1 : 0.814, valid f1 : 0.627
training process:  20%|█▉        | 25/128 [22:07<1:34:18, 54.94s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [22:59<1:31:47, 54.00s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [23:51<1:29:58, 53.45s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [24:44<1:28:38, 53.19s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.010, train acc : 0.833, valid acc : 0.700, train f1 : 0.829, valid f1 : 0.576
training process:  23%|██▎       | 29/128 [25:44<1:31:18, 55.34s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [26:37<1:29:12, 54.61s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [27:30<1:27:19, 54.02s/it]EarlyStopping counter : 8 out of 12
training process:  25%|██▌       | 32/128 [28:22<1:25:31, 53.45s/it]EarlyStopping counter : 9 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.008, train acc : 0.846, valid acc : 0.785, train f1 : 0.843, valid f1 : 0.645
training process:  26%|██▌       | 33/128 [29:24<1:28:54, 56.15s/it]Best score increase :0.642 -> 0.645
training process:  27%|██▋       | 34/128 [30:18<1:26:34, 55.26s/it]Best score increase :0.645 -> 0.672
training process:  27%|██▋       | 35/128 [31:07<1:23:00, 53.55s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [31:58<1:20:47, 52.69s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.009, train acc : 0.849, valid acc : 0.731, train f1 : 0.846, valid f1 : 0.601
training process:  29%|██▉       | 37/128 [32:58<1:23:25, 55.00s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [33:46<1:19:21, 52.90s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [34:36<1:17:02, 51.94s/it]Best score increase :0.672 -> 0.682
training process:  31%|███▏      | 40/128 [35:25<1:14:42, 50.94s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.008, train acc : 0.861, valid acc : 0.782, train f1 : 0.858, valid f1 : 0.643
training process:  32%|███▏      | 41/128 [36:21<1:16:27, 52.74s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [37:09<1:13:28, 51.26s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [38:00<1:12:23, 51.10s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [38:49<1:10:34, 50.41s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.008, train acc : 0.863, valid acc : 0.788, train f1 : 0.860, valid f1 : 0.649
training process:  35%|███▌      | 45/128 [39:45<1:12:11, 52.19s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 46/128 [40:38<1:11:29, 52.31s/it]EarlyStopping counter : 7 out of 12
training process:  37%|███▋      | 47/128 [41:28<1:09:59, 51.85s/it]EarlyStopping counter : 8 out of 12
training process:  38%|███▊      | 48/128 [42:17<1:07:56, 50.96s/it]EarlyStopping counter : 9 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.007, train acc : 0.868, valid acc : 0.905, train f1 : 0.866, valid f1 : 0.774
training process:  38%|███▊      | 49/128 [43:14<1:09:22, 52.69s/it]Best score increase :0.682 -> 0.774
training process:  39%|███▉      | 50/128 [44:04<1:07:15, 51.74s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [44:52<1:05:12, 50.81s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [45:40<1:03:04, 49.80s/it]EarlyStopping counter : 3 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.009, train acc : 0.871, valid acc : 0.762, train f1 : 0.870, valid f1 : 0.627
training process:  41%|████▏     | 53/128 [46:38<1:05:23, 52.31s/it]EarlyStopping counter : 4 out of 12
training process:  42%|████▏     | 54/128 [47:26<1:02:49, 50.94s/it]EarlyStopping counter : 5 out of 12
training process:  43%|████▎     | 55/128 [48:14<1:01:05, 50.21s/it]EarlyStopping counter : 6 out of 12
training process:  44%|████▍     | 56/128 [49:04<1:00:01, 50.03s/it]EarlyStopping counter : 7 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.008, train acc : 0.880, valid acc : 0.809, train f1 : 0.878, valid f1 : 0.669
training process:  45%|████▍     | 57/128 [50:02<1:02:01, 52.41s/it]EarlyStopping counter : 8 out of 12
training process:  45%|████▌     | 58/128 [50:50<59:50, 51.29s/it]  EarlyStopping counter : 9 out of 12
training process:  46%|████▌     | 59/128 [51:38<57:38, 50.13s/it]EarlyStopping counter : 10 out of 12
training process:  47%|████▋     | 60/128 [52:27<56:24, 49.77s/it]EarlyStopping counter : 11 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.008, train acc : 0.885, valid acc : 0.795, train f1 : 0.884, valid f1 : 0.655
training process:  47%|████▋     | 60/128 [53:24<1:00:32, 53.41s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 60, best f1 score : 0.774
training process finished, best loss : 0.007 and best acc : 0.905, best f1 : 0.774, best epoch : 48

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.52      0.86      0.65       580
           1       0.99      0.93      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.75      0.89      0.80      7398
weighted avg       0.95      0.93      0.93      7398


# test acc : 0.93, test f1 : 0.80, test AUC : 0.89, test loss : 0.345

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.61s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.69s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.63s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:02,  7.80s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.75s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.78s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.77s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.79s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.91s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.90s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.92s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.95s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.84s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 11%|█▏        | 35/306 [00:00<00:00, 343.30it/s] 23%|██▎       | 70/306 [00:00<00:00, 251.66it/s] 32%|███▏      | 97/306 [00:00<00:00, 254.87it/s] 42%|████▏     | 129/306 [00:00<00:00, 273.38it/s] 52%|█████▏    | 158/306 [00:00<00:00, 251.99it/s] 65%|██████▌   | 200/306 [00:00<00:00, 301.39it/s] 76%|███████▌  | 232/306 [00:00<00:00, 295.75it/s] 86%|████████▌ | 263/306 [00:00<00:00, 278.32it/s] 95%|█████████▌| 292/306 [00:01<00:00, 261.91it/s]100%|██████████| 306/306 [00:01<00:00, 275.40it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 37/553 [00:00<00:01, 368.71it/s]extract the null data:  13%|█▎        | 74/553 [00:00<00:01, 350.10it/s]extract the null data:  20%|██        | 113/553 [00:00<00:01, 365.71it/s]extract the null data:  29%|██▊       | 158/553 [00:00<00:00, 397.90it/s]extract the null data:  37%|███▋      | 207/553 [00:00<00:00, 427.75it/s]extract the null data:  46%|████▌     | 255/553 [00:00<00:00, 444.74it/s]extract the null data:  55%|█████▍    | 302/553 [00:00<00:00, 451.88it/s]extract the null data:  63%|██████▎   | 348/553 [00:00<00:00, 448.38it/s]extract the null data:  72%|███████▏  | 396/553 [00:00<00:00, 457.53it/s]extract the null data:  80%|████████  | 443/553 [00:01<00:00, 461.21it/s]extract the null data:  89%|████████▊ | 490/553 [00:01<00:00, 451.28it/s]extract the null data:  97%|█████████▋| 536/553 [00:01<00:00, 447.91it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 434.59it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.36it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.06it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 166.17it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 167.57it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 169.89it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 172.21it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:02, 172.37it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 172.22it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:02, 172.46it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:02, 171.79it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:02, 169.25it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:02, 170.33it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:01, 169.92it/s]replace nan value:  45%|████▍     | 248/553 [00:01<00:01, 170.11it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 168.86it/s]replace nan value:  51%|█████▏    | 284/553 [00:01<00:01, 169.51it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 169.87it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:01, 169.90it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 168.36it/s]replace nan value:  64%|██████▍   | 353/553 [00:02<00:01, 167.84it/s]replace nan value:  67%|██████▋   | 371/553 [00:02<00:01, 169.52it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 169.85it/s]replace nan value:  74%|███████▎  | 407/553 [00:02<00:00, 170.27it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 169.56it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 170.70it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 170.83it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 169.93it/s]replace nan value:  90%|████████▉ | 497/553 [00:02<00:00, 171.21it/s]replace nan value:  93%|█████████▎| 515/553 [00:03<00:00, 171.12it/s]replace nan value:  96%|█████████▋| 533/553 [00:03<00:00, 167.64it/s]replace nan value:  99%|█████████▉| 550/553 [00:03<00:00, 168.08it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 169.46it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 126.35it/s]  5%|▍         | 27/553 [00:00<00:03, 133.81it/s]  7%|▋         | 41/553 [00:00<00:03, 131.78it/s] 10%|▉         | 55/553 [00:00<00:04, 121.87it/s] 12%|█▏        | 68/553 [00:00<00:04, 110.80it/s] 15%|█▌        | 83/553 [00:00<00:03, 121.26it/s] 17%|█▋        | 96/553 [00:00<00:03, 123.61it/s] 20%|█▉        | 109/553 [00:00<00:03, 125.23it/s] 22%|██▏       | 123/553 [00:00<00:03, 128.98it/s] 25%|██▍       | 138/553 [00:01<00:03, 134.31it/s] 28%|██▊       | 154/553 [00:01<00:02, 141.76it/s] 31%|███       | 171/553 [00:01<00:02, 147.64it/s] 34%|███▎      | 186/553 [00:01<00:02, 144.21it/s] 37%|███▋      | 202/553 [00:01<00:02, 146.57it/s] 39%|███▉      | 217/553 [00:01<00:02, 141.24it/s] 42%|████▏     | 232/553 [00:01<00:02, 132.32it/s] 44%|████▍     | 246/553 [00:01<00:02, 131.28it/s] 47%|████▋     | 260/553 [00:01<00:02, 131.75it/s] 50%|████▉     | 274/553 [00:02<00:02, 125.19it/s] 52%|█████▏    | 287/553 [00:02<00:02, 126.16it/s] 54%|█████▍    | 300/553 [00:02<00:02, 118.33it/s] 56%|█████▋    | 312/553 [00:02<00:02, 112.49it/s] 59%|█████▉    | 325/553 [00:02<00:01, 116.82it/s] 61%|██████    | 337/553 [00:02<00:01, 117.00it/s] 63%|██████▎   | 349/553 [00:02<00:01, 115.16it/s] 65%|██████▌   | 361/553 [00:02<00:01, 111.77it/s] 68%|██████▊   | 376/553 [00:02<00:01, 117.68it/s] 70%|███████   | 388/553 [00:03<00:01, 112.19it/s] 72%|███████▏  | 400/553 [00:03<00:01, 104.82it/s] 75%|███████▍  | 414/553 [00:03<00:01, 113.65it/s] 77%|███████▋  | 426/553 [00:03<00:01, 104.13it/s] 79%|███████▉  | 439/553 [00:03<00:01, 110.35it/s] 82%|████████▏ | 454/553 [00:03<00:00, 121.02it/s] 85%|████████▍ | 468/553 [00:03<00:00, 125.35it/s] 87%|████████▋ | 481/553 [00:03<00:00, 119.41it/s] 89%|████████▉ | 494/553 [00:04<00:00, 114.12it/s] 92%|█████████▏| 507/553 [00:04<00:00, 117.11it/s] 94%|█████████▍| 520/553 [00:04<00:00, 118.67it/s] 96%|█████████▌| 532/553 [00:04<00:00, 100.27it/s] 99%|█████████▉| 547/553 [00:04<00:00, 111.30it/s]100%|██████████| 553/553 [00:04<00:00, 119.30it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 266.46it/s]extract the null data:  53%|█████▎    | 73/139 [00:00<00:00, 378.90it/s]extract the null data:  86%|████████▌ | 119/139 [00:00<00:00, 414.21it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 400.97it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 172.83it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 171.96it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 171.74it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 172.24it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 170.84it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 166.42it/s]replace nan value:  90%|████████▉ | 125/139 [00:00<00:00, 167.15it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 169.36it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:01, 125.00it/s] 21%|██        | 29/139 [00:00<00:00, 132.19it/s] 32%|███▏      | 45/139 [00:00<00:00, 142.51it/s] 43%|████▎     | 60/139 [00:00<00:00, 121.62it/s] 53%|█████▎    | 73/139 [00:00<00:00, 122.60it/s] 62%|██████▏   | 86/139 [00:00<00:00, 112.67it/s] 71%|███████   | 98/139 [00:00<00:00, 106.23it/s] 78%|███████▊  | 109/139 [00:00<00:00, 106.23it/s] 91%|█████████ | 126/139 [00:01<00:00, 120.69it/s]100%|██████████| 139/139 [00:01<00:00, 120.89it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   9%|▉         | 16/173 [00:00<00:00, 159.65it/s]extract the null data:  36%|███▋      | 63/173 [00:00<00:00, 340.71it/s]extract the null data:  64%|██████▎   | 110/173 [00:00<00:00, 397.11it/s]extract the null data:  91%|█████████ | 157/173 [00:00<00:00, 423.34it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 373.67it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 172.33it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 171.10it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 169.48it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 176.85it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 176.47it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 172.39it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 172.91it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 171.72it/s]replace nan value:  94%|█████████▍| 163/173 [00:00<00:00, 166.56it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 169.92it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 125.49it/s] 15%|█▌        | 26/173 [00:00<00:01, 102.06it/s] 23%|██▎       | 39/173 [00:00<00:01, 111.58it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.06it/s] 40%|███▉      | 69/173 [00:00<00:00, 129.11it/s] 49%|████▊     | 84/173 [00:00<00:00, 131.86it/s] 57%|█████▋    | 98/173 [00:00<00:00, 131.88it/s] 65%|██████▌   | 113/173 [00:00<00:00, 136.03it/s] 73%|███████▎  | 127/173 [00:00<00:00, 131.31it/s] 82%|████████▏ | 141/173 [00:01<00:00, 132.23it/s] 90%|████████▉ | 155/173 [00:01<00:00, 119.99it/s] 97%|█████████▋| 168/173 [00:01<00:00, 98.09it/s] 100%|██████████| 173/173 [00:01<00:00, 114.13it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.008, train f1 : 0.556, valid f1 : 0.549
training process - Deferred Re-weighting:   1%|          | 1/128 [01:03<2:14:49, 63.70s/it]Best score increase :0.000 -> 0.549
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:55<1:59:25, 56.87s/it]Best score increase :0.549 -> 0.590
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:46<1:53:00, 54.25s/it]Best score increase :0.590 -> 0.673
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:37<1:48:47, 52.64s/it]Best score increase :0.673 -> 0.747
epoch : 5, train loss : 0.005, valid loss : 0.004, train f1 : 0.757, valid f1 : 0.775
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:34<1:51:32, 54.41s/it]Best score increase :0.747 -> 0.775
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:23<1:47:03, 52.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:13<1:44:27, 51.80s/it]Best score increase :0.775 -> 0.786
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:04<1:42:52, 51.43s/it]Best score increase :0.786 -> 0.797
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.803, valid f1 : 0.799
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:03<1:46:48, 53.86s/it]Best score increase :0.797 -> 0.799
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:53<1:43:26, 52.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:41<1:40:03, 51.31s/it]Best score increase :0.799 -> 0.803
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:35<1:40:32, 52.00s/it]Best score increase :0.803 -> 0.810
epoch : 13, train loss : 0.003, valid loss : 0.003, train f1 : 0.813, valid f1 : 0.812
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:33<1:42:55, 53.70s/it]Best score increase :0.810 -> 0.812
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:20<1:38:37, 51.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:12<1:37:19, 51.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:02<1:35:47, 51.31s/it]Best score increase :0.812 -> 0.828
epoch : 17, train loss : 0.003, valid loss : 0.003, train f1 : 0.821, valid f1 : 0.817
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:02<1:39:43, 53.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:51<1:36:05, 52.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:41<1:34:08, 51.82s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:32<1:32:40, 51.49s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.003, valid loss : 0.003, train f1 : 0.829, valid f1 : 0.811
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:29<1:34:57, 53.25s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:16<1:30:48, 51.40s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:05<1:28:36, 50.64s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:55<1:27:25, 50.44s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.842, valid f1 : 0.825
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:55<1:31:19, 53.20s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:45<1:29:00, 52.35s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [23:37<1:27:44, 52.12s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [24:28<1:26:13, 51.74s/it]Best score increase :0.828 -> 0.830
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.847, valid f1 : 0.831
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:26<1:28:27, 53.61s/it]Best score increase :0.830 -> 0.831
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:16<1:25:44, 52.50s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:07<1:24:30, 52.27s/it]Best score increase :0.831 -> 0.841
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:57<1:22:30, 51.57s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.002, train f1 : 0.850, valid f1 : 0.846
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [28:57<1:25:36, 54.07s/it]Best score increase :0.841 -> 0.846
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:49<1:23:42, 53.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:40<1:21:45, 52.75s/it]Best score increase :0.846 -> 0.855
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:32<1:20:35, 52.56s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.002, train f1 : 0.854, valid f1 : 0.843
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:33<1:23:28, 55.03s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:22<1:19:37, 53.09s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:13<1:17:53, 52.51s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:06<1:17:06, 52.57s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.002, train f1 : 0.859, valid f1 : 0.859
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:06<1:19:37, 54.91s/it]Best score increase :0.855 -> 0.859
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [36:57<1:16:47, 53.58s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [37:49<1:15:15, 53.13s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [38:41<1:13:52, 52.77s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.002, train f1 : 0.864, valid f1 : 0.854
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [39:41<1:16:13, 55.11s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [40:32<1:13:34, 53.83s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:23<1:11:26, 52.92s/it]Best score increase :0.859 -> 0.867
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [42:14<1:09:51, 52.39s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.002, train f1 : 0.864, valid f1 : 0.865
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [43:14<1:12:00, 54.69s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [44:07<1:10:19, 54.09s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [44:57<1:07:57, 52.95s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [45:48<1:06:17, 52.34s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.002, train f1 : 0.870, valid f1 : 0.844
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [46:47<1:08:06, 54.48s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [47:39<1:06:17, 53.74s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [48:29<1:03:53, 52.51s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [49:21<1:02:59, 52.50s/it]EarlyStopping counter : 9 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.002, train f1 : 0.867, valid f1 : 0.847
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [50:23<1:05:27, 55.32s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [51:15<1:03:24, 54.34s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [52:06<1:02:53, 53.91s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 58, best f1 score : 0.868
training process finished, best loss : 0.002, best acc : 0.965, best f1 : 0.868, best epoch : 54

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.87      0.72      0.79       580
           1       0.98      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.92      0.85      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.85, test loss : 0.140

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:31,  8.36s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:19,  7.94s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.85s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.94s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.99s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.94s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.81s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.95s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.87s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.95s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.88s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.95s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.93s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 13%|█▎        | 41/306 [00:00<00:00, 405.10it/s] 28%|██▊       | 87/306 [00:00<00:00, 421.58it/s] 48%|████▊     | 146/306 [00:00<00:00, 489.89it/s] 64%|██████▍   | 196/306 [00:00<00:00, 482.02it/s] 80%|████████  | 245/306 [00:00<00:00, 468.67it/s] 95%|█████████▌| 292/306 [00:00<00:00, 461.02it/s]100%|██████████| 306/306 [00:00<00:00, 466.66it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : CnnLSTM-exp_clip_21_dist_3_LDAM_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 62/553 [00:00<00:00, 615.76it/s]extract the null data:  23%|██▎       | 128/553 [00:00<00:00, 635.84it/s]extract the null data:  35%|███▍      | 192/553 [00:00<00:00, 633.47it/s]extract the null data:  46%|████▋     | 256/553 [00:00<00:00, 635.73it/s]extract the null data:  58%|█████▊    | 321/553 [00:00<00:00, 638.47it/s]extract the null data:  70%|██████▉   | 386/553 [00:00<00:00, 641.91it/s]extract the null data:  82%|████████▏ | 451/553 [00:00<00:00, 639.05it/s]extract the null data:  93%|█████████▎| 516/553 [00:00<00:00, 640.32it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 636.45it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 216.98it/s]replace nan value:   8%|▊         | 45/553 [00:00<00:02, 220.32it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 223.78it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 222.16it/s]replace nan value:  21%|██        | 114/553 [00:00<00:01, 222.86it/s]replace nan value:  25%|██▍       | 137/553 [00:00<00:01, 222.77it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:01, 225.60it/s]replace nan value:  33%|███▎      | 184/553 [00:00<00:01, 224.55it/s]replace nan value:  37%|███▋      | 207/553 [00:00<00:01, 222.46it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:01, 222.30it/s]replace nan value:  46%|████▌     | 253/553 [00:01<00:01, 222.28it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 220.44it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 219.74it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 221.34it/s]replace nan value:  62%|██████▏   | 345/553 [00:01<00:00, 222.93it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 224.13it/s]replace nan value:  71%|███████   | 391/553 [00:01<00:00, 222.80it/s]replace nan value:  75%|███████▍  | 414/553 [00:01<00:00, 223.43it/s]replace nan value:  79%|███████▉  | 437/553 [00:01<00:00, 222.91it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 223.58it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 222.94it/s]replace nan value:  92%|█████████▏| 506/553 [00:02<00:00, 220.84it/s]replace nan value:  96%|█████████▌| 529/553 [00:02<00:00, 221.47it/s]replace nan value: 100%|█████████▉| 552/553 [00:02<00:00, 221.05it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 222.22it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 145.07it/s]  6%|▌         | 32/553 [00:00<00:03, 158.70it/s]  9%|▊         | 48/553 [00:00<00:03, 131.72it/s] 11%|█         | 62/553 [00:00<00:03, 130.37it/s] 14%|█▍        | 77/553 [00:00<00:03, 135.04it/s] 17%|█▋        | 93/553 [00:00<00:03, 137.71it/s] 20%|█▉        | 109/553 [00:00<00:03, 142.64it/s] 23%|██▎       | 125/553 [00:00<00:02, 144.89it/s] 26%|██▌       | 144/553 [00:00<00:02, 156.49it/s] 29%|██▉       | 163/553 [00:01<00:02, 164.95it/s] 33%|███▎      | 181/553 [00:01<00:02, 167.19it/s] 36%|███▌      | 199/553 [00:01<00:02, 170.59it/s] 39%|███▉      | 217/553 [00:01<00:01, 169.73it/s] 42%|████▏     | 235/553 [00:01<00:01, 163.99it/s] 46%|████▌     | 252/553 [00:01<00:01, 161.09it/s] 49%|████▊     | 269/553 [00:01<00:01, 157.00it/s] 52%|█████▏    | 285/553 [00:01<00:01, 153.62it/s] 54%|█████▍    | 301/553 [00:01<00:01, 148.99it/s] 57%|█████▋    | 316/553 [00:02<00:01, 141.63it/s] 60%|█████▉    | 331/553 [00:02<00:01, 140.44it/s] 63%|██████▎   | 346/553 [00:02<00:01, 142.67it/s] 65%|██████▌   | 361/553 [00:02<00:01, 136.27it/s] 68%|██████▊   | 378/553 [00:02<00:01, 143.11it/s] 71%|███████   | 393/553 [00:02<00:01, 134.49it/s] 74%|███████▍  | 408/553 [00:02<00:01, 137.47it/s] 76%|███████▋  | 422/553 [00:02<00:00, 134.36it/s] 79%|███████▉  | 436/553 [00:02<00:00, 131.02it/s] 82%|████████▏ | 454/553 [00:03<00:00, 144.05it/s] 85%|████████▌ | 471/553 [00:03<00:00, 149.31it/s] 88%|████████▊ | 487/553 [00:03<00:00, 146.57it/s] 91%|█████████ | 502/553 [00:03<00:00, 138.20it/s] 94%|█████████▍| 519/553 [00:03<00:00, 144.26it/s] 97%|█████████▋| 534/553 [00:03<00:00, 124.70it/s]100%|█████████▉| 551/553 [00:03<00:00, 114.82it/s]100%|██████████| 553/553 [00:03<00:00, 142.26it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 416.64it/s]extract the null data:  81%|████████▏ | 113/139 [00:00<00:00, 585.60it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 584.97it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 241.27it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 241.58it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 242.65it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 241.45it/s]replace nan value:  90%|████████▉ | 125/139 [00:00<00:00, 239.27it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 240.44it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 11%|█         | 15/139 [00:00<00:00, 143.46it/s] 23%|██▎       | 32/139 [00:00<00:00, 153.90it/s] 35%|███▌      | 49/139 [00:00<00:00, 159.86it/s] 47%|████▋     | 65/139 [00:00<00:00, 159.11it/s] 58%|█████▊    | 81/139 [00:00<00:00, 153.72it/s] 70%|██████▉   | 97/139 [00:00<00:00, 144.50it/s] 81%|████████  | 112/139 [00:00<00:00, 143.93it/s] 93%|█████████▎| 129/139 [00:00<00:00, 151.04it/s]100%|██████████| 139/139 [00:00<00:00, 152.32it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 377.70it/s]extract the null data:  63%|██████▎   | 109/173 [00:00<00:00, 568.28it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 587.44it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 234.25it/s]replace nan value:  28%|██▊       | 49/173 [00:00<00:00, 239.61it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 238.97it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 242.20it/s]replace nan value:  71%|███████   | 123/173 [00:00<00:00, 237.22it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 233.77it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 232.69it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 235.35it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 142.85it/s] 17%|█▋        | 30/173 [00:00<00:01, 131.30it/s] 27%|██▋       | 46/173 [00:00<00:00, 142.72it/s] 36%|███▌      | 62/173 [00:00<00:00, 149.07it/s] 45%|████▌     | 78/173 [00:00<00:00, 148.76it/s] 54%|█████▍    | 93/173 [00:00<00:00, 147.03it/s] 62%|██████▏   | 108/173 [00:00<00:00, 145.27it/s] 71%|███████   | 123/173 [00:00<00:00, 141.48it/s] 80%|███████▉  | 138/173 [00:00<00:00, 140.96it/s] 88%|████████▊ | 153/173 [00:01<00:00, 134.11it/s] 97%|█████████▋| 167/173 [00:01<00:00, 105.81it/s]100%|██████████| 173/173 [00:01<00:00, 125.88it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-------------------------------------------------------------------------------------------
      Layer (type)                             Input Shape         Param #     Tr. Param #
===========================================================================================
      NoiseLayer-1                             [1, 21, 12]               0               0
          Conv1d-2                             [1, 12, 21]           1,184           1,184
          Conv1d-3                             [1, 32, 21]           3,104           3,104
     BatchNorm1d-4                             [1, 32, 21]              64              64
            ReLU-5                             [1, 32, 21]               0               0
            LSTM-6     [32, 1, 21], [4, 1, 64], [4, 1, 64]         143,872         143,872
          Linear-7                            [1, 32, 128]           8,256           8,256
          Linear-8                             [1, 32, 64]           4,160           4,160
          Linear-9                                [1, 128]           8,256           8,256
    BatchNorm1d-10                                 [1, 64]             128             128
           ReLU-11                                 [1, 64]               0               0
         Linear-12                                 [1, 64]             130             130
===========================================================================================
Total params: 169,154
Trainable params: 169,154
Non-trainable params: 0
-------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.010, train f1 : 0.684, valid f1 : 0.613
training process - Deferred Re-weighting:   1%|          | 1/128 [00:54<1:55:36, 54.61s/it]Best score increase :0.000 -> 0.613
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:42<1:46:31, 50.73s/it]Best score increase :0.613 -> 0.673
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:28<1:41:23, 48.67s/it]Best score increase :0.673 -> 0.735
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:18<1:41:09, 48.94s/it]Best score increase :0.735 -> 0.737
epoch : 5, train loss : 0.007, valid loss : 0.006, train f1 : 0.840, valid f1 : 0.752
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:11<1:43:38, 50.56s/it]Best score increase :0.737 -> 0.752
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:02<1:43:14, 50.77s/it]Best score increase :0.752 -> 0.767
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:52<1:41:37, 50.39s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:46<1:42:52, 51.43s/it]Best score increase :0.767 -> 0.798
epoch : 9, train loss : 0.006, valid loss : 0.005, train f1 : 0.862, valid f1 : 0.790
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:45<1:46:56, 53.92s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:35<1:43:48, 52.78s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:28<1:43:10, 52.91s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:18<1:40:34, 52.02s/it]EarlyStopping counter : 4 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.004, train f1 : 0.879, valid f1 : 0.820
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:18<1:43:57, 54.24s/it]Best score increase :0.798 -> 0.820
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:09<1:41:18, 53.32s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:58<1:37:58, 52.03s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:51<1:37:38, 52.31s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.006, train f1 : 0.888, valid f1 : 0.742
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:53<1:42:23, 55.35s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:45<1:39:20, 54.18s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:36<1:36:48, 53.29s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:27<1:34:28, 52.48s/it]EarlyStopping counter : 7 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.005, train f1 : 0.897, valid f1 : 0.773
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:28<1:38:18, 55.13s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:18<1:34:40, 53.59s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:08<1:32:08, 52.66s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:59<1:30:24, 52.15s/it]EarlyStopping counter : 11 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.005, train f1 : 0.899, valid f1 : 0.770
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:58<1:35:14, 54.95s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 24, best f1 score : 0.820
training process finished, best loss : 0.004, best acc : 0.940, best f1 : 0.820, best epoch : 12

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.77      0.65       580
           1       0.98      0.95      0.96      6818

    accuracy                           0.94      7398
   macro avg       0.77      0.86      0.81      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.81, test AUC : 0.86, test loss : 0.226

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:33,  8.49s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.21s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:13,  8.12s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.86s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:55,  7.95s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.10s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:39,  7.94s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:31,  7.98s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:24,  8.05s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:20<00:16,  8.05s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:28<00:08,  8.01s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.16s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.07s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s] 12%|█▏        | 36/306 [00:00<00:00, 357.54it/s] 24%|██▍       | 73/306 [00:00<00:00, 363.88it/s] 36%|███▋      | 111/306 [00:00<00:00, 366.99it/s] 49%|████▊     | 149/306 [00:00<00:00, 371.71it/s] 61%|██████▏   | 188/306 [00:00<00:00, 376.63it/s] 74%|███████▍  | 226/306 [00:00<00:00, 372.56it/s] 87%|████████▋ | 265/306 [00:00<00:00, 375.23it/s] 99%|█████████▉| 303/306 [00:00<00:00, 375.07it/s]100%|██████████| 306/306 [00:00<00:00, 372.87it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
