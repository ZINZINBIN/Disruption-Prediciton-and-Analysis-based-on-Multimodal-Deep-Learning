############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   6%|▌         | 34/553 [00:00<00:01, 337.55it/s]extract the null data:  15%|█▌        | 85/553 [00:00<00:01, 434.67it/s]extract the null data:  26%|██▋       | 146/553 [00:00<00:00, 511.55it/s]extract the null data:  37%|███▋      | 203/553 [00:00<00:00, 533.16it/s]extract the null data:  46%|████▋     | 257/553 [00:00<00:00, 524.23it/s]extract the null data:  58%|█████▊    | 320/553 [00:00<00:00, 557.02it/s]extract the null data:  69%|██████▉   | 384/553 [00:00<00:00, 581.31it/s]extract the null data:  80%|████████  | 443/553 [00:00<00:00, 548.97it/s]extract the null data:  90%|█████████ | 499/553 [00:01<00:00, 437.44it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 498.56it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 197.82it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 207.51it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 209.86it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 212.01it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 213.96it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 202.16it/s]replace nan value:  27%|██▋       | 151/553 [00:00<00:02, 165.77it/s]replace nan value:  31%|███       | 169/553 [00:00<00:02, 163.17it/s]replace nan value:  34%|███▎      | 186/553 [00:01<00:02, 147.77it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:02, 144.60it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:02, 153.19it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:02, 155.18it/s]replace nan value:  47%|████▋     | 258/553 [00:01<00:01, 162.82it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 178.12it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 188.74it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 189.78it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:01, 198.23it/s]replace nan value:  66%|██████▌   | 366/553 [00:02<00:00, 203.84it/s]replace nan value:  70%|███████   | 388/553 [00:02<00:00, 207.56it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 197.24it/s]replace nan value:  78%|███████▊  | 431/553 [00:02<00:00, 201.93it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 206.74it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 210.09it/s]replace nan value:  90%|████████▉ | 497/553 [00:02<00:00, 209.99it/s]replace nan value:  94%|█████████▍| 519/553 [00:02<00:00, 212.12it/s]replace nan value:  98%|█████████▊| 541/553 [00:02<00:00, 212.50it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 190.14it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 115.67it/s]  5%|▍         | 26/553 [00:00<00:04, 126.97it/s]  7%|▋         | 40/553 [00:00<00:04, 127.35it/s] 10%|▉         | 53/553 [00:00<00:04, 116.62it/s] 12%|█▏        | 65/553 [00:00<00:04, 105.91it/s] 14%|█▍        | 78/553 [00:00<00:04, 111.24it/s] 16%|█▋        | 91/553 [00:00<00:03, 115.69it/s] 19%|█▊        | 103/553 [00:00<00:03, 116.76it/s] 22%|██▏       | 119/553 [00:00<00:03, 128.44it/s] 24%|██▍       | 132/553 [00:01<00:03, 124.41it/s] 27%|██▋       | 149/553 [00:01<00:02, 136.46it/s] 30%|██▉       | 165/553 [00:01<00:02, 141.02it/s] 33%|███▎      | 180/553 [00:01<00:02, 142.56it/s] 35%|███▌      | 195/553 [00:01<00:02, 130.51it/s] 39%|███▊      | 214/553 [00:01<00:02, 144.24it/s] 41%|████▏     | 229/553 [00:01<00:02, 142.82it/s] 44%|████▍     | 244/553 [00:01<00:02, 137.50it/s] 47%|████▋     | 258/553 [00:01<00:02, 133.31it/s] 49%|████▉     | 272/553 [00:02<00:02, 134.51it/s] 52%|█████▏    | 290/553 [00:02<00:01, 145.72it/s] 55%|█████▌    | 305/553 [00:02<00:01, 130.83it/s] 58%|█████▊    | 319/553 [00:02<00:01, 127.03it/s] 61%|██████    | 335/553 [00:02<00:01, 134.06it/s] 63%|██████▎   | 349/553 [00:02<00:01, 132.67it/s] 66%|██████▌   | 363/553 [00:02<00:01, 133.13it/s] 69%|██████▊   | 379/553 [00:02<00:01, 139.69it/s] 71%|███████   | 394/553 [00:03<00:01, 105.08it/s] 73%|███████▎  | 406/553 [00:03<00:01, 98.34it/s]  75%|███████▌  | 417/553 [00:03<00:01, 87.49it/s] 77%|███████▋  | 427/553 [00:03<00:01, 80.80it/s] 79%|███████▉  | 436/553 [00:03<00:01, 81.95it/s] 81%|████████  | 447/553 [00:03<00:01, 88.27it/s] 83%|████████▎ | 457/553 [00:03<00:01, 88.25it/s] 85%|████████▍ | 470/553 [00:04<00:00, 96.36it/s] 87%|████████▋ | 483/553 [00:04<00:00, 104.55it/s] 89%|████████▉ | 494/553 [00:04<00:00, 96.88it/s]  92%|█████████▏| 510/553 [00:04<00:00, 112.23it/s] 94%|█████████▍| 522/553 [00:04<00:00, 113.45it/s] 97%|█████████▋| 534/553 [00:04<00:00, 102.64it/s] 99%|█████████▊| 546/553 [00:04<00:00, 106.18it/s]100%|██████████| 553/553 [00:04<00:00, 114.78it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 415.79it/s]extract the null data:  78%|███████▊  | 109/139 [00:00<00:00, 564.16it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 549.49it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 230.76it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 229.96it/s]replace nan value:  51%|█████     | 71/139 [00:00<00:00, 175.13it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 177.15it/s]replace nan value:  80%|███████▉  | 111/139 [00:00<00:00, 187.22it/s]replace nan value:  94%|█████████▍| 131/139 [00:00<00:00, 186.75it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 187.94it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 128.74it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.92it/s] 29%|██▉       | 40/139 [00:00<00:00, 124.70it/s] 38%|███▊      | 53/139 [00:00<00:00, 98.90it/s]  46%|████▌     | 64/139 [00:00<00:00, 98.08it/s] 54%|█████▍    | 75/139 [00:00<00:00, 87.11it/s] 61%|██████    | 85/139 [00:00<00:00, 82.38it/s] 68%|██████▊   | 94/139 [00:01<00:00, 74.83it/s] 75%|███████▍  | 104/139 [00:01<00:00, 76.50it/s] 83%|████████▎ | 116/139 [00:01<00:00, 86.27it/s] 95%|█████████▍| 132/139 [00:01<00:00, 102.31it/s]100%|██████████| 139/139 [00:01<00:00, 97.74it/s] 
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  10%|█         | 18/173 [00:00<00:00, 177.60it/s]extract the null data:  50%|█████     | 87/173 [00:00<00:00, 476.34it/s]extract the null data:  90%|█████████ | 156/173 [00:00<00:00, 570.60it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 525.44it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 197.16it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 198.01it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 215.15it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 218.25it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 221.50it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 194.20it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 163.96it/s]replace nan value:  99%|█████████▉| 171/173 [00:01<00:00, 136.43it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 169.69it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 136.45it/s] 17%|█▋        | 29/173 [00:00<00:01, 84.26it/s]  23%|██▎       | 39/173 [00:00<00:01, 87.03it/s] 34%|███▎      | 58/173 [00:00<00:00, 119.27it/s] 43%|████▎     | 75/173 [00:00<00:00, 131.90it/s] 52%|█████▏    | 90/173 [00:00<00:00, 130.55it/s] 61%|██████    | 105/173 [00:00<00:00, 136.13it/s] 71%|███████   | 122/173 [00:00<00:00, 142.89it/s] 79%|███████▉  | 137/173 [00:01<00:00, 131.12it/s] 87%|████████▋ | 151/173 [00:01<00:00, 91.51it/s]  95%|█████████▍| 164/173 [00:01<00:00, 96.80it/s]100%|██████████| 173/173 [00:01<00:00, 105.52it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.604, valid loss : 0.436, train acc : 0.712, valid acc : 0.916, train f1 : 0.538, valid f1 : 0.672
training process:   1%|          | 1/128 [01:31<3:13:04, 91.22s/it]Best score increase :0.000 -> 0.672
training process:   2%|▏         | 2/128 [02:57<3:05:27, 88.32s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [04:18<2:56:36, 84.77s/it]Best score increase :0.672 -> 0.705
training process:   3%|▎         | 4/128 [05:57<3:07:22, 90.66s/it]Best score increase :0.705 -> 0.757
epoch : 5, train loss : 0.193, valid loss : 0.164, train acc : 0.949, valid acc : 0.946, train f1 : 0.786, valid f1 : 0.761
training process:   4%|▍         | 5/128 [08:13<3:38:52, 106.77s/it]Best score increase :0.757 -> 0.761
training process:   5%|▍         | 6/128 [10:11<3:45:13, 110.76s/it]Best score increase :0.761 -> 0.785
training process:   5%|▌         | 7/128 [12:19<3:54:25, 116.24s/it]Best score increase :0.785 -> 0.792
training process:   6%|▋         | 8/128 [14:00<3:42:52, 111.44s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.143, valid loss : 0.146, train acc : 0.957, valid acc : 0.952, train f1 : 0.823, valid f1 : 0.802
training process:   7%|▋         | 9/128 [15:51<3:40:43, 111.29s/it]Best score increase :0.792 -> 0.802
training process:   8%|▊         | 10/128 [17:41<3:38:13, 110.96s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [19:24<3:31:43, 108.58s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [21:04<3:24:39, 105.86s/it]Best score increase :0.802 -> 0.809
epoch : 13, train loss : 0.125, valid loss : 0.142, train acc : 0.960, valid acc : 0.954, train f1 : 0.837, valid f1 : 0.812
training process:  10%|█         | 13/128 [22:58<3:27:32, 108.28s/it]Best score increase :0.809 -> 0.812
training process:  11%|█         | 14/128 [25:01<3:34:23, 112.84s/it]Best score increase :0.812 -> 0.821
training process:  12%|█▏        | 15/128 [26:53<3:32:17, 112.72s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [28:23<3:17:15, 105.67s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.116, valid loss : 0.143, train acc : 0.963, valid acc : 0.954, train f1 : 0.851, valid f1 : 0.814
training process:  13%|█▎        | 17/128 [29:56<3:08:46, 102.04s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [30:55<2:43:12, 89.02s/it] EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [31:57<2:27:06, 80.98s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [32:58<2:14:41, 74.82s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.109, valid loss : 0.150, train acc : 0.965, valid acc : 0.956, train f1 : 0.864, valid f1 : 0.825
training process:  16%|█▋        | 21/128 [34:12<2:13:05, 74.63s/it]Best score increase :0.821 -> 0.825
training process:  17%|█▋        | 22/128 [35:17<2:06:46, 71.76s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [36:24<2:03:07, 70.36s/it]Best score increase :0.825 -> 0.838
training process:  19%|█▉        | 24/128 [37:28<1:58:24, 68.31s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.107, valid loss : 0.150, train acc : 0.965, valid acc : 0.958, train f1 : 0.865, valid f1 : 0.834
training process:  20%|█▉        | 25/128 [38:41<2:00:01, 69.92s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [39:45<1:55:25, 67.90s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [40:48<1:52:18, 66.71s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [41:51<1:49:01, 65.42s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.100, valid loss : 0.137, train acc : 0.967, valid acc : 0.960, train f1 : 0.871, valid f1 : 0.841
training process:  23%|██▎       | 29/128 [43:04<1:51:41, 67.69s/it]Best score increase :0.838 -> 0.841
training process:  23%|██▎       | 30/128 [44:09<1:49:22, 66.96s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [45:16<1:48:13, 66.94s/it]EarlyStopping counter : 2 out of 12
training process:  25%|██▌       | 32/128 [46:19<1:45:18, 65.82s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.097, valid loss : 0.166, train acc : 0.968, valid acc : 0.956, train f1 : 0.875, valid f1 : 0.819
training process:  26%|██▌       | 33/128 [47:48<1:55:04, 72.68s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 34/128 [49:02<1:54:21, 72.99s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 35/128 [50:25<1:58:02, 76.16s/it]EarlyStopping counter : 6 out of 12
training process:  28%|██▊       | 36/128 [51:39<1:55:41, 75.45s/it]EarlyStopping counter : 7 out of 12
epoch : 37, train loss : 0.095, valid loss : 0.135, train acc : 0.969, valid acc : 0.960, train f1 : 0.879, valid f1 : 0.846
training process:  29%|██▉       | 37/128 [53:26<2:08:45, 84.89s/it]Best score increase :0.841 -> 0.846
training process:  30%|██▉       | 38/128 [54:59<2:11:04, 87.38s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [56:12<2:03:19, 83.14s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [57:30<1:59:37, 81.56s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.091, valid loss : 0.138, train acc : 0.969, valid acc : 0.962, train f1 : 0.883, valid f1 : 0.852
training process:  32%|███▏      | 41/128 [59:22<2:11:19, 90.57s/it]Best score increase :0.846 -> 0.852
training process:  33%|███▎      | 42/128 [1:01:00<2:12:56, 92.75s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [1:02:27<2:09:19, 91.29s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [1:03:57<2:07:00, 90.72s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.089, valid loss : 0.153, train acc : 0.971, valid acc : 0.959, train f1 : 0.890, valid f1 : 0.839
training process:  35%|███▌      | 45/128 [1:05:41<2:11:07, 94.78s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [1:07:11<2:07:26, 93.25s/it]EarlyStopping counter : 5 out of 12
training process:  37%|███▋      | 47/128 [1:08:35<2:02:20, 90.62s/it]EarlyStopping counter : 6 out of 12
training process:  38%|███▊      | 48/128 [1:10:05<2:00:20, 90.25s/it]EarlyStopping counter : 7 out of 12
epoch : 49, train loss : 0.087, valid loss : 0.153, train acc : 0.971, valid acc : 0.961, train f1 : 0.889, valid f1 : 0.846
training process:  38%|███▊      | 49/128 [1:11:49<2:04:18, 94.41s/it]EarlyStopping counter : 8 out of 12
training process:  39%|███▉      | 50/128 [1:13:26<2:03:37, 95.10s/it]EarlyStopping counter : 9 out of 12
training process:  40%|███▉      | 51/128 [1:14:56<2:00:24, 93.82s/it]EarlyStopping counter : 10 out of 12
training process:  41%|████      | 52/128 [1:16:25<1:56:51, 92.26s/it]EarlyStopping counter : 11 out of 12
epoch : 53, train loss : 0.084, valid loss : 0.138, train acc : 0.971, valid acc : 0.963, train f1 : 0.892, valid f1 : 0.856
training process:  41%|████▏     | 53/128 [1:18:05<1:58:11, 94.56s/it]Best score increase :0.852 -> 0.856
training process:  42%|████▏     | 54/128 [1:19:36<1:55:31, 93.67s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [1:21:05<1:52:03, 92.10s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [1:22:34<1:49:20, 91.12s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.082, valid loss : 0.153, train acc : 0.972, valid acc : 0.961, train f1 : 0.894, valid f1 : 0.846
training process:  45%|████▍     | 57/128 [1:24:17<1:52:01, 94.67s/it]EarlyStopping counter : 4 out of 12
training process:  45%|████▌     | 58/128 [1:25:48<1:49:19, 93.71s/it]EarlyStopping counter : 5 out of 12
training process:  46%|████▌     | 59/128 [1:27:17<1:46:02, 92.21s/it]EarlyStopping counter : 6 out of 12
training process:  47%|████▋     | 60/128 [1:28:46<1:43:23, 91.23s/it]EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.082, valid loss : 0.144, train acc : 0.973, valid acc : 0.962, train f1 : 0.898, valid f1 : 0.853
training process:  48%|████▊     | 61/128 [1:30:30<1:46:14, 95.15s/it]EarlyStopping counter : 8 out of 12
training process:  48%|████▊     | 62/128 [1:32:01<1:43:09, 93.77s/it]EarlyStopping counter : 9 out of 12
training process:  49%|████▉     | 63/128 [1:33:29<1:39:52, 92.19s/it]EarlyStopping counter : 10 out of 12
training process:  50%|█████     | 64/128 [1:34:57<1:36:46, 90.73s/it]EarlyStopping counter : 11 out of 12
epoch : 65, train loss : 0.080, valid loss : 0.144, train acc : 0.973, valid acc : 0.962, train f1 : 0.896, valid f1 : 0.852
training process:  50%|█████     | 64/128 [1:36:39<1:36:39, 90.62s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 64, best f1 score : 0.857
training process finished, best loss : 0.140 and best acc : 0.963, best f1 : 0.857, best epoch : 61

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.63      0.75       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.81      0.87      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.81, test loss : 8.488

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:16<03:05, 16.90s/it]processing for feature importance:  17%|█▋        | 2/12 [00:29<02:24, 14.50s/it]processing for feature importance:  25%|██▌       | 3/12 [00:45<02:16, 15.11s/it]processing for feature importance:  33%|███▎      | 4/12 [00:59<01:57, 14.65s/it]processing for feature importance:  42%|████▏     | 5/12 [01:17<01:50, 15.84s/it]processing for feature importance:  50%|█████     | 6/12 [01:34<01:37, 16.27s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:54<01:26, 17.37s/it]processing for feature importance:  67%|██████▋   | 8/12 [02:13<01:11, 17.96s/it]processing for feature importance:  75%|███████▌  | 9/12 [02:30<00:53, 17.82s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:50<00:36, 18.35s/it]processing for feature importance:  92%|█████████▏| 11/12 [03:07<00:17, 17.85s/it]processing for feature importance: 100%|██████████| 12/12 [03:26<00:00, 18.44s/it]processing for feature importance: 100%|██████████| 12/12 [03:26<00:00, 17.25s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  1%|          | 2/306 [00:00<00:17, 17.36it/s]  2%|▏         | 7/306 [00:00<00:09, 30.41it/s]  4%|▎         | 11/306 [00:00<00:09, 30.04it/s]  5%|▍         | 15/306 [00:00<00:09, 30.46it/s]  7%|▋         | 22/306 [00:00<00:06, 42.43it/s]  9%|▉         | 29/306 [00:00<00:05, 49.72it/s] 13%|█▎        | 39/306 [00:00<00:04, 63.27it/s] 17%|█▋        | 52/306 [00:00<00:03, 80.78it/s] 20%|█▉        | 61/306 [00:01<00:03, 75.16it/s] 24%|██▎       | 72/306 [00:01<00:02, 79.48it/s] 28%|██▊       | 87/306 [00:01<00:02, 94.86it/s] 33%|███▎      | 101/306 [00:01<00:01, 106.42it/s] 38%|███▊      | 117/306 [00:01<00:01, 116.26it/s] 43%|████▎     | 131/306 [00:01<00:01, 118.74it/s] 47%|████▋     | 145/306 [00:01<00:01, 124.49it/s] 52%|█████▏    | 159/306 [00:01<00:01, 127.63it/s] 56%|█████▌    | 172/306 [00:01<00:01, 122.62it/s] 60%|██████    | 185/306 [00:02<00:01, 85.13it/s]  64%|██████▍   | 196/306 [00:02<00:01, 69.07it/s] 69%|██████▊   | 210/306 [00:02<00:01, 81.41it/s] 73%|███████▎  | 224/306 [00:02<00:00, 93.66it/s] 77%|███████▋  | 236/306 [00:02<00:00, 95.15it/s] 81%|████████  | 247/306 [00:02<00:00, 84.90it/s] 85%|████████▍ | 260/306 [00:03<00:00, 94.51it/s] 89%|████████▉ | 272/306 [00:03<00:00, 97.02it/s] 92%|█████████▏| 283/306 [00:03<00:00, 88.39it/s] 96%|█████████▋| 295/306 [00:03<00:00, 95.86it/s]100%|██████████| 306/306 [00:03<00:00, 81.40it/s]100%|██████████| 306/306 [00:03<00:00, 83.91it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 447.25it/s]extract the null data:  16%|█▋        | 90/553 [00:00<00:01, 408.20it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:01, 290.31it/s]extract the null data:  30%|██▉       | 164/553 [00:00<00:01, 281.65it/s]extract the null data:  37%|███▋      | 203/553 [00:00<00:01, 312.70it/s]extract the null data:  44%|████▍     | 242/553 [00:00<00:00, 334.68it/s]extract the null data:  50%|█████     | 278/553 [00:00<00:00, 289.09it/s]extract the null data:  56%|█████▌    | 309/553 [00:01<00:00, 278.03it/s]extract the null data:  62%|██████▏   | 341/553 [00:01<00:00, 273.79it/s]extract the null data:  68%|██████▊   | 377/553 [00:01<00:00, 295.22it/s]extract the null data:  74%|███████▍  | 408/553 [00:01<00:00, 258.18it/s]extract the null data:  79%|███████▉  | 436/553 [00:01<00:00, 222.58it/s]extract the null data:  83%|████████▎ | 460/553 [00:01<00:00, 216.97it/s]extract the null data:  87%|████████▋ | 483/553 [00:01<00:00, 188.79it/s]extract the null data:  94%|█████████▍| 519/553 [00:01<00:00, 227.08it/s]extract the null data: 100%|██████████| 553/553 [00:02<00:00, 268.46it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 11/553 [00:00<00:05, 102.51it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:05, 91.63it/s] replace nan value:   6%|▌         | 32/553 [00:00<00:05, 88.82it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:06, 78.57it/s]replace nan value:   9%|▉         | 49/553 [00:00<00:08, 58.72it/s]replace nan value:  10%|█         | 56/553 [00:00<00:08, 56.01it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:06, 73.77it/s]replace nan value:  14%|█▍        | 78/553 [00:01<00:07, 66.16it/s]replace nan value:  16%|█▌        | 86/553 [00:01<00:07, 60.02it/s]replace nan value:  17%|█▋        | 93/553 [00:01<00:07, 58.27it/s]replace nan value:  19%|█▉        | 104/553 [00:01<00:06, 66.30it/s]replace nan value:  21%|██        | 117/553 [00:01<00:05, 79.47it/s]replace nan value:  23%|██▎       | 126/553 [00:01<00:05, 79.94it/s]replace nan value:  24%|██▍       | 135/553 [00:01<00:06, 66.93it/s]replace nan value:  26%|██▌       | 143/553 [00:02<00:06, 62.25it/s]replace nan value:  27%|██▋       | 150/553 [00:02<00:07, 55.02it/s]replace nan value:  28%|██▊       | 156/553 [00:02<00:08, 47.77it/s]replace nan value:  29%|██▉       | 162/553 [00:02<00:08, 45.67it/s]replace nan value:  30%|███       | 168/553 [00:02<00:08, 44.03it/s]replace nan value:  32%|███▏      | 175/553 [00:02<00:07, 49.30it/s]replace nan value:  33%|███▎      | 181/553 [00:03<00:08, 42.12it/s]replace nan value:  34%|███▎      | 186/553 [00:03<00:09, 40.61it/s]replace nan value:  35%|███▍      | 192/553 [00:03<00:08, 41.37it/s]replace nan value:  36%|███▌      | 198/553 [00:03<00:08, 43.41it/s]replace nan value:  37%|███▋      | 203/553 [00:03<00:07, 44.67it/s]replace nan value:  38%|███▊      | 209/553 [00:03<00:07, 44.27it/s]replace nan value:  39%|███▊      | 214/553 [00:03<00:07, 43.73it/s]replace nan value:  40%|███▉      | 220/553 [00:03<00:07, 47.08it/s]replace nan value:  41%|████      | 226/553 [00:04<00:06, 47.36it/s]replace nan value:  42%|████▏     | 231/553 [00:04<00:07, 41.88it/s]replace nan value:  43%|████▎     | 238/553 [00:04<00:07, 43.59it/s]replace nan value:  44%|████▍     | 243/553 [00:04<00:07, 43.73it/s]replace nan value:  45%|████▍     | 248/553 [00:04<00:07, 43.27it/s]replace nan value:  46%|████▋     | 256/553 [00:04<00:05, 50.93it/s]replace nan value:  48%|████▊     | 266/553 [00:04<00:04, 63.15it/s]replace nan value:  50%|█████     | 279/553 [00:04<00:03, 74.84it/s]replace nan value:  53%|█████▎    | 292/553 [00:05<00:02, 88.55it/s]replace nan value:  55%|█████▍    | 302/553 [00:05<00:02, 87.15it/s]replace nan value:  56%|█████▋    | 312/553 [00:05<00:02, 81.00it/s]replace nan value:  58%|█████▊    | 321/553 [00:05<00:03, 72.73it/s]replace nan value:  59%|█████▉    | 329/553 [00:05<00:03, 66.99it/s]replace nan value:  61%|██████    | 336/553 [00:05<00:03, 61.93it/s]replace nan value:  62%|██████▏   | 344/553 [00:05<00:03, 65.73it/s]replace nan value:  63%|██████▎   | 351/553 [00:05<00:03, 61.88it/s]replace nan value:  65%|██████▍   | 358/553 [00:06<00:03, 58.01it/s]replace nan value:  66%|██████▌   | 364/553 [00:06<00:03, 53.85it/s]replace nan value:  67%|██████▋   | 370/553 [00:06<00:03, 54.42it/s]replace nan value:  68%|██████▊   | 376/553 [00:06<00:03, 52.78it/s]replace nan value:  70%|███████   | 388/553 [00:06<00:02, 69.31it/s]replace nan value:  72%|███████▏  | 399/553 [00:06<00:01, 79.04it/s]replace nan value:  74%|███████▍  | 408/553 [00:06<00:01, 80.50it/s]replace nan value:  75%|███████▌  | 417/553 [00:06<00:01, 74.15it/s]replace nan value:  77%|███████▋  | 425/553 [00:07<00:01, 70.96it/s]replace nan value:  78%|███████▊  | 433/553 [00:07<00:02, 59.54it/s]replace nan value:  80%|███████▉  | 440/553 [00:07<00:01, 61.05it/s]replace nan value:  81%|████████  | 447/553 [00:07<00:01, 62.84it/s]replace nan value:  82%|████████▏ | 455/553 [00:07<00:01, 63.97it/s]replace nan value:  84%|████████▍ | 465/553 [00:07<00:01, 67.34it/s]replace nan value:  86%|████████▌ | 475/553 [00:07<00:01, 71.51it/s]replace nan value:  88%|████████▊ | 485/553 [00:07<00:00, 76.06it/s]replace nan value:  89%|████████▉ | 493/553 [00:08<00:00, 69.28it/s]replace nan value:  91%|█████████ | 501/553 [00:08<00:00, 62.34it/s]replace nan value:  92%|█████████▏| 508/553 [00:08<00:00, 61.23it/s]replace nan value:  93%|█████████▎| 515/553 [00:08<00:00, 58.14it/s]replace nan value:  94%|█████████▍| 521/553 [00:08<00:00, 57.45it/s]replace nan value:  95%|█████████▌| 527/553 [00:08<00:00, 53.76it/s]replace nan value:  96%|█████████▋| 533/553 [00:08<00:00, 45.48it/s]replace nan value:  98%|█████████▊| 540/553 [00:09<00:00, 51.06it/s]replace nan value: 100%|██████████| 553/553 [00:09<00:00, 60.59it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  1%|          | 3/553 [00:00<00:27, 20.27it/s]  1%|▏         | 7/553 [00:00<00:20, 26.79it/s]  3%|▎         | 18/553 [00:00<00:09, 58.61it/s]  6%|▌         | 33/553 [00:00<00:05, 90.40it/s]  8%|▊         | 44/553 [00:00<00:05, 92.91it/s] 10%|▉         | 54/553 [00:00<00:06, 75.91it/s] 11%|█▏        | 63/553 [00:00<00:06, 76.10it/s] 13%|█▎        | 72/553 [00:01<00:06, 74.92it/s] 15%|█▌        | 83/553 [00:01<00:05, 83.16it/s] 18%|█▊        | 97/553 [00:01<00:04, 95.70it/s] 20%|██        | 112/553 [00:01<00:04, 109.31it/s] 22%|██▏       | 124/553 [00:01<00:05, 80.88it/s]  24%|██▍       | 134/553 [00:01<00:06, 69.47it/s] 26%|██▌       | 143/553 [00:01<00:06, 65.85it/s] 27%|██▋       | 152/553 [00:02<00:05, 69.93it/s] 29%|██▉       | 161/553 [00:02<00:05, 73.17it/s] 31%|███       | 169/553 [00:02<00:07, 54.84it/s] 32%|███▏      | 176/553 [00:02<00:08, 44.56it/s] 33%|███▎      | 182/553 [00:02<00:09, 40.48it/s] 34%|███▍      | 187/553 [00:02<00:09, 38.07it/s] 35%|███▍      | 192/553 [00:03<00:08, 40.20it/s] 36%|███▌      | 197/553 [00:03<00:08, 42.23it/s] 37%|███▋      | 203/553 [00:03<00:08, 42.02it/s] 38%|███▊      | 211/553 [00:03<00:06, 50.79it/s] 39%|███▉      | 217/553 [00:03<00:08, 40.94it/s] 40%|████      | 222/553 [00:03<00:09, 35.40it/s] 41%|████▏     | 229/553 [00:03<00:07, 40.80it/s] 43%|████▎     | 237/553 [00:04<00:07, 45.13it/s] 44%|████▍     | 244/553 [00:04<00:06, 46.60it/s] 45%|████▌     | 249/553 [00:04<00:06, 46.77it/s] 46%|████▌     | 254/553 [00:04<00:06, 46.98it/s] 47%|████▋     | 259/553 [00:04<00:06, 44.96it/s] 48%|████▊     | 266/553 [00:04<00:05, 47.89it/s] 49%|████▉     | 271/553 [00:04<00:06, 45.99it/s] 51%|█████     | 281/553 [00:04<00:04, 59.65it/s] 53%|█████▎    | 292/553 [00:05<00:03, 70.74it/s] 54%|█████▍    | 301/553 [00:05<00:03, 72.04it/s] 56%|█████▌    | 309/553 [00:05<00:04, 53.15it/s] 57%|█████▋    | 316/553 [00:05<00:04, 50.52it/s] 58%|█████▊    | 322/553 [00:05<00:05, 43.75it/s] 59%|█████▉    | 327/553 [00:05<00:05, 41.00it/s] 60%|██████    | 332/553 [00:06<00:05, 37.16it/s] 61%|██████    | 338/553 [00:06<00:05, 40.99it/s] 62%|██████▏   | 344/553 [00:06<00:04, 45.14it/s] 64%|██████▎   | 352/553 [00:06<00:03, 53.38it/s] 65%|██████▍   | 358/553 [00:06<00:03, 52.13it/s] 66%|██████▌   | 365/553 [00:06<00:03, 54.12it/s] 67%|██████▋   | 371/553 [00:06<00:03, 52.66it/s] 68%|██████▊   | 377/553 [00:06<00:04, 42.53it/s] 69%|██████▉   | 384/553 [00:07<00:03, 46.32it/s] 70%|███████   | 389/553 [00:07<00:03, 45.93it/s] 71%|███████▏  | 395/553 [00:07<00:03, 48.87it/s] 73%|███████▎  | 402/553 [00:07<00:02, 53.76it/s] 74%|███████▍  | 410/553 [00:07<00:02, 60.47it/s] 76%|███████▌  | 418/553 [00:07<00:02, 62.08it/s] 77%|███████▋  | 427/553 [00:07<00:01, 66.48it/s] 78%|███████▊  | 434/553 [00:07<00:01, 60.27it/s] 80%|███████▉  | 441/553 [00:08<00:01, 61.14it/s] 82%|████████▏ | 454/553 [00:08<00:01, 78.09it/s] 84%|████████▎ | 463/553 [00:08<00:01, 74.24it/s] 85%|████████▌ | 471/553 [00:08<00:01, 69.98it/s] 87%|████████▋ | 479/553 [00:08<00:01, 71.62it/s] 88%|████████▊ | 489/553 [00:08<00:00, 74.89it/s] 90%|████████▉ | 497/553 [00:08<00:01, 51.84it/s] 91%|█████████ | 504/553 [00:09<00:00, 52.39it/s] 93%|█████████▎| 512/553 [00:09<00:00, 55.37it/s] 94%|█████████▍| 521/553 [00:09<00:00, 61.52it/s] 95%|█████████▌| 528/553 [00:09<00:00, 57.50it/s] 97%|█████████▋| 535/553 [00:09<00:00, 59.52it/s] 98%|█████████▊| 544/553 [00:09<00:00, 63.94it/s]100%|█████████▉| 551/553 [00:09<00:00, 60.99it/s]100%|██████████| 553/553 [00:09<00:00, 56.52it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 17/139 [00:00<00:00, 166.69it/s]extract the null data:  48%|████▊     | 67/139 [00:00<00:00, 357.55it/s]extract the null data:  76%|███████▌  | 105/139 [00:00<00:00, 366.34it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 332.89it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  11%|█         | 15/139 [00:00<00:00, 140.58it/s]replace nan value:  22%|██▏       | 30/139 [00:00<00:01, 90.96it/s] replace nan value:  29%|██▉       | 41/139 [00:00<00:01, 85.15it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:01, 84.39it/s]replace nan value:  45%|████▍     | 62/139 [00:00<00:00, 93.74it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 94.85it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 89.26it/s]replace nan value:  68%|██████▊   | 95/139 [00:01<00:00, 84.45it/s]replace nan value:  77%|███████▋  | 107/139 [00:01<00:00, 89.89it/s]replace nan value:  86%|████████▋ | 120/139 [00:01<00:00, 100.20it/s]replace nan value:  96%|█████████▌| 133/139 [00:01<00:00, 107.88it/s]replace nan value: 100%|██████████| 139/139 [00:01<00:00, 98.18it/s] 
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 86.38it/s] 14%|█▍        | 20/139 [00:00<00:01, 73.48it/s] 20%|██        | 28/139 [00:00<00:01, 62.73it/s] 25%|██▌       | 35/139 [00:00<00:01, 55.31it/s] 30%|███       | 42/139 [00:00<00:01, 59.23it/s] 35%|███▌      | 49/139 [00:00<00:02, 43.62it/s] 39%|███▉      | 54/139 [00:01<00:02, 39.71it/s] 42%|████▏     | 59/139 [00:01<00:02, 35.03it/s] 45%|████▌     | 63/139 [00:01<00:02, 35.99it/s] 48%|████▊     | 67/139 [00:01<00:02, 34.40it/s] 53%|█████▎    | 73/139 [00:01<00:01, 39.75it/s] 56%|█████▌    | 78/139 [00:01<00:01, 37.18it/s] 60%|█████▉    | 83/139 [00:01<00:01, 40.19it/s] 63%|██████▎   | 88/139 [00:02<00:01, 30.06it/s] 67%|██████▋   | 93/139 [00:02<00:01, 33.32it/s] 71%|███████   | 98/139 [00:02<00:01, 35.02it/s] 73%|███████▎  | 102/139 [00:02<00:01, 34.08it/s] 76%|███████▋  | 106/139 [00:02<00:01, 30.40it/s] 82%|████████▏ | 114/139 [00:02<00:00, 40.30it/s] 91%|█████████▏| 127/139 [00:02<00:00, 58.51it/s] 96%|█████████▋| 134/139 [00:03<00:00, 54.27it/s]100%|██████████| 139/139 [00:03<00:00, 44.31it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:26,  6.50it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:01, 97.22it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:01, 121.75it/s]extract the null data:  35%|███▌      | 61/173 [00:00<00:00, 154.42it/s]extract the null data:  47%|████▋     | 82/173 [00:00<00:00, 169.57it/s]extract the null data:  58%|█████▊    | 101/173 [00:00<00:00, 168.05it/s]extract the null data:  69%|██████▉   | 119/173 [00:00<00:00, 164.57it/s]extract the null data:  79%|███████▊  | 136/173 [00:00<00:00, 159.38it/s]extract the null data:  88%|████████▊ | 153/173 [00:01<00:00, 153.06it/s]extract the null data:  99%|█████████▉| 171/173 [00:01<00:00, 144.62it/s]extract the null data: 100%|██████████| 173/173 [00:01<00:00, 144.88it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   5%|▌         | 9/173 [00:00<00:01, 89.24it/s]replace nan value:  10%|█         | 18/173 [00:00<00:02, 68.76it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:01, 104.11it/s]replace nan value:  28%|██▊       | 49/173 [00:00<00:01, 115.26it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 129.31it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 137.12it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 136.38it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 132.56it/s]replace nan value:  72%|███████▏  | 124/173 [00:01<00:00, 103.18it/s]replace nan value:  79%|███████▊  | 136/173 [00:01<00:00, 82.06it/s] replace nan value:  84%|████████▍ | 146/173 [00:01<00:00, 63.58it/s]replace nan value:  90%|████████▉ | 155/173 [00:01<00:00, 67.25it/s]replace nan value:  95%|█████████▍| 164/173 [00:01<00:00, 68.89it/s]replace nan value:  99%|█████████▉| 172/173 [00:01<00:00, 68.08it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 88.61it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  3%|▎         | 6/173 [00:00<00:03, 50.73it/s]  8%|▊         | 14/173 [00:00<00:02, 54.81it/s] 12%|█▏        | 20/173 [00:00<00:04, 34.26it/s] 14%|█▍        | 24/173 [00:00<00:05, 28.16it/s] 17%|█▋        | 29/173 [00:00<00:05, 28.32it/s] 19%|█▉        | 33/173 [00:01<00:04, 30.30it/s] 21%|██▏       | 37/173 [00:01<00:04, 31.29it/s] 25%|██▍       | 43/173 [00:01<00:03, 38.04it/s] 29%|██▉       | 50/173 [00:01<00:02, 44.14it/s] 32%|███▏      | 55/173 [00:01<00:02, 39.38it/s] 35%|███▍      | 60/173 [00:01<00:02, 40.12it/s] 38%|███▊      | 65/173 [00:01<00:02, 36.54it/s] 40%|███▉      | 69/173 [00:01<00:02, 36.00it/s] 43%|████▎     | 75/173 [00:02<00:02, 40.66it/s] 46%|████▌     | 80/173 [00:02<00:02, 39.00it/s] 49%|████▉     | 85/173 [00:02<00:02, 35.67it/s] 52%|█████▏    | 90/173 [00:02<00:02, 38.69it/s] 55%|█████▍    | 95/173 [00:02<00:02, 32.53it/s] 58%|█████▊    | 101/173 [00:02<00:01, 37.72it/s] 61%|██████▏   | 106/173 [00:02<00:01, 38.48it/s] 67%|██████▋   | 116/173 [00:03<00:01, 49.04it/s] 71%|███████   | 122/173 [00:03<00:01, 38.45it/s] 73%|███████▎  | 127/173 [00:03<00:01, 34.91it/s] 77%|███████▋  | 133/173 [00:03<00:01, 38.56it/s] 80%|████████  | 139/173 [00:03<00:00, 41.31it/s] 83%|████████▎ | 144/173 [00:03<00:00, 38.21it/s] 86%|████████▌ | 149/173 [00:04<00:00, 31.49it/s] 90%|████████▉ | 155/173 [00:04<00:00, 36.37it/s] 92%|█████████▏| 160/173 [00:04<00:00, 32.60it/s] 95%|█████████▍| 164/173 [00:04<00:00, 30.23it/s] 97%|█████████▋| 168/173 [00:04<00:00, 19.02it/s] 99%|█████████▉| 171/173 [00:05<00:00, 18.38it/s]100%|██████████| 173/173 [00:05<00:00, 33.08it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.561, valid loss : 0.463, train acc : 0.707, valid acc : 0.768, train f1 : 0.706, valid f1 : 0.607
training process:   1%|          | 1/128 [02:45<5:51:17, 165.97s/it]Best score increase :0.000 -> 0.607
training process:   2%|▏         | 2/128 [04:52<4:59:34, 142.65s/it]Best score increase :0.607 -> 0.698
training process:   2%|▏         | 3/128 [06:47<4:31:05, 130.12s/it]Best score increase :0.698 -> 0.744
training process:   3%|▎         | 4/128 [08:50<4:23:26, 127.47s/it]Best score increase :0.744 -> 0.796
epoch : 5, train loss : 0.339, valid loss : 0.255, train acc : 0.852, valid acc : 0.919, train f1 : 0.851, valid f1 : 0.790
training process:   4%|▍         | 5/128 [10:52<4:17:03, 125.40s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [12:39<4:01:53, 118.96s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▌         | 7/128 [14:22<3:49:52, 113.99s/it]EarlyStopping counter : 3 out of 12
training process:   6%|▋         | 8/128 [16:05<3:41:02, 110.52s/it]Best score increase :0.796 -> 0.803
epoch : 9, train loss : 0.291, valid loss : 0.214, train acc : 0.873, valid acc : 0.926, train f1 : 0.873, valid f1 : 0.807
training process:   7%|▋         | 9/128 [18:06<3:45:33, 113.73s/it]Best score increase :0.803 -> 0.807
training process:   8%|▊         | 10/128 [19:49<3:36:45, 110.22s/it]Best score increase :0.807 -> 0.813
training process:   9%|▊         | 11/128 [21:33<3:31:45, 108.59s/it]Best score increase :0.813 -> 0.825
training process:   9%|▉         | 12/128 [23:12<3:23:48, 105.42s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.260, valid loss : 0.221, train acc : 0.890, valid acc : 0.917, train f1 : 0.890, valid f1 : 0.793
training process:  10%|█         | 13/128 [25:18<3:34:23, 111.86s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [27:11<3:33:04, 112.14s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [29:10<3:34:45, 114.03s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [30:58<3:29:38, 112.30s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.240, valid loss : 0.184, train acc : 0.899, valid acc : 0.935, train f1 : 0.899, valid f1 : 0.823
training process:  13%|█▎        | 17/128 [33:13<3:40:21, 119.12s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [35:00<3:32:04, 115.68s/it]EarlyStopping counter : 7 out of 12
training process:  15%|█▍        | 19/128 [36:42<3:22:42, 111.58s/it]EarlyStopping counter : 8 out of 12
training process:  16%|█▌        | 20/128 [38:25<3:16:07, 108.96s/it]EarlyStopping counter : 9 out of 12
epoch : 21, train loss : 0.218, valid loss : 0.187, train acc : 0.910, valid acc : 0.932, train f1 : 0.910, valid f1 : 0.822
training process:  16%|█▋        | 21/128 [40:28<3:21:23, 112.93s/it]EarlyStopping counter : 10 out of 12
training process:  17%|█▋        | 22/128 [42:03<3:10:26, 107.79s/it]EarlyStopping counter : 11 out of 12
training process:  17%|█▋        | 22/128 [43:57<3:31:49, 119.90s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 22, best f1 score : 0.825
training process finished, best loss : 0.190 and best acc : 0.936, best f1 : 0.825, best epoch : 10

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.48      0.80      0.60       580
           1       0.98      0.93      0.95      6818

    accuracy                           0.92      7398
   macro avg       0.73      0.86      0.78      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.78, test AUC : 0.86, test loss : 12.327

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:18<03:26, 18.82s/it]processing for feature importance:  17%|█▋        | 2/12 [00:37<03:10, 19.00s/it]processing for feature importance:  25%|██▌       | 3/12 [00:55<02:46, 18.48s/it]processing for feature importance:  33%|███▎      | 4/12 [01:14<02:27, 18.44s/it]processing for feature importance:  42%|████▏     | 5/12 [01:29<01:59, 17.13s/it]processing for feature importance:  50%|█████     | 6/12 [01:46<01:42, 17.16s/it]processing for feature importance:  58%|█████▊    | 7/12 [02:02<01:24, 16.91s/it]processing for feature importance:  67%|██████▋   | 8/12 [02:21<01:10, 17.63s/it]processing for feature importance:  75%|███████▌  | 9/12 [02:37<00:50, 16.93s/it]processing for feature importance:  83%|████████▎ | 10/12 [02:53<00:33, 16.82s/it]processing for feature importance:  92%|█████████▏| 11/12 [03:08<00:16, 16.11s/it]processing for feature importance: 100%|██████████| 12/12 [03:26<00:00, 16.81s/it]processing for feature importance: 100%|██████████| 12/12 [03:26<00:00, 17.22s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  2%|▏         | 5/306 [00:00<00:06, 48.23it/s]  6%|▌         | 17/306 [00:00<00:03, 88.66it/s] 10%|▉         | 30/306 [00:00<00:02, 106.25it/s] 13%|█▎        | 41/306 [00:00<00:02, 97.70it/s]  17%|█▋        | 52/306 [00:00<00:02, 96.27it/s] 20%|██        | 62/306 [00:00<00:02, 95.09it/s] 24%|██▎       | 72/306 [00:00<00:02, 96.05it/s] 27%|██▋       | 82/306 [00:00<00:02, 74.94it/s] 30%|██▉       | 91/306 [00:01<00:02, 72.18it/s] 34%|███▍      | 105/306 [00:01<00:02, 88.18it/s] 38%|███▊      | 116/306 [00:01<00:02, 88.67it/s] 43%|████▎     | 132/306 [00:01<00:01, 106.29it/s] 50%|█████     | 154/306 [00:01<00:01, 135.82it/s] 57%|█████▋    | 174/306 [00:01<00:00, 152.34it/s] 63%|██████▎   | 192/306 [00:01<00:00, 160.07it/s] 68%|██████▊   | 209/306 [00:01<00:00, 156.33it/s] 75%|███████▍  | 228/306 [00:01<00:00, 165.15it/s] 80%|████████  | 245/306 [00:02<00:00, 133.58it/s] 85%|████████▍ | 260/306 [00:02<00:00, 100.88it/s] 89%|████████▉ | 272/306 [00:02<00:00, 104.36it/s] 96%|█████████▌| 293/306 [00:02<00:00, 127.58it/s]100%|██████████| 306/306 [00:02<00:00, 116.18it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 478.41it/s]extract the null data:  18%|█▊        | 97/553 [00:00<00:00, 482.45it/s]extract the null data:  27%|██▋       | 149/553 [00:00<00:00, 498.89it/s]extract the null data:  37%|███▋      | 204/553 [00:00<00:00, 518.02it/s]extract the null data:  47%|████▋     | 258/553 [00:00<00:00, 523.73it/s]extract the null data:  56%|█████▌    | 311/553 [00:00<00:00, 525.61it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 532.12it/s]extract the null data:  76%|███████▌  | 420/553 [00:00<00:00, 489.67it/s]extract the null data:  85%|████████▍ | 470/553 [00:00<00:00, 459.65it/s]extract the null data:  95%|█████████▍| 523/553 [00:01<00:00, 476.93it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 451.89it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   1%|▏         | 8/553 [00:00<00:07, 69.15it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:05, 100.55it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:04, 106.34it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:06, 73.13it/s] replace nan value:  10%|▉         | 55/553 [00:00<00:06, 72.91it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:06, 74.27it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:06, 69.01it/s]replace nan value:  14%|█▍        | 79/553 [00:01<00:06, 70.17it/s]replace nan value:  16%|█▋        | 91/553 [00:01<00:05, 82.85it/s]replace nan value:  19%|█▉        | 104/553 [00:01<00:04, 91.55it/s]replace nan value:  22%|██▏       | 119/553 [00:01<00:04, 106.42it/s]replace nan value:  24%|██▍       | 132/553 [00:01<00:03, 111.14it/s]replace nan value:  26%|██▌       | 145/553 [00:01<00:03, 115.77it/s]replace nan value:  29%|██▉       | 161/553 [00:01<00:03, 126.57it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:02, 131.96it/s]replace nan value:  34%|███▍      | 190/553 [00:01<00:03, 109.27it/s]replace nan value:  37%|███▋      | 207/553 [00:02<00:02, 118.54it/s]replace nan value:  40%|████      | 223/553 [00:02<00:02, 128.00it/s]replace nan value:  43%|████▎     | 237/553 [00:02<00:02, 115.44it/s]replace nan value:  46%|████▌     | 255/553 [00:02<00:02, 130.48it/s]replace nan value:  49%|████▉     | 273/553 [00:02<00:01, 141.55it/s]replace nan value:  52%|█████▏    | 288/553 [00:02<00:01, 140.66it/s]replace nan value:  55%|█████▍    | 303/553 [00:02<00:01, 137.92it/s]replace nan value:  58%|█████▊    | 318/553 [00:02<00:01, 130.06it/s]replace nan value:  60%|██████    | 332/553 [00:03<00:02, 107.64it/s]replace nan value:  62%|██████▏   | 345/553 [00:03<00:01, 111.52it/s]replace nan value:  65%|██████▍   | 358/553 [00:03<00:01, 114.49it/s]replace nan value:  67%|██████▋   | 370/553 [00:03<00:01, 104.21it/s]replace nan value:  69%|██████▉   | 381/553 [00:03<00:01, 90.93it/s] replace nan value:  71%|███████   | 391/553 [00:03<00:02, 77.56it/s]replace nan value:  72%|███████▏  | 400/553 [00:03<00:02, 69.32it/s]replace nan value:  74%|███████▍  | 408/553 [00:04<00:02, 69.73it/s]replace nan value:  75%|███████▌  | 416/553 [00:04<00:02, 67.83it/s]replace nan value:  77%|███████▋  | 424/553 [00:04<00:02, 59.21it/s]replace nan value:  78%|███████▊  | 431/553 [00:04<00:02, 50.17it/s]replace nan value:  79%|███████▉  | 437/553 [00:04<00:02, 48.75it/s]replace nan value:  82%|████████▏ | 451/553 [00:04<00:01, 68.00it/s]replace nan value:  83%|████████▎ | 459/553 [00:04<00:01, 65.55it/s]replace nan value:  84%|████████▍ | 467/553 [00:05<00:01, 67.83it/s]replace nan value:  86%|████████▌ | 475/553 [00:05<00:01, 66.80it/s]replace nan value:  88%|████████▊ | 484/553 [00:05<00:01, 66.78it/s]replace nan value:  89%|████████▉ | 491/553 [00:05<00:00, 66.68it/s]replace nan value:  90%|█████████ | 498/553 [00:05<00:00, 66.58it/s]replace nan value:  92%|█████████▏| 509/553 [00:05<00:00, 71.76it/s]replace nan value:  93%|█████████▎| 517/553 [00:05<00:00, 68.88it/s]replace nan value:  95%|█████████▍| 525/553 [00:05<00:00, 65.71it/s]replace nan value:  97%|█████████▋| 535/553 [00:06<00:00, 73.45it/s]replace nan value: 100%|██████████| 553/553 [00:06<00:00, 100.62it/s]replace nan value: 100%|██████████| 553/553 [00:06<00:00, 89.95it/s] 
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 107.15it/s]  5%|▍         | 26/553 [00:00<00:04, 126.25it/s]  7%|▋         | 39/553 [00:00<00:04, 110.11it/s]  9%|▉         | 51/553 [00:00<00:07, 67.37it/s]  11%|█         | 60/553 [00:00<00:07, 65.78it/s] 12%|█▏        | 68/553 [00:00<00:08, 55.32it/s] 14%|█▍        | 78/553 [00:01<00:07, 63.77it/s] 17%|█▋        | 92/553 [00:01<00:05, 78.34it/s] 18%|█▊        | 101/553 [00:01<00:05, 77.51it/s] 21%|██        | 115/553 [00:01<00:04, 91.49it/s] 23%|██▎       | 125/553 [00:01<00:05, 84.53it/s] 24%|██▍       | 135/553 [00:01<00:05, 80.95it/s] 26%|██▌       | 144/553 [00:01<00:05, 78.03it/s] 29%|██▉       | 160/553 [00:01<00:04, 93.41it/s] 31%|███       | 171/553 [00:02<00:03, 95.83it/s] 33%|███▎      | 181/553 [00:02<00:03, 93.91it/s] 36%|███▌      | 197/553 [00:02<00:03, 109.46it/s] 38%|███▊      | 209/553 [00:02<00:04, 84.80it/s]  40%|███▉      | 219/553 [00:02<00:05, 56.92it/s] 41%|████      | 227/553 [00:02<00:05, 57.77it/s] 43%|████▎     | 236/553 [00:03<00:05, 61.72it/s] 45%|████▍     | 247/553 [00:03<00:04, 71.64it/s] 46%|████▋     | 256/553 [00:03<00:04, 63.39it/s] 48%|████▊     | 265/553 [00:03<00:04, 65.59it/s] 49%|████▉     | 273/553 [00:03<00:04, 59.12it/s] 51%|█████     | 280/553 [00:03<00:04, 61.39it/s] 52%|█████▏    | 289/553 [00:03<00:03, 68.06it/s] 54%|█████▎    | 297/553 [00:04<00:03, 67.02it/s] 55%|█████▌    | 306/553 [00:04<00:03, 71.05it/s] 57%|█████▋    | 315/553 [00:04<00:03, 75.05it/s] 58%|█████▊    | 323/553 [00:04<00:03, 76.17it/s] 60%|██████    | 332/553 [00:04<00:02, 77.76it/s] 62%|██████▏   | 345/553 [00:04<00:02, 89.43it/s] 65%|██████▍   | 358/553 [00:04<00:01, 98.96it/s] 67%|██████▋   | 373/553 [00:04<00:01, 113.00it/s] 70%|██████▉   | 385/553 [00:04<00:01, 106.79it/s] 72%|███████▏  | 396/553 [00:05<00:01, 104.68it/s] 74%|███████▍  | 409/553 [00:05<00:01, 110.91it/s] 76%|███████▌  | 421/553 [00:05<00:01, 109.66it/s] 78%|███████▊  | 433/553 [00:05<00:01, 101.46it/s] 81%|████████▏ | 450/553 [00:05<00:00, 119.37it/s] 84%|████████▍ | 464/553 [00:05<00:00, 124.21it/s] 86%|████████▋ | 478/553 [00:05<00:00, 126.11it/s] 89%|████████▉ | 491/553 [00:05<00:00, 121.47it/s] 91%|█████████ | 504/553 [00:05<00:00, 120.98it/s] 94%|█████████▍| 519/553 [00:05<00:00, 127.53it/s] 96%|█████████▌| 532/553 [00:06<00:00, 106.11it/s] 99%|█████████▉| 548/553 [00:06<00:00, 116.88it/s]100%|██████████| 553/553 [00:06<00:00, 86.58it/s] 
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 297.91it/s]extract the null data:  65%|██████▍   | 90/139 [00:00<00:00, 474.91it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 494.61it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 207.66it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 205.12it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 198.97it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 199.98it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 201.40it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 190.26it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.04it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.79it/s] 17%|█▋        | 24/139 [00:00<00:00, 119.50it/s] 27%|██▋       | 38/139 [00:00<00:00, 127.54it/s] 37%|███▋      | 52/139 [00:00<00:00, 129.86it/s] 48%|████▊     | 67/139 [00:00<00:00, 135.28it/s] 58%|█████▊    | 81/139 [00:00<00:00, 135.09it/s] 68%|██████▊   | 95/139 [00:00<00:00, 122.82it/s] 78%|███████▊  | 108/139 [00:00<00:00, 124.16it/s] 90%|████████▉ | 125/139 [00:00<00:00, 135.84it/s]100%|██████████| 139/139 [00:01<00:00, 131.57it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 236.17it/s]extract the null data:  48%|████▊     | 83/173 [00:00<00:00, 441.56it/s]extract the null data:  82%|████████▏ | 142/173 [00:00<00:00, 506.22it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 473.76it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 189.06it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 191.51it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 196.04it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 195.60it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 196.16it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 195.16it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 161.73it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 147.06it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 156.09it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  4%|▍         | 7/173 [00:00<00:02, 69.27it/s] 10%|█         | 18/173 [00:00<00:01, 86.13it/s] 16%|█▌        | 27/173 [00:00<00:01, 74.07it/s] 20%|██        | 35/173 [00:00<00:02, 67.11it/s] 24%|██▍       | 42/173 [00:00<00:02, 60.26it/s] 28%|██▊       | 49/173 [00:00<00:02, 61.71it/s] 32%|███▏      | 56/173 [00:00<00:01, 60.63it/s] 37%|███▋      | 64/173 [00:00<00:01, 63.71it/s] 41%|████      | 71/173 [00:01<00:01, 61.66it/s] 46%|████▌     | 80/173 [00:01<00:01, 66.48it/s] 53%|█████▎    | 91/173 [00:01<00:01, 74.53it/s] 61%|██████    | 105/173 [00:01<00:00, 90.90it/s] 69%|██████▉   | 120/173 [00:01<00:00, 106.78it/s] 77%|███████▋  | 133/173 [00:01<00:00, 112.25it/s] 84%|████████▍ | 145/173 [00:01<00:00, 94.34it/s]  90%|█████████ | 156/173 [00:02<00:00, 76.25it/s] 95%|█████████▌| 165/173 [00:02<00:00, 68.62it/s]100%|██████████| 173/173 [00:02<00:00, 45.88it/s]100%|██████████| 173/173 [00:02<00:00, 66.76it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.090, valid loss : 0.081, train acc : 0.550, valid acc : 0.648, train f1 : 0.456, valid f1 : 0.525
training process:   1%|          | 1/128 [01:52<3:57:09, 112.04s/it]Best score increase :0.000 -> 0.525
training process:   2%|▏         | 2/128 [03:27<3:34:12, 102.00s/it]Best score increase :0.525 -> 0.668
training process:   2%|▏         | 3/128 [04:57<3:21:53, 96.90s/it] Best score increase :0.668 -> 0.728
training process:   3%|▎         | 4/128 [06:31<3:17:43, 95.67s/it]Best score increase :0.728 -> 0.762
epoch : 5, train loss : 0.057, valid loss : 0.058, train acc : 0.854, valid acc : 0.930, train f1 : 0.693, valid f1 : 0.793
training process:   4%|▍         | 5/128 [08:23<3:27:59, 101.46s/it]Best score increase :0.762 -> 0.793
training process:   5%|▍         | 6/128 [10:01<3:23:47, 100.22s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [11:35<3:18:28, 98.42s/it] Best score increase :0.793 -> 0.815
training process:   6%|▋         | 8/128 [13:03<3:09:38, 94.82s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.050, valid loss : 0.054, train acc : 0.900, valid acc : 0.938, train f1 : 0.751, valid f1 : 0.811
training process:   7%|▋         | 9/128 [14:47<3:13:48, 97.72s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [16:20<3:09:18, 96.26s/it]Best score increase :0.815 -> 0.821
training process:   9%|▊         | 11/128 [17:58<3:08:50, 96.84s/it]Best score increase :0.821 -> 0.833
training process:   9%|▉         | 12/128 [19:32<3:05:37, 96.01s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.045, valid loss : 0.052, train acc : 0.915, valid acc : 0.948, train f1 : 0.779, valid f1 : 0.835
training process:  10%|█         | 13/128 [21:19<3:10:21, 99.32s/it]Best score increase :0.833 -> 0.835
training process:  11%|█         | 14/128 [22:49<3:03:36, 96.64s/it]Best score increase :0.835 -> 0.838
training process:  12%|█▏        | 15/128 [24:31<3:05:08, 98.31s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [26:24<3:11:35, 102.64s/it]Best score increase :0.838 -> 0.841
epoch : 17, train loss : 0.043, valid loss : 0.057, train acc : 0.925, valid acc : 0.949, train f1 : 0.797, valid f1 : 0.834
training process:  13%|█▎        | 17/128 [28:32<3:24:04, 110.31s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [30:32<3:27:12, 113.02s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [32:34<3:30:39, 115.96s/it]Best score increase :0.841 -> 0.847
training process:  16%|█▌        | 20/128 [34:33<3:30:09, 116.75s/it]Best score increase :0.847 -> 0.848
epoch : 21, train loss : 0.040, valid loss : 0.059, train acc : 0.931, valid acc : 0.952, train f1 : 0.809, valid f1 : 0.841
training process:  16%|█▋        | 21/128 [36:50<3:38:58, 122.79s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [39:01<3:41:33, 125.41s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [41:16<3:44:25, 128.24s/it]Best score increase :0.848 -> 0.859
training process:  19%|█▉        | 24/128 [43:33<3:46:35, 130.72s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.040, valid loss : 0.053, train acc : 0.936, valid acc : 0.953, train f1 : 0.818, valid f1 : 0.852
training process:  20%|█▉        | 25/128 [46:06<3:55:58, 137.46s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [48:23<3:53:36, 137.42s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [50:42<3:51:58, 137.81s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [53:00<3:49:59, 138.00s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.037, valid loss : 0.054, train acc : 0.941, valid acc : 0.954, train f1 : 0.830, valid f1 : 0.854
training process:  23%|██▎       | 29/128 [55:30<3:53:15, 141.37s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [57:47<3:49:06, 140.27s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [1:00:00<3:43:17, 138.11s/it]EarlyStopping counter : 8 out of 12
training process:  25%|██▌       | 32/128 [1:02:15<3:39:18, 137.07s/it]EarlyStopping counter : 9 out of 12
epoch : 33, train loss : 0.037, valid loss : 0.070, train acc : 0.945, valid acc : 0.957, train f1 : 0.839, valid f1 : 0.850
training process:  26%|██▌       | 33/128 [1:04:49<3:44:53, 142.04s/it]EarlyStopping counter : 10 out of 12
training process:  27%|██▋       | 34/128 [1:07:10<3:42:09, 141.81s/it]EarlyStopping counter : 11 out of 12
training process:  27%|██▋       | 34/128 [1:09:15<3:11:29, 122.23s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 34, best f1 score : 0.859
training process finished, best loss : 0.053 and best acc : 0.955, best f1 : 0.859, best epoch : 22

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.71      0.74      0.73       580
           1       0.98      0.97      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.84      0.86      0.85      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.85, test AUC : 0.86, test loss : 3.301

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:19<03:37, 19.81s/it]processing for feature importance:  17%|█▋        | 2/12 [00:37<03:05, 18.56s/it]processing for feature importance:  25%|██▌       | 3/12 [00:54<02:42, 18.02s/it]processing for feature importance:  33%|███▎      | 4/12 [01:14<02:29, 18.74s/it]processing for feature importance:  42%|████▏     | 5/12 [01:33<02:11, 18.83s/it]processing for feature importance:  50%|█████     | 6/12 [01:52<01:52, 18.73s/it]processing for feature importance:  58%|█████▊    | 7/12 [02:11<01:34, 18.98s/it]processing for feature importance:  67%|██████▋   | 8/12 [02:31<01:16, 19.21s/it]processing for feature importance:  75%|███████▌  | 9/12 [02:52<00:59, 19.69s/it]processing for feature importance:  83%|████████▎ | 10/12 [03:10<00:38, 19.36s/it]processing for feature importance:  92%|█████████▏| 11/12 [03:32<00:19, 19.98s/it]processing for feature importance: 100%|██████████| 12/12 [03:51<00:00, 19.70s/it]processing for feature importance: 100%|██████████| 12/12 [03:51<00:00, 19.27s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 204.96it/s] 15%|█▍        | 45/306 [00:00<00:01, 219.89it/s] 22%|██▏       | 68/306 [00:00<00:01, 221.79it/s] 30%|██▉       | 91/306 [00:00<00:00, 223.25it/s] 37%|███▋      | 114/306 [00:00<00:00, 217.30it/s] 44%|████▍     | 136/306 [00:00<00:00, 217.62it/s] 52%|█████▏    | 158/306 [00:00<00:00, 217.53it/s] 59%|█████▉    | 181/306 [00:00<00:00, 218.65it/s] 67%|██████▋   | 204/306 [00:00<00:00, 219.26it/s] 74%|███████▍  | 226/306 [00:01<00:00, 216.35it/s] 81%|████████  | 248/306 [00:01<00:00, 211.17it/s] 88%|████████▊ | 270/306 [00:01<00:00, 212.99it/s] 96%|█████████▌| 293/306 [00:01<00:00, 217.44it/s]100%|██████████| 306/306 [00:01<00:00, 217.13it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 477.88it/s]extract the null data:  18%|█▊        | 97/553 [00:00<00:00, 482.69it/s]extract the null data:  27%|██▋       | 147/553 [00:00<00:00, 490.12it/s]extract the null data:  36%|███▌      | 197/553 [00:00<00:00, 469.36it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:00, 478.54it/s]extract the null data:  54%|█████▍    | 299/553 [00:00<00:00, 491.26it/s]extract the null data:  64%|██████▎   | 352/553 [00:00<00:00, 501.13it/s]extract the null data:  73%|███████▎  | 403/553 [00:00<00:00, 481.68it/s]extract the null data:  82%|████████▏ | 456/553 [00:00<00:00, 495.14it/s]extract the null data:  92%|█████████▏| 508/553 [00:01<00:00, 502.27it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 491.47it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 14/553 [00:00<00:03, 139.24it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 166.08it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:02, 174.44it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 176.96it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 175.10it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 179.16it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 181.91it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 183.21it/s]replace nan value:  30%|███       | 166/553 [00:00<00:02, 185.88it/s]replace nan value:  33%|███▎      | 185/553 [00:01<00:02, 183.96it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:01, 187.15it/s]replace nan value:  41%|████      | 225/553 [00:01<00:01, 188.92it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 189.62it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 190.06it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 189.75it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 188.86it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 188.87it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 184.61it/s]replace nan value:  65%|██████▌   | 361/553 [00:01<00:01, 170.10it/s]replace nan value:  69%|██████▊   | 379/553 [00:02<00:01, 168.32it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 167.43it/s]replace nan value:  75%|███████▍  | 413/553 [00:02<00:00, 167.51it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 165.39it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 166.27it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 165.95it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 165.74it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 164.01it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 164.16it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 160.60it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 161.94it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 174.10it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.55it/s]  5%|▍         | 27/553 [00:00<00:03, 133.43it/s]  7%|▋         | 41/553 [00:00<00:03, 130.54it/s] 10%|▉         | 55/553 [00:00<00:04, 119.90it/s] 12%|█▏        | 68/553 [00:00<00:04, 108.96it/s] 15%|█▌        | 83/553 [00:00<00:03, 119.26it/s] 17%|█▋        | 96/553 [00:00<00:03, 121.80it/s] 20%|█▉        | 109/553 [00:00<00:03, 123.40it/s] 22%|██▏       | 124/553 [00:01<00:03, 128.11it/s] 25%|██▌       | 139/553 [00:01<00:03, 133.83it/s] 28%|██▊       | 156/553 [00:01<00:02, 143.45it/s] 31%|███       | 172/553 [00:01<00:02, 146.28it/s] 34%|███▍      | 187/553 [00:01<00:02, 140.97it/s] 37%|███▋      | 203/553 [00:01<00:02, 146.15it/s] 39%|███▉      | 218/553 [00:01<00:02, 141.86it/s] 42%|████▏     | 233/553 [00:01<00:02, 134.74it/s] 45%|████▍     | 247/553 [00:01<00:02, 133.66it/s] 47%|████▋     | 262/553 [00:01<00:02, 136.65it/s] 50%|████▉     | 276/553 [00:02<00:02, 128.38it/s] 53%|█████▎    | 291/553 [00:02<00:01, 131.47it/s] 55%|█████▌    | 305/553 [00:02<00:01, 126.38it/s] 58%|█████▊    | 318/553 [00:02<00:01, 118.34it/s] 60%|█████▉    | 331/553 [00:02<00:01, 120.66it/s] 62%|██████▏   | 345/553 [00:02<00:01, 122.44it/s] 65%|██████▍   | 358/553 [00:02<00:01, 121.40it/s] 67%|██████▋   | 373/553 [00:02<00:01, 127.83it/s] 70%|██████▉   | 386/553 [00:03<00:01, 120.67it/s] 72%|███████▏  | 399/553 [00:03<00:01, 110.77it/s] 75%|███████▍  | 414/553 [00:03<00:01, 120.81it/s] 77%|███████▋  | 427/553 [00:03<00:01, 106.89it/s] 80%|███████▉  | 442/553 [00:03<00:00, 117.70it/s] 83%|████████▎ | 458/553 [00:03<00:00, 126.17it/s] 85%|████████▌ | 472/553 [00:03<00:00, 129.76it/s] 88%|████████▊ | 486/553 [00:03<00:00, 126.43it/s] 90%|█████████ | 499/553 [00:03<00:00, 118.68it/s] 93%|█████████▎| 513/553 [00:04<00:00, 124.11it/s] 95%|█████████▌| 526/553 [00:04<00:00, 111.41it/s] 97%|█████████▋| 538/553 [00:04<00:00, 110.33it/s]100%|█████████▉| 551/553 [00:04<00:00, 99.36it/s] 100%|██████████| 553/553 [00:04<00:00, 123.02it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 25/139 [00:00<00:00, 248.32it/s]extract the null data:  55%|█████▍    | 76/139 [00:00<00:00, 401.66it/s]extract the null data:  92%|█████████▏| 128/139 [00:00<00:00, 455.46it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 431.19it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 187.97it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 186.96it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 184.90it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 182.74it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 183.22it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 183.59it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 184.54it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 184.40it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.54it/s] 17%|█▋        | 23/139 [00:00<00:01, 113.52it/s] 27%|██▋       | 37/139 [00:00<00:00, 122.94it/s] 36%|███▌      | 50/139 [00:00<00:00, 120.23it/s] 45%|████▌     | 63/139 [00:00<00:00, 121.01it/s] 55%|█████▌    | 77/139 [00:00<00:00, 122.73it/s] 65%|██████▍   | 90/139 [00:00<00:00, 112.91it/s] 76%|███████▌  | 105/139 [00:00<00:00, 120.79it/s] 88%|████████▊ | 122/139 [00:00<00:00, 130.58it/s] 98%|█████████▊| 136/139 [00:01<00:00, 130.81it/s]100%|██████████| 139/139 [00:01<00:00, 124.80it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 258.87it/s]extract the null data:  46%|████▌     | 79/173 [00:00<00:00, 416.70it/s]extract the null data:  76%|███████▌  | 131/173 [00:00<00:00, 463.26it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 451.69it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|▉         | 17/173 [00:00<00:00, 163.53it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 160.42it/s]replace nan value:  31%|███       | 53/173 [00:00<00:00, 172.53it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 177.62it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 171.69it/s]replace nan value:  64%|██████▍   | 111/173 [00:00<00:00, 178.19it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 181.48it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 181.78it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 161.51it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 162.83it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▍         | 8/173 [00:00<00:02, 78.39it/s] 12%|█▏        | 21/173 [00:00<00:01, 103.90it/s] 20%|█▉        | 34/173 [00:00<00:01, 115.45it/s] 27%|██▋       | 46/173 [00:00<00:01, 102.53it/s] 33%|███▎      | 57/173 [00:00<00:01, 92.20it/s]  39%|███▊      | 67/173 [00:00<00:01, 80.21it/s] 46%|████▌     | 80/173 [00:00<00:01, 91.13it/s] 55%|█████▍    | 95/173 [00:00<00:00, 106.51it/s] 65%|██████▍   | 112/173 [00:01<00:00, 122.29it/s] 72%|███████▏  | 125/173 [00:01<00:00, 120.95it/s] 81%|████████  | 140/173 [00:01<00:00, 127.79it/s] 89%|████████▉ | 154/173 [00:01<00:00, 124.00it/s] 97%|█████████▋| 167/173 [00:01<00:00, 101.22it/s]100%|██████████| 173/173 [00:01<00:00, 103.65it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.213, valid loss : 0.089, train acc : 0.682, valid acc : 0.459, train f1 : 0.670, valid f1 : 0.405
training process:   1%|          | 1/128 [01:17<2:44:48, 77.86s/it]Best score increase :0.000 -> 0.405
training process:   2%|▏         | 2/128 [02:24<2:29:43, 71.30s/it]Best score increase :0.405 -> 0.409
training process:   2%|▏         | 3/128 [03:33<2:25:49, 69.99s/it]EarlyStopping counter : 1 out of 12
training process:   3%|▎         | 4/128 [04:39<2:21:33, 68.50s/it]Best score increase :0.409 -> 0.418
epoch : 5, train loss : 0.084, valid loss : 0.092, train acc : 0.730, valid acc : 0.494, train f1 : 0.711, valid f1 : 0.432
training process:   4%|▍         | 5/128 [05:57<2:27:34, 71.99s/it]Best score increase :0.418 -> 0.432
training process:   5%|▍         | 6/128 [07:08<2:25:30, 71.56s/it]Best score increase :0.432 -> 0.451
training process:   5%|▌         | 7/128 [08:29<2:30:35, 74.67s/it]Best score increase :0.451 -> 0.471
training process:   6%|▋         | 8/128 [09:47<2:31:53, 75.95s/it]Best score increase :0.471 -> 0.472
epoch : 9, train loss : 0.069, valid loss : 0.084, train acc : 0.763, valid acc : 0.581, train f1 : 0.750, valid f1 : 0.492
training process:   7%|▋         | 9/128 [11:24<2:43:44, 82.56s/it]Best score increase :0.472 -> 0.492
training process:   8%|▊         | 10/128 [12:55<2:47:16, 85.05s/it]Best score increase :0.492 -> 0.526
training process:   9%|▊         | 11/128 [14:25<2:48:34, 86.45s/it]Best score increase :0.526 -> 0.531
training process:   9%|▉         | 12/128 [15:44<2:43:11, 84.41s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.061, valid loss : 0.076, train acc : 0.792, valid acc : 0.639, train f1 : 0.784, valid f1 : 0.533
training process:  10%|█         | 13/128 [17:27<2:52:14, 89.86s/it]Best score increase :0.531 -> 0.533
training process:  11%|█         | 14/128 [18:58<2:51:16, 90.15s/it]Best score increase :0.533 -> 0.548
training process:  12%|█▏        | 15/128 [20:23<2:47:16, 88.82s/it]Best score increase :0.548 -> 0.570
training process:  12%|█▎        | 16/128 [21:46<2:42:00, 86.79s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.056, valid loss : 0.061, train acc : 0.813, valid acc : 0.727, train f1 : 0.807, valid f1 : 0.598
training process:  13%|█▎        | 17/128 [23:28<2:49:16, 91.50s/it]Best score increase :0.570 -> 0.598
training process:  14%|█▍        | 18/128 [24:53<2:44:10, 89.55s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [26:20<2:41:12, 88.74s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [27:43<2:36:57, 87.20s/it]Best score increase :0.598 -> 0.615
epoch : 21, train loss : 0.051, valid loss : 0.060, train acc : 0.839, valid acc : 0.758, train f1 : 0.836, valid f1 : 0.623
training process:  16%|█▋        | 21/128 [29:25<2:43:16, 91.56s/it]Best score increase :0.615 -> 0.623
training process:  17%|█▋        | 22/128 [30:39<2:32:21, 86.24s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [31:53<2:24:23, 82.51s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [33:27<2:28:53, 85.90s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.049, valid loss : 0.063, train acc : 0.846, valid acc : 0.751, train f1 : 0.843, valid f1 : 0.617
training process:  20%|█▉        | 25/128 [34:48<2:25:14, 84.61s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [35:52<2:13:21, 78.45s/it]Best score increase :0.623 -> 0.660
training process:  21%|██        | 27/128 [36:59<2:06:11, 74.97s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [38:03<1:59:29, 71.70s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.047, valid loss : 0.054, train acc : 0.861, valid acc : 0.804, train f1 : 0.859, valid f1 : 0.665
training process:  23%|██▎       | 29/128 [39:20<2:01:00, 73.34s/it]Best score increase :0.660 -> 0.665
training process:  23%|██▎       | 30/128 [40:16<1:51:18, 68.15s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [41:13<1:44:27, 64.61s/it]Best score increase :0.665 -> 0.671
training process:  25%|██▌       | 32/128 [42:04<1:36:56, 60.59s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.043, valid loss : 0.057, train acc : 0.872, valid acc : 0.791, train f1 : 0.871, valid f1 : 0.652
training process:  26%|██▌       | 33/128 [43:24<1:45:13, 66.46s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [44:18<1:38:01, 62.57s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [45:12<1:33:19, 60.21s/it]EarlyStopping counter : 4 out of 12
training process:  28%|██▊       | 36/128 [46:05<1:28:59, 58.03s/it]Best score increase :0.671 -> 0.689
epoch : 37, train loss : 0.040, valid loss : 0.053, train acc : 0.879, valid acc : 0.822, train f1 : 0.878, valid f1 : 0.683
training process:  29%|██▉       | 37/128 [47:09<1:30:39, 59.78s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [48:02<1:26:43, 57.82s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [48:56<1:24:05, 56.69s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [49:50<1:21:53, 55.84s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.038, valid loss : 0.055, train acc : 0.890, valid acc : 0.823, train f1 : 0.888, valid f1 : 0.683
training process:  32%|███▏      | 41/128 [50:54<1:24:34, 58.33s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [51:47<1:21:11, 56.65s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [52:42<1:19:34, 56.17s/it]Best score increase :0.689 -> 0.709
training process:  34%|███▍      | 44/128 [53:35<1:17:04, 55.06s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.036, valid loss : 0.054, train acc : 0.897, valid acc : 0.821, train f1 : 0.896, valid f1 : 0.682
training process:  35%|███▌      | 45/128 [54:40<1:20:26, 58.15s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [55:41<1:20:33, 58.94s/it]Best score increase :0.709 -> 0.728
training process:  37%|███▋      | 47/128 [56:35<1:17:32, 57.44s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [57:29<1:15:22, 56.53s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.035, valid loss : 0.049, train acc : 0.902, valid acc : 0.845, train f1 : 0.901, valid f1 : 0.706
training process:  38%|███▊      | 49/128 [58:33<1:17:16, 58.69s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [59:28<1:14:55, 57.64s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [1:00:26<1:13:55, 57.61s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [1:01:25<1:13:30, 58.03s/it]Best score increase :0.728 -> 0.733
epoch : 53, train loss : 0.034, valid loss : 0.044, train acc : 0.906, valid acc : 0.869, train f1 : 0.905, valid f1 : 0.734
training process:  41%|████▏     | 53/128 [1:02:38<1:18:24, 62.73s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [1:03:43<1:17:59, 63.23s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [1:04:50<1:18:14, 64.31s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [1:05:49<1:15:33, 62.97s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.033, valid loss : 0.046, train acc : 0.906, valid acc : 0.868, train f1 : 0.905, valid f1 : 0.733
training process:  45%|████▍     | 57/128 [1:06:59<1:16:58, 65.05s/it]EarlyStopping counter : 5 out of 12
training process:  45%|████▌     | 58/128 [1:08:04<1:15:40, 64.86s/it]Best score increase :0.733 -> 0.739
training process:  46%|████▌     | 59/128 [1:09:15<1:16:46, 66.76s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [1:10:42<1:22:34, 72.85s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.032, valid loss : 0.045, train acc : 0.914, valid acc : 0.871, train f1 : 0.914, valid f1 : 0.737
training process:  48%|████▊     | 61/128 [1:12:17<1:28:56, 79.66s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [1:13:46<1:30:42, 82.46s/it]EarlyStopping counter : 4 out of 12
training process:  49%|████▉     | 63/128 [1:15:18<1:32:19, 85.22s/it]Best score increase :0.739 -> 0.758
training process:  50%|█████     | 64/128 [1:16:44<1:31:14, 85.53s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.030, valid loss : 0.048, train acc : 0.920, valid acc : 0.854, train f1 : 0.919, valid f1 : 0.717
training process:  51%|█████     | 65/128 [1:18:25<1:34:28, 89.98s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 66/128 [1:19:43<1:29:14, 86.36s/it]EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 67/128 [1:20:59<1:24:36, 83.23s/it]EarlyStopping counter : 4 out of 12
training process:  53%|█████▎    | 68/128 [1:22:32<1:26:26, 86.43s/it]EarlyStopping counter : 5 out of 12
epoch : 69, train loss : 0.029, valid loss : 0.044, train acc : 0.921, valid acc : 0.876, train f1 : 0.921, valid f1 : 0.743
training process:  54%|█████▍    | 69/128 [1:23:51<1:22:31, 83.92s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▍    | 70/128 [1:25:00<1:16:49, 79.48s/it]EarlyStopping counter : 7 out of 12
training process:  55%|█████▌    | 71/128 [1:26:05<1:11:24, 75.17s/it]EarlyStopping counter : 8 out of 12
training process:  56%|█████▋    | 72/128 [1:27:13<1:08:05, 72.95s/it]Best score increase :0.758 -> 0.769
epoch : 73, train loss : 0.029, valid loss : 0.044, train acc : 0.925, valid acc : 0.886, train f1 : 0.925, valid f1 : 0.756
training process:  57%|█████▋    | 73/128 [1:28:29<1:07:42, 73.86s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:29:41<1:05:59, 73.32s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:30:48<1:03:05, 71.42s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▉    | 76/128 [1:32:18<1:06:44, 77.01s/it]EarlyStopping counter : 4 out of 12
epoch : 77, train loss : 0.028, valid loss : 0.042, train acc : 0.928, valid acc : 0.898, train f1 : 0.927, valid f1 : 0.772
training process:  60%|██████    | 77/128 [1:33:43<1:07:31, 79.44s/it]Best score increase :0.769 -> 0.772
training process:  61%|██████    | 78/128 [1:34:49<1:02:47, 75.36s/it]EarlyStopping counter : 1 out of 12
training process:  62%|██████▏   | 79/128 [1:35:58<1:00:04, 73.57s/it]EarlyStopping counter : 2 out of 12
training process:  62%|██████▎   | 80/128 [1:37:11<58:38, 73.31s/it]  EarlyStopping counter : 3 out of 12
epoch : 81, train loss : 0.027, valid loss : 0.044, train acc : 0.929, valid acc : 0.887, train f1 : 0.929, valid f1 : 0.756
training process:  63%|██████▎   | 81/128 [1:38:26<57:53, 73.90s/it]EarlyStopping counter : 4 out of 12
training process:  64%|██████▍   | 82/128 [1:39:36<55:48, 72.80s/it]Best score increase :0.772 -> 0.774
training process:  65%|██████▍   | 83/128 [1:40:48<54:21, 72.47s/it]EarlyStopping counter : 1 out of 12
training process:  66%|██████▌   | 84/128 [1:41:55<51:56, 70.83s/it]Best score increase :0.774 -> 0.788
epoch : 85, train loss : 0.027, valid loss : 0.046, train acc : 0.930, valid acc : 0.873, train f1 : 0.930, valid f1 : 0.738
training process:  66%|██████▋   | 85/128 [1:43:11<51:59, 72.54s/it]EarlyStopping counter : 1 out of 12
training process:  67%|██████▋   | 86/128 [1:44:21<50:15, 71.79s/it]EarlyStopping counter : 2 out of 12
training process:  68%|██████▊   | 87/128 [1:45:33<49:01, 71.75s/it]EarlyStopping counter : 3 out of 12
training process:  69%|██████▉   | 88/128 [1:46:37<46:18, 69.46s/it]EarlyStopping counter : 4 out of 12
epoch : 89, train loss : 0.027, valid loss : 0.044, train acc : 0.930, valid acc : 0.892, train f1 : 0.930, valid f1 : 0.762
training process:  70%|██████▉   | 89/128 [1:47:58<47:25, 72.97s/it]EarlyStopping counter : 5 out of 12
training process:  70%|███████   | 90/128 [1:49:09<45:41, 72.14s/it]EarlyStopping counter : 6 out of 12
training process:  71%|███████   | 91/128 [1:50:16<43:38, 70.78s/it]EarlyStopping counter : 7 out of 12
training process:  72%|███████▏  | 92/128 [1:51:24<41:53, 69.82s/it]EarlyStopping counter : 8 out of 12
epoch : 93, train loss : 0.024, valid loss : 0.043, train acc : 0.936, valid acc : 0.904, train f1 : 0.936, valid f1 : 0.780
training process:  73%|███████▎  | 93/128 [1:52:43<42:17, 72.51s/it]EarlyStopping counter : 9 out of 12
training process:  73%|███████▎  | 94/128 [1:53:52<40:37, 71.69s/it]EarlyStopping counter : 10 out of 12
training process:  74%|███████▍  | 95/128 [1:54:56<38:10, 69.41s/it]EarlyStopping counter : 11 out of 12
training process:  74%|███████▍  | 95/128 [1:56:07<40:20, 73.34s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 95, best f1 score : 0.788
training process finished, best loss : 0.041 and best acc : 0.909, best f1 : 0.788, best epoch : 83

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.47      0.92      0.63       580
           1       0.99      0.91      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.73      0.92      0.79      7398
weighted avg       0.95      0.91      0.93      7398


# test acc : 0.91, test f1 : 0.79, test AUC : 0.92, test loss : 2.352

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:49,  9.97s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:43, 10.33s/it]processing for feature importance:  25%|██▌       | 3/12 [00:30<01:33, 10.35s/it]processing for feature importance:  33%|███▎      | 4/12 [00:40<01:19,  9.97s/it]processing for feature importance:  42%|████▏     | 5/12 [00:50<01:10, 10.09s/it]processing for feature importance:  50%|█████     | 6/12 [00:59<00:58,  9.79s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:09<00:49,  9.82s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:18<00:38,  9.65s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:28<00:28,  9.59s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:37<00:18,  9.35s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:45<00:09,  9.15s/it]processing for feature importance: 100%|██████████| 12/12 [01:55<00:00,  9.29s/it]processing for feature importance: 100%|██████████| 12/12 [01:55<00:00,  9.63s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 203.47it/s] 14%|█▍        | 44/306 [00:00<00:01, 213.64it/s] 22%|██▏       | 66/306 [00:00<00:01, 214.35it/s] 29%|██▉       | 88/306 [00:00<00:01, 205.20it/s] 36%|███▋      | 111/306 [00:00<00:00, 211.22it/s] 44%|████▍     | 134/306 [00:00<00:00, 216.81it/s] 52%|█████▏    | 158/306 [00:00<00:00, 215.14it/s] 59%|█████▉    | 182/306 [00:00<00:00, 220.82it/s] 67%|██████▋   | 205/306 [00:01<00:00, 163.71it/s] 73%|███████▎  | 224/306 [00:01<00:00, 169.02it/s] 79%|███████▉  | 243/306 [00:01<00:00, 173.25it/s] 86%|████████▌ | 262/306 [00:01<00:00, 176.73it/s] 92%|█████████▏| 281/306 [00:01<00:00, 180.18it/s] 98%|█████████▊| 300/306 [00:01<00:00, 182.57it/s]100%|██████████| 306/306 [00:01<00:00, 190.56it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 443.71it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 452.84it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:00, 456.46it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 461.03it/s]extract the null data:  42%|████▏     | 232/553 [00:00<00:00, 463.06it/s]extract the null data:  50%|█████     | 279/553 [00:00<00:00, 464.26it/s]extract the null data:  59%|█████▉    | 326/553 [00:00<00:00, 463.03it/s]extract the null data:  67%|██████▋   | 373/553 [00:00<00:00, 464.03it/s]extract the null data:  76%|███████▌  | 420/553 [00:00<00:00, 461.59it/s]extract the null data:  84%|████████▍ | 467/553 [00:01<00:00, 461.00it/s]extract the null data:  93%|█████████▎| 514/553 [00:01<00:00, 463.24it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 461.35it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 162.06it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.31it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:02, 167.65it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 167.87it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 169.54it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 169.46it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 171.17it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 173.88it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:02, 175.72it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:02, 174.43it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:02, 170.62it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:01, 170.82it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:02, 158.34it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 153.81it/s]replace nan value:  48%|████▊     | 265/553 [00:01<00:01, 158.75it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 161.54it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 152.62it/s]replace nan value:  57%|█████▋    | 317/553 [00:01<00:01, 157.77it/s]replace nan value:  60%|██████    | 334/553 [00:02<00:01, 160.39it/s]replace nan value:  63%|██████▎   | 351/553 [00:02<00:01, 161.46it/s]replace nan value:  67%|██████▋   | 368/553 [00:02<00:01, 162.95it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:01, 164.17it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 163.89it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 163.48it/s]replace nan value:  79%|███████▉  | 436/553 [00:02<00:00, 162.63it/s]replace nan value:  82%|████████▏ | 453/553 [00:02<00:00, 163.94it/s]replace nan value:  85%|████████▍ | 470/553 [00:02<00:00, 164.36it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 164.43it/s]replace nan value:  91%|█████████ | 504/553 [00:03<00:00, 164.17it/s]replace nan value:  94%|█████████▍| 521/553 [00:03<00:00, 164.25it/s]replace nan value:  97%|█████████▋| 538/553 [00:03<00:00, 162.78it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 163.89it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 104.81it/s]  4%|▍         | 24/553 [00:00<00:04, 106.82it/s]  6%|▋         | 35/553 [00:00<00:05, 96.09it/s]   8%|▊         | 45/553 [00:00<00:05, 89.52it/s] 10%|█         | 57/553 [00:00<00:05, 96.33it/s] 12%|█▏        | 68/553 [00:00<00:05, 96.65it/s] 15%|█▍        | 82/553 [00:00<00:04, 109.23it/s] 17%|█▋        | 95/553 [00:00<00:03, 114.80it/s] 20%|█▉        | 108/553 [00:01<00:03, 119.06it/s] 22%|██▏       | 122/553 [00:01<00:03, 123.74it/s] 25%|██▍       | 137/553 [00:01<00:03, 130.80it/s] 28%|██▊       | 153/553 [00:01<00:02, 139.11it/s] 31%|███       | 169/553 [00:01<00:02, 144.89it/s] 33%|███▎      | 184/553 [00:01<00:02, 140.54it/s] 36%|███▌      | 199/553 [00:01<00:02, 141.02it/s] 39%|███▉      | 215/553 [00:01<00:02, 143.39it/s] 42%|████▏     | 230/553 [00:01<00:02, 134.82it/s] 44%|████▍     | 244/553 [00:01<00:02, 134.51it/s] 47%|████▋     | 258/553 [00:02<00:02, 135.27it/s] 49%|████▉     | 272/553 [00:02<00:02, 129.47it/s] 52%|█████▏    | 286/553 [00:02<00:02, 132.38it/s] 54%|█████▍    | 300/553 [00:02<00:01, 127.38it/s] 57%|█████▋    | 313/553 [00:02<00:01, 122.21it/s] 59%|█████▉    | 326/553 [00:02<00:01, 122.87it/s] 61%|██████▏   | 340/553 [00:02<00:01, 125.32it/s] 64%|██████▍   | 353/553 [00:02<00:01, 124.57it/s] 66%|██████▌   | 366/553 [00:02<00:01, 119.73it/s] 69%|██████▊   | 380/553 [00:03<00:01, 124.39it/s] 71%|███████   | 393/553 [00:03<00:01, 114.10it/s] 73%|███████▎  | 405/553 [00:03<00:01, 114.74it/s] 75%|███████▌  | 417/553 [00:03<00:01, 113.74it/s] 78%|███████▊  | 429/553 [00:03<00:01, 109.52it/s] 81%|████████  | 446/553 [00:03<00:00, 124.82it/s] 83%|████████▎ | 461/553 [00:03<00:00, 130.64it/s] 86%|████████▌ | 475/553 [00:03<00:00, 125.85it/s] 88%|████████▊ | 488/553 [00:03<00:00, 117.76it/s] 90%|█████████ | 500/553 [00:04<00:00, 92.45it/s]  93%|█████████▎| 515/553 [00:04<00:00, 104.12it/s] 95%|█████████▌| 527/553 [00:04<00:00, 97.21it/s]  97%|█████████▋| 539/553 [00:04<00:00, 101.27it/s]100%|█████████▉| 551/553 [00:04<00:00, 93.01it/s] 100%|██████████| 553/553 [00:04<00:00, 116.99it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 285.54it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 424.30it/s]extract the null data:  96%|█████████▋| 134/139 [00:00<00:00, 465.84it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 443.02it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 186.95it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 186.33it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 184.51it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 185.41it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 186.55it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 187.35it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 179.28it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 181.12it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.88it/s] 17%|█▋        | 24/139 [00:00<00:00, 117.81it/s] 27%|██▋       | 38/139 [00:00<00:00, 126.06it/s] 37%|███▋      | 51/139 [00:00<00:00, 126.76it/s] 47%|████▋     | 66/139 [00:00<00:00, 132.67it/s] 58%|█████▊    | 80/139 [00:00<00:00, 123.78it/s] 67%|██████▋   | 93/139 [00:00<00:00, 116.66it/s] 76%|███████▌  | 105/139 [00:00<00:00, 117.24it/s] 86%|████████▌ | 119/139 [00:00<00:00, 123.15it/s] 95%|█████████▍| 132/139 [00:01<00:00, 111.75it/s]100%|██████████| 139/139 [00:01<00:00, 120.95it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 268.70it/s]extract the null data:  45%|████▌     | 78/173 [00:00<00:00, 406.56it/s]extract the null data:  75%|███████▍  | 129/173 [00:00<00:00, 452.15it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 449.68it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 202.59it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 199.75it/s]replace nan value:  36%|███▌      | 62/173 [00:00<00:00, 196.98it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 191.32it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 188.57it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 184.98it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 185.36it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 185.01it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 187.30it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 129.30it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.51it/s] 26%|██▌       | 45/173 [00:00<00:00, 138.09it/s] 36%|███▌      | 62/173 [00:00<00:00, 139.72it/s] 45%|████▍     | 77/173 [00:00<00:00, 101.36it/s] 53%|█████▎    | 92/173 [00:00<00:00, 111.99it/s] 62%|██████▏   | 107/173 [00:00<00:00, 120.61it/s] 71%|███████   | 122/173 [00:01<00:00, 126.09it/s] 79%|███████▊  | 136/173 [00:01<00:00, 126.38it/s] 87%|████████▋ | 150/173 [00:01<00:00, 126.40it/s] 94%|█████████▍| 163/173 [00:01<00:00, 121.95it/s]100%|██████████| 173/173 [00:01<00:00, 113.48it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.604, valid loss : 0.436, train f1 : 0.538, valid f1 : 0.672
training process - Deferred Re-weighting:   1%|          | 1/128 [01:17<2:45:05, 78.00s/it]Best score increase :0.000 -> 0.672
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:26<2:31:51, 72.31s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:30<2:22:50, 68.56s/it]Best score increase :0.672 -> 0.705
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:39<2:22:03, 68.73s/it]Best score increase :0.705 -> 0.757
epoch : 5, train loss : 0.192, valid loss : 0.163, train f1 : 0.787, valid f1 : 0.761
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:57<2:27:33, 71.98s/it]Best score increase :0.757 -> 0.761
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:01<2:21:17, 69.49s/it]Best score increase :0.761 -> 0.784
training process - Deferred Re-weighting:   5%|▌         | 7/128 [08:06<2:16:56, 67.91s/it]Best score increase :0.784 -> 0.792
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:15<2:16:36, 68.31s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.142, valid loss : 0.147, train f1 : 0.824, valid f1 : 0.803
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:25<2:16:30, 68.83s/it]Best score increase :0.792 -> 0.803
training process - Deferred Re-weighting:   8%|▊         | 10/128 [11:23<2:08:26, 65.31s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [12:11<1:57:34, 60.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:58<1:48:36, 56.18s/it]Best score increase :0.803 -> 0.808
epoch : 13, train loss : 0.124, valid loss : 0.142, train f1 : 0.841, valid f1 : 0.814
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:53<1:46:36, 55.62s/it]Best score increase :0.808 -> 0.814
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:39<1:40:19, 52.80s/it]Best score increase :0.814 -> 0.821
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:26<1:36:01, 50.99s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:12<1:32:38, 49.63s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.114, valid loss : 0.140, train f1 : 0.855, valid f1 : 0.821
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:15<1:39:14, 53.64s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:11<1:39:42, 54.38s/it]Best score increase :0.821 -> 0.823
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:07<1:39:32, 54.80s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:12<1:44:06, 57.84s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.107, valid loss : 0.153, train f1 : 0.866, valid f1 : 0.821
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [21:22<1:49:52, 61.61s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [22:17<1:45:05, 59.49s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [23:12<1:41:44, 58.14s/it]Best score increase :0.823 -> 0.839
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [24:07<1:39:15, 57.27s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.104, valid loss : 0.150, train f1 : 0.868, valid f1 : 0.837
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [25:11<1:41:55, 59.37s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [26:16<1:43:35, 60.94s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [27:14<1:41:06, 60.06s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [28:13<1:39:35, 59.75s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.096, valid loss : 0.136, train f1 : 0.878, valid f1 : 0.847
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [29:16<1:40:07, 60.68s/it]Best score increase :0.839 -> 0.847
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [30:16<1:39:02, 60.63s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [31:12<1:35:38, 59.16s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [32:11<1:34:38, 59.15s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.093, valid loss : 0.174, train f1 : 0.882, valid f1 : 0.822
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [33:20<1:38:03, 61.93s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [34:19<1:35:43, 61.10s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:18<1:33:46, 60.50s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:17<1:32:01, 60.01s/it]EarlyStopping counter : 7 out of 12
epoch : 37, train loss : 0.090, valid loss : 0.132, train f1 : 0.883, valid f1 : 0.854
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [37:26<1:35:03, 62.67s/it]Best score increase :0.847 -> 0.854
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [38:27<1:33:34, 62.39s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [39:27<1:31:26, 61.65s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [40:30<1:30:52, 61.96s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.086, valid loss : 0.141, train f1 : 0.892, valid f1 : 0.858
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [41:40<1:33:34, 64.53s/it]Best score increase :0.854 -> 0.858
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [42:41<1:30:58, 63.47s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [43:43<1:29:07, 62.91s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [44:42<1:26:24, 61.73s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.083, valid loss : 0.153, train f1 : 0.899, valid f1 : 0.849
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [45:55<1:29:51, 64.96s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [47:07<1:31:44, 67.13s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [48:24<1:34:50, 70.26s/it]Best score increase :0.858 -> 0.860
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [49:37<1:34:43, 71.05s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.080, valid loss : 0.163, train f1 : 0.900, valid f1 : 0.851
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [51:06<1:40:34, 76.39s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [52:22<1:39:03, 76.20s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [53:34<1:36:16, 75.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [54:52<1:36:02, 75.83s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.077, valid loss : 0.139, train f1 : 0.902, valid f1 : 0.866
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [56:21<1:39:47, 79.83s/it]Best score increase :0.860 -> 0.866
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [57:36<1:36:39, 78.37s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [58:54<1:35:21, 78.38s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [1:00:14<1:34:29, 78.75s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.074, valid loss : 0.165, train f1 : 0.907, valid f1 : 0.858
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [1:01:42<1:36:23, 81.46s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [1:02:59<1:33:39, 80.28s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:04:11<1:29:26, 77.77s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:05:28<1:27:47, 77.46s/it]EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.073, valid loss : 0.150, train f1 : 0.908, valid f1 : 0.864
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:06:54<1:29:30, 80.16s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:08:12<1:27:19, 79.38s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:09:28<1:24:58, 78.44s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:10:45<1:23:06, 77.91s/it]EarlyStopping counter : 11 out of 12
epoch : 65, train loss : 0.070, valid loss : 0.150, train f1 : 0.911, valid f1 : 0.858
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:12:14<1:12:14, 67.73s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 64, best f1 score : 0.866
training process finished, best loss : 0.139, best acc : 0.965, best f1 : 0.866, best epoch : 52

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.64      0.76       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.82      0.87      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.82, test loss : 8.530

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:11<02:07, 11.55s/it]processing for feature importance:  17%|█▋        | 2/12 [00:23<01:57, 11.78s/it]processing for feature importance:  25%|██▌       | 3/12 [00:34<01:41, 11.28s/it]processing for feature importance:  33%|███▎      | 4/12 [00:45<01:29, 11.20s/it]processing for feature importance:  42%|████▏     | 5/12 [00:55<01:15, 10.81s/it]processing for feature importance:  50%|█████     | 6/12 [01:06<01:06, 11.07s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:17<00:54, 10.85s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:25<00:40, 10.10s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:36<00:30, 10.22s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:46<00:20, 10.26s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:57<00:10, 10.53s/it]processing for feature importance: 100%|██████████| 12/12 [02:08<00:00, 10.52s/it]processing for feature importance: 100%|██████████| 12/12 [02:08<00:00, 10.69s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 23/306 [00:00<00:01, 225.75it/s] 15%|█▌        | 47/306 [00:00<00:01, 233.17it/s] 23%|██▎       | 71/306 [00:00<00:01, 234.78it/s] 31%|███▏      | 96/306 [00:00<00:00, 239.31it/s] 40%|███▉      | 121/306 [00:00<00:00, 240.90it/s] 48%|████▊     | 146/306 [00:00<00:00, 242.28it/s] 56%|█████▌    | 171/306 [00:00<00:00, 243.48it/s] 64%|██████▍   | 196/306 [00:00<00:00, 243.99it/s] 72%|███████▏  | 221/306 [00:00<00:00, 244.45it/s] 80%|████████  | 246/306 [00:01<00:00, 245.09it/s] 89%|████████▊ | 271/306 [00:01<00:00, 244.83it/s] 97%|█████████▋| 296/306 [00:01<00:00, 245.55it/s]100%|██████████| 306/306 [00:01<00:00, 242.48it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 571.49it/s]extract the null data:  21%|██        | 117/553 [00:00<00:00, 582.12it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 588.82it/s]extract the null data:  43%|████▎     | 237/553 [00:00<00:00, 592.32it/s]extract the null data:  54%|█████▎    | 297/553 [00:00<00:00, 593.39it/s]extract the null data:  65%|██████▍   | 357/553 [00:00<00:00, 594.46it/s]extract the null data:  75%|███████▌  | 417/553 [00:00<00:00, 593.44it/s]extract the null data:  86%|████████▋ | 478/553 [00:00<00:00, 595.54it/s]extract the null data:  97%|█████████▋| 538/553 [00:00<00:00, 593.11it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 591.31it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 189.47it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 193.95it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 193.37it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:02, 194.76it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 195.82it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 196.57it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 196.26it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:01, 197.15it/s]replace nan value:  32%|███▏      | 179/553 [00:00<00:01, 196.84it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:01, 197.28it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 191.30it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 192.20it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 190.63it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 192.57it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 194.11it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:01, 195.22it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 196.16it/s]replace nan value:  65%|██████▍   | 359/553 [00:01<00:00, 196.21it/s]replace nan value:  69%|██████▊   | 379/553 [00:01<00:00, 191.80it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 194.34it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 195.71it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 196.48it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 198.07it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 199.50it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 199.72it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 199.42it/s]replace nan value:  98%|█████████▊| 543/553 [00:02<00:00, 193.64it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 195.09it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 139.55it/s]  5%|▌         | 29/553 [00:00<00:03, 144.69it/s]  8%|▊         | 44/553 [00:00<00:03, 133.80it/s] 10%|█         | 58/553 [00:00<00:03, 123.81it/s] 13%|█▎        | 71/553 [00:00<00:03, 122.04it/s] 16%|█▌        | 88/553 [00:00<00:03, 135.55it/s] 18%|█▊        | 102/553 [00:00<00:03, 129.02it/s] 22%|██▏       | 120/553 [00:00<00:03, 142.25it/s] 24%|██▍       | 135/553 [00:01<00:03, 135.75it/s] 28%|██▊       | 153/553 [00:01<00:02, 147.18it/s] 31%|███       | 171/553 [00:01<00:02, 155.10it/s] 34%|███▍      | 187/553 [00:01<00:02, 150.91it/s] 37%|███▋      | 206/553 [00:01<00:02, 160.32it/s] 40%|████      | 223/553 [00:01<00:02, 152.73it/s] 43%|████▎     | 240/553 [00:01<00:02, 155.78it/s] 46%|████▋     | 256/553 [00:01<00:02, 148.35it/s] 49%|████▉     | 271/553 [00:01<00:01, 144.89it/s] 52%|█████▏    | 287/553 [00:01<00:01, 148.87it/s] 55%|█████▍    | 302/553 [00:02<00:01, 143.48it/s] 57%|█████▋    | 317/553 [00:02<00:01, 136.28it/s] 60%|█████▉    | 331/553 [00:02<00:01, 135.40it/s] 63%|██████▎   | 346/553 [00:02<00:01, 138.62it/s] 65%|██████▌   | 360/553 [00:02<00:01, 101.20it/s] 68%|██████▊   | 376/553 [00:02<00:01, 114.19it/s] 70%|███████   | 389/553 [00:02<00:01, 114.29it/s] 73%|███████▎  | 402/553 [00:03<00:01, 112.87it/s] 75%|███████▌  | 416/553 [00:03<00:01, 116.78it/s] 78%|███████▊  | 429/553 [00:03<00:01, 113.81it/s] 81%|████████  | 447/553 [00:03<00:00, 130.89it/s] 84%|████████▎ | 462/553 [00:03<00:00, 135.15it/s] 86%|████████▋ | 477/553 [00:03<00:00, 138.05it/s] 89%|████████▉ | 492/553 [00:03<00:00, 129.33it/s] 92%|█████████▏| 506/553 [00:03<00:00, 127.80it/s] 94%|█████████▍| 521/553 [00:03<00:00, 128.38it/s] 97%|█████████▋| 534/553 [00:04<00:00, 115.02it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.49it/s]100%|██████████| 553/553 [00:04<00:00, 130.33it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 338.23it/s]extract the null data:  68%|██████▊   | 94/139 [00:00<00:00, 440.68it/s]extract the null data:  99%|█████████▉| 138/139 [00:00<00:00, 413.77it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 412.17it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 211.82it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 211.50it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 198.14it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 202.35it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 204.31it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 206.53it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 205.72it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 135.59it/s] 22%|██▏       | 30/139 [00:00<00:00, 144.57it/s] 35%|███▍      | 48/139 [00:00<00:00, 151.27it/s] 46%|████▌     | 64/139 [00:00<00:00, 125.47it/s] 56%|█████▌    | 78/139 [00:00<00:00, 125.94it/s] 65%|██████▌   | 91/139 [00:00<00:00, 120.92it/s] 76%|███████▌  | 105/139 [00:00<00:00, 125.48it/s] 88%|████████▊ | 122/139 [00:00<00:00, 133.74it/s] 98%|█████████▊| 136/139 [00:01<00:00, 133.21it/s]100%|██████████| 139/139 [00:01<00:00, 132.66it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 25/173 [00:00<00:00, 248.13it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 471.52it/s]extract the null data:  87%|████████▋ | 150/173 [00:00<00:00, 536.50it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 505.47it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 197.49it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 197.15it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 198.42it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 196.68it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 197.45it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 197.55it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 196.85it/s]replace nan value:  93%|█████████▎| 161/173 [00:00<00:00, 195.32it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 195.99it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.49it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.43it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.34it/s] 32%|███▏      | 56/173 [00:00<00:00, 129.16it/s] 40%|████      | 70/173 [00:00<00:00, 127.20it/s] 49%|████▊     | 84/173 [00:00<00:00, 126.34it/s] 57%|█████▋    | 98/173 [00:00<00:00, 127.73it/s] 65%|██████▌   | 113/173 [00:00<00:00, 130.40it/s] 73%|███████▎  | 127/173 [00:01<00:00, 123.81it/s] 81%|████████  | 140/173 [00:01<00:00, 123.70it/s] 88%|████████▊ | 153/173 [00:01<00:00, 116.60it/s] 95%|█████████▌| 165/173 [00:01<00:00, 103.80it/s]100%|██████████| 173/173 [00:01<00:00, 112.08it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.561, valid loss : 0.463, train f1 : 0.706, valid f1 : 0.607
training process - Deferred Re-weighting:   1%|          | 1/128 [01:20<2:49:56, 80.28s/it]Best score increase :0.000 -> 0.607
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:17<2:20:13, 66.77s/it]Best score increase :0.607 -> 0.698
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:13<2:08:45, 61.81s/it]Best score increase :0.698 -> 0.744
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:10<2:04:08, 60.07s/it]Best score increase :0.744 -> 0.796
epoch : 5, train loss : 0.338, valid loss : 0.253, train f1 : 0.851, valid f1 : 0.790
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:19<2:09:10, 63.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:17<2:04:40, 61.32s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:25<2:08:26, 63.69s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:31<2:08:41, 64.34s/it]Best score increase :0.796 -> 0.803
epoch : 9, train loss : 0.289, valid loss : 0.215, train f1 : 0.873, valid f1 : 0.805
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:52<2:18:07, 69.64s/it]Best score increase :0.803 -> 0.805
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:58<2:14:44, 68.51s/it]Best score increase :0.805 -> 0.811
training process - Deferred Re-weighting:   9%|▊         | 11/128 [12:05<2:12:49, 68.12s/it]Best score increase :0.811 -> 0.826
training process - Deferred Re-weighting:   9%|▉         | 12/128 [13:08<2:08:34, 66.51s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.256, valid loss : 0.214, train f1 : 0.892, valid f1 : 0.795
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:26<2:13:57, 69.89s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [15:31<2:09:56, 68.39s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [16:42<2:10:17, 69.18s/it]Best score increase :0.826 -> 0.829
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:48<2:07:23, 68.24s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.234, valid loss : 0.181, train f1 : 0.902, valid f1 : 0.820
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [19:09<2:13:05, 71.94s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [20:10<2:06:15, 68.87s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [21:18<2:04:31, 68.55s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [22:26<2:02:49, 68.23s/it]Best score increase :0.829 -> 0.833
epoch : 21, train loss : 0.211, valid loss : 0.184, train f1 : 0.912, valid f1 : 0.826
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [23:46<2:08:12, 71.89s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [24:58<2:06:51, 71.80s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [26:07<2:04:13, 70.99s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [27:13<2:00:31, 69.53s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.198, valid loss : 0.230, train f1 : 0.918, valid f1 : 0.784
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [28:32<2:04:20, 72.43s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [29:42<2:01:43, 71.60s/it]Best score increase :0.833 -> 0.844
training process - Deferred Re-weighting:  21%|██        | 27/128 [30:51<1:59:37, 71.06s/it]Best score increase :0.844 -> 0.847
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [31:57<1:55:41, 69.41s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.184, valid loss : 0.143, train f1 : 0.925, valid f1 : 0.849
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [33:28<2:05:11, 75.88s/it]Best score increase :0.847 -> 0.849
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [34:55<2:09:27, 79.26s/it]Best score increase :0.849 -> 0.853
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [36:14<2:07:45, 79.03s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [37:32<2:06:22, 78.98s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.167, valid loss : 0.179, train f1 : 0.935, valid f1 : 0.813
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [39:10<2:13:45, 84.48s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [40:26<2:08:17, 81.89s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [41:34<2:00:42, 77.88s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [42:45<1:56:11, 75.78s/it]EarlyStopping counter : 6 out of 12
epoch : 37, train loss : 0.157, valid loss : 0.155, train f1 : 0.936, valid f1 : 0.836
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [44:07<1:57:54, 77.74s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [45:23<1:55:36, 77.07s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [46:31<1:50:26, 74.46s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [47:44<1:48:35, 74.04s/it]EarlyStopping counter : 10 out of 12
epoch : 41, train loss : 0.145, valid loss : 0.158, train f1 : 0.943, valid f1 : 0.837
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [49:08<1:51:29, 76.89s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [50:18<1:46:45, 73.63s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 41, best f1 score : 0.853
training process finished, best loss : 0.143, best acc : 0.948, best f1 : 0.853, best epoch : 30

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.81      0.72       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.89      0.85      7398
weighted avg       0.96      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.89, test loss : 8.607

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:12<02:15, 12.28s/it]processing for feature importance:  17%|█▋        | 2/12 [00:24<02:00, 12.04s/it]processing for feature importance:  25%|██▌       | 3/12 [00:35<01:46, 11.88s/it]processing for feature importance:  33%|███▎      | 4/12 [00:47<01:33, 11.66s/it]processing for feature importance:  42%|████▏     | 5/12 [00:57<01:19, 11.35s/it]processing for feature importance:  50%|█████     | 6/12 [01:09<01:07, 11.28s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:20<00:56, 11.36s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:31<00:44, 11.12s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:42<00:33, 11.21s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:53<00:22, 11.16s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:06<00:11, 11.56s/it]processing for feature importance: 100%|██████████| 12/12 [02:16<00:00, 11.22s/it]processing for feature importance: 100%|██████████| 12/12 [02:16<00:00, 11.38s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 17/306 [00:00<00:01, 167.82it/s] 12%|█▏        | 38/306 [00:00<00:01, 192.28it/s] 20%|█▉        | 60/306 [00:00<00:01, 204.68it/s] 27%|██▋       | 82/306 [00:00<00:01, 210.18it/s] 34%|███▍      | 105/306 [00:00<00:00, 214.06it/s] 42%|████▏     | 127/306 [00:00<00:00, 213.19it/s] 49%|████▊     | 149/306 [00:00<00:00, 204.48it/s] 56%|█████▌    | 172/306 [00:00<00:00, 210.69it/s] 63%|██████▎   | 194/306 [00:00<00:00, 211.27it/s] 71%|███████   | 216/306 [00:01<00:00, 213.60it/s] 78%|███████▊  | 239/306 [00:01<00:00, 216.57it/s] 86%|████████▌ | 262/306 [00:01<00:00, 219.60it/s] 93%|█████████▎| 284/306 [00:01<00:00, 218.97it/s]100%|██████████| 306/306 [00:01<00:00, 210.44it/s]100%|██████████| 306/306 [00:01<00:00, 210.50it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 481.63it/s]extract the null data:  18%|█▊        | 99/553 [00:00<00:00, 487.97it/s]extract the null data:  27%|██▋       | 149/553 [00:00<00:00, 492.14it/s]extract the null data:  36%|███▌      | 199/553 [00:00<00:00, 487.57it/s]extract the null data:  45%|████▍     | 248/553 [00:00<00:00, 487.14it/s]extract the null data:  54%|█████▎    | 297/553 [00:00<00:00, 482.33it/s]extract the null data:  63%|██████▎   | 348/553 [00:00<00:00, 488.53it/s]extract the null data:  73%|███████▎  | 401/553 [00:00<00:00, 499.96it/s]extract the null data:  82%|████████▏ | 452/553 [00:00<00:00, 502.95it/s]extract the null data:  91%|█████████ | 503/553 [00:01<00:00, 502.88it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 494.77it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 169.67it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 168.55it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:02, 170.47it/s]replace nan value:  13%|█▎        | 70/553 [00:00<00:02, 170.61it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 172.47it/s]replace nan value:  19%|█▉        | 106/553 [00:00<00:02, 172.09it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 172.61it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 172.61it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 175.61it/s]replace nan value:  32%|███▏      | 179/553 [00:01<00:02, 175.92it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 175.19it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 175.13it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 173.62it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 164.74it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 169.40it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 171.96it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 173.04it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 161.85it/s]replace nan value:  62%|██████▏   | 342/553 [00:02<00:01, 165.49it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 166.98it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:01, 169.78it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 171.39it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 172.16it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 170.53it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 171.71it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 172.33it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 172.58it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 174.13it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 174.56it/s]replace nan value:  98%|█████████▊| 540/553 [00:03<00:00, 174.26it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 171.53it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 9/553 [00:00<00:06, 89.41it/s]  5%|▍         | 25/553 [00:00<00:04, 127.05it/s]  7%|▋         | 40/553 [00:00<00:03, 133.90it/s] 10%|▉         | 54/553 [00:00<00:04, 121.98it/s] 12%|█▏        | 67/553 [00:00<00:04, 104.18it/s] 14%|█▍        | 80/553 [00:00<00:04, 111.39it/s] 17%|█▋        | 94/553 [00:00<00:03, 118.95it/s] 20%|█▉        | 108/553 [00:00<00:03, 124.27it/s] 22%|██▏       | 123/553 [00:01<00:03, 130.24it/s] 25%|██▍       | 138/553 [00:01<00:03, 135.45it/s] 28%|██▊       | 155/553 [00:01<00:02, 145.15it/s] 31%|███       | 171/553 [00:01<00:02, 149.43it/s] 34%|███▍      | 187/553 [00:01<00:02, 145.21it/s] 37%|███▋      | 205/553 [00:01<00:02, 153.70it/s] 40%|███▉      | 221/553 [00:01<00:02, 145.65it/s] 43%|████▎     | 236/553 [00:01<00:02, 146.54it/s] 45%|████▌     | 251/553 [00:01<00:02, 142.76it/s] 48%|████▊     | 266/553 [00:01<00:02, 139.16it/s] 51%|█████     | 280/553 [00:02<00:02, 120.98it/s] 53%|█████▎    | 294/553 [00:02<00:02, 123.98it/s] 56%|█████▌    | 307/553 [00:02<00:02, 120.62it/s] 58%|█████▊    | 320/553 [00:02<00:01, 119.67it/s] 60%|██████    | 334/553 [00:02<00:01, 123.49it/s] 63%|██████▎   | 347/553 [00:02<00:01, 124.57it/s] 65%|██████▌   | 360/553 [00:02<00:01, 115.33it/s] 68%|██████▊   | 376/553 [00:02<00:01, 125.10it/s] 70%|███████   | 389/553 [00:03<00:01, 120.30it/s] 73%|███████▎  | 402/553 [00:03<00:01, 110.53it/s] 75%|███████▌  | 416/553 [00:03<00:01, 114.18it/s] 77%|███████▋  | 428/553 [00:03<00:01, 106.94it/s] 81%|████████  | 446/553 [00:03<00:00, 125.41it/s] 84%|████████▎ | 462/553 [00:03<00:00, 131.99it/s] 86%|████████▋ | 477/553 [00:03<00:00, 135.12it/s] 89%|████████▉ | 491/553 [00:03<00:00, 105.81it/s] 91%|█████████ | 503/553 [00:04<00:00, 108.74it/s] 94%|█████████▍| 519/553 [00:04<00:00, 119.41it/s] 96%|█████████▌| 532/553 [00:04<00:00, 104.99it/s] 99%|█████████▉| 548/553 [00:04<00:00, 117.57it/s]100%|██████████| 553/553 [00:04<00:00, 122.23it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 298.76it/s]extract the null data:  63%|██████▎   | 88/139 [00:00<00:00, 459.70it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 492.98it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 200.22it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 196.95it/s]replace nan value:  45%|████▍     | 62/139 [00:00<00:00, 194.04it/s]replace nan value:  59%|█████▉    | 82/139 [00:00<00:00, 192.34it/s]replace nan value:  73%|███████▎  | 102/139 [00:00<00:00, 172.17it/s]replace nan value:  88%|████████▊ | 122/139 [00:00<00:00, 179.35it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 185.40it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.42it/s] 16%|█▌        | 22/139 [00:00<00:01, 103.65it/s] 26%|██▌       | 36/139 [00:00<00:00, 119.70it/s] 35%|███▌      | 49/139 [00:00<00:00, 121.02it/s] 45%|████▍     | 62/139 [00:00<00:00, 119.32it/s] 54%|█████▍    | 75/139 [00:00<00:00, 120.99it/s] 63%|██████▎   | 88/139 [00:00<00:00, 105.89it/s] 73%|███████▎  | 102/139 [00:00<00:00, 114.09it/s] 82%|████████▏ | 114/139 [00:00<00:00, 114.23it/s] 91%|█████████▏| 127/139 [00:01<00:00, 118.67it/s]100%|██████████| 139/139 [00:01<00:00, 117.42it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 267.12it/s]extract the null data:  49%|████▊     | 84/173 [00:00<00:00, 442.99it/s]extract the null data:  80%|████████  | 139/173 [00:00<00:00, 489.96it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 469.58it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|▉         | 17/173 [00:00<00:01, 154.17it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 158.93it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 174.95it/s]replace nan value:  43%|████▎     | 74/173 [00:00<00:00, 180.95it/s]replace nan value:  54%|█████▍    | 93/173 [00:00<00:00, 173.71it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 178.71it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 181.55it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 184.73it/s]replace nan value:  98%|█████████▊| 170/173 [00:00<00:00, 184.39it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 178.90it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 129.92it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.57it/s] 24%|██▎       | 41/173 [00:00<00:01, 120.73it/s] 32%|███▏      | 55/173 [00:00<00:00, 126.68it/s] 40%|███▉      | 69/173 [00:00<00:00, 127.73it/s] 48%|████▊     | 83/173 [00:00<00:00, 129.63it/s] 56%|█████▌    | 97/173 [00:00<00:00, 127.73it/s] 64%|██████▍   | 111/173 [00:00<00:00, 131.00it/s] 72%|███████▏  | 125/173 [00:01<00:00, 121.71it/s] 80%|███████▉  | 138/173 [00:01<00:00, 118.72it/s] 87%|████████▋ | 151/173 [00:01<00:00, 120.71it/s] 95%|█████████▍| 164/173 [00:01<00:00, 114.89it/s]100%|██████████| 173/173 [00:01<00:00, 113.79it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.071, train acc : 0.735, valid acc : 0.925, train f1 : 0.540, valid f1 : 0.607
training process:   1%|          | 1/128 [01:07<2:23:42, 67.89s/it]Best score increase :0.000 -> 0.607
training process:   2%|▏         | 2/128 [02:03<2:07:18, 60.62s/it]Best score increase :0.607 -> 0.620
training process:   2%|▏         | 3/128 [02:57<1:59:59, 57.60s/it]Best score increase :0.620 -> 0.687
training process:   3%|▎         | 4/128 [03:54<1:58:13, 57.20s/it]Best score increase :0.687 -> 0.742
epoch : 5, train loss : 0.042, valid loss : 0.046, train acc : 0.950, valid acc : 0.943, train f1 : 0.784, valid f1 : 0.741
training process:   4%|▍         | 5/128 [05:12<2:12:58, 64.87s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [06:18<2:12:44, 65.28s/it]Best score increase :0.742 -> 0.768
training process:   5%|▌         | 7/128 [07:21<2:10:23, 64.66s/it]Best score increase :0.768 -> 0.776
training process:   6%|▋         | 8/128 [08:31<2:12:37, 66.31s/it]Best score increase :0.776 -> 0.781
epoch : 9, train loss : 0.037, valid loss : 0.045, train acc : 0.957, valid acc : 0.951, train f1 : 0.822, valid f1 : 0.787
training process:   7%|▋         | 9/128 [09:57<2:23:31, 72.37s/it]Best score increase :0.781 -> 0.787
training process:   8%|▊         | 10/128 [10:55<2:13:39, 67.97s/it]Best score increase :0.787 -> 0.794
training process:   9%|▊         | 11/128 [11:55<2:07:34, 65.42s/it]Best score increase :0.794 -> 0.795
training process:   9%|▉         | 12/128 [12:57<2:04:20, 64.31s/it]Best score increase :0.795 -> 0.801
epoch : 13, train loss : 0.033, valid loss : 0.041, train acc : 0.960, valid acc : 0.954, train f1 : 0.838, valid f1 : 0.811
training process:  10%|█         | 13/128 [14:09<2:07:51, 66.70s/it]Best score increase :0.801 -> 0.811
training process:  11%|█         | 14/128 [15:04<2:00:24, 63.37s/it]Best score increase :0.811 -> 0.815
training process:  12%|█▏        | 15/128 [16:07<1:58:50, 63.10s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [17:08<1:56:41, 62.51s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.031, valid loss : 0.042, train acc : 0.963, valid acc : 0.955, train f1 : 0.852, valid f1 : 0.816
training process:  13%|█▎        | 17/128 [18:18<1:59:38, 64.67s/it]Best score increase :0.815 -> 0.816
training process:  14%|█▍        | 18/128 [19:32<2:03:36, 67.42s/it]Best score increase :0.816 -> 0.820
training process:  15%|█▍        | 19/128 [20:39<2:02:19, 67.34s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [21:42<1:59:07, 66.18s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.029, valid loss : 0.042, train acc : 0.965, valid acc : 0.955, train f1 : 0.862, valid f1 : 0.822
training process:  16%|█▋        | 21/128 [22:59<2:03:44, 69.39s/it]Best score increase :0.820 -> 0.822
training process:  17%|█▋        | 22/128 [24:01<1:58:46, 67.23s/it]Best score increase :0.822 -> 0.827
training process:  18%|█▊        | 23/128 [25:07<1:57:00, 66.87s/it]Best score increase :0.827 -> 0.835
training process:  19%|█▉        | 24/128 [26:12<1:54:39, 66.15s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.029, valid loss : 0.042, train acc : 0.966, valid acc : 0.958, train f1 : 0.867, valid f1 : 0.831
training process:  20%|█▉        | 25/128 [27:27<1:58:26, 69.00s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [28:33<1:55:44, 68.09s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [29:44<1:55:55, 68.87s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [30:50<1:53:29, 68.09s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.027, valid loss : 0.041, train acc : 0.968, valid acc : 0.958, train f1 : 0.876, valid f1 : 0.835
training process:  23%|██▎       | 29/128 [32:05<1:55:31, 70.02s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [33:02<1:48:03, 66.16s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 31/128 [34:00<1:43:01, 63.73s/it]Best score increase :0.835 -> 0.837
training process:  25%|██▌       | 32/128 [34:56<1:38:20, 61.47s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.026, valid loss : 0.049, train acc : 0.968, valid acc : 0.957, train f1 : 0.878, valid f1 : 0.823
training process:  26%|██▌       | 33/128 [36:06<1:41:07, 63.87s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [37:02<1:36:43, 61.74s/it]Best score increase :0.837 -> 0.844
training process:  27%|██▋       | 35/128 [38:03<1:35:18, 61.48s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [39:01<1:32:18, 60.20s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.025, valid loss : 0.040, train acc : 0.969, valid acc : 0.961, train f1 : 0.881, valid f1 : 0.845
training process:  29%|██▉       | 37/128 [40:09<1:34:56, 62.60s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [41:07<1:31:51, 61.24s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [42:05<1:29:23, 60.26s/it]Best score increase :0.844 -> 0.845
training process:  31%|███▏      | 40/128 [43:05<1:28:32, 60.37s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.024, valid loss : 0.040, train acc : 0.970, valid acc : 0.962, train f1 : 0.887, valid f1 : 0.851
training process:  32%|███▏      | 41/128 [44:13<1:30:31, 62.43s/it]Best score increase :0.845 -> 0.851
training process:  33%|███▎      | 42/128 [45:07<1:25:50, 59.89s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [46:04<1:23:46, 59.13s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [47:04<1:23:11, 59.42s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.024, valid loss : 0.045, train acc : 0.971, valid acc : 0.961, train f1 : 0.890, valid f1 : 0.843
training process:  35%|███▌      | 45/128 [48:12<1:25:54, 62.10s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [49:08<1:22:22, 60.27s/it]EarlyStopping counter : 5 out of 12
training process:  37%|███▋      | 47/128 [50:04<1:19:38, 59.00s/it]EarlyStopping counter : 6 out of 12
training process:  38%|███▊      | 48/128 [51:03<1:18:21, 58.76s/it]Best score increase :0.851 -> 0.853
epoch : 49, train loss : 0.023, valid loss : 0.046, train acc : 0.972, valid acc : 0.961, train f1 : 0.893, valid f1 : 0.848
training process:  38%|███▊      | 49/128 [52:14<1:22:13, 62.45s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [53:18<1:21:48, 62.93s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [54:26<1:22:50, 64.55s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [55:33<1:22:39, 65.25s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.022, valid loss : 0.041, train acc : 0.973, valid acc : 0.963, train f1 : 0.896, valid f1 : 0.858
training process:  41%|████▏     | 53/128 [56:50<1:26:02, 68.83s/it]Best score increase :0.853 -> 0.858
training process:  42%|████▏     | 54/128 [57:53<1:22:32, 66.92s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [58:57<1:20:23, 66.08s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [1:00:02<1:19:01, 65.86s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.022, valid loss : 0.047, train acc : 0.973, valid acc : 0.962, train f1 : 0.897, valid f1 : 0.852
training process:  45%|████▍     | 57/128 [1:01:18<1:21:32, 68.90s/it]EarlyStopping counter : 4 out of 12
training process:  45%|████▌     | 58/128 [1:02:26<1:19:56, 68.52s/it]EarlyStopping counter : 5 out of 12
training process:  46%|████▌     | 59/128 [1:03:36<1:19:23, 69.04s/it]EarlyStopping counter : 6 out of 12
training process:  47%|████▋     | 60/128 [1:04:52<1:20:36, 71.13s/it]EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.022, valid loss : 0.043, train acc : 0.973, valid acc : 0.963, train f1 : 0.897, valid f1 : 0.854
training process:  48%|████▊     | 61/128 [1:06:17<1:23:54, 75.15s/it]EarlyStopping counter : 8 out of 12
training process:  48%|████▊     | 62/128 [1:07:24<1:20:17, 72.99s/it]EarlyStopping counter : 9 out of 12
training process:  49%|████▉     | 63/128 [1:08:36<1:18:26, 72.41s/it]EarlyStopping counter : 10 out of 12
training process:  50%|█████     | 64/128 [1:09:45<1:16:09, 71.40s/it]EarlyStopping counter : 11 out of 12
epoch : 65, train loss : 0.021, valid loss : 0.044, train acc : 0.974, valid acc : 0.961, train f1 : 0.902, valid f1 : 0.851
training process:  50%|█████     | 64/128 [1:11:06<1:11:06, 66.67s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 64, best f1 score : 0.859
training process finished, best loss : 0.041 and best acc : 0.963, best f1 : 0.859, best epoch : 58

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.61      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.80      0.86      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.80, test loss : 2.591

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:39,  9.02s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:32,  9.27s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:25,  9.48s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:17,  9.72s/it]processing for feature importance:  42%|████▏     | 5/12 [00:49<01:10, 10.11s/it]processing for feature importance:  50%|█████     | 6/12 [01:00<01:03, 10.53s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:11<00:54, 10.84s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:21<00:41, 10.32s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:31<00:30, 10.21s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:41<00:20, 10.36s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:53<00:10, 10.63s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.50s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.27s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 215.68it/s] 15%|█▌        | 47/306 [00:00<00:01, 233.05it/s] 24%|██▎       | 72/306 [00:00<00:00, 239.46it/s] 31%|███▏      | 96/306 [00:00<00:00, 237.86it/s] 39%|███▉      | 120/306 [00:00<00:00, 234.69it/s] 47%|████▋     | 144/306 [00:00<00:00, 231.40it/s] 55%|█████▍    | 168/306 [00:00<00:00, 232.84it/s] 63%|██████▎   | 194/306 [00:00<00:00, 238.72it/s] 71%|███████   | 218/306 [00:00<00:00, 237.86it/s] 79%|███████▉  | 242/306 [00:01<00:00, 235.91it/s] 87%|████████▋ | 266/306 [00:01<00:00, 232.46it/s] 95%|█████████▍| 290/306 [00:01<00:00, 232.72it/s]100%|██████████| 306/306 [00:01<00:00, 234.14it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 66/553 [00:00<00:00, 650.04it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:00, 647.97it/s]extract the null data:  36%|███▌      | 199/553 [00:00<00:00, 656.43it/s]extract the null data:  48%|████▊     | 265/553 [00:00<00:00, 657.48it/s]extract the null data:  60%|█████▉    | 331/553 [00:00<00:00, 655.59it/s]extract the null data:  72%|███████▏  | 397/553 [00:00<00:00, 655.18it/s]extract the null data:  84%|████████▎ | 463/553 [00:00<00:00, 653.53it/s]extract the null data:  96%|█████████▌| 529/553 [00:00<00:00, 644.79it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 649.67it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 202.45it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:02, 209.80it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:02, 214.64it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 219.66it/s]replace nan value:  20%|██        | 112/553 [00:00<00:01, 223.27it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:01, 225.03it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:01, 228.12it/s]replace nan value:  33%|███▎      | 183/553 [00:00<00:01, 229.42it/s]replace nan value:  37%|███▋      | 207/553 [00:00<00:01, 230.22it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 228.06it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 224.19it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 224.60it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 227.00it/s]replace nan value:  59%|█████▉    | 325/553 [00:01<00:00, 228.40it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:00, 229.73it/s]replace nan value:  67%|██████▋   | 373/553 [00:01<00:00, 230.71it/s]replace nan value:  72%|███████▏  | 397/553 [00:01<00:00, 229.19it/s]replace nan value:  76%|███████▌  | 420/553 [00:01<00:00, 228.70it/s]replace nan value:  80%|████████  | 443/553 [00:01<00:00, 228.92it/s]replace nan value:  84%|████████▍ | 466/553 [00:02<00:00, 226.35it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 222.49it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 222.46it/s]replace nan value:  97%|█████████▋| 535/553 [00:02<00:00, 221.95it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 224.96it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.54it/s]  5%|▌         | 29/553 [00:00<00:03, 140.99it/s]  8%|▊         | 44/553 [00:00<00:03, 128.67it/s] 10%|█         | 57/553 [00:00<00:04, 121.23it/s] 13%|█▎        | 70/553 [00:00<00:04, 113.76it/s] 15%|█▌        | 85/553 [00:00<00:03, 124.03it/s] 18%|█▊        | 98/553 [00:00<00:03, 122.37it/s] 21%|██        | 114/553 [00:00<00:03, 132.34it/s] 23%|██▎       | 128/553 [00:01<00:03, 130.30it/s] 26%|██▋       | 146/553 [00:01<00:02, 144.32it/s] 29%|██▉       | 163/553 [00:01<00:02, 150.10it/s] 33%|███▎      | 180/553 [00:01<00:02, 155.32it/s] 36%|███▌      | 197/553 [00:01<00:02, 155.38it/s] 39%|███▉      | 215/553 [00:01<00:02, 160.21it/s] 42%|████▏     | 232/553 [00:01<00:02, 149.29it/s] 45%|████▍     | 248/553 [00:01<00:02, 151.00it/s] 48%|████▊     | 264/553 [00:01<00:01, 151.18it/s] 51%|█████     | 280/553 [00:01<00:01, 141.78it/s] 53%|█████▎    | 295/553 [00:02<00:01, 138.67it/s] 56%|█████▌    | 309/553 [00:02<00:01, 136.78it/s] 58%|█████▊    | 323/553 [00:02<00:01, 132.66it/s] 61%|██████    | 338/553 [00:02<00:01, 134.52it/s] 64%|██████▎   | 352/553 [00:02<00:01, 129.74it/s] 66%|██████▌   | 366/553 [00:02<00:01, 119.84it/s] 69%|██████▉   | 383/553 [00:02<00:01, 132.34it/s] 72%|███████▏  | 397/553 [00:02<00:01, 120.42it/s] 75%|███████▍  | 414/553 [00:03<00:01, 130.72it/s] 77%|███████▋  | 428/553 [00:03<00:01, 121.49it/s] 81%|████████  | 448/553 [00:03<00:00, 139.29it/s] 84%|████████▍ | 464/553 [00:03<00:00, 144.38it/s] 87%|████████▋ | 479/553 [00:03<00:00, 142.73it/s] 89%|████████▉ | 494/553 [00:03<00:00, 136.76it/s] 92%|█████████▏| 510/553 [00:03<00:00, 141.41it/s] 95%|█████████▍| 525/553 [00:03<00:00, 130.21it/s] 97%|█████████▋| 539/553 [00:03<00:00, 127.06it/s]100%|█████████▉| 552/553 [00:04<00:00, 113.70it/s]100%|██████████| 553/553 [00:04<00:00, 133.77it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  33%|███▎      | 46/139 [00:00<00:00, 459.20it/s]extract the null data:  86%|████████▋ | 120/139 [00:00<00:00, 620.65it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 610.55it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 237.93it/s]replace nan value:  35%|███▌      | 49/139 [00:00<00:00, 239.52it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 242.10it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 240.42it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 243.16it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 242.02it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 132.01it/s] 22%|██▏       | 30/139 [00:00<00:00, 142.86it/s] 35%|███▍      | 48/139 [00:00<00:00, 151.32it/s] 46%|████▌     | 64/139 [00:00<00:00, 147.26it/s] 57%|█████▋    | 79/139 [00:00<00:00, 142.59it/s] 68%|██████▊   | 94/139 [00:00<00:00, 131.96it/s] 78%|███████▊  | 108/139 [00:00<00:00, 133.19it/s] 90%|████████▉ | 125/139 [00:00<00:00, 143.40it/s]100%|██████████| 139/139 [00:00<00:00, 141.94it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 44/173 [00:00<00:00, 437.05it/s]extract the null data:  69%|██████▉   | 120/173 [00:00<00:00, 625.53it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 630.03it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 234.28it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 235.86it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 237.07it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 240.26it/s]replace nan value:  71%|███████   | 122/173 [00:00<00:00, 240.01it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 239.54it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 239.05it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 238.73it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 146.35it/s] 17%|█▋        | 30/173 [00:00<00:01, 131.15it/s] 27%|██▋       | 47/173 [00:00<00:00, 146.00it/s] 36%|███▋      | 63/173 [00:00<00:00, 150.29it/s] 46%|████▌     | 79/173 [00:00<00:00, 147.81it/s] 54%|█████▍    | 94/173 [00:00<00:00, 145.73it/s] 63%|██████▎   | 109/173 [00:00<00:00, 144.25it/s] 72%|███████▏  | 124/173 [00:00<00:00, 138.68it/s] 80%|████████  | 139/173 [00:00<00:00, 139.11it/s] 88%|████████▊ | 153/173 [00:01<00:00, 134.68it/s] 97%|█████████▋| 167/173 [00:01<00:00, 109.10it/s]100%|██████████| 173/173 [00:01<00:00, 127.73it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.137, valid loss : 0.104, train acc : 0.719, valid acc : 0.824, train f1 : 0.718, valid f1 : 0.658
training process:   1%|          | 1/128 [00:52<1:52:05, 52.96s/it]Best score increase :0.000 -> 0.658
training process:   2%|▏         | 2/128 [01:37<1:41:16, 48.23s/it]Best score increase :0.658 -> 0.712
training process:   2%|▏         | 3/128 [02:23<1:38:02, 47.06s/it]Best score increase :0.712 -> 0.771
training process:   3%|▎         | 4/128 [03:08<1:35:35, 46.26s/it]Best score increase :0.771 -> 0.817
epoch : 5, train loss : 0.085, valid loss : 0.063, train acc : 0.858, valid acc : 0.928, train f1 : 0.857, valid f1 : 0.805
training process:   4%|▍         | 5/128 [04:01<1:39:54, 48.73s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [04:47<1:37:16, 47.84s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▌         | 7/128 [05:32<1:34:36, 46.92s/it]EarlyStopping counter : 3 out of 12
training process:   6%|▋         | 8/128 [06:17<1:32:35, 46.30s/it]EarlyStopping counter : 4 out of 12
epoch : 9, train loss : 0.074, valid loss : 0.055, train acc : 0.875, valid acc : 0.932, train f1 : 0.875, valid f1 : 0.817
training process:   7%|▋         | 9/128 [07:12<1:37:15, 49.04s/it]EarlyStopping counter : 5 out of 12
training process:   8%|▊         | 10/128 [08:02<1:37:06, 49.38s/it]Best score increase :0.817 -> 0.826
training process:   9%|▊         | 11/128 [08:50<1:34:57, 48.70s/it]Best score increase :0.826 -> 0.837
training process:   9%|▉         | 12/128 [09:35<1:32:27, 47.82s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.066, valid loss : 0.059, train acc : 0.894, valid acc : 0.921, train f1 : 0.894, valid f1 : 0.800
training process:  10%|█         | 13/128 [10:29<1:35:11, 49.67s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [11:23<1:36:26, 50.76s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [12:16<1:37:11, 51.60s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [13:05<1:34:34, 50.66s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.060, valid loss : 0.049, train acc : 0.904, valid acc : 0.937, train f1 : 0.904, valid f1 : 0.826
training process:  13%|█▎        | 17/128 [14:01<1:36:37, 52.23s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [14:55<1:36:49, 52.81s/it]EarlyStopping counter : 7 out of 12
training process:  15%|█▍        | 19/128 [15:44<1:33:48, 51.64s/it]EarlyStopping counter : 8 out of 12
training process:  16%|█▌        | 20/128 [16:30<1:30:19, 50.18s/it]EarlyStopping counter : 9 out of 12
epoch : 21, train loss : 0.055, valid loss : 0.054, train acc : 0.914, valid acc : 0.929, train f1 : 0.914, valid f1 : 0.816
training process:  16%|█▋        | 21/128 [17:32<1:35:44, 53.69s/it]EarlyStopping counter : 10 out of 12
training process:  17%|█▋        | 22/128 [18:26<1:35:02, 53.80s/it]EarlyStopping counter : 11 out of 12
training process:  17%|█▋        | 22/128 [19:19<1:33:05, 52.70s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 22, best f1 score : 0.837
training process finished, best loss : 0.049 and best acc : 0.943, best f1 : 0.837, best epoch : 10

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.51      0.79      0.62       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.92      7398
   macro avg       0.75      0.86      0.79      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.79, test AUC : 0.86, test loss : 3.159

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.40s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.47s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.39s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.42s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:51,  7.39s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.34s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.32s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:28,  7.25s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:22,  7.42s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:13<00:14,  7.44s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:21<00:07,  7.45s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.34s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.37s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 186.09it/s] 12%|█▏        | 38/306 [00:00<00:01, 164.75it/s] 20%|█▉        | 61/306 [00:00<00:01, 192.20it/s] 27%|██▋       | 84/306 [00:00<00:01, 203.69it/s] 35%|███▍      | 107/306 [00:00<00:00, 212.42it/s] 42%|████▏     | 129/306 [00:00<00:00, 212.97it/s] 50%|████▉     | 152/306 [00:00<00:00, 217.19it/s] 58%|█████▊    | 176/306 [00:00<00:00, 221.20it/s] 65%|██████▌   | 199/306 [00:00<00:00, 222.68it/s] 73%|███████▎  | 222/306 [00:01<00:00, 223.40it/s] 80%|████████  | 246/306 [00:01<00:00, 226.24it/s] 88%|████████▊ | 269/306 [00:01<00:00, 227.13it/s] 95%|█████████▌| 292/306 [00:01<00:00, 227.09it/s]100%|██████████| 306/306 [00:01<00:00, 217.41it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 62/553 [00:00<00:00, 611.26it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:00, 608.38it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 608.84it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:00, 613.20it/s]extract the null data:  56%|█████▌    | 309/553 [00:00<00:00, 610.07it/s]extract the null data:  67%|██████▋   | 371/553 [00:00<00:00, 599.86it/s]extract the null data:  78%|███████▊  | 432/553 [00:00<00:00, 590.56it/s]extract the null data:  89%|████████▉ | 494/553 [00:00<00:00, 597.75it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 599.27it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 188.60it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:03, 159.35it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:03, 161.00it/s]replace nan value:  14%|█▎        | 75/553 [00:00<00:02, 173.21it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:02, 168.00it/s]replace nan value:  20%|██        | 112/553 [00:00<00:02, 174.92it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:02, 180.79it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 183.94it/s]replace nan value:  31%|███       | 172/553 [00:00<00:02, 186.11it/s]replace nan value:  35%|███▍      | 192/553 [00:01<00:01, 188.75it/s]replace nan value:  39%|███▊      | 213/553 [00:01<00:01, 192.07it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 192.66it/s]replace nan value:  46%|████▌     | 253/553 [00:01<00:01, 192.57it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 194.12it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 194.87it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 194.41it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 194.00it/s]replace nan value:  64%|██████▍   | 353/553 [00:01<00:01, 193.79it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:00, 191.58it/s]replace nan value:  71%|███████   | 393/553 [00:02<00:00, 192.45it/s]replace nan value:  75%|███████▍  | 413/553 [00:02<00:00, 194.33it/s]replace nan value:  78%|███████▊  | 433/553 [00:02<00:00, 194.28it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 196.86it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 200.23it/s]replace nan value:  90%|████████▉ | 496/553 [00:02<00:00, 201.77it/s]replace nan value:  93%|█████████▎| 517/553 [00:02<00:00, 203.55it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 200.09it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 190.34it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 126.93it/s]  5%|▍         | 27/553 [00:00<00:03, 134.08it/s]  7%|▋         | 41/553 [00:00<00:03, 130.01it/s] 10%|▉         | 55/553 [00:00<00:04, 117.37it/s] 12%|█▏        | 67/553 [00:00<00:04, 107.19it/s] 14%|█▍        | 80/553 [00:00<00:04, 110.49it/s] 17%|█▋        | 93/553 [00:00<00:04, 114.48it/s] 19%|█▉        | 106/553 [00:00<00:03, 118.67it/s] 22%|██▏       | 120/553 [00:01<00:03, 124.60it/s] 24%|██▍       | 133/553 [00:01<00:03, 120.81it/s] 27%|██▋       | 149/553 [00:01<00:03, 130.61it/s] 29%|██▉       | 163/553 [00:01<00:02, 133.10it/s] 32%|███▏      | 178/553 [00:01<00:02, 134.75it/s] 35%|███▍      | 193/553 [00:01<00:02, 137.75it/s] 38%|███▊      | 210/553 [00:01<00:02, 142.50it/s] 41%|████      | 225/553 [00:01<00:02, 134.63it/s] 43%|████▎     | 239/553 [00:01<00:02, 135.52it/s] 46%|████▌     | 253/553 [00:01<00:02, 129.60it/s] 48%|████▊     | 267/553 [00:02<00:02, 125.67it/s] 51%|█████     | 280/553 [00:02<00:02, 123.21it/s] 53%|█████▎    | 293/553 [00:02<00:02, 121.36it/s] 55%|█████▌    | 306/553 [00:02<00:02, 116.03it/s] 58%|█████▊    | 318/553 [00:02<00:02, 114.74it/s] 60%|█████▉    | 330/553 [00:02<00:01, 116.07it/s] 62%|██████▏   | 344/553 [00:02<00:01, 121.92it/s] 65%|██████▍   | 357/553 [00:02<00:01, 114.67it/s] 67%|██████▋   | 371/553 [00:02<00:01, 121.21it/s] 69%|██████▉   | 384/553 [00:03<00:01, 119.18it/s] 72%|███████▏  | 397/553 [00:03<00:01, 103.66it/s] 75%|███████▍  | 412/553 [00:03<00:01, 113.82it/s] 77%|███████▋  | 424/553 [00:03<00:01, 103.72it/s] 79%|███████▉  | 436/553 [00:03<00:01, 106.24it/s] 82%|████████▏ | 452/553 [00:03<00:00, 119.47it/s] 84%|████████▍ | 465/553 [00:03<00:00, 121.36it/s] 86%|████████▋ | 478/553 [00:03<00:00, 120.36it/s] 89%|████████▉ | 491/553 [00:04<00:00, 116.19it/s] 91%|█████████ | 503/553 [00:04<00:00, 113.69it/s] 93%|█████████▎| 517/553 [00:04<00:00, 118.95it/s] 96%|█████████▌| 529/553 [00:04<00:00, 103.99it/s] 98%|█████████▊| 540/553 [00:04<00:00, 105.54it/s]100%|█████████▉| 551/553 [00:04<00:00, 93.32it/s] 100%|██████████| 553/553 [00:04<00:00, 117.52it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  40%|███▉      | 55/139 [00:00<00:00, 548.56it/s]extract the null data:  91%|█████████▏| 127/139 [00:00<00:00, 646.34it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 638.64it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 240.33it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 240.70it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 238.91it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 238.48it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 241.07it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 239.57it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 130.26it/s] 21%|██        | 29/139 [00:00<00:00, 141.25it/s] 33%|███▎      | 46/139 [00:00<00:00, 153.49it/s] 45%|████▍     | 62/139 [00:00<00:00, 141.69it/s] 55%|█████▌    | 77/139 [00:00<00:00, 141.01it/s] 66%|██████▌   | 92/139 [00:00<00:00, 130.45it/s] 76%|███████▋  | 106/139 [00:00<00:00, 129.63it/s] 88%|████████▊ | 122/139 [00:00<00:00, 136.95it/s] 98%|█████████▊| 136/139 [00:00<00:00, 136.52it/s]100%|██████████| 139/139 [00:01<00:00, 138.23it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  34%|███▎      | 58/173 [00:00<00:00, 578.32it/s]extract the null data:  74%|███████▍  | 128/173 [00:00<00:00, 647.33it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 644.18it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 231.66it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 234.85it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 236.35it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 232.70it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 229.59it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 228.55it/s]replace nan value:  96%|█████████▌| 166/173 [00:00<00:00, 227.18it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 230.06it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 142.60it/s] 17%|█▋        | 30/173 [00:00<00:01, 128.08it/s] 27%|██▋       | 46/173 [00:00<00:00, 140.72it/s] 36%|███▌      | 62/173 [00:00<00:00, 146.88it/s] 45%|████▍     | 77/173 [00:00<00:00, 144.23it/s] 53%|█████▎    | 92/173 [00:00<00:00, 143.33it/s] 62%|██████▏   | 107/173 [00:00<00:00, 142.84it/s] 71%|███████   | 122/173 [00:00<00:00, 140.52it/s] 79%|███████▉  | 137/173 [00:00<00:00, 137.87it/s] 87%|████████▋ | 151/173 [00:01<00:00, 133.69it/s] 95%|█████████▌| 165/173 [00:01<00:00, 121.82it/s]100%|██████████| 173/173 [00:01<00:00, 124.57it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.022, valid loss : 0.019, train acc : 0.551, valid acc : 0.753, train f1 : 0.457, valid f1 : 0.595
training process:   1%|          | 1/128 [01:04<2:15:58, 64.24s/it]Best score increase :0.000 -> 0.595
training process:   2%|▏         | 2/128 [01:55<1:58:23, 56.37s/it]Best score increase :0.595 -> 0.738
training process:   2%|▏         | 3/128 [02:44<1:50:42, 53.14s/it]Best score increase :0.738 -> 0.777
training process:   3%|▎         | 4/128 [03:37<1:49:55, 53.19s/it]Best score increase :0.777 -> 0.794
epoch : 5, train loss : 0.014, valid loss : 0.016, train acc : 0.871, valid acc : 0.936, train f1 : 0.711, valid f1 : 0.800
training process:   4%|▍         | 5/128 [04:34<1:51:41, 54.48s/it]Best score increase :0.794 -> 0.800
training process:   5%|▍         | 6/128 [05:22<1:46:25, 52.34s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:15<1:46:03, 52.59s/it]Best score increase :0.800 -> 0.823
training process:   6%|▋         | 8/128 [07:07<1:44:41, 52.34s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.013, valid loss : 0.015, train acc : 0.902, valid acc : 0.945, train f1 : 0.753, valid f1 : 0.828
training process:   7%|▋         | 9/128 [08:05<1:46:59, 53.94s/it]Best score increase :0.823 -> 0.828
training process:   8%|▊         | 10/128 [08:49<1:40:34, 51.14s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:34<1:36:04, 49.27s/it]Best score increase :0.828 -> 0.833
training process:   9%|▉         | 12/128 [10:20<1:32:54, 48.05s/it]Best score increase :0.833 -> 0.835
epoch : 13, train loss : 0.012, valid loss : 0.014, train acc : 0.914, valid acc : 0.944, train f1 : 0.777, valid f1 : 0.829
training process:  10%|█         | 13/128 [11:14<1:35:34, 49.87s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [11:59<1:32:03, 48.46s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [12:44<1:29:25, 47.48s/it]Best score increase :0.835 -> 0.837
training process:  12%|█▎        | 16/128 [13:29<1:27:26, 46.84s/it]Best score increase :0.837 -> 0.842
epoch : 17, train loss : 0.011, valid loss : 0.015, train acc : 0.926, valid acc : 0.949, train f1 : 0.799, valid f1 : 0.839
training process:  13%|█▎        | 17/128 [14:31<1:35:02, 51.37s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:23<1:34:05, 51.32s/it]Best score increase :0.842 -> 0.848
training process:  15%|█▍        | 19/128 [16:15<1:33:49, 51.65s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [17:05<1:32:16, 51.26s/it]Best score increase :0.848 -> 0.850
epoch : 21, train loss : 0.010, valid loss : 0.015, train acc : 0.933, valid acc : 0.952, train f1 : 0.814, valid f1 : 0.847
training process:  16%|█▋        | 21/128 [17:57<1:31:50, 51.50s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [18:42<1:27:11, 49.35s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [19:26<1:23:38, 47.79s/it]Best score increase :0.850 -> 0.853
training process:  19%|█▉        | 24/128 [20:10<1:21:09, 46.82s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.010, valid loss : 0.015, train acc : 0.938, valid acc : 0.955, train f1 : 0.822, valid f1 : 0.856
training process:  20%|█▉        | 25/128 [21:13<1:28:42, 51.67s/it]Best score increase :0.853 -> 0.856
training process:  20%|██        | 26/128 [22:00<1:25:21, 50.21s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [22:46<1:22:16, 48.88s/it]Best score increase :0.856 -> 0.859
training process:  22%|██▏       | 28/128 [23:34<1:20:53, 48.54s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.010, valid loss : 0.015, train acc : 0.943, valid acc : 0.955, train f1 : 0.834, valid f1 : 0.856
training process:  23%|██▎       | 29/128 [24:27<1:22:13, 49.83s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [25:12<1:19:10, 48.48s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [25:57<1:16:42, 47.45s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [26:44<1:15:33, 47.22s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.009, valid loss : 0.019, train acc : 0.945, valid acc : 0.957, train f1 : 0.840, valid f1 : 0.849
training process:  26%|██▌       | 33/128 [27:38<1:18:21, 49.49s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [28:25<1:16:03, 48.55s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [29:10<1:13:47, 47.60s/it]EarlyStopping counter : 8 out of 12
training process:  28%|██▊       | 36/128 [29:56<1:12:01, 46.97s/it]EarlyStopping counter : 9 out of 12
epoch : 37, train loss : 0.009, valid loss : 0.016, train acc : 0.946, valid acc : 0.959, train f1 : 0.844, valid f1 : 0.866
training process:  29%|██▉       | 37/128 [30:51<1:14:59, 49.44s/it]Best score increase :0.859 -> 0.866
training process:  30%|██▉       | 38/128 [31:36<1:12:23, 48.26s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [32:21<1:09:50, 47.08s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [33:06<1:08:20, 46.59s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.009, valid loss : 0.015, train acc : 0.947, valid acc : 0.949, train f1 : 0.847, valid f1 : 0.850
training process:  32%|███▏      | 41/128 [34:00<1:10:36, 48.70s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [34:46<1:08:31, 47.81s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [35:32<1:07:02, 47.32s/it]Best score increase :0.866 -> 0.869
training process:  34%|███▍      | 44/128 [36:17<1:05:23, 46.71s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.019, train acc : 0.953, valid acc : 0.956, train f1 : 0.858, valid f1 : 0.853
training process:  35%|███▌      | 45/128 [37:10<1:07:21, 48.69s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [37:55<1:05:03, 47.60s/it]EarlyStopping counter : 3 out of 12
training process:  37%|███▋      | 47/128 [38:39<1:02:47, 46.51s/it]EarlyStopping counter : 4 out of 12
training process:  38%|███▊      | 48/128 [39:33<1:04:53, 48.67s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.008, valid loss : 0.020, train acc : 0.953, valid acc : 0.956, train f1 : 0.861, valid f1 : 0.853
training process:  38%|███▊      | 49/128 [40:34<1:08:54, 52.34s/it]EarlyStopping counter : 6 out of 12
training process:  39%|███▉      | 50/128 [41:27<1:08:25, 52.64s/it]EarlyStopping counter : 7 out of 12
training process:  40%|███▉      | 51/128 [42:21<1:08:08, 53.09s/it]EarlyStopping counter : 8 out of 12
training process:  41%|████      | 52/128 [43:15<1:07:19, 53.15s/it]EarlyStopping counter : 9 out of 12
epoch : 53, train loss : 0.008, valid loss : 0.017, train acc : 0.955, valid acc : 0.961, train f1 : 0.864, valid f1 : 0.872
training process:  41%|████▏     | 53/128 [44:19<1:10:33, 56.44s/it]Best score increase :0.869 -> 0.872
training process:  42%|████▏     | 54/128 [45:12<1:08:14, 55.33s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [46:05<1:06:45, 54.87s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [47:13<1:10:18, 58.59s/it]Best score increase :0.872 -> 0.873
epoch : 57, train loss : 0.008, valid loss : 0.019, train acc : 0.956, valid acc : 0.963, train f1 : 0.867, valid f1 : 0.876
training process:  45%|████▍     | 57/128 [48:26<1:14:43, 63.14s/it]Best score increase :0.873 -> 0.876
training process:  45%|████▌     | 58/128 [49:32<1:14:25, 63.80s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [50:43<1:15:59, 66.07s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [51:55<1:16:49, 67.78s/it]EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.008, valid loss : 0.020, train acc : 0.957, valid acc : 0.961, train f1 : 0.871, valid f1 : 0.871
training process:  48%|████▊     | 61/128 [52:58<1:14:00, 66.28s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [54:02<1:12:17, 65.72s/it]EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [55:07<1:10:50, 65.40s/it]EarlyStopping counter : 6 out of 12
training process:  50%|█████     | 64/128 [56:16<1:11:03, 66.62s/it]EarlyStopping counter : 7 out of 12
epoch : 65, train loss : 0.008, valid loss : 0.019, train acc : 0.957, valid acc : 0.961, train f1 : 0.870, valid f1 : 0.867
training process:  51%|█████     | 65/128 [57:36<1:14:01, 70.49s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 66/128 [58:48<1:13:27, 71.08s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 67/128 [59:55<1:11:04, 69.92s/it]EarlyStopping counter : 10 out of 12
training process:  53%|█████▎    | 68/128 [1:01:04<1:09:27, 69.46s/it]EarlyStopping counter : 11 out of 12
epoch : 69, train loss : 0.008, valid loss : 0.019, train acc : 0.961, valid acc : 0.962, train f1 : 0.879, valid f1 : 0.875
training process:  53%|█████▎    | 68/128 [1:02:31<55:10, 55.17s/it]  
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 68, best f1 score : 0.876
training process finished, best loss : 0.019 and best acc : 0.963, best f1 : 0.876, best epoch : 56

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.80      0.72      0.76       580
           1       0.98      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.89      0.85      0.87      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.87, test AUC : 0.85, test loss : 1.262

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:31,  8.33s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:19,  8.00s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:13,  8.21s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:07,  8.39s/it]processing for feature importance:  42%|████▏     | 5/12 [00:42<00:59,  8.55s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:52,  8.70s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:59<00:42,  8.58s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:33,  8.41s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:15<00:24,  8.19s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:23<00:16,  8.33s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:31<00:08,  8.23s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.41s/it]processing for feature importance: 100%|██████████| 12/12 [01:40<00:00,  8.38s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 212.48it/s] 16%|█▌        | 49/306 [00:00<00:01, 243.85it/s] 26%|██▌       | 79/306 [00:00<00:00, 265.25it/s] 35%|███▌      | 108/306 [00:00<00:00, 273.14it/s] 45%|████▍     | 137/306 [00:00<00:00, 278.95it/s] 54%|█████▍    | 166/306 [00:00<00:00, 280.73it/s] 64%|██████▎   | 195/306 [00:00<00:00, 281.60it/s] 74%|███████▎  | 225/306 [00:00<00:00, 286.10it/s] 83%|████████▎ | 254/306 [00:00<00:00, 285.55it/s] 92%|█████████▏| 283/306 [00:01<00:00, 281.01it/s]100%|██████████| 306/306 [00:01<00:00, 277.55it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:01, 500.68it/s]extract the null data:  19%|█▊        | 103/553 [00:00<00:00, 509.68it/s]extract the null data:  28%|██▊       | 156/553 [00:00<00:00, 516.86it/s]extract the null data:  38%|███▊      | 208/553 [00:00<00:00, 515.38it/s]extract the null data:  47%|████▋     | 260/553 [00:00<00:00, 511.59it/s]extract the null data:  57%|█████▋    | 314/553 [00:00<00:00, 519.90it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 519.14it/s]extract the null data:  76%|███████▌  | 419/553 [00:00<00:00, 520.75it/s]extract the null data:  85%|████████▌ | 472/553 [00:00<00:00, 515.33it/s]extract the null data:  95%|█████████▍| 524/553 [00:01<00:00, 513.33it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 514.37it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 173.10it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:02, 181.16it/s]replace nan value:  10%|█         | 56/553 [00:00<00:02, 180.28it/s]replace nan value:  14%|█▎        | 75/553 [00:00<00:02, 180.08it/s]replace nan value:  17%|█▋        | 94/553 [00:00<00:02, 180.18it/s]replace nan value:  20%|██        | 113/553 [00:00<00:02, 181.09it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:02, 181.72it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 185.22it/s]replace nan value:  31%|███       | 171/553 [00:00<00:02, 185.98it/s]replace nan value:  34%|███▍      | 190/553 [00:01<00:01, 186.04it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 186.47it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 186.04it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 186.77it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 187.39it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 188.83it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 189.57it/s]replace nan value:  59%|█████▉    | 325/553 [00:01<00:01, 188.12it/s]replace nan value:  62%|██████▏   | 345/553 [00:01<00:01, 188.76it/s]replace nan value:  66%|██████▌   | 365/553 [00:01<00:00, 189.35it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 189.74it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 188.53it/s]replace nan value:  77%|███████▋  | 424/553 [00:02<00:00, 188.96it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 190.45it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 191.31it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 190.37it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 188.60it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 188.82it/s]replace nan value:  98%|█████████▊| 542/553 [00:02<00:00, 185.11it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 186.34it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 133.20it/s]  5%|▌         | 29/553 [00:00<00:03, 140.72it/s]  8%|▊         | 44/553 [00:00<00:03, 131.13it/s] 10%|█         | 58/553 [00:00<00:04, 122.48it/s] 13%|█▎        | 71/553 [00:00<00:03, 121.22it/s] 16%|█▌        | 88/553 [00:00<00:03, 134.53it/s] 18%|█▊        | 102/553 [00:00<00:03, 129.53it/s] 22%|██▏       | 120/553 [00:00<00:03, 143.41it/s] 24%|██▍       | 135/553 [00:00<00:02, 144.35it/s] 28%|██▊       | 154/553 [00:01<00:02, 156.62it/s] 31%|███       | 172/553 [00:01<00:02, 163.04it/s] 34%|███▍      | 189/553 [00:01<00:02, 158.56it/s] 38%|███▊      | 208/553 [00:01<00:02, 165.90it/s] 41%|████      | 225/553 [00:01<00:02, 153.99it/s] 44%|████▎     | 241/553 [00:01<00:02, 153.43it/s] 46%|████▋     | 257/553 [00:01<00:01, 148.12it/s] 49%|████▉     | 272/553 [00:01<00:01, 143.21it/s] 52%|█████▏    | 289/553 [00:01<00:01, 148.40it/s] 55%|█████▍    | 304/553 [00:02<00:01, 139.95it/s] 58%|█████▊    | 319/553 [00:02<00:01, 131.08it/s] 60%|██████    | 333/553 [00:02<00:01, 133.02it/s] 63%|██████▎   | 348/553 [00:02<00:01, 134.62it/s] 65%|██████▌   | 362/553 [00:02<00:01, 129.61it/s] 68%|██████▊   | 377/553 [00:02<00:01, 132.65it/s] 71%|███████   | 391/553 [00:02<00:01, 120.91it/s] 73%|███████▎  | 404/553 [00:02<00:01, 121.08it/s] 75%|███████▌  | 417/553 [00:03<00:01, 118.98it/s] 78%|███████▊  | 430/553 [00:03<00:01, 114.66it/s] 81%|████████  | 448/553 [00:03<00:00, 129.10it/s] 84%|████████▎ | 463/553 [00:03<00:00, 130.96it/s] 86%|████████▋ | 477/553 [00:03<00:00, 132.22it/s] 89%|████████▉ | 491/553 [00:03<00:00, 122.07it/s] 91%|█████████ | 504/553 [00:03<00:00, 120.77it/s] 94%|█████████▍| 519/553 [00:03<00:00, 126.26it/s] 96%|█████████▌| 532/553 [00:04<00:00, 107.01it/s] 99%|█████████▉| 548/553 [00:04<00:00, 118.50it/s]100%|██████████| 553/553 [00:04<00:00, 130.98it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 31/139 [00:00<00:00, 306.47it/s]extract the null data:  63%|██████▎   | 88/139 [00:00<00:00, 459.19it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 476.38it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 194.61it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 197.65it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 194.97it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 194.20it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 194.53it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 193.09it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.86it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.89it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.13it/s] 29%|██▉       | 41/139 [00:00<00:00, 135.94it/s] 40%|███▉      | 55/139 [00:00<00:00, 125.73it/s] 50%|████▉     | 69/139 [00:00<00:00, 129.66it/s] 60%|█████▉    | 83/139 [00:00<00:00, 123.49it/s] 69%|██████▉   | 96/139 [00:00<00:00, 117.32it/s] 78%|███████▊  | 108/139 [00:00<00:00, 116.40it/s] 89%|████████▉ | 124/139 [00:00<00:00, 125.84it/s] 99%|█████████▊| 137/139 [00:01<00:00, 124.14it/s]100%|██████████| 139/139 [00:01<00:00, 124.46it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 378.34it/s]extract the null data:  57%|█████▋    | 99/173 [00:00<00:00, 510.34it/s]extract the null data:  91%|█████████ | 157/173 [00:00<00:00, 539.57it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 519.63it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 189.94it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 188.80it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 193.62it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 193.37it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 193.46it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 191.97it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 190.81it/s]replace nan value:  91%|█████████▏| 158/173 [00:00<00:00, 186.34it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 188.40it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.90it/s] 16%|█▌        | 27/173 [00:00<00:01, 112.29it/s] 24%|██▎       | 41/173 [00:00<00:01, 123.58it/s] 32%|███▏      | 56/173 [00:00<00:00, 131.73it/s] 40%|████      | 70/173 [00:00<00:00, 131.58it/s] 49%|████▊     | 84/173 [00:00<00:00, 131.48it/s] 57%|█████▋    | 98/173 [00:00<00:00, 132.64it/s] 65%|██████▌   | 113/173 [00:00<00:00, 135.76it/s] 73%|███████▎  | 127/173 [00:00<00:00, 130.15it/s] 82%|████████▏ | 141/173 [00:01<00:00, 129.86it/s] 90%|████████▉ | 155/173 [00:01<00:00, 118.89it/s] 97%|█████████▋| 168/173 [00:01<00:00, 97.01it/s] 100%|██████████| 173/173 [00:01<00:00, 114.66it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.040, valid loss : 0.030, train acc : 0.632, valid acc : 0.320, train f1 : 0.594, valid f1 : 0.303
training process:   1%|          | 1/128 [00:58<2:04:19, 58.74s/it]Best score increase :0.000 -> 0.303
training process:   2%|▏         | 2/128 [01:48<1:52:08, 53.40s/it]Best score increase :0.303 -> 0.331
training process:   2%|▏         | 3/128 [02:38<1:48:09, 51.91s/it]Best score increase :0.331 -> 0.387
training process:   3%|▎         | 4/128 [03:31<1:47:56, 52.23s/it]Best score increase :0.387 -> 0.435
epoch : 5, train loss : 0.021, valid loss : 0.022, train acc : 0.721, valid acc : 0.517, train f1 : 0.700, valid f1 : 0.448
training process:   4%|▍         | 5/128 [04:31<1:53:01, 55.13s/it]Best score increase :0.435 -> 0.448
training process:   5%|▍         | 6/128 [05:23<1:49:47, 53.99s/it]Best score increase :0.448 -> 0.487
training process:   5%|▌         | 7/128 [06:16<1:48:19, 53.71s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:04<1:43:44, 51.87s/it]Best score increase :0.487 -> 0.494
epoch : 9, train loss : 0.018, valid loss : 0.020, train acc : 0.776, valid acc : 0.615, train f1 : 0.764, valid f1 : 0.516
training process:   7%|▋         | 9/128 [08:06<1:49:22, 55.14s/it]Best score increase :0.494 -> 0.516
training process:   8%|▊         | 10/128 [08:59<1:47:16, 54.55s/it]Best score increase :0.516 -> 0.570
training process:   9%|▊         | 11/128 [09:47<1:41:58, 52.30s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:46<1:45:03, 54.34s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.016, valid loss : 0.020, train acc : 0.804, valid acc : 0.649, train f1 : 0.797, valid f1 : 0.540
training process:  10%|█         | 13/128 [11:45<1:47:12, 55.94s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [12:31<1:40:29, 52.89s/it]Best score increase :0.570 -> 0.587
training process:  12%|█▏        | 15/128 [13:22<1:38:39, 52.39s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [14:13<1:37:03, 51.99s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.015, valid loss : 0.016, train acc : 0.822, valid acc : 0.739, train f1 : 0.817, valid f1 : 0.608
training process:  13%|█▎        | 17/128 [15:11<1:39:05, 53.56s/it]Best score increase :0.587 -> 0.608
training process:  14%|█▍        | 18/128 [15:58<1:34:34, 51.58s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:45<1:31:36, 50.43s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:35<1:30:07, 50.07s/it]Best score increase :0.608 -> 0.619
epoch : 21, train loss : 0.013, valid loss : 0.017, train acc : 0.850, valid acc : 0.750, train f1 : 0.847, valid f1 : 0.618
training process:  16%|█▋        | 21/128 [18:33<1:33:59, 52.71s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [19:21<1:30:26, 51.19s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [20:13<1:29:44, 51.28s/it]Best score increase :0.619 -> 0.628
training process:  19%|█▉        | 24/128 [21:06<1:30:10, 52.02s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.013, valid loss : 0.017, train acc : 0.857, valid acc : 0.744, train f1 : 0.854, valid f1 : 0.614
training process:  20%|█▉        | 25/128 [22:07<1:33:37, 54.53s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [22:57<1:30:35, 53.29s/it]Best score increase :0.628 -> 0.674
training process:  21%|██        | 27/128 [23:55<1:32:06, 54.72s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [24:44<1:28:02, 52.83s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.012, valid loss : 0.014, train acc : 0.870, valid acc : 0.802, train f1 : 0.868, valid f1 : 0.664
training process:  23%|██▎       | 29/128 [25:47<1:32:30, 56.06s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [26:45<1:32:20, 56.53s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [27:34<1:27:42, 54.25s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [28:34<1:29:29, 55.93s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.011, valid loss : 0.015, train acc : 0.881, valid acc : 0.802, train f1 : 0.879, valid f1 : 0.663
training process:  26%|██▌       | 33/128 [29:46<1:36:23, 60.88s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [30:38<1:31:18, 58.28s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [31:42<1:32:53, 59.93s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [32:32<1:27:11, 56.87s/it]Best score increase :0.674 -> 0.687
epoch : 37, train loss : 0.010, valid loss : 0.014, train acc : 0.890, valid acc : 0.835, train f1 : 0.889, valid f1 : 0.697
training process:  29%|██▉       | 37/128 [33:32<1:27:54, 57.96s/it]Best score increase :0.687 -> 0.697
training process:  30%|██▉       | 38/128 [34:37<1:29:51, 59.91s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [35:26<1:24:04, 56.68s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [36:34<1:28:20, 60.24s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.015, train acc : 0.898, valid acc : 0.829, train f1 : 0.897, valid f1 : 0.689
training process:  32%|███▏      | 41/128 [37:37<1:28:30, 61.04s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [38:41<1:28:50, 61.98s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [39:32<1:22:53, 58.51s/it]Best score increase :0.697 -> 0.701
training process:  34%|███▍      | 44/128 [40:41<1:26:20, 61.67s/it]Best score increase :0.701 -> 0.702
epoch : 45, train loss : 0.009, valid loss : 0.014, train acc : 0.905, valid acc : 0.825, train f1 : 0.904, valid f1 : 0.687
training process:  35%|███▌      | 45/128 [41:38<1:23:22, 60.27s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [42:50<1:27:23, 63.95s/it]Best score increase :0.702 -> 0.727
training process:  37%|███▋      | 47/128 [43:49<1:23:58, 62.21s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [44:54<1:24:17, 63.21s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.009, valid loss : 0.013, train acc : 0.907, valid acc : 0.857, train f1 : 0.906, valid f1 : 0.721
training process:  38%|███▊      | 49/128 [46:10<1:28:12, 66.99s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [47:06<1:22:38, 63.57s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [48:18<1:24:59, 66.23s/it]Best score increase :0.727 -> 0.732
training process:  41%|████      | 52/128 [49:19<1:21:46, 64.56s/it]Best score increase :0.732 -> 0.737
epoch : 53, train loss : 0.009, valid loss : 0.012, train acc : 0.912, valid acc : 0.863, train f1 : 0.911, valid f1 : 0.729
training process:  41%|████▏     | 53/128 [50:45<1:28:45, 71.01s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [51:38<1:21:08, 65.80s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [52:31<1:15:24, 61.98s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [53:25<1:11:14, 59.37s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.008, valid loss : 0.013, train acc : 0.914, valid acc : 0.864, train f1 : 0.913, valid f1 : 0.731
training process:  45%|████▍     | 57/128 [54:48<1:18:45, 66.56s/it]EarlyStopping counter : 5 out of 12
training process:  45%|████▌     | 58/128 [55:43<1:13:27, 62.96s/it]Best score increase :0.737 -> 0.748
training process:  46%|████▌     | 59/128 [56:54<1:15:10, 65.37s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [57:48<1:10:25, 62.14s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.008, valid loss : 0.012, train acc : 0.923, valid acc : 0.879, train f1 : 0.923, valid f1 : 0.749
training process:  48%|████▊     | 61/128 [58:46<1:08:05, 60.98s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [59:38<1:03:51, 58.06s/it]EarlyStopping counter : 4 out of 12
training process:  49%|████▉     | 63/128 [1:00:36<1:03:04, 58.22s/it]Best score increase :0.748 -> 0.767
training process:  50%|█████     | 64/128 [1:01:35<1:02:12, 58.31s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.008, valid loss : 0.013, train acc : 0.922, valid acc : 0.866, train f1 : 0.922, valid f1 : 0.731
training process:  51%|█████     | 65/128 [1:02:44<1:04:33, 61.48s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 66/128 [1:03:31<59:16, 57.36s/it]  EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 67/128 [1:04:23<56:35, 55.67s/it]EarlyStopping counter : 4 out of 12
training process:  53%|█████▎    | 68/128 [1:05:20<56:04, 56.07s/it]EarlyStopping counter : 5 out of 12
epoch : 69, train loss : 0.007, valid loss : 0.012, train acc : 0.926, valid acc : 0.879, train f1 : 0.926, valid f1 : 0.749
training process:  54%|█████▍    | 69/128 [1:06:15<54:51, 55.78s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▍    | 70/128 [1:07:04<51:58, 53.77s/it]EarlyStopping counter : 7 out of 12
training process:  55%|█████▌    | 71/128 [1:08:04<52:43, 55.51s/it]EarlyStopping counter : 8 out of 12
training process:  56%|█████▋    | 72/128 [1:08:58<51:24, 55.08s/it]EarlyStopping counter : 9 out of 12
epoch : 73, train loss : 0.007, valid loss : 0.012, train acc : 0.931, valid acc : 0.893, train f1 : 0.931, valid f1 : 0.766
training process:  57%|█████▋    | 73/128 [1:10:06<54:05, 59.01s/it]EarlyStopping counter : 10 out of 12
training process:  58%|█████▊    | 74/128 [1:10:57<50:53, 56.55s/it]EarlyStopping counter : 11 out of 12
training process:  58%|█████▊    | 74/128 [1:11:47<52:22, 58.20s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 74, best f1 score : 0.767
training process finished, best loss : 0.012 and best acc : 0.893, best f1 : 0.767, best epoch : 62

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.43      0.91      0.58       580
           1       0.99      0.89      0.94      6818

    accuracy                           0.90      7398
   macro avg       0.71      0.90      0.76      7398
weighted avg       0.95      0.90      0.91      7398


# test acc : 0.90, test f1 : 0.76, test AUC : 0.90, test loss : 0.679

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:49,  9.92s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:39,  9.91s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:25,  9.54s/it]processing for feature importance:  33%|███▎      | 4/12 [00:37<01:12,  9.10s/it]processing for feature importance:  42%|████▏     | 5/12 [00:45<01:00,  8.60s/it]processing for feature importance:  50%|█████     | 6/12 [00:52<00:49,  8.29s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:39,  7.96s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:31,  7.76s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:14<00:22,  7.66s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:14,  7.47s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:29<00:07,  7.59s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  7.87s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.18s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 208.57it/s] 14%|█▎        | 42/306 [00:00<00:01, 173.74it/s] 20%|█▉        | 60/306 [00:00<00:01, 126.19it/s] 27%|██▋       | 84/306 [00:00<00:01, 158.13it/s] 35%|███▍      | 106/306 [00:00<00:01, 170.79it/s] 41%|████      | 125/306 [00:00<00:01, 166.50it/s] 48%|████▊     | 147/306 [00:00<00:00, 181.34it/s] 55%|█████▌    | 169/306 [00:00<00:00, 191.18it/s] 62%|██████▏   | 189/306 [00:01<00:00, 151.90it/s] 67%|██████▋   | 206/306 [00:01<00:00, 146.20it/s] 73%|███████▎  | 222/306 [00:01<00:00, 137.60it/s] 77%|███████▋  | 237/306 [00:01<00:00, 125.07it/s] 82%|████████▏ | 251/306 [00:01<00:00, 123.12it/s] 86%|████████▋ | 264/306 [00:01<00:00, 120.23it/s] 91%|█████████ | 277/306 [00:01<00:00, 116.12it/s] 96%|█████████▋| 295/306 [00:02<00:00, 130.99it/s]100%|██████████| 306/306 [00:02<00:00, 146.31it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 412.46it/s]extract the null data:  16%|█▌        | 87/553 [00:00<00:01, 390.81it/s]extract the null data:  25%|██▍       | 137/553 [00:00<00:00, 416.04it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 420.78it/s]extract the null data:  42%|████▏     | 234/553 [00:00<00:00, 460.82it/s]extract the null data:  51%|█████     | 281/553 [00:00<00:00, 390.60it/s]extract the null data:  60%|██████    | 333/553 [00:00<00:00, 425.71it/s]extract the null data:  68%|██████▊   | 378/553 [00:00<00:00, 420.77it/s]extract the null data:  77%|███████▋  | 427/553 [00:01<00:00, 438.12it/s]extract the null data:  86%|████████▋ | 477/553 [00:01<00:00, 454.14it/s]extract the null data:  95%|█████████▌| 528/553 [00:01<00:00, 467.61it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 440.17it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 175.45it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:02, 180.38it/s]replace nan value:  10%|█         | 56/553 [00:00<00:02, 177.62it/s]replace nan value:  13%|█▎        | 74/553 [00:00<00:02, 177.82it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:02, 178.97it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 148.89it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:03, 121.70it/s]replace nan value:  25%|██▌       | 141/553 [00:01<00:03, 111.09it/s]replace nan value:  28%|██▊       | 153/553 [00:01<00:03, 106.13it/s]replace nan value:  30%|██▉       | 165/553 [00:01<00:03, 101.88it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:03, 97.77it/s] replace nan value:  34%|███▎      | 186/553 [00:01<00:03, 97.62it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:03, 100.88it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:03, 95.51it/s] replace nan value:  40%|███▉      | 220/553 [00:01<00:03, 98.67it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:03, 92.87it/s]replace nan value:  44%|████▎     | 241/553 [00:02<00:03, 93.23it/s]replace nan value:  45%|████▌     | 251/553 [00:02<00:03, 94.25it/s]replace nan value:  47%|████▋     | 261/553 [00:02<00:03, 92.18it/s]replace nan value:  49%|████▉     | 272/553 [00:02<00:02, 93.96it/s]replace nan value:  51%|█████     | 282/553 [00:02<00:03, 89.49it/s]replace nan value:  53%|█████▎    | 292/553 [00:02<00:02, 92.18it/s]replace nan value:  55%|█████▍    | 302/553 [00:02<00:02, 88.76it/s]replace nan value:  57%|█████▋    | 314/553 [00:02<00:02, 93.58it/s]replace nan value:  59%|█████▊    | 324/553 [00:03<00:02, 91.19it/s]replace nan value:  60%|██████    | 334/553 [00:03<00:02, 93.36it/s]replace nan value:  62%|██████▏   | 344/553 [00:03<00:02, 84.35it/s]replace nan value:  64%|██████▍   | 354/553 [00:03<00:02, 84.13it/s]replace nan value:  66%|██████▌   | 364/553 [00:03<00:02, 87.74it/s]replace nan value:  68%|██████▊   | 374/553 [00:03<00:02, 86.90it/s]replace nan value:  69%|██████▉   | 384/553 [00:03<00:01, 89.58it/s]replace nan value:  71%|███████   | 394/553 [00:03<00:01, 87.05it/s]replace nan value:  73%|███████▎  | 404/553 [00:03<00:01, 89.68it/s]replace nan value:  75%|███████▍  | 414/553 [00:04<00:01, 82.77it/s]replace nan value:  78%|███████▊  | 429/553 [00:04<00:01, 99.42it/s]replace nan value:  81%|████████  | 447/553 [00:04<00:00, 119.46it/s]replace nan value:  84%|████████▎ | 462/553 [00:04<00:00, 126.54it/s]replace nan value:  87%|████████▋ | 480/553 [00:04<00:00, 139.62it/s]replace nan value:  90%|█████████ | 498/553 [00:04<00:00, 149.69it/s]replace nan value:  93%|█████████▎| 515/553 [00:04<00:00, 155.18it/s]replace nan value:  96%|█████████▋| 533/553 [00:04<00:00, 160.05it/s]replace nan value:  99%|█████████▉| 550/553 [00:04<00:00, 157.69it/s]replace nan value: 100%|██████████| 553/553 [00:04<00:00, 112.23it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.16it/s]  5%|▍         | 27/553 [00:00<00:03, 132.47it/s]  7%|▋         | 41/553 [00:00<00:04, 125.81it/s] 10%|▉         | 54/553 [00:00<00:04, 117.22it/s] 12%|█▏        | 66/553 [00:00<00:04, 107.96it/s] 14%|█▍        | 80/553 [00:00<00:04, 114.76it/s] 17%|█▋        | 93/553 [00:00<00:03, 118.74it/s] 19%|█▉        | 105/553 [00:00<00:04, 100.67it/s] 22%|██▏       | 120/553 [00:01<00:03, 113.11it/s] 24%|██▍       | 132/553 [00:01<00:03, 106.22it/s] 26%|██▌       | 144/553 [00:01<00:03, 103.76it/s] 29%|██▉       | 162/553 [00:01<00:03, 123.43it/s] 32%|███▏      | 178/553 [00:01<00:02, 130.31it/s] 35%|███▌      | 195/553 [00:01<00:02, 140.38it/s] 39%|███▊      | 213/553 [00:01<00:02, 151.36it/s] 41%|████▏     | 229/553 [00:01<00:02, 145.00it/s] 44%|████▍     | 244/553 [00:01<00:02, 142.51it/s] 47%|████▋     | 261/553 [00:02<00:01, 149.08it/s] 50%|█████     | 277/553 [00:02<00:01, 140.17it/s] 53%|█████▎    | 292/553 [00:02<00:01, 140.18it/s] 56%|█████▌    | 307/553 [00:02<00:02, 113.38it/s] 58%|█████▊    | 320/553 [00:02<00:02, 116.01it/s] 60%|██████    | 333/553 [00:02<00:01, 118.59it/s] 63%|██████▎   | 346/553 [00:02<00:01, 121.57it/s] 65%|██████▍   | 359/553 [00:02<00:01, 115.20it/s] 68%|██████▊   | 374/553 [00:03<00:01, 124.12it/s] 70%|██████▉   | 387/553 [00:03<00:01, 117.43it/s] 72%|███████▏  | 400/553 [00:03<00:01, 110.71it/s] 75%|███████▌  | 415/553 [00:03<00:01, 118.66it/s] 77%|███████▋  | 428/553 [00:03<00:01, 109.52it/s] 80%|████████  | 445/553 [00:03<00:00, 124.06it/s] 83%|████████▎ | 459/553 [00:03<00:00, 128.26it/s] 86%|████████▌ | 473/553 [00:03<00:00, 118.71it/s] 88%|████████▊ | 486/553 [00:04<00:00, 111.08it/s] 90%|█████████ | 498/553 [00:04<00:00, 107.86it/s] 93%|█████████▎| 512/553 [00:04<00:00, 115.72it/s] 95%|█████████▍| 524/553 [00:04<00:00, 108.67it/s] 97%|█████████▋| 536/553 [00:04<00:00, 105.29it/s]100%|█████████▉| 551/553 [00:04<00:00, 96.97it/s] 100%|██████████| 553/553 [00:04<00:00, 118.33it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 267.10it/s]extract the null data:  47%|████▋     | 65/139 [00:00<00:00, 329.80it/s]extract the null data:  76%|███████▌  | 105/139 [00:00<00:00, 360.54it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 352.92it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 197.93it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 168.39it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 167.75it/s]replace nan value:  54%|█████▍    | 75/139 [00:00<00:00, 163.30it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 132.36it/s]replace nan value:  77%|███████▋  | 107/139 [00:00<00:00, 136.98it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 146.10it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 154.14it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.98it/s] 16%|█▌        | 22/139 [00:00<00:01, 107.97it/s] 24%|██▎       | 33/139 [00:00<00:00, 108.45it/s] 33%|███▎      | 46/139 [00:00<00:00, 106.34it/s] 41%|████      | 57/139 [00:00<00:00, 85.56it/s]  51%|█████     | 71/139 [00:00<00:00, 97.54it/s] 59%|█████▉    | 82/139 [00:00<00:00, 83.57it/s] 65%|██████▌   | 91/139 [00:01<00:00, 82.97it/s] 76%|███████▋  | 106/139 [00:01<00:00, 98.18it/s] 88%|████████▊ | 123/139 [00:01<00:00, 115.95it/s] 99%|█████████▊| 137/139 [00:01<00:00, 122.05it/s]100%|██████████| 139/139 [00:01<00:00, 104.68it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 28/173 [00:00<00:00, 277.07it/s]extract the null data:  49%|████▉     | 85/173 [00:00<00:00, 447.14it/s]extract the null data:  83%|████████▎ | 144/173 [00:00<00:00, 512.04it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 490.46it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 199.21it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 194.43it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 193.85it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 191.67it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 191.76it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 192.30it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 193.39it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 192.25it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 192.19it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 146.88it/s] 17%|█▋        | 30/173 [00:00<00:01, 132.25it/s] 27%|██▋       | 46/173 [00:00<00:00, 142.38it/s] 36%|███▌      | 62/173 [00:00<00:00, 148.65it/s] 45%|████▍     | 77/173 [00:00<00:00, 147.88it/s] 53%|█████▎    | 92/173 [00:00<00:00, 147.22it/s] 62%|██████▏   | 107/173 [00:00<00:00, 139.80it/s] 71%|███████   | 122/173 [00:00<00:00, 140.53it/s] 79%|███████▉  | 137/173 [00:00<00:00, 139.05it/s] 87%|████████▋ | 151/173 [00:01<00:00, 135.05it/s] 95%|█████████▌| 165/173 [00:01<00:00, 121.17it/s]100%|██████████| 173/173 [00:01<00:00, 125.81it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.071, train f1 : 0.540, valid f1 : 0.607
training process - Deferred Re-weighting:   1%|          | 1/128 [01:23<2:56:02, 83.17s/it]Best score increase :0.000 -> 0.607
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:36<2:42:07, 77.20s/it]Best score increase :0.607 -> 0.620
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:45<2:32:56, 73.41s/it]Best score increase :0.620 -> 0.687
training process - Deferred Re-weighting:   3%|▎         | 4/128 [05:01<2:34:15, 74.64s/it]Best score increase :0.687 -> 0.742
epoch : 5, train loss : 0.042, valid loss : 0.047, train f1 : 0.785, valid f1 : 0.741
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:29<2:42:48, 79.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:39<2:34:48, 76.14s/it]Best score increase :0.742 -> 0.768
training process - Deferred Re-weighting:   5%|▌         | 7/128 [08:37<2:21:47, 70.31s/it]Best score increase :0.768 -> 0.778
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:30<2:09:35, 64.80s/it]Best score increase :0.778 -> 0.782
epoch : 9, train loss : 0.037, valid loss : 0.045, train f1 : 0.824, valid f1 : 0.786
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:58<2:22:46, 71.99s/it]Best score increase :0.782 -> 0.786
training process - Deferred Re-weighting:   8%|▊         | 10/128 [12:13<2:23:40, 73.05s/it]Best score increase :0.786 -> 0.794
training process - Deferred Re-weighting:   9%|▊         | 11/128 [13:25<2:21:41, 72.66s/it]Best score increase :0.794 -> 0.796
training process - Deferred Re-weighting:   9%|▉         | 12/128 [14:39<2:20:56, 72.90s/it]Best score increase :0.796 -> 0.802
epoch : 13, train loss : 0.033, valid loss : 0.041, train f1 : 0.840, valid f1 : 0.811
training process - Deferred Re-weighting:  10%|█         | 13/128 [16:07<2:28:29, 77.48s/it]Best score increase :0.802 -> 0.811
training process - Deferred Re-weighting:  11%|█         | 14/128 [17:19<2:24:19, 75.96s/it]Best score increase :0.811 -> 0.815
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [18:30<2:20:01, 74.35s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [19:40<2:16:47, 73.29s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.031, valid loss : 0.041, train f1 : 0.854, valid f1 : 0.818
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [21:11<2:24:54, 78.33s/it]Best score increase :0.815 -> 0.818
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [22:26<2:22:16, 77.60s/it]Best score increase :0.818 -> 0.820
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [23:45<2:21:21, 77.81s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [25:05<2:21:39, 78.70s/it]Best score increase :0.820 -> 0.822
epoch : 21, train loss : 0.029, valid loss : 0.043, train f1 : 0.866, valid f1 : 0.824
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [26:33<2:24:58, 81.30s/it]Best score increase :0.822 -> 0.824
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [27:47<2:19:54, 79.19s/it]Best score increase :0.824 -> 0.829
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [29:00<2:15:13, 77.27s/it]Best score increase :0.829 -> 0.835
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [30:26<2:18:17, 79.78s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.028, valid loss : 0.042, train f1 : 0.872, valid f1 : 0.833
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [31:51<2:19:51, 81.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [32:56<2:10:09, 76.56s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [34:01<2:03:05, 73.12s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [35:05<1:57:03, 70.23s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.026, valid loss : 0.040, train f1 : 0.880, valid f1 : 0.839
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [36:20<1:58:35, 71.87s/it]Best score increase :0.835 -> 0.839
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [37:30<1:56:15, 71.18s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [38:38<1:53:28, 70.19s/it]Best score increase :0.839 -> 0.840
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [39:42<1:49:22, 68.36s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.025, valid loss : 0.052, train f1 : 0.884, valid f1 : 0.827
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [41:01<1:53:09, 71.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [42:09<1:50:19, 70.42s/it]Best score increase :0.840 -> 0.846
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [43:16<1:47:37, 69.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [44:18<1:43:00, 67.18s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.024, valid loss : 0.038, train f1 : 0.892, valid f1 : 0.857
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [45:31<1:44:44, 69.06s/it]Best score increase :0.846 -> 0.857
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [46:40<1:43:18, 68.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [47:44<1:40:00, 67.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [48:40<1:34:08, 64.19s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.023, valid loss : 0.041, train f1 : 0.895, valid f1 : 0.860
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [49:58<1:38:57, 68.25s/it]Best score increase :0.857 -> 0.860
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [50:59<1:34:35, 65.99s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [51:50<1:27:22, 61.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [52:43<1:22:35, 58.99s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.022, valid loss : 0.046, train f1 : 0.900, valid f1 : 0.853
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [53:44<1:22:21, 59.53s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [54:38<1:18:59, 57.80s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [55:34<1:17:34, 57.47s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [56:33<1:17:14, 57.93s/it]EarlyStopping counter : 7 out of 12
epoch : 49, train loss : 0.021, valid loss : 0.050, train f1 : 0.902, valid f1 : 0.858
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [57:47<1:22:42, 62.81s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [58:47<1:20:18, 61.77s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [1:00:00<1:23:39, 65.19s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [1:01:21<1:28:28, 69.85s/it]EarlyStopping counter : 11 out of 12
epoch : 53, train loss : 0.020, valid loss : 0.043, train f1 : 0.906, valid f1 : 0.867
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [1:02:32<1:27:55, 70.34s/it]Best score increase :0.860 -> 0.867
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [1:03:30<1:22:14, 66.69s/it]Best score increase :0.867 -> 0.869
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:04:32<1:19:08, 65.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [1:05:35<1:17:35, 64.67s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.019, valid loss : 0.054, train f1 : 0.910, valid f1 : 0.856
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [1:06:55<1:21:57, 69.25s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [1:08:01<1:19:36, 68.24s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:09:02<1:15:46, 65.89s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:10:03<1:12:59, 64.40s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.019, valid loss : 0.046, train f1 : 0.912, valid f1 : 0.866
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:11:12<1:13:43, 66.02s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:12:16<1:11:55, 65.38s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:13:18<1:09:34, 64.22s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:14:22<1:08:25, 64.15s/it]EarlyStopping counter : 10 out of 12
epoch : 65, train loss : 0.019, valid loss : 0.046, train f1 : 0.916, valid f1 : 0.867
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:15:41<1:12:03, 68.63s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:17:05<1:14:43, 71.16s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 65, best f1 score : 0.869
training process finished, best loss : 0.044, best acc : 0.966, best f1 : 0.869, best epoch : 53

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.61      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.96      0.81      0.86      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.81, test loss : 2.813

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:57, 10.65s/it]processing for feature importance:  17%|█▋        | 2/12 [00:21<01:47, 10.77s/it]processing for feature importance:  25%|██▌       | 3/12 [00:31<01:34, 10.51s/it]processing for feature importance:  33%|███▎      | 4/12 [00:41<01:20, 10.09s/it]processing for feature importance:  42%|████▏     | 5/12 [00:50<01:08,  9.77s/it]processing for feature importance:  50%|█████     | 6/12 [01:00<01:00, 10.01s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:12<00:52, 10.46s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:24<00:43, 10.95s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:34<00:32, 10.76s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:44<00:21, 10.56s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:54<00:10, 10.39s/it]processing for feature importance: 100%|██████████| 12/12 [02:05<00:00, 10.59s/it]processing for feature importance: 100%|██████████| 12/12 [02:05<00:00, 10.48s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 204.58it/s] 15%|█▍        | 45/306 [00:00<00:01, 222.24it/s] 23%|██▎       | 69/306 [00:00<00:01, 229.93it/s] 30%|███       | 93/306 [00:00<00:00, 231.39it/s] 38%|███▊      | 117/306 [00:00<00:00, 233.73it/s] 47%|████▋     | 143/306 [00:00<00:00, 241.36it/s] 55%|█████▍    | 168/306 [00:00<00:00, 239.35it/s] 63%|██████▎   | 192/306 [00:00<00:00, 238.62it/s] 71%|███████   | 216/306 [00:00<00:00, 237.96it/s] 78%|███████▊  | 240/306 [00:01<00:00, 237.18it/s] 87%|████████▋ | 266/306 [00:01<00:00, 242.14it/s] 95%|█████████▌| 291/306 [00:01<00:00, 243.71it/s]100%|██████████| 306/306 [00:01<00:00, 237.33it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 467.01it/s]extract the null data:  17%|█▋        | 94/553 [00:00<00:01, 420.12it/s]extract the null data:  26%|██▌       | 142/553 [00:00<00:00, 442.79it/s]extract the null data:  35%|███▍      | 191/553 [00:00<00:00, 458.50it/s]extract the null data:  43%|████▎     | 238/553 [00:00<00:00, 450.48it/s]extract the null data:  52%|█████▏    | 287/553 [00:00<00:00, 461.83it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 475.13it/s]extract the null data:  70%|███████   | 388/553 [00:00<00:00, 482.10it/s]extract the null data:  79%|███████▉  | 438/553 [00:00<00:00, 486.03it/s]extract the null data:  88%|████████▊ | 489/553 [00:01<00:00, 490.96it/s]extract the null data:  98%|█████████▊| 541/553 [00:01<00:00, 496.96it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 474.69it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:02, 179.04it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 177.61it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 176.82it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 176.53it/s]replace nan value:  16%|█▋        | 90/553 [00:00<00:02, 177.23it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 179.62it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 179.20it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 180.17it/s]replace nan value:  30%|██▉       | 165/553 [00:00<00:02, 181.36it/s]replace nan value:  33%|███▎      | 184/553 [00:01<00:02, 179.41it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:01, 179.98it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 180.26it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 179.29it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 179.89it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 179.98it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 159.07it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 149.21it/s]replace nan value:  60%|██████    | 332/553 [00:01<00:01, 156.65it/s]replace nan value:  63%|██████▎   | 350/553 [00:02<00:01, 162.17it/s]replace nan value:  67%|██████▋   | 369/553 [00:02<00:01, 167.73it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:00, 170.38it/s]replace nan value:  73%|███████▎  | 405/553 [00:02<00:00, 173.10it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 174.37it/s]replace nan value:  80%|███████▉  | 441/553 [00:02<00:00, 175.07it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 177.84it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 178.25it/s]replace nan value:  90%|████████▉ | 496/553 [00:02<00:00, 176.09it/s]replace nan value:  93%|█████████▎| 514/553 [00:02<00:00, 176.06it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 174.33it/s]replace nan value:  99%|█████████▉| 550/553 [00:03<00:00, 174.52it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 173.61it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 105.48it/s]  4%|▍         | 24/553 [00:00<00:04, 119.28it/s]  7%|▋         | 39/553 [00:00<00:04, 124.82it/s]  9%|▉         | 52/553 [00:00<00:04, 111.01it/s] 12%|█▏        | 64/553 [00:00<00:04, 102.08it/s] 14%|█▎        | 76/553 [00:00<00:04, 107.04it/s] 16%|█▌        | 89/553 [00:00<00:04, 111.52it/s] 18%|█▊        | 101/553 [00:00<00:04, 106.03it/s] 21%|██        | 116/553 [00:01<00:03, 116.41it/s] 23%|██▎       | 128/553 [00:01<00:03, 115.76it/s] 26%|██▌       | 143/553 [00:01<00:03, 125.26it/s] 29%|██▉       | 160/553 [00:01<00:02, 135.35it/s] 31%|███▏      | 174/553 [00:01<00:02, 132.83it/s] 34%|███▍      | 188/553 [00:01<00:02, 130.96it/s] 37%|███▋      | 204/553 [00:01<00:02, 137.38it/s] 39%|███▉      | 218/553 [00:01<00:02, 132.11it/s] 42%|████▏     | 232/553 [00:01<00:02, 126.71it/s] 44%|████▍     | 245/553 [00:02<00:02, 124.54it/s] 47%|████▋     | 258/553 [00:02<00:02, 124.30it/s] 49%|████▉     | 271/553 [00:02<00:02, 119.20it/s] 51%|█████     | 283/553 [00:02<00:02, 119.21it/s] 53%|█████▎    | 295/553 [00:02<00:02, 117.57it/s] 56%|█████▌    | 307/553 [00:02<00:02, 114.91it/s] 58%|█████▊    | 319/553 [00:02<00:02, 115.84it/s] 60%|██████    | 332/553 [00:02<00:01, 119.87it/s] 63%|██████▎   | 346/553 [00:02<00:01, 124.99it/s] 65%|██████▍   | 359/553 [00:02<00:01, 116.24it/s] 68%|██████▊   | 375/553 [00:03<00:01, 127.46it/s] 70%|███████   | 388/553 [00:03<00:01, 120.64it/s] 73%|███████▎  | 401/553 [00:03<00:01, 114.48it/s] 75%|███████▌  | 415/553 [00:03<00:01, 121.12it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.33it/s] 80%|████████  | 445/553 [00:03<00:00, 127.06it/s] 83%|████████▎ | 460/553 [00:03<00:00, 132.00it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.16it/s] 88%|████████▊ | 488/553 [00:04<00:00, 128.31it/s] 91%|█████████ | 502/553 [00:04<00:00, 122.34it/s] 93%|█████████▎| 517/553 [00:04<00:00, 128.95it/s] 96%|█████████▌| 531/553 [00:04<00:00, 110.36it/s] 99%|█████████▉| 547/553 [00:04<00:00, 120.97it/s]100%|██████████| 553/553 [00:04<00:00, 119.47it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 31/139 [00:00<00:00, 306.05it/s]extract the null data:  65%|██████▍   | 90/139 [00:00<00:00, 471.84it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 483.36it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 195.73it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 195.77it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 195.68it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 196.18it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 197.23it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 196.39it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 195.46it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.42it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.45it/s] 29%|██▉       | 40/139 [00:00<00:00, 132.49it/s] 39%|███▉      | 54/139 [00:00<00:00, 123.84it/s] 48%|████▊     | 67/139 [00:00<00:00, 122.99it/s] 58%|█████▊    | 80/139 [00:00<00:00, 123.04it/s] 67%|██████▋   | 93/139 [00:00<00:00, 111.86it/s] 76%|███████▌  | 105/139 [00:00<00:00, 113.59it/s] 87%|████████▋ | 121/139 [00:00<00:00, 124.08it/s] 96%|█████████▋| 134/139 [00:01<00:00, 124.03it/s]100%|██████████| 139/139 [00:01<00:00, 123.28it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 317.75it/s]extract the null data:  52%|█████▏    | 90/173 [00:00<00:00, 471.10it/s]extract the null data:  87%|████████▋ | 150/173 [00:00<00:00, 529.18it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 503.40it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 197.08it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 194.49it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 196.65it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 197.39it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 195.33it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 196.37it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 193.93it/s]replace nan value:  93%|█████████▎| 161/173 [00:00<00:00, 192.93it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 194.78it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.33it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.45it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.67it/s] 34%|███▎      | 58/173 [00:00<00:00, 135.21it/s] 42%|████▏     | 72/173 [00:00<00:00, 133.94it/s] 50%|████▉     | 86/173 [00:00<00:00, 131.98it/s] 58%|█████▊    | 100/173 [00:00<00:00, 131.49it/s] 66%|██████▋   | 115/173 [00:00<00:00, 136.27it/s] 75%|███████▍  | 129/173 [00:00<00:00, 128.59it/s] 82%|████████▏ | 142/173 [00:01<00:00, 128.25it/s] 90%|████████▉ | 155/173 [00:01<00:00, 116.32it/s] 97%|█████████▋| 167/173 [00:01<00:00, 93.63it/s] 100%|██████████| 173/173 [00:01<00:00, 114.65it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.137, valid loss : 0.104, train f1 : 0.718, valid f1 : 0.658
training process - Deferred Re-weighting:   1%|          | 1/128 [00:58<2:04:25, 58.79s/it]Best score increase :0.000 -> 0.658
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:49<1:53:11, 53.90s/it]Best score increase :0.658 -> 0.712
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:34<1:44:08, 49.99s/it]Best score increase :0.712 -> 0.771
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:27<1:45:48, 51.19s/it]Best score increase :0.771 -> 0.817
epoch : 5, train loss : 0.085, valid loss : 0.062, train f1 : 0.857, valid f1 : 0.806
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:20<1:46:16, 51.84s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:08<1:42:52, 50.60s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:01<1:43:32, 51.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:48<1:39:32, 49.77s/it]EarlyStopping counter : 4 out of 12
epoch : 9, train loss : 0.074, valid loss : 0.056, train f1 : 0.875, valid f1 : 0.817
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:44<1:42:46, 51.82s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:32<1:39:48, 50.75s/it]Best score increase :0.817 -> 0.827
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:24<1:39:15, 50.91s/it]Best score increase :0.827 -> 0.841
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:23<1:43:34, 53.57s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.065, valid loss : 0.058, train f1 : 0.895, valid f1 : 0.804
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:19<1:44:03, 54.29s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:06<1:39:03, 52.14s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [12:54<1:35:37, 50.77s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [13:46<1:35:46, 51.30s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.059, valid loss : 0.047, train f1 : 0.907, valid f1 : 0.827
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [14:45<1:39:12, 53.63s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:33<1:34:47, 51.71s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:21<1:31:57, 50.62s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:09<1:29:41, 49.83s/it]EarlyStopping counter : 9 out of 12
epoch : 21, train loss : 0.053, valid loss : 0.054, train f1 : 0.917, valid f1 : 0.812
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:05<1:32:23, 51.80s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [18:59<1:32:45, 52.50s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:05<1:36:49, 54.81s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 22, best f1 score : 0.841
training process finished, best loss : 0.049, best acc : 0.944, best f1 : 0.841, best epoch : 10

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.51      0.79      0.62       580
           1       0.98      0.94      0.96      6818

    accuracy                           0.92      7398
   macro avg       0.75      0.86      0.79      7398
weighted avg       0.94      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.79, test AUC : 0.86, test loss : 3.136

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:32,  8.40s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.26s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:11,  7.90s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:03,  7.93s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:55,  8.00s/it]processing for feature importance:  50%|█████     | 6/12 [00:50<00:51,  8.66s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:46,  9.22s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:10<00:37,  9.41s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:19<00:28,  9.44s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:29<00:19,  9.59s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:39<00:09,  9.77s/it]processing for feature importance: 100%|██████████| 12/12 [01:48<00:00,  9.47s/it]processing for feature importance: 100%|██████████| 12/12 [01:48<00:00,  9.05s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 20/306 [00:00<00:01, 196.36it/s] 14%|█▍        | 43/306 [00:00<00:01, 215.00it/s] 22%|██▏       | 67/306 [00:00<00:01, 225.16it/s] 29%|██▉       | 90/306 [00:00<00:01, 179.96it/s] 36%|███▌      | 110/306 [00:00<00:01, 147.22it/s] 42%|████▏     | 127/306 [00:00<00:01, 135.74it/s] 46%|████▋     | 142/306 [00:00<00:01, 126.36it/s] 51%|█████     | 156/306 [00:01<00:01, 114.86it/s] 55%|█████▍    | 168/306 [00:01<00:01, 114.61it/s] 59%|█████▉    | 180/306 [00:01<00:01, 114.09it/s] 65%|██████▍   | 198/306 [00:01<00:00, 130.75it/s] 72%|███████▏  | 221/306 [00:01<00:00, 156.27it/s] 80%|███████▉  | 244/306 [00:01<00:00, 174.90it/s] 87%|████████▋ | 266/306 [00:01<00:00, 187.41it/s] 94%|█████████▍| 288/306 [00:01<00:00, 194.78it/s]100%|██████████| 306/306 [00:01<00:00, 160.84it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_Normal_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 57/553 [00:00<00:00, 566.45it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 574.83it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 587.22it/s]extract the null data:  43%|████▎     | 238/553 [00:00<00:00, 594.40it/s]extract the null data:  54%|█████▍    | 301/553 [00:00<00:00, 605.85it/s]extract the null data:  66%|██████▌   | 363/553 [00:00<00:00, 607.44it/s]extract the null data:  77%|███████▋  | 424/553 [00:00<00:00, 607.87it/s]extract the null data:  88%|████████▊ | 488/553 [00:00<00:00, 617.72it/s]extract the null data: 100%|█████████▉| 551/553 [00:00<00:00, 619.56it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 606.54it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 189.05it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 184.04it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 184.24it/s]replace nan value:  14%|█▎        | 76/553 [00:00<00:02, 184.56it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:02, 184.28it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 181.65it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 187.93it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 191.63it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:01, 192.99it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:01, 193.37it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 193.75it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 194.21it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 192.53it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:01, 192.57it/s]replace nan value:  54%|█████▎    | 296/553 [00:01<00:01, 194.74it/s]replace nan value:  57%|█████▋    | 316/553 [00:01<00:01, 195.56it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 196.00it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:00, 197.06it/s]replace nan value:  68%|██████▊   | 378/553 [00:01<00:00, 199.76it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 198.29it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 199.62it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 199.72it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 199.79it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 198.66it/s]replace nan value:  91%|█████████ | 501/553 [00:02<00:00, 197.52it/s]replace nan value:  94%|█████████▍| 521/553 [00:02<00:00, 193.87it/s]replace nan value:  98%|█████████▊| 541/553 [00:02<00:00, 195.52it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 193.70it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 132.67it/s]  5%|▌         | 29/553 [00:00<00:03, 139.73it/s]  8%|▊         | 43/553 [00:00<00:03, 133.56it/s] 10%|█         | 57/553 [00:00<00:04, 123.61it/s] 13%|█▎        | 70/553 [00:00<00:04, 116.78it/s] 16%|█▌        | 86/553 [00:00<00:03, 129.26it/s] 18%|█▊        | 100/553 [00:00<00:03, 122.36it/s] 21%|██        | 117/553 [00:00<00:03, 134.82it/s] 24%|██▎       | 131/553 [00:01<00:03, 131.32it/s] 27%|██▋       | 149/553 [00:01<00:02, 143.24it/s] 30%|██▉       | 165/553 [00:01<00:02, 146.21it/s] 33%|███▎      | 181/553 [00:01<00:02, 147.66it/s] 36%|███▌      | 197/553 [00:01<00:02, 149.33it/s] 39%|███▊      | 214/553 [00:01<00:02, 154.00it/s] 42%|████▏     | 230/553 [00:01<00:02, 143.29it/s] 44%|████▍     | 245/553 [00:01<00:02, 142.10it/s] 47%|████▋     | 261/553 [00:01<00:02, 145.39it/s] 50%|████▉     | 276/553 [00:02<00:02, 135.81it/s] 53%|█████▎    | 291/553 [00:02<00:01, 137.45it/s] 55%|█████▌    | 305/553 [00:02<00:01, 131.90it/s] 58%|█████▊    | 319/553 [00:02<00:01, 121.28it/s] 60%|██████    | 332/553 [00:02<00:01, 123.00it/s] 63%|██████▎   | 346/553 [00:02<00:01, 126.12it/s] 65%|██████▍   | 359/553 [00:02<00:01, 120.70it/s] 68%|██████▊   | 375/553 [00:02<00:01, 129.79it/s] 70%|███████   | 389/553 [00:02<00:01, 122.41it/s] 73%|███████▎  | 402/553 [00:03<00:01, 116.96it/s] 75%|███████▌  | 416/553 [00:03<00:01, 118.05it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.92it/s] 80%|████████  | 445/553 [00:03<00:00, 127.28it/s] 83%|████████▎ | 460/553 [00:03<00:00, 132.60it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.55it/s] 88%|████████▊ | 488/553 [00:03<00:00, 128.68it/s] 91%|█████████ | 502/553 [00:03<00:00, 122.15it/s] 93%|█████████▎| 517/553 [00:03<00:00, 128.12it/s] 96%|█████████▌| 530/553 [00:04<00:00, 109.58it/s] 98%|█████████▊| 544/553 [00:04<00:00, 117.08it/s]100%|██████████| 553/553 [00:04<00:00, 127.35it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 279.62it/s]extract the null data:  67%|██████▋   | 93/139 [00:00<00:00, 494.96it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 502.68it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 213.17it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 210.05it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 206.60it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 206.02it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 205.91it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 202.73it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 204.61it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.95it/s] 17%|█▋        | 24/139 [00:00<00:00, 120.30it/s] 28%|██▊       | 39/139 [00:00<00:00, 131.00it/s] 38%|███▊      | 53/139 [00:00<00:00, 124.34it/s] 48%|████▊     | 67/139 [00:00<00:00, 124.42it/s] 58%|█████▊    | 80/139 [00:00<00:00, 123.66it/s] 67%|██████▋   | 93/139 [00:00<00:00, 112.81it/s] 76%|███████▋  | 106/139 [00:00<00:00, 115.17it/s] 88%|████████▊ | 122/139 [00:01<00:00, 123.68it/s] 97%|█████████▋| 135/139 [00:01<00:00, 122.72it/s]100%|██████████| 139/139 [00:01<00:00, 122.90it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 299.19it/s]extract the null data:  52%|█████▏    | 90/173 [00:00<00:00, 472.54it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 508.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 494.16it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 208.85it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 210.45it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 211.19it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 211.45it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 206.97it/s]replace nan value:  75%|███████▌  | 130/173 [00:00<00:00, 205.65it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 206.42it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 205.55it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 207.18it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:01, 154.32it/s] 18%|█▊        | 32/173 [00:00<00:01, 133.16it/s] 29%|██▉       | 51/173 [00:00<00:00, 155.68it/s] 39%|███▊      | 67/173 [00:00<00:00, 153.31it/s] 48%|████▊     | 83/173 [00:00<00:00, 154.12it/s] 57%|█████▋    | 99/173 [00:00<00:00, 152.17it/s] 67%|██████▋   | 116/173 [00:00<00:00, 156.99it/s] 76%|███████▋  | 132/173 [00:00<00:00, 146.77it/s] 85%|████████▍ | 147/173 [00:00<00:00, 145.66it/s] 94%|█████████▎| 162/173 [00:01<00:00, 132.57it/s]100%|██████████| 173/173 [00:01<00:00, 132.40it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.009, train acc : 0.704, valid acc : 0.912, train f1 : 0.535, valid f1 : 0.680
training process:   1%|          | 1/128 [01:15<2:39:11, 75.21s/it]Best score increase :0.000 -> 0.680
training process:   2%|▏         | 2/128 [02:07<2:09:13, 61.54s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:08<2:07:38, 61.27s/it]Best score increase :0.680 -> 0.716
training process:   3%|▎         | 4/128 [04:18<2:14:09, 64.91s/it]Best score increase :0.716 -> 0.765
epoch : 5, train loss : 0.004, valid loss : 0.003, train acc : 0.950, valid acc : 0.947, train f1 : 0.794, valid f1 : 0.772
training process:   4%|▍         | 5/128 [05:41<2:26:36, 71.52s/it]Best score increase :0.765 -> 0.772
training process:   5%|▍         | 6/128 [06:47<2:21:38, 69.66s/it]Best score increase :0.772 -> 0.789
training process:   5%|▌         | 7/128 [08:03<2:24:23, 71.60s/it]Best score increase :0.789 -> 0.797
training process:   6%|▋         | 8/128 [09:12<2:21:45, 70.88s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.957, valid acc : 0.952, train f1 : 0.827, valid f1 : 0.806
training process:   7%|▋         | 9/128 [10:29<2:24:07, 72.67s/it]Best score increase :0.797 -> 0.806
training process:   8%|▊         | 10/128 [11:47<2:26:21, 74.42s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [12:43<2:13:44, 68.59s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [13:58<2:16:47, 70.76s/it]Best score increase :0.806 -> 0.812
epoch : 13, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.953, train f1 : 0.839, valid f1 : 0.812
training process:  10%|█         | 13/128 [15:22<2:23:09, 74.69s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [16:27<2:16:19, 71.75s/it]Best score increase :0.812 -> 0.820
training process:  12%|█▏        | 15/128 [17:41<2:16:31, 72.49s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [18:42<2:08:29, 68.83s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.003, train acc : 0.963, valid acc : 0.954, train f1 : 0.853, valid f1 : 0.816
training process:  13%|█▎        | 17/128 [20:08<2:17:03, 74.09s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [21:05<2:06:33, 69.03s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [22:22<2:09:30, 71.29s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [23:22<2:02:33, 68.09s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train acc : 0.966, valid acc : 0.956, train f1 : 0.866, valid f1 : 0.827
training process:  16%|█▋        | 21/128 [24:46<2:09:45, 72.76s/it]Best score increase :0.820 -> 0.827
training process:  17%|█▋        | 22/128 [25:58<2:07:57, 72.43s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [27:02<2:02:40, 70.10s/it]Best score increase :0.827 -> 0.838
training process:  19%|█▉        | 24/128 [28:08<1:59:06, 68.71s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.965, valid acc : 0.958, train f1 : 0.866, valid f1 : 0.831
training process:  20%|█▉        | 25/128 [29:33<2:06:28, 73.67s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [30:50<2:06:42, 74.53s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [32:07<2:07:06, 75.51s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [33:17<2:03:08, 73.89s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.960, train f1 : 0.872, valid f1 : 0.843
training process:  23%|██▎       | 29/128 [34:41<2:06:51, 76.89s/it]Best score increase :0.838 -> 0.843
training process:  23%|██▎       | 30/128 [35:55<2:04:04, 75.96s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [37:05<1:59:41, 74.04s/it]EarlyStopping counter : 2 out of 12
training process:  25%|██▌       | 32/128 [38:18<1:58:05, 73.81s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.957, train f1 : 0.877, valid f1 : 0.824
training process:  26%|██▌       | 33/128 [39:44<2:02:26, 77.33s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 34/128 [41:03<2:01:59, 77.87s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 35/128 [42:20<2:00:28, 77.72s/it]EarlyStopping counter : 6 out of 12
training process:  28%|██▊       | 36/128 [43:32<1:56:37, 76.06s/it]EarlyStopping counter : 7 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.002, train acc : 0.969, valid acc : 0.961, train f1 : 0.880, valid f1 : 0.854
training process:  29%|██▉       | 37/128 [44:57<1:59:19, 78.68s/it]Best score increase :0.843 -> 0.854
training process:  30%|██▉       | 38/128 [46:18<1:58:56, 79.30s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [47:32<1:55:23, 77.79s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [48:47<1:52:49, 76.93s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.962, train f1 : 0.884, valid f1 : 0.855
training process:  32%|███▏      | 41/128 [50:16<1:56:41, 80.48s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [51:33<1:54:02, 79.56s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [52:52<1:52:23, 79.33s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [54:01<1:46:46, 76.27s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.971, valid acc : 0.960, train f1 : 0.892, valid f1 : 0.841
training process:  35%|███▌      | 45/128 [55:28<1:50:03, 79.55s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [56:43<1:46:40, 78.05s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [57:59<1:44:29, 77.40s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [59:18<1:43:53, 77.92s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.961, train f1 : 0.893, valid f1 : 0.845
training process:  38%|███▊      | 48/128 [1:00:53<1:41:28, 76.11s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.855
training process finished, best loss : 0.003 and best acc : 0.962, best f1 : 0.855, best epoch : 40

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.61      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.80      0.86      7398
weighted avg       0.96      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.80, test loss : 0.149

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<02:00, 10.99s/it]processing for feature importance:  17%|█▋        | 2/12 [00:22<01:52, 11.30s/it]processing for feature importance:  25%|██▌       | 3/12 [00:34<01:43, 11.49s/it]processing for feature importance:  33%|███▎      | 4/12 [00:45<01:29, 11.25s/it]processing for feature importance:  42%|████▏     | 5/12 [00:54<01:15, 10.75s/it]processing for feature importance:  50%|█████     | 6/12 [01:04<01:01, 10.29s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:14<00:50, 10.18s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:26<00:42, 10.68s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:37<00:33, 11.04s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:49<00:22, 11.15s/it]processing for feature importance:  92%|█████████▏| 11/12 [02:00<00:11, 11.08s/it]processing for feature importance: 100%|██████████| 12/12 [02:08<00:00, 10.27s/it]processing for feature importance: 100%|██████████| 12/12 [02:08<00:00, 10.72s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 23/306 [00:00<00:01, 224.02it/s] 16%|█▌        | 49/306 [00:00<00:01, 241.19it/s] 24%|██▍       | 74/306 [00:00<00:00, 243.13it/s] 32%|███▏      | 99/306 [00:00<00:00, 245.40it/s] 41%|████      | 125/306 [00:00<00:00, 246.98it/s] 49%|████▉     | 150/306 [00:00<00:00, 247.09it/s] 57%|█████▋    | 175/306 [00:00<00:00, 244.69it/s] 66%|██████▌   | 201/306 [00:00<00:00, 247.10it/s] 74%|███████▍  | 226/306 [00:00<00:00, 245.72it/s] 82%|████████▏ | 251/306 [00:01<00:00, 245.58it/s] 90%|█████████ | 276/306 [00:01<00:00, 245.69it/s] 99%|█████████▊| 302/306 [00:01<00:00, 247.88it/s]100%|██████████| 306/306 [00:01<00:00, 245.82it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 59/553 [00:00<00:00, 580.29it/s]extract the null data:  22%|██▏       | 122/553 [00:00<00:00, 605.05it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:00, 611.05it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 603.20it/s]extract the null data:  56%|█████▌    | 307/553 [00:00<00:00, 573.71it/s]extract the null data:  67%|██████▋   | 369/553 [00:00<00:00, 587.57it/s]extract the null data:  78%|███████▊  | 433/553 [00:00<00:00, 601.10it/s]extract the null data:  90%|████████▉ | 497/553 [00:00<00:00, 610.25it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 588.74it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 189.83it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 195.25it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 197.38it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 201.85it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 199.59it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 199.24it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 198.33it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:01, 199.30it/s]replace nan value:  33%|███▎      | 184/553 [00:00<00:01, 203.06it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:01, 204.80it/s]replace nan value:  41%|████      | 226/553 [00:01<00:01, 197.75it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 198.12it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 198.40it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 197.36it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 197.60it/s]replace nan value:  59%|█████▉    | 326/553 [00:01<00:01, 194.33it/s]replace nan value:  63%|██████▎   | 346/553 [00:01<00:01, 190.94it/s]replace nan value:  66%|██████▌   | 366/553 [00:01<00:00, 192.94it/s]replace nan value:  70%|██████▉   | 386/553 [00:01<00:00, 184.21it/s]replace nan value:  74%|███████▎  | 407/553 [00:02<00:00, 190.31it/s]replace nan value:  77%|███████▋  | 428/553 [00:02<00:00, 195.32it/s]replace nan value:  81%|████████  | 448/553 [00:02<00:00, 181.97it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 178.40it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 183.77it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 186.04it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 190.36it/s]replace nan value:  99%|█████████▉| 548/553 [00:02<00:00, 191.02it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 193.17it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 139.57it/s]  5%|▌         | 30/553 [00:00<00:03, 149.73it/s]  8%|▊         | 45/553 [00:00<00:03, 133.07it/s] 11%|█         | 59/553 [00:00<00:04, 123.04it/s] 13%|█▎        | 72/553 [00:00<00:03, 123.61it/s] 16%|█▌        | 89/553 [00:00<00:03, 134.94it/s] 19%|█▊        | 103/553 [00:00<00:03, 132.88it/s] 22%|██▏       | 121/553 [00:00<00:02, 144.27it/s] 25%|██▍       | 136/553 [00:00<00:02, 143.59it/s] 28%|██▊       | 153/553 [00:01<00:02, 149.99it/s] 31%|███       | 171/553 [00:01<00:02, 157.67it/s] 34%|███▍      | 187/553 [00:01<00:02, 154.85it/s] 37%|███▋      | 206/553 [00:01<00:02, 163.79it/s] 40%|████      | 223/553 [00:01<00:02, 153.10it/s] 43%|████▎     | 239/553 [00:01<00:02, 137.34it/s] 46%|████▌     | 254/553 [00:01<00:02, 134.63it/s] 49%|████▉     | 270/553 [00:01<00:02, 138.55it/s] 52%|█████▏    | 285/553 [00:02<00:01, 139.39it/s] 54%|█████▍    | 300/553 [00:02<00:01, 130.50it/s] 57%|█████▋    | 314/553 [00:02<00:02, 117.53it/s] 59%|█████▉    | 327/553 [00:02<00:02, 111.98it/s] 62%|██████▏   | 342/553 [00:02<00:01, 120.76it/s] 64%|██████▍   | 355/553 [00:02<00:01, 120.37it/s] 67%|██████▋   | 371/553 [00:02<00:01, 129.91it/s] 70%|██████▉   | 385/553 [00:02<00:01, 127.37it/s] 72%|███████▏  | 398/553 [00:02<00:01, 118.20it/s] 75%|███████▍  | 414/553 [00:03<00:01, 128.28it/s] 77%|███████▋  | 428/553 [00:03<00:01, 118.93it/s] 81%|████████  | 446/553 [00:03<00:00, 134.53it/s] 84%|████████▎ | 462/553 [00:03<00:00, 139.93it/s] 86%|████████▋ | 477/553 [00:03<00:00, 142.23it/s] 89%|████████▉ | 492/553 [00:03<00:00, 132.68it/s] 92%|█████████▏| 506/553 [00:03<00:00, 131.93it/s] 94%|█████████▍| 521/553 [00:03<00:00, 131.94it/s] 97%|█████████▋| 535/553 [00:04<00:00, 103.10it/s]100%|█████████▉| 551/553 [00:04<00:00, 100.34it/s]100%|██████████| 553/553 [00:04<00:00, 129.25it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 31/139 [00:00<00:00, 307.09it/s]extract the null data:  70%|██████▉   | 97/139 [00:00<00:00, 512.42it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 525.16it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 217.70it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 223.74it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 223.33it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 224.96it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 222.75it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 219.56it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 221.07it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 125.65it/s] 21%|██        | 29/139 [00:00<00:00, 135.56it/s] 32%|███▏      | 44/139 [00:00<00:00, 140.74it/s] 42%|████▏     | 59/139 [00:00<00:00, 125.77it/s] 53%|█████▎    | 74/139 [00:00<00:00, 128.90it/s] 63%|██████▎   | 88/139 [00:00<00:00, 112.94it/s] 74%|███████▍  | 103/139 [00:00<00:00, 123.04it/s] 83%|████████▎ | 116/139 [00:00<00:00, 117.13it/s] 94%|█████████▍| 131/139 [00:01<00:00, 122.90it/s]100%|██████████| 139/139 [00:01<00:00, 126.08it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  11%|█         | 19/173 [00:00<00:00, 188.92it/s]extract the null data:  48%|████▊     | 83/173 [00:00<00:00, 452.16it/s]extract the null data:  87%|████████▋ | 151/173 [00:00<00:00, 553.31it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 512.33it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 216.39it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 216.83it/s]replace nan value:  39%|███▊      | 67/173 [00:00<00:00, 220.31it/s]replace nan value:  53%|█████▎    | 91/173 [00:00<00:00, 224.84it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 225.43it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 208.02it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 191.50it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.86it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 143.51it/s] 17%|█▋        | 30/173 [00:00<00:01, 123.28it/s] 27%|██▋       | 46/173 [00:00<00:00, 134.14it/s] 35%|███▌      | 61/173 [00:00<00:00, 139.69it/s] 45%|████▍     | 77/173 [00:00<00:00, 143.65it/s] 54%|█████▍    | 94/173 [00:00<00:00, 149.58it/s] 64%|██████▍   | 111/173 [00:00<00:00, 154.97it/s] 73%|███████▎  | 127/173 [00:00<00:00, 142.81it/s] 82%|████████▏ | 142/173 [00:00<00:00, 144.05it/s] 91%|█████████ | 157/173 [00:01<00:00, 132.70it/s] 99%|█████████▉| 171/173 [00:01<00:00, 103.96it/s]100%|██████████| 173/173 [00:01<00:00, 128.23it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.009, train acc : 0.703, valid acc : 0.739, train f1 : 0.702, valid f1 : 0.585
training process:   1%|          | 1/128 [00:59<2:06:35, 59.81s/it]Best score increase :0.000 -> 0.585
training process:   2%|▏         | 2/128 [01:49<1:53:42, 54.15s/it]Best score increase :0.585 -> 0.671
training process:   2%|▏         | 3/128 [02:40<1:49:27, 52.54s/it]Best score increase :0.671 -> 0.727
training process:   3%|▎         | 4/128 [03:32<1:48:12, 52.36s/it]Best score increase :0.727 -> 0.786
epoch : 5, train loss : 0.007, valid loss : 0.005, train acc : 0.851, valid acc : 0.908, train f1 : 0.851, valid f1 : 0.776
training process:   4%|▍         | 5/128 [04:31<1:52:01, 54.64s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [05:24<1:50:21, 54.28s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▌         | 7/128 [06:16<1:47:23, 53.25s/it]EarlyStopping counter : 3 out of 12
training process:   6%|▋         | 8/128 [07:09<1:46:38, 53.32s/it]Best score increase :0.786 -> 0.796
epoch : 9, train loss : 0.006, valid loss : 0.004, train acc : 0.873, valid acc : 0.921, train f1 : 0.873, valid f1 : 0.799
training process:   7%|▋         | 9/128 [08:11<1:51:01, 55.98s/it]Best score increase :0.796 -> 0.799
training process:   8%|▊         | 10/128 [09:00<1:45:47, 53.79s/it]Best score increase :0.799 -> 0.801
training process:   9%|▊         | 11/128 [09:46<1:40:06, 51.34s/it]Best score increase :0.801 -> 0.815
training process:   9%|▉         | 12/128 [10:34<1:37:42, 50.54s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.005, valid loss : 0.004, train acc : 0.891, valid acc : 0.913, train f1 : 0.891, valid f1 : 0.787
training process:  10%|█         | 13/128 [11:27<1:38:22, 51.32s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [12:13<1:34:29, 49.73s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [12:58<1:30:37, 48.12s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [13:43<1:28:25, 47.37s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.004, train acc : 0.899, valid acc : 0.927, train f1 : 0.899, valid f1 : 0.811
training process:  13%|█▎        | 17/128 [14:40<1:32:29, 50.00s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [15:29<1:31:07, 49.70s/it]EarlyStopping counter : 7 out of 12
training process:  15%|█▍        | 19/128 [16:17<1:29:44, 49.40s/it]EarlyStopping counter : 8 out of 12
training process:  16%|█▌        | 20/128 [17:07<1:28:59, 49.44s/it]EarlyStopping counter : 9 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.004, train acc : 0.909, valid acc : 0.928, train f1 : 0.909, valid f1 : 0.814
training process:  16%|█▋        | 21/128 [18:06<1:33:29, 52.43s/it]EarlyStopping counter : 10 out of 12
training process:  17%|█▋        | 22/128 [18:57<1:31:42, 51.91s/it]EarlyStopping counter : 11 out of 12
training process:  17%|█▋        | 22/128 [19:49<1:35:33, 54.09s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 22, best f1 score : 0.815
training process finished, best loss : 0.004 and best acc : 0.930, best f1 : 0.815, best epoch : 10

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.46      0.81      0.59       580
           1       0.98      0.92      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.72      0.87      0.77      7398
weighted avg       0.94      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.77, test AUC : 0.87, test loss : 0.246

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:06<01:16,  6.95s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:10,  7.05s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.61s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<01:00,  7.55s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:53,  7.58s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.63s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.54s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.59s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:24,  8.21s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:17,  8.55s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:08,  8.36s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  8.22s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.91s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 18/306 [00:00<00:01, 173.09it/s] 13%|█▎        | 41/306 [00:00<00:01, 204.70it/s] 21%|██        | 64/306 [00:00<00:01, 215.19it/s] 28%|██▊       | 87/306 [00:00<00:00, 220.55it/s] 36%|███▌      | 110/306 [00:00<00:00, 220.66it/s] 44%|████▍     | 134/306 [00:00<00:00, 226.44it/s] 51%|█████▏    | 157/306 [00:00<00:00, 226.16it/s] 59%|█████▉    | 180/306 [00:00<00:00, 222.93it/s] 66%|██████▋   | 203/306 [00:00<00:00, 215.17it/s] 74%|███████▎  | 225/306 [00:01<00:00, 213.04it/s] 81%|████████  | 247/306 [00:01<00:00, 209.91it/s] 88%|████████▊ | 269/306 [00:01<00:00, 211.37it/s] 95%|█████████▌| 291/306 [00:01<00:00, 210.13it/s]100%|██████████| 306/306 [00:01<00:00, 214.61it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 57/553 [00:00<00:00, 563.31it/s]extract the null data:  21%|██        | 114/553 [00:00<00:00, 564.03it/s]extract the null data:  31%|███▏      | 174/553 [00:00<00:00, 579.89it/s]extract the null data:  43%|████▎     | 240/553 [00:00<00:00, 609.87it/s]extract the null data:  55%|█████▌    | 305/553 [00:00<00:00, 621.08it/s]extract the null data:  67%|██████▋   | 368/553 [00:00<00:00, 621.02it/s]extract the null data:  78%|███████▊  | 431/553 [00:00<00:00, 616.21it/s]extract the null data:  90%|████████▉ | 496/553 [00:00<00:00, 623.86it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 611.86it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 145.47it/s]replace nan value:   5%|▌         | 30/553 [00:00<00:03, 147.16it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:03, 161.56it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 174.34it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 185.21it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 189.19it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 188.99it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 191.03it/s]replace nan value:  30%|███       | 168/553 [00:00<00:01, 192.78it/s]replace nan value:  34%|███▍      | 188/553 [00:01<00:01, 192.59it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 195.24it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 195.55it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 195.11it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 199.14it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 204.21it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 206.05it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 206.69it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:00, 208.29it/s]replace nan value:  69%|██████▊   | 379/553 [00:01<00:00, 211.08it/s]replace nan value:  73%|███████▎  | 401/553 [00:02<00:00, 210.14it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 209.52it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 210.24it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 212.95it/s]replace nan value:  89%|████████▊ | 490/553 [00:02<00:00, 216.93it/s]replace nan value:  93%|█████████▎| 513/553 [00:02<00:00, 220.62it/s]replace nan value:  97%|█████████▋| 536/553 [00:02<00:00, 220.86it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 201.75it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.85it/s]  6%|▌         | 31/553 [00:00<00:03, 150.05it/s]  8%|▊         | 47/553 [00:00<00:04, 125.93it/s] 11%|█         | 61/553 [00:00<00:03, 126.48it/s] 14%|█▍        | 77/553 [00:00<00:03, 133.80it/s] 17%|█▋        | 93/553 [00:00<00:03, 137.72it/s] 20%|█▉        | 109/553 [00:00<00:03, 143.03it/s] 23%|██▎       | 125/553 [00:00<00:02, 147.07it/s] 26%|██▌       | 144/553 [00:00<00:02, 159.12it/s] 30%|██▉       | 164/553 [00:01<00:02, 169.52it/s] 33%|███▎      | 182/553 [00:01<00:02, 170.83it/s] 37%|███▋      | 202/553 [00:01<00:01, 176.01it/s] 40%|███▉      | 220/553 [00:01<00:01, 171.09it/s] 43%|████▎     | 238/553 [00:01<00:01, 172.43it/s] 46%|████▋     | 256/553 [00:01<00:01, 163.82it/s] 49%|████▉     | 273/553 [00:01<00:01, 160.30it/s] 53%|█████▎    | 291/553 [00:01<00:01, 162.05it/s] 56%|█████▌    | 308/553 [00:01<00:01, 153.25it/s] 59%|█████▊    | 324/553 [00:02<00:01, 152.19it/s] 62%|██████▏   | 341/553 [00:02<00:01, 154.95it/s] 65%|██████▍   | 357/553 [00:02<00:01, 149.63it/s] 68%|██████▊   | 375/553 [00:02<00:01, 154.60it/s] 71%|███████   | 391/553 [00:02<00:01, 140.89it/s] 74%|███████▎  | 407/553 [00:02<00:01, 144.06it/s] 76%|███████▋  | 422/553 [00:02<00:00, 144.04it/s] 79%|███████▉  | 437/553 [00:02<00:00, 142.24it/s] 82%|████████▏ | 456/553 [00:02<00:00, 155.00it/s] 86%|████████▌ | 474/553 [00:03<00:00, 160.08it/s] 89%|████████▉ | 491/553 [00:03<00:00, 147.73it/s] 92%|█████████▏| 507/553 [00:03<00:00, 143.90it/s] 94%|█████████▍| 522/553 [00:03<00:00, 140.09it/s] 97%|█████████▋| 537/553 [00:03<00:00, 128.31it/s]100%|█████████▉| 551/553 [00:03<00:00, 117.85it/s]100%|██████████| 553/553 [00:03<00:00, 147.17it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 348.21it/s]extract the null data:  76%|███████▋  | 106/139 [00:00<00:00, 559.71it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 559.27it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▊        | 26/139 [00:00<00:00, 257.21it/s]replace nan value:  38%|███▊      | 53/139 [00:00<00:00, 260.25it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 250.75it/s]replace nan value:  76%|███████▋  | 106/139 [00:00<00:00, 248.32it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 249.05it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 251.40it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 128.95it/s] 22%|██▏       | 30/139 [00:00<00:00, 139.51it/s] 35%|███▍      | 48/139 [00:00<00:00, 148.74it/s] 45%|████▌     | 63/139 [00:00<00:00, 141.27it/s] 56%|█████▌    | 78/139 [00:00<00:00, 137.32it/s] 66%|██████▌   | 92/139 [00:00<00:00, 131.28it/s] 76%|███████▋  | 106/139 [00:00<00:00, 131.16it/s] 88%|████████▊ | 123/139 [00:00<00:00, 141.59it/s] 99%|█████████▉| 138/139 [00:00<00:00, 138.67it/s]100%|██████████| 139/139 [00:01<00:00, 138.29it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 218.35it/s]extract the null data:  57%|█████▋    | 98/173 [00:00<00:00, 534.19it/s]extract the null data:  99%|█████████▉| 171/173 [00:00<00:00, 622.96it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 568.05it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 240.74it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 242.57it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 248.09it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 245.77it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 240.48it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 236.87it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 238.43it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 144.01it/s] 17%|█▋        | 30/173 [00:00<00:01, 124.93it/s] 26%|██▌       | 45/173 [00:00<00:00, 134.96it/s] 35%|███▌      | 61/173 [00:00<00:00, 140.45it/s] 44%|████▍     | 76/173 [00:00<00:00, 138.91it/s] 53%|█████▎    | 92/173 [00:00<00:00, 140.76it/s] 62%|██████▏   | 108/173 [00:00<00:00, 144.39it/s] 71%|███████   | 123/173 [00:00<00:00, 144.46it/s] 80%|████████  | 139/173 [00:00<00:00, 147.12it/s] 89%|████████▉ | 154/173 [00:01<00:00, 135.78it/s] 97%|█████████▋| 168/173 [00:01<00:00, 109.59it/s]100%|██████████| 173/173 [00:01<00:00, 125.64it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.544, valid acc : 0.624, train f1 : 0.453, valid f1 : 0.509
training process:   1%|          | 1/128 [00:56<1:59:54, 56.65s/it]Best score increase :0.000 -> 0.509
training process:   2%|▏         | 2/128 [01:59<2:06:35, 60.28s/it]Best score increase :0.509 -> 0.639
training process:   2%|▏         | 3/128 [02:57<2:03:25, 59.25s/it]Best score increase :0.639 -> 0.701
training process:   3%|▎         | 4/128 [03:53<2:00:03, 58.10s/it]Best score increase :0.701 -> 0.738
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.834, valid acc : 0.922, train f1 : 0.674, valid f1 : 0.785
training process:   4%|▍         | 5/128 [04:56<2:02:37, 59.82s/it]Best score increase :0.738 -> 0.785
training process:   5%|▍         | 6/128 [05:59<2:03:36, 60.79s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:57<2:00:56, 59.97s/it]Best score increase :0.785 -> 0.813
training process:   6%|▋         | 8/128 [07:52<1:56:40, 58.34s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.892, valid acc : 0.937, train f1 : 0.741, valid f1 : 0.810
training process:   7%|▋         | 9/128 [08:59<2:00:46, 60.89s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [09:53<1:56:08, 59.05s/it]Best score increase :0.813 -> 0.818
training process:   9%|▊         | 11/128 [10:47<1:52:08, 57.51s/it]Best score increase :0.818 -> 0.830
training process:   9%|▉         | 12/128 [11:42<1:49:37, 56.70s/it]Best score increase :0.830 -> 0.832
epoch : 13, train loss : 0.006, valid loss : 0.007, train acc : 0.909, valid acc : 0.945, train f1 : 0.770, valid f1 : 0.830
training process:  10%|█         | 13/128 [12:49<1:54:21, 59.67s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [13:40<1:48:45, 57.24s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [14:34<1:45:37, 56.09s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [15:28<1:43:36, 55.51s/it]Best score increase :0.832 -> 0.840
epoch : 17, train loss : 0.006, valid loss : 0.007, train acc : 0.920, valid acc : 0.949, train f1 : 0.788, valid f1 : 0.835
training process:  13%|█▎        | 17/128 [16:32<1:47:24, 58.06s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [17:29<1:46:05, 57.87s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [18:29<1:45:49, 58.25s/it]Best score increase :0.840 -> 0.850
training process:  16%|█▌        | 20/128 [19:25<1:43:41, 57.61s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.007, train acc : 0.927, valid acc : 0.951, train f1 : 0.803, valid f1 : 0.838
training process:  16%|█▋        | 21/128 [20:31<1:47:24, 60.22s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [21:30<1:45:34, 59.76s/it]EarlyStopping counter : 3 out of 12
training process:  18%|█▊        | 23/128 [22:25<1:42:28, 58.56s/it]Best score increase :0.850 -> 0.856
training process:  19%|█▉        | 24/128 [23:32<1:45:45, 61.01s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.007, train acc : 0.932, valid acc : 0.950, train f1 : 0.813, valid f1 : 0.848
training process:  20%|█▉        | 25/128 [24:51<1:53:46, 66.27s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [25:57<1:52:30, 66.18s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [26:59<1:49:31, 65.06s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 28/128 [28:12<1:52:25, 67.46s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.007, train acc : 0.937, valid acc : 0.952, train f1 : 0.823, valid f1 : 0.850
training process:  23%|██▎       | 29/128 [29:34<1:58:31, 71.84s/it]EarlyStopping counter : 6 out of 12
training process:  23%|██▎       | 30/128 [30:47<1:57:40, 72.05s/it]Best score increase :0.856 -> 0.857
training process:  24%|██▍       | 31/128 [32:12<2:03:06, 76.15s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [33:46<2:09:58, 81.23s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.009, train acc : 0.943, valid acc : 0.956, train f1 : 0.834, valid f1 : 0.848
training process:  26%|██▌       | 33/128 [35:26<2:17:39, 86.94s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 34/128 [36:52<2:15:45, 86.66s/it]EarlyStopping counter : 4 out of 12
training process:  27%|██▋       | 35/128 [38:17<2:13:44, 86.28s/it]EarlyStopping counter : 5 out of 12
training process:  28%|██▊       | 36/128 [39:42<2:11:35, 85.82s/it]EarlyStopping counter : 6 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.007, train acc : 0.940, valid acc : 0.957, train f1 : 0.831, valid f1 : 0.860
training process:  29%|██▉       | 37/128 [41:25<2:18:05, 91.05s/it]Best score increase :0.857 -> 0.860
training process:  30%|██▉       | 38/128 [42:49<2:13:21, 88.91s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [44:08<2:07:18, 85.83s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [45:28<2:03:36, 84.28s/it]Best score increase :0.860 -> 0.863
epoch : 41, train loss : 0.004, valid loss : 0.007, train acc : 0.941, valid acc : 0.947, train f1 : 0.833, valid f1 : 0.843
training process:  32%|███▏      | 41/128 [46:57<2:04:04, 85.57s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [48:13<1:58:29, 82.67s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [49:21<1:51:06, 78.43s/it]Best score increase :0.863 -> 0.866
training process:  34%|███▍      | 44/128 [50:31<1:46:14, 75.89s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.004, valid loss : 0.008, train acc : 0.947, valid acc : 0.957, train f1 : 0.846, valid f1 : 0.858
training process:  35%|███▌      | 45/128 [51:53<1:47:32, 77.74s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [53:06<1:43:54, 76.03s/it]EarlyStopping counter : 3 out of 12
training process:  37%|███▋      | 47/128 [54:19<1:41:26, 75.14s/it]EarlyStopping counter : 4 out of 12
training process:  38%|███▊      | 48/128 [55:32<1:39:36, 74.70s/it]EarlyStopping counter : 5 out of 12
epoch : 49, train loss : 0.004, valid loss : 0.008, train acc : 0.948, valid acc : 0.956, train f1 : 0.848, valid f1 : 0.857
training process:  38%|███▊      | 49/128 [57:05<1:45:20, 80.00s/it]EarlyStopping counter : 6 out of 12
training process:  39%|███▉      | 50/128 [58:28<1:45:08, 80.88s/it]EarlyStopping counter : 7 out of 12
training process:  40%|███▉      | 51/128 [59:40<1:40:42, 78.48s/it]EarlyStopping counter : 8 out of 12
training process:  41%|████      | 52/128 [1:00:56<1:38:07, 77.47s/it]EarlyStopping counter : 9 out of 12
epoch : 53, train loss : 0.004, valid loss : 0.008, train acc : 0.950, valid acc : 0.960, train f1 : 0.854, valid f1 : 0.868
training process:  41%|████▏     | 53/128 [1:02:17<1:38:08, 78.51s/it]Best score increase :0.866 -> 0.868
training process:  42%|████▏     | 54/128 [1:03:27<1:33:53, 76.13s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [1:04:39<1:31:05, 74.87s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [1:05:52<1:29:16, 74.39s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.004, valid loss : 0.008, train acc : 0.950, valid acc : 0.961, train f1 : 0.854, valid f1 : 0.867
training process:  45%|████▍     | 57/128 [1:07:14<1:30:29, 76.47s/it]EarlyStopping counter : 4 out of 12
training process:  45%|████▌     | 58/128 [1:08:29<1:28:44, 76.07s/it]EarlyStopping counter : 5 out of 12
training process:  46%|████▌     | 59/128 [1:09:40<1:25:56, 74.73s/it]EarlyStopping counter : 6 out of 12
training process:  47%|████▋     | 60/128 [1:10:52<1:23:42, 73.86s/it]EarlyStopping counter : 7 out of 12
epoch : 61, train loss : 0.004, valid loss : 0.008, train acc : 0.950, valid acc : 0.958, train f1 : 0.854, valid f1 : 0.864
training process:  48%|████▊     | 61/128 [1:12:17<1:26:16, 77.26s/it]EarlyStopping counter : 8 out of 12
training process:  48%|████▊     | 62/128 [1:13:30<1:23:21, 75.78s/it]EarlyStopping counter : 9 out of 12
training process:  49%|████▉     | 63/128 [1:14:44<1:21:34, 75.30s/it]EarlyStopping counter : 10 out of 12
training process:  50%|█████     | 64/128 [1:15:56<1:19:22, 74.42s/it]Best score increase :0.868 -> 0.869
epoch : 65, train loss : 0.004, valid loss : 0.008, train acc : 0.951, valid acc : 0.960, train f1 : 0.857, valid f1 : 0.864
training process:  51%|█████     | 65/128 [1:17:19<1:20:52, 77.03s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:18:32<1:18:12, 75.69s/it]Best score increase :0.869 -> 0.873
training process:  52%|█████▏    | 67/128 [1:19:41<1:14:58, 73.74s/it]EarlyStopping counter : 1 out of 12
training process:  53%|█████▎    | 68/128 [1:20:51<1:12:28, 72.47s/it]EarlyStopping counter : 2 out of 12
epoch : 69, train loss : 0.004, valid loss : 0.007, train acc : 0.955, valid acc : 0.961, train f1 : 0.865, valid f1 : 0.873
training process:  54%|█████▍    | 69/128 [1:22:14<1:14:32, 75.80s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▍    | 70/128 [1:23:28<1:12:34, 75.08s/it]Best score increase :0.873 -> 0.875
training process:  55%|█████▌    | 71/128 [1:24:39<1:10:10, 73.87s/it]EarlyStopping counter : 1 out of 12
training process:  56%|█████▋    | 72/128 [1:25:48<1:07:37, 72.45s/it]EarlyStopping counter : 2 out of 12
epoch : 73, train loss : 0.004, valid loss : 0.007, train acc : 0.956, valid acc : 0.963, train f1 : 0.868, valid f1 : 0.876
training process:  57%|█████▋    | 73/128 [1:27:10<1:09:07, 75.41s/it]Best score increase :0.875 -> 0.876
training process:  58%|█████▊    | 74/128 [1:28:26<1:07:52, 75.41s/it]EarlyStopping counter : 1 out of 12
training process:  59%|█████▊    | 75/128 [1:29:38<1:05:44, 74.42s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▉    | 76/128 [1:30:48<1:03:30, 73.28s/it]EarlyStopping counter : 3 out of 12
epoch : 77, train loss : 0.004, valid loss : 0.009, train acc : 0.957, valid acc : 0.961, train f1 : 0.871, valid f1 : 0.866
training process:  60%|██████    | 77/128 [1:32:09<1:04:11, 75.52s/it]EarlyStopping counter : 4 out of 12
training process:  61%|██████    | 78/128 [1:33:19<1:01:30, 73.81s/it]Best score increase :0.876 -> 0.880
training process:  62%|██████▏   | 79/128 [1:34:46<1:03:30, 77.77s/it]EarlyStopping counter : 1 out of 12
training process:  62%|██████▎   | 80/128 [1:35:55<1:00:12, 75.27s/it]EarlyStopping counter : 2 out of 12
epoch : 81, train loss : 0.004, valid loss : 0.008, train acc : 0.956, valid acc : 0.962, train f1 : 0.869, valid f1 : 0.876
training process:  63%|██████▎   | 81/128 [1:37:15<1:00:02, 76.64s/it]EarlyStopping counter : 3 out of 12
training process:  64%|██████▍   | 82/128 [1:38:25<57:18, 74.75s/it]  EarlyStopping counter : 4 out of 12
training process:  65%|██████▍   | 83/128 [1:39:36<55:10, 73.56s/it]EarlyStopping counter : 5 out of 12
training process:  66%|██████▌   | 84/128 [1:40:47<53:20, 72.73s/it]EarlyStopping counter : 6 out of 12
epoch : 85, train loss : 0.004, valid loss : 0.008, train acc : 0.957, valid acc : 0.961, train f1 : 0.870, valid f1 : 0.874
training process:  66%|██████▋   | 85/128 [1:42:09<54:10, 75.60s/it]EarlyStopping counter : 7 out of 12
training process:  67%|██████▋   | 86/128 [1:43:18<51:32, 73.63s/it]EarlyStopping counter : 8 out of 12
training process:  68%|██████▊   | 87/128 [1:44:27<49:12, 72.02s/it]EarlyStopping counter : 9 out of 12
training process:  69%|██████▉   | 88/128 [1:45:36<47:27, 71.19s/it]EarlyStopping counter : 10 out of 12
epoch : 89, train loss : 0.004, valid loss : 0.009, train acc : 0.958, valid acc : 0.963, train f1 : 0.874, valid f1 : 0.873
training process:  70%|██████▉   | 89/128 [1:46:57<48:13, 74.19s/it]EarlyStopping counter : 11 out of 12
training process:  70%|██████▉   | 89/128 [1:48:08<47:23, 72.90s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 89, best f1 score : 0.880
training process finished, best loss : 0.007 and best acc : 0.963, best f1 : 0.880, best epoch : 77

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.80      0.77      0.79       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.89      0.88      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.88, test loss : 0.476

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:50, 10.01s/it]processing for feature importance:  17%|█▋        | 2/12 [00:19<01:35,  9.54s/it]processing for feature importance:  25%|██▌       | 3/12 [00:30<01:31, 10.19s/it]processing for feature importance:  33%|███▎      | 4/12 [00:41<01:24, 10.50s/it]processing for feature importance:  42%|████▏     | 5/12 [00:51<01:12, 10.42s/it]processing for feature importance:  50%|█████     | 6/12 [01:01<01:01, 10.22s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:11<00:51, 10.31s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:21<00:40, 10.23s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:32<00:30, 10.25s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:41<00:20, 10.07s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:52<00:10, 10.40s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.33s/it]processing for feature importance: 100%|██████████| 12/12 [02:03<00:00, 10.26s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  2%|▏         | 7/306 [00:00<00:04, 68.81it/s] 10%|▉         | 30/306 [00:00<00:01, 160.71it/s] 17%|█▋        | 53/306 [00:00<00:01, 189.14it/s] 25%|██▍       | 76/306 [00:00<00:01, 204.26it/s] 32%|███▏      | 97/306 [00:00<00:01, 188.66it/s] 38%|███▊      | 117/306 [00:00<00:01, 142.69it/s] 43%|████▎     | 133/306 [00:00<00:01, 127.76it/s] 48%|████▊     | 147/306 [00:01<00:01, 129.60it/s] 53%|█████▎    | 161/306 [00:01<00:01, 118.73it/s] 57%|█████▋    | 174/306 [00:01<00:01, 119.24it/s] 61%|██████    | 187/306 [00:01<00:00, 121.20it/s] 67%|██████▋   | 206/306 [00:01<00:00, 135.03it/s] 74%|███████▎  | 225/306 [00:01<00:00, 149.37it/s] 79%|███████▉  | 241/306 [00:01<00:00, 151.07it/s] 85%|████████▍ | 260/306 [00:01<00:00, 161.59it/s] 91%|█████████ | 277/306 [00:01<00:00, 159.46it/s] 96%|█████████▌| 294/306 [00:02<00:00, 143.98it/s]100%|██████████| 306/306 [00:02<00:00, 142.75it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_RW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 486.00it/s]extract the null data:  18%|█▊        | 102/553 [00:00<00:00, 509.05it/s]extract the null data:  28%|██▊       | 156/553 [00:00<00:00, 519.96it/s]extract the null data:  38%|███▊      | 208/553 [00:00<00:01, 344.72it/s]extract the null data:  45%|████▌     | 249/553 [00:00<00:00, 316.55it/s]extract the null data:  52%|█████▏    | 285/553 [00:00<00:00, 283.72it/s]extract the null data:  57%|█████▋    | 317/553 [00:00<00:00, 285.86it/s]extract the null data:  63%|██████▎   | 348/553 [00:01<00:00, 290.54it/s]extract the null data:  73%|███████▎  | 401/553 [00:01<00:00, 353.11it/s]extract the null data:  82%|████████▏ | 456/553 [00:01<00:00, 406.49it/s]extract the null data:  92%|█████████▏| 510/553 [00:01<00:00, 442.47it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 383.54it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 12/553 [00:00<00:04, 117.76it/s]replace nan value:   5%|▌         | 29/553 [00:00<00:03, 139.50it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:04, 118.50it/s]replace nan value:  11%|█         | 62/553 [00:00<00:03, 141.33it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:03, 146.00it/s]replace nan value:  17%|█▋        | 94/553 [00:00<00:03, 149.32it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:03, 147.10it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 143.56it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 146.54it/s]replace nan value:  29%|██▉       | 159/553 [00:01<00:02, 152.36it/s]replace nan value:  32%|███▏      | 175/553 [00:01<00:02, 153.09it/s]replace nan value:  35%|███▍      | 191/553 [00:01<00:02, 144.82it/s]replace nan value:  37%|███▋      | 206/553 [00:01<00:02, 142.97it/s]replace nan value:  40%|████      | 222/553 [00:01<00:02, 145.99it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:02, 148.06it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:02, 149.38it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 143.89it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 155.84it/s]replace nan value:  55%|█████▍    | 304/553 [00:02<00:01, 155.70it/s]replace nan value:  58%|█████▊    | 322/553 [00:02<00:01, 162.31it/s]replace nan value:  62%|██████▏   | 341/553 [00:02<00:01, 168.76it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 173.14it/s]replace nan value:  69%|██████▊   | 379/553 [00:02<00:00, 176.65it/s]replace nan value:  72%|███████▏  | 397/553 [00:02<00:00, 177.41it/s]replace nan value:  75%|███████▌  | 416/553 [00:02<00:00, 179.74it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 179.28it/s]replace nan value:  82%|████████▏ | 452/553 [00:02<00:00, 169.95it/s]replace nan value:  85%|████████▍ | 470/553 [00:03<00:00, 159.66it/s]replace nan value:  88%|████████▊ | 487/553 [00:03<00:00, 151.39it/s]replace nan value:  91%|█████████ | 503/553 [00:03<00:00, 134.25it/s]replace nan value:  94%|█████████▍| 520/553 [00:03<00:00, 136.23it/s]replace nan value:  97%|█████████▋| 537/553 [00:03<00:00, 143.27it/s]replace nan value: 100%|█████████▉| 552/553 [00:03<00:00, 130.35it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 150.10it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 110.35it/s]  4%|▍         | 24/553 [00:00<00:04, 115.81it/s]  7%|▋         | 36/553 [00:00<00:04, 109.85it/s]  9%|▊         | 48/553 [00:00<00:05, 93.36it/s]  10%|█         | 58/553 [00:00<00:05, 95.33it/s] 12%|█▏        | 68/553 [00:00<00:05, 94.01it/s] 14%|█▍        | 79/553 [00:00<00:04, 97.45it/s] 16%|█▋        | 91/553 [00:00<00:04, 103.63it/s] 18%|█▊        | 102/553 [00:01<00:05, 84.75it/s] 20%|██        | 112/553 [00:01<00:05, 85.47it/s] 22%|██▏       | 121/553 [00:01<00:05, 81.14it/s] 24%|██▎       | 130/553 [00:01<00:05, 82.46it/s] 27%|██▋       | 148/553 [00:01<00:03, 107.75it/s] 30%|██▉       | 164/553 [00:01<00:03, 120.87it/s] 33%|███▎      | 180/553 [00:01<00:02, 130.75it/s] 35%|███▌      | 194/553 [00:01<00:02, 125.20it/s] 38%|███▊      | 211/553 [00:01<00:02, 136.23it/s] 41%|████      | 225/553 [00:02<00:02, 129.29it/s] 43%|████▎     | 239/553 [00:02<00:02, 130.05it/s] 46%|████▌     | 253/553 [00:02<00:02, 119.97it/s] 48%|████▊     | 266/553 [00:02<00:02, 118.19it/s] 50%|█████     | 279/553 [00:02<00:02, 119.59it/s] 53%|█████▎    | 293/553 [00:02<00:02, 122.11it/s] 55%|█████▌    | 306/553 [00:02<00:02, 119.45it/s] 58%|█████▊    | 319/553 [00:02<00:01, 120.38it/s] 60%|██████    | 332/553 [00:02<00:01, 119.86it/s] 62%|██████▏   | 345/553 [00:03<00:01, 122.51it/s] 65%|██████▍   | 358/553 [00:03<00:01, 123.17it/s] 67%|██████▋   | 371/553 [00:03<00:01, 123.74it/s] 70%|██████▉   | 385/553 [00:03<00:01, 122.69it/s] 72%|███████▏  | 398/553 [00:03<00:01, 111.51it/s] 75%|███████▍  | 414/553 [00:03<00:01, 120.97it/s] 77%|███████▋  | 427/553 [00:03<00:01, 83.62it/s]  80%|████████  | 443/553 [00:04<00:01, 98.69it/s] 83%|████████▎ | 458/553 [00:04<00:00, 109.61it/s] 86%|████████▌ | 473/553 [00:04<00:00, 117.95it/s] 88%|████████▊ | 487/553 [00:04<00:00, 117.90it/s] 90%|█████████ | 500/553 [00:04<00:00, 111.27it/s] 93%|█████████▎| 512/553 [00:04<00:00, 100.06it/s] 95%|█████████▍| 523/553 [00:04<00:00, 93.59it/s]  96%|█████████▋| 533/553 [00:04<00:00, 84.66it/s] 99%|█████████▉| 548/553 [00:05<00:00, 98.96it/s]100%|██████████| 553/553 [00:05<00:00, 106.79it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 22/139 [00:00<00:00, 215.92it/s]extract the null data:  51%|█████     | 71/139 [00:00<00:00, 374.82it/s]extract the null data:  80%|███████▉  | 111/139 [00:00<00:00, 386.02it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 349.25it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 174.27it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 159.81it/s]replace nan value:  38%|███▊      | 53/139 [00:00<00:00, 157.33it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 154.28it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 120.81it/s]replace nan value:  73%|███████▎  | 101/139 [00:00<00:00, 129.63it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 129.75it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 142.41it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 142.33it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 102.45it/s] 16%|█▌        | 22/139 [00:00<00:01, 105.26it/s] 26%|██▌       | 36/139 [00:00<00:00, 118.28it/s] 35%|███▍      | 48/139 [00:00<00:00, 117.71it/s] 43%|████▎     | 60/139 [00:00<00:00, 101.11it/s] 51%|█████     | 71/139 [00:00<00:00, 89.02it/s]  59%|█████▉    | 82/139 [00:00<00:00, 92.95it/s] 66%|██████▌   | 92/139 [00:00<00:00, 86.70it/s] 76%|███████▌  | 105/139 [00:01<00:00, 94.16it/s] 84%|████████▍ | 117/139 [00:01<00:00, 99.87it/s] 92%|█████████▏| 128/139 [00:01<00:00, 99.15it/s]100%|██████████| 139/139 [00:01<00:00, 100.96it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   8%|▊         | 13/173 [00:00<00:01, 129.61it/s]extract the null data:  20%|██        | 35/173 [00:00<00:00, 180.61it/s]extract the null data:  50%|█████     | 87/173 [00:00<00:00, 333.06it/s]extract the null data:  84%|████████▍ | 145/173 [00:00<00:00, 427.26it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 350.19it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:   5%|▌         | 9/173 [00:00<00:02, 77.59it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:01, 121.50it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 147.06it/s]replace nan value:  36%|███▌      | 62/173 [00:00<00:00, 161.72it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 169.09it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 169.02it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 172.80it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 172.50it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 174.68it/s]replace nan value:  99%|█████████▉| 172/173 [00:01<00:00, 174.64it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 164.46it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▍         | 8/173 [00:00<00:02, 69.04it/s] 10%|▉         | 17/173 [00:00<00:02, 72.89it/s] 14%|█▍        | 25/173 [00:00<00:01, 74.53it/s] 24%|██▎       | 41/173 [00:00<00:01, 104.71it/s] 33%|███▎      | 57/173 [00:00<00:00, 123.28it/s] 40%|████      | 70/173 [00:00<00:00, 122.44it/s] 48%|████▊     | 83/173 [00:00<00:00, 124.13it/s] 55%|█████▌    | 96/173 [00:00<00:00, 122.27it/s] 63%|██████▎   | 109/173 [00:00<00:00, 117.35it/s] 70%|██████▉   | 121/173 [00:01<00:00, 116.94it/s] 77%|███████▋  | 133/173 [00:01<00:00, 104.21it/s] 83%|████████▎ | 144/173 [00:01<00:00, 100.52it/s] 90%|████████▉ | 155/173 [00:01<00:00, 97.26it/s]  95%|█████████▌| 165/173 [00:01<00:00, 92.22it/s]100%|██████████| 173/173 [00:01<00:00, 96.87it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.012, train acc : 0.684, valid acc : 0.463, train f1 : 0.674, valid f1 : 0.407
training process:   1%|          | 1/128 [01:31<3:14:36, 91.94s/it]Best score increase :0.000 -> 0.407
training process:   2%|▏         | 2/128 [02:41<2:45:28, 78.80s/it]Best score increase :0.407 -> 0.416
training process:   2%|▏         | 3/128 [03:52<2:36:35, 75.17s/it]EarlyStopping counter : 1 out of 12
training process:   3%|▎         | 4/128 [05:00<2:29:58, 72.57s/it]EarlyStopping counter : 2 out of 12
epoch : 5, train loss : 0.003, valid loss : 0.013, train acc : 0.726, valid acc : 0.487, train f1 : 0.706, valid f1 : 0.427
training process:   4%|▍         | 5/128 [06:19<2:33:09, 74.71s/it]Best score increase :0.416 -> 0.427
training process:   5%|▍         | 6/128 [07:27<2:27:36, 72.59s/it]Best score increase :0.427 -> 0.435
training process:   5%|▌         | 7/128 [08:34<2:22:15, 70.54s/it]Best score increase :0.435 -> 0.451
training process:   6%|▋         | 8/128 [09:38<2:17:21, 68.68s/it]Best score increase :0.451 -> 0.461
epoch : 9, train loss : 0.003, valid loss : 0.012, train acc : 0.754, valid acc : 0.545, train f1 : 0.738, valid f1 : 0.468
training process:   7%|▋         | 9/128 [10:57<2:22:04, 71.63s/it]Best score increase :0.461 -> 0.468
training process:   8%|▊         | 10/128 [11:58<2:14:48, 68.55s/it]Best score increase :0.468 -> 0.498
training process:   9%|▊         | 11/128 [13:06<2:12:59, 68.20s/it]Best score increase :0.498 -> 0.505
training process:   9%|▉         | 12/128 [14:09<2:09:04, 66.77s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.002, valid loss : 0.011, train acc : 0.780, valid acc : 0.610, train f1 : 0.770, valid f1 : 0.512
training process:  10%|█         | 13/128 [15:21<2:11:10, 68.44s/it]Best score increase :0.505 -> 0.512
training process:  11%|█         | 14/128 [16:20<2:04:08, 65.34s/it]Best score increase :0.512 -> 0.527
training process:  12%|█▏        | 15/128 [17:22<2:01:23, 64.45s/it]Best score increase :0.527 -> 0.542
training process:  12%|█▎        | 16/128 [18:29<2:01:31, 65.11s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.009, train acc : 0.802, valid acc : 0.693, train f1 : 0.795, valid f1 : 0.572
training process:  13%|█▎        | 17/128 [19:31<1:59:01, 64.33s/it]Best score increase :0.542 -> 0.572
training process:  14%|█▍        | 18/128 [20:26<1:52:50, 61.55s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [21:29<1:52:30, 61.93s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [22:32<1:51:47, 62.11s/it]Best score increase :0.572 -> 0.593
epoch : 21, train loss : 0.002, valid loss : 0.008, train acc : 0.828, valid acc : 0.736, train f1 : 0.824, valid f1 : 0.606
training process:  16%|█▋        | 21/128 [23:48<1:58:17, 66.33s/it]Best score increase :0.593 -> 0.606
training process:  17%|█▋        | 22/128 [24:53<1:56:43, 66.07s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [26:00<1:56:01, 66.30s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [27:08<1:55:51, 66.84s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.009, train acc : 0.837, valid acc : 0.738, train f1 : 0.833, valid f1 : 0.607
training process:  20%|█▉        | 25/128 [28:29<2:02:01, 71.08s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [29:33<1:57:11, 68.93s/it]Best score increase :0.606 -> 0.643
training process:  21%|██        | 27/128 [30:39<1:54:21, 67.94s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [31:42<1:50:52, 66.52s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.008, train acc : 0.851, valid acc : 0.783, train f1 : 0.848, valid f1 : 0.646
training process:  23%|██▎       | 29/128 [32:54<1:52:39, 68.28s/it]Best score increase :0.643 -> 0.646
training process:  23%|██▎       | 30/128 [33:59<1:49:58, 67.33s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [35:04<1:47:36, 66.57s/it]Best score increase :0.646 -> 0.654
training process:  25%|██▌       | 32/128 [36:08<1:45:14, 65.78s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.008, train acc : 0.865, valid acc : 0.772, train f1 : 0.863, valid f1 : 0.635
training process:  26%|██▌       | 33/128 [37:24<1:49:09, 68.94s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [38:30<1:46:29, 67.98s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [39:33<1:43:11, 66.57s/it]EarlyStopping counter : 4 out of 12
training process:  28%|██▊       | 36/128 [40:41<1:42:32, 66.88s/it]Best score increase :0.654 -> 0.676
epoch : 37, train loss : 0.002, valid loss : 0.007, train acc : 0.871, valid acc : 0.807, train f1 : 0.870, valid f1 : 0.668
training process:  29%|██▉       | 37/128 [41:52<1:43:06, 67.98s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [42:41<1:33:33, 62.37s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [43:29<1:26:20, 58.21s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [44:19<1:21:27, 55.54s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.001, valid loss : 0.007, train acc : 0.882, valid acc : 0.813, train f1 : 0.881, valid f1 : 0.673
training process:  32%|███▏      | 41/128 [45:17<1:21:51, 56.46s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [46:05<1:17:02, 53.75s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [46:50<1:12:25, 51.13s/it]Best score increase :0.676 -> 0.695
training process:  34%|███▍      | 44/128 [47:34<1:08:50, 49.17s/it]EarlyStopping counter : 1 out of 12
epoch : 45, train loss : 0.001, valid loss : 0.007, train acc : 0.889, valid acc : 0.810, train f1 : 0.887, valid f1 : 0.670
training process:  35%|███▌      | 45/128 [48:27<1:09:36, 50.32s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 46/128 [49:12<1:06:21, 48.55s/it]Best score increase :0.695 -> 0.717
training process:  37%|███▋      | 47/128 [49:56<1:03:56, 47.36s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [50:43<1:02:40, 47.01s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.001, valid loss : 0.007, train acc : 0.895, valid acc : 0.830, train f1 : 0.894, valid f1 : 0.689
training process:  38%|███▊      | 49/128 [51:39<1:05:32, 49.78s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [52:28<1:04:38, 49.73s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [53:22<1:05:09, 50.77s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [54:11<1:03:58, 50.50s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.001, valid loss : 0.006, train acc : 0.899, valid acc : 0.859, train f1 : 0.899, valid f1 : 0.721
training process:  41%|████▏     | 53/128 [55:20<1:09:47, 55.83s/it]Best score increase :0.717 -> 0.721
training process:  42%|████▏     | 54/128 [56:18<1:09:40, 56.49s/it]EarlyStopping counter : 1 out of 12
training process:  43%|████▎     | 55/128 [57:15<1:09:10, 56.85s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 56/128 [58:15<1:09:15, 57.72s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.001, valid loss : 0.006, train acc : 0.901, valid acc : 0.852, train f1 : 0.900, valid f1 : 0.714
training process:  45%|████▍     | 57/128 [59:20<1:10:59, 60.00s/it]EarlyStopping counter : 4 out of 12
training process:  45%|████▌     | 58/128 [1:00:22<1:10:41, 60.59s/it]Best score increase :0.721 -> 0.725
training process:  46%|████▌     | 59/128 [1:01:23<1:09:46, 60.68s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [1:02:20<1:07:31, 59.58s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.001, valid loss : 0.006, train acc : 0.909, valid acc : 0.860, train f1 : 0.908, valid f1 : 0.723
training process:  48%|████▊     | 61/128 [1:03:29<1:09:32, 62.28s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [1:04:32<1:08:40, 62.44s/it]EarlyStopping counter : 4 out of 12
training process:  49%|████▉     | 63/128 [1:05:29<1:05:57, 60.88s/it]Best score increase :0.725 -> 0.748
training process:  50%|█████     | 64/128 [1:06:23<1:02:50, 58.92s/it]EarlyStopping counter : 1 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.007, train acc : 0.913, valid acc : 0.842, train f1 : 0.912, valid f1 : 0.704
training process:  51%|█████     | 65/128 [1:07:29<1:03:59, 60.94s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 66/128 [1:08:38<1:05:30, 63.39s/it]EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 67/128 [1:09:46<1:05:51, 64.77s/it]EarlyStopping counter : 4 out of 12
training process:  53%|█████▎    | 68/128 [1:10:49<1:04:13, 64.22s/it]EarlyStopping counter : 5 out of 12
epoch : 69, train loss : 0.001, valid loss : 0.006, train acc : 0.916, valid acc : 0.862, train f1 : 0.915, valid f1 : 0.726
training process:  54%|█████▍    | 69/128 [1:12:01<1:05:24, 66.52s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▍    | 70/128 [1:13:00<1:02:01, 64.16s/it]EarlyStopping counter : 7 out of 12
training process:  55%|█████▌    | 71/128 [1:14:02<1:00:33, 63.74s/it]EarlyStopping counter : 8 out of 12
training process:  56%|█████▋    | 72/128 [1:14:59<57:29, 61.60s/it]  Best score increase :0.748 -> 0.751
epoch : 73, train loss : 0.001, valid loss : 0.006, train acc : 0.921, valid acc : 0.874, train f1 : 0.921, valid f1 : 0.740
training process:  57%|█████▋    | 73/128 [1:15:59<56:09, 61.27s/it]EarlyStopping counter : 1 out of 12
training process:  58%|█████▊    | 74/128 [1:16:53<52:56, 58.82s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▊    | 75/128 [1:17:38<48:20, 54.73s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▉    | 76/128 [1:18:25<45:28, 52.48s/it]EarlyStopping counter : 4 out of 12
epoch : 77, train loss : 0.001, valid loss : 0.006, train acc : 0.922, valid acc : 0.887, train f1 : 0.922, valid f1 : 0.756
training process:  60%|██████    | 77/128 [1:19:25<46:28, 54.68s/it]Best score increase :0.751 -> 0.756
training process:  61%|██████    | 78/128 [1:20:17<44:54, 53.89s/it]EarlyStopping counter : 1 out of 12
training process:  62%|██████▏   | 79/128 [1:21:04<42:21, 51.87s/it]EarlyStopping counter : 2 out of 12
training process:  62%|██████▎   | 80/128 [1:21:55<41:17, 51.61s/it]EarlyStopping counter : 3 out of 12
epoch : 81, train loss : 0.001, valid loss : 0.006, train acc : 0.925, valid acc : 0.872, train f1 : 0.925, valid f1 : 0.737
training process:  63%|██████▎   | 81/128 [1:22:50<41:19, 52.75s/it]EarlyStopping counter : 4 out of 12
training process:  64%|██████▍   | 82/128 [1:23:43<40:27, 52.77s/it]EarlyStopping counter : 5 out of 12
training process:  65%|██████▍   | 83/128 [1:24:27<37:37, 50.17s/it]EarlyStopping counter : 6 out of 12
training process:  66%|██████▌   | 84/128 [1:25:16<36:24, 49.66s/it]Best score increase :0.756 -> 0.777
epoch : 85, train loss : 0.001, valid loss : 0.006, train acc : 0.926, valid acc : 0.861, train f1 : 0.926, valid f1 : 0.725
training process:  66%|██████▋   | 85/128 [1:26:08<36:05, 50.36s/it]EarlyStopping counter : 1 out of 12
training process:  67%|██████▋   | 86/128 [1:26:52<33:54, 48.45s/it]EarlyStopping counter : 2 out of 12
training process:  68%|██████▊   | 87/128 [1:27:41<33:14, 48.65s/it]EarlyStopping counter : 3 out of 12
training process:  69%|██████▉   | 88/128 [1:28:38<34:07, 51.19s/it]EarlyStopping counter : 4 out of 12
epoch : 89, train loss : 0.001, valid loss : 0.006, train acc : 0.926, valid acc : 0.877, train f1 : 0.925, valid f1 : 0.743
training process:  70%|██████▉   | 89/128 [1:29:48<37:00, 56.94s/it]EarlyStopping counter : 5 out of 12
training process:  70%|███████   | 90/128 [1:30:48<36:30, 57.64s/it]EarlyStopping counter : 6 out of 12
training process:  71%|███████   | 91/128 [1:31:40<34:30, 55.95s/it]EarlyStopping counter : 7 out of 12
training process:  72%|███████▏  | 92/128 [1:32:35<33:27, 55.76s/it]EarlyStopping counter : 8 out of 12
epoch : 93, train loss : 0.001, valid loss : 0.006, train acc : 0.931, valid acc : 0.892, train f1 : 0.931, valid f1 : 0.764
training process:  73%|███████▎  | 93/128 [1:33:44<34:55, 59.88s/it]EarlyStopping counter : 9 out of 12
training process:  73%|███████▎  | 94/128 [1:34:46<34:11, 60.34s/it]EarlyStopping counter : 10 out of 12
training process:  74%|███████▍  | 95/128 [1:35:41<32:21, 58.84s/it]EarlyStopping counter : 11 out of 12
training process:  74%|███████▍  | 95/128 [1:36:37<33:33, 61.03s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 95, best f1 score : 0.777
training process finished, best loss : 0.005 and best acc : 0.901, best f1 : 0.777, best epoch : 83

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.45      0.92      0.60       580
           1       0.99      0.90      0.95      6818

    accuracy                           0.90      7398
   macro avg       0.72      0.91      0.77      7398
weighted avg       0.95      0.90      0.92      7398


# test acc : 0.90, test f1 : 0.77, test AUC : 0.91, test loss : 0.326

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:51, 10.17s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:32,  9.20s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:24,  9.44s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:18,  9.77s/it]processing for feature importance:  42%|████▏     | 5/12 [00:46<01:02,  8.94s/it]processing for feature importance:  50%|█████     | 6/12 [00:54<00:51,  8.57s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:02<00:42,  8.53s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:10<00:33,  8.32s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:19<00:25,  8.59s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:30<00:18,  9.21s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:39<00:09,  9.20s/it]processing for feature importance: 100%|██████████| 12/12 [01:49<00:00,  9.50s/it]processing for feature importance: 100%|██████████| 12/12 [01:49<00:00,  9.13s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 20/306 [00:00<00:01, 197.94it/s] 13%|█▎        | 41/306 [00:00<00:01, 203.90it/s] 20%|██        | 62/306 [00:00<00:01, 200.42it/s] 27%|██▋       | 83/306 [00:00<00:01, 194.53it/s] 34%|███▎      | 103/306 [00:00<00:01, 194.79it/s] 41%|████      | 124/306 [00:00<00:00, 198.29it/s] 47%|████▋     | 145/306 [00:00<00:00, 201.30it/s] 55%|█████▍    | 167/306 [00:00<00:00, 204.99it/s] 61%|██████▏   | 188/306 [00:00<00:00, 202.74it/s] 68%|██████▊   | 209/306 [00:01<00:00, 203.85it/s] 75%|███████▌  | 230/306 [00:01<00:00, 203.50it/s] 82%|████████▏ | 251/306 [00:01<00:00, 197.01it/s] 89%|████████▊ | 271/306 [00:01<00:00, 179.75it/s] 96%|█████████▌| 293/306 [00:01<00:00, 188.46it/s]100%|██████████| 306/306 [00:01<00:00, 196.28it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 40/553 [00:00<00:01, 392.22it/s]extract the null data:  15%|█▌        | 84/553 [00:00<00:01, 419.80it/s]extract the null data:  24%|██▎       | 130/553 [00:00<00:00, 433.77it/s]extract the null data:  31%|███▏      | 174/553 [00:00<00:00, 429.49it/s]extract the null data:  39%|███▉      | 217/553 [00:00<00:00, 413.06it/s]extract the null data:  48%|████▊     | 264/553 [00:00<00:00, 431.15it/s]extract the null data:  56%|█████▋    | 312/553 [00:00<00:00, 444.80it/s]extract the null data:  65%|██████▍   | 359/553 [00:00<00:00, 450.27it/s]extract the null data:  73%|███████▎  | 405/553 [00:00<00:00, 450.71it/s]extract the null data:  82%|████████▏ | 452/553 [00:01<00:00, 454.92it/s]extract the null data:  90%|█████████ | 498/553 [00:01<00:00, 445.21it/s]extract the null data:  99%|█████████▊| 546/553 [00:01<00:00, 453.31it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 441.18it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.07it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 164.43it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 162.98it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 163.00it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 166.31it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 166.95it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 162.21it/s]replace nan value:  25%|██▍       | 137/553 [00:00<00:02, 163.70it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:02, 165.30it/s]replace nan value:  31%|███       | 172/553 [00:01<00:02, 167.90it/s]replace nan value:  34%|███▍      | 189/553 [00:01<00:02, 166.93it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:02, 170.05it/s]replace nan value:  41%|████      | 225/553 [00:01<00:01, 171.45it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 172.31it/s]replace nan value:  47%|████▋     | 262/553 [00:01<00:01, 174.92it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 175.19it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 176.29it/s]replace nan value:  57%|█████▋    | 317/553 [00:01<00:01, 167.79it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 171.77it/s]replace nan value:  64%|██████▍   | 355/553 [00:02<00:01, 175.73it/s]replace nan value:  67%|██████▋   | 373/553 [00:02<00:01, 167.83it/s]replace nan value:  71%|███████   | 391/553 [00:02<00:00, 169.87it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 171.31it/s]replace nan value:  77%|███████▋  | 427/553 [00:02<00:00, 173.14it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 175.09it/s]replace nan value:  84%|████████▎ | 463/553 [00:02<00:00, 174.51it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 174.24it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 160.86it/s]replace nan value:  93%|█████████▎| 517/553 [00:03<00:00, 165.71it/s]replace nan value:  97%|█████████▋| 535/553 [00:03<00:00, 166.77it/s]replace nan value: 100%|█████████▉| 552/553 [00:03<00:00, 162.34it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 168.48it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 105.44it/s]  5%|▍         | 25/553 [00:00<00:04, 124.00it/s]  7%|▋         | 40/553 [00:00<00:03, 131.27it/s] 10%|▉         | 54/553 [00:00<00:04, 119.83it/s] 12%|█▏        | 67/553 [00:00<00:04, 110.79it/s] 14%|█▍        | 80/553 [00:00<00:04, 116.01it/s] 17%|█▋        | 93/553 [00:00<00:03, 120.01it/s] 19%|█▉        | 107/553 [00:00<00:03, 125.52it/s] 22%|██▏       | 122/553 [00:00<00:03, 128.31it/s] 25%|██▍       | 137/553 [00:01<00:03, 134.16it/s] 28%|██▊       | 154/553 [00:01<00:02, 143.95it/s] 31%|███       | 172/553 [00:01<00:02, 153.19it/s] 34%|███▍      | 188/553 [00:01<00:02, 152.65it/s] 38%|███▊      | 208/553 [00:01<00:02, 164.11it/s] 41%|████      | 225/553 [00:01<00:02, 148.98it/s] 44%|████▎     | 241/553 [00:01<00:02, 134.32it/s] 46%|████▌     | 255/553 [00:01<00:02, 133.12it/s] 49%|████▉     | 270/553 [00:02<00:02, 137.28it/s] 51%|█████▏    | 284/553 [00:02<00:02, 129.76it/s] 54%|█████▍    | 298/553 [00:02<00:01, 128.57it/s] 56%|█████▋    | 312/553 [00:02<00:01, 126.55it/s] 59%|█████▉    | 326/553 [00:02<00:01, 128.70it/s] 62%|██████▏   | 341/553 [00:02<00:01, 132.70it/s] 64%|██████▍   | 355/553 [00:02<00:01, 129.77it/s] 67%|██████▋   | 371/553 [00:02<00:01, 136.79it/s] 70%|██████▉   | 385/553 [00:02<00:01, 132.66it/s] 72%|███████▏  | 399/553 [00:03<00:01, 119.20it/s] 75%|███████▌  | 415/553 [00:03<00:01, 122.24it/s] 77%|███████▋  | 428/553 [00:03<00:01, 115.75it/s] 80%|████████  | 445/553 [00:03<00:00, 129.39it/s] 84%|████████▎ | 462/553 [00:03<00:00, 137.75it/s] 86%|████████▋ | 477/553 [00:03<00:00, 136.86it/s] 89%|████████▉ | 491/553 [00:03<00:00, 128.96it/s] 91%|█████████▏| 505/553 [00:03<00:00, 125.68it/s] 94%|█████████▍| 520/553 [00:03<00:00, 132.01it/s] 97%|█████████▋| 534/553 [00:04<00:00, 116.20it/s] 99%|█████████▉| 550/553 [00:04<00:00, 126.73it/s]100%|██████████| 553/553 [00:04<00:00, 128.35it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  25%|██▌       | 35/139 [00:00<00:00, 348.18it/s]extract the null data:  73%|███████▎  | 101/139 [00:00<00:00, 530.87it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 539.81it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 232.89it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 231.34it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 232.23it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 223.47it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 220.32it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 217.95it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  4%|▎         | 5/139 [00:00<00:02, 48.87it/s] 14%|█▎        | 19/139 [00:00<00:01, 100.80it/s] 26%|██▌       | 36/139 [00:00<00:00, 131.48it/s] 37%|███▋      | 51/139 [00:00<00:00, 135.97it/s] 48%|████▊     | 67/139 [00:00<00:00, 138.42it/s] 59%|█████▉    | 82/139 [00:00<00:00, 139.15it/s] 69%|██████▉   | 96/139 [00:00<00:00, 132.58it/s] 79%|███████▉  | 110/139 [00:00<00:00, 134.62it/s] 91%|█████████▏| 127/139 [00:00<00:00, 144.15it/s]100%|██████████| 139/139 [00:01<00:00, 136.35it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  10%|▉         | 17/173 [00:00<00:00, 169.24it/s]extract the null data:  46%|████▌     | 80/173 [00:00<00:00, 435.64it/s]extract the null data:  82%|████████▏ | 142/173 [00:00<00:00, 515.00it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 470.24it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 192.53it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 192.88it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 199.41it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 196.41it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 191.25it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 191.46it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 189.41it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 188.28it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 184.23it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 131.53it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.90it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.96it/s] 32%|███▏      | 55/173 [00:00<00:00, 126.25it/s] 40%|███▉      | 69/173 [00:00<00:00, 126.84it/s] 49%|████▊     | 84/173 [00:00<00:00, 132.40it/s] 58%|█████▊    | 100/173 [00:00<00:00, 139.67it/s] 67%|██████▋   | 116/173 [00:00<00:00, 143.16it/s] 76%|███████▌  | 131/173 [00:00<00:00, 134.76it/s] 84%|████████▍ | 145/173 [00:01<00:00, 134.04it/s] 92%|█████████▏| 159/173 [00:01<00:00, 124.24it/s] 99%|█████████▉| 172/173 [00:01<00:00, 94.11it/s] 100%|██████████| 173/173 [00:01<00:00, 118.31it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.009, train f1 : 0.535, valid f1 : 0.680
training process - Deferred Re-weighting:   1%|          | 1/128 [01:08<2:24:51, 68.44s/it]Best score increase :0.000 -> 0.680
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:10<2:15:54, 64.72s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:09<2:09:42, 62.26s/it]Best score increase :0.680 -> 0.716
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:12<2:08:36, 62.23s/it]Best score increase :0.716 -> 0.765
epoch : 5, train loss : 0.004, valid loss : 0.003, train f1 : 0.794, valid f1 : 0.772
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:26<2:16:25, 66.55s/it]Best score increase :0.765 -> 0.772
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:21<2:07:13, 62.57s/it]Best score increase :0.772 -> 0.791
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:17<2:02:09, 60.57s/it]Best score increase :0.791 -> 0.797
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:13<1:58:19, 59.16s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.828, valid f1 : 0.804
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:21<2:02:41, 61.86s/it]Best score increase :0.797 -> 0.804
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:19<1:59:21, 60.69s/it]Best score increase :0.804 -> 0.808
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:14<1:54:57, 58.95s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:11<1:52:40, 58.28s/it]Best score increase :0.808 -> 0.813
epoch : 13, train loss : 0.002, valid loss : 0.003, train f1 : 0.842, valid f1 : 0.812
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:18<1:56:58, 61.03s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:16<1:53:50, 59.92s/it]Best score increase :0.813 -> 0.818
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:17<1:53:41, 60.37s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:13<1:50:22, 59.13s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.003, train f1 : 0.856, valid f1 : 0.821
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:20<1:53:47, 61.50s/it]Best score increase :0.818 -> 0.821
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:17<1:50:05, 60.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:13<1:46:41, 58.73s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:10<1:45:14, 58.47s/it]Best score increase :0.821 -> 0.825
epoch : 21, train loss : 0.002, valid loss : 0.003, train f1 : 0.868, valid f1 : 0.827
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [21:19<1:49:53, 61.62s/it]Best score increase :0.825 -> 0.827
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [22:15<1:45:42, 59.83s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [23:11<1:42:40, 58.67s/it]Best score increase :0.827 -> 0.841
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [24:07<1:40:23, 57.92s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.869, valid f1 : 0.836
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [25:12<1:42:57, 59.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [26:08<1:40:07, 58.89s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [27:09<1:39:50, 59.31s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [28:10<1:39:46, 59.86s/it]EarlyStopping counter : 5 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.880, valid f1 : 0.852
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [29:16<1:41:52, 61.74s/it]Best score increase :0.841 -> 0.852
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [30:17<1:40:35, 61.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [31:15<1:37:32, 60.33s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [32:11<1:34:54, 59.32s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.882, valid f1 : 0.826
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [33:21<1:38:58, 62.52s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [34:16<1:34:12, 60.13s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:13<1:31:39, 59.13s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:09<1:29:11, 58.16s/it]EarlyStopping counter : 7 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.002, train f1 : 0.885, valid f1 : 0.857
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [37:12<1:30:30, 59.68s/it]Best score increase :0.852 -> 0.857
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [38:11<1:29:22, 59.58s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [39:06<1:26:23, 58.24s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [39:57<1:21:55, 55.86s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.894, valid f1 : 0.856
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [40:54<1:21:35, 56.27s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [41:44<1:17:57, 54.39s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [42:44<1:19:28, 56.10s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [43:42<1:19:22, 56.70s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.899, valid f1 : 0.849
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [44:53<1:24:23, 61.01s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [45:53<1:23:02, 60.77s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [47:00<1:24:12, 62.38s/it]Best score increase :0.857 -> 0.862
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [47:56<1:20:48, 60.60s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train f1 : 0.901, valid f1 : 0.850
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [49:04<1:22:37, 62.75s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [50:06<1:21:15, 62.50s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [51:02<1:17:45, 60.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [52:01<1:16:06, 60.08s/it]EarlyStopping counter : 5 out of 12
epoch : 53, train loss : 0.001, valid loss : 0.003, train f1 : 0.905, valid f1 : 0.866
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [53:11<1:19:03, 63.25s/it]Best score increase :0.862 -> 0.866
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [54:12<1:16:54, 62.36s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [55:10<1:14:25, 61.17s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [56:09<1:12:37, 60.53s/it]EarlyStopping counter : 3 out of 12
epoch : 57, train loss : 0.001, valid loss : 0.003, train f1 : 0.908, valid f1 : 0.853
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [57:15<1:13:23, 62.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [58:14<1:11:19, 61.13s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [59:13<1:09:39, 60.57s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:00:12<1:08:08, 60.13s/it]Best score increase :0.866 -> 0.870
epoch : 61, train loss : 0.001, valid loss : 0.003, train f1 : 0.911, valid f1 : 0.858
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:01:21<1:09:59, 62.68s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:02:20<1:07:52, 61.70s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:03:19<1:05:50, 60.77s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:04:15<1:03:25, 59.45s/it]EarlyStopping counter : 4 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.003, train f1 : 0.912, valid f1 : 0.861
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:05:24<1:05:31, 62.41s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:06:24<1:03:46, 61.71s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:07:21<1:01:07, 60.13s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:08:18<59:13, 59.22s/it]  EarlyStopping counter : 8 out of 12
epoch : 69, train loss : 0.001, valid loss : 0.002, train f1 : 0.916, valid f1 : 0.878
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:09:26<1:00:44, 61.77s/it]Best score increase :0.870 -> 0.878
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:10:23<58:20, 60.36s/it]  EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:11:22<57:02, 60.04s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:12:26<57:01, 61.11s/it]EarlyStopping counter : 3 out of 12
epoch : 73, train loss : 0.001, valid loss : 0.003, train f1 : 0.921, valid f1 : 0.868
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:13:38<59:12, 64.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:14:41<57:33, 63.95s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:15:44<56:12, 63.64s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:16:39<52:54, 61.05s/it]EarlyStopping counter : 7 out of 12
epoch : 77, train loss : 0.001, valid loss : 0.003, train f1 : 0.924, valid f1 : 0.858
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:17:50<54:32, 64.17s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:18:49<52:07, 62.55s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  62%|██████▏   | 79/128 [1:19:44<49:20, 60.42s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  62%|██████▎   | 80/128 [1:20:35<46:04, 57.60s/it]EarlyStopping counter : 11 out of 12
epoch : 81, train loss : 0.001, valid loss : 0.003, train f1 : 0.927, valid f1 : 0.853
training process - Deferred Re-weighting:  62%|██████▎   | 80/128 [1:21:34<48:56, 61.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 80, best f1 score : 0.878
training process finished, best loss : 0.002, best acc : 0.967, best f1 : 0.878, best epoch : 68

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.67      0.78       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.83      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.83, test loss : 0.145

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.89s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.37s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.55s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.41s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.44s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:43,  7.33s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.34s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:30,  7.56s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.54s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:14,  7.35s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.52s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  8.25s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.67s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 114.85it/s]  8%|▊         | 25/306 [00:00<00:02, 116.03it/s] 15%|█▌        | 47/306 [00:00<00:01, 160.85it/s] 23%|██▎       | 69/306 [00:00<00:01, 181.50it/s] 29%|██▉       | 88/306 [00:00<00:01, 141.86it/s] 34%|███▍      | 104/306 [00:00<00:01, 135.72it/s] 42%|████▏     | 127/306 [00:00<00:01, 159.63it/s] 49%|████▊     | 149/306 [00:00<00:00, 175.22it/s] 55%|█████▍    | 168/306 [00:01<00:00, 155.52it/s] 60%|██████    | 185/306 [00:01<00:00, 142.72it/s] 66%|██████▌   | 201/306 [00:01<00:00, 146.94it/s] 74%|███████▎  | 225/306 [00:01<00:00, 171.18it/s] 79%|███████▉  | 243/306 [00:01<00:00, 164.96it/s] 85%|████████▌ | 261/306 [00:01<00:00, 142.65it/s] 91%|█████████ | 277/306 [00:01<00:00, 145.09it/s] 98%|█████████▊| 300/306 [00:01<00:00, 165.33it/s]100%|██████████| 306/306 [00:01<00:00, 155.67it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_DRW_seed_40
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 452.97it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 392.99it/s]extract the null data:  25%|██▌       | 140/553 [00:00<00:00, 429.22it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:00, 446.51it/s]extract the null data:  42%|████▏     | 235/553 [00:00<00:00, 454.43it/s]extract the null data:  51%|█████▏    | 284/553 [00:00<00:00, 463.99it/s]extract the null data:  60%|█████▉    | 331/553 [00:00<00:00, 457.35it/s]extract the null data:  68%|██████▊   | 378/553 [00:00<00:00, 459.13it/s]extract the null data:  77%|███████▋  | 425/553 [00:00<00:00, 412.83it/s]extract the null data:  85%|████████▍ | 468/553 [00:01<00:00, 367.89it/s]extract the null data:  92%|█████████▏| 507/553 [00:01<00:00, 342.76it/s]extract the null data: 100%|█████████▉| 551/553 [00:01<00:00, 350.93it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 399.30it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 14/553 [00:00<00:04, 134.53it/s]replace nan value:   6%|▌         | 32/553 [00:00<00:03, 159.52it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 164.65it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:03, 156.77it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 161.81it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 165.42it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 168.46it/s]replace nan value:  25%|██▍       | 138/553 [00:00<00:03, 137.63it/s]replace nan value:  28%|██▊       | 153/553 [00:01<00:03, 118.53it/s]replace nan value:  31%|███       | 171/553 [00:01<00:02, 132.48it/s]replace nan value:  34%|███▍      | 189/553 [00:01<00:02, 143.44it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:02, 151.74it/s]replace nan value:  41%|████      | 225/553 [00:01<00:02, 157.61it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 162.84it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 162.49it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 145.69it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 153.50it/s]replace nan value:  57%|█████▋    | 313/553 [00:02<00:01, 159.40it/s]replace nan value:  60%|█████▉    | 331/553 [00:02<00:01, 163.45it/s]replace nan value:  63%|██████▎   | 349/553 [00:02<00:01, 167.66it/s]replace nan value:  66%|██████▋   | 367/553 [00:02<00:01, 170.34it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 172.68it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 173.33it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 175.26it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 175.08it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 175.81it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 175.47it/s]replace nan value:  89%|████████▉ | 493/553 [00:03<00:00, 175.01it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 173.37it/s]replace nan value:  96%|█████████▌| 529/553 [00:03<00:00, 172.98it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 174.32it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 161.25it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.44it/s]  5%|▌         | 28/553 [00:00<00:04, 108.78it/s]  7%|▋         | 41/553 [00:00<00:04, 117.07it/s] 10%|▉         | 54/553 [00:00<00:04, 113.13it/s] 12%|█▏        | 66/553 [00:00<00:04, 108.47it/s] 14%|█▍        | 80/553 [00:00<00:04, 115.87it/s] 17%|█▋        | 94/553 [00:00<00:03, 121.63it/s] 20%|█▉        | 108/553 [00:00<00:03, 126.49it/s] 22%|██▏       | 123/553 [00:01<00:03, 132.13it/s] 25%|██▌       | 139/553 [00:01<00:02, 138.60it/s] 28%|██▊       | 157/553 [00:01<00:02, 149.48it/s] 31%|███▏      | 173/553 [00:01<00:02, 152.17it/s] 34%|███▍      | 189/553 [00:01<00:02, 146.77it/s] 37%|███▋      | 207/553 [00:01<00:02, 154.10it/s] 40%|████      | 223/553 [00:01<00:02, 143.84it/s] 43%|████▎     | 238/553 [00:01<00:02, 128.72it/s] 46%|████▌     | 252/553 [00:01<00:02, 129.12it/s] 48%|████▊     | 266/553 [00:02<00:02, 130.17it/s] 51%|█████     | 280/553 [00:02<00:02, 129.30it/s] 53%|█████▎    | 294/553 [00:02<00:02, 128.63it/s] 56%|█████▌    | 307/553 [00:02<00:01, 125.75it/s] 58%|█████▊    | 320/553 [00:02<00:01, 117.24it/s] 60%|██████    | 332/553 [00:02<00:02, 96.97it/s]  63%|██████▎   | 346/553 [00:02<00:01, 106.62it/s] 65%|██████▍   | 358/553 [00:02<00:01, 109.98it/s] 67%|██████▋   | 371/553 [00:02<00:01, 110.21it/s] 69%|██████▉   | 384/553 [00:03<00:01, 114.51it/s] 72%|███████▏  | 396/553 [00:03<00:01, 108.74it/s] 74%|███████▍  | 409/553 [00:03<00:01, 114.08it/s] 76%|███████▌  | 421/553 [00:03<00:01, 112.45it/s] 78%|███████▊  | 433/553 [00:03<00:01, 111.90it/s] 82%|████████▏ | 451/553 [00:03<00:00, 128.96it/s] 84%|████████▍ | 466/553 [00:03<00:00, 133.37it/s] 87%|████████▋ | 480/553 [00:03<00:00, 129.26it/s] 89%|████████▉ | 494/553 [00:03<00:00, 124.69it/s] 92%|█████████▏| 508/553 [00:04<00:00, 128.39it/s] 94%|█████████▍| 521/553 [00:04<00:00, 125.38it/s] 97%|█████████▋| 534/553 [00:04<00:00, 112.29it/s] 99%|█████████▉| 549/553 [00:04<00:00, 121.83it/s]100%|██████████| 553/553 [00:04<00:00, 121.73it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 327.19it/s]extract the null data:  67%|██████▋   | 93/139 [00:00<00:00, 484.35it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 500.52it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:   9%|▉         | 13/139 [00:00<00:01, 123.78it/s]replace nan value:  19%|█▉        | 27/139 [00:00<00:00, 131.06it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 164.99it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 180.01it/s]replace nan value:  64%|██████▍   | 89/139 [00:00<00:00, 186.03it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 188.50it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 190.11it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 180.17it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.18it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.23it/s] 30%|███       | 42/139 [00:00<00:00, 142.28it/s] 41%|████      | 57/139 [00:00<00:00, 131.00it/s] 53%|█████▎    | 74/139 [00:00<00:00, 135.32it/s] 63%|██████▎   | 88/139 [00:00<00:00, 105.87it/s] 75%|███████▍  | 104/139 [00:00<00:00, 118.08it/s] 85%|████████▍ | 118/139 [00:00<00:00, 122.53it/s] 94%|█████████▍| 131/139 [00:01<00:00, 120.57it/s]100%|██████████| 139/139 [00:01<00:00, 124.15it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 298.93it/s]extract the null data:  54%|█████▍    | 94/173 [00:00<00:00, 496.53it/s]extract the null data:  86%|████████▌ | 149/173 [00:00<00:00, 519.34it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 499.92it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 195.88it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 195.92it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 195.98it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 193.74it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 194.35it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 194.86it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 194.06it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 192.80it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 193.28it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 133.25it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.59it/s] 24%|██▍       | 42/173 [00:00<00:01, 123.48it/s] 32%|███▏      | 55/173 [00:00<00:00, 119.23it/s] 40%|████      | 70/173 [00:00<00:00, 129.23it/s] 50%|████▉     | 86/173 [00:00<00:00, 137.57it/s] 59%|█████▉    | 102/173 [00:00<00:00, 144.21it/s] 68%|██████▊   | 117/173 [00:00<00:00, 131.13it/s] 76%|███████▌  | 131/173 [00:01<00:00, 129.27it/s] 84%|████████▍ | 146/173 [00:01<00:00, 132.23it/s] 92%|█████████▏| 160/173 [00:01<00:00, 117.83it/s]100%|██████████| 173/173 [00:01<00:00, 91.78it/s] 100%|██████████| 173/173 [00:01<00:00, 116.05it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.009, train f1 : 0.702, valid f1 : 0.585
training process - Deferred Re-weighting:   1%|          | 1/128 [01:14<2:37:00, 74.18s/it]Best score increase :0.000 -> 0.585
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:14<2:19:10, 66.27s/it]Best score increase :0.585 -> 0.671
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:31<2:28:14, 71.15s/it]Best score increase :0.671 -> 0.727
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:30<2:16:41, 66.14s/it]Best score increase :0.727 -> 0.786
epoch : 5, train loss : 0.007, valid loss : 0.005, train f1 : 0.851, valid f1 : 0.776
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:41<2:19:08, 67.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:38<2:10:43, 64.29s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:42<2:09:28, 64.20s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:41<2:04:45, 62.38s/it]Best score increase :0.786 -> 0.795
epoch : 9, train loss : 0.006, valid loss : 0.004, train f1 : 0.874, valid f1 : 0.799
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:54<2:10:16, 65.68s/it]Best score increase :0.795 -> 0.799
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:52<2:04:29, 63.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:52<2:02:02, 62.59s/it]Best score increase :0.799 -> 0.819
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:54<2:00:36, 62.39s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.005, valid loss : 0.004, train f1 : 0.893, valid f1 : 0.789
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:04<2:03:43, 64.55s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:58<1:56:26, 61.29s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:47<1:48:42, 57.72s/it]Best score increase :0.819 -> 0.822
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:37<1:43:23, 55.39s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.004, train f1 : 0.902, valid f1 : 0.810
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:35<1:43:48, 56.11s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:23<1:38:42, 53.84s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:12<1:35:09, 52.38s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:01<1:32:05, 51.16s/it]Best score increase :0.822 -> 0.830
epoch : 21, train loss : 0.004, valid loss : 0.004, train f1 : 0.912, valid f1 : 0.817
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [20:57<1:33:59, 52.70s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [21:44<1:30:12, 51.06s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [22:31<1:27:13, 49.85s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [23:15<1:23:23, 48.11s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.005, train f1 : 0.917, valid f1 : 0.776
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [24:07<1:24:36, 49.29s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:55<1:23:05, 48.88s/it]Best score increase :0.830 -> 0.838
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:42<1:20:57, 48.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [26:28<1:19:10, 47.51s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.003, train f1 : 0.924, valid f1 : 0.849
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:33<1:27:15, 52.88s/it]Best score increase :0.838 -> 0.849
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [28:43<1:34:26, 57.82s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [29:52<1:39:16, 61.41s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [31:03<1:42:36, 64.13s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.003, valid loss : 0.004, train f1 : 0.934, valid f1 : 0.813
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [32:21<1:48:25, 68.48s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [33:28<1:46:23, 67.91s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [34:41<1:47:48, 69.56s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [35:54<1:48:03, 70.48s/it]EarlyStopping counter : 7 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.003, train f1 : 0.936, valid f1 : 0.828
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [37:17<1:52:23, 74.10s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [38:22<1:47:12, 71.47s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [39:31<1:44:58, 70.77s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [40:39<1:42:29, 69.88s/it]EarlyStopping counter : 11 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.003, train f1 : 0.941, valid f1 : 0.830
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [41:56<1:32:16, 62.91s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 40, best f1 score : 0.849
training process finished, best loss : 0.003, best acc : 0.947, best f1 : 0.849, best epoch : 28

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.58      0.83      0.68       580
           1       0.99      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.89      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.89, test loss : 0.186

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:49,  9.92s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:43, 10.35s/it]processing for feature importance:  25%|██▌       | 3/12 [00:31<01:36, 10.68s/it]processing for feature importance:  33%|███▎      | 4/12 [00:43<01:27, 10.96s/it]processing for feature importance:  42%|████▏     | 5/12 [00:53<01:16, 10.89s/it]processing for feature importance:  50%|█████     | 6/12 [01:03<01:03, 10.52s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:14<00:53, 10.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:25<00:42, 10.68s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:35<00:31, 10.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:48<00:22, 11.26s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:58<00:11, 11.04s/it]processing for feature importance: 100%|██████████| 12/12 [02:09<00:00, 10.87s/it]processing for feature importance: 100%|██████████| 12/12 [02:09<00:00, 10.79s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 210.72it/s] 14%|█▍        | 44/306 [00:00<00:01, 214.33it/s] 22%|██▏       | 66/306 [00:00<00:01, 168.14it/s] 29%|██▉       | 89/306 [00:00<00:01, 185.16it/s] 37%|███▋      | 112/306 [00:00<00:00, 197.63it/s] 44%|████▍     | 135/306 [00:00<00:00, 207.64it/s] 52%|█████▏    | 159/306 [00:00<00:00, 217.04it/s] 59%|█████▉    | 182/306 [00:00<00:00, 219.41it/s] 67%|██████▋   | 205/306 [00:00<00:00, 221.72it/s] 75%|███████▍  | 228/306 [00:01<00:00, 212.19it/s] 82%|████████▏ | 251/306 [00:01<00:00, 216.22it/s] 89%|████████▉ | 273/306 [00:01<00:00, 216.41it/s] 97%|█████████▋| 296/306 [00:01<00:00, 218.83it/s]100%|██████████| 306/306 [00:01<00:00, 209.02it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   5%|▌         | 28/553 [00:00<00:02, 250.58it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:01, 253.30it/s]extract the null data:  19%|█▉        | 105/553 [00:00<00:01, 365.89it/s]extract the null data:  28%|██▊       | 156/553 [00:00<00:00, 418.46it/s]extract the null data:  37%|███▋      | 206/553 [00:00<00:00, 446.26it/s]extract the null data:  46%|████▌     | 253/553 [00:00<00:00, 454.20it/s]extract the null data:  54%|█████▍    | 301/553 [00:00<00:00, 462.17it/s]extract the null data:  64%|██████▎   | 352/553 [00:00<00:00, 477.25it/s]extract the null data:  73%|███████▎  | 403/553 [00:00<00:00, 486.36it/s]extract the null data:  82%|████████▏ | 453/553 [00:01<00:00, 488.20it/s]extract the null data:  91%|█████████ | 502/553 [00:01<00:00, 486.91it/s]extract the null data: 100%|█████████▉| 551/553 [00:01<00:00, 484.73it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 450.54it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 171.15it/s]replace nan value:   7%|▋         | 37/553 [00:00<00:02, 177.78it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 184.87it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:02, 191.51it/s]replace nan value:  18%|█▊        | 98/553 [00:00<00:02, 182.88it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 193.30it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 201.23it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:02, 194.69it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 201.25it/s]replace nan value:  37%|███▋      | 207/553 [00:01<00:01, 205.82it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 205.14it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 205.06it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 206.56it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 207.09it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 205.78it/s]replace nan value:  60%|██████    | 334/553 [00:01<00:01, 200.21it/s]replace nan value:  64%|██████▍   | 355/553 [00:01<00:00, 202.11it/s]replace nan value:  68%|██████▊   | 377/553 [00:01<00:00, 204.96it/s]replace nan value:  73%|███████▎  | 401/553 [00:01<00:00, 213.42it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 213.48it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 211.36it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 209.06it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 181.83it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 173.14it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 181.07it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 187.69it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 196.62it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 117.86it/s]  5%|▍         | 26/553 [00:00<00:04, 125.99it/s]  7%|▋         | 39/553 [00:00<00:04, 124.45it/s]  9%|▉         | 52/553 [00:00<00:04, 118.47it/s] 12%|█▏        | 64/553 [00:00<00:04, 113.43it/s] 14%|█▍        | 78/553 [00:00<00:03, 120.10it/s] 16%|█▋        | 91/553 [00:00<00:04, 100.65it/s] 19%|█▉        | 106/553 [00:00<00:03, 112.18it/s] 22%|██▏       | 122/553 [00:01<00:03, 122.51it/s] 25%|██▌       | 139/553 [00:01<00:03, 134.31it/s] 29%|██▊       | 158/553 [00:01<00:02, 148.10it/s] 31%|███▏      | 174/553 [00:01<00:02, 147.67it/s] 34%|███▍      | 190/553 [00:01<00:02, 142.49it/s] 38%|███▊      | 208/553 [00:01<00:02, 152.57it/s] 41%|████      | 224/553 [00:01<00:02, 146.83it/s] 43%|████▎     | 240/553 [00:01<00:02, 149.79it/s] 46%|████▋     | 256/553 [00:01<00:02, 143.82it/s] 49%|████▉     | 271/553 [00:02<00:01, 142.54it/s] 52%|█████▏    | 288/553 [00:02<00:01, 148.94it/s] 55%|█████▍    | 304/553 [00:02<00:01, 137.43it/s] 58%|█████▊    | 318/553 [00:02<00:01, 126.17it/s] 60%|██████    | 333/553 [00:02<00:01, 130.78it/s] 63%|██████▎   | 347/553 [00:02<00:01, 132.98it/s] 65%|██████▌   | 361/553 [00:02<00:01, 126.71it/s] 68%|██████▊   | 377/553 [00:02<00:01, 134.67it/s] 71%|███████   | 391/553 [00:02<00:01, 124.19it/s] 73%|███████▎  | 404/553 [00:03<00:01, 124.43it/s] 75%|███████▌  | 417/553 [00:03<00:01, 120.97it/s] 78%|███████▊  | 430/553 [00:03<00:01, 116.77it/s] 81%|████████  | 448/553 [00:03<00:00, 131.32it/s] 84%|████████▎ | 463/553 [00:03<00:00, 134.63it/s] 86%|████████▋ | 478/553 [00:03<00:00, 132.29it/s] 89%|████████▉ | 492/553 [00:03<00:00, 126.89it/s] 91%|█████████▏| 505/553 [00:03<00:00, 123.02it/s] 94%|█████████▍| 520/553 [00:03<00:00, 127.11it/s] 96%|█████████▋| 533/553 [00:04<00:00, 108.55it/s] 99%|█████████▉| 549/553 [00:04<00:00, 119.30it/s]100%|██████████| 553/553 [00:04<00:00, 126.76it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 354.56it/s]extract the null data:  66%|██████▌   | 92/139 [00:00<00:00, 474.01it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 472.88it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 187.07it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 187.87it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 186.81it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 175.90it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 179.98it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 182.48it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 185.10it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 183.75it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  6%|▋         | 9/139 [00:00<00:01, 88.89it/s] 14%|█▍        | 20/139 [00:00<00:01, 100.39it/s] 25%|██▌       | 35/139 [00:00<00:00, 120.08it/s] 34%|███▍      | 47/139 [00:00<00:00, 118.01it/s] 42%|████▏     | 59/139 [00:00<00:00, 108.39it/s] 53%|█████▎    | 74/139 [00:00<00:00, 120.06it/s] 63%|██████▎   | 87/139 [00:00<00:00, 115.39it/s] 73%|███████▎  | 101/139 [00:00<00:00, 121.45it/s] 83%|████████▎ | 115/139 [00:00<00:00, 125.78it/s] 94%|█████████▎| 130/139 [00:01<00:00, 131.51it/s]100%|██████████| 139/139 [00:01<00:00, 122.54it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 238.90it/s]extract the null data:  45%|████▌     | 78/173 [00:00<00:00, 411.20it/s]extract the null data:  76%|███████▌  | 131/173 [00:00<00:00, 462.76it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 448.78it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 186.40it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 185.99it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 186.54it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 187.23it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 187.46it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 188.32it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 187.64it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 186.68it/s]replace nan value:  99%|█████████▉| 172/173 [00:01<00:00, 138.33it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 163.81it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▍         | 8/173 [00:00<00:02, 79.45it/s]  9%|▉         | 16/173 [00:00<00:02, 72.85it/s] 14%|█▍        | 24/173 [00:00<00:02, 59.97it/s] 23%|██▎       | 39/173 [00:00<00:01, 83.53it/s] 28%|██▊       | 49/173 [00:00<00:01, 83.20it/s] 34%|███▎      | 58/173 [00:00<00:01, 80.53it/s] 39%|███▊      | 67/173 [00:00<00:01, 78.87it/s] 46%|████▌     | 80/173 [00:00<00:01, 90.04it/s] 55%|█████▍    | 95/173 [00:01<00:00, 106.37it/s] 64%|██████▍   | 111/173 [00:01<00:00, 120.53it/s] 72%|███████▏  | 124/173 [00:01<00:00, 111.13it/s] 79%|███████▊  | 136/173 [00:01<00:00, 103.16it/s] 86%|████████▌ | 149/173 [00:01<00:00, 108.75it/s] 93%|█████████▎| 161/173 [00:01<00:00, 108.46it/s]100%|██████████| 173/173 [00:01<00:00, 88.96it/s] 100%|██████████| 173/173 [00:01<00:00, 92.90it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.521, valid loss : 0.378, train acc : 0.847, valid acc : 0.922, train f1 : 0.586, valid f1 : 0.620
training process:   1%|          | 1/128 [01:13<2:36:17, 73.84s/it]Best score increase :0.000 -> 0.620
training process:   2%|▏         | 2/128 [02:13<2:18:07, 65.77s/it]Best score increase :0.620 -> 0.646
training process:   2%|▏         | 3/128 [03:15<2:12:59, 63.84s/it]Best score increase :0.646 -> 0.685
training process:   3%|▎         | 4/128 [04:16<2:09:16, 62.55s/it]Best score increase :0.685 -> 0.725
epoch : 5, train loss : 0.189, valid loss : 0.168, train acc : 0.949, valid acc : 0.942, train f1 : 0.779, valid f1 : 0.746
training process:   4%|▍         | 5/128 [05:26<2:14:01, 65.38s/it]Best score increase :0.725 -> 0.746
training process:   5%|▍         | 6/128 [06:28<2:10:40, 64.27s/it]Best score increase :0.746 -> 0.778
training process:   5%|▌         | 7/128 [07:27<2:05:46, 62.37s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [08:29<2:04:37, 62.31s/it]Best score increase :0.778 -> 0.799
epoch : 9, train loss : 0.141, valid loss : 0.155, train acc : 0.956, valid acc : 0.951, train f1 : 0.818, valid f1 : 0.787
training process:   7%|▋         | 9/128 [09:50<2:15:03, 68.09s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [10:58<2:14:04, 68.18s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [12:08<2:13:52, 68.65s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [13:17<2:13:10, 68.88s/it]Best score increase :0.799 -> 0.819
epoch : 13, train loss : 0.124, valid loss : 0.170, train acc : 0.960, valid acc : 0.950, train f1 : 0.838, valid f1 : 0.785
training process:  10%|█         | 13/128 [14:36<2:18:06, 72.06s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [15:44<2:14:34, 70.83s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [16:49<2:09:49, 68.93s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [17:55<2:06:55, 68.00s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.116, valid loss : 0.158, train acc : 0.963, valid acc : 0.953, train f1 : 0.852, valid f1 : 0.802
training process:  13%|█▎        | 17/128 [19:13<2:11:19, 70.99s/it]EarlyStopping counter : 5 out of 12
training process:  14%|█▍        | 18/128 [20:19<2:07:25, 69.50s/it]EarlyStopping counter : 6 out of 12
training process:  15%|█▍        | 19/128 [21:21<2:02:10, 67.25s/it]EarlyStopping counter : 7 out of 12
training process:  16%|█▌        | 20/128 [22:25<1:59:31, 66.40s/it]EarlyStopping counter : 8 out of 12
epoch : 21, train loss : 0.109, valid loss : 0.158, train acc : 0.965, valid acc : 0.956, train f1 : 0.864, valid f1 : 0.818
training process:  16%|█▋        | 21/128 [23:41<2:03:38, 69.33s/it]EarlyStopping counter : 9 out of 12
training process:  17%|█▋        | 22/128 [24:38<1:55:47, 65.54s/it]Best score increase :0.819 -> 0.833
training process:  18%|█▊        | 23/128 [25:35<1:50:09, 62.95s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [26:31<1:45:46, 61.03s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.104, valid loss : 0.149, train acc : 0.967, valid acc : 0.958, train f1 : 0.869, valid f1 : 0.829
training process:  20%|█▉        | 25/128 [27:37<1:47:18, 62.51s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [28:35<1:43:29, 60.88s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [29:30<1:39:59, 59.40s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [30:30<1:39:07, 59.48s/it]Best score increase :0.833 -> 0.837
epoch : 29, train loss : 0.101, valid loss : 0.156, train acc : 0.967, valid acc : 0.957, train f1 : 0.870, valid f1 : 0.825
training process:  23%|██▎       | 29/128 [31:39<1:42:59, 62.42s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [32:40<1:41:13, 61.98s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [33:39<1:38:29, 60.92s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [34:36<1:35:39, 59.79s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.096, valid loss : 0.154, train acc : 0.968, valid acc : 0.959, train f1 : 0.878, valid f1 : 0.837
training process:  26%|██▌       | 33/128 [35:41<1:37:08, 61.35s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [36:39<1:34:32, 60.35s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [37:39<1:33:36, 60.39s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [38:38<1:31:45, 59.84s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.094, valid loss : 0.156, train acc : 0.970, valid acc : 0.960, train f1 : 0.884, valid f1 : 0.838
training process:  29%|██▉       | 37/128 [39:43<1:32:55, 61.27s/it]EarlyStopping counter : 9 out of 12
training process:  30%|██▉       | 38/128 [40:40<1:29:57, 59.97s/it]EarlyStopping counter : 10 out of 12
training process:  30%|███       | 39/128 [41:34<1:26:33, 58.35s/it]Best score increase :0.837 -> 0.844
training process:  31%|███▏      | 40/128 [42:29<1:24:04, 57.32s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.090, valid loss : 0.147, train acc : 0.970, valid acc : 0.961, train f1 : 0.886, valid f1 : 0.845
training process:  32%|███▏      | 41/128 [43:35<1:26:53, 59.93s/it]Best score increase :0.844 -> 0.845
training process:  33%|███▎      | 42/128 [44:33<1:24:57, 59.28s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [45:31<1:23:31, 58.96s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [46:26<1:21:02, 57.89s/it]Best score increase :0.845 -> 0.848
epoch : 45, train loss : 0.087, valid loss : 0.142, train acc : 0.972, valid acc : 0.961, train f1 : 0.893, valid f1 : 0.846
training process:  35%|███▌      | 45/128 [47:37<1:25:10, 61.57s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 46/128 [48:35<1:22:41, 60.51s/it]EarlyStopping counter : 2 out of 12
training process:  37%|███▋      | 47/128 [49:34<1:21:16, 60.21s/it]EarlyStopping counter : 3 out of 12
training process:  38%|███▊      | 48/128 [50:33<1:19:37, 59.72s/it]EarlyStopping counter : 4 out of 12
epoch : 49, train loss : 0.085, valid loss : 0.140, train acc : 0.971, valid acc : 0.964, train f1 : 0.891, valid f1 : 0.860
training process:  38%|███▊      | 49/128 [51:39<1:21:20, 61.78s/it]Best score increase :0.848 -> 0.860
training process:  39%|███▉      | 50/128 [52:34<1:17:25, 59.56s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [53:30<1:15:04, 58.50s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [54:26<1:13:07, 57.73s/it]EarlyStopping counter : 3 out of 12
epoch : 53, train loss : 0.085, valid loss : 0.166, train acc : 0.972, valid acc : 0.960, train f1 : 0.894, valid f1 : 0.841
training process:  41%|████▏     | 53/128 [55:34<1:16:09, 60.92s/it]EarlyStopping counter : 4 out of 12
training process:  42%|████▏     | 54/128 [56:32<1:14:10, 60.14s/it]EarlyStopping counter : 5 out of 12
training process:  43%|████▎     | 55/128 [57:35<1:14:09, 60.95s/it]EarlyStopping counter : 6 out of 12
training process:  44%|████▍     | 56/128 [58:40<1:14:29, 62.08s/it]EarlyStopping counter : 7 out of 12
epoch : 57, train loss : 0.083, valid loss : 0.171, train acc : 0.973, valid acc : 0.961, train f1 : 0.898, valid f1 : 0.843
training process:  45%|████▍     | 57/128 [59:54<1:17:54, 65.84s/it]EarlyStopping counter : 8 out of 12
training process:  45%|████▌     | 58/128 [1:00:56<1:15:25, 64.64s/it]EarlyStopping counter : 9 out of 12
training process:  46%|████▌     | 59/128 [1:02:00<1:13:52, 64.24s/it]EarlyStopping counter : 10 out of 12
training process:  47%|████▋     | 60/128 [1:03:01<1:11:43, 63.29s/it]EarlyStopping counter : 11 out of 12
epoch : 61, train loss : 0.080, valid loss : 0.149, train acc : 0.973, valid acc : 0.962, train f1 : 0.899, valid f1 : 0.852
training process:  47%|████▋     | 60/128 [1:04:12<1:12:45, 64.20s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 60, best f1 score : 0.860
training process finished, best loss : 0.140 and best acc : 0.964, best f1 : 0.860, best epoch : 48

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.61      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.80      0.86      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.80, test loss : 8.714

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:35,  8.69s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:25,  8.54s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:18,  8.78s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:08,  8.54s/it]processing for feature importance:  42%|████▏     | 5/12 [00:44<01:04,  9.23s/it]processing for feature importance:  50%|█████     | 6/12 [00:54<00:56,  9.35s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:03<00:46,  9.38s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:13<00:38,  9.53s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:23<00:28,  9.57s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:32<00:18,  9.39s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:41<00:09,  9.19s/it]processing for feature importance: 100%|██████████| 12/12 [01:50<00:00,  9.24s/it]processing for feature importance: 100%|██████████| 12/12 [01:50<00:00,  9.20s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 106.79it/s] 10%|▉         | 30/306 [00:00<00:01, 152.17it/s] 17%|█▋        | 52/306 [00:00<00:01, 181.55it/s] 25%|██▍       | 75/306 [00:00<00:01, 197.70it/s] 31%|███       | 95/306 [00:00<00:01, 195.32it/s] 38%|███▊      | 117/306 [00:00<00:00, 202.12it/s] 45%|████▌     | 139/306 [00:00<00:00, 207.80it/s] 53%|█████▎    | 161/306 [00:00<00:00, 210.38it/s] 60%|██████    | 184/306 [00:00<00:00, 213.62it/s] 68%|██████▊   | 207/306 [00:01<00:00, 217.09it/s] 75%|███████▌  | 230/306 [00:01<00:00, 219.03it/s] 82%|████████▏ | 252/306 [00:01<00:00, 186.08it/s] 90%|████████▉ | 274/306 [00:01<00:00, 193.43it/s] 97%|█████████▋| 297/306 [00:01<00:00, 201.76it/s]100%|██████████| 306/306 [00:01<00:00, 199.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   5%|▌         | 29/553 [00:00<00:01, 288.60it/s]extract the null data:  10%|█         | 58/553 [00:00<00:01, 269.63it/s]extract the null data:  16%|█▌        | 88/553 [00:00<00:01, 269.63it/s]extract the null data:  21%|██        | 116/553 [00:00<00:01, 263.82it/s]extract the null data:  29%|██▉       | 163/553 [00:00<00:01, 332.29it/s]extract the null data:  40%|███▉      | 221/553 [00:00<00:00, 411.20it/s]extract the null data:  49%|████▉     | 273/553 [00:00<00:00, 444.13it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 495.07it/s]extract the null data:  71%|███████   | 394/553 [00:00<00:00, 524.75it/s]extract the null data:  82%|████████▏ | 454/553 [00:01<00:00, 545.76it/s]extract the null data:  93%|█████████▎| 514/553 [00:01<00:00, 561.13it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 457.86it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 194.83it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 201.00it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 201.61it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 196.87it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 198.41it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 201.29it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 202.22it/s]replace nan value:  30%|███       | 167/553 [00:00<00:01, 202.37it/s]replace nan value:  34%|███▍      | 188/553 [00:00<00:01, 202.70it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:02, 167.53it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 174.79it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 182.46it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 155.02it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 139.52it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 155.04it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:01, 164.56it/s]replace nan value:  63%|██████▎   | 347/553 [00:01<00:01, 173.55it/s]replace nan value:  67%|██████▋   | 368/553 [00:02<00:01, 181.01it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:01, 165.35it/s]replace nan value:  73%|███████▎  | 405/553 [00:02<00:00, 167.09it/s]replace nan value:  77%|███████▋  | 426/553 [00:02<00:00, 176.63it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 185.00it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 190.62it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 195.51it/s]replace nan value:  92%|█████████▏| 510/553 [00:02<00:00, 198.03it/s]replace nan value:  96%|█████████▌| 530/553 [00:02<00:00, 189.92it/s]replace nan value: 100%|█████████▉| 551/553 [00:03<00:00, 194.27it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 181.98it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.94it/s]  5%|▌         | 28/553 [00:00<00:03, 131.67it/s]  8%|▊         | 42/553 [00:00<00:03, 131.94it/s] 10%|█         | 56/553 [00:00<00:04, 122.30it/s] 12%|█▏        | 69/553 [00:00<00:04, 114.63it/s] 16%|█▌        | 86/553 [00:00<00:03, 130.67it/s] 18%|█▊        | 100/553 [00:00<00:03, 126.12it/s] 21%|██▏       | 118/553 [00:00<00:03, 141.63it/s] 24%|██▍       | 133/553 [00:01<00:02, 140.31it/s] 27%|██▋       | 149/553 [00:01<00:02, 144.18it/s] 30%|███       | 166/553 [00:01<00:02, 151.61it/s] 33%|███▎      | 182/553 [00:01<00:02, 151.47it/s] 36%|███▌      | 198/553 [00:01<00:02, 125.75it/s] 38%|███▊      | 212/553 [00:01<00:03, 113.08it/s] 41%|████      | 225/553 [00:01<00:03, 94.27it/s]  43%|████▎     | 236/553 [00:02<00:03, 85.62it/s] 44%|████▍     | 246/553 [00:02<00:03, 81.70it/s] 46%|████▌     | 255/553 [00:02<00:03, 77.62it/s] 48%|████▊     | 265/553 [00:02<00:03, 77.98it/s] 49%|████▉     | 273/553 [00:02<00:03, 73.04it/s] 51%|█████     | 281/553 [00:02<00:03, 74.35it/s] 52%|█████▏    | 290/553 [00:02<00:03, 74.71it/s] 54%|█████▍    | 298/553 [00:02<00:03, 65.68it/s] 56%|█████▌    | 310/553 [00:03<00:03, 76.99it/s] 59%|█████▊    | 324/553 [00:03<00:02, 91.91it/s] 61%|██████    | 338/553 [00:03<00:02, 104.48it/s] 64%|██████▍   | 353/553 [00:03<00:01, 113.48it/s] 66%|██████▌   | 365/553 [00:03<00:02, 92.74it/s]  68%|██████▊   | 376/553 [00:03<00:02, 85.05it/s] 70%|███████   | 388/553 [00:03<00:01, 92.63it/s] 72%|███████▏  | 398/553 [00:03<00:01, 92.12it/s] 75%|███████▍  | 414/553 [00:04<00:01, 107.69it/s] 77%|███████▋  | 426/553 [00:04<00:01, 105.00it/s] 80%|███████▉  | 442/553 [00:04<00:00, 118.64it/s] 83%|████████▎ | 458/553 [00:04<00:00, 129.49it/s] 86%|████████▌ | 474/553 [00:04<00:00, 135.41it/s] 88%|████████▊ | 488/553 [00:04<00:00, 131.12it/s] 91%|█████████ | 502/553 [00:04<00:00, 125.76it/s] 94%|█████████▎| 518/553 [00:04<00:00, 133.19it/s] 96%|█████████▌| 532/553 [00:04<00:00, 108.02it/s] 99%|█████████▉| 549/553 [00:05<00:00, 121.28it/s]100%|██████████| 553/553 [00:05<00:00, 106.55it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▍       | 34/139 [00:00<00:00, 335.56it/s]extract the null data:  73%|███████▎  | 101/139 [00:00<00:00, 530.68it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 536.59it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 226.25it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 224.20it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 221.30it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 220.81it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 220.08it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 220.35it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 220.99it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.26it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.20it/s] 28%|██▊       | 39/139 [00:00<00:00, 129.57it/s] 37%|███▋      | 52/139 [00:00<00:00, 116.65it/s] 49%|████▉     | 68/139 [00:00<00:00, 129.93it/s] 59%|█████▉    | 82/139 [00:00<00:00, 132.48it/s] 69%|██████▉   | 96/139 [00:00<00:00, 116.26it/s] 78%|███████▊  | 109/139 [00:00<00:00, 92.25it/s] 87%|████████▋ | 121/139 [00:01<00:00, 95.07it/s] 95%|█████████▍| 132/139 [00:01<00:00, 86.53it/s]100%|██████████| 139/139 [00:01<00:00, 106.32it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   9%|▉         | 16/173 [00:00<00:00, 159.45it/s]extract the null data:  47%|████▋     | 82/173 [00:00<00:00, 450.10it/s]extract the null data:  80%|███████▉  | 138/173 [00:00<00:00, 497.79it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 471.26it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 192.60it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 196.32it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 178.95it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 184.40it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 187.47it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 191.96it/s]replace nan value:  82%|████████▏ | 142/173 [00:00<00:00, 195.57it/s]replace nan value:  94%|█████████▍| 163/173 [00:00<00:00, 197.85it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 192.70it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.98it/s] 16%|█▌        | 28/173 [00:00<00:01, 115.44it/s] 24%|██▍       | 42/173 [00:00<00:01, 124.75it/s] 33%|███▎      | 57/173 [00:00<00:00, 131.09it/s] 41%|████      | 71/173 [00:00<00:00, 130.19it/s] 49%|████▉     | 85/173 [00:00<00:00, 128.75it/s] 57%|█████▋    | 99/173 [00:00<00:00, 129.50it/s] 65%|██████▌   | 113/173 [00:00<00:00, 128.75it/s] 73%|███████▎  | 126/173 [00:00<00:00, 128.27it/s] 82%|████████▏ | 142/173 [00:01<00:00, 136.25it/s] 90%|█████████ | 156/173 [00:01<00:00, 120.90it/s] 98%|█████████▊| 169/173 [00:01<00:00, 100.08it/s]100%|██████████| 173/173 [00:01<00:00, 116.05it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.562, valid loss : 0.430, train acc : 0.701, valid acc : 0.793, train f1 : 0.701, valid f1 : 0.623
training process:   1%|          | 1/128 [01:16<2:42:14, 76.65s/it]Best score increase :0.000 -> 0.623
training process:   2%|▏         | 2/128 [02:26<2:32:11, 72.47s/it]Best score increase :0.623 -> 0.706
training process:   2%|▏         | 3/128 [03:35<2:28:11, 71.13s/it]Best score increase :0.706 -> 0.778
training process:   3%|▎         | 4/128 [04:44<2:25:06, 70.21s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.340, valid loss : 0.269, train acc : 0.849, valid acc : 0.910, train f1 : 0.849, valid f1 : 0.777
training process:   4%|▍         | 5/128 [06:02<2:29:29, 72.92s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [07:08<2:23:56, 70.79s/it]Best score increase :0.778 -> 0.805
training process:   5%|▌         | 7/128 [08:18<2:22:02, 70.43s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:21<2:15:53, 67.95s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.286, valid loss : 0.243, train acc : 0.875, valid acc : 0.913, train f1 : 0.875, valid f1 : 0.787
training process:   7%|▋         | 9/128 [10:33<2:17:34, 69.36s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [11:35<2:11:45, 66.99s/it]Best score increase :0.805 -> 0.806
training process:   9%|▊         | 11/128 [12:32<2:04:39, 63.93s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [13:32<2:01:20, 62.76s/it]Best score increase :0.806 -> 0.823
epoch : 13, train loss : 0.258, valid loss : 0.218, train acc : 0.890, valid acc : 0.920, train f1 : 0.890, valid f1 : 0.799
training process:  10%|█         | 13/128 [14:45<2:06:27, 65.97s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [15:42<2:00:00, 63.16s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [16:42<1:57:08, 62.20s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [17:46<1:56:59, 62.68s/it]Best score increase :0.823 -> 0.827
epoch : 17, train loss : 0.226, valid loss : 0.212, train acc : 0.906, valid acc : 0.932, train f1 : 0.906, valid f1 : 0.823
training process:  13%|█▎        | 17/128 [18:56<1:59:57, 64.84s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [19:54<1:55:15, 62.87s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [20:54<1:52:46, 62.08s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [21:54<1:50:29, 61.38s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.216, valid loss : 0.212, train acc : 0.912, valid acc : 0.918, train f1 : 0.912, valid f1 : 0.799
training process:  16%|█▋        | 21/128 [23:01<1:52:46, 63.24s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [23:55<1:46:48, 60.45s/it]EarlyStopping counter : 6 out of 12
training process:  18%|█▊        | 23/128 [24:44<1:39:24, 56.80s/it]EarlyStopping counter : 7 out of 12
training process:  19%|█▉        | 24/128 [25:32<1:33:53, 54.16s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.202, valid loss : 0.195, train acc : 0.916, valid acc : 0.921, train f1 : 0.916, valid f1 : 0.802
training process:  20%|█▉        | 25/128 [26:27<1:33:23, 54.41s/it]EarlyStopping counter : 9 out of 12
training process:  20%|██        | 26/128 [27:15<1:29:31, 52.66s/it]Best score increase :0.827 -> 0.842
training process:  21%|██        | 27/128 [28:04<1:26:43, 51.52s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [28:49<1:22:39, 49.59s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.188, valid loss : 0.169, train acc : 0.925, valid acc : 0.938, train f1 : 0.925, valid f1 : 0.835
training process:  23%|██▎       | 29/128 [30:03<1:33:40, 56.78s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [31:05<1:35:17, 58.35s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [32:05<1:35:22, 58.99s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [33:05<1:34:32, 59.09s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.180, valid loss : 0.174, train acc : 0.928, valid acc : 0.934, train f1 : 0.928, valid f1 : 0.827
training process:  26%|██▌       | 33/128 [34:13<1:38:13, 62.03s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [35:15<1:36:51, 61.82s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [36:16<1:35:44, 61.77s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [37:17<1:34:05, 61.37s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.169, valid loss : 0.148, train acc : 0.932, valid acc : 0.947, train f1 : 0.932, valid f1 : 0.852
training process:  29%|██▉       | 37/128 [38:27<1:37:07, 64.03s/it]Best score increase :0.842 -> 0.852
training process:  30%|██▉       | 38/128 [39:30<1:35:20, 63.56s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [40:30<1:32:48, 62.57s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [41:34<1:32:19, 62.95s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.168, valid loss : 0.159, train acc : 0.932, valid acc : 0.941, train f1 : 0.932, valid f1 : 0.840
training process:  32%|███▏      | 41/128 [42:53<1:38:22, 67.85s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [44:00<1:36:48, 67.55s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [45:08<1:35:45, 67.59s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [46:10<1:32:33, 66.11s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.154, valid loss : 0.169, train acc : 0.941, valid acc : 0.938, train f1 : 0.941, valid f1 : 0.835
training process:  35%|███▌      | 45/128 [47:21<1:33:23, 67.51s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [48:20<1:28:43, 64.92s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [49:21<1:25:58, 63.68s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [50:24<1:24:48, 63.60s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.151, valid loss : 0.177, train acc : 0.940, valid acc : 0.934, train f1 : 0.940, valid f1 : 0.828
training process:  38%|███▊      | 48/128 [51:33<1:25:55, 64.45s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.852
training process finished, best loss : 0.148 and best acc : 0.947, best f1 : 0.852, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.66      0.85      0.74       580
           1       0.99      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.91      0.86      7398
weighted avg       0.96      0.95      0.96      7398


# test acc : 0.95, test f1 : 0.86, test AUC : 0.91, test loss : 8.444

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:50, 10.08s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:42, 10.25s/it]processing for feature importance:  25%|██▌       | 3/12 [00:31<01:33, 10.43s/it]processing for feature importance:  33%|███▎      | 4/12 [00:39<01:17,  9.73s/it]processing for feature importance:  42%|████▏     | 5/12 [00:49<01:08,  9.78s/it]processing for feature importance:  50%|█████     | 6/12 [00:57<00:55,  9.18s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:08<00:48,  9.70s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:17<00:38,  9.62s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:27<00:28,  9.63s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:36<00:18,  9.43s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:45<00:09,  9.22s/it]processing for feature importance: 100%|██████████| 12/12 [01:55<00:00,  9.58s/it]processing for feature importance: 100%|██████████| 12/12 [01:55<00:00,  9.64s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▌         | 16/306 [00:00<00:01, 156.29it/s] 14%|█▎        | 42/306 [00:00<00:01, 211.72it/s] 22%|██▏       | 68/306 [00:00<00:01, 230.96it/s] 30%|███       | 92/306 [00:00<00:01, 185.45it/s] 38%|███▊      | 117/306 [00:00<00:00, 204.29it/s] 47%|████▋     | 143/306 [00:00<00:00, 219.19it/s] 56%|█████▌    | 170/306 [00:00<00:00, 233.12it/s] 63%|██████▎   | 194/306 [00:00<00:00, 201.30it/s] 71%|███████   | 216/306 [00:01<00:00, 164.91it/s] 77%|███████▋  | 235/306 [00:01<00:00, 150.15it/s] 82%|████████▏ | 252/306 [00:01<00:00, 136.88it/s] 87%|████████▋ | 267/306 [00:01<00:00, 130.65it/s] 92%|█████████▏| 281/306 [00:01<00:00, 123.18it/s] 96%|█████████▌| 294/306 [00:01<00:00, 117.92it/s]100%|██████████| 306/306 [00:01<00:00, 162.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   5%|▍         | 27/553 [00:00<00:01, 268.59it/s]extract the null data:  12%|█▏        | 68/553 [00:00<00:01, 348.02it/s]extract the null data:  19%|█▊        | 103/553 [00:00<00:01, 309.81it/s]extract the null data:  26%|██▌       | 144/553 [00:00<00:01, 344.35it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:01, 316.11it/s]extract the null data:  40%|███▉      | 221/553 [00:00<00:00, 346.74it/s]extract the null data:  48%|████▊     | 263/553 [00:00<00:00, 367.37it/s]extract the null data:  55%|█████▌    | 305/553 [00:00<00:00, 381.74it/s]extract the null data:  63%|██████▎   | 346/553 [00:00<00:00, 387.96it/s]extract the null data:  70%|███████   | 388/553 [00:01<00:00, 395.63it/s]extract the null data:  77%|███████▋  | 428/553 [00:01<00:00, 319.48it/s]extract the null data:  85%|████████▌ | 471/553 [00:01<00:00, 345.34it/s]extract the null data:  93%|█████████▎| 512/553 [00:01<00:00, 361.27it/s]extract the null data: 100%|█████████▉| 551/553 [00:01<00:00, 367.22it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 349.56it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   2%|▏         | 9/553 [00:00<00:06, 88.31it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:04, 117.71it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:03, 135.20it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:03, 142.32it/s]replace nan value:  13%|█▎        | 70/553 [00:00<00:03, 136.32it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:03, 141.35it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:03, 144.78it/s]replace nan value:  21%|██▏       | 118/553 [00:00<00:02, 149.06it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 153.57it/s]replace nan value:  27%|██▋       | 151/553 [00:01<00:02, 154.96it/s]replace nan value:  30%|███       | 167/553 [00:01<00:02, 133.28it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 132.84it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 140.10it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:02, 123.71it/s]replace nan value:  41%|████      | 225/553 [00:01<00:02, 113.54it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:02, 124.65it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:02, 132.70it/s]replace nan value:  49%|████▉     | 273/553 [00:02<00:02, 139.63it/s]replace nan value:  52%|█████▏    | 289/553 [00:02<00:01, 144.93it/s]replace nan value:  55%|█████▌    | 305/553 [00:02<00:01, 148.88it/s]replace nan value:  58%|█████▊    | 321/553 [00:02<00:01, 151.01it/s]replace nan value:  61%|██████    | 337/553 [00:02<00:01, 153.06it/s]replace nan value:  64%|██████▍   | 353/553 [00:02<00:01, 153.53it/s]replace nan value:  67%|██████▋   | 369/553 [00:02<00:01, 153.73it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:01, 155.35it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 159.18it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 163.68it/s]replace nan value:  79%|███████▉  | 437/553 [00:03<00:00, 165.22it/s]replace nan value:  82%|████████▏ | 454/553 [00:03<00:00, 165.77it/s]replace nan value:  85%|████████▌ | 471/553 [00:03<00:00, 164.16it/s]replace nan value:  88%|████████▊ | 488/553 [00:03<00:00, 162.83it/s]replace nan value:  91%|█████████▏| 505/553 [00:03<00:00, 162.63it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 162.45it/s]replace nan value:  97%|█████████▋| 539/553 [00:03<00:00, 161.28it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 147.46it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 122.53it/s]  5%|▍         | 26/553 [00:00<00:05, 103.99it/s]  7%|▋         | 40/553 [00:00<00:04, 114.36it/s]  9%|▉         | 52/553 [00:00<00:04, 108.86it/s] 11%|█▏        | 63/553 [00:00<00:04, 104.42it/s] 14%|█▎        | 76/553 [00:00<00:04, 111.24it/s] 16%|█▋        | 90/553 [00:00<00:03, 118.96it/s] 19%|█▊        | 103/553 [00:00<00:03, 117.31it/s] 22%|██▏       | 119/553 [00:01<00:03, 128.92it/s] 24%|██▍       | 133/553 [00:01<00:03, 126.55it/s] 27%|██▋       | 150/553 [00:01<00:02, 136.77it/s] 30%|██▉       | 164/553 [00:01<00:02, 133.72it/s] 32%|███▏      | 178/553 [00:01<00:02, 135.04it/s] 35%|███▍      | 193/553 [00:01<00:02, 138.87it/s] 38%|███▊      | 210/553 [00:01<00:02, 138.28it/s] 41%|████      | 224/553 [00:01<00:02, 132.03it/s] 43%|████▎     | 239/553 [00:01<00:02, 134.91it/s] 46%|████▌     | 253/553 [00:02<00:02, 132.50it/s] 48%|████▊     | 267/553 [00:02<00:02, 123.18it/s] 51%|█████     | 280/553 [00:02<00:02, 122.81it/s] 53%|█████▎    | 293/553 [00:02<00:02, 123.75it/s] 55%|█████▌    | 306/553 [00:02<00:02, 106.96it/s] 58%|█████▊    | 318/553 [00:02<00:02, 107.96it/s] 60%|█████▉    | 331/553 [00:02<00:01, 112.56it/s] 62%|██████▏   | 343/553 [00:02<00:02, 97.29it/s]  64%|██████▍   | 354/553 [00:03<00:02, 95.62it/s] 66%|██████▌   | 366/553 [00:03<00:01, 100.02it/s] 69%|██████▊   | 380/553 [00:03<00:01, 109.16it/s] 71%|███████   | 392/553 [00:03<00:01, 103.50it/s] 73%|███████▎  | 405/553 [00:03<00:01, 107.79it/s] 75%|███████▌  | 417/553 [00:03<00:01, 108.59it/s] 78%|███████▊  | 429/553 [00:03<00:01, 102.63it/s] 81%|████████  | 446/553 [00:03<00:00, 119.11it/s] 83%|████████▎ | 460/553 [00:03<00:00, 124.69it/s] 86%|████████▌ | 474/553 [00:04<00:00, 127.61it/s] 88%|████████▊ | 487/553 [00:04<00:00, 122.91it/s] 90%|█████████ | 500/553 [00:04<00:00, 114.12it/s] 93%|█████████▎| 515/553 [00:04<00:00, 121.57it/s] 95%|█████████▌| 528/553 [00:04<00:00, 109.46it/s] 98%|█████████▊| 540/553 [00:04<00:00, 111.35it/s]100%|█████████▉| 552/553 [00:04<00:00, 90.20it/s] 100%|██████████| 553/553 [00:04<00:00, 114.68it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 348.76it/s]extract the null data:  51%|█████     | 71/139 [00:00<00:00, 277.63it/s]extract the null data:  87%|████████▋ | 121/139 [00:00<00:00, 364.30it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 359.32it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 16/139 [00:00<00:00, 154.67it/s]replace nan value:  24%|██▎       | 33/139 [00:00<00:00, 159.93it/s]replace nan value:  35%|███▌      | 49/139 [00:00<00:00, 120.72it/s]replace nan value:  48%|████▊     | 67/139 [00:00<00:00, 138.67it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 151.08it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 158.89it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 125.59it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 140.41it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 140.85it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 129.94it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.68it/s] 28%|██▊       | 39/139 [00:00<00:00, 125.65it/s] 37%|███▋      | 52/139 [00:00<00:00, 105.13it/s] 47%|████▋     | 65/139 [00:00<00:00, 111.66it/s] 56%|█████▌    | 78/139 [00:00<00:00, 111.85it/s] 65%|██████▍   | 90/139 [00:00<00:00, 91.80it/s]  72%|███████▏  | 100/139 [00:00<00:00, 87.96it/s] 79%|███████▉  | 110/139 [00:01<00:00, 78.18it/s] 86%|████████▋ | 120/139 [00:01<00:00, 79.91it/s] 93%|█████████▎| 129/139 [00:01<00:00, 81.85it/s]100%|██████████| 139/139 [00:01<00:00, 95.07it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 318.82it/s]extract the null data:  50%|████▉     | 86/173 [00:00<00:00, 448.53it/s]extract the null data:  81%|████████  | 140/173 [00:00<00:00, 489.12it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 482.11it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 203.44it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 189.52it/s]replace nan value:  36%|███▌      | 62/173 [00:00<00:00, 166.12it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 175.56it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 182.04it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 152.67it/s]replace nan value:  82%|████████▏ | 141/173 [00:00<00:00, 164.20it/s]replace nan value:  93%|█████████▎| 161/173 [00:00<00:00, 171.89it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 172.44it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▌         | 9/173 [00:00<00:01, 85.39it/s] 11%|█         | 19/173 [00:00<00:01, 88.15it/s] 18%|█▊        | 32/173 [00:00<00:01, 103.19it/s] 28%|██▊       | 48/173 [00:00<00:01, 123.77it/s] 37%|███▋      | 64/173 [00:00<00:00, 136.07it/s] 46%|████▌     | 79/173 [00:00<00:00, 140.49it/s] 54%|█████▍    | 94/173 [00:00<00:00, 140.87it/s] 63%|██████▎   | 109/173 [00:00<00:00, 114.81it/s] 71%|███████   | 122/173 [00:01<00:00, 102.57it/s] 79%|███████▊  | 136/173 [00:01<00:00, 110.20it/s] 86%|████████▌ | 149/173 [00:01<00:00, 114.60it/s] 93%|█████████▎| 161/173 [00:01<00:00, 113.45it/s]100%|██████████| 173/173 [00:01<00:00, 91.79it/s] 100%|██████████| 173/173 [00:01<00:00, 109.16it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.088, valid loss : 0.081, train acc : 0.608, valid acc : 0.659, train f1 : 0.488, valid f1 : 0.527
training process:   1%|          | 1/128 [01:22<2:55:15, 82.80s/it]Best score increase :0.000 -> 0.527
training process:   2%|▏         | 2/128 [02:33<2:38:31, 75.49s/it]Best score increase :0.527 -> 0.644
training process:   2%|▏         | 3/128 [03:44<2:33:31, 73.69s/it]Best score increase :0.644 -> 0.748
training process:   3%|▎         | 4/128 [04:59<2:33:24, 74.23s/it]Best score increase :0.748 -> 0.792
epoch : 5, train loss : 0.058, valid loss : 0.059, train acc : 0.854, valid acc : 0.936, train f1 : 0.691, valid f1 : 0.803
training process:   4%|▍         | 5/128 [06:26<2:41:17, 78.68s/it]Best score increase :0.792 -> 0.803
training process:   5%|▍         | 6/128 [07:37<2:35:02, 76.25s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [08:41<2:25:41, 72.25s/it]Best score increase :0.803 -> 0.809
training process:   6%|▋         | 8/128 [09:53<2:24:21, 72.18s/it]Best score increase :0.809 -> 0.814
epoch : 9, train loss : 0.049, valid loss : 0.057, train acc : 0.901, valid acc : 0.950, train f1 : 0.756, valid f1 : 0.832
training process:   7%|▋         | 9/128 [11:20<2:31:46, 76.53s/it]Best score increase :0.814 -> 0.832
training process:   8%|▊         | 10/128 [12:35<2:29:51, 76.20s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [13:45<2:24:39, 74.19s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [14:52<2:19:41, 72.26s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.045, valid loss : 0.063, train acc : 0.913, valid acc : 0.948, train f1 : 0.776, valid f1 : 0.829
training process:  10%|█         | 13/128 [16:11<2:22:22, 74.29s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [17:25<2:20:46, 74.09s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [18:27<2:12:31, 70.37s/it]Best score increase :0.832 -> 0.840
training process:  12%|█▎        | 16/128 [19:27<2:05:47, 67.39s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.043, valid loss : 0.060, train acc : 0.928, valid acc : 0.947, train f1 : 0.803, valid f1 : 0.828
training process:  13%|█▎        | 17/128 [20:35<2:05:05, 67.62s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [21:37<2:00:23, 65.67s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [22:39<1:57:26, 64.65s/it]Best score increase :0.840 -> 0.849
training process:  16%|█▌        | 20/128 [23:40<1:54:33, 63.65s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.041, valid loss : 0.064, train acc : 0.934, valid acc : 0.954, train f1 : 0.815, valid f1 : 0.844
training process:  16%|█▋        | 21/128 [24:54<1:58:52, 66.66s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [25:55<1:54:46, 64.97s/it]Best score increase :0.849 -> 0.853
training process:  18%|█▊        | 23/128 [27:07<1:57:22, 67.07s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [28:09<1:53:46, 65.64s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.040, valid loss : 0.058, train acc : 0.937, valid acc : 0.956, train f1 : 0.820, valid f1 : 0.855
training process:  20%|█▉        | 25/128 [29:20<1:55:33, 67.32s/it]Best score increase :0.853 -> 0.855
training process:  20%|██        | 26/128 [30:22<1:51:40, 65.69s/it]Best score increase :0.855 -> 0.859
training process:  21%|██        | 27/128 [31:23<1:48:12, 64.29s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [32:24<1:45:18, 63.19s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.039, valid loss : 0.060, train acc : 0.943, valid acc : 0.956, train f1 : 0.833, valid f1 : 0.855
training process:  23%|██▎       | 29/128 [33:35<1:48:09, 65.55s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [34:32<1:43:05, 63.12s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [35:35<1:42:02, 63.12s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [36:37<1:40:14, 62.65s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.036, valid loss : 0.061, train acc : 0.943, valid acc : 0.955, train f1 : 0.836, valid f1 : 0.854
training process:  26%|██▌       | 33/128 [37:49<1:43:24, 65.31s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [38:50<1:40:21, 64.05s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [39:50<1:37:21, 62.81s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [40:52<1:36:14, 62.76s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.036, valid loss : 0.065, train acc : 0.948, valid acc : 0.958, train f1 : 0.845, valid f1 : 0.857
training process:  29%|██▉       | 37/128 [42:01<1:38:08, 64.71s/it]EarlyStopping counter : 11 out of 12
training process:  29%|██▉       | 37/128 [43:01<1:45:48, 69.77s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.860
training process finished, best loss : 0.052 and best acc : 0.955, best f1 : 0.860, best epoch : 26

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.72      0.74      0.73       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.85      0.86      0.85      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.85, test AUC : 0.86, test loss : 3.101

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:49,  9.94s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:33,  9.36s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:26,  9.66s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:16,  9.60s/it]processing for feature importance:  42%|████▏     | 5/12 [00:48<01:08,  9.84s/it]processing for feature importance:  50%|█████     | 6/12 [00:57<00:57,  9.61s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:07<00:48,  9.72s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:17<00:38,  9.71s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:27<00:29,  9.78s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:35<00:18,  9.26s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:45<00:09,  9.39s/it]processing for feature importance: 100%|██████████| 12/12 [01:53<00:00,  9.00s/it]processing for feature importance: 100%|██████████| 12/12 [01:53<00:00,  9.44s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 23/306 [00:00<00:01, 229.37it/s] 16%|█▋        | 50/306 [00:00<00:01, 249.29it/s] 25%|██▍       | 75/306 [00:00<00:00, 244.44it/s] 33%|███▎      | 100/306 [00:00<00:00, 238.26it/s] 41%|████      | 124/306 [00:00<00:00, 227.32it/s] 48%|████▊     | 147/306 [00:00<00:00, 228.04it/s] 56%|█████▌    | 170/306 [00:00<00:00, 224.92it/s] 63%|██████▎   | 193/306 [00:00<00:00, 192.77it/s] 71%|███████   | 216/306 [00:00<00:00, 202.68it/s] 78%|███████▊  | 239/306 [00:01<00:00, 208.80it/s] 86%|████████▌ | 263/306 [00:01<00:00, 215.76it/s] 94%|█████████▍| 287/306 [00:01<00:00, 220.44it/s]100%|██████████| 306/306 [00:01<00:00, 220.95it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 489.70it/s]extract the null data:  18%|█▊        | 102/553 [00:00<00:00, 508.18it/s]extract the null data:  28%|██▊       | 153/553 [00:00<00:00, 476.31it/s]extract the null data:  36%|███▋      | 201/553 [00:00<00:00, 405.29it/s]extract the null data:  46%|████▋     | 256/553 [00:00<00:00, 450.45it/s]extract the null data:  55%|█████▍    | 303/553 [00:00<00:00, 431.13it/s]extract the null data:  63%|██████▎   | 349/553 [00:00<00:00, 438.20it/s]extract the null data:  71%|███████   | 394/553 [00:00<00:00, 384.30it/s]extract the null data:  81%|████████  | 447/553 [00:01<00:00, 423.05it/s]extract the null data:  90%|█████████ | 500/553 [00:01<00:00, 451.62it/s]extract the null data: 100%|█████████▉| 552/553 [00:01<00:00, 470.26it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 446.20it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 172.75it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 175.62it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 178.85it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 164.43it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 171.19it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 174.89it/s]replace nan value:  23%|██▎       | 129/553 [00:00<00:02, 176.48it/s]replace nan value:  27%|██▋       | 147/553 [00:00<00:02, 160.61it/s]replace nan value:  30%|███       | 166/553 [00:00<00:02, 167.23it/s]replace nan value:  33%|███▎      | 185/553 [00:01<00:02, 172.52it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:02, 156.83it/s]replace nan value:  40%|████      | 222/553 [00:01<00:02, 163.83it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 169.15it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 159.10it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:02, 135.33it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 147.49it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 156.85it/s]replace nan value:  60%|██████    | 332/553 [00:02<00:01, 162.97it/s]replace nan value:  63%|██████▎   | 349/553 [00:02<00:01, 155.69it/s]replace nan value:  67%|██████▋   | 368/553 [00:02<00:01, 162.90it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:01, 156.42it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 158.13it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:01, 133.63it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 132.42it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 147.58it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 159.84it/s]replace nan value:  89%|████████▉ | 493/553 [00:03<00:00, 166.60it/s]replace nan value:  93%|█████████▎| 512/553 [00:03<00:00, 170.52it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 172.31it/s]replace nan value:  99%|█████████▉| 549/553 [00:03<00:00, 174.82it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 161.29it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 133.01it/s]  5%|▌         | 28/553 [00:00<00:03, 136.44it/s]  8%|▊         | 42/553 [00:00<00:03, 130.94it/s] 10%|█         | 56/553 [00:00<00:04, 122.18it/s] 12%|█▏        | 69/553 [00:00<00:04, 113.17it/s] 15%|█▌        | 84/553 [00:00<00:03, 123.99it/s] 18%|█▊        | 98/553 [00:00<00:03, 123.78it/s] 21%|██        | 114/553 [00:00<00:03, 133.47it/s] 23%|██▎       | 128/553 [00:01<00:03, 121.40it/s] 25%|██▌       | 141/553 [00:01<00:04, 102.55it/s] 27%|██▋       | 152/553 [00:01<00:03, 102.01it/s] 30%|███       | 168/553 [00:01<00:03, 116.26it/s] 33%|███▎      | 181/553 [00:01<00:03, 106.35it/s] 35%|███▍      | 193/553 [00:01<00:03, 93.21it/s]  37%|███▋      | 203/553 [00:01<00:03, 92.70it/s] 39%|███▉      | 217/553 [00:01<00:03, 102.04it/s] 42%|████▏     | 230/553 [00:02<00:02, 108.46it/s] 44%|████▍     | 245/553 [00:02<00:02, 119.13it/s] 47%|████▋     | 262/553 [00:02<00:02, 131.71it/s] 50%|████▉     | 276/553 [00:02<00:02, 113.34it/s] 52%|█████▏    | 289/553 [00:02<00:02, 96.76it/s]  54%|█████▍    | 300/553 [00:02<00:02, 87.38it/s] 56%|█████▌    | 311/553 [00:02<00:02, 87.25it/s] 58%|█████▊    | 321/553 [00:03<00:02, 79.88it/s] 60%|█████▉    | 330/553 [00:03<00:02, 77.36it/s] 61%|██████    | 338/553 [00:03<00:02, 77.32it/s] 64%|██████▍   | 353/553 [00:03<00:02, 92.99it/s] 66%|██████▌   | 366/553 [00:03<00:01, 100.88it/s] 69%|██████▉   | 382/553 [00:03<00:01, 116.51it/s] 71%|███████▏  | 395/553 [00:03<00:01, 111.00it/s] 74%|███████▍  | 410/553 [00:03<00:01, 120.37it/s] 76%|███████▋  | 423/553 [00:03<00:01, 116.61it/s] 79%|███████▉  | 436/553 [00:04<00:00, 119.35it/s] 82%|████████▏ | 454/553 [00:04<00:00, 134.31it/s] 85%|████████▍ | 470/553 [00:04<00:00, 140.23it/s] 88%|████████▊ | 485/553 [00:04<00:00, 140.39it/s] 90%|█████████ | 500/553 [00:04<00:00, 125.56it/s] 93%|█████████▎| 516/553 [00:04<00:00, 134.46it/s] 96%|█████████▌| 530/553 [00:04<00:00, 116.51it/s] 99%|█████████▊| 546/553 [00:04<00:00, 126.36it/s]100%|██████████| 553/553 [00:05<00:00, 110.34it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 257.18it/s]extract the null data:  60%|██████    | 84/139 [00:00<00:00, 444.45it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 489.86it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 220.94it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 222.50it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 221.73it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 220.92it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 221.10it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 222.21it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 221.71it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 128.13it/s] 21%|██        | 29/139 [00:00<00:00, 143.78it/s] 34%|███▍      | 47/139 [00:00<00:00, 157.58it/s] 45%|████▌     | 63/139 [00:00<00:00, 110.78it/s] 55%|█████▍    | 76/139 [00:00<00:00, 98.89it/s]  63%|██████▎   | 87/139 [00:00<00:00, 101.46it/s] 71%|███████   | 98/139 [00:00<00:00, 101.62it/s] 78%|███████▊  | 109/139 [00:01<00:00, 84.77it/s] 91%|█████████ | 126/139 [00:01<00:00, 99.89it/s] 99%|█████████▊| 137/139 [00:01<00:00, 101.30it/s]100%|██████████| 139/139 [00:01<00:00, 105.93it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 209.02it/s]extract the null data:  48%|████▊     | 83/173 [00:00<00:00, 446.50it/s]extract the null data:  74%|███████▍  | 128/173 [00:00<00:00, 431.34it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 448.58it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 202.00it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 203.17it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 144.92it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 135.07it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 154.26it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 166.96it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 174.76it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 180.23it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 169.80it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  5%|▌         | 9/173 [00:00<00:01, 83.22it/s] 10%|█         | 18/173 [00:00<00:01, 79.64it/s] 15%|█▌        | 26/173 [00:00<00:02, 64.46it/s] 20%|█▉        | 34/173 [00:00<00:02, 67.40it/s] 25%|██▌       | 44/173 [00:00<00:01, 75.34it/s] 34%|███▎      | 58/173 [00:00<00:01, 94.31it/s] 42%|████▏     | 73/173 [00:00<00:00, 110.94it/s] 51%|█████     | 88/173 [00:00<00:00, 121.29it/s] 60%|█████▉    | 103/173 [00:01<00:00, 120.21it/s] 69%|██████▉   | 119/173 [00:01<00:00, 128.86it/s] 77%|███████▋  | 133/173 [00:01<00:00, 125.87it/s] 86%|████████▌ | 148/173 [00:01<00:00, 130.79it/s] 94%|█████████▎| 162/173 [00:01<00:00, 122.59it/s]100%|██████████| 173/173 [00:01<00:00, 102.83it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.249, valid loss : 0.085, train acc : 0.685, valid acc : 0.543, train f1 : 0.679, valid f1 : 0.460
training process:   1%|          | 1/128 [01:10<2:28:22, 70.10s/it]Best score increase :0.000 -> 0.460
training process:   2%|▏         | 2/128 [02:10<2:14:46, 64.18s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:10<2:09:50, 62.32s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [04:23<2:17:54, 66.73s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.085, valid loss : 0.107, train acc : 0.738, valid acc : 0.498, train f1 : 0.720, valid f1 : 0.433
training process:   4%|▍         | 5/128 [05:45<2:27:45, 72.08s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [06:56<2:26:16, 71.94s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [08:11<2:26:49, 72.81s/it]Best score increase :0.460 -> 0.465
training process:   6%|▋         | 8/128 [09:26<2:26:40, 73.34s/it]Best score increase :0.465 -> 0.484
epoch : 9, train loss : 0.066, valid loss : 0.087, train acc : 0.778, valid acc : 0.596, train f1 : 0.768, valid f1 : 0.501
training process:   7%|▋         | 9/128 [10:47<2:30:27, 75.86s/it]Best score increase :0.484 -> 0.501
training process:   8%|▊         | 10/128 [11:59<2:26:45, 74.62s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [13:11<2:24:12, 73.95s/it]Best score increase :0.501 -> 0.528
training process:   9%|▉         | 12/128 [14:25<2:22:36, 73.76s/it]Best score increase :0.528 -> 0.533
epoch : 13, train loss : 0.060, valid loss : 0.083, train acc : 0.801, valid acc : 0.626, train f1 : 0.794, valid f1 : 0.522
training process:  10%|█         | 13/128 [15:46<2:25:35, 75.96s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [17:00<2:23:30, 75.53s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [18:14<2:21:28, 75.12s/it]Best score increase :0.533 -> 0.565
training process:  12%|█▎        | 16/128 [19:28<2:19:21, 74.66s/it]Best score increase :0.565 -> 0.575
epoch : 17, train loss : 0.052, valid loss : 0.082, train acc : 0.828, valid acc : 0.664, train f1 : 0.823, valid f1 : 0.551
training process:  13%|█▎        | 17/128 [20:53<2:23:56, 77.81s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [22:04<2:18:49, 75.72s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [23:17<2:16:10, 74.96s/it]Best score increase :0.575 -> 0.576
training process:  16%|█▌        | 20/128 [24:29<2:13:34, 74.21s/it]Best score increase :0.576 -> 0.578
epoch : 21, train loss : 0.051, valid loss : 0.078, train acc : 0.842, valid acc : 0.694, train f1 : 0.839, valid f1 : 0.573
training process:  16%|█▋        | 21/128 [25:55<2:18:33, 77.70s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [27:03<2:12:06, 74.78s/it]Best score increase :0.578 -> 0.602
training process:  18%|█▊        | 23/128 [28:07<2:05:15, 71.58s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [29:21<2:04:55, 72.07s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.047, valid loss : 0.073, train acc : 0.851, valid acc : 0.718, train f1 : 0.849, valid f1 : 0.591
training process:  20%|█▉        | 25/128 [30:32<2:03:35, 71.99s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [31:34<1:57:13, 68.96s/it]Best score increase :0.602 -> 0.647
training process:  21%|██        | 27/128 [32:38<1:53:13, 67.27s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [33:38<1:48:54, 65.34s/it]Best score increase :0.647 -> 0.650
epoch : 29, train loss : 0.045, valid loss : 0.069, train acc : 0.864, valid acc : 0.752, train f1 : 0.862, valid f1 : 0.619
training process:  23%|██▎       | 29/128 [34:47<1:49:26, 66.33s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [35:49<1:46:08, 64.98s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [36:50<1:43:11, 63.83s/it]Best score increase :0.650 -> 0.657
training process:  25%|██▌       | 32/128 [37:51<1:40:46, 62.99s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.042, valid loss : 0.063, train acc : 0.879, valid acc : 0.799, train f1 : 0.877, valid f1 : 0.661
training process:  26%|██▌       | 33/128 [39:10<1:47:17, 67.77s/it]Best score increase :0.657 -> 0.661
training process:  27%|██▋       | 34/128 [40:13<1:44:07, 66.46s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [41:13<1:40:01, 64.53s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [42:14<1:37:11, 63.39s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.039, valid loss : 0.057, train acc : 0.885, valid acc : 0.832, train f1 : 0.884, valid f1 : 0.692
training process:  29%|██▉       | 37/128 [43:26<1:39:56, 65.89s/it]Best score increase :0.661 -> 0.692
training process:  30%|██▉       | 38/128 [44:30<1:37:51, 65.24s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [45:33<1:35:48, 64.59s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [46:36<1:34:18, 64.30s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.038, valid loss : 0.058, train acc : 0.891, valid acc : 0.832, train f1 : 0.890, valid f1 : 0.694
training process:  32%|███▏      | 41/128 [47:49<1:36:48, 66.77s/it]Best score increase :0.692 -> 0.694
training process:  33%|███▎      | 42/128 [48:54<1:34:59, 66.28s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [49:57<1:32:30, 65.30s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [50:59<1:30:01, 64.30s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.036, valid loss : 0.060, train acc : 0.897, valid acc : 0.816, train f1 : 0.896, valid f1 : 0.677
training process:  35%|███▌      | 45/128 [52:11<1:31:57, 66.47s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [53:15<1:30:01, 65.87s/it]Best score increase :0.694 -> 0.703
training process:  37%|███▋      | 47/128 [54:18<1:27:46, 65.01s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [55:17<1:24:06, 63.08s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.036, valid loss : 0.063, train acc : 0.899, valid acc : 0.812, train f1 : 0.899, valid f1 : 0.673
training process:  38%|███▊      | 49/128 [56:27<1:26:07, 65.41s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [57:33<1:25:14, 65.57s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [58:31<1:21:06, 63.21s/it]Best score increase :0.703 -> 0.709
training process:  41%|████      | 52/128 [59:28<1:17:34, 61.24s/it]Best score increase :0.709 -> 0.724
epoch : 53, train loss : 0.032, valid loss : 0.061, train acc : 0.912, valid acc : 0.833, train f1 : 0.911, valid f1 : 0.694
training process:  41%|████▏     | 53/128 [1:00:37<1:19:23, 63.52s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [1:01:34<1:15:57, 61.59s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [1:02:25<1:11:18, 58.61s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [1:03:17<1:07:57, 56.63s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.032, valid loss : 0.062, train acc : 0.911, valid acc : 0.837, train f1 : 0.911, valid f1 : 0.698
training process:  45%|████▍     | 57/128 [1:04:21<1:09:34, 58.79s/it]EarlyStopping counter : 5 out of 12
training process:  45%|████▌     | 58/128 [1:05:23<1:09:49, 59.85s/it]Best score increase :0.724 -> 0.730
training process:  46%|████▌     | 59/128 [1:06:26<1:09:50, 60.73s/it]Best score increase :0.730 -> 0.734
training process:  47%|████▋     | 60/128 [1:07:27<1:08:58, 60.87s/it]EarlyStopping counter : 1 out of 12
epoch : 61, train loss : 0.032, valid loss : 0.057, train acc : 0.912, valid acc : 0.853, train f1 : 0.912, valid f1 : 0.715
training process:  48%|████▊     | 61/128 [1:08:41<1:12:06, 64.58s/it]EarlyStopping counter : 2 out of 12
training process:  48%|████▊     | 62/128 [1:09:47<1:11:30, 65.00s/it]EarlyStopping counter : 3 out of 12
training process:  49%|████▉     | 63/128 [1:10:55<1:11:29, 66.00s/it]EarlyStopping counter : 4 out of 12
training process:  50%|█████     | 64/128 [1:11:58<1:09:32, 65.19s/it]Best score increase :0.734 -> 0.744
epoch : 65, train loss : 0.031, valid loss : 0.057, train acc : 0.919, valid acc : 0.852, train f1 : 0.919, valid f1 : 0.715
training process:  51%|█████     | 65/128 [1:13:11<1:10:51, 67.49s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:14:12<1:07:44, 65.55s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:15:14<1:05:32, 64.46s/it]EarlyStopping counter : 3 out of 12
training process:  53%|█████▎    | 68/128 [1:16:17<1:04:01, 64.03s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.029, valid loss : 0.057, train acc : 0.923, valid acc : 0.856, train f1 : 0.923, valid f1 : 0.719
training process:  54%|█████▍    | 69/128 [1:17:28<1:05:06, 66.21s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▍    | 70/128 [1:18:28<1:02:01, 64.16s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▌    | 71/128 [1:19:34<1:01:28, 64.71s/it]EarlyStopping counter : 7 out of 12
training process:  56%|█████▋    | 72/128 [1:20:35<59:19, 63.56s/it]  EarlyStopping counter : 8 out of 12
epoch : 73, train loss : 0.030, valid loss : 0.054, train acc : 0.920, valid acc : 0.869, train f1 : 0.919, valid f1 : 0.735
training process:  57%|█████▋    | 73/128 [1:21:46<1:00:28, 65.97s/it]EarlyStopping counter : 9 out of 12
training process:  58%|█████▊    | 74/128 [1:22:46<57:49, 64.25s/it]  EarlyStopping counter : 10 out of 12
training process:  59%|█████▊    | 75/128 [1:23:48<55:54, 63.30s/it]EarlyStopping counter : 11 out of 12
training process:  59%|█████▊    | 75/128 [1:24:51<59:57, 67.88s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 75, best f1 score : 0.744
training process finished, best loss : 0.052 and best acc : 0.876, best f1 : 0.744, best epoch : 63

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.39      0.93      0.55       580
           1       0.99      0.88      0.93      6818

    accuracy                           0.88      7398
   macro avg       0.69      0.90      0.74      7398
weighted avg       0.95      0.88      0.90      7398


# test acc : 0.88, test f1 : 0.74, test AUC : 0.90, test loss : 2.804

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:37,  8.89s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:33,  9.35s/it]processing for feature importance:  25%|██▌       | 3/12 [00:28<01:25,  9.53s/it]processing for feature importance:  33%|███▎      | 4/12 [00:38<01:18,  9.82s/it]processing for feature importance:  42%|████▏     | 5/12 [00:48<01:08,  9.78s/it]processing for feature importance:  50%|█████     | 6/12 [00:59<01:01, 10.21s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:08<00:48,  9.74s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:18<00:39,  9.89s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:26<00:28,  9.48s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:36<00:19,  9.64s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:46<00:09,  9.62s/it]processing for feature importance: 100%|██████████| 12/12 [01:56<00:00,  9.67s/it]processing for feature importance: 100%|██████████| 12/12 [01:56<00:00,  9.69s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 10/306 [00:00<00:03, 97.42it/s] 10%|█         | 31/306 [00:00<00:01, 160.24it/s] 18%|█▊        | 54/306 [00:00<00:01, 188.98it/s] 25%|██▌       | 77/306 [00:00<00:01, 202.17it/s] 32%|███▏      | 99/306 [00:00<00:01, 206.79it/s] 40%|███▉      | 121/306 [00:00<00:00, 209.33it/s] 47%|████▋     | 143/306 [00:00<00:00, 212.63it/s] 54%|█████▍    | 165/306 [00:00<00:00, 195.74it/s] 60%|██████    | 185/306 [00:00<00:00, 194.30it/s] 68%|██████▊   | 208/306 [00:01<00:00, 202.80it/s] 75%|███████▌  | 231/306 [00:01<00:00, 208.01it/s] 82%|████████▏ | 252/306 [00:01<00:00, 168.85it/s] 89%|████████▊ | 271/306 [00:01<00:00, 166.34it/s] 96%|█████████▌| 293/306 [00:01<00:00, 179.46it/s]100%|██████████| 306/306 [00:01<00:00, 188.81it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 591.95it/s]extract the null data:  22%|██▏       | 120/553 [00:00<00:00, 555.38it/s]extract the null data:  33%|███▎      | 181/553 [00:00<00:00, 577.46it/s]extract the null data:  44%|████▍     | 242/553 [00:00<00:00, 586.60it/s]extract the null data:  54%|█████▍    | 301/553 [00:00<00:00, 559.90it/s]extract the null data:  65%|██████▌   | 360/553 [00:00<00:00, 567.80it/s]extract the null data:  76%|███████▌  | 419/553 [00:00<00:00, 574.71it/s]extract the null data:  86%|████████▋ | 477/553 [00:00<00:00, 571.08it/s]extract the null data:  97%|█████████▋| 535/553 [00:00<00:00, 483.55it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 538.88it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 196.97it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 173.65it/s]replace nan value:  10%|█         | 58/553 [00:00<00:03, 138.70it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:03, 157.33it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:02, 165.66it/s]replace nan value:  21%|██▏       | 118/553 [00:00<00:02, 178.27it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 187.29it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 192.46it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:01, 196.84it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 199.40it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 195.31it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 198.94it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 202.50it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 204.31it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 210.30it/s]replace nan value:  60%|██████    | 332/553 [00:01<00:01, 210.01it/s]replace nan value:  64%|██████▍   | 354/553 [00:01<00:00, 209.87it/s]replace nan value:  68%|██████▊   | 376/553 [00:01<00:00, 209.02it/s]replace nan value:  72%|███████▏  | 397/553 [00:02<00:00, 207.99it/s]replace nan value:  76%|███████▌  | 418/553 [00:02<00:00, 207.67it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 207.07it/s]replace nan value:  83%|████████▎ | 461/553 [00:02<00:00, 208.63it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 208.38it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 207.59it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 206.53it/s]replace nan value:  99%|█████████▊| 545/553 [00:02<00:00, 206.44it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 197.42it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 116.32it/s]  5%|▍         | 25/553 [00:00<00:04, 123.32it/s]  7%|▋         | 39/553 [00:00<00:04, 125.15it/s]  9%|▉         | 52/553 [00:00<00:04, 109.38it/s] 12%|█▏        | 64/553 [00:00<00:04, 106.89it/s] 14%|█▍        | 78/553 [00:00<00:04, 114.43it/s] 16%|█▋        | 91/553 [00:00<00:04, 113.86it/s] 19%|█▊        | 103/553 [00:00<00:04, 106.27it/s] 22%|██▏       | 121/553 [00:01<00:03, 124.67it/s] 25%|██▍       | 136/553 [00:01<00:03, 129.98it/s] 28%|██▊       | 154/553 [00:01<00:02, 143.77it/s] 31%|███       | 172/553 [00:01<00:02, 151.65it/s] 34%|███▍      | 188/553 [00:01<00:02, 149.56it/s] 37%|███▋      | 207/553 [00:01<00:02, 159.78it/s] 41%|████      | 224/553 [00:01<00:02, 145.96it/s] 43%|████▎     | 240/553 [00:01<00:02, 147.86it/s] 46%|████▋     | 256/553 [00:01<00:02, 141.86it/s] 49%|████▉     | 271/553 [00:02<00:02, 140.02it/s] 52%|█████▏    | 286/553 [00:02<00:01, 142.48it/s] 54%|█████▍    | 301/553 [00:02<00:01, 138.72it/s] 57%|█████▋    | 315/553 [00:02<00:02, 117.28it/s] 59%|█████▉    | 329/553 [00:02<00:01, 121.05it/s] 62%|██████▏   | 345/553 [00:02<00:01, 127.01it/s] 65%|██████▍   | 359/553 [00:02<00:01, 125.19it/s] 68%|██████▊   | 376/553 [00:02<00:01, 133.23it/s] 71%|███████   | 390/553 [00:02<00:01, 124.46it/s] 73%|███████▎  | 404/553 [00:03<00:01, 127.63it/s] 75%|███████▌  | 417/553 [00:03<00:01, 125.80it/s] 78%|███████▊  | 430/553 [00:03<00:01, 122.39it/s] 81%|████████  | 449/553 [00:03<00:00, 139.56it/s] 84%|████████▍ | 464/553 [00:03<00:00, 136.74it/s] 86%|████████▋ | 478/553 [00:03<00:00, 136.60it/s] 89%|████████▉ | 492/553 [00:03<00:00, 132.71it/s] 92%|█████████▏| 506/553 [00:03<00:00, 131.26it/s] 94%|█████████▍| 521/553 [00:03<00:00, 132.03it/s] 97%|█████████▋| 535/553 [00:04<00:00, 116.85it/s]100%|█████████▉| 551/553 [00:04<00:00, 109.44it/s]100%|██████████| 553/553 [00:04<00:00, 127.96it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   8%|▊         | 11/139 [00:00<00:01, 93.56it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 211.04it/s]extract the null data:  70%|██████▉   | 97/139 [00:00<00:00, 358.90it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 361.66it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 222.88it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 226.87it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 225.17it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 224.92it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 224.12it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 205.47it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 214.87it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.68it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.88it/s] 30%|███       | 42/139 [00:00<00:00, 141.49it/s] 41%|████      | 57/139 [00:00<00:00, 124.25it/s] 52%|█████▏    | 72/139 [00:00<00:00, 131.77it/s] 62%|██████▏   | 86/139 [00:00<00:00, 123.54it/s] 71%|███████   | 99/139 [00:00<00:00, 113.60it/s] 82%|████████▏ | 114/139 [00:00<00:00, 123.23it/s] 94%|█████████▎| 130/139 [00:01<00:00, 133.01it/s]100%|██████████| 139/139 [00:01<00:00, 129.58it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 208.70it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 476.23it/s]extract the null data:  87%|████████▋ | 150/173 [00:00<00:00, 526.93it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 502.12it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 219.95it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 218.88it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 204.94it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 189.82it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 199.53it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 206.90it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 207.49it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 191.30it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.07it/s] 16%|█▌        | 28/173 [00:00<00:01, 120.07it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.74it/s] 33%|███▎      | 57/173 [00:00<00:00, 131.53it/s] 41%|████      | 71/173 [00:00<00:00, 126.36it/s] 50%|█████     | 87/173 [00:00<00:00, 135.68it/s] 60%|█████▉    | 103/173 [00:00<00:00, 142.76it/s] 69%|██████▉   | 119/173 [00:00<00:00, 147.97it/s] 77%|███████▋  | 134/173 [00:00<00:00, 144.10it/s] 86%|████████▌ | 149/173 [00:01<00:00, 140.41it/s] 95%|█████████▍| 164/173 [00:01<00:00, 131.95it/s]100%|██████████| 173/173 [00:01<00:00, 126.09it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.521, valid loss : 0.378, train f1 : 0.586, valid f1 : 0.620
training process - Deferred Re-weighting:   1%|          | 1/128 [01:15<2:40:14, 75.71s/it]Best score increase :0.000 -> 0.620
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:22<2:28:33, 70.75s/it]Best score increase :0.620 -> 0.646
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:25<2:19:06, 66.77s/it]Best score increase :0.646 -> 0.685
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:25<2:12:44, 64.23s/it]Best score increase :0.685 -> 0.725
epoch : 5, train loss : 0.188, valid loss : 0.168, train f1 : 0.780, valid f1 : 0.747
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:34<2:15:35, 66.14s/it]Best score increase :0.725 -> 0.747
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:33<2:08:59, 63.44s/it]Best score increase :0.747 -> 0.779
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:32<2:05:22, 62.17s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:34<2:03:50, 61.92s/it]Best score increase :0.779 -> 0.799
epoch : 9, train loss : 0.140, valid loss : 0.157, train f1 : 0.820, valid f1 : 0.785
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:45<2:08:37, 64.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:47<2:05:40, 63.90s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:48<2:03:04, 63.12s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:51<2:02:01, 63.11s/it]Best score increase :0.799 -> 0.821
epoch : 13, train loss : 0.123, valid loss : 0.173, train f1 : 0.842, valid f1 : 0.783
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:03<2:06:04, 65.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [15:03<2:01:27, 63.93s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [16:02<1:57:53, 62.60s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:05<1:56:53, 62.62s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.114, valid loss : 0.157, train f1 : 0.852, valid f1 : 0.807
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:19<2:02:01, 65.96s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [19:20<1:58:27, 64.61s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [20:23<1:56:14, 63.99s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [21:26<1:54:54, 63.84s/it]EarlyStopping counter : 8 out of 12
epoch : 21, train loss : 0.107, valid loss : 0.157, train f1 : 0.868, valid f1 : 0.821
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [22:35<1:56:45, 65.47s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [23:36<1:53:06, 64.02s/it]Best score increase :0.821 -> 0.841
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [24:35<1:49:26, 62.54s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [25:36<1:47:26, 61.99s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.101, valid loss : 0.147, train f1 : 0.875, valid f1 : 0.834
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [26:42<1:48:37, 63.28s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [27:40<1:44:59, 61.76s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [28:44<1:45:12, 62.50s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [29:41<1:41:04, 60.65s/it]Best score increase :0.841 -> 0.844
epoch : 29, train loss : 0.098, valid loss : 0.161, train f1 : 0.876, valid f1 : 0.831
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [30:38<1:38:17, 59.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [31:25<1:31:19, 55.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [32:13<1:26:21, 53.42s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [33:02<1:23:32, 52.22s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.092, valid loss : 0.159, train f1 : 0.885, valid f1 : 0.841
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [34:02<1:26:23, 54.57s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [34:51<1:22:53, 52.91s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:41<1:20:22, 51.86s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:29<1:17:57, 50.85s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.089, valid loss : 0.170, train f1 : 0.889, valid f1 : 0.831
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [37:27<1:20:28, 53.06s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [38:18<1:18:37, 52.41s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [39:14<1:19:24, 53.53s/it]Best score increase :0.844 -> 0.851
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [40:01<1:15:25, 51.42s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.085, valid loss : 0.142, train f1 : 0.896, valid f1 : 0.855
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [40:55<1:15:37, 52.15s/it]Best score increase :0.851 -> 0.855
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [41:40<1:11:41, 50.02s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [42:26<1:09:13, 48.87s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [43:14<1:08:08, 48.67s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.081, valid loss : 0.139, train f1 : 0.901, valid f1 : 0.856
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [44:10<1:10:25, 50.91s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [44:58<1:08:05, 49.83s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [45:43<1:05:33, 48.56s/it]Best score increase :0.855 -> 0.861
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:30<1:04:02, 48.04s/it]Best score increase :0.861 -> 0.864
epoch : 49, train loss : 0.079, valid loss : 0.139, train f1 : 0.903, valid f1 : 0.861
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [47:24<1:05:24, 49.68s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [48:10<1:03:28, 48.83s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [48:58<1:02:15, 48.51s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [49:48<1:02:03, 48.99s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.077, valid loss : 0.167, train f1 : 0.906, valid f1 : 0.856
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [50:42<1:03:01, 50.42s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [51:28<1:00:29, 49.04s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [52:14<58:30, 48.09s/it]  EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [53:00<57:03, 47.55s/it]EarlyStopping counter : 8 out of 12
epoch : 57, train loss : 0.075, valid loss : 0.183, train f1 : 0.911, valid f1 : 0.848
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [53:59<1:00:12, 50.88s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [54:46<57:55, 49.65s/it]  Best score increase :0.864 -> 0.867
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [55:31<55:45, 48.49s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [56:19<54:39, 48.22s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.072, valid loss : 0.140, train f1 : 0.915, valid f1 : 0.867
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [57:15<56:23, 50.50s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [58:01<54:17, 49.35s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [58:48<52:40, 48.63s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [59:52<56:42, 53.16s/it]EarlyStopping counter : 6 out of 12
epoch : 65, train loss : 0.070, valid loss : 0.170, train f1 : 0.922, valid f1 : 0.857
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:00:57<59:36, 56.77s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:01:44<55:37, 53.83s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:02:43<56:05, 55.18s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:03:43<56:50, 56.84s/it]EarlyStopping counter : 10 out of 12
epoch : 69, train loss : 0.068, valid loss : 0.149, train f1 : 0.916, valid f1 : 0.868
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:04:48<58:15, 59.24s/it]Best score increase :0.867 -> 0.868
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:05:42<55:42, 57.63s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:06:33<52:59, 55.78s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:07:21<49:41, 53.23s/it]EarlyStopping counter : 3 out of 12
epoch : 73, train loss : 0.065, valid loss : 0.163, train f1 : 0.922, valid f1 : 0.867
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:08:16<49:22, 53.86s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:09:12<49:05, 54.54s/it]Best score increase :0.868 -> 0.871
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:10:12<49:34, 56.13s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:11:00<46:35, 53.77s/it]EarlyStopping counter : 2 out of 12
epoch : 77, train loss : 0.064, valid loss : 0.172, train f1 : 0.924, valid f1 : 0.860
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:12:06<48:46, 57.39s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:12:59<46:35, 55.90s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  62%|██████▏   | 79/128 [1:13:45<43:17, 53.00s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  62%|██████▎   | 80/128 [1:14:40<42:56, 53.69s/it]EarlyStopping counter : 6 out of 12
epoch : 81, train loss : 0.060, valid loss : 0.179, train f1 : 0.930, valid f1 : 0.861
training process - Deferred Re-weighting:  63%|██████▎   | 81/128 [1:15:44<44:23, 56.67s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  64%|██████▍   | 82/128 [1:16:35<42:13, 55.09s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  65%|██████▍   | 83/128 [1:17:32<41:44, 55.66s/it]Best score increase :0.871 -> 0.874
training process - Deferred Re-weighting:  66%|██████▌   | 84/128 [1:18:24<39:53, 54.40s/it]EarlyStopping counter : 1 out of 12
epoch : 85, train loss : 0.059, valid loss : 0.158, train f1 : 0.932, valid f1 : 0.865
training process - Deferred Re-weighting:  66%|██████▋   | 85/128 [1:19:20<39:28, 55.09s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  67%|██████▋   | 86/128 [1:20:16<38:40, 55.24s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  68%|██████▊   | 87/128 [1:21:16<38:41, 56.61s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  69%|██████▉   | 88/128 [1:22:09<37:06, 55.67s/it]EarlyStopping counter : 5 out of 12
epoch : 89, train loss : 0.057, valid loss : 0.169, train f1 : 0.934, valid f1 : 0.868
training process - Deferred Re-weighting:  70%|██████▉   | 89/128 [1:23:04<36:03, 55.48s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  70%|███████   | 90/128 [1:23:57<34:41, 54.79s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  71%|███████   | 91/128 [1:24:47<32:52, 53.32s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  72%|███████▏  | 92/128 [1:25:40<31:51, 53.09s/it]Best score increase :0.874 -> 0.877
epoch : 93, train loss : 0.054, valid loss : 0.166, train f1 : 0.937, valid f1 : 0.871
training process - Deferred Re-weighting:  73%|███████▎  | 93/128 [1:26:46<33:16, 57.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  73%|███████▎  | 94/128 [1:27:36<31:09, 54.97s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  74%|███████▍  | 95/128 [1:28:27<29:35, 53.80s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  75%|███████▌  | 96/128 [1:29:23<29:01, 54.42s/it]EarlyStopping counter : 4 out of 12
epoch : 97, train loss : 0.054, valid loss : 0.194, train f1 : 0.941, valid f1 : 0.855
training process - Deferred Re-weighting:  76%|███████▌  | 97/128 [1:30:32<30:25, 58.89s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  77%|███████▋  | 98/128 [1:31:30<29:18, 58.62s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  77%|███████▋  | 99/128 [1:32:28<28:14, 58.42s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  78%|███████▊  | 100/128 [1:33:26<27:05, 58.04s/it]EarlyStopping counter : 8 out of 12
epoch : 101, train loss : 0.050, valid loss : 0.174, train f1 : 0.940, valid f1 : 0.868
training process - Deferred Re-weighting:  79%|███████▉  | 101/128 [1:34:34<27:28, 61.04s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  80%|███████▉  | 102/128 [1:35:25<25:09, 58.07s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  80%|████████  | 103/128 [1:36:15<23:14, 55.77s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  80%|████████  | 103/128 [1:37:06<23:34, 56.57s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 103, best f1 score : 0.877
training process finished, best loss : 0.158, best acc : 0.967, best f1 : 0.877, best epoch : 91

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.95      0.67      0.78       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.96      0.83      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.83, test loss : 10.070

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.63s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:15,  7.58s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.50s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<00:59,  7.50s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.47s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:44,  7.49s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:38,  7.61s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.67s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:23,  7.77s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.74s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.78s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.78s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.67s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 206.48it/s] 15%|█▌        | 47/306 [00:00<00:01, 233.81it/s] 24%|██▍       | 73/306 [00:00<00:00, 242.75it/s] 32%|███▏      | 98/306 [00:00<00:00, 243.02it/s] 40%|████      | 123/306 [00:00<00:00, 241.97it/s] 48%|████▊     | 148/306 [00:00<00:00, 243.75it/s] 57%|█████▋    | 174/306 [00:00<00:00, 246.07it/s] 65%|██████▌   | 200/306 [00:00<00:00, 248.13it/s] 74%|███████▎  | 225/306 [00:00<00:00, 247.95it/s] 82%|████████▏ | 250/306 [00:01<00:00, 248.17it/s] 90%|████████▉ | 275/306 [00:01<00:00, 247.37it/s] 98%|█████████▊| 301/306 [00:01<00:00, 249.27it/s]100%|██████████| 306/306 [00:01<00:00, 245.22it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 68/553 [00:00<00:00, 674.66it/s]extract the null data:  25%|██▍       | 137/553 [00:00<00:00, 681.77it/s]extract the null data:  38%|███▊      | 208/553 [00:00<00:00, 691.66it/s]extract the null data:  50%|█████     | 278/553 [00:00<00:00, 694.26it/s]extract the null data:  63%|██████▎   | 348/553 [00:00<00:00, 688.25it/s]extract the null data:  75%|███████▌  | 417/553 [00:00<00:00, 687.22it/s]extract the null data:  88%|████████▊ | 486/553 [00:00<00:00, 684.36it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 685.58it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 218.17it/s]replace nan value:   8%|▊         | 44/553 [00:00<00:02, 216.93it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:02, 214.93it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 214.86it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 215.23it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:01, 216.51it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:01, 215.92it/s]replace nan value:  32%|███▏      | 177/553 [00:00<00:01, 218.27it/s]replace nan value:  36%|███▌      | 200/553 [00:00<00:01, 221.61it/s]replace nan value:  41%|████      | 224/553 [00:01<00:01, 224.18it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 224.65it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 221.17it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 223.03it/s]replace nan value:  57%|█████▋    | 316/553 [00:01<00:01, 220.95it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:00, 221.52it/s]replace nan value:  65%|██████▌   | 362/553 [00:01<00:00, 219.09it/s]replace nan value:  69%|██████▉   | 384/553 [00:01<00:00, 217.75it/s]replace nan value:  73%|███████▎  | 406/553 [00:01<00:00, 215.35it/s]replace nan value:  77%|███████▋  | 428/553 [00:01<00:00, 214.61it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 215.88it/s]replace nan value:  85%|████████▌ | 472/553 [00:02<00:00, 216.00it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 214.91it/s]replace nan value:  93%|█████████▎| 516/553 [00:02<00:00, 215.22it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 215.09it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 217.65it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 144.64it/s]  6%|▌         | 32/553 [00:00<00:03, 156.15it/s]  9%|▊         | 48/553 [00:00<00:03, 131.32it/s] 11%|█         | 62/553 [00:00<00:03, 130.98it/s] 14%|█▍        | 77/553 [00:00<00:03, 135.96it/s] 17%|█▋        | 93/553 [00:00<00:03, 138.68it/s] 20%|█▉        | 109/553 [00:00<00:03, 143.66it/s] 23%|██▎       | 125/553 [00:00<00:02, 146.28it/s] 26%|██▌       | 144/553 [00:00<00:02, 157.91it/s] 29%|██▉       | 163/553 [00:01<00:02, 165.95it/s] 33%|███▎      | 181/553 [00:01<00:02, 167.61it/s] 36%|███▌      | 199/553 [00:01<00:02, 171.23it/s] 39%|███▉      | 217/553 [00:01<00:01, 170.30it/s] 42%|████▏     | 235/553 [00:01<00:01, 164.22it/s] 46%|████▌     | 252/553 [00:01<00:01, 161.09it/s] 49%|████▊     | 269/553 [00:01<00:01, 156.56it/s] 52%|█████▏    | 285/553 [00:01<00:01, 153.66it/s] 54%|█████▍    | 301/553 [00:01<00:01, 149.84it/s] 57%|█████▋    | 317/553 [00:02<00:01, 142.79it/s] 60%|██████    | 332/553 [00:02<00:01, 142.39it/s] 63%|██████▎   | 348/553 [00:02<00:01, 142.14it/s] 66%|██████▌   | 363/553 [00:02<00:01, 138.93it/s] 69%|██████▊   | 379/553 [00:02<00:01, 143.87it/s] 71%|███████   | 394/553 [00:02<00:01, 134.06it/s] 74%|███████▍  | 409/553 [00:02<00:01, 137.90it/s] 76%|███████▋  | 423/553 [00:02<00:00, 131.85it/s] 79%|███████▉  | 437/553 [00:02<00:00, 132.68it/s] 82%|████████▏ | 455/553 [00:03<00:00, 145.00it/s] 85%|████████▌ | 471/553 [00:03<00:00, 147.48it/s] 88%|████████▊ | 486/553 [00:03<00:00, 145.03it/s] 91%|█████████ | 501/553 [00:03<00:00, 135.26it/s] 94%|█████████▎| 518/553 [00:03<00:00, 143.12it/s] 96%|█████████▋| 533/553 [00:03<00:00, 122.40it/s]100%|█████████▉| 551/553 [00:03<00:00, 115.44it/s]100%|██████████| 553/553 [00:03<00:00, 142.41it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  35%|███▌      | 49/139 [00:00<00:00, 488.07it/s]extract the null data:  88%|████████▊ | 123/139 [00:00<00:00, 632.27it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 620.20it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 234.44it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 234.51it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 235.85it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 235.98it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 236.86it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 236.14it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 130.42it/s] 21%|██        | 29/139 [00:00<00:00, 139.43it/s] 33%|███▎      | 46/139 [00:00<00:00, 149.94it/s] 45%|████▍     | 62/139 [00:00<00:00, 135.80it/s] 55%|█████▌    | 77/139 [00:00<00:00, 136.53it/s] 65%|██████▌   | 91/139 [00:00<00:00, 127.58it/s] 76%|███████▋  | 106/139 [00:00<00:00, 131.34it/s] 88%|████████▊ | 123/139 [00:00<00:00, 141.12it/s] 99%|█████████▉| 138/139 [00:00<00:00, 141.30it/s]100%|██████████| 139/139 [00:01<00:00, 138.30it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 40/173 [00:00<00:00, 398.35it/s]extract the null data:  69%|██████▉   | 119/173 [00:00<00:00, 626.15it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 631.55it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 248.15it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 246.02it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 246.83it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 249.07it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 249.08it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 250.20it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 247.40it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:01, 154.87it/s] 18%|█▊        | 32/173 [00:00<00:01, 133.07it/s] 30%|███       | 52/173 [00:00<00:00, 156.21it/s] 39%|███▉      | 68/173 [00:00<00:00, 152.71it/s] 49%|████▊     | 84/173 [00:00<00:00, 150.22it/s] 58%|█████▊    | 100/173 [00:00<00:00, 153.13it/s] 68%|██████▊   | 117/173 [00:00<00:00, 156.31it/s] 77%|███████▋  | 133/173 [00:00<00:00, 144.98it/s] 86%|████████▌ | 148/173 [00:00<00:00, 143.82it/s] 94%|█████████▍| 163/173 [00:01<00:00, 131.10it/s]100%|██████████| 173/173 [00:01<00:00, 131.49it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.562, valid loss : 0.430, train f1 : 0.701, valid f1 : 0.623
training process - Deferred Re-weighting:   1%|          | 1/128 [00:53<1:53:17, 53.53s/it]Best score increase :0.000 -> 0.623
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:37<1:40:32, 47.88s/it]Best score increase :0.623 -> 0.706
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:22<1:37:26, 46.77s/it]Best score increase :0.706 -> 0.778
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:08<1:35:35, 46.26s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.339, valid loss : 0.269, train f1 : 0.849, valid f1 : 0.778
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:03<1:41:06, 49.32s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [04:52<1:40:28, 49.42s/it]Best score increase :0.778 -> 0.804
training process - Deferred Re-weighting:   5%|▌         | 7/128 [05:39<1:37:38, 48.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:25<1:35:46, 47.89s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.284, valid loss : 0.240, train f1 : 0.876, valid f1 : 0.789
training process - Deferred Re-weighting:   7%|▋         | 9/128 [07:18<1:37:45, 49.29s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:03<1:34:37, 48.11s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [08:48<1:31:58, 47.16s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [09:33<1:29:37, 46.36s/it]Best score increase :0.804 -> 0.821
epoch : 13, train loss : 0.254, valid loss : 0.207, train f1 : 0.892, valid f1 : 0.805
training process - Deferred Re-weighting:  10%|█         | 13/128 [10:25<1:32:10, 48.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [11:10<1:29:26, 47.07s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [11:55<1:27:51, 46.65s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [12:41<1:26:42, 46.45s/it]Best score increase :0.821 -> 0.825
epoch : 17, train loss : 0.220, valid loss : 0.205, train f1 : 0.909, valid f1 : 0.824
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [13:34<1:29:14, 48.24s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [14:18<1:26:13, 47.03s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [15:03<1:24:29, 46.51s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [16:05<1:32:05, 51.16s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.208, valid loss : 0.202, train f1 : 0.916, valid f1 : 0.804
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [17:15<1:41:04, 56.67s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [18:15<1:41:59, 57.73s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [19:14<1:41:35, 58.05s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [20:06<1:37:41, 56.36s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.191, valid loss : 0.195, train f1 : 0.921, valid f1 : 0.799
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [21:05<1:37:56, 57.06s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [22:00<1:36:14, 56.61s/it]Best score increase :0.825 -> 0.844
training process - Deferred Re-weighting:  21%|██        | 27/128 [22:57<1:35:12, 56.56s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [23:59<1:37:18, 58.38s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.177, valid loss : 0.157, train f1 : 0.930, valid f1 : 0.847
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [25:06<1:40:32, 60.93s/it]Best score increase :0.844 -> 0.847
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [26:04<1:37:44, 59.84s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [27:01<1:35:42, 59.20s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [27:56<1:32:37, 57.89s/it]EarlyStopping counter : 3 out of 12
epoch : 33, train loss : 0.167, valid loss : 0.175, train f1 : 0.934, valid f1 : 0.828
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:02<1:35:14, 60.16s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [29:58<1:32:30, 59.05s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [30:55<1:30:24, 58.32s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [31:50<1:28:00, 57.39s/it]EarlyStopping counter : 7 out of 12
epoch : 37, train loss : 0.153, valid loss : 0.141, train f1 : 0.940, valid f1 : 0.856
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [32:55<1:30:32, 59.69s/it]Best score increase :0.847 -> 0.856
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [33:52<1:28:34, 59.04s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [34:53<1:28:13, 59.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [36:02<1:31:19, 62.26s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.150, valid loss : 0.151, train f1 : 0.942, valid f1 : 0.849
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [37:18<1:36:30, 66.55s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [38:32<1:38:38, 68.82s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [39:43<1:38:15, 69.36s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:35<1:29:54, 64.22s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.134, valid loss : 0.162, train f1 : 0.950, valid f1 : 0.842
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:35<1:26:50, 62.78s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [42:36<1:25:07, 62.29s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [43:49<1:28:26, 65.52s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [45:01<1:30:03, 67.54s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.128, valid loss : 0.170, train f1 : 0.951, valid f1 : 0.837
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:17<1:17:08, 57.86s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.856
training process finished, best loss : 0.147, best acc : 0.949, best f1 : 0.856, best epoch : 45

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.85      0.75       580
           1       0.99      0.97      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.83      0.91      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.91, test loss : 8.001

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.02s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.63s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.50s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<00:59,  7.43s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:51,  7.31s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:43,  7.18s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.22s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:29,  7.33s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:22,  7.50s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:15,  7.90s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:08,  8.03s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  8.34s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.75s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 105.80it/s]  7%|▋         | 22/306 [00:00<00:02, 104.41it/s] 13%|█▎        | 41/306 [00:00<00:01, 140.93it/s] 18%|█▊        | 56/306 [00:00<00:02, 116.66it/s] 24%|██▍       | 74/306 [00:00<00:01, 132.26it/s] 29%|██▉       | 88/306 [00:00<00:01, 119.50it/s] 34%|███▍      | 104/306 [00:00<00:01, 130.47it/s] 39%|███▊      | 118/306 [00:00<00:01, 118.62it/s] 46%|████▌     | 141/306 [00:01<00:01, 146.55it/s] 51%|█████▏    | 157/306 [00:01<00:01, 142.43it/s] 56%|█████▌    | 172/306 [00:01<00:00, 134.75it/s] 61%|██████    | 186/306 [00:01<00:00, 135.95it/s] 65%|██████▌   | 200/306 [00:01<00:00, 126.45it/s] 72%|███████▏  | 219/306 [00:01<00:00, 141.68it/s] 76%|███████▋  | 234/306 [00:01<00:00, 125.87it/s] 82%|████████▏ | 252/306 [00:01<00:00, 139.19it/s] 87%|████████▋ | 267/306 [00:02<00:00, 130.22it/s] 93%|█████████▎| 286/306 [00:02<00:00, 145.31it/s] 99%|█████████▊| 302/306 [00:02<00:00, 136.30it/s]100%|██████████| 306/306 [00:02<00:00, 133.36it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 40/553 [00:00<00:01, 398.73it/s]extract the null data:  15%|█▌        | 83/553 [00:00<00:01, 413.71it/s]extract the null data:  23%|██▎       | 126/553 [00:00<00:01, 420.42it/s]extract the null data:  31%|███       | 170/553 [00:00<00:00, 427.63it/s]extract the null data:  39%|███▉      | 216/553 [00:00<00:00, 438.99it/s]extract the null data:  47%|████▋     | 261/553 [00:00<00:00, 439.68it/s]extract the null data:  56%|█████▌    | 307/553 [00:00<00:00, 446.00it/s]extract the null data:  64%|██████▎   | 352/553 [00:00<00:00, 438.59it/s]extract the null data:  72%|███████▏  | 399/553 [00:00<00:00, 446.19it/s]extract the null data:  80%|████████  | 445/553 [00:01<00:00, 448.85it/s]extract the null data:  89%|████████▉ | 491/553 [00:01<00:00, 449.98it/s]extract the null data:  97%|█████████▋| 537/553 [00:01<00:00, 449.05it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 440.88it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 159.23it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 164.82it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 163.34it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:02, 162.58it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 161.89it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 162.31it/s]replace nan value:  21%|██▏       | 118/553 [00:00<00:02, 164.37it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 164.54it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 164.87it/s]replace nan value:  31%|███       | 169/553 [00:01<00:02, 164.38it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 166.58it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 165.36it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:02, 164.65it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 164.04it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 163.65it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 164.23it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 165.30it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 164.67it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 164.61it/s]replace nan value:  61%|██████▏   | 340/553 [00:02<00:01, 165.92it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 165.60it/s]replace nan value:  68%|██████▊   | 374/553 [00:02<00:01, 166.55it/s]replace nan value:  71%|███████   | 392/553 [00:02<00:00, 167.76it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 167.15it/s]replace nan value:  77%|███████▋  | 426/553 [00:02<00:00, 165.58it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 164.90it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 165.64it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 165.35it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 166.07it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 167.07it/s]replace nan value:  95%|█████████▌| 528/553 [00:03<00:00, 166.46it/s]replace nan value:  99%|█████████▊| 545/553 [00:03<00:00, 163.13it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 164.65it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.36it/s]  5%|▍         | 27/553 [00:00<00:03, 131.67it/s]  7%|▋         | 41/553 [00:00<00:03, 129.12it/s] 10%|▉         | 54/553 [00:00<00:04, 118.71it/s] 12%|█▏        | 66/553 [00:00<00:04, 110.40it/s] 14%|█▍        | 80/553 [00:00<00:04, 115.16it/s] 17%|█▋        | 93/553 [00:00<00:03, 119.18it/s] 19%|█▉        | 107/553 [00:00<00:03, 124.31it/s] 22%|██▏       | 122/553 [00:00<00:03, 126.22it/s] 25%|██▍       | 137/553 [00:01<00:03, 131.49it/s] 28%|██▊       | 153/553 [00:01<00:02, 139.33it/s] 31%|███       | 170/553 [00:01<00:02, 146.85it/s] 33%|███▎      | 185/553 [00:01<00:02, 141.97it/s] 37%|███▋      | 202/553 [00:01<00:02, 145.85it/s] 39%|███▉      | 217/553 [00:01<00:02, 144.40it/s] 42%|████▏     | 232/553 [00:01<00:02, 138.15it/s] 44%|████▍     | 246/553 [00:01<00:02, 138.11it/s] 47%|████▋     | 260/553 [00:01<00:02, 138.51it/s] 50%|████▉     | 274/553 [00:02<00:02, 131.67it/s] 52%|█████▏    | 288/553 [00:02<00:01, 133.88it/s] 55%|█████▍    | 302/553 [00:02<00:01, 126.88it/s] 57%|█████▋    | 315/553 [00:02<00:01, 121.16it/s] 59%|█████▉    | 328/553 [00:02<00:01, 120.80it/s] 62%|██████▏   | 342/553 [00:02<00:01, 126.04it/s] 64%|██████▍   | 355/553 [00:02<00:01, 121.33it/s] 67%|██████▋   | 368/553 [00:02<00:01, 123.05it/s] 69%|██████▉   | 382/553 [00:02<00:01, 127.15it/s] 71%|███████▏  | 395/553 [00:03<00:01, 113.67it/s] 74%|███████▍  | 408/553 [00:03<00:01, 117.14it/s] 76%|███████▌  | 420/553 [00:03<00:01, 112.61it/s] 78%|███████▊  | 432/553 [00:03<00:01, 110.36it/s] 81%|████████  | 449/553 [00:03<00:00, 124.59it/s] 84%|████████▎ | 463/553 [00:03<00:00, 127.14it/s] 86%|████████▌ | 476/553 [00:03<00:00, 127.94it/s] 88%|████████▊ | 489/553 [00:03<00:00, 120.17it/s] 91%|█████████ | 502/553 [00:03<00:00, 116.52it/s] 93%|█████████▎| 517/553 [00:04<00:00, 123.15it/s] 96%|█████████▌| 530/553 [00:04<00:00, 105.34it/s] 98%|█████████▊| 544/553 [00:04<00:00, 112.93it/s]100%|██████████| 553/553 [00:04<00:00, 122.80it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 275.88it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 415.83it/s]extract the null data:  96%|█████████▌| 133/139 [00:00<00:00, 464.70it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 439.49it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 180.72it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 182.06it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 181.46it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 180.85it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 180.60it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 178.63it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 177.86it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 179.65it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.84it/s] 17%|█▋        | 24/139 [00:00<00:00, 117.34it/s] 27%|██▋       | 37/139 [00:00<00:00, 121.91it/s] 36%|███▌      | 50/139 [00:00<00:00, 122.46it/s] 45%|████▌     | 63/139 [00:00<00:00, 118.94it/s] 54%|█████▍    | 75/139 [00:00<00:00, 118.23it/s] 63%|██████▎   | 87/139 [00:00<00:00, 106.46it/s] 71%|███████   | 99/139 [00:00<00:00, 106.65it/s] 80%|███████▉  | 111/139 [00:00<00:00, 109.45it/s] 90%|████████▉ | 125/139 [00:01<00:00, 118.11it/s] 99%|█████████▊| 137/139 [00:01<00:00, 117.28it/s]100%|██████████| 139/139 [00:01<00:00, 115.68it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 20/173 [00:00<00:00, 197.54it/s]extract the null data:  41%|████      | 71/173 [00:00<00:00, 378.83it/s]extract the null data:  71%|███████   | 123/173 [00:00<00:00, 440.86it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 429.84it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 184.41it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 181.31it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 181.84it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 179.71it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 180.38it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 179.69it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 177.72it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 176.28it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 173.67it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 177.10it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 125.65it/s] 16%|█▌        | 27/173 [00:00<00:01, 109.46it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.71it/s] 32%|███▏      | 55/173 [00:00<00:00, 124.47it/s] 39%|███▉      | 68/173 [00:00<00:00, 124.10it/s] 47%|████▋     | 81/173 [00:00<00:00, 123.78it/s] 54%|█████▍    | 94/173 [00:00<00:00, 124.49it/s] 62%|██████▏   | 107/173 [00:00<00:00, 123.41it/s] 69%|██████▉   | 120/173 [00:00<00:00, 122.10it/s] 77%|███████▋  | 133/173 [00:01<00:00, 115.83it/s] 84%|████████▍ | 146/173 [00:01<00:00, 116.41it/s] 91%|█████████▏| 158/173 [00:01<00:00, 107.22it/s] 98%|█████████▊| 169/173 [00:01<00:00, 86.75it/s] 100%|██████████| 173/173 [00:01<00:00, 106.19it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.102, valid loss : 0.065, train acc : 0.874, valid acc : 0.924, train f1 : 0.571, valid f1 : 0.587
training process:   1%|          | 1/128 [01:07<2:22:53, 67.51s/it]Best score increase :0.000 -> 0.587
training process:   2%|▏         | 2/128 [02:00<2:04:07, 59.11s/it]Best score increase :0.587 -> 0.645
training process:   2%|▏         | 3/128 [03:11<2:14:14, 64.43s/it]Best score increase :0.645 -> 0.692
training process:   3%|▎         | 4/128 [04:22<2:18:30, 67.02s/it]Best score increase :0.692 -> 0.712
epoch : 5, train loss : 0.043, valid loss : 0.049, train acc : 0.949, valid acc : 0.942, train f1 : 0.775, valid f1 : 0.742
training process:   4%|▍         | 5/128 [05:50<2:33:07, 74.69s/it]Best score increase :0.712 -> 0.742
training process:   5%|▍         | 6/128 [07:05<2:31:57, 74.74s/it]Best score increase :0.742 -> 0.765
training process:   5%|▌         | 7/128 [07:58<2:16:03, 67.47s/it]Best score increase :0.765 -> 0.779
training process:   6%|▋         | 8/128 [08:51<2:05:46, 62.88s/it]Best score increase :0.779 -> 0.797
epoch : 9, train loss : 0.036, valid loss : 0.047, train acc : 0.956, valid acc : 0.950, train f1 : 0.819, valid f1 : 0.783
training process:   7%|▋         | 9/128 [10:10<2:15:02, 68.09s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [11:28<2:19:45, 71.06s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [12:43<2:21:13, 72.42s/it]Best score increase :0.797 -> 0.799
training process:   9%|▉         | 12/128 [14:00<2:22:25, 73.67s/it]Best score increase :0.799 -> 0.817
epoch : 13, train loss : 0.034, valid loss : 0.050, train acc : 0.960, valid acc : 0.951, train f1 : 0.840, valid f1 : 0.790
training process:  10%|█         | 13/128 [15:01<2:13:54, 69.86s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [16:01<2:06:59, 66.83s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [17:17<2:11:20, 69.74s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [18:32<2:13:03, 71.28s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.031, valid loss : 0.046, train acc : 0.962, valid acc : 0.953, train f1 : 0.850, valid f1 : 0.808
training process:  13%|█▎        | 17/128 [19:55<2:18:31, 74.88s/it]EarlyStopping counter : 5 out of 12
training process:  14%|█▍        | 18/128 [21:00<2:11:22, 71.66s/it]EarlyStopping counter : 6 out of 12
training process:  15%|█▍        | 19/128 [21:53<1:59:57, 66.03s/it]EarlyStopping counter : 7 out of 12
training process:  16%|█▌        | 20/128 [22:52<1:55:28, 64.16s/it]Best score increase :0.817 -> 0.818
epoch : 21, train loss : 0.030, valid loss : 0.046, train acc : 0.965, valid acc : 0.955, train f1 : 0.863, valid f1 : 0.814
training process:  16%|█▋        | 21/128 [24:18<2:06:00, 70.66s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [25:30<2:05:26, 71.00s/it]Best score increase :0.818 -> 0.829
training process:  18%|█▊        | 23/128 [26:43<2:05:33, 71.75s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [27:52<2:02:55, 70.92s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.029, valid loss : 0.043, train acc : 0.966, valid acc : 0.956, train f1 : 0.868, valid f1 : 0.819
training process:  20%|█▉        | 25/128 [28:53<1:56:36, 67.93s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [29:54<1:51:33, 65.62s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [31:01<1:51:26, 66.20s/it]Best score increase :0.829 -> 0.835
training process:  22%|██▏       | 28/128 [31:54<1:43:38, 62.18s/it]Best score increase :0.835 -> 0.840
epoch : 29, train loss : 0.027, valid loss : 0.043, train acc : 0.967, valid acc : 0.958, train f1 : 0.871, valid f1 : 0.830
training process:  23%|██▎       | 29/128 [32:55<1:42:10, 61.92s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [33:47<1:36:12, 58.91s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [34:42<1:33:07, 57.60s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [35:39<1:32:10, 57.61s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.026, valid loss : 0.045, train acc : 0.969, valid acc : 0.958, train f1 : 0.881, valid f1 : 0.829
training process:  26%|██▌       | 33/128 [36:43<1:34:11, 59.49s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [37:40<1:31:49, 58.61s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [38:34<1:28:33, 57.14s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [39:25<1:25:11, 55.55s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.025, valid loss : 0.045, train acc : 0.970, valid acc : 0.958, train f1 : 0.886, valid f1 : 0.831
training process:  29%|██▉       | 37/128 [40:35<1:30:39, 59.78s/it]EarlyStopping counter : 9 out of 12
training process:  30%|██▉       | 38/128 [41:32<1:28:16, 58.85s/it]EarlyStopping counter : 10 out of 12
training process:  30%|███       | 39/128 [42:20<1:22:24, 55.56s/it]Best score increase :0.840 -> 0.844
training process:  31%|███▏      | 40/128 [43:08<1:18:08, 53.27s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.024, valid loss : 0.043, train acc : 0.972, valid acc : 0.961, train f1 : 0.891, valid f1 : 0.845
training process:  32%|███▏      | 41/128 [44:11<1:21:40, 56.33s/it]EarlyStopping counter : 2 out of 12
training process:  33%|███▎      | 42/128 [45:25<1:28:08, 61.50s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▎      | 43/128 [46:39<1:32:29, 65.29s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▍      | 44/128 [47:55<1:35:58, 68.55s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.023, valid loss : 0.041, train acc : 0.972, valid acc : 0.961, train f1 : 0.896, valid f1 : 0.849
training process:  35%|███▌      | 45/128 [49:09<1:37:21, 70.38s/it]Best score increase :0.844 -> 0.849
training process:  36%|███▌      | 46/128 [49:55<1:26:04, 62.98s/it]EarlyStopping counter : 1 out of 12
training process:  37%|███▋      | 47/128 [50:42<1:18:17, 57.99s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 48/128 [51:49<1:21:05, 60.82s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.023, valid loss : 0.041, train acc : 0.972, valid acc : 0.962, train f1 : 0.895, valid f1 : 0.855
training process:  38%|███▊      | 49/128 [53:05<1:26:07, 65.41s/it]Best score increase :0.849 -> 0.855
training process:  39%|███▉      | 50/128 [54:12<1:25:49, 66.01s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [55:20<1:25:11, 66.38s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [56:20<1:21:41, 64.49s/it]EarlyStopping counter : 3 out of 12
epoch : 53, train loss : 0.023, valid loss : 0.049, train acc : 0.973, valid acc : 0.961, train f1 : 0.897, valid f1 : 0.843
training process:  41%|████▏     | 53/128 [57:15<1:17:15, 61.81s/it]EarlyStopping counter : 4 out of 12
training process:  42%|████▏     | 54/128 [58:08<1:12:40, 58.92s/it]EarlyStopping counter : 5 out of 12
training process:  43%|████▎     | 55/128 [59:24<1:17:57, 64.08s/it]EarlyStopping counter : 6 out of 12
training process:  44%|████▍     | 56/128 [1:00:43<1:22:18, 68.59s/it]EarlyStopping counter : 7 out of 12
epoch : 57, train loss : 0.022, valid loss : 0.050, train acc : 0.974, valid acc : 0.961, train f1 : 0.901, valid f1 : 0.844
training process:  45%|████▍     | 57/128 [1:02:09<1:27:20, 73.81s/it]EarlyStopping counter : 8 out of 12
training process:  45%|████▌     | 58/128 [1:03:15<1:23:27, 71.54s/it]Best score increase :0.855 -> 0.857
training process:  46%|████▌     | 59/128 [1:04:01<1:13:19, 63.76s/it]EarlyStopping counter : 1 out of 12
training process:  47%|████▋     | 60/128 [1:04:49<1:06:57, 59.08s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.021, valid loss : 0.043, train acc : 0.974, valid acc : 0.963, train f1 : 0.902, valid f1 : 0.855
training process:  48%|████▊     | 61/128 [1:06:16<1:15:17, 67.42s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 62/128 [1:07:33<1:17:19, 70.30s/it]EarlyStopping counter : 4 out of 12
training process:  49%|████▉     | 63/128 [1:08:47<1:17:22, 71.42s/it]EarlyStopping counter : 5 out of 12
training process:  50%|█████     | 64/128 [1:09:53<1:14:36, 69.94s/it]EarlyStopping counter : 6 out of 12
epoch : 65, train loss : 0.021, valid loss : 0.046, train acc : 0.976, valid acc : 0.963, train f1 : 0.912, valid f1 : 0.857
training process:  51%|█████     | 65/128 [1:10:56<1:11:03, 67.67s/it]EarlyStopping counter : 7 out of 12
training process:  52%|█████▏    | 66/128 [1:12:01<1:09:23, 67.15s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 67/128 [1:13:13<1:09:37, 68.48s/it]EarlyStopping counter : 9 out of 12
training process:  53%|█████▎    | 68/128 [1:14:24<1:09:19, 69.32s/it]EarlyStopping counter : 10 out of 12
epoch : 69, train loss : 0.021, valid loss : 0.043, train acc : 0.975, valid acc : 0.964, train f1 : 0.905, valid f1 : 0.860
training process:  54%|█████▍    | 69/128 [1:15:46<1:11:44, 72.96s/it]Best score increase :0.857 -> 0.860
training process:  55%|█████▍    | 70/128 [1:16:46<1:06:43, 69.02s/it]EarlyStopping counter : 1 out of 12
training process:  55%|█████▌    | 71/128 [1:17:44<1:02:39, 65.96s/it]EarlyStopping counter : 2 out of 12
training process:  56%|█████▋    | 72/128 [1:18:48<1:00:56, 65.29s/it]EarlyStopping counter : 3 out of 12
epoch : 73, train loss : 0.020, valid loss : 0.047, train acc : 0.976, valid acc : 0.963, train f1 : 0.911, valid f1 : 0.857
training process:  57%|█████▋    | 73/128 [1:19:59<1:01:29, 67.08s/it]EarlyStopping counter : 4 out of 12
training process:  58%|█████▊    | 74/128 [1:21:00<58:30, 65.01s/it]  Best score increase :0.860 -> 0.862
training process:  59%|█████▊    | 75/128 [1:21:59<55:59, 63.38s/it]EarlyStopping counter : 1 out of 12
training process:  59%|█████▉    | 76/128 [1:23:01<54:33, 62.94s/it]EarlyStopping counter : 2 out of 12
epoch : 77, train loss : 0.020, valid loss : 0.049, train acc : 0.975, valid acc : 0.962, train f1 : 0.909, valid f1 : 0.852
training process:  60%|██████    | 77/128 [1:24:15<56:17, 66.22s/it]EarlyStopping counter : 3 out of 12
training process:  61%|██████    | 78/128 [1:25:15<53:37, 64.36s/it]EarlyStopping counter : 4 out of 12
training process:  62%|██████▏   | 79/128 [1:26:20<52:44, 64.59s/it]EarlyStopping counter : 5 out of 12
training process:  62%|██████▎   | 80/128 [1:27:23<51:13, 64.02s/it]EarlyStopping counter : 6 out of 12
epoch : 81, train loss : 0.019, valid loss : 0.049, train acc : 0.976, valid acc : 0.963, train f1 : 0.912, valid f1 : 0.858
training process:  63%|██████▎   | 81/128 [1:28:49<55:20, 70.65s/it]EarlyStopping counter : 7 out of 12
training process:  64%|██████▍   | 82/128 [1:30:03<55:02, 71.79s/it]EarlyStopping counter : 8 out of 12
training process:  65%|██████▍   | 83/128 [1:31:14<53:40, 71.56s/it]EarlyStopping counter : 9 out of 12
training process:  66%|██████▌   | 84/128 [1:32:10<49:00, 66.84s/it]EarlyStopping counter : 10 out of 12
epoch : 85, train loss : 0.019, valid loss : 0.045, train acc : 0.976, valid acc : 0.963, train f1 : 0.912, valid f1 : 0.861
training process:  66%|██████▋   | 85/128 [1:33:17<47:59, 66.96s/it]EarlyStopping counter : 11 out of 12
training process:  66%|██████▋   | 85/128 [1:34:32<47:49, 66.73s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 85, best f1 score : 0.862
training process finished, best loss : 0.043 and best acc : 0.964, best f1 : 0.862, best epoch : 73

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.63      0.76       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.82      0.87      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.82, test loss : 2.761

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.04s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.91s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:13,  8.21s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:07,  8.40s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:58,  8.39s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:50,  8.34s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:58<00:41,  8.36s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:34,  8.54s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:16<00:26,  8.75s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:26<00:18,  9.10s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:34<00:08,  8.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.79s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.58s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 84.64it/s]  8%|▊         | 24/306 [00:00<00:02, 121.32it/s] 12%|█▏        | 37/306 [00:00<00:02, 118.34it/s] 16%|█▌        | 49/306 [00:00<00:02, 115.49it/s] 21%|██        | 64/306 [00:00<00:01, 126.16it/s] 25%|██▌       | 77/306 [00:00<00:02, 113.70it/s] 30%|███       | 93/306 [00:00<00:01, 125.24it/s] 35%|███▍      | 106/306 [00:00<00:01, 114.81it/s] 40%|████      | 123/306 [00:01<00:01, 127.74it/s] 45%|████▍     | 137/306 [00:01<00:01, 116.83it/s] 50%|█████     | 153/306 [00:01<00:01, 125.35it/s] 54%|█████▍    | 166/306 [00:01<00:01, 115.54it/s] 59%|█████▉    | 182/306 [00:01<00:00, 125.82it/s] 64%|██████▎   | 195/306 [00:01<00:00, 114.79it/s] 69%|██████▉   | 211/306 [00:01<00:00, 126.09it/s] 74%|███████▎  | 225/306 [00:01<00:00, 113.13it/s] 80%|████████  | 246/306 [00:02<00:00, 134.55it/s] 85%|████████▌ | 261/306 [00:02<00:00, 118.31it/s] 91%|█████████ | 278/306 [00:02<00:00, 130.46it/s] 95%|█████████▌| 292/306 [00:02<00:00, 119.45it/s]100%|██████████| 306/306 [00:02<00:00, 122.02it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 487.54it/s]extract the null data:  18%|█▊        | 99/553 [00:00<00:00, 493.77it/s]extract the null data:  27%|██▋       | 152/553 [00:00<00:00, 508.36it/s]extract the null data:  37%|███▋      | 207/553 [00:00<00:00, 523.35it/s]extract the null data:  48%|████▊     | 263/553 [00:00<00:00, 534.33it/s]extract the null data:  57%|█████▋    | 317/553 [00:00<00:00, 532.84it/s]extract the null data:  67%|██████▋   | 372/553 [00:00<00:00, 535.42it/s]extract the null data:  77%|███████▋  | 426/553 [00:00<00:00, 531.84it/s]extract the null data:  87%|████████▋ | 481/553 [00:00<00:00, 536.10it/s]extract the null data:  97%|█████████▋| 538/553 [00:01<00:00, 543.85it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 532.73it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 196.48it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 180.14it/s]replace nan value:  11%|█         | 61/553 [00:00<00:02, 190.28it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 200.74it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 205.76it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 205.81it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:01, 207.64it/s]replace nan value:  31%|███       | 170/553 [00:00<00:01, 209.08it/s]replace nan value:  35%|███▍      | 192/553 [00:00<00:01, 211.22it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 214.70it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 215.26it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 212.54it/s]replace nan value:  51%|█████     | 281/553 [00:01<00:01, 213.54it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 207.57it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 202.96it/s]replace nan value:  62%|██████▏   | 345/553 [00:01<00:01, 197.23it/s]replace nan value:  66%|██████▌   | 365/553 [00:01<00:00, 194.24it/s]replace nan value:  70%|██████▉   | 385/553 [00:01<00:00, 191.79it/s]replace nan value:  73%|███████▎  | 405/553 [00:02<00:00, 192.56it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 191.84it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 190.13it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 189.60it/s]replace nan value:  88%|████████▊ | 484/553 [00:02<00:00, 187.11it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 187.83it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 188.92it/s]replace nan value:  98%|█████████▊| 542/553 [00:02<00:00, 187.20it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 197.77it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 135.57it/s]  5%|▌         | 29/553 [00:00<00:03, 140.48it/s]  8%|▊         | 44/553 [00:00<00:03, 130.30it/s] 10%|█         | 58/553 [00:00<00:04, 120.42it/s] 13%|█▎        | 71/553 [00:00<00:04, 118.71it/s] 16%|█▌        | 87/553 [00:00<00:03, 130.47it/s] 18%|█▊        | 101/553 [00:00<00:03, 125.04it/s] 21%|██▏       | 118/553 [00:00<00:03, 137.66it/s] 24%|██▍       | 132/553 [00:01<00:03, 135.41it/s] 27%|██▋       | 150/553 [00:01<00:02, 145.43it/s] 30%|███       | 167/553 [00:01<00:02, 152.06it/s] 33%|███▎      | 183/553 [00:01<00:02, 150.39it/s] 36%|███▌      | 200/553 [00:01<00:02, 155.66it/s] 39%|███▉      | 216/553 [00:01<00:02, 155.76it/s] 42%|████▏     | 232/553 [00:01<00:02, 146.12it/s] 45%|████▍     | 248/553 [00:01<00:02, 148.47it/s] 48%|████▊     | 264/553 [00:01<00:01, 147.78it/s] 50%|█████     | 279/553 [00:01<00:01, 140.20it/s] 53%|█████▎    | 294/553 [00:02<00:01, 136.94it/s] 56%|█████▌    | 308/553 [00:02<00:01, 133.32it/s] 58%|█████▊    | 322/553 [00:02<00:01, 130.85it/s] 61%|██████    | 336/553 [00:02<00:01, 132.66it/s] 63%|██████▎   | 350/553 [00:02<00:01, 132.33it/s] 66%|██████▌   | 364/553 [00:02<00:01, 130.53it/s] 68%|██████▊   | 378/553 [00:02<00:01, 132.91it/s] 71%|███████   | 392/553 [00:02<00:01, 122.65it/s] 73%|███████▎  | 405/553 [00:02<00:01, 123.19it/s] 76%|███████▌  | 418/553 [00:03<00:01, 121.29it/s] 78%|███████▊  | 431/553 [00:03<00:01, 119.00it/s] 81%|████████  | 449/553 [00:03<00:00, 135.54it/s] 84%|████████▍ | 464/553 [00:03<00:00, 137.85it/s] 86%|████████▋ | 478/553 [00:03<00:00, 136.93it/s] 89%|████████▉ | 492/553 [00:03<00:00, 131.65it/s] 92%|█████████▏| 506/553 [00:03<00:00, 129.20it/s] 94%|█████████▍| 521/553 [00:03<00:00, 129.73it/s] 97%|█████████▋| 535/553 [00:04<00:00, 115.24it/s]100%|█████████▉| 551/553 [00:04<00:00, 108.15it/s]100%|██████████| 553/553 [00:04<00:00, 131.60it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 32/139 [00:00<00:00, 317.04it/s]extract the null data:  69%|██████▉   | 96/139 [00:00<00:00, 505.30it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 510.12it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 219.55it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 215.22it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 211.60it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 207.37it/s]replace nan value:  78%|███████▊  | 109/139 [00:00<00:00, 204.22it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 209.46it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 209.42it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.43it/s] 18%|█▊        | 25/139 [00:00<00:00, 123.60it/s] 29%|██▉       | 40/139 [00:00<00:00, 134.16it/s] 39%|███▉      | 54/139 [00:00<00:00, 127.48it/s] 50%|████▉     | 69/139 [00:00<00:00, 133.58it/s] 60%|█████▉    | 83/139 [00:00<00:00, 130.77it/s] 70%|██████▉   | 97/139 [00:00<00:00, 126.11it/s] 79%|███████▉  | 110/139 [00:00<00:00, 121.03it/s] 91%|█████████ | 126/139 [00:00<00:00, 128.11it/s]100%|██████████| 139/139 [00:01<00:00, 128.23it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 267.44it/s]extract the null data:  57%|█████▋    | 99/173 [00:00<00:00, 530.31it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 623.32it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 571.43it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 211.49it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 213.84it/s]replace nan value:  39%|███▊      | 67/173 [00:00<00:00, 219.06it/s]replace nan value:  51%|█████▏    | 89/173 [00:00<00:00, 218.66it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 221.59it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 227.15it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 227.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 221.65it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 136.26it/s] 17%|█▋        | 29/173 [00:00<00:01, 119.24it/s] 26%|██▌       | 45/173 [00:00<00:00, 133.95it/s] 35%|███▍      | 60/173 [00:00<00:00, 139.80it/s] 43%|████▎     | 75/173 [00:00<00:00, 134.65it/s] 52%|█████▏    | 90/173 [00:00<00:00, 137.70it/s] 60%|██████    | 104/173 [00:00<00:00, 133.98it/s] 69%|██████▉   | 119/173 [00:00<00:00, 136.15it/s] 77%|███████▋  | 133/173 [00:00<00:00, 130.96it/s] 85%|████████▍ | 147/173 [00:01<00:00, 131.73it/s] 93%|█████████▎| 161/173 [00:01<00:00, 116.18it/s]100%|██████████| 173/173 [00:01<00:00, 93.93it/s] 100%|██████████| 173/173 [00:01<00:00, 119.17it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.104, train acc : 0.714, valid acc : 0.810, train f1 : 0.714, valid f1 : 0.641
training process:   1%|          | 1/128 [01:20<2:50:50, 80.71s/it]Best score increase :0.000 -> 0.641
training process:   2%|▏         | 2/128 [02:18<2:21:12, 67.24s/it]Best score increase :0.641 -> 0.750
training process:   2%|▏         | 3/128 [03:10<2:05:21, 60.17s/it]Best score increase :0.750 -> 0.786
training process:   3%|▎         | 4/128 [04:08<2:03:07, 59.57s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.087, valid loss : 0.071, train acc : 0.847, valid acc : 0.906, train f1 : 0.847, valid f1 : 0.773
training process:   4%|▍         | 5/128 [05:27<2:15:50, 66.26s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [06:38<2:18:22, 68.06s/it]Best score increase :0.786 -> 0.807
training process:   5%|▌         | 7/128 [07:46<2:16:52, 67.87s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [08:50<2:13:35, 66.79s/it]Best score increase :0.807 -> 0.811
epoch : 9, train loss : 0.073, valid loss : 0.061, train acc : 0.876, valid acc : 0.925, train f1 : 0.876, valid f1 : 0.806
training process:   7%|▋         | 9/128 [10:05<2:17:33, 69.35s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [11:06<2:11:26, 66.84s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [11:56<2:00:17, 61.69s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [12:47<1:52:47, 58.34s/it]Best score increase :0.811 -> 0.816
epoch : 13, train loss : 0.066, valid loss : 0.056, train acc : 0.891, valid acc : 0.926, train f1 : 0.891, valid f1 : 0.809
training process:  10%|█         | 13/128 [13:48<1:53:07, 59.02s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [14:37<1:46:35, 56.10s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [15:29<1:43:05, 54.74s/it]Best score increase :0.816 -> 0.819
training process:  12%|█▎        | 16/128 [16:21<1:40:43, 53.96s/it]Best score increase :0.819 -> 0.838
epoch : 17, train loss : 0.057, valid loss : 0.061, train acc : 0.908, valid acc : 0.923, train f1 : 0.908, valid f1 : 0.806
training process:  13%|█▎        | 17/128 [17:20<1:43:05, 55.73s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [18:09<1:37:55, 53.42s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [18:59<1:35:27, 52.54s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [19:50<1:33:30, 51.95s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.055, valid loss : 0.057, train acc : 0.915, valid acc : 0.919, train f1 : 0.915, valid f1 : 0.801
training process:  16%|█▋        | 21/128 [20:46<1:35:11, 53.38s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [21:37<1:33:02, 52.66s/it]EarlyStopping counter : 6 out of 12
training process:  18%|█▊        | 23/128 [22:28<1:31:08, 52.08s/it]EarlyStopping counter : 7 out of 12
training process:  19%|█▉        | 24/128 [23:16<1:28:21, 50.97s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.050, valid loss : 0.053, train acc : 0.921, valid acc : 0.924, train f1 : 0.921, valid f1 : 0.808
training process:  20%|█▉        | 25/128 [24:13<1:30:34, 52.76s/it]EarlyStopping counter : 9 out of 12
training process:  20%|██        | 26/128 [25:00<1:26:49, 51.07s/it]Best score increase :0.838 -> 0.846
training process:  21%|██        | 27/128 [25:50<1:25:01, 50.51s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [26:38<1:23:05, 49.85s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.047, valid loss : 0.048, train acc : 0.928, valid acc : 0.938, train f1 : 0.928, valid f1 : 0.833
training process:  23%|██▎       | 29/128 [27:34<1:25:32, 51.84s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [28:23<1:23:13, 50.95s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [29:10<1:20:17, 49.67s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [29:55<1:17:23, 48.36s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.045, valid loss : 0.048, train acc : 0.932, valid acc : 0.939, train f1 : 0.932, valid f1 : 0.835
training process:  26%|██▌       | 33/128 [30:49<1:18:51, 49.80s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [31:34<1:15:46, 48.37s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [32:49<1:27:47, 56.64s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [34:33<1:48:37, 70.84s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.042, valid loss : 0.044, train acc : 0.935, valid acc : 0.945, train f1 : 0.935, valid f1 : 0.848
training process:  29%|██▉       | 37/128 [36:25<2:06:07, 83.16s/it]Best score increase :0.846 -> 0.848
training process:  30%|██▉       | 38/128 [37:35<1:58:48, 79.20s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [38:28<1:45:34, 71.17s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [39:19<1:35:39, 65.22s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.042, valid loss : 0.045, train acc : 0.936, valid acc : 0.941, train f1 : 0.936, valid f1 : 0.840
training process:  32%|███▏      | 41/128 [40:18<1:32:01, 63.47s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [41:10<1:26:00, 60.00s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [42:03<1:21:57, 57.85s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [42:57<1:19:12, 56.58s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.038, valid loss : 0.049, train acc : 0.944, valid acc : 0.937, train f1 : 0.944, valid f1 : 0.831
training process:  35%|███▌      | 45/128 [43:58<1:20:12, 57.98s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [44:49<1:16:33, 56.01s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [45:40<1:13:18, 54.30s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [46:32<1:11:25, 53.57s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.038, valid loss : 0.050, train acc : 0.944, valid acc : 0.935, train f1 : 0.944, valid f1 : 0.829
training process:  38%|███▊      | 48/128 [47:34<1:19:17, 59.47s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.848
training process finished, best loss : 0.044 and best acc : 0.945, best f1 : 0.848, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.64      0.84      0.72       580
           1       0.99      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.90      0.85      7398
weighted avg       0.96      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.90, test loss : 2.343

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:30,  8.20s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:23,  8.37s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:15,  8.42s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:06,  8.25s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:59,  8.45s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:48,  8.16s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:40,  8.19s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:33,  8.28s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:14<00:24,  8.29s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:22<00:16,  8.18s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:30<00:08,  8.19s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.05s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.21s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 185.08it/s] 13%|█▎        | 39/306 [00:00<00:01, 193.58it/s] 20%|█▉        | 60/306 [00:00<00:01, 196.94it/s] 26%|██▌       | 80/306 [00:00<00:01, 196.81it/s] 33%|███▎      | 100/306 [00:00<00:01, 196.06it/s] 39%|███▉      | 120/306 [00:00<00:00, 195.80it/s] 46%|████▌     | 141/306 [00:00<00:00, 199.47it/s] 53%|█████▎    | 162/306 [00:00<00:00, 202.30it/s] 60%|█████▉    | 183/306 [00:00<00:00, 201.92it/s] 67%|██████▋   | 204/306 [00:01<00:00, 204.13it/s] 74%|███████▎  | 225/306 [00:01<00:00, 197.38it/s] 80%|████████  | 246/306 [00:01<00:00, 199.74it/s] 87%|████████▋ | 267/306 [00:01<00:00, 201.08it/s] 94%|█████████▍| 288/306 [00:01<00:00, 202.59it/s]100%|██████████| 306/306 [00:01<00:00, 199.46it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 57/553 [00:00<00:00, 564.48it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 574.01it/s]extract the null data:  32%|███▏      | 175/553 [00:00<00:00, 581.22it/s]extract the null data:  42%|████▏     | 235/553 [00:00<00:00, 584.78it/s]extract the null data:  53%|█████▎    | 295/553 [00:00<00:00, 589.23it/s]extract the null data:  65%|██████▍   | 358/553 [00:00<00:00, 602.85it/s]extract the null data:  77%|███████▋  | 426/553 [00:00<00:00, 625.91it/s]extract the null data:  88%|████████▊ | 489/553 [00:00<00:00, 625.47it/s]extract the null data: 100%|█████████▉| 552/553 [00:00<00:00, 622.30it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 606.93it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 197.72it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 203.00it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:02, 209.00it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 210.62it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 210.39it/s]replace nan value:  23%|██▎       | 129/553 [00:00<00:02, 207.42it/s]replace nan value:  27%|██▋       | 151/553 [00:00<00:01, 208.99it/s]replace nan value:  31%|███▏      | 173/553 [00:00<00:01, 211.53it/s]replace nan value:  35%|███▌      | 195/553 [00:00<00:01, 213.30it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 214.25it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 212.63it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 211.82it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 211.02it/s]replace nan value:  55%|█████▌    | 305/553 [00:01<00:01, 211.31it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:01, 212.53it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:00, 210.35it/s]replace nan value:  67%|██████▋   | 371/553 [00:01<00:00, 210.30it/s]replace nan value:  71%|███████   | 393/553 [00:01<00:00, 207.89it/s]replace nan value:  75%|███████▌  | 415/553 [00:01<00:00, 208.86it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 210.82it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 214.45it/s]replace nan value:  88%|████████▊ | 485/553 [00:02<00:00, 222.23it/s]replace nan value:  92%|█████████▏| 508/553 [00:02<00:00, 223.00it/s]replace nan value:  96%|█████████▌| 531/553 [00:02<00:00, 224.82it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 214.28it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 122.14it/s]  5%|▍         | 26/553 [00:00<00:04, 124.94it/s]  7%|▋         | 39/553 [00:00<00:04, 125.52it/s]  9%|▉         | 52/553 [00:00<00:04, 110.31it/s] 12%|█▏        | 64/553 [00:00<00:04, 101.67it/s] 14%|█▍        | 77/553 [00:00<00:04, 106.27it/s] 16%|█▋        | 90/553 [00:00<00:04, 112.98it/s] 18%|█▊        | 102/553 [00:00<00:04, 109.07it/s] 21%|██        | 117/553 [00:01<00:03, 120.54it/s] 24%|██▎       | 130/553 [00:01<00:03, 116.65it/s] 26%|██▋       | 146/553 [00:01<00:03, 128.16it/s] 29%|██▉       | 161/553 [00:01<00:02, 133.53it/s] 32%|███▏      | 175/553 [00:01<00:02, 133.31it/s] 34%|███▍      | 189/553 [00:01<00:02, 131.57it/s] 37%|███▋      | 204/553 [00:01<00:02, 136.77it/s] 39%|███▉      | 218/553 [00:01<00:02, 133.33it/s] 42%|████▏     | 232/553 [00:01<00:02, 131.67it/s] 45%|████▍     | 247/553 [00:01<00:02, 135.62it/s] 47%|████▋     | 262/553 [00:02<00:02, 139.24it/s] 50%|████▉     | 276/553 [00:02<00:02, 131.57it/s] 53%|█████▎    | 291/553 [00:02<00:01, 136.35it/s] 55%|█████▌    | 305/553 [00:02<00:01, 132.10it/s] 58%|█████▊    | 319/553 [00:02<00:01, 122.66it/s] 60%|██████    | 333/553 [00:02<00:01, 124.92it/s] 63%|██████▎   | 347/553 [00:02<00:01, 127.71it/s] 65%|██████▌   | 360/553 [00:02<00:01, 121.03it/s] 68%|██████▊   | 376/553 [00:02<00:01, 130.21it/s] 71%|███████   | 390/553 [00:03<00:01, 120.88it/s] 73%|███████▎  | 403/553 [00:03<00:01, 122.10it/s] 75%|███████▌  | 416/553 [00:03<00:01, 121.99it/s] 78%|███████▊  | 429/553 [00:03<00:01, 117.43it/s] 81%|████████  | 447/553 [00:03<00:00, 133.05it/s] 84%|████████▎ | 462/553 [00:03<00:00, 135.77it/s] 86%|████████▋ | 477/553 [00:03<00:00, 137.46it/s] 89%|████████▉ | 491/553 [00:03<00:00, 127.76it/s] 91%|█████████ | 504/553 [00:04<00:00, 125.67it/s] 94%|█████████▍| 519/553 [00:04<00:00, 130.88it/s] 96%|█████████▋| 533/553 [00:04<00:00, 112.59it/s] 99%|█████████▉| 549/553 [00:04<00:00, 123.18it/s]100%|██████████| 553/553 [00:04<00:00, 123.31it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 289.02it/s]extract the null data:  64%|██████▍   | 89/139 [00:00<00:00, 470.96it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 485.66it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 197.75it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 194.79it/s]replace nan value:  44%|████▍     | 61/139 [00:00<00:00, 198.25it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 208.06it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 203.66it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 199.93it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 200.44it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 126.06it/s] 19%|█▉        | 27/139 [00:00<00:00, 132.90it/s] 32%|███▏      | 44/139 [00:00<00:00, 146.42it/s] 42%|████▏     | 59/139 [00:00<00:00, 134.87it/s] 53%|█████▎    | 74/139 [00:00<00:00, 138.68it/s] 63%|██████▎   | 88/139 [00:00<00:00, 121.96it/s] 75%|███████▍  | 104/139 [00:00<00:00, 131.33it/s] 86%|████████▌ | 119/139 [00:00<00:00, 135.72it/s] 96%|█████████▌| 133/139 [00:00<00:00, 132.64it/s]100%|██████████| 139/139 [00:01<00:00, 135.06it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 287.08it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 459.47it/s]extract the null data:  82%|████████▏ | 142/173 [00:00<00:00, 495.41it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 462.06it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 186.64it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 183.67it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 185.96it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 189.13it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 193.91it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 195.34it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 196.58it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 199.38it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 194.08it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 134.10it/s] 16%|█▌        | 28/173 [00:00<00:01, 118.42it/s] 24%|██▍       | 42/173 [00:00<00:01, 126.61it/s] 33%|███▎      | 57/173 [00:00<00:00, 134.70it/s] 41%|████      | 71/173 [00:00<00:00, 134.21it/s] 49%|████▉     | 85/173 [00:00<00:00, 131.50it/s] 57%|█████▋    | 99/173 [00:00<00:00, 132.50it/s] 66%|██████▌   | 114/173 [00:00<00:00, 137.55it/s] 74%|███████▍  | 128/173 [00:00<00:00, 129.16it/s] 82%|████████▏ | 142/173 [00:01<00:00, 130.11it/s] 90%|█████████ | 156/173 [00:01<00:00, 116.52it/s] 97%|█████████▋| 168/173 [00:01<00:00, 95.89it/s] 100%|██████████| 173/173 [00:01<00:00, 115.15it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.022, valid loss : 0.020, train acc : 0.653, valid acc : 0.725, train f1 : 0.514, valid f1 : 0.573
training process:   1%|          | 1/128 [01:01<2:10:50, 61.81s/it]Best score increase :0.000 -> 0.573
training process:   2%|▏         | 2/128 [01:52<1:56:36, 55.53s/it]Best score increase :0.573 -> 0.672
training process:   2%|▏         | 3/128 [02:48<1:55:24, 55.39s/it]Best score increase :0.672 -> 0.748
training process:   3%|▎         | 4/128 [03:54<2:03:05, 59.56s/it]Best score increase :0.748 -> 0.804
epoch : 5, train loss : 0.015, valid loss : 0.016, train acc : 0.867, valid acc : 0.929, train f1 : 0.703, valid f1 : 0.791
training process:   4%|▍         | 5/128 [05:11<2:15:14, 65.97s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [06:20<2:15:55, 66.85s/it]Best score increase :0.804 -> 0.812
training process:   5%|▌         | 7/128 [07:28<2:16:01, 67.45s/it]Best score increase :0.812 -> 0.814
training process:   6%|▋         | 8/128 [08:36<2:14:52, 67.44s/it]Best score increase :0.814 -> 0.818
epoch : 9, train loss : 0.013, valid loss : 0.016, train acc : 0.902, valid acc : 0.948, train f1 : 0.756, valid f1 : 0.833
training process:   7%|▋         | 9/128 [09:55<2:21:28, 71.33s/it]Best score increase :0.818 -> 0.833
training process:   8%|▊         | 10/128 [11:08<2:21:00, 71.70s/it]Best score increase :0.833 -> 0.834
training process:   9%|▊         | 11/128 [12:20<2:20:10, 71.88s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [13:34<2:20:03, 72.45s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.012, valid loss : 0.017, train acc : 0.914, valid acc : 0.947, train f1 : 0.777, valid f1 : 0.830
training process:  10%|█         | 13/128 [14:42<2:16:25, 71.18s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [15:42<2:08:40, 67.73s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [16:40<2:02:11, 64.88s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▎        | 16/128 [17:41<1:58:43, 63.60s/it]Best score increase :0.834 -> 0.844
epoch : 17, train loss : 0.011, valid loss : 0.016, train acc : 0.927, valid acc : 0.944, train f1 : 0.799, valid f1 : 0.824
training process:  13%|█▎        | 17/128 [18:48<1:59:35, 64.64s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [19:46<1:54:42, 62.57s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [20:46<1:52:10, 61.75s/it]Best score increase :0.844 -> 0.857
training process:  16%|█▌        | 20/128 [21:45<1:49:45, 60.98s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.011, valid loss : 0.017, train acc : 0.933, valid acc : 0.950, train f1 : 0.813, valid f1 : 0.839
training process:  16%|█▋        | 21/128 [22:51<1:51:39, 62.61s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [23:50<1:48:38, 61.49s/it]EarlyStopping counter : 3 out of 12
training process:  18%|█▊        | 23/128 [24:46<1:44:50, 59.91s/it]EarlyStopping counter : 4 out of 12
training process:  19%|█▉        | 24/128 [25:43<1:42:14, 58.98s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.010, valid loss : 0.016, train acc : 0.936, valid acc : 0.956, train f1 : 0.818, valid f1 : 0.858
training process:  20%|█▉        | 25/128 [26:52<1:46:30, 62.05s/it]Best score increase :0.857 -> 0.858
training process:  20%|██        | 26/128 [27:48<1:42:10, 60.10s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [28:43<1:38:47, 58.69s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [29:39<1:36:23, 57.84s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.010, valid loss : 0.015, train acc : 0.943, valid acc : 0.954, train f1 : 0.834, valid f1 : 0.852
training process:  23%|██▎       | 29/128 [30:41<1:37:30, 59.09s/it]EarlyStopping counter : 4 out of 12
training process:  23%|██▎       | 30/128 [32:25<1:58:35, 72.61s/it]EarlyStopping counter : 5 out of 12
training process:  24%|██▍       | 31/128 [33:27<1:52:18, 69.47s/it]Best score increase :0.858 -> 0.862
training process:  25%|██▌       | 32/128 [34:37<1:51:11, 69.49s/it]Best score increase :0.862 -> 0.864
epoch : 33, train loss : 0.009, valid loss : 0.017, train acc : 0.944, valid acc : 0.953, train f1 : 0.838, valid f1 : 0.849
training process:  26%|██▌       | 33/128 [35:53<1:52:53, 71.30s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [36:55<1:47:37, 68.69s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [38:00<1:44:43, 67.57s/it]EarlyStopping counter : 3 out of 12
training process:  28%|██▊       | 36/128 [39:06<1:42:37, 66.93s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.009, valid loss : 0.018, train acc : 0.948, valid acc : 0.957, train f1 : 0.846, valid f1 : 0.859
training process:  29%|██▉       | 37/128 [40:21<1:45:17, 69.42s/it]EarlyStopping counter : 5 out of 12
training process:  30%|██▉       | 38/128 [41:26<1:42:19, 68.22s/it]EarlyStopping counter : 6 out of 12
training process:  30%|███       | 39/128 [42:27<1:37:41, 65.87s/it]EarlyStopping counter : 7 out of 12
training process:  31%|███▏      | 40/128 [43:20<1:31:00, 62.06s/it]EarlyStopping counter : 8 out of 12
epoch : 41, train loss : 0.009, valid loss : 0.018, train acc : 0.951, valid acc : 0.959, train f1 : 0.855, valid f1 : 0.865
training process:  32%|███▏      | 41/128 [44:21<1:29:50, 61.96s/it]Best score increase :0.864 -> 0.865
training process:  33%|███▎      | 42/128 [45:16<1:25:25, 59.60s/it]Best score increase :0.865 -> 0.870
training process:  34%|███▎      | 43/128 [46:09<1:21:51, 57.78s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [47:03<1:19:19, 56.66s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.016, train acc : 0.950, valid acc : 0.960, train f1 : 0.852, valid f1 : 0.870
training process:  35%|███▌      | 45/128 [48:06<1:20:53, 58.48s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [49:01<1:18:33, 57.49s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [49:56<1:16:37, 56.76s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [50:52<1:15:23, 56.55s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.009, valid loss : 0.017, train acc : 0.955, valid acc : 0.957, train f1 : 0.865, valid f1 : 0.864
training process:  38%|███▊      | 49/128 [51:55<1:17:08, 58.59s/it]EarlyStopping counter : 7 out of 12
training process:  39%|███▉      | 50/128 [52:51<1:15:05, 57.76s/it]EarlyStopping counter : 8 out of 12
training process:  40%|███▉      | 51/128 [53:46<1:12:57, 56.85s/it]EarlyStopping counter : 9 out of 12
training process:  41%|████      | 52/128 [54:43<1:11:56, 56.79s/it]EarlyStopping counter : 10 out of 12
epoch : 53, train loss : 0.008, valid loss : 0.021, train acc : 0.955, valid acc : 0.961, train f1 : 0.865, valid f1 : 0.867
training process:  41%|████▏     | 53/128 [55:47<1:13:55, 59.14s/it]EarlyStopping counter : 11 out of 12
training process:  41%|████▏     | 53/128 [56:43<1:20:15, 64.21s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 53, best f1 score : 0.870
training process finished, best loss : 0.019 and best acc : 0.961, best f1 : 0.870, best epoch : 46

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.80      0.76      0.78       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.89      0.87      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.87, test loss : 0.984

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:34,  8.63s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:24,  8.47s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:15,  8.35s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:05,  8.16s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:56,  8.12s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:48,  8.05s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:40,  8.07s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:05<00:32,  8.05s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:13<00:24,  8.12s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:16,  8.10s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:29<00:08,  8.02s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  7.92s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.08s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:02, 136.10it/s]  9%|▉         | 29/306 [00:00<00:02, 111.34it/s] 14%|█▍        | 43/306 [00:00<00:02, 121.93it/s] 18%|█▊        | 56/306 [00:00<00:02, 118.20it/s] 22%|██▏       | 68/306 [00:00<00:02, 103.63it/s] 27%|██▋       | 82/306 [00:00<00:01, 112.15it/s] 31%|███       | 94/306 [00:00<00:01, 109.90it/s] 35%|███▍      | 107/306 [00:00<00:01, 115.42it/s] 39%|███▉      | 119/306 [00:01<00:01, 116.19it/s] 43%|████▎     | 131/306 [00:01<00:01, 103.20it/s] 48%|████▊     | 146/306 [00:01<00:01, 112.90it/s] 52%|█████▏    | 158/306 [00:01<00:01, 113.01it/s] 56%|█████▌    | 170/306 [00:01<00:01, 110.45it/s] 60%|██████    | 184/306 [00:01<00:01, 116.58it/s] 64%|██████▍   | 196/306 [00:01<00:00, 112.55it/s] 69%|██████▊   | 210/306 [00:01<00:00, 119.45it/s] 73%|███████▎  | 223/306 [00:01<00:00, 119.81it/s] 77%|███████▋  | 236/306 [00:02<00:00, 105.56it/s] 82%|████████▏ | 251/306 [00:02<00:00, 114.57it/s] 86%|████████▌ | 263/306 [00:02<00:00, 112.16it/s] 90%|█████████ | 276/306 [00:02<00:00, 116.16it/s] 94%|█████████▍| 288/306 [00:02<00:00, 116.01it/s] 98%|█████████▊| 300/306 [00:02<00:00, 102.35it/s]100%|██████████| 306/306 [00:02<00:00, 112.81it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 573.55it/s]extract the null data:  21%|██▏       | 118/553 [00:00<00:00, 586.63it/s]extract the null data:  32%|███▏      | 178/553 [00:00<00:00, 592.01it/s]extract the null data:  43%|████▎     | 239/553 [00:00<00:00, 596.41it/s]extract the null data:  54%|█████▍    | 301/553 [00:00<00:00, 602.93it/s]extract the null data:  65%|██████▌   | 362/553 [00:00<00:00, 592.11it/s]extract the null data:  76%|███████▋  | 422/553 [00:00<00:00, 583.60it/s]extract the null data:  87%|████████▋ | 481/553 [00:00<00:00, 585.46it/s]extract the null data:  98%|█████████▊| 543/553 [00:00<00:00, 594.52it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 591.67it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 198.71it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 200.58it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:02, 201.94it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 199.31it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 202.55it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 210.89it/s]replace nan value:  27%|██▋       | 150/553 [00:00<00:01, 213.12it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:01, 218.78it/s]replace nan value:  35%|███▌      | 196/553 [00:00<00:01, 213.79it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 210.63it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 207.74it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 203.95it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 203.08it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 203.40it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 199.32it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:01, 197.15it/s]replace nan value:  66%|██████▌   | 364/553 [00:01<00:00, 197.54it/s]replace nan value:  70%|██████▉   | 385/553 [00:01<00:00, 198.41it/s]replace nan value:  73%|███████▎  | 405/553 [00:01<00:00, 197.89it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 196.78it/s]replace nan value:  81%|████████  | 446/553 [00:02<00:00, 197.99it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 199.24it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 199.58it/s]replace nan value:  92%|█████████▏| 508/553 [00:02<00:00, 198.39it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 197.23it/s]replace nan value:  99%|█████████▉| 548/553 [00:02<00:00, 197.62it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 201.98it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.09it/s]  5%|▌         | 29/553 [00:00<00:03, 138.73it/s]  8%|▊         | 43/553 [00:00<00:03, 133.47it/s] 10%|█         | 57/553 [00:00<00:03, 124.80it/s] 13%|█▎        | 70/553 [00:00<00:04, 118.65it/s] 16%|█▌        | 87/553 [00:00<00:03, 132.98it/s] 18%|█▊        | 101/553 [00:00<00:03, 127.46it/s] 22%|██▏       | 120/553 [00:00<00:03, 142.63it/s] 24%|██▍       | 135/553 [00:00<00:02, 142.10it/s] 28%|██▊       | 153/553 [00:01<00:02, 152.84it/s] 31%|███       | 171/553 [00:01<00:02, 160.01it/s] 34%|███▍      | 188/553 [00:01<00:02, 155.02it/s] 37%|███▋      | 207/553 [00:01<00:02, 163.91it/s] 41%|████      | 224/553 [00:01<00:02, 154.45it/s] 44%|████▎     | 241/553 [00:01<00:02, 155.77it/s] 46%|████▋     | 257/553 [00:01<00:01, 149.56it/s] 49%|████▉     | 273/553 [00:01<00:01, 145.64it/s] 52%|█████▏    | 289/553 [00:01<00:01, 149.31it/s] 55%|█████▌    | 305/553 [00:02<00:01, 141.80it/s] 58%|█████▊    | 320/553 [00:02<00:01, 132.06it/s] 61%|██████    | 335/553 [00:02<00:01, 135.26it/s] 63%|██████▎   | 349/553 [00:02<00:01, 132.74it/s] 66%|██████▌   | 363/553 [00:02<00:01, 131.21it/s] 68%|██████▊   | 378/553 [00:02<00:01, 135.52it/s] 71%|███████   | 392/553 [00:02<00:01, 126.13it/s] 73%|███████▎  | 405/553 [00:02<00:01, 126.90it/s] 76%|███████▌  | 418/553 [00:03<00:01, 124.54it/s] 78%|███████▊  | 431/553 [00:03<00:01, 121.38it/s] 81%|████████▏ | 450/553 [00:03<00:00, 140.06it/s] 84%|████████▍ | 465/553 [00:03<00:00, 142.03it/s] 87%|████████▋ | 480/553 [00:03<00:00, 137.90it/s] 89%|████████▉ | 494/553 [00:03<00:00, 133.03it/s] 92%|█████████▏| 509/553 [00:03<00:00, 137.50it/s] 95%|█████████▍| 523/553 [00:03<00:00, 128.63it/s] 97%|█████████▋| 537/553 [00:03<00:00, 119.80it/s]100%|█████████▉| 551/553 [00:04<00:00, 109.40it/s]100%|██████████| 553/553 [00:04<00:00, 135.02it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 38/139 [00:00<00:00, 378.49it/s]extract the null data:  76%|███████▋  | 106/139 [00:00<00:00, 552.87it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 554.78it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 223.53it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 219.71it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 219.27it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 218.95it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 218.94it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 227.84it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 223.65it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 129.18it/s] 20%|██        | 28/139 [00:00<00:00, 134.11it/s] 32%|███▏      | 44/139 [00:00<00:00, 141.10it/s] 42%|████▏     | 59/139 [00:00<00:00, 128.60it/s] 53%|█████▎    | 74/139 [00:00<00:00, 131.76it/s] 63%|██████▎   | 88/139 [00:00<00:00, 113.77it/s] 73%|███████▎  | 102/139 [00:00<00:00, 120.17it/s] 83%|████████▎ | 115/139 [00:00<00:00, 121.54it/s] 93%|█████████▎| 129/139 [00:01<00:00, 125.06it/s]100%|██████████| 139/139 [00:01<00:00, 126.45it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 38/173 [00:00<00:00, 379.63it/s]extract the null data:  59%|█████▉    | 102/173 [00:00<00:00, 530.30it/s]extract the null data:  97%|█████████▋| 168/173 [00:00<00:00, 586.13it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 557.73it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 23/173 [00:00<00:00, 227.78it/s]replace nan value:  27%|██▋       | 46/173 [00:00<00:00, 219.29it/s]replace nan value:  40%|███▉      | 69/173 [00:00<00:00, 221.99it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 221.19it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 220.71it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 220.30it/s]replace nan value:  93%|█████████▎| 161/173 [00:00<00:00, 220.08it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 220.29it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 138.48it/s] 16%|█▌        | 28/173 [00:00<00:01, 121.12it/s] 25%|██▍       | 43/173 [00:00<00:00, 131.63it/s] 34%|███▎      | 58/173 [00:00<00:00, 138.09it/s] 42%|████▏     | 72/173 [00:00<00:00, 137.46it/s] 50%|████▉     | 86/173 [00:00<00:00, 135.82it/s] 58%|█████▊    | 100/173 [00:00<00:00, 136.35it/s] 66%|██████▋   | 115/173 [00:00<00:00, 140.38it/s] 75%|███████▌  | 130/173 [00:00<00:00, 131.77it/s] 83%|████████▎ | 144/173 [00:01<00:00, 128.58it/s] 91%|█████████ | 157/173 [00:01<00:00, 118.11it/s] 98%|█████████▊| 169/173 [00:01<00:00, 97.35it/s] 100%|██████████| 173/173 [00:01<00:00, 117.13it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.054, valid loss : 0.026, train acc : 0.678, valid acc : 0.425, train f1 : 0.667, valid f1 : 0.381
training process:   1%|          | 1/128 [01:47<3:47:03, 107.27s/it]Best score increase :0.000 -> 0.381
training process:   2%|▏         | 2/128 [02:37<2:34:34, 73.61s/it] EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [03:23<2:07:34, 61.24s/it]Best score increase :0.381 -> 0.392
training process:   3%|▎         | 4/128 [04:10<1:54:50, 55.56s/it]Best score increase :0.392 -> 0.441
epoch : 5, train loss : 0.021, valid loss : 0.027, train acc : 0.724, valid acc : 0.506, train f1 : 0.701, valid f1 : 0.440
training process:   4%|▍         | 5/128 [05:47<2:24:26, 70.46s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▍         | 6/128 [07:17<2:36:30, 76.97s/it]Best score increase :0.441 -> 0.490
training process:   5%|▌         | 7/128 [08:52<2:47:25, 83.02s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:57<2:34:16, 77.14s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.018, valid loss : 0.022, train acc : 0.778, valid acc : 0.596, train f1 : 0.768, valid f1 : 0.502
training process:   7%|▋         | 9/128 [10:51<2:18:35, 69.88s/it]Best score increase :0.490 -> 0.502
training process:   8%|▊         | 10/128 [11:38<2:03:35, 62.84s/it]Best score increase :0.502 -> 0.504
training process:   9%|▊         | 11/128 [13:04<2:16:36, 70.06s/it]Best score increase :0.504 -> 0.518
training process:   9%|▉         | 12/128 [14:46<2:34:03, 79.69s/it]Best score increase :0.518 -> 0.537
epoch : 13, train loss : 0.016, valid loss : 0.021, train acc : 0.806, valid acc : 0.636, train f1 : 0.800, valid f1 : 0.530
training process:  10%|█         | 13/128 [16:37<2:50:44, 89.08s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [17:40<2:34:25, 81.28s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [18:32<2:16:41, 72.58s/it]Best score increase :0.537 -> 0.558
training process:  12%|█▎        | 16/128 [19:24<2:04:02, 66.45s/it]Best score increase :0.558 -> 0.611
epoch : 17, train loss : 0.014, valid loss : 0.022, train acc : 0.837, valid acc : 0.670, train f1 : 0.833, valid f1 : 0.555
training process:  13%|█▎        | 17/128 [21:16<2:28:18, 80.17s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [22:56<2:37:45, 86.05s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [24:38<2:44:59, 90.82s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [25:32<2:23:25, 79.68s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.013, valid loss : 0.019, train acc : 0.852, valid acc : 0.716, train f1 : 0.849, valid f1 : 0.589
training process:  16%|█▋        | 21/128 [26:37<2:14:17, 75.30s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [27:46<2:09:48, 73.48s/it]EarlyStopping counter : 6 out of 12
training process:  18%|█▊        | 23/128 [29:28<2:23:31, 82.01s/it]Best score increase :0.611 -> 0.616
training process:  19%|█▉        | 24/128 [31:09<2:31:51, 87.61s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.012, valid loss : 0.018, train acc : 0.862, valid acc : 0.737, train f1 : 0.860, valid f1 : 0.606
training process:  20%|█▉        | 25/128 [32:50<2:37:15, 91.61s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [33:38<2:13:52, 78.75s/it]Best score increase :0.616 -> 0.657
training process:  21%|██        | 27/128 [34:31<1:59:12, 70.82s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [35:49<2:01:47, 73.07s/it]Best score increase :0.657 -> 0.665
epoch : 29, train loss : 0.011, valid loss : 0.017, train acc : 0.873, valid acc : 0.782, train f1 : 0.871, valid f1 : 0.644
training process:  23%|██▎       | 29/128 [37:39<2:18:55, 84.19s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [39:21<2:25:56, 89.36s/it]Best score increase :0.665 -> 0.678
training process:  24%|██▍       | 31/128 [40:40<2:19:28, 86.27s/it]EarlyStopping counter : 1 out of 12
training process:  25%|██▌       | 32/128 [41:32<2:01:48, 76.13s/it]EarlyStopping counter : 2 out of 12
epoch : 33, train loss : 0.011, valid loss : 0.016, train acc : 0.887, valid acc : 0.825, train f1 : 0.886, valid f1 : 0.685
training process:  26%|██▌       | 33/128 [42:35<1:54:03, 72.03s/it]Best score increase :0.678 -> 0.685
training process:  27%|██▋       | 34/128 [44:09<2:03:17, 78.69s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [45:51<2:12:53, 85.74s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [47:31<2:17:49, 89.88s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.010, valid loss : 0.015, train acc : 0.894, valid acc : 0.828, train f1 : 0.893, valid f1 : 0.689
training process:  29%|██▉       | 37/128 [48:48<2:10:24, 85.99s/it]Best score increase :0.685 -> 0.689
training process:  30%|██▉       | 38/128 [49:41<1:54:07, 76.09s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [50:35<1:43:25, 69.72s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [52:16<1:55:47, 78.94s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.015, train acc : 0.898, valid acc : 0.841, train f1 : 0.897, valid f1 : 0.702
training process:  32%|███▏      | 41/128 [54:04<2:07:18, 87.79s/it]Best score increase :0.689 -> 0.702
training process:  33%|███▎      | 42/128 [55:44<2:10:54, 91.34s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [56:36<1:52:55, 79.71s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [57:30<1:40:27, 71.76s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.016, train acc : 0.904, valid acc : 0.831, train f1 : 0.904, valid f1 : 0.692
training process:  35%|███▌      | 45/128 [58:38<1:37:57, 70.81s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [1:00:21<1:49:58, 80.47s/it]Best score increase :0.702 -> 0.714
training process:  37%|███▋      | 47/128 [1:02:01<1:56:38, 86.40s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [1:03:39<1:59:37, 89.71s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.009, valid loss : 0.016, train acc : 0.906, valid acc : 0.822, train f1 : 0.905, valid f1 : 0.682
training process:  38%|███▊      | 49/128 [1:04:39<1:46:17, 80.73s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [1:05:31<1:34:01, 72.32s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [1:06:45<1:33:28, 72.84s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [1:08:24<1:41:54, 80.46s/it]Best score increase :0.714 -> 0.716
epoch : 53, train loss : 0.008, valid loss : 0.016, train acc : 0.918, valid acc : 0.842, train f1 : 0.918, valid f1 : 0.704
training process:  41%|████▏     | 53/128 [1:10:12<1:50:57, 88.77s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [1:11:32<1:46:22, 86.25s/it]Best score increase :0.716 -> 0.721
training process:  43%|████▎     | 55/128 [1:12:24<1:32:30, 76.03s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [1:13:20<1:23:59, 69.99s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.008, valid loss : 0.017, train acc : 0.917, valid acc : 0.834, train f1 : 0.916, valid f1 : 0.695
training process:  45%|████▍     | 57/128 [1:14:52<1:30:35, 76.55s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [1:16:27<1:35:41, 82.03s/it]Best score increase :0.721 -> 0.740
training process:  46%|████▌     | 59/128 [1:18:02<1:38:51, 85.97s/it]Best score increase :0.740 -> 0.742
training process:  47%|████▋     | 60/128 [1:19:20<1:34:37, 83.49s/it]EarlyStopping counter : 1 out of 12
epoch : 61, train loss : 0.008, valid loss : 0.015, train acc : 0.917, valid acc : 0.863, train f1 : 0.917, valid f1 : 0.729
training process:  48%|████▊     | 61/128 [1:20:22<1:26:00, 77.02s/it]EarlyStopping counter : 2 out of 12
training process:  48%|████▊     | 62/128 [1:21:16<1:17:16, 70.25s/it]EarlyStopping counter : 3 out of 12
training process:  49%|████▉     | 63/128 [1:22:51<1:24:01, 77.56s/it]EarlyStopping counter : 4 out of 12
training process:  50%|█████     | 64/128 [1:24:23<1:27:27, 82.00s/it]Best score increase :0.742 -> 0.752
epoch : 65, train loss : 0.008, valid loss : 0.015, train acc : 0.923, valid acc : 0.866, train f1 : 0.923, valid f1 : 0.730
training process:  51%|█████     | 65/128 [1:26:04<1:32:04, 87.69s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:27:11<1:24:00, 81.29s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:28:04<1:14:14, 73.02s/it]EarlyStopping counter : 3 out of 12
training process:  53%|█████▎    | 68/128 [1:28:56<1:06:29, 66.49s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.007, valid loss : 0.015, train acc : 0.927, valid acc : 0.874, train f1 : 0.927, valid f1 : 0.741
training process:  54%|█████▍    | 69/128 [1:30:43<1:17:30, 78.82s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▍    | 70/128 [1:32:22<1:22:01, 84.85s/it]EarlyStopping counter : 6 out of 12
training process:  55%|█████▌    | 71/128 [1:33:59<1:24:00, 88.42s/it]EarlyStopping counter : 7 out of 12
training process:  56%|█████▋    | 72/128 [1:34:54<1:13:05, 78.31s/it]EarlyStopping counter : 8 out of 12
epoch : 73, train loss : 0.008, valid loss : 0.015, train acc : 0.925, valid acc : 0.884, train f1 : 0.925, valid f1 : 0.754
training process:  57%|█████▋    | 73/128 [1:35:54<1:06:57, 73.05s/it]Best score increase :0.752 -> 0.754
training process:  58%|█████▊    | 74/128 [1:37:03<1:04:39, 71.84s/it]EarlyStopping counter : 1 out of 12
training process:  59%|█████▊    | 75/128 [1:38:44<1:11:05, 80.48s/it]EarlyStopping counter : 2 out of 12
training process:  59%|█████▉    | 76/128 [1:40:29<1:16:02, 87.74s/it]EarlyStopping counter : 3 out of 12
epoch : 77, train loss : 0.007, valid loss : 0.016, train acc : 0.930, valid acc : 0.880, train f1 : 0.930, valid f1 : 0.750
training process:  60%|██████    | 77/128 [1:42:09<1:17:41, 91.40s/it]EarlyStopping counter : 4 out of 12
training process:  61%|██████    | 78/128 [1:43:07<1:08:02, 81.65s/it]EarlyStopping counter : 5 out of 12
training process:  62%|██████▏   | 79/128 [1:44:06<1:00:54, 74.59s/it]EarlyStopping counter : 6 out of 12
training process:  62%|██████▎   | 80/128 [1:45:49<1:06:31, 83.15s/it]Best score increase :0.754 -> 0.759
epoch : 81, train loss : 0.007, valid loss : 0.016, train acc : 0.934, valid acc : 0.869, train f1 : 0.933, valid f1 : 0.736
training process:  63%|██████▎   | 81/128 [1:47:38<1:11:23, 91.14s/it]EarlyStopping counter : 1 out of 12
training process:  64%|██████▍   | 82/128 [1:49:18<1:11:47, 93.65s/it]EarlyStopping counter : 2 out of 12
training process:  65%|██████▍   | 83/128 [1:50:08<1:00:23, 80.53s/it]EarlyStopping counter : 3 out of 12
training process:  66%|██████▌   | 84/128 [1:50:58<52:17, 71.31s/it]  Best score increase :0.759 -> 0.771
epoch : 85, train loss : 0.007, valid loss : 0.016, train acc : 0.934, valid acc : 0.878, train f1 : 0.934, valid f1 : 0.746
training process:  66%|██████▋   | 85/128 [1:51:56<48:17, 67.38s/it]EarlyStopping counter : 1 out of 12
training process:  67%|██████▋   | 86/128 [1:53:34<53:31, 76.46s/it]EarlyStopping counter : 2 out of 12
training process:  68%|██████▊   | 87/128 [1:55:13<56:53, 83.25s/it]EarlyStopping counter : 3 out of 12
training process:  69%|██████▉   | 88/128 [1:56:49<58:11, 87.29s/it]Best score increase :0.771 -> 0.772
epoch : 89, train loss : 0.006, valid loss : 0.015, train acc : 0.939, valid acc : 0.891, train f1 : 0.939, valid f1 : 0.765
training process:  70%|██████▉   | 89/128 [1:57:52<51:52, 79.80s/it]EarlyStopping counter : 1 out of 12
training process:  70%|███████   | 90/128 [1:58:41<44:47, 70.71s/it]EarlyStopping counter : 2 out of 12
training process:  71%|███████   | 91/128 [1:59:44<42:13, 68.47s/it]EarlyStopping counter : 3 out of 12
training process:  72%|███████▏  | 92/128 [2:01:24<46:35, 77.66s/it]EarlyStopping counter : 4 out of 12
epoch : 93, train loss : 0.006, valid loss : 0.016, train acc : 0.941, valid acc : 0.881, train f1 : 0.941, valid f1 : 0.751
training process:  73%|███████▎  | 93/128 [2:03:12<50:46, 87.04s/it]EarlyStopping counter : 5 out of 12
training process:  73%|███████▎  | 94/128 [2:04:50<51:08, 90.26s/it]EarlyStopping counter : 6 out of 12
training process:  74%|███████▍  | 95/128 [2:05:45<43:47, 79.61s/it]EarlyStopping counter : 7 out of 12
training process:  75%|███████▌  | 96/128 [2:06:40<38:28, 72.13s/it]EarlyStopping counter : 8 out of 12
epoch : 97, train loss : 0.006, valid loss : 0.016, train acc : 0.939, valid acc : 0.890, train f1 : 0.939, valid f1 : 0.761
training process:  76%|███████▌  | 97/128 [2:08:07<39:40, 76.78s/it]EarlyStopping counter : 9 out of 12
training process:  77%|███████▋  | 98/128 [2:09:44<41:26, 82.88s/it]EarlyStopping counter : 10 out of 12
training process:  77%|███████▋  | 99/128 [2:11:24<42:26, 87.80s/it]EarlyStopping counter : 11 out of 12
training process:  77%|███████▋  | 99/128 [2:12:44<38:53, 80.45s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 99, best f1 score : 0.772
training process finished, best loss : 0.015 and best acc : 0.897, best f1 : 0.772, best epoch : 87

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.49      0.91      0.64       580
           1       0.99      0.92      0.95      6818

    accuracy                           0.92      7398
   macro avg       0.74      0.91      0.80      7398
weighted avg       0.95      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.80, test AUC : 0.91, test loss : 0.702

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.36s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.96s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:12,  8.06s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:05,  8.16s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:57,  8.22s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:49,  8.18s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:56<00:41,  8.22s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:04<00:32,  8.11s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:24,  8.02s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:20<00:15,  7.96s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:28<00:07,  7.93s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  7.85s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.00s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 76.51it/s]  7%|▋         | 22/306 [00:00<00:02, 112.26it/s] 11%|█         | 34/306 [00:00<00:02, 106.39it/s] 15%|█▍        | 45/306 [00:00<00:02, 94.68it/s]  19%|█▉        | 59/306 [00:00<00:02, 108.18it/s] 23%|██▎       | 71/306 [00:00<00:02, 106.61it/s] 27%|██▋       | 82/306 [00:00<00:02, 106.89it/s] 31%|███       | 95/306 [00:00<00:01, 111.47it/s] 35%|███▍      | 107/306 [00:01<00:01, 107.23it/s] 40%|███▉      | 121/306 [00:01<00:01, 116.20it/s] 43%|████▎     | 133/306 [00:01<00:01, 114.59it/s] 47%|████▋     | 145/306 [00:01<00:01, 102.60it/s] 52%|█████▏    | 159/306 [00:01<00:01, 111.48it/s] 56%|█████▌    | 171/306 [00:01<00:01, 112.59it/s] 60%|█████▉    | 183/306 [00:01<00:01, 110.82it/s] 64%|██████▎   | 195/306 [00:01<00:00, 112.09it/s] 68%|██████▊   | 207/306 [00:01<00:00, 103.67it/s] 73%|███████▎  | 222/306 [00:02<00:00, 114.78it/s] 76%|███████▋  | 234/306 [00:02<00:00, 111.58it/s] 80%|████████  | 246/306 [00:02<00:00, 104.99it/s] 84%|████████▍ | 258/306 [00:02<00:00, 108.41it/s] 88%|████████▊ | 270/306 [00:02<00:00, 108.97it/s] 92%|█████████▏| 282/306 [00:02<00:00, 110.40it/s] 96%|█████████▌| 294/306 [00:02<00:00, 112.58it/s]100%|██████████| 306/306 [00:02<00:00, 105.05it/s]100%|██████████| 306/306 [00:02<00:00, 108.20it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 59/553 [00:00<00:00, 585.01it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:00, 617.53it/s]extract the null data:  34%|███▎      | 186/553 [00:00<00:00, 558.83it/s]extract the null data:  44%|████▍     | 243/553 [00:00<00:00, 538.52it/s]extract the null data:  55%|█████▍    | 302/553 [00:00<00:00, 553.44it/s]extract the null data:  65%|██████▌   | 362/553 [00:00<00:00, 566.27it/s]extract the null data:  77%|███████▋  | 424/553 [00:00<00:00, 581.60it/s]extract the null data:  88%|████████▊ | 484/553 [00:00<00:00, 585.04it/s]extract the null data:  98%|█████████▊| 543/553 [00:00<00:00, 586.24it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 575.80it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 196.04it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 207.49it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 210.50it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 211.42it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 210.94it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 211.58it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:01, 212.73it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:01, 214.05it/s]replace nan value:  36%|███▌      | 197/553 [00:00<00:01, 215.96it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 214.29it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 213.91it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 213.80it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 206.50it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 207.06it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 210.40it/s]replace nan value:  63%|██████▎   | 350/553 [00:01<00:00, 208.96it/s]replace nan value:  67%|██████▋   | 371/553 [00:01<00:00, 208.85it/s]replace nan value:  71%|███████   | 393/553 [00:01<00:00, 209.44it/s]replace nan value:  75%|███████▌  | 415/553 [00:01<00:00, 209.88it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 211.19it/s]replace nan value:  83%|████████▎ | 459/553 [00:02<00:00, 213.55it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 211.68it/s]replace nan value:  91%|█████████ | 503/553 [00:02<00:00, 212.26it/s]replace nan value:  95%|█████████▍| 525/553 [00:02<00:00, 212.08it/s]replace nan value:  99%|█████████▉| 547/553 [00:02<00:00, 207.57it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 210.36it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 142.08it/s]  6%|▌         | 31/553 [00:00<00:03, 150.96it/s]  8%|▊         | 47/553 [00:00<00:03, 128.88it/s] 11%|█         | 61/553 [00:00<00:03, 123.72it/s] 14%|█▎        | 76/553 [00:00<00:03, 131.69it/s] 16%|█▋        | 91/553 [00:00<00:03, 132.27it/s] 19%|█▉        | 106/553 [00:00<00:03, 136.03it/s] 22%|██▏       | 122/553 [00:00<00:03, 142.41it/s] 25%|██▌       | 140/553 [00:00<00:02, 151.06it/s] 29%|██▉       | 159/553 [00:01<00:02, 162.37it/s] 32%|███▏      | 176/553 [00:01<00:02, 161.06it/s] 35%|███▍      | 193/553 [00:01<00:02, 162.65it/s] 38%|███▊      | 212/553 [00:01<00:02, 168.99it/s] 41%|████▏     | 229/553 [00:01<00:02, 157.53it/s] 44%|████▍     | 245/553 [00:01<00:01, 154.95it/s] 48%|████▊     | 263/553 [00:01<00:01, 160.68it/s] 51%|█████     | 280/553 [00:01<00:01, 148.70it/s] 54%|█████▎    | 296/553 [00:01<00:01, 144.69it/s] 56%|█████▌    | 311/553 [00:02<00:01, 141.19it/s] 59%|█████▉    | 326/553 [00:02<00:01, 141.33it/s] 62%|██████▏   | 341/553 [00:02<00:01, 143.57it/s] 64%|██████▍   | 356/553 [00:02<00:01, 139.04it/s] 67%|██████▋   | 373/553 [00:02<00:01, 145.46it/s] 70%|███████   | 388/553 [00:02<00:01, 135.50it/s] 73%|███████▎  | 402/553 [00:02<00:01, 129.28it/s] 75%|███████▌  | 416/553 [00:02<00:01, 131.80it/s] 78%|███████▊  | 430/553 [00:03<00:00, 126.54it/s] 81%|████████  | 449/553 [00:03<00:00, 142.91it/s] 84%|████████▍ | 465/553 [00:03<00:00, 146.49it/s] 87%|████████▋ | 480/553 [00:03<00:00, 141.09it/s] 90%|████████▉ | 495/553 [00:03<00:00, 132.25it/s] 92%|█████████▏| 511/553 [00:03<00:00, 138.58it/s] 95%|█████████▌| 526/553 [00:03<00:00, 123.54it/s] 97%|█████████▋| 539/553 [00:03<00:00, 122.01it/s]100%|█████████▉| 552/553 [00:03<00:00, 110.66it/s]100%|██████████| 553/553 [00:03<00:00, 138.68it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 40/139 [00:00<00:00, 395.13it/s]extract the null data:  78%|███████▊  | 109/139 [00:00<00:00, 565.64it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 570.95it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 238.76it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 201.67it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 191.68it/s]replace nan value:  65%|██████▌   | 91/139 [00:00<00:00, 201.40it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 209.55it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 215.20it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 209.86it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 119.51it/s] 19%|█▉        | 27/139 [00:00<00:00, 134.82it/s] 32%|███▏      | 44/139 [00:00<00:00, 147.96it/s] 42%|████▏     | 59/139 [00:00<00:00, 135.53it/s] 53%|█████▎    | 74/139 [00:00<00:00, 139.76it/s] 64%|██████▍   | 89/139 [00:00<00:00, 123.72it/s] 76%|███████▌  | 105/139 [00:00<00:00, 129.18it/s] 88%|████████▊ | 122/139 [00:00<00:00, 135.94it/s] 98%|█████████▊| 136/139 [00:01<00:00, 135.66it/s]100%|██████████| 139/139 [00:01<00:00, 135.31it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|█▉        | 34/173 [00:00<00:00, 338.92it/s]extract the null data:  61%|██████    | 105/173 [00:00<00:00, 554.48it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 577.92it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 234.36it/s]replace nan value:  28%|██▊       | 49/173 [00:00<00:00, 240.02it/s]replace nan value:  43%|████▎     | 74/173 [00:00<00:00, 230.98it/s]replace nan value:  57%|█████▋    | 98/173 [00:00<00:00, 226.44it/s]replace nan value:  70%|██████▉   | 121/173 [00:00<00:00, 224.33it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 227.36it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 219.77it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 224.83it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 142.31it/s] 17%|█▋        | 30/173 [00:00<00:01, 128.37it/s] 27%|██▋       | 47/173 [00:00<00:00, 145.36it/s] 38%|███▊      | 65/173 [00:00<00:00, 153.82it/s] 47%|████▋     | 82/173 [00:00<00:00, 157.74it/s] 57%|█████▋    | 99/173 [00:00<00:00, 158.38it/s] 68%|██████▊   | 117/173 [00:00<00:00, 164.81it/s] 77%|███████▋  | 134/173 [00:00<00:00, 153.17it/s] 87%|████████▋ | 150/173 [00:00<00:00, 150.08it/s] 96%|█████████▌| 166/173 [00:01<00:00, 121.54it/s]100%|██████████| 173/173 [00:01<00:00, 136.24it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.102, valid loss : 0.065, train f1 : 0.571, valid f1 : 0.587
training process - Deferred Re-weighting:   1%|          | 1/128 [01:45<3:43:33, 105.62s/it]Best score increase :0.000 -> 0.587
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:59<3:02:18, 86.81s/it] Best score increase :0.587 -> 0.645
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:55<2:31:33, 72.75s/it]Best score increase :0.645 -> 0.692
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:44<2:11:27, 63.61s/it]Best score increase :0.692 -> 0.712
epoch : 5, train loss : 0.043, valid loss : 0.049, train f1 : 0.775, valid f1 : 0.744
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:20<2:34:10, 75.21s/it]Best score increase :0.712 -> 0.744
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:55<2:46:33, 81.92s/it]Best score increase :0.744 -> 0.767
training process - Deferred Re-weighting:   5%|▌         | 7/128 [09:30<2:53:34, 86.07s/it]Best score increase :0.767 -> 0.780
training process - Deferred Re-weighting:   6%|▋         | 8/128 [10:36<2:39:25, 79.71s/it]Best score increase :0.780 -> 0.797
epoch : 9, train loss : 0.036, valid loss : 0.048, train f1 : 0.820, valid f1 : 0.784
training process - Deferred Re-weighting:   7%|▋         | 9/128 [11:33<2:24:07, 72.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [12:22<2:08:45, 65.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [13:58<2:25:58, 74.85s/it]Best score increase :0.797 -> 0.798
training process - Deferred Re-weighting:   9%|▉         | 12/128 [15:38<2:39:26, 82.47s/it]Best score increase :0.798 -> 0.819
epoch : 13, train loss : 0.033, valid loss : 0.050, train f1 : 0.843, valid f1 : 0.787
training process - Deferred Re-weighting:  10%|█         | 13/128 [17:28<2:53:53, 90.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [18:21<2:30:52, 79.41s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [19:12<2:13:29, 70.88s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [20:03<2:00:55, 64.78s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.031, valid loss : 0.046, train f1 : 0.853, valid f1 : 0.814
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [21:48<2:21:55, 76.72s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [23:28<2:33:49, 83.90s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [25:07<2:40:28, 88.33s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [26:01<2:20:42, 78.17s/it]EarlyStopping counter : 8 out of 12
epoch : 21, train loss : 0.029, valid loss : 0.047, train f1 : 0.866, valid f1 : 0.824
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [26:57<2:07:32, 71.52s/it]Best score increase :0.819 -> 0.824
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [27:46<1:54:19, 64.71s/it]Best score increase :0.824 -> 0.835
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [29:22<2:09:45, 74.14s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [31:00<2:20:36, 81.12s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.028, valid loss : 0.043, train f1 : 0.873, valid f1 : 0.832
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [32:47<2:32:42, 88.95s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [33:43<2:14:31, 79.13s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [34:38<2:00:43, 71.72s/it]Best score increase :0.835 -> 0.846
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [35:30<1:49:47, 65.88s/it]Best score increase :0.846 -> 0.850
epoch : 29, train loss : 0.026, valid loss : 0.044, train f1 : 0.877, valid f1 : 0.832
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [37:16<2:08:27, 77.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [38:52<2:16:02, 83.29s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [40:32<2:23:07, 88.53s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [41:30<2:06:56, 79.34s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.025, valid loss : 0.048, train f1 : 0.887, valid f1 : 0.837
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [42:28<1:55:32, 72.97s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [43:40<1:53:34, 72.49s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [45:19<2:04:50, 80.54s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [46:57<2:11:31, 85.78s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.024, valid loss : 0.048, train f1 : 0.892, valid f1 : 0.833
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [48:35<2:15:47, 89.53s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [49:26<1:56:51, 77.90s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [50:18<1:44:06, 70.19s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [51:31<1:57:34, 79.27s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 39, best f1 score : 0.850
training process finished, best loss : 0.038, best acc : 0.962, best f1 : 0.850, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.58      0.72       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.95      0.79      0.85      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.85, test AUC : 0.79, test loss : 2.456

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.56s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.73s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.65s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.58s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.60s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.64s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.67s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:23,  7.67s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.71s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.72s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.77s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.69s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 209.53it/s] 14%|█▎        | 42/306 [00:00<00:01, 207.87it/s] 21%|██        | 63/306 [00:00<00:01, 199.08it/s] 27%|██▋       | 84/306 [00:00<00:01, 201.65it/s] 34%|███▍      | 105/306 [00:00<00:01, 198.55it/s] 41%|████      | 126/306 [00:00<00:00, 201.97it/s] 49%|████▊     | 149/306 [00:00<00:00, 209.21it/s] 56%|█████▌    | 172/306 [00:00<00:00, 213.45it/s] 63%|██████▎   | 194/306 [00:00<00:00, 209.65it/s] 70%|███████   | 215/306 [00:01<00:00, 209.63it/s] 77%|███████▋  | 237/306 [00:01<00:00, 211.34it/s] 85%|████████▍ | 259/306 [00:01<00:00, 168.58it/s] 91%|█████████ | 278/306 [00:01<00:00, 163.85it/s] 97%|█████████▋| 297/306 [00:01<00:00, 169.99it/s]100%|██████████| 306/306 [00:01<00:00, 190.65it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 41/553 [00:00<00:01, 407.68it/s]extract the null data:  16%|█▌        | 88/553 [00:00<00:01, 441.69it/s]extract the null data:  24%|██▍       | 135/553 [00:00<00:00, 453.73it/s]extract the null data:  33%|███▎      | 182/553 [00:00<00:00, 459.10it/s]extract the null data:  41%|████      | 228/553 [00:00<00:00, 441.92it/s]extract the null data:  49%|████▉     | 273/553 [00:00<00:00, 382.68it/s]extract the null data:  57%|█████▋    | 313/553 [00:00<00:00, 380.19it/s]extract the null data:  64%|██████▎   | 352/553 [00:00<00:00, 357.12it/s]extract the null data:  70%|███████   | 389/553 [00:01<00:00, 344.37it/s]extract the null data:  77%|███████▋  | 424/553 [00:01<00:00, 335.84it/s]extract the null data:  85%|████████▍ | 469/553 [00:01<00:00, 366.64it/s]extract the null data:  93%|█████████▎| 515/553 [00:01<00:00, 391.11it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 392.36it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 155.30it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 163.59it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 161.20it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:03, 161.36it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:03, 144.61it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:03, 124.51it/s]replace nan value:  20%|██        | 112/553 [00:00<00:03, 118.00it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:03, 121.76it/s]replace nan value:  25%|██▌       | 140/553 [00:01<00:03, 125.57it/s]replace nan value:  29%|██▊       | 158/553 [00:01<00:02, 138.47it/s]replace nan value:  32%|███▏      | 175/553 [00:01<00:02, 146.69it/s]replace nan value:  35%|███▍      | 192/553 [00:01<00:02, 151.95it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:02, 156.36it/s]replace nan value:  41%|████      | 226/553 [00:01<00:02, 159.10it/s]replace nan value:  44%|████▍     | 243/553 [00:01<00:01, 159.20it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 157.82it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 160.00it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 162.77it/s]replace nan value:  56%|█████▌    | 310/553 [00:02<00:01, 164.65it/s]replace nan value:  59%|█████▉    | 327/553 [00:02<00:01, 165.34it/s]replace nan value:  62%|██████▏   | 344/553 [00:02<00:01, 166.17it/s]replace nan value:  65%|██████▌   | 361/553 [00:02<00:01, 164.89it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:01, 152.41it/s]replace nan value:  71%|███████▏  | 395/553 [00:02<00:01, 155.41it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 155.99it/s]replace nan value:  77%|███████▋  | 427/553 [00:02<00:00, 154.58it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 147.16it/s]replace nan value:  83%|████████▎ | 458/553 [00:03<00:00, 139.45it/s]replace nan value:  86%|████████▌ | 473/553 [00:03<00:00, 139.92it/s]replace nan value:  89%|████████▊ | 490/553 [00:03<00:00, 147.93it/s]replace nan value:  92%|█████████▏| 506/553 [00:03<00:00, 151.27it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 147.74it/s]replace nan value:  97%|█████████▋| 538/553 [00:03<00:00, 149.57it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 149.60it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 10/553 [00:00<00:05, 94.63it/s]  4%|▍         | 21/553 [00:00<00:05, 94.09it/s]  6%|▋         | 35/553 [00:00<00:04, 111.16it/s]  8%|▊         | 47/553 [00:00<00:04, 102.03it/s] 10%|█         | 58/553 [00:00<00:05, 94.82it/s]  12%|█▏        | 69/553 [00:00<00:04, 97.79it/s] 15%|█▍        | 81/553 [00:00<00:04, 104.03it/s] 17%|█▋        | 92/553 [00:00<00:04, 105.07it/s] 19%|█▊        | 103/553 [00:01<00:04, 106.49it/s] 22%|██▏       | 119/553 [00:01<00:03, 121.80it/s] 24%|██▍       | 132/553 [00:01<00:03, 105.32it/s] 26%|██▌       | 144/553 [00:01<00:04, 100.12it/s] 29%|██▉       | 160/553 [00:01<00:03, 113.45it/s] 31%|███▏      | 174/553 [00:01<00:03, 119.81it/s] 34%|███▍      | 188/553 [00:01<00:02, 123.72it/s] 36%|███▋      | 201/553 [00:01<00:02, 119.24it/s] 39%|███▉      | 215/553 [00:01<00:02, 124.64it/s] 41%|████      | 228/553 [00:02<00:02, 125.25it/s] 44%|████▍     | 242/553 [00:02<00:02, 127.73it/s] 46%|████▌     | 255/553 [00:02<00:02, 125.12it/s] 49%|████▊     | 269/553 [00:02<00:02, 126.21it/s] 51%|█████     | 282/553 [00:02<00:02, 124.91it/s] 53%|█████▎    | 295/553 [00:02<00:02, 124.28it/s] 56%|█████▌    | 308/553 [00:02<00:01, 123.51it/s] 58%|█████▊    | 321/553 [00:02<00:01, 119.87it/s] 60%|██████    | 334/553 [00:02<00:01, 122.19it/s] 63%|██████▎   | 348/553 [00:03<00:01, 123.57it/s] 65%|██████▌   | 361/553 [00:03<00:01, 118.49it/s] 67%|██████▋   | 373/553 [00:03<00:01, 106.02it/s] 69%|██████▉   | 384/553 [00:03<00:01, 104.49it/s] 71%|███████▏  | 395/553 [00:03<00:01, 98.98it/s]  74%|███████▍  | 408/553 [00:03<00:01, 106.42it/s] 76%|███████▌  | 419/553 [00:03<00:01, 90.03it/s]  78%|███████▊  | 429/553 [00:03<00:01, 89.95it/s] 81%|████████  | 446/553 [00:03<00:00, 109.81it/s] 83%|████████▎ | 459/553 [00:04<00:00, 113.46it/s] 85%|████████▌ | 471/553 [00:04<00:00, 102.55it/s] 88%|████████▊ | 484/553 [00:04<00:00, 107.24it/s] 90%|████████▉ | 496/553 [00:04<00:00, 89.53it/s]  92%|█████████▏| 506/553 [00:04<00:00, 90.46it/s] 93%|█████████▎| 516/553 [00:04<00:00, 88.08it/s] 95%|█████████▌| 526/553 [00:04<00:00, 85.55it/s] 97%|█████████▋| 535/553 [00:05<00:00, 84.46it/s] 98%|█████████▊| 544/553 [00:05<00:00, 85.32it/s]100%|██████████| 553/553 [00:05<00:00, 73.44it/s]100%|██████████| 553/553 [00:05<00:00, 104.84it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  10%|█         | 14/139 [00:00<00:00, 138.69it/s]extract the null data:  43%|████▎     | 60/139 [00:00<00:00, 324.13it/s]extract the null data:  80%|███████▉  | 111/139 [00:00<00:00, 406.16it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 388.88it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:   8%|▊         | 11/139 [00:00<00:01, 92.55it/s]replace nan value:  22%|██▏       | 30/139 [00:00<00:00, 145.10it/s]replace nan value:  35%|███▌      | 49/139 [00:00<00:00, 163.61it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 171.81it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 175.90it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 174.82it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 161.32it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 151.72it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  6%|▋         | 9/139 [00:00<00:01, 89.91it/s] 16%|█▌        | 22/139 [00:00<00:01, 113.11it/s] 27%|██▋       | 38/139 [00:00<00:00, 133.04it/s] 37%|███▋      | 52/139 [00:00<00:01, 80.42it/s]  45%|████▌     | 63/139 [00:00<00:00, 83.49it/s] 53%|█████▎    | 74/139 [00:00<00:00, 87.63it/s] 63%|██████▎   | 87/139 [00:00<00:00, 93.27it/s] 71%|███████   | 99/139 [00:01<00:00, 100.20it/s] 79%|███████▉  | 110/139 [00:01<00:00, 95.63it/s] 88%|████████▊ | 123/139 [00:01<00:00, 102.46it/s] 96%|█████████▋| 134/139 [00:01<00:00, 103.28it/s]100%|██████████| 139/139 [00:01<00:00, 99.16it/s] 
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   7%|▋         | 12/173 [00:00<00:01, 118.71it/s]extract the null data:  36%|███▋      | 63/173 [00:00<00:00, 347.47it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 357.35it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 371.02it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 363.01it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 181.23it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 157.11it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 166.91it/s]replace nan value:  43%|████▎     | 74/173 [00:00<00:00, 142.05it/s]replace nan value:  51%|█████▏    | 89/173 [00:00<00:00, 127.92it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 144.79it/s]replace nan value:  72%|███████▏  | 124/173 [00:00<00:00, 148.96it/s]replace nan value:  82%|████████▏ | 142/173 [00:00<00:00, 157.05it/s]replace nan value:  92%|█████████▏| 160/173 [00:01<00:00, 163.59it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 154.99it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  6%|▌         | 10/173 [00:00<00:01, 84.73it/s] 13%|█▎        | 23/173 [00:00<00:01, 104.94it/s] 20%|██        | 35/173 [00:00<00:01, 111.31it/s] 31%|███       | 53/173 [00:00<00:00, 134.51it/s] 39%|███▊      | 67/173 [00:00<00:00, 118.16it/s] 46%|████▌     | 80/173 [00:00<00:00, 109.39it/s] 53%|█████▎    | 92/173 [00:00<00:00, 88.66it/s]  62%|██████▏   | 107/173 [00:01<00:00, 102.57it/s] 69%|██████▉   | 119/173 [00:01<00:00, 92.32it/s]  75%|███████▍  | 129/173 [00:01<00:00, 79.54it/s] 80%|███████▉  | 138/173 [00:01<00:00, 77.87it/s] 86%|████████▌ | 149/173 [00:01<00:00, 83.53it/s] 93%|█████████▎| 161/173 [00:01<00:00, 90.56it/s] 99%|█████████▉| 171/173 [00:02<00:00, 58.81it/s]100%|██████████| 173/173 [00:02<00:00, 84.94it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.104, train f1 : 0.714, valid f1 : 0.641
training process - Deferred Re-weighting:   1%|          | 1/128 [01:11<2:30:40, 71.19s/it]Best score increase :0.000 -> 0.641
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:06<2:10:02, 61.92s/it]Best score increase :0.641 -> 0.750
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:06<2:07:22, 61.14s/it]Best score increase :0.750 -> 0.786
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:07<2:05:58, 60.95s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.087, valid loss : 0.071, train f1 : 0.847, valid f1 : 0.773
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:07<2:04:33, 60.76s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:54<1:54:05, 56.11s/it]Best score increase :0.786 -> 0.806
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:42<1:47:40, 53.39s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:33<1:45:19, 52.66s/it]Best score increase :0.806 -> 0.812
epoch : 9, train loss : 0.073, valid loss : 0.060, train f1 : 0.877, valid f1 : 0.810
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:29<1:46:17, 53.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:17<1:41:48, 51.77s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:04<1:38:00, 50.26s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:51<1:35:23, 49.34s/it]Best score increase :0.812 -> 0.819
epoch : 13, train loss : 0.065, valid loss : 0.054, train f1 : 0.893, valid f1 : 0.817
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:45<1:37:17, 50.76s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:39<1:38:39, 51.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:27<1:35:17, 50.60s/it]Best score increase :0.819 -> 0.820
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:13<1:31:38, 49.09s/it]Best score increase :0.820 -> 0.835
epoch : 17, train loss : 0.056, valid loss : 0.060, train f1 : 0.912, valid f1 : 0.808
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:09<1:35:03, 51.38s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [15:56<1:31:28, 49.90s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:42<1:28:50, 48.90s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:28<1:26:18, 47.95s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.053, valid loss : 0.055, train f1 : 0.918, valid f1 : 0.805
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:21<1:28:18, 49.52s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:12<1:28:23, 50.04s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:25<1:39:18, 56.75s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:38<1:46:57, 61.70s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.048, valid loss : 0.052, train f1 : 0.925, valid f1 : 0.811
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:59<1:55:55, 67.53s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:13<1:58:08, 69.49s/it]Best score increase :0.835 -> 0.845
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:27<1:58:57, 70.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [26:24<1:51:05, 66.66s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.044, valid loss : 0.046, train f1 : 0.931, valid f1 : 0.840
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:27<1:48:20, 65.66s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [28:20<1:40:49, 61.73s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [29:34<1:45:54, 65.51s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [30:53<1:51:06, 69.44s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.042, valid loss : 0.048, train f1 : 0.938, valid f1 : 0.836
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [32:21<1:58:37, 74.92s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [33:58<2:08:01, 81.72s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [35:32<2:12:31, 85.50s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [36:57<2:10:45, 85.28s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.038, valid loss : 0.041, train f1 : 0.943, valid f1 : 0.854
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [38:29<2:12:21, 87.27s/it]Best score increase :0.845 -> 0.854
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [40:00<2:12:26, 88.30s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [41:26<2:10:07, 87.72s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [42:54<2:08:41, 87.75s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.037, valid loss : 0.042, train f1 : 0.944, valid f1 : 0.851
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [44:28<2:09:47, 89.51s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [45:47<2:03:54, 86.45s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [47:12<2:02:00, 86.12s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [48:28<1:56:10, 82.98s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.033, valid loss : 0.048, train f1 : 0.953, valid f1 : 0.834
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [50:03<1:59:37, 86.48s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [51:26<1:56:50, 85.50s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [52:49<1:54:40, 84.95s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [54:09<1:51:09, 83.37s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.032, valid loss : 0.052, train f1 : 0.954, valid f1 : 0.836
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [55:42<1:32:50, 69.63s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.854
training process finished, best loss : 0.041, best acc : 0.948, best f1 : 0.854, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.69      0.84      0.75       580
           1       0.99      0.97      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.84      0.90      0.87      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.87, test AUC : 0.90, test loss : 2.228

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:35,  8.71s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:24,  8.44s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:16,  8.48s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:07,  8.41s/it]processing for feature importance:  42%|████▏     | 5/12 [00:42<00:58,  8.36s/it]processing for feature importance:  50%|█████     | 6/12 [00:50<00:50,  8.41s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:58<00:41,  8.23s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:06<00:32,  8.18s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:13<00:23,  7.84s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:15,  7.87s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:30<00:08,  8.07s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.18s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.21s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 77.99it/s]  6%|▌         | 17/306 [00:00<00:03, 81.43it/s] 13%|█▎        | 39/306 [00:00<00:01, 137.42it/s] 17%|█▋        | 53/306 [00:00<00:01, 137.34it/s] 22%|██▏       | 67/306 [00:00<00:02, 113.06it/s] 28%|██▊       | 86/306 [00:00<00:01, 134.48it/s] 33%|███▎      | 101/306 [00:00<00:01, 132.93it/s] 38%|███▊      | 115/306 [00:00<00:01, 131.84it/s] 42%|████▏     | 129/306 [00:01<00:01, 121.02it/s] 48%|████▊     | 146/306 [00:01<00:01, 130.62it/s] 53%|█████▎    | 162/306 [00:01<00:01, 136.77it/s] 58%|█████▊    | 176/306 [00:01<00:01, 115.75it/s] 65%|██████▌   | 200/306 [00:01<00:00, 144.01it/s] 71%|███████   | 216/306 [00:01<00:00, 133.54it/s] 75%|███████▌  | 231/306 [00:01<00:00, 118.63it/s] 82%|████████▏ | 250/306 [00:01<00:00, 131.52it/s] 86%|████████▋ | 264/306 [00:02<00:00, 122.02it/s] 91%|█████████ | 277/306 [00:02<00:00, 110.88it/s] 96%|█████████▌| 294/306 [00:02<00:00, 122.83it/s]100%|██████████| 306/306 [00:02<00:00, 124.74it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_Normal_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 551.67it/s]extract the null data:  21%|██        | 114/553 [00:00<00:00, 563.73it/s]extract the null data:  31%|███       | 171/553 [00:00<00:00, 563.06it/s]extract the null data:  41%|████      | 228/553 [00:00<00:00, 563.42it/s]extract the null data:  52%|█████▏    | 285/553 [00:00<00:00, 565.51it/s]extract the null data:  62%|██████▏   | 344/553 [00:00<00:00, 571.51it/s]extract the null data:  73%|███████▎  | 402/553 [00:00<00:00, 569.34it/s]extract the null data:  83%|████████▎ | 460/553 [00:00<00:00, 570.58it/s]extract the null data:  94%|█████████▎| 518/553 [00:00<00:00, 557.15it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 560.02it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 174.51it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 193.34it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 199.40it/s]replace nan value:  15%|█▍        | 81/553 [00:00<00:02, 203.03it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 199.32it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:02, 198.61it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 196.44it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:02, 194.89it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 193.36it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 192.44it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 191.64it/s]replace nan value:  44%|████▍     | 242/553 [00:01<00:01, 191.24it/s]replace nan value:  47%|████▋     | 262/553 [00:01<00:01, 190.61it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 186.77it/s]replace nan value:  54%|█████▍    | 301/553 [00:01<00:01, 186.48it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 187.20it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 188.09it/s]replace nan value:  65%|██████▍   | 359/553 [00:01<00:01, 185.79it/s]replace nan value:  69%|██████▊   | 379/553 [00:01<00:00, 188.18it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 187.09it/s]replace nan value:  75%|███████▌  | 417/553 [00:02<00:00, 187.51it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 189.41it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 192.14it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 198.83it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 200.29it/s]replace nan value:  94%|█████████▍| 521/553 [00:02<00:00, 197.16it/s]replace nan value:  98%|█████████▊| 541/553 [00:02<00:00, 192.84it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 192.28it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.48it/s]  6%|▌         | 31/553 [00:00<00:03, 154.41it/s]  8%|▊         | 47/553 [00:00<00:03, 129.38it/s] 11%|█         | 61/553 [00:00<00:03, 125.41it/s] 14%|█▎        | 76/553 [00:00<00:03, 131.58it/s] 16%|█▋        | 91/553 [00:00<00:03, 131.82it/s] 19%|█▉        | 106/553 [00:00<00:03, 135.23it/s] 22%|██▏       | 122/553 [00:00<00:03, 138.19it/s] 25%|██▌       | 139/553 [00:01<00:02, 146.02it/s] 28%|██▊       | 157/553 [00:01<00:02, 155.45it/s] 31%|███▏      | 173/553 [00:01<00:02, 156.63it/s] 34%|███▍      | 189/553 [00:01<00:02, 150.39it/s] 37%|███▋      | 207/553 [00:01<00:02, 156.09it/s] 40%|████      | 223/553 [00:01<00:02, 145.02it/s] 43%|████▎     | 238/553 [00:01<00:02, 146.09it/s] 46%|████▌     | 253/553 [00:01<00:02, 143.00it/s] 48%|████▊     | 268/553 [00:01<00:02, 137.77it/s] 51%|█████     | 282/553 [00:02<00:02, 133.36it/s] 54%|█████▎    | 296/553 [00:02<00:01, 131.09it/s] 56%|█████▌    | 310/553 [00:02<00:01, 129.10it/s] 58%|█████▊    | 323/553 [00:02<00:01, 127.08it/s] 61%|██████    | 338/553 [00:02<00:01, 132.06it/s] 64%|██████▎   | 352/553 [00:02<00:01, 134.17it/s] 66%|██████▌   | 366/553 [00:02<00:01, 127.87it/s] 69%|██████▉   | 382/553 [00:02<00:01, 135.06it/s] 72%|███████▏  | 396/553 [00:02<00:01, 123.14it/s] 74%|███████▍  | 410/553 [00:03<00:01, 127.41it/s] 76%|███████▋  | 423/553 [00:03<00:01, 119.94it/s] 79%|███████▉  | 436/553 [00:03<00:00, 119.59it/s] 82%|████████▏ | 453/553 [00:03<00:00, 131.82it/s] 85%|████████▍ | 469/553 [00:03<00:00, 138.01it/s] 87%|████████▋ | 483/553 [00:03<00:00, 134.64it/s] 90%|████████▉ | 497/553 [00:03<00:00, 124.97it/s] 93%|█████████▎| 512/553 [00:03<00:00, 131.45it/s] 95%|█████████▌| 526/553 [00:03<00:00, 119.68it/s] 97%|█████████▋| 539/553 [00:04<00:00, 119.07it/s]100%|█████████▉| 552/553 [00:04<00:00, 106.28it/s]100%|██████████| 553/553 [00:04<00:00, 131.46it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 22/139 [00:00<00:00, 219.70it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 469.32it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 492.99it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 212.76it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 220.38it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 219.90it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 212.24it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 205.51it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 203.52it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 208.66it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.78it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.71it/s] 29%|██▉       | 41/139 [00:00<00:00, 135.48it/s] 40%|███▉      | 55/139 [00:00<00:00, 124.50it/s] 49%|████▉     | 68/139 [00:00<00:00, 124.49it/s] 58%|█████▊    | 81/139 [00:00<00:00, 122.62it/s] 68%|██████▊   | 94/139 [00:00<00:00, 114.07it/s] 77%|███████▋  | 107/139 [00:00<00:00, 116.22it/s] 88%|████████▊ | 122/139 [00:00<00:00, 125.87it/s] 97%|█████████▋| 135/139 [00:01<00:00, 122.31it/s]100%|██████████| 139/139 [00:01<00:00, 123.78it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 315.30it/s]extract the null data:  54%|█████▍    | 93/173 [00:00<00:00, 487.16it/s]extract the null data:  90%|████████▉ | 155/173 [00:00<00:00, 544.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 518.33it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 194.86it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 197.06it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 209.45it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 214.23it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 209.62it/s]replace nan value:  75%|███████▍  | 129/173 [00:00<00:00, 205.70it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 200.13it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 195.61it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 200.95it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 135.97it/s] 16%|█▌        | 28/173 [00:00<00:01, 122.30it/s] 25%|██▍       | 43/173 [00:00<00:00, 132.45it/s] 34%|███▎      | 58/173 [00:00<00:00, 137.80it/s] 42%|████▏     | 72/173 [00:00<00:00, 135.40it/s] 50%|████▉     | 86/173 [00:00<00:00, 129.53it/s] 58%|█████▊    | 100/173 [00:00<00:00, 129.94it/s] 66%|██████▋   | 115/173 [00:00<00:00, 134.04it/s] 75%|███████▍  | 129/173 [00:00<00:00, 126.85it/s] 82%|████████▏ | 142/173 [00:01<00:00, 127.52it/s] 90%|████████▉ | 155/173 [00:01<00:00, 114.43it/s] 97%|█████████▋| 167/173 [00:01<00:00, 97.56it/s] 100%|██████████| 173/173 [00:01<00:00, 116.65it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.008, train acc : 0.840, valid acc : 0.921, train f1 : 0.589, valid f1 : 0.634
training process:   1%|          | 1/128 [01:27<3:05:11, 87.49s/it]Best score increase :0.000 -> 0.634
training process:   2%|▏         | 2/128 [02:30<2:33:27, 73.08s/it]Best score increase :0.634 -> 0.654
training process:   2%|▏         | 3/128 [03:33<2:22:16, 68.29s/it]Best score increase :0.654 -> 0.692
training process:   3%|▎         | 4/128 [04:29<2:11:50, 63.79s/it]Best score increase :0.692 -> 0.734
epoch : 5, train loss : 0.004, valid loss : 0.003, train acc : 0.949, valid acc : 0.944, train f1 : 0.784, valid f1 : 0.759
training process:   4%|▍         | 5/128 [05:52<2:24:30, 70.49s/it]Best score increase :0.734 -> 0.759
training process:   5%|▍         | 6/128 [07:08<2:27:23, 72.49s/it]Best score increase :0.759 -> 0.783
training process:   5%|▌         | 7/128 [08:22<2:26:44, 72.76s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:37<2:26:56, 73.47s/it]Best score increase :0.783 -> 0.798
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.956, valid acc : 0.951, train f1 : 0.820, valid f1 : 0.792
training process:   7%|▋         | 9/128 [10:58<2:30:52, 76.07s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [12:07<2:25:22, 73.92s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [13:10<2:17:17, 70.41s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [14:11<2:10:26, 67.47s/it]Best score increase :0.798 -> 0.821
epoch : 13, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.950, train f1 : 0.840, valid f1 : 0.782
training process:  10%|█         | 13/128 [15:27<2:14:36, 70.23s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [16:41<2:15:27, 71.29s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [17:54<2:15:21, 71.87s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [19:07<2:14:55, 72.28s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.003, train acc : 0.963, valid acc : 0.953, train f1 : 0.854, valid f1 : 0.803
training process:  13%|█▎        | 17/128 [20:28<2:18:28, 74.85s/it]EarlyStopping counter : 5 out of 12
training process:  14%|█▍        | 18/128 [21:41<2:16:00, 74.19s/it]EarlyStopping counter : 6 out of 12
training process:  15%|█▍        | 19/128 [22:47<2:10:18, 71.73s/it]EarlyStopping counter : 7 out of 12
training process:  16%|█▌        | 20/128 [23:47<2:02:52, 68.26s/it]EarlyStopping counter : 8 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train acc : 0.965, valid acc : 0.956, train f1 : 0.864, valid f1 : 0.817
training process:  16%|█▋        | 21/128 [24:45<1:56:00, 65.05s/it]EarlyStopping counter : 9 out of 12
training process:  17%|█▋        | 22/128 [25:48<1:54:14, 64.67s/it]Best score increase :0.821 -> 0.836
training process:  18%|█▊        | 23/128 [27:04<1:58:45, 67.86s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [28:18<2:00:47, 69.69s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.959, train f1 : 0.872, valid f1 : 0.833
training process:  20%|█▉        | 25/128 [29:41<2:06:42, 73.81s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [30:54<2:04:56, 73.50s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [32:10<2:05:01, 74.27s/it]Best score increase :0.836 -> 0.838
training process:  22%|██▏       | 28/128 [32:59<1:51:05, 66.66s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.958, train f1 : 0.874, valid f1 : 0.830
training process:  23%|██▎       | 29/128 [33:57<1:46:02, 64.27s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [34:46<1:37:20, 59.60s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [35:57<1:41:45, 62.94s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [37:11<1:46:12, 66.38s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.960, train f1 : 0.879, valid f1 : 0.839
training process:  26%|██▌       | 33/128 [38:37<1:54:12, 72.13s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [39:52<1:54:27, 73.06s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [41:06<1:53:41, 73.35s/it]EarlyStopping counter : 8 out of 12
training process:  28%|██▊       | 36/128 [42:11<1:48:26, 70.73s/it]EarlyStopping counter : 9 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.961, train f1 : 0.885, valid f1 : 0.840
training process:  29%|██▉       | 37/128 [43:10<1:42:07, 67.33s/it]Best score increase :0.838 -> 0.840
training process:  30%|██▉       | 38/128 [44:19<1:41:39, 67.78s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [45:32<1:42:56, 69.40s/it]Best score increase :0.840 -> 0.846
training process:  31%|███▏      | 40/128 [46:52<1:46:21, 72.52s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.961, train f1 : 0.888, valid f1 : 0.847
training process:  32%|███▏      | 41/128 [48:18<1:50:58, 76.54s/it]Best score increase :0.846 -> 0.847
training process:  33%|███▎      | 42/128 [49:32<1:48:28, 75.68s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [50:44<1:45:53, 74.74s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [51:50<1:40:45, 71.97s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.962, train f1 : 0.894, valid f1 : 0.848
training process:  35%|███▌      | 45/128 [53:06<1:41:29, 73.36s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [54:39<1:48:14, 79.20s/it]EarlyStopping counter : 5 out of 12
training process:  37%|███▋      | 47/128 [55:56<1:46:11, 78.66s/it]Best score increase :0.847 -> 0.852
training process:  38%|███▊      | 48/128 [57:19<1:46:35, 79.94s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.964, train f1 : 0.893, valid f1 : 0.861
training process:  38%|███▊      | 49/128 [58:57<1:52:11, 85.20s/it]Best score increase :0.852 -> 0.861
training process:  39%|███▉      | 50/128 [1:00:22<1:50:43, 85.17s/it]EarlyStopping counter : 1 out of 12
training process:  40%|███▉      | 51/128 [1:01:44<1:47:56, 84.12s/it]EarlyStopping counter : 2 out of 12
training process:  41%|████      | 52/128 [1:02:55<1:41:43, 80.31s/it]EarlyStopping counter : 3 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train acc : 0.973, valid acc : 0.961, train f1 : 0.897, valid f1 : 0.842
training process:  41%|████▏     | 53/128 [1:04:16<1:40:40, 80.54s/it]EarlyStopping counter : 4 out of 12
training process:  42%|████▏     | 54/128 [1:05:36<1:39:07, 80.37s/it]EarlyStopping counter : 5 out of 12
training process:  43%|████▎     | 55/128 [1:06:55<1:37:25, 80.08s/it]EarlyStopping counter : 6 out of 12
training process:  44%|████▍     | 56/128 [1:08:13<1:35:10, 79.32s/it]EarlyStopping counter : 7 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.003, train acc : 0.973, valid acc : 0.961, train f1 : 0.900, valid f1 : 0.846
training process:  45%|████▍     | 57/128 [1:09:52<1:40:57, 85.31s/it]EarlyStopping counter : 8 out of 12
training process:  45%|████▌     | 58/128 [1:11:10<1:36:55, 83.08s/it]EarlyStopping counter : 9 out of 12
training process:  46%|████▌     | 59/128 [1:12:21<1:31:11, 79.29s/it]EarlyStopping counter : 10 out of 12
training process:  47%|████▋     | 60/128 [1:13:33<1:27:31, 77.23s/it]EarlyStopping counter : 11 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.003, train acc : 0.973, valid acc : 0.963, train f1 : 0.899, valid f1 : 0.856
training process:  47%|████▋     | 60/128 [1:15:01<1:25:01, 75.02s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 60, best f1 score : 0.861
training process finished, best loss : 0.003 and best acc : 0.964, best f1 : 0.861, best epoch : 48

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.61      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.81      0.86      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.81, test loss : 0.159

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:31,  8.32s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:22,  8.23s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:11,  7.93s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.04s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:58,  8.31s/it]processing for feature importance:  50%|█████     | 6/12 [00:50<00:51,  8.53s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:59<00:43,  8.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:07<00:34,  8.69s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:15<00:25,  8.45s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:23<00:16,  8.23s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:32<00:08,  8.51s/it]processing for feature importance: 100%|██████████| 12/12 [01:41<00:00,  8.57s/it]processing for feature importance: 100%|██████████| 12/12 [01:41<00:00,  8.44s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 126.28it/s]  9%|▉         | 29/306 [00:00<00:01, 139.64it/s] 15%|█▌        | 46/306 [00:00<00:01, 147.00it/s] 21%|██        | 63/306 [00:00<00:01, 151.67it/s] 26%|██▋       | 81/306 [00:00<00:01, 154.78it/s] 32%|███▏      | 97/306 [00:00<00:01, 156.30it/s] 37%|███▋      | 113/306 [00:00<00:01, 151.92it/s] 42%|████▏     | 129/306 [00:00<00:01, 148.97it/s] 47%|████▋     | 144/306 [00:00<00:01, 145.27it/s] 52%|█████▏    | 159/306 [00:01<00:01, 143.41it/s] 57%|█████▋    | 175/306 [00:01<00:00, 144.69it/s] 63%|██████▎   | 192/306 [00:01<00:00, 147.41it/s] 68%|██████▊   | 209/306 [00:01<00:00, 149.96it/s] 74%|███████▍  | 226/306 [00:01<00:00, 155.48it/s] 79%|███████▉  | 242/306 [00:01<00:00, 152.46it/s] 86%|████████▋ | 264/306 [00:01<00:00, 167.60it/s] 92%|█████████▏| 281/306 [00:01<00:00, 161.70it/s] 97%|█████████▋| 298/306 [00:01<00:00, 159.69it/s]100%|██████████| 306/306 [00:02<00:00, 150.64it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 47/553 [00:00<00:01, 464.97it/s]extract the null data:  17%|█▋        | 94/553 [00:00<00:01, 458.91it/s]extract the null data:  26%|██▋       | 146/553 [00:00<00:00, 482.76it/s]extract the null data:  35%|███▌      | 196/553 [00:00<00:00, 487.13it/s]extract the null data:  44%|████▍     | 245/553 [00:00<00:00, 458.12it/s]extract the null data:  53%|█████▎    | 292/553 [00:00<00:00, 451.93it/s]extract the null data:  61%|██████    | 338/553 [00:00<00:00, 453.82it/s]extract the null data:  70%|██████▉   | 385/553 [00:00<00:00, 458.51it/s]extract the null data:  79%|███████▊  | 435/553 [00:00<00:00, 469.61it/s]extract the null data:  88%|████████▊ | 488/553 [00:01<00:00, 485.97it/s]extract the null data:  97%|█████████▋| 537/553 [00:01<00:00, 475.80it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 469.66it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 167.49it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 171.16it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:03, 162.71it/s]replace nan value:  13%|█▎        | 70/553 [00:00<00:02, 163.49it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 166.86it/s]replace nan value:  19%|█▉        | 106/553 [00:00<00:02, 169.44it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 170.43it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 170.06it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 170.36it/s]replace nan value:  32%|███▏      | 178/553 [00:01<00:02, 172.16it/s]replace nan value:  35%|███▌      | 196/553 [00:01<00:02, 170.81it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 170.02it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 167.45it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 166.31it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 172.14it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 175.55it/s]replace nan value:  55%|█████▌    | 305/553 [00:01<00:01, 175.39it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 174.20it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 176.52it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 175.54it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:00, 176.68it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 174.33it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 170.73it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 167.89it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 168.13it/s]replace nan value:  84%|████████▍ | 467/553 [00:02<00:00, 170.71it/s]replace nan value:  88%|████████▊ | 485/553 [00:02<00:00, 168.06it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 173.44it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 172.41it/s]replace nan value:  98%|█████████▊| 540/553 [00:03<00:00, 168.91it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 170.38it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 133.40it/s]  5%|▌         | 28/553 [00:00<00:03, 136.99it/s]  8%|▊         | 42/553 [00:00<00:03, 130.71it/s] 10%|█         | 56/553 [00:00<00:04, 121.49it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.88it/s] 15%|█▌        | 84/553 [00:00<00:03, 122.48it/s] 18%|█▊        | 98/553 [00:00<00:03, 123.09it/s] 21%|██        | 114/553 [00:00<00:03, 131.73it/s] 23%|██▎       | 128/553 [00:01<00:03, 128.83it/s] 26%|██▌       | 145/553 [00:01<00:02, 140.44it/s] 29%|██▉       | 162/553 [00:01<00:02, 148.43it/s] 32%|███▏      | 178/553 [00:01<00:02, 150.05it/s] 35%|███▌      | 194/553 [00:01<00:02, 152.49it/s] 38%|███▊      | 210/553 [00:01<00:02, 154.07it/s] 41%|████      | 226/553 [00:01<00:02, 138.41it/s] 44%|████▎     | 241/553 [00:01<00:02, 140.41it/s] 46%|████▋     | 256/553 [00:01<00:02, 136.23it/s] 49%|████▉     | 270/553 [00:01<00:02, 136.55it/s] 51%|█████▏    | 284/553 [00:02<00:02, 123.88it/s] 54%|█████▎    | 297/553 [00:02<00:02, 114.76it/s] 56%|█████▌    | 309/553 [00:02<00:02, 115.41it/s] 58%|█████▊    | 321/553 [00:02<00:01, 116.40it/s] 61%|██████    | 335/553 [00:02<00:01, 120.94it/s] 63%|██████▎   | 348/553 [00:02<00:01, 122.32it/s] 65%|██████▌   | 361/553 [00:02<00:01, 118.01it/s] 68%|██████▊   | 376/553 [00:02<00:01, 123.62it/s] 70%|███████   | 389/553 [00:03<00:01, 119.74it/s] 73%|███████▎  | 402/553 [00:03<00:01, 115.18it/s] 75%|███████▌  | 416/553 [00:03<00:01, 116.84it/s] 77%|███████▋  | 428/553 [00:03<00:01, 111.92it/s] 80%|████████  | 445/553 [00:03<00:00, 126.05it/s] 83%|████████▎ | 461/553 [00:03<00:00, 134.50it/s] 86%|████████▌ | 475/553 [00:03<00:00, 135.58it/s] 88%|████████▊ | 489/553 [00:03<00:00, 124.94it/s] 91%|█████████ | 502/553 [00:03<00:00, 116.55it/s] 93%|█████████▎| 516/553 [00:04<00:00, 120.82it/s] 96%|█████████▌| 529/553 [00:04<00:00, 106.59it/s] 98%|█████████▊| 541/553 [00:04<00:00, 107.58it/s]100%|██████████| 553/553 [00:04<00:00, 93.65it/s] 100%|██████████| 553/553 [00:04<00:00, 123.04it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 259.32it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 460.42it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 474.37it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 178.52it/s]replace nan value:  27%|██▋       | 37/139 [00:00<00:00, 184.02it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 192.99it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 205.10it/s]replace nan value:  73%|███████▎  | 102/139 [00:00<00:00, 205.90it/s]replace nan value:  88%|████████▊ | 123/139 [00:00<00:00, 198.05it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 196.29it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.79it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.87it/s] 28%|██▊       | 39/139 [00:00<00:00, 128.91it/s] 37%|███▋      | 52/139 [00:00<00:00, 123.00it/s] 48%|████▊     | 67/139 [00:00<00:00, 128.98it/s] 58%|█████▊    | 81/139 [00:00<00:00, 130.15it/s] 68%|██████▊   | 95/139 [00:00<00:00, 119.97it/s] 78%|███████▊  | 108/139 [00:00<00:00, 121.87it/s] 90%|████████▉ | 125/139 [00:00<00:00, 133.48it/s]100%|██████████| 139/139 [00:01<00:00, 132.98it/s]100%|██████████| 139/139 [00:01<00:00, 127.97it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:27,  6.32it/s]extract the null data:  32%|███▏      | 55/173 [00:00<00:00, 258.25it/s]extract the null data:  66%|██████▋   | 115/173 [00:00<00:00, 393.78it/s]extract the null data:  98%|█████████▊| 170/173 [00:00<00:00, 450.52it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 370.58it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 180.01it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 171.02it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 178.23it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 184.42it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 182.36it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 186.57it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 187.94it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 185.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 182.55it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 136.34it/s] 17%|█▋        | 29/173 [00:00<00:01, 122.63it/s] 27%|██▋       | 46/173 [00:00<00:00, 140.33it/s] 36%|███▌      | 62/173 [00:00<00:00, 147.53it/s] 45%|████▍     | 77/173 [00:00<00:00, 145.50it/s] 53%|█████▎    | 92/173 [00:00<00:00, 144.95it/s] 62%|██████▏   | 108/173 [00:00<00:00, 147.02it/s] 71%|███████   | 123/173 [00:00<00:00, 131.15it/s] 79%|███████▉  | 137/173 [00:00<00:00, 132.82it/s] 87%|████████▋ | 151/173 [00:01<00:00, 128.59it/s] 95%|█████████▌| 165/173 [00:01<00:00, 119.01it/s]100%|██████████| 173/173 [00:01<00:00, 123.07it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.009, train acc : 0.698, valid acc : 0.762, train f1 : 0.698, valid f1 : 0.599
training process:   1%|          | 1/128 [01:39<3:30:15, 99.33s/it]Best score increase :0.000 -> 0.599
training process:   2%|▏         | 2/128 [03:04<3:11:36, 91.24s/it]Best score increase :0.599 -> 0.681
training process:   2%|▏         | 3/128 [04:40<3:13:47, 93.02s/it]Best score increase :0.681 -> 0.766
training process:   3%|▎         | 4/128 [06:14<3:13:08, 93.46s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.007, valid loss : 0.005, train acc : 0.851, valid acc : 0.901, train f1 : 0.851, valid f1 : 0.767
training process:   4%|▍         | 5/128 [07:51<3:14:41, 94.97s/it]Best score increase :0.766 -> 0.767
training process:   5%|▍         | 6/128 [09:24<3:11:39, 94.26s/it]Best score increase :0.767 -> 0.791
training process:   5%|▌         | 7/128 [10:55<3:07:49, 93.14s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [12:22<3:02:02, 91.02s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.006, valid loss : 0.005, train acc : 0.876, valid acc : 0.902, train f1 : 0.876, valid f1 : 0.771
training process:   7%|▋         | 9/128 [14:03<3:06:48, 94.19s/it]EarlyStopping counter : 3 out of 12
training process:   8%|▊         | 10/128 [15:35<3:04:15, 93.69s/it]EarlyStopping counter : 4 out of 12
training process:   9%|▊         | 11/128 [16:50<2:51:34, 87.99s/it]EarlyStopping counter : 5 out of 12
training process:   9%|▉         | 12/128 [18:01<2:40:03, 82.79s/it]Best score increase :0.791 -> 0.813
epoch : 13, train loss : 0.005, valid loss : 0.004, train acc : 0.890, valid acc : 0.912, train f1 : 0.890, valid f1 : 0.785
training process:  10%|█         | 13/128 [19:41<2:48:20, 87.83s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [20:55<2:39:03, 83.71s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [22:13<2:34:17, 81.92s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▎        | 16/128 [23:40<2:36:08, 83.65s/it]Best score increase :0.813 -> 0.816
epoch : 17, train loss : 0.004, valid loss : 0.004, train acc : 0.906, valid acc : 0.924, train f1 : 0.906, valid f1 : 0.809
training process:  13%|█▎        | 17/128 [25:12<2:39:30, 86.22s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [26:31<2:33:38, 83.81s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [27:48<2:28:49, 81.92s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [29:03<2:23:24, 79.67s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.004, train acc : 0.912, valid acc : 0.909, train f1 : 0.912, valid f1 : 0.786
training process:  16%|█▋        | 21/128 [30:28<2:25:10, 81.40s/it]EarlyStopping counter : 5 out of 12
training process:  17%|█▋        | 22/128 [31:46<2:21:51, 80.29s/it]EarlyStopping counter : 6 out of 12
training process:  18%|█▊        | 23/128 [33:08<2:21:32, 80.88s/it]EarlyStopping counter : 7 out of 12
training process:  19%|█▉        | 24/128 [34:36<2:23:37, 82.86s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.004, train acc : 0.917, valid acc : 0.917, train f1 : 0.917, valid f1 : 0.798
training process:  20%|█▉        | 25/128 [36:11<2:28:56, 86.76s/it]EarlyStopping counter : 9 out of 12
training process:  20%|██        | 26/128 [37:39<2:28:09, 87.15s/it]Best score increase :0.816 -> 0.840
training process:  21%|██        | 27/128 [39:09<2:27:44, 87.77s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [40:32<2:23:57, 86.38s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.003, train acc : 0.925, valid acc : 0.932, train f1 : 0.925, valid f1 : 0.824
training process:  23%|██▎       | 29/128 [42:11<2:28:39, 90.09s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [43:42<2:28:01, 90.63s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [45:10<2:25:10, 89.80s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [46:44<2:25:31, 90.96s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.004, train acc : 0.926, valid acc : 0.927, train f1 : 0.926, valid f1 : 0.817
training process:  26%|██▌       | 33/128 [48:19<2:26:09, 92.31s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 34/128 [49:33<2:16:03, 86.85s/it]EarlyStopping counter : 8 out of 12
training process:  27%|██▋       | 35/128 [50:35<2:02:41, 79.15s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 36/128 [51:34<1:52:25, 73.32s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.003, train acc : 0.932, valid acc : 0.944, train f1 : 0.932, valid f1 : 0.846
training process:  29%|██▉       | 37/128 [52:52<1:53:07, 74.59s/it]Best score increase :0.840 -> 0.846
training process:  30%|██▉       | 38/128 [53:59<1:48:39, 72.43s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [55:04<1:43:52, 70.03s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [56:10<1:41:11, 69.00s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.003, train acc : 0.932, valid acc : 0.936, train f1 : 0.932, valid f1 : 0.831
training process:  32%|███▏      | 41/128 [57:26<1:42:56, 70.99s/it]EarlyStopping counter : 4 out of 12
training process:  33%|███▎      | 42/128 [58:30<1:38:52, 68.98s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▎      | 43/128 [59:34<1:35:35, 67.48s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▍      | 44/128 [1:00:36<1:32:04, 65.77s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.003, train acc : 0.941, valid acc : 0.934, train f1 : 0.941, valid f1 : 0.829
training process:  35%|███▌      | 45/128 [1:01:54<1:36:04, 69.45s/it]EarlyStopping counter : 8 out of 12
training process:  36%|███▌      | 46/128 [1:03:00<1:33:38, 68.52s/it]EarlyStopping counter : 9 out of 12
training process:  37%|███▋      | 47/128 [1:04:02<1:29:38, 66.41s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 48/128 [1:05:04<1:26:47, 65.10s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.003, valid loss : 0.004, train acc : 0.940, valid acc : 0.928, train f1 : 0.940, valid f1 : 0.818
training process:  38%|███▊      | 48/128 [1:06:15<1:50:26, 82.83s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.846
training process finished, best loss : 0.003 and best acc : 0.944, best f1 : 0.846, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.86      0.72       580
           1       0.99      0.95      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.80      0.91      0.84      7398
weighted avg       0.96      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.91, test loss : 0.172

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:36,  8.78s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:28,  8.87s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:21,  9.02s/it]processing for feature importance:  33%|███▎      | 4/12 [00:36<01:14,  9.35s/it]processing for feature importance:  42%|████▏     | 5/12 [00:47<01:08,  9.72s/it]processing for feature importance:  50%|█████     | 6/12 [00:56<00:58,  9.76s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:07<00:49,  9.99s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:17<00:40, 10.08s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:27<00:30, 10.10s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:36<00:19,  9.74s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:46<00:09,  9.68s/it]processing for feature importance: 100%|██████████| 12/12 [01:56<00:00,  9.88s/it]processing for feature importance: 100%|██████████| 12/12 [01:56<00:00,  9.72s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 138.37it/s] 11%|█         | 34/306 [00:00<00:01, 167.55it/s] 17%|█▋        | 53/306 [00:00<00:01, 173.14it/s] 24%|██▎       | 72/306 [00:00<00:01, 179.12it/s] 29%|██▉       | 90/306 [00:00<00:01, 170.20it/s] 35%|███▌      | 108/306 [00:00<00:01, 165.41it/s] 41%|████      | 125/306 [00:00<00:01, 160.72it/s] 46%|████▋     | 142/306 [00:00<00:01, 155.65it/s] 53%|█████▎    | 161/306 [00:00<00:00, 164.94it/s] 59%|█████▉    | 180/306 [00:01<00:00, 171.10it/s] 65%|██████▍   | 198/306 [00:01<00:00, 172.75it/s] 71%|███████   | 216/306 [00:01<00:00, 167.59it/s] 76%|███████▌  | 233/306 [00:01<00:00, 161.51it/s] 82%|████████▏ | 250/306 [00:01<00:00, 161.10it/s] 88%|████████▊ | 268/306 [00:01<00:00, 166.45it/s] 94%|█████████▍| 287/306 [00:01<00:00, 170.80it/s]100%|█████████▉| 305/306 [00:01<00:00, 168.36it/s]100%|██████████| 306/306 [00:01<00:00, 166.75it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:00, 536.44it/s]extract the null data:  21%|██        | 115/553 [00:00<00:00, 574.69it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 591.56it/s]extract the null data:  43%|████▎     | 237/553 [00:00<00:00, 593.59it/s]extract the null data:  54%|█████▎    | 297/553 [00:00<00:00, 587.58it/s]extract the null data:  65%|██████▍   | 358/553 [00:00<00:00, 591.75it/s]extract the null data:  76%|███████▌  | 418/553 [00:00<00:00, 587.08it/s]extract the null data:  86%|████████▋ | 477/553 [00:00<00:00, 581.08it/s]extract the null data:  97%|█████████▋| 536/553 [00:00<00:00, 582.38it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 583.37it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 195.80it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 201.69it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 202.22it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 206.84it/s]replace nan value:  19%|█▉        | 105/553 [00:00<00:02, 207.03it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 204.63it/s]replace nan value:  27%|██▋       | 147/553 [00:00<00:01, 204.88it/s]replace nan value:  30%|███       | 168/553 [00:00<00:01, 206.09it/s]replace nan value:  34%|███▍      | 189/553 [00:00<00:01, 206.82it/s]replace nan value:  38%|███▊      | 210/553 [00:01<00:01, 206.55it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 203.63it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 200.86it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 192.22it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 192.64it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 191.84it/s]replace nan value:  60%|██████    | 334/553 [00:01<00:01, 196.59it/s]replace nan value:  64%|██████▍   | 354/553 [00:01<00:01, 195.60it/s]replace nan value:  68%|██████▊   | 374/553 [00:01<00:00, 194.73it/s]replace nan value:  71%|███████   | 394/553 [00:01<00:00, 190.96it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 192.05it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 190.17it/s]replace nan value:  82%|████████▏ | 454/553 [00:02<00:00, 192.69it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 193.01it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 194.29it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 196.53it/s]replace nan value:  97%|█████████▋| 535/553 [00:02<00:00, 196.24it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 197.42it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 146.28it/s]  6%|▌         | 31/553 [00:00<00:03, 151.97it/s]  8%|▊         | 47/553 [00:00<00:03, 127.62it/s] 11%|█         | 61/553 [00:00<00:04, 122.47it/s] 14%|█▎        | 75/553 [00:00<00:03, 127.86it/s] 16%|█▋        | 90/553 [00:00<00:03, 134.18it/s] 19%|█▉        | 104/553 [00:00<00:03, 130.80it/s] 22%|██▏       | 121/553 [00:00<00:03, 140.16it/s] 25%|██▍       | 136/553 [00:01<00:02, 141.16it/s] 28%|██▊       | 154/553 [00:01<00:02, 151.89it/s] 31%|███       | 172/553 [00:01<00:02, 158.23it/s] 34%|███▍      | 188/553 [00:01<00:02, 153.68it/s] 37%|███▋      | 207/553 [00:01<00:02, 162.24it/s] 41%|████      | 224/553 [00:01<00:02, 152.42it/s] 43%|████▎     | 240/553 [00:01<00:02, 153.21it/s] 46%|████▋     | 256/553 [00:01<00:02, 145.75it/s] 49%|████▉     | 271/553 [00:01<00:01, 143.01it/s] 52%|█████▏    | 287/553 [00:01<00:01, 146.68it/s] 55%|█████▍    | 302/553 [00:02<00:01, 139.75it/s] 57%|█████▋    | 317/553 [00:02<00:01, 131.85it/s] 60%|█████▉    | 331/553 [00:02<00:01, 133.04it/s] 62%|██████▏   | 345/553 [00:02<00:01, 134.04it/s] 65%|██████▍   | 359/553 [00:02<00:01, 127.59it/s] 68%|██████▊   | 375/553 [00:02<00:01, 136.21it/s] 70%|███████   | 389/553 [00:02<00:01, 126.74it/s] 73%|███████▎  | 402/553 [00:02<00:01, 121.02it/s] 75%|███████▌  | 416/553 [00:03<00:01, 122.98it/s] 78%|███████▊  | 429/553 [00:03<00:01, 118.23it/s] 81%|████████  | 448/553 [00:03<00:00, 134.55it/s] 84%|████████▎ | 463/553 [00:03<00:00, 138.66it/s] 86%|████████▋ | 478/553 [00:03<00:00, 137.85it/s] 89%|████████▉ | 492/553 [00:03<00:00, 133.13it/s] 92%|█████████▏| 506/553 [00:03<00:00, 130.71it/s] 94%|█████████▍| 521/553 [00:03<00:00, 132.27it/s] 97%|█████████▋| 535/553 [00:03<00:00, 116.87it/s]100%|█████████▉| 551/553 [00:04<00:00, 107.98it/s]100%|██████████| 553/553 [00:04<00:00, 133.50it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 41/139 [00:00<00:00, 404.48it/s]extract the null data:  74%|███████▍  | 103/139 [00:00<00:00, 529.15it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 540.71it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 210.85it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 213.84it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 214.18it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 216.42it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 214.93it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 216.34it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 215.10it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 115.56it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.10it/s] 30%|███       | 42/139 [00:00<00:00, 139.78it/s] 40%|████      | 56/139 [00:00<00:00, 127.80it/s] 51%|█████     | 71/139 [00:00<00:00, 131.32it/s] 61%|██████    | 85/139 [00:00<00:00, 125.90it/s] 71%|███████   | 98/139 [00:00<00:00, 119.09it/s] 79%|███████▉  | 110/139 [00:00<00:00, 116.19it/s] 90%|████████▉ | 125/139 [00:00<00:00, 124.72it/s] 99%|█████████▉| 138/139 [00:01<00:00, 125.29it/s]100%|██████████| 139/139 [00:01<00:00, 125.42it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:   1%|          | 1/173 [00:00<00:34,  4.93it/s]extract the null data:  39%|███▊      | 67/173 [00:00<00:00, 274.48it/s]extract the null data:  76%|███████▌  | 131/173 [00:00<00:00, 408.48it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 364.51it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 206.94it/s]replace nan value:  25%|██▍       | 43/173 [00:00<00:00, 210.38it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 211.29it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 212.21it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 213.23it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 212.47it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 211.49it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 209.90it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 136.92it/s] 16%|█▌        | 28/173 [00:00<00:01, 119.38it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.42it/s] 34%|███▍      | 59/173 [00:00<00:00, 139.19it/s] 43%|████▎     | 74/173 [00:00<00:00, 140.87it/s] 51%|█████▏    | 89/173 [00:00<00:00, 139.14it/s] 60%|█████▉    | 103/173 [00:00<00:00, 135.12it/s] 68%|██████▊   | 118/173 [00:00<00:00, 133.80it/s] 76%|███████▋  | 132/173 [00:00<00:00, 128.40it/s] 84%|████████▍ | 145/173 [00:01<00:00, 128.06it/s] 91%|█████████▏| 158/173 [00:01<00:00, 119.88it/s] 99%|█████████▉| 171/173 [00:01<00:00, 89.46it/s] 100%|██████████| 173/173 [00:01<00:00, 117.39it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.598, valid acc : 0.644, train f1 : 0.482, valid f1 : 0.518
training process:   1%|          | 1/128 [01:45<3:44:12, 105.93s/it]Best score increase :0.000 -> 0.518
training process:   2%|▏         | 2/128 [03:27<3:36:55, 103.30s/it]Best score increase :0.518 -> 0.620
training process:   2%|▏         | 3/128 [04:59<3:24:32, 98.18s/it] Best score increase :0.620 -> 0.732
training process:   3%|▎         | 4/128 [06:25<3:13:01, 93.40s/it]Best score increase :0.732 -> 0.791
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.837, valid acc : 0.932, train f1 : 0.675, valid f1 : 0.796
training process:   4%|▍         | 5/128 [07:51<3:06:05, 90.77s/it]Best score increase :0.791 -> 0.796
training process:   5%|▍         | 6/128 [09:12<2:57:37, 87.35s/it]Best score increase :0.796 -> 0.797
training process:   5%|▌         | 7/128 [10:32<2:51:10, 84.88s/it]Best score increase :0.797 -> 0.806
training process:   6%|▋         | 8/128 [11:56<2:49:19, 84.66s/it]Best score increase :0.806 -> 0.809
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.893, valid acc : 0.947, train f1 : 0.745, valid f1 : 0.829
training process:   7%|▋         | 9/128 [13:28<2:52:20, 86.90s/it]Best score increase :0.809 -> 0.829
training process:   8%|▊         | 10/128 [14:49<2:47:45, 85.30s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [16:11<2:44:04, 84.14s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [17:32<2:41:08, 83.35s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.008, train acc : 0.907, valid acc : 0.948, train f1 : 0.768, valid f1 : 0.830
training process:  10%|█         | 13/128 [18:48<2:35:19, 81.04s/it]EarlyStopping counter : 4 out of 12
training process:  11%|█         | 14/128 [19:50<2:22:54, 75.21s/it]EarlyStopping counter : 5 out of 12
training process:  12%|█▏        | 15/128 [21:05<2:21:47, 75.28s/it]Best score increase :0.829 -> 0.839
training process:  12%|█▎        | 16/128 [22:23<2:21:53, 76.01s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.007, train acc : 0.924, valid acc : 0.946, train f1 : 0.797, valid f1 : 0.825
training process:  13%|█▎        | 17/128 [23:56<2:29:51, 81.01s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [25:14<2:27:14, 80.31s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [26:34<2:25:23, 80.04s/it]Best score increase :0.839 -> 0.846
training process:  16%|█▌        | 20/128 [27:50<2:22:02, 78.91s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.008, train acc : 0.930, valid acc : 0.953, train f1 : 0.808, valid f1 : 0.843
training process:  16%|█▋        | 21/128 [29:23<2:28:06, 83.05s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [30:38<2:22:37, 80.74s/it]Best score increase :0.846 -> 0.851
training process:  18%|█▊        | 23/128 [32:09<2:26:38, 83.80s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [33:31<2:24:22, 83.29s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.007, train acc : 0.933, valid acc : 0.955, train f1 : 0.813, valid f1 : 0.854
training process:  20%|█▉        | 25/128 [35:06<2:28:41, 86.61s/it]Best score increase :0.851 -> 0.854
training process:  20%|██        | 26/128 [36:34<2:28:08, 87.14s/it]Best score increase :0.854 -> 0.857
training process:  21%|██        | 27/128 [38:06<2:29:07, 88.59s/it]Best score increase :0.857 -> 0.858
training process:  22%|██▏       | 28/128 [39:09<2:15:08, 81.09s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.007, train acc : 0.940, valid acc : 0.956, train f1 : 0.827, valid f1 : 0.854
training process:  23%|██▎       | 29/128 [40:38<2:17:22, 83.26s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [42:09<2:20:00, 85.72s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [43:02<2:02:31, 75.79s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [44:00<1:53:01, 70.64s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.007, train acc : 0.940, valid acc : 0.954, train f1 : 0.831, valid f1 : 0.852
training process:  26%|██▌       | 33/128 [45:12<1:52:08, 70.83s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [46:11<1:45:25, 67.29s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [47:08<1:39:47, 64.38s/it]EarlyStopping counter : 8 out of 12
training process:  28%|██▊       | 36/128 [48:10<1:37:34, 63.64s/it]EarlyStopping counter : 9 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.008, train acc : 0.945, valid acc : 0.956, train f1 : 0.839, valid f1 : 0.855
training process:  29%|██▉       | 37/128 [49:24<1:41:09, 66.70s/it]EarlyStopping counter : 10 out of 12
training process:  30%|██▉       | 38/128 [50:25<1:37:13, 64.81s/it]EarlyStopping counter : 11 out of 12
training process:  30%|██▉       | 38/128 [51:25<2:01:47, 81.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 38, best f1 score : 0.858
training process finished, best loss : 0.006 and best acc : 0.954, best f1 : 0.858, best epoch : 26

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.68      0.76      0.72       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.83      0.87      0.85      7398
weighted avg       0.96      0.95      0.96      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.87, test loss : 0.402

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:44,  9.50s/it]processing for feature importance:  17%|█▋        | 2/12 [00:18<01:32,  9.24s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:19,  8.81s/it]processing for feature importance:  33%|███▎      | 4/12 [00:36<01:12,  9.01s/it]processing for feature importance:  42%|████▏     | 5/12 [00:45<01:04,  9.15s/it]processing for feature importance:  50%|█████     | 6/12 [00:54<00:55,  9.18s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:04<00:46,  9.36s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:13<00:36,  9.18s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:22<00:27,  9.08s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:30<00:17,  8.86s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:39<00:08,  8.75s/it]processing for feature importance: 100%|██████████| 12/12 [01:47<00:00,  8.76s/it]processing for feature importance: 100%|██████████| 12/12 [01:47<00:00,  8.99s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 24/306 [00:00<00:01, 235.24it/s] 17%|█▋        | 52/306 [00:00<00:00, 258.24it/s] 26%|██▌       | 80/306 [00:00<00:00, 265.38it/s] 35%|███▌      | 108/306 [00:00<00:00, 270.75it/s] 44%|████▍     | 136/306 [00:00<00:00, 273.87it/s] 54%|█████▍    | 165/306 [00:00<00:00, 276.97it/s] 63%|██████▎   | 193/306 [00:00<00:00, 269.83it/s] 72%|███████▏  | 221/306 [00:00<00:00, 258.03it/s] 81%|████████  | 248/306 [00:00<00:00, 260.36it/s] 91%|█████████ | 277/306 [00:01<00:00, 267.30it/s] 99%|█████████▉| 304/306 [00:01<00:00, 267.96it/s]100%|██████████| 306/306 [00:01<00:00, 266.35it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_RW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 62/553 [00:00<00:00, 614.61it/s]extract the null data:  23%|██▎       | 129/553 [00:00<00:00, 646.33it/s]extract the null data:  36%|███▌      | 198/553 [00:00<00:00, 664.20it/s]extract the null data:  48%|████▊     | 268/553 [00:00<00:00, 676.95it/s]extract the null data:  61%|██████    | 336/553 [00:00<00:00, 645.99it/s]extract the null data:  73%|███████▎  | 401/553 [00:00<00:00, 626.62it/s]extract the null data:  85%|████████▌ | 471/553 [00:00<00:00, 649.06it/s]extract the null data:  98%|█████████▊| 542/553 [00:00<00:00, 667.16it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 653.87it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 193.09it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 208.12it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:02, 220.25it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:01, 235.85it/s]replace nan value:  21%|██        | 117/553 [00:00<00:01, 236.54it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:01, 226.42it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:01, 226.70it/s]replace nan value:  34%|███▍      | 187/553 [00:00<00:01, 222.86it/s]replace nan value:  38%|███▊      | 210/553 [00:00<00:01, 218.95it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 215.68it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 213.77it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 214.75it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 219.85it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 217.17it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:00, 216.05it/s]replace nan value:  66%|██████▌   | 366/553 [00:01<00:00, 215.06it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 220.52it/s]replace nan value:  75%|███████▍  | 413/553 [00:01<00:00, 212.55it/s]replace nan value:  79%|███████▊  | 435/553 [00:01<00:00, 211.20it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 215.90it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 215.29it/s]replace nan value:  91%|█████████ | 502/553 [00:02<00:00, 212.63it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 208.61it/s]replace nan value:  99%|█████████▊| 545/553 [00:02<00:00, 206.10it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 215.73it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.43it/s]  5%|▌         | 29/553 [00:00<00:03, 143.60it/s]  8%|▊         | 44/553 [00:00<00:03, 135.10it/s] 10%|█         | 58/553 [00:00<00:03, 125.18it/s] 13%|█▎        | 71/553 [00:00<00:03, 122.89it/s] 16%|█▌        | 89/553 [00:00<00:03, 137.43it/s] 19%|█▊        | 103/553 [00:00<00:03, 134.43it/s] 22%|██▏       | 121/553 [00:00<00:02, 146.08it/s] 25%|██▍       | 137/553 [00:00<00:02, 149.77it/s] 28%|██▊       | 156/553 [00:01<00:02, 161.15it/s] 31%|███▏      | 173/553 [00:01<00:02, 162.71it/s] 34%|███▍      | 190/553 [00:01<00:02, 158.62it/s] 38%|███▊      | 209/553 [00:01<00:02, 167.23it/s] 41%|████      | 226/553 [00:01<00:02, 155.98it/s] 44%|████▍     | 242/553 [00:01<00:01, 156.19it/s] 47%|████▋     | 258/553 [00:01<00:01, 153.61it/s] 50%|████▉     | 274/553 [00:01<00:01, 150.07it/s] 52%|█████▏    | 290/553 [00:01<00:01, 152.73it/s] 55%|█████▌    | 306/553 [00:02<00:01, 137.85it/s] 58%|█████▊    | 321/553 [00:02<00:01, 138.12it/s] 61%|██████    | 337/553 [00:02<00:01, 141.71it/s] 64%|██████▎   | 352/553 [00:02<00:01, 143.09it/s] 66%|██████▋   | 367/553 [00:02<00:01, 137.54it/s] 69%|██████▉   | 384/553 [00:02<00:01, 143.91it/s] 72%|███████▏  | 399/553 [00:02<00:01, 124.38it/s] 75%|███████▌  | 415/553 [00:02<00:01, 132.95it/s] 78%|███████▊  | 429/553 [00:03<00:00, 125.25it/s] 81%|████████  | 449/553 [00:03<00:00, 143.64it/s] 84%|████████▍ | 465/553 [00:03<00:00, 146.58it/s] 87%|████████▋ | 481/553 [00:03<00:00, 144.42it/s] 90%|████████▉ | 496/553 [00:03<00:00, 136.05it/s] 93%|█████████▎| 512/553 [00:03<00:00, 142.24it/s] 95%|█████████▌| 527/553 [00:03<00:00, 126.00it/s] 98%|█████████▊| 541/553 [00:03<00:00, 129.14it/s]100%|██████████| 553/553 [00:03<00:00, 139.33it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 38/139 [00:00<00:00, 376.74it/s]extract the null data:  76%|███████▌  | 105/139 [00:00<00:00, 548.42it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 553.00it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 228.51it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 238.91it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 234.36it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 226.07it/s]replace nan value:  86%|████████▌ | 119/139 [00:00<00:00, 226.15it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 230.00it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 139.03it/s] 22%|██▏       | 30/139 [00:00<00:00, 150.27it/s] 35%|███▍      | 48/139 [00:00<00:00, 160.78it/s] 47%|████▋     | 65/139 [00:00<00:00, 158.80it/s] 58%|█████▊    | 81/139 [00:00<00:00, 154.05it/s] 70%|██████▉   | 97/139 [00:00<00:00, 143.68it/s] 81%|████████  | 112/139 [00:00<00:00, 143.06it/s] 93%|█████████▎| 129/139 [00:00<00:00, 149.87it/s]100%|██████████| 139/139 [00:00<00:00, 151.42it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 269.32it/s]extract the null data:  55%|█████▌    | 96/173 [00:00<00:00, 514.30it/s]extract the null data:  97%|█████████▋| 168/173 [00:00<00:00, 604.97it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 559.77it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 249.30it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 236.28it/s]replace nan value:  43%|████▎     | 74/173 [00:00<00:00, 222.07it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 229.74it/s]replace nan value:  71%|███████   | 123/173 [00:00<00:00, 233.10it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 231.07it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 224.56it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 228.34it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:01, 153.29it/s] 18%|█▊        | 32/173 [00:00<00:01, 134.19it/s] 29%|██▉       | 50/173 [00:00<00:00, 151.69it/s] 38%|███▊      | 66/173 [00:00<00:00, 145.36it/s] 47%|████▋     | 82/173 [00:00<00:00, 149.16it/s] 57%|█████▋    | 99/173 [00:00<00:00, 152.47it/s] 68%|██████▊   | 117/173 [00:00<00:00, 157.95it/s] 77%|███████▋  | 133/173 [00:00<00:00, 142.39it/s] 86%|████████▌ | 148/173 [00:01<00:00, 140.22it/s] 94%|█████████▍| 163/173 [00:01<00:00, 129.96it/s]100%|██████████| 173/173 [00:01<00:00, 128.49it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.011, train acc : 0.682, valid acc : 0.536, train f1 : 0.676, valid f1 : 0.455
training process:   1%|          | 1/128 [00:54<1:55:41, 54.65s/it]Best score increase :0.000 -> 0.455
training process:   2%|▏         | 2/128 [01:41<1:44:59, 49.99s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:27<1:40:52, 48.42s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:16<1:40:09, 48.46s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.003, valid loss : 0.015, train acc : 0.732, valid acc : 0.484, train f1 : 0.712, valid f1 : 0.424
training process:   4%|▍         | 5/128 [04:11<1:44:14, 50.85s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:00<1:42:25, 50.37s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [05:47<1:39:19, 49.25s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [06:35<1:37:25, 48.71s/it]Best score increase :0.455 -> 0.461
epoch : 9, train loss : 0.003, valid loss : 0.012, train acc : 0.764, valid acc : 0.565, train f1 : 0.752, valid f1 : 0.480
training process:   7%|▋         | 9/128 [07:31<1:40:57, 50.90s/it]Best score increase :0.461 -> 0.480
training process:   8%|▊         | 10/128 [08:19<1:38:20, 50.00s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:05<1:35:07, 48.78s/it]Best score increase :0.480 -> 0.498
training process:   9%|▉         | 12/128 [09:50<1:32:13, 47.71s/it]Best score increase :0.498 -> 0.515
epoch : 13, train loss : 0.002, valid loss : 0.012, train acc : 0.788, valid acc : 0.593, train f1 : 0.780, valid f1 : 0.500
training process:  10%|█         | 13/128 [10:45<1:35:42, 49.93s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [11:33<1:33:36, 49.27s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [12:43<1:44:50, 55.67s/it]Best score increase :0.515 -> 0.544
training process:  12%|█▎        | 16/128 [13:40<1:44:19, 55.88s/it]Best score increase :0.544 -> 0.552
epoch : 17, train loss : 0.002, valid loss : 0.011, train acc : 0.817, valid acc : 0.633, train f1 : 0.811, valid f1 : 0.528
training process:  13%|█▎        | 17/128 [14:44<1:48:03, 58.41s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [15:47<1:49:26, 59.70s/it]Best score increase :0.552 -> 0.558
training process:  15%|█▍        | 19/128 [16:49<1:49:45, 60.41s/it]Best score increase :0.558 -> 0.563
training process:  16%|█▌        | 20/128 [17:53<1:50:43, 61.52s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.011, train acc : 0.831, valid acc : 0.661, train f1 : 0.827, valid f1 : 0.549
training process:  16%|█▋        | 21/128 [19:06<1:55:52, 64.98s/it]EarlyStopping counter : 2 out of 12
training process:  17%|█▋        | 22/128 [20:05<1:51:44, 63.25s/it]Best score increase :0.563 -> 0.582
training process:  18%|█▊        | 23/128 [21:11<1:51:59, 63.99s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:12<1:49:37, 63.24s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.010, train acc : 0.843, valid acc : 0.695, train f1 : 0.839, valid f1 : 0.573
training process:  20%|█▉        | 25/128 [23:38<2:00:22, 70.13s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [24:43<1:56:12, 68.36s/it]Best score increase :0.582 -> 0.624
training process:  21%|██        | 27/128 [25:37<1:48:11, 64.27s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [26:32<1:42:09, 61.29s/it]Best score increase :0.624 -> 0.630
epoch : 29, train loss : 0.002, valid loss : 0.009, train acc : 0.854, valid acc : 0.727, train f1 : 0.851, valid f1 : 0.598
training process:  23%|██▎       | 29/128 [27:44<1:46:18, 64.43s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [29:00<1:51:18, 68.14s/it]Best score increase :0.630 -> 0.632
training process:  24%|██▍       | 31/128 [30:17<1:54:21, 70.73s/it]Best score increase :0.632 -> 0.641
training process:  25%|██▌       | 32/128 [31:34<1:56:13, 72.64s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.008, train acc : 0.870, valid acc : 0.778, train f1 : 0.868, valid f1 : 0.642
training process:  26%|██▌       | 33/128 [32:59<2:00:46, 76.28s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [34:16<1:59:51, 76.51s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [35:09<1:47:47, 69.55s/it]EarlyStopping counter : 4 out of 12
training process:  28%|██▊       | 36/128 [36:04<1:39:37, 64.98s/it]EarlyStopping counter : 5 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.008, train acc : 0.878, valid acc : 0.809, train f1 : 0.876, valid f1 : 0.669
training process:  29%|██▉       | 37/128 [37:07<1:37:57, 64.59s/it]Best score increase :0.641 -> 0.669
training process:  30%|██▉       | 38/128 [38:22<1:41:32, 67.69s/it]EarlyStopping counter : 1 out of 12
training process:  30%|███       | 39/128 [39:39<1:44:23, 70.38s/it]EarlyStopping counter : 2 out of 12
training process:  31%|███▏      | 40/128 [40:57<1:46:25, 72.57s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.008, train acc : 0.884, valid acc : 0.821, train f1 : 0.883, valid f1 : 0.682
training process:  32%|███▏      | 41/128 [42:21<1:50:12, 76.00s/it]Best score increase :0.669 -> 0.682
training process:  33%|███▎      | 42/128 [43:38<1:49:28, 76.38s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▎      | 43/128 [44:45<1:44:23, 73.69s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▍      | 44/128 [45:40<1:35:10, 67.98s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.001, valid loss : 0.008, train acc : 0.890, valid acc : 0.810, train f1 : 0.889, valid f1 : 0.671
training process:  35%|███▌      | 45/128 [46:47<1:33:42, 67.74s/it]EarlyStopping counter : 4 out of 12
training process:  36%|███▌      | 46/128 [47:47<1:29:16, 65.33s/it]Best score increase :0.682 -> 0.692
training process:  37%|███▋      | 47/128 [49:05<1:33:34, 69.31s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [50:21<1:35:02, 71.29s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.001, valid loss : 0.008, train acc : 0.893, valid acc : 0.810, train f1 : 0.892, valid f1 : 0.670
training process:  38%|███▊      | 49/128 [51:43<1:37:48, 74.28s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [52:59<1:37:13, 74.79s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [54:15<1:36:27, 75.16s/it]Best score increase :0.692 -> 0.699
training process:  41%|████      | 52/128 [55:14<1:29:12, 70.43s/it]Best score increase :0.699 -> 0.714
epoch : 53, train loss : 0.001, valid loss : 0.008, train acc : 0.906, valid acc : 0.825, train f1 : 0.905, valid f1 : 0.686
training process:  41%|████▏     | 53/128 [56:16<1:25:02, 68.04s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [57:07<1:17:19, 62.70s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [58:10<1:16:20, 62.75s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [59:24<1:19:27, 66.22s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.001, valid loss : 0.008, train acc : 0.906, valid acc : 0.832, train f1 : 0.906, valid f1 : 0.693
training process:  45%|████▍     | 57/128 [1:00:47<1:24:22, 71.31s/it]EarlyStopping counter : 5 out of 12
training process:  45%|████▌     | 58/128 [1:02:02<1:24:36, 72.52s/it]Best score increase :0.714 -> 0.721
training process:  46%|████▌     | 59/128 [1:03:18<1:24:36, 73.57s/it]Best score increase :0.721 -> 0.726
training process:  47%|████▋     | 60/128 [1:04:31<1:23:13, 73.43s/it]EarlyStopping counter : 1 out of 12
epoch : 61, train loss : 0.001, valid loss : 0.008, train acc : 0.906, valid acc : 0.840, train f1 : 0.906, valid f1 : 0.701
training process:  48%|████▊     | 61/128 [1:05:28<1:16:14, 68.28s/it]EarlyStopping counter : 2 out of 12
training process:  48%|████▊     | 62/128 [1:06:18<1:09:06, 62.83s/it]EarlyStopping counter : 3 out of 12
training process:  49%|████▉     | 63/128 [1:07:08<1:03:59, 59.07s/it]EarlyStopping counter : 4 out of 12
training process:  50%|█████     | 64/128 [1:08:06<1:02:46, 58.85s/it]Best score increase :0.726 -> 0.731
epoch : 65, train loss : 0.001, valid loss : 0.008, train acc : 0.914, valid acc : 0.838, train f1 : 0.913, valid f1 : 0.699
training process:  51%|█████     | 65/128 [1:09:12<1:03:54, 60.86s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:10:09<1:01:32, 59.55s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:11:03<58:51, 57.89s/it]  EarlyStopping counter : 3 out of 12
training process:  53%|█████▎    | 68/128 [1:12:03<58:39, 58.66s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.001, valid loss : 0.008, train acc : 0.919, valid acc : 0.843, train f1 : 0.918, valid f1 : 0.705
training process:  54%|█████▍    | 69/128 [1:13:13<1:00:59, 62.02s/it]EarlyStopping counter : 5 out of 12
training process:  55%|█████▍    | 70/128 [1:14:15<59:52, 61.94s/it]  EarlyStopping counter : 6 out of 12
training process:  55%|█████▌    | 71/128 [1:15:24<1:01:04, 64.29s/it]EarlyStopping counter : 7 out of 12
training process:  56%|█████▋    | 72/128 [1:16:24<58:43, 62.92s/it]  EarlyStopping counter : 8 out of 12
epoch : 73, train loss : 0.001, valid loss : 0.007, train acc : 0.914, valid acc : 0.862, train f1 : 0.914, valid f1 : 0.726
training process:  57%|█████▋    | 73/128 [1:17:54<1:05:11, 71.12s/it]EarlyStopping counter : 9 out of 12
training process:  58%|█████▊    | 74/128 [1:19:14<1:06:20, 73.71s/it]EarlyStopping counter : 10 out of 12
training process:  59%|█████▊    | 75/128 [1:20:20<1:03:06, 71.45s/it]EarlyStopping counter : 11 out of 12
training process:  59%|█████▊    | 75/128 [1:21:26<57:33, 65.16s/it]  
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 75, best f1 score : 0.731
training process finished, best loss : 0.007 and best acc : 0.866, best f1 : 0.731, best epoch : 63

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.38      0.93      0.54       580
           1       0.99      0.87      0.93      6818

    accuracy                           0.88      7398
   macro avg       0.69      0.90      0.73      7398
weighted avg       0.95      0.88      0.90      7398


# test acc : 0.88, test f1 : 0.73, test AUC : 0.90, test loss : 0.379

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:50, 10.03s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:42, 10.22s/it]processing for feature importance:  25%|██▌       | 3/12 [00:30<01:33, 10.39s/it]processing for feature importance:  33%|███▎      | 4/12 [00:41<01:22, 10.34s/it]processing for feature importance:  42%|████▏     | 5/12 [00:50<01:09,  9.89s/it]processing for feature importance:  50%|█████     | 6/12 [00:58<00:56,  9.38s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:07<00:46,  9.34s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:17<00:38,  9.56s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:27<00:28,  9.43s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:35<00:18,  9.24s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:44<00:09,  9.04s/it]processing for feature importance: 100%|██████████| 12/12 [01:52<00:00,  8.77s/it]processing for feature importance: 100%|██████████| 12/12 [01:52<00:00,  9.39s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 127.20it/s]  8%|▊         | 26/306 [00:00<00:02, 125.97it/s] 13%|█▎        | 39/306 [00:00<00:02, 123.58it/s] 18%|█▊        | 54/306 [00:00<00:01, 133.55it/s] 22%|██▏       | 68/306 [00:00<00:02, 117.12it/s] 26%|██▋       | 81/306 [00:00<00:02, 112.05it/s] 31%|███       | 94/306 [00:00<00:01, 115.87it/s] 35%|███▌      | 108/306 [00:00<00:01, 122.60it/s] 41%|████      | 126/306 [00:00<00:01, 137.87it/s] 46%|████▌     | 141/306 [00:01<00:01, 140.28it/s] 51%|█████▏    | 157/306 [00:01<00:01, 145.02it/s] 57%|█████▋    | 173/306 [00:01<00:00, 144.31it/s] 62%|██████▏   | 190/306 [00:01<00:00, 149.38it/s] 67%|██████▋   | 206/306 [00:01<00:00, 146.10it/s] 73%|███████▎  | 222/306 [00:01<00:00, 145.64it/s] 79%|███████▉  | 242/306 [00:01<00:00, 157.61it/s] 84%|████████▍ | 258/306 [00:01<00:00, 152.69it/s] 90%|████████▉ | 274/306 [00:02<00:00, 132.99it/s] 94%|█████████▍| 288/306 [00:02<00:00, 129.51it/s] 99%|█████████▉| 303/306 [00:02<00:00, 131.44it/s]100%|██████████| 306/306 [00:02<00:00, 134.70it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 554.15it/s]extract the null data:  20%|██        | 112/553 [00:00<00:00, 550.85it/s]extract the null data:  30%|███       | 168/553 [00:00<00:00, 547.44it/s]extract the null data:  40%|████      | 223/553 [00:00<00:00, 525.26it/s]extract the null data:  50%|████▉     | 276/553 [00:00<00:00, 519.51it/s]extract the null data:  59%|█████▉    | 329/553 [00:00<00:00, 520.48it/s]extract the null data:  69%|██████▉   | 384/553 [00:00<00:00, 527.78it/s]extract the null data:  79%|███████▉  | 437/553 [00:00<00:00, 527.43it/s]extract the null data:  89%|████████▊ | 490/553 [00:00<00:00, 524.44it/s]extract the null data:  98%|█████████▊| 543/553 [00:01<00:00, 519.83it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 526.88it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 145.46it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 167.96it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 173.93it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 174.48it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 173.47it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 176.16it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 177.37it/s]replace nan value:  26%|██▌       | 145/553 [00:00<00:02, 180.41it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:02, 168.29it/s]replace nan value:  33%|███▎      | 183/553 [00:01<00:02, 173.02it/s]replace nan value:  37%|███▋      | 202/553 [00:01<00:01, 175.89it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 167.70it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 170.32it/s]replace nan value:  46%|████▋     | 256/553 [00:01<00:01, 171.42it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:01, 174.82it/s]replace nan value:  53%|█████▎    | 293/553 [00:01<00:01, 174.32it/s]replace nan value:  56%|█████▌    | 311/553 [00:01<00:01, 174.82it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 176.12it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:01, 179.97it/s]replace nan value:  66%|██████▋   | 367/553 [00:02<00:01, 177.68it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 175.40it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 175.44it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 167.80it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 173.78it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 169.13it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 160.89it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 160.38it/s]replace nan value:  92%|█████████▏| 511/553 [00:02<00:00, 167.66it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 172.40it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 173.55it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 171.85it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.05it/s]  5%|▍         | 27/553 [00:00<00:03, 132.08it/s]  7%|▋         | 41/553 [00:00<00:04, 127.30it/s] 10%|▉         | 54/553 [00:00<00:04, 118.12it/s] 12%|█▏        | 66/553 [00:00<00:04, 111.06it/s] 14%|█▍        | 79/553 [00:00<00:04, 116.45it/s] 17%|█▋        | 93/553 [00:00<00:03, 120.42it/s] 20%|█▉        | 108/553 [00:00<00:03, 125.45it/s] 22%|██▏       | 122/553 [00:00<00:03, 129.66it/s] 25%|██▍       | 138/553 [00:01<00:03, 136.90it/s] 28%|██▊       | 154/553 [00:01<00:02, 142.25it/s] 31%|███       | 171/553 [00:01<00:02, 148.28it/s] 34%|███▎      | 186/553 [00:01<00:02, 142.67it/s] 37%|███▋      | 202/553 [00:01<00:02, 146.23it/s] 39%|███▉      | 217/553 [00:01<00:02, 146.10it/s] 42%|████▏     | 232/553 [00:01<00:02, 139.51it/s] 45%|████▍     | 247/553 [00:01<00:02, 140.91it/s] 48%|████▊     | 263/553 [00:01<00:02, 144.90it/s] 50%|█████     | 278/553 [00:02<00:02, 131.29it/s] 53%|█████▎    | 292/553 [00:02<00:02, 129.51it/s] 55%|█████▌    | 306/553 [00:02<00:02, 122.52it/s] 58%|█████▊    | 319/553 [00:02<00:01, 122.82it/s] 60%|██████    | 333/553 [00:02<00:01, 125.63it/s] 63%|██████▎   | 347/553 [00:02<00:01, 128.96it/s] 65%|██████▌   | 360/553 [00:02<00:01, 122.49it/s] 68%|██████▊   | 376/553 [00:02<00:01, 129.21it/s] 71%|███████   | 390/553 [00:03<00:01, 119.72it/s] 73%|███████▎  | 403/553 [00:03<00:01, 121.97it/s] 75%|███████▌  | 416/553 [00:03<00:01, 122.50it/s] 78%|███████▊  | 429/553 [00:03<00:01, 117.02it/s] 81%|████████  | 447/553 [00:03<00:00, 132.96it/s] 83%|████████▎ | 461/553 [00:03<00:00, 134.79it/s] 86%|████████▌ | 476/553 [00:03<00:00, 137.96it/s] 89%|████████▊ | 490/553 [00:03<00:00, 128.32it/s] 91%|█████████ | 504/553 [00:03<00:00, 125.22it/s] 94%|█████████▍| 519/553 [00:03<00:00, 130.70it/s] 96%|█████████▋| 533/553 [00:04<00:00, 112.53it/s] 99%|█████████▉| 549/553 [00:04<00:00, 124.19it/s]100%|██████████| 553/553 [00:04<00:00, 126.86it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 267.34it/s]extract the null data:  70%|██████▉   | 97/139 [00:00<00:00, 518.87it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 519.01it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 196.80it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 206.49it/s]replace nan value:  46%|████▌     | 64/139 [00:00<00:00, 209.15it/s]replace nan value:  61%|██████    | 85/139 [00:00<00:00, 207.92it/s]replace nan value:  76%|███████▋  | 106/139 [00:00<00:00, 190.22it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 181.73it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 191.92it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.55it/s] 20%|██        | 28/139 [00:00<00:00, 138.96it/s] 33%|███▎      | 46/139 [00:00<00:00, 151.95it/s] 45%|████▍     | 62/139 [00:00<00:00, 142.61it/s] 55%|█████▌    | 77/139 [00:00<00:00, 144.04it/s] 66%|██████▌   | 92/139 [00:00<00:00, 133.42it/s] 76%|███████▋  | 106/139 [00:00<00:00, 135.06it/s] 88%|████████▊ | 123/139 [00:00<00:00, 144.21it/s] 99%|█████████▉| 138/139 [00:00<00:00, 143.99it/s]100%|██████████| 139/139 [00:00<00:00, 141.55it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 355.43it/s]extract the null data:  59%|█████▉    | 102/173 [00:00<00:00, 533.03it/s]extract the null data:  98%|█████████▊| 170/173 [00:00<00:00, 596.12it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 561.77it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 231.14it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 223.83it/s]replace nan value:  41%|████      | 71/173 [00:00<00:00, 218.30it/s]replace nan value:  54%|█████▍    | 93/173 [00:00<00:00, 217.77it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 218.08it/s]replace nan value:  79%|███████▉  | 137/173 [00:00<00:00, 212.05it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 208.63it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 212.03it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.29it/s] 16%|█▌        | 28/173 [00:00<00:01, 119.91it/s] 24%|██▍       | 42/173 [00:00<00:01, 127.19it/s] 33%|███▎      | 57/173 [00:00<00:00, 135.13it/s] 41%|████      | 71/173 [00:00<00:00, 135.11it/s] 49%|████▉     | 85/173 [00:00<00:00, 135.30it/s] 57%|█████▋    | 99/173 [00:00<00:00, 133.97it/s] 66%|██████▌   | 114/173 [00:00<00:00, 138.77it/s] 74%|███████▍  | 128/173 [00:00<00:00, 132.30it/s] 83%|████████▎ | 143/173 [00:01<00:00, 136.67it/s] 91%|█████████ | 157/173 [00:01<00:00, 123.80it/s] 98%|█████████▊| 170/173 [00:01<00:00, 106.94it/s]100%|██████████| 173/173 [00:01<00:00, 121.09it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.008, train f1 : 0.589, valid f1 : 0.634
training process - Deferred Re-weighting:   1%|          | 1/128 [01:12<2:32:42, 72.15s/it]Best score increase :0.000 -> 0.634
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:13<2:17:50, 65.64s/it]Best score increase :0.634 -> 0.654
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:20<2:17:54, 66.19s/it]Best score increase :0.654 -> 0.692
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:18<2:10:35, 63.19s/it]Best score increase :0.692 -> 0.734
epoch : 5, train loss : 0.004, valid loss : 0.003, train f1 : 0.784, valid f1 : 0.758
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:41<2:24:18, 70.40s/it]Best score increase :0.734 -> 0.758
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:37<2:12:40, 65.25s/it]Best score increase :0.758 -> 0.784
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:30<2:03:43, 61.35s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:21<1:55:54, 57.95s/it]Best score increase :0.784 -> 0.798
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.822, valid f1 : 0.789
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:19<1:55:11, 58.08s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:13<1:51:59, 56.95s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:12<1:52:04, 57.48s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:11<1:51:50, 57.85s/it]Best score increase :0.798 -> 0.826
epoch : 13, train loss : 0.002, valid loss : 0.003, train f1 : 0.841, valid f1 : 0.784
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:18<1:56:16, 60.66s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:17<1:54:09, 60.08s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:19<1:54:25, 60.75s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:23<1:55:05, 61.66s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.003, train f1 : 0.855, valid f1 : 0.812
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [17:44<2:04:57, 67.55s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [18:46<2:00:51, 65.93s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:45<1:55:41, 63.68s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:46<1:53:35, 63.11s/it]EarlyStopping counter : 8 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train f1 : 0.868, valid f1 : 0.823
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [22:04<2:00:05, 67.34s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [23:14<2:00:46, 68.36s/it]Best score increase :0.826 -> 0.841
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [24:10<1:52:59, 64.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [25:08<1:48:22, 62.53s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.875, valid f1 : 0.841
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [26:25<1:55:03, 67.02s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [27:43<1:59:39, 70.39s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [29:03<2:02:59, 73.06s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [30:20<2:03:56, 74.37s/it]Best score increase :0.841 -> 0.844
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.876, valid f1 : 0.833
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [31:49<2:10:05, 78.84s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [33:07<2:08:19, 78.56s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [34:24<2:06:00, 77.95s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [35:42<2:04:53, 78.05s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.886, valid f1 : 0.844
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [37:16<2:11:06, 82.81s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [38:51<2:15:25, 86.44s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [40:18<2:14:03, 86.49s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [41:42<2:11:46, 85.94s/it]EarlyStopping counter : 8 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.890, valid f1 : 0.836
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [43:10<2:11:15, 86.54s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [44:28<2:05:51, 83.91s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [45:32<1:55:45, 78.04s/it]Best score increase :0.844 -> 0.850
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [46:46<1:52:40, 76.82s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.898, valid f1 : 0.856
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [48:09<1:53:53, 78.54s/it]Best score increase :0.850 -> 0.856
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [49:22<1:50:18, 76.96s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [50:36<1:47:29, 75.88s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [51:34<1:38:59, 70.71s/it]EarlyStopping counter : 3 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.904, valid f1 : 0.856
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [52:43<1:36:51, 70.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [53:41<1:30:58, 66.57s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [54:37<1:25:42, 63.49s/it]Best score increase :0.856 -> 0.861
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [55:52<1:29:09, 66.87s/it]Best score increase :0.861 -> 0.871
epoch : 49, train loss : 0.001, valid loss : 0.003, train f1 : 0.905, valid f1 : 0.861
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [57:08<1:31:44, 69.68s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [58:06<1:26:01, 66.18s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [59:06<1:22:35, 64.36s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [1:00:18<1:24:05, 66.39s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.001, valid loss : 0.003, train f1 : 0.907, valid f1 : 0.860
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [1:01:44<1:30:22, 72.31s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [1:03:00<1:30:40, 73.52s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:03:58<1:23:53, 68.96s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [1:05:13<1:24:49, 70.69s/it]EarlyStopping counter : 8 out of 12
epoch : 57, train loss : 0.001, valid loss : 0.003, train f1 : 0.913, valid f1 : 0.850
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [1:06:37<1:28:21, 74.67s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [1:07:49<1:26:16, 73.95s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:08:54<1:21:50, 71.17s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:09:52<1:21:43, 71.06s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 59, best f1 score : 0.871
training process finished, best loss : 0.002, best acc : 0.966, best f1 : 0.871, best epoch : 47

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.62      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.81      0.86      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.81, test loss : 0.155

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:33,  8.47s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:23,  8.36s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:16,  8.50s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:09,  8.67s/it]processing for feature importance:  42%|████▏     | 5/12 [00:41<00:57,  8.28s/it]processing for feature importance:  50%|█████     | 6/12 [00:49<00:48,  8.14s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:58<00:41,  8.27s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:05<00:32,  8.05s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:13<00:23,  7.86s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:20<00:15,  7.71s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:28<00:07,  7.62s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  7.89s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.05s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 117.13it/s]  8%|▊         | 26/306 [00:00<00:02, 128.51it/s] 14%|█▍        | 44/306 [00:00<00:01, 145.74it/s] 20%|█▉        | 61/306 [00:00<00:01, 151.11it/s] 26%|██▌       | 79/306 [00:00<00:01, 157.47it/s] 31%|███       | 95/306 [00:00<00:01, 153.37it/s] 36%|███▋      | 111/306 [00:00<00:01, 148.95it/s] 41%|████      | 126/306 [00:00<00:01, 144.76it/s] 46%|████▌     | 141/306 [00:00<00:01, 142.30it/s] 51%|█████▏    | 157/306 [00:01<00:01, 146.00it/s] 57%|█████▋    | 174/306 [00:01<00:00, 150.31it/s] 63%|██████▎   | 192/306 [00:01<00:00, 156.85it/s] 68%|██████▊   | 208/306 [00:01<00:00, 153.69it/s] 73%|███████▎  | 224/306 [00:01<00:00, 148.84it/s] 81%|████████  | 248/306 [00:01<00:00, 173.67it/s] 87%|████████▋ | 266/306 [00:01<00:00, 165.01it/s] 92%|█████████▏| 283/306 [00:01<00:00, 160.12it/s] 98%|█████████▊| 300/306 [00:01<00:00, 155.13it/s]100%|██████████| 306/306 [00:01<00:00, 153.47it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_DRW_seed_41
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▊         | 48/553 [00:00<00:01, 472.77it/s]extract the null data:  18%|█▊        | 98/553 [00:00<00:00, 484.30it/s]extract the null data:  27%|██▋       | 149/553 [00:00<00:00, 491.28it/s]extract the null data:  36%|███▋      | 201/553 [00:00<00:00, 498.98it/s]extract the null data:  46%|████▌     | 253/553 [00:00<00:00, 502.91it/s]extract the null data:  55%|█████▍    | 304/553 [00:00<00:00, 503.88it/s]extract the null data:  64%|██████▍   | 356/553 [00:00<00:00, 506.15it/s]extract the null data:  74%|███████▎  | 407/553 [00:00<00:00, 501.95it/s]extract the null data:  83%|████████▎ | 459/553 [00:00<00:00, 505.07it/s]extract the null data:  92%|█████████▏| 510/553 [00:01<00:00, 505.38it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 502.58it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 168.12it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.63it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 169.91it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 171.69it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 173.58it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 174.16it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 175.71it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 176.94it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:02, 174.67it/s]replace nan value:  32%|███▏      | 179/553 [00:01<00:02, 175.97it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 176.66it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 176.14it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 175.65it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 175.93it/s]replace nan value:  49%|████▊     | 269/553 [00:01<00:01, 175.92it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 177.80it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 177.42it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 177.74it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 177.72it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 176.62it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:00, 175.94it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 177.02it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 177.59it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 176.45it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 177.43it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 177.32it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 177.13it/s]replace nan value:  91%|█████████▏| 505/553 [00:02<00:00, 175.75it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 171.56it/s]replace nan value:  98%|█████████▊| 541/553 [00:03<00:00, 171.24it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 175.08it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 127.56it/s]  5%|▌         | 28/553 [00:00<00:03, 135.97it/s]  8%|▊         | 42/553 [00:00<00:03, 130.37it/s] 10%|█         | 56/553 [00:00<00:04, 121.05it/s] 12%|█▏        | 69/553 [00:00<00:04, 110.88it/s] 15%|█▌        | 84/553 [00:00<00:03, 120.44it/s] 18%|█▊        | 97/553 [00:00<00:03, 122.85it/s] 20%|██        | 112/553 [00:00<00:03, 129.60it/s] 23%|██▎       | 126/553 [00:01<00:03, 125.39it/s] 26%|██▌       | 144/553 [00:01<00:02, 138.88it/s] 29%|██▉       | 162/553 [00:01<00:02, 146.61it/s] 32%|███▏      | 178/553 [00:01<00:02, 147.50it/s] 35%|███▌      | 194/553 [00:01<00:02, 149.73it/s] 38%|███▊      | 211/553 [00:01<00:02, 153.42it/s] 41%|████      | 227/553 [00:01<00:02, 144.97it/s] 44%|████▍     | 242/553 [00:01<00:02, 142.71it/s] 46%|████▋     | 257/553 [00:01<00:02, 139.60it/s] 49%|████▉     | 272/553 [00:02<00:02, 134.75it/s] 52%|█████▏    | 287/553 [00:02<00:01, 138.14it/s] 54%|█████▍    | 301/553 [00:02<00:01, 131.04it/s] 57%|█████▋    | 315/553 [00:02<00:01, 125.61it/s] 59%|█████▉    | 328/553 [00:02<00:01, 125.42it/s] 62%|██████▏   | 343/553 [00:02<00:01, 130.31it/s] 65%|██████▍   | 357/553 [00:02<00:01, 123.64it/s] 67%|██████▋   | 372/553 [00:02<00:01, 130.51it/s] 70%|██████▉   | 386/553 [00:02<00:01, 123.23it/s] 72%|███████▏  | 399/553 [00:03<00:01, 113.33it/s] 75%|███████▌  | 415/553 [00:03<00:01, 120.95it/s] 77%|███████▋  | 428/553 [00:03<00:01, 112.46it/s] 80%|████████  | 445/553 [00:03<00:00, 126.57it/s] 83%|████████▎ | 460/553 [00:03<00:00, 132.04it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.11it/s] 88%|████████▊ | 488/553 [00:03<00:00, 128.01it/s] 91%|█████████ | 502/553 [00:03<00:00, 121.53it/s] 93%|█████████▎| 516/553 [00:03<00:00, 125.97it/s] 96%|█████████▌| 529/553 [00:04<00:00, 112.96it/s] 98%|█████████▊| 541/553 [00:04<00:00, 113.98it/s]100%|██████████| 553/553 [00:04<00:00, 99.74it/s] 100%|██████████| 553/553 [00:04<00:00, 126.32it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 295.63it/s]extract the null data:  65%|██████▍   | 90/139 [00:00<00:00, 470.61it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 481.86it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 195.32it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 196.93it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 196.00it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 195.94it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 195.57it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 195.65it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 195.60it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 108.43it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.07it/s] 27%|██▋       | 38/139 [00:00<00:00, 124.91it/s] 37%|███▋      | 51/139 [00:00<00:00, 120.88it/s] 46%|████▌     | 64/139 [00:00<00:00, 121.51it/s] 55%|█████▌    | 77/139 [00:00<00:00, 118.22it/s] 64%|██████▍   | 89/139 [00:00<00:00, 106.58it/s] 75%|███████▍  | 104/139 [00:00<00:00, 116.38it/s] 85%|████████▍ | 118/139 [00:00<00:00, 122.69it/s] 95%|█████████▍| 132/139 [00:01<00:00, 123.02it/s]100%|██████████| 139/139 [00:01<00:00, 121.85it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|██        | 35/173 [00:00<00:00, 349.77it/s]extract the null data:  54%|█████▍    | 94/173 [00:00<00:00, 490.28it/s]extract the null data:  88%|████████▊ | 152/173 [00:00<00:00, 529.54it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 509.15it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 191.35it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 192.92it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 194.79it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 192.55it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 192.89it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 193.14it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 193.91it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 193.63it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 192.81it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.68it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.82it/s] 23%|██▎       | 40/173 [00:00<00:01, 118.58it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.22it/s] 39%|███▉      | 68/173 [00:00<00:00, 127.12it/s] 47%|████▋     | 81/173 [00:00<00:00, 126.50it/s] 55%|█████▍    | 95/173 [00:00<00:00, 128.50it/s] 64%|██████▍   | 111/173 [00:00<00:00, 137.34it/s] 72%|███████▏  | 125/173 [00:00<00:00, 132.91it/s] 81%|████████  | 140/173 [00:01<00:00, 136.71it/s] 89%|████████▉ | 154/173 [00:01<00:00, 129.50it/s] 97%|█████████▋| 168/173 [00:01<00:00, 105.41it/s]100%|██████████| 173/173 [00:01<00:00, 118.06it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.009, train f1 : 0.698, valid f1 : 0.599
training process - Deferred Re-weighting:   1%|          | 1/128 [01:08<2:24:32, 68.29s/it]Best score increase :0.000 -> 0.599
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:11<2:16:45, 65.12s/it]Best score increase :0.599 -> 0.681
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:10<2:09:52, 62.34s/it]Best score increase :0.681 -> 0.766
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:12<2:08:35, 62.22s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.007, valid loss : 0.005, train f1 : 0.850, valid f1 : 0.766
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:25<2:15:38, 66.17s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:39<2:19:48, 68.76s/it]Best score increase :0.766 -> 0.790
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:37<2:11:48, 65.36s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:32<2:03:47, 61.89s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.006, valid loss : 0.005, train f1 : 0.877, valid f1 : 0.774
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:37<2:05:00, 63.03s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:47<2:08:04, 65.12s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [12:00<2:12:03, 67.72s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [13:12<2:13:03, 68.82s/it]Best score increase :0.790 -> 0.815
epoch : 13, train loss : 0.005, valid loss : 0.004, train f1 : 0.892, valid f1 : 0.793
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:30<2:17:06, 71.53s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [15:42<2:16:26, 71.81s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [16:54<2:15:29, 71.94s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:45<2:02:25, 65.59s/it]Best score increase :0.815 -> 0.818
epoch : 17, train loss : 0.004, valid loss : 0.004, train f1 : 0.909, valid f1 : 0.811
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:44<1:57:42, 63.62s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [19:39<1:52:00, 61.09s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [20:52<1:57:05, 64.46s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [22:06<2:01:30, 67.50s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.004, train f1 : 0.916, valid f1 : 0.792
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [23:30<2:08:52, 72.27s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [24:45<2:09:04, 73.06s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [25:59<2:08:48, 73.60s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [27:08<2:05:09, 72.20s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.004, train f1 : 0.921, valid f1 : 0.794
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [28:08<1:57:17, 68.32s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [28:57<1:46:26, 62.61s/it]Best score increase :0.818 -> 0.841
training process - Deferred Re-weighting:  21%|██        | 27/128 [29:48<1:39:29, 59.10s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [31:03<1:46:16, 63.77s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.003, valid loss : 0.003, train f1 : 0.930, valid f1 : 0.840
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [32:23<1:53:34, 68.83s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [33:37<1:55:06, 70.47s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [34:50<1:54:58, 71.12s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [36:05<1:55:31, 72.21s/it]EarlyStopping counter : 6 out of 12
epoch : 33, train loss : 0.003, valid loss : 0.004, train f1 : 0.933, valid f1 : 0.814
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [37:23<1:57:07, 73.97s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [38:17<1:46:22, 67.90s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [39:09<1:37:52, 63.15s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [39:58<1:30:33, 59.06s/it]EarlyStopping counter : 10 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.003, train f1 : 0.940, valid f1 : 0.853
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [41:11<1:35:58, 63.28s/it]Best score increase :0.841 -> 0.853
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [42:24<1:38:54, 65.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [43:38<1:41:28, 68.41s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [44:51<1:42:27, 69.86s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.003, train f1 : 0.942, valid f1 : 0.841
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [46:10<1:45:15, 72.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [47:22<1:43:48, 72.43s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [48:15<1:34:29, 66.70s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [49:05<1:26:20, 61.68s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.003, train f1 : 0.950, valid f1 : 0.834
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [50:09<1:26:16, 62.36s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [51:05<1:22:27, 60.33s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [52:18<1:26:29, 64.07s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [53:35<1:30:35, 67.94s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.003, valid loss : 0.003, train f1 : 0.951, valid f1 : 0.827
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [55:05<1:31:48, 68.86s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.853
training process finished, best loss : 0.003, best acc : 0.947, best f1 : 0.853, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.86      0.74       580
           1       0.99      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.82      0.91      0.86      7398
weighted avg       0.96      0.95      0.96      7398


# test acc : 0.95, test f1 : 0.86, test AUC : 0.91, test loss : 0.164

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:31,  8.34s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:25,  8.57s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:15,  8.38s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:08,  8.59s/it]processing for feature importance:  42%|████▏     | 5/12 [00:42<01:00,  8.64s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:52,  8.70s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:43,  8.70s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:09<00:34,  8.68s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:17<00:26,  8.77s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:26<00:17,  8.78s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:35<00:08,  8.86s/it]processing for feature importance: 100%|██████████| 12/12 [01:44<00:00,  8.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:44<00:00,  8.71s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 118.11it/s] 11%|█         | 33/306 [00:00<00:01, 167.62it/s] 17%|█▋        | 51/306 [00:00<00:01, 171.05it/s] 23%|██▎       | 71/306 [00:00<00:01, 179.94it/s] 30%|██▉       | 91/306 [00:00<00:01, 184.48it/s] 36%|███▋      | 111/306 [00:00<00:01, 186.46it/s] 43%|████▎     | 131/306 [00:00<00:00, 188.89it/s] 49%|████▉     | 150/306 [00:00<00:00, 189.18it/s] 56%|█████▌    | 170/306 [00:00<00:00, 190.13it/s] 62%|██████▏   | 190/306 [00:01<00:00, 188.67it/s] 69%|██████▊   | 210/306 [00:01<00:00, 190.59it/s] 75%|███████▌  | 230/306 [00:01<00:00, 192.99it/s] 82%|████████▏ | 250/306 [00:01<00:00, 194.74it/s] 88%|████████▊ | 270/306 [00:01<00:00, 195.35it/s] 95%|█████████▍| 290/306 [00:01<00:00, 194.87it/s]100%|██████████| 306/306 [00:01<00:00, 188.05it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 43/553 [00:00<00:01, 427.63it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 454.57it/s]extract the null data:  26%|██▌       | 142/553 [00:00<00:00, 478.65it/s]extract the null data:  35%|███▍      | 193/553 [00:00<00:00, 490.62it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:00, 505.26it/s]extract the null data:  54%|█████▍    | 298/553 [00:00<00:00, 496.94it/s]extract the null data:  63%|██████▎   | 348/553 [00:00<00:00, 494.38it/s]extract the null data:  72%|███████▏  | 398/553 [00:00<00:00, 489.47it/s]extract the null data:  81%|████████  | 447/553 [00:00<00:00, 481.50it/s]extract the null data:  90%|████████▉ | 496/553 [00:01<00:00, 475.85it/s]extract the null data:  98%|█████████▊| 544/553 [00:01<00:00, 447.17it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 470.63it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 152.56it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 157.23it/s]replace nan value:   9%|▉         | 49/553 [00:00<00:03, 157.47it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:03, 158.72it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:03, 151.78it/s]replace nan value:  18%|█▊        | 98/553 [00:00<00:02, 151.70it/s]replace nan value:  21%|██        | 115/553 [00:00<00:02, 154.59it/s]replace nan value:  24%|██▎       | 131/553 [00:00<00:02, 156.13it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:02, 159.79it/s]replace nan value:  30%|██▉       | 165/553 [00:01<00:02, 158.98it/s]replace nan value:  33%|███▎      | 181/553 [00:01<00:02, 152.90it/s]replace nan value:  36%|███▌      | 197/553 [00:01<00:02, 153.51it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:02, 156.24it/s]replace nan value:  42%|████▏     | 230/553 [00:01<00:02, 157.30it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 158.10it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 155.19it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 154.59it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 154.38it/s]replace nan value:  56%|█████▋    | 312/553 [00:02<00:01, 156.86it/s]replace nan value:  59%|█████▉    | 329/553 [00:02<00:01, 159.33it/s]replace nan value:  63%|██████▎   | 346/553 [00:02<00:01, 162.10it/s]replace nan value:  66%|██████▌   | 363/553 [00:02<00:01, 157.94it/s]replace nan value:  69%|██████▊   | 379/553 [00:02<00:01, 156.57it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 159.14it/s]replace nan value:  75%|███████▍  | 413/553 [00:02<00:00, 161.01it/s]replace nan value:  78%|███████▊  | 430/553 [00:02<00:00, 160.18it/s]replace nan value:  81%|████████  | 447/553 [00:02<00:00, 160.10it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 157.44it/s]replace nan value:  87%|████████▋ | 481/553 [00:03<00:00, 158.56it/s]replace nan value:  90%|████████▉ | 497/553 [00:03<00:00, 136.60it/s]replace nan value:  93%|█████████▎| 514/553 [00:03<00:00, 143.79it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 146.63it/s]replace nan value:  99%|█████████▊| 546/553 [00:03<00:00, 149.98it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 154.70it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.98it/s]  5%|▍         | 26/553 [00:00<00:04, 128.98it/s]  7%|▋         | 40/553 [00:00<00:04, 126.47it/s] 10%|▉         | 53/553 [00:00<00:04, 113.74it/s] 12%|█▏        | 65/553 [00:00<00:04, 106.08it/s] 14%|█▍        | 78/553 [00:00<00:04, 110.77it/s] 16%|█▋        | 91/553 [00:00<00:04, 115.06it/s] 19%|█▊        | 103/553 [00:00<00:03, 115.08it/s] 22%|██▏       | 119/553 [00:00<00:03, 126.33it/s] 24%|██▍       | 132/553 [00:01<00:03, 123.40it/s] 27%|██▋       | 149/553 [00:01<00:02, 136.28it/s] 30%|██▉       | 165/553 [00:01<00:02, 140.82it/s] 33%|███▎      | 180/553 [00:01<00:02, 140.64it/s] 35%|███▌      | 195/553 [00:01<00:02, 139.41it/s] 38%|███▊      | 211/553 [00:01<00:02, 143.17it/s] 41%|████      | 226/553 [00:01<00:02, 136.11it/s] 44%|████▎     | 241/553 [00:01<00:02, 137.96it/s] 46%|████▌     | 255/553 [00:02<00:02, 122.87it/s] 48%|████▊     | 268/553 [00:02<00:02, 123.78it/s] 51%|█████     | 281/553 [00:02<00:02, 91.68it/s]  53%|█████▎    | 292/553 [00:02<00:03, 86.80it/s] 55%|█████▍    | 304/553 [00:02<00:02, 94.07it/s] 57%|█████▋    | 315/553 [00:02<00:02, 95.99it/s] 59%|█████▉    | 328/553 [00:02<00:02, 102.18it/s] 62%|██████▏   | 342/553 [00:02<00:01, 110.45it/s] 64%|██████▍   | 354/553 [00:03<00:01, 110.88it/s] 66%|██████▌   | 366/553 [00:03<00:01, 111.12it/s] 69%|██████▊   | 380/553 [00:03<00:01, 117.50it/s] 71%|███████   | 392/553 [00:03<00:01, 104.44it/s] 73%|███████▎  | 403/553 [00:03<00:01, 104.63it/s] 75%|███████▌  | 415/553 [00:03<00:01, 108.54it/s] 77%|███████▋  | 427/553 [00:03<00:01, 102.24it/s] 80%|███████▉  | 442/553 [00:03<00:00, 113.83it/s] 83%|████████▎ | 457/553 [00:03<00:00, 123.34it/s] 85%|████████▌ | 471/553 [00:04<00:00, 125.91it/s] 88%|████████▊ | 484/553 [00:04<00:00, 125.16it/s] 90%|████████▉ | 497/553 [00:04<00:00, 111.61it/s] 92%|█████████▏| 511/553 [00:04<00:00, 117.27it/s] 95%|█████████▍| 524/553 [00:04<00:00, 108.02it/s] 97%|█████████▋| 536/553 [00:04<00:00, 101.73it/s]100%|█████████▉| 551/553 [00:04<00:00, 94.37it/s] 100%|██████████| 553/553 [00:04<00:00, 113.46it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:   4%|▎         | 5/139 [00:00<00:02, 49.24it/s]extract the null data:  37%|███▋      | 52/139 [00:00<00:00, 291.73it/s]extract the null data:  74%|███████▍  | 103/139 [00:00<00:00, 387.70it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 356.90it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 175.33it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 173.67it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 175.89it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 175.93it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 177.01it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 175.79it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 178.26it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 166.54it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  6%|▋         | 9/139 [00:00<00:01, 83.05it/s] 16%|█▌        | 22/139 [00:00<00:01, 107.56it/s] 27%|██▋       | 38/139 [00:00<00:00, 127.71it/s] 37%|███▋      | 51/139 [00:00<00:00, 127.53it/s] 47%|████▋     | 65/139 [00:00<00:00, 131.39it/s] 57%|█████▋    | 79/139 [00:00<00:00, 127.10it/s] 66%|██████▌   | 92/139 [00:00<00:00, 117.07it/s] 76%|███████▌  | 105/139 [00:00<00:00, 116.00it/s] 87%|████████▋ | 121/139 [00:00<00:00, 127.99it/s] 96%|█████████▋| 134/139 [00:01<00:00, 124.88it/s]100%|██████████| 139/139 [00:01<00:00, 123.88it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 22/173 [00:00<00:00, 214.26it/s]extract the null data:  38%|███▊      | 66/173 [00:00<00:00, 343.52it/s]extract the null data:  68%|██████▊   | 118/173 [00:00<00:00, 420.60it/s]extract the null data:  97%|█████████▋| 168/173 [00:00<00:00, 448.73it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 414.32it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 180.13it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 176.18it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 178.02it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 178.44it/s]replace nan value:  54%|█████▍    | 93/173 [00:00<00:00, 177.09it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 179.89it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 181.54it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 180.59it/s]replace nan value:  98%|█████████▊| 169/173 [00:00<00:00, 178.13it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 178.39it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 126.83it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.82it/s] 24%|██▎       | 41/173 [00:00<00:01, 122.55it/s] 33%|███▎      | 57/173 [00:00<00:00, 134.94it/s] 41%|████      | 71/173 [00:00<00:00, 125.90it/s] 49%|████▊     | 84/173 [00:00<00:00, 109.60it/s] 57%|█████▋    | 99/173 [00:00<00:00, 119.18it/s] 67%|██████▋   | 116/173 [00:00<00:00, 131.31it/s] 75%|███████▌  | 130/173 [00:01<00:00, 129.84it/s] 83%|████████▎ | 144/173 [00:01<00:00, 128.94it/s] 91%|█████████▏| 158/173 [00:01<00:00, 120.39it/s] 99%|█████████▉| 171/173 [00:01<00:00, 80.60it/s] 100%|██████████| 173/173 [00:01<00:00, 106.16it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.450, valid loss : 0.312, train acc : 0.911, valid acc : 0.923, train f1 : 0.578, valid f1 : 0.572
training process:   1%|          | 1/128 [01:12<2:34:00, 72.76s/it]Best score increase :0.000 -> 0.572
training process:   2%|▏         | 2/128 [02:12<2:17:01, 65.25s/it]Best score increase :0.572 -> 0.678
training process:   2%|▏         | 3/128 [03:11<2:10:03, 62.43s/it]Best score increase :0.678 -> 0.712
training process:   3%|▎         | 4/128 [04:09<2:05:01, 60.50s/it]Best score increase :0.712 -> 0.762
epoch : 5, train loss : 0.171, valid loss : 0.157, train acc : 0.952, valid acc : 0.948, train f1 : 0.794, valid f1 : 0.769
training process:   4%|▍         | 5/128 [05:20<2:12:07, 64.45s/it]Best score increase :0.762 -> 0.769
training process:   5%|▍         | 6/128 [06:19<2:07:21, 62.64s/it]Best score increase :0.769 -> 0.799
training process:   5%|▌         | 7/128 [07:18<2:03:24, 61.20s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [08:17<2:00:53, 60.45s/it]Best score increase :0.799 -> 0.801
epoch : 9, train loss : 0.132, valid loss : 0.138, train acc : 0.959, valid acc : 0.954, train f1 : 0.833, valid f1 : 0.811
training process:   7%|▋         | 9/128 [09:26<2:05:17, 63.17s/it]Best score increase :0.801 -> 0.811
training process:   8%|▊         | 10/128 [10:23<2:00:41, 61.37s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [11:23<1:58:39, 60.85s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [12:21<1:55:52, 59.93s/it]Best score increase :0.811 -> 0.823
epoch : 13, train loss : 0.119, valid loss : 0.154, train acc : 0.962, valid acc : 0.953, train f1 : 0.849, valid f1 : 0.802
training process:  10%|█         | 13/128 [13:27<1:58:49, 62.00s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [14:27<1:56:30, 61.32s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [15:24<1:53:12, 60.11s/it]Best score increase :0.823 -> 0.835
training process:  12%|█▎        | 16/128 [16:24<1:51:45, 59.87s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.111, valid loss : 0.135, train acc : 0.964, valid acc : 0.959, train f1 : 0.856, valid f1 : 0.834
training process:  13%|█▎        | 17/128 [17:37<1:58:04, 63.83s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [18:36<1:54:29, 62.45s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [19:35<1:51:26, 61.34s/it]EarlyStopping counter : 4 out of 12
training process:  16%|█▌        | 20/128 [20:36<1:50:11, 61.22s/it]Best score increase :0.835 -> 0.842
epoch : 21, train loss : 0.106, valid loss : 0.135, train acc : 0.965, valid acc : 0.961, train f1 : 0.865, valid f1 : 0.845
training process:  16%|█▋        | 21/128 [21:46<1:54:07, 63.99s/it]Best score increase :0.842 -> 0.845
training process:  17%|█▋        | 22/128 [22:46<1:50:48, 62.73s/it]Best score increase :0.845 -> 0.851
training process:  18%|█▊        | 23/128 [23:46<1:48:38, 62.09s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [24:47<1:46:54, 61.68s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.102, valid loss : 0.147, train acc : 0.967, valid acc : 0.960, train f1 : 0.871, valid f1 : 0.837
training process:  20%|█▉        | 25/128 [26:02<1:52:32, 65.56s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [27:25<2:00:19, 70.78s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [28:51<2:07:03, 75.48s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [30:16<2:10:20, 78.20s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.096, valid loss : 0.154, train acc : 0.969, valid acc : 0.959, train f1 : 0.879, valid f1 : 0.835
training process:  23%|██▎       | 29/128 [31:30<2:07:06, 77.04s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [32:22<1:53:42, 69.61s/it]EarlyStopping counter : 8 out of 12
training process:  24%|██▍       | 31/128 [33:13<1:43:31, 64.04s/it]EarlyStopping counter : 9 out of 12
training process:  25%|██▌       | 32/128 [34:31<1:48:53, 68.06s/it]EarlyStopping counter : 10 out of 12
epoch : 33, train loss : 0.092, valid loss : 0.138, train acc : 0.970, valid acc : 0.963, train f1 : 0.884, valid f1 : 0.854
training process:  26%|██▌       | 33/128 [36:03<1:59:09, 75.26s/it]Best score increase :0.851 -> 0.854
training process:  27%|██▋       | 34/128 [37:26<2:01:35, 77.61s/it]Best score increase :0.854 -> 0.856
training process:  27%|██▋       | 35/128 [38:53<2:04:51, 80.56s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [39:46<1:50:29, 72.06s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.090, valid loss : 0.155, train acc : 0.971, valid acc : 0.961, train f1 : 0.889, valid f1 : 0.841
training process:  29%|██▉       | 37/128 [40:44<1:42:54, 67.86s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [41:36<1:34:56, 63.29s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [42:58<1:41:51, 68.66s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [44:20<1:46:51, 72.86s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.091, valid loss : 0.150, train acc : 0.970, valid acc : 0.962, train f1 : 0.886, valid f1 : 0.849
training process:  32%|███▏      | 41/128 [45:52<1:53:45, 78.46s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [47:10<1:52:17, 78.34s/it]Best score increase :0.856 -> 0.860
training process:  34%|███▎      | 43/128 [48:00<1:38:52, 69.80s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [48:51<1:29:52, 64.20s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.087, valid loss : 0.141, train acc : 0.972, valid acc : 0.962, train f1 : 0.893, valid f1 : 0.856
training process:  35%|███▌      | 45/128 [49:57<1:29:38, 64.80s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [51:19<1:35:30, 69.88s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [52:37<1:37:52, 72.51s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [53:56<1:39:05, 74.32s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.084, valid loss : 0.146, train acc : 0.972, valid acc : 0.963, train f1 : 0.896, valid f1 : 0.857
training process:  38%|███▊      | 49/128 [55:13<1:38:53, 75.11s/it]EarlyStopping counter : 7 out of 12
training process:  39%|███▉      | 50/128 [56:03<1:27:56, 67.65s/it]Best score increase :0.860 -> 0.870
training process:  40%|███▉      | 51/128 [56:50<1:18:59, 61.56s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [57:55<1:19:02, 62.41s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.083, valid loss : 0.150, train acc : 0.973, valid acc : 0.964, train f1 : 0.896, valid f1 : 0.862
training process:  41%|████▏     | 53/128 [59:24<1:28:02, 70.44s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [1:00:43<1:29:52, 72.87s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [1:02:03<1:31:28, 75.19s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [1:03:01<1:24:01, 70.02s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.080, valid loss : 0.145, train acc : 0.974, valid acc : 0.964, train f1 : 0.901, valid f1 : 0.860
training process:  45%|████▍     | 57/128 [1:03:57<1:17:40, 65.64s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [1:04:47<1:11:11, 61.02s/it]EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [1:06:03<1:15:35, 65.73s/it]EarlyStopping counter : 9 out of 12
training process:  47%|████▋     | 60/128 [1:07:26<1:20:04, 70.66s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.081, valid loss : 0.151, train acc : 0.973, valid acc : 0.962, train f1 : 0.899, valid f1 : 0.854
training process:  48%|████▊     | 61/128 [1:08:56<1:25:29, 76.55s/it]EarlyStopping counter : 11 out of 12
training process:  48%|████▊     | 61/128 [1:10:20<1:17:16, 69.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.870
training process finished, best loss : 0.130 and best acc : 0.965, best f1 : 0.870, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.66      0.77       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.83      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.83, test loss : 8.443

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.07s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.96s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.69s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.85s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.76s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.77s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.83s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.95s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.80s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:18<00:15,  7.80s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.72s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.80s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:02, 134.33it/s]  9%|▉         | 29/306 [00:00<00:02, 115.71it/s] 13%|█▎        | 41/306 [00:00<00:02, 111.23it/s] 18%|█▊        | 56/306 [00:00<00:02, 122.12it/s] 23%|██▎       | 69/306 [00:00<00:02, 114.73it/s] 26%|██▋       | 81/306 [00:00<00:01, 115.03it/s] 30%|███       | 93/306 [00:00<00:01, 114.87it/s] 34%|███▍      | 105/306 [00:00<00:01, 108.04it/s] 39%|███▉      | 120/306 [00:01<00:01, 118.88it/s] 43%|████▎     | 133/306 [00:01<00:01, 115.11it/s] 47%|████▋     | 145/306 [00:01<00:01, 104.56it/s] 52%|█████▏    | 159/306 [00:01<00:01, 112.47it/s] 56%|█████▌    | 171/306 [00:01<00:01, 112.84it/s] 60%|█████▉    | 183/306 [00:01<00:01, 110.66it/s] 64%|██████▎   | 195/306 [00:01<00:00, 112.26it/s] 68%|██████▊   | 207/306 [00:01<00:00, 109.75it/s] 72%|███████▏  | 221/306 [00:01<00:00, 116.79it/s] 76%|███████▌  | 233/306 [00:02<00:00, 115.16it/s] 80%|████████  | 245/306 [00:02<00:00, 102.05it/s] 85%|████████▍ | 260/306 [00:02<00:00, 111.26it/s] 89%|████████▉ | 272/306 [00:02<00:00, 112.27it/s] 93%|█████████▎| 284/306 [00:02<00:00, 109.89it/s] 97%|█████████▋| 296/306 [00:02<00:00, 112.34it/s]100%|██████████| 306/306 [00:02<00:00, 112.67it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 43/553 [00:00<00:01, 421.50it/s]extract the null data:  16%|█▌        | 86/553 [00:00<00:01, 419.56it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:00, 434.09it/s]extract the null data:  32%|███▏      | 177/553 [00:00<00:00, 439.22it/s]extract the null data:  40%|███▉      | 221/553 [00:00<00:00, 434.88it/s]extract the null data:  48%|████▊     | 266/553 [00:00<00:00, 436.78it/s]extract the null data:  56%|█████▌    | 311/553 [00:00<00:00, 437.95it/s]extract the null data:  64%|██████▍   | 355/553 [00:00<00:00, 432.91it/s]extract the null data:  72%|███████▏  | 399/553 [00:00<00:00, 430.72it/s]extract the null data:  80%|████████  | 445/553 [00:01<00:00, 438.88it/s]extract the null data:  89%|████████▉ | 491/553 [00:01<00:00, 442.61it/s]extract the null data:  97%|█████████▋| 539/553 [00:01<00:00, 451.93it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 439.61it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 167.13it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.04it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 170.45it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 168.02it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 168.33it/s]replace nan value:  19%|█▉        | 106/553 [00:00<00:02, 170.95it/s]replace nan value:  22%|██▏       | 124/553 [00:00<00:02, 170.23it/s]replace nan value:  26%|██▌       | 142/553 [00:00<00:02, 168.81it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 170.32it/s]replace nan value:  32%|███▏      | 178/553 [00:01<00:02, 169.56it/s]replace nan value:  35%|███▌      | 196/553 [00:01<00:02, 171.21it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 171.97it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 170.11it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 170.86it/s]replace nan value:  48%|████▊     | 268/553 [00:01<00:01, 170.85it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 169.99it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 170.45it/s]replace nan value:  58%|█████▊    | 322/553 [00:01<00:01, 170.42it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 171.18it/s]replace nan value:  65%|██████▍   | 358/553 [00:02<00:01, 171.93it/s]replace nan value:  68%|██████▊   | 376/553 [00:02<00:01, 170.90it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:00, 168.25it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 168.46it/s]replace nan value:  77%|███████▋  | 428/553 [00:02<00:00, 166.38it/s]replace nan value:  81%|████████  | 446/553 [00:02<00:00, 167.60it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 169.16it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 169.00it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 169.19it/s]replace nan value:  93%|█████████▎| 516/553 [00:03<00:00, 170.26it/s]replace nan value:  97%|█████████▋| 534/553 [00:03<00:00, 168.95it/s]replace nan value: 100%|█████████▉| 552/553 [00:03<00:00, 169.53it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 169.71it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 125.79it/s]  5%|▍         | 27/553 [00:00<00:04, 130.62it/s]  7%|▋         | 41/553 [00:00<00:03, 129.27it/s] 10%|▉         | 54/553 [00:00<00:04, 117.65it/s] 12%|█▏        | 66/553 [00:00<00:04, 109.51it/s] 14%|█▍        | 79/553 [00:00<00:04, 114.17it/s] 17%|█▋        | 93/553 [00:00<00:03, 116.94it/s] 19%|█▉        | 107/553 [00:00<00:03, 123.32it/s] 22%|██▏       | 122/553 [00:01<00:03, 125.25it/s] 25%|██▍       | 137/553 [00:01<00:03, 130.39it/s] 28%|██▊       | 153/553 [00:01<00:02, 137.53it/s] 31%|███       | 169/553 [00:01<00:02, 142.75it/s] 33%|███▎      | 184/553 [00:01<00:02, 138.48it/s] 36%|███▌      | 200/553 [00:01<00:02, 142.87it/s] 39%|███▉      | 215/553 [00:01<00:02, 143.03it/s] 42%|████▏     | 230/553 [00:01<00:02, 133.09it/s] 44%|████▍     | 244/553 [00:01<00:02, 133.02it/s] 47%|████▋     | 259/553 [00:01<00:02, 136.38it/s] 49%|████▉     | 273/553 [00:02<00:02, 130.50it/s] 52%|█████▏    | 288/553 [00:02<00:01, 134.91it/s] 55%|█████▍    | 302/553 [00:02<00:01, 127.22it/s] 57%|█████▋    | 315/553 [00:02<00:01, 121.81it/s] 59%|█████▉    | 328/553 [00:02<00:01, 121.22it/s] 62%|██████▏   | 342/553 [00:02<00:01, 125.79it/s] 64%|██████▍   | 355/553 [00:02<00:01, 121.78it/s] 67%|██████▋   | 369/553 [00:02<00:01, 125.67it/s] 69%|██████▉   | 382/553 [00:02<00:01, 126.30it/s] 71%|███████▏  | 395/553 [00:03<00:01, 113.42it/s] 74%|███████▍  | 408/553 [00:03<00:01, 116.89it/s] 76%|███████▌  | 420/553 [00:03<00:01, 113.18it/s] 78%|███████▊  | 432/553 [00:03<00:01, 111.47it/s] 81%|████████  | 449/553 [00:03<00:00, 126.30it/s] 84%|████████▍ | 464/553 [00:03<00:00, 129.68it/s] 86%|████████▋ | 478/553 [00:03<00:00, 128.61it/s] 89%|████████▉ | 491/553 [00:03<00:00, 121.31it/s] 91%|█████████ | 504/553 [00:04<00:00, 119.26it/s] 94%|█████████▍| 519/553 [00:04<00:00, 123.95it/s] 96%|█████████▌| 532/553 [00:04<00:00, 105.27it/s] 99%|█████████▉| 548/553 [00:04<00:00, 117.00it/s]100%|██████████| 553/553 [00:04<00:00, 122.54it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 269.72it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 420.86it/s]extract the null data:  96%|█████████▋| 134/139 [00:00<00:00, 472.75it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 446.55it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 188.37it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 187.17it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 188.25it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 188.50it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 187.71it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 186.03it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 187.79it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 187.77it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 104.07it/s] 17%|█▋        | 24/139 [00:00<00:00, 116.14it/s] 27%|██▋       | 38/139 [00:00<00:00, 123.51it/s] 37%|███▋      | 51/139 [00:00<00:00, 119.26it/s] 45%|████▌     | 63/139 [00:00<00:00, 118.94it/s] 54%|█████▍    | 75/139 [00:00<00:00, 117.59it/s] 63%|██████▎   | 87/139 [00:00<00:00, 107.97it/s] 71%|███████   | 99/139 [00:00<00:00, 108.46it/s] 79%|███████▉  | 110/139 [00:00<00:00, 107.30it/s] 90%|████████▉ | 125/139 [00:01<00:00, 116.78it/s] 99%|█████████▊| 137/139 [00:01<00:00, 116.34it/s]100%|██████████| 139/139 [00:01<00:00, 115.09it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  11%|█         | 19/173 [00:00<00:00, 189.85it/s]extract the null data:  42%|████▏     | 73/173 [00:00<00:00, 392.94it/s]extract the null data:  73%|███████▎  | 127/173 [00:00<00:00, 455.83it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 438.28it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 190.28it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 188.29it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 187.75it/s]replace nan value:  46%|████▌     | 79/173 [00:00<00:00, 191.29it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 190.18it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 188.58it/s]replace nan value:  80%|███████▉  | 138/173 [00:00<00:00, 188.35it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 186.77it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 186.81it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 126.07it/s] 16%|█▌        | 27/173 [00:00<00:01, 109.11it/s] 24%|██▎       | 41/173 [00:00<00:01, 119.89it/s] 32%|███▏      | 55/173 [00:00<00:00, 125.26it/s] 39%|███▉      | 68/173 [00:00<00:00, 124.23it/s] 47%|████▋     | 81/173 [00:00<00:00, 124.27it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.21it/s] 62%|██████▏   | 107/173 [00:00<00:00, 123.19it/s] 69%|██████▉   | 120/173 [00:00<00:00, 122.74it/s] 77%|███████▋  | 133/173 [00:01<00:00, 116.07it/s] 84%|████████▍ | 146/173 [00:01<00:00, 117.46it/s] 91%|█████████▏| 158/173 [00:01<00:00, 109.42it/s] 98%|█████████▊| 170/173 [00:01<00:00, 89.54it/s] 100%|██████████| 173/173 [00:01<00:00, 107.53it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.556, valid loss : 0.368, train acc : 0.709, valid acc : 0.846, train f1 : 0.708, valid f1 : 0.668
training process:   1%|          | 1/128 [01:41<3:35:12, 101.68s/it]Best score increase :0.000 -> 0.668
training process:   2%|▏         | 2/128 [02:53<2:56:30, 84.05s/it] Best score increase :0.668 -> 0.715
training process:   2%|▏         | 3/128 [03:46<2:25:40, 69.93s/it]Best score increase :0.715 -> 0.762
training process:   3%|▎         | 4/128 [04:37<2:08:53, 62.37s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.322, valid loss : 0.297, train acc : 0.857, valid acc : 0.881, train f1 : 0.857, valid f1 : 0.740
training process:   4%|▍         | 5/128 [05:59<2:22:28, 69.50s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [07:33<2:38:10, 77.79s/it]Best score increase :0.762 -> 0.768
training process:   5%|▌         | 7/128 [09:03<2:44:45, 81.70s/it]Best score increase :0.768 -> 0.784
training process:   6%|▋         | 8/128 [10:32<2:48:29, 84.25s/it]Best score increase :0.784 -> 0.797
epoch : 9, train loss : 0.274, valid loss : 0.299, train acc : 0.882, valid acc : 0.874, train f1 : 0.882, valid f1 : 0.735
training process:   7%|▋         | 9/128 [11:33<2:32:21, 76.82s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [12:25<2:16:04, 69.19s/it]Best score increase :0.797 -> 0.804
training process:   9%|▊         | 11/128 [13:32<2:13:26, 68.43s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [15:01<2:24:32, 74.76s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.255, valid loss : 0.194, train acc : 0.892, valid acc : 0.930, train f1 : 0.892, valid f1 : 0.815
training process:  10%|█         | 13/128 [16:42<2:38:50, 82.87s/it]Best score increase :0.804 -> 0.815
training process:  11%|█         | 14/128 [18:14<2:42:33, 85.55s/it]Best score increase :0.815 -> 0.835
training process:  12%|█▏        | 15/128 [19:07<2:22:30, 75.66s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [19:59<2:08:03, 68.60s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.230, valid loss : 0.203, train acc : 0.902, valid acc : 0.920, train f1 : 0.902, valid f1 : 0.800
training process:  13%|█▎        | 17/128 [20:56<2:00:17, 65.02s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [22:26<2:13:05, 72.59s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [23:56<2:21:10, 77.71s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [25:26<2:26:56, 81.63s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.214, valid loss : 0.200, train acc : 0.910, valid acc : 0.926, train f1 : 0.910, valid f1 : 0.813
training process:  16%|█▋        | 21/128 [26:47<2:25:08, 81.39s/it]EarlyStopping counter : 7 out of 12
training process:  17%|█▋        | 22/128 [27:36<2:06:30, 71.61s/it]EarlyStopping counter : 8 out of 12
training process:  18%|█▊        | 23/128 [28:21<1:51:26, 63.68s/it]EarlyStopping counter : 9 out of 12
training process:  19%|█▉        | 24/128 [29:29<1:52:16, 64.78s/it]EarlyStopping counter : 10 out of 12
epoch : 25, train loss : 0.202, valid loss : 0.162, train acc : 0.917, valid acc : 0.942, train f1 : 0.917, valid f1 : 0.842
training process:  20%|█▉        | 25/128 [31:03<2:06:39, 73.79s/it]Best score increase :0.835 -> 0.842
training process:  20%|██        | 26/128 [32:29<2:11:39, 77.45s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [33:59<2:16:25, 81.04s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [34:47<1:58:33, 71.13s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.190, valid loss : 0.166, train acc : 0.922, valid acc : 0.940, train f1 : 0.922, valid f1 : 0.838
training process:  23%|██▎       | 29/128 [35:40<1:48:20, 65.66s/it]EarlyStopping counter : 4 out of 12
training process:  23%|██▎       | 30/128 [36:29<1:39:22, 60.85s/it]EarlyStopping counter : 5 out of 12
training process:  24%|██▍       | 31/128 [37:56<1:50:45, 68.51s/it]EarlyStopping counter : 6 out of 12
training process:  25%|██▌       | 32/128 [39:27<2:00:21, 75.23s/it]Best score increase :0.842 -> 0.856
epoch : 33, train loss : 0.176, valid loss : 0.160, train acc : 0.930, valid acc : 0.944, train f1 : 0.930, valid f1 : 0.847
training process:  26%|██▌       | 33/128 [41:06<2:10:33, 82.46s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [42:16<2:03:27, 78.80s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [43:08<1:49:23, 70.58s/it]EarlyStopping counter : 3 out of 12
training process:  28%|██▊       | 36/128 [43:59<1:39:23, 64.82s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.173, valid loss : 0.181, train acc : 0.931, valid acc : 0.928, train f1 : 0.931, valid f1 : 0.818
training process:  29%|██▉       | 37/128 [45:20<1:45:44, 69.72s/it]EarlyStopping counter : 5 out of 12
training process:  30%|██▉       | 38/128 [46:53<1:54:48, 76.54s/it]EarlyStopping counter : 6 out of 12
training process:  30%|███       | 39/128 [48:21<1:59:00, 80.23s/it]EarlyStopping counter : 7 out of 12
training process:  31%|███▏      | 40/128 [49:50<2:01:34, 82.89s/it]EarlyStopping counter : 8 out of 12
epoch : 41, train loss : 0.165, valid loss : 0.161, train acc : 0.935, valid acc : 0.937, train f1 : 0.935, valid f1 : 0.833
training process:  32%|███▏      | 41/128 [50:50<1:50:00, 75.87s/it]EarlyStopping counter : 9 out of 12
training process:  33%|███▎      | 42/128 [51:43<1:38:49, 68.95s/it]EarlyStopping counter : 10 out of 12
training process:  34%|███▎      | 43/128 [52:42<1:33:30, 66.01s/it]EarlyStopping counter : 11 out of 12
training process:  34%|███▎      | 43/128 [54:09<1:47:04, 75.58s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 43, best f1 score : 0.856
training process finished, best loss : 0.149 and best acc : 0.949, best f1 : 0.856, best epoch : 31

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.84      0.68       580
           1       0.99      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.89      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.89, test loss : 9.551

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.36s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.47s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.44s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.58s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.45s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.40s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.34s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:29,  7.39s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:22,  7.42s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:14,  7.39s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:21<00:07,  7.37s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.32s/it]processing for feature importance: 100%|██████████| 12/12 [01:28<00:00,  7.39s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 114.02it/s]  8%|▊         | 24/306 [00:00<00:02, 117.32it/s] 12%|█▏        | 38/306 [00:00<00:02, 122.32it/s] 17%|█▋        | 52/306 [00:00<00:02, 126.22it/s] 21%|██        | 65/306 [00:00<00:01, 126.83it/s] 26%|██▌       | 79/306 [00:00<00:01, 129.13it/s] 30%|███       | 93/306 [00:00<00:01, 130.67it/s] 35%|███▍      | 107/306 [00:00<00:01, 133.10it/s] 40%|███▉      | 121/306 [00:00<00:01, 131.72it/s] 44%|████▍     | 135/306 [00:01<00:01, 127.91it/s] 48%|████▊     | 148/306 [00:01<00:01, 127.50it/s] 53%|█████▎    | 162/306 [00:01<00:01, 127.18it/s] 57%|█████▋    | 175/306 [00:01<00:01, 125.60it/s] 61%|██████▏   | 188/306 [00:01<00:00, 125.63it/s] 66%|██████▌   | 201/306 [00:01<00:00, 125.67it/s] 70%|██████▉   | 214/306 [00:01<00:00, 124.78it/s] 74%|███████▍  | 227/306 [00:01<00:00, 123.94it/s] 78%|███████▊  | 240/306 [00:01<00:00, 123.98it/s] 83%|████████▎ | 253/306 [00:02<00:00, 124.17it/s] 87%|████████▋ | 266/306 [00:02<00:00, 124.01it/s] 92%|█████████▏| 280/306 [00:02<00:00, 125.05it/s] 96%|█████████▌| 294/306 [00:02<00:00, 125.02it/s]100%|██████████| 306/306 [00:02<00:00, 126.30it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 452.43it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 455.24it/s]extract the null data:  25%|██▌       | 140/553 [00:00<00:00, 463.52it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:00, 469.76it/s]extract the null data:  43%|████▎     | 237/553 [00:00<00:00, 473.58it/s]extract the null data:  52%|█████▏    | 285/553 [00:00<00:00, 474.58it/s]extract the null data:  60%|██████    | 333/553 [00:00<00:00, 470.78it/s]extract the null data:  69%|██████▉   | 381/553 [00:00<00:00, 459.88it/s]extract the null data:  77%|███████▋  | 428/553 [00:00<00:00, 459.06it/s]extract the null data:  86%|████████▌ | 475/553 [00:01<00:00, 462.34it/s]extract the null data:  94%|█████████▍| 522/553 [00:01<00:00, 463.72it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 463.59it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 16/553 [00:00<00:03, 159.42it/s]replace nan value:   6%|▌         | 33/553 [00:00<00:03, 164.16it/s]replace nan value:   9%|▉         | 50/553 [00:00<00:03, 166.36it/s]replace nan value:  12%|█▏        | 67/553 [00:00<00:02, 167.08it/s]replace nan value:  15%|█▌        | 84/553 [00:00<00:02, 167.53it/s]replace nan value:  18%|█▊        | 101/553 [00:00<00:02, 168.20it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 169.59it/s]replace nan value:  25%|██▍       | 137/553 [00:00<00:02, 170.82it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 172.07it/s]replace nan value:  31%|███▏      | 173/553 [00:01<00:02, 171.98it/s]replace nan value:  35%|███▍      | 191/553 [00:01<00:02, 171.40it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:02, 171.59it/s]replace nan value:  41%|████      | 227/553 [00:01<00:01, 170.28it/s]replace nan value:  44%|████▍     | 245/553 [00:01<00:01, 169.88it/s]replace nan value:  47%|████▋     | 262/553 [00:01<00:01, 169.66it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 169.53it/s]replace nan value:  54%|█████▎    | 296/553 [00:01<00:01, 169.12it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 169.85it/s]replace nan value:  60%|██████    | 332/553 [00:01<00:01, 170.01it/s]replace nan value:  63%|██████▎   | 350/553 [00:02<00:01, 170.22it/s]replace nan value:  67%|██████▋   | 368/553 [00:02<00:01, 170.22it/s]replace nan value:  70%|██████▉   | 386/553 [00:02<00:00, 170.64it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 170.16it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 169.78it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 169.42it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 170.66it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 170.46it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 167.37it/s]replace nan value:  92%|█████████▏| 510/553 [00:03<00:00, 167.98it/s]replace nan value:  95%|█████████▌| 527/553 [00:03<00:00, 167.53it/s]replace nan value:  98%|█████████▊| 544/553 [00:03<00:00, 168.19it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 169.19it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 106.39it/s]  4%|▍         | 24/553 [00:00<00:04, 118.14it/s]  7%|▋         | 37/553 [00:00<00:04, 122.99it/s]  9%|▉         | 50/553 [00:00<00:04, 102.13it/s] 11%|█         | 61/553 [00:00<00:05, 95.58it/s]  13%|█▎        | 71/553 [00:00<00:04, 96.54it/s] 15%|█▌        | 84/553 [00:00<00:04, 104.81it/s] 17%|█▋        | 96/553 [00:00<00:04, 108.02it/s] 20%|█▉        | 108/553 [00:01<00:04, 109.36it/s] 22%|██▏       | 121/553 [00:01<00:03, 115.23it/s] 24%|██▍       | 133/553 [00:01<00:03, 113.12it/s] 27%|██▋       | 148/553 [00:01<00:03, 123.40it/s] 29%|██▉       | 162/553 [00:01<00:03, 126.04it/s] 32%|███▏      | 176/553 [00:01<00:02, 126.80it/s] 34%|███▍      | 189/553 [00:01<00:02, 126.49it/s] 37%|███▋      | 204/553 [00:01<00:02, 131.78it/s] 39%|███▉      | 218/553 [00:01<00:02, 127.53it/s] 42%|████▏     | 231/553 [00:01<00:02, 120.49it/s] 44%|████▍     | 244/553 [00:02<00:02, 119.80it/s] 46%|████▋     | 257/553 [00:02<00:02, 120.80it/s] 49%|████▉     | 270/553 [00:02<00:02, 118.14it/s] 51%|█████     | 282/553 [00:02<00:02, 115.54it/s] 53%|█████▎    | 294/553 [00:02<00:02, 113.86it/s] 55%|█████▌    | 306/553 [00:02<00:02, 108.26it/s] 58%|█████▊    | 319/553 [00:02<00:02, 111.48it/s] 60%|██████    | 332/553 [00:02<00:01, 115.92it/s] 62%|██████▏   | 345/553 [00:02<00:01, 119.14it/s] 65%|██████▍   | 357/553 [00:03<00:01, 118.37it/s] 67%|██████▋   | 372/553 [00:03<00:01, 127.37it/s] 70%|██████▉   | 385/553 [00:03<00:01, 122.64it/s] 72%|███████▏  | 398/553 [00:03<00:01, 111.93it/s] 75%|███████▍  | 414/553 [00:03<00:01, 120.03it/s] 77%|███████▋  | 427/553 [00:03<00:01, 110.20it/s] 80%|████████  | 443/553 [00:03<00:00, 121.99it/s] 83%|████████▎ | 458/553 [00:03<00:00, 128.59it/s] 86%|████████▌ | 473/553 [00:04<00:00, 132.59it/s] 88%|████████▊ | 487/553 [00:04<00:00, 128.28it/s] 91%|█████████ | 501/553 [00:04<00:00, 121.02it/s] 93%|█████████▎| 516/553 [00:04<00:00, 127.90it/s] 96%|█████████▌| 530/553 [00:04<00:00, 109.70it/s] 98%|█████████▊| 544/553 [00:04<00:00, 116.67it/s]100%|██████████| 553/553 [00:04<00:00, 116.07it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 275.80it/s]extract the null data:  60%|█████▉    | 83/139 [00:00<00:00, 433.13it/s]extract the null data:  99%|█████████▊| 137/139 [00:00<00:00, 478.16it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 451.00it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 186.52it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 188.33it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 188.42it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 187.76it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 187.13it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 185.31it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 185.46it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 186.47it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.70it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.91it/s] 27%|██▋       | 38/139 [00:00<00:00, 125.33it/s] 37%|███▋      | 51/139 [00:00<00:00, 121.61it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.80it/s] 55%|█████▌    | 77/139 [00:00<00:00, 120.55it/s] 65%|██████▍   | 90/139 [00:00<00:00, 115.45it/s] 76%|███████▌  | 105/139 [00:00<00:00, 123.60it/s] 88%|████████▊ | 122/139 [00:00<00:00, 133.85it/s] 98%|█████████▊| 136/139 [00:01<00:00, 134.24it/s]100%|██████████| 139/139 [00:01<00:00, 127.31it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 238.61it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 472.30it/s]extract the null data:  84%|████████▍ | 145/173 [00:00<00:00, 516.47it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 489.58it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 182.58it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 185.70it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 186.78it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 185.99it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 185.99it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 187.06it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 185.78it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 184.85it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 182.36it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 184.48it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.32it/s] 16%|█▌        | 28/173 [00:00<00:01, 114.21it/s] 24%|██▍       | 42/173 [00:00<00:01, 122.16it/s] 32%|███▏      | 56/173 [00:00<00:00, 128.14it/s] 40%|███▉      | 69/173 [00:00<00:00, 124.59it/s] 48%|████▊     | 83/173 [00:00<00:00, 128.30it/s] 55%|█████▌    | 96/173 [00:00<00:00, 126.48it/s] 64%|██████▎   | 110/173 [00:00<00:00, 130.30it/s] 72%|███████▏  | 124/173 [00:00<00:00, 122.14it/s] 79%|███████▉  | 137/173 [00:01<00:00, 121.47it/s] 87%|████████▋ | 150/173 [00:01<00:00, 116.29it/s] 94%|█████████▎| 162/173 [00:01<00:00, 109.38it/s]100%|██████████| 173/173 [00:01<00:00, 109.66it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.088, valid loss : 0.079, train acc : 0.689, valid acc : 0.844, train f1 : 0.529, valid f1 : 0.661
training process:   1%|          | 1/128 [01:31<3:14:04, 91.69s/it]Best score increase :0.000 -> 0.661
training process:   2%|▏         | 2/128 [02:59<3:08:15, 89.65s/it]Best score increase :0.661 -> 0.689
training process:   2%|▏         | 3/128 [04:05<2:44:20, 78.88s/it]Best score increase :0.689 -> 0.738
training process:   3%|▎         | 4/128 [05:34<2:51:17, 82.88s/it]Best score increase :0.738 -> 0.758
epoch : 5, train loss : 0.055, valid loss : 0.059, train acc : 0.864, valid acc : 0.940, train f1 : 0.705, valid f1 : 0.806
training process:   4%|▍         | 5/128 [06:47<2:42:20, 79.19s/it]Best score increase :0.758 -> 0.806
training process:   5%|▍         | 6/128 [07:39<2:22:13, 69.94s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [08:31<2:09:12, 64.07s/it]Best score increase :0.806 -> 0.814
training process:   6%|▋         | 8/128 [09:56<2:21:20, 70.67s/it]Best score increase :0.814 -> 0.830
epoch : 9, train loss : 0.047, valid loss : 0.052, train acc : 0.905, valid acc : 0.947, train f1 : 0.762, valid f1 : 0.835
training process:   7%|▋         | 9/128 [11:29<2:33:52, 77.58s/it]Best score increase :0.830 -> 0.835
training process:   8%|▊         | 10/128 [12:57<2:38:51, 80.77s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [13:59<2:26:49, 75.29s/it]Best score increase :0.835 -> 0.843
training process:   9%|▉         | 12/128 [15:05<2:20:05, 72.46s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.044, valid loss : 0.060, train acc : 0.918, valid acc : 0.955, train f1 : 0.783, valid f1 : 0.846
training process:  10%|█         | 13/128 [16:06<2:12:13, 68.99s/it]Best score increase :0.843 -> 0.846
training process:  11%|█         | 14/128 [16:57<2:00:30, 63.43s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [17:59<1:58:27, 62.90s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [19:25<2:10:28, 69.90s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.041, valid loss : 0.053, train acc : 0.931, valid acc : 0.947, train f1 : 0.807, valid f1 : 0.834
training process:  13%|█▎        | 17/128 [20:35<2:09:13, 69.85s/it]EarlyStopping counter : 4 out of 12
training process:  14%|█▍        | 18/128 [22:04<2:18:59, 75.81s/it]EarlyStopping counter : 5 out of 12
training process:  15%|█▍        | 19/128 [23:24<2:19:43, 76.92s/it]EarlyStopping counter : 6 out of 12
training process:  16%|█▌        | 20/128 [24:28<2:11:46, 73.21s/it]Best score increase :0.846 -> 0.853
epoch : 21, train loss : 0.039, valid loss : 0.056, train acc : 0.934, valid acc : 0.955, train f1 : 0.815, valid f1 : 0.852
training process:  16%|█▋        | 21/128 [25:27<2:02:48, 68.86s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [26:17<1:51:43, 63.24s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [27:32<1:56:50, 66.77s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [29:00<2:06:27, 72.95s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.038, valid loss : 0.061, train acc : 0.936, valid acc : 0.956, train f1 : 0.820, valid f1 : 0.852
training process:  20%|█▉        | 25/128 [30:38<2:18:25, 80.64s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [32:08<2:21:56, 83.50s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [32:59<2:04:10, 73.77s/it]Best score increase :0.853 -> 0.860
training process:  22%|██▏       | 28/128 [33:53<1:52:40, 67.61s/it]Best score increase :0.860 -> 0.861
epoch : 29, train loss : 0.037, valid loss : 0.067, train acc : 0.944, valid acc : 0.958, train f1 : 0.836, valid f1 : 0.858
training process:  23%|██▎       | 29/128 [35:03<1:53:04, 68.53s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [36:11<1:51:37, 68.34s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [37:19<1:50:15, 68.20s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [38:29<1:50:00, 68.76s/it]Best score increase :0.861 -> 0.863
epoch : 33, train loss : 0.035, valid loss : 0.055, train acc : 0.944, valid acc : 0.957, train f1 : 0.838, valid f1 : 0.860
training process:  26%|██▌       | 33/128 [39:48<1:53:42, 71.81s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [40:55<1:50:04, 70.26s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [42:01<1:46:50, 68.93s/it]Best score increase :0.863 -> 0.867
training process:  28%|██▊       | 36/128 [43:08<1:44:57, 68.45s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.035, valid loss : 0.073, train acc : 0.946, valid acc : 0.961, train f1 : 0.843, valid f1 : 0.864
training process:  29%|██▉       | 37/128 [44:27<1:48:47, 71.73s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [45:27<1:42:09, 68.10s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [46:33<1:40:12, 67.55s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [47:26<1:32:30, 63.08s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.035, valid loss : 0.067, train acc : 0.947, valid acc : 0.958, train f1 : 0.845, valid f1 : 0.858
training process:  32%|███▏      | 41/128 [48:27<1:30:42, 62.55s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [49:20<1:25:24, 59.59s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▎      | 43/128 [50:11<1:20:51, 57.08s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▍      | 44/128 [51:04<1:18:11, 55.85s/it]EarlyStopping counter : 9 out of 12
epoch : 45, train loss : 0.035, valid loss : 0.056, train acc : 0.951, valid acc : 0.956, train f1 : 0.853, valid f1 : 0.862
training process:  35%|███▌      | 45/128 [52:11<1:21:50, 59.16s/it]EarlyStopping counter : 10 out of 12
training process:  36%|███▌      | 46/128 [53:03<1:18:00, 57.08s/it]EarlyStopping counter : 11 out of 12
training process:  36%|███▌      | 46/128 [53:54<1:36:05, 70.31s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 46, best f1 score : 0.867
training process finished, best loss : 0.055 and best acc : 0.958, best f1 : 0.867, best epoch : 41

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.74      0.67       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.85      0.82      7398
weighted avg       0.95      0.94      0.94      7398


# test acc : 0.94, test f1 : 0.82, test AUC : 0.85, test loss : 3.888

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:32,  8.44s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.08s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:11,  7.93s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.05s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:56,  8.13s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:49,  8.21s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:41,  8.24s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:05<00:33,  8.28s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:23,  7.96s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:20<00:15,  7.80s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.65s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.51s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.90s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 9/306 [00:00<00:03, 89.17it/s]  9%|▉         | 28/306 [00:00<00:01, 141.76it/s] 14%|█▍        | 43/306 [00:00<00:01, 143.29it/s] 19%|█▉        | 58/306 [00:00<00:02, 121.41it/s] 25%|██▌       | 77/306 [00:00<00:01, 140.05it/s] 30%|███       | 92/306 [00:00<00:01, 141.02it/s] 35%|███▍      | 107/306 [00:00<00:01, 134.87it/s] 40%|███▉      | 122/306 [00:00<00:01, 137.91it/s] 44%|████▍     | 136/306 [00:01<00:01, 131.21it/s] 50%|████▉     | 152/306 [00:01<00:01, 139.15it/s] 55%|█████▍    | 167/306 [00:01<00:00, 141.01it/s] 59%|█████▉    | 182/306 [00:01<00:01, 122.56it/s] 65%|██████▌   | 200/306 [00:01<00:00, 134.09it/s] 70%|███████   | 215/306 [00:01<00:00, 136.33it/s] 75%|███████▍  | 229/306 [00:01<00:00, 132.89it/s] 80%|███████▉  | 244/306 [00:01<00:00, 136.12it/s] 84%|████████▍ | 258/306 [00:01<00:00, 134.45it/s] 89%|████████▉ | 272/306 [00:02<00:00, 134.50it/s] 93%|█████████▎| 286/306 [00:02<00:00, 136.01it/s] 98%|█████████▊| 300/306 [00:02<00:00, 129.37it/s]100%|██████████| 306/306 [00:02<00:00, 132.73it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 595.32it/s]extract the null data:  22%|██▏       | 120/553 [00:00<00:00, 578.46it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 584.87it/s]extract the null data:  43%|████▎     | 239/553 [00:00<00:00, 580.06it/s]extract the null data:  54%|█████▍    | 298/553 [00:00<00:00, 562.86it/s]extract the null data:  64%|██████▍   | 355/553 [00:00<00:00, 562.19it/s]extract the null data:  75%|███████▍  | 413/553 [00:00<00:00, 566.57it/s]extract the null data:  86%|████████▌ | 473/553 [00:00<00:00, 575.76it/s]extract the null data:  96%|█████████▌| 531/553 [00:00<00:00, 569.23it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 570.08it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 209.39it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 197.87it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 195.10it/s]replace nan value:  15%|█▍        | 82/553 [00:00<00:02, 193.04it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 196.21it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 203.21it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 200.26it/s]replace nan value:  30%|███       | 167/553 [00:00<00:01, 199.99it/s]replace nan value:  34%|███▍      | 188/553 [00:00<00:01, 198.76it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 199.45it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 202.75it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 198.98it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 198.82it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 198.88it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:01, 200.48it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 207.55it/s]replace nan value:  65%|██████▍   | 357/553 [00:01<00:00, 204.51it/s]replace nan value:  68%|██████▊   | 378/553 [00:01<00:00, 204.25it/s]replace nan value:  72%|███████▏  | 399/553 [00:01<00:00, 200.15it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 199.30it/s]replace nan value:  80%|███████▉  | 440/553 [00:02<00:00, 198.72it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 197.43it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 197.60it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 195.83it/s]replace nan value:  94%|█████████▍| 520/553 [00:02<00:00, 196.53it/s]replace nan value:  98%|█████████▊| 541/553 [00:02<00:00, 199.01it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 199.27it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 118.59it/s]  5%|▍         | 26/553 [00:00<00:04, 129.99it/s]  7%|▋         | 40/553 [00:00<00:03, 133.38it/s] 10%|▉         | 54/553 [00:00<00:04, 124.12it/s] 12%|█▏        | 67/553 [00:00<00:04, 115.83it/s] 15%|█▍        | 81/553 [00:00<00:03, 123.13it/s] 17%|█▋        | 95/553 [00:00<00:03, 128.03it/s] 20%|█▉        | 109/553 [00:00<00:03, 130.48it/s] 23%|██▎       | 125/553 [00:00<00:03, 134.08it/s] 26%|██▌       | 142/553 [00:01<00:02, 144.24it/s] 29%|██▉       | 161/553 [00:01<00:02, 155.96it/s] 32%|███▏      | 177/553 [00:01<00:02, 156.41it/s] 35%|███▍      | 193/553 [00:01<00:02, 157.21it/s] 38%|███▊      | 211/553 [00:01<00:02, 161.83it/s] 41%|████      | 228/553 [00:01<00:02, 153.25it/s] 44%|████▍     | 244/553 [00:01<00:02, 146.89it/s] 47%|████▋     | 260/553 [00:01<00:01, 150.36it/s] 50%|████▉     | 276/553 [00:01<00:01, 143.30it/s] 53%|█████▎    | 292/553 [00:02<00:01, 141.89it/s] 56%|█████▌    | 307/553 [00:02<00:01, 134.67it/s] 58%|█████▊    | 321/553 [00:02<00:01, 132.88it/s] 61%|██████    | 336/553 [00:02<00:01, 135.92it/s] 63%|██████▎   | 350/553 [00:02<00:01, 134.87it/s] 66%|██████▌   | 364/553 [00:02<00:01, 131.47it/s] 69%|██████▊   | 379/553 [00:02<00:01, 134.81it/s] 71%|███████   | 393/553 [00:02<00:01, 124.42it/s] 74%|███████▎  | 407/553 [00:02<00:01, 127.77it/s] 76%|███████▌  | 420/553 [00:03<00:01, 123.83it/s] 78%|███████▊  | 433/553 [00:03<00:00, 122.21it/s] 82%|████████▏ | 451/553 [00:03<00:00, 137.57it/s] 84%|████████▍ | 466/553 [00:03<00:00, 140.98it/s] 87%|████████▋ | 481/553 [00:03<00:00, 137.01it/s] 90%|████████▉ | 495/553 [00:03<00:00, 128.72it/s] 92%|█████████▏| 510/553 [00:03<00:00, 133.88it/s] 95%|█████████▍| 524/553 [00:03<00:00, 124.03it/s] 97%|█████████▋| 537/553 [00:03<00:00, 116.89it/s]100%|█████████▉| 551/553 [00:04<00:00, 106.58it/s]100%|██████████| 553/553 [00:04<00:00, 132.59it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  31%|███       | 43/139 [00:00<00:00, 426.60it/s]extract the null data:  79%|███████▉  | 110/139 [00:00<00:00, 567.14it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 565.78it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 216.91it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 212.50it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 212.04it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 212.32it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 209.45it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 213.49it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 212.90it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 117.74it/s] 19%|█▊        | 26/139 [00:00<00:00, 128.78it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.12it/s] 39%|███▉      | 54/139 [00:00<00:00, 126.68it/s] 48%|████▊     | 67/139 [00:00<00:00, 125.30it/s] 58%|█████▊    | 80/139 [00:00<00:00, 125.79it/s] 67%|██████▋   | 93/139 [00:00<00:00, 116.11it/s] 76%|███████▋  | 106/139 [00:00<00:00, 119.50it/s] 88%|████████▊ | 122/139 [00:00<00:00, 128.50it/s] 97%|█████████▋| 135/139 [00:01<00:00, 125.27it/s]100%|██████████| 139/139 [00:01<00:00, 125.92it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 318.77it/s]extract the null data:  57%|█████▋    | 98/173 [00:00<00:00, 518.35it/s]extract the null data:  93%|█████████▎| 161/173 [00:00<00:00, 568.82it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 539.05it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 203.37it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 206.14it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 206.18it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 208.80it/s]replace nan value:  61%|██████▏   | 106/173 [00:00<00:00, 208.75it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 207.63it/s]replace nan value:  86%|████████▌ | 149/173 [00:00<00:00, 209.02it/s]replace nan value:  98%|█████████▊| 170/173 [00:00<00:00, 205.79it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 206.72it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 141.30it/s] 17%|█▋        | 30/173 [00:00<00:01, 122.88it/s] 27%|██▋       | 46/173 [00:00<00:00, 134.31it/s] 35%|███▌      | 61/173 [00:00<00:00, 139.24it/s] 44%|████▍     | 76/173 [00:00<00:00, 136.06it/s] 53%|█████▎    | 91/173 [00:00<00:00, 140.19it/s] 61%|██████▏   | 106/173 [00:00<00:00, 135.29it/s] 70%|██████▉   | 121/173 [00:00<00:00, 138.13it/s] 78%|███████▊  | 135/173 [00:01<00:00, 131.80it/s] 86%|████████▌ | 149/173 [00:01<00:00, 125.85it/s] 94%|█████████▎| 162/173 [00:01<00:00, 120.06it/s]100%|██████████| 173/173 [00:01<00:00, 119.15it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.279, valid loss : 0.081, train acc : 0.695, valid acc : 0.629, train f1 : 0.695, valid f1 : 0.515
training process:   1%|          | 1/128 [01:14<2:37:40, 74.49s/it]Best score increase :0.000 -> 0.515
training process:   2%|▏         | 2/128 [02:06<2:08:24, 61.14s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:56<1:56:33, 55.95s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:49<1:53:22, 54.86s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.086, valid loss : 0.104, train acc : 0.754, valid acc : 0.514, train f1 : 0.742, valid f1 : 0.445
training process:   4%|▍         | 5/128 [05:12<2:13:33, 65.15s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [06:28<2:19:45, 68.74s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [07:57<2:32:19, 75.53s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [09:06<2:26:44, 73.37s/it]EarlyStopping counter : 7 out of 12
epoch : 9, train loss : 0.067, valid loss : 0.100, train acc : 0.784, valid acc : 0.537, train f1 : 0.774, valid f1 : 0.462
training process:   7%|▋         | 9/128 [10:21<2:26:17, 73.76s/it]EarlyStopping counter : 8 out of 12
training process:   8%|▊         | 10/128 [11:28<2:20:51, 71.62s/it]Best score increase :0.515 -> 0.539
training process:   9%|▊         | 11/128 [12:20<2:08:00, 65.65s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [13:13<1:59:26, 61.78s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.060, valid loss : 0.076, train acc : 0.800, valid acc : 0.679, train f1 : 0.794, valid f1 : 0.561
training process:  10%|█         | 13/128 [14:13<1:57:32, 61.33s/it]Best score increase :0.539 -> 0.561
training process:  11%|█         | 14/128 [15:21<2:00:32, 63.44s/it]Best score increase :0.561 -> 0.597
training process:  12%|█▏        | 15/128 [16:47<2:12:07, 70.16s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [17:57<2:10:42, 70.02s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.055, valid loss : 0.077, train acc : 0.825, valid acc : 0.676, train f1 : 0.820, valid f1 : 0.559
training process:  13%|█▎        | 17/128 [19:37<2:26:28, 79.17s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [20:46<2:19:41, 76.20s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [21:41<2:06:29, 69.63s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [22:34<1:56:25, 64.68s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.050, valid loss : 0.078, train acc : 0.843, valid acc : 0.688, train f1 : 0.840, valid f1 : 0.568
training process:  16%|█▋        | 21/128 [23:35<1:53:15, 63.51s/it]EarlyStopping counter : 7 out of 12
training process:  17%|█▋        | 22/128 [24:43<1:54:49, 65.00s/it]Best score increase :0.597 -> 0.609
training process:  18%|█▊        | 23/128 [25:39<1:48:43, 62.13s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [26:36<1:45:10, 60.68s/it]Best score increase :0.609 -> 0.612
epoch : 25, train loss : 0.047, valid loss : 0.069, train acc : 0.855, valid acc : 0.733, train f1 : 0.852, valid f1 : 0.603
training process:  20%|█▉        | 25/128 [27:44<1:47:49, 62.81s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 26/128 [28:44<1:45:31, 62.08s/it]Best score increase :0.612 -> 0.622
training process:  21%|██        | 27/128 [29:41<1:42:01, 60.60s/it]Best score increase :0.622 -> 0.624
training process:  22%|██▏       | 28/128 [30:38<1:38:56, 59.36s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.045, valid loss : 0.068, train acc : 0.864, valid acc : 0.742, train f1 : 0.861, valid f1 : 0.611
training process:  23%|██▎       | 29/128 [31:51<1:45:04, 63.68s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [33:01<1:47:02, 65.53s/it]Best score increase :0.624 -> 0.639
training process:  24%|██▍       | 31/128 [34:07<1:45:55, 65.52s/it]Best score increase :0.639 -> 0.654
training process:  25%|██▌       | 32/128 [35:16<1:46:39, 66.66s/it]Best score increase :0.654 -> 0.674
epoch : 33, train loss : 0.041, valid loss : 0.061, train acc : 0.879, valid acc : 0.794, train f1 : 0.877, valid f1 : 0.655
training process:  26%|██▌       | 33/128 [36:37<1:52:10, 70.85s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [37:45<1:49:46, 70.07s/it]Best score increase :0.674 -> 0.700
training process:  27%|██▋       | 35/128 [38:51<1:46:47, 68.90s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [39:59<1:45:09, 68.58s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.040, valid loss : 0.070, train acc : 0.885, valid acc : 0.750, train f1 : 0.883, valid f1 : 0.617
training process:  29%|██▉       | 37/128 [41:17<1:48:09, 71.31s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [42:26<1:46:00, 70.67s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [43:32<1:43:03, 69.48s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [44:40<1:41:09, 68.97s/it]EarlyStopping counter : 6 out of 12
epoch : 41, train loss : 0.039, valid loss : 0.063, train acc : 0.888, valid acc : 0.787, train f1 : 0.887, valid f1 : 0.649
training process:  32%|███▏      | 41/128 [45:57<1:43:21, 71.29s/it]EarlyStopping counter : 7 out of 12
training process:  33%|███▎      | 42/128 [47:05<1:40:42, 70.26s/it]EarlyStopping counter : 8 out of 12
training process:  34%|███▎      | 43/128 [48:14<1:38:51, 69.79s/it]EarlyStopping counter : 9 out of 12
training process:  34%|███▍      | 44/128 [49:24<1:37:55, 69.95s/it]EarlyStopping counter : 10 out of 12
epoch : 45, train loss : 0.035, valid loss : 0.062, train acc : 0.899, valid acc : 0.794, train f1 : 0.898, valid f1 : 0.656
training process:  35%|███▌      | 45/128 [50:45<1:41:17, 73.22s/it]EarlyStopping counter : 11 out of 12
training process:  35%|███▌      | 45/128 [51:55<1:35:47, 69.24s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.700
training process finished, best loss : 0.052 and best acc : 0.840, best f1 : 0.700, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.31      0.93      0.46       580
           1       0.99      0.82      0.90      6818

    accuracy                           0.83      7398
   macro avg       0.65      0.88      0.68      7398
weighted avg       0.94      0.83      0.86      7398


# test acc : 0.83, test f1 : 0.68, test AUC : 0.88, test loss : 3.271

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:10<01:51, 10.13s/it]processing for feature importance:  17%|█▋        | 2/12 [00:20<01:43, 10.30s/it]processing for feature importance:  25%|██▌       | 3/12 [00:29<01:27,  9.73s/it]processing for feature importance:  33%|███▎      | 4/12 [00:39<01:18,  9.84s/it]processing for feature importance:  42%|████▏     | 5/12 [00:49<01:08,  9.77s/it]processing for feature importance:  50%|█████     | 6/12 [00:59<00:58,  9.79s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:08<00:49,  9.82s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:18<00:39,  9.88s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:28<00:29,  9.81s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:38<00:19,  9.85s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:48<00:09,  9.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:58<00:00, 10.08s/it]processing for feature importance: 100%|██████████| 12/12 [01:58<00:00,  9.91s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:01, 148.60it/s] 10%|▉         | 30/306 [00:00<00:01, 143.03it/s] 15%|█▍        | 45/306 [00:00<00:01, 141.41it/s] 20%|█▉        | 60/306 [00:00<00:01, 140.20it/s] 25%|██▍       | 75/306 [00:00<00:01, 143.14it/s] 32%|███▏      | 97/306 [00:00<00:01, 168.43it/s] 37%|███▋      | 114/306 [00:00<00:01, 160.27it/s] 43%|████▎     | 131/306 [00:00<00:01, 154.73it/s] 48%|████▊     | 147/306 [00:00<00:01, 151.16it/s] 53%|█████▎    | 163/306 [00:01<00:00, 151.79it/s] 59%|█████▉    | 180/306 [00:01<00:00, 152.50it/s] 64%|██████▍   | 197/306 [00:01<00:00, 154.00it/s] 70%|██████▉   | 214/306 [00:01<00:00, 155.26it/s] 75%|███████▌  | 231/306 [00:01<00:00, 157.95it/s] 81%|████████  | 247/306 [00:01<00:00, 152.93it/s] 86%|████████▌ | 263/306 [00:01<00:00, 150.09it/s] 91%|█████████ | 279/306 [00:01<00:00, 151.82it/s] 97%|█████████▋| 296/306 [00:01<00:00, 152.39it/s]100%|██████████| 306/306 [00:02<00:00, 152.86it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 64/553 [00:00<00:00, 636.60it/s]extract the null data:  24%|██▎       | 130/553 [00:00<00:00, 645.82it/s]extract the null data:  36%|███▌      | 198/553 [00:00<00:00, 661.03it/s]extract the null data:  48%|████▊     | 265/553 [00:00<00:00, 655.99it/s]extract the null data:  60%|█████▉    | 331/553 [00:00<00:00, 653.70it/s]extract the null data:  72%|███████▏  | 397/553 [00:00<00:00, 652.42it/s]extract the null data:  84%|████████▍ | 464/553 [00:00<00:00, 655.63it/s]extract the null data:  96%|█████████▌| 530/553 [00:00<00:00, 646.85it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 649.00it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:02, 223.23it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 223.46it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 219.49it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 222.64it/s]replace nan value:  21%|██        | 116/553 [00:00<00:01, 227.42it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:01, 224.96it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:01, 221.79it/s]replace nan value:  34%|███▎      | 186/553 [00:00<00:01, 224.51it/s]replace nan value:  38%|███▊      | 209/553 [00:00<00:01, 225.22it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 224.56it/s]replace nan value:  46%|████▋     | 256/553 [00:01<00:01, 226.58it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 227.76it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 226.81it/s]replace nan value:  59%|█████▉    | 327/553 [00:01<00:00, 228.41it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:00, 231.59it/s]replace nan value:  68%|██████▊   | 375/553 [00:01<00:00, 228.12it/s]replace nan value:  72%|███████▏  | 398/553 [00:01<00:00, 227.26it/s]replace nan value:  76%|███████▋  | 422/553 [00:01<00:00, 228.65it/s]replace nan value:  80%|████████  | 445/553 [00:01<00:00, 227.36it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 226.80it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 228.93it/s]replace nan value:  93%|█████████▎| 515/553 [00:02<00:00, 227.36it/s]replace nan value:  97%|█████████▋| 538/553 [00:02<00:00, 226.22it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 226.41it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 132.81it/s]  5%|▌         | 28/553 [00:00<00:03, 135.64it/s]  8%|▊         | 42/553 [00:00<00:03, 131.59it/s] 10%|█         | 56/553 [00:00<00:04, 122.43it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.51it/s] 15%|█▌        | 85/553 [00:00<00:03, 124.41it/s] 18%|█▊        | 98/553 [00:00<00:03, 121.85it/s] 21%|██        | 114/553 [00:00<00:03, 130.78it/s] 23%|██▎       | 128/553 [00:01<00:03, 130.31it/s] 27%|██▋       | 147/553 [00:01<00:02, 146.32it/s] 30%|██▉       | 164/553 [00:01<00:02, 152.46it/s] 33%|███▎      | 181/553 [00:01<00:02, 153.84it/s] 36%|███▌      | 198/553 [00:01<00:02, 156.93it/s] 39%|███▉      | 215/553 [00:01<00:02, 158.39it/s] 42%|████▏     | 231/553 [00:01<00:02, 147.84it/s] 44%|████▍     | 246/553 [00:01<00:02, 146.94it/s] 47%|████▋     | 262/553 [00:01<00:01, 148.82it/s] 50%|█████     | 277/553 [00:01<00:01, 141.51it/s] 53%|█████▎    | 293/553 [00:02<00:01, 143.06it/s] 56%|█████▌    | 308/553 [00:02<00:01, 141.17it/s] 58%|█████▊    | 323/553 [00:02<00:01, 140.76it/s] 61%|██████▏   | 340/553 [00:02<00:01, 146.96it/s] 64%|██████▍   | 355/553 [00:02<00:01, 143.32it/s] 67%|██████▋   | 372/553 [00:02<00:01, 150.65it/s] 70%|███████   | 388/553 [00:02<00:01, 139.91it/s] 73%|███████▎  | 403/553 [00:02<00:01, 133.47it/s] 75%|███████▌  | 417/553 [00:02<00:01, 133.60it/s] 78%|███████▊  | 431/553 [00:03<00:00, 130.50it/s] 82%|████████▏ | 451/553 [00:03<00:00, 148.35it/s] 85%|████████▍ | 469/553 [00:03<00:00, 154.24it/s] 88%|████████▊ | 485/553 [00:03<00:00, 151.56it/s] 91%|█████████ | 501/553 [00:03<00:00, 141.35it/s] 94%|█████████▎| 518/553 [00:03<00:00, 147.08it/s] 96%|█████████▋| 533/553 [00:03<00:00, 125.59it/s]100%|█████████▉| 551/553 [00:03<00:00, 117.46it/s]100%|██████████| 553/553 [00:04<00:00, 137.83it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  35%|███▌      | 49/139 [00:00<00:00, 487.46it/s]extract the null data:  86%|████████▋ | 120/139 [00:00<00:00, 614.70it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 609.03it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▊        | 26/139 [00:00<00:00, 255.45it/s]replace nan value:  37%|███▋      | 52/139 [00:00<00:00, 250.04it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 249.89it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 250.20it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 251.15it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 250.66it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 134.71it/s] 22%|██▏       | 30/139 [00:00<00:00, 144.84it/s] 34%|███▍      | 47/139 [00:00<00:00, 154.66it/s] 45%|████▌     | 63/139 [00:00<00:00, 141.61it/s] 56%|█████▌    | 78/139 [00:00<00:00, 139.28it/s] 67%|██████▋   | 93/139 [00:00<00:00, 129.06it/s] 77%|███████▋  | 107/139 [00:00<00:00, 129.47it/s] 90%|████████▉ | 125/139 [00:00<00:00, 143.17it/s]100%|██████████| 139/139 [00:00<00:00, 141.76it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 316.23it/s]extract the null data:  61%|██████▏   | 106/173 [00:00<00:00, 563.94it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 588.99it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 249.54it/s]replace nan value:  29%|██▉       | 51/173 [00:00<00:00, 252.50it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 251.95it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 245.71it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 246.51it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 248.73it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 246.29it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:01, 152.30it/s] 18%|█▊        | 32/173 [00:00<00:01, 132.86it/s] 29%|██▉       | 51/173 [00:00<00:00, 155.70it/s] 39%|███▊      | 67/173 [00:00<00:00, 151.51it/s] 49%|████▊     | 84/173 [00:00<00:00, 152.22it/s] 58%|█████▊    | 100/173 [00:00<00:00, 153.30it/s] 68%|██████▊   | 117/173 [00:00<00:00, 156.14it/s] 77%|███████▋  | 133/173 [00:00<00:00, 145.80it/s] 86%|████████▌ | 148/173 [00:00<00:00, 143.88it/s] 94%|█████████▍| 163/173 [00:01<00:00, 131.89it/s]100%|██████████| 173/173 [00:01<00:00, 131.17it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.450, valid loss : 0.312, train f1 : 0.578, valid f1 : 0.572
training process - Deferred Re-weighting:   1%|          | 1/128 [01:20<2:49:45, 80.20s/it]Best score increase :0.000 -> 0.572
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:31<2:37:20, 74.92s/it]Best score increase :0.572 -> 0.678
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:44<2:33:56, 73.89s/it]Best score increase :0.678 -> 0.712
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:49<2:25:23, 70.35s/it]Best score increase :0.712 -> 0.762
epoch : 5, train loss : 0.171, valid loss : 0.157, train f1 : 0.794, valid f1 : 0.772
training process - Deferred Re-weighting:   4%|▍         | 5/128 [06:05<2:28:23, 72.38s/it]Best score increase :0.762 -> 0.772
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:17<2:27:20, 72.46s/it]Best score increase :0.772 -> 0.800
training process - Deferred Re-weighting:   5%|▌         | 7/128 [08:08<2:11:54, 65.41s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:00<2:02:21, 61.18s/it]Best score increase :0.800 -> 0.801
epoch : 9, train loss : 0.131, valid loss : 0.139, train f1 : 0.835, valid f1 : 0.813
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:00<2:00:22, 60.70s/it]Best score increase :0.801 -> 0.813
training process - Deferred Re-weighting:   8%|▊         | 10/128 [11:15<2:07:55, 65.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [12:29<2:12:37, 68.02s/it]Best score increase :0.813 -> 0.816
training process - Deferred Re-weighting:   9%|▉         | 12/128 [13:28<2:06:05, 65.22s/it]Best score increase :0.816 -> 0.823
epoch : 13, train loss : 0.118, valid loss : 0.157, train f1 : 0.850, valid f1 : 0.803
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:53<2:16:35, 71.26s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [16:03<2:14:26, 70.76s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [17:07<2:09:24, 68.71s/it]Best score increase :0.823 -> 0.841
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [18:22<2:11:40, 70.54s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.110, valid loss : 0.133, train f1 : 0.860, valid f1 : 0.841
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [19:21<2:04:07, 67.09s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [20:12<1:54:17, 62.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [21:02<1:46:46, 58.77s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [22:18<1:55:06, 63.95s/it]Best score increase :0.841 -> 0.843
epoch : 21, train loss : 0.104, valid loss : 0.134, train f1 : 0.869, valid f1 : 0.848
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [23:44<2:05:25, 70.34s/it]Best score increase :0.843 -> 0.848
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [24:58<2:06:23, 71.54s/it]Best score increase :0.848 -> 0.853
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [26:13<2:07:13, 72.70s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [27:18<2:01:45, 70.24s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.099, valid loss : 0.147, train f1 : 0.875, valid f1 : 0.843
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [28:38<2:05:42, 73.23s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [29:35<1:56:09, 68.33s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [30:32<1:49:03, 64.79s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [31:24<1:41:53, 61.14s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.093, valid loss : 0.155, train f1 : 0.884, valid f1 : 0.845
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [32:38<1:47:13, 64.98s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [33:50<1:49:39, 67.14s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [35:03<1:51:18, 68.85s/it]Best score increase :0.853 -> 0.855
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [36:22<1:54:44, 71.71s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.088, valid loss : 0.140, train f1 : 0.891, valid f1 : 0.862
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [37:51<2:02:02, 77.08s/it]Best score increase :0.855 -> 0.862
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [38:50<1:52:15, 71.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [39:50<1:45:25, 68.02s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [40:53<1:42:17, 66.72s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.086, valid loss : 0.156, train f1 : 0.894, valid f1 : 0.845
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [42:16<1:48:22, 71.45s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [43:21<1:44:07, 69.41s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [44:20<1:38:34, 66.46s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [45:19<1:34:19, 64.31s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.086, valid loss : 0.149, train f1 : 0.893, valid f1 : 0.854
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [46:29<1:35:38, 65.96s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [47:30<1:32:15, 64.36s/it]Best score increase :0.862 -> 0.868
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [48:30<1:29:23, 63.10s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [49:28<1:26:15, 61.61s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.082, valid loss : 0.142, train f1 : 0.900, valid f1 : 0.860
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [50:40<1:29:17, 64.55s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [51:55<1:32:36, 67.77s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [53:15<1:36:36, 71.56s/it]Best score increase :0.868 -> 0.872
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [54:12<1:29:37, 67.22s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.079, valid loss : 0.152, train f1 : 0.905, valid f1 : 0.860
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [55:27<1:31:22, 69.39s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [56:42<1:32:19, 71.02s/it]Best score increase :0.872 -> 0.874
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [57:54<1:31:46, 71.52s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [58:55<1:26:31, 68.30s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.077, valid loss : 0.154, train f1 : 0.904, valid f1 : 0.868
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [1:00:17<1:30:33, 72.44s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [1:01:36<1:31:32, 74.23s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:02:41<1:27:00, 71.51s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [1:03:43<1:22:30, 68.76s/it]Best score increase :0.874 -> 0.879
epoch : 57, train loss : 0.072, valid loss : 0.154, train f1 : 0.913, valid f1 : 0.863
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [1:05:05<1:26:01, 72.70s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [1:06:02<1:19:14, 67.93s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:07:02<1:15:31, 65.67s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:08:14<1:16:36, 67.59s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.073, valid loss : 0.166, train f1 : 0.912, valid f1 : 0.852
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:09:20<1:15:01, 67.19s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:10:24<1:12:51, 66.23s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:11:31<1:11:41, 66.17s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:12:33<1:09:29, 65.15s/it]EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.069, valid loss : 0.156, train f1 : 0.917, valid f1 : 0.867
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:13:32<1:06:23, 63.24s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:14:36<1:05:34, 63.46s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:15:47<1:06:54, 65.81s/it]Best score increase :0.879 -> 0.884
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:16:41<1:02:02, 62.03s/it]EarlyStopping counter : 1 out of 12
epoch : 69, train loss : 0.067, valid loss : 0.164, train f1 : 0.919, valid f1 : 0.868
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:17:44<1:01:20, 62.38s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:18:49<1:01:04, 63.17s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:19:55<1:00:56, 64.15s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:20:44<55:41, 59.68s/it]  EarlyStopping counter : 5 out of 12
epoch : 73, train loss : 0.064, valid loss : 0.156, train f1 : 0.923, valid f1 : 0.880
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:22:05<1:00:30, 66.01s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:23:11<59:15, 65.85s/it]  EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:24:01<54:03, 61.21s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:25:06<54:06, 62.44s/it]EarlyStopping counter : 9 out of 12
epoch : 77, train loss : 0.064, valid loss : 0.169, train f1 : 0.924, valid f1 : 0.866
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:26:27<57:48, 68.01s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:27:19<52:32, 63.05s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:28:22<56:39, 67.98s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 78, best f1 score : 0.884
training process finished, best loss : 0.141, best acc : 0.968, best f1 : 0.884, best epoch : 66

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.68      0.78       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.84      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.84, test loss : 8.859

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.57s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:13,  7.37s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:05,  7.29s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.31s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.38s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:43,  7.32s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:37,  7.44s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:29,  7.39s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:06<00:22,  7.41s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:15,  7.58s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:21<00:07,  7.52s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.50s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.44s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 18/306 [00:00<00:01, 171.81it/s] 12%|█▏        | 36/306 [00:00<00:01, 162.26it/s] 17%|█▋        | 53/306 [00:00<00:01, 153.73it/s] 23%|██▎       | 69/306 [00:00<00:01, 147.11it/s] 27%|██▋       | 84/306 [00:00<00:01, 143.86it/s] 32%|███▏      | 99/306 [00:00<00:01, 141.80it/s] 38%|███▊      | 117/306 [00:00<00:01, 148.49it/s] 44%|████▍     | 134/306 [00:00<00:01, 154.59it/s] 49%|████▉     | 150/306 [00:00<00:01, 152.18it/s] 54%|█████▍    | 166/306 [00:01<00:00, 148.25it/s] 59%|█████▉    | 181/306 [00:01<00:00, 144.66it/s] 64%|██████▍   | 196/306 [00:01<00:00, 142.81it/s] 72%|███████▏  | 219/306 [00:01<00:00, 165.84it/s] 79%|███████▉  | 241/306 [00:01<00:00, 181.20it/s] 85%|████████▍ | 260/306 [00:01<00:00, 172.63it/s] 91%|█████████ | 278/306 [00:01<00:00, 163.84it/s] 96%|█████████▋| 295/306 [00:01<00:00, 156.81it/s]100%|██████████| 306/306 [00:01<00:00, 153.99it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 53/553 [00:00<00:00, 527.18it/s]extract the null data:  20%|█▉        | 108/553 [00:00<00:00, 537.04it/s]extract the null data:  29%|██▉       | 162/553 [00:00<00:00, 527.85it/s]extract the null data:  39%|███▉      | 218/553 [00:00<00:00, 539.53it/s]extract the null data:  50%|████▉     | 274/553 [00:00<00:00, 546.59it/s]extract the null data:  60%|█████▉    | 331/553 [00:00<00:00, 553.23it/s]extract the null data:  70%|██████▉   | 387/553 [00:00<00:00, 548.82it/s]extract the null data:  80%|████████  | 443/553 [00:00<00:00, 549.93it/s]extract the null data:  91%|█████████ | 502/553 [00:00<00:00, 561.99it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 551.81it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 189.26it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 192.00it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 193.10it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:02, 193.87it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 195.58it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 195.23it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 191.77it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:02, 188.65it/s]replace nan value:  32%|███▏      | 179/553 [00:00<00:01, 190.20it/s]replace nan value:  36%|███▌      | 199/553 [00:01<00:01, 190.36it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 190.85it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 191.73it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 194.09it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 194.94it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 196.73it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 196.51it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:01, 194.55it/s]replace nan value:  65%|██████▌   | 360/553 [00:01<00:01, 193.00it/s]replace nan value:  69%|██████▊   | 380/553 [00:01<00:00, 190.28it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 186.42it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 183.72it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 180.28it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 177.78it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 177.64it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 177.48it/s]replace nan value:  92%|█████████▏| 511/553 [00:02<00:00, 175.88it/s]replace nan value:  96%|█████████▌| 529/553 [00:02<00:00, 175.95it/s]replace nan value:  99%|█████████▉| 548/553 [00:02<00:00, 179.18it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 187.16it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.85it/s]  5%|▌         | 28/553 [00:00<00:03, 136.86it/s]  8%|▊         | 42/553 [00:00<00:03, 131.11it/s] 10%|█         | 56/553 [00:00<00:04, 122.54it/s] 12%|█▏        | 69/553 [00:00<00:04, 112.48it/s] 15%|█▌        | 84/553 [00:00<00:03, 122.65it/s] 18%|█▊        | 98/553 [00:00<00:03, 122.96it/s] 21%|██        | 114/553 [00:00<00:03, 132.54it/s] 23%|██▎       | 128/553 [00:01<00:03, 130.39it/s] 26%|██▋       | 146/553 [00:01<00:02, 143.63it/s] 29%|██▉       | 162/553 [00:01<00:02, 147.91it/s] 32%|███▏      | 178/553 [00:01<00:02, 149.38it/s] 35%|███▌      | 194/553 [00:01<00:02, 151.83it/s] 38%|███▊      | 211/553 [00:01<00:02, 155.18it/s] 41%|████      | 227/553 [00:01<00:02, 147.04it/s] 44%|████▍     | 242/553 [00:01<00:02, 144.88it/s] 46%|████▋     | 257/553 [00:01<00:02, 141.97it/s] 49%|████▉     | 272/553 [00:01<00:02, 137.38it/s] 52%|█████▏    | 288/553 [00:02<00:01, 142.49it/s] 55%|█████▍    | 303/553 [00:02<00:01, 135.29it/s] 57%|█████▋    | 317/553 [00:02<00:01, 127.79it/s] 60%|█████▉    | 330/553 [00:02<00:01, 127.92it/s] 62%|██████▏   | 345/553 [00:02<00:01, 129.53it/s] 65%|██████▍   | 359/553 [00:02<00:01, 124.50it/s] 68%|██████▊   | 375/553 [00:02<00:01, 132.98it/s] 70%|███████   | 389/553 [00:02<00:01, 123.82it/s] 73%|███████▎  | 402/553 [00:03<00:01, 118.78it/s] 75%|███████▌  | 416/553 [00:03<00:01, 120.28it/s] 78%|███████▊  | 429/553 [00:03<00:01, 114.29it/s] 81%|████████  | 446/553 [00:03<00:00, 128.80it/s] 83%|████████▎ | 461/553 [00:03<00:00, 134.29it/s] 86%|████████▌ | 476/553 [00:03<00:00, 136.86it/s] 89%|████████▊ | 490/553 [00:03<00:00, 127.79it/s] 91%|█████████ | 504/553 [00:03<00:00, 125.87it/s] 94%|█████████▍| 519/553 [00:03<00:00, 130.98it/s] 96%|█████████▋| 533/553 [00:04<00:00, 111.70it/s] 99%|█████████▉| 549/553 [00:04<00:00, 122.38it/s]100%|██████████| 553/553 [00:04<00:00, 128.72it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 359.55it/s]extract the null data:  71%|███████   | 98/139 [00:00<00:00, 509.72it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 519.00it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 204.38it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 203.17it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 202.83it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 201.23it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 201.60it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 199.59it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 201.24it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.81it/s] 18%|█▊        | 25/139 [00:00<00:00, 122.16it/s] 29%|██▉       | 40/139 [00:00<00:00, 131.40it/s] 39%|███▉      | 54/139 [00:00<00:00, 123.86it/s] 48%|████▊     | 67/139 [00:00<00:00, 123.38it/s] 58%|█████▊    | 80/139 [00:00<00:00, 122.44it/s] 67%|██████▋   | 93/139 [00:00<00:00, 110.63it/s] 76%|███████▌  | 105/139 [00:00<00:00, 113.22it/s] 86%|████████▋ | 120/139 [00:00<00:00, 122.24it/s] 96%|█████████▌| 133/139 [00:01<00:00, 116.93it/s]100%|██████████| 139/139 [00:01<00:00, 120.56it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  16%|█▌        | 27/173 [00:00<00:00, 267.50it/s]extract the null data:  51%|█████     | 88/173 [00:00<00:00, 465.76it/s]extract the null data:  86%|████████▌ | 148/173 [00:00<00:00, 523.62it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 496.85it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 196.75it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 196.88it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 201.60it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 200.92it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 200.97it/s]replace nan value:  72%|███████▏  | 124/173 [00:00<00:00, 202.58it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 201.15it/s]replace nan value:  96%|█████████▌| 166/173 [00:00<00:00, 200.34it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 199.93it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 132.10it/s] 16%|█▌        | 28/173 [00:00<00:01, 115.63it/s] 24%|██▍       | 42/173 [00:00<00:01, 125.48it/s] 33%|███▎      | 57/173 [00:00<00:00, 131.96it/s] 41%|████      | 71/173 [00:00<00:00, 132.54it/s] 49%|████▉     | 85/173 [00:00<00:00, 131.07it/s] 57%|█████▋    | 99/173 [00:00<00:00, 130.01it/s] 66%|██████▌   | 114/173 [00:00<00:00, 135.92it/s] 74%|███████▍  | 128/173 [00:00<00:00, 128.24it/s] 82%|████████▏ | 142/173 [00:01<00:00, 129.97it/s] 90%|█████████ | 156/173 [00:01<00:00, 117.10it/s] 97%|█████████▋| 168/173 [00:01<00:00, 95.23it/s] 100%|██████████| 173/173 [00:01<00:00, 113.97it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.556, valid loss : 0.368, train f1 : 0.708, valid f1 : 0.668
training process - Deferred Re-weighting:   1%|          | 1/128 [01:21<2:53:32, 81.99s/it]Best score increase :0.000 -> 0.668
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:30<2:36:07, 74.35s/it]Best score increase :0.668 -> 0.715
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:22<2:13:31, 64.09s/it]Best score increase :0.715 -> 0.762
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:33<2:17:57, 66.76s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.322, valid loss : 0.299, train f1 : 0.857, valid f1 : 0.737
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:53<2:26:46, 71.59s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:45<2:11:59, 64.92s/it]Best score increase :0.762 -> 0.769
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:57<2:15:33, 67.22s/it]Best score increase :0.769 -> 0.785
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:10<2:18:09, 69.08s/it]Best score increase :0.785 -> 0.800
epoch : 9, train loss : 0.272, valid loss : 0.302, train f1 : 0.882, valid f1 : 0.732
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:09<2:10:24, 65.76s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [11:17<2:11:00, 66.61s/it]Best score increase :0.800 -> 0.804
training process - Deferred Re-weighting:   9%|▊         | 11/128 [12:31<2:13:54, 68.67s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [13:24<2:03:40, 63.97s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.252, valid loss : 0.192, train f1 : 0.894, valid f1 : 0.815
training process - Deferred Re-weighting:  10%|█         | 13/128 [14:38<2:08:32, 67.06s/it]Best score increase :0.804 -> 0.815
training process - Deferred Re-weighting:  11%|█         | 14/128 [15:44<2:06:58, 66.83s/it]Best score increase :0.815 -> 0.835
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [16:44<2:01:51, 64.71s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:41<1:56:20, 62.33s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.225, valid loss : 0.195, train f1 : 0.905, valid f1 : 0.811
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:55<2:01:58, 65.93s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [20:01<2:00:59, 65.99s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [20:52<1:51:34, 61.41s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [21:53<1:50:30, 61.39s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.207, valid loss : 0.195, train f1 : 0.914, valid f1 : 0.818
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [23:14<1:59:30, 67.02s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [24:13<1:54:13, 64.65s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [25:13<1:51:04, 63.47s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [26:27<1:55:13, 66.48s/it]EarlyStopping counter : 10 out of 12
epoch : 25, train loss : 0.192, valid loss : 0.155, train f1 : 0.922, valid f1 : 0.844
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [27:38<1:56:23, 67.80s/it]Best score increase :0.835 -> 0.844
training process - Deferred Re-weighting:  20%|██        | 26/128 [28:42<1:53:11, 66.59s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [29:56<1:55:51, 68.83s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [30:56<1:50:17, 66.17s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.178, valid loss : 0.162, train f1 : 0.928, valid f1 : 0.837
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [32:03<1:49:41, 66.48s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [33:15<1:51:15, 68.11s/it]Best score increase :0.844 -> 0.847
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [34:16<1:46:35, 65.94s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [35:12<1:40:50, 63.02s/it]Best score increase :0.847 -> 0.858
epoch : 33, train loss : 0.163, valid loss : 0.149, train f1 : 0.937, valid f1 : 0.850
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [36:34<1:48:55, 68.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [37:38<1:45:21, 67.25s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [38:38<1:41:07, 65.24s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [39:52<1:43:43, 67.65s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.156, valid loss : 0.191, train f1 : 0.938, valid f1 : 0.810
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [41:03<1:44:12, 68.71s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [42:04<1:39:55, 66.61s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [43:11<1:38:37, 66.49s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [44:19<1:38:14, 66.99s/it]Best score increase :0.858 -> 0.864
epoch : 41, train loss : 0.147, valid loss : 0.157, train f1 : 0.943, valid f1 : 0.835
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [45:21<1:34:51, 65.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [46:34<1:37:07, 67.76s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [47:44<1:36:49, 68.35s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [48:34<1:28:08, 62.95s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.133, valid loss : 0.128, train f1 : 0.948, valid f1 : 0.861
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [49:54<1:34:05, 68.01s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [51:02<1:32:59, 68.04s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [51:56<1:26:03, 63.75s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [53:08<1:28:27, 66.35s/it]EarlyStopping counter : 8 out of 12
epoch : 49, train loss : 0.129, valid loss : 0.142, train f1 : 0.949, valid f1 : 0.844
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [54:27<1:32:10, 70.01s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [55:21<1:24:50, 65.26s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [56:31<1:25:51, 66.90s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [57:42<1:26:02, 67.92s/it]Best score increase :0.864 -> 0.871
epoch : 53, train loss : 0.125, valid loss : 0.159, train f1 : 0.952, valid f1 : 0.838
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [58:43<1:22:15, 65.81s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [59:54<1:23:09, 67.43s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:01:07<1:24:13, 69.22s/it]Best score increase :0.871 -> 0.877
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [1:01:56<1:15:50, 63.21s/it]EarlyStopping counter : 1 out of 12
epoch : 57, train loss : 0.115, valid loss : 0.124, train f1 : 0.956, valid f1 : 0.879
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [1:03:16<1:20:35, 68.10s/it]Best score increase :0.877 -> 0.879
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [1:04:27<1:20:34, 69.07s/it]Best score increase :0.879 -> 0.881
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:05:17<1:12:44, 63.26s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:06:27<1:14:05, 65.38s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.109, valid loss : 0.124, train f1 : 0.959, valid f1 : 0.865
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:07:44<1:16:51, 68.84s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:08:33<1:09:04, 62.80s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:09:45<1:10:58, 65.51s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:10:59<1:12:37, 68.09s/it]Best score increase :0.881 -> 0.886
epoch : 65, train loss : 0.104, valid loss : 0.127, train f1 : 0.959, valid f1 : 0.878
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:11:55<1:07:51, 64.63s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:13:12<1:10:23, 68.12s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:14:22<1:09:52, 68.73s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:15:16<1:04:29, 64.49s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.096, valid loss : 0.139, train f1 : 0.964, valid f1 : 0.867
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:16:39<1:08:42, 69.88s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:17:45<1:06:35, 68.88s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:18:37<1:00:26, 63.62s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:19:49<1:01:55, 66.35s/it]EarlyStopping counter : 8 out of 12
epoch : 73, train loss : 0.087, valid loss : 0.123, train f1 : 0.968, valid f1 : 0.884
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:21:07<1:03:45, 69.56s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:22:04<59:18, 65.89s/it]  EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:23:17<1:00:05, 68.02s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:24:21<59:36, 67.49s/it]  
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 75, best f1 score : 0.887
training process finished, best loss : 0.123, best acc : 0.964, best f1 : 0.887, best epoch : 74

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.77      0.82      0.79       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.88      0.90      0.89      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.89, test AUC : 0.90, test loss : 7.151

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.42s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.42s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.44s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.45s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.54s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.60s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.78s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.71s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.64s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:15,  7.57s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.60s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.64s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.60s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 104.66it/s]  8%|▊         | 23/306 [00:00<00:02, 113.17it/s] 12%|█▏        | 38/306 [00:00<00:02, 123.51it/s] 18%|█▊        | 54/306 [00:00<00:01, 135.07it/s] 23%|██▎       | 70/306 [00:00<00:01, 141.64it/s] 28%|██▊       | 85/306 [00:00<00:01, 136.50it/s] 32%|███▏      | 99/306 [00:00<00:01, 132.80it/s] 37%|███▋      | 113/306 [00:00<00:01, 131.18it/s] 42%|████▏     | 127/306 [00:00<00:01, 129.60it/s] 46%|████▌     | 141/306 [00:01<00:01, 130.18it/s] 51%|█████     | 156/306 [00:01<00:01, 135.86it/s] 56%|█████▌    | 172/306 [00:01<00:00, 139.02it/s] 61%|██████    | 186/306 [00:01<00:00, 137.64it/s] 65%|██████▌   | 200/306 [00:01<00:00, 134.43it/s] 70%|██████▉   | 214/306 [00:01<00:00, 131.84it/s] 75%|███████▍  | 228/306 [00:01<00:00, 130.20it/s] 79%|███████▉  | 242/306 [00:01<00:00, 128.56it/s] 84%|████████▍ | 257/306 [00:01<00:00, 130.10it/s] 89%|████████▉ | 272/306 [00:02<00:00, 133.65it/s] 94%|█████████▍| 287/306 [00:02<00:00, 133.51it/s] 99%|█████████▊| 302/306 [00:02<00:00, 137.12it/s]100%|██████████| 306/306 [00:02<00:00, 131.73it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 62/553 [00:00<00:00, 613.79it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:00, 609.94it/s]extract the null data:  33%|███▎      | 185/553 [00:00<00:00, 606.18it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:00, 610.08it/s]extract the null data:  56%|█████▌    | 309/553 [00:00<00:00, 608.29it/s]extract the null data:  67%|██████▋   | 371/553 [00:00<00:00, 610.00it/s]extract the null data:  78%|███████▊  | 433/553 [00:00<00:00, 601.47it/s]extract the null data:  89%|████████▉ | 494/553 [00:00<00:00, 603.14it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 606.08it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 199.65it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:02, 212.10it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:02, 216.99it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 210.16it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 206.55it/s]replace nan value:  24%|██▎       | 131/553 [00:00<00:02, 206.33it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:01, 209.07it/s]replace nan value:  32%|███▏      | 176/553 [00:00<00:01, 213.69it/s]replace nan value:  36%|███▌      | 198/553 [00:00<00:01, 215.20it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 213.98it/s]replace nan value:  44%|████▍     | 242/553 [00:01<00:01, 210.72it/s]replace nan value:  48%|████▊     | 264/553 [00:01<00:01, 208.79it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 210.37it/s]replace nan value:  56%|█████▌    | 308/553 [00:01<00:01, 208.59it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 208.57it/s]replace nan value:  63%|██████▎   | 351/553 [00:01<00:00, 210.18it/s]replace nan value:  67%|██████▋   | 373/553 [00:01<00:00, 205.17it/s]replace nan value:  71%|███████   | 394/553 [00:01<00:00, 202.60it/s]replace nan value:  75%|███████▌  | 415/553 [00:01<00:00, 199.64it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 196.88it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 198.80it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 201.33it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 200.58it/s]replace nan value:  94%|█████████▍| 519/553 [00:02<00:00, 197.06it/s]replace nan value:  98%|█████████▊| 541/553 [00:02<00:00, 202.68it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 206.33it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 141.46it/s]  6%|▌         | 31/553 [00:00<00:03, 151.86it/s]  8%|▊         | 47/553 [00:00<00:04, 126.05it/s] 11%|█         | 61/553 [00:00<00:03, 123.74it/s] 14%|█▍        | 77/553 [00:00<00:03, 133.60it/s] 16%|█▋        | 91/553 [00:00<00:03, 135.31it/s] 19%|█▉        | 107/553 [00:00<00:03, 141.08it/s] 22%|██▏       | 124/553 [00:00<00:02, 146.59it/s] 26%|██▌       | 142/553 [00:00<00:02, 154.51it/s] 29%|██▉       | 162/553 [00:01<00:02, 163.69it/s] 33%|███▎      | 180/553 [00:01<00:02, 167.03it/s] 36%|███▌      | 197/553 [00:01<00:02, 167.50it/s] 39%|███▉      | 215/553 [00:01<00:01, 170.36it/s] 42%|████▏     | 233/553 [00:01<00:02, 158.65it/s] 45%|████▌     | 250/553 [00:01<00:01, 157.78it/s] 48%|████▊     | 266/553 [00:01<00:01, 150.29it/s] 51%|█████     | 282/553 [00:01<00:01, 142.89it/s] 54%|█████▎    | 297/553 [00:02<00:01, 135.64it/s] 56%|█████▌    | 311/553 [00:02<00:01, 131.86it/s] 59%|█████▉    | 325/553 [00:02<00:01, 132.36it/s] 61%|██████▏   | 339/553 [00:02<00:01, 131.27it/s] 64%|██████▍   | 353/553 [00:02<00:01, 129.43it/s] 66%|██████▌   | 366/553 [00:02<00:01, 124.81it/s] 69%|██████▉   | 381/553 [00:02<00:01, 130.98it/s] 71%|███████▏  | 395/553 [00:02<00:01, 118.81it/s] 74%|███████▍  | 408/553 [00:02<00:01, 121.17it/s] 76%|███████▌  | 421/553 [00:03<00:01, 117.37it/s] 78%|███████▊  | 433/553 [00:03<00:01, 114.02it/s] 82%|████████▏ | 451/553 [00:03<00:00, 128.48it/s] 84%|████████▍ | 465/553 [00:03<00:00, 131.29it/s] 87%|████████▋ | 479/553 [00:03<00:00, 127.19it/s] 89%|████████▉ | 492/553 [00:03<00:00, 123.53it/s] 91%|█████████▏| 505/553 [00:03<00:00, 120.60it/s] 94%|█████████▍| 520/553 [00:03<00:00, 125.81it/s] 96%|█████████▋| 533/553 [00:03<00:00, 108.08it/s] 99%|█████████▉| 549/553 [00:04<00:00, 119.24it/s]100%|██████████| 553/553 [00:04<00:00, 131.92it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 265.92it/s]extract the null data:  58%|█████▊    | 80/139 [00:00<00:00, 418.12it/s]extract the null data:  98%|█████████▊| 136/139 [00:00<00:00, 482.28it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 451.29it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 192.97it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 194.64it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 192.31it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 195.02it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 193.28it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 192.83it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 194.74it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 116.16it/s] 18%|█▊        | 25/139 [00:00<00:00, 123.69it/s] 28%|██▊       | 39/139 [00:00<00:00, 130.53it/s] 38%|███▊      | 53/139 [00:00<00:00, 123.61it/s] 47%|████▋     | 66/139 [00:00<00:00, 125.00it/s] 57%|█████▋    | 79/139 [00:00<00:00, 117.93it/s] 65%|██████▌   | 91/139 [00:00<00:00, 108.14it/s] 75%|███████▍  | 104/139 [00:00<00:00, 112.74it/s] 83%|████████▎ | 116/139 [00:00<00:00, 114.14it/s] 93%|█████████▎| 129/139 [00:01<00:00, 116.96it/s]100%|██████████| 139/139 [00:01<00:00, 118.50it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 259.22it/s]extract the null data:  44%|████▍     | 76/173 [00:00<00:00, 398.31it/s]extract the null data:  73%|███████▎  | 127/173 [00:00<00:00, 446.69it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 432.46it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 176.31it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 176.78it/s]replace nan value:  32%|███▏      | 55/173 [00:00<00:00, 181.44it/s]replace nan value:  43%|████▎     | 74/173 [00:00<00:00, 181.01it/s]replace nan value:  54%|█████▍    | 93/173 [00:00<00:00, 180.61it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 181.51it/s]replace nan value:  76%|███████▌  | 131/173 [00:00<00:00, 181.29it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 180.33it/s]replace nan value:  98%|█████████▊| 169/173 [00:00<00:00, 176.93it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 178.60it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 127.88it/s] 15%|█▌        | 26/173 [00:00<00:01, 103.97it/s] 23%|██▎       | 39/173 [00:00<00:01, 113.05it/s] 31%|███       | 54/173 [00:00<00:00, 123.12it/s] 39%|███▊      | 67/173 [00:00<00:00, 124.72it/s] 46%|████▌     | 80/173 [00:00<00:00, 124.98it/s] 54%|█████▍    | 94/173 [00:00<00:00, 127.92it/s] 62%|██████▏   | 107/173 [00:00<00:00, 125.41it/s] 69%|██████▉   | 120/173 [00:00<00:00, 124.05it/s] 77%|███████▋  | 133/173 [00:01<00:00, 116.97it/s] 84%|████████▍ | 145/173 [00:01<00:00, 117.16it/s] 91%|█████████ | 157/173 [00:01<00:00, 106.84it/s] 97%|█████████▋| 168/173 [00:01<00:00, 87.69it/s] 100%|██████████| 173/173 [00:01<00:00, 106.68it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.080, valid loss : 0.059, train acc : 0.917, valid acc : 0.923, train f1 : 0.554, valid f1 : 0.566
training process:   1%|          | 1/128 [01:30<3:12:03, 90.74s/it]Best score increase :0.000 -> 0.566
training process:   2%|▏         | 2/128 [02:34<2:37:17, 74.90s/it]Best score increase :0.566 -> 0.663
training process:   2%|▏         | 3/128 [03:38<2:25:52, 70.02s/it]Best score increase :0.663 -> 0.702
training process:   3%|▎         | 4/128 [04:57<2:31:41, 73.40s/it]Best score increase :0.702 -> 0.737
epoch : 5, train loss : 0.041, valid loss : 0.048, train acc : 0.951, valid acc : 0.945, train f1 : 0.791, valid f1 : 0.752
training process:   4%|▍         | 5/128 [06:10<2:30:16, 73.31s/it]Best score increase :0.737 -> 0.752
training process:   5%|▍         | 6/128 [07:21<2:27:30, 72.55s/it]Best score increase :0.752 -> 0.782
training process:   5%|▌         | 7/128 [08:42<2:31:33, 75.15s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:37<2:18:02, 69.02s/it]Best score increase :0.782 -> 0.794
epoch : 9, train loss : 0.035, valid loss : 0.041, train acc : 0.959, valid acc : 0.952, train f1 : 0.831, valid f1 : 0.799
training process:   7%|▋         | 9/128 [10:59<2:24:21, 72.79s/it]Best score increase :0.794 -> 0.799
training process:   8%|▊         | 10/128 [12:16<2:26:09, 74.32s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [13:10<2:12:30, 67.95s/it]Best score increase :0.799 -> 0.802
training process:   9%|▉         | 12/128 [14:27<2:16:50, 70.78s/it]Best score increase :0.802 -> 0.816
epoch : 13, train loss : 0.032, valid loss : 0.045, train acc : 0.962, valid acc : 0.953, train f1 : 0.848, valid f1 : 0.803
training process:  10%|█         | 13/128 [15:54<2:24:56, 75.62s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [16:51<2:12:50, 69.92s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [17:56<2:09:21, 68.69s/it]Best score increase :0.816 -> 0.833
training process:  12%|█▎        | 16/128 [19:08<2:09:37, 69.45s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.030, valid loss : 0.042, train acc : 0.964, valid acc : 0.956, train f1 : 0.860, valid f1 : 0.815
training process:  13%|█▎        | 17/128 [20:20<2:10:11, 70.38s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [21:19<2:02:42, 66.93s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [22:27<2:01:58, 67.14s/it]EarlyStopping counter : 4 out of 12
training process:  16%|█▌        | 20/128 [23:41<2:04:58, 69.43s/it]EarlyStopping counter : 5 out of 12
epoch : 21, train loss : 0.029, valid loss : 0.041, train acc : 0.966, valid acc : 0.958, train f1 : 0.868, valid f1 : 0.835
training process:  16%|█▋        | 21/128 [24:44<2:00:05, 67.34s/it]Best score increase :0.833 -> 0.835
training process:  17%|█▋        | 22/128 [25:57<2:02:02, 69.08s/it]Best score increase :0.835 -> 0.845
training process:  18%|█▊        | 23/128 [27:06<2:00:46, 69.02s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [28:02<1:52:55, 65.15s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.028, valid loss : 0.045, train acc : 0.967, valid acc : 0.958, train f1 : 0.872, valid f1 : 0.829
training process:  20%|█▉        | 25/128 [29:08<1:52:02, 65.26s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [30:22<1:55:29, 67.93s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [31:21<1:50:06, 65.41s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [32:20<1:45:47, 63.47s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.026, valid loss : 0.045, train acc : 0.969, valid acc : 0.961, train f1 : 0.881, valid f1 : 0.842
training process:  23%|██▎       | 29/128 [33:42<1:53:46, 68.96s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [34:39<1:46:47, 65.38s/it]EarlyStopping counter : 8 out of 12
training process:  24%|██▍       | 31/128 [35:37<1:42:01, 63.10s/it]EarlyStopping counter : 9 out of 12
training process:  25%|██▌       | 32/128 [36:45<1:43:30, 64.69s/it]Best score increase :0.845 -> 0.850
epoch : 33, train loss : 0.025, valid loss : 0.040, train acc : 0.970, valid acc : 0.963, train f1 : 0.886, valid f1 : 0.857
training process:  26%|██▌       | 33/128 [37:59<1:46:45, 67.43s/it]Best score increase :0.850 -> 0.857
training process:  27%|██▋       | 34/128 [38:47<1:36:33, 61.64s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [39:53<1:37:28, 62.89s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [41:10<1:43:01, 67.19s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.024, valid loss : 0.048, train acc : 0.972, valid acc : 0.960, train f1 : 0.892, valid f1 : 0.837
training process:  29%|██▉       | 37/128 [42:20<1:43:13, 68.06s/it]EarlyStopping counter : 4 out of 12
training process:  30%|██▉       | 38/128 [43:38<1:46:23, 70.93s/it]EarlyStopping counter : 5 out of 12
training process:  30%|███       | 39/128 [44:47<1:44:23, 70.38s/it]EarlyStopping counter : 6 out of 12
training process:  31%|███▏      | 40/128 [45:50<1:39:52, 68.10s/it]Best score increase :0.857 -> 0.860
epoch : 41, train loss : 0.024, valid loss : 0.045, train acc : 0.971, valid acc : 0.961, train f1 : 0.888, valid f1 : 0.845
training process:  32%|███▏      | 41/128 [47:01<1:40:10, 69.08s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [48:14<1:40:45, 70.29s/it]Best score increase :0.860 -> 0.864
training process:  34%|███▎      | 43/128 [49:19<1:37:24, 68.76s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [50:20<1:32:44, 66.25s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.024, valid loss : 0.042, train acc : 0.972, valid acc : 0.963, train f1 : 0.895, valid f1 : 0.860
training process:  35%|███▌      | 45/128 [51:42<1:38:13, 71.01s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [52:45<1:33:41, 68.56s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [53:41<1:27:33, 64.86s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [54:56<1:30:23, 67.80s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.023, valid loss : 0.044, train acc : 0.973, valid acc : 0.963, train f1 : 0.898, valid f1 : 0.856
training process:  38%|███▊      | 49/128 [56:10<1:31:55, 69.82s/it]EarlyStopping counter : 7 out of 12
training process:  39%|███▉      | 50/128 [57:13<1:28:11, 67.84s/it]Best score increase :0.864 -> 0.874
training process:  40%|███▉      | 51/128 [58:21<1:26:48, 67.64s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [59:28<1:25:37, 67.59s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.022, valid loss : 0.046, train acc : 0.974, valid acc : 0.965, train f1 : 0.901, valid f1 : 0.863
training process:  41%|████▏     | 53/128 [1:00:26<1:20:54, 64.73s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [1:01:40<1:23:04, 67.36s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [1:02:52<1:23:41, 68.79s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [1:03:47<1:17:32, 64.61s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.021, valid loss : 0.045, train acc : 0.974, valid acc : 0.963, train f1 : 0.905, valid f1 : 0.856
training process:  45%|████▍     | 57/128 [1:05:07<1:22:10, 69.45s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [1:06:23<1:23:13, 71.34s/it]EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [1:07:14<1:14:58, 65.20s/it]EarlyStopping counter : 9 out of 12
training process:  47%|████▋     | 60/128 [1:08:25<1:15:44, 66.82s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.021, valid loss : 0.045, train acc : 0.974, valid acc : 0.963, train f1 : 0.904, valid f1 : 0.857
training process:  48%|████▊     | 61/128 [1:09:46<1:19:36, 71.30s/it]EarlyStopping counter : 11 out of 12
training process:  48%|████▊     | 61/128 [1:10:44<1:17:42, 69.58s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.874
training process finished, best loss : 0.037 and best acc : 0.966, best f1 : 0.874, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.65      0.77       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.96      0.82      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.82, test loss : 2.583

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.01s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.83s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.81s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.79s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.88s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.84s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:40,  8.03s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:32,  8.14s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:12<00:25,  8.43s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:16,  8.42s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:29<00:08,  8.28s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.44s/it]processing for feature importance: 100%|██████████| 12/12 [01:38<00:00,  8.17s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 20/306 [00:00<00:01, 199.30it/s] 13%|█▎        | 40/306 [00:00<00:02, 130.45it/s] 18%|█▊        | 55/306 [00:00<00:02, 118.46it/s] 24%|██▍       | 73/306 [00:00<00:01, 132.64it/s] 28%|██▊       | 87/306 [00:00<00:01, 133.38it/s] 33%|███▎      | 101/306 [00:00<00:01, 113.10it/s] 40%|████      | 123/306 [00:00<00:01, 138.69it/s] 45%|████▌     | 138/306 [00:01<00:01, 127.52it/s] 50%|████▉     | 152/306 [00:01<00:01, 114.87it/s] 56%|█████▌    | 172/306 [00:01<00:00, 135.27it/s] 61%|██████    | 187/306 [00:01<00:00, 128.68it/s] 66%|██████▌   | 201/306 [00:01<00:00, 114.71it/s] 72%|███████▏  | 221/306 [00:01<00:00, 132.06it/s] 77%|███████▋  | 235/306 [00:01<00:00, 127.91it/s] 81%|████████▏ | 249/306 [00:01<00:00, 114.08it/s] 88%|████████▊ | 269/306 [00:02<00:00, 131.95it/s] 92%|█████████▏| 283/306 [00:02<00:00, 128.48it/s] 97%|█████████▋| 297/306 [00:02<00:00, 113.29it/s]100%|██████████| 306/306 [00:02<00:00, 126.38it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 55/553 [00:00<00:00, 549.08it/s]extract the null data:  20%|██        | 111/553 [00:00<00:00, 554.54it/s]extract the null data:  30%|███       | 168/553 [00:00<00:00, 557.63it/s]extract the null data:  41%|████      | 225/553 [00:00<00:00, 558.74it/s]extract the null data:  51%|█████     | 281/553 [00:00<00:00, 556.53it/s]extract the null data:  61%|██████    | 337/553 [00:00<00:00, 548.58it/s]extract the null data:  71%|███████   | 392/553 [00:00<00:00, 547.11it/s]extract the null data:  81%|████████  | 449/553 [00:00<00:00, 550.95it/s]extract the null data:  91%|█████████▏| 505/553 [00:00<00:00, 552.20it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 548.77it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 182.37it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 184.88it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 183.10it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 185.60it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:02, 186.88it/s]replace nan value:  21%|██        | 115/553 [00:00<00:02, 187.23it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 186.43it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:02, 188.86it/s]replace nan value:  31%|███▏      | 173/553 [00:00<00:02, 188.56it/s]replace nan value:  35%|███▍      | 192/553 [00:01<00:01, 187.91it/s]replace nan value:  38%|███▊      | 212/553 [00:01<00:01, 190.09it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 188.52it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 187.85it/s]replace nan value:  49%|████▉     | 271/553 [00:01<00:01, 189.35it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 189.06it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 188.20it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 188.71it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:01, 189.70it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 191.12it/s]replace nan value:  70%|███████   | 389/553 [00:02<00:00, 193.94it/s]replace nan value:  74%|███████▍  | 409/553 [00:02<00:00, 194.09it/s]replace nan value:  78%|███████▊  | 429/553 [00:02<00:00, 191.69it/s]replace nan value:  81%|████████  | 449/553 [00:02<00:00, 192.68it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 190.93it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 189.84it/s]replace nan value:  92%|█████████▏| 508/553 [00:02<00:00, 188.03it/s]replace nan value:  95%|█████████▌| 527/553 [00:02<00:00, 186.66it/s]replace nan value:  99%|█████████▊| 546/553 [00:02<00:00, 187.14it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 188.61it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 119.55it/s]  5%|▍         | 25/553 [00:00<00:04, 123.67it/s]  7%|▋         | 39/553 [00:00<00:04, 124.51it/s]  9%|▉         | 52/553 [00:00<00:04, 111.80it/s] 12%|█▏        | 64/553 [00:00<00:04, 101.97it/s] 14%|█▍        | 77/553 [00:00<00:04, 107.05it/s] 16%|█▋        | 90/553 [00:00<00:04, 113.06it/s] 18%|█▊        | 102/553 [00:00<00:04, 107.80it/s] 21%|██        | 117/553 [00:01<00:03, 119.38it/s] 24%|██▎       | 130/553 [00:01<00:03, 117.30it/s] 26%|██▋       | 146/553 [00:01<00:03, 129.07it/s] 29%|██▉       | 161/553 [00:01<00:02, 134.45it/s] 32%|███▏      | 175/553 [00:01<00:02, 134.04it/s] 34%|███▍      | 189/553 [00:01<00:02, 133.03it/s] 37%|███▋      | 205/553 [00:01<00:02, 140.16it/s] 40%|███▉      | 220/553 [00:01<00:02, 130.29it/s] 42%|████▏     | 234/553 [00:01<00:02, 129.62it/s] 45%|████▍     | 248/553 [00:02<00:02, 130.27it/s] 47%|████▋     | 262/553 [00:02<00:02, 131.14it/s] 50%|████▉     | 276/553 [00:02<00:02, 121.66it/s] 52%|█████▏    | 290/553 [00:02<00:02, 123.70it/s] 55%|█████▍    | 303/553 [00:02<00:02, 120.62it/s] 57%|█████▋    | 316/553 [00:02<00:02, 118.00it/s] 59%|█████▉    | 329/553 [00:02<00:01, 120.46it/s] 62%|██████▏   | 345/553 [00:02<00:01, 125.95it/s] 65%|██████▍   | 358/553 [00:02<00:01, 126.03it/s] 68%|██████▊   | 374/553 [00:03<00:01, 133.61it/s] 70%|███████   | 388/553 [00:03<00:01, 124.09it/s] 73%|███████▎  | 401/553 [00:03<00:01, 116.98it/s] 75%|███████▌  | 416/553 [00:03<00:01, 121.09it/s] 78%|███████▊  | 429/553 [00:03<00:01, 116.26it/s] 81%|████████  | 447/553 [00:03<00:00, 132.37it/s] 84%|████████▎ | 462/553 [00:03<00:00, 135.89it/s] 86%|████████▋ | 477/553 [00:03<00:00, 138.55it/s] 89%|████████▉ | 492/553 [00:03<00:00, 129.72it/s] 92%|█████████▏| 506/553 [00:04<00:00, 127.78it/s] 94%|█████████▍| 521/553 [00:04<00:00, 128.60it/s] 97%|█████████▋| 534/553 [00:04<00:00, 115.36it/s] 99%|█████████▉| 550/553 [00:04<00:00, 125.33it/s]100%|██████████| 553/553 [00:04<00:00, 122.35it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 30/139 [00:00<00:00, 299.14it/s]extract the null data:  68%|██████▊   | 94/139 [00:00<00:00, 496.37it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 511.08it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 215.70it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 212.62it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 209.09it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 210.49it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 207.35it/s]replace nan value:  94%|█████████▍| 131/139 [00:00<00:00, 207.92it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 209.02it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.35it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.61it/s] 29%|██▉       | 40/139 [00:00<00:00, 133.13it/s] 39%|███▉      | 54/139 [00:00<00:00, 125.65it/s] 48%|████▊     | 67/139 [00:00<00:00, 124.46it/s] 58%|█████▊    | 80/139 [00:00<00:00, 122.08it/s] 67%|██████▋   | 93/139 [00:00<00:00, 111.30it/s] 76%|███████▋  | 106/139 [00:00<00:00, 113.81it/s] 88%|████████▊ | 122/139 [00:01<00:00, 122.81it/s] 97%|█████████▋| 135/139 [00:01<00:00, 121.47it/s]100%|██████████| 139/139 [00:01<00:00, 122.75it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 288.59it/s]extract the null data:  54%|█████▍    | 94/173 [00:00<00:00, 496.75it/s]extract the null data:  91%|█████████ | 157/173 [00:00<00:00, 554.10it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 523.32it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 204.40it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 205.03it/s]replace nan value:  36%|███▋      | 63/173 [00:00<00:00, 205.68it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 202.24it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 202.72it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 205.65it/s]replace nan value:  86%|████████▌ | 148/173 [00:00<00:00, 204.85it/s]replace nan value:  98%|█████████▊| 169/173 [00:00<00:00, 202.65it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 203.30it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 136.72it/s] 16%|█▌        | 28/173 [00:00<00:01, 117.36it/s] 25%|██▍       | 43/173 [00:00<00:01, 128.37it/s] 34%|███▍      | 59/173 [00:00<00:00, 138.39it/s] 43%|████▎     | 75/173 [00:00<00:00, 140.67it/s] 53%|█████▎    | 92/173 [00:00<00:00, 144.69it/s] 62%|██████▏   | 108/173 [00:00<00:00, 147.39it/s] 71%|███████   | 123/173 [00:00<00:00, 144.45it/s] 80%|███████▉  | 138/173 [00:00<00:00, 145.36it/s] 88%|████████▊ | 153/173 [00:01<00:00, 138.54it/s] 97%|█████████▋| 167/173 [00:01<00:00, 110.10it/s]100%|██████████| 173/173 [00:01<00:00, 126.32it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.085, train acc : 0.715, valid acc : 0.888, train f1 : 0.711, valid f1 : 0.723
training process:   1%|          | 1/128 [01:22<2:55:34, 82.95s/it]Best score increase :0.000 -> 0.723
training process:   2%|▏         | 2/128 [02:15<2:16:27, 64.98s/it]Best score increase :0.723 -> 0.732
training process:   2%|▏         | 3/128 [03:30<2:25:23, 69.79s/it]Best score increase :0.732 -> 0.776
training process:   3%|▎         | 4/128 [04:39<2:23:11, 69.29s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.081, valid loss : 0.075, train acc : 0.858, valid acc : 0.884, train f1 : 0.858, valid f1 : 0.745
training process:   4%|▍         | 5/128 [05:40<2:16:00, 66.35s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [06:54<2:20:05, 68.90s/it]EarlyStopping counter : 3 out of 12
training process:   5%|▌         | 7/128 [08:00<2:16:52, 67.87s/it]Best score increase :0.776 -> 0.787
training process:   6%|▋         | 8/128 [08:56<2:08:39, 64.33s/it]Best score increase :0.787 -> 0.818
epoch : 9, train loss : 0.069, valid loss : 0.073, train acc : 0.885, valid acc : 0.885, train f1 : 0.885, valid f1 : 0.748
training process:   7%|▋         | 9/128 [10:20<2:19:44, 70.46s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [11:23<2:13:53, 68.08s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [12:25<2:08:54, 66.10s/it]EarlyStopping counter : 3 out of 12
training process:   9%|▉         | 12/128 [13:39<2:12:40, 68.63s/it]EarlyStopping counter : 4 out of 12
epoch : 13, train loss : 0.065, valid loss : 0.056, train acc : 0.893, valid acc : 0.927, train f1 : 0.893, valid f1 : 0.810
training process:  10%|█         | 13/128 [14:50<2:12:54, 69.34s/it]EarlyStopping counter : 5 out of 12
training process:  11%|█         | 14/128 [15:53<2:07:49, 67.28s/it]Best score increase :0.818 -> 0.826
training process:  12%|█▏        | 15/128 [17:06<2:10:13, 69.15s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [18:07<2:04:25, 66.65s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.058, valid loss : 0.054, train acc : 0.904, valid acc : 0.928, train f1 : 0.904, valid f1 : 0.813
training process:  13%|█▎        | 17/128 [19:16<2:04:35, 67.35s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [20:32<2:08:23, 70.03s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [21:31<2:00:57, 66.58s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [22:37<1:59:51, 66.59s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.054, valid loss : 0.057, train acc : 0.914, valid acc : 0.922, train f1 : 0.914, valid f1 : 0.806
training process:  16%|█▋        | 21/128 [24:01<2:08:09, 71.86s/it]EarlyStopping counter : 7 out of 12
training process:  17%|█▋        | 22/128 [24:54<1:56:50, 66.13s/it]Best score increase :0.826 -> 0.828
training process:  18%|█▊        | 23/128 [26:01<1:56:12, 66.40s/it]Best score increase :0.828 -> 0.831
training process:  19%|█▉        | 24/128 [27:16<1:59:21, 68.86s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.051, valid loss : 0.049, train acc : 0.920, valid acc : 0.937, train f1 : 0.920, valid f1 : 0.830
training process:  20%|█▉        | 25/128 [28:21<1:56:08, 67.65s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [29:31<1:56:30, 68.53s/it]Best score increase :0.831 -> 0.836
training process:  21%|██        | 27/128 [30:47<1:58:50, 70.59s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [31:39<1:48:42, 65.22s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.048, valid loss : 0.053, train acc : 0.925, valid acc : 0.929, train f1 : 0.925, valid f1 : 0.818
training process:  23%|██▎       | 29/128 [32:56<1:53:17, 68.66s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [34:10<1:54:49, 70.30s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [35:04<1:45:45, 65.42s/it]EarlyStopping counter : 5 out of 12
training process:  25%|██▌       | 32/128 [36:13<1:46:28, 66.55s/it]Best score increase :0.836 -> 0.838
epoch : 33, train loss : 0.044, valid loss : 0.051, train acc : 0.932, valid acc : 0.935, train f1 : 0.932, valid f1 : 0.829
training process:  26%|██▌       | 33/128 [37:35<1:52:26, 71.01s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [38:29<1:43:11, 65.87s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [39:40<1:44:27, 67.40s/it]Best score increase :0.838 -> 0.841
training process:  28%|██▊       | 36/128 [40:49<1:44:10, 67.94s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.043, valid loss : 0.052, train acc : 0.933, valid acc : 0.934, train f1 : 0.933, valid f1 : 0.829
training process:  29%|██▉       | 37/128 [41:56<1:42:34, 67.63s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [42:53<1:36:51, 64.58s/it]Best score increase :0.841 -> 0.850
training process:  30%|███       | 39/128 [43:57<1:35:12, 64.19s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [45:01<1:34:22, 64.35s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.041, valid loss : 0.053, train acc : 0.938, valid acc : 0.925, train f1 : 0.938, valid f1 : 0.813
training process:  32%|███▏      | 41/128 [46:13<1:36:40, 66.67s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [47:09<1:30:55, 63.44s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [48:24<1:34:34, 66.75s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [49:24<1:30:54, 64.94s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.039, valid loss : 0.047, train acc : 0.943, valid acc : 0.942, train f1 : 0.943, valid f1 : 0.844
training process:  35%|███▌      | 45/128 [50:34<1:31:49, 66.38s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [51:41<1:30:55, 66.53s/it]EarlyStopping counter : 8 out of 12
training process:  37%|███▋      | 47/128 [52:56<1:33:12, 69.04s/it]EarlyStopping counter : 9 out of 12
training process:  38%|███▊      | 48/128 [53:53<1:27:07, 65.34s/it]EarlyStopping counter : 10 out of 12
epoch : 49, train loss : 0.038, valid loss : 0.043, train acc : 0.943, valid acc : 0.943, train f1 : 0.943, valid f1 : 0.845
training process:  38%|███▊      | 49/128 [55:08<1:30:09, 68.48s/it]EarlyStopping counter : 11 out of 12
training process:  38%|███▊      | 49/128 [56:23<1:30:55, 69.06s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 49, best f1 score : 0.850
training process finished, best loss : 0.043 and best acc : 0.947, best f1 : 0.850, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.59      0.83      0.69       580
           1       0.99      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.79      0.89      0.83      7398
weighted avg       0.95      0.94      0.95      7398


# test acc : 0.94, test f1 : 0.83, test AUC : 0.89, test loss : 2.557

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.55s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:15,  7.54s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.46s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.47s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.52s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.55s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.57s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.52s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.53s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:15,  7.65s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.58s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.57s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.55s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▌         | 16/306 [00:00<00:01, 147.93it/s] 10%|█         | 31/306 [00:00<00:02, 105.96it/s] 14%|█▍        | 43/306 [00:00<00:02, 108.33it/s] 19%|█▊        | 57/306 [00:00<00:02, 115.11it/s] 23%|██▎       | 69/306 [00:00<00:02, 106.91it/s] 29%|██▉       | 89/306 [00:00<00:01, 133.21it/s] 34%|███▎      | 103/306 [00:00<00:01, 127.60it/s] 38%|███▊      | 117/306 [00:01<00:01, 110.42it/s] 45%|████▌     | 138/306 [00:01<00:01, 133.15it/s] 50%|█████     | 153/306 [00:01<00:01, 129.64it/s] 55%|█████▍    | 167/306 [00:01<00:01, 113.38it/s] 62%|██████▏   | 189/306 [00:01<00:00, 137.02it/s] 67%|██████▋   | 204/306 [00:01<00:00, 130.38it/s] 71%|███████   | 218/306 [00:01<00:00, 113.64it/s] 77%|███████▋  | 236/306 [00:01<00:00, 127.61it/s] 82%|████████▏ | 250/306 [00:02<00:00, 120.95it/s] 86%|████████▌ | 263/306 [00:02<00:00, 110.52it/s] 92%|█████████▏| 280/306 [00:02<00:00, 123.99it/s] 96%|█████████▌| 294/306 [00:02<00:00, 121.86it/s]100%|██████████| 306/306 [00:02<00:00, 119.07it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:00, 533.26it/s]extract the null data:  20%|█▉        | 108/553 [00:00<00:00, 519.59it/s]extract the null data:  29%|██▉       | 160/553 [00:00<00:00, 512.89it/s]extract the null data:  38%|███▊      | 212/553 [00:00<00:00, 506.08it/s]extract the null data:  48%|████▊     | 263/553 [00:00<00:00, 493.27it/s]extract the null data:  57%|█████▋    | 313/553 [00:00<00:00, 486.42it/s]extract the null data:  66%|██████▌   | 366/553 [00:00<00:00, 499.61it/s]extract the null data:  76%|███████▌  | 418/553 [00:00<00:00, 505.02it/s]extract the null data:  85%|████████▍ | 469/553 [00:00<00:00, 504.90it/s]extract the null data:  94%|█████████▍| 520/553 [00:01<00:00, 504.50it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 505.75it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 175.02it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 173.66it/s]replace nan value:  10%|▉         | 54/553 [00:00<00:02, 173.49it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 177.27it/s]replace nan value:  16%|█▋        | 91/553 [00:00<00:02, 175.95it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 177.59it/s]replace nan value:  23%|██▎       | 128/553 [00:00<00:02, 175.48it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 175.88it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:02, 176.67it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 176.24it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:01, 178.16it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 178.33it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 176.76it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 175.96it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 178.20it/s]replace nan value:  53%|█████▎    | 292/553 [00:01<00:01, 177.77it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 176.43it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 178.24it/s]replace nan value:  63%|██████▎   | 348/553 [00:01<00:01, 179.41it/s]replace nan value:  66%|██████▌   | 366/553 [00:02<00:01, 178.61it/s]replace nan value:  69%|██████▉   | 384/553 [00:02<00:00, 177.36it/s]replace nan value:  73%|███████▎  | 402/553 [00:02<00:00, 174.90it/s]replace nan value:  76%|███████▌  | 420/553 [00:02<00:00, 173.62it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 174.01it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 174.46it/s]replace nan value:  86%|████████▌ | 474/553 [00:02<00:00, 171.38it/s]replace nan value:  89%|████████▉ | 492/553 [00:02<00:00, 171.33it/s]replace nan value:  92%|█████████▏| 510/553 [00:02<00:00, 172.17it/s]replace nan value:  95%|█████████▌| 528/553 [00:03<00:00, 173.98it/s]replace nan value:  99%|█████████▉| 547/553 [00:03<00:00, 175.80it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 175.64it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.53it/s]  5%|▌         | 28/553 [00:00<00:03, 135.54it/s]  8%|▊         | 42/553 [00:00<00:03, 131.06it/s] 10%|█         | 56/553 [00:00<00:04, 121.63it/s] 12%|█▏        | 69/553 [00:00<00:04, 111.17it/s] 15%|█▌        | 84/553 [00:00<00:03, 121.19it/s] 18%|█▊        | 97/553 [00:00<00:03, 123.39it/s] 20%|██        | 112/553 [00:00<00:03, 131.02it/s] 23%|██▎       | 126/553 [00:01<00:03, 126.82it/s] 26%|██▌       | 144/553 [00:01<00:02, 140.07it/s] 29%|██▉       | 162/553 [00:01<00:02, 147.53it/s] 32%|███▏      | 178/553 [00:01<00:02, 148.92it/s] 35%|███▌      | 194/553 [00:01<00:02, 151.06it/s] 38%|███▊      | 211/553 [00:01<00:02, 153.63it/s] 41%|████      | 227/553 [00:01<00:02, 146.26it/s] 44%|████▍     | 242/553 [00:01<00:02, 143.69it/s] 46%|████▋     | 257/553 [00:01<00:02, 139.92it/s] 49%|████▉     | 272/553 [00:02<00:02, 134.47it/s] 52%|█████▏    | 287/553 [00:02<00:01, 137.82it/s] 54%|█████▍    | 301/553 [00:02<00:01, 131.51it/s] 57%|█████▋    | 315/553 [00:02<00:01, 127.73it/s] 59%|█████▉    | 329/553 [00:02<00:01, 130.65it/s] 62%|██████▏   | 345/553 [00:02<00:01, 135.86it/s] 65%|██████▍   | 359/553 [00:02<00:01, 133.13it/s] 68%|██████▊   | 376/553 [00:02<00:01, 139.66it/s] 71%|███████   | 390/553 [00:02<00:01, 129.59it/s] 73%|███████▎  | 405/553 [00:03<00:01, 132.50it/s] 76%|███████▌  | 419/553 [00:03<00:01, 130.75it/s] 78%|███████▊  | 433/553 [00:03<00:00, 128.49it/s] 82%|████████▏ | 453/553 [00:03<00:00, 142.68it/s] 85%|████████▍ | 470/553 [00:03<00:00, 147.28it/s] 88%|████████▊ | 485/553 [00:03<00:00, 144.56it/s] 90%|█████████ | 500/553 [00:03<00:00, 132.23it/s] 93%|█████████▎| 516/553 [00:03<00:00, 139.06it/s] 96%|█████████▌| 531/553 [00:03<00:00, 119.39it/s] 99%|█████████▉| 548/553 [00:04<00:00, 131.14it/s]100%|██████████| 553/553 [00:04<00:00, 132.43it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  31%|███       | 43/139 [00:00<00:00, 425.47it/s]extract the null data:  79%|███████▉  | 110/139 [00:00<00:00, 563.99it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 565.44it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 219.71it/s]replace nan value:  32%|███▏      | 45/139 [00:00<00:00, 221.45it/s]replace nan value:  49%|████▉     | 68/139 [00:00<00:00, 219.66it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 217.45it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 217.42it/s]replace nan value:  97%|█████████▋| 135/139 [00:00<00:00, 218.32it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 218.53it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 118.18it/s] 19%|█▊        | 26/139 [00:00<00:00, 129.46it/s] 29%|██▉       | 41/139 [00:00<00:00, 137.65it/s] 40%|███▉      | 55/139 [00:00<00:00, 126.63it/s] 50%|████▉     | 69/139 [00:00<00:00, 129.18it/s] 60%|█████▉    | 83/139 [00:00<00:00, 123.59it/s] 69%|██████▉   | 96/139 [00:00<00:00, 116.95it/s] 78%|███████▊  | 109/139 [00:00<00:00, 118.63it/s] 91%|█████████▏| 127/139 [00:00<00:00, 133.56it/s]100%|██████████| 139/139 [00:01<00:00, 129.89it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 39/173 [00:00<00:00, 384.72it/s]extract the null data:  62%|██████▏   | 107/173 [00:00<00:00, 553.28it/s]extract the null data:  99%|█████████▉| 172/173 [00:00<00:00, 596.32it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 567.52it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 219.29it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 218.64it/s]replace nan value:  38%|███▊      | 66/173 [00:00<00:00, 216.85it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 217.19it/s]replace nan value:  64%|██████▎   | 110/173 [00:00<00:00, 217.99it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 223.46it/s]replace nan value:  91%|█████████ | 157/173 [00:00<00:00, 222.02it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 218.71it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 137.45it/s] 16%|█▌        | 28/173 [00:00<00:01, 120.07it/s] 25%|██▍       | 43/173 [00:00<00:00, 132.24it/s] 34%|███▍      | 59/173 [00:00<00:00, 141.02it/s] 43%|████▎     | 74/173 [00:00<00:00, 143.71it/s] 51%|█████▏    | 89/173 [00:00<00:00, 141.16it/s] 60%|██████    | 104/173 [00:00<00:00, 135.32it/s] 68%|██████▊   | 118/173 [00:00<00:00, 134.79it/s] 76%|███████▋  | 132/173 [00:00<00:00, 128.16it/s] 84%|████████▍ | 145/173 [00:01<00:00, 126.28it/s] 91%|█████████▏| 158/173 [00:01<00:00, 115.63it/s] 98%|█████████▊| 170/173 [00:01<00:00, 94.16it/s] 100%|██████████| 173/173 [00:01<00:00, 115.55it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.022, valid loss : 0.020, train acc : 0.756, valid acc : 0.911, train f1 : 0.568, valid f1 : 0.722
training process:   1%|          | 1/128 [01:25<3:00:14, 85.16s/it]Best score increase :0.000 -> 0.722
training process:   2%|▏         | 2/128 [02:22<2:24:39, 68.89s/it]Best score increase :0.722 -> 0.730
training process:   2%|▏         | 3/128 [03:43<2:35:05, 74.44s/it]Best score increase :0.730 -> 0.760
training process:   3%|▎         | 4/128 [04:49<2:26:41, 70.98s/it]Best score increase :0.760 -> 0.775
epoch : 5, train loss : 0.014, valid loss : 0.016, train acc : 0.879, valid acc : 0.943, train f1 : 0.721, valid f1 : 0.813
training process:   4%|▍         | 5/128 [06:00<2:25:23, 70.92s/it]Best score increase :0.775 -> 0.813
training process:   5%|▍         | 6/128 [07:21<2:31:15, 74.39s/it]Best score increase :0.813 -> 0.816
training process:   5%|▌         | 7/128 [08:22<2:21:34, 70.20s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:13<2:07:57, 63.98s/it]Best score increase :0.816 -> 0.840
epoch : 9, train loss : 0.012, valid loss : 0.014, train acc : 0.907, valid acc : 0.932, train f1 : 0.763, valid f1 : 0.809
training process:   7%|▋         | 9/128 [10:16<2:06:08, 63.60s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [11:09<1:58:55, 60.47s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▊         | 11/128 [12:03<1:53:58, 58.45s/it]Best score increase :0.840 -> 0.847
training process:   9%|▉         | 12/128 [12:57<1:50:13, 57.02s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.011, valid loss : 0.015, train acc : 0.917, valid acc : 0.949, train f1 : 0.783, valid f1 : 0.838
training process:  10%|█         | 13/128 [14:02<1:54:10, 59.57s/it]EarlyStopping counter : 2 out of 12
training process:  11%|█         | 14/128 [14:55<1:49:10, 57.46s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 15/128 [15:46<1:44:31, 55.50s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▎        | 16/128 [16:36<1:40:43, 53.96s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.011, valid loss : 0.015, train acc : 0.932, valid acc : 0.951, train f1 : 0.810, valid f1 : 0.847
training process:  13%|█▎        | 17/128 [17:36<1:42:59, 55.67s/it]EarlyStopping counter : 6 out of 12
training process:  14%|█▍        | 18/128 [18:32<1:42:29, 55.91s/it]EarlyStopping counter : 7 out of 12
training process:  15%|█▍        | 19/128 [19:25<1:39:35, 54.82s/it]EarlyStopping counter : 8 out of 12
training process:  16%|█▌        | 20/128 [20:21<1:39:26, 55.25s/it]Best score increase :0.847 -> 0.860
epoch : 21, train loss : 0.010, valid loss : 0.016, train acc : 0.934, valid acc : 0.953, train f1 : 0.816, valid f1 : 0.853
training process:  16%|█▋        | 21/128 [21:19<1:40:00, 56.08s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [22:12<1:37:42, 55.31s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [23:03<1:34:31, 54.01s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [23:56<1:33:01, 53.67s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.010, valid loss : 0.017, train acc : 0.939, valid acc : 0.957, train f1 : 0.826, valid f1 : 0.860
training process:  20%|█▉        | 25/128 [25:01<1:37:39, 56.89s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [25:58<1:37:00, 57.06s/it]EarlyStopping counter : 6 out of 12
training process:  21%|██        | 27/128 [26:50<1:33:26, 55.51s/it]Best score increase :0.860 -> 0.865
training process:  22%|██▏       | 28/128 [27:42<1:30:35, 54.36s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.010, valid loss : 0.018, train acc : 0.945, valid acc : 0.959, train f1 : 0.840, valid f1 : 0.863
training process:  23%|██▎       | 29/128 [28:51<1:36:53, 58.72s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [29:45<1:33:52, 57.48s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [30:39<1:30:55, 56.24s/it]Best score increase :0.865 -> 0.874
training process:  25%|██▌       | 32/128 [31:30<1:27:47, 54.87s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.009, valid loss : 0.015, train acc : 0.946, valid acc : 0.958, train f1 : 0.844, valid f1 : 0.868
training process:  26%|██▌       | 33/128 [32:31<1:29:31, 56.55s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [33:24<1:26:58, 55.51s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [34:15<1:23:49, 54.08s/it]EarlyStopping counter : 4 out of 12
training process:  28%|██▊       | 36/128 [35:07<1:22:15, 53.64s/it]EarlyStopping counter : 5 out of 12
epoch : 37, train loss : 0.009, valid loss : 0.020, train acc : 0.948, valid acc : 0.961, train f1 : 0.847, valid f1 : 0.865
training process:  29%|██▉       | 37/128 [36:08<1:24:38, 55.80s/it]EarlyStopping counter : 6 out of 12
training process:  30%|██▉       | 38/128 [37:02<1:23:02, 55.37s/it]EarlyStopping counter : 7 out of 12
training process:  30%|███       | 39/128 [37:53<1:20:01, 53.95s/it]EarlyStopping counter : 8 out of 12
training process:  31%|███▏      | 40/128 [38:45<1:18:15, 53.35s/it]EarlyStopping counter : 9 out of 12
epoch : 41, train loss : 0.009, valid loss : 0.019, train acc : 0.950, valid acc : 0.958, train f1 : 0.851, valid f1 : 0.860
training process:  32%|███▏      | 41/128 [39:44<1:20:03, 55.21s/it]EarlyStopping counter : 10 out of 12
training process:  33%|███▎      | 42/128 [40:37<1:18:02, 54.44s/it]EarlyStopping counter : 11 out of 12
training process:  33%|███▎      | 42/128 [41:25<1:24:50, 59.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 42, best f1 score : 0.874
training process finished, best loss : 0.017 and best acc : 0.962, best f1 : 0.874, best epoch : 30

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.77      0.73      0.75       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.87      0.86      0.87      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.87, test AUC : 0.86, test loss : 1.133

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.17s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.73s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.77s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:03,  7.89s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.88s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.77s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.62s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.50s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:22,  7.54s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:14,  7.36s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.34s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.28s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.54s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 109.51it/s]  9%|▉         | 29/306 [00:00<00:01, 143.53it/s] 15%|█▍        | 45/306 [00:00<00:01, 147.74it/s] 20%|█▉        | 60/306 [00:00<00:01, 124.95it/s] 25%|██▌       | 78/306 [00:00<00:01, 138.46it/s] 32%|███▏      | 97/306 [00:00<00:01, 152.47it/s] 37%|███▋      | 113/306 [00:00<00:01, 143.78it/s] 42%|████▏     | 128/306 [00:00<00:01, 137.56it/s] 46%|████▋     | 142/306 [00:01<00:01, 135.82it/s] 51%|█████▏    | 157/306 [00:01<00:01, 135.99it/s] 56%|█████▌    | 171/306 [00:01<00:01, 129.29it/s] 61%|██████    | 186/306 [00:01<00:00, 131.46it/s] 66%|██████▌   | 201/306 [00:01<00:00, 135.32it/s] 70%|███████   | 215/306 [00:01<00:00, 125.65it/s] 75%|███████▌  | 231/306 [00:01<00:00, 130.96it/s] 80%|████████  | 246/306 [00:01<00:00, 135.47it/s] 85%|████████▍ | 260/306 [00:01<00:00, 123.74it/s] 90%|█████████ | 276/306 [00:02<00:00, 130.01it/s] 95%|█████████▌| 292/306 [00:02<00:00, 134.40it/s]100%|██████████| 306/306 [00:02<00:00, 123.93it/s]100%|██████████| 306/306 [00:02<00:00, 132.47it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 450.08it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 443.52it/s]extract the null data:  25%|██▍       | 137/553 [00:00<00:00, 437.40it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:00, 448.11it/s]extract the null data:  42%|████▏     | 231/553 [00:00<00:00, 454.03it/s]extract the null data:  50%|█████     | 277/553 [00:00<00:00, 454.28it/s]extract the null data:  59%|█████▊    | 324/553 [00:00<00:00, 457.78it/s]extract the null data:  67%|██████▋   | 371/553 [00:00<00:00, 458.44it/s]extract the null data:  75%|███████▌  | 417/553 [00:00<00:00, 458.27it/s]extract the null data:  84%|████████▍ | 464/553 [00:01<00:00, 459.73it/s]extract the null data:  92%|█████████▏| 511/553 [00:01<00:00, 461.64it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 456.17it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 163.16it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.76it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 166.81it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 167.37it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 166.32it/s]replace nan value:  19%|█▊        | 103/553 [00:00<00:02, 168.36it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 171.59it/s]replace nan value:  25%|██▌       | 139/553 [00:00<00:02, 171.92it/s]replace nan value:  28%|██▊       | 157/553 [00:00<00:02, 172.68it/s]replace nan value:  32%|███▏      | 175/553 [00:01<00:02, 172.62it/s]replace nan value:  35%|███▍      | 193/553 [00:01<00:02, 171.83it/s]replace nan value:  38%|███▊      | 211/553 [00:01<00:01, 172.11it/s]replace nan value:  41%|████▏     | 229/553 [00:01<00:01, 168.61it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 168.66it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 168.96it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 168.76it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 169.12it/s]replace nan value:  57%|█████▋    | 315/553 [00:01<00:01, 170.11it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 169.97it/s]replace nan value:  63%|██████▎   | 350/553 [00:02<00:01, 169.72it/s]replace nan value:  66%|██████▋   | 367/553 [00:02<00:01, 169.38it/s]replace nan value:  70%|██████▉   | 385/553 [00:02<00:00, 170.42it/s]replace nan value:  73%|███████▎  | 403/553 [00:02<00:00, 169.66it/s]replace nan value:  76%|███████▌  | 421/553 [00:02<00:00, 169.68it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 169.89it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 170.68it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 170.54it/s]replace nan value:  89%|████████▉ | 493/553 [00:02<00:00, 170.56it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 170.56it/s]replace nan value:  96%|█████████▌| 529/553 [00:03<00:00, 169.61it/s]replace nan value:  99%|█████████▊| 546/553 [00:03<00:00, 169.37it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 169.57it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 107.34it/s]  5%|▍         | 26/553 [00:00<00:04, 128.92it/s]  7%|▋         | 40/553 [00:00<00:03, 128.73it/s] 10%|▉         | 53/553 [00:00<00:04, 118.59it/s] 12%|█▏        | 65/553 [00:00<00:04, 111.06it/s] 14%|█▍        | 80/553 [00:00<00:03, 119.08it/s] 17%|█▋        | 96/553 [00:00<00:03, 130.33it/s] 20%|██        | 112/553 [00:00<00:03, 138.11it/s] 23%|██▎       | 126/553 [00:00<00:03, 135.70it/s] 27%|██▋       | 147/553 [00:01<00:02, 155.40it/s] 30%|██▉       | 165/553 [00:01<00:02, 160.06it/s] 33%|███▎      | 182/553 [00:01<00:02, 158.97it/s] 36%|███▌      | 200/553 [00:01<00:02, 164.10it/s] 39%|███▉      | 217/553 [00:01<00:02, 161.54it/s] 42%|████▏     | 234/553 [00:01<00:02, 156.55it/s] 45%|████▌     | 250/553 [00:01<00:01, 155.15it/s] 48%|████▊     | 266/553 [00:01<00:01, 151.24it/s] 51%|█████     | 282/553 [00:01<00:01, 146.03it/s] 54%|█████▎    | 297/553 [00:02<00:01, 140.52it/s] 56%|█████▋    | 312/553 [00:02<00:01, 137.07it/s] 59%|█████▉    | 327/553 [00:02<00:01, 137.33it/s] 62%|██████▏   | 343/553 [00:02<00:01, 141.98it/s] 65%|██████▍   | 358/553 [00:02<00:01, 134.78it/s] 68%|██████▊   | 374/553 [00:02<00:01, 141.54it/s] 70%|███████   | 389/553 [00:02<00:01, 132.56it/s] 73%|███████▎  | 403/553 [00:02<00:01, 127.06it/s] 75%|███████▌  | 416/553 [00:02<00:01, 127.22it/s] 78%|███████▊  | 429/553 [00:03<00:01, 122.20it/s] 81%|████████  | 448/553 [00:03<00:00, 139.02it/s] 84%|████████▍ | 464/553 [00:03<00:00, 142.63it/s] 87%|████████▋ | 479/553 [00:03<00:00, 140.24it/s] 89%|████████▉ | 494/553 [00:03<00:00, 133.50it/s] 92%|█████████▏| 509/553 [00:03<00:00, 137.40it/s] 95%|█████████▍| 523/553 [00:03<00:00, 129.05it/s] 97%|█████████▋| 537/553 [00:03<00:00, 120.73it/s]100%|█████████▉| 551/553 [00:04<00:00, 111.90it/s]100%|██████████| 553/553 [00:04<00:00, 135.58it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  26%|██▌       | 36/139 [00:00<00:00, 354.99it/s]extract the null data:  75%|███████▍  | 104/139 [00:00<00:00, 543.45it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 547.70it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 222.49it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 226.16it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 225.10it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 225.68it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 224.64it/s]replace nan value:  99%|█████████▉| 138/139 [00:00<00:00, 224.21it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 224.53it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 119.70it/s] 19%|█▊        | 26/139 [00:00<00:00, 129.40it/s] 31%|███       | 43/139 [00:00<00:00, 144.08it/s] 42%|████▏     | 58/139 [00:00<00:00, 129.53it/s] 53%|█████▎    | 74/139 [00:00<00:00, 137.41it/s] 63%|██████▎   | 88/139 [00:00<00:00, 122.79it/s] 75%|███████▍  | 104/139 [00:00<00:00, 131.09it/s] 85%|████████▍ | 118/139 [00:00<00:00, 132.74it/s] 95%|█████████▍| 132/139 [00:01<00:00, 129.89it/s]100%|██████████| 139/139 [00:01<00:00, 132.97it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 288.66it/s]extract the null data:  49%|████▊     | 84/173 [00:00<00:00, 440.28it/s]extract the null data:  80%|████████  | 139/173 [00:00<00:00, 486.51it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 467.79it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 187.82it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 193.61it/s]replace nan value:  35%|███▌      | 61/173 [00:00<00:00, 204.31it/s]replace nan value:  47%|████▋     | 82/173 [00:00<00:00, 199.16it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 194.56it/s]replace nan value:  71%|███████   | 122/173 [00:00<00:00, 191.49it/s]replace nan value:  82%|████████▏ | 142/173 [00:00<00:00, 190.26it/s]replace nan value:  94%|█████████▎| 162/173 [00:00<00:00, 187.61it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 190.54it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 127.63it/s] 15%|█▌        | 26/173 [00:00<00:01, 105.67it/s] 23%|██▎       | 39/173 [00:00<00:01, 114.54it/s] 31%|███       | 54/173 [00:00<00:00, 125.32it/s] 39%|███▊      | 67/173 [00:00<00:00, 126.28it/s] 46%|████▌     | 80/173 [00:00<00:00, 124.55it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.97it/s] 62%|██████▏   | 107/173 [00:00<00:00, 124.75it/s] 69%|██████▉   | 120/173 [00:00<00:00, 123.88it/s] 77%|███████▋  | 133/173 [00:01<00:00, 121.22it/s] 85%|████████▍ | 147/173 [00:01<00:00, 126.64it/s] 92%|█████████▏| 160/173 [00:01<00:00, 118.12it/s] 99%|█████████▉| 172/173 [00:01<00:00, 91.73it/s] 100%|██████████| 173/173 [00:01<00:00, 113.24it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.073, valid loss : 0.022, train acc : 0.701, valid acc : 0.571, train f1 : 0.701, valid f1 : 0.481
training process:   1%|          | 1/128 [01:01<2:09:13, 61.05s/it]Best score increase :0.000 -> 0.481
training process:   2%|▏         | 2/128 [01:52<1:55:59, 55.23s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:43<1:51:03, 53.31s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:45<1:57:12, 56.71s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.020, valid loss : 0.028, train acc : 0.744, valid acc : 0.492, train f1 : 0.729, valid f1 : 0.431
training process:   4%|▍         | 5/128 [04:52<2:04:02, 60.51s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:47<1:59:17, 58.67s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [06:42<1:56:07, 57.58s/it]Best score increase :0.481 -> 0.484
training process:   6%|▋         | 8/128 [07:41<1:55:54, 57.95s/it]Best score increase :0.484 -> 0.541
epoch : 9, train loss : 0.017, valid loss : 0.024, train acc : 0.791, valid acc : 0.571, train f1 : 0.781, valid f1 : 0.485
training process:   7%|▋         | 9/128 [08:53<2:03:35, 62.32s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:57<2:03:22, 62.73s/it]Best score increase :0.541 -> 0.543
training process:   9%|▊         | 11/128 [11:00<2:02:35, 62.86s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:54<1:56:09, 60.09s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.016, valid loss : 0.020, train acc : 0.810, valid acc : 0.679, train f1 : 0.804, valid f1 : 0.561
training process:  10%|█         | 13/128 [12:53<1:54:39, 59.82s/it]Best score increase :0.543 -> 0.561
training process:  11%|█         | 14/128 [13:45<1:49:28, 57.62s/it]Best score increase :0.561 -> 0.606
training process:  12%|█▏        | 15/128 [14:39<1:46:19, 56.46s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:42<1:49:01, 58.41s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.014, valid loss : 0.019, train acc : 0.837, valid acc : 0.702, train f1 : 0.833, valid f1 : 0.578
training process:  13%|█▎        | 17/128 [16:54<1:55:47, 62.59s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [17:49<1:50:12, 60.11s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [18:44<1:46:35, 58.68s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [19:39<1:43:41, 57.61s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.013, valid loss : 0.020, train acc : 0.853, valid acc : 0.695, train f1 : 0.850, valid f1 : 0.574
training process:  16%|█▋        | 21/128 [20:44<1:46:22, 59.65s/it]EarlyStopping counter : 7 out of 12
training process:  17%|█▋        | 22/128 [21:39<1:43:11, 58.41s/it]Best score increase :0.606 -> 0.624
training process:  18%|█▊        | 23/128 [22:34<1:40:22, 57.35s/it]Best score increase :0.624 -> 0.642
training process:  19%|█▉        | 24/128 [23:33<1:40:05, 57.75s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.012, valid loss : 0.018, train acc : 0.865, valid acc : 0.755, train f1 : 0.863, valid f1 : 0.621
training process:  20%|█▉        | 25/128 [24:41<1:44:41, 60.99s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 26/128 [25:45<1:44:53, 61.71s/it]EarlyStopping counter : 3 out of 12
training process:  21%|██        | 27/128 [26:38<1:39:51, 59.32s/it]Best score increase :0.642 -> 0.646
training process:  22%|██▏       | 28/128 [27:32<1:35:58, 57.59s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.012, valid loss : 0.017, train acc : 0.874, valid acc : 0.757, train f1 : 0.872, valid f1 : 0.623
training process:  23%|██▎       | 29/128 [28:33<1:36:53, 58.72s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [29:25<1:32:29, 56.62s/it]Best score increase :0.646 -> 0.650
training process:  24%|██▍       | 31/128 [30:28<1:34:27, 58.42s/it]Best score increase :0.650 -> 0.660
training process:  25%|██▌       | 32/128 [31:22<1:31:30, 57.19s/it]Best score increase :0.660 -> 0.678
epoch : 33, train loss : 0.011, valid loss : 0.017, train acc : 0.886, valid acc : 0.782, train f1 : 0.885, valid f1 : 0.644
training process:  26%|██▌       | 33/128 [32:28<1:35:01, 60.01s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [33:26<1:32:43, 59.18s/it]Best score increase :0.678 -> 0.681
training process:  27%|██▋       | 35/128 [34:23<1:30:46, 58.57s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [35:19<1:28:47, 57.90s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.010, valid loss : 0.018, train acc : 0.892, valid acc : 0.782, train f1 : 0.891, valid f1 : 0.645
training process:  29%|██▉       | 37/128 [36:26<1:31:42, 60.47s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [37:23<1:29:15, 59.50s/it]Best score increase :0.681 -> 0.691
training process:  30%|███       | 39/128 [38:20<1:27:05, 58.71s/it]EarlyStopping counter : 1 out of 12
training process:  31%|███▏      | 40/128 [39:17<1:25:22, 58.21s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.018, train acc : 0.897, valid acc : 0.776, train f1 : 0.896, valid f1 : 0.639
training process:  32%|███▏      | 41/128 [40:23<1:27:57, 60.66s/it]EarlyStopping counter : 3 out of 12
training process:  33%|███▎      | 42/128 [41:21<1:25:45, 59.83s/it]EarlyStopping counter : 4 out of 12
training process:  34%|███▎      | 43/128 [42:18<1:23:33, 58.98s/it]EarlyStopping counter : 5 out of 12
training process:  34%|███▍      | 44/128 [43:17<1:22:25, 58.88s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.017, train acc : 0.907, valid acc : 0.798, train f1 : 0.906, valid f1 : 0.660
training process:  35%|███▌      | 45/128 [44:23<1:24:30, 61.09s/it]EarlyStopping counter : 7 out of 12
training process:  36%|███▌      | 46/128 [45:19<1:21:15, 59.45s/it]Best score increase :0.691 -> 0.707
training process:  37%|███▋      | 47/128 [46:14<1:18:40, 58.28s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [47:11<1:17:11, 57.90s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.009, valid loss : 0.015, train acc : 0.908, valid acc : 0.843, train f1 : 0.908, valid f1 : 0.705
training process:  38%|███▊      | 49/128 [48:15<1:18:32, 59.65s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [49:11<1:15:58, 58.45s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [50:06<1:13:57, 57.63s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [51:03<1:12:39, 57.36s/it]Best score increase :0.707 -> 0.709
epoch : 53, train loss : 0.009, valid loss : 0.016, train acc : 0.911, valid acc : 0.837, train f1 : 0.910, valid f1 : 0.698
training process:  41%|████▏     | 53/128 [52:09<1:15:01, 60.01s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [53:01<1:10:47, 57.41s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [53:54<1:08:18, 56.15s/it]Best score increase :0.709 -> 0.742
training process:  44%|████▍     | 56/128 [54:48<1:06:42, 55.59s/it]EarlyStopping counter : 1 out of 12
epoch : 57, train loss : 0.009, valid loss : 0.015, train acc : 0.914, valid acc : 0.847, train f1 : 0.914, valid f1 : 0.710
training process:  45%|████▍     | 57/128 [55:49<1:07:44, 57.24s/it]EarlyStopping counter : 2 out of 12
training process:  45%|████▌     | 58/128 [56:41<1:04:47, 55.53s/it]EarlyStopping counter : 3 out of 12
training process:  46%|████▌     | 59/128 [57:31<1:02:08, 54.04s/it]EarlyStopping counter : 4 out of 12
training process:  47%|████▋     | 60/128 [58:20<59:22, 52.38s/it]  EarlyStopping counter : 5 out of 12
epoch : 61, train loss : 0.008, valid loss : 0.014, train acc : 0.917, valid acc : 0.862, train f1 : 0.917, valid f1 : 0.726
training process:  48%|████▊     | 61/128 [59:17<1:00:04, 53.80s/it]EarlyStopping counter : 6 out of 12
training process:  48%|████▊     | 62/128 [1:00:08<58:26, 53.13s/it]Best score increase :0.742 -> 0.745
training process:  49%|████▉     | 63/128 [1:00:54<55:09, 50.92s/it]EarlyStopping counter : 1 out of 12
training process:  50%|█████     | 64/128 [1:01:42<53:10, 49.86s/it]EarlyStopping counter : 2 out of 12
epoch : 65, train loss : 0.008, valid loss : 0.015, train acc : 0.918, valid acc : 0.856, train f1 : 0.917, valid f1 : 0.720
training process:  51%|█████     | 65/128 [1:02:47<57:23, 54.66s/it]EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 66/128 [1:03:45<57:26, 55.59s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 67/128 [1:04:32<53:46, 52.89s/it]EarlyStopping counter : 5 out of 12
training process:  53%|█████▎    | 68/128 [1:05:23<52:16, 52.27s/it]EarlyStopping counter : 6 out of 12
epoch : 69, train loss : 0.008, valid loss : 0.015, train acc : 0.923, valid acc : 0.863, train f1 : 0.922, valid f1 : 0.728
training process:  54%|█████▍    | 69/128 [1:06:24<54:06, 55.02s/it]EarlyStopping counter : 7 out of 12
training process:  55%|█████▍    | 70/128 [1:07:20<53:32, 55.39s/it]EarlyStopping counter : 8 out of 12
training process:  55%|█████▌    | 71/128 [1:08:06<49:49, 52.45s/it]Best score increase :0.745 -> 0.754
training process:  56%|█████▋    | 72/128 [1:09:02<49:52, 53.44s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.007, valid loss : 0.014, train acc : 0.926, valid acc : 0.868, train f1 : 0.926, valid f1 : 0.733
training process:  57%|█████▋    | 73/128 [1:10:03<51:18, 55.97s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:10:52<48:16, 53.65s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▊    | 75/128 [1:11:41<46:17, 52.40s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▉    | 76/128 [1:12:35<45:43, 52.75s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.007, valid loss : 0.014, train acc : 0.930, valid acc : 0.876, train f1 : 0.929, valid f1 : 0.744
training process:  60%|██████    | 77/128 [1:13:35<46:49, 55.09s/it]EarlyStopping counter : 6 out of 12
training process:  61%|██████    | 78/128 [1:14:26<44:53, 53.87s/it]EarlyStopping counter : 7 out of 12
training process:  62%|██████▏   | 79/128 [1:15:16<42:51, 52.48s/it]EarlyStopping counter : 8 out of 12
training process:  62%|██████▎   | 80/128 [1:16:14<43:21, 54.19s/it]Best score increase :0.754 -> 0.765
epoch : 81, train loss : 0.007, valid loss : 0.015, train acc : 0.934, valid acc : 0.877, train f1 : 0.934, valid f1 : 0.744
training process:  63%|██████▎   | 81/128 [1:17:17<44:33, 56.88s/it]EarlyStopping counter : 1 out of 12
training process:  64%|██████▍   | 82/128 [1:18:10<42:48, 55.84s/it]EarlyStopping counter : 2 out of 12
training process:  65%|██████▍   | 83/128 [1:19:11<42:53, 57.20s/it]EarlyStopping counter : 3 out of 12
training process:  66%|██████▌   | 84/128 [1:20:08<42:02, 57.32s/it]EarlyStopping counter : 4 out of 12
epoch : 85, train loss : 0.007, valid loss : 0.014, train acc : 0.933, valid acc : 0.894, train f1 : 0.933, valid f1 : 0.767
training process:  66%|██████▋   | 85/128 [1:21:09<41:44, 58.24s/it]Best score increase :0.765 -> 0.767
training process:  67%|██████▋   | 86/128 [1:22:09<41:11, 58.84s/it]EarlyStopping counter : 1 out of 12
training process:  68%|██████▊   | 87/128 [1:23:10<40:34, 59.38s/it]EarlyStopping counter : 2 out of 12
training process:  69%|██████▉   | 88/128 [1:23:59<37:40, 56.50s/it]EarlyStopping counter : 3 out of 12
epoch : 89, train loss : 0.007, valid loss : 0.015, train acc : 0.936, valid acc : 0.875, train f1 : 0.935, valid f1 : 0.744
training process:  70%|██████▉   | 89/128 [1:25:10<39:23, 60.61s/it]EarlyStopping counter : 4 out of 12
training process:  70%|███████   | 90/128 [1:26:08<38:00, 60.01s/it]Best score increase :0.767 -> 0.770
training process:  71%|███████   | 91/128 [1:27:01<35:35, 57.72s/it]EarlyStopping counter : 1 out of 12
training process:  72%|███████▏  | 92/128 [1:28:04<35:37, 59.38s/it]EarlyStopping counter : 2 out of 12
epoch : 93, train loss : 0.006, valid loss : 0.014, train acc : 0.937, valid acc : 0.891, train f1 : 0.937, valid f1 : 0.764
training process:  73%|███████▎  | 93/128 [1:29:11<35:56, 61.60s/it]EarlyStopping counter : 3 out of 12
training process:  73%|███████▎  | 94/128 [1:30:03<33:22, 58.90s/it]EarlyStopping counter : 4 out of 12
training process:  74%|███████▍  | 95/128 [1:30:58<31:41, 57.61s/it]EarlyStopping counter : 5 out of 12
training process:  75%|███████▌  | 96/128 [1:31:57<31:02, 58.21s/it]EarlyStopping counter : 6 out of 12
epoch : 97, train loss : 0.006, valid loss : 0.014, train acc : 0.942, valid acc : 0.894, train f1 : 0.942, valid f1 : 0.767
training process:  76%|███████▌  | 97/128 [1:33:05<31:30, 60.99s/it]EarlyStopping counter : 7 out of 12
training process:  77%|███████▋  | 98/128 [1:33:57<29:09, 58.31s/it]Best score increase :0.770 -> 0.785
training process:  77%|███████▋  | 99/128 [1:34:57<28:28, 58.92s/it]EarlyStopping counter : 1 out of 12
training process:  78%|███████▊  | 100/128 [1:35:57<27:34, 59.10s/it]EarlyStopping counter : 2 out of 12
epoch : 101, train loss : 0.006, valid loss : 0.014, train acc : 0.943, valid acc : 0.894, train f1 : 0.943, valid f1 : 0.769
training process:  79%|███████▉  | 101/128 [1:36:54<26:19, 58.50s/it]EarlyStopping counter : 3 out of 12
training process:  80%|███████▉  | 102/128 [1:37:49<24:57, 57.58s/it]EarlyStopping counter : 4 out of 12
training process:  80%|████████  | 103/128 [1:38:47<23:57, 57.50s/it]EarlyStopping counter : 5 out of 12
training process:  81%|████████▏ | 104/128 [1:39:43<22:55, 57.30s/it]EarlyStopping counter : 6 out of 12
epoch : 105, train loss : 0.006, valid loss : 0.014, train acc : 0.943, valid acc : 0.887, train f1 : 0.943, valid f1 : 0.758
training process:  82%|████████▏ | 105/128 [1:40:51<23:07, 60.35s/it]EarlyStopping counter : 7 out of 12
training process:  83%|████████▎ | 106/128 [1:41:48<21:46, 59.40s/it]EarlyStopping counter : 8 out of 12
training process:  84%|████████▎ | 107/128 [1:42:43<20:20, 58.11s/it]EarlyStopping counter : 9 out of 12
training process:  84%|████████▍ | 108/128 [1:43:42<19:23, 58.17s/it]EarlyStopping counter : 10 out of 12
epoch : 109, train loss : 0.006, valid loss : 0.013, train acc : 0.940, valid acc : 0.910, train f1 : 0.940, valid f1 : 0.791
training process:  85%|████████▌ | 109/128 [1:44:49<19:16, 60.85s/it]Best score increase :0.785 -> 0.791
training process:  86%|████████▌ | 110/128 [1:45:45<17:50, 59.46s/it]EarlyStopping counter : 1 out of 12
training process:  87%|████████▋ | 111/128 [1:46:40<16:28, 58.17s/it]EarlyStopping counter : 2 out of 12
training process:  88%|████████▊ | 112/128 [1:47:42<15:50, 59.43s/it]EarlyStopping counter : 3 out of 12
epoch : 113, train loss : 0.006, valid loss : 0.013, train acc : 0.947, valid acc : 0.905, train f1 : 0.947, valid f1 : 0.783
training process:  88%|████████▊ | 113/128 [1:48:53<15:41, 62.75s/it]EarlyStopping counter : 4 out of 12
training process:  89%|████████▉ | 114/128 [1:49:47<14:00, 60.06s/it]EarlyStopping counter : 5 out of 12
training process:  90%|████████▉ | 115/128 [1:50:49<13:11, 60.88s/it]EarlyStopping counter : 6 out of 12
training process:  91%|█████████ | 116/128 [1:51:47<11:57, 59.81s/it]EarlyStopping counter : 7 out of 12
epoch : 117, train loss : 0.006, valid loss : 0.013, train acc : 0.944, valid acc : 0.893, train f1 : 0.943, valid f1 : 0.767
training process:  91%|█████████▏| 117/128 [1:52:51<11:13, 61.24s/it]EarlyStopping counter : 8 out of 12
training process:  92%|█████████▏| 118/128 [1:53:49<10:01, 60.12s/it]EarlyStopping counter : 9 out of 12
training process:  93%|█████████▎| 119/128 [1:54:48<08:59, 59.94s/it]EarlyStopping counter : 10 out of 12
training process:  94%|█████████▍| 120/128 [1:55:47<07:56, 59.57s/it]EarlyStopping counter : 11 out of 12
epoch : 121, train loss : 0.006, valid loss : 0.014, train acc : 0.945, valid acc : 0.900, train f1 : 0.944, valid f1 : 0.777
training process:  94%|█████████▍| 120/128 [1:56:50<07:47, 58.42s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 120, best f1 score : 0.791
training process finished, best loss : 0.013 and best acc : 0.910, best f1 : 0.791, best epoch : 108

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.45      0.92      0.60       580
           1       0.99      0.90      0.95      6818

    accuracy                           0.91      7398
   macro avg       0.72      0.91      0.78      7398
weighted avg       0.95      0.91      0.92      7398


# test acc : 0.91, test f1 : 0.78, test AUC : 0.91, test loss : 0.824

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.72s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.78s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.98s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:04,  8.02s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:56,  8.01s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  8.00s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.99s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.88s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.91s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.88s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:08,  8.01s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.95s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.94s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  9%|▉         | 27/306 [00:00<00:01, 266.02it/s] 18%|█▊        | 56/306 [00:00<00:00, 274.37it/s] 28%|██▊       | 85/306 [00:00<00:00, 278.59it/s] 37%|███▋      | 114/306 [00:00<00:00, 281.02it/s] 47%|████▋     | 143/306 [00:00<00:00, 283.07it/s] 56%|█████▌    | 172/306 [00:00<00:00, 282.92it/s] 66%|██████▌   | 201/306 [00:00<00:00, 284.34it/s] 75%|███████▌  | 230/306 [00:00<00:00, 284.75it/s] 85%|████████▍ | 259/306 [00:00<00:00, 283.95it/s] 94%|█████████▍| 288/306 [00:01<00:00, 284.21it/s]100%|██████████| 306/306 [00:01<00:00, 282.41it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█▏        | 63/553 [00:00<00:00, 628.48it/s]extract the null data:  23%|██▎       | 129/553 [00:00<00:00, 641.33it/s]extract the null data:  35%|███▌      | 195/553 [00:00<00:00, 646.91it/s]extract the null data:  47%|████▋     | 261/553 [00:00<00:00, 648.41it/s]extract the null data:  59%|█████▉    | 328/553 [00:00<00:00, 652.87it/s]extract the null data:  71%|███████   | 394/553 [00:00<00:00, 655.13it/s]extract the null data:  84%|████████▎ | 462/553 [00:00<00:00, 660.57it/s]extract the null data:  96%|█████████▌| 529/553 [00:00<00:00, 659.33it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 653.39it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 23/553 [00:00<00:02, 221.06it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 225.57it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 224.95it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:02, 228.24it/s]replace nan value:  21%|██        | 117/553 [00:00<00:01, 229.46it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:01, 229.55it/s]replace nan value:  30%|██▉       | 164/553 [00:00<00:01, 226.85it/s]replace nan value:  34%|███▍      | 187/553 [00:00<00:01, 227.38it/s]replace nan value:  38%|███▊      | 211/553 [00:00<00:01, 230.26it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 229.90it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 230.20it/s]replace nan value:  51%|█████     | 283/553 [00:01<00:01, 231.53it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 230.48it/s]replace nan value:  60%|█████▉    | 331/553 [00:01<00:00, 231.74it/s]replace nan value:  64%|██████▍   | 355/553 [00:01<00:00, 230.47it/s]replace nan value:  69%|██████▊   | 379/553 [00:01<00:00, 232.04it/s]replace nan value:  73%|███████▎  | 403/553 [00:01<00:00, 232.85it/s]replace nan value:  77%|███████▋  | 427/553 [00:01<00:00, 229.37it/s]replace nan value:  82%|████████▏ | 451/553 [00:01<00:00, 230.05it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 229.81it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 230.53it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 231.70it/s]replace nan value:  99%|█████████▉| 547/553 [00:02<00:00, 231.34it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 229.79it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 133.91it/s]  5%|▌         | 29/553 [00:00<00:03, 141.38it/s]  8%|▊         | 44/553 [00:00<00:03, 128.71it/s] 10%|█         | 58/553 [00:00<00:04, 119.29it/s] 13%|█▎        | 71/553 [00:00<00:04, 117.22it/s] 16%|█▌        | 87/553 [00:00<00:03, 128.25it/s] 18%|█▊        | 100/553 [00:00<00:03, 122.94it/s] 21%|██▏       | 118/553 [00:00<00:03, 138.21it/s] 24%|██▍       | 133/553 [00:01<00:03, 137.32it/s] 27%|██▋       | 151/553 [00:01<00:02, 147.61it/s] 31%|███       | 170/553 [00:01<00:02, 158.90it/s] 34%|███▍      | 187/553 [00:01<00:02, 153.00it/s] 37%|███▋      | 206/553 [00:01<00:02, 160.79it/s] 40%|████      | 223/553 [00:01<00:02, 151.40it/s] 43%|████▎     | 239/553 [00:01<00:02, 153.37it/s] 46%|████▌     | 255/553 [00:01<00:02, 142.97it/s] 49%|████▉     | 270/553 [00:01<00:02, 141.00it/s] 52%|█████▏    | 286/553 [00:02<00:01, 145.04it/s] 54%|█████▍    | 301/553 [00:02<00:01, 143.15it/s] 57%|█████▋    | 316/553 [00:02<00:01, 138.63it/s] 60%|█████▉    | 331/553 [00:02<00:01, 141.35it/s] 63%|██████▎   | 347/553 [00:02<00:01, 145.50it/s] 65%|██████▌   | 362/553 [00:02<00:01, 141.19it/s] 69%|██████▊   | 379/553 [00:02<00:01, 148.31it/s] 71%|███████   | 394/553 [00:02<00:01, 138.76it/s] 74%|███████▍  | 410/553 [00:02<00:00, 143.50it/s] 77%|███████▋  | 425/553 [00:03<00:00, 132.37it/s] 80%|███████▉  | 442/553 [00:03<00:00, 142.27it/s] 83%|████████▎ | 461/553 [00:03<00:00, 153.97it/s] 86%|████████▋ | 478/553 [00:03<00:00, 152.99it/s] 89%|████████▉ | 494/553 [00:03<00:00, 146.08it/s] 92%|█████████▏| 511/553 [00:03<00:00, 152.13it/s] 95%|█████████▌| 527/553 [00:03<00:00, 135.24it/s] 98%|█████████▊| 542/553 [00:03<00:00, 137.76it/s]100%|██████████| 553/553 [00:03<00:00, 139.77it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 367.12it/s]extract the null data:  78%|███████▊  | 109/139 [00:00<00:00, 573.54it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 572.69it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 249.27it/s]replace nan value:  37%|███▋      | 51/139 [00:00<00:00, 253.33it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 253.91it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 252.40it/s]replace nan value:  93%|█████████▎| 129/139 [00:00<00:00, 252.27it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 252.11it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 12%|█▏        | 16/139 [00:00<00:00, 142.84it/s] 25%|██▌       | 35/139 [00:00<00:00, 168.64it/s] 37%|███▋      | 52/139 [00:00<00:00, 161.86it/s] 50%|█████     | 70/139 [00:00<00:00, 167.41it/s] 63%|██████▎   | 87/139 [00:00<00:00, 149.45it/s] 74%|███████▍  | 103/139 [00:00<00:00, 151.95it/s] 86%|████████▋ | 120/139 [00:00<00:00, 156.94it/s] 98%|█████████▊| 136/139 [00:00<00:00, 154.58it/s]100%|██████████| 139/139 [00:00<00:00, 157.26it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 46/173 [00:00<00:00, 458.37it/s]extract the null data:  68%|██████▊   | 117/173 [00:00<00:00, 605.56it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 619.04it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 242.46it/s]replace nan value:  29%|██▉       | 51/173 [00:00<00:00, 248.62it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 249.70it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 250.18it/s]replace nan value:  75%|███████▍  | 129/173 [00:00<00:00, 249.60it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 246.65it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 247.46it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 146.00it/s] 17%|█▋        | 30/173 [00:00<00:01, 134.59it/s] 28%|██▊       | 48/173 [00:00<00:00, 149.83it/s] 38%|███▊      | 65/173 [00:00<00:00, 150.00it/s] 47%|████▋     | 81/173 [00:00<00:00, 153.16it/s] 56%|█████▌    | 97/173 [00:00<00:00, 153.58it/s] 66%|██████▌   | 114/173 [00:00<00:00, 157.22it/s] 75%|███████▌  | 130/173 [00:00<00:00, 149.81it/s] 84%|████████▍ | 146/173 [00:00<00:00, 142.39it/s] 93%|█████████▎| 161/173 [00:01<00:00, 129.10it/s]100%|██████████| 173/173 [00:01<00:00, 130.38it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.080, valid loss : 0.059, train f1 : 0.554, valid f1 : 0.566
training process - Deferred Re-weighting:   1%|          | 1/128 [00:55<1:57:13, 55.38s/it]Best score increase :0.000 -> 0.566
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:40<1:44:05, 49.56s/it]Best score increase :0.566 -> 0.663
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:25<1:38:45, 47.40s/it]Best score increase :0.663 -> 0.702
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:11<1:36:30, 46.70s/it]Best score increase :0.702 -> 0.737
epoch : 5, train loss : 0.041, valid loss : 0.048, train f1 : 0.791, valid f1 : 0.753
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:12<1:46:46, 52.09s/it]Best score increase :0.737 -> 0.753
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:05<1:46:16, 52.26s/it]Best score increase :0.753 -> 0.784
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:00<1:47:04, 53.10s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [06:56<1:47:53, 53.94s/it]Best score increase :0.784 -> 0.796
epoch : 9, train loss : 0.035, valid loss : 0.042, train f1 : 0.831, valid f1 : 0.804
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:02<1:54:47, 57.88s/it]Best score increase :0.796 -> 0.804
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:00<1:53:49, 57.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:54<1:50:44, 56.79s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:50<1:49:04, 56.41s/it]Best score increase :0.804 -> 0.819
epoch : 13, train loss : 0.032, valid loss : 0.046, train f1 : 0.849, valid f1 : 0.802
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:55<1:53:11, 59.06s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:51<1:50:35, 58.21s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:48<1:48:37, 57.68s/it]Best score increase :0.819 -> 0.834
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:45<1:47:31, 57.60s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.030, valid loss : 0.042, train f1 : 0.862, valid f1 : 0.823
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:49<1:50:07, 59.52s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:50<1:49:37, 59.80s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:48<1:47:53, 59.39s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:40<1:42:53, 57.16s/it]Best score increase :0.834 -> 0.839
epoch : 21, train loss : 0.028, valid loss : 0.041, train f1 : 0.870, valid f1 : 0.838
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:48<1:47:45, 60.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:45<1:44:49, 59.33s/it]Best score increase :0.839 -> 0.847
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:38<1:40:22, 57.36s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:32<1:37:37, 56.32s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.027, valid loss : 0.046, train f1 : 0.874, valid f1 : 0.837
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:38<1:41:44, 59.27s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:38<1:41:18, 59.59s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:31<1:37:09, 57.72s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [26:29<1:35:58, 57.58s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.025, valid loss : 0.045, train f1 : 0.886, valid f1 : 0.847
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:35<1:39:34, 60.35s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [28:33<1:37:19, 59.59s/it]Best score increase :0.847 -> 0.849
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [29:25<1:32:19, 57.11s/it]Best score increase :0.849 -> 0.851
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [30:23<1:31:47, 57.37s/it]Best score increase :0.851 -> 0.854
epoch : 33, train loss : 0.024, valid loss : 0.040, train f1 : 0.893, valid f1 : 0.862
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [31:28<1:34:36, 59.75s/it]Best score increase :0.854 -> 0.862
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [32:21<1:30:26, 57.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [33:15<1:27:49, 56.66s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [34:11<1:26:46, 56.59s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.023, valid loss : 0.048, train f1 : 0.896, valid f1 : 0.838
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [35:16<1:29:29, 59.01s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [36:04<1:23:33, 55.70s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [37:01<1:23:06, 56.03s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [37:58<1:22:35, 56.31s/it]Best score increase :0.862 -> 0.863
epoch : 41, train loss : 0.023, valid loss : 0.047, train f1 : 0.895, valid f1 : 0.860
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [38:55<1:21:56, 56.51s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [39:51<1:20:59, 56.50s/it]Best score increase :0.863 -> 0.875
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [40:46<1:19:19, 55.99s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [41:38<1:16:48, 54.86s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.023, valid loss : 0.042, train f1 : 0.902, valid f1 : 0.863
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [42:36<1:17:09, 55.77s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [43:33<1:16:38, 56.08s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [44:28<1:15:05, 55.62s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [45:13<1:10:12, 52.66s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.021, valid loss : 0.046, train f1 : 0.909, valid f1 : 0.862
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [46:18<1:14:08, 56.31s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [47:13<1:12:49, 56.02s/it]Best score increase :0.875 -> 0.877
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [47:59<1:08:02, 53.02s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [48:57<1:08:57, 54.44s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.021, valid loss : 0.049, train f1 : 0.909, valid f1 : 0.867
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [50:03<1:12:15, 57.81s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [50:51<1:07:35, 54.81s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [51:49<1:07:52, 55.78s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [52:48<1:08:00, 56.68s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.019, valid loss : 0.047, train f1 : 0.912, valid f1 : 0.864
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [53:47<1:08:01, 57.49s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [54:44<1:06:49, 57.28s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [55:40<1:05:33, 57.00s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [56:36<1:04:12, 56.65s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.019, valid loss : 0.049, train f1 : 0.915, valid f1 : 0.867
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [57:41<1:05:59, 59.10s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [58:39<1:04:25, 57.69s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.877
training process finished, best loss : 0.038, best acc : 0.966, best f1 : 0.877, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.68      0.78       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.84      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.84, test loss : 2.656

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:33,  8.54s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:24,  8.42s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:15,  8.44s/it]processing for feature importance:  33%|███▎      | 4/12 [00:33<01:07,  8.38s/it]processing for feature importance:  42%|████▏     | 5/12 [00:42<00:59,  8.43s/it]processing for feature importance:  50%|█████     | 6/12 [00:50<00:50,  8.44s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:59<00:43,  8.71s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:08<00:34,  8.73s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:17<00:25,  8.64s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:25<00:16,  8.44s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:33<00:08,  8.53s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.48s/it]processing for feature importance: 100%|██████████| 12/12 [01:42<00:00,  8.52s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 211.63it/s] 15%|█▍        | 45/306 [00:00<00:01, 220.74it/s] 22%|██▏       | 68/306 [00:00<00:01, 188.36it/s] 29%|██▉       | 88/306 [00:00<00:01, 152.76it/s] 34%|███▍      | 105/306 [00:00<00:01, 153.61it/s] 40%|███▉      | 121/306 [00:00<00:01, 138.06it/s] 46%|████▌     | 141/306 [00:00<00:01, 153.92it/s] 52%|█████▏    | 158/306 [00:01<00:00, 148.00it/s] 57%|█████▋    | 174/306 [00:01<00:00, 136.24it/s] 63%|██████▎   | 193/306 [00:01<00:00, 149.09it/s] 68%|██████▊   | 209/306 [00:01<00:00, 138.43it/s] 74%|███████▎  | 225/306 [00:01<00:00, 142.57it/s] 81%|████████▏ | 249/306 [00:01<00:00, 168.17it/s] 87%|████████▋ | 267/306 [00:01<00:00, 158.35it/s] 93%|█████████▎| 284/306 [00:01<00:00, 143.17it/s] 98%|█████████▊| 301/306 [00:01<00:00, 146.67it/s]100%|██████████| 306/306 [00:02<00:00, 152.91it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 52/553 [00:00<00:00, 517.63it/s]extract the null data:  19%|█▉        | 107/553 [00:00<00:00, 532.11it/s]extract the null data:  29%|██▉       | 163/553 [00:00<00:00, 541.19it/s]extract the null data:  40%|███▉      | 221/553 [00:00<00:00, 555.37it/s]extract the null data:  50%|█████     | 277/553 [00:00<00:00, 555.84it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 559.06it/s]extract the null data:  71%|███████   | 391/553 [00:00<00:00, 560.93it/s]extract the null data:  81%|████████  | 448/553 [00:00<00:00, 555.48it/s]extract the null data:  91%|█████████▏| 505/553 [00:00<00:00, 557.29it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 554.64it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 187.26it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 190.74it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 192.18it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:02, 187.79it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 188.65it/s]replace nan value:  22%|██▏       | 120/553 [00:00<00:02, 192.74it/s]replace nan value:  25%|██▌       | 140/553 [00:00<00:02, 193.00it/s]replace nan value:  29%|██▉       | 160/553 [00:00<00:02, 194.25it/s]replace nan value:  33%|███▎      | 180/553 [00:00<00:01, 193.14it/s]replace nan value:  36%|███▌      | 200/553 [00:01<00:01, 193.98it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 194.79it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 197.73it/s]replace nan value:  47%|████▋     | 262/553 [00:01<00:01, 199.71it/s]replace nan value:  51%|█████     | 282/553 [00:01<00:01, 199.07it/s]replace nan value:  55%|█████▍    | 303/553 [00:01<00:01, 200.43it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 197.57it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:01, 196.39it/s]replace nan value:  66%|██████▌   | 364/553 [00:01<00:00, 196.68it/s]replace nan value:  69%|██████▉   | 384/553 [00:01<00:00, 192.97it/s]replace nan value:  73%|███████▎  | 404/553 [00:02<00:00, 191.44it/s]replace nan value:  77%|███████▋  | 424/553 [00:02<00:00, 191.04it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 191.13it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 189.40it/s]replace nan value:  87%|████████▋ | 483/553 [00:02<00:00, 189.32it/s]replace nan value:  91%|█████████ | 502/553 [00:02<00:00, 189.04it/s]replace nan value:  94%|█████████▍| 521/553 [00:02<00:00, 187.86it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 187.35it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 192.37it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 136.75it/s]  5%|▌         | 29/553 [00:00<00:03, 143.18it/s]  8%|▊         | 44/553 [00:00<00:03, 132.63it/s] 10%|█         | 58/553 [00:00<00:04, 122.89it/s] 13%|█▎        | 71/553 [00:00<00:03, 121.51it/s] 16%|█▌        | 86/553 [00:00<00:03, 129.81it/s] 18%|█▊        | 100/553 [00:00<00:03, 125.12it/s] 21%|██▏       | 118/553 [00:00<00:03, 140.56it/s] 24%|██▍       | 133/553 [00:00<00:03, 138.76it/s] 27%|██▋       | 151/553 [00:01<00:02, 149.09it/s] 31%|███       | 170/553 [00:01<00:02, 159.23it/s] 34%|███▍      | 187/553 [00:01<00:02, 154.01it/s] 37%|███▋      | 206/553 [00:01<00:02, 162.58it/s] 40%|████      | 223/553 [00:01<00:02, 152.27it/s] 43%|████▎     | 239/553 [00:01<00:02, 153.89it/s] 46%|████▌     | 255/553 [00:01<00:02, 146.35it/s] 49%|████▉     | 270/553 [00:01<00:01, 145.65it/s] 52%|█████▏    | 285/553 [00:01<00:01, 143.90it/s] 54%|█████▍    | 300/553 [00:02<00:01, 140.54it/s] 57%|█████▋    | 315/553 [00:02<00:01, 133.98it/s] 59%|█████▉    | 329/553 [00:02<00:01, 132.69it/s] 62%|██████▏   | 345/553 [00:02<00:01, 135.09it/s] 65%|██████▍   | 359/553 [00:02<00:01, 130.12it/s] 68%|██████▊   | 375/553 [00:02<00:01, 137.64it/s] 70%|███████   | 389/553 [00:02<00:01, 128.09it/s] 73%|███████▎  | 402/553 [00:02<00:01, 122.99it/s] 75%|███████▌  | 416/553 [00:03<00:01, 124.74it/s] 78%|███████▊  | 429/553 [00:03<00:01, 119.25it/s] 81%|████████  | 448/553 [00:03<00:00, 135.27it/s] 84%|████████▍ | 464/553 [00:03<00:00, 139.02it/s] 87%|████████▋ | 479/553 [00:03<00:00, 136.10it/s] 89%|████████▉ | 493/553 [00:03<00:00, 131.12it/s] 92%|█████████▏| 507/553 [00:03<00:00, 131.75it/s] 94%|█████████▍| 521/553 [00:03<00:00, 130.78it/s] 97%|█████████▋| 535/553 [00:03<00:00, 115.18it/s]100%|█████████▉| 551/553 [00:04<00:00, 107.67it/s]100%|██████████| 553/553 [00:04<00:00, 133.30it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 329.54it/s]extract the null data:  70%|██████▉   | 97/139 [00:00<00:00, 509.44it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 524.97it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 22/139 [00:00<00:00, 218.31it/s]replace nan value:  32%|███▏      | 44/139 [00:00<00:00, 216.67it/s]replace nan value:  47%|████▋     | 66/139 [00:00<00:00, 216.17it/s]replace nan value:  63%|██████▎   | 88/139 [00:00<00:00, 215.73it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 216.01it/s]replace nan value:  95%|█████████▍| 132/139 [00:00<00:00, 215.20it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 215.95it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 127.24it/s] 19%|█▉        | 27/139 [00:00<00:00, 127.88it/s] 31%|███       | 43/139 [00:00<00:00, 140.12it/s] 42%|████▏     | 58/139 [00:00<00:00, 124.27it/s] 53%|█████▎    | 73/139 [00:00<00:00, 131.75it/s] 63%|██████▎   | 87/139 [00:00<00:00, 119.08it/s] 72%|███████▏  | 100/139 [00:00<00:00, 120.43it/s] 81%|████████▏ | 113/139 [00:00<00:00, 119.58it/s] 91%|█████████▏| 127/139 [00:01<00:00, 124.78it/s]100%|██████████| 139/139 [00:01<00:00, 125.78it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██▏       | 37/173 [00:00<00:00, 365.65it/s]extract the null data:  58%|█████▊    | 100/173 [00:00<00:00, 516.54it/s]extract the null data:  94%|█████████▍| 163/173 [00:00<00:00, 564.39it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 539.13it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 22/173 [00:00<00:00, 210.17it/s]replace nan value:  25%|██▌       | 44/173 [00:00<00:00, 206.27it/s]replace nan value:  38%|███▊      | 65/173 [00:00<00:00, 206.19it/s]replace nan value:  50%|█████     | 87/173 [00:00<00:00, 208.14it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 207.50it/s]replace nan value:  75%|███████▍  | 129/173 [00:00<00:00, 205.08it/s]replace nan value:  87%|████████▋ | 150/173 [00:00<00:00, 205.18it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 203.74it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 205.35it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 134.42it/s] 16%|█▌        | 28/173 [00:00<00:01, 120.21it/s] 25%|██▍       | 43/173 [00:00<00:00, 130.40it/s] 34%|███▎      | 58/173 [00:00<00:00, 136.17it/s] 42%|████▏     | 72/173 [00:00<00:00, 135.84it/s] 50%|████▉     | 86/173 [00:00<00:00, 132.98it/s] 58%|█████▊    | 100/173 [00:00<00:00, 134.05it/s] 67%|██████▋   | 116/173 [00:00<00:00, 138.25it/s] 75%|███████▌  | 130/173 [00:00<00:00, 131.99it/s] 83%|████████▎ | 144/173 [00:01<00:00, 129.48it/s] 91%|█████████ | 157/173 [00:01<00:00, 118.31it/s] 98%|█████████▊| 169/173 [00:01<00:00, 98.32it/s] 100%|██████████| 173/173 [00:01<00:00, 116.88it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.138, valid loss : 0.085, train f1 : 0.711, valid f1 : 0.723
training process - Deferred Re-weighting:   1%|          | 1/128 [01:09<2:27:41, 69.78s/it]Best score increase :0.000 -> 0.723
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:59<2:01:29, 57.85s/it]Best score increase :0.723 -> 0.732
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:55<1:58:29, 56.88s/it]Best score increase :0.732 -> 0.776
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:54<1:59:20, 57.74s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.081, valid loss : 0.076, train f1 : 0.858, valid f1 : 0.744
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:54<2:00:08, 58.61s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:46<1:54:43, 56.42s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:42<1:53:52, 56.46s/it]Best score increase :0.776 -> 0.788
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:42<1:54:58, 57.48s/it]Best score increase :0.788 -> 0.818
epoch : 9, train loss : 0.069, valid loss : 0.073, train f1 : 0.886, valid f1 : 0.747
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:38<1:52:57, 56.95s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:37<1:53:27, 57.69s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:37<1:53:36, 58.26s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:25<1:46:29, 55.08s/it]EarlyStopping counter : 4 out of 12
epoch : 13, train loss : 0.064, valid loss : 0.056, train f1 : 0.894, valid f1 : 0.811
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:30<1:51:51, 58.36s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:29<1:50:49, 58.32s/it]Best score increase :0.818 -> 0.827
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:22<1:47:04, 56.86s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:19<1:45:53, 56.73s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.057, valid loss : 0.053, train f1 : 0.907, valid f1 : 0.819
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [16:24<1:49:45, 59.32s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [17:20<1:47:03, 58.40s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [18:09<1:40:54, 55.54s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [19:08<1:41:44, 56.52s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.052, valid loss : 0.057, train f1 : 0.917, valid f1 : 0.807
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [20:13<1:45:23, 59.10s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [21:06<1:41:07, 57.24s/it]Best score increase :0.827 -> 0.834
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:58<1:37:19, 55.61s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:59<1:39:20, 57.31s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.048, valid loss : 0.049, train f1 : 0.926, valid f1 : 0.837
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [24:05<1:42:48, 59.88s/it]Best score increase :0.834 -> 0.837
training process - Deferred Re-weighting:  20%|██        | 26/128 [25:03<1:40:46, 59.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [26:03<1:40:10, 59.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [27:00<1:38:13, 58.94s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.045, valid loss : 0.051, train f1 : 0.931, valid f1 : 0.825
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [28:09<1:42:12, 61.95s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [29:07<1:38:59, 60.61s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [30:02<1:35:14, 58.91s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [30:56<1:31:57, 57.47s/it]Best score increase :0.837 -> 0.844
epoch : 33, train loss : 0.041, valid loss : 0.049, train f1 : 0.938, valid f1 : 0.837
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [32:00<1:34:20, 59.58s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [32:54<1:30:20, 57.67s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [33:50<1:28:41, 57.22s/it]Best score increase :0.844 -> 0.848
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [34:49<1:28:43, 57.87s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.040, valid loss : 0.055, train f1 : 0.940, valid f1 : 0.826
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [35:54<1:30:41, 59.80s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [36:45<1:25:46, 57.19s/it]Best score increase :0.848 -> 0.854
training process - Deferred Re-weighting:  30%|███       | 39/128 [37:44<1:25:43, 57.80s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [38:41<1:24:20, 57.50s/it]EarlyStopping counter : 2 out of 12
epoch : 41, train loss : 0.037, valid loss : 0.051, train f1 : 0.946, valid f1 : 0.822
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [39:37<1:23:04, 57.30s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [40:33<1:21:25, 56.80s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [41:28<1:19:28, 56.10s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [42:26<1:19:24, 56.72s/it]EarlyStopping counter : 6 out of 12
epoch : 45, train loss : 0.034, valid loss : 0.042, train f1 : 0.950, valid f1 : 0.853
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [43:23<1:18:39, 56.86s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [44:23<1:18:58, 57.79s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [45:19<1:17:12, 57.20s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [46:08<1:13:18, 54.98s/it]EarlyStopping counter : 10 out of 12
epoch : 49, train loss : 0.032, valid loss : 0.042, train f1 : 0.952, valid f1 : 0.851
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [47:13<1:16:13, 57.89s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [48:12<1:17:43, 59.03s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 49, best f1 score : 0.854
training process finished, best loss : 0.042, best acc : 0.949, best f1 : 0.854, best epoch : 37

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.58      0.84      0.69       580
           1       0.99      0.95      0.97      6818

    accuracy                           0.94      7398
   macro avg       0.78      0.89      0.83      7398
weighted avg       0.95      0.94      0.95      7398


# test acc : 0.94, test f1 : 0.83, test AUC : 0.89, test loss : 2.592

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.60s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.64s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.63s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.69s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:52,  7.57s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:44,  7.45s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.41s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:29,  7.48s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.55s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.86s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.86s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.85s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.68s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 203.10it/s] 14%|█▍        | 44/306 [00:00<00:01, 216.05it/s] 22%|██▏       | 67/306 [00:00<00:01, 220.42it/s] 29%|██▉       | 90/306 [00:00<00:00, 223.69it/s] 37%|███▋      | 113/306 [00:00<00:00, 225.15it/s] 44%|████▍     | 136/306 [00:00<00:00, 225.60it/s] 52%|█████▏    | 159/306 [00:00<00:00, 225.81it/s] 59%|█████▉    | 182/306 [00:00<00:00, 226.20it/s] 67%|██████▋   | 205/306 [00:00<00:00, 226.51it/s] 75%|███████▍  | 228/306 [00:01<00:00, 227.33it/s] 82%|████████▏ | 251/306 [00:01<00:00, 227.63it/s] 90%|████████▉ | 275/306 [00:01<00:00, 229.14it/s] 97%|█████████▋| 298/306 [00:01<00:00, 228.72it/s]100%|██████████| 306/306 [00:01<00:00, 225.61it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_Normal_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:01, 384.28it/s]extract the null data:  15%|█▌        | 83/553 [00:00<00:01, 271.94it/s]extract the null data:  20%|██        | 112/553 [00:00<00:01, 252.68it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:01, 246.97it/s]extract the null data:  30%|██▉       | 164/553 [00:00<00:01, 247.23it/s]extract the null data:  34%|███▍      | 190/553 [00:00<00:01, 243.73it/s]extract the null data:  39%|███▉      | 215/553 [00:00<00:01, 240.62it/s]extract the null data:  45%|████▍     | 247/553 [00:00<00:01, 262.59it/s]extract the null data:  53%|█████▎    | 293/553 [00:01<00:00, 320.24it/s]extract the null data:  61%|██████▏   | 340/553 [00:01<00:00, 362.80it/s]extract the null data:  70%|██████▉   | 387/553 [00:01<00:00, 392.31it/s]extract the null data:  78%|███████▊  | 434/553 [00:01<00:00, 413.70it/s]extract the null data:  87%|████████▋ | 482/553 [00:01<00:00, 431.22it/s]extract the null data:  96%|█████████▌| 530/553 [00:01<00:00, 444.50it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 343.51it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 164.44it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 171.86it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 173.67it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 173.03it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 174.04it/s]replace nan value:  19%|█▉        | 107/553 [00:00<00:02, 175.96it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 176.37it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 178.40it/s]replace nan value:  29%|██▉       | 163/553 [00:00<00:02, 178.98it/s]replace nan value:  33%|███▎      | 182/553 [00:01<00:02, 180.09it/s]replace nan value:  36%|███▋      | 201/553 [00:01<00:01, 180.88it/s]replace nan value:  40%|███▉      | 220/553 [00:01<00:01, 180.27it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 179.91it/s]replace nan value:  46%|████▋     | 257/553 [00:01<00:01, 179.04it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 181.52it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 181.12it/s]replace nan value:  57%|█████▋    | 314/553 [00:01<00:01, 180.24it/s]replace nan value:  60%|██████    | 333/553 [00:01<00:01, 180.21it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:01, 179.96it/s]replace nan value:  67%|██████▋   | 370/553 [00:02<00:01, 179.35it/s]replace nan value:  70%|███████   | 388/553 [00:02<00:00, 179.24it/s]replace nan value:  74%|███████▎  | 407/553 [00:02<00:00, 180.68it/s]replace nan value:  77%|███████▋  | 426/553 [00:02<00:00, 179.71it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 180.19it/s]replace nan value:  84%|████████▍ | 464/553 [00:02<00:00, 177.11it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 172.18it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 169.23it/s]replace nan value:  93%|█████████▎| 517/553 [00:02<00:00, 169.02it/s]replace nan value:  97%|█████████▋| 534/553 [00:03<00:00, 167.07it/s]replace nan value: 100%|█████████▉| 551/553 [00:03<00:00, 165.30it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 175.73it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 122.91it/s]  5%|▍         | 27/553 [00:00<00:03, 131.68it/s]  7%|▋         | 41/553 [00:00<00:03, 130.42it/s] 10%|▉         | 55/553 [00:00<00:04, 119.57it/s] 12%|█▏        | 68/553 [00:00<00:04, 109.26it/s] 15%|█▌        | 83/553 [00:00<00:03, 119.84it/s] 17%|█▋        | 96/553 [00:00<00:03, 122.45it/s] 20%|█▉        | 110/553 [00:00<00:03, 126.14it/s] 22%|██▏       | 124/553 [00:00<00:03, 130.10it/s] 25%|██▌       | 140/553 [00:01<00:03, 137.50it/s] 29%|██▊       | 158/553 [00:01<00:02, 147.82it/s] 31%|███▏      | 174/553 [00:01<00:02, 147.05it/s] 34%|███▍      | 189/553 [00:01<00:02, 147.35it/s] 37%|███▋      | 207/553 [00:01<00:02, 155.05it/s] 40%|████      | 223/553 [00:01<00:02, 144.75it/s] 43%|████▎     | 239/553 [00:01<00:02, 147.20it/s] 46%|████▌     | 254/553 [00:01<00:02, 139.33it/s] 49%|████▊     | 269/553 [00:01<00:02, 139.56it/s] 51%|█████▏    | 284/553 [00:02<00:01, 136.29it/s] 54%|█████▍    | 298/553 [00:02<00:01, 132.00it/s] 56%|█████▋    | 312/553 [00:02<00:01, 127.59it/s] 59%|█████▉    | 326/553 [00:02<00:01, 129.42it/s] 61%|██████▏   | 340/553 [00:02<00:01, 131.13it/s] 64%|██████▍   | 354/553 [00:02<00:01, 128.25it/s] 66%|██████▋   | 367/553 [00:02<00:01, 127.27it/s] 69%|██████▉   | 382/553 [00:02<00:01, 132.67it/s] 72%|███████▏  | 396/553 [00:03<00:01, 120.59it/s] 74%|███████▍  | 409/553 [00:03<00:01, 122.39it/s] 76%|███████▋  | 422/553 [00:03<00:01, 118.74it/s] 79%|███████▊  | 435/553 [00:03<00:01, 116.07it/s] 82%|████████▏ | 451/553 [00:03<00:00, 127.68it/s] 84%|████████▍ | 466/553 [00:03<00:00, 132.16it/s] 87%|████████▋ | 480/553 [00:03<00:00, 128.05it/s] 89%|████████▉ | 493/553 [00:03<00:00, 125.19it/s] 92%|█████████▏| 506/553 [00:03<00:00, 125.21it/s] 94%|█████████▍| 520/553 [00:03<00:00, 128.17it/s] 96%|█████████▋| 533/553 [00:04<00:00, 109.31it/s] 99%|█████████▉| 549/553 [00:04<00:00, 120.72it/s]100%|██████████| 553/553 [00:04<00:00, 127.18it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  20%|██        | 28/139 [00:00<00:00, 275.21it/s]extract the null data:  62%|██████▏   | 86/139 [00:00<00:00, 452.49it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 466.61it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 193.39it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 188.23it/s]replace nan value:  42%|████▏     | 59/139 [00:00<00:00, 188.81it/s]replace nan value:  57%|█████▋    | 79/139 [00:00<00:00, 190.44it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 191.50it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 194.45it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.01it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 114.74it/s] 18%|█▊        | 25/139 [00:00<00:00, 121.84it/s] 28%|██▊       | 39/139 [00:00<00:00, 129.41it/s] 37%|███▋      | 52/139 [00:00<00:00, 122.00it/s] 47%|████▋     | 66/139 [00:00<00:00, 126.98it/s] 57%|█████▋    | 79/139 [00:00<00:00, 120.62it/s] 66%|██████▌   | 92/139 [00:00<00:00, 112.06it/s] 76%|███████▌  | 105/139 [00:00<00:00, 113.73it/s] 86%|████████▋ | 120/139 [00:00<00:00, 122.89it/s] 96%|█████████▌| 133/139 [00:01<00:00, 118.45it/s]100%|██████████| 139/139 [00:01<00:00, 121.18it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 298.71it/s]extract the null data:  51%|█████▏    | 89/173 [00:00<00:00, 466.78it/s]extract the null data:  84%|████████▍ | 146/173 [00:00<00:00, 512.15it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 484.90it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 194.94it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 194.66it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 194.81it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 194.94it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 194.38it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 194.88it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 194.10it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 192.98it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 193.29it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 139.87it/s] 16%|█▌        | 28/173 [00:00<00:01, 126.55it/s] 25%|██▌       | 44/173 [00:00<00:00, 139.26it/s] 35%|███▌      | 61/173 [00:00<00:00, 146.97it/s] 44%|████▍     | 76/173 [00:00<00:00, 145.11it/s] 53%|█████▎    | 92/173 [00:00<00:00, 143.91it/s] 62%|██████▏   | 107/173 [00:00<00:00, 145.32it/s] 71%|███████   | 122/173 [00:00<00:00, 143.79it/s] 79%|███████▉  | 137/173 [00:00<00:00, 139.24it/s] 87%|████████▋ | 151/173 [00:01<00:00, 135.01it/s] 95%|█████████▌| 165/173 [00:01<00:00, 122.92it/s]100%|██████████| 173/173 [00:01<00:00, 125.94it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.006, train acc : 0.908, valid acc : 0.924, train f1 : 0.590, valid f1 : 0.593
training process:   1%|          | 1/128 [00:57<2:01:59, 57.64s/it]Best score increase :0.000 -> 0.593
training process:   2%|▏         | 2/128 [01:51<1:56:09, 55.32s/it]Best score increase :0.593 -> 0.690
training process:   2%|▏         | 3/128 [02:42<1:51:15, 53.40s/it]Best score increase :0.690 -> 0.724
training process:   3%|▎         | 4/128 [03:30<1:45:59, 51.28s/it]Best score increase :0.724 -> 0.764
epoch : 5, train loss : 0.003, valid loss : 0.003, train acc : 0.952, valid acc : 0.949, train f1 : 0.800, valid f1 : 0.775
training process:   4%|▍         | 5/128 [04:28<1:50:07, 53.72s/it]Best score increase :0.764 -> 0.775
training process:   5%|▍         | 6/128 [05:24<1:51:05, 54.63s/it]Best score increase :0.775 -> 0.803
training process:   5%|▌         | 7/128 [06:17<1:49:01, 54.06s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [07:06<1:44:36, 52.30s/it]Best score increase :0.803 -> 0.806
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.959, valid acc : 0.955, train f1 : 0.834, valid f1 : 0.816
training process:   7%|▋         | 9/128 [08:03<1:46:50, 53.87s/it]Best score increase :0.806 -> 0.816
training process:   8%|▊         | 10/128 [08:55<1:44:53, 53.34s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:48<1:43:26, 53.05s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [10:35<1:39:02, 51.23s/it]Best score increase :0.816 -> 0.824
epoch : 13, train loss : 0.002, valid loss : 0.003, train acc : 0.962, valid acc : 0.954, train f1 : 0.851, valid f1 : 0.808
training process:  10%|█         | 13/128 [11:30<1:40:46, 52.58s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:19<1:37:30, 51.32s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [13:07<1:34:34, 50.22s/it]Best score increase :0.824 -> 0.839
training process:  12%|█▎        | 16/128 [13:54<1:31:56, 49.25s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.003, train acc : 0.964, valid acc : 0.960, train f1 : 0.859, valid f1 : 0.840
training process:  13%|█▎        | 17/128 [14:55<1:37:38, 52.78s/it]Best score increase :0.839 -> 0.840
training process:  14%|█▍        | 18/128 [15:42<1:34:05, 51.32s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:31<1:31:58, 50.63s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:22<1:31:14, 50.69s/it]Best score increase :0.840 -> 0.842
epoch : 21, train loss : 0.002, valid loss : 0.003, train acc : 0.966, valid acc : 0.961, train f1 : 0.867, valid f1 : 0.845
training process:  16%|█▋        | 21/128 [18:18<1:33:08, 52.22s/it]Best score increase :0.842 -> 0.845
training process:  17%|█▋        | 22/128 [19:07<1:30:28, 51.21s/it]Best score increase :0.845 -> 0.854
training process:  18%|█▊        | 23/128 [19:56<1:28:36, 50.63s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [20:48<1:28:10, 50.87s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.960, train f1 : 0.873, valid f1 : 0.839
training process:  20%|█▉        | 25/128 [21:51<1:33:55, 54.71s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 26/128 [22:39<1:29:29, 52.64s/it]EarlyStopping counter : 4 out of 12
training process:  21%|██        | 27/128 [23:28<1:26:44, 51.53s/it]EarlyStopping counter : 5 out of 12
training process:  22%|██▏       | 28/128 [24:22<1:27:14, 52.34s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.969, valid acc : 0.960, train f1 : 0.883, valid f1 : 0.841
training process:  23%|██▎       | 29/128 [25:24<1:31:06, 55.21s/it]EarlyStopping counter : 7 out of 12
training process:  23%|██▎       | 30/128 [26:20<1:30:17, 55.28s/it]EarlyStopping counter : 8 out of 12
training process:  24%|██▍       | 31/128 [27:18<1:30:41, 56.10s/it]EarlyStopping counter : 9 out of 12
training process:  25%|██▌       | 32/128 [28:13<1:29:28, 55.92s/it]EarlyStopping counter : 10 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.963, train f1 : 0.886, valid f1 : 0.857
training process:  26%|██▌       | 33/128 [29:16<1:31:59, 58.10s/it]Best score increase :0.854 -> 0.857
training process:  27%|██▋       | 34/128 [30:16<1:31:54, 58.66s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [31:16<1:31:23, 58.96s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [32:13<1:29:38, 58.46s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.961, train f1 : 0.892, valid f1 : 0.841
training process:  29%|██▉       | 37/128 [33:18<1:31:20, 60.23s/it]EarlyStopping counter : 4 out of 12
training process:  30%|██▉       | 38/128 [34:16<1:29:18, 59.54s/it]EarlyStopping counter : 5 out of 12
training process:  30%|███       | 39/128 [35:12<1:26:46, 58.50s/it]EarlyStopping counter : 6 out of 12
training process:  31%|███▏      | 40/128 [36:04<1:23:03, 56.64s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.971, valid acc : 0.964, train f1 : 0.889, valid f1 : 0.858
training process:  32%|███▏      | 41/128 [37:05<1:23:58, 57.91s/it]EarlyStopping counter : 8 out of 12
training process:  33%|███▎      | 42/128 [37:59<1:21:11, 56.65s/it]Best score increase :0.857 -> 0.862
training process:  34%|███▎      | 43/128 [38:54<1:19:54, 56.40s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [39:45<1:16:45, 54.82s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.962, train f1 : 0.894, valid f1 : 0.857
training process:  35%|███▌      | 45/128 [40:44<1:17:15, 55.85s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [41:35<1:14:31, 54.53s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [42:26<1:11:54, 53.27s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [43:18<1:10:53, 53.17s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.963, train f1 : 0.896, valid f1 : 0.856
training process:  38%|███▊      | 49/128 [44:19<1:12:54, 55.37s/it]EarlyStopping counter : 7 out of 12
training process:  39%|███▉      | 50/128 [45:11<1:10:41, 54.38s/it]Best score increase :0.862 -> 0.872
training process:  40%|███▉      | 51/128 [46:05<1:09:43, 54.33s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [46:59<1:08:28, 54.06s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.002, valid loss : 0.003, train acc : 0.973, valid acc : 0.964, train f1 : 0.897, valid f1 : 0.863
training process:  41%|████▏     | 53/128 [48:02<1:11:06, 56.89s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [48:55<1:08:45, 55.76s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [49:48<1:06:51, 54.95s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [50:42<1:05:22, 54.48s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.003, train acc : 0.974, valid acc : 0.964, train f1 : 0.903, valid f1 : 0.859
training process:  45%|████▍     | 57/128 [51:39<1:05:18, 55.20s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [52:28<1:02:25, 53.51s/it]EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [53:20<1:00:55, 52.99s/it]EarlyStopping counter : 9 out of 12
training process:  47%|████▋     | 60/128 [54:14<1:00:31, 53.41s/it]EarlyStopping counter : 10 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.003, train acc : 0.974, valid acc : 0.963, train f1 : 0.903, valid f1 : 0.857
training process:  48%|████▊     | 61/128 [55:19<1:03:16, 56.67s/it]EarlyStopping counter : 11 out of 12
training process:  48%|████▊     | 61/128 [56:11<1:01:43, 55.27s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 61, best f1 score : 0.872
training process finished, best loss : 0.002 and best acc : 0.966, best f1 : 0.872, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.66      0.77       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.83      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.83, test loss : 0.152

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.34s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.73s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.64s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:02,  7.75s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:55,  7.88s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.93s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.95s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.99s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:24,  8.05s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:16,  8.12s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:08,  8.05s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  8.04s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.95s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 14/306 [00:00<00:02, 131.94it/s]  9%|▉         | 28/306 [00:00<00:02, 110.46it/s] 14%|█▍        | 44/306 [00:00<00:02, 124.34it/s] 19%|█▉        | 59/306 [00:00<00:01, 132.91it/s] 25%|██▍       | 75/306 [00:00<00:01, 139.34it/s] 29%|██▉       | 90/306 [00:00<00:01, 129.64it/s] 34%|███▍      | 104/306 [00:00<00:01, 123.15it/s] 39%|███▉      | 119/306 [00:00<00:01, 128.68it/s] 44%|████▍     | 135/306 [00:01<00:01, 136.19it/s] 49%|████▊     | 149/306 [00:01<00:01, 133.22it/s] 53%|█████▎    | 163/306 [00:01<00:01, 118.03it/s] 59%|█████▉    | 180/306 [00:01<00:00, 131.03it/s] 63%|██████▎   | 194/306 [00:01<00:00, 132.00it/s] 69%|██████▉   | 211/306 [00:01<00:00, 141.11it/s] 74%|███████▍  | 226/306 [00:01<00:00, 122.96it/s] 79%|███████▉  | 241/306 [00:01<00:00, 128.65it/s] 85%|████████▍ | 259/306 [00:01<00:00, 142.03it/s] 90%|████████▉ | 274/306 [00:02<00:00, 139.37it/s] 95%|█████████▍| 290/306 [00:02<00:00, 144.85it/s]100%|█████████▉| 305/306 [00:02<00:00, 136.88it/s]100%|██████████| 306/306 [00:02<00:00, 131.98it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 56/553 [00:00<00:00, 550.69it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 576.22it/s]extract the null data:  32%|███▏      | 178/553 [00:00<00:00, 591.31it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 604.12it/s]extract the null data:  55%|█████▍    | 303/553 [00:00<00:00, 602.88it/s]extract the null data:  66%|██████▌   | 365/553 [00:00<00:00, 606.20it/s]extract the null data:  77%|███████▋  | 426/553 [00:00<00:00, 584.97it/s]extract the null data:  88%|████████▊ | 485/553 [00:00<00:00, 581.87it/s]extract the null data:  98%|█████████▊| 544/553 [00:00<00:00, 574.27it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 584.05it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 188.40it/s]replace nan value:   7%|▋         | 39/553 [00:00<00:02, 193.35it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 194.52it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:02, 191.70it/s]replace nan value:  18%|█▊        | 99/553 [00:00<00:02, 186.63it/s]replace nan value:  21%|██▏       | 118/553 [00:00<00:02, 186.87it/s]replace nan value:  25%|██▍       | 138/553 [00:00<00:02, 188.20it/s]replace nan value:  29%|██▊       | 158/553 [00:00<00:02, 191.72it/s]replace nan value:  32%|███▏      | 178/553 [00:00<00:01, 191.39it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:01, 190.83it/s]replace nan value:  39%|███▉      | 218/553 [00:01<00:01, 190.55it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 190.35it/s]replace nan value:  47%|████▋     | 258/553 [00:01<00:01, 190.26it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 187.50it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 187.50it/s]replace nan value:  57%|█████▋    | 316/553 [00:01<00:01, 188.01it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 188.58it/s]replace nan value:  64%|██████▍   | 355/553 [00:01<00:01, 189.67it/s]replace nan value:  68%|██████▊   | 375/553 [00:01<00:00, 190.83it/s]replace nan value:  71%|███████▏  | 395/553 [00:02<00:00, 191.81it/s]replace nan value:  75%|███████▌  | 415/553 [00:02<00:00, 191.45it/s]replace nan value:  79%|███████▊  | 435/553 [00:02<00:00, 190.17it/s]replace nan value:  82%|████████▏ | 455/553 [00:02<00:00, 190.05it/s]replace nan value:  86%|████████▌ | 475/553 [00:02<00:00, 189.53it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 189.23it/s]replace nan value:  93%|█████████▎| 513/553 [00:02<00:00, 189.21it/s]replace nan value:  96%|█████████▌| 532/553 [00:02<00:00, 187.74it/s]replace nan value: 100%|█████████▉| 551/553 [00:02<00:00, 186.61it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 189.36it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.45it/s]  5%|▌         | 28/553 [00:00<00:03, 140.52it/s]  8%|▊         | 43/553 [00:00<00:03, 133.70it/s] 10%|█         | 57/553 [00:00<00:03, 124.09it/s] 13%|█▎        | 70/553 [00:00<00:04, 117.50it/s] 15%|█▌        | 85/553 [00:00<00:03, 126.87it/s] 18%|█▊        | 98/553 [00:00<00:03, 126.34it/s] 21%|██        | 115/553 [00:00<00:03, 137.49it/s] 23%|██▎       | 129/553 [00:00<00:03, 136.65it/s] 27%|██▋       | 148/553 [00:01<00:02, 151.92it/s] 30%|███       | 166/553 [00:01<00:02, 158.26it/s] 33%|███▎      | 182/553 [00:01<00:02, 156.16it/s] 36%|███▌      | 200/553 [00:01<00:02, 163.08it/s] 39%|███▉      | 217/553 [00:01<00:02, 161.81it/s] 42%|████▏     | 234/553 [00:01<00:02, 152.76it/s] 45%|████▌     | 250/553 [00:01<00:02, 147.58it/s] 48%|████▊     | 265/553 [00:01<00:01, 145.92it/s] 51%|█████     | 280/553 [00:01<00:01, 139.95it/s] 53%|█████▎    | 295/553 [00:02<00:01, 136.76it/s] 56%|█████▌    | 309/553 [00:02<00:01, 133.68it/s] 58%|█████▊    | 323/553 [00:02<00:01, 130.74it/s] 61%|██████    | 337/553 [00:02<00:01, 133.12it/s] 63%|██████▎   | 351/553 [00:02<00:01, 132.47it/s] 66%|██████▌   | 365/553 [00:02<00:01, 129.55it/s] 68%|██████▊   | 378/553 [00:02<00:01, 109.04it/s] 71%|███████   | 390/553 [00:02<00:01, 105.47it/s] 73%|███████▎  | 402/553 [00:03<00:01, 108.86it/s] 75%|███████▌  | 416/553 [00:03<00:01, 113.25it/s] 77%|███████▋  | 428/553 [00:03<00:01, 110.09it/s] 80%|████████  | 445/553 [00:03<00:00, 125.58it/s] 83%|████████▎ | 460/553 [00:03<00:00, 131.72it/s] 86%|████████▌ | 474/553 [00:03<00:00, 133.80it/s] 88%|████████▊ | 488/553 [00:03<00:00, 128.56it/s] 91%|█████████ | 502/553 [00:03<00:00, 122.05it/s] 93%|█████████▎| 517/553 [00:03<00:00, 127.15it/s] 96%|█████████▌| 530/553 [00:04<00:00, 108.58it/s] 98%|█████████▊| 544/553 [00:04<00:00, 115.97it/s]100%|██████████| 553/553 [00:04<00:00, 128.17it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 24/139 [00:00<00:00, 238.38it/s]extract the null data:  56%|█████▌    | 78/139 [00:00<00:00, 414.42it/s]extract the null data:  94%|█████████▍| 131/139 [00:00<00:00, 462.98it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 436.45it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 183.86it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 186.72it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 186.86it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 188.56it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 187.14it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 186.89it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 187.34it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 187.24it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.01it/s] 17%|█▋        | 24/139 [00:00<00:00, 118.19it/s] 27%|██▋       | 38/139 [00:00<00:00, 125.19it/s] 37%|███▋      | 51/139 [00:00<00:00, 120.60it/s] 46%|████▌     | 64/139 [00:00<00:00, 122.28it/s] 55%|█████▌    | 77/139 [00:00<00:00, 124.28it/s] 65%|██████▍   | 90/139 [00:00<00:00, 115.92it/s] 76%|███████▌  | 105/139 [00:00<00:00, 121.85it/s] 87%|████████▋ | 121/139 [00:00<00:00, 132.65it/s] 97%|█████████▋| 135/139 [00:01<00:00, 128.46it/s]100%|██████████| 139/139 [00:01<00:00, 125.77it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 21/173 [00:00<00:00, 207.69it/s]extract the null data:  42%|████▏     | 73/173 [00:00<00:00, 386.43it/s]extract the null data:  72%|███████▏  | 124/173 [00:00<00:00, 439.53it/s]extract the null data:  99%|█████████▉| 172/173 [00:00<00:00, 454.35it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 424.61it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 186.14it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 186.89it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 189.00it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 187.93it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 185.55it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 184.82it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 186.17it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 183.99it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 181.65it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 184.48it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 126.11it/s] 16%|█▌        | 27/173 [00:00<00:01, 112.63it/s] 24%|██▎       | 41/173 [00:00<00:01, 122.10it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.56it/s] 39%|███▉      | 68/173 [00:00<00:00, 127.25it/s] 47%|████▋     | 81/173 [00:00<00:00, 126.50it/s] 54%|█████▍    | 94/173 [00:00<00:00, 127.55it/s] 62%|██████▏   | 107/173 [00:00<00:00, 126.11it/s] 69%|██████▉   | 120/173 [00:00<00:00, 125.41it/s] 77%|███████▋  | 133/173 [00:01<00:00, 118.95it/s] 84%|████████▍ | 146/173 [00:01<00:00, 119.30it/s] 91%|█████████▏| 158/173 [00:01<00:00, 110.30it/s] 98%|█████████▊| 170/173 [00:01<00:00, 92.05it/s] 100%|██████████| 173/173 [00:01<00:00, 110.33it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.007, train acc : 0.706, valid acc : 0.815, train f1 : 0.706, valid f1 : 0.641
training process:   1%|          | 1/128 [01:06<2:20:09, 66.22s/it]Best score increase :0.000 -> 0.641
training process:   2%|▏         | 2/128 [02:01<2:05:02, 59.55s/it]Best score increase :0.641 -> 0.694
training process:   2%|▏         | 3/128 [02:51<1:55:47, 55.58s/it]Best score increase :0.694 -> 0.754
training process:   3%|▎         | 4/128 [03:48<1:55:35, 55.93s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.006, valid loss : 0.006, train acc : 0.857, valid acc : 0.870, train f1 : 0.857, valid f1 : 0.729
training process:   4%|▍         | 5/128 [04:54<2:02:28, 59.74s/it]EarlyStopping counter : 2 out of 12
training process:   5%|▍         | 6/128 [05:51<1:59:16, 58.66s/it]Best score increase :0.754 -> 0.758
training process:   5%|▌         | 7/128 [06:44<1:54:16, 56.67s/it]Best score increase :0.758 -> 0.772
training process:   6%|▋         | 8/128 [07:35<1:49:43, 54.86s/it]Best score increase :0.772 -> 0.789
epoch : 9, train loss : 0.005, valid loss : 0.006, train acc : 0.883, valid acc : 0.864, train f1 : 0.883, valid f1 : 0.723
training process:   7%|▋         | 9/128 [08:37<1:53:24, 57.18s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:32<1:51:10, 56.53s/it]Best score increase :0.789 -> 0.801
training process:   9%|▊         | 11/128 [10:28<1:49:52, 56.35s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:22<1:47:46, 55.75s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.005, valid loss : 0.004, train acc : 0.892, valid acc : 0.928, train f1 : 0.892, valid f1 : 0.811
training process:  10%|█         | 13/128 [12:24<1:50:10, 57.48s/it]Best score increase :0.801 -> 0.811
training process:  11%|█         | 14/128 [13:17<1:46:37, 56.12s/it]Best score increase :0.811 -> 0.834
training process:  12%|█▏        | 15/128 [14:14<1:46:11, 56.38s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:07<1:43:46, 55.60s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.004, train acc : 0.902, valid acc : 0.913, train f1 : 0.902, valid f1 : 0.790
training process:  13%|█▎        | 17/128 [16:13<1:48:12, 58.49s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [17:07<1:45:05, 57.32s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [18:00<1:41:40, 55.97s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [18:55<1:40:16, 55.71s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.004, train acc : 0.910, valid acc : 0.922, train f1 : 0.910, valid f1 : 0.807
training process:  16%|█▋        | 21/128 [19:58<1:43:09, 57.84s/it]EarlyStopping counter : 7 out of 12
training process:  17%|█▋        | 22/128 [20:54<1:41:08, 57.25s/it]EarlyStopping counter : 8 out of 12
training process:  18%|█▊        | 23/128 [21:49<1:39:20, 56.77s/it]EarlyStopping counter : 9 out of 12
training process:  19%|█▉        | 24/128 [22:40<1:34:59, 54.80s/it]EarlyStopping counter : 10 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.003, train acc : 0.918, valid acc : 0.940, train f1 : 0.918, valid f1 : 0.838
training process:  20%|█▉        | 25/128 [23:40<1:37:00, 56.51s/it]Best score increase :0.834 -> 0.838
training process:  20%|██        | 26/128 [24:34<1:34:46, 55.75s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [25:29<1:33:29, 55.54s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [26:23<1:31:35, 54.96s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.004, valid loss : 0.003, train acc : 0.923, valid acc : 0.937, train f1 : 0.923, valid f1 : 0.832
training process:  23%|██▎       | 29/128 [27:25<1:34:06, 57.04s/it]EarlyStopping counter : 4 out of 12
training process:  23%|██▎       | 30/128 [28:17<1:30:50, 55.61s/it]EarlyStopping counter : 5 out of 12
training process:  24%|██▍       | 31/128 [29:10<1:28:42, 54.87s/it]EarlyStopping counter : 6 out of 12
training process:  25%|██▌       | 32/128 [30:06<1:28:20, 55.22s/it]Best score increase :0.838 -> 0.854
epoch : 33, train loss : 0.003, valid loss : 0.003, train acc : 0.929, valid acc : 0.940, train f1 : 0.929, valid f1 : 0.839
training process:  26%|██▌       | 33/128 [31:11<1:31:53, 58.03s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [32:06<1:29:47, 57.32s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [32:57<1:25:34, 55.21s/it]EarlyStopping counter : 3 out of 12
training process:  28%|██▊       | 36/128 [33:48<1:22:38, 53.89s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.004, train acc : 0.931, valid acc : 0.923, train f1 : 0.931, valid f1 : 0.811
training process:  29%|██▉       | 37/128 [34:50<1:25:25, 56.33s/it]EarlyStopping counter : 5 out of 12
training process:  30%|██▉       | 38/128 [35:44<1:23:32, 55.69s/it]EarlyStopping counter : 6 out of 12
training process:  30%|███       | 39/128 [36:39<1:22:16, 55.47s/it]EarlyStopping counter : 7 out of 12
training process:  31%|███▏      | 40/128 [37:32<1:20:36, 54.96s/it]EarlyStopping counter : 8 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.003, train acc : 0.935, valid acc : 0.934, train f1 : 0.935, valid f1 : 0.828
training process:  32%|███▏      | 41/128 [38:30<1:20:39, 55.63s/it]EarlyStopping counter : 9 out of 12
training process:  33%|███▎      | 42/128 [39:18<1:16:43, 53.53s/it]EarlyStopping counter : 10 out of 12
training process:  34%|███▎      | 43/128 [40:11<1:15:40, 53.42s/it]EarlyStopping counter : 11 out of 12
training process:  34%|███▎      | 43/128 [41:01<1:21:06, 57.25s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 43, best f1 score : 0.854
training process finished, best loss : 0.003 and best acc : 0.947, best f1 : 0.854, best epoch : 31

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.84      0.66       580
           1       0.99      0.94      0.96      6818

    accuracy                           0.93      7398
   macro avg       0.76      0.89      0.81      7398
weighted avg       0.95      0.93      0.94      7398


# test acc : 0.93, test f1 : 0.81, test AUC : 0.89, test loss : 0.193

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.39s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:15,  7.50s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.60s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:02,  7.77s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:55,  7.88s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:47,  7.90s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:39,  7.89s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.95s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.80s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.81s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.93s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  8.00s/it]processing for feature importance: 100%|██████████| 12/12 [01:34<00:00,  7.86s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▌         | 16/306 [00:00<00:01, 157.79it/s] 10%|█         | 32/306 [00:00<00:01, 157.81it/s] 16%|█▌        | 49/306 [00:00<00:01, 161.09it/s] 22%|██▏       | 66/306 [00:00<00:01, 161.81it/s] 28%|██▊       | 85/306 [00:00<00:01, 168.98it/s] 33%|███▎      | 102/306 [00:00<00:01, 164.61it/s] 40%|███▉      | 121/306 [00:00<00:01, 171.38it/s] 46%|████▌     | 140/306 [00:00<00:00, 174.05it/s] 52%|█████▏    | 158/306 [00:00<00:00, 171.19it/s] 58%|█████▊    | 176/306 [00:01<00:00, 168.15it/s] 63%|██████▎   | 193/306 [00:01<00:00, 168.57it/s] 69%|██████▊   | 210/306 [00:01<00:00, 164.96it/s] 75%|███████▍  | 228/306 [00:01<00:00, 167.04it/s] 80%|████████  | 245/306 [00:01<00:00, 166.32it/s] 86%|████████▌ | 263/306 [00:01<00:00, 168.36it/s] 92%|█████████▏| 280/306 [00:01<00:00, 165.63it/s] 97%|█████████▋| 298/306 [00:01<00:00, 167.46it/s]100%|██████████| 306/306 [00:01<00:00, 167.57it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 44/553 [00:00<00:01, 439.63it/s]extract the null data:  16%|█▌        | 89/553 [00:00<00:01, 440.80it/s]extract the null data:  24%|██▍       | 134/553 [00:00<00:00, 443.25it/s]extract the null data:  32%|███▏      | 179/553 [00:00<00:00, 442.69it/s]extract the null data:  41%|████      | 224/553 [00:00<00:00, 444.69it/s]extract the null data:  49%|████▉     | 270/553 [00:00<00:00, 449.35it/s]extract the null data:  57%|█████▋    | 315/553 [00:00<00:00, 445.29it/s]extract the null data:  65%|██████▌   | 360/553 [00:00<00:00, 443.79it/s]extract the null data:  73%|███████▎  | 405/553 [00:00<00:00, 445.48it/s]extract the null data:  81%|████████▏ | 450/553 [00:01<00:00, 445.91it/s]extract the null data:  90%|█████████ | 498/553 [00:01<00:00, 454.48it/s]extract the null data:  98%|█████████▊| 544/553 [00:01<00:00, 450.37it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 446.54it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 164.18it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 164.63it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 165.42it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 164.84it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 165.80it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 165.31it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 166.70it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 162.86it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:02, 163.40it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 164.75it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 164.88it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 165.67it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:02, 165.80it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 164.77it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 164.80it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 164.66it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 165.18it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 165.08it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 164.91it/s]replace nan value:  61%|██████▏   | 340/553 [00:02<00:01, 165.65it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 164.65it/s]replace nan value:  68%|██████▊   | 374/553 [00:02<00:01, 165.59it/s]replace nan value:  71%|███████   | 391/553 [00:02<00:00, 165.83it/s]replace nan value:  74%|███████▍  | 408/553 [00:02<00:00, 165.34it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 164.11it/s]replace nan value:  80%|████████  | 443/553 [00:02<00:00, 166.05it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 166.72it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 167.16it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 166.36it/s]replace nan value:  92%|█████████▏| 511/553 [00:03<00:00, 167.37it/s]replace nan value:  95%|█████████▌| 528/553 [00:03<00:00, 167.18it/s]replace nan value:  99%|█████████▊| 545/553 [00:03<00:00, 167.38it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 165.45it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.18it/s]  5%|▍         | 27/553 [00:00<00:04, 130.83it/s]  7%|▋         | 41/553 [00:00<00:03, 128.53it/s] 10%|▉         | 54/553 [00:00<00:04, 117.58it/s] 12%|█▏        | 66/553 [00:00<00:04, 109.13it/s] 14%|█▍        | 80/553 [00:00<00:04, 115.35it/s] 17%|█▋        | 93/553 [00:00<00:03, 119.66it/s] 19%|█▉        | 107/553 [00:00<00:03, 124.78it/s] 22%|██▏       | 122/553 [00:00<00:03, 126.60it/s] 25%|██▍       | 137/553 [00:01<00:03, 131.89it/s] 28%|██▊       | 153/553 [00:01<00:02, 139.48it/s] 31%|███       | 169/553 [00:01<00:02, 145.15it/s] 33%|███▎      | 184/553 [00:01<00:02, 141.01it/s] 36%|███▋      | 201/553 [00:01<00:02, 147.33it/s] 39%|███▉      | 216/553 [00:01<00:02, 146.33it/s] 42%|████▏     | 231/553 [00:01<00:02, 135.88it/s] 44%|████▍     | 245/553 [00:01<00:02, 136.03it/s] 47%|████▋     | 260/553 [00:01<00:02, 138.97it/s] 50%|████▉     | 274/553 [00:02<00:02, 133.36it/s] 52%|█████▏    | 289/553 [00:02<00:01, 136.40it/s] 55%|█████▍    | 303/553 [00:02<00:01, 128.12it/s] 57%|█████▋    | 316/553 [00:02<00:01, 121.16it/s] 59%|█████▉    | 329/553 [00:02<00:01, 121.23it/s] 62%|██████▏   | 344/553 [00:02<00:01, 127.76it/s] 65%|██████▍   | 357/553 [00:02<00:01, 120.25it/s] 67%|██████▋   | 372/553 [00:02<00:01, 127.29it/s] 70%|██████▉   | 385/553 [00:02<00:01, 122.17it/s] 72%|███████▏  | 398/553 [00:03<00:01, 111.49it/s] 75%|███████▍  | 414/553 [00:03<00:01, 119.16it/s] 77%|███████▋  | 427/553 [00:03<00:01, 109.56it/s] 80%|███████▉  | 442/553 [00:03<00:00, 119.46it/s] 83%|████████▎ | 457/553 [00:03<00:00, 127.51it/s] 85%|████████▌ | 471/553 [00:03<00:00, 129.71it/s] 88%|████████▊ | 485/553 [00:03<00:00, 129.03it/s] 90%|█████████ | 499/553 [00:03<00:00, 119.41it/s] 93%|█████████▎| 513/553 [00:04<00:00, 124.78it/s] 95%|█████████▌| 526/553 [00:04<00:00, 111.86it/s] 97%|█████████▋| 538/553 [00:04<00:00, 109.92it/s]100%|█████████▉| 551/553 [00:04<00:00, 98.76it/s] 100%|██████████| 553/553 [00:04<00:00, 123.50it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 255.69it/s]extract the null data:  56%|█████▌    | 78/139 [00:00<00:00, 407.82it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 453.37it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 431.37it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 184.08it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 181.73it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 183.41it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 183.97it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 183.76it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 183.83it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 185.15it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 184.15it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 125.97it/s] 21%|██        | 29/139 [00:00<00:00, 135.90it/s] 33%|███▎      | 46/139 [00:00<00:00, 145.17it/s] 44%|████▍     | 61/139 [00:00<00:00, 131.27it/s] 55%|█████▍    | 76/139 [00:00<00:00, 134.93it/s] 65%|██████▍   | 90/139 [00:00<00:00, 121.46it/s] 76%|███████▌  | 105/139 [00:00<00:00, 125.73it/s] 87%|████████▋ | 121/139 [00:00<00:00, 134.80it/s] 97%|█████████▋| 135/139 [00:01<00:00, 130.00it/s]100%|██████████| 139/139 [00:01<00:00, 132.30it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  14%|█▍        | 24/173 [00:00<00:00, 239.92it/s]extract the null data:  44%|████▍     | 76/173 [00:00<00:00, 404.60it/s]extract the null data:  73%|███████▎  | 127/173 [00:00<00:00, 451.31it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 439.67it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 183.48it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 183.41it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 182.91it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 181.53it/s]replace nan value:  55%|█████▍    | 95/173 [00:00<00:00, 181.64it/s]replace nan value:  66%|██████▌   | 114/173 [00:00<00:00, 180.83it/s]replace nan value:  77%|███████▋  | 133/173 [00:00<00:00, 181.11it/s]replace nan value:  88%|████████▊ | 152/173 [00:00<00:00, 180.35it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 177.55it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 180.06it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 125.68it/s] 16%|█▌        | 27/173 [00:00<00:01, 109.00it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.39it/s] 32%|███▏      | 55/173 [00:00<00:00, 125.01it/s] 39%|███▉      | 68/173 [00:00<00:00, 125.40it/s] 47%|████▋     | 81/173 [00:00<00:00, 124.99it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.84it/s] 62%|██████▏   | 107/173 [00:00<00:00, 124.68it/s] 69%|██████▉   | 120/173 [00:00<00:00, 124.30it/s] 77%|███████▋  | 133/173 [00:01<00:00, 118.32it/s] 84%|████████▍ | 146/173 [00:01<00:00, 118.92it/s] 91%|█████████▏| 158/173 [00:01<00:00, 109.52it/s] 98%|█████████▊| 170/173 [00:01<00:00, 91.28it/s] 100%|██████████| 173/173 [00:01<00:00, 109.09it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.673, valid acc : 0.804, train f1 : 0.520, valid f1 : 0.628
training process:   1%|          | 1/128 [01:06<2:20:55, 66.58s/it]Best score increase :0.000 -> 0.628
training process:   2%|▏         | 2/128 [02:03<2:07:42, 60.81s/it]Best score increase :0.628 -> 0.668
training process:   2%|▏         | 3/128 [03:00<2:02:44, 58.91s/it]Best score increase :0.668 -> 0.714
training process:   3%|▎         | 4/128 [03:55<1:58:52, 57.52s/it]Best score increase :0.714 -> 0.740
epoch : 5, train loss : 0.007, valid loss : 0.008, train acc : 0.851, valid acc : 0.936, train f1 : 0.692, valid f1 : 0.800
training process:   4%|▍         | 5/128 [04:55<1:59:39, 58.37s/it]Best score increase :0.740 -> 0.800
training process:   5%|▍         | 6/128 [05:49<1:56:03, 57.08s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:45<1:53:51, 56.46s/it]Best score increase :0.800 -> 0.810
training process:   6%|▋         | 8/128 [07:40<1:52:30, 56.26s/it]Best score increase :0.810 -> 0.822
epoch : 9, train loss : 0.006, valid loss : 0.006, train acc : 0.899, valid acc : 0.944, train f1 : 0.753, valid f1 : 0.829
training process:   7%|▋         | 9/128 [08:44<1:55:59, 58.48s/it]Best score increase :0.822 -> 0.829
training process:   8%|▊         | 10/128 [09:35<1:50:47, 56.33s/it]Best score increase :0.829 -> 0.832
training process:   9%|▊         | 11/128 [10:27<1:47:03, 54.90s/it]Best score increase :0.832 -> 0.836
training process:   9%|▉         | 12/128 [11:23<1:46:51, 55.27s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.006, valid loss : 0.008, train acc : 0.913, valid acc : 0.954, train f1 : 0.777, valid f1 : 0.844
training process:  10%|█         | 13/128 [12:26<1:50:17, 57.55s/it]Best score increase :0.836 -> 0.844
training process:  11%|█         | 14/128 [13:20<1:47:28, 56.57s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [14:16<1:45:54, 56.24s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [15:06<1:41:46, 54.52s/it]Best score increase :0.844 -> 0.846
epoch : 17, train loss : 0.005, valid loss : 0.007, train acc : 0.928, valid acc : 0.944, train f1 : 0.803, valid f1 : 0.831
training process:  13%|█▎        | 17/128 [16:05<1:43:02, 55.70s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 18/128 [17:01<1:42:16, 55.78s/it]EarlyStopping counter : 2 out of 12
training process:  15%|█▍        | 19/128 [17:56<1:41:25, 55.83s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 20/128 [18:53<1:40:54, 56.06s/it]Best score increase :0.846 -> 0.852
epoch : 21, train loss : 0.005, valid loss : 0.007, train acc : 0.930, valid acc : 0.954, train f1 : 0.809, valid f1 : 0.854
training process:  16%|█▋        | 21/128 [19:52<1:41:44, 57.05s/it]Best score increase :0.852 -> 0.854
training process:  17%|█▋        | 22/128 [20:43<1:37:30, 55.19s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [21:38<1:36:06, 54.92s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [22:32<1:34:44, 54.66s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.007, train acc : 0.933, valid acc : 0.955, train f1 : 0.814, valid f1 : 0.851
training process:  20%|█▉        | 25/128 [23:34<1:37:40, 56.90s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [24:28<1:35:37, 56.25s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [25:19<1:31:52, 54.58s/it]Best score increase :0.854 -> 0.859
training process:  22%|██▏       | 28/128 [26:12<1:29:57, 53.97s/it]EarlyStopping counter : 1 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.008, train acc : 0.940, valid acc : 0.957, train f1 : 0.830, valid f1 : 0.855
training process:  23%|██▎       | 29/128 [27:14<1:33:23, 56.60s/it]EarlyStopping counter : 2 out of 12
training process:  23%|██▎       | 30/128 [28:09<1:31:34, 56.07s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 31/128 [29:04<1:29:49, 55.56s/it]EarlyStopping counter : 4 out of 12
training process:  25%|██▌       | 32/128 [29:54<1:26:25, 54.02s/it]EarlyStopping counter : 5 out of 12
epoch : 33, train loss : 0.005, valid loss : 0.007, train acc : 0.941, valid acc : 0.956, train f1 : 0.833, valid f1 : 0.857
training process:  26%|██▌       | 33/128 [30:54<1:28:15, 55.75s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 34/128 [31:50<1:27:20, 55.75s/it]EarlyStopping counter : 7 out of 12
training process:  27%|██▋       | 35/128 [32:44<1:25:43, 55.30s/it]Best score increase :0.859 -> 0.864
training process:  28%|██▊       | 36/128 [33:38<1:24:10, 54.89s/it]EarlyStopping counter : 1 out of 12
epoch : 37, train loss : 0.005, valid loss : 0.009, train acc : 0.943, valid acc : 0.959, train f1 : 0.837, valid f1 : 0.859
training process:  29%|██▉       | 37/128 [34:40<1:26:43, 57.19s/it]EarlyStopping counter : 2 out of 12
training process:  30%|██▉       | 38/128 [35:34<1:24:01, 56.02s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 39/128 [36:27<1:21:43, 55.10s/it]EarlyStopping counter : 4 out of 12
training process:  31%|███▏      | 40/128 [37:20<1:20:13, 54.70s/it]EarlyStopping counter : 5 out of 12
epoch : 41, train loss : 0.004, valid loss : 0.008, train acc : 0.944, valid acc : 0.956, train f1 : 0.840, valid f1 : 0.855
training process:  32%|███▏      | 41/128 [38:25<1:23:42, 57.74s/it]EarlyStopping counter : 6 out of 12
training process:  33%|███▎      | 42/128 [39:20<1:21:38, 56.96s/it]Best score increase :0.864 -> 0.866
training process:  34%|███▎      | 43/128 [40:14<1:19:13, 55.93s/it]EarlyStopping counter : 1 out of 12
training process:  34%|███▍      | 44/128 [41:04<1:16:01, 54.30s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.004, valid loss : 0.007, train acc : 0.947, valid acc : 0.953, train f1 : 0.847, valid f1 : 0.856
training process:  35%|███▌      | 45/128 [42:08<1:18:56, 57.07s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 46/128 [43:02<1:16:35, 56.05s/it]EarlyStopping counter : 4 out of 12
training process:  37%|███▋      | 47/128 [43:56<1:15:10, 55.69s/it]EarlyStopping counter : 5 out of 12
training process:  38%|███▊      | 48/128 [44:48<1:12:37, 54.47s/it]EarlyStopping counter : 6 out of 12
epoch : 49, train loss : 0.004, valid loss : 0.007, train acc : 0.947, valid acc : 0.957, train f1 : 0.846, valid f1 : 0.861
training process:  38%|███▊      | 49/128 [45:47<1:13:28, 55.81s/it]EarlyStopping counter : 7 out of 12
training process:  39%|███▉      | 50/128 [46:42<1:12:12, 55.54s/it]EarlyStopping counter : 8 out of 12
training process:  40%|███▉      | 51/128 [47:36<1:10:48, 55.18s/it]EarlyStopping counter : 9 out of 12
training process:  41%|████      | 52/128 [48:31<1:09:50, 55.14s/it]EarlyStopping counter : 10 out of 12
epoch : 53, train loss : 0.004, valid loss : 0.008, train acc : 0.951, valid acc : 0.960, train f1 : 0.854, valid f1 : 0.867
training process:  41%|████▏     | 53/128 [49:31<1:10:28, 56.38s/it]EarlyStopping counter : 11 out of 12
training process:  41%|████▏     | 53/128 [50:16<1:11:09, 56.92s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 53, best f1 score : 0.867
training process finished, best loss : 0.009 and best acc : 0.960, best f1 : 0.867, best epoch : 50

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.64      0.78      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.81      0.87      0.84      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.84, test AUC : 0.87, test loss : 0.468

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:19,  7.23s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.64s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.99s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:06,  8.27s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:56,  8.12s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:48,  8.11s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.95s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.88s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:24,  8.02s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:16,  8.05s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.96s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.97s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.98s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 183.45it/s] 12%|█▏        | 38/306 [00:00<00:02, 120.18it/s] 20%|█▉        | 60/306 [00:00<00:01, 151.48it/s] 25%|██▌       | 77/306 [00:00<00:01, 156.99it/s] 31%|███       | 95/306 [00:00<00:01, 159.64it/s] 37%|███▋      | 112/306 [00:00<00:01, 134.89it/s] 44%|████▍     | 135/306 [00:00<00:01, 155.32it/s] 50%|█████     | 153/306 [00:00<00:00, 161.59it/s] 56%|█████▌    | 172/306 [00:01<00:00, 165.64it/s] 62%|██████▏   | 190/306 [00:01<00:00, 143.11it/s] 69%|██████▉   | 212/306 [00:01<00:00, 161.45it/s] 75%|███████▌  | 230/306 [00:01<00:00, 163.59it/s] 81%|████████  | 248/306 [00:01<00:00, 165.94it/s] 87%|████████▋ | 266/306 [00:01<00:00, 145.32it/s] 94%|█████████▍| 287/306 [00:01<00:00, 161.29it/s] 99%|█████████▉| 304/306 [00:01<00:00, 161.70it/s]100%|██████████| 306/306 [00:01<00:00, 156.10it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_RW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 57/553 [00:00<00:00, 564.55it/s]extract the null data:  22%|██▏       | 119/553 [00:00<00:00, 591.61it/s]extract the null data:  33%|███▎      | 180/553 [00:00<00:00, 596.24it/s]extract the null data:  43%|████▎     | 240/553 [00:00<00:00, 592.31it/s]extract the null data:  54%|█████▍    | 300/553 [00:00<00:00, 576.30it/s]extract the null data:  65%|██████▍   | 358/553 [00:00<00:00, 572.88it/s]extract the null data:  75%|███████▌  | 416/553 [00:00<00:00, 574.83it/s]extract the null data:  86%|████████▌ | 474/553 [00:00<00:00, 574.35it/s]extract the null data:  96%|█████████▌| 532/553 [00:00<00:00, 565.32it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 573.08it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 185.18it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 187.32it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 186.88it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 185.22it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:02, 185.12it/s]replace nan value:  21%|██        | 115/553 [00:00<00:02, 183.72it/s]replace nan value:  24%|██▍       | 134/553 [00:00<00:02, 183.15it/s]replace nan value:  28%|██▊       | 154/553 [00:00<00:02, 186.58it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:02, 187.40it/s]replace nan value:  35%|███▌      | 194/553 [00:01<00:01, 188.40it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 189.45it/s]replace nan value:  42%|████▏     | 233/553 [00:01<00:01, 186.90it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 185.95it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 187.81it/s]replace nan value:  53%|█████▎    | 291/553 [00:01<00:01, 188.08it/s]replace nan value:  56%|█████▌    | 310/553 [00:01<00:01, 185.93it/s]replace nan value:  60%|█████▉    | 330/553 [00:01<00:01, 187.91it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:01, 185.92it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 185.14it/s]replace nan value:  70%|██████▉   | 387/553 [00:02<00:00, 184.06it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 183.69it/s]replace nan value:  77%|███████▋  | 425/553 [00:02<00:00, 182.76it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 182.45it/s]replace nan value:  84%|████████▎ | 463/553 [00:02<00:00, 183.15it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 183.90it/s]replace nan value:  91%|█████████ | 501/553 [00:02<00:00, 184.55it/s]replace nan value:  94%|█████████▍| 521/553 [00:02<00:00, 186.20it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 187.05it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 185.71it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:04, 134.66it/s]  5%|▌         | 29/553 [00:00<00:03, 140.24it/s]  8%|▊         | 44/553 [00:00<00:03, 130.91it/s] 10%|█         | 58/553 [00:00<00:04, 121.63it/s] 13%|█▎        | 71/553 [00:00<00:04, 120.15it/s] 16%|█▌        | 87/553 [00:00<00:03, 132.35it/s] 18%|█▊        | 101/553 [00:00<00:03, 126.64it/s] 22%|██▏       | 119/553 [00:00<00:03, 141.34it/s] 24%|██▍       | 134/553 [00:01<00:03, 139.12it/s] 27%|██▋       | 152/553 [00:01<00:02, 149.21it/s] 31%|███       | 169/553 [00:01<00:02, 153.09it/s] 33%|███▎      | 185/553 [00:01<00:02, 150.15it/s] 37%|███▋      | 202/553 [00:01<00:02, 154.93it/s] 39%|███▉      | 218/553 [00:01<00:02, 152.96it/s] 42%|████▏     | 234/553 [00:01<00:02, 147.32it/s] 45%|████▌     | 249/553 [00:01<00:02, 146.11it/s] 48%|████▊     | 265/553 [00:01<00:01, 146.70it/s] 51%|█████     | 280/553 [00:01<00:01, 140.25it/s] 53%|█████▎    | 295/553 [00:02<00:01, 136.50it/s] 56%|█████▌    | 309/553 [00:02<00:01, 134.11it/s] 58%|█████▊    | 323/553 [00:02<00:01, 130.84it/s] 61%|██████    | 338/553 [00:02<00:01, 133.84it/s] 64%|██████▎   | 352/553 [00:02<00:01, 134.84it/s] 66%|██████▌   | 366/553 [00:02<00:01, 128.80it/s] 69%|██████▉   | 381/553 [00:02<00:01, 134.30it/s] 71%|███████▏  | 395/553 [00:02<00:01, 122.18it/s] 74%|███████▍  | 408/553 [00:03<00:01, 120.70it/s] 76%|███████▌  | 421/553 [00:03<00:01, 100.74it/s] 78%|███████▊  | 432/553 [00:03<00:01, 102.84it/s] 81%|████████▏ | 450/553 [00:03<00:00, 122.38it/s] 84%|████████▍ | 464/553 [00:03<00:00, 125.76it/s] 86%|████████▋ | 478/553 [00:03<00:00, 124.60it/s] 89%|████████▉ | 491/553 [00:03<00:00, 119.69it/s] 91%|█████████ | 504/553 [00:03<00:00, 118.47it/s] 94%|█████████▎| 518/553 [00:03<00:00, 124.07it/s] 96%|█████████▌| 531/553 [00:04<00:00, 103.68it/s] 99%|█████████▊| 546/553 [00:04<00:00, 115.12it/s]100%|██████████| 553/553 [00:04<00:00, 127.23it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 32/139 [00:00<00:00, 317.19it/s]extract the null data:  65%|██████▍   | 90/139 [00:00<00:00, 470.40it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 486.29it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 200.98it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 201.58it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 201.53it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 201.83it/s]replace nan value:  76%|███████▋  | 106/139 [00:00<00:00, 206.54it/s]replace nan value:  91%|█████████▏| 127/139 [00:00<00:00, 205.17it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 203.85it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 119.92it/s] 19%|█▊        | 26/139 [00:00<00:00, 127.90it/s] 29%|██▉       | 41/139 [00:00<00:00, 137.25it/s] 40%|███▉      | 55/139 [00:00<00:00, 126.87it/s] 50%|████▉     | 69/139 [00:00<00:00, 129.62it/s] 60%|█████▉    | 83/139 [00:00<00:00, 123.12it/s] 69%|██████▉   | 96/139 [00:00<00:00, 115.85it/s] 78%|███████▊  | 108/139 [00:00<00:00, 112.02it/s] 88%|████████▊ | 122/139 [00:01<00:00, 118.88it/s] 97%|█████████▋| 135/139 [00:01<00:00, 115.83it/s]100%|██████████| 139/139 [00:01<00:00, 121.36it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  10%|█         | 18/173 [00:00<00:00, 176.80it/s]extract the null data:  39%|███▊      | 67/173 [00:00<00:00, 356.74it/s]extract the null data:  67%|██████▋   | 116/173 [00:00<00:00, 413.59it/s]extract the null data:  94%|█████████▍| 163/173 [00:00<00:00, 434.13it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 404.56it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 177.11it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 178.57it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 176.57it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 174.77it/s]replace nan value:  52%|█████▏    | 90/173 [00:00<00:00, 174.99it/s]replace nan value:  63%|██████▎   | 109/173 [00:00<00:00, 177.02it/s]replace nan value:  73%|███████▎  | 127/173 [00:00<00:00, 177.50it/s]replace nan value:  84%|████████▍ | 145/173 [00:00<00:00, 175.63it/s]replace nan value:  94%|█████████▍| 163/173 [00:00<00:00, 175.14it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 175.21it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 126.82it/s] 16%|█▌        | 27/173 [00:00<00:01, 109.10it/s] 23%|██▎       | 40/173 [00:00<00:01, 116.14it/s] 31%|███       | 54/173 [00:00<00:00, 124.76it/s] 39%|███▊      | 67/173 [00:00<00:00, 124.40it/s] 46%|████▌     | 80/173 [00:00<00:00, 123.20it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.60it/s] 62%|██████▏   | 107/173 [00:00<00:00, 124.60it/s] 71%|███████   | 122/173 [00:00<00:00, 128.29it/s] 78%|███████▊  | 135/173 [00:01<00:00, 127.85it/s] 86%|████████▌ | 149/173 [00:01<00:00, 125.52it/s] 94%|█████████▎| 162/173 [00:01<00:00, 119.87it/s]100%|██████████| 173/173 [00:01<00:00, 114.11it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.011, train acc : 0.691, valid acc : 0.622, train f1 : 0.691, valid f1 : 0.511
training process:   1%|          | 1/128 [01:03<2:13:54, 63.27s/it]Best score increase :0.000 -> 0.511
training process:   2%|▏         | 2/128 [01:55<1:59:41, 57.00s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:53<1:59:04, 57.16s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:50<1:58:12, 57.20s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.014, train acc : 0.749, valid acc : 0.504, train f1 : 0.736, valid f1 : 0.438
training process:   4%|▍         | 5/128 [04:53<2:01:39, 59.35s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:45<1:55:43, 56.92s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [06:38<1:52:08, 55.60s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [07:36<1:52:34, 56.29s/it]EarlyStopping counter : 7 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.014, train acc : 0.775, valid acc : 0.526, train f1 : 0.763, valid f1 : 0.454
training process:   7%|▋         | 9/128 [08:41<1:56:50, 58.91s/it]EarlyStopping counter : 8 out of 12
training process:   8%|▊         | 10/128 [09:37<1:54:23, 58.17s/it]Best score increase :0.511 -> 0.529
training process:   9%|▊         | 11/128 [10:29<1:49:31, 56.17s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:20<1:45:23, 54.51s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.002, valid loss : 0.011, train acc : 0.790, valid acc : 0.650, train f1 : 0.783, valid f1 : 0.540
training process:  10%|█         | 13/128 [12:24<1:50:06, 57.45s/it]Best score increase :0.529 -> 0.540
training process:  11%|█         | 14/128 [13:20<1:48:15, 56.97s/it]Best score increase :0.540 -> 0.565
training process:  12%|█▏        | 15/128 [14:16<1:47:09, 56.90s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▎        | 16/128 [15:08<1:43:17, 55.33s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.011, train acc : 0.815, valid acc : 0.655, train f1 : 0.809, valid f1 : 0.544
training process:  13%|█▎        | 17/128 [16:08<1:44:44, 56.62s/it]EarlyStopping counter : 3 out of 12
training process:  14%|█▍        | 18/128 [17:03<1:42:59, 56.17s/it]EarlyStopping counter : 4 out of 12
training process:  15%|█▍        | 19/128 [17:59<1:42:16, 56.30s/it]EarlyStopping counter : 5 out of 12
training process:  16%|█▌        | 20/128 [18:55<1:41:13, 56.24s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.011, train acc : 0.834, valid acc : 0.671, train f1 : 0.830, valid f1 : 0.556
training process:  16%|█▋        | 21/128 [19:57<1:43:18, 57.93s/it]EarlyStopping counter : 7 out of 12
training process:  17%|█▋        | 22/128 [20:50<1:39:35, 56.37s/it]Best score increase :0.565 -> 0.593
training process:  18%|█▊        | 23/128 [21:43<1:36:56, 55.39s/it]EarlyStopping counter : 1 out of 12
training process:  19%|█▉        | 24/128 [22:37<1:34:58, 54.79s/it]Best score increase :0.593 -> 0.601
epoch : 25, train loss : 0.002, valid loss : 0.010, train acc : 0.845, valid acc : 0.707, train f1 : 0.842, valid f1 : 0.582
training process:  20%|█▉        | 25/128 [23:39<1:37:55, 57.04s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 26/128 [24:33<1:35:42, 56.30s/it]Best score increase :0.601 -> 0.611
training process:  21%|██        | 27/128 [25:19<1:29:34, 53.21s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [26:05<1:25:01, 51.01s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.010, train acc : 0.855, valid acc : 0.724, train f1 : 0.852, valid f1 : 0.597
training process:  23%|██▎       | 29/128 [27:06<1:28:51, 53.85s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [27:57<1:26:42, 53.08s/it]Best score increase :0.611 -> 0.624
training process:  24%|██▍       | 31/128 [28:48<1:24:56, 52.55s/it]Best score increase :0.624 -> 0.630
training process:  25%|██▌       | 32/128 [29:38<1:22:44, 51.71s/it]Best score increase :0.630 -> 0.655
epoch : 33, train loss : 0.002, valid loss : 0.008, train acc : 0.869, valid acc : 0.780, train f1 : 0.867, valid f1 : 0.643
training process:  26%|██▌       | 33/128 [30:37<1:25:03, 53.72s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [31:26<1:21:57, 52.32s/it]Best score increase :0.655 -> 0.685
training process:  27%|██▋       | 35/128 [32:17<1:20:42, 52.07s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [33:07<1:19:00, 51.53s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.010, train acc : 0.878, valid acc : 0.730, train f1 : 0.876, valid f1 : 0.601
training process:  29%|██▉       | 37/128 [34:09<1:22:42, 54.53s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [34:59<1:19:40, 53.11s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [35:44<1:15:25, 50.85s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [36:34<1:14:06, 50.53s/it]Best score increase :0.685 -> 0.687
epoch : 41, train loss : 0.002, valid loss : 0.008, train acc : 0.880, valid acc : 0.780, train f1 : 0.879, valid f1 : 0.643
training process:  32%|███▏      | 41/128 [37:36<1:18:20, 54.03s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [38:30<1:17:19, 53.95s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [39:24<1:16:34, 54.06s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [40:15<1:14:25, 53.15s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.001, valid loss : 0.008, train acc : 0.892, valid acc : 0.779, train f1 : 0.891, valid f1 : 0.642
training process:  35%|███▌      | 45/128 [41:16<1:16:36, 55.38s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [42:11<1:15:21, 55.14s/it]EarlyStopping counter : 6 out of 12
training process:  37%|███▋      | 47/128 [43:03<1:13:27, 54.41s/it]EarlyStopping counter : 7 out of 12
training process:  38%|███▊      | 48/128 [43:56<1:12:04, 54.05s/it]EarlyStopping counter : 8 out of 12
epoch : 49, train loss : 0.001, valid loss : 0.008, train acc : 0.895, valid acc : 0.807, train f1 : 0.895, valid f1 : 0.668
training process:  38%|███▊      | 49/128 [44:57<1:13:44, 56.01s/it]EarlyStopping counter : 9 out of 12
training process:  39%|███▉      | 50/128 [45:47<1:10:32, 54.27s/it]EarlyStopping counter : 10 out of 12
training process:  40%|███▉      | 51/128 [46:38<1:08:21, 53.27s/it]EarlyStopping counter : 11 out of 12
training process:  41%|████      | 52/128 [47:33<1:08:12, 53.84s/it]Best score increase :0.687 -> 0.688
epoch : 53, train loss : 0.001, valid loss : 0.008, train acc : 0.902, valid acc : 0.801, train f1 : 0.900, valid f1 : 0.663
training process:  41%|████▏     | 53/128 [48:37<1:10:51, 56.69s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [49:30<1:08:33, 55.59s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [50:22<1:06:23, 54.57s/it]Best score increase :0.688 -> 0.712
training process:  44%|████▍     | 56/128 [51:15<1:04:53, 54.07s/it]EarlyStopping counter : 1 out of 12
epoch : 57, train loss : 0.001, valid loss : 0.008, train acc : 0.904, valid acc : 0.813, train f1 : 0.903, valid f1 : 0.675
training process:  45%|████▍     | 57/128 [52:15<1:06:11, 55.93s/it]EarlyStopping counter : 2 out of 12
training process:  45%|████▌     | 58/128 [53:08<1:04:20, 55.16s/it]EarlyStopping counter : 3 out of 12
training process:  46%|████▌     | 59/128 [54:03<1:03:22, 55.10s/it]EarlyStopping counter : 4 out of 12
training process:  47%|████▋     | 60/128 [54:58<1:02:14, 54.92s/it]EarlyStopping counter : 5 out of 12
epoch : 61, train loss : 0.001, valid loss : 0.007, train acc : 0.905, valid acc : 0.833, train f1 : 0.904, valid f1 : 0.695
training process:  48%|████▊     | 61/128 [55:56<1:02:15, 55.76s/it]EarlyStopping counter : 6 out of 12
training process:  48%|████▊     | 62/128 [56:44<58:52, 53.53s/it]  EarlyStopping counter : 7 out of 12
training process:  49%|████▉     | 63/128 [57:38<58:12, 53.73s/it]EarlyStopping counter : 8 out of 12
training process:  50%|█████     | 64/128 [58:32<57:21, 53.78s/it]EarlyStopping counter : 9 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.007, train acc : 0.909, valid acc : 0.845, train f1 : 0.908, valid f1 : 0.707
training process:  51%|█████     | 65/128 [59:35<59:23, 56.57s/it]EarlyStopping counter : 10 out of 12
training process:  52%|█████▏    | 66/128 [1:00:28<57:16, 55.43s/it]Best score increase :0.712 -> 0.713
training process:  52%|█████▏    | 67/128 [1:01:20<55:16, 54.37s/it]EarlyStopping counter : 1 out of 12
training process:  53%|█████▎    | 68/128 [1:02:10<53:15, 53.26s/it]EarlyStopping counter : 2 out of 12
epoch : 69, train loss : 0.001, valid loss : 0.007, train acc : 0.913, valid acc : 0.842, train f1 : 0.913, valid f1 : 0.704
training process:  54%|█████▍    | 69/128 [1:03:14<55:30, 56.45s/it]EarlyStopping counter : 3 out of 12
training process:  55%|█████▍    | 70/128 [1:04:09<53:59, 55.85s/it]EarlyStopping counter : 4 out of 12
training process:  55%|█████▌    | 71/128 [1:05:04<52:58, 55.76s/it]Best score increase :0.713 -> 0.739
training process:  56%|█████▋    | 72/128 [1:05:55<50:34, 54.19s/it]EarlyStopping counter : 1 out of 12
epoch : 73, train loss : 0.001, valid loss : 0.007, train acc : 0.914, valid acc : 0.847, train f1 : 0.914, valid f1 : 0.709
training process:  57%|█████▋    | 73/128 [1:06:54<50:57, 55.59s/it]EarlyStopping counter : 2 out of 12
training process:  58%|█████▊    | 74/128 [1:07:50<50:19, 55.91s/it]EarlyStopping counter : 3 out of 12
training process:  59%|█████▊    | 75/128 [1:08:46<49:20, 55.87s/it]EarlyStopping counter : 4 out of 12
training process:  59%|█████▉    | 76/128 [1:09:42<48:22, 55.82s/it]EarlyStopping counter : 5 out of 12
epoch : 77, train loss : 0.001, valid loss : 0.007, train acc : 0.917, valid acc : 0.837, train f1 : 0.916, valid f1 : 0.699
training process:  60%|██████    | 77/128 [1:10:44<48:56, 57.58s/it]EarlyStopping counter : 6 out of 12
training process:  61%|██████    | 78/128 [1:11:35<46:28, 55.77s/it]EarlyStopping counter : 7 out of 12
training process:  62%|██████▏   | 79/128 [1:12:31<45:36, 55.85s/it]EarlyStopping counter : 8 out of 12
training process:  62%|██████▎   | 80/128 [1:13:27<44:46, 55.97s/it]Best score increase :0.739 -> 0.745
epoch : 81, train loss : 0.001, valid loss : 0.007, train acc : 0.920, valid acc : 0.859, train f1 : 0.920, valid f1 : 0.724
training process:  63%|██████▎   | 81/128 [1:14:31<45:35, 58.21s/it]EarlyStopping counter : 1 out of 12
training process:  64%|██████▍   | 82/128 [1:15:26<43:59, 57.37s/it]EarlyStopping counter : 2 out of 12
training process:  65%|██████▍   | 83/128 [1:16:17<41:35, 55.46s/it]EarlyStopping counter : 3 out of 12
training process:  66%|██████▌   | 84/128 [1:17:11<40:14, 54.89s/it]EarlyStopping counter : 4 out of 12
epoch : 85, train loss : 0.001, valid loss : 0.007, train acc : 0.923, valid acc : 0.873, train f1 : 0.923, valid f1 : 0.741
training process:  66%|██████▋   | 85/128 [1:18:14<41:04, 57.32s/it]EarlyStopping counter : 5 out of 12
training process:  67%|██████▋   | 86/128 [1:19:09<39:37, 56.62s/it]EarlyStopping counter : 6 out of 12
training process:  68%|██████▊   | 87/128 [1:20:05<38:38, 56.56s/it]EarlyStopping counter : 7 out of 12
training process:  69%|██████▉   | 88/128 [1:20:55<36:26, 54.67s/it]EarlyStopping counter : 8 out of 12
epoch : 89, train loss : 0.001, valid loss : 0.007, train acc : 0.923, valid acc : 0.860, train f1 : 0.923, valid f1 : 0.725
training process:  70%|██████▉   | 89/128 [1:21:57<36:47, 56.60s/it]EarlyStopping counter : 9 out of 12
training process:  70%|███████   | 90/128 [1:22:52<35:33, 56.13s/it]EarlyStopping counter : 10 out of 12
training process:  71%|███████   | 91/128 [1:23:44<34:00, 55.15s/it]EarlyStopping counter : 11 out of 12
training process:  71%|███████   | 91/128 [1:24:38<34:24, 55.81s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 91, best f1 score : 0.745
training process finished, best loss : 0.006 and best acc : 0.877, best f1 : 0.745, best epoch : 79

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.38      0.93      0.54       580
           1       0.99      0.87      0.93      6818

    accuracy                           0.87      7398
   macro avg       0.69      0.90      0.73      7398
weighted avg       0.94      0.87      0.90      7398


# test acc : 0.87, test f1 : 0.73, test AUC : 0.90, test loss : 0.392

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.16s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.85s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.96s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:02,  7.78s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.81s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:45,  7.66s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.68s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.54s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:22,  7.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.57s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.67s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.71s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.71s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 10/306 [00:00<00:03, 89.70it/s] 10%|█         | 31/306 [00:00<00:01, 153.78it/s] 15%|█▌        | 47/306 [00:00<00:01, 154.38it/s] 22%|██▏       | 66/306 [00:00<00:01, 165.50it/s] 27%|██▋       | 83/306 [00:00<00:01, 138.07it/s] 33%|███▎      | 101/306 [00:00<00:01, 148.59it/s] 39%|███▊      | 118/306 [00:00<00:01, 153.40it/s] 44%|████▍     | 136/306 [00:00<00:01, 161.01it/s] 50%|█████     | 153/306 [00:01<00:00, 157.60it/s] 56%|█████▌    | 170/306 [00:01<00:00, 138.63it/s] 62%|██████▏   | 191/306 [00:01<00:00, 152.42it/s] 68%|██████▊   | 208/306 [00:01<00:00, 156.76it/s] 75%|███████▍  | 228/306 [00:01<00:00, 166.14it/s] 80%|████████  | 245/306 [00:01<00:00, 157.74it/s] 86%|████████▌ | 262/306 [00:01<00:00, 143.75it/s] 93%|█████████▎| 284/306 [00:01<00:00, 160.14it/s] 98%|█████████▊| 301/306 [00:01<00:00, 158.02it/s]100%|██████████| 306/306 [00:01<00:00, 153.76it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 51/553 [00:00<00:00, 509.16it/s]extract the null data:  19%|█▊        | 103/553 [00:00<00:00, 511.27it/s]extract the null data:  28%|██▊       | 157/553 [00:00<00:00, 521.11it/s]extract the null data:  38%|███▊      | 211/553 [00:00<00:00, 526.61it/s]extract the null data:  48%|████▊     | 266/553 [00:00<00:00, 534.46it/s]extract the null data:  58%|█████▊    | 322/553 [00:00<00:00, 541.04it/s]extract the null data:  68%|██████▊   | 377/553 [00:00<00:00, 543.80it/s]extract the null data:  78%|███████▊  | 432/553 [00:00<00:00, 537.44it/s]extract the null data:  88%|████████▊ | 486/553 [00:00<00:00, 533.78it/s]extract the null data:  98%|█████████▊| 544/553 [00:01<00:00, 545.09it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 535.89it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 180.06it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 182.01it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 175.80it/s]replace nan value:  14%|█▎        | 76/553 [00:00<00:02, 179.52it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:02, 181.83it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 183.14it/s]replace nan value:  24%|██▍       | 133/553 [00:00<00:02, 183.73it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:02, 183.90it/s]replace nan value:  31%|███       | 171/553 [00:00<00:02, 185.30it/s]replace nan value:  34%|███▍      | 190/553 [00:01<00:01, 186.36it/s]replace nan value:  38%|███▊      | 209/553 [00:01<00:01, 186.81it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 187.08it/s]replace nan value:  45%|████▍     | 247/553 [00:01<00:01, 186.63it/s]replace nan value:  48%|████▊     | 267/553 [00:01<00:01, 188.71it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 188.28it/s]replace nan value:  55%|█████▌    | 305/553 [00:01<00:01, 187.27it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 186.20it/s]replace nan value:  62%|██████▏   | 343/553 [00:01<00:01, 185.96it/s]replace nan value:  65%|██████▌   | 362/553 [00:01<00:01, 186.45it/s]replace nan value:  69%|██████▉   | 381/553 [00:02<00:00, 187.02it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 185.60it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 184.97it/s]replace nan value:  79%|███████▉  | 438/553 [00:02<00:00, 184.71it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 185.62it/s]replace nan value:  86%|████████▌ | 476/553 [00:02<00:00, 186.19it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 184.94it/s]replace nan value:  93%|█████████▎| 514/553 [00:02<00:00, 183.95it/s]replace nan value:  96%|█████████▋| 533/553 [00:02<00:00, 183.39it/s]replace nan value: 100%|█████████▉| 552/553 [00:02<00:00, 182.85it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 184.77it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 12/553 [00:00<00:04, 116.48it/s]  5%|▍         | 25/553 [00:00<00:04, 124.02it/s]  7%|▋         | 40/553 [00:00<00:03, 130.10it/s] 10%|▉         | 53/553 [00:00<00:04, 118.67it/s] 12%|█▏        | 65/553 [00:00<00:04, 108.38it/s] 14%|█▍        | 78/553 [00:00<00:04, 113.05it/s] 16%|█▋        | 91/553 [00:00<00:03, 116.59it/s] 19%|█▉        | 104/553 [00:00<00:03, 119.41it/s] 22%|██▏       | 120/553 [00:00<00:03, 127.99it/s] 24%|██▍       | 133/553 [00:01<00:03, 125.63it/s] 27%|██▋       | 150/553 [00:01<00:02, 137.08it/s] 30%|███       | 166/553 [00:01<00:02, 142.82it/s] 33%|███▎      | 181/553 [00:01<00:02, 142.04it/s] 36%|███▌      | 197/553 [00:01<00:02, 142.99it/s] 39%|███▊      | 214/553 [00:01<00:02, 147.74it/s] 41%|████▏     | 229/553 [00:01<00:02, 137.78it/s] 44%|████▍     | 243/553 [00:01<00:02, 137.73it/s] 46%|████▋     | 257/553 [00:01<00:02, 134.72it/s] 49%|████▉     | 271/553 [00:02<00:02, 130.52it/s] 52%|█████▏    | 286/553 [00:02<00:01, 135.18it/s] 54%|█████▍    | 300/553 [00:02<00:01, 130.70it/s] 57%|█████▋    | 314/553 [00:02<00:01, 123.72it/s] 59%|█████▉    | 327/553 [00:02<00:01, 122.35it/s] 62%|██████▏   | 341/553 [00:02<00:01, 126.21it/s] 64%|██████▍   | 354/553 [00:02<00:01, 122.52it/s] 66%|██████▋   | 367/553 [00:02<00:01, 121.16it/s] 69%|██████▉   | 381/553 [00:02<00:01, 125.45it/s] 71%|███████   | 394/553 [00:03<00:01, 113.56it/s] 73%|███████▎  | 406/553 [00:03<00:01, 114.98it/s] 76%|███████▌  | 418/553 [00:03<00:01, 112.21it/s] 78%|███████▊  | 430/553 [00:03<00:01, 109.74it/s] 81%|████████  | 447/553 [00:03<00:00, 125.01it/s] 83%|████████▎ | 461/553 [00:03<00:00, 128.71it/s] 86%|████████▌ | 475/553 [00:03<00:00, 130.47it/s] 88%|████████▊ | 489/553 [00:03<00:00, 123.25it/s] 91%|█████████ | 502/553 [00:03<00:00, 118.31it/s] 93%|█████████▎| 516/553 [00:04<00:00, 124.04it/s] 96%|█████████▌| 529/553 [00:04<00:00, 110.06it/s] 98%|█████████▊| 541/553 [00:04<00:00, 110.94it/s]100%|██████████| 553/553 [00:04<00:00, 96.93it/s] 100%|██████████| 553/553 [00:04<00:00, 122.45it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 25/139 [00:00<00:00, 246.02it/s]extract the null data:  55%|█████▌    | 77/139 [00:00<00:00, 405.72it/s]extract the null data:  91%|█████████▏| 127/139 [00:00<00:00, 445.65it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 425.35it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 182.78it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 179.10it/s]replace nan value:  40%|████      | 56/139 [00:00<00:00, 176.89it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 176.63it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 176.50it/s]replace nan value:  79%|███████▉  | 110/139 [00:00<00:00, 177.45it/s]replace nan value:  92%|█████████▏| 128/139 [00:00<00:00, 177.72it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 177.84it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 105.61it/s] 17%|█▋        | 23/139 [00:00<00:01, 113.43it/s] 26%|██▌       | 36/139 [00:00<00:00, 120.65it/s] 35%|███▌      | 49/139 [00:00<00:00, 119.29it/s] 44%|████▍     | 61/139 [00:00<00:00, 113.95it/s] 53%|█████▎    | 74/139 [00:00<00:00, 118.50it/s] 62%|██████▏   | 86/139 [00:00<00:00, 112.75it/s] 71%|███████   | 98/139 [00:00<00:00, 106.79it/s] 78%|███████▊  | 109/139 [00:00<00:00, 103.96it/s] 89%|████████▉ | 124/139 [00:01<00:00, 115.54it/s] 98%|█████████▊| 136/139 [00:01<00:00, 113.59it/s]100%|██████████| 139/139 [00:01<00:00, 114.01it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  10%|█         | 18/173 [00:00<00:00, 176.88it/s]extract the null data:  39%|███▉      | 68/173 [00:00<00:00, 363.68it/s]extract the null data:  68%|██████▊   | 118/173 [00:00<00:00, 423.77it/s]extract the null data:  98%|█████████▊| 169/173 [00:00<00:00, 454.17it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 417.89it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 179.88it/s]replace nan value:  21%|██        | 36/173 [00:00<00:00, 177.87it/s]replace nan value:  32%|███▏      | 55/173 [00:00<00:00, 179.79it/s]replace nan value:  42%|████▏     | 73/173 [00:00<00:00, 179.36it/s]replace nan value:  53%|█████▎    | 92/173 [00:00<00:00, 179.69it/s]replace nan value:  64%|██████▍   | 111/173 [00:00<00:00, 179.88it/s]replace nan value:  75%|███████▍  | 129/173 [00:00<00:00, 179.67it/s]replace nan value:  86%|████████▌ | 148/173 [00:00<00:00, 179.90it/s]replace nan value:  96%|█████████▌| 166/173 [00:00<00:00, 178.81it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 179.51it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.65it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.56it/s] 24%|██▎       | 41/173 [00:00<00:01, 120.52it/s] 32%|███▏      | 55/173 [00:00<00:00, 127.11it/s] 39%|███▉      | 68/173 [00:00<00:00, 127.54it/s] 47%|████▋     | 81/173 [00:00<00:00, 127.12it/s] 54%|█████▍    | 94/173 [00:00<00:00, 127.99it/s] 62%|██████▏   | 107/173 [00:00<00:00, 126.85it/s] 69%|██████▉   | 120/173 [00:00<00:00, 126.50it/s] 77%|███████▋  | 133/173 [00:01<00:00, 123.82it/s] 86%|████████▌ | 148/173 [00:01<00:00, 127.84it/s] 93%|█████████▎| 161/173 [00:01<00:00, 118.34it/s]100%|██████████| 173/173 [00:01<00:00, 93.29it/s] 100%|██████████| 173/173 [00:01<00:00, 114.96it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.006, train f1 : 0.590, valid f1 : 0.593
training process - Deferred Re-weighting:   1%|          | 1/128 [01:09<2:26:09, 69.05s/it]Best score increase :0.000 -> 0.593
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:03<2:06:23, 60.19s/it]Best score increase :0.593 -> 0.690
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:53<1:55:58, 55.67s/it]Best score increase :0.690 -> 0.724
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:45<1:52:11, 54.29s/it]Best score increase :0.724 -> 0.764
epoch : 5, train loss : 0.003, valid loss : 0.003, train f1 : 0.800, valid f1 : 0.775
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:49<1:58:24, 57.76s/it]Best score increase :0.764 -> 0.775
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:43<1:54:40, 56.40s/it]Best score increase :0.775 -> 0.802
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:38<1:52:53, 55.98s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:28<1:48:26, 54.22s/it]Best score increase :0.802 -> 0.806
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.836, valid f1 : 0.815
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:30<1:52:06, 56.52s/it]Best score increase :0.806 -> 0.815
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:26<1:50:53, 56.38s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:21<1:48:55, 55.86s/it]Best score increase :0.815 -> 0.818
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:18<1:48:53, 56.32s/it]Best score increase :0.818 -> 0.823
epoch : 13, train loss : 0.002, valid loss : 0.003, train f1 : 0.852, valid f1 : 0.806
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:22<1:52:29, 58.69s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [13:15<1:48:00, 56.85s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [14:10<1:45:59, 56.27s/it]Best score increase :0.823 -> 0.841
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [15:06<1:45:17, 56.41s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.002, train f1 : 0.860, valid f1 : 0.843
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [16:12<1:49:16, 59.07s/it]Best score increase :0.841 -> 0.843
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [17:05<1:45:06, 57.33s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:55<1:40:18, 55.22s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:48<1:38:11, 54.55s/it]Best score increase :0.843 -> 0.847
epoch : 21, train loss : 0.002, valid loss : 0.003, train f1 : 0.869, valid f1 : 0.848
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:52<1:42:12, 57.32s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:46<1:39:20, 56.23s/it]Best score increase :0.847 -> 0.852
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [21:37<1:36:01, 54.87s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [22:23<1:30:32, 52.23s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.876, valid f1 : 0.845
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:19<1:31:29, 53.29s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:14<1:31:08, 53.61s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:05<1:29:21, 53.08s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:57<1:27:30, 52.50s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.887, valid f1 : 0.845
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:54<1:28:52, 53.86s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:41<1:25:00, 52.05s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:32<1:23:18, 51.53s/it]Best score increase :0.852 -> 0.857
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:24<1:22:47, 51.74s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.891, valid f1 : 0.865
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [30:23<1:25:33, 54.03s/it]Best score increase :0.857 -> 0.865
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [31:11<1:21:32, 52.05s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:56<1:17:21, 49.91s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [32:41<1:14:39, 48.69s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.896, valid f1 : 0.848
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:42<1:19:01, 52.11s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [34:36<1:19:10, 52.78s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [35:29<1:18:16, 52.77s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [36:19<1:16:10, 51.94s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.895, valid f1 : 0.862
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [37:19<1:18:59, 54.48s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [38:15<1:18:48, 54.98s/it]Best score increase :0.865 -> 0.868
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [39:09<1:17:34, 54.76s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:03<1:16:10, 54.41s/it]EarlyStopping counter : 2 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.902, valid f1 : 0.865
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:04<1:17:53, 56.31s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [41:57<1:15:40, 55.37s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [42:52<1:14:31, 55.20s/it]Best score increase :0.868 -> 0.876
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [43:47<1:13:33, 55.17s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.001, valid loss : 0.003, train f1 : 0.907, valid f1 : 0.860
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [44:50<1:15:43, 57.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [45:42<1:12:35, 55.84s/it]Best score increase :0.876 -> 0.878
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [46:32<1:09:18, 54.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [47:25<1:08:08, 53.80s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.001, valid loss : 0.003, train f1 : 0.905, valid f1 : 0.872
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [48:28<1:10:41, 56.56s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [49:23<1:09:13, 56.12s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [50:15<1:06:52, 54.96s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [51:08<1:05:00, 54.18s/it]Best score increase :0.878 -> 0.884
epoch : 57, train loss : 0.001, valid loss : 0.003, train f1 : 0.915, valid f1 : 0.866
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [52:10<1:07:08, 56.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [53:04<1:05:12, 55.90s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [54:00<1:04:10, 55.81s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [54:55<1:03:05, 55.66s/it]EarlyStopping counter : 4 out of 12
epoch : 61, train loss : 0.001, valid loss : 0.003, train f1 : 0.915, valid f1 : 0.857
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [55:56<1:03:49, 57.16s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [56:49<1:01:28, 55.89s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [57:44<1:00:15, 55.62s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [58:39<59:14, 55.54s/it]  EarlyStopping counter : 8 out of 12
epoch : 65, train loss : 0.001, valid loss : 0.003, train f1 : 0.919, valid f1 : 0.868
training process - Deferred Re-weighting:  51%|█████     | 65/128 [59:42<1:00:39, 57.76s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:00:32<57:11, 55.35s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:01:22<54:44, 53.84s/it]Best score increase :0.884 -> 0.886
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:02:17<54:17, 54.29s/it]EarlyStopping counter : 1 out of 12
epoch : 69, train loss : 0.001, valid loss : 0.003, train f1 : 0.922, valid f1 : 0.872
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:03:20<55:58, 56.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:04:15<54:25, 56.30s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:05:07<52:08, 54.89s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:05:59<50:32, 54.16s/it]EarlyStopping counter : 5 out of 12
epoch : 73, train loss : 0.001, valid loss : 0.003, train f1 : 0.925, valid f1 : 0.880
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:07:03<52:09, 56.91s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:07:57<50:35, 56.21s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:08:51<49:01, 55.50s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  59%|█████▉    | 76/128 [1:09:44<47:22, 54.67s/it]EarlyStopping counter : 9 out of 12
epoch : 77, train loss : 0.001, valid loss : 0.003, train f1 : 0.925, valid f1 : 0.868
training process - Deferred Re-weighting:  60%|██████    | 77/128 [1:10:43<47:44, 56.17s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:11:38<46:20, 55.62s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  61%|██████    | 78/128 [1:12:34<46:31, 55.82s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 78, best f1 score : 0.886
training process finished, best loss : 0.003, best acc : 0.969, best f1 : 0.886, best epoch : 66

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.92      0.67      0.78       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.83      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.83, test loss : 0.156

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:25,  7.79s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  8.00s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:12,  8.08s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.03s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:55,  7.98s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:47,  7.95s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.87s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:31,  7.93s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:23,  7.98s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.95s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:08,  8.03s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.97s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.97s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 177.77it/s] 12%|█▏        | 37/306 [00:00<00:01, 161.70it/s] 19%|█▉        | 58/306 [00:00<00:01, 179.13it/s] 25%|██▌       | 77/306 [00:00<00:01, 179.35it/s] 31%|███▏      | 96/306 [00:00<00:01, 182.30it/s] 38%|███▊      | 115/306 [00:00<00:01, 175.61it/s] 43%|████▎     | 133/306 [00:00<00:00, 176.75it/s] 49%|████▉     | 151/306 [00:00<00:00, 164.60it/s] 55%|█████▌    | 169/306 [00:00<00:00, 168.43it/s] 61%|██████    | 186/306 [00:01<00:00, 167.03it/s] 67%|██████▋   | 204/306 [00:01<00:00, 168.66it/s] 72%|███████▏  | 221/306 [00:01<00:00, 166.38it/s] 78%|███████▊  | 238/306 [00:01<00:00, 162.05it/s] 84%|████████▍ | 257/306 [00:01<00:00, 168.69it/s] 90%|████████▉ | 274/306 [00:01<00:00, 159.16it/s] 96%|█████████▌| 294/306 [00:01<00:00, 170.46it/s]100%|██████████| 306/306 [00:01<00:00, 171.00it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_DRW_seed_42
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   7%|▋         | 41/553 [00:00<00:01, 404.10it/s]extract the null data:  15%|█▍        | 82/553 [00:00<00:01, 401.09it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:01, 405.38it/s]extract the null data:  30%|██▉       | 165/553 [00:00<00:00, 403.93it/s]extract the null data:  37%|███▋      | 206/553 [00:00<00:00, 403.30it/s]extract the null data:  45%|████▍     | 248/553 [00:00<00:00, 405.83it/s]extract the null data:  52%|█████▏    | 289/553 [00:00<00:00, 407.06it/s]extract the null data:  60%|█████▉    | 331/553 [00:00<00:00, 408.41it/s]extract the null data:  67%|██████▋   | 373/553 [00:00<00:00, 409.78it/s]extract the null data:  75%|███████▌  | 415/553 [00:01<00:00, 410.86it/s]extract the null data:  83%|████████▎ | 457/553 [00:01<00:00, 410.00it/s]extract the null data:  90%|█████████ | 499/553 [00:01<00:00, 409.79it/s]extract the null data:  98%|█████████▊| 540/553 [00:01<00:00, 406.48it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 406.80it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 15/553 [00:00<00:03, 145.72it/s]replace nan value:   6%|▌         | 31/553 [00:00<00:03, 153.04it/s]replace nan value:   8%|▊         | 47/553 [00:00<00:03, 151.25it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:03, 150.51it/s]replace nan value:  14%|█▍        | 79/553 [00:00<00:03, 151.60it/s]replace nan value:  17%|█▋        | 95/553 [00:00<00:03, 152.19it/s]replace nan value:  20%|██        | 111/553 [00:00<00:02, 152.81it/s]replace nan value:  23%|██▎       | 127/553 [00:00<00:02, 153.05it/s]replace nan value:  26%|██▌       | 143/553 [00:00<00:02, 153.38it/s]replace nan value:  29%|██▉       | 159/553 [00:01<00:02, 155.30it/s]replace nan value:  32%|███▏      | 176/553 [00:01<00:02, 156.63it/s]replace nan value:  35%|███▍      | 192/553 [00:01<00:02, 153.47it/s]replace nan value:  38%|███▊      | 208/553 [00:01<00:02, 153.81it/s]replace nan value:  41%|████      | 224/553 [00:01<00:02, 154.28it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:02, 153.74it/s]replace nan value:  46%|████▋     | 256/553 [00:01<00:01, 153.65it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 153.79it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 153.84it/s]replace nan value:  55%|█████▍    | 304/553 [00:01<00:01, 154.15it/s]replace nan value:  58%|█████▊    | 320/553 [00:02<00:01, 154.10it/s]replace nan value:  61%|██████    | 336/553 [00:02<00:01, 155.36it/s]replace nan value:  64%|██████▎   | 352/553 [00:02<00:01, 155.63it/s]replace nan value:  67%|██████▋   | 368/553 [00:02<00:01, 154.28it/s]replace nan value:  69%|██████▉   | 384/553 [00:02<00:01, 155.34it/s]replace nan value:  72%|███████▏  | 400/553 [00:02<00:00, 154.21it/s]replace nan value:  75%|███████▌  | 416/553 [00:02<00:00, 154.43it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 153.46it/s]replace nan value:  81%|████████  | 448/553 [00:02<00:00, 152.91it/s]replace nan value:  84%|████████▍ | 464/553 [00:03<00:00, 153.86it/s]replace nan value:  87%|████████▋ | 480/553 [00:03<00:00, 153.45it/s]replace nan value:  90%|████████▉ | 496/553 [00:03<00:00, 153.03it/s]replace nan value:  93%|█████████▎| 512/553 [00:03<00:00, 152.24it/s]replace nan value:  95%|█████████▌| 528/553 [00:03<00:00, 152.66it/s]replace nan value:  99%|█████████▊| 545/553 [00:03<00:00, 154.91it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 153.57it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:04, 109.23it/s]  5%|▍         | 25/553 [00:00<00:04, 123.60it/s]  7%|▋         | 39/553 [00:00<00:04, 126.88it/s]  9%|▉         | 52/553 [00:00<00:04, 114.42it/s] 12%|█▏        | 64/553 [00:00<00:04, 106.45it/s] 14%|█▍        | 77/553 [00:00<00:04, 111.16it/s] 16%|█▋        | 91/553 [00:00<00:04, 114.58it/s] 19%|█▊        | 103/553 [00:00<00:03, 114.43it/s] 21%|██▏       | 118/553 [00:01<00:03, 123.94it/s] 24%|██▎       | 131/553 [00:01<00:03, 121.04it/s] 27%|██▋       | 148/553 [00:01<00:03, 133.13it/s] 29%|██▉       | 163/553 [00:01<00:02, 136.08it/s] 32%|███▏      | 178/553 [00:01<00:02, 136.87it/s] 35%|███▍      | 193/553 [00:01<00:02, 138.87it/s] 38%|███▊      | 209/553 [00:01<00:02, 144.21it/s] 41%|████      | 224/553 [00:01<00:02, 133.32it/s] 43%|████▎     | 238/553 [00:01<00:02, 134.93it/s] 46%|████▌     | 252/553 [00:01<00:02, 130.80it/s] 48%|████▊     | 266/553 [00:02<00:02, 127.89it/s] 50%|█████     | 279/553 [00:02<00:02, 126.17it/s] 53%|█████▎    | 292/553 [00:02<00:02, 125.57it/s] 55%|█████▌    | 305/553 [00:02<00:02, 123.25it/s] 58%|█████▊    | 318/553 [00:02<00:02, 114.02it/s] 60%|█████▉    | 331/553 [00:02<00:01, 116.36it/s] 62%|██████▏   | 345/553 [00:02<00:01, 117.96it/s] 65%|██████▍   | 357/553 [00:02<00:01, 116.23it/s] 67%|██████▋   | 371/553 [00:02<00:01, 122.26it/s] 69%|██████▉   | 384/553 [00:03<00:01, 120.77it/s] 72%|███████▏  | 397/553 [00:03<00:01, 105.99it/s] 75%|███████▍  | 412/553 [00:03<00:01, 116.17it/s] 77%|███████▋  | 425/553 [00:03<00:01, 105.74it/s] 79%|███████▉  | 438/553 [00:03<00:01, 111.20it/s] 82%|████████▏ | 453/553 [00:03<00:00, 120.00it/s] 85%|████████▍ | 468/553 [00:03<00:00, 126.49it/s] 87%|████████▋ | 481/553 [00:03<00:00, 120.34it/s] 89%|████████▉ | 494/553 [00:04<00:00, 113.80it/s] 92%|█████████▏| 506/553 [00:04<00:00, 115.09it/s] 94%|█████████▍| 520/553 [00:04<00:00, 118.67it/s] 96%|█████████▌| 532/553 [00:04<00:00, 100.63it/s] 99%|█████████▉| 547/553 [00:04<00:00, 111.44it/s]100%|██████████| 553/553 [00:04<00:00, 118.09it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 258.99it/s]extract the null data:  53%|█████▎    | 74/139 [00:00<00:00, 383.63it/s]extract the null data:  87%|████████▋ | 121/139 [00:00<00:00, 419.60it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 407.04it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  13%|█▎        | 18/139 [00:00<00:00, 175.47it/s]replace nan value:  26%|██▌       | 36/139 [00:00<00:00, 174.45it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 172.71it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 171.04it/s]replace nan value:  65%|██████▍   | 90/139 [00:00<00:00, 169.42it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 169.69it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 170.19it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 170.82it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 102.92it/s] 17%|█▋        | 23/139 [00:00<00:01, 111.07it/s] 26%|██▌       | 36/139 [00:00<00:00, 119.27it/s] 35%|███▌      | 49/139 [00:00<00:00, 118.74it/s] 44%|████▍     | 61/139 [00:00<00:00, 111.50it/s] 53%|█████▎    | 74/139 [00:00<00:00, 116.07it/s] 62%|██████▏   | 86/139 [00:00<00:00, 110.56it/s] 71%|███████   | 98/139 [00:00<00:00, 104.61it/s] 78%|███████▊  | 109/139 [00:01<00:00, 102.05it/s] 89%|████████▉ | 124/139 [00:01<00:00, 112.43it/s] 98%|█████████▊| 136/139 [00:01<00:00, 110.34it/s]100%|██████████| 139/139 [00:01<00:00, 111.48it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 20/173 [00:00<00:00, 196.99it/s]extract the null data:  38%|███▊      | 66/173 [00:00<00:00, 349.97it/s]extract the null data:  65%|██████▍   | 112/173 [00:00<00:00, 399.04it/s]extract the null data:  92%|█████████▏| 159/173 [00:00<00:00, 425.93it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 397.22it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|▉         | 17/173 [00:00<00:00, 168.82it/s]replace nan value:  20%|█▉        | 34/173 [00:00<00:00, 168.81it/s]replace nan value:  29%|██▉       | 51/173 [00:00<00:00, 169.26it/s]replace nan value:  39%|███▉      | 68/173 [00:00<00:00, 169.53it/s]replace nan value:  49%|████▉     | 85/173 [00:00<00:00, 168.67it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 166.25it/s]replace nan value:  69%|██████▉   | 119/173 [00:00<00:00, 166.24it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 167.38it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 167.76it/s]replace nan value:  98%|█████████▊| 170/173 [00:01<00:00, 167.12it/s]replace nan value: 100%|██████████| 173/173 [00:01<00:00, 167.48it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 127.22it/s] 15%|█▌        | 26/173 [00:00<00:01, 102.65it/s] 23%|██▎       | 39/173 [00:00<00:01, 111.21it/s] 31%|███       | 53/173 [00:00<00:00, 120.20it/s] 38%|███▊      | 66/173 [00:00<00:00, 119.04it/s] 46%|████▌     | 80/173 [00:00<00:00, 118.74it/s] 54%|█████▍    | 93/173 [00:00<00:00, 121.27it/s] 61%|██████▏   | 106/173 [00:00<00:00, 119.08it/s] 69%|██████▉   | 119/173 [00:01<00:00, 118.96it/s] 76%|███████▌  | 131/173 [00:01<00:00, 114.72it/s] 83%|████████▎ | 143/173 [00:01<00:00, 115.29it/s] 90%|████████▉ | 155/173 [00:01<00:00, 105.60it/s] 96%|█████████▌| 166/173 [00:01<00:00, 84.06it/s] 100%|██████████| 173/173 [00:01<00:00, 103.14it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.007, train f1 : 0.706, valid f1 : 0.641
training process - Deferred Re-weighting:   1%|          | 1/128 [01:06<2:20:58, 66.60s/it]Best score increase :0.000 -> 0.641
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:02<2:06:59, 60.47s/it]Best score increase :0.641 -> 0.694
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:51<1:55:01, 55.22s/it]Best score increase :0.694 -> 0.754
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:38<1:47:02, 51.79s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.006, valid loss : 0.006, train f1 : 0.856, valid f1 : 0.728
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:39<1:53:16, 55.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:32<1:50:26, 54.31s/it]Best score increase :0.754 -> 0.757
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:22<1:47:12, 53.16s/it]Best score increase :0.757 -> 0.774
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:15<1:45:54, 52.96s/it]Best score increase :0.774 -> 0.789
epoch : 9, train loss : 0.005, valid loss : 0.006, train f1 : 0.883, valid f1 : 0.721
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:14<1:48:52, 54.89s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:02<1:43:26, 52.60s/it]Best score increase :0.789 -> 0.800
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:53<1:42:02, 52.33s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:45<1:40:54, 52.19s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.005, valid loss : 0.004, train f1 : 0.894, valid f1 : 0.812
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:45<1:44:28, 54.51s/it]Best score increase :0.800 -> 0.812
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:32<1:39:07, 52.17s/it]Best score increase :0.812 -> 0.833
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:18<1:34:55, 50.41s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:09<1:34:28, 50.61s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.004, valid loss : 0.004, train f1 : 0.905, valid f1 : 0.796
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:09<1:38:58, 53.50s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:05<1:38:59, 53.99s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [16:58<1:37:57, 53.93s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:50<1:35:51, 53.25s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.004, train f1 : 0.914, valid f1 : 0.809
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [18:53<1:39:59, 56.07s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:48<1:38:44, 55.89s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:42<1:36:54, 55.38s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:38<1:35:54, 55.33s/it]EarlyStopping counter : 10 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.003, train f1 : 0.922, valid f1 : 0.844
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:37<1:37:17, 56.67s/it]Best score increase :0.833 -> 0.844
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:29<1:33:49, 55.19s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:25<1:33:10, 55.35s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:21<1:32:33, 55.53s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.003, valid loss : 0.003, train f1 : 0.927, valid f1 : 0.832
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:27<1:36:42, 58.61s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:19<1:32:42, 56.76s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:10<1:28:49, 54.95s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:05<1:28:17, 55.18s/it]Best score increase :0.844 -> 0.854
epoch : 33, train loss : 0.003, valid loss : 0.003, train f1 : 0.936, valid f1 : 0.843
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [30:09<1:31:15, 57.63s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [31:05<1:29:26, 57.09s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:57<1:26:13, 55.63s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [32:47<1:23:00, 54.14s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.003, valid loss : 0.004, train f1 : 0.937, valid f1 : 0.801
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:53<1:27:07, 57.44s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [34:48<1:25:14, 56.83s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [35:43<1:23:38, 56.38s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [36:35<1:20:36, 54.96s/it]Best score increase :0.854 -> 0.859
epoch : 41, train loss : 0.003, valid loss : 0.003, train f1 : 0.942, valid f1 : 0.830
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [37:35<1:21:39, 56.32s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [38:29<1:20:05, 55.87s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [39:24<1:18:42, 55.56s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:20<1:17:55, 55.66s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.002, train f1 : 0.947, valid f1 : 0.855
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:20<1:18:47, 56.96s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [42:09<1:14:28, 54.49s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [43:07<1:14:56, 55.51s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [44:05<1:15:01, 56.27s/it]EarlyStopping counter : 8 out of 12
epoch : 49, train loss : 0.003, valid loss : 0.003, train f1 : 0.949, valid f1 : 0.839
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [45:11<1:17:56, 59.20s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [46:04<1:14:31, 57.33s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [46:58<1:12:16, 56.32s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [47:54<1:11:27, 56.41s/it]Best score increase :0.859 -> 0.869
epoch : 53, train loss : 0.002, valid loss : 0.003, train f1 : 0.953, valid f1 : 0.832
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [49:00<1:13:54, 59.13s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [49:56<1:11:46, 58.20s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [50:49<1:08:59, 56.70s/it]Best score increase :0.869 -> 0.875
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [51:43<1:06:54, 55.76s/it]EarlyStopping counter : 1 out of 12
epoch : 57, train loss : 0.002, valid loss : 0.002, train f1 : 0.955, valid f1 : 0.877
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [52:49<1:09:45, 58.94s/it]Best score increase :0.875 -> 0.877
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [53:45<1:07:45, 58.08s/it]Best score increase :0.877 -> 0.882
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [54:40<1:05:48, 57.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [55:32<1:03:01, 55.61s/it]EarlyStopping counter : 2 out of 12
epoch : 61, train loss : 0.002, valid loss : 0.002, train f1 : 0.959, valid f1 : 0.863
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [56:32<1:03:35, 56.95s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [57:28<1:02:14, 56.58s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [58:24<1:01:06, 56.41s/it]Best score increase :0.882 -> 0.884
training process - Deferred Re-weighting:  50%|█████     | 64/128 [59:21<1:00:21, 56.59s/it]Best score increase :0.884 -> 0.887
epoch : 65, train loss : 0.002, valid loss : 0.002, train f1 : 0.959, valid f1 : 0.879
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:00:22<1:00:58, 58.08s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 66/128 [1:01:15<58:14, 56.36s/it]  EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 67/128 [1:02:10<56:53, 55.96s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  53%|█████▎    | 68/128 [1:03:04<55:26, 55.44s/it]EarlyStopping counter : 4 out of 12
epoch : 69, train loss : 0.002, valid loss : 0.003, train f1 : 0.964, valid f1 : 0.871
training process - Deferred Re-weighting:  54%|█████▍    | 69/128 [1:04:10<57:40, 58.66s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  55%|█████▍    | 70/128 [1:05:02<54:48, 56.69s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  55%|█████▌    | 71/128 [1:05:55<52:34, 55.34s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  56%|█████▋    | 72/128 [1:06:51<51:49, 55.52s/it]EarlyStopping counter : 8 out of 12
epoch : 73, train loss : 0.002, valid loss : 0.002, train f1 : 0.968, valid f1 : 0.883
training process - Deferred Re-weighting:  57%|█████▋    | 73/128 [1:07:56<53:38, 58.52s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 74/128 [1:08:50<51:33, 57.29s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:09:42<49:02, 55.52s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  59%|█████▊    | 75/128 [1:10:33<49:52, 56.45s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 75, best f1 score : 0.888
training process finished, best loss : 0.002, best acc : 0.964, best f1 : 0.888, best epoch : 69

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.77      0.83      0.79       580
           1       0.99      0.98      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.88      0.90      0.89      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.89, test AUC : 0.90, test loss : 0.134

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.49s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:17,  7.75s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.66s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.63s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.72s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.67s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.71s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.62s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.62s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.54s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.77s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.82s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.70s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 13/306 [00:00<00:02, 123.27it/s]  8%|▊         | 26/306 [00:00<00:02, 122.06it/s] 17%|█▋        | 52/306 [00:00<00:01, 180.84it/s] 25%|██▌       | 78/306 [00:00<00:01, 208.68it/s] 32%|███▏      | 99/306 [00:00<00:01, 197.69it/s] 40%|███▉      | 121/306 [00:00<00:00, 197.81it/s] 46%|████▌     | 141/306 [00:00<00:01, 162.66it/s] 55%|█████▍    | 167/306 [00:00<00:00, 187.02it/s] 61%|██████    | 187/306 [00:01<00:00, 185.01it/s] 68%|██████▊   | 209/306 [00:01<00:00, 194.58it/s] 75%|███████▌  | 230/306 [00:01<00:00, 159.49it/s] 83%|████████▎ | 255/306 [00:01<00:00, 181.39it/s] 90%|████████▉ | 275/306 [00:01<00:00, 184.20it/s] 97%|█████████▋| 297/306 [00:01<00:00, 192.96it/s]100%|██████████| 306/306 [00:01<00:00, 183.77it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|█         | 58/553 [00:00<00:00, 571.27it/s]extract the null data:  21%|██        | 116/553 [00:00<00:00, 569.27it/s]extract the null data:  32%|███▏      | 175/553 [00:00<00:00, 574.60it/s]extract the null data:  42%|████▏     | 233/553 [00:00<00:00, 561.09it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 565.41it/s]extract the null data:  63%|██████▎   | 350/553 [00:00<00:00, 573.15it/s]extract the null data:  74%|███████▍  | 411/553 [00:00<00:00, 583.76it/s]extract the null data:  85%|████████▌ | 472/553 [00:00<00:00, 589.50it/s]extract the null data:  96%|█████████▌| 531/553 [00:00<00:00, 589.10it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 579.59it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 193.91it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 190.81it/s]replace nan value:  11%|█         | 60/553 [00:00<00:02, 191.98it/s]replace nan value:  14%|█▍        | 80/553 [00:00<00:02, 192.84it/s]replace nan value:  18%|█▊        | 100/553 [00:00<00:02, 194.59it/s]replace nan value:  22%|██▏       | 121/553 [00:00<00:02, 197.60it/s]replace nan value:  25%|██▌       | 141/553 [00:00<00:02, 198.08it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:01, 199.14it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 198.27it/s]replace nan value:  37%|███▋      | 203/553 [00:01<00:01, 199.06it/s]replace nan value:  40%|████      | 223/553 [00:01<00:01, 199.12it/s]replace nan value:  44%|████▍     | 244/553 [00:01<00:01, 201.52it/s]replace nan value:  48%|████▊     | 266/553 [00:01<00:01, 204.42it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 206.04it/s]replace nan value:  56%|█████▌    | 308/553 [00:01<00:01, 203.56it/s]replace nan value:  59%|█████▉    | 329/553 [00:01<00:01, 204.61it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:00, 211.75it/s]replace nan value:  68%|██████▊   | 374/553 [00:01<00:00, 214.06it/s]replace nan value:  72%|███████▏  | 396/553 [00:01<00:00, 214.16it/s]replace nan value:  76%|███████▌  | 418/553 [00:02<00:00, 215.19it/s]replace nan value:  80%|███████▉  | 441/553 [00:02<00:00, 217.13it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 221.38it/s]replace nan value:  88%|████████▊ | 488/553 [00:02<00:00, 223.53it/s]replace nan value:  92%|█████████▏| 511/553 [00:02<00:00, 220.55it/s]replace nan value:  97%|█████████▋| 534/553 [00:02<00:00, 217.14it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 207.41it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 128.98it/s]  5%|▍         | 27/553 [00:00<00:03, 135.03it/s]  7%|▋         | 41/553 [00:00<00:03, 132.77it/s] 10%|▉         | 55/553 [00:00<00:04, 122.34it/s] 12%|█▏        | 68/553 [00:00<00:04, 110.33it/s] 15%|█▌        | 83/553 [00:00<00:03, 121.63it/s] 17%|█▋        | 96/553 [00:00<00:03, 123.50it/s] 20%|█▉        | 109/553 [00:00<00:03, 124.20it/s] 22%|██▏       | 124/553 [00:00<00:03, 129.55it/s] 25%|██▌       | 140/553 [00:01<00:03, 136.66it/s] 29%|██▊       | 158/553 [00:01<00:02, 147.17it/s] 31%|███▏      | 174/553 [00:01<00:02, 144.76it/s] 34%|███▍      | 189/553 [00:01<00:02, 143.48it/s] 37%|███▋      | 206/553 [00:01<00:02, 150.69it/s] 40%|████      | 222/553 [00:01<00:02, 140.09it/s] 43%|████▎     | 238/553 [00:01<00:02, 144.09it/s] 46%|████▌     | 253/553 [00:01<00:02, 140.86it/s] 48%|████▊     | 268/553 [00:01<00:02, 138.01it/s] 51%|█████     | 282/553 [00:02<00:02, 133.76it/s] 54%|█████▎    | 296/553 [00:02<00:01, 130.02it/s] 56%|█████▌    | 310/553 [00:02<00:01, 127.22it/s] 58%|█████▊    | 323/553 [00:02<00:01, 125.69it/s] 61%|██████    | 337/553 [00:02<00:01, 128.30it/s] 63%|██████▎   | 350/553 [00:02<00:01, 127.11it/s] 66%|██████▌   | 363/553 [00:02<00:01, 123.45it/s] 68%|██████▊   | 377/553 [00:02<00:01, 127.25it/s] 71%|███████   | 390/553 [00:02<00:01, 120.66it/s] 73%|███████▎  | 405/553 [00:03<00:01, 126.16it/s] 76%|███████▌  | 418/553 [00:03<00:01, 125.98it/s] 78%|███████▊  | 431/553 [00:03<00:00, 124.37it/s] 82%|████████▏ | 451/553 [00:03<00:00, 143.55it/s] 84%|████████▍ | 467/553 [00:03<00:00, 148.04it/s] 87%|████████▋ | 482/553 [00:03<00:00, 144.37it/s] 90%|████████▉ | 497/553 [00:03<00:00, 136.20it/s] 93%|█████████▎| 513/553 [00:03<00:00, 141.98it/s] 95%|█████████▌| 528/553 [00:03<00:00, 127.83it/s] 98%|█████████▊| 542/553 [00:04<00:00, 130.50it/s]100%|██████████| 553/553 [00:04<00:00, 130.92it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 32/139 [00:00<00:00, 316.40it/s]extract the null data:  71%|███████   | 99/139 [00:00<00:00, 523.04it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 535.34it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 237.74it/s]replace nan value:  35%|███▌      | 49/139 [00:00<00:00, 241.38it/s]replace nan value:  53%|█████▎    | 74/139 [00:00<00:00, 238.08it/s]replace nan value:  71%|███████   | 99/139 [00:00<00:00, 242.08it/s]replace nan value:  89%|████████▉ | 124/139 [00:00<00:00, 242.85it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 241.09it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 129.82it/s] 21%|██        | 29/139 [00:00<00:00, 141.21it/s] 33%|███▎      | 46/139 [00:00<00:00, 151.23it/s] 45%|████▍     | 62/139 [00:00<00:00, 137.06it/s] 55%|█████▌    | 77/139 [00:00<00:00, 138.79it/s] 66%|██████▌   | 92/139 [00:00<00:00, 127.80it/s] 76%|███████▌  | 105/139 [00:00<00:00, 127.98it/s] 88%|████████▊ | 122/139 [00:00<00:00, 135.16it/s] 99%|█████████▊| 137/139 [00:01<00:00, 138.22it/s]100%|██████████| 139/139 [00:01<00:00, 136.98it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▍       | 43/173 [00:00<00:00, 425.84it/s]extract the null data:  66%|██████▌   | 114/173 [00:00<00:00, 588.68it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 592.86it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 244.07it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 244.71it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 237.05it/s]replace nan value:  57%|█████▋    | 99/173 [00:00<00:00, 237.56it/s]replace nan value:  71%|███████   | 123/173 [00:00<00:00, 237.97it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 234.26it/s]replace nan value:  99%|█████████▉| 171/173 [00:00<00:00, 233.32it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 235.79it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 140.03it/s] 17%|█▋        | 30/173 [00:00<00:01, 124.64it/s] 27%|██▋       | 46/173 [00:00<00:00, 138.20it/s] 36%|███▌      | 62/173 [00:00<00:00, 143.00it/s] 45%|████▍     | 77/173 [00:00<00:00, 140.66it/s] 53%|█████▎    | 92/173 [00:00<00:00, 138.24it/s] 62%|██████▏   | 107/173 [00:00<00:00, 139.34it/s] 71%|███████   | 122/173 [00:00<00:00, 140.42it/s] 79%|███████▉  | 137/173 [00:00<00:00, 137.38it/s] 87%|████████▋ | 151/173 [00:01<00:00, 132.34it/s] 95%|█████████▌| 165/173 [00:01<00:00, 118.24it/s]100%|██████████| 173/173 [00:01<00:00, 121.86it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.541, valid loss : 0.358, train acc : 0.812, valid acc : 0.926, train f1 : 0.593, valid f1 : 0.667
training process:   1%|          | 1/128 [01:02<2:12:38, 62.67s/it]Best score increase :0.000 -> 0.667
training process:   2%|▏         | 2/128 [01:54<1:58:34, 56.47s/it]Best score increase :0.667 -> 0.673
training process:   2%|▏         | 3/128 [02:49<1:55:39, 55.51s/it]Best score increase :0.673 -> 0.703
training process:   3%|▎         | 4/128 [03:43<1:53:26, 54.89s/it]Best score increase :0.703 -> 0.735
epoch : 5, train loss : 0.187, valid loss : 0.163, train acc : 0.950, valid acc : 0.946, train f1 : 0.785, valid f1 : 0.759
training process:   4%|▍         | 5/128 [04:45<1:57:57, 57.54s/it]Best score increase :0.735 -> 0.759
training process:   5%|▍         | 6/128 [05:37<1:53:07, 55.64s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:28<1:49:34, 54.34s/it]Best score increase :0.759 -> 0.778
training process:   6%|▋         | 8/128 [07:22<1:48:01, 54.02s/it]Best score increase :0.778 -> 0.779
epoch : 9, train loss : 0.140, valid loss : 0.154, train acc : 0.959, valid acc : 0.950, train f1 : 0.831, valid f1 : 0.786
training process:   7%|▋         | 9/128 [08:25<1:52:51, 56.90s/it]Best score increase :0.779 -> 0.786
training process:   8%|▊         | 10/128 [09:20<1:50:29, 56.18s/it]Best score increase :0.786 -> 0.793
training process:   9%|▊         | 11/128 [10:13<1:47:56, 55.35s/it]Best score increase :0.793 -> 0.794
training process:   9%|▉         | 12/128 [11:03<1:44:04, 53.83s/it]Best score increase :0.794 -> 0.796
epoch : 13, train loss : 0.126, valid loss : 0.161, train acc : 0.960, valid acc : 0.952, train f1 : 0.838, valid f1 : 0.796
training process:  10%|█         | 13/128 [12:03<1:46:22, 55.50s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:58<1:45:12, 55.37s/it]Best score increase :0.796 -> 0.797
training process:  12%|█▏        | 15/128 [13:53<1:44:16, 55.37s/it]Best score increase :0.797 -> 0.813
training process:  12%|█▎        | 16/128 [14:46<1:42:10, 54.74s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.117, valid loss : 0.153, train acc : 0.962, valid acc : 0.954, train f1 : 0.850, valid f1 : 0.806
training process:  13%|█▎        | 17/128 [15:45<1:43:07, 55.74s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [16:36<1:39:58, 54.54s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [17:30<1:38:41, 54.32s/it]EarlyStopping counter : 4 out of 12
training process:  16%|█▌        | 20/128 [18:26<1:38:40, 54.82s/it]Best score increase :0.813 -> 0.827
epoch : 21, train loss : 0.109, valid loss : 0.167, train acc : 0.964, valid acc : 0.954, train f1 : 0.859, valid f1 : 0.808
training process:  16%|█▋        | 21/128 [19:30<1:42:34, 57.52s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [20:22<1:38:50, 55.95s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [21:16<1:36:41, 55.25s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [22:09<1:34:53, 54.75s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.104, valid loss : 0.153, train acc : 0.966, valid acc : 0.957, train f1 : 0.869, valid f1 : 0.825
training process:  20%|█▉        | 25/128 [23:11<1:37:16, 56.66s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [24:02<1:33:54, 55.24s/it]Best score increase :0.827 -> 0.828
training process:  21%|██        | 27/128 [24:56<1:31:55, 54.61s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [25:45<1:28:16, 52.97s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.099, valid loss : 0.157, train acc : 0.968, valid acc : 0.957, train f1 : 0.875, valid f1 : 0.826
training process:  23%|██▎       | 29/128 [26:47<1:32:02, 55.78s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [27:45<1:32:05, 56.38s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [28:41<1:30:59, 56.28s/it]Best score increase :0.828 -> 0.830
training process:  25%|██▌       | 32/128 [29:32<1:27:33, 54.72s/it]Best score increase :0.830 -> 0.841
epoch : 33, train loss : 0.094, valid loss : 0.153, train acc : 0.969, valid acc : 0.959, train f1 : 0.882, valid f1 : 0.836
training process:  26%|██▌       | 33/128 [30:32<1:29:09, 56.31s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [31:25<1:26:27, 55.18s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [32:16<1:23:35, 53.93s/it]EarlyStopping counter : 3 out of 12
training process:  28%|██▊       | 36/128 [33:10<1:22:56, 54.09s/it]Best score increase :0.841 -> 0.850
epoch : 37, train loss : 0.093, valid loss : 0.180, train acc : 0.969, valid acc : 0.957, train f1 : 0.882, valid f1 : 0.821
training process:  29%|██▉       | 37/128 [34:15<1:27:00, 57.37s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [35:08<1:24:00, 56.01s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [36:01<1:21:43, 55.09s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [36:52<1:19:04, 53.91s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.089, valid loss : 0.170, train acc : 0.969, valid acc : 0.958, train f1 : 0.883, valid f1 : 0.830
training process:  32%|███▏      | 41/128 [37:55<1:22:09, 56.66s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [38:46<1:18:45, 54.94s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [39:38<1:16:41, 54.14s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [40:31<1:15:19, 53.81s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.088, valid loss : 0.167, train acc : 0.972, valid acc : 0.959, train f1 : 0.895, valid f1 : 0.836
training process:  35%|███▌      | 45/128 [41:33<1:17:46, 56.23s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [42:25<1:15:07, 54.97s/it]Best score increase :0.850 -> 0.856
training process:  37%|███▋      | 47/128 [43:17<1:13:07, 54.16s/it]EarlyStopping counter : 1 out of 12
training process:  38%|███▊      | 48/128 [44:10<1:11:32, 53.66s/it]EarlyStopping counter : 2 out of 12
epoch : 49, train loss : 0.082, valid loss : 0.165, train acc : 0.973, valid acc : 0.959, train f1 : 0.898, valid f1 : 0.836
training process:  38%|███▊      | 49/128 [45:11<1:13:23, 55.73s/it]EarlyStopping counter : 3 out of 12
training process:  39%|███▉      | 50/128 [46:02<1:10:39, 54.35s/it]EarlyStopping counter : 4 out of 12
training process:  40%|███▉      | 51/128 [46:53<1:08:46, 53.59s/it]EarlyStopping counter : 5 out of 12
training process:  41%|████      | 52/128 [47:47<1:07:46, 53.50s/it]EarlyStopping counter : 6 out of 12
epoch : 53, train loss : 0.086, valid loss : 0.159, train acc : 0.972, valid acc : 0.961, train f1 : 0.892, valid f1 : 0.846
training process:  41%|████▏     | 53/128 [48:45<1:08:47, 55.03s/it]EarlyStopping counter : 7 out of 12
training process:  42%|████▏     | 54/128 [49:37<1:06:45, 54.12s/it]Best score increase :0.856 -> 0.864
training process:  43%|████▎     | 55/128 [50:30<1:05:16, 53.65s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 56/128 [51:21<1:03:19, 52.77s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.080, valid loss : 0.170, train acc : 0.974, valid acc : 0.960, train f1 : 0.901, valid f1 : 0.840
training process:  45%|████▍     | 57/128 [52:20<1:04:50, 54.79s/it]EarlyStopping counter : 3 out of 12
training process:  45%|████▌     | 58/128 [53:10<1:02:17, 53.39s/it]EarlyStopping counter : 4 out of 12
training process:  46%|████▌     | 59/128 [53:57<59:12, 51.48s/it]  EarlyStopping counter : 5 out of 12
training process:  47%|████▋     | 60/128 [54:47<57:34, 50.80s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.080, valid loss : 0.169, train acc : 0.974, valid acc : 0.961, train f1 : 0.901, valid f1 : 0.842
training process:  48%|████▊     | 61/128 [55:47<59:53, 53.63s/it]EarlyStopping counter : 7 out of 12
training process:  48%|████▊     | 62/128 [56:33<56:37, 51.48s/it]EarlyStopping counter : 8 out of 12
training process:  49%|████▉     | 63/128 [57:21<54:41, 50.48s/it]EarlyStopping counter : 9 out of 12
training process:  50%|█████     | 64/128 [58:10<53:22, 50.05s/it]EarlyStopping counter : 10 out of 12
epoch : 65, train loss : 0.078, valid loss : 0.154, train acc : 0.974, valid acc : 0.963, train f1 : 0.901, valid f1 : 0.856
training process:  51%|█████     | 65/128 [59:07<54:37, 52.02s/it]EarlyStopping counter : 11 out of 12
training process:  51%|█████     | 65/128 [59:57<58:06, 55.35s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 65, best f1 score : 0.864
training process finished, best loss : 0.141 and best acc : 0.965, best f1 : 0.864, best epoch : 53

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.93      0.63      0.75       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.81      0.87      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.81, test loss : 8.839

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:22,  7.54s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.63s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.57s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.42s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.44s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.47s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.49s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:29,  7.40s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.39s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:14,  7.35s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:21<00:07,  7.42s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.43s/it]processing for feature importance: 100%|██████████| 12/12 [01:29<00:00,  7.44s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▌         | 16/306 [00:00<00:01, 155.98it/s] 11%|█         | 34/306 [00:00<00:01, 166.55it/s] 17%|█▋        | 53/306 [00:00<00:01, 176.67it/s] 23%|██▎       | 71/306 [00:00<00:01, 175.20it/s] 29%|██▉       | 89/306 [00:00<00:01, 172.96it/s] 36%|███▌      | 110/306 [00:00<00:01, 178.53it/s] 42%|████▏     | 129/306 [00:00<00:00, 179.09it/s] 48%|████▊     | 147/306 [00:00<00:00, 175.12it/s] 54%|█████▍    | 166/306 [00:00<00:00, 179.24it/s] 60%|██████    | 184/306 [00:01<00:00, 175.62it/s] 66%|██████▌   | 202/306 [00:01<00:00, 171.82it/s] 72%|███████▏  | 220/306 [00:01<00:00, 170.47it/s] 78%|███████▊  | 240/306 [00:01<00:00, 176.62it/s] 85%|████████▍ | 259/306 [00:01<00:00, 178.09it/s] 91%|█████████ | 277/306 [00:01<00:00, 173.85it/s] 96%|█████████▋| 295/306 [00:01<00:00, 174.41it/s]100%|██████████| 306/306 [00:01<00:00, 173.92it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 457.27it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 456.87it/s]extract the null data:  25%|██▌       | 140/553 [00:00<00:00, 466.28it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:00, 471.35it/s]extract the null data:  43%|████▎     | 236/553 [00:00<00:00, 470.42it/s]extract the null data:  52%|█████▏    | 285/553 [00:00<00:00, 474.64it/s]extract the null data:  60%|██████    | 333/553 [00:00<00:00, 475.41it/s]extract the null data:  69%|██████▉   | 381/553 [00:00<00:00, 475.65it/s]extract the null data:  78%|███████▊  | 429/553 [00:00<00:00, 473.96it/s]extract the null data:  86%|████████▋ | 477/553 [00:01<00:00, 472.98it/s]extract the null data:  95%|█████████▍| 525/553 [00:01<00:00, 459.03it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 466.33it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 164.97it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 166.48it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 165.61it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 166.00it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 164.89it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 164.79it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 165.44it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 165.03it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:02, 166.30it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 166.68it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 166.71it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 166.66it/s]replace nan value:  40%|███▉      | 221/553 [00:01<00:01, 166.62it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 165.82it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 164.97it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 164.91it/s]replace nan value:  52%|█████▏    | 289/553 [00:01<00:01, 165.57it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 165.86it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 167.85it/s]replace nan value:  62%|██████▏   | 342/553 [00:02<00:01, 168.90it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 169.35it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:01, 170.82it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 171.35it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 173.01it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 171.12it/s]replace nan value:  81%|████████▏ | 450/553 [00:02<00:00, 172.20it/s]replace nan value:  85%|████████▍ | 468/553 [00:02<00:00, 170.85it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 171.51it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 171.18it/s]replace nan value:  94%|█████████▍| 522/553 [00:03<00:00, 171.28it/s]replace nan value:  98%|█████████▊| 540/553 [00:03<00:00, 171.29it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 168.30it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 104.34it/s]  4%|▍         | 24/553 [00:00<00:04, 118.34it/s]  7%|▋         | 38/553 [00:00<00:04, 126.13it/s]  9%|▉         | 51/553 [00:00<00:04, 105.90it/s] 11%|█         | 62/553 [00:00<00:04, 99.42it/s]  13%|█▎        | 73/553 [00:00<00:04, 101.66it/s] 16%|█▌        | 86/553 [00:00<00:04, 109.69it/s] 18%|█▊        | 98/553 [00:00<00:04, 106.70it/s] 20%|██        | 112/553 [00:01<00:03, 115.59it/s] 22%|██▏       | 124/553 [00:01<00:03, 115.71it/s] 25%|██▍       | 137/553 [00:01<00:03, 119.76it/s] 27%|██▋       | 151/553 [00:01<00:03, 125.34it/s] 30%|██▉       | 165/553 [00:01<00:02, 129.52it/s] 32%|███▏      | 179/553 [00:01<00:02, 129.44it/s] 35%|███▍      | 193/553 [00:01<00:02, 131.39it/s] 38%|███▊      | 208/553 [00:01<00:02, 135.98it/s] 40%|████      | 222/553 [00:01<00:02, 124.07it/s] 43%|████▎     | 236/553 [00:01<00:02, 126.87it/s] 45%|████▌     | 249/553 [00:02<00:02, 122.07it/s] 48%|████▊     | 263/553 [00:02<00:02, 126.38it/s] 50%|████▉     | 276/553 [00:02<00:02, 117.69it/s] 52%|█████▏    | 290/553 [00:02<00:02, 122.24it/s] 55%|█████▍    | 303/553 [00:02<00:02, 114.09it/s] 57%|█████▋    | 315/553 [00:02<00:02, 108.69it/s] 59%|█████▉    | 327/553 [00:02<00:02, 108.72it/s] 61%|██████▏   | 340/553 [00:02<00:01, 113.24it/s] 64%|██████▎   | 352/553 [00:02<00:01, 113.76it/s] 66%|██████▌   | 364/553 [00:03<00:01, 107.56it/s] 68%|██████▊   | 378/553 [00:03<00:01, 114.71it/s] 71%|███████   | 390/553 [00:03<00:01, 108.49it/s] 73%|███████▎  | 402/553 [00:03<00:01, 111.39it/s] 75%|███████▌  | 416/553 [00:03<00:01, 114.80it/s] 77%|███████▋  | 428/553 [00:03<00:01, 111.01it/s] 80%|████████  | 445/553 [00:03<00:00, 126.59it/s] 83%|████████▎ | 460/553 [00:03<00:00, 132.11it/s] 86%|████████▌ | 474/553 [00:03<00:00, 134.15it/s] 88%|████████▊ | 488/553 [00:04<00:00, 128.56it/s] 91%|█████████ | 501/553 [00:04<00:00, 121.73it/s] 93%|█████████▎| 516/553 [00:04<00:00, 128.97it/s] 96%|█████████▌| 530/553 [00:04<00:00, 110.15it/s] 99%|█████████▊| 545/553 [00:04<00:00, 118.97it/s]100%|██████████| 553/553 [00:04<00:00, 116.61it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  21%|██        | 29/139 [00:00<00:00, 284.85it/s]extract the null data:  60%|██████    | 84/139 [00:00<00:00, 437.06it/s]extract the null data:  99%|█████████▉| 138/139 [00:00<00:00, 481.75it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 454.46it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 183.24it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 183.81it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 184.34it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 185.52it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 184.16it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 183.29it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 182.67it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 183.46it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.29it/s] 17%|█▋        | 24/139 [00:00<00:00, 117.94it/s] 27%|██▋       | 37/139 [00:00<00:00, 122.99it/s] 36%|███▌      | 50/139 [00:00<00:00, 121.54it/s] 45%|████▌     | 63/139 [00:00<00:00, 118.53it/s] 54%|█████▍    | 75/139 [00:00<00:00, 118.23it/s] 63%|██████▎   | 87/139 [00:00<00:00, 108.36it/s] 71%|███████   | 99/139 [00:00<00:00, 109.40it/s] 80%|███████▉  | 111/139 [00:00<00:00, 110.68it/s] 90%|████████▉ | 125/139 [00:01<00:00, 118.05it/s] 99%|█████████▉| 138/139 [00:01<00:00, 120.90it/s]100%|██████████| 139/139 [00:01<00:00, 117.25it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 20/173 [00:00<00:00, 198.99it/s]extract the null data:  44%|████▍     | 76/173 [00:00<00:00, 406.86it/s]extract the null data:  76%|███████▋  | 132/173 [00:00<00:00, 473.41it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 452.66it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 191.35it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 187.36it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 188.00it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 186.96it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 187.53it/s]replace nan value:  68%|██████▊   | 117/173 [00:00<00:00, 188.49it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 186.43it/s]replace nan value:  90%|████████▉ | 155/173 [00:00<00:00, 184.58it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 185.36it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 146.93it/s] 17%|█▋        | 30/173 [00:00<00:01, 131.03it/s] 27%|██▋       | 47/173 [00:00<00:00, 146.67it/s] 36%|███▋      | 63/173 [00:00<00:00, 151.54it/s] 46%|████▌     | 79/173 [00:00<00:00, 148.68it/s] 54%|█████▍    | 94/173 [00:00<00:00, 146.00it/s] 63%|██████▎   | 109/173 [00:00<00:00, 145.46it/s] 72%|███████▏  | 124/173 [00:00<00:00, 139.51it/s] 80%|████████  | 139/173 [00:00<00:00, 140.02it/s] 89%|████████▉ | 154/173 [00:01<00:00, 132.36it/s] 97%|█████████▋| 168/173 [00:01<00:00, 106.83it/s]100%|██████████| 173/173 [00:01<00:00, 126.13it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.549, valid loss : 0.393, train acc : 0.714, valid acc : 0.843, train f1 : 0.714, valid f1 : 0.668
training process:   1%|          | 1/128 [01:03<2:14:58, 63.76s/it]Best score increase :0.000 -> 0.668
training process:   2%|▏         | 2/128 [01:57<2:01:39, 57.93s/it]Best score increase :0.668 -> 0.709
training process:   2%|▏         | 3/128 [02:50<1:55:34, 55.47s/it]Best score increase :0.709 -> 0.756
training process:   3%|▎         | 4/128 [03:41<1:51:39, 54.03s/it]Best score increase :0.756 -> 0.773
epoch : 5, train loss : 0.343, valid loss : 0.239, train acc : 0.842, valid acc : 0.923, train f1 : 0.842, valid f1 : 0.785
training process:   4%|▍         | 5/128 [04:43<1:56:36, 56.88s/it]Best score increase :0.773 -> 0.785
training process:   5%|▍         | 6/128 [05:36<1:52:41, 55.42s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:28<1:49:43, 54.41s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:17<1:45:02, 52.52s/it]Best score increase :0.785 -> 0.789
epoch : 9, train loss : 0.288, valid loss : 0.222, train acc : 0.875, valid acc : 0.928, train f1 : 0.875, valid f1 : 0.806
training process:   7%|▋         | 9/128 [08:17<1:48:55, 54.92s/it]Best score increase :0.789 -> 0.806
training process:   8%|▊         | 10/128 [09:11<1:47:10, 54.49s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:57<1:41:18, 51.95s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [10:44<1:37:26, 50.40s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.258, valid loss : 0.216, train acc : 0.888, valid acc : 0.931, train f1 : 0.887, valid f1 : 0.816
training process:  10%|█         | 13/128 [11:43<1:41:39, 53.04s/it]Best score increase :0.806 -> 0.816
training process:  11%|█         | 14/128 [12:35<1:40:05, 52.68s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:21<1:35:36, 50.76s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:10<1:33:34, 50.13s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.234, valid loss : 0.188, train acc : 0.902, valid acc : 0.941, train f1 : 0.902, valid f1 : 0.835
training process:  13%|█▎        | 17/128 [15:06<1:36:15, 52.03s/it]Best score increase :0.816 -> 0.835
training process:  14%|█▍        | 18/128 [15:52<1:32:21, 50.38s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:44<1:32:10, 50.74s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:33<1:30:09, 50.09s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.220, valid loss : 0.185, train acc : 0.910, valid acc : 0.937, train f1 : 0.910, valid f1 : 0.828
training process:  16%|█▋        | 21/128 [18:28<1:32:02, 51.62s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [19:14<1:28:13, 49.94s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [20:04<1:27:27, 49.97s/it]EarlyStopping counter : 6 out of 12
training process:  19%|█▉        | 24/128 [20:55<1:27:08, 50.27s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.207, valid loss : 0.178, train acc : 0.914, valid acc : 0.937, train f1 : 0.914, valid f1 : 0.832
training process:  20%|█▉        | 25/128 [21:54<1:30:50, 52.92s/it]EarlyStopping counter : 8 out of 12
training process:  20%|██        | 26/128 [22:47<1:29:47, 52.81s/it]EarlyStopping counter : 9 out of 12
training process:  21%|██        | 27/128 [23:38<1:28:16, 52.44s/it]EarlyStopping counter : 10 out of 12
training process:  22%|██▏       | 28/128 [24:29<1:26:43, 52.03s/it]Best score increase :0.835 -> 0.844
epoch : 29, train loss : 0.192, valid loss : 0.172, train acc : 0.921, valid acc : 0.936, train f1 : 0.921, valid f1 : 0.828
training process:  23%|██▎       | 29/128 [25:28<1:29:25, 54.20s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [26:19<1:26:29, 52.96s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [27:10<1:24:44, 52.42s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [28:01<1:23:14, 52.03s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.183, valid loss : 0.174, train acc : 0.924, valid acc : 0.933, train f1 : 0.924, valid f1 : 0.825
training process:  26%|██▌       | 33/128 [28:57<1:24:25, 53.32s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [29:48<1:22:29, 52.66s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [30:41<1:21:41, 52.71s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [31:33<1:20:32, 52.53s/it]Best score increase :0.844 -> 0.848
epoch : 37, train loss : 0.172, valid loss : 0.152, train acc : 0.931, valid acc : 0.943, train f1 : 0.931, valid f1 : 0.843
training process:  29%|██▉       | 37/128 [32:33<1:23:07, 54.81s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [33:27<1:21:40, 54.45s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [34:19<1:19:44, 53.76s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [35:10<1:17:30, 52.85s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.171, valid loss : 0.170, train acc : 0.929, valid acc : 0.933, train f1 : 0.929, valid f1 : 0.823
training process:  32%|███▏      | 41/128 [36:10<1:20:00, 55.17s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [37:03<1:18:10, 54.54s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [37:56<1:16:36, 54.08s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [38:47<1:14:20, 53.10s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.162, valid loss : 0.179, train acc : 0.935, valid acc : 0.932, train f1 : 0.934, valid f1 : 0.823
training process:  35%|███▌      | 45/128 [39:47<1:16:12, 55.09s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [40:38<1:13:29, 53.78s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [41:33<1:13:14, 54.25s/it]EarlyStopping counter : 11 out of 12
training process:  37%|███▋      | 47/128 [42:27<1:13:09, 54.19s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.848
training process finished, best loss : 0.135 and best acc : 0.950, best f1 : 0.848, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.69      0.78      0.73       580
           1       0.98      0.97      0.98      6818

    accuracy                           0.95      7398
   macro avg       0.83      0.87      0.85      7398
weighted avg       0.96      0.95      0.96      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.87, test loss : 7.933

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:09<01:39,  9.06s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:27,  8.71s/it]processing for feature importance:  25%|██▌       | 3/12 [00:26<01:18,  8.67s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:08,  8.62s/it]processing for feature importance:  42%|████▏     | 5/12 [00:43<01:01,  8.72s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:51,  8.55s/it]processing for feature importance:  58%|█████▊    | 7/12 [01:00<00:42,  8.54s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:09<00:34,  8.66s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:18<00:26,  8.74s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:26<00:17,  8.75s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:35<00:08,  8.69s/it]processing for feature importance: 100%|██████████| 12/12 [01:43<00:00,  8.38s/it]processing for feature importance: 100%|██████████| 12/12 [01:43<00:00,  8.60s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▍         | 12/306 [00:00<00:02, 107.21it/s] 10%|█         | 31/306 [00:00<00:01, 150.14it/s] 15%|█▌        | 47/306 [00:00<00:01, 151.48it/s] 21%|██        | 63/306 [00:00<00:01, 128.45it/s] 26%|██▋       | 81/306 [00:00<00:01, 142.10it/s] 31%|███▏      | 96/306 [00:00<00:01, 141.52it/s] 36%|███▋      | 111/306 [00:00<00:01, 135.80it/s] 43%|████▎     | 132/306 [00:00<00:01, 156.17it/s] 48%|████▊     | 148/306 [00:01<00:01, 154.99it/s] 54%|█████▎    | 164/306 [00:01<00:01, 140.99it/s] 60%|█████▉    | 183/306 [00:01<00:00, 153.42it/s] 65%|██████▌   | 199/306 [00:01<00:00, 154.18it/s] 70%|███████   | 215/306 [00:01<00:00, 139.02it/s] 75%|███████▌  | 231/306 [00:01<00:00, 143.62it/s] 80%|████████  | 246/306 [00:01<00:00, 135.25it/s] 86%|████████▋ | 264/306 [00:01<00:00, 145.98it/s] 92%|█████████▏| 281/306 [00:01<00:00, 151.29it/s] 97%|█████████▋| 297/306 [00:02<00:00, 139.17it/s]100%|██████████| 306/306 [00:02<00:00, 145.14it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   9%|▉         | 49/553 [00:00<00:01, 486.84it/s]extract the null data:  18%|█▊        | 101/553 [00:00<00:00, 502.37it/s]extract the null data:  27%|██▋       | 152/553 [00:00<00:00, 492.26it/s]extract the null data:  37%|███▋      | 202/553 [00:00<00:00, 481.07it/s]extract the null data:  45%|████▌     | 251/553 [00:00<00:00, 474.62it/s]extract the null data:  54%|█████▍    | 299/553 [00:00<00:00, 476.27it/s]extract the null data:  63%|██████▎   | 347/553 [00:00<00:00, 476.11it/s]extract the null data:  71%|███████▏  | 395/553 [00:00<00:00, 474.59it/s]extract the null data:  80%|████████  | 443/553 [00:00<00:00, 468.78it/s]extract the null data:  89%|████████▊ | 490/553 [00:01<00:00, 458.53it/s]extract the null data:  99%|█████████▊| 545/553 [00:01<00:00, 485.27it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 479.52it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 191.01it/s]replace nan value:   7%|▋         | 40/553 [00:00<00:02, 180.03it/s]replace nan value:  11%|█         | 59/553 [00:00<00:02, 174.95it/s]replace nan value:  14%|█▍        | 77/553 [00:00<00:02, 173.66it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:02, 176.28it/s]replace nan value:  21%|██        | 114/553 [00:00<00:02, 175.52it/s]replace nan value:  24%|██▍       | 132/553 [00:00<00:02, 174.79it/s]replace nan value:  27%|██▋       | 150/553 [00:00<00:02, 174.59it/s]replace nan value:  30%|███       | 168/553 [00:00<00:02, 175.35it/s]replace nan value:  34%|███▎      | 186/553 [00:01<00:02, 175.16it/s]replace nan value:  37%|███▋      | 204/553 [00:01<00:02, 174.33it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 173.72it/s]replace nan value:  43%|████▎     | 240/553 [00:01<00:01, 173.54it/s]replace nan value:  47%|████▋     | 258/553 [00:01<00:01, 174.01it/s]replace nan value:  50%|█████     | 278/553 [00:01<00:01, 181.42it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 182.36it/s]replace nan value:  57%|█████▋    | 316/553 [00:01<00:01, 179.38it/s]replace nan value:  60%|██████    | 334/553 [00:01<00:01, 176.97it/s]replace nan value:  64%|██████▎   | 352/553 [00:01<00:01, 175.06it/s]replace nan value:  67%|██████▋   | 370/553 [00:02<00:01, 173.06it/s]replace nan value:  70%|███████   | 388/553 [00:02<00:00, 171.35it/s]replace nan value:  73%|███████▎  | 406/553 [00:02<00:00, 169.71it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 168.60it/s]replace nan value:  80%|███████▉  | 441/553 [00:02<00:00, 169.33it/s]replace nan value:  83%|████████▎ | 459/553 [00:02<00:00, 170.78it/s]replace nan value:  86%|████████▋ | 477/553 [00:02<00:00, 171.44it/s]replace nan value:  90%|████████▉ | 495/553 [00:02<00:00, 171.04it/s]replace nan value:  93%|█████████▎| 513/553 [00:02<00:00, 170.81it/s]replace nan value:  96%|█████████▌| 532/553 [00:03<00:00, 175.69it/s]replace nan value: 100%|█████████▉| 551/553 [00:03<00:00, 179.62it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 174.99it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 123.85it/s]  5%|▍         | 27/553 [00:00<00:04, 130.06it/s]  7%|▋         | 41/553 [00:00<00:04, 127.89it/s] 10%|▉         | 54/553 [00:00<00:04, 117.32it/s] 12%|█▏        | 66/553 [00:00<00:04, 109.15it/s] 14%|█▍        | 80/553 [00:00<00:04, 114.69it/s] 17%|█▋        | 93/553 [00:00<00:03, 119.16it/s] 19%|█▉        | 107/553 [00:00<00:03, 125.20it/s] 22%|██▏       | 122/553 [00:00<00:03, 127.30it/s] 25%|██▍       | 137/553 [00:01<00:03, 132.99it/s] 28%|██▊       | 154/553 [00:01<00:02, 142.62it/s] 31%|███       | 171/553 [00:01<00:02, 149.47it/s] 34%|███▍      | 187/553 [00:01<00:02, 145.09it/s] 37%|███▋      | 204/553 [00:01<00:02, 150.65it/s] 40%|███▉      | 220/553 [00:01<00:02, 142.04it/s] 42%|████▏     | 235/553 [00:01<00:02, 142.07it/s] 45%|████▌     | 250/553 [00:01<00:02, 139.39it/s] 48%|████▊     | 265/553 [00:01<00:02, 137.69it/s] 50%|█████     | 279/553 [00:02<00:02, 132.63it/s] 53%|█████▎    | 293/553 [00:02<00:02, 129.62it/s] 55%|█████▌    | 306/553 [00:02<00:01, 125.29it/s] 58%|█████▊    | 319/553 [00:02<00:01, 124.87it/s] 60%|██████    | 332/553 [00:02<00:01, 126.27it/s] 62%|██████▏   | 345/553 [00:02<00:01, 126.60it/s] 65%|██████▍   | 358/553 [00:02<00:01, 123.87it/s] 67%|██████▋   | 373/553 [00:02<00:01, 129.58it/s] 70%|██████▉   | 386/553 [00:02<00:01, 121.40it/s] 72%|███████▏  | 399/553 [00:03<00:01, 109.12it/s] 75%|███████▌  | 415/553 [00:03<00:01, 117.49it/s] 77%|███████▋  | 427/553 [00:03<00:01, 110.15it/s] 80%|████████  | 443/553 [00:03<00:00, 121.60it/s] 83%|████████▎ | 458/553 [00:03<00:00, 128.13it/s] 85%|████████▌ | 472/553 [00:03<00:00, 131.09it/s] 88%|████████▊ | 486/553 [00:03<00:00, 129.14it/s] 90%|█████████ | 500/553 [00:03<00:00, 118.87it/s] 93%|█████████▎| 515/553 [00:04<00:00, 125.00it/s] 95%|█████████▌| 528/553 [00:04<00:00, 111.14it/s] 98%|█████████▊| 540/553 [00:04<00:00, 113.37it/s]100%|█████████▉| 552/553 [00:04<00:00, 101.98it/s]100%|██████████| 553/553 [00:04<00:00, 124.53it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▉        | 27/139 [00:00<00:00, 269.68it/s]extract the null data:  59%|█████▉    | 82/139 [00:00<00:00, 432.67it/s]extract the null data:  98%|█████████▊| 136/139 [00:00<00:00, 479.46it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 451.86it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 187.93it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 188.94it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 188.16it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 189.43it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 188.99it/s]replace nan value:  83%|████████▎ | 115/139 [00:00<00:00, 188.92it/s]replace nan value:  96%|█████████▋| 134/139 [00:00<00:00, 189.26it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 189.01it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 106.96it/s] 17%|█▋        | 23/139 [00:00<00:01, 114.41it/s] 27%|██▋       | 37/139 [00:00<00:00, 123.57it/s] 36%|███▌      | 50/139 [00:00<00:00, 124.94it/s] 45%|████▌     | 63/139 [00:00<00:00, 121.51it/s] 55%|█████▍    | 76/139 [00:00<00:00, 120.25it/s] 64%|██████▍   | 89/139 [00:00<00:00, 104.64it/s] 73%|███████▎  | 102/139 [00:00<00:00, 111.16it/s] 82%|████████▏ | 114/139 [00:00<00:00, 111.78it/s] 91%|█████████▏| 127/139 [00:01<00:00, 116.27it/s]100%|██████████| 139/139 [00:01<00:00, 116.41it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 316.81it/s]extract the null data:  50%|█████     | 87/173 [00:00<00:00, 447.85it/s]extract the null data:  82%|████████▏ | 142/173 [00:00<00:00, 493.57it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 475.30it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 189.89it/s]replace nan value:  23%|██▎       | 39/173 [00:00<00:00, 188.75it/s]replace nan value:  34%|███▍      | 59/173 [00:00<00:00, 192.37it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 198.88it/s]replace nan value:  58%|█████▊    | 100/173 [00:00<00:00, 197.34it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 194.87it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 192.06it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 189.69it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 191.22it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.67it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.19it/s] 23%|██▎       | 40/173 [00:00<00:01, 117.60it/s] 32%|███▏      | 55/173 [00:00<00:00, 125.40it/s] 39%|███▉      | 68/173 [00:00<00:00, 125.19it/s] 47%|████▋     | 81/173 [00:00<00:00, 124.60it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.10it/s] 62%|██████▏   | 107/173 [00:00<00:00, 125.00it/s] 69%|██████▉   | 120/173 [00:00<00:00, 124.73it/s] 77%|███████▋  | 133/173 [00:01<00:00, 118.74it/s] 84%|████████▍ | 146/173 [00:01<00:00, 118.92it/s] 91%|█████████▏| 158/173 [00:01<00:00, 110.20it/s] 98%|█████████▊| 170/173 [00:01<00:00, 91.04it/s] 100%|██████████| 173/173 [00:01<00:00, 108.39it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.087, valid loss : 0.077, train acc : 0.615, valid acc : 0.775, train f1 : 0.493, valid f1 : 0.609
training process:   1%|          | 1/128 [01:00<2:08:39, 60.78s/it]Best score increase :0.000 -> 0.609
training process:   2%|▏         | 2/128 [01:53<1:57:17, 55.85s/it]Best score increase :0.609 -> 0.652
training process:   2%|▏         | 3/128 [02:46<1:53:44, 54.60s/it]Best score increase :0.652 -> 0.738
training process:   3%|▎         | 4/128 [03:36<1:48:59, 52.74s/it]Best score increase :0.738 -> 0.755
epoch : 5, train loss : 0.057, valid loss : 0.060, train acc : 0.856, valid acc : 0.923, train f1 : 0.693, valid f1 : 0.777
training process:   4%|▍         | 5/128 [04:35<1:53:10, 55.20s/it]Best score increase :0.755 -> 0.777
training process:   5%|▍         | 6/128 [05:28<1:50:19, 54.26s/it]Best score increase :0.777 -> 0.793
training process:   5%|▌         | 7/128 [06:21<1:48:29, 53.80s/it]Best score increase :0.793 -> 0.803
training process:   6%|▋         | 8/128 [07:12<1:46:07, 53.06s/it]Best score increase :0.803 -> 0.808
epoch : 9, train loss : 0.050, valid loss : 0.058, train acc : 0.897, valid acc : 0.942, train f1 : 0.747, valid f1 : 0.814
training process:   7%|▋         | 9/128 [08:11<1:48:52, 54.89s/it]Best score increase :0.808 -> 0.814
training process:   8%|▊         | 10/128 [09:04<1:46:49, 54.32s/it]Best score increase :0.814 -> 0.824
training process:   9%|▊         | 11/128 [09:57<1:45:06, 53.90s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:48<1:42:44, 53.14s/it]Best score increase :0.824 -> 0.827
epoch : 13, train loss : 0.046, valid loss : 0.063, train acc : 0.913, valid acc : 0.951, train f1 : 0.775, valid f1 : 0.830
training process:  10%|█         | 13/128 [11:48<1:45:43, 55.16s/it]Best score increase :0.827 -> 0.830
training process:  11%|█         | 14/128 [12:45<1:45:35, 55.58s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:41<1:45:04, 55.79s/it]Best score increase :0.830 -> 0.838
training process:  12%|█▎        | 16/128 [14:37<1:44:13, 55.83s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.043, valid loss : 0.061, train acc : 0.925, valid acc : 0.951, train f1 : 0.795, valid f1 : 0.835
training process:  13%|█▎        | 17/128 [15:38<1:46:22, 57.50s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [16:30<1:42:29, 55.91s/it]Best score increase :0.838 -> 0.850
training process:  15%|█▍        | 19/128 [17:27<1:41:57, 56.12s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [18:18<1:38:28, 54.71s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.041, valid loss : 0.065, train acc : 0.933, valid acc : 0.952, train f1 : 0.811, valid f1 : 0.838
training process:  16%|█▋        | 21/128 [19:18<1:40:07, 56.15s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [20:09<1:36:42, 54.74s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [20:58<1:32:33, 52.89s/it]EarlyStopping counter : 5 out of 12
training process:  19%|█▉        | 24/128 [21:44<1:28:15, 50.92s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.039, valid loss : 0.062, train acc : 0.936, valid acc : 0.954, train f1 : 0.818, valid f1 : 0.847
training process:  20%|█▉        | 25/128 [22:38<1:28:46, 51.72s/it]EarlyStopping counter : 7 out of 12
training process:  20%|██        | 26/128 [23:25<1:25:21, 50.21s/it]EarlyStopping counter : 8 out of 12
training process:  21%|██        | 27/128 [24:13<1:23:46, 49.77s/it]EarlyStopping counter : 9 out of 12
training process:  22%|██▏       | 28/128 [25:04<1:23:27, 50.08s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.038, valid loss : 0.064, train acc : 0.940, valid acc : 0.956, train f1 : 0.826, valid f1 : 0.852
training process:  23%|██▎       | 29/128 [26:01<1:25:45, 51.97s/it]Best score increase :0.850 -> 0.852
training process:  23%|██▎       | 30/128 [26:48<1:22:29, 50.50s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [27:37<1:21:01, 50.12s/it]Best score increase :0.852 -> 0.854
training process:  25%|██▌       | 32/128 [28:29<1:21:00, 50.63s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.036, valid loss : 0.062, train acc : 0.940, valid acc : 0.956, train f1 : 0.831, valid f1 : 0.854
training process:  26%|██▌       | 33/128 [29:27<1:23:57, 53.02s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [30:19<1:22:20, 52.56s/it]Best score increase :0.854 -> 0.859
training process:  27%|██▋       | 35/128 [31:08<1:19:50, 51.51s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [31:56<1:17:38, 50.63s/it]Best score increase :0.859 -> 0.860
epoch : 37, train loss : 0.036, valid loss : 0.077, train acc : 0.946, valid acc : 0.956, train f1 : 0.843, valid f1 : 0.848
training process:  29%|██▉       | 37/128 [32:57<1:21:27, 53.70s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [33:49<1:19:51, 53.23s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [34:38<1:16:50, 51.80s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [35:26<1:14:18, 50.67s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.034, valid loss : 0.075, train acc : 0.942, valid acc : 0.958, train f1 : 0.836, valid f1 : 0.857
training process:  32%|███▏      | 41/128 [36:23<1:16:26, 52.71s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [37:12<1:13:36, 51.36s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [37:57<1:10:16, 49.61s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [38:44<1:08:16, 48.77s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.035, valid loss : 0.073, train acc : 0.949, valid acc : 0.958, train f1 : 0.851, valid f1 : 0.856
training process:  35%|███▌      | 45/128 [39:43<1:11:35, 51.76s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [40:31<1:09:25, 50.80s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [41:19<1:07:18, 49.85s/it]Best score increase :0.860 -> 0.863
training process:  38%|███▊      | 48/128 [42:05<1:04:54, 48.68s/it]Best score increase :0.863 -> 0.864
epoch : 49, train loss : 0.032, valid loss : 0.071, train acc : 0.949, valid acc : 0.957, train f1 : 0.850, valid f1 : 0.856
training process:  38%|███▊      | 49/128 [43:01<1:06:59, 50.88s/it]EarlyStopping counter : 1 out of 12
training process:  39%|███▉      | 50/128 [43:49<1:05:13, 50.18s/it]EarlyStopping counter : 2 out of 12
training process:  40%|███▉      | 51/128 [44:40<1:04:27, 50.22s/it]EarlyStopping counter : 3 out of 12
training process:  41%|████      | 52/128 [45:32<1:04:27, 50.89s/it]EarlyStopping counter : 4 out of 12
epoch : 53, train loss : 0.034, valid loss : 0.073, train acc : 0.952, valid acc : 0.957, train f1 : 0.857, valid f1 : 0.855
training process:  41%|████▏     | 53/128 [46:31<1:06:28, 53.18s/it]EarlyStopping counter : 5 out of 12
training process:  42%|████▏     | 54/128 [47:25<1:05:50, 53.39s/it]EarlyStopping counter : 6 out of 12
training process:  43%|████▎     | 55/128 [48:21<1:06:01, 54.27s/it]EarlyStopping counter : 7 out of 12
training process:  44%|████▍     | 56/128 [49:13<1:04:16, 53.57s/it]EarlyStopping counter : 8 out of 12
epoch : 57, train loss : 0.032, valid loss : 0.081, train acc : 0.954, valid acc : 0.958, train f1 : 0.863, valid f1 : 0.855
training process:  45%|████▍     | 57/128 [50:16<1:06:40, 56.34s/it]EarlyStopping counter : 9 out of 12
training process:  45%|████▌     | 58/128 [51:07<1:04:05, 54.94s/it]EarlyStopping counter : 10 out of 12
training process:  46%|████▌     | 59/128 [51:58<1:01:52, 53.81s/it]EarlyStopping counter : 11 out of 12
training process:  46%|████▌     | 59/128 [52:51<1:01:48, 53.75s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 59, best f1 score : 0.865
training process finished, best loss : 0.066 and best acc : 0.958, best f1 : 0.865, best epoch : 59

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.81      0.72      0.76       580
           1       0.98      0.99      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.89      0.85      0.87      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.87, test AUC : 0.85, test loss : 4.028

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:28,  8.08s/it]processing for feature importance:  17%|█▋        | 2/12 [00:16<01:20,  8.06s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:10,  7.86s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:01,  7.73s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.83s/it]processing for feature importance:  50%|█████     | 6/12 [00:47<00:46,  7.81s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:55<00:39,  7.93s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:03<00:32,  8.05s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:11<00:24,  8.03s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:19<00:15,  7.90s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:27<00:07,  7.97s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  8.14s/it]processing for feature importance: 100%|██████████| 12/12 [01:35<00:00,  7.98s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 17/306 [00:00<00:01, 160.43it/s] 12%|█▏        | 36/306 [00:00<00:01, 172.65it/s] 18%|█▊        | 56/306 [00:00<00:01, 184.31it/s] 25%|██▍       | 75/306 [00:00<00:01, 177.56it/s] 30%|███       | 93/306 [00:00<00:01, 173.39it/s] 36%|███▋      | 111/306 [00:00<00:01, 170.51it/s] 42%|████▏     | 129/306 [00:00<00:01, 170.06it/s] 48%|████▊     | 148/306 [00:00<00:00, 173.92it/s] 54%|█████▍    | 166/306 [00:00<00:00, 172.14it/s] 60%|██████    | 184/306 [00:01<00:00, 173.50it/s] 66%|██████▋   | 203/306 [00:01<00:00, 177.30it/s] 72%|███████▏  | 221/306 [00:01<00:00, 173.55it/s] 79%|███████▉  | 241/306 [00:01<00:00, 180.67it/s] 86%|████████▌ | 262/306 [00:01<00:00, 188.55it/s] 92%|█████████▏| 281/306 [00:01<00:00, 185.27it/s] 98%|█████████▊| 300/306 [00:01<00:00, 183.98it/s]100%|██████████| 306/306 [00:01<00:00, 178.28it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 455.20it/s]extract the null data:  17%|█▋        | 94/553 [00:00<00:00, 467.03it/s]extract the null data:  26%|██▌       | 143/553 [00:00<00:00, 477.29it/s]extract the null data:  35%|███▍      | 192/553 [00:00<00:00, 478.49it/s]extract the null data:  44%|████▎     | 241/553 [00:00<00:00, 480.27it/s]extract the null data:  52%|█████▏    | 290/553 [00:00<00:00, 476.89it/s]extract the null data:  61%|██████▏   | 339/553 [00:00<00:00, 478.46it/s]extract the null data:  70%|██████▉   | 387/553 [00:00<00:00, 477.66it/s]extract the null data:  79%|███████▊  | 435/553 [00:00<00:00, 477.04it/s]extract the null data:  88%|████████▊ | 485/553 [00:01<00:00, 483.35it/s]extract the null data:  97%|█████████▋| 534/553 [00:01<00:00, 483.19it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 478.46it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 167.09it/s]replace nan value:   6%|▋         | 35/553 [00:00<00:03, 170.46it/s]replace nan value:  10%|▉         | 53/553 [00:00<00:02, 172.65it/s]replace nan value:  13%|█▎        | 71/553 [00:00<00:02, 173.37it/s]replace nan value:  16%|█▌        | 89/553 [00:00<00:02, 174.35it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 176.89it/s]replace nan value:  23%|██▎       | 126/553 [00:00<00:02, 176.80it/s]replace nan value:  26%|██▌       | 144/553 [00:00<00:02, 177.35it/s]replace nan value:  29%|██▉       | 162/553 [00:00<00:02, 176.94it/s]replace nan value:  33%|███▎      | 180/553 [00:01<00:02, 177.04it/s]replace nan value:  36%|███▌      | 198/553 [00:01<00:01, 177.76it/s]replace nan value:  39%|███▉      | 216/553 [00:01<00:01, 177.51it/s]replace nan value:  42%|████▏     | 234/553 [00:01<00:01, 176.14it/s]replace nan value:  46%|████▌     | 252/553 [00:01<00:01, 176.71it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 177.28it/s]replace nan value:  52%|█████▏    | 288/553 [00:01<00:01, 177.56it/s]replace nan value:  55%|█████▌    | 306/553 [00:01<00:01, 176.68it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 176.25it/s]replace nan value:  62%|██████▏   | 342/553 [00:01<00:01, 176.40it/s]replace nan value:  65%|██████▌   | 360/553 [00:02<00:01, 177.10it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:00, 177.31it/s]replace nan value:  72%|███████▏  | 396/553 [00:02<00:00, 177.14it/s]replace nan value:  75%|███████▍  | 414/553 [00:02<00:00, 177.08it/s]replace nan value:  78%|███████▊  | 432/553 [00:02<00:00, 176.49it/s]replace nan value:  82%|████████▏ | 451/553 [00:02<00:00, 177.58it/s]replace nan value:  85%|████████▍ | 469/553 [00:02<00:00, 175.68it/s]replace nan value:  88%|████████▊ | 487/553 [00:02<00:00, 175.57it/s]replace nan value:  91%|█████████▏| 505/553 [00:02<00:00, 176.23it/s]replace nan value:  95%|█████████▍| 523/553 [00:02<00:00, 176.11it/s]replace nan value:  98%|█████████▊| 541/553 [00:03<00:00, 175.70it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 175.93it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 104.43it/s]  4%|▍         | 24/553 [00:00<00:04, 115.27it/s]  7%|▋         | 37/553 [00:00<00:04, 120.00it/s]  9%|▉         | 50/553 [00:00<00:05, 100.11it/s] 11%|█         | 61/553 [00:00<00:05, 95.16it/s]  13%|█▎        | 72/553 [00:00<00:04, 98.43it/s] 15%|█▌        | 84/553 [00:00<00:04, 104.61it/s] 17%|█▋        | 96/553 [00:00<00:04, 107.80it/s] 20%|█▉        | 108/553 [00:01<00:04, 109.35it/s] 22%|██▏       | 122/553 [00:01<00:03, 112.39it/s] 24%|██▍       | 135/553 [00:01<00:03, 116.38it/s] 27%|██▋       | 150/553 [00:01<00:03, 124.47it/s] 30%|██▉       | 164/553 [00:01<00:03, 127.80it/s] 32%|███▏      | 178/553 [00:01<00:02, 127.48it/s] 35%|███▍      | 192/553 [00:01<00:02, 128.46it/s] 37%|███▋      | 207/553 [00:01<00:02, 134.27it/s] 40%|███▉      | 221/553 [00:01<00:02, 125.28it/s] 42%|████▏     | 234/553 [00:02<00:02, 124.39it/s] 45%|████▍     | 247/553 [00:02<00:02, 124.31it/s] 47%|████▋     | 260/553 [00:02<00:02, 124.23it/s] 49%|████▉     | 273/553 [00:02<00:02, 116.24it/s] 52%|█████▏    | 285/553 [00:02<00:02, 116.79it/s] 54%|█████▎    | 297/553 [00:02<00:02, 110.42it/s] 56%|█████▌    | 309/553 [00:02<00:02, 110.83it/s] 58%|█████▊    | 321/553 [00:02<00:02, 107.12it/s] 60%|██████    | 333/553 [00:02<00:02, 108.37it/s] 62%|██████▏   | 345/553 [00:03<00:01, 109.53it/s] 64%|██████▍   | 356/553 [00:03<00:01, 108.61it/s] 67%|██████▋   | 370/553 [00:03<00:01, 117.34it/s] 69%|██████▉   | 384/553 [00:03<00:01, 121.44it/s] 72%|███████▏  | 397/553 [00:03<00:01, 108.32it/s] 75%|███████▍  | 413/553 [00:03<00:01, 120.87it/s] 77%|███████▋  | 426/553 [00:03<00:01, 108.79it/s] 80%|███████▉  | 440/553 [00:03<00:00, 116.31it/s] 82%|████████▏ | 456/553 [00:03<00:00, 127.81it/s] 85%|████████▍ | 470/553 [00:04<00:00, 130.59it/s] 88%|████████▊ | 484/553 [00:04<00:00, 130.50it/s] 90%|█████████ | 498/553 [00:04<00:00, 120.23it/s] 93%|█████████▎| 513/553 [00:04<00:00, 125.94it/s] 95%|█████████▌| 526/553 [00:04<00:00, 114.06it/s] 97%|█████████▋| 538/553 [00:04<00:00, 111.92it/s]100%|█████████▉| 551/553 [00:04<00:00, 99.84it/s] 100%|██████████| 553/553 [00:04<00:00, 114.95it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  19%|█▊        | 26/139 [00:00<00:00, 256.31it/s]extract the null data:  61%|██████    | 85/139 [00:00<00:00, 447.82it/s]extract the null data:  99%|█████████▉| 138/139 [00:00<00:00, 483.24it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 454.68it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 186.98it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 189.41it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 189.20it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 188.51it/s]replace nan value:  70%|██████▉   | 97/139 [00:00<00:00, 189.37it/s]replace nan value:  84%|████████▍ | 117/139 [00:00<00:00, 189.81it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 188.84it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 189.03it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 107.87it/s] 17%|█▋        | 24/139 [00:00<00:00, 117.50it/s] 27%|██▋       | 38/139 [00:00<00:00, 123.95it/s] 37%|███▋      | 51/139 [00:00<00:00, 119.70it/s] 45%|████▌     | 63/139 [00:00<00:00, 119.68it/s] 54%|█████▍    | 75/139 [00:00<00:00, 119.59it/s] 63%|██████▎   | 87/139 [00:00<00:00, 109.71it/s] 71%|███████   | 99/139 [00:00<00:00, 109.94it/s] 80%|███████▉  | 111/139 [00:00<00:00, 111.25it/s] 90%|████████▉ | 125/139 [00:01<00:00, 119.09it/s] 99%|█████████▉| 138/139 [00:01<00:00, 120.35it/s]100%|██████████| 139/139 [00:01<00:00, 117.42it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 32/173 [00:00<00:00, 317.52it/s]extract the null data:  50%|█████     | 87/173 [00:00<00:00, 451.52it/s]extract the null data:  83%|████████▎ | 143/173 [00:00<00:00, 497.33it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 479.67it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 188.18it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 186.44it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 188.08it/s]replace nan value:  45%|████▍     | 77/173 [00:00<00:00, 188.41it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 185.14it/s]replace nan value:  66%|██████▋   | 115/173 [00:00<00:00, 186.56it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 186.37it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 186.22it/s]replace nan value:  99%|█████████▉| 172/173 [00:00<00:00, 183.30it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 185.42it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 128.54it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.71it/s] 23%|██▎       | 40/173 [00:00<00:01, 117.82it/s] 32%|███▏      | 55/173 [00:00<00:00, 126.85it/s] 39%|███▉      | 68/173 [00:00<00:00, 126.95it/s] 47%|████▋     | 81/173 [00:00<00:00, 126.46it/s] 55%|█████▍    | 95/173 [00:00<00:00, 126.72it/s] 63%|██████▎   | 109/173 [00:00<00:00, 128.71it/s] 71%|███████   | 122/173 [00:00<00:00, 125.11it/s] 78%|███████▊  | 135/173 [00:01<00:00, 120.31it/s] 86%|████████▌ | 148/173 [00:01<00:00, 119.59it/s] 92%|█████████▏| 160/173 [00:01<00:00, 109.52it/s] 99%|█████████▉| 172/173 [00:01<00:00, 81.55it/s] 100%|██████████| 173/173 [00:01<00:00, 109.16it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.230, valid loss : 0.081, train acc : 0.689, valid acc : 0.565, train f1 : 0.682, valid f1 : 0.476
training process:   1%|          | 1/128 [01:06<2:20:55, 66.58s/it]Best score increase :0.000 -> 0.476
training process:   2%|▏         | 2/128 [02:01<2:05:42, 59.86s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:54<1:58:04, 56.68s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:48<1:54:55, 55.61s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.084, valid loss : 0.100, train acc : 0.734, valid acc : 0.504, train f1 : 0.717, valid f1 : 0.438
training process:   4%|▍         | 5/128 [04:51<1:59:18, 58.20s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:43<1:54:15, 56.19s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [06:38<1:52:10, 55.63s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [07:33<1:51:11, 55.60s/it]Best score increase :0.476 -> 0.504
epoch : 9, train loss : 0.067, valid loss : 0.094, train acc : 0.772, valid acc : 0.569, train f1 : 0.760, valid f1 : 0.483
training process:   7%|▋         | 9/128 [08:40<1:57:17, 59.13s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:35<1:53:47, 57.86s/it]Best score increase :0.504 -> 0.524
training process:   9%|▊         | 11/128 [10:28<1:49:39, 56.23s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:22<1:47:30, 55.61s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.060, valid loss : 0.082, train acc : 0.801, valid acc : 0.644, train f1 : 0.794, valid f1 : 0.537
training process:  10%|█         | 13/128 [12:22<1:49:20, 57.05s/it]Best score increase :0.524 -> 0.537
training process:  11%|█         | 14/128 [13:09<1:42:36, 54.00s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [14:03<1:41:19, 53.80s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:53<1:38:50, 52.95s/it]Best score increase :0.537 -> 0.581
epoch : 17, train loss : 0.054, valid loss : 0.070, train acc : 0.822, valid acc : 0.727, train f1 : 0.818, valid f1 : 0.597
training process:  13%|█▎        | 17/128 [15:53<1:41:25, 54.83s/it]Best score increase :0.581 -> 0.597
training process:  14%|█▍        | 18/128 [16:42<1:37:35, 53.24s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [17:36<1:36:53, 53.33s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [18:27<1:34:39, 52.59s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.051, valid loss : 0.068, train acc : 0.839, valid acc : 0.757, train f1 : 0.836, valid f1 : 0.623
training process:  16%|█▋        | 21/128 [19:26<1:37:39, 54.76s/it]Best score increase :0.597 -> 0.623
training process:  17%|█▋        | 22/128 [20:13<1:32:21, 52.27s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [21:04<1:30:49, 51.90s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [21:55<1:29:17, 51.52s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.048, valid loss : 0.069, train acc : 0.853, valid acc : 0.745, train f1 : 0.850, valid f1 : 0.612
training process:  20%|█▉        | 25/128 [22:55<1:32:51, 54.09s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [23:41<1:28:13, 51.90s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [24:32<1:26:52, 51.61s/it]EarlyStopping counter : 6 out of 12
training process:  22%|██▏       | 28/128 [25:26<1:27:10, 52.30s/it]EarlyStopping counter : 7 out of 12
epoch : 29, train loss : 0.046, valid loss : 0.066, train acc : 0.860, valid acc : 0.779, train f1 : 0.858, valid f1 : 0.642
training process:  23%|██▎       | 29/128 [26:25<1:29:39, 54.33s/it]Best score increase :0.623 -> 0.642
training process:  23%|██▎       | 30/128 [27:18<1:27:58, 53.86s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [28:12<1:27:14, 53.97s/it]Best score increase :0.642 -> 0.671
training process:  25%|██▌       | 32/128 [29:05<1:25:55, 53.71s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.043, valid loss : 0.068, train acc : 0.873, valid acc : 0.769, train f1 : 0.871, valid f1 : 0.632
training process:  26%|██▌       | 33/128 [30:05<1:28:01, 55.60s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [31:00<1:26:37, 55.29s/it]Best score increase :0.671 -> 0.673
training process:  27%|██▋       | 35/128 [31:55<1:25:35, 55.22s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [32:48<1:23:29, 54.45s/it]Best score increase :0.673 -> 0.718
epoch : 37, train loss : 0.040, valid loss : 0.063, train acc : 0.881, valid acc : 0.790, train f1 : 0.880, valid f1 : 0.652
training process:  29%|██▉       | 37/128 [33:52<1:26:53, 57.29s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [34:47<1:25:00, 56.67s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [35:40<1:22:26, 55.58s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [36:33<1:20:22, 54.80s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.040, valid loss : 0.064, train acc : 0.889, valid acc : 0.790, train f1 : 0.888, valid f1 : 0.651
training process:  32%|███▏      | 41/128 [37:37<1:23:33, 57.63s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [38:33<1:21:57, 57.18s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [39:27<1:19:41, 56.25s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [40:21<1:17:31, 55.38s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.037, valid loss : 0.068, train acc : 0.892, valid acc : 0.782, train f1 : 0.891, valid f1 : 0.644
training process:  35%|███▌      | 45/128 [41:26<1:20:47, 58.40s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [42:20<1:17:56, 57.03s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [43:13<1:15:09, 55.68s/it]EarlyStopping counter : 11 out of 12
training process:  37%|███▋      | 47/128 [44:07<1:16:02, 56.33s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.718
training process finished, best loss : 0.055 and best acc : 0.856, best f1 : 0.718, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.34      0.93      0.50       580
           1       0.99      0.85      0.92      6818

    accuracy                           0.86      7398
   macro avg       0.67      0.89      0.71      7398
weighted avg       0.94      0.86      0.88      7398


# test acc : 0.86, test f1 : 0.71, test AUC : 0.89, test loss : 2.970

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:08<01:29,  8.15s/it]processing for feature importance:  17%|█▋        | 2/12 [00:17<01:25,  8.56s/it]processing for feature importance:  25%|██▌       | 3/12 [00:25<01:15,  8.38s/it]processing for feature importance:  33%|███▎      | 4/12 [00:34<01:09,  8.65s/it]processing for feature importance:  42%|████▏     | 5/12 [00:42<01:00,  8.61s/it]processing for feature importance:  50%|█████     | 6/12 [00:51<00:51,  8.61s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:59<00:42,  8.56s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:08<00:34,  8.59s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:17<00:25,  8.60s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:25<00:16,  8.48s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:33<00:08,  8.40s/it]processing for feature importance: 100%|██████████| 12/12 [01:41<00:00,  8.35s/it]processing for feature importance: 100%|██████████| 12/12 [01:41<00:00,  8.48s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 20/306 [00:00<00:01, 196.64it/s] 13%|█▎        | 40/306 [00:00<00:01, 178.20it/s] 19%|█▉        | 58/306 [00:00<00:01, 174.14it/s] 25%|██▍       | 76/306 [00:00<00:01, 148.63it/s] 31%|███       | 95/306 [00:00<00:01, 155.91it/s] 37%|███▋      | 112/306 [00:00<00:01, 155.76it/s] 42%|████▏     | 128/306 [00:00<00:01, 147.36it/s] 47%|████▋     | 145/306 [00:00<00:01, 153.07it/s] 53%|█████▎    | 163/306 [00:01<00:00, 156.87it/s] 58%|█████▊    | 179/306 [00:01<00:00, 147.65it/s] 64%|██████▍   | 197/306 [00:01<00:00, 154.55it/s] 70%|██████▉   | 214/306 [00:01<00:00, 156.83it/s] 75%|███████▌  | 230/306 [00:01<00:00, 144.21it/s] 81%|████████  | 248/306 [00:01<00:00, 150.31it/s] 87%|████████▋ | 265/306 [00:01<00:00, 155.13it/s] 92%|█████████▏| 281/306 [00:01<00:00, 143.91it/s] 97%|█████████▋| 298/306 [00:01<00:00, 149.90it/s]100%|██████████| 306/306 [00:01<00:00, 153.88it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 46/553 [00:00<00:01, 451.90it/s]extract the null data:  17%|█▋        | 92/553 [00:00<00:01, 443.70it/s]extract the null data:  25%|██▍       | 137/553 [00:00<00:00, 440.37it/s]extract the null data:  33%|███▎      | 182/553 [00:00<00:00, 436.34it/s]extract the null data:  41%|████      | 228/553 [00:00<00:00, 442.79it/s]extract the null data:  50%|█████     | 278/553 [00:00<00:00, 459.43it/s]extract the null data:  59%|█████▊    | 324/553 [00:00<00:00, 457.52it/s]extract the null data:  67%|██████▋   | 370/553 [00:00<00:00, 454.98it/s]extract the null data:  75%|███████▌  | 416/553 [00:00<00:00, 449.22it/s]extract the null data:  83%|████████▎ | 461/553 [00:01<00:00, 449.08it/s]extract the null data:  92%|█████████▏| 507/553 [00:01<00:00, 451.65it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 450.70it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 449.59it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 17/553 [00:00<00:03, 162.57it/s]replace nan value:   6%|▌         | 34/553 [00:00<00:03, 164.06it/s]replace nan value:   9%|▉         | 51/553 [00:00<00:03, 163.21it/s]replace nan value:  12%|█▏        | 68/553 [00:00<00:02, 164.45it/s]replace nan value:  15%|█▌        | 85/553 [00:00<00:02, 165.45it/s]replace nan value:  18%|█▊        | 102/553 [00:00<00:02, 164.50it/s]replace nan value:  22%|██▏       | 119/553 [00:00<00:02, 165.22it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:02, 165.87it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:02, 166.31it/s]replace nan value:  31%|███       | 170/553 [00:01<00:02, 166.38it/s]replace nan value:  34%|███▍      | 188/553 [00:01<00:02, 167.46it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:02, 167.22it/s]replace nan value:  40%|████      | 222/553 [00:01<00:01, 166.68it/s]replace nan value:  43%|████▎     | 239/553 [00:01<00:01, 166.57it/s]replace nan value:  46%|████▋     | 256/553 [00:01<00:01, 163.84it/s]replace nan value:  49%|████▉     | 273/553 [00:01<00:01, 164.57it/s]replace nan value:  52%|█████▏    | 290/553 [00:01<00:01, 165.45it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 165.72it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 165.61it/s]replace nan value:  62%|██████▏   | 341/553 [00:02<00:01, 166.11it/s]replace nan value:  65%|██████▍   | 359/553 [00:02<00:01, 167.29it/s]replace nan value:  68%|██████▊   | 377/553 [00:02<00:01, 169.63it/s]replace nan value:  71%|███████   | 394/553 [00:02<00:00, 168.90it/s]replace nan value:  74%|███████▍  | 411/553 [00:02<00:00, 167.94it/s]replace nan value:  77%|███████▋  | 428/553 [00:02<00:00, 165.80it/s]replace nan value:  80%|████████  | 445/553 [00:02<00:00, 166.26it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 165.97it/s]replace nan value:  87%|████████▋ | 479/553 [00:02<00:00, 164.81it/s]replace nan value:  90%|████████▉ | 496/553 [00:02<00:00, 165.62it/s]replace nan value:  93%|█████████▎| 513/553 [00:03<00:00, 165.59it/s]replace nan value:  96%|█████████▌| 530/553 [00:03<00:00, 164.03it/s]replace nan value:  99%|█████████▉| 548/553 [00:03<00:00, 166.62it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 165.87it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 124.42it/s]  5%|▍         | 27/553 [00:00<00:04, 131.43it/s]  7%|▋         | 41/553 [00:00<00:03, 129.56it/s] 10%|▉         | 54/553 [00:00<00:04, 118.37it/s] 12%|█▏        | 66/553 [00:00<00:04, 109.94it/s] 14%|█▍        | 80/553 [00:00<00:04, 114.71it/s] 17%|█▋        | 93/553 [00:00<00:03, 118.46it/s] 19%|█▉        | 107/553 [00:00<00:03, 124.05it/s] 22%|██▏       | 122/553 [00:00<00:03, 126.95it/s] 25%|██▍       | 137/553 [00:01<00:03, 132.59it/s] 28%|██▊       | 153/553 [00:01<00:02, 139.39it/s] 31%|███       | 170/553 [00:01<00:02, 146.72it/s] 33%|███▎      | 185/553 [00:01<00:02, 140.97it/s] 36%|███▋      | 201/553 [00:01<00:02, 146.19it/s] 39%|███▉      | 216/553 [00:01<00:02, 144.82it/s] 42%|████▏     | 231/553 [00:01<00:02, 134.81it/s] 44%|████▍     | 245/553 [00:01<00:02, 132.90it/s] 47%|████▋     | 260/553 [00:01<00:02, 136.24it/s] 50%|████▉     | 274/553 [00:02<00:02, 130.37it/s] 52%|█████▏    | 288/553 [00:02<00:01, 132.62it/s] 55%|█████▍    | 302/553 [00:02<00:01, 126.38it/s] 57%|█████▋    | 315/553 [00:02<00:01, 121.08it/s] 59%|█████▉    | 328/553 [00:02<00:01, 121.52it/s] 62%|██████▏   | 343/553 [00:02<00:01, 128.82it/s] 64%|██████▍   | 356/553 [00:02<00:01, 123.87it/s] 67%|██████▋   | 371/553 [00:02<00:01, 130.38it/s] 70%|██████▉   | 385/553 [00:02<00:01, 125.60it/s] 72%|███████▏  | 398/553 [00:03<00:01, 114.51it/s] 75%|███████▍  | 414/553 [00:03<00:01, 121.78it/s] 77%|███████▋  | 427/553 [00:03<00:01, 111.75it/s] 80%|████████  | 443/553 [00:03<00:00, 123.15it/s] 83%|████████▎ | 458/553 [00:03<00:00, 129.96it/s] 86%|████████▌ | 473/553 [00:03<00:00, 134.10it/s] 88%|████████▊ | 487/553 [00:03<00:00, 129.30it/s] 91%|█████████ | 501/553 [00:03<00:00, 121.48it/s] 93%|█████████▎| 516/553 [00:04<00:00, 128.24it/s] 96%|█████████▌| 530/553 [00:04<00:00, 110.07it/s] 98%|█████████▊| 544/553 [00:04<00:00, 117.12it/s]100%|██████████| 553/553 [00:04<00:00, 124.50it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 32/139 [00:00<00:00, 316.13it/s]extract the null data:  63%|██████▎   | 88/139 [00:00<00:00, 454.91it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 468.17it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 192.39it/s]replace nan value:  29%|██▉       | 40/139 [00:00<00:00, 192.64it/s]replace nan value:  43%|████▎     | 60/139 [00:00<00:00, 193.78it/s]replace nan value:  58%|█████▊    | 80/139 [00:00<00:00, 194.48it/s]replace nan value:  72%|███████▏  | 100/139 [00:00<00:00, 193.44it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 192.55it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 192.00it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  8%|▊         | 11/139 [00:00<00:01, 109.09it/s] 17%|█▋        | 23/139 [00:00<00:01, 114.33it/s] 28%|██▊       | 39/139 [00:00<00:00, 134.62it/s] 38%|███▊      | 53/139 [00:00<00:00, 132.26it/s] 48%|████▊     | 67/139 [00:00<00:00, 134.68it/s] 58%|█████▊    | 81/139 [00:00<00:00, 134.93it/s] 68%|██████▊   | 95/139 [00:00<00:00, 125.42it/s] 78%|███████▊  | 108/139 [00:00<00:00, 125.92it/s] 90%|████████▉ | 125/139 [00:00<00:00, 136.33it/s]100%|██████████| 139/139 [00:01<00:00, 132.09it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 258.64it/s]extract the null data:  47%|████▋     | 82/173 [00:00<00:00, 434.67it/s]extract the null data:  81%|████████  | 140/173 [00:00<00:00, 499.54it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 473.56it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  11%|█         | 19/173 [00:00<00:00, 188.04it/s]replace nan value:  22%|██▏       | 38/173 [00:00<00:00, 185.70it/s]replace nan value:  34%|███▎      | 58/173 [00:00<00:00, 188.79it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 189.39it/s]replace nan value:  56%|█████▌    | 97/173 [00:00<00:00, 188.80it/s]replace nan value:  67%|██████▋   | 116/173 [00:00<00:00, 187.31it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 187.11it/s]replace nan value:  89%|████████▉ | 154/173 [00:00<00:00, 184.38it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 178.41it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 184.04it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 13/173 [00:00<00:01, 128.69it/s] 15%|█▌        | 26/173 [00:00<00:01, 105.29it/s] 23%|██▎       | 39/173 [00:00<00:01, 114.54it/s] 31%|███       | 54/173 [00:00<00:00, 124.88it/s] 39%|███▊      | 67/173 [00:00<00:00, 124.88it/s] 46%|████▌     | 80/173 [00:00<00:00, 123.89it/s] 54%|█████▍    | 94/173 [00:00<00:00, 125.70it/s] 62%|██████▏   | 107/173 [00:00<00:00, 124.45it/s] 69%|██████▉   | 120/173 [00:00<00:00, 123.86it/s] 77%|███████▋  | 133/173 [00:01<00:00, 117.54it/s] 84%|████████▍ | 146/173 [00:01<00:00, 117.73it/s] 91%|█████████▏| 158/173 [00:01<00:00, 109.03it/s] 98%|█████████▊| 170/173 [00:01<00:00, 89.19it/s] 100%|██████████| 173/173 [00:01<00:00, 107.83it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.541, valid loss : 0.358, train f1 : 0.593, valid f1 : 0.667
training process - Deferred Re-weighting:   1%|          | 1/128 [01:04<2:16:36, 64.54s/it]Best score increase :0.000 -> 0.667
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:57<2:00:37, 57.44s/it]Best score increase :0.667 -> 0.673
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:48<1:54:02, 54.74s/it]Best score increase :0.673 -> 0.703
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:42<1:52:17, 54.34s/it]Best score increase :0.703 -> 0.735
epoch : 5, train loss : 0.187, valid loss : 0.162, train f1 : 0.785, valid f1 : 0.760
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:46<1:58:39, 57.88s/it]Best score increase :0.735 -> 0.760
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:40<1:55:12, 56.66s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:34<1:52:22, 55.73s/it]Best score increase :0.760 -> 0.777
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:28<1:50:07, 55.06s/it]Best score increase :0.777 -> 0.782
epoch : 9, train loss : 0.139, valid loss : 0.153, train f1 : 0.832, valid f1 : 0.788
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:28<1:52:35, 56.77s/it]Best score increase :0.782 -> 0.788
training process - Deferred Re-weighting:   8%|▊         | 10/128 [09:18<1:47:22, 54.60s/it]Best score increase :0.788 -> 0.796
training process - Deferred Re-weighting:   9%|▊         | 11/128 [10:10<1:45:10, 53.93s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [11:02<1:43:03, 53.31s/it]Best score increase :0.796 -> 0.798
epoch : 13, train loss : 0.125, valid loss : 0.161, train f1 : 0.840, valid f1 : 0.799
training process - Deferred Re-weighting:  10%|█         | 13/128 [12:03<1:46:41, 55.67s/it]Best score increase :0.798 -> 0.799
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:55<1:43:33, 54.51s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:46<1:40:32, 53.39s/it]Best score increase :0.799 -> 0.820
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:37<1:38:37, 52.84s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.115, valid loss : 0.155, train f1 : 0.854, valid f1 : 0.810
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:38<1:42:13, 55.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:31<1:39:54, 54.49s/it]Best score increase :0.820 -> 0.822
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:22<1:37:10, 53.49s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [18:15<1:35:49, 53.24s/it]Best score increase :0.822 -> 0.831
epoch : 21, train loss : 0.106, valid loss : 0.167, train f1 : 0.864, valid f1 : 0.813
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:14<1:37:51, 54.87s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [20:06<1:35:33, 54.09s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:59<1:34:14, 53.85s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:57<1:35:19, 54.99s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.101, valid loss : 0.152, train f1 : 0.875, valid f1 : 0.837
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [23:05<1:41:08, 58.92s/it]Best score increase :0.831 -> 0.837
training process - Deferred Re-weighting:  20%|██        | 26/128 [24:03<1:39:59, 58.82s/it]Best score increase :0.837 -> 0.838
training process - Deferred Re-weighting:  21%|██        | 27/128 [25:03<1:39:14, 58.96s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:58<1:36:15, 57.76s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.096, valid loss : 0.156, train f1 : 0.879, valid f1 : 0.838
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [27:06<1:40:25, 60.87s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [28:04<1:38:08, 60.09s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [29:02<1:36:09, 59.47s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [29:58<1:33:29, 58.44s/it]Best score increase :0.838 -> 0.846
epoch : 33, train loss : 0.090, valid loss : 0.156, train f1 : 0.890, valid f1 : 0.841
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [31:00<1:34:03, 59.40s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [31:50<1:28:57, 56.78s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [32:45<1:27:00, 56.13s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [33:35<1:23:14, 54.28s/it]Best score increase :0.846 -> 0.866
epoch : 37, train loss : 0.088, valid loss : 0.188, train f1 : 0.891, valid f1 : 0.829
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [34:34<1:24:13, 55.54s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [35:24<1:21:00, 54.01s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [36:15<1:18:36, 53.00s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [37:06<1:17:04, 52.55s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.084, valid loss : 0.176, train f1 : 0.893, valid f1 : 0.839
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [38:06<1:19:26, 54.78s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [38:56<1:16:22, 53.29s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [39:48<1:15:09, 53.05s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [40:40<1:13:39, 52.61s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.082, valid loss : 0.161, train f1 : 0.901, valid f1 : 0.853
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [41:40<1:15:52, 54.85s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [42:28<1:12:18, 52.91s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [43:17<1:09:48, 51.70s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [44:08<1:16:04, 56.35s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.866
training process finished, best loss : 0.140, best acc : 0.965, best f1 : 0.866, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.63      0.76       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.96      0.81      0.87      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.81, test loss : 8.655

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.43s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.47s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.46s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:00,  7.59s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:53,  7.67s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.53s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.50s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.62s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.64s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:15,  7.61s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.95s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.84s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.67s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 206.42it/s] 14%|█▍        | 43/306 [00:00<00:01, 209.92it/s] 22%|██▏       | 66/306 [00:00<00:01, 215.73it/s] 29%|██▉       | 88/306 [00:00<00:01, 216.75it/s] 36%|███▋      | 111/306 [00:00<00:00, 218.08it/s] 44%|████▍     | 135/306 [00:00<00:00, 222.63it/s] 52%|█████▏    | 158/306 [00:00<00:00, 223.45it/s] 59%|█████▉    | 181/306 [00:00<00:00, 225.37it/s] 67%|██████▋   | 205/306 [00:00<00:00, 227.11it/s] 75%|███████▍  | 229/306 [00:01<00:00, 228.89it/s] 82%|████████▏ | 252/306 [00:01<00:00, 214.30it/s] 90%|████████▉ | 275/306 [00:01<00:00, 218.69it/s] 98%|█████████▊| 299/306 [00:01<00:00, 223.46it/s]100%|██████████| 306/306 [00:01<00:00, 221.27it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_CE_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 54/553 [00:00<00:00, 532.39it/s]extract the null data:  20%|██        | 112/553 [00:00<00:00, 557.47it/s]extract the null data:  30%|███       | 168/553 [00:00<00:00, 557.52it/s]extract the null data:  42%|████▏     | 232/553 [00:00<00:00, 588.24it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 584.49it/s]extract the null data:  63%|██████▎   | 350/553 [00:00<00:00, 582.22it/s]extract the null data:  74%|███████▍  | 409/553 [00:00<00:00, 567.94it/s]extract the null data:  84%|████████▍ | 466/553 [00:00<00:00, 561.25it/s]extract the null data:  95%|█████████▍| 523/553 [00:00<00:00, 544.39it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 556.18it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 18/553 [00:00<00:03, 176.63it/s]replace nan value:   7%|▋         | 36/553 [00:00<00:02, 177.36it/s]replace nan value:  10%|▉         | 55/553 [00:00<00:02, 179.96it/s]replace nan value:  13%|█▎        | 74/553 [00:00<00:02, 180.35it/s]replace nan value:  17%|█▋        | 93/553 [00:00<00:02, 181.08it/s]replace nan value:  20%|██        | 112/553 [00:00<00:02, 183.38it/s]replace nan value:  24%|██▎       | 131/553 [00:00<00:02, 181.70it/s]replace nan value:  27%|██▋       | 150/553 [00:00<00:02, 182.14it/s]replace nan value:  31%|███       | 169/553 [00:00<00:02, 179.05it/s]replace nan value:  34%|███▍      | 187/553 [00:01<00:02, 178.46it/s]replace nan value:  37%|███▋      | 205/553 [00:01<00:02, 158.98it/s]replace nan value:  40%|████      | 222/553 [00:01<00:02, 147.17it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 156.49it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 163.53it/s]replace nan value:  50%|█████     | 279/553 [00:01<00:01, 170.72it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 172.55it/s]replace nan value:  57%|█████▋    | 317/553 [00:01<00:01, 178.41it/s]replace nan value:  61%|██████    | 336/553 [00:01<00:01, 179.19it/s]replace nan value:  65%|██████▍   | 357/553 [00:02<00:01, 186.34it/s]replace nan value:  68%|██████▊   | 378/553 [00:02<00:00, 191.37it/s]replace nan value:  72%|███████▏  | 398/553 [00:02<00:00, 189.90it/s]replace nan value:  76%|███████▌  | 418/553 [00:02<00:00, 180.81it/s]replace nan value:  79%|███████▉  | 437/553 [00:02<00:00, 181.76it/s]replace nan value:  83%|████████▎ | 458/553 [00:02<00:00, 189.60it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 190.22it/s]replace nan value:  90%|█████████ | 498/553 [00:02<00:00, 187.63it/s]replace nan value:  93%|█████████▎| 517/553 [00:02<00:00, 183.89it/s]replace nan value:  97%|█████████▋| 536/553 [00:03<00:00, 184.58it/s]replace nan value: 100%|██████████| 553/553 [00:03<00:00, 178.94it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 13/553 [00:00<00:04, 129.71it/s]  5%|▌         | 28/553 [00:00<00:03, 140.42it/s]  8%|▊         | 43/553 [00:00<00:04, 127.48it/s] 10%|█         | 56/553 [00:00<00:04, 123.84it/s] 12%|█▏        | 69/553 [00:00<00:04, 113.36it/s] 15%|█▌        | 84/553 [00:00<00:03, 123.29it/s] 18%|█▊        | 97/553 [00:00<00:03, 124.15it/s] 20%|██        | 112/553 [00:00<00:03, 131.60it/s] 23%|██▎       | 126/553 [00:00<00:03, 129.20it/s] 26%|██▌       | 144/553 [00:01<00:02, 142.52it/s] 29%|██▉       | 162/553 [00:01<00:02, 151.51it/s] 32%|███▏      | 178/553 [00:01<00:02, 151.55it/s] 35%|███▌      | 194/553 [00:01<00:02, 153.12it/s] 38%|███▊      | 211/553 [00:01<00:02, 155.65it/s] 41%|████      | 227/553 [00:01<00:02, 147.45it/s] 44%|████▍     | 242/553 [00:01<00:02, 145.10it/s] 46%|████▋     | 257/553 [00:01<00:02, 139.67it/s] 49%|████▉     | 272/553 [00:01<00:02, 136.42it/s] 52%|█████▏    | 288/553 [00:02<00:01, 141.84it/s] 55%|█████▍    | 303/553 [00:02<00:01, 134.50it/s] 57%|█████▋    | 317/553 [00:02<00:01, 126.13it/s] 60%|█████▉    | 331/553 [00:02<00:01, 128.58it/s] 62%|██████▏   | 345/553 [00:02<00:01, 129.43it/s] 65%|██████▍   | 359/553 [00:02<00:01, 125.30it/s] 68%|██████▊   | 376/553 [00:02<00:01, 132.77it/s] 71%|███████   | 390/553 [00:02<00:01, 122.12it/s] 73%|███████▎  | 403/553 [00:03<00:01, 122.80it/s] 75%|███████▌  | 416/553 [00:03<00:01, 123.10it/s] 78%|███████▊  | 429/553 [00:03<00:01, 117.80it/s] 81%|████████  | 447/553 [00:03<00:00, 133.90it/s] 84%|████████▎ | 462/553 [00:03<00:00, 137.32it/s] 86%|████████▋ | 477/553 [00:03<00:00, 138.19it/s] 89%|████████▉ | 491/553 [00:03<00:00, 127.01it/s] 91%|█████████ | 504/553 [00:03<00:00, 125.63it/s] 94%|█████████▎| 518/553 [00:03<00:00, 126.39it/s] 96%|█████████▌| 531/553 [00:04<00:00, 101.87it/s] 99%|█████████▊| 545/553 [00:04<00:00, 110.84it/s]100%|██████████| 553/553 [00:04<00:00, 127.69it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 23/139 [00:00<00:00, 229.32it/s]extract the null data:  41%|████      | 57/139 [00:00<00:00, 270.47it/s]extract the null data:  63%|██████▎   | 87/139 [00:00<00:00, 282.65it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 342.39it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 20/139 [00:00<00:00, 189.76it/s]replace nan value:  28%|██▊       | 39/139 [00:00<00:00, 186.57it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 177.31it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 178.00it/s]replace nan value:  68%|██████▊   | 94/139 [00:00<00:00, 176.56it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 175.43it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 169.91it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 174.67it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 128.37it/s] 19%|█▉        | 27/139 [00:00<00:00, 130.12it/s] 32%|███▏      | 44/139 [00:00<00:00, 142.71it/s] 42%|████▏     | 59/139 [00:00<00:00, 117.53it/s] 53%|█████▎    | 74/139 [00:00<00:00, 124.12it/s] 63%|██████▎   | 87/139 [00:00<00:00, 118.42it/s] 73%|███████▎  | 101/139 [00:00<00:00, 124.43it/s] 83%|████████▎ | 115/139 [00:00<00:00, 128.50it/s] 93%|█████████▎| 129/139 [00:01<00:00, 130.06it/s]100%|██████████| 139/139 [00:01<00:00, 128.65it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 29/173 [00:00<00:00, 285.49it/s]extract the null data:  53%|█████▎    | 92/173 [00:00<00:00, 482.69it/s]extract the null data:  88%|████████▊ | 152/173 [00:00<00:00, 523.93it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 493.39it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 196.73it/s]replace nan value:  23%|██▎       | 40/173 [00:00<00:00, 196.61it/s]replace nan value:  35%|███▍      | 60/173 [00:00<00:00, 196.51it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 200.04it/s]replace nan value:  59%|█████▉    | 102/173 [00:00<00:00, 194.98it/s]replace nan value:  71%|███████   | 122/173 [00:00<00:00, 196.18it/s]replace nan value:  83%|████████▎ | 143/173 [00:00<00:00, 198.12it/s]replace nan value:  94%|█████████▍| 163/173 [00:00<00:00, 198.07it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 196.58it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 124.61it/s] 16%|█▌        | 28/173 [00:00<00:01, 111.40it/s] 25%|██▌       | 44/173 [00:00<00:00, 130.75it/s] 35%|███▌      | 61/173 [00:00<00:00, 141.80it/s] 44%|████▍     | 76/173 [00:00<00:00, 143.71it/s] 53%|█████▎    | 92/173 [00:00<00:00, 144.12it/s] 62%|██████▏   | 107/173 [00:00<00:00, 143.11it/s] 71%|███████   | 122/173 [00:00<00:00, 142.72it/s] 79%|███████▉  | 137/173 [00:00<00:00, 141.03it/s] 88%|████████▊ | 152/173 [00:01<00:00, 127.30it/s] 95%|█████████▌| 165/173 [00:01<00:00, 117.24it/s]100%|██████████| 173/173 [00:01<00:00, 120.86it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.549, valid loss : 0.393, train f1 : 0.714, valid f1 : 0.668
training process - Deferred Re-weighting:   1%|          | 1/128 [01:04<2:16:21, 64.42s/it]Best score increase :0.000 -> 0.668
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:56<2:00:13, 57.25s/it]Best score increase :0.668 -> 0.709
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:48<1:54:00, 54.72s/it]Best score increase :0.709 -> 0.756
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:39<1:49:59, 53.22s/it]Best score increase :0.756 -> 0.773
epoch : 5, train loss : 0.343, valid loss : 0.238, train f1 : 0.842, valid f1 : 0.787
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:36<1:51:47, 54.53s/it]Best score increase :0.773 -> 0.787
training process - Deferred Re-weighting:   5%|▍         | 6/128 [05:28<1:49:05, 53.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [06:17<1:45:30, 52.32s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [07:08<1:43:55, 51.96s/it]Best score increase :0.787 -> 0.792
epoch : 9, train loss : 0.286, valid loss : 0.217, train f1 : 0.876, valid f1 : 0.808
training process - Deferred Re-weighting:   7%|▋         | 9/128 [08:08<1:47:34, 54.24s/it]Best score increase :0.792 -> 0.808
training process - Deferred Re-weighting:   8%|▊         | 10/128 [08:54<1:41:44, 51.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [09:44<1:40:16, 51.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [10:39<1:41:08, 52.31s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.255, valid loss : 0.212, train f1 : 0.889, valid f1 : 0.819
training process - Deferred Re-weighting:  10%|█         | 13/128 [11:40<1:45:19, 54.95s/it]Best score increase :0.808 -> 0.819
training process - Deferred Re-weighting:  11%|█         | 14/128 [12:32<1:42:45, 54.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [13:25<1:41:26, 53.86s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [14:20<1:41:04, 54.15s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.228, valid loss : 0.184, train f1 : 0.905, valid f1 : 0.836
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [15:21<1:43:45, 56.09s/it]Best score increase :0.819 -> 0.836
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [16:13<1:40:49, 55.00s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [17:05<1:37:56, 53.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [17:59<1:37:15, 54.03s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.212, valid loss : 0.176, train f1 : 0.913, valid f1 : 0.836
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [19:01<1:40:47, 56.52s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [19:54<1:37:56, 55.44s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [20:47<1:35:30, 54.57s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [21:41<1:34:20, 54.43s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.197, valid loss : 0.168, train f1 : 0.918, valid f1 : 0.836
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [22:42<1:36:57, 56.48s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [23:35<1:34:05, 55.35s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [24:26<1:31:22, 54.29s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [25:20<1:29:56, 53.97s/it]Best score increase :0.836 -> 0.846
epoch : 29, train loss : 0.180, valid loss : 0.155, train f1 : 0.928, valid f1 : 0.844
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [26:23<1:33:39, 56.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [27:16<1:30:41, 55.53s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [28:07<1:27:48, 54.32s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [28:58<1:25:28, 53.42s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.168, valid loss : 0.166, train f1 : 0.932, valid f1 : 0.834
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [29:59<1:28:03, 55.62s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [30:51<1:25:16, 54.43s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [31:38<1:21:09, 52.36s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [32:30<1:19:42, 51.98s/it]Best score increase :0.846 -> 0.855
epoch : 37, train loss : 0.154, valid loss : 0.143, train f1 : 0.939, valid f1 : 0.849
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [33:25<1:20:29, 53.07s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [34:16<1:18:47, 52.52s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [35:05<1:16:19, 51.46s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [35:53<1:13:50, 50.34s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.150, valid loss : 0.165, train f1 : 0.940, valid f1 : 0.827
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [36:54<1:17:27, 53.41s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [37:45<1:15:47, 52.87s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [38:34<1:13:09, 51.65s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [39:23<1:11:02, 50.74s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.140, valid loss : 0.181, train f1 : 0.944, valid f1 : 0.825
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [40:20<1:12:58, 52.75s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [41:10<1:10:57, 51.92s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [41:58<1:08:28, 50.72s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [42:48<1:13:46, 54.65s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.855
training process finished, best loss : 0.127, best acc : 0.954, best f1 : 0.855, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.74      0.75      0.75       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.86      0.86      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.86, test loss : 7.408

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:17,  7.05s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:10,  7.09s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:05,  7.22s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:58,  7.32s/it]processing for feature importance:  42%|████▏     | 5/12 [00:36<00:51,  7.40s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:45,  7.55s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:38,  7.65s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:30,  7.64s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:15,  7.51s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.62s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.62s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.51s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  4%|▎         | 11/306 [00:00<00:02, 106.80it/s] 11%|█         | 33/306 [00:00<00:01, 168.07it/s] 17%|█▋        | 51/306 [00:00<00:01, 168.32it/s] 23%|██▎       | 69/306 [00:00<00:01, 172.03it/s] 28%|██▊       | 87/306 [00:00<00:01, 142.06it/s] 34%|███▍      | 104/306 [00:00<00:01, 148.22it/s] 39%|███▉      | 120/306 [00:00<00:01, 144.71it/s] 44%|████▍     | 135/306 [00:00<00:01, 137.08it/s] 49%|████▉     | 151/306 [00:01<00:01, 140.46it/s] 55%|█████▍    | 167/306 [00:01<00:00, 142.57it/s] 59%|█████▉    | 182/306 [00:01<00:00, 136.47it/s] 65%|██████▍   | 198/306 [00:01<00:00, 142.41it/s] 70%|███████   | 215/306 [00:01<00:00, 146.75it/s] 75%|███████▌  | 230/306 [00:01<00:00, 135.94it/s] 80%|████████  | 246/306 [00:01<00:00, 141.33it/s] 85%|████████▌ | 261/306 [00:01<00:00, 142.22it/s] 90%|█████████ | 276/306 [00:01<00:00, 135.07it/s] 96%|█████████▌| 293/306 [00:02<00:00, 140.97it/s]100%|██████████| 306/306 [00:02<00:00, 144.51it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:   8%|▊         | 45/553 [00:00<00:01, 449.03it/s]extract the null data:  16%|█▋        | 91/553 [00:00<00:01, 455.14it/s]extract the null data:  25%|██▍       | 138/553 [00:00<00:00, 459.66it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:00, 455.15it/s]extract the null data:  42%|████▏     | 231/553 [00:00<00:00, 456.99it/s]extract the null data:  51%|█████     | 281/553 [00:00<00:00, 468.23it/s]extract the null data:  59%|█████▉    | 328/553 [00:00<00:00, 462.30it/s]extract the null data:  68%|██████▊   | 375/553 [00:00<00:00, 461.78it/s]extract the null data:  76%|███████▋  | 422/553 [00:00<00:00, 457.63it/s]extract the null data:  85%|████████▍ | 469/553 [00:01<00:00, 459.46it/s]extract the null data:  93%|█████████▎| 516/553 [00:01<00:00, 461.45it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 461.63it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 196.94it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 208.40it/s]replace nan value:  12%|█▏        | 65/553 [00:00<00:02, 215.55it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 218.28it/s]replace nan value:  20%|██        | 112/553 [00:00<00:01, 224.89it/s]replace nan value:  25%|██▍       | 136/553 [00:00<00:01, 226.90it/s]replace nan value:  29%|██▉       | 159/553 [00:00<00:01, 224.87it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 224.76it/s]replace nan value:  37%|███▋      | 205/553 [00:00<00:01, 222.31it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 214.59it/s]replace nan value:  45%|████▌     | 250/553 [00:01<00:01, 214.01it/s]replace nan value:  49%|████▉     | 272/553 [00:01<00:01, 207.58it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 209.18it/s]replace nan value:  57%|█████▋    | 317/553 [00:01<00:01, 212.31it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 208.11it/s]replace nan value:  65%|██████▌   | 360/553 [00:01<00:00, 205.31it/s]replace nan value:  69%|██████▉   | 381/553 [00:01<00:00, 202.63it/s]replace nan value:  73%|███████▎  | 402/553 [00:01<00:00, 198.42it/s]replace nan value:  76%|███████▋  | 422/553 [00:02<00:00, 195.88it/s]replace nan value:  80%|███████▉  | 442/553 [00:02<00:00, 197.04it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 196.17it/s]replace nan value:  87%|████████▋ | 482/553 [00:02<00:00, 197.15it/s]replace nan value:  91%|█████████ | 504/553 [00:02<00:00, 201.17it/s]replace nan value:  95%|█████████▍| 525/553 [00:02<00:00, 202.95it/s]replace nan value:  99%|█████████▊| 546/553 [00:02<00:00, 202.07it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 208.08it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:04, 109.81it/s]  5%|▍         | 25/553 [00:00<00:04, 123.14it/s]  7%|▋         | 39/553 [00:00<00:04, 127.07it/s]  9%|▉         | 52/553 [00:00<00:04, 116.89it/s] 12%|█▏        | 64/553 [00:00<00:04, 110.50it/s] 14%|█▍        | 77/553 [00:00<00:04, 115.12it/s] 16%|█▋        | 90/553 [00:00<00:03, 119.20it/s] 19%|█▊        | 103/553 [00:00<00:03, 117.15it/s] 22%|██▏       | 120/553 [00:00<00:03, 131.70it/s] 24%|██▍       | 134/553 [00:01<00:03, 133.38it/s] 27%|██▋       | 152/553 [00:01<00:02, 145.48it/s] 31%|███       | 171/553 [00:01<00:02, 155.80it/s] 34%|███▍      | 187/553 [00:01<00:02, 151.62it/s] 37%|███▋      | 205/553 [00:01<00:02, 159.62it/s] 40%|████      | 222/553 [00:01<00:02, 149.24it/s] 43%|████▎     | 239/553 [00:01<00:02, 154.26it/s] 46%|████▌     | 255/553 [00:01<00:01, 149.53it/s] 49%|████▉     | 271/553 [00:01<00:01, 146.32it/s] 52%|█████▏    | 286/553 [00:02<00:01, 146.84it/s] 54%|█████▍    | 301/553 [00:02<00:01, 140.48it/s] 57%|█████▋    | 316/553 [00:02<00:01, 133.09it/s] 60%|█████▉    | 330/553 [00:02<00:01, 133.67it/s] 62%|██████▏   | 345/553 [00:02<00:01, 136.40it/s] 65%|██████▍   | 359/553 [00:02<00:01, 132.25it/s] 68%|██████▊   | 376/553 [00:02<00:01, 138.80it/s] 71%|███████   | 390/553 [00:02<00:01, 129.08it/s] 73%|███████▎  | 404/553 [00:02<00:01, 129.34it/s] 76%|███████▌  | 418/553 [00:03<00:01, 123.05it/s] 78%|███████▊  | 431/553 [00:03<00:01, 118.09it/s] 81%|████████  | 448/553 [00:03<00:00, 131.38it/s] 84%|████████▎ | 462/553 [00:03<00:00, 133.46it/s] 86%|████████▌ | 476/553 [00:03<00:00, 134.70it/s] 89%|████████▊ | 490/553 [00:03<00:00, 124.85it/s] 91%|█████████ | 503/553 [00:03<00:00, 120.06it/s] 94%|█████████▍| 519/553 [00:03<00:00, 128.36it/s] 96%|█████████▌| 532/553 [00:04<00:00, 107.66it/s] 99%|█████████▉| 547/553 [00:04<00:00, 118.03it/s]100%|██████████| 553/553 [00:04<00:00, 129.04it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  22%|██▏       | 31/139 [00:00<00:00, 304.87it/s]extract the null data:  60%|█████▉    | 83/139 [00:00<00:00, 425.60it/s]extract the null data:  98%|█████████▊| 136/139 [00:00<00:00, 469.55it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 446.42it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  14%|█▎        | 19/139 [00:00<00:00, 182.51it/s]replace nan value:  27%|██▋       | 38/139 [00:00<00:00, 184.73it/s]replace nan value:  41%|████      | 57/139 [00:00<00:00, 184.68it/s]replace nan value:  55%|█████▍    | 76/139 [00:00<00:00, 183.79it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 182.61it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 181.90it/s]replace nan value:  96%|█████████▌| 133/139 [00:00<00:00, 182.77it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 183.13it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 129.43it/s] 19%|█▉        | 27/139 [00:00<00:00, 134.61it/s] 32%|███▏      | 44/139 [00:00<00:00, 145.34it/s] 42%|████▏     | 59/139 [00:00<00:00, 132.33it/s] 53%|█████▎    | 74/139 [00:00<00:00, 136.37it/s] 63%|██████▎   | 88/139 [00:00<00:00, 119.78it/s] 75%|███████▍  | 104/139 [00:00<00:00, 128.44it/s] 85%|████████▍ | 118/139 [00:00<00:00, 130.67it/s] 95%|█████████▍| 132/139 [00:01<00:00, 128.02it/s]100%|██████████| 139/139 [00:01<00:00, 132.29it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  15%|█▌        | 26/173 [00:00<00:00, 256.53it/s]extract the null data:  45%|████▌     | 78/173 [00:00<00:00, 408.28it/s]extract the null data:  75%|███████▍  | 129/173 [00:00<00:00, 453.88it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 441.74it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  10%|█         | 18/173 [00:00<00:00, 178.99it/s]replace nan value:  21%|██▏       | 37/173 [00:00<00:00, 181.78it/s]replace nan value:  32%|███▏      | 56/173 [00:00<00:00, 180.87it/s]replace nan value:  43%|████▎     | 75/173 [00:00<00:00, 180.65it/s]replace nan value:  54%|█████▍    | 94/173 [00:00<00:00, 181.80it/s]replace nan value:  65%|██████▌   | 113/173 [00:00<00:00, 180.34it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 180.01it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 180.03it/s]replace nan value:  98%|█████████▊| 170/173 [00:00<00:00, 178.28it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 179.49it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 130.77it/s] 16%|█▌        | 28/173 [00:00<00:01, 113.32it/s] 25%|██▍       | 43/173 [00:00<00:01, 127.46it/s] 34%|███▍      | 59/173 [00:00<00:00, 137.14it/s] 43%|████▎     | 74/173 [00:00<00:00, 139.06it/s] 51%|█████▏    | 89/173 [00:00<00:00, 138.62it/s] 60%|█████▉    | 103/173 [00:00<00:00, 137.84it/s] 68%|██████▊   | 118/173 [00:00<00:00, 140.64it/s] 77%|███████▋  | 133/173 [00:00<00:00, 133.27it/s] 85%|████████▍ | 147/173 [00:01<00:00, 134.71it/s] 93%|█████████▎| 161/173 [00:01<00:00, 122.26it/s]100%|██████████| 173/173 [00:01<00:00, 120.39it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.111, valid loss : 0.062, train acc : 0.844, valid acc : 0.927, train f1 : 0.597, valid f1 : 0.610
training process:   1%|          | 1/128 [01:00<2:07:47, 60.37s/it]Best score increase :0.000 -> 0.610
training process:   2%|▏         | 2/128 [01:51<1:55:09, 54.83s/it]Best score increase :0.610 -> 0.670
training process:   2%|▏         | 3/128 [02:42<1:50:38, 53.11s/it]Best score increase :0.670 -> 0.684
training process:   3%|▎         | 4/128 [03:34<1:49:14, 52.86s/it]Best score increase :0.684 -> 0.726
epoch : 5, train loss : 0.043, valid loss : 0.049, train acc : 0.949, valid acc : 0.943, train f1 : 0.780, valid f1 : 0.740
training process:   4%|▍         | 5/128 [04:34<1:53:09, 55.20s/it]Best score increase :0.726 -> 0.740
training process:   5%|▍         | 6/128 [05:25<1:49:30, 53.86s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:17<1:47:26, 53.27s/it]Best score increase :0.740 -> 0.766
training process:   6%|▋         | 8/128 [07:10<1:46:30, 53.25s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.036, valid loss : 0.051, train acc : 0.957, valid acc : 0.947, train f1 : 0.823, valid f1 : 0.766
training process:   7%|▋         | 9/128 [08:13<1:51:31, 56.23s/it]EarlyStopping counter : 2 out of 12
training process:   8%|▊         | 10/128 [09:07<1:49:03, 55.46s/it]Best score increase :0.766 -> 0.779
training process:   9%|▊         | 11/128 [09:59<1:46:29, 54.61s/it]Best score increase :0.779 -> 0.786
training process:   9%|▉         | 12/128 [10:54<1:45:45, 54.70s/it]Best score increase :0.786 -> 0.791
epoch : 13, train loss : 0.034, valid loss : 0.052, train acc : 0.959, valid acc : 0.949, train f1 : 0.835, valid f1 : 0.780
training process:  10%|█         | 13/128 [11:56<1:48:53, 56.82s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [12:47<1:44:42, 55.11s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [13:41<1:42:51, 54.61s/it]Best score increase :0.791 -> 0.805
training process:  12%|█▎        | 16/128 [14:35<1:41:39, 54.46s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.032, valid loss : 0.050, train acc : 0.962, valid acc : 0.953, train f1 : 0.850, valid f1 : 0.803
training process:  13%|█▎        | 17/128 [15:38<1:45:47, 57.18s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [16:30<1:41:38, 55.44s/it]EarlyStopping counter : 3 out of 12
training process:  15%|█▍        | 19/128 [17:23<1:39:33, 54.80s/it]EarlyStopping counter : 4 out of 12
training process:  16%|█▌        | 20/128 [18:19<1:39:18, 55.17s/it]Best score increase :0.805 -> 0.811
epoch : 21, train loss : 0.030, valid loss : 0.053, train acc : 0.964, valid acc : 0.953, train f1 : 0.859, valid f1 : 0.802
training process:  16%|█▋        | 21/128 [19:19<1:41:10, 56.74s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [20:08<1:36:10, 54.43s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [21:03<1:35:18, 54.46s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [21:58<1:34:54, 54.76s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.028, valid loss : 0.050, train acc : 0.966, valid acc : 0.955, train f1 : 0.866, valid f1 : 0.815
training process:  20%|█▉        | 25/128 [23:00<1:37:32, 56.82s/it]Best score increase :0.811 -> 0.815
training process:  20%|██        | 26/128 [23:50<1:33:04, 54.75s/it]Best score increase :0.815 -> 0.818
training process:  21%|██        | 27/128 [24:42<1:30:56, 54.03s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [25:35<1:29:24, 53.65s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.027, valid loss : 0.051, train acc : 0.968, valid acc : 0.956, train f1 : 0.877, valid f1 : 0.819
training process:  23%|██▎       | 29/128 [26:35<1:31:51, 55.67s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [27:27<1:28:49, 54.39s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [28:19<1:26:57, 53.78s/it]Best score increase :0.818 -> 0.828
training process:  25%|██▌       | 32/128 [29:13<1:26:07, 53.83s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.026, valid loss : 0.048, train acc : 0.969, valid acc : 0.958, train f1 : 0.880, valid f1 : 0.829
training process:  26%|██▌       | 33/128 [30:14<1:28:39, 56.00s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [31:07<1:26:14, 55.05s/it]EarlyStopping counter : 3 out of 12
training process:  27%|██▋       | 35/128 [32:01<1:24:43, 54.66s/it]EarlyStopping counter : 4 out of 12
training process:  28%|██▊       | 36/128 [32:54<1:23:02, 54.16s/it]Best score increase :0.828 -> 0.843
epoch : 37, train loss : 0.025, valid loss : 0.058, train acc : 0.970, valid acc : 0.957, train f1 : 0.887, valid f1 : 0.821
training process:  29%|██▉       | 37/128 [33:55<1:25:16, 56.23s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [34:48<1:23:03, 55.37s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [35:42<1:21:12, 54.74s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [36:35<1:19:40, 54.33s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.024, valid loss : 0.054, train acc : 0.970, valid acc : 0.958, train f1 : 0.884, valid f1 : 0.831
training process:  32%|███▏      | 41/128 [37:33<1:20:36, 55.59s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [38:27<1:18:45, 54.94s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [39:19<1:16:51, 54.25s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [40:11<1:14:58, 53.56s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.024, valid loss : 0.052, train acc : 0.972, valid acc : 0.960, train f1 : 0.894, valid f1 : 0.840
training process:  35%|███▌      | 45/128 [41:13<1:17:31, 56.04s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [42:05<1:14:49, 54.76s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [42:57<1:12:42, 53.86s/it]Best score increase :0.843 -> 0.847
training process:  38%|███▊      | 48/128 [43:50<1:11:42, 53.79s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.023, valid loss : 0.052, train acc : 0.973, valid acc : 0.960, train f1 : 0.899, valid f1 : 0.838
training process:  38%|███▊      | 49/128 [44:52<1:13:44, 56.00s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [45:44<1:11:27, 54.97s/it]Best score increase :0.847 -> 0.853
training process:  40%|███▉      | 51/128 [46:37<1:09:36, 54.24s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [47:30<1:08:27, 54.04s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.023, valid loss : 0.051, train acc : 0.972, valid acc : 0.960, train f1 : 0.896, valid f1 : 0.842
training process:  41%|████▏     | 53/128 [48:34<1:11:09, 56.93s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [49:27<1:08:41, 55.70s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [50:20<1:06:55, 55.01s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [51:13<1:05:05, 54.25s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.022, valid loss : 0.055, train acc : 0.973, valid acc : 0.960, train f1 : 0.899, valid f1 : 0.841
training process:  45%|████▍     | 57/128 [52:14<1:06:48, 56.46s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [53:08<1:04:53, 55.62s/it]EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [54:00<1:02:44, 54.56s/it]EarlyStopping counter : 9 out of 12
training process:  47%|████▋     | 60/128 [54:51<1:00:40, 53.53s/it]Best score increase :0.853 -> 0.859
epoch : 61, train loss : 0.022, valid loss : 0.055, train acc : 0.974, valid acc : 0.961, train f1 : 0.904, valid f1 : 0.846
training process:  48%|████▊     | 61/128 [55:54<1:02:47, 56.23s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 62/128 [56:48<1:01:14, 55.68s/it]EarlyStopping counter : 2 out of 12
training process:  49%|████▉     | 63/128 [57:45<1:00:35, 55.93s/it]EarlyStopping counter : 3 out of 12
training process:  50%|█████     | 64/128 [58:35<57:49, 54.22s/it]  EarlyStopping counter : 4 out of 12
epoch : 65, train loss : 0.021, valid loss : 0.051, train acc : 0.974, valid acc : 0.961, train f1 : 0.903, valid f1 : 0.850
training process:  51%|█████     | 65/128 [59:37<59:27, 56.62s/it]EarlyStopping counter : 5 out of 12
training process:  52%|█████▏    | 66/128 [1:00:28<56:37, 54.80s/it]EarlyStopping counter : 6 out of 12
training process:  52%|█████▏    | 67/128 [1:01:19<54:41, 53.79s/it]EarlyStopping counter : 7 out of 12
training process:  53%|█████▎    | 68/128 [1:02:10<52:59, 53.00s/it]EarlyStopping counter : 8 out of 12
epoch : 69, train loss : 0.020, valid loss : 0.058, train acc : 0.975, valid acc : 0.960, train f1 : 0.907, valid f1 : 0.839
training process:  54%|█████▍    | 69/128 [1:03:09<53:46, 54.69s/it]EarlyStopping counter : 9 out of 12
training process:  55%|█████▍    | 70/128 [1:03:58<51:25, 53.19s/it]EarlyStopping counter : 10 out of 12
training process:  55%|█████▌    | 71/128 [1:04:49<49:48, 52.42s/it]EarlyStopping counter : 11 out of 12
training process:  55%|█████▌    | 71/128 [1:05:41<52:43, 55.51s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 71, best f1 score : 0.859
training process finished, best loss : 0.047 and best acc : 0.963, best f1 : 0.859, best epoch : 59

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.92      0.62      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.95      0.81      0.86      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.81, test loss : 3.023

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.65s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.61s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.49s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.67s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.64s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:46,  7.68s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:39,  7.81s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.66s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.66s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.66s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.74s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.68s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.67s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:01, 149.22it/s] 11%|█▏        | 35/306 [00:00<00:01, 173.89it/s] 18%|█▊        | 54/306 [00:00<00:01, 178.56it/s] 24%|██▎       | 72/306 [00:00<00:01, 176.89it/s] 29%|██▉       | 90/306 [00:00<00:01, 173.72it/s] 36%|███▌      | 109/306 [00:00<00:01, 176.99it/s] 42%|████▏     | 127/306 [00:00<00:01, 175.54it/s] 48%|████▊     | 147/306 [00:00<00:00, 180.67it/s] 54%|█████▍    | 166/306 [00:00<00:00, 181.08it/s] 61%|██████    | 186/306 [00:01<00:00, 183.92it/s] 67%|██████▋   | 205/306 [00:01<00:00, 179.16it/s] 73%|███████▎  | 223/306 [00:01<00:00, 177.44it/s] 79%|███████▉  | 243/306 [00:01<00:00, 181.04it/s] 86%|████████▌ | 262/306 [00:01<00:00, 180.72it/s] 92%|█████████▏| 281/306 [00:01<00:00, 180.40it/s] 98%|█████████▊| 300/306 [00:01<00:00, 180.45it/s]100%|██████████| 306/306 [00:01<00:00, 178.32it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 53/553 [00:00<00:00, 521.94it/s]extract the null data:  20%|█▉        | 108/553 [00:00<00:00, 532.11it/s]extract the null data:  29%|██▉       | 162/553 [00:00<00:00, 521.21it/s]extract the null data:  39%|███▉      | 215/553 [00:00<00:00, 521.13it/s]extract the null data:  48%|████▊     | 268/553 [00:00<00:00, 514.22it/s]extract the null data:  58%|█████▊    | 321/553 [00:00<00:00, 518.28it/s]extract the null data:  68%|██████▊   | 375/553 [00:00<00:00, 524.14it/s]extract the null data:  78%|███████▊  | 429/553 [00:00<00:00, 526.50it/s]extract the null data:  88%|████████▊ | 484/553 [00:00<00:00, 533.56it/s]extract the null data:  97%|█████████▋| 538/553 [00:01<00:00, 526.02it/s]extract the null data: 100%|██████████| 553/553 [00:01<00:00, 524.49it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   3%|▎         | 19/553 [00:00<00:02, 187.20it/s]replace nan value:   7%|▋         | 38/553 [00:00<00:02, 185.35it/s]replace nan value:  10%|█         | 57/553 [00:00<00:02, 182.05it/s]replace nan value:  14%|█▎        | 76/553 [00:00<00:02, 182.46it/s]replace nan value:  17%|█▋        | 96/553 [00:00<00:02, 186.03it/s]replace nan value:  21%|██        | 115/553 [00:00<00:02, 187.15it/s]replace nan value:  24%|██▍       | 135/553 [00:00<00:02, 188.35it/s]replace nan value:  28%|██▊       | 155/553 [00:00<00:02, 190.59it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:01, 189.92it/s]replace nan value:  35%|███▌      | 195/553 [00:01<00:01, 190.89it/s]replace nan value:  39%|███▉      | 215/553 [00:01<00:01, 192.42it/s]replace nan value:  42%|████▏     | 235/553 [00:01<00:01, 193.19it/s]replace nan value:  46%|████▌     | 255/553 [00:01<00:01, 194.02it/s]replace nan value:  50%|████▉     | 275/553 [00:01<00:01, 192.73it/s]replace nan value:  53%|█████▎    | 295/553 [00:01<00:01, 193.22it/s]replace nan value:  57%|█████▋    | 315/553 [00:01<00:01, 194.48it/s]replace nan value:  61%|██████    | 335/553 [00:01<00:01, 194.02it/s]replace nan value:  64%|██████▍   | 356/553 [00:01<00:01, 196.68it/s]replace nan value:  68%|██████▊   | 378/553 [00:01<00:00, 200.76it/s]replace nan value:  72%|███████▏  | 399/553 [00:02<00:00, 198.70it/s]replace nan value:  76%|███████▌  | 419/553 [00:02<00:00, 198.14it/s]replace nan value:  79%|███████▉  | 439/553 [00:02<00:00, 196.89it/s]replace nan value:  83%|████████▎ | 460/553 [00:02<00:00, 199.18it/s]replace nan value:  87%|████████▋ | 480/553 [00:02<00:00, 198.98it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 198.87it/s]replace nan value:  94%|█████████▍| 520/553 [00:02<00:00, 198.62it/s]replace nan value:  98%|█████████▊| 540/553 [00:02<00:00, 196.23it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 194.21it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 139.55it/s]  5%|▌         | 29/553 [00:00<00:03, 143.26it/s]  8%|▊         | 44/553 [00:00<00:03, 131.94it/s] 10%|█         | 58/553 [00:00<00:04, 122.79it/s] 13%|█▎        | 71/553 [00:00<00:03, 122.00it/s] 16%|█▌        | 87/553 [00:00<00:03, 132.01it/s] 18%|█▊        | 101/553 [00:00<00:03, 126.93it/s] 22%|██▏       | 119/553 [00:00<00:03, 141.62it/s] 24%|██▍       | 134/553 [00:00<00:02, 140.67it/s] 28%|██▊       | 153/553 [00:01<00:02, 154.01it/s] 31%|███       | 171/553 [00:01<00:02, 158.47it/s] 34%|███▍      | 187/553 [00:01<00:02, 154.68it/s] 37%|███▋      | 206/553 [00:01<00:02, 163.01it/s] 40%|████      | 223/553 [00:01<00:02, 155.10it/s] 43%|████▎     | 240/553 [00:01<00:01, 156.64it/s] 46%|████▋     | 256/553 [00:01<00:01, 149.18it/s] 49%|████▉     | 272/553 [00:01<00:01, 145.05it/s] 52%|█████▏    | 289/553 [00:01<00:01, 149.93it/s] 55%|█████▌    | 305/553 [00:02<00:01, 142.30it/s] 58%|█████▊    | 320/553 [00:02<00:01, 132.34it/s] 61%|██████    | 335/553 [00:02<00:01, 135.48it/s] 63%|██████▎   | 349/553 [00:02<00:01, 134.92it/s] 66%|██████▌   | 363/553 [00:02<00:01, 133.33it/s] 68%|██████▊   | 378/553 [00:02<00:01, 137.23it/s] 71%|███████   | 392/553 [00:02<00:01, 127.22it/s] 73%|███████▎  | 405/553 [00:02<00:01, 127.04it/s] 76%|███████▌  | 418/553 [00:03<00:01, 126.38it/s] 78%|███████▊  | 431/553 [00:03<00:00, 123.30it/s] 81%|████████▏ | 450/553 [00:03<00:00, 141.39it/s] 84%|████████▍ | 465/553 [00:03<00:00, 142.78it/s] 87%|████████▋ | 480/553 [00:03<00:00, 139.23it/s] 90%|████████▉ | 495/553 [00:03<00:00, 133.18it/s] 92%|█████████▏| 511/553 [00:03<00:00, 139.64it/s] 95%|█████████▌| 526/553 [00:03<00:00, 122.74it/s] 97%|█████████▋| 539/553 [00:03<00:00, 121.78it/s]100%|█████████▉| 552/553 [00:04<00:00, 110.46it/s]100%|██████████| 553/553 [00:04<00:00, 135.41it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  27%|██▋       | 37/139 [00:00<00:00, 368.79it/s]extract the null data:  75%|███████▍  | 104/139 [00:00<00:00, 541.01it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 542.49it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 23/139 [00:00<00:00, 223.05it/s]replace nan value:  33%|███▎      | 46/139 [00:00<00:00, 224.47it/s]replace nan value:  50%|████▉     | 69/139 [00:00<00:00, 220.78it/s]replace nan value:  66%|██████▌   | 92/139 [00:00<00:00, 218.24it/s]replace nan value:  82%|████████▏ | 114/139 [00:00<00:00, 216.25it/s]replace nan value:  99%|█████████▊| 137/139 [00:00<00:00, 217.58it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 218.48it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▉         | 13/139 [00:00<00:00, 128.04it/s] 19%|█▉        | 27/139 [00:00<00:00, 130.75it/s] 31%|███       | 43/139 [00:00<00:00, 142.29it/s] 42%|████▏     | 58/139 [00:00<00:00, 128.15it/s] 53%|█████▎    | 73/139 [00:00<00:00, 135.18it/s] 63%|██████▎   | 87/139 [00:00<00:00, 119.71it/s] 72%|███████▏  | 100/139 [00:00<00:00, 120.40it/s] 81%|████████▏ | 113/139 [00:00<00:00, 119.90it/s] 91%|█████████▏| 127/139 [00:01<00:00, 125.14it/s]100%|██████████| 139/139 [00:01<00:00, 127.27it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██▏       | 37/173 [00:00<00:00, 367.00it/s]extract the null data:  58%|█████▊    | 101/173 [00:00<00:00, 526.86it/s]extract the null data:  97%|█████████▋| 168/173 [00:00<00:00, 588.28it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 556.73it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 21/173 [00:00<00:00, 205.42it/s]replace nan value:  24%|██▍       | 42/173 [00:00<00:00, 206.36it/s]replace nan value:  37%|███▋      | 64/173 [00:00<00:00, 211.20it/s]replace nan value:  50%|████▉     | 86/173 [00:00<00:00, 213.02it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 227.68it/s]replace nan value:  78%|███████▊  | 135/173 [00:00<00:00, 223.42it/s]replace nan value:  91%|█████████▏| 158/173 [00:00<00:00, 217.81it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 211.04it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  6%|▌         | 10/173 [00:00<00:01, 99.59it/s] 12%|█▏        | 20/173 [00:00<00:01, 97.92it/s] 18%|█▊        | 31/173 [00:00<00:01, 98.87it/s] 28%|██▊       | 48/173 [00:00<00:00, 125.85it/s] 37%|███▋      | 64/173 [00:00<00:00, 135.47it/s] 46%|████▌     | 79/173 [00:00<00:00, 139.90it/s] 54%|█████▍    | 94/173 [00:00<00:00, 142.88it/s] 63%|██████▎   | 109/173 [00:00<00:00, 144.88it/s] 72%|███████▏  | 124/173 [00:00<00:00, 140.33it/s] 80%|████████  | 139/173 [00:01<00:00, 140.55it/s] 89%|████████▉ | 154/173 [00:01<00:00, 131.10it/s] 97%|█████████▋| 168/173 [00:01<00:00, 107.37it/s]100%|██████████| 173/173 [00:01<00:00, 120.36it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.135, valid loss : 0.094, train acc : 0.727, valid acc : 0.860, train f1 : 0.727, valid f1 : 0.687
training process:   1%|          | 1/128 [00:59<2:05:34, 59.33s/it]Best score increase :0.000 -> 0.687
training process:   2%|▏         | 2/128 [01:49<1:53:45, 54.17s/it]Best score increase :0.687 -> 0.711
training process:   2%|▏         | 3/128 [02:42<1:51:14, 53.39s/it]Best score increase :0.711 -> 0.762
training process:   3%|▎         | 4/128 [03:31<1:46:45, 51.66s/it]Best score increase :0.762 -> 0.776
epoch : 5, train loss : 0.087, valid loss : 0.062, train acc : 0.847, valid acc : 0.928, train f1 : 0.847, valid f1 : 0.800
training process:   4%|▍         | 5/128 [04:32<1:53:12, 55.23s/it]Best score increase :0.776 -> 0.800
training process:   5%|▍         | 6/128 [05:23<1:48:53, 53.56s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:13<1:45:57, 52.54s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:04<1:43:47, 51.89s/it]Best score increase :0.800 -> 0.804
epoch : 9, train loss : 0.073, valid loss : 0.059, train acc : 0.878, valid acc : 0.928, train f1 : 0.878, valid f1 : 0.809
training process:   7%|▋         | 9/128 [08:03<1:47:20, 54.12s/it]Best score increase :0.804 -> 0.809
training process:   8%|▊         | 10/128 [08:55<1:45:04, 53.43s/it]Best score increase :0.809 -> 0.812
training process:   9%|▊         | 11/128 [09:45<1:42:26, 52.54s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [10:36<1:40:29, 51.98s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.065, valid loss : 0.055, train acc : 0.893, valid acc : 0.933, train f1 : 0.893, valid f1 : 0.819
training process:  10%|█         | 13/128 [11:35<1:43:44, 54.12s/it]Best score increase :0.812 -> 0.819
training process:  11%|█         | 14/128 [12:25<1:40:25, 52.85s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:14<1:37:24, 51.72s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:03<1:34:50, 50.81s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.059, valid loss : 0.047, train acc : 0.905, valid acc : 0.945, train f1 : 0.905, valid f1 : 0.840
training process:  13%|█▎        | 17/128 [15:04<1:40:04, 54.09s/it]Best score increase :0.819 -> 0.840
training process:  14%|█▍        | 18/128 [15:54<1:36:54, 52.86s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:44<1:34:07, 51.81s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:33<1:31:54, 51.06s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.056, valid loss : 0.045, train acc : 0.912, valid acc : 0.941, train f1 : 0.912, valid f1 : 0.833
training process:  16%|█▋        | 21/128 [18:28<1:33:01, 52.16s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [19:13<1:28:40, 50.19s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [20:02<1:27:04, 49.75s/it]EarlyStopping counter : 6 out of 12
training process:  19%|█▉        | 24/128 [20:50<1:25:05, 49.09s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.052, valid loss : 0.046, train acc : 0.916, valid acc : 0.938, train f1 : 0.916, valid f1 : 0.832
training process:  20%|█▉        | 25/128 [21:42<1:25:45, 49.96s/it]EarlyStopping counter : 8 out of 12
training process:  20%|██        | 26/128 [22:38<1:28:18, 51.95s/it]EarlyStopping counter : 9 out of 12
training process:  21%|██        | 27/128 [23:47<1:35:49, 56.93s/it]EarlyStopping counter : 10 out of 12
training process:  22%|██▏       | 28/128 [24:57<1:41:44, 61.04s/it]Best score increase :0.840 -> 0.845
epoch : 29, train loss : 0.048, valid loss : 0.043, train acc : 0.924, valid acc : 0.943, train f1 : 0.924, valid f1 : 0.840
training process:  23%|██▎       | 29/128 [26:15<1:48:57, 66.03s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [27:22<1:48:13, 66.26s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [28:11<1:38:51, 61.14s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [28:58<1:31:06, 56.94s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.046, valid loss : 0.040, train acc : 0.927, valid acc : 0.946, train f1 : 0.927, valid f1 : 0.846
training process:  26%|██▌       | 33/128 [29:53<1:29:18, 56.41s/it]Best score increase :0.845 -> 0.846
training process:  27%|██▋       | 34/128 [30:40<1:24:02, 53.64s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 35/128 [31:28<1:20:11, 51.73s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 36/128 [32:14<1:17:00, 50.23s/it]Best score increase :0.846 -> 0.856
epoch : 37, train loss : 0.042, valid loss : 0.037, train acc : 0.935, valid acc : 0.950, train f1 : 0.935, valid f1 : 0.853
training process:  29%|██▉       | 37/128 [33:09<1:18:10, 51.54s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [33:57<1:15:49, 50.55s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [34:43<1:12:45, 49.06s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [35:30<1:11:07, 48.49s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.042, valid loss : 0.038, train acc : 0.933, valid acc : 0.947, train f1 : 0.933, valid f1 : 0.846
training process:  32%|███▏      | 41/128 [36:24<1:12:35, 50.06s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [37:11<1:10:26, 49.15s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [38:23<1:19:20, 56.01s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [39:50<1:31:28, 65.34s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.040, valid loss : 0.039, train acc : 0.938, valid acc : 0.948, train f1 : 0.938, valid f1 : 0.852
training process:  35%|███▌      | 45/128 [41:23<1:42:02, 73.76s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [42:30<1:37:47, 71.55s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [43:28<1:31:13, 67.58s/it]EarlyStopping counter : 11 out of 12
training process:  37%|███▋      | 47/128 [44:26<1:16:34, 56.72s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.856
training process finished, best loss : 0.036 and best acc : 0.953, best f1 : 0.856, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.74      0.78      0.76       580
           1       0.98      0.98      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.86      0.88      0.87      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.87, test AUC : 0.88, test loss : 2.052

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.39s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.90s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:07,  7.54s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.69s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.52s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:44,  7.40s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:36,  7.35s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.61s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.58s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:15<00:15,  7.60s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.53s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.54s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.55s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 22/306 [00:00<00:01, 208.30it/s] 14%|█▍        | 43/306 [00:00<00:01, 157.76it/s] 21%|██        | 64/306 [00:00<00:01, 174.22it/s] 27%|██▋       | 83/306 [00:00<00:01, 168.13it/s] 33%|███▎      | 101/306 [00:00<00:01, 158.41it/s] 41%|████      | 124/306 [00:00<00:01, 178.64it/s] 47%|████▋     | 143/306 [00:00<00:01, 151.68it/s] 54%|█████▍    | 166/306 [00:00<00:00, 170.86it/s] 60%|██████    | 185/306 [00:01<00:00, 152.65it/s] 68%|██████▊   | 207/306 [00:01<00:00, 168.14it/s] 74%|███████▎  | 225/306 [00:01<00:00, 163.61it/s] 79%|███████▉  | 243/306 [00:01<00:00, 156.98it/s] 87%|████████▋ | 265/306 [00:01<00:00, 171.90it/s] 92%|█████████▏| 283/306 [00:01<00:00, 147.88it/s]100%|██████████| 306/306 [00:01<00:00, 165.72it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 66/553 [00:00<00:00, 659.08it/s]extract the null data:  24%|██▍       | 132/553 [00:00<00:00, 653.83it/s]extract the null data:  36%|███▋      | 201/553 [00:00<00:00, 667.60it/s]extract the null data:  49%|████▉     | 272/553 [00:00<00:00, 681.37it/s]extract the null data:  62%|██████▏   | 341/553 [00:00<00:00, 683.50it/s]extract the null data:  74%|███████▍  | 410/553 [00:00<00:00, 679.16it/s]extract the null data:  86%|████████▋ | 478/553 [00:00<00:00, 677.43it/s]extract the null data:  99%|█████████▉| 547/553 [00:00<00:00, 678.87it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 675.26it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 212.11it/s]replace nan value:   8%|▊         | 46/553 [00:00<00:02, 222.91it/s]replace nan value:  12%|█▏        | 69/553 [00:00<00:02, 224.90it/s]replace nan value:  17%|█▋        | 92/553 [00:00<00:02, 225.83it/s]replace nan value:  21%|██        | 115/553 [00:00<00:01, 226.19it/s]replace nan value:  25%|██▍       | 138/553 [00:00<00:01, 224.19it/s]replace nan value:  29%|██▉       | 161/553 [00:00<00:01, 225.86it/s]replace nan value:  33%|███▎      | 185/553 [00:00<00:01, 227.34it/s]replace nan value:  38%|███▊      | 208/553 [00:00<00:01, 225.59it/s]replace nan value:  42%|████▏     | 231/553 [00:01<00:01, 223.93it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 224.90it/s]replace nan value:  50%|█████     | 277/553 [00:01<00:01, 220.10it/s]replace nan value:  54%|█████▍    | 300/553 [00:01<00:01, 222.35it/s]replace nan value:  58%|█████▊    | 323/553 [00:01<00:01, 224.18it/s]replace nan value:  63%|██████▎   | 346/553 [00:01<00:00, 223.46it/s]replace nan value:  67%|██████▋   | 370/553 [00:01<00:00, 226.20it/s]replace nan value:  71%|███████   | 393/553 [00:01<00:00, 226.49it/s]replace nan value:  75%|███████▌  | 416/553 [00:01<00:00, 225.94it/s]replace nan value:  80%|███████▉  | 440/553 [00:01<00:00, 227.41it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 232.10it/s]replace nan value:  88%|████████▊ | 489/553 [00:02<00:00, 227.90it/s]replace nan value:  93%|█████████▎| 512/553 [00:02<00:00, 225.74it/s]replace nan value:  97%|█████████▋| 535/553 [00:02<00:00, 226.82it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 225.18it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.84it/s]  5%|▌         | 29/553 [00:00<00:03, 139.89it/s]  8%|▊         | 43/553 [00:00<00:03, 131.47it/s] 10%|█         | 57/553 [00:00<00:04, 118.70it/s] 13%|█▎        | 70/553 [00:00<00:04, 109.88it/s] 15%|█▌        | 85/553 [00:00<00:03, 120.80it/s] 18%|█▊        | 98/553 [00:00<00:03, 119.48it/s] 21%|██        | 114/553 [00:00<00:03, 130.90it/s] 23%|██▎       | 128/553 [00:01<00:03, 129.61it/s] 27%|██▋       | 147/553 [00:01<00:02, 146.08it/s] 30%|██▉       | 165/553 [00:01<00:02, 153.66it/s] 33%|███▎      | 181/553 [00:01<00:02, 154.62it/s] 36%|███▌      | 199/553 [00:01<00:02, 161.91it/s] 39%|███▉      | 217/553 [00:01<00:02, 163.44it/s] 42%|████▏     | 234/553 [00:01<00:02, 157.72it/s] 45%|████▌     | 250/553 [00:01<00:01, 158.23it/s] 48%|████▊     | 266/553 [00:01<00:01, 156.04it/s] 51%|█████     | 282/553 [00:01<00:01, 152.40it/s] 54%|█████▍    | 298/553 [00:02<00:01, 148.72it/s] 57%|█████▋    | 313/553 [00:02<00:01, 146.12it/s] 59%|█████▉    | 328/553 [00:02<00:01, 143.70it/s] 62%|██████▏   | 345/553 [00:02<00:01, 145.83it/s] 65%|██████▌   | 360/553 [00:02<00:01, 138.40it/s] 68%|██████▊   | 377/553 [00:02<00:01, 146.65it/s] 71%|███████   | 392/553 [00:02<00:01, 135.88it/s] 74%|███████▎  | 407/553 [00:02<00:01, 138.02it/s] 76%|███████▌  | 421/553 [00:02<00:00, 135.16it/s] 79%|███████▊  | 435/553 [00:03<00:00, 133.03it/s] 82%|████████▏ | 453/553 [00:03<00:00, 145.70it/s] 85%|████████▍ | 470/553 [00:03<00:00, 151.87it/s] 88%|████████▊ | 486/553 [00:03<00:00, 150.53it/s] 91%|█████████ | 502/553 [00:03<00:00, 141.08it/s] 94%|█████████▍| 519/553 [00:03<00:00, 146.91it/s] 97%|█████████▋| 534/553 [00:03<00:00, 126.83it/s]100%|█████████▉| 551/553 [00:03<00:00, 117.11it/s]100%|██████████| 553/553 [00:03<00:00, 139.01it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  30%|███       | 42/139 [00:00<00:00, 419.43it/s]extract the null data:  85%|████████▍ | 118/139 [00:00<00:00, 616.64it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 604.06it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  18%|█▊        | 25/139 [00:00<00:00, 242.56it/s]replace nan value:  36%|███▌      | 50/139 [00:00<00:00, 245.27it/s]replace nan value:  55%|█████▌    | 77/139 [00:00<00:00, 253.01it/s]replace nan value:  75%|███████▍  | 104/139 [00:00<00:00, 257.52it/s]replace nan value:  94%|█████████▎| 130/139 [00:00<00:00, 251.10it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 250.59it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 130.47it/s] 21%|██        | 29/139 [00:00<00:00, 137.63it/s] 35%|███▍      | 48/139 [00:00<00:00, 152.35it/s] 46%|████▌     | 64/139 [00:00<00:00, 151.79it/s] 58%|█████▊    | 80/139 [00:00<00:00, 150.04it/s] 68%|██████▊   | 95/139 [00:00<00:00, 142.02it/s] 79%|███████▉  | 110/139 [00:00<00:00, 143.69it/s] 92%|█████████▏| 128/139 [00:00<00:00, 153.37it/s]100%|██████████| 139/139 [00:00<00:00, 149.91it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  25%|██▍       | 43/173 [00:00<00:00, 428.49it/s]extract the null data:  67%|██████▋   | 116/173 [00:00<00:00, 601.69it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 619.43it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 25/173 [00:00<00:00, 249.11it/s]replace nan value:  29%|██▉       | 50/173 [00:00<00:00, 245.83it/s]replace nan value:  44%|████▍     | 76/173 [00:00<00:00, 248.00it/s]replace nan value:  58%|█████▊    | 101/173 [00:00<00:00, 247.23it/s]replace nan value:  73%|███████▎  | 126/173 [00:00<00:00, 240.95it/s]replace nan value:  87%|████████▋ | 151/173 [00:00<00:00, 242.28it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 243.04it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 145.76it/s] 17%|█▋        | 30/173 [00:00<00:01, 134.11it/s] 28%|██▊       | 48/173 [00:00<00:00, 152.94it/s] 38%|███▊      | 65/173 [00:00<00:00, 152.14it/s] 47%|████▋     | 81/173 [00:00<00:00, 154.18it/s] 56%|█████▌    | 97/173 [00:00<00:00, 154.32it/s] 65%|██████▌   | 113/173 [00:00<00:00, 155.37it/s] 75%|███████▍  | 129/173 [00:00<00:00, 147.83it/s] 83%|████████▎ | 144/173 [00:00<00:00, 143.87it/s] 92%|█████████▏| 159/173 [00:01<00:00, 132.02it/s]100%|██████████| 173/173 [00:01<00:00, 100.92it/s]100%|██████████| 173/173 [00:01<00:00, 130.23it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.021, valid loss : 0.019, train acc : 0.655, valid acc : 0.840, train f1 : 0.517, valid f1 : 0.661
training process:   1%|          | 1/128 [01:11<2:31:35, 71.62s/it]Best score increase :0.000 -> 0.661
training process:   2%|▏         | 2/128 [02:34<2:44:54, 78.53s/it]Best score increase :0.661 -> 0.694
training process:   2%|▏         | 3/128 [03:44<2:34:34, 74.20s/it]Best score increase :0.694 -> 0.769
training process:   3%|▎         | 4/128 [05:08<2:41:33, 78.17s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.014, valid loss : 0.016, train acc : 0.872, valid acc : 0.919, train f1 : 0.711, valid f1 : 0.774
training process:   4%|▍         | 5/128 [06:31<2:44:17, 80.14s/it]Best score increase :0.769 -> 0.774
training process:   5%|▍         | 6/128 [07:28<2:26:43, 72.16s/it]Best score increase :0.774 -> 0.806
training process:   5%|▌         | 7/128 [08:25<2:15:25, 67.15s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▋         | 8/128 [09:34<2:15:18, 67.65s/it]Best score increase :0.806 -> 0.811
epoch : 9, train loss : 0.013, valid loss : 0.017, train acc : 0.900, valid acc : 0.943, train f1 : 0.754, valid f1 : 0.816
training process:   7%|▋         | 9/128 [10:49<2:18:50, 70.00s/it]Best score increase :0.811 -> 0.816
training process:   8%|▊         | 10/128 [11:57<2:16:50, 69.58s/it]Best score increase :0.816 -> 0.817
training process:   9%|▊         | 11/128 [13:06<2:14:55, 69.20s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [14:14<2:13:06, 68.85s/it]Best score increase :0.817 -> 0.835
epoch : 13, train loss : 0.012, valid loss : 0.018, train acc : 0.914, valid acc : 0.951, train f1 : 0.777, valid f1 : 0.831
training process:  10%|█         | 13/128 [15:31<2:16:36, 71.27s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [16:37<2:12:31, 69.75s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [17:34<2:03:57, 65.82s/it]Best score increase :0.835 -> 0.836
training process:  12%|█▎        | 16/128 [18:33<1:59:14, 63.88s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.011, valid loss : 0.018, train acc : 0.924, valid acc : 0.953, train f1 : 0.795, valid f1 : 0.840
training process:  13%|█▎        | 17/128 [19:53<2:07:03, 68.68s/it]Best score increase :0.836 -> 0.840
training process:  14%|█▍        | 18/128 [21:02<2:06:02, 68.75s/it]Best score increase :0.840 -> 0.847
training process:  15%|█▍        | 19/128 [22:17<2:08:33, 70.76s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [23:34<2:10:51, 72.70s/it]Best score increase :0.847 -> 0.854
epoch : 21, train loss : 0.011, valid loss : 0.019, train acc : 0.933, valid acc : 0.955, train f1 : 0.811, valid f1 : 0.849
training process:  16%|█▋        | 21/128 [24:54<2:13:12, 74.69s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [25:53<2:03:33, 69.94s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [26:49<1:55:23, 65.93s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [27:56<1:54:35, 66.11s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.010, valid loss : 0.018, train acc : 0.936, valid acc : 0.955, train f1 : 0.818, valid f1 : 0.850
training process:  20%|█▉        | 25/128 [29:20<2:02:52, 71.57s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 26/128 [30:37<2:04:24, 73.19s/it]Best score increase :0.854 -> 0.861
training process:  21%|██        | 27/128 [31:49<2:02:35, 72.82s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 28/128 [33:06<2:03:20, 74.00s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.010, valid loss : 0.019, train acc : 0.941, valid acc : 0.957, train f1 : 0.830, valid f1 : 0.857
training process:  23%|██▎       | 29/128 [34:22<2:03:22, 74.77s/it]EarlyStopping counter : 3 out of 12
training process:  23%|██▎       | 30/128 [35:21<1:54:07, 69.87s/it]EarlyStopping counter : 4 out of 12
training process:  24%|██▍       | 31/128 [36:25<1:50:19, 68.24s/it]Best score increase :0.861 -> 0.864
training process:  25%|██▌       | 32/128 [37:47<1:55:31, 72.20s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.009, valid loss : 0.018, train acc : 0.941, valid acc : 0.957, train f1 : 0.831, valid f1 : 0.858
training process:  26%|██▌       | 33/128 [39:06<1:57:54, 74.47s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [40:17<1:55:05, 73.47s/it]Best score increase :0.864 -> 0.865
training process:  27%|██▋       | 35/128 [41:36<1:56:14, 74.99s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [42:46<1:52:51, 73.61s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.009, valid loss : 0.023, train acc : 0.948, valid acc : 0.959, train f1 : 0.846, valid f1 : 0.856
training process:  29%|██▉       | 37/128 [43:57<1:50:04, 72.58s/it]EarlyStopping counter : 3 out of 12
training process:  30%|██▉       | 38/128 [44:55<1:42:39, 68.44s/it]EarlyStopping counter : 4 out of 12
training process:  30%|███       | 39/128 [45:55<1:37:31, 65.74s/it]EarlyStopping counter : 5 out of 12
training process:  31%|███▏      | 40/128 [47:02<1:37:04, 66.19s/it]Best score increase :0.865 -> 0.868
epoch : 41, train loss : 0.009, valid loss : 0.023, train acc : 0.946, valid acc : 0.961, train f1 : 0.844, valid f1 : 0.862
training process:  32%|███▏      | 41/128 [48:17<1:39:39, 68.73s/it]EarlyStopping counter : 1 out of 12
training process:  33%|███▎      | 42/128 [49:22<1:37:11, 67.81s/it]EarlyStopping counter : 2 out of 12
training process:  34%|███▎      | 43/128 [50:36<1:38:29, 69.52s/it]EarlyStopping counter : 3 out of 12
training process:  34%|███▍      | 44/128 [51:45<1:37:15, 69.47s/it]EarlyStopping counter : 4 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.021, train acc : 0.951, valid acc : 0.961, train f1 : 0.853, valid f1 : 0.868
training process:  35%|███▌      | 45/128 [53:11<1:42:45, 74.28s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 46/128 [54:13<1:36:27, 70.57s/it]EarlyStopping counter : 6 out of 12
training process:  37%|███▋      | 47/128 [55:10<1:30:02, 66.70s/it]Best score increase :0.868 -> 0.870
training process:  38%|███▊      | 48/128 [56:10<1:26:08, 64.60s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.008, valid loss : 0.022, train acc : 0.952, valid acc : 0.961, train f1 : 0.857, valid f1 : 0.868
training process:  38%|███▊      | 49/128 [57:25<1:29:08, 67.70s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [58:42<1:31:34, 70.45s/it]Best score increase :0.870 -> 0.871
training process:  40%|███▉      | 51/128 [59:56<1:31:52, 71.59s/it]EarlyStopping counter : 1 out of 12
training process:  41%|████      | 52/128 [1:01:05<1:29:44, 70.85s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.009, valid loss : 0.022, train acc : 0.955, valid acc : 0.962, train f1 : 0.864, valid f1 : 0.871
training process:  41%|████▏     | 53/128 [1:02:24<1:31:30, 73.20s/it]EarlyStopping counter : 3 out of 12
training process:  42%|████▏     | 54/128 [1:03:28<1:27:00, 70.55s/it]EarlyStopping counter : 4 out of 12
training process:  43%|████▎     | 55/128 [1:04:27<1:21:24, 66.91s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 56/128 [1:05:26<1:17:32, 64.62s/it]EarlyStopping counter : 6 out of 12
epoch : 57, train loss : 0.008, valid loss : 0.025, train acc : 0.958, valid acc : 0.963, train f1 : 0.872, valid f1 : 0.870
training process:  45%|████▍     | 57/128 [1:06:45<1:21:32, 68.91s/it]EarlyStopping counter : 7 out of 12
training process:  45%|████▌     | 58/128 [1:07:56<1:21:06, 69.52s/it]EarlyStopping counter : 8 out of 12
training process:  46%|████▌     | 59/128 [1:09:06<1:20:03, 69.62s/it]Best score increase :0.871 -> 0.873
training process:  47%|████▋     | 60/128 [1:10:15<1:18:45, 69.49s/it]Best score increase :0.873 -> 0.875
epoch : 61, train loss : 0.008, valid loss : 0.024, train acc : 0.955, valid acc : 0.963, train f1 : 0.865, valid f1 : 0.870
training process:  48%|████▊     | 61/128 [1:11:33<1:20:24, 72.00s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 62/128 [1:12:45<1:19:15, 72.05s/it]EarlyStopping counter : 2 out of 12
training process:  49%|████▉     | 63/128 [1:13:46<1:14:26, 68.72s/it]EarlyStopping counter : 3 out of 12
training process:  50%|█████     | 64/128 [1:14:43<1:09:36, 65.25s/it]Best score increase :0.875 -> 0.876
epoch : 65, train loss : 0.008, valid loss : 0.023, train acc : 0.958, valid acc : 0.963, train f1 : 0.872, valid f1 : 0.874
training process:  51%|█████     | 65/128 [1:15:50<1:09:05, 65.80s/it]EarlyStopping counter : 1 out of 12
training process:  52%|█████▏    | 66/128 [1:16:39<1:02:52, 60.85s/it]EarlyStopping counter : 2 out of 12
training process:  52%|█████▏    | 67/128 [1:17:30<58:36, 57.65s/it]  Best score increase :0.876 -> 0.878
training process:  53%|█████▎    | 68/128 [1:18:18<54:49, 54.82s/it]Best score increase :0.878 -> 0.880
epoch : 69, train loss : 0.008, valid loss : 0.027, train acc : 0.960, valid acc : 0.963, train f1 : 0.879, valid f1 : 0.870
training process:  54%|█████▍    | 69/128 [1:19:15<54:38, 55.57s/it]EarlyStopping counter : 1 out of 12
training process:  55%|█████▍    | 70/128 [1:20:04<51:52, 53.66s/it]EarlyStopping counter : 2 out of 12
training process:  55%|█████▌    | 71/128 [1:20:54<49:51, 52.49s/it]EarlyStopping counter : 3 out of 12
training process:  56%|█████▋    | 72/128 [1:21:44<48:22, 51.83s/it]EarlyStopping counter : 4 out of 12
epoch : 73, train loss : 0.008, valid loss : 0.023, train acc : 0.960, valid acc : 0.965, train f1 : 0.877, valid f1 : 0.879
training process:  57%|█████▋    | 73/128 [1:22:41<48:56, 53.40s/it]EarlyStopping counter : 5 out of 12
training process:  58%|█████▊    | 74/128 [1:23:29<46:34, 51.75s/it]EarlyStopping counter : 6 out of 12
training process:  59%|█████▊    | 75/128 [1:24:18<44:59, 50.93s/it]EarlyStopping counter : 7 out of 12
training process:  59%|█████▉    | 76/128 [1:25:07<43:31, 50.23s/it]Best score increase :0.880 -> 0.883
epoch : 77, train loss : 0.008, valid loss : 0.026, train acc : 0.962, valid acc : 0.962, train f1 : 0.884, valid f1 : 0.871
training process:  60%|██████    | 77/128 [1:26:05<44:36, 52.48s/it]EarlyStopping counter : 1 out of 12
training process:  61%|██████    | 78/128 [1:27:19<49:10, 59.02s/it]EarlyStopping counter : 2 out of 12
training process:  62%|██████▏   | 79/128 [1:28:33<51:57, 63.61s/it]EarlyStopping counter : 3 out of 12
training process:  62%|██████▎   | 80/128 [1:29:48<53:31, 66.91s/it]EarlyStopping counter : 4 out of 12
epoch : 81, train loss : 0.007, valid loss : 0.025, train acc : 0.963, valid acc : 0.963, train f1 : 0.887, valid f1 : 0.874
training process:  63%|██████▎   | 81/128 [1:31:11<56:10, 71.72s/it]EarlyStopping counter : 5 out of 12
training process:  64%|██████▍   | 82/128 [1:32:07<51:28, 67.14s/it]EarlyStopping counter : 6 out of 12
training process:  65%|██████▍   | 83/128 [1:32:59<46:58, 62.64s/it]EarlyStopping counter : 7 out of 12
training process:  66%|██████▌   | 84/128 [1:33:49<43:07, 58.80s/it]EarlyStopping counter : 8 out of 12
epoch : 85, train loss : 0.007, valid loss : 0.026, train acc : 0.963, valid acc : 0.961, train f1 : 0.886, valid f1 : 0.867
training process:  66%|██████▋   | 85/128 [1:34:49<42:24, 59.18s/it]EarlyStopping counter : 9 out of 12
training process:  67%|██████▋   | 86/128 [1:35:37<39:04, 55.83s/it]EarlyStopping counter : 10 out of 12
training process:  68%|██████▊   | 87/128 [1:36:25<36:33, 53.49s/it]EarlyStopping counter : 11 out of 12
training process:  68%|██████▊   | 87/128 [1:37:15<45:50, 67.08s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 87, best f1 score : 0.884
training process finished, best loss : 0.023 and best acc : 0.966, best f1 : 0.884, best epoch : 77

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.88      0.70      0.78       580
           1       0.97      0.99      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.93      0.84      0.88      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.88, test AUC : 0.84, test loss : 1.683

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:24,  7.65s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:14,  7.48s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.41s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<00:59,  7.50s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.50s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.61s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.48s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:59<00:29,  7.40s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:07<00:22,  7.40s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:14<00:14,  7.45s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:22<00:07,  7.56s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.66s/it]processing for feature importance: 100%|██████████| 12/12 [01:30<00:00,  7.53s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 19/306 [00:00<00:01, 183.62it/s] 12%|█▏        | 38/306 [00:00<00:01, 160.06it/s] 18%|█▊        | 55/306 [00:00<00:01, 129.88it/s] 23%|██▎       | 70/306 [00:00<00:01, 135.11it/s] 27%|██▋       | 84/306 [00:00<00:01, 115.19it/s] 33%|███▎      | 100/306 [00:00<00:01, 127.26it/s] 37%|███▋      | 114/306 [00:00<00:01, 124.11it/s] 42%|████▏     | 127/306 [00:00<00:01, 121.32it/s] 46%|████▋     | 142/306 [00:01<00:01, 128.12it/s] 51%|█████     | 156/306 [00:01<00:01, 114.49it/s] 57%|█████▋    | 174/306 [00:01<00:01, 128.54it/s] 61%|██████▏   | 188/306 [00:01<00:00, 125.29it/s] 66%|██████▌   | 201/306 [00:01<00:00, 120.66it/s] 71%|███████   | 216/306 [00:01<00:00, 128.33it/s] 75%|███████▌  | 230/306 [00:01<00:00, 119.29it/s] 81%|████████  | 247/306 [00:01<00:00, 131.63it/s] 85%|████████▌ | 261/306 [00:02<00:00, 127.79it/s] 90%|████████▉ | 275/306 [00:02<00:00, 118.40it/s] 95%|█████████▍| 290/306 [00:02<00:00, 125.64it/s] 99%|█████████▉| 303/306 [00:02<00:00, 117.53it/s]100%|██████████| 306/306 [00:02<00:00, 124.30it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  10%|▉         | 53/553 [00:00<00:00, 527.13it/s]extract the null data:  20%|█▉        | 109/553 [00:00<00:00, 546.06it/s]extract the null data:  31%|███       | 169/553 [00:00<00:00, 566.88it/s]extract the null data:  41%|████      | 226/553 [00:00<00:00, 564.84it/s]extract the null data:  52%|█████▏    | 285/553 [00:00<00:00, 570.70it/s]extract the null data:  62%|██████▏   | 344/553 [00:00<00:00, 577.11it/s]extract the null data:  73%|███████▎  | 404/553 [00:00<00:00, 583.10it/s]extract the null data:  84%|████████▎ | 463/553 [00:00<00:00, 583.71it/s]extract the null data:  94%|█████████▍| 522/553 [00:00<00:00, 584.01it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 578.27it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▎         | 20/553 [00:00<00:02, 195.93it/s]replace nan value:   7%|▋         | 41/553 [00:00<00:02, 199.13it/s]replace nan value:  11%|█         | 62/553 [00:00<00:02, 199.70it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 201.44it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 199.83it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 199.98it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:02, 199.38it/s]replace nan value:  30%|███       | 168/553 [00:00<00:01, 205.37it/s]replace nan value:  34%|███▍      | 189/553 [00:00<00:01, 206.23it/s]replace nan value:  38%|███▊      | 210/553 [00:01<00:01, 201.34it/s]replace nan value:  42%|████▏     | 232/553 [00:01<00:01, 204.39it/s]replace nan value:  46%|████▌     | 254/553 [00:01<00:01, 207.08it/s]replace nan value:  50%|████▉     | 276/553 [00:01<00:01, 208.15it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 207.23it/s]replace nan value:  58%|█████▊    | 318/553 [00:01<00:01, 204.43it/s]replace nan value:  61%|██████▏   | 339/553 [00:01<00:01, 203.25it/s]replace nan value:  65%|██████▌   | 360/553 [00:01<00:00, 201.13it/s]replace nan value:  69%|██████▉   | 381/553 [00:01<00:00, 203.05it/s]replace nan value:  73%|███████▎  | 402/553 [00:01<00:00, 202.81it/s]replace nan value:  76%|███████▋  | 423/553 [00:02<00:00, 201.41it/s]replace nan value:  80%|████████  | 444/553 [00:02<00:00, 200.47it/s]replace nan value:  84%|████████▍ | 465/553 [00:02<00:00, 198.27it/s]replace nan value:  88%|████████▊ | 486/553 [00:02<00:00, 199.92it/s]replace nan value:  92%|█████████▏| 507/553 [00:02<00:00, 199.64it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 200.23it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 200.70it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 201.77it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  2%|▏         | 11/553 [00:00<00:05, 106.73it/s]  5%|▍         | 25/553 [00:00<00:04, 124.16it/s]  7%|▋         | 39/553 [00:00<00:04, 128.23it/s]  9%|▉         | 52/553 [00:00<00:04, 115.67it/s] 12%|█▏        | 64/553 [00:00<00:04, 105.58it/s] 14%|█▍        | 77/553 [00:00<00:04, 109.99it/s] 16%|█▋        | 91/553 [00:00<00:04, 113.81it/s] 19%|█▊        | 103/553 [00:00<00:03, 114.64it/s] 22%|██▏       | 119/553 [00:01<00:03, 126.16it/s] 24%|██▍       | 132/553 [00:01<00:03, 125.02it/s] 27%|██▋       | 150/553 [00:01<00:02, 139.88it/s] 30%|███       | 167/553 [00:01<00:02, 146.70it/s] 33%|███▎      | 182/553 [00:01<00:02, 142.90it/s] 36%|███▌      | 198/553 [00:01<00:02, 146.16it/s] 39%|███▊      | 214/553 [00:01<00:02, 149.75it/s] 42%|████▏     | 230/553 [00:01<00:02, 137.20it/s] 44%|████▍     | 245/553 [00:01<00:02, 139.71it/s] 47%|████▋     | 260/553 [00:01<00:02, 142.05it/s] 50%|████▉     | 275/553 [00:02<00:02, 138.00it/s] 52%|█████▏    | 289/553 [00:02<00:01, 134.25it/s] 55%|█████▍    | 303/553 [00:02<00:02, 124.27it/s] 57%|█████▋    | 316/553 [00:02<00:01, 121.82it/s] 60%|█████▉    | 330/553 [00:02<00:01, 125.09it/s] 62%|██████▏   | 345/553 [00:02<00:01, 129.99it/s] 65%|██████▍   | 359/553 [00:02<00:01, 127.41it/s] 68%|██████▊   | 376/553 [00:02<00:01, 135.21it/s] 71%|███████   | 390/553 [00:03<00:01, 124.26it/s] 73%|███████▎  | 403/553 [00:03<00:01, 125.36it/s] 75%|███████▌  | 416/553 [00:03<00:01, 125.67it/s] 78%|███████▊  | 429/553 [00:03<00:01, 120.44it/s] 81%|████████  | 447/553 [00:03<00:00, 136.76it/s] 84%|████████▎ | 462/553 [00:03<00:00, 139.11it/s] 86%|████████▋ | 477/553 [00:03<00:00, 140.92it/s] 89%|████████▉ | 492/553 [00:03<00:00, 130.08it/s] 92%|█████████▏| 506/553 [00:03<00:00, 128.32it/s] 94%|█████████▍| 520/553 [00:04<00:00, 129.41it/s] 97%|█████████▋| 534/553 [00:04<00:00, 113.37it/s] 99%|█████████▉| 550/553 [00:04<00:00, 123.60it/s]100%|██████████| 553/553 [00:04<00:00, 126.65it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  24%|██▎       | 33/139 [00:00<00:00, 329.58it/s]extract the null data:  69%|██████▉   | 96/139 [00:00<00:00, 504.87it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 515.67it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 21/139 [00:00<00:00, 205.81it/s]replace nan value:  30%|███       | 42/139 [00:00<00:00, 205.82it/s]replace nan value:  45%|████▌     | 63/139 [00:00<00:00, 205.23it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 205.18it/s]replace nan value:  76%|███████▌  | 105/139 [00:00<00:00, 201.20it/s]replace nan value:  91%|█████████ | 126/139 [00:00<00:00, 189.70it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 193.75it/s]
  0%|          | 0/139 [00:00<?, ?it/s]  9%|▊         | 12/139 [00:00<00:01, 113.79it/s] 19%|█▉        | 27/139 [00:00<00:00, 129.64it/s] 32%|███▏      | 44/139 [00:00<00:00, 146.69it/s] 42%|████▏     | 59/139 [00:00<00:00, 136.23it/s] 54%|█████▍    | 75/139 [00:00<00:00, 140.24it/s] 65%|██████▍   | 90/139 [00:00<00:00, 126.73it/s] 76%|███████▌  | 105/139 [00:00<00:00, 131.30it/s] 88%|████████▊ | 122/139 [00:00<00:00, 137.67it/s] 98%|█████████▊| 136/139 [00:01<00:00, 137.11it/s]100%|██████████| 139/139 [00:01<00:00, 136.22it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  17%|█▋        | 30/173 [00:00<00:00, 297.98it/s]extract the null data:  54%|█████▍    | 93/173 [00:00<00:00, 488.61it/s]extract the null data:  91%|█████████ | 157/173 [00:00<00:00, 555.32it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 517.80it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  12%|█▏        | 20/173 [00:00<00:00, 199.77it/s]replace nan value:  24%|██▎       | 41/173 [00:00<00:00, 201.00it/s]replace nan value:  36%|███▌      | 62/173 [00:00<00:00, 200.59it/s]replace nan value:  48%|████▊     | 83/173 [00:00<00:00, 200.17it/s]replace nan value:  60%|██████    | 104/173 [00:00<00:00, 197.01it/s]replace nan value:  72%|███████▏  | 124/173 [00:00<00:00, 195.82it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 195.24it/s]replace nan value:  95%|█████████▍| 164/173 [00:00<00:00, 196.37it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 196.05it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  8%|▊         | 14/173 [00:00<00:01, 127.45it/s] 16%|█▌        | 27/173 [00:00<00:01, 110.86it/s] 24%|██▎       | 41/173 [00:00<00:01, 122.09it/s] 32%|███▏      | 56/173 [00:00<00:00, 131.50it/s] 40%|████      | 70/173 [00:00<00:00, 129.46it/s] 49%|████▊     | 84/173 [00:00<00:00, 129.79it/s] 58%|█████▊    | 100/173 [00:00<00:00, 137.95it/s] 67%|██████▋   | 116/173 [00:00<00:00, 144.17it/s] 76%|███████▌  | 131/173 [00:00<00:00, 137.48it/s] 84%|████████▍ | 146/173 [00:01<00:00, 137.88it/s] 92%|█████████▏| 160/173 [00:01<00:00, 127.94it/s]100%|██████████| 173/173 [00:01<00:00, 99.53it/s] 100%|██████████| 173/173 [00:01<00:00, 121.20it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.048, valid loss : 0.026, train acc : 0.669, valid acc : 0.406, train f1 : 0.652, valid f1 : 0.368
training process:   1%|          | 1/128 [01:26<3:02:46, 86.35s/it]Best score increase :0.000 -> 0.368
training process:   2%|▏         | 2/128 [02:39<2:45:08, 78.64s/it]Best score increase :0.368 -> 0.400
training process:   2%|▏         | 3/128 [03:55<2:40:51, 77.22s/it]Best score increase :0.400 -> 0.431
training process:   3%|▎         | 4/128 [05:02<2:31:27, 73.29s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.021, valid loss : 0.024, train acc : 0.726, valid acc : 0.535, train f1 : 0.707, valid f1 : 0.460
training process:   4%|▍         | 5/128 [06:07<2:24:19, 70.40s/it]Best score increase :0.431 -> 0.460
training process:   5%|▍         | 6/128 [07:10<2:17:51, 67.80s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [08:27<2:22:53, 70.86s/it]Best score increase :0.460 -> 0.488
training process:   6%|▋         | 8/128 [09:45<2:26:26, 73.22s/it]Best score increase :0.488 -> 0.512
epoch : 9, train loss : 0.017, valid loss : 0.022, train acc : 0.778, valid acc : 0.615, train f1 : 0.767, valid f1 : 0.515
training process:   7%|▋         | 9/128 [11:27<2:42:59, 82.18s/it]Best score increase :0.512 -> 0.515
training process:   8%|▊         | 10/128 [12:51<2:42:27, 82.61s/it]Best score increase :0.515 -> 0.562
training process:   9%|▊         | 11/128 [13:48<2:25:43, 74.73s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [14:44<2:13:50, 69.23s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.015, valid loss : 0.021, train acc : 0.809, valid acc : 0.672, train f1 : 0.803, valid f1 : 0.557
training process:  10%|█         | 13/128 [16:22<2:29:03, 77.77s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [17:52<2:35:12, 81.69s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [19:08<2:30:35, 79.96s/it]Best score increase :0.562 -> 0.577
training process:  12%|█▎        | 16/128 [20:30<2:29:55, 80.32s/it]Best score increase :0.577 -> 0.620
epoch : 17, train loss : 0.014, valid loss : 0.017, train acc : 0.835, valid acc : 0.768, train f1 : 0.832, valid f1 : 0.632
training process:  13%|█▎        | 17/128 [21:34<2:19:46, 75.55s/it]Best score increase :0.620 -> 0.632
training process:  14%|█▍        | 18/128 [22:31<2:08:01, 69.83s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [24:04<2:19:48, 76.96s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [25:37<2:26:52, 81.59s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.013, valid loss : 0.016, train acc : 0.851, valid acc : 0.784, train f1 : 0.849, valid f1 : 0.646
training process:  16%|█▋        | 21/128 [27:17<2:35:40, 87.30s/it]Best score increase :0.632 -> 0.646
training process:  17%|█▋        | 22/128 [28:13<2:17:45, 77.97s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [29:09<2:04:35, 71.20s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [30:25<2:06:06, 72.76s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.012, valid loss : 0.017, train acc : 0.863, valid acc : 0.777, train f1 : 0.861, valid f1 : 0.640
training process:  20%|█▉        | 25/128 [31:59<2:15:31, 78.94s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [33:29<2:19:59, 82.34s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [34:58<2:21:59, 84.35s/it]Best score increase :0.646 -> 0.650
training process:  22%|██▏       | 28/128 [35:54<2:06:36, 75.96s/it]Best score increase :0.650 -> 0.670
epoch : 29, train loss : 0.011, valid loss : 0.016, train acc : 0.873, valid acc : 0.799, train f1 : 0.872, valid f1 : 0.660
training process:  23%|██▎       | 29/128 [36:58<1:59:28, 72.41s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [38:25<2:05:17, 76.71s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [39:43<2:04:41, 77.13s/it]Best score increase :0.670 -> 0.690
training process:  25%|██▌       | 32/128 [41:14<2:10:05, 81.30s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.011, valid loss : 0.015, train acc : 0.887, valid acc : 0.833, train f1 : 0.885, valid f1 : 0.695
training process:  26%|██▌       | 33/128 [42:38<2:09:42, 81.92s/it]Best score increase :0.690 -> 0.695
training process:  27%|██▋       | 34/128 [43:52<2:04:44, 79.62s/it]Best score increase :0.695 -> 0.707
training process:  27%|██▋       | 35/128 [44:50<1:53:23, 73.16s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [45:48<1:45:18, 68.68s/it]Best score increase :0.707 -> 0.735
epoch : 37, train loss : 0.010, valid loss : 0.013, train acc : 0.893, valid acc : 0.862, train f1 : 0.892, valid f1 : 0.727
training process:  29%|██▉       | 37/128 [47:07<1:48:43, 71.68s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [47:57<1:37:59, 65.33s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [48:49<1:30:36, 61.08s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [49:40<1:25:19, 58.18s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.010, valid loss : 0.014, train acc : 0.897, valid acc : 0.849, train f1 : 0.896, valid f1 : 0.711
training process:  32%|███▏      | 41/128 [50:40<1:25:18, 58.83s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [51:32<1:21:05, 56.57s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [52:26<1:19:05, 55.83s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [53:19<1:17:07, 55.09s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.009, valid loss : 0.014, train acc : 0.904, valid acc : 0.849, train f1 : 0.903, valid f1 : 0.712
training process:  35%|███▌      | 45/128 [54:19<1:18:09, 56.50s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [55:12<1:15:43, 55.41s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [56:31<1:24:35, 62.66s/it]Best score increase :0.735 -> 0.736
training process:  38%|███▊      | 48/128 [57:50<1:29:48, 67.35s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.008, valid loss : 0.015, train acc : 0.914, valid acc : 0.849, train f1 : 0.913, valid f1 : 0.712
training process:  38%|███▊      | 49/128 [59:17<1:36:37, 73.39s/it]EarlyStopping counter : 2 out of 12
training process:  39%|███▉      | 50/128 [1:00:14<1:29:06, 68.55s/it]EarlyStopping counter : 3 out of 12
training process:  40%|███▉      | 51/128 [1:01:12<1:23:48, 65.31s/it]EarlyStopping counter : 4 out of 12
training process:  41%|████      | 52/128 [1:02:23<1:24:57, 67.07s/it]Best score increase :0.736 -> 0.746
epoch : 53, train loss : 0.008, valid loss : 0.015, train acc : 0.913, valid acc : 0.862, train f1 : 0.913, valid f1 : 0.727
training process:  41%|████▏     | 53/128 [1:03:52<1:32:04, 73.66s/it]EarlyStopping counter : 1 out of 12
training process:  42%|████▏     | 54/128 [1:05:11<1:32:48, 75.25s/it]EarlyStopping counter : 2 out of 12
training process:  43%|████▎     | 55/128 [1:06:17<1:28:08, 72.44s/it]EarlyStopping counter : 3 out of 12
training process:  44%|████▍     | 56/128 [1:07:13<1:21:03, 67.55s/it]EarlyStopping counter : 4 out of 12
epoch : 57, train loss : 0.008, valid loss : 0.013, train acc : 0.919, valid acc : 0.894, train f1 : 0.919, valid f1 : 0.769
training process:  45%|████▍     | 57/128 [1:08:25<1:21:35, 68.95s/it]Best score increase :0.746 -> 0.769
training process:  45%|████▌     | 58/128 [1:09:38<1:21:50, 70.15s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 59/128 [1:10:49<1:20:47, 70.25s/it]EarlyStopping counter : 2 out of 12
training process:  47%|████▋     | 60/128 [1:12:04<1:21:19, 71.76s/it]EarlyStopping counter : 3 out of 12
epoch : 61, train loss : 0.008, valid loss : 0.013, train acc : 0.921, valid acc : 0.874, train f1 : 0.921, valid f1 : 0.742
training process:  48%|████▊     | 61/128 [1:13:24<1:22:59, 74.31s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 62/128 [1:14:20<1:15:25, 68.57s/it]EarlyStopping counter : 5 out of 12
training process:  49%|████▉     | 63/128 [1:15:18<1:10:53, 65.44s/it]EarlyStopping counter : 6 out of 12
training process:  50%|█████     | 64/128 [1:16:28<1:11:12, 66.75s/it]EarlyStopping counter : 7 out of 12
epoch : 65, train loss : 0.008, valid loss : 0.014, train acc : 0.922, valid acc : 0.883, train f1 : 0.922, valid f1 : 0.754
training process:  51%|█████     | 65/128 [1:17:54<1:16:18, 72.68s/it]EarlyStopping counter : 8 out of 12
training process:  52%|█████▏    | 66/128 [1:19:12<1:16:49, 74.34s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 67/128 [1:20:25<1:15:10, 73.95s/it]Best score increase :0.769 -> 0.772
training process:  53%|█████▎    | 68/128 [1:21:23<1:08:55, 68.93s/it]Best score increase :0.772 -> 0.790
epoch : 69, train loss : 0.007, valid loss : 0.014, train acc : 0.928, valid acc : 0.899, train f1 : 0.927, valid f1 : 0.776
training process:  54%|█████▍    | 69/128 [1:22:33<1:08:10, 69.34s/it]EarlyStopping counter : 1 out of 12
training process:  55%|█████▍    | 70/128 [1:23:50<1:09:11, 71.58s/it]EarlyStopping counter : 2 out of 12
training process:  55%|█████▌    | 71/128 [1:25:04<1:08:41, 72.30s/it]EarlyStopping counter : 3 out of 12
training process:  56%|█████▋    | 72/128 [1:26:21<1:08:59, 73.91s/it]EarlyStopping counter : 4 out of 12
epoch : 73, train loss : 0.007, valid loss : 0.014, train acc : 0.931, valid acc : 0.903, train f1 : 0.930, valid f1 : 0.782
training process:  57%|█████▋    | 73/128 [1:27:32<1:06:43, 72.80s/it]EarlyStopping counter : 5 out of 12
training process:  58%|█████▊    | 74/128 [1:28:28<1:01:02, 67.83s/it]EarlyStopping counter : 6 out of 12
training process:  59%|█████▊    | 75/128 [1:29:41<1:01:26, 69.55s/it]EarlyStopping counter : 7 out of 12
training process:  59%|█████▉    | 76/128 [1:30:58<1:02:14, 71.81s/it]EarlyStopping counter : 8 out of 12
epoch : 77, train loss : 0.007, valid loss : 0.014, train acc : 0.934, valid acc : 0.890, train f1 : 0.933, valid f1 : 0.761
training process:  60%|██████    | 77/128 [1:32:18<1:02:57, 74.06s/it]EarlyStopping counter : 9 out of 12
training process:  61%|██████    | 78/128 [1:33:30<1:01:22, 73.65s/it]EarlyStopping counter : 10 out of 12
training process:  62%|██████▏   | 79/128 [1:34:26<55:41, 68.19s/it]  EarlyStopping counter : 11 out of 12
training process:  62%|██████▏   | 79/128 [1:35:32<59:15, 72.56s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 79, best f1 score : 0.790
training process finished, best loss : 0.013 and best acc : 0.909, best f1 : 0.790, best epoch : 67

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.48      0.91      0.63       580
           1       0.99      0.92      0.95      6818

    accuracy                           0.92      7398
   macro avg       0.74      0.91      0.79      7398
weighted avg       0.95      0.92      0.93      7398


# test acc : 0.92, test f1 : 0.79, test AUC : 0.91, test loss : 0.715

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:27,  7.95s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:19,  7.91s/it]processing for feature importance:  25%|██▌       | 3/12 [00:24<01:13,  8.21s/it]processing for feature importance:  33%|███▎      | 4/12 [00:32<01:04,  8.11s/it]processing for feature importance:  42%|████▏     | 5/12 [00:40<00:57,  8.23s/it]processing for feature importance:  50%|█████     | 6/12 [00:48<00:49,  8.21s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:57<00:41,  8.21s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:05<00:32,  8.23s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:13<00:24,  8.19s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:21<00:15,  8.00s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:29<00:08,  8.02s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  7.87s/it]processing for feature importance: 100%|██████████| 12/12 [01:36<00:00,  8.06s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▌         | 16/306 [00:00<00:01, 156.04it/s] 10%|█         | 32/306 [00:00<00:02, 119.74it/s] 15%|█▍        | 45/306 [00:00<00:02, 107.36it/s] 21%|██        | 65/306 [00:00<00:01, 136.16it/s] 27%|██▋       | 84/306 [00:00<00:01, 149.64it/s] 33%|███▎      | 100/306 [00:00<00:01, 142.63it/s] 39%|███▉      | 119/306 [00:00<00:01, 152.44it/s] 44%|████▍     | 135/306 [00:01<00:01, 122.56it/s] 49%|████▊     | 149/306 [00:01<00:01, 122.07it/s] 56%|█████▌    | 172/306 [00:01<00:00, 145.85it/s] 61%|██████▏   | 188/306 [00:01<00:00, 137.39it/s] 69%|██████▉   | 211/306 [00:01<00:00, 159.80it/s] 75%|███████▍  | 228/306 [00:01<00:00, 127.01it/s] 79%|███████▉  | 243/306 [00:01<00:00, 125.11it/s] 86%|████████▋ | 264/306 [00:01<00:00, 144.09it/s] 92%|█████████▏| 280/306 [00:02<00:00, 135.39it/s] 99%|█████████▊| 302/306 [00:02<00:00, 155.56it/s]100%|██████████| 306/306 [00:02<00:00, 138.58it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█▏        | 63/553 [00:00<00:00, 625.51it/s]extract the null data:  23%|██▎       | 129/553 [00:00<00:00, 642.78it/s]extract the null data:  35%|███▌      | 194/553 [00:00<00:00, 645.66it/s]extract the null data:  47%|████▋     | 260/553 [00:00<00:00, 648.21it/s]extract the null data:  59%|█████▉    | 325/553 [00:00<00:00, 648.28it/s]extract the null data:  71%|███████   | 393/553 [00:00<00:00, 657.63it/s]extract the null data:  83%|████████▎ | 459/553 [00:00<00:00, 646.82it/s]extract the null data:  95%|█████████▍| 524/553 [00:00<00:00, 647.29it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 646.11it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 22/553 [00:00<00:02, 214.92it/s]replace nan value:   8%|▊         | 44/553 [00:00<00:02, 214.38it/s]replace nan value:  12%|█▏        | 66/553 [00:00<00:02, 213.75it/s]replace nan value:  16%|█▌        | 88/553 [00:00<00:02, 208.91it/s]replace nan value:  20%|█▉        | 110/553 [00:00<00:02, 212.49it/s]replace nan value:  24%|██▍       | 133/553 [00:00<00:01, 215.89it/s]replace nan value:  28%|██▊       | 157/553 [00:00<00:01, 220.70it/s]replace nan value:  33%|███▎      | 181/553 [00:00<00:01, 224.95it/s]replace nan value:  37%|███▋      | 205/553 [00:00<00:01, 227.85it/s]replace nan value:  41%|████      | 228/553 [00:01<00:01, 227.61it/s]replace nan value:  45%|████▌     | 251/553 [00:01<00:01, 225.75it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 225.65it/s]replace nan value:  54%|█████▎    | 297/553 [00:01<00:01, 226.81it/s]replace nan value:  58%|█████▊    | 320/553 [00:01<00:01, 225.62it/s]replace nan value:  62%|██████▏   | 343/553 [00:01<00:00, 224.00it/s]replace nan value:  66%|██████▌   | 366/553 [00:01<00:00, 225.50it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 227.89it/s]replace nan value:  75%|███████▍  | 414/553 [00:01<00:00, 230.45it/s]replace nan value:  79%|███████▉  | 438/553 [00:01<00:00, 228.88it/s]replace nan value:  84%|████████▎ | 462/553 [00:02<00:00, 229.77it/s]replace nan value:  88%|████████▊ | 485/553 [00:02<00:00, 229.48it/s]replace nan value:  92%|█████████▏| 508/553 [00:02<00:00, 228.53it/s]replace nan value:  96%|█████████▌| 531/553 [00:02<00:00, 227.42it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 224.45it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 145.77it/s]  6%|▌         | 32/553 [00:00<00:03, 159.57it/s]  9%|▊         | 48/553 [00:00<00:03, 130.91it/s] 11%|█         | 62/553 [00:00<00:03, 129.16it/s] 14%|█▍        | 77/553 [00:00<00:03, 134.95it/s] 17%|█▋        | 92/553 [00:00<00:03, 139.54it/s] 19%|█▉        | 107/553 [00:00<00:03, 141.69it/s] 22%|██▏       | 123/553 [00:00<00:02, 146.81it/s] 25%|██▌       | 140/553 [00:00<00:02, 153.13it/s] 29%|██▉       | 160/553 [00:01<00:02, 165.61it/s] 32%|███▏      | 177/553 [00:01<00:02, 164.79it/s] 35%|███▌      | 195/553 [00:01<00:02, 166.96it/s] 39%|███▊      | 213/553 [00:01<00:01, 170.40it/s] 42%|████▏     | 231/553 [00:01<00:02, 155.67it/s] 45%|████▍     | 247/553 [00:01<00:01, 156.23it/s] 48%|████▊     | 264/553 [00:01<00:01, 158.06it/s] 51%|█████     | 280/553 [00:01<00:01, 149.73it/s] 54%|█████▎    | 296/553 [00:01<00:01, 145.11it/s] 56%|█████▌    | 311/553 [00:02<00:01, 142.12it/s] 59%|█████▉    | 326/553 [00:02<00:01, 143.30it/s] 62%|██████▏   | 342/553 [00:02<00:01, 146.02it/s] 65%|██████▍   | 357/553 [00:02<00:01, 140.66it/s] 68%|██████▊   | 374/553 [00:02<00:01, 148.45it/s] 70%|███████   | 389/553 [00:02<00:01, 137.36it/s] 73%|███████▎  | 403/553 [00:02<00:01, 133.37it/s] 75%|███████▌  | 417/553 [00:02<00:01, 133.18it/s] 78%|███████▊  | 431/553 [00:02<00:00, 129.08it/s] 82%|████████▏ | 451/553 [00:03<00:00, 146.88it/s] 85%|████████▍ | 468/553 [00:03<00:00, 152.46it/s] 88%|████████▊ | 484/553 [00:03<00:00, 149.36it/s] 90%|█████████ | 500/553 [00:03<00:00, 138.03it/s] 93%|█████████▎| 517/553 [00:03<00:00, 145.76it/s] 96%|█████████▌| 532/553 [00:03<00:00, 124.54it/s] 99%|█████████▉| 550/553 [00:03<00:00, 137.12it/s]100%|██████████| 553/553 [00:03<00:00, 142.48it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  33%|███▎      | 46/139 [00:00<00:00, 459.72it/s]extract the null data:  86%|████████▌ | 119/139 [00:00<00:00, 615.55it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 608.05it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▊        | 26/139 [00:00<00:00, 250.88it/s]replace nan value:  37%|███▋      | 52/139 [00:00<00:00, 250.50it/s]replace nan value:  56%|█████▌    | 78/139 [00:00<00:00, 248.02it/s]replace nan value:  74%|███████▍  | 103/139 [00:00<00:00, 248.64it/s]replace nan value:  92%|█████████▏| 128/139 [00:00<00:00, 248.40it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 248.39it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 131.98it/s] 22%|██▏       | 30/139 [00:00<00:00, 142.62it/s] 34%|███▍      | 47/139 [00:00<00:00, 154.32it/s] 45%|████▌     | 63/139 [00:00<00:00, 139.60it/s] 56%|█████▌    | 78/139 [00:00<00:00, 135.46it/s] 66%|██████▌   | 92/139 [00:00<00:00, 126.38it/s] 76%|███████▋  | 106/139 [00:00<00:00, 128.75it/s] 89%|████████▉ | 124/139 [00:00<00:00, 142.55it/s]100%|██████████| 139/139 [00:00<00:00, 140.30it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  18%|█▊        | 31/173 [00:00<00:00, 308.42it/s]extract the null data:  63%|██████▎   | 109/173 [00:00<00:00, 582.50it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 596.47it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 26/173 [00:00<00:00, 253.58it/s]replace nan value:  30%|███       | 52/173 [00:00<00:00, 254.05it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 247.82it/s]replace nan value:  60%|█████▉    | 103/173 [00:00<00:00, 242.40it/s]replace nan value:  74%|███████▍  | 128/173 [00:00<00:00, 239.71it/s]replace nan value:  88%|████████▊ | 153/173 [00:00<00:00, 241.54it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 242.34it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 145.57it/s] 17%|█▋        | 30/173 [00:00<00:01, 133.84it/s] 27%|██▋       | 47/173 [00:00<00:00, 148.34it/s] 37%|███▋      | 64/173 [00:00<00:00, 154.15it/s] 46%|████▌     | 80/173 [00:00<00:00, 149.94it/s] 55%|█████▌    | 96/173 [00:00<00:00, 151.05it/s] 65%|██████▌   | 113/173 [00:00<00:00, 155.09it/s] 75%|███████▍  | 129/173 [00:00<00:00, 148.10it/s] 83%|████████▎ | 144/173 [00:00<00:00, 143.63it/s] 92%|█████████▏| 159/173 [00:01<00:00, 131.00it/s]100%|██████████| 173/173 [00:01<00:00, 101.46it/s]100%|██████████| 173/173 [00:01<00:00, 129.74it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.111, valid loss : 0.062, train f1 : 0.597, valid f1 : 0.610
training process - Deferred Re-weighting:   1%|          | 1/128 [00:59<2:05:17, 59.20s/it]Best score increase :0.000 -> 0.610
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:01<2:07:42, 60.81s/it]Best score increase :0.610 -> 0.670
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:09<2:13:37, 64.14s/it]Best score increase :0.670 -> 0.684
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:16<2:15:15, 65.45s/it]Best score increase :0.684 -> 0.726
epoch : 5, train loss : 0.043, valid loss : 0.049, train f1 : 0.779, valid f1 : 0.741
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:34<2:23:03, 69.78s/it]Best score increase :0.726 -> 0.741
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:24<2:08:06, 63.00s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:12<1:57:11, 58.11s/it]Best score increase :0.741 -> 0.766
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:17<2:00:45, 60.38s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.036, valid loss : 0.051, train f1 : 0.825, valid f1 : 0.769
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:38<2:12:37, 66.87s/it]Best score increase :0.766 -> 0.769
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:37<2:06:46, 64.46s/it]Best score increase :0.769 -> 0.785
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:40<2:05:05, 64.15s/it]Best score increase :0.785 -> 0.787
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:37<1:59:45, 61.94s/it]Best score increase :0.787 -> 0.793
epoch : 13, train loss : 0.034, valid loss : 0.052, train f1 : 0.837, valid f1 : 0.783
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:34<1:55:48, 60.42s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [14:32<1:53:30, 59.74s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:37<1:55:30, 61.33s/it]Best score increase :0.793 -> 0.807
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [16:44<1:57:18, 62.84s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.031, valid loss : 0.051, train f1 : 0.854, valid f1 : 0.806
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:07<2:07:26, 68.89s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [19:02<1:59:03, 64.94s/it]Best score increase :0.807 -> 0.808
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [19:52<1:49:46, 60.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [20:50<1:47:25, 59.68s/it]Best score increase :0.808 -> 0.815
epoch : 21, train loss : 0.029, valid loss : 0.053, train f1 : 0.863, valid f1 : 0.810
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [22:17<2:00:52, 67.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [23:30<2:02:16, 69.21s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [24:50<2:07:05, 72.62s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [26:09<2:08:54, 74.37s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.028, valid loss : 0.051, train f1 : 0.871, valid f1 : 0.819
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [27:25<2:08:37, 74.93s/it]Best score increase :0.815 -> 0.819
training process - Deferred Re-weighting:  20%|██        | 26/128 [28:23<1:59:03, 70.03s/it]Best score increase :0.819 -> 0.827
training process - Deferred Re-weighting:  21%|██        | 27/128 [29:27<1:54:47, 68.20s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [30:35<1:53:17, 67.98s/it]EarlyStopping counter : 2 out of 12
epoch : 29, train loss : 0.026, valid loss : 0.050, train f1 : 0.880, valid f1 : 0.828
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [31:56<1:58:43, 71.96s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [33:04<1:55:31, 70.73s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [34:01<1:47:44, 66.64s/it]Best score increase :0.827 -> 0.833
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [34:55<1:40:21, 62.72s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.025, valid loss : 0.049, train f1 : 0.887, valid f1 : 0.834
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [36:12<1:46:03, 66.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [37:30<1:50:08, 70.30s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [38:49<1:53:00, 72.91s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [39:53<1:48:02, 70.46s/it]Best score increase :0.833 -> 0.852
epoch : 37, train loss : 0.024, valid loss : 0.061, train f1 : 0.895, valid f1 : 0.823
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [40:55<1:42:41, 67.71s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [42:09<1:44:42, 69.80s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [43:26<1:46:40, 71.92s/it]Best score increase :0.852 -> 0.857
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [44:32<1:42:53, 70.15s/it]EarlyStopping counter : 1 out of 12
epoch : 41, train loss : 0.023, valid loss : 0.056, train f1 : 0.891, valid f1 : 0.840
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [45:54<1:47:00, 73.80s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [46:49<1:37:39, 68.13s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [47:52<1:34:21, 66.60s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [49:08<1:36:51, 69.18s/it]EarlyStopping counter : 5 out of 12
epoch : 45, train loss : 0.022, valid loss : 0.050, train f1 : 0.903, valid f1 : 0.859
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [50:30<1:41:05, 73.07s/it]Best score increase :0.857 -> 0.859
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [51:36<1:37:12, 71.13s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [52:39<1:32:26, 68.47s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 48/128 [53:31<1:24:58, 63.73s/it]EarlyStopping counter : 3 out of 12
epoch : 49, train loss : 0.021, valid loss : 0.054, train f1 : 0.907, valid f1 : 0.844
training process - Deferred Re-weighting:  38%|███▊      | 49/128 [54:45<1:27:40, 66.58s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  39%|███▉      | 50/128 [56:01<1:30:35, 69.69s/it]Best score increase :0.859 -> 0.862
training process - Deferred Re-weighting:  40%|███▉      | 51/128 [57:08<1:28:12, 68.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  41%|████      | 52/128 [58:23<1:29:17, 70.50s/it]EarlyStopping counter : 2 out of 12
epoch : 53, train loss : 0.021, valid loss : 0.051, train f1 : 0.906, valid f1 : 0.859
training process - Deferred Re-weighting:  41%|████▏     | 53/128 [59:23<1:24:15, 67.41s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  42%|████▏     | 54/128 [1:00:19<1:18:59, 64.05s/it]Best score increase :0.862 -> 0.867
training process - Deferred Re-weighting:  43%|████▎     | 55/128 [1:01:33<1:21:37, 67.09s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 56/128 [1:02:40<1:20:27, 67.04s/it]EarlyStopping counter : 2 out of 12
epoch : 57, train loss : 0.020, valid loss : 0.055, train f1 : 0.913, valid f1 : 0.850
training process - Deferred Re-weighting:  45%|████▍     | 57/128 [1:03:39<1:16:33, 64.69s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  45%|████▌     | 58/128 [1:04:30<1:10:35, 60.50s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 59/128 [1:05:20<1:05:47, 57.20s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  47%|████▋     | 60/128 [1:06:09<1:02:13, 54.90s/it]EarlyStopping counter : 6 out of 12
epoch : 61, train loss : 0.019, valid loss : 0.056, train f1 : 0.917, valid f1 : 0.851
training process - Deferred Re-weighting:  48%|████▊     | 61/128 [1:07:07<1:02:13, 55.72s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 62/128 [1:07:56<59:13, 53.84s/it]  EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  49%|████▉     | 63/128 [1:08:46<57:07, 52.74s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  50%|█████     | 64/128 [1:09:33<54:24, 51.01s/it]EarlyStopping counter : 10 out of 12
epoch : 65, train loss : 0.019, valid loss : 0.054, train f1 : 0.917, valid f1 : 0.859
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:10:30<55:20, 52.71s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  51%|█████     | 65/128 [1:11:46<1:09:33, 66.25s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 65, best f1 score : 0.867
training process finished, best loss : 0.045, best acc : 0.965, best f1 : 0.867, best epoch : 53

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.92      0.64      0.76       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.94      0.82      0.87      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.82, test loss : 2.961

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:20,  7.35s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:16,  7.65s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:09,  7.73s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<01:01,  7.69s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:53,  7.61s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.58s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:52<00:37,  7.48s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.52s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:22,  7.61s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.66s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.70s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.68s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.63s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:01, 145.59it/s] 10%|▉         | 30/306 [00:00<00:02, 135.04it/s] 14%|█▍        | 44/306 [00:00<00:02, 103.82it/s] 18%|█▊        | 56/306 [00:00<00:02, 94.58it/s]  23%|██▎       | 71/306 [00:00<00:02, 109.89it/s] 28%|██▊       | 87/306 [00:00<00:01, 123.35it/s] 33%|███▎      | 101/306 [00:00<00:01, 125.50it/s] 38%|███▊      | 115/306 [00:00<00:01, 117.74it/s] 42%|████▏     | 129/306 [00:01<00:01, 120.93it/s] 46%|████▋     | 142/306 [00:01<00:01, 104.75it/s] 50%|█████     | 153/306 [00:01<00:01, 97.26it/s]  54%|█████▎    | 164/306 [00:01<00:01, 96.54it/s] 59%|█████▉    | 180/306 [00:01<00:01, 112.55it/s] 64%|██████▍   | 196/306 [00:01<00:00, 122.15it/s] 68%|██████▊   | 209/306 [00:01<00:00, 121.45it/s] 73%|███████▎  | 222/306 [00:01<00:00, 111.11it/s] 77%|███████▋  | 237/306 [00:02<00:00, 117.66it/s] 82%|████████▏ | 250/306 [00:02<00:00, 103.34it/s] 85%|████████▌ | 261/306 [00:02<00:00, 96.47it/s]  89%|████████▊ | 271/306 [00:02<00:00, 94.53it/s] 95%|█████████▌| 292/306 [00:02<00:00, 123.46it/s]100%|██████████| 306/306 [00:02<00:00, 125.36it/s]100%|██████████| 306/306 [00:02<00:00, 113.06it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_Focal_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 60/553 [00:00<00:00, 592.87it/s]extract the null data:  22%|██▏       | 122/553 [00:00<00:00, 602.94it/s]extract the null data:  33%|███▎      | 184/553 [00:00<00:00, 608.02it/s]extract the null data:  44%|████▍     | 246/553 [00:00<00:00, 612.19it/s]extract the null data:  56%|█████▌    | 308/553 [00:00<00:00, 595.78it/s]extract the null data:  67%|██████▋   | 369/553 [00:00<00:00, 598.32it/s]extract the null data:  78%|███████▊  | 430/553 [00:00<00:00, 601.33it/s]extract the null data:  89%|████████▉ | 493/553 [00:00<00:00, 607.29it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 605.07it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 208.08it/s]replace nan value:   8%|▊         | 43/553 [00:00<00:02, 209.45it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 209.50it/s]replace nan value:  16%|█▌        | 87/553 [00:00<00:02, 213.87it/s]replace nan value:  20%|█▉        | 109/553 [00:00<00:02, 213.42it/s]replace nan value:  24%|██▎       | 131/553 [00:00<00:01, 213.73it/s]replace nan value:  28%|██▊       | 153/553 [00:00<00:01, 214.49it/s]replace nan value:  32%|███▏      | 175/553 [00:00<00:01, 214.07it/s]replace nan value:  36%|███▌      | 197/553 [00:00<00:01, 213.14it/s]replace nan value:  40%|███▉      | 219/553 [00:01<00:01, 211.38it/s]replace nan value:  44%|████▎     | 241/553 [00:01<00:01, 210.11it/s]replace nan value:  48%|████▊     | 263/553 [00:01<00:01, 210.67it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 210.91it/s]replace nan value:  56%|█████▌    | 307/553 [00:01<00:01, 209.10it/s]replace nan value:  59%|█████▉    | 328/553 [00:01<00:01, 209.16it/s]replace nan value:  63%|██████▎   | 350/553 [00:01<00:00, 209.69it/s]replace nan value:  67%|██████▋   | 371/553 [00:01<00:00, 207.76it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 208.06it/s]replace nan value:  75%|███████▍  | 413/553 [00:01<00:00, 207.43it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 204.84it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 206.93it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 208.59it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 209.47it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 210.43it/s]replace nan value:  98%|█████████▊| 544/553 [00:02<00:00, 210.51it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 210.10it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 145.75it/s]  6%|▌         | 32/553 [00:00<00:03, 156.88it/s]  9%|▊         | 48/553 [00:00<00:03, 129.68it/s] 11%|█         | 62/553 [00:00<00:03, 128.65it/s] 14%|█▍        | 77/553 [00:00<00:03, 132.55it/s] 16%|█▋        | 91/553 [00:00<00:03, 132.57it/s] 19%|█▉        | 106/553 [00:00<00:03, 136.35it/s] 22%|██▏       | 122/553 [00:00<00:03, 141.73it/s] 25%|██▌       | 140/553 [00:00<00:02, 150.94it/s] 29%|██▉       | 159/553 [00:01<00:02, 162.26it/s] 32%|███▏      | 176/553 [00:01<00:02, 160.88it/s] 35%|███▍      | 193/553 [00:01<00:02, 163.04it/s] 38%|███▊      | 211/553 [00:01<00:02, 167.07it/s] 41%|████      | 228/553 [00:01<00:02, 157.89it/s] 44%|████▍     | 244/553 [00:01<00:02, 151.57it/s] 47%|████▋     | 261/553 [00:01<00:01, 155.71it/s] 50%|█████     | 277/553 [00:01<00:01, 147.51it/s] 53%|█████▎    | 292/553 [00:01<00:01, 146.70it/s] 56%|█████▌    | 307/553 [00:02<00:01, 139.30it/s] 58%|█████▊    | 322/553 [00:02<00:01, 137.74it/s] 61%|██████    | 337/553 [00:02<00:01, 139.52it/s] 64%|██████▎   | 352/553 [00:02<00:01, 140.81it/s] 66%|██████▋   | 367/553 [00:02<00:01, 135.93it/s] 69%|██████▉   | 383/553 [00:02<00:01, 142.37it/s] 72%|███████▏  | 398/553 [00:02<00:01, 126.23it/s] 75%|███████▍  | 414/553 [00:02<00:01, 133.82it/s] 77%|███████▋  | 428/553 [00:03<00:01, 121.95it/s] 81%|████████  | 447/553 [00:03<00:00, 138.64it/s] 84%|████████▎ | 463/553 [00:03<00:00, 143.23it/s] 86%|████████▋ | 478/553 [00:03<00:00, 142.02it/s] 89%|████████▉ | 493/553 [00:03<00:00, 136.75it/s] 92%|█████████▏| 508/553 [00:03<00:00, 139.34it/s] 95%|█████████▍| 523/553 [00:03<00:00, 132.86it/s] 97%|█████████▋| 537/553 [00:03<00:00, 123.34it/s]100%|█████████▉| 551/553 [00:03<00:00, 112.78it/s]100%|██████████| 553/553 [00:03<00:00, 138.75it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  29%|██▉       | 40/139 [00:00<00:00, 398.50it/s]extract the null data:  79%|███████▉  | 110/139 [00:00<00:00, 575.49it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 575.96it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 230.29it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 228.40it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 229.68it/s]replace nan value:  68%|██████▊   | 95/139 [00:00<00:00, 229.02it/s]replace nan value:  85%|████████▍ | 118/139 [00:00<00:00, 229.25it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 229.26it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 129.38it/s] 21%|██        | 29/139 [00:00<00:00, 138.93it/s] 33%|███▎      | 46/139 [00:00<00:00, 149.26it/s] 44%|████▍     | 61/139 [00:00<00:00, 134.31it/s] 54%|█████▍    | 75/139 [00:00<00:00, 135.91it/s] 64%|██████▍   | 89/139 [00:00<00:00, 121.20it/s] 75%|███████▍  | 104/139 [00:00<00:00, 129.21it/s] 86%|████████▌ | 119/139 [00:00<00:00, 133.82it/s] 96%|█████████▌| 133/139 [00:01<00:00, 131.54it/s]100%|██████████| 139/139 [00:01<00:00, 134.45it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 354.64it/s]extract the null data:  62%|██████▏   | 107/173 [00:00<00:00, 558.55it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 582.60it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 233.16it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 235.20it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 236.20it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 234.79it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 233.50it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 233.61it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 232.38it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 233.15it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 147.14it/s] 17%|█▋        | 30/173 [00:00<00:01, 131.99it/s] 27%|██▋       | 47/173 [00:00<00:00, 146.55it/s] 37%|███▋      | 64/173 [00:00<00:00, 151.09it/s] 46%|████▌     | 80/173 [00:00<00:00, 146.03it/s] 55%|█████▍    | 95/173 [00:00<00:00, 147.09it/s] 64%|██████▍   | 111/173 [00:00<00:00, 150.94it/s] 73%|███████▎  | 127/173 [00:00<00:00, 142.21it/s] 82%|████████▏ | 142/173 [00:00<00:00, 142.73it/s] 91%|█████████ | 157/173 [00:01<00:00, 127.24it/s] 99%|█████████▉| 171/173 [00:01<00:00, 103.12it/s]100%|██████████| 173/173 [00:01<00:00, 128.90it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.135, valid loss : 0.094, train f1 : 0.727, valid f1 : 0.687
training process - Deferred Re-weighting:   1%|          | 1/128 [01:22<2:53:43, 82.08s/it]Best score increase :0.000 -> 0.687
training process - Deferred Re-weighting:   2%|▏         | 2/128 [02:36<2:42:47, 77.52s/it]Best score increase :0.687 -> 0.711
training process - Deferred Re-weighting:   2%|▏         | 3/128 [03:43<2:31:43, 72.83s/it]Best score increase :0.711 -> 0.762
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:43<2:19:43, 67.61s/it]Best score increase :0.762 -> 0.776
epoch : 5, train loss : 0.087, valid loss : 0.062, train f1 : 0.847, valid f1 : 0.799
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:51<2:19:22, 67.98s/it]Best score increase :0.776 -> 0.799
training process - Deferred Re-weighting:   5%|▍         | 6/128 [07:02<2:20:18, 69.01s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [08:13<2:20:16, 69.55s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:25<2:20:35, 70.29s/it]Best score increase :0.799 -> 0.803
epoch : 9, train loss : 0.072, valid loss : 0.058, train f1 : 0.879, valid f1 : 0.811
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:45<2:25:12, 73.21s/it]Best score increase :0.803 -> 0.811
training process - Deferred Re-weighting:   8%|▊         | 10/128 [12:09<2:30:36, 76.58s/it]Best score increase :0.811 -> 0.814
training process - Deferred Re-weighting:   9%|▊         | 11/128 [13:20<2:25:59, 74.86s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [14:18<2:15:14, 69.95s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.064, valid loss : 0.054, train f1 : 0.895, valid f1 : 0.819
training process - Deferred Re-weighting:  10%|█         | 13/128 [15:26<2:12:31, 69.14s/it]Best score increase :0.814 -> 0.819
training process - Deferred Re-weighting:  11%|█         | 14/128 [16:30<2:08:51, 67.82s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [17:43<2:10:11, 69.13s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [18:56<2:11:18, 70.34s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.058, valid loss : 0.045, train f1 : 0.907, valid f1 : 0.844
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [20:18<2:16:33, 73.82s/it]Best score increase :0.819 -> 0.844
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [21:37<2:18:07, 75.35s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [22:55<2:18:26, 76.21s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [24:05<2:13:43, 74.29s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.054, valid loss : 0.043, train f1 : 0.916, valid f1 : 0.842
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [25:13<2:09:10, 72.43s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [26:18<2:04:12, 70.31s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [27:29<2:03:24, 70.52s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [28:48<2:06:48, 73.16s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.050, valid loss : 0.045, train f1 : 0.921, valid f1 : 0.834
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [30:16<2:13:10, 77.58s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [31:36<2:12:47, 78.11s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [32:49<2:09:13, 76.77s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [33:48<1:58:57, 71.38s/it]Best score increase :0.844 -> 0.850
epoch : 29, train loss : 0.045, valid loss : 0.040, train f1 : 0.930, valid f1 : 0.848
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [34:55<1:55:21, 69.92s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [36:15<1:59:32, 73.19s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [37:25<1:56:44, 72.21s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [38:35<1:54:18, 71.45s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.042, valid loss : 0.038, train f1 : 0.936, valid f1 : 0.859
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [40:01<2:00:03, 75.83s/it]Best score increase :0.850 -> 0.859
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [41:15<1:57:56, 75.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [42:36<1:59:07, 76.85s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [43:35<1:49:53, 71.67s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.038, valid loss : 0.036, train f1 : 0.943, valid f1 : 0.859
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [44:44<1:47:12, 70.69s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [45:51<1:44:38, 69.76s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [47:15<1:49:42, 73.96s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [48:40<1:53:10, 77.17s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.037, valid loss : 0.038, train f1 : 0.944, valid f1 : 0.854
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [50:12<1:58:43, 81.88s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [51:22<1:52:11, 78.27s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [52:22<1:43:03, 72.75s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [53:24<1:37:27, 69.61s/it]EarlyStopping counter : 11 out of 12
epoch : 45, train loss : 0.034, valid loss : 0.040, train f1 : 0.948, valid f1 : 0.854
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [54:57<1:44:55, 74.95s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 44, best f1 score : 0.859
training process finished, best loss : 0.036, best acc : 0.952, best f1 : 0.859, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.70      0.81      0.75       580
           1       0.98      0.97      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.84      0.89      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.89, test loss : 2.191

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:26,  7.83s/it]processing for feature importance:  17%|█▋        | 2/12 [00:15<01:18,  7.90s/it]processing for feature importance:  25%|██▌       | 3/12 [00:23<01:11,  7.95s/it]processing for feature importance:  33%|███▎      | 4/12 [00:31<01:04,  8.01s/it]processing for feature importance:  42%|████▏     | 5/12 [00:39<00:54,  7.81s/it]processing for feature importance:  50%|█████     | 6/12 [00:46<00:46,  7.73s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:54<00:38,  7.66s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:02<00:31,  7.80s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:10<00:23,  7.75s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:17<00:15,  7.77s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:26<00:07,  7.97s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.84s/it]processing for feature importance: 100%|██████████| 12/12 [01:33<00:00,  7.83s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 8/306 [00:00<00:03, 79.00it/s]  6%|▌         | 17/306 [00:00<00:03, 79.96it/s]  8%|▊         | 25/306 [00:00<00:03, 79.68it/s] 11%|█         | 33/306 [00:00<00:03, 79.76it/s] 17%|█▋        | 52/306 [00:00<00:02, 118.43it/s] 22%|██▏       | 67/306 [00:00<00:01, 127.50it/s] 26%|██▌       | 80/306 [00:00<00:01, 118.24it/s] 31%|███       | 95/306 [00:00<00:01, 126.64it/s] 35%|███▌      | 108/306 [00:00<00:01, 126.60it/s] 40%|███▉      | 121/306 [00:01<00:01, 107.80it/s] 43%|████▎     | 133/306 [00:01<00:01, 98.94it/s]  48%|████▊     | 147/306 [00:01<00:01, 108.81it/s] 57%|█████▋    | 173/306 [00:01<00:00, 147.54it/s] 62%|██████▏   | 189/306 [00:01<00:00, 150.90it/s] 67%|██████▋   | 205/306 [00:01<00:00, 146.69it/s] 72%|███████▏  | 221/306 [00:01<00:00, 138.25it/s] 77%|███████▋  | 236/306 [00:01<00:00, 135.58it/s] 82%|████████▏ | 250/306 [00:02<00:00, 114.15it/s] 86%|████████▌ | 263/306 [00:02<00:00, 102.84it/s] 92%|█████████▏| 282/306 [00:02<00:00, 122.61it/s] 97%|█████████▋| 297/306 [00:02<00:00, 129.00it/s]100%|██████████| 306/306 [00:02<00:00, 120.50it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_Normal_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  11%|█         | 61/553 [00:00<00:00, 602.73it/s]extract the null data:  22%|██▏       | 124/553 [00:00<00:00, 616.50it/s]extract the null data:  34%|███▍      | 188/553 [00:00<00:00, 623.83it/s]extract the null data:  46%|████▌     | 252/553 [00:00<00:00, 628.44it/s]extract the null data:  57%|█████▋    | 315/553 [00:00<00:00, 623.53it/s]extract the null data:  68%|██████▊   | 378/553 [00:00<00:00, 622.45it/s]extract the null data:  80%|███████▉  | 442/553 [00:00<00:00, 628.05it/s]extract the null data:  92%|█████████▏| 508/553 [00:00<00:00, 635.14it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 628.61it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 205.65it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 203.21it/s]replace nan value:  12%|█▏        | 64/553 [00:00<00:02, 207.71it/s]replace nan value:  16%|█▌        | 86/553 [00:00<00:02, 210.96it/s]replace nan value:  20%|█▉        | 108/553 [00:00<00:02, 211.97it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:02, 210.08it/s]replace nan value:  27%|██▋       | 152/553 [00:00<00:01, 210.41it/s]replace nan value:  31%|███▏      | 174/553 [00:00<00:01, 210.50it/s]replace nan value:  35%|███▌      | 196/553 [00:00<00:01, 209.22it/s]replace nan value:  39%|███▉      | 217/553 [00:01<00:01, 208.80it/s]replace nan value:  43%|████▎     | 238/553 [00:01<00:01, 208.13it/s]replace nan value:  47%|████▋     | 259/553 [00:01<00:01, 208.16it/s]replace nan value:  51%|█████     | 280/553 [00:01<00:01, 208.46it/s]replace nan value:  55%|█████▍    | 302/553 [00:01<00:01, 209.69it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:01, 210.72it/s]replace nan value:  63%|██████▎   | 346/553 [00:01<00:00, 212.03it/s]replace nan value:  67%|██████▋   | 368/553 [00:01<00:00, 212.98it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 213.16it/s]replace nan value:  75%|███████▍  | 412/553 [00:01<00:00, 214.00it/s]replace nan value:  78%|███████▊  | 434/553 [00:02<00:00, 211.68it/s]replace nan value:  82%|████████▏ | 456/553 [00:02<00:00, 212.13it/s]replace nan value:  86%|████████▋ | 478/553 [00:02<00:00, 211.73it/s]replace nan value:  90%|█████████ | 500/553 [00:02<00:00, 211.22it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 212.48it/s]replace nan value:  98%|█████████▊| 544/553 [00:02<00:00, 210.24it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 210.32it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 143.08it/s]  6%|▌         | 31/553 [00:00<00:03, 152.81it/s]  8%|▊         | 47/553 [00:00<00:03, 129.62it/s] 11%|█         | 61/553 [00:00<00:03, 125.37it/s] 14%|█▎        | 76/553 [00:00<00:03, 132.98it/s] 16%|█▋        | 91/553 [00:00<00:03, 134.04it/s] 19%|█▉        | 106/553 [00:00<00:03, 137.21it/s] 22%|██▏       | 122/553 [00:00<00:03, 141.03it/s] 25%|██▌       | 139/553 [00:00<00:02, 149.20it/s] 29%|██▊       | 158/553 [00:01<00:02, 160.96it/s] 32%|███▏      | 175/553 [00:01<00:02, 161.89it/s] 35%|███▍      | 192/553 [00:01<00:02, 160.51it/s] 38%|███▊      | 211/553 [00:01<00:02, 166.51it/s] 41%|████      | 228/553 [00:01<00:02, 158.40it/s] 44%|████▍     | 244/553 [00:01<00:02, 153.13it/s] 47%|████▋     | 262/553 [00:01<00:01, 159.62it/s] 50%|█████     | 279/553 [00:01<00:01, 149.60it/s] 53%|█████▎    | 295/553 [00:01<00:01, 143.94it/s] 56%|█████▌    | 310/553 [00:02<00:01, 140.54it/s] 59%|█████▉    | 325/553 [00:02<00:01, 140.93it/s] 61%|██████▏   | 340/553 [00:02<00:01, 142.44it/s] 64%|██████▍   | 355/553 [00:02<00:01, 137.90it/s] 67%|██████▋   | 372/553 [00:02<00:01, 144.41it/s] 70%|██████▉   | 387/553 [00:02<00:01, 136.25it/s] 73%|███████▎  | 401/553 [00:02<00:01, 128.50it/s] 75%|███████▌  | 416/553 [00:02<00:01, 131.89it/s] 78%|███████▊  | 430/553 [00:03<00:00, 127.25it/s] 81%|████████  | 449/553 [00:03<00:00, 143.95it/s] 84%|████████▍ | 465/553 [00:03<00:00, 147.05it/s] 87%|████████▋ | 480/553 [00:03<00:00, 143.25it/s] 90%|████████▉ | 495/553 [00:03<00:00, 137.43it/s] 93%|█████████▎| 512/553 [00:03<00:00, 143.72it/s] 95%|█████████▌| 527/553 [00:03<00:00, 128.27it/s] 98%|█████████▊| 541/553 [00:03<00:00, 130.80it/s]100%|██████████| 553/553 [00:03<00:00, 139.85it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  28%|██▊       | 39/139 [00:00<00:00, 385.43it/s]extract the null data:  81%|████████▏ | 113/139 [00:00<00:00, 590.78it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 585.88it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  17%|█▋        | 24/139 [00:00<00:00, 235.03it/s]replace nan value:  35%|███▍      | 48/139 [00:00<00:00, 231.06it/s]replace nan value:  52%|█████▏    | 72/139 [00:00<00:00, 232.06it/s]replace nan value:  69%|██████▉   | 96/139 [00:00<00:00, 232.27it/s]replace nan value:  86%|████████▋ | 120/139 [00:00<00:00, 233.98it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 233.61it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 10%|█         | 14/139 [00:00<00:00, 128.74it/s] 21%|██        | 29/139 [00:00<00:00, 140.59it/s] 34%|███▍      | 47/139 [00:00<00:00, 157.93it/s] 45%|████▌     | 63/139 [00:00<00:00, 149.43it/s] 57%|█████▋    | 79/139 [00:00<00:00, 148.48it/s] 68%|██████▊   | 94/139 [00:00<00:00, 138.59it/s] 78%|███████▊  | 109/139 [00:00<00:00, 140.12it/s] 91%|█████████▏| 127/139 [00:00<00:00, 150.22it/s]100%|██████████| 139/139 [00:00<00:00, 148.26it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██▏       | 37/173 [00:00<00:00, 369.02it/s]extract the null data:  62%|██████▏   | 107/173 [00:00<00:00, 562.36it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 582.83it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  14%|█▍        | 24/173 [00:00<00:00, 236.68it/s]replace nan value:  28%|██▊       | 48/173 [00:00<00:00, 237.58it/s]replace nan value:  42%|████▏     | 72/173 [00:00<00:00, 236.73it/s]replace nan value:  55%|█████▌    | 96/173 [00:00<00:00, 234.18it/s]replace nan value:  69%|██████▉   | 120/173 [00:00<00:00, 234.67it/s]replace nan value:  83%|████████▎ | 144/173 [00:00<00:00, 235.46it/s]replace nan value:  97%|█████████▋| 168/173 [00:00<00:00, 232.50it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 233.54it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▊         | 15/173 [00:00<00:01, 147.06it/s] 17%|█▋        | 30/173 [00:00<00:01, 130.53it/s] 27%|██▋       | 47/173 [00:00<00:00, 145.60it/s] 37%|███▋      | 64/173 [00:00<00:00, 151.57it/s] 46%|████▌     | 80/173 [00:00<00:00, 147.75it/s] 55%|█████▍    | 95/173 [00:00<00:00, 148.19it/s] 64%|██████▍   | 111/173 [00:00<00:00, 151.08it/s] 73%|███████▎  | 127/173 [00:00<00:00, 143.14it/s] 82%|████████▏ | 142/173 [00:00<00:00, 144.94it/s] 91%|█████████ | 157/173 [00:01<00:00, 129.48it/s] 99%|█████████▉| 171/173 [00:01<00:00, 99.51it/s] 100%|██████████| 173/173 [00:01<00:00, 127.65it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.007, train acc : 0.804, valid acc : 0.926, train f1 : 0.592, valid f1 : 0.687
training process:   1%|          | 1/128 [01:33<3:18:34, 93.81s/it]Best score increase :0.000 -> 0.687
training process:   2%|▏         | 2/128 [02:44<2:48:28, 80.22s/it]Best score increase :0.687 -> 0.693
training process:   2%|▏         | 3/128 [03:55<2:37:59, 75.83s/it]Best score increase :0.693 -> 0.711
training process:   3%|▎         | 4/128 [04:54<2:23:28, 69.42s/it]Best score increase :0.711 -> 0.737
epoch : 5, train loss : 0.004, valid loss : 0.003, train acc : 0.950, valid acc : 0.944, train f1 : 0.790, valid f1 : 0.760
training process:   4%|▍         | 5/128 [06:03<2:21:43, 69.13s/it]Best score increase :0.737 -> 0.760
training process:   5%|▍         | 6/128 [07:13<2:21:15, 69.47s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [08:36<2:28:55, 73.85s/it]Best score increase :0.760 -> 0.777
training process:   6%|▋         | 8/128 [10:00<2:34:29, 77.24s/it]Best score increase :0.777 -> 0.785
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.959, valid acc : 0.951, train f1 : 0.833, valid f1 : 0.789
training process:   7%|▋         | 9/128 [11:19<2:34:18, 77.80s/it]Best score increase :0.785 -> 0.789
training process:   8%|▊         | 10/128 [12:29<2:28:12, 75.36s/it]Best score increase :0.789 -> 0.799
training process:   9%|▊         | 11/128 [13:31<2:19:03, 71.32s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [14:32<2:11:22, 67.96s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.002, valid loss : 0.003, train acc : 0.960, valid acc : 0.952, train f1 : 0.840, valid f1 : 0.798
training process:  10%|█         | 13/128 [15:50<2:16:27, 71.19s/it]EarlyStopping counter : 3 out of 12
training process:  11%|█         | 14/128 [17:14<2:22:39, 75.08s/it]EarlyStopping counter : 4 out of 12
training process:  12%|█▏        | 15/128 [18:37<2:25:55, 77.49s/it]Best score increase :0.799 -> 0.815
training process:  12%|█▎        | 16/128 [20:01<2:28:05, 79.33s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.003, train acc : 0.963, valid acc : 0.954, train f1 : 0.853, valid f1 : 0.808
training process:  13%|█▎        | 17/128 [21:18<2:25:18, 78.54s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [22:18<2:13:47, 72.98s/it]Best score increase :0.815 -> 0.818
training process:  15%|█▍        | 19/128 [23:18<2:05:25, 69.04s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [24:40<2:11:40, 73.16s/it]Best score increase :0.818 -> 0.829
epoch : 21, train loss : 0.002, valid loss : 0.003, train acc : 0.965, valid acc : 0.955, train f1 : 0.862, valid f1 : 0.811
training process:  16%|█▋        | 21/128 [26:08<2:17:55, 77.35s/it]EarlyStopping counter : 1 out of 12
training process:  17%|█▋        | 22/128 [27:31<2:19:49, 79.15s/it]EarlyStopping counter : 2 out of 12
training process:  18%|█▊        | 23/128 [28:42<2:14:06, 76.63s/it]EarlyStopping counter : 3 out of 12
training process:  19%|█▉        | 24/128 [30:01<2:14:11, 77.42s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train acc : 0.967, valid acc : 0.959, train f1 : 0.871, valid f1 : 0.836
training process:  20%|█▉        | 25/128 [31:09<2:08:11, 74.67s/it]Best score increase :0.829 -> 0.836
training process:  20%|██        | 26/128 [32:09<1:59:23, 70.23s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [33:05<1:51:09, 66.04s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [33:52<1:40:29, 60.30s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train acc : 0.968, valid acc : 0.958, train f1 : 0.877, valid f1 : 0.828
training process:  23%|██▎       | 29/128 [34:46<1:36:15, 58.34s/it]EarlyStopping counter : 4 out of 12
training process:  23%|██▎       | 30/128 [35:33<1:29:40, 54.90s/it]EarlyStopping counter : 5 out of 12
training process:  24%|██▍       | 31/128 [36:20<1:24:49, 52.47s/it]EarlyStopping counter : 6 out of 12
training process:  25%|██▌       | 32/128 [37:08<1:21:50, 51.15s/it]Best score increase :0.836 -> 0.846
epoch : 33, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.960, train f1 : 0.883, valid f1 : 0.839
training process:  26%|██▌       | 33/128 [38:04<1:23:25, 52.69s/it]EarlyStopping counter : 1 out of 12
training process:  27%|██▋       | 34/128 [38:54<1:21:03, 51.74s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 35/128 [39:43<1:19:06, 51.04s/it]EarlyStopping counter : 3 out of 12
training process:  28%|██▊       | 36/128 [40:30<1:16:20, 49.79s/it]Best score increase :0.846 -> 0.859
epoch : 37, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.957, train f1 : 0.883, valid f1 : 0.825
training process:  29%|██▉       | 37/128 [41:25<1:17:56, 51.39s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [42:10<1:14:23, 49.59s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [42:56<1:11:43, 48.35s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [43:41<1:09:30, 47.40s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train acc : 0.970, valid acc : 0.959, train f1 : 0.887, valid f1 : 0.835
training process:  32%|███▏      | 41/128 [44:34<1:11:11, 49.09s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [45:19<1:08:34, 47.84s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [46:08<1:08:06, 48.08s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [46:59<1:08:33, 48.97s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train acc : 0.972, valid acc : 0.961, train f1 : 0.895, valid f1 : 0.842
training process:  35%|███▌      | 45/128 [47:57<1:11:44, 51.86s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [48:45<1:09:19, 50.73s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [49:35<1:07:59, 50.36s/it]EarlyStopping counter : 11 out of 12
training process:  37%|███▋      | 47/128 [50:23<1:26:51, 64.33s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.859
training process finished, best loss : 0.003 and best acc : 0.964, best f1 : 0.859, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.95      0.61      0.74       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.96      0.80      0.86      7398
weighted avg       0.97      0.97      0.96      7398


# test acc : 0.97, test f1 : 0.86, test AUC : 0.80, test loss : 0.159

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:21,  7.44s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:12,  7.30s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:06,  7.36s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<01:00,  7.51s/it]processing for feature importance:  42%|████▏     | 5/12 [00:38<00:54,  7.82s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:45,  7.60s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:38,  7.66s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:00<00:30,  7.65s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:09<00:23,  7.85s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.65s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:23<00:07,  7.62s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.76s/it]processing for feature importance: 100%|██████████| 12/12 [01:31<00:00,  7.66s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 26/306 [00:00<00:01, 254.52it/s] 17%|█▋        | 53/306 [00:00<00:00, 259.67it/s] 26%|██▌       | 79/306 [00:00<00:00, 248.12it/s] 34%|███▍      | 105/306 [00:00<00:00, 250.62it/s] 43%|████▎     | 131/306 [00:00<00:00, 250.85it/s] 51%|█████▏    | 157/306 [00:00<00:00, 251.00it/s] 60%|█████▉    | 183/306 [00:00<00:00, 249.61it/s] 68%|██████▊   | 208/306 [00:00<00:00, 249.18it/s] 76%|███████▌  | 233/306 [00:00<00:00, 246.07it/s] 85%|████████▍ | 259/306 [00:01<00:00, 247.56it/s] 93%|█████████▎| 284/306 [00:01<00:00, 247.87it/s]100%|██████████| 306/306 [00:01<00:00, 248.79it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 67/553 [00:00<00:00, 665.37it/s]extract the null data:  25%|██▍       | 136/553 [00:00<00:00, 675.19it/s]extract the null data:  37%|███▋      | 204/553 [00:00<00:00, 651.19it/s]extract the null data:  49%|████▉     | 270/553 [00:00<00:00, 636.06it/s]extract the null data:  60%|██████    | 334/553 [00:00<00:00, 629.00it/s]extract the null data:  72%|███████▏  | 397/553 [00:00<00:00, 617.79it/s]extract the null data:  83%|████████▎ | 459/553 [00:00<00:00, 613.89it/s]extract the null data:  94%|█████████▍| 521/553 [00:00<00:00, 605.35it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 621.97it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 21/553 [00:00<00:02, 204.25it/s]replace nan value:   8%|▊         | 42/553 [00:00<00:02, 203.26it/s]replace nan value:  11%|█▏        | 63/553 [00:00<00:02, 196.95it/s]replace nan value:  15%|█▌        | 83/553 [00:00<00:02, 196.70it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:02, 200.13it/s]replace nan value:  23%|██▎       | 125/553 [00:00<00:02, 202.12it/s]replace nan value:  26%|██▋       | 146/553 [00:00<00:01, 204.00it/s]replace nan value:  30%|███       | 167/553 [00:00<00:01, 205.37it/s]replace nan value:  34%|███▍      | 190/553 [00:00<00:01, 210.58it/s]replace nan value:  39%|███▊      | 214/553 [00:01<00:01, 219.16it/s]replace nan value:  43%|████▎     | 237/553 [00:01<00:01, 219.36it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 223.04it/s]replace nan value:  52%|█████▏    | 285/553 [00:01<00:01, 226.09it/s]replace nan value:  56%|█████▌    | 309/553 [00:01<00:01, 227.64it/s]replace nan value:  60%|██████    | 334/553 [00:01<00:00, 231.59it/s]replace nan value:  65%|██████▍   | 359/553 [00:01<00:00, 234.02it/s]replace nan value:  69%|██████▉   | 384/553 [00:01<00:00, 237.18it/s]replace nan value:  74%|███████▍  | 408/553 [00:01<00:00, 236.16it/s]replace nan value:  78%|███████▊  | 432/553 [00:01<00:00, 232.78it/s]replace nan value:  83%|████████▎ | 457/553 [00:02<00:00, 235.33it/s]replace nan value:  87%|████████▋ | 481/553 [00:02<00:00, 233.06it/s]replace nan value:  91%|█████████▏| 505/553 [00:02<00:00, 227.53it/s]replace nan value:  95%|█████████▌| 528/553 [00:02<00:00, 226.07it/s]replace nan value: 100%|█████████▉| 552/553 [00:02<00:00, 228.57it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 221.71it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.52it/s]  5%|▌         | 30/553 [00:00<00:03, 149.18it/s]  8%|▊         | 45/553 [00:00<00:03, 133.39it/s] 11%|█         | 59/553 [00:00<00:04, 121.14it/s] 13%|█▎        | 72/553 [00:00<00:03, 120.73it/s] 16%|█▌        | 88/553 [00:00<00:03, 131.16it/s] 18%|█▊        | 102/553 [00:00<00:03, 125.52it/s] 22%|██▏       | 119/553 [00:00<00:03, 136.77it/s] 24%|██▍       | 133/553 [00:01<00:03, 135.13it/s] 27%|██▋       | 151/553 [00:01<00:02, 147.81it/s] 31%|███       | 170/553 [00:01<00:02, 159.61it/s] 34%|███▍      | 187/553 [00:01<00:02, 155.89it/s] 37%|███▋      | 206/553 [00:01<00:02, 164.64it/s] 40%|████      | 223/553 [00:01<00:02, 154.65it/s] 44%|████▎     | 241/553 [00:01<00:01, 159.39it/s] 47%|████▋     | 258/553 [00:01<00:01, 156.74it/s] 50%|████▉     | 274/553 [00:01<00:01, 154.48it/s] 53%|█████▎    | 291/553 [00:01<00:01, 155.68it/s] 56%|█████▌    | 307/553 [00:02<00:01, 143.54it/s] 58%|█████▊    | 322/553 [00:02<00:01, 142.17it/s] 61%|██████    | 338/553 [00:02<00:01, 146.09it/s] 64%|██████▍   | 354/553 [00:02<00:01, 146.23it/s] 67%|██████▋   | 370/553 [00:02<00:01, 149.47it/s] 70%|██████▉   | 386/553 [00:02<00:01, 143.36it/s] 73%|███████▎  | 401/553 [00:02<00:01, 132.67it/s] 75%|███████▌  | 416/553 [00:02<00:01, 135.31it/s] 78%|███████▊  | 430/553 [00:03<00:00, 130.17it/s] 81%|████████  | 449/553 [00:03<00:00, 146.07it/s] 84%|████████▍ | 465/553 [00:03<00:00, 148.91it/s] 87%|████████▋ | 481/553 [00:03<00:00, 148.49it/s] 90%|████████▉ | 496/553 [00:03<00:00, 141.24it/s] 93%|█████████▎| 513/553 [00:03<00:00, 147.37it/s] 95%|█████████▌| 528/553 [00:03<00:00, 134.06it/s] 98%|█████████▊| 544/553 [00:03<00:00, 138.75it/s]100%|██████████| 553/553 [00:03<00:00, 141.36it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  33%|███▎      | 46/139 [00:00<00:00, 457.21it/s]extract the null data:  94%|█████████▎| 130/139 [00:00<00:00, 680.25it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 654.91it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  21%|██        | 29/139 [00:00<00:00, 280.59it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 282.12it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 281.30it/s]replace nan value:  83%|████████▎ | 116/139 [00:00<00:00, 279.69it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 281.02it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 12%|█▏        | 16/139 [00:00<00:00, 148.76it/s] 25%|██▌       | 35/139 [00:00<00:00, 168.15it/s] 37%|███▋      | 52/139 [00:00<00:00, 159.86it/s] 51%|█████     | 71/139 [00:00<00:00, 166.73it/s] 63%|██████▎   | 88/139 [00:00<00:00, 147.66it/s] 76%|███████▋  | 106/139 [00:00<00:00, 156.11it/s] 89%|████████▉ | 124/139 [00:00<00:00, 161.89it/s]100%|██████████| 139/139 [00:00<00:00, 159.20it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|██        | 35/173 [00:00<00:00, 346.73it/s]extract the null data:  68%|██████▊   | 117/173 [00:00<00:00, 620.07it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 604.04it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 28/173 [00:00<00:00, 272.73it/s]replace nan value:  33%|███▎      | 57/173 [00:00<00:00, 282.02it/s]replace nan value:  51%|█████     | 88/173 [00:00<00:00, 290.68it/s]replace nan value:  68%|██████▊   | 118/173 [00:00<00:00, 289.46it/s]replace nan value:  85%|████████▍ | 147/173 [00:00<00:00, 284.98it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 282.64it/s]
  0%|          | 0/173 [00:00<?, ?it/s] 10%|▉         | 17/173 [00:00<00:00, 169.77it/s] 20%|█▉        | 34/173 [00:00<00:00, 142.82it/s] 31%|███       | 54/173 [00:00<00:00, 165.67it/s] 41%|████      | 71/173 [00:00<00:00, 166.92it/s] 51%|█████     | 88/173 [00:00<00:00, 167.31it/s] 61%|██████    | 105/173 [00:00<00:00, 167.38it/s] 71%|███████   | 122/173 [00:00<00:00, 165.78it/s] 80%|████████  | 139/173 [00:00<00:00, 158.73it/s] 90%|████████▉ | 155/173 [00:00<00:00, 151.56it/s] 99%|█████████▉| 171/173 [00:01<00:00, 106.38it/s]100%|██████████| 173/173 [00:01<00:00, 139.03it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.008, train acc : 0.712, valid acc : 0.823, train f1 : 0.712, valid f1 : 0.650
training process:   1%|          | 1/128 [01:07<2:23:37, 67.85s/it]Best score increase :0.000 -> 0.650
training process:   2%|▏         | 2/128 [01:54<1:56:34, 55.51s/it]Best score increase :0.650 -> 0.697
training process:   2%|▏         | 3/128 [02:45<1:50:43, 53.14s/it]Best score increase :0.697 -> 0.742
training process:   3%|▎         | 4/128 [03:32<1:45:14, 50.92s/it]Best score increase :0.742 -> 0.761
epoch : 5, train loss : 0.007, valid loss : 0.005, train acc : 0.843, valid acc : 0.913, train f1 : 0.843, valid f1 : 0.774
training process:   4%|▍         | 5/128 [04:31<1:50:12, 53.76s/it]Best score increase :0.761 -> 0.774
training process:   5%|▍         | 6/128 [05:21<1:46:47, 52.52s/it]EarlyStopping counter : 1 out of 12
training process:   5%|▌         | 7/128 [06:09<1:42:56, 51.04s/it]EarlyStopping counter : 2 out of 12
training process:   6%|▋         | 8/128 [07:01<1:42:29, 51.25s/it]Best score increase :0.774 -> 0.786
epoch : 9, train loss : 0.006, valid loss : 0.004, train acc : 0.875, valid acc : 0.922, train f1 : 0.875, valid f1 : 0.798
training process:   7%|▋         | 9/128 [08:01<1:47:17, 54.09s/it]Best score increase :0.786 -> 0.798
training process:   8%|▊         | 10/128 [08:53<1:44:54, 53.34s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▊         | 11/128 [09:42<1:41:46, 52.19s/it]EarlyStopping counter : 2 out of 12
training process:   9%|▉         | 12/128 [10:35<1:41:15, 52.38s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.005, valid loss : 0.004, train acc : 0.887, valid acc : 0.927, train f1 : 0.887, valid f1 : 0.809
training process:  10%|█         | 13/128 [11:37<1:45:40, 55.14s/it]Best score increase :0.798 -> 0.809
training process:  11%|█         | 14/128 [12:29<1:43:03, 54.24s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [13:19<1:39:41, 52.93s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [14:10<1:38:03, 52.53s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.005, valid loss : 0.004, train acc : 0.902, valid acc : 0.935, train f1 : 0.902, valid f1 : 0.824
training process:  13%|█▎        | 17/128 [15:09<1:40:37, 54.39s/it]Best score increase :0.809 -> 0.824
training process:  14%|█▍        | 18/128 [15:59<1:37:03, 52.94s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [16:48<1:34:25, 51.98s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [17:38<1:32:35, 51.44s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.004, train acc : 0.910, valid acc : 0.931, train f1 : 0.910, valid f1 : 0.819
training process:  16%|█▋        | 21/128 [18:39<1:36:41, 54.22s/it]EarlyStopping counter : 4 out of 12
training process:  17%|█▋        | 22/128 [19:26<1:32:09, 52.16s/it]EarlyStopping counter : 5 out of 12
training process:  18%|█▊        | 23/128 [20:15<1:29:09, 50.95s/it]EarlyStopping counter : 6 out of 12
training process:  19%|█▉        | 24/128 [21:07<1:29:00, 51.35s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.004, train acc : 0.914, valid acc : 0.935, train f1 : 0.914, valid f1 : 0.828
training process:  20%|█▉        | 25/128 [22:00<1:29:09, 51.93s/it]Best score increase :0.824 -> 0.828
training process:  20%|██        | 26/128 [22:47<1:25:30, 50.29s/it]EarlyStopping counter : 1 out of 12
training process:  21%|██        | 27/128 [23:34<1:23:02, 49.33s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 28/128 [24:20<1:20:39, 48.39s/it]Best score increase :0.828 -> 0.831
epoch : 29, train loss : 0.004, valid loss : 0.004, train acc : 0.920, valid acc : 0.931, train f1 : 0.920, valid f1 : 0.821
training process:  23%|██▎       | 29/128 [25:44<1:37:34, 59.14s/it]EarlyStopping counter : 1 out of 12
training process:  23%|██▎       | 30/128 [26:38<1:33:50, 57.45s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 31/128 [27:49<1:39:31, 61.57s/it]EarlyStopping counter : 3 out of 12
training process:  25%|██▌       | 32/128 [28:43<1:34:49, 59.27s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.004, valid loss : 0.004, train acc : 0.925, valid acc : 0.925, train f1 : 0.925, valid f1 : 0.811
training process:  26%|██▌       | 33/128 [30:01<1:42:50, 64.95s/it]EarlyStopping counter : 5 out of 12
training process:  27%|██▋       | 34/128 [30:54<1:36:23, 61.53s/it]EarlyStopping counter : 6 out of 12
training process:  27%|██▋       | 35/128 [32:06<1:40:08, 64.60s/it]EarlyStopping counter : 7 out of 12
training process:  28%|██▊       | 36/128 [33:01<1:34:27, 61.61s/it]Best score increase :0.831 -> 0.842
epoch : 37, train loss : 0.003, valid loss : 0.003, train acc : 0.931, valid acc : 0.937, train f1 : 0.931, valid f1 : 0.831
training process:  29%|██▉       | 37/128 [34:17<1:40:02, 65.96s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [35:14<1:34:50, 63.23s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [36:16<1:33:13, 62.85s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [37:14<1:30:02, 61.39s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.004, train acc : 0.929, valid acc : 0.924, train f1 : 0.929, valid f1 : 0.808
training process:  32%|███▏      | 41/128 [38:25<1:33:25, 64.43s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [39:27<1:31:17, 63.70s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [40:26<1:28:15, 62.30s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [41:25<1:25:40, 61.20s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.004, train acc : 0.935, valid acc : 0.922, train f1 : 0.935, valid f1 : 0.808
training process:  35%|███▌      | 45/128 [42:32<1:26:54, 62.82s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [43:35<1:25:54, 62.86s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [44:38<1:25:13, 63.13s/it]EarlyStopping counter : 11 out of 12
training process:  37%|███▋      | 47/128 [45:33<1:18:30, 58.15s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.842
training process finished, best loss : 0.003 and best acc : 0.946, best f1 : 0.842, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.79      0.70       580
           1       0.98      0.96      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.80      0.87      0.83      7398
weighted avg       0.95      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.83, test AUC : 0.87, test loss : 0.165

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:23,  7.56s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.43s/it]processing for feature importance:  25%|██▌       | 3/12 [00:22<01:08,  7.60s/it]processing for feature importance:  33%|███▎      | 4/12 [00:30<00:59,  7.49s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.56s/it]processing for feature importance:  50%|█████     | 6/12 [00:45<00:46,  7.79s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:53<00:39,  7.86s/it]processing for feature importance:  67%|██████▋   | 8/12 [01:01<00:30,  7.74s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:08<00:23,  7.67s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:16<00:15,  7.70s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:24<00:07,  7.80s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.73s/it]processing for feature importance: 100%|██████████| 12/12 [01:32<00:00,  7.69s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  3%|▎         | 10/306 [00:00<00:03, 93.35it/s]  9%|▉         | 29/306 [00:00<00:01, 148.40it/s] 14%|█▍        | 44/306 [00:00<00:01, 142.44it/s] 20%|█▉        | 61/306 [00:00<00:01, 151.73it/s] 25%|██▌       | 78/306 [00:00<00:01, 153.08it/s] 31%|███       | 94/306 [00:00<00:01, 140.27it/s] 37%|███▋      | 114/306 [00:00<00:01, 157.09it/s] 42%|████▏     | 130/306 [00:00<00:01, 137.73it/s] 52%|█████▏    | 158/306 [00:01<00:00, 175.80it/s] 58%|█████▊    | 177/306 [00:01<00:00, 178.23it/s] 64%|██████▍   | 196/306 [00:01<00:00, 153.68it/s] 70%|███████   | 215/306 [00:01<00:00, 162.24it/s] 76%|███████▌  | 233/306 [00:01<00:00, 144.61it/s] 82%|████████▏ | 252/306 [00:01<00:00, 155.54it/s] 88%|████████▊ | 269/306 [00:01<00:00, 138.96it/s] 94%|█████████▍| 288/306 [00:01<00:00, 150.75it/s] 99%|█████████▉| 304/306 [00:02<00:00, 137.98it/s]100%|██████████| 306/306 [00:02<00:00, 148.47it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 69/553 [00:00<00:00, 684.08it/s]extract the null data:  25%|██▌       | 141/553 [00:00<00:00, 700.15it/s]extract the null data:  39%|███▊      | 214/553 [00:00<00:00, 710.29it/s]extract the null data:  52%|█████▏    | 286/553 [00:00<00:00, 710.88it/s]extract the null data:  65%|██████▌   | 360/553 [00:00<00:00, 719.45it/s]extract the null data:  79%|███████▊  | 435/553 [00:00<00:00, 727.52it/s]extract the null data:  92%|█████████▏| 510/553 [00:00<00:00, 733.81it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 723.03it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   5%|▍         | 26/553 [00:00<00:02, 256.40it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:01, 257.04it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:01, 257.85it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:01, 255.90it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 257.19it/s]replace nan value:  28%|██▊       | 157/553 [00:00<00:01, 259.26it/s]replace nan value:  33%|███▎      | 183/553 [00:00<00:01, 256.08it/s]replace nan value:  38%|███▊      | 209/553 [00:00<00:01, 252.00it/s]replace nan value:  42%|████▏     | 235/553 [00:00<00:01, 253.09it/s]replace nan value:  47%|████▋     | 261/553 [00:01<00:01, 253.33it/s]replace nan value:  52%|█████▏    | 287/553 [00:01<00:01, 252.05it/s]replace nan value:  57%|█████▋    | 313/553 [00:01<00:00, 254.03it/s]replace nan value:  61%|██████▏   | 340/553 [00:01<00:00, 255.89it/s]replace nan value:  66%|██████▌   | 366/553 [00:01<00:00, 254.80it/s]replace nan value:  71%|███████   | 392/553 [00:01<00:00, 255.21it/s]replace nan value:  76%|███████▌  | 418/553 [00:01<00:00, 254.83it/s]replace nan value:  80%|████████  | 444/553 [00:01<00:00, 254.24it/s]replace nan value:  85%|████████▍ | 470/553 [00:01<00:00, 254.14it/s]replace nan value:  90%|████████▉ | 496/553 [00:01<00:00, 252.04it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 246.85it/s]replace nan value:  99%|█████████▉| 547/553 [00:02<00:00, 242.76it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 252.28it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 16/553 [00:00<00:03, 154.87it/s]  6%|▌         | 33/553 [00:00<00:03, 158.04it/s]  9%|▉         | 49/553 [00:00<00:03, 133.78it/s] 11%|█▏        | 63/553 [00:00<00:03, 132.85it/s] 14%|█▍        | 78/553 [00:00<00:03, 135.92it/s] 17%|█▋        | 94/553 [00:00<00:03, 141.10it/s] 20%|██        | 111/553 [00:00<00:02, 148.61it/s] 23%|██▎       | 126/553 [00:00<00:02, 143.85it/s] 26%|██▋       | 146/553 [00:00<00:02, 159.75it/s] 30%|██▉       | 164/553 [00:01<00:02, 165.40it/s] 33%|███▎      | 181/553 [00:01<00:02, 165.96it/s] 36%|███▌      | 199/553 [00:01<00:02, 169.98it/s] 39%|███▉      | 217/553 [00:01<00:01, 170.27it/s] 42%|████▏     | 235/553 [00:01<00:01, 165.46it/s] 46%|████▌     | 252/553 [00:01<00:01, 163.33it/s] 49%|████▊     | 269/553 [00:01<00:01, 159.45it/s] 52%|█████▏    | 285/553 [00:01<00:01, 156.67it/s] 54%|█████▍    | 301/553 [00:01<00:01, 152.90it/s] 57%|█████▋    | 317/553 [00:02<00:01, 144.57it/s] 60%|██████    | 332/553 [00:02<00:01, 142.46it/s] 63%|██████▎   | 347/553 [00:02<00:01, 142.99it/s] 65%|██████▌   | 362/553 [00:02<00:01, 136.05it/s] 68%|██████▊   | 378/553 [00:02<00:01, 141.27it/s] 71%|███████   | 393/553 [00:02<00:01, 131.20it/s] 74%|███████▍  | 409/553 [00:02<00:01, 137.42it/s] 76%|███████▋  | 423/553 [00:02<00:00, 133.29it/s] 79%|███████▉  | 438/553 [00:02<00:00, 137.10it/s] 83%|████████▎ | 458/553 [00:03<00:00, 152.18it/s] 86%|████████▌ | 476/553 [00:03<00:00, 159.28it/s] 89%|████████▉ | 493/553 [00:03<00:00, 147.83it/s] 92%|█████████▏| 509/553 [00:03<00:00, 150.90it/s] 95%|█████████▍| 525/553 [00:03<00:00, 139.86it/s] 98%|█████████▊| 540/553 [00:03<00:00, 137.87it/s]100%|██████████| 553/553 [00:03<00:00, 145.77it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  41%|████      | 57/139 [00:00<00:00, 568.74it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 695.45it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  21%|██        | 29/139 [00:00<00:00, 280.54it/s]replace nan value:  42%|████▏     | 58/139 [00:00<00:00, 278.38it/s]replace nan value:  63%|██████▎   | 87/139 [00:00<00:00, 279.60it/s]replace nan value:  83%|████████▎ | 116/139 [00:00<00:00, 280.21it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 279.37it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 11%|█         | 15/139 [00:00<00:00, 142.13it/s] 22%|██▏       | 31/139 [00:00<00:00, 151.61it/s] 35%|███▌      | 49/139 [00:00<00:00, 159.61it/s] 47%|████▋     | 66/139 [00:00<00:00, 160.14it/s] 60%|█████▉    | 83/139 [00:00<00:00, 153.60it/s] 71%|███████   | 99/139 [00:00<00:00, 144.22it/s] 83%|████████▎ | 115/139 [00:00<00:00, 147.48it/s] 94%|█████████▍| 131/139 [00:00<00:00, 149.89it/s]100%|██████████| 139/139 [00:00<00:00, 152.44it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  20%|██        | 35/173 [00:00<00:00, 349.76it/s]extract the null data:  66%|██████▌   | 114/173 [00:00<00:00, 607.11it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 626.60it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 26/173 [00:00<00:00, 259.70it/s]replace nan value:  31%|███       | 53/173 [00:00<00:00, 259.94it/s]replace nan value:  46%|████▌     | 80/173 [00:00<00:00, 264.30it/s]replace nan value:  62%|██████▏   | 108/173 [00:00<00:00, 268.64it/s]replace nan value:  79%|███████▊  | 136/173 [00:00<00:00, 270.62it/s]replace nan value:  95%|█████████▍| 164/173 [00:00<00:00, 270.95it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 267.96it/s]
  0%|          | 0/173 [00:00<?, ?it/s] 10%|█         | 18/173 [00:00<00:00, 172.56it/s] 21%|██        | 36/173 [00:00<00:00, 152.38it/s] 32%|███▏      | 56/173 [00:00<00:00, 170.20it/s] 43%|████▎     | 74/173 [00:00<00:00, 172.21it/s] 53%|█████▎    | 92/173 [00:00<00:00, 168.03it/s] 64%|██████▎   | 110/173 [00:00<00:00, 171.16it/s] 74%|███████▍  | 128/173 [00:00<00:00, 162.45it/s] 84%|████████▍ | 145/173 [00:00<00:00, 156.60it/s] 93%|█████████▎| 161/173 [00:01<00:00, 143.06it/s]100%|██████████| 173/173 [00:01<00:00, 143.81it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.010, train acc : 0.602, valid acc : 0.737, train f1 : 0.485, valid f1 : 0.584
training process:   1%|          | 1/128 [01:23<2:55:50, 83.08s/it]Best score increase :0.000 -> 0.584
training process:   2%|▏         | 2/128 [02:15<2:16:33, 65.03s/it]Best score increase :0.584 -> 0.635
training process:   2%|▏         | 3/128 [03:16<2:11:54, 63.31s/it]Best score increase :0.635 -> 0.717
training process:   3%|▎         | 4/128 [04:09<2:02:11, 59.13s/it]Best score increase :0.717 -> 0.741
epoch : 5, train loss : 0.008, valid loss : 0.008, train acc : 0.841, valid acc : 0.916, train f1 : 0.679, valid f1 : 0.768
training process:   4%|▍         | 5/128 [05:10<2:02:17, 59.66s/it]Best score increase :0.741 -> 0.768
training process:   5%|▍         | 6/128 [06:02<1:56:08, 57.12s/it]Best score increase :0.768 -> 0.788
training process:   5%|▌         | 7/128 [06:55<1:52:20, 55.71s/it]Best score increase :0.788 -> 0.794
training process:   6%|▋         | 8/128 [07:47<1:49:37, 54.81s/it]Best score increase :0.794 -> 0.810
epoch : 9, train loss : 0.007, valid loss : 0.007, train acc : 0.889, valid acc : 0.939, train f1 : 0.737, valid f1 : 0.808
training process:   7%|▋         | 9/128 [08:47<1:51:41, 56.31s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [09:43<1:50:33, 56.22s/it]Best score increase :0.810 -> 0.818
training process:   9%|▊         | 11/128 [10:36<1:47:31, 55.14s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [11:41<1:52:44, 58.32s/it]Best score increase :0.818 -> 0.828
epoch : 13, train loss : 0.006, valid loss : 0.008, train acc : 0.906, valid acc : 0.948, train f1 : 0.766, valid f1 : 0.825
training process:  10%|█         | 13/128 [12:41<1:52:50, 58.87s/it]EarlyStopping counter : 1 out of 12
training process:  11%|█         | 14/128 [13:48<1:55:58, 61.04s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 15/128 [14:41<1:50:24, 58.63s/it]Best score increase :0.828 -> 0.836
training process:  12%|█▎        | 16/128 [15:49<1:54:49, 61.51s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.006, valid loss : 0.007, train acc : 0.920, valid acc : 0.950, train f1 : 0.788, valid f1 : 0.833
training process:  13%|█▎        | 17/128 [16:50<1:53:28, 61.34s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 18/128 [17:58<1:56:19, 63.45s/it]Best score increase :0.836 -> 0.852
training process:  15%|█▍        | 19/128 [18:51<1:49:46, 60.42s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 20/128 [19:57<1:51:36, 62.00s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.005, valid loss : 0.008, train acc : 0.929, valid acc : 0.951, train f1 : 0.805, valid f1 : 0.837
training process:  16%|█▋        | 21/128 [20:59<1:50:14, 61.82s/it]EarlyStopping counter : 3 out of 12
training process:  17%|█▋        | 22/128 [22:04<1:50:56, 62.80s/it]EarlyStopping counter : 4 out of 12
training process:  18%|█▊        | 23/128 [22:57<1:44:47, 59.88s/it]EarlyStopping counter : 5 out of 12
training process:  19%|█▉        | 24/128 [24:09<1:50:29, 63.74s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.005, valid loss : 0.007, train acc : 0.932, valid acc : 0.954, train f1 : 0.811, valid f1 : 0.849
training process:  20%|█▉        | 25/128 [25:11<1:48:27, 63.18s/it]EarlyStopping counter : 7 out of 12
training process:  20%|██        | 26/128 [26:22<1:51:01, 65.31s/it]EarlyStopping counter : 8 out of 12
training process:  21%|██        | 27/128 [27:34<1:53:30, 67.43s/it]EarlyStopping counter : 9 out of 12
training process:  22%|██▏       | 28/128 [28:47<1:55:24, 69.24s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.008, train acc : 0.936, valid acc : 0.955, train f1 : 0.821, valid f1 : 0.851
training process:  23%|██▎       | 29/128 [29:48<1:50:07, 66.74s/it]EarlyStopping counter : 11 out of 12
training process:  23%|██▎       | 29/128 [30:58<1:45:43, 64.07s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 29, best f1 score : 0.852
training process finished, best loss : 0.007 and best acc : 0.954, best f1 : 0.852, best epoch : 17

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.69      0.74      0.72       580
           1       0.98      0.97      0.97      6818

    accuracy                           0.95      7398
   macro avg       0.83      0.86      0.85      7398
weighted avg       0.96      0.95      0.95      7398


# test acc : 0.95, test f1 : 0.85, test AUC : 0.86, test loss : 0.410

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:18,  7.09s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:12,  7.24s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:05,  7.33s/it]processing for feature importance:  33%|███▎      | 4/12 [00:29<01:00,  7.54s/it]processing for feature importance:  42%|████▏     | 5/12 [00:37<00:52,  7.56s/it]processing for feature importance:  50%|█████     | 6/12 [00:44<00:44,  7.37s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:51<00:36,  7.25s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:58<00:28,  7.23s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:05<00:21,  7.24s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:13<00:14,  7.32s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:20<00:07,  7.30s/it]processing for feature importance: 100%|██████████| 12/12 [01:27<00:00,  7.32s/it]processing for feature importance: 100%|██████████| 12/12 [01:27<00:00,  7.33s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  5%|▍         | 15/306 [00:00<00:02, 144.42it/s] 10%|▉         | 30/306 [00:00<00:02, 124.34it/s] 17%|█▋        | 51/306 [00:00<00:01, 158.30it/s] 22%|██▏       | 68/306 [00:00<00:01, 140.52it/s] 29%|██▉       | 89/306 [00:00<00:01, 158.46it/s] 35%|███▍      | 106/306 [00:00<00:01, 156.29it/s] 41%|████      | 124/306 [00:00<00:01, 162.68it/s] 47%|████▋     | 143/306 [00:00<00:00, 168.45it/s] 53%|█████▎    | 161/306 [00:01<00:00, 152.15it/s] 59%|█████▉    | 182/306 [00:01<00:00, 167.64it/s] 65%|██████▌   | 200/306 [00:01<00:00, 148.74it/s] 72%|███████▏  | 221/306 [00:01<00:00, 163.68it/s] 78%|███████▊  | 239/306 [00:01<00:00, 152.43it/s] 85%|████████▍ | 259/306 [00:01<00:00, 164.35it/s] 91%|█████████ | 277/306 [00:01<00:00, 160.92it/s] 96%|█████████▌| 294/306 [00:01<00:00, 159.14it/s]100%|██████████| 306/306 [00:01<00:00, 160.08it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_RW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  13%|█▎        | 70/553 [00:00<00:00, 694.49it/s]extract the null data:  26%|██▌       | 144/553 [00:00<00:00, 720.91it/s]extract the null data:  39%|███▉      | 217/553 [00:00<00:00, 720.12it/s]extract the null data:  53%|█████▎    | 291/553 [00:00<00:00, 726.73it/s]extract the null data:  66%|██████▌   | 364/553 [00:00<00:00, 725.37it/s]extract the null data:  79%|███████▉  | 437/553 [00:00<00:00, 716.63it/s]extract the null data:  92%|█████████▏| 509/553 [00:00<00:00, 715.04it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 715.58it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   5%|▍         | 26/553 [00:00<00:02, 255.18it/s]replace nan value:   9%|▉         | 52/553 [00:00<00:02, 249.47it/s]replace nan value:  14%|█▍        | 78/553 [00:00<00:01, 249.83it/s]replace nan value:  19%|█▉        | 104/553 [00:00<00:01, 251.90it/s]replace nan value:  24%|██▎       | 130/553 [00:00<00:01, 254.09it/s]replace nan value:  28%|██▊       | 156/553 [00:00<00:01, 254.34it/s]replace nan value:  33%|███▎      | 182/553 [00:00<00:01, 254.69it/s]replace nan value:  38%|███▊      | 208/553 [00:00<00:01, 255.53it/s]replace nan value:  42%|████▏     | 234/553 [00:00<00:01, 255.23it/s]replace nan value:  47%|████▋     | 260/553 [00:01<00:01, 252.46it/s]replace nan value:  52%|█████▏    | 286/553 [00:01<00:01, 250.68it/s]replace nan value:  56%|█████▋    | 312/553 [00:01<00:00, 249.03it/s]replace nan value:  61%|██████    | 338/553 [00:01<00:00, 251.74it/s]replace nan value:  66%|██████▌   | 364/553 [00:01<00:00, 251.51it/s]replace nan value:  71%|███████   | 390/553 [00:01<00:00, 251.29it/s]replace nan value:  75%|███████▌  | 416/553 [00:01<00:00, 253.21it/s]replace nan value:  80%|███████▉  | 442/553 [00:01<00:00, 252.81it/s]replace nan value:  85%|████████▍ | 469/553 [00:01<00:00, 255.71it/s]replace nan value:  90%|████████▉ | 495/553 [00:01<00:00, 255.53it/s]replace nan value:  94%|█████████▍| 522/553 [00:02<00:00, 256.99it/s]replace nan value:  99%|█████████▉| 548/553 [00:02<00:00, 255.35it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 253.27it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 15/553 [00:00<00:03, 147.76it/s]  6%|▌         | 32/553 [00:00<00:03, 159.92it/s]  9%|▊         | 48/553 [00:00<00:03, 136.22it/s] 11%|█         | 62/553 [00:00<00:03, 134.29it/s] 14%|█▍        | 78/553 [00:00<00:03, 139.52it/s] 17%|█▋        | 93/553 [00:00<00:03, 142.75it/s] 20%|█▉        | 109/553 [00:00<00:03, 147.19it/s] 23%|██▎       | 125/553 [00:00<00:02, 150.35it/s] 26%|██▌       | 145/553 [00:00<00:02, 163.80it/s] 30%|██▉       | 165/553 [00:01<00:02, 172.21it/s] 33%|███▎      | 183/553 [00:01<00:02, 171.02it/s] 37%|███▋      | 202/553 [00:01<00:02, 173.02it/s] 40%|███▉      | 220/553 [00:01<00:01, 167.09it/s] 43%|████▎     | 237/553 [00:01<00:01, 167.55it/s] 46%|████▌     | 254/553 [00:01<00:01, 161.54it/s] 49%|████▉     | 271/553 [00:01<00:01, 157.34it/s] 52%|█████▏    | 289/553 [00:01<00:01, 163.12it/s] 55%|█████▌    | 306/553 [00:01<00:01, 146.65it/s] 58%|█████▊    | 322/553 [00:02<00:01, 146.61it/s] 61%|██████    | 338/553 [00:02<00:01, 149.12it/s] 64%|██████▍   | 354/553 [00:02<00:01, 147.54it/s] 67%|██████▋   | 369/553 [00:02<00:01, 147.28it/s] 69%|██████▉   | 384/553 [00:02<00:01, 147.53it/s] 72%|███████▏  | 399/553 [00:02<00:01, 128.62it/s] 75%|███████▌  | 416/553 [00:02<00:01, 135.20it/s] 78%|███████▊  | 430/553 [00:02<00:00, 131.47it/s] 81%|████████▏ | 450/553 [00:02<00:00, 149.48it/s] 84%|████████▍ | 467/553 [00:03<00:00, 154.06it/s] 87%|████████▋ | 483/553 [00:03<00:00, 154.26it/s] 90%|█████████ | 499/553 [00:03<00:00, 147.08it/s] 93%|█████████▎| 517/553 [00:03<00:00, 154.89it/s] 96%|█████████▋| 533/553 [00:03<00:00, 135.20it/s]100%|█████████▉| 551/553 [00:03<00:00, 126.41it/s]100%|██████████| 553/553 [00:03<00:00, 147.83it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  32%|███▏      | 44/139 [00:00<00:00, 436.20it/s]extract the null data:  88%|████████▊ | 123/139 [00:00<00:00, 639.61it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 625.37it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  20%|██        | 28/139 [00:00<00:00, 279.43it/s]replace nan value:  40%|████      | 56/139 [00:00<00:00, 277.89it/s]replace nan value:  60%|██████    | 84/139 [00:00<00:00, 275.93it/s]replace nan value:  81%|████████  | 112/139 [00:00<00:00, 275.65it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 275.65it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 12%|█▏        | 16/139 [00:00<00:00, 142.87it/s] 25%|██▌       | 35/139 [00:00<00:00, 167.20it/s] 37%|███▋      | 52/139 [00:00<00:00, 160.74it/s] 50%|████▉     | 69/139 [00:00<00:00, 160.77it/s] 62%|██████▏   | 86/139 [00:00<00:00, 152.39it/s] 73%|███████▎  | 102/139 [00:00<00:00, 144.70it/s] 86%|████████▌ | 119/139 [00:00<00:00, 150.84it/s] 97%|█████████▋| 135/139 [00:00<00:00, 149.45it/s]100%|██████████| 139/139 [00:00<00:00, 153.71it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██▏       | 37/173 [00:00<00:00, 365.96it/s]extract the null data:  67%|██████▋   | 116/173 [00:00<00:00, 610.39it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 624.67it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 28/173 [00:00<00:00, 271.94it/s]replace nan value:  32%|███▏      | 56/173 [00:00<00:00, 270.06it/s]replace nan value:  49%|████▊     | 84/173 [00:00<00:00, 270.94it/s]replace nan value:  65%|██████▍   | 112/173 [00:00<00:00, 271.02it/s]replace nan value:  81%|████████  | 140/173 [00:00<00:00, 267.46it/s]replace nan value:  97%|█████████▋| 167/173 [00:00<00:00, 266.92it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 268.36it/s]
  0%|          | 0/173 [00:00<?, ?it/s] 10%|█         | 18/173 [00:00<00:00, 169.45it/s] 20%|██        | 35/173 [00:00<00:00, 152.29it/s] 32%|███▏      | 56/173 [00:00<00:00, 174.98it/s] 43%|████▎     | 74/173 [00:00<00:00, 175.59it/s] 53%|█████▎    | 92/173 [00:00<00:00, 173.77it/s] 65%|██████▍   | 112/173 [00:00<00:00, 180.24it/s] 76%|███████▌  | 131/173 [00:00<00:00, 170.37it/s] 86%|████████▌ | 149/173 [00:00<00:00, 164.47it/s] 96%|█████████▌| 166/173 [00:01<00:00, 134.96it/s]100%|██████████| 173/173 [00:01<00:00, 151.62it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.010, valid loss : 0.011, train acc : 0.687, valid acc : 0.563, train f1 : 0.681, valid f1 : 0.475
training process:   1%|          | 1/128 [01:02<2:12:32, 62.62s/it]Best score increase :0.000 -> 0.475
training process:   2%|▏         | 2/128 [01:55<1:59:57, 57.12s/it]EarlyStopping counter : 1 out of 12
training process:   2%|▏         | 3/128 [02:48<1:54:31, 54.97s/it]EarlyStopping counter : 2 out of 12
training process:   3%|▎         | 4/128 [03:44<1:54:55, 55.61s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.003, valid loss : 0.014, train acc : 0.729, valid acc : 0.494, train f1 : 0.711, valid f1 : 0.431
training process:   4%|▍         | 5/128 [04:45<1:57:57, 57.54s/it]EarlyStopping counter : 4 out of 12
training process:   5%|▍         | 6/128 [05:56<2:06:17, 62.11s/it]EarlyStopping counter : 5 out of 12
training process:   5%|▌         | 7/128 [06:49<1:59:09, 59.08s/it]EarlyStopping counter : 6 out of 12
training process:   6%|▋         | 8/128 [07:53<2:01:09, 60.58s/it]Best score increase :0.475 -> 0.489
epoch : 9, train loss : 0.003, valid loss : 0.014, train acc : 0.762, valid acc : 0.533, train f1 : 0.749, valid f1 : 0.459
training process:   7%|▋         | 9/128 [09:03<2:06:15, 63.66s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 10/128 [10:01<2:01:18, 61.68s/it]Best score increase :0.489 -> 0.502
training process:   9%|▊         | 11/128 [11:17<2:09:01, 66.17s/it]EarlyStopping counter : 1 out of 12
training process:   9%|▉         | 12/128 [12:32<2:12:56, 68.77s/it]EarlyStopping counter : 2 out of 12
epoch : 13, train loss : 0.002, valid loss : 0.012, train acc : 0.790, valid acc : 0.615, train f1 : 0.782, valid f1 : 0.516
training process:  10%|█         | 13/128 [13:54<2:19:39, 72.87s/it]Best score increase :0.502 -> 0.516
training process:  11%|█         | 14/128 [15:11<2:20:48, 74.11s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 15/128 [16:09<2:10:22, 69.23s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▎        | 16/128 [17:08<2:03:41, 66.26s/it]Best score increase :0.516 -> 0.558
epoch : 17, train loss : 0.002, valid loss : 0.010, train acc : 0.810, valid acc : 0.685, train f1 : 0.804, valid f1 : 0.565
training process:  13%|█▎        | 17/128 [18:19<2:05:07, 67.64s/it]Best score increase :0.558 -> 0.565
training process:  14%|█▍        | 18/128 [19:17<1:58:30, 64.64s/it]EarlyStopping counter : 1 out of 12
training process:  15%|█▍        | 19/128 [20:30<2:01:54, 67.11s/it]EarlyStopping counter : 2 out of 12
training process:  16%|█▌        | 20/128 [21:22<1:52:50, 62.69s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.010, train acc : 0.830, valid acc : 0.728, train f1 : 0.826, valid f1 : 0.599
training process:  16%|█▋        | 21/128 [22:47<2:03:28, 69.24s/it]Best score increase :0.565 -> 0.599
training process:  17%|█▋        | 22/128 [23:59<2:04:01, 70.20s/it]EarlyStopping counter : 1 out of 12
training process:  18%|█▊        | 23/128 [24:51<1:53:29, 64.85s/it]EarlyStopping counter : 2 out of 12
training process:  19%|█▉        | 24/128 [26:03<1:56:01, 66.94s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.010, train acc : 0.842, valid acc : 0.711, train f1 : 0.839, valid f1 : 0.585
training process:  20%|█▉        | 25/128 [27:04<1:51:36, 65.02s/it]EarlyStopping counter : 4 out of 12
training process:  20%|██        | 26/128 [28:02<1:47:15, 63.09s/it]EarlyStopping counter : 5 out of 12
training process:  21%|██        | 27/128 [28:55<1:40:58, 59.99s/it]EarlyStopping counter : 6 out of 12
training process:  22%|██▏       | 28/128 [29:49<1:37:11, 58.31s/it]EarlyStopping counter : 7 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.009, train acc : 0.850, valid acc : 0.762, train f1 : 0.847, valid f1 : 0.627
training process:  23%|██▎       | 29/128 [30:50<1:37:10, 58.90s/it]Best score increase :0.599 -> 0.627
training process:  23%|██▎       | 30/128 [31:43<1:33:17, 57.12s/it]EarlyStopping counter : 1 out of 12
training process:  24%|██▍       | 31/128 [32:36<1:30:16, 55.84s/it]Best score increase :0.627 -> 0.639
training process:  25%|██▌       | 32/128 [33:28<1:27:54, 54.94s/it]EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.010, train acc : 0.864, valid acc : 0.743, train f1 : 0.861, valid f1 : 0.610
training process:  26%|██▌       | 33/128 [34:45<1:37:11, 61.39s/it]EarlyStopping counter : 2 out of 12
training process:  27%|██▋       | 34/128 [35:44<1:35:06, 60.71s/it]Best score increase :0.639 -> 0.654
training process:  27%|██▋       | 35/128 [36:43<1:33:30, 60.33s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 36/128 [37:43<1:32:05, 60.06s/it]Best score increase :0.654 -> 0.692
epoch : 37, train loss : 0.002, valid loss : 0.009, train acc : 0.873, valid acc : 0.763, train f1 : 0.872, valid f1 : 0.628
training process:  29%|██▉       | 37/128 [38:52<1:35:04, 62.69s/it]EarlyStopping counter : 1 out of 12
training process:  30%|██▉       | 38/128 [39:47<1:30:40, 60.45s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 39/128 [40:49<1:30:22, 60.92s/it]EarlyStopping counter : 3 out of 12
training process:  31%|███▏      | 40/128 [42:07<1:36:47, 65.99s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.009, train acc : 0.882, valid acc : 0.761, train f1 : 0.880, valid f1 : 0.625
training process:  32%|███▏      | 41/128 [43:25<1:40:57, 69.62s/it]EarlyStopping counter : 5 out of 12
training process:  33%|███▎      | 42/128 [44:17<1:32:26, 64.50s/it]EarlyStopping counter : 6 out of 12
training process:  34%|███▎      | 43/128 [45:22<1:31:25, 64.54s/it]EarlyStopping counter : 7 out of 12
training process:  34%|███▍      | 44/128 [46:16<1:25:54, 61.37s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.001, valid loss : 0.010, train acc : 0.885, valid acc : 0.756, train f1 : 0.884, valid f1 : 0.622
training process:  35%|███▌      | 45/128 [47:37<1:33:06, 67.31s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 46/128 [48:41<1:30:41, 66.36s/it]EarlyStopping counter : 10 out of 12
training process:  37%|███▋      | 47/128 [49:35<1:24:22, 62.50s/it]EarlyStopping counter : 11 out of 12
training process:  37%|███▋      | 47/128 [50:51<1:27:38, 64.92s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.692
training process finished, best loss : 0.008 and best acc : 0.833, best f1 : 0.692, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.32      0.93      0.48       580
           1       0.99      0.84      0.91      6818

    accuracy                           0.84      7398
   macro avg       0.66      0.88      0.69      7398
weighted avg       0.94      0.84      0.87      7398


# test acc : 0.84, test f1 : 0.69, test AUC : 0.88, test loss : 0.425

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:17,  7.08s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:10,  7.00s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:03,  7.05s/it]processing for feature importance:  33%|███▎      | 4/12 [00:27<00:55,  6.95s/it]processing for feature importance:  42%|████▏     | 5/12 [00:35<00:49,  7.02s/it]processing for feature importance:  50%|█████     | 6/12 [00:42<00:42,  7.02s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:49<00:35,  7.15s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:57<00:29,  7.27s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:04<00:21,  7.22s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:11<00:14,  7.28s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:18<00:07,  7.20s/it]processing for feature importance: 100%|██████████| 12/12 [01:25<00:00,  7.10s/it]processing for feature importance: 100%|██████████| 12/12 [01:25<00:00,  7.12s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  7%|▋         | 21/306 [00:00<00:01, 198.24it/s] 13%|█▎        | 41/306 [00:00<00:01, 158.27it/s] 21%|██        | 63/306 [00:00<00:01, 176.35it/s] 27%|██▋       | 82/306 [00:00<00:01, 162.01it/s] 32%|███▏      | 99/306 [00:00<00:01, 162.49it/s] 39%|███▉      | 120/306 [00:00<00:01, 175.23it/s] 45%|████▌     | 138/306 [00:00<00:01, 151.41it/s] 52%|█████▏    | 158/306 [00:00<00:00, 163.61it/s] 57%|█████▋    | 175/306 [00:01<00:00, 146.27it/s] 66%|██████▋   | 203/306 [00:01<00:00, 179.69it/s] 73%|███████▎  | 224/306 [00:01<00:00, 186.25it/s] 80%|███████▉  | 244/306 [00:01<00:00, 163.18it/s] 87%|████████▋ | 265/306 [00:01<00:00, 174.86it/s] 93%|█████████▎| 284/306 [00:01<00:00, 164.78it/s]100%|██████████| 306/306 [00:01<00:00, 178.97it/s]100%|██████████| 306/306 [00:01<00:00, 169.62it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 68/553 [00:00<00:00, 679.54it/s]extract the null data:  25%|██▌       | 139/553 [00:00<00:00, 695.75it/s]extract the null data:  38%|███▊      | 210/553 [00:00<00:00, 699.71it/s]extract the null data:  51%|█████     | 282/553 [00:00<00:00, 704.13it/s]extract the null data:  64%|██████▍   | 353/553 [00:00<00:00, 700.72it/s]extract the null data:  77%|███████▋  | 424/553 [00:00<00:00, 699.82it/s]extract the null data:  89%|████████▉ | 494/553 [00:00<00:00, 699.54it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 696.57it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 24/553 [00:00<00:02, 230.95it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:02, 229.66it/s]replace nan value:  13%|█▎        | 73/553 [00:00<00:02, 234.43it/s]replace nan value:  18%|█▊        | 98/553 [00:00<00:01, 237.55it/s]replace nan value:  22%|██▏       | 123/553 [00:00<00:01, 240.43it/s]replace nan value:  27%|██▋       | 148/553 [00:00<00:01, 241.91it/s]replace nan value:  31%|███▏      | 173/553 [00:00<00:01, 244.04it/s]replace nan value:  36%|███▌      | 199/553 [00:00<00:01, 246.42it/s]replace nan value:  41%|████      | 224/553 [00:00<00:01, 241.66it/s]replace nan value:  45%|████▌     | 249/553 [00:01<00:01, 242.10it/s]replace nan value:  50%|████▉     | 274/553 [00:01<00:01, 241.59it/s]replace nan value:  54%|█████▍    | 299/553 [00:01<00:01, 240.22it/s]replace nan value:  59%|█████▊    | 324/553 [00:01<00:00, 239.30it/s]replace nan value:  63%|██████▎   | 349/553 [00:01<00:00, 239.73it/s]replace nan value:  68%|██████▊   | 374/553 [00:01<00:00, 241.88it/s]replace nan value:  72%|███████▏  | 399/553 [00:01<00:00, 242.73it/s]replace nan value:  77%|███████▋  | 424/553 [00:01<00:00, 242.37it/s]replace nan value:  81%|████████  | 449/553 [00:01<00:00, 243.55it/s]replace nan value:  86%|████████▌ | 474/553 [00:01<00:00, 241.82it/s]replace nan value:  90%|█████████ | 499/553 [00:02<00:00, 241.62it/s]replace nan value:  95%|█████████▍| 524/553 [00:02<00:00, 242.59it/s]replace nan value:  99%|█████████▉| 549/553 [00:02<00:00, 244.40it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 241.37it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 138.18it/s]  5%|▌         | 29/553 [00:00<00:03, 143.98it/s]  8%|▊         | 44/553 [00:00<00:03, 132.22it/s] 10%|█         | 58/553 [00:00<00:03, 124.28it/s] 13%|█▎        | 71/553 [00:00<00:03, 123.26it/s] 16%|█▌        | 89/553 [00:00<00:03, 137.49it/s] 19%|█▊        | 103/553 [00:00<00:03, 134.42it/s] 22%|██▏       | 121/553 [00:00<00:02, 145.64it/s] 25%|██▍       | 137/553 [00:00<00:02, 147.92it/s] 28%|██▊       | 156/553 [00:01<00:02, 158.61it/s] 31%|███▏      | 174/553 [00:01<00:02, 159.32it/s] 35%|███▍      | 191/553 [00:01<00:02, 160.13it/s] 38%|███▊      | 210/553 [00:01<00:02, 164.52it/s] 41%|████      | 227/553 [00:01<00:02, 155.44it/s] 44%|████▍     | 243/553 [00:01<00:02, 154.22it/s] 47%|████▋     | 259/553 [00:01<00:01, 153.61it/s] 50%|████▉     | 275/553 [00:01<00:01, 151.21it/s] 53%|█████▎    | 291/553 [00:01<00:01, 152.71it/s] 56%|█████▌    | 307/553 [00:02<00:01, 140.42it/s] 58%|█████▊    | 322/553 [00:02<00:01, 138.15it/s] 61%|██████    | 337/553 [00:02<00:01, 139.24it/s] 64%|██████▍   | 353/553 [00:02<00:01, 142.57it/s] 67%|██████▋   | 368/553 [00:02<00:01, 142.27it/s] 70%|██████▉   | 385/553 [00:02<00:01, 144.00it/s] 72%|███████▏  | 400/553 [00:02<00:01, 131.24it/s] 75%|███████▌  | 416/553 [00:02<00:01, 136.51it/s] 78%|███████▊  | 430/553 [00:03<00:00, 132.21it/s] 82%|████████▏ | 451/553 [00:03<00:00, 150.58it/s] 85%|████████▍ | 469/553 [00:03<00:00, 157.17it/s] 88%|████████▊ | 485/553 [00:03<00:00, 155.32it/s] 91%|█████████ | 501/553 [00:03<00:00, 145.36it/s] 94%|█████████▍| 519/553 [00:03<00:00, 151.64it/s] 97%|█████████▋| 535/553 [00:03<00:00, 131.29it/s]100%|█████████▉| 551/553 [00:03<00:00, 121.74it/s]100%|██████████| 553/553 [00:03<00:00, 142.32it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  36%|███▌      | 50/139 [00:00<00:00, 495.42it/s]extract the null data:  93%|█████████▎| 129/139 [00:00<00:00, 664.72it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 646.39it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 27/139 [00:00<00:00, 260.28it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 265.07it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 266.79it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 264.19it/s]replace nan value:  98%|█████████▊| 136/139 [00:00<00:00, 267.23it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 266.27it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 11%|█         | 15/139 [00:00<00:00, 144.78it/s] 22%|██▏       | 31/139 [00:00<00:00, 152.12it/s] 35%|███▍      | 48/139 [00:00<00:00, 158.73it/s] 46%|████▌     | 64/139 [00:00<00:00, 149.86it/s] 58%|█████▊    | 80/139 [00:00<00:00, 146.22it/s] 68%|██████▊   | 95/139 [00:00<00:00, 136.85it/s] 78%|███████▊  | 109/139 [00:00<00:00, 137.78it/s] 91%|█████████▏| 127/139 [00:00<00:00, 148.19it/s]100%|██████████| 139/139 [00:00<00:00, 147.88it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  21%|██        | 36/173 [00:00<00:00, 359.59it/s]extract the null data:  65%|██████▌   | 113/173 [00:00<00:00, 599.68it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 622.08it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  16%|█▌        | 27/173 [00:00<00:00, 263.17it/s]replace nan value:  31%|███       | 54/173 [00:00<00:00, 261.34it/s]replace nan value:  47%|████▋     | 81/173 [00:00<00:00, 253.53it/s]replace nan value:  62%|██████▏   | 107/173 [00:00<00:00, 251.35it/s]replace nan value:  77%|███████▋  | 134/173 [00:00<00:00, 255.67it/s]replace nan value:  92%|█████████▏| 160/173 [00:00<00:00, 255.51it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 255.40it/s]
  0%|          | 0/173 [00:00<?, ?it/s] 10%|█         | 18/173 [00:00<00:00, 174.88it/s] 21%|██        | 36/173 [00:00<00:00, 155.88it/s] 33%|███▎      | 57/173 [00:00<00:00, 175.63it/s] 43%|████▎     | 75/173 [00:00<00:00, 172.88it/s] 54%|█████▍    | 93/173 [00:00<00:00, 175.22it/s] 65%|██████▍   | 112/173 [00:00<00:00, 177.98it/s] 75%|███████▌  | 130/173 [00:00<00:00, 170.04it/s] 86%|████████▌ | 148/173 [00:00<00:00, 163.86it/s] 95%|█████████▌| 165/173 [00:01<00:00, 145.89it/s]100%|██████████| 173/173 [00:01<00:00, 149.38it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.007, train f1 : 0.592, valid f1 : 0.687
training process - Deferred Re-weighting:   1%|          | 1/128 [01:01<2:10:08, 61.48s/it]Best score increase :0.000 -> 0.687
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:54<1:58:06, 56.24s/it]Best score increase :0.687 -> 0.693
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:47<1:54:57, 55.18s/it]Best score increase :0.693 -> 0.711
training process - Deferred Re-weighting:   3%|▎         | 4/128 [04:01<2:08:58, 62.41s/it]Best score increase :0.711 -> 0.737
epoch : 5, train loss : 0.004, valid loss : 0.003, train f1 : 0.790, valid f1 : 0.762
training process - Deferred Re-weighting:   4%|▍         | 5/128 [05:24<2:23:17, 69.90s/it]Best score increase :0.737 -> 0.762
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:43<2:28:08, 72.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:57<2:27:58, 73.38s/it]Best score increase :0.762 -> 0.779
training process - Deferred Re-weighting:   6%|▋         | 8/128 [09:12<2:27:51, 73.93s/it]Best score increase :0.779 -> 0.785
epoch : 9, train loss : 0.003, valid loss : 0.003, train f1 : 0.835, valid f1 : 0.790
training process - Deferred Re-weighting:   7%|▋         | 9/128 [10:37<2:33:26, 77.37s/it]Best score increase :0.785 -> 0.790
training process - Deferred Re-weighting:   8%|▊         | 10/128 [11:53<2:31:07, 76.85s/it]Best score increase :0.790 -> 0.798
training process - Deferred Re-weighting:   9%|▊         | 11/128 [13:08<2:28:47, 76.30s/it]Best score increase :0.798 -> 0.802
training process - Deferred Re-weighting:   9%|▉         | 12/128 [14:22<2:26:23, 75.72s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.002, valid loss : 0.003, train f1 : 0.842, valid f1 : 0.798
training process - Deferred Re-weighting:  10%|█         | 13/128 [15:45<2:29:05, 77.79s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [16:52<2:21:54, 74.69s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [17:45<2:08:05, 68.01s/it]Best score increase :0.802 -> 0.820
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [18:37<1:58:04, 63.25s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.003, train f1 : 0.856, valid f1 : 0.811
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [19:37<1:55:20, 62.35s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [20:30<1:48:49, 59.36s/it]Best score increase :0.820 -> 0.825
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [21:22<1:44:03, 57.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [22:15<1:40:38, 55.91s/it]Best score increase :0.825 -> 0.837
epoch : 21, train loss : 0.002, valid loss : 0.003, train f1 : 0.866, valid f1 : 0.813
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [23:23<1:45:57, 59.41s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [24:42<1:55:32, 65.40s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [25:59<2:00:24, 68.81s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [27:15<2:03:18, 71.14s/it]EarlyStopping counter : 4 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.003, train f1 : 0.876, valid f1 : 0.841
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [28:42<2:10:05, 75.78s/it]Best score increase :0.837 -> 0.841
training process - Deferred Re-weighting:  20%|██        | 26/128 [29:47<2:03:20, 72.55s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [30:40<1:52:12, 66.66s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [31:57<1:56:12, 69.73s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.003, train f1 : 0.881, valid f1 : 0.840
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [33:22<2:02:32, 74.26s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [34:38<2:02:24, 74.95s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [35:55<2:02:02, 75.48s/it]Best score increase :0.841 -> 0.845
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [37:15<2:02:47, 76.75s/it]Best score increase :0.845 -> 0.849
epoch : 33, train loss : 0.002, valid loss : 0.003, train f1 : 0.893, valid f1 : 0.842
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [38:26<1:59:11, 75.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [39:19<1:47:08, 68.39s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [40:12<1:38:46, 63.73s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [41:04<1:32:39, 60.43s/it]Best score increase :0.849 -> 0.871
epoch : 37, train loss : 0.002, valid loss : 0.003, train f1 : 0.893, valid f1 : 0.830
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [42:04<1:31:26, 60.29s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [42:57<1:26:58, 57.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [43:49<1:23:31, 56.31s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [44:58<1:28:15, 60.17s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.002, valid loss : 0.003, train f1 : 0.895, valid f1 : 0.842
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [46:23<1:37:49, 67.46s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [47:37<1:39:36, 69.50s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [48:55<1:42:02, 72.03s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [50:11<1:42:38, 73.31s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.002, valid loss : 0.003, train f1 : 0.902, valid f1 : 0.856
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [51:38<1:46:58, 77.33s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [52:53<1:44:49, 76.71s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [53:48<1:34:44, 70.18s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [54:51<1:34:32, 70.03s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.871
training process finished, best loss : 0.003, best acc : 0.966, best f1 : 0.871, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.94      0.64      0.76       580
           1       0.97      1.00      0.98      6818

    accuracy                           0.97      7398
   macro avg       0.96      0.82      0.87      7398
weighted avg       0.97      0.97      0.97      7398


# test acc : 0.97, test f1 : 0.87, test AUC : 0.82, test loss : 0.156

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:07<01:19,  7.19s/it]processing for feature importance:  17%|█▋        | 2/12 [00:14<01:14,  7.44s/it]processing for feature importance:  25%|██▌       | 3/12 [00:21<01:05,  7.24s/it]processing for feature importance:  33%|███▎      | 4/12 [00:28<00:56,  7.05s/it]processing for feature importance:  42%|████▏     | 5/12 [00:35<00:49,  7.09s/it]processing for feature importance:  50%|█████     | 6/12 [00:43<00:43,  7.21s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:50<00:35,  7.18s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:56<00:27,  6.99s/it]processing for feature importance:  75%|███████▌  | 9/12 [01:04<00:21,  7.05s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:11<00:14,  7.12s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:19<00:07,  7.36s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.22s/it]processing for feature importance: 100%|██████████| 12/12 [01:26<00:00,  7.18s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  6%|▌         | 17/306 [00:00<00:01, 168.25it/s] 11%|█         | 34/306 [00:00<00:02, 123.89it/s] 17%|█▋        | 52/306 [00:00<00:01, 143.96it/s] 22%|██▏       | 68/306 [00:00<00:01, 124.27it/s] 28%|██▊       | 86/306 [00:00<00:01, 139.89it/s] 33%|███▎      | 101/306 [00:00<00:01, 132.48it/s] 39%|███▉      | 119/306 [00:00<00:01, 144.71it/s] 44%|████▍     | 135/306 [00:00<00:01, 136.02it/s] 49%|████▉     | 150/306 [00:01<00:01, 134.01it/s] 55%|█████▍    | 167/306 [00:01<00:00, 143.46it/s] 59%|█████▉    | 182/306 [00:01<00:00, 126.06it/s] 65%|██████▌   | 200/306 [00:01<00:00, 138.91it/s] 70%|███████   | 215/306 [00:01<00:00, 125.44it/s] 76%|███████▋  | 234/306 [00:01<00:00, 138.07it/s] 81%|████████▏ | 249/306 [00:01<00:00, 132.13it/s] 87%|████████▋ | 266/306 [00:01<00:00, 141.54it/s] 94%|█████████▍| 287/306 [00:02<00:00, 156.94it/s] 99%|█████████▉| 304/306 [00:02<00:00, 141.43it/s]100%|██████████| 306/306 [00:02<00:00, 137.13it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : Transformer-exp_clip_21_dist_3_LDAM_RS_DRW_seed_43
extract the null data:   0%|          | 0/553 [00:00<?, ?it/s]extract the null data:  12%|█▏        | 68/553 [00:00<00:00, 677.84it/s]extract the null data:  25%|██▌       | 140/553 [00:00<00:00, 701.82it/s]extract the null data:  38%|███▊      | 211/553 [00:00<00:00, 701.92it/s]extract the null data:  51%|█████     | 282/553 [00:00<00:00, 688.14it/s]extract the null data:  63%|██████▎   | 351/553 [00:00<00:00, 680.70it/s]extract the null data:  76%|███████▌  | 420/553 [00:00<00:00, 672.54it/s]extract the null data:  89%|████████▊ | 490/553 [00:00<00:00, 678.83it/s]extract the null data: 100%|██████████| 553/553 [00:00<00:00, 681.67it/s]
replace nan value:   0%|          | 0/553 [00:00<?, ?it/s]replace nan value:   4%|▍         | 24/553 [00:00<00:02, 237.46it/s]replace nan value:   9%|▊         | 48/553 [00:00<00:02, 235.66it/s]replace nan value:  13%|█▎        | 72/553 [00:00<00:02, 237.13it/s]replace nan value:  18%|█▊        | 97/553 [00:00<00:01, 238.58it/s]replace nan value:  22%|██▏       | 122/553 [00:00<00:01, 238.95it/s]replace nan value:  27%|██▋       | 147/553 [00:00<00:01, 239.72it/s]replace nan value:  31%|███       | 172/553 [00:00<00:01, 240.80it/s]replace nan value:  36%|███▌      | 197/553 [00:00<00:01, 241.43it/s]replace nan value:  40%|████      | 222/553 [00:00<00:01, 238.95it/s]replace nan value:  44%|████▍     | 246/553 [00:01<00:01, 237.33it/s]replace nan value:  49%|████▉     | 270/553 [00:01<00:01, 236.97it/s]replace nan value:  53%|█████▎    | 294/553 [00:01<00:01, 237.67it/s]replace nan value:  58%|█████▊    | 319/553 [00:01<00:00, 239.92it/s]replace nan value:  62%|██████▏   | 344/553 [00:01<00:00, 240.15it/s]replace nan value:  67%|██████▋   | 369/553 [00:01<00:00, 241.53it/s]replace nan value:  71%|███████   | 394/553 [00:01<00:00, 241.48it/s]replace nan value:  76%|███████▌  | 419/553 [00:01<00:00, 242.52it/s]replace nan value:  80%|████████  | 444/553 [00:01<00:00, 244.33it/s]replace nan value:  85%|████████▍ | 469/553 [00:01<00:00, 244.98it/s]replace nan value:  89%|████████▉ | 494/553 [00:02<00:00, 243.32it/s]replace nan value:  94%|█████████▍| 519/553 [00:02<00:00, 239.05it/s]replace nan value:  98%|█████████▊| 543/553 [00:02<00:00, 238.50it/s]replace nan value: 100%|██████████| 553/553 [00:02<00:00, 239.82it/s]
  0%|          | 0/553 [00:00<?, ?it/s]  3%|▎         | 14/553 [00:00<00:03, 137.72it/s]  6%|▌         | 31/553 [00:00<00:03, 154.23it/s]  8%|▊         | 47/553 [00:00<00:03, 133.26it/s] 11%|█         | 61/553 [00:00<00:03, 130.57it/s] 14%|█▍        | 77/553 [00:00<00:03, 137.88it/s] 17%|█▋        | 93/553 [00:00<00:03, 140.60it/s] 20%|█▉        | 109/553 [00:00<00:03, 145.25it/s] 23%|██▎       | 125/553 [00:00<00:02, 148.34it/s] 26%|██▌       | 144/553 [00:00<00:02, 159.73it/s] 29%|██▉       | 163/553 [00:01<00:02, 167.77it/s] 33%|███▎      | 181/553 [00:01<00:02, 170.00it/s] 36%|███▌      | 200/553 [00:01<00:02, 174.41it/s] 39%|███▉      | 218/553 [00:01<00:01, 171.76it/s] 43%|████▎     | 236/553 [00:01<00:01, 166.95it/s] 46%|████▌     | 253/553 [00:01<00:01, 163.91it/s] 49%|████▉     | 270/553 [00:01<00:01, 157.78it/s] 52%|█████▏    | 286/553 [00:01<00:01, 157.86it/s] 55%|█████▍    | 302/553 [00:01<00:01, 152.87it/s] 58%|█████▊    | 318/553 [00:02<00:01, 143.93it/s] 60%|██████    | 333/553 [00:02<00:01, 144.47it/s] 63%|██████▎   | 348/553 [00:02<00:01, 145.21it/s] 66%|██████▌   | 363/553 [00:02<00:01, 141.71it/s] 69%|██████▊   | 379/553 [00:02<00:01, 146.81it/s] 71%|███████   | 394/553 [00:02<00:01, 137.09it/s] 74%|███████▍  | 410/553 [00:02<00:01, 142.23it/s] 77%|███████▋  | 425/553 [00:02<00:00, 131.88it/s] 80%|███████▉  | 442/553 [00:02<00:00, 141.15it/s] 83%|████████▎ | 461/553 [00:03<00:00, 153.00it/s] 86%|████████▋ | 478/553 [00:03<00:00, 150.76it/s] 89%|████████▉ | 494/553 [00:03<00:00, 144.06it/s] 92%|█████████▏| 510/553 [00:03<00:00, 148.37it/s] 95%|█████████▌| 526/553 [00:03<00:00, 133.57it/s] 98%|█████████▊| 540/553 [00:03<00:00, 132.51it/s]100%|██████████| 553/553 [00:03<00:00, 145.35it/s]
extract the null data:   0%|          | 0/139 [00:00<?, ?it/s]extract the null data:  39%|███▉      | 54/139 [00:00<00:00, 535.26it/s]extract the null data:  92%|█████████▏| 128/139 [00:00<00:00, 652.75it/s]extract the null data: 100%|██████████| 139/139 [00:00<00:00, 641.52it/s]
replace nan value:   0%|          | 0/139 [00:00<?, ?it/s]replace nan value:  19%|█▉        | 27/139 [00:00<00:00, 261.61it/s]replace nan value:  39%|███▉      | 54/139 [00:00<00:00, 264.42it/s]replace nan value:  58%|█████▊    | 81/139 [00:00<00:00, 264.07it/s]replace nan value:  78%|███████▊  | 108/139 [00:00<00:00, 263.71it/s]replace nan value:  97%|█████████▋| 135/139 [00:00<00:00, 265.58it/s]replace nan value: 100%|██████████| 139/139 [00:00<00:00, 265.23it/s]
  0%|          | 0/139 [00:00<?, ?it/s] 11%|█         | 15/139 [00:00<00:00, 147.69it/s] 23%|██▎       | 32/139 [00:00<00:00, 157.72it/s] 36%|███▌      | 50/139 [00:00<00:00, 163.57it/s] 48%|████▊     | 67/139 [00:00<00:00, 159.27it/s] 60%|█████▉    | 83/139 [00:00<00:00, 156.29it/s] 71%|███████   | 99/139 [00:00<00:00, 148.19it/s] 83%|████████▎ | 116/139 [00:00<00:00, 153.65it/s] 95%|█████████▍| 132/139 [00:00<00:00, 152.77it/s]100%|██████████| 139/139 [00:00<00:00, 157.03it/s]
extract the null data:   0%|          | 0/173 [00:00<?, ?it/s]extract the null data:  23%|██▎       | 39/173 [00:00<00:00, 386.66it/s]extract the null data:  68%|██████▊   | 118/173 [00:00<00:00, 620.88it/s]extract the null data: 100%|██████████| 173/173 [00:00<00:00, 627.81it/s]
replace nan value:   0%|          | 0/173 [00:00<?, ?it/s]replace nan value:  15%|█▌        | 26/173 [00:00<00:00, 258.15it/s]replace nan value:  30%|███       | 52/173 [00:00<00:00, 257.24it/s]replace nan value:  45%|████▌     | 78/173 [00:00<00:00, 256.48it/s]replace nan value:  61%|██████    | 105/173 [00:00<00:00, 260.23it/s]replace nan value:  76%|███████▋  | 132/173 [00:00<00:00, 261.80it/s]replace nan value:  92%|█████████▏| 159/173 [00:00<00:00, 263.45it/s]replace nan value: 100%|██████████| 173/173 [00:00<00:00, 260.66it/s]
  0%|          | 0/173 [00:00<?, ?it/s]  9%|▉         | 16/173 [00:00<00:00, 157.21it/s] 18%|█▊        | 32/173 [00:00<00:01, 137.73it/s] 30%|███       | 52/173 [00:00<00:00, 159.11it/s] 40%|███▉      | 69/173 [00:00<00:00, 156.78it/s] 49%|████▉     | 85/173 [00:00<00:00, 157.40it/s] 58%|█████▊    | 101/173 [00:00<00:00, 157.12it/s] 68%|██████▊   | 118/173 [00:00<00:00, 157.01it/s] 77%|███████▋  | 134/173 [00:00<00:00, 149.07it/s] 86%|████████▌ | 149/173 [00:00<00:00, 143.76it/s] 95%|█████████▍| 164/173 [00:01<00:00, 134.07it/s]100%|██████████| 173/173 [00:01<00:00, 135.57it/s]
train data : 22810, disrupt : 1837, non-disrupt : 20973
valid data : 5421, disrupt : 456, non-disrupt : 4965
test data : 7398, disrupt : 580, non-disrupt : 6818

################# model summary #################

-----------------------------------------------------------------------------------
           Layer (type)                Input Shape         Param #     Tr. Param #
===================================================================================
           NoiseLayer-1                [2, 21, 12]               0               0
               Linear-2                [2, 21, 12]           1,664           1,664
   PositionalEncoding-3               [21, 2, 128]               0               0
   TransformerEncoder-4     [21, 2, 128], [21, 21]         793,088         793,088
               Linear-5                   [2, 128]          16,512          16,512
          BatchNorm1d-6                   [2, 128]             256             256
                 GELU-7                   [2, 128]               0               0
               Linear-8                   [2, 128]             258             258
===================================================================================
Total params: 811,778
Trainable params: 811,778
Non-trainable params: 0
Batch size: 2
-----------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.008, train f1 : 0.712, valid f1 : 0.650
training process - Deferred Re-weighting:   1%|          | 1/128 [01:02<2:12:31, 62.61s/it]Best score increase :0.000 -> 0.650
training process - Deferred Re-weighting:   2%|▏         | 2/128 [01:55<1:59:51, 57.07s/it]Best score increase :0.650 -> 0.697
training process - Deferred Re-weighting:   2%|▏         | 3/128 [02:48<1:55:07, 55.26s/it]Best score increase :0.697 -> 0.742
training process - Deferred Re-weighting:   3%|▎         | 4/128 [03:41<1:52:06, 54.24s/it]Best score increase :0.742 -> 0.761
epoch : 5, train loss : 0.007, valid loss : 0.005, train f1 : 0.843, valid f1 : 0.773
training process - Deferred Re-weighting:   4%|▍         | 5/128 [04:55<2:05:34, 61.25s/it]Best score increase :0.761 -> 0.773
training process - Deferred Re-weighting:   5%|▍         | 6/128 [06:07<2:12:07, 64.98s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [07:00<2:03:13, 61.10s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [08:11<2:08:15, 64.13s/it]Best score increase :0.773 -> 0.787
epoch : 9, train loss : 0.006, valid loss : 0.004, train f1 : 0.876, valid f1 : 0.801
training process - Deferred Re-weighting:   7%|▋         | 9/128 [09:11<2:05:00, 63.03s/it]Best score increase :0.787 -> 0.801
training process - Deferred Re-weighting:   8%|▊         | 10/128 [10:31<2:13:55, 68.10s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [11:52<2:20:31, 72.06s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [12:52<2:12:25, 68.50s/it]EarlyStopping counter : 3 out of 12
epoch : 13, train loss : 0.005, valid loss : 0.004, train f1 : 0.889, valid f1 : 0.810
training process - Deferred Re-weighting:  10%|█         | 13/128 [13:59<2:10:16, 67.97s/it]Best score increase :0.801 -> 0.810
training process - Deferred Re-weighting:  11%|█         | 14/128 [15:01<2:05:43, 66.17s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [15:57<1:59:04, 63.22s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [17:17<2:07:28, 68.29s/it]EarlyStopping counter : 3 out of 12
epoch : 17, train loss : 0.004, valid loss : 0.004, train f1 : 0.904, valid f1 : 0.826
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [18:42<2:15:34, 73.29s/it]Best score increase :0.810 -> 0.826
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [20:03<2:18:39, 75.63s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [21:21<2:18:20, 76.15s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [22:39<2:18:01, 76.68s/it]EarlyStopping counter : 3 out of 12
epoch : 21, train loss : 0.004, valid loss : 0.004, train f1 : 0.913, valid f1 : 0.826
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [23:43<2:09:54, 72.84s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [24:36<1:58:21, 66.99s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [25:29<1:49:44, 62.71s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [26:22<1:43:40, 59.81s/it]EarlyStopping counter : 7 out of 12
epoch : 25, train loss : 0.004, valid loss : 0.003, train f1 : 0.918, valid f1 : 0.829
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [27:22<1:42:56, 59.96s/it]Best score increase :0.826 -> 0.829
training process - Deferred Re-weighting:  20%|██        | 26/128 [28:15<1:38:19, 57.84s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [29:08<1:34:46, 56.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [30:24<1:43:43, 62.23s/it]Best score increase :0.829 -> 0.836
epoch : 29, train loss : 0.004, valid loss : 0.003, train f1 : 0.927, valid f1 : 0.836
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [31:26<1:42:50, 62.33s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [32:34<1:44:26, 63.94s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [33:27<1:37:57, 60.59s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [34:35<1:40:48, 63.01s/it]EarlyStopping counter : 4 out of 12
epoch : 33, train loss : 0.003, valid loss : 0.004, train f1 : 0.932, valid f1 : 0.814
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [36:00<1:50:06, 69.54s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [37:17<1:52:13, 71.63s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [38:33<1:53:20, 73.13s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [39:36<1:47:16, 69.96s/it]Best score increase :0.836 -> 0.850
epoch : 37, train loss : 0.003, valid loss : 0.003, train f1 : 0.939, valid f1 : 0.840
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [40:39<1:42:54, 67.85s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [41:56<1:45:51, 70.58s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [43:11<1:46:36, 71.87s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [44:30<1:48:35, 74.04s/it]EarlyStopping counter : 4 out of 12
epoch : 41, train loss : 0.003, valid loss : 0.004, train f1 : 0.939, valid f1 : 0.813
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [45:42<1:46:46, 73.63s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [46:41<1:39:09, 69.18s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [47:58<1:41:09, 71.41s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [48:42<1:28:35, 63.28s/it]EarlyStopping counter : 8 out of 12
epoch : 45, train loss : 0.003, valid loss : 0.004, train f1 : 0.943, valid f1 : 0.804
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [49:34<1:22:43, 59.80s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [50:19<1:15:36, 55.33s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [51:01<1:09:31, 51.49s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [51:44<1:29:10, 66.05s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.850
training process finished, best loss : 0.003, best acc : 0.951, best f1 : 0.850, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.71      0.77      0.74       580
           1       0.98      0.97      0.98      6818

    accuracy                           0.96      7398
   macro avg       0.84      0.87      0.86      7398
weighted avg       0.96      0.96      0.96      7398


# test acc : 0.96, test f1 : 0.86, test AUC : 0.87, test loss : 0.149

################# Feature Importance #################

processing for feature importance:   0%|          | 0/12 [00:00<?, ?it/s]processing for feature importance:   8%|▊         | 1/12 [00:06<01:14,  6.76s/it]processing for feature importance:  17%|█▋        | 2/12 [00:13<01:05,  6.60s/it]processing for feature importance:  25%|██▌       | 3/12 [00:19<00:59,  6.58s/it]processing for feature importance:  33%|███▎      | 4/12 [00:26<00:52,  6.56s/it]processing for feature importance:  42%|████▏     | 5/12 [00:32<00:46,  6.58s/it]processing for feature importance:  50%|█████     | 6/12 [00:39<00:39,  6.65s/it]processing for feature importance:  58%|█████▊    | 7/12 [00:46<00:33,  6.73s/it]processing for feature importance:  67%|██████▋   | 8/12 [00:53<00:26,  6.62s/it]processing for feature importance:  75%|███████▌  | 9/12 [00:59<00:20,  6.70s/it]processing for feature importance:  83%|████████▎ | 10/12 [01:06<00:13,  6.63s/it]processing for feature importance:  92%|█████████▏| 11/12 [01:12<00:06,  6.60s/it]processing for feature importance: 100%|██████████| 12/12 [01:19<00:00,  6.59s/it]processing for feature importance: 100%|██████████| 12/12 [01:19<00:00,  6.62s/it]

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/306 [00:00<?, ?it/s]  8%|▊         | 25/306 [00:00<00:01, 246.49it/s] 17%|█▋        | 53/306 [00:00<00:00, 262.93it/s] 27%|██▋       | 83/306 [00:00<00:00, 272.90it/s] 37%|███▋      | 112/306 [00:00<00:00, 277.68it/s] 46%|████▋     | 142/306 [00:00<00:00, 276.56it/s] 56%|█████▌    | 171/306 [00:00<00:00, 279.20it/s] 65%|██████▌   | 200/306 [00:00<00:00, 281.00it/s] 75%|███████▍  | 229/306 [00:00<00:00, 282.09it/s] 84%|████████▍ | 258/306 [00:00<00:00, 280.99it/s] 94%|█████████▍| 288/306 [00:01<00:00, 284.65it/s]100%|██████████| 306/306 [00:01<00:00, 279.40it/s]
time :  1308
prob :  1308
thermal quench :  5.342
current quench:  5.368
