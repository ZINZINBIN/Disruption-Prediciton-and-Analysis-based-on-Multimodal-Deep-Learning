/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_Normal
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.106, valid loss : 0.113, train acc : 0.982, valid acc : 0.982, train f1 : 0.495, valid f1 : 0.495
training process:   2%|▏         | 1/50 [04:07<3:22:00, 247.37s/it]training process:   4%|▍         | 2/50 [07:26<2:55:19, 219.15s/it]training process:   6%|▌         | 3/50 [10:45<2:44:17, 209.73s/it]training process:   8%|▊         | 4/50 [14:02<2:36:54, 204.67s/it]epoch : 5, train loss : 0.073, valid loss : 0.072, train acc : 0.988, valid acc : 0.990, train f1 : 0.771, valid f1 : 0.802
training process:  10%|█         | 5/50 [18:03<2:43:19, 217.76s/it]training process:  12%|█▏        | 6/50 [21:17<2:33:51, 209.80s/it]training process:  14%|█▍        | 7/50 [24:33<2:27:00, 205.13s/it]training process:  16%|█▌        | 8/50 [27:47<2:21:08, 201.62s/it]epoch : 9, train loss : 0.067, valid loss : 0.068, train acc : 0.989, valid acc : 0.990, train f1 : 0.786, valid f1 : 0.811
training process:  18%|█▊        | 9/50 [31:46<2:25:45, 213.31s/it]training process:  20%|██        | 10/50 [35:03<2:18:50, 208.27s/it]training process:  22%|██▏       | 11/50 [38:16<2:12:25, 203.72s/it]training process:  24%|██▍       | 12/50 [41:29<2:06:57, 200.45s/it]epoch : 13, train loss : 0.050, valid loss : 0.044, train acc : 0.991, valid acc : 0.992, train f1 : 0.843, valid f1 : 0.865
training process:  26%|██▌       | 13/50 [45:27<2:10:38, 211.85s/it]training process:  28%|██▊       | 14/50 [48:41<2:03:54, 206.52s/it]training process:  30%|███       | 15/50 [51:56<1:58:22, 202.92s/it]training process:  32%|███▏      | 16/50 [55:08<1:53:05, 199.58s/it]epoch : 17, train loss : 0.036, valid loss : 0.050, train acc : 0.993, valid acc : 0.993, train f1 : 0.891, valid f1 : 0.879
training process:  34%|███▍      | 17/50 [59:05<1:56:00, 210.93s/it]training process:  36%|███▌      | 18/50 [1:02:17<1:49:30, 205.33s/it]training process:  38%|███▊      | 19/50 [1:05:29<1:43:55, 201.16s/it]training process:  40%|████      | 20/50 [1:08:41<1:39:11, 198.40s/it]epoch : 21, train loss : 0.037, valid loss : 0.033, train acc : 0.993, valid acc : 0.996, train f1 : 0.882, valid f1 : 0.929
training process:  42%|████▏     | 21/50 [1:12:36<1:41:16, 209.54s/it]training process:  44%|████▍     | 22/50 [1:15:47<1:35:10, 203.95s/it]training process:  46%|████▌     | 23/50 [1:19:01<1:30:20, 200.78s/it]training process:  48%|████▊     | 24/50 [1:22:13<1:25:52, 198.16s/it]epoch : 25, train loss : 0.031, valid loss : 0.041, train acc : 0.995, valid acc : 0.995, train f1 : 0.913, valid f1 : 0.911
training process:  50%|█████     | 25/50 [1:26:11<1:27:39, 210.37s/it]training process:  52%|█████▏    | 26/50 [1:29:27<1:22:20, 205.84s/it]training process:  54%|█████▍    | 27/50 [1:32:44<1:17:53, 203.21s/it]training process:  56%|█████▌    | 28/50 [1:35:57<1:13:22, 200.10s/it]epoch : 29, train loss : 0.029, valid loss : 0.058, train acc : 0.995, valid acc : 0.990, train f1 : 0.918, valid f1 : 0.862
training process:  58%|█████▊    | 29/50 [1:39:56<1:14:07, 211.76s/it]training process:  60%|██████    | 30/50 [1:43:13<1:09:09, 207.48s/it]training process:  62%|██████▏   | 31/50 [1:46:31<1:04:44, 204.47s/it]training process:  64%|██████▍   | 32/50 [1:49:47<1:00:35, 202.00s/it]epoch : 33, train loss : 0.028, valid loss : 0.043, train acc : 0.995, valid acc : 0.993, train f1 : 0.920, valid f1 : 0.894
training process:  66%|██████▌   | 33/50 [1:53:48<1:00:31, 213.62s/it]training process:  68%|██████▊   | 34/50 [1:56:58<55:08, 206.78s/it]  training process:  70%|███████   | 35/50 [2:00:10<50:33, 202.26s/it]training process:  72%|███████▏  | 36/50 [2:03:21<46:24, 198.88s/it]epoch : 37, train loss : 0.027, valid loss : 0.038, train acc : 0.996, valid acc : 0.995, train f1 : 0.930, valid f1 : 0.921
training process:  74%|███████▍  | 37/50 [2:07:20<45:40, 210.82s/it]training process:  76%|███████▌  | 38/50 [2:10:32<41:04, 205.34s/it]training process:  78%|███████▊  | 39/50 [2:13:47<37:04, 202.23s/it]training process:  80%|████████  | 40/50 [2:17:01<33:17, 199.72s/it]epoch : 41, train loss : 0.026, valid loss : 0.142, train acc : 0.996, valid acc : 0.970, train f1 : 0.931, valid f1 : 0.735
training process:  82%|████████▏ | 41/50 [2:21:00<31:44, 211.58s/it]training process:  84%|████████▍ | 42/50 [2:24:15<27:32, 206.54s/it]training process:  86%|████████▌ | 43/50 [2:27:31<23:42, 203.26s/it]training process:  88%|████████▊ | 44/50 [2:30:45<20:02, 200.42s/it]epoch : 45, train loss : 0.027, valid loss : 0.036, train acc : 0.995, valid acc : 0.995, train f1 : 0.924, valid f1 : 0.916
training process:  90%|█████████ | 45/50 [2:34:44<17:40, 212.18s/it]training process:  92%|█████████▏| 46/50 [2:37:59<13:48, 207.03s/it]training process:  94%|█████████▍| 47/50 [2:41:13<10:09, 203.21s/it]training process:  96%|█████████▌| 48/50 [2:44:26<06:39, 199.90s/it]epoch : 49, train loss : 0.026, valid loss : 0.040, train acc : 0.996, valid acc : 0.992, train f1 : 0.928, valid f1 : 0.888
training process:  98%|█████████▊| 49/50 [2:48:23<03:31, 211.16s/it]training process: 100%|██████████| 50/50 [2:51:35<00:00, 205.42s/it]training process: 100%|██████████| 50/50 [2:51:35<00:00, 205.91s/it]
training process finished, best loss : 0.033 and best acc : 0.996, best f1 : 0.929, best epoch : 20

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.65      0.66        71
           1       0.99      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.83      0.82      0.83      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.83, test AUC : 0.82, test loss : 1.147

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:41, 23.40it/s]  1%|          | 6/981 [00:00<00:39, 24.38it/s]  1%|          | 9/981 [00:00<00:39, 24.54it/s]  1%|          | 12/981 [00:00<00:38, 24.87it/s]  2%|▏         | 15/981 [00:00<00:38, 24.96it/s]  2%|▏         | 18/981 [00:00<00:38, 25.02it/s]  2%|▏         | 21/981 [00:00<00:38, 25.01it/s]  2%|▏         | 24/981 [00:00<00:38, 24.98it/s]  3%|▎         | 27/981 [00:01<00:38, 24.92it/s]  3%|▎         | 30/981 [00:01<00:38, 24.99it/s]  3%|▎         | 33/981 [00:01<00:37, 25.08it/s]  4%|▎         | 36/981 [00:01<00:37, 25.03it/s]  4%|▍         | 39/981 [00:01<00:37, 25.11it/s]  4%|▍         | 42/981 [00:01<00:37, 25.09it/s]  5%|▍         | 45/981 [00:01<00:37, 25.00it/s]  5%|▍         | 48/981 [00:01<00:37, 24.97it/s]  5%|▌         | 51/981 [00:02<00:37, 24.95it/s]  6%|▌         | 54/981 [00:02<00:37, 24.65it/s]  6%|▌         | 57/981 [00:02<00:37, 24.69it/s]  6%|▌         | 60/981 [00:02<00:36, 24.94it/s]  6%|▋         | 63/981 [00:02<00:36, 24.86it/s]  7%|▋         | 66/981 [00:02<00:36, 24.89it/s]  7%|▋         | 69/981 [00:02<00:36, 24.93it/s]  7%|▋         | 72/981 [00:02<00:36, 25.06it/s]  8%|▊         | 75/981 [00:03<00:36, 24.74it/s]  8%|▊         | 78/981 [00:03<00:36, 24.80it/s]  8%|▊         | 81/981 [00:03<00:36, 24.78it/s]  9%|▊         | 84/981 [00:03<00:36, 24.82it/s]  9%|▉         | 87/981 [00:03<00:35, 24.84it/s]  9%|▉         | 90/981 [00:03<00:35, 24.83it/s]  9%|▉         | 93/981 [00:03<00:35, 24.74it/s] 10%|▉         | 96/981 [00:03<00:35, 24.80it/s] 10%|█         | 99/981 [00:03<00:35, 24.53it/s] 10%|█         | 102/981 [00:04<00:35, 24.58it/s] 11%|█         | 105/981 [00:04<00:35, 24.64it/s] 11%|█         | 108/981 [00:04<00:35, 24.66it/s] 11%|█▏        | 111/981 [00:04<00:35, 24.60it/s] 12%|█▏        | 114/981 [00:04<00:35, 24.38it/s] 12%|█▏        | 117/981 [00:04<00:35, 24.49it/s] 12%|█▏        | 120/981 [00:04<00:35, 24.26it/s] 13%|█▎        | 123/981 [00:04<00:35, 24.35it/s] 13%|█▎        | 126/981 [00:05<00:34, 24.45it/s] 13%|█▎        | 129/981 [00:05<00:34, 24.49it/s] 13%|█▎        | 132/981 [00:05<00:34, 24.48it/s] 14%|█▍        | 135/981 [00:05<00:34, 24.64it/s] 14%|█▍        | 138/981 [00:05<00:34, 24.68it/s] 14%|█▍        | 141/981 [00:05<00:34, 24.12it/s] 15%|█▍        | 144/981 [00:05<00:34, 24.32it/s] 15%|█▍        | 147/981 [00:05<00:34, 24.43it/s] 15%|█▌        | 150/981 [00:06<00:34, 24.16it/s] 16%|█▌        | 153/981 [00:06<00:33, 24.36it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.52it/s] 16%|█▌        | 159/981 [00:06<00:33, 24.39it/s] 17%|█▋        | 162/981 [00:06<00:33, 24.55it/s] 17%|█▋        | 165/981 [00:06<00:32, 24.76it/s] 17%|█▋        | 168/981 [00:06<00:32, 24.76it/s] 17%|█▋        | 171/981 [00:06<00:32, 24.90it/s] 18%|█▊        | 174/981 [00:07<00:32, 24.80it/s] 18%|█▊        | 177/981 [00:07<00:32, 24.76it/s] 18%|█▊        | 180/981 [00:07<00:32, 24.55it/s] 19%|█▊        | 183/981 [00:07<00:32, 24.61it/s] 19%|█▉        | 186/981 [00:07<00:32, 24.64it/s] 19%|█▉        | 189/981 [00:07<00:32, 24.71it/s] 20%|█▉        | 192/981 [00:07<00:31, 24.76it/s] 20%|█▉        | 195/981 [00:07<00:31, 24.72it/s] 20%|██        | 198/981 [00:08<00:31, 24.63it/s] 20%|██        | 201/981 [00:08<00:31, 24.43it/s] 21%|██        | 204/981 [00:08<00:31, 24.47it/s] 21%|██        | 207/981 [00:08<00:31, 24.59it/s] 21%|██▏       | 210/981 [00:08<00:31, 24.45it/s] 22%|██▏       | 213/981 [00:08<00:31, 24.45it/s] 22%|██▏       | 216/981 [00:08<00:31, 24.43it/s] 22%|██▏       | 219/981 [00:08<00:31, 24.55it/s] 23%|██▎       | 222/981 [00:09<00:31, 24.38it/s] 23%|██▎       | 225/981 [00:09<00:31, 24.31it/s] 23%|██▎       | 228/981 [00:09<00:31, 24.16it/s] 24%|██▎       | 231/981 [00:09<00:31, 24.08it/s] 24%|██▍       | 234/981 [00:09<00:30, 24.19it/s] 24%|██▍       | 237/981 [00:09<00:30, 24.32it/s] 24%|██▍       | 240/981 [00:09<00:30, 24.07it/s] 25%|██▍       | 243/981 [00:09<00:30, 23.81it/s] 25%|██▌       | 246/981 [00:10<00:30, 23.91it/s] 25%|██▌       | 249/981 [00:10<00:30, 24.19it/s] 26%|██▌       | 252/981 [00:10<00:29, 24.33it/s] 26%|██▌       | 255/981 [00:10<00:30, 24.16it/s] 26%|██▋       | 258/981 [00:10<00:30, 23.76it/s] 27%|██▋       | 261/981 [00:10<00:30, 23.87it/s] 27%|██▋       | 264/981 [00:10<00:29, 24.18it/s] 27%|██▋       | 267/981 [00:10<00:29, 24.33it/s] 28%|██▊       | 270/981 [00:10<00:29, 24.47it/s] 28%|██▊       | 273/981 [00:11<00:28, 24.66it/s] 28%|██▊       | 276/981 [00:11<00:28, 24.71it/s] 28%|██▊       | 279/981 [00:11<00:28, 24.73it/s] 29%|██▊       | 282/981 [00:11<00:28, 24.83it/s] 29%|██▉       | 285/981 [00:11<00:27, 24.90it/s] 29%|██▉       | 288/981 [00:11<00:27, 24.95it/s] 30%|██▉       | 291/981 [00:11<00:27, 25.01it/s] 30%|██▉       | 294/981 [00:11<00:27, 24.95it/s] 30%|███       | 297/981 [00:12<00:27, 24.97it/s] 31%|███       | 300/981 [00:12<00:27, 25.00it/s] 31%|███       | 303/981 [00:12<00:27, 25.04it/s] 31%|███       | 306/981 [00:12<00:26, 25.07it/s] 31%|███▏      | 309/981 [00:12<00:26, 25.05it/s] 32%|███▏      | 312/981 [00:12<00:26, 24.94it/s] 32%|███▏      | 315/981 [00:12<00:26, 24.97it/s] 32%|███▏      | 318/981 [00:12<00:26, 24.86it/s] 33%|███▎      | 321/981 [00:13<00:26, 24.83it/s] 33%|███▎      | 324/981 [00:13<00:26, 24.79it/s] 33%|███▎      | 327/981 [00:13<00:26, 24.86it/s] 34%|███▎      | 330/981 [00:13<00:26, 24.80it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.78it/s] 34%|███▍      | 336/981 [00:13<00:25, 24.85it/s] 35%|███▍      | 339/981 [00:13<00:25, 24.91it/s] 35%|███▍      | 342/981 [00:13<00:25, 24.93it/s] 35%|███▌      | 345/981 [00:13<00:25, 24.87it/s] 35%|███▌      | 348/981 [00:14<00:25, 24.83it/s] 36%|███▌      | 351/981 [00:14<00:25, 24.85it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.66it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.65it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.72it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.71it/s] 37%|███▋      | 366/981 [00:14<00:24, 24.68it/s] 38%|███▊      | 369/981 [00:14<00:24, 24.66it/s] 38%|███▊      | 372/981 [00:15<00:25, 24.30it/s] 38%|███▊      | 375/981 [00:15<00:24, 24.34it/s] 39%|███▊      | 378/981 [00:15<00:24, 24.33it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.43it/s] 39%|███▉      | 384/981 [00:15<00:24, 24.54it/s] 39%|███▉      | 387/981 [00:15<00:24, 24.56it/s] 40%|███▉      | 390/981 [00:15<00:23, 24.69it/s] 40%|████      | 393/981 [00:15<00:23, 24.72it/s] 40%|████      | 396/981 [00:16<00:23, 24.68it/s] 41%|████      | 399/981 [00:16<00:23, 24.73it/s] 41%|████      | 402/981 [00:16<00:23, 24.63it/s] 41%|████▏     | 405/981 [00:16<00:23, 24.50it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.59it/s] 42%|████▏     | 411/981 [00:16<00:23, 24.69it/s] 42%|████▏     | 414/981 [00:16<00:22, 24.79it/s] 43%|████▎     | 417/981 [00:16<00:22, 24.85it/s] 43%|████▎     | 420/981 [00:17<00:22, 24.86it/s] 43%|████▎     | 423/981 [00:17<00:22, 24.86it/s] 43%|████▎     | 426/981 [00:17<00:22, 24.84it/s] 44%|████▎     | 429/981 [00:17<00:22, 24.82it/s] 44%|████▍     | 432/981 [00:17<00:22, 24.85it/s] 44%|████▍     | 435/981 [00:17<00:21, 24.92it/s] 45%|████▍     | 438/981 [00:17<00:21, 24.87it/s] 45%|████▍     | 441/981 [00:17<00:21, 24.85it/s] 45%|████▌     | 444/981 [00:18<00:21, 24.85it/s] 46%|████▌     | 447/981 [00:18<00:21, 24.87it/s] 46%|████▌     | 450/981 [00:18<00:21, 24.89it/s] 46%|████▌     | 453/981 [00:18<00:21, 24.85it/s] 46%|████▋     | 456/981 [00:18<00:21, 24.88it/s] 47%|████▋     | 459/981 [00:18<00:21, 24.84it/s] 47%|████▋     | 462/981 [00:18<00:20, 24.89it/s] 47%|████▋     | 465/981 [00:18<00:20, 25.04it/s] 48%|████▊     | 468/981 [00:18<00:20, 25.09it/s] 48%|████▊     | 471/981 [00:19<00:20, 25.11it/s] 48%|████▊     | 474/981 [00:19<00:20, 25.20it/s] 49%|████▊     | 477/981 [00:19<00:19, 25.29it/s] 49%|████▉     | 480/981 [00:19<00:19, 25.22it/s] 49%|████▉     | 483/981 [00:19<00:19, 25.08it/s] 50%|████▉     | 486/981 [00:19<00:19, 25.06it/s] 50%|████▉     | 489/981 [00:19<00:19, 25.07it/s] 50%|█████     | 492/981 [00:19<00:19, 24.97it/s] 50%|█████     | 495/981 [00:20<00:19, 24.94it/s] 51%|█████     | 498/981 [00:20<00:19, 24.95it/s] 51%|█████     | 501/981 [00:20<00:19, 24.95it/s] 51%|█████▏    | 504/981 [00:20<00:19, 25.03it/s] 52%|█████▏    | 507/981 [00:20<00:18, 25.00it/s] 52%|█████▏    | 510/981 [00:20<00:18, 25.10it/s] 52%|█████▏    | 513/981 [00:20<00:18, 25.21it/s] 53%|█████▎    | 516/981 [00:20<00:18, 25.30it/s] 53%|█████▎    | 519/981 [00:20<00:18, 25.36it/s] 53%|█████▎    | 522/981 [00:21<00:18, 25.42it/s] 54%|█████▎    | 525/981 [00:21<00:17, 25.48it/s] 54%|█████▍    | 528/981 [00:21<00:17, 25.63it/s] 54%|█████▍    | 531/981 [00:21<00:17, 25.61it/s] 54%|█████▍    | 534/981 [00:21<00:17, 25.61it/s] 55%|█████▍    | 537/981 [00:21<00:17, 25.67it/s] 55%|█████▌    | 540/981 [00:21<00:17, 25.67it/s] 55%|█████▌    | 543/981 [00:21<00:17, 25.60it/s] 56%|█████▌    | 546/981 [00:22<00:17, 25.27it/s] 56%|█████▌    | 549/981 [00:22<00:17, 25.30it/s] 56%|█████▋    | 552/981 [00:22<00:16, 25.51it/s] 57%|█████▋    | 555/981 [00:22<00:16, 25.84it/s] 57%|█████▋    | 558/981 [00:22<00:16, 25.96it/s] 57%|█████▋    | 561/981 [00:22<00:16, 26.03it/s] 57%|█████▋    | 564/981 [00:22<00:16, 25.95it/s] 58%|█████▊    | 567/981 [00:22<00:16, 25.78it/s] 58%|█████▊    | 570/981 [00:22<00:15, 25.74it/s] 58%|█████▊    | 573/981 [00:23<00:15, 25.78it/s] 59%|█████▊    | 576/981 [00:23<00:15, 25.76it/s] 59%|█████▉    | 579/981 [00:23<00:15, 25.74it/s] 59%|█████▉    | 582/981 [00:23<00:15, 25.75it/s] 60%|█████▉    | 585/981 [00:23<00:15, 25.69it/s] 60%|█████▉    | 588/981 [00:23<00:15, 25.75it/s] 60%|██████    | 591/981 [00:23<00:15, 25.80it/s] 61%|██████    | 594/981 [00:23<00:14, 25.90it/s] 61%|██████    | 597/981 [00:24<00:14, 25.92it/s] 61%|██████    | 600/981 [00:24<00:14, 25.93it/s] 61%|██████▏   | 603/981 [00:24<00:14, 25.83it/s] 62%|██████▏   | 606/981 [00:24<00:14, 25.90it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.96it/s] 62%|██████▏   | 612/981 [00:24<00:14, 26.00it/s] 63%|██████▎   | 615/981 [00:24<00:14, 26.13it/s] 63%|██████▎   | 618/981 [00:24<00:13, 26.03it/s] 63%|██████▎   | 621/981 [00:24<00:13, 25.89it/s] 64%|██████▎   | 624/981 [00:25<00:13, 25.95it/s] 64%|██████▍   | 627/981 [00:25<00:13, 25.92it/s] 64%|██████▍   | 630/981 [00:25<00:13, 25.96it/s] 65%|██████▍   | 633/981 [00:25<00:13, 25.99it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.94it/s] 65%|██████▌   | 639/981 [00:25<00:13, 25.85it/s] 65%|██████▌   | 642/981 [00:25<00:13, 25.78it/s] 66%|██████▌   | 645/981 [00:25<00:13, 25.72it/s] 66%|██████▌   | 648/981 [00:25<00:12, 25.70it/s] 66%|██████▋   | 651/981 [00:26<00:12, 25.71it/s] 67%|██████▋   | 654/981 [00:26<00:12, 25.68it/s] 67%|██████▋   | 657/981 [00:26<00:12, 25.76it/s] 67%|██████▋   | 660/981 [00:26<00:12, 25.79it/s] 68%|██████▊   | 663/981 [00:26<00:12, 25.73it/s] 68%|██████▊   | 666/981 [00:26<00:12, 25.76it/s] 68%|██████▊   | 669/981 [00:26<00:12, 25.74it/s] 69%|██████▊   | 672/981 [00:26<00:12, 25.74it/s] 69%|██████▉   | 675/981 [00:27<00:11, 25.72it/s] 69%|██████▉   | 678/981 [00:27<00:11, 25.83it/s] 69%|██████▉   | 681/981 [00:27<00:11, 25.76it/s] 70%|██████▉   | 684/981 [00:27<00:11, 25.39it/s] 70%|███████   | 687/981 [00:27<00:11, 25.33it/s] 70%|███████   | 690/981 [00:27<00:11, 25.14it/s] 71%|███████   | 693/981 [00:27<00:11, 25.25it/s] 71%|███████   | 696/981 [00:27<00:11, 25.17it/s] 71%|███████▏  | 699/981 [00:27<00:11, 25.38it/s] 72%|███████▏  | 702/981 [00:28<00:10, 25.39it/s] 72%|███████▏  | 705/981 [00:28<00:10, 25.41it/s] 72%|███████▏  | 708/981 [00:28<00:10, 25.52it/s] 72%|███████▏  | 711/981 [00:28<00:10, 25.57it/s] 73%|███████▎  | 714/981 [00:28<00:10, 25.65it/s] 73%|███████▎  | 717/981 [00:28<00:10, 25.68it/s] 73%|███████▎  | 720/981 [00:28<00:10, 25.89it/s] 74%|███████▎  | 723/981 [00:28<00:09, 25.91it/s] 74%|███████▍  | 726/981 [00:29<00:10, 25.42it/s] 74%|███████▍  | 729/981 [00:29<00:09, 25.46it/s] 75%|███████▍  | 732/981 [00:29<00:09, 25.38it/s] 75%|███████▍  | 735/981 [00:29<00:09, 25.63it/s] 75%|███████▌  | 738/981 [00:29<00:09, 25.73it/s] 76%|███████▌  | 741/981 [00:29<00:09, 25.75it/s] 76%|███████▌  | 744/981 [00:29<00:09, 25.70it/s] 76%|███████▌  | 747/981 [00:29<00:09, 25.67it/s] 76%|███████▋  | 750/981 [00:29<00:09, 25.60it/s] 77%|███████▋  | 753/981 [00:30<00:08, 25.57it/s] 77%|███████▋  | 756/981 [00:30<00:08, 25.56it/s] 77%|███████▋  | 759/981 [00:30<00:08, 25.61it/s] 78%|███████▊  | 762/981 [00:30<00:08, 25.61it/s] 78%|███████▊  | 765/981 [00:30<00:08, 25.29it/s] 78%|███████▊  | 768/981 [00:30<00:08, 25.39it/s] 79%|███████▊  | 771/981 [00:30<00:08, 25.44it/s] 79%|███████▉  | 774/981 [00:30<00:08, 25.35it/s] 79%|███████▉  | 777/981 [00:31<00:08, 25.28it/s] 80%|███████▉  | 780/981 [00:31<00:07, 25.42it/s] 80%|███████▉  | 783/981 [00:31<00:07, 25.61it/s] 80%|████████  | 786/981 [00:31<00:07, 25.97it/s] 80%|████████  | 789/981 [00:31<00:07, 26.38it/s] 81%|████████  | 792/981 [00:31<00:07, 26.85it/s] 81%|████████  | 795/981 [00:31<00:06, 27.36it/s] 81%|████████▏ | 798/981 [00:31<00:06, 27.89it/s] 82%|████████▏ | 801/981 [00:31<00:06, 28.25it/s] 82%|████████▏ | 804/981 [00:32<00:06, 28.41it/s] 82%|████████▏ | 807/981 [00:32<00:06, 28.81it/s] 83%|████████▎ | 810/981 [00:32<00:05, 28.97it/s] 83%|████████▎ | 813/981 [00:32<00:05, 29.03it/s] 83%|████████▎ | 816/981 [00:32<00:05, 29.21it/s] 83%|████████▎ | 819/981 [00:32<00:05, 29.29it/s] 84%|████████▍ | 822/981 [00:32<00:05, 29.34it/s] 84%|████████▍ | 825/981 [00:32<00:05, 29.42it/s] 84%|████████▍ | 828/981 [00:32<00:05, 29.49it/s] 85%|████████▍ | 831/981 [00:32<00:05, 29.46it/s] 85%|████████▌ | 834/981 [00:33<00:04, 29.41it/s] 85%|████████▌ | 837/981 [00:33<00:04, 29.50it/s] 86%|████████▌ | 840/981 [00:33<00:04, 29.50it/s] 86%|████████▌ | 843/981 [00:33<00:04, 29.61it/s] 86%|████████▌ | 846/981 [00:33<00:04, 29.61it/s] 87%|████████▋ | 849/981 [00:33<00:04, 29.52it/s] 87%|████████▋ | 852/981 [00:33<00:04, 29.56it/s] 87%|████████▋ | 855/981 [00:33<00:04, 29.64it/s] 87%|████████▋ | 858/981 [00:33<00:04, 29.71it/s] 88%|████████▊ | 861/981 [00:33<00:04, 29.71it/s] 88%|████████▊ | 864/981 [00:34<00:03, 29.44it/s] 88%|████████▊ | 867/981 [00:34<00:03, 29.19it/s] 89%|████████▊ | 870/981 [00:34<00:03, 28.97it/s] 89%|████████▉ | 873/981 [00:34<00:03, 29.15it/s] 89%|████████▉ | 876/981 [00:34<00:03, 29.27it/s] 90%|████████▉ | 879/981 [00:34<00:03, 29.36it/s] 90%|████████▉ | 882/981 [00:34<00:03, 29.50it/s] 90%|█████████ | 885/981 [00:34<00:03, 29.51it/s] 91%|█████████ | 888/981 [00:34<00:03, 29.60it/s] 91%|█████████ | 891/981 [00:34<00:03, 29.62it/s] 91%|█████████ | 894/981 [00:35<00:02, 29.67it/s] 91%|█████████▏| 897/981 [00:35<00:02, 29.72it/s] 92%|█████████▏| 900/981 [00:35<00:02, 29.74it/s] 92%|█████████▏| 903/981 [00:35<00:02, 29.72it/s] 92%|█████████▏| 906/981 [00:35<00:02, 29.79it/s] 93%|█████████▎| 909/981 [00:35<00:02, 29.64it/s] 93%|█████████▎| 912/981 [00:35<00:02, 29.70it/s] 93%|█████████▎| 915/981 [00:35<00:02, 29.67it/s] 94%|█████████▎| 918/981 [00:35<00:02, 28.94it/s] 94%|█████████▍| 921/981 [00:35<00:02, 29.03it/s] 94%|█████████▍| 924/981 [00:36<00:01, 29.28it/s] 95%|█████████▍| 928/981 [00:36<00:01, 29.73it/s] 95%|█████████▍| 931/981 [00:36<00:01, 29.79it/s] 95%|█████████▌| 935/981 [00:36<00:01, 30.03it/s] 96%|█████████▌| 939/981 [00:36<00:01, 30.21it/s] 96%|█████████▌| 943/981 [00:36<00:01, 30.27it/s] 97%|█████████▋| 947/981 [00:36<00:01, 30.31it/s] 97%|█████████▋| 951/981 [00:36<00:00, 30.32it/s] 97%|█████████▋| 955/981 [00:37<00:00, 30.24it/s] 98%|█████████▊| 959/981 [00:37<00:00, 30.10it/s] 98%|█████████▊| 963/981 [00:37<00:00, 30.05it/s] 99%|█████████▊| 967/981 [00:37<00:00, 29.90it/s] 99%|█████████▉| 970/981 [00:37<00:00, 29.86it/s] 99%|█████████▉| 973/981 [00:37<00:00, 29.68it/s] 99%|█████████▉| 976/981 [00:37<00:00, 29.61it/s]100%|█████████▉| 979/981 [00:37<00:00, 29.55it/s]100%|██████████| 981/981 [00:37<00:00, 25.82it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_RS
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.295, valid loss : 0.066, train acc : 0.857, valid acc : 0.984, train f1 : 0.857, valid f1 : 0.829
training process:   2%|▏         | 1/50 [04:02<3:18:21, 242.88s/it]training process:   4%|▍         | 2/50 [07:15<2:50:32, 213.19s/it]training process:   6%|▌         | 3/50 [10:28<2:39:59, 204.24s/it]training process:   8%|▊         | 4/50 [13:42<2:33:26, 200.15s/it]epoch : 5, train loss : 0.144, valid loss : 0.048, train acc : 0.941, valid acc : 0.992, train f1 : 0.941, valid f1 : 0.896
training process:  10%|█         | 5/50 [17:42<2:40:47, 214.39s/it]training process:  12%|█▏        | 6/50 [20:57<2:32:31, 208.00s/it]training process:  14%|█▍        | 7/50 [24:12<2:26:00, 203.73s/it]training process:  16%|█▌        | 8/50 [27:25<2:20:08, 200.20s/it]epoch : 9, train loss : 0.127, valid loss : 0.176, train acc : 0.953, valid acc : 0.932, train f1 : 0.953, valid f1 : 0.651
training process:  18%|█▊        | 9/50 [31:26<2:25:34, 213.03s/it]training process:  20%|██        | 10/50 [34:42<2:18:23, 207.58s/it]training process:  22%|██▏       | 11/50 [37:56<2:12:11, 203.38s/it]training process:  24%|██▍       | 12/50 [41:11<2:07:22, 201.12s/it]epoch : 13, train loss : 0.111, valid loss : 0.083, train acc : 0.956, valid acc : 0.959, train f1 : 0.956, valid f1 : 0.720
training process:  26%|██▌       | 13/50 [45:12<2:11:21, 213.01s/it]training process:  28%|██▊       | 14/50 [48:25<2:04:13, 207.03s/it]training process:  30%|███       | 15/50 [51:37<1:58:02, 202.36s/it]training process:  32%|███▏      | 16/50 [54:47<1:52:33, 198.65s/it]epoch : 17, train loss : 0.110, valid loss : 0.076, train acc : 0.957, valid acc : 0.961, train f1 : 0.957, valid f1 : 0.721
training process:  34%|███▍      | 17/50 [58:43<1:55:29, 209.99s/it]training process:  36%|███▌      | 18/50 [1:01:54<1:49:00, 204.38s/it]training process:  38%|███▊      | 19/50 [1:05:06<1:43:36, 200.53s/it]training process:  40%|████      | 20/50 [1:08:16<1:38:46, 197.55s/it]epoch : 21, train loss : 0.104, valid loss : 0.101, train acc : 0.959, valid acc : 0.958, train f1 : 0.959, valid f1 : 0.714
training process:  42%|████▏     | 21/50 [1:12:17<1:41:41, 210.41s/it]training process:  44%|████▍     | 22/50 [1:15:29<1:35:40, 205.02s/it]training process:  46%|████▌     | 23/50 [1:18:45<1:30:56, 202.09s/it]training process:  48%|████▊     | 24/50 [1:21:59<1:26:32, 199.71s/it]epoch : 25, train loss : 0.099, valid loss : 0.068, train acc : 0.963, valid acc : 0.989, train f1 : 0.963, valid f1 : 0.875
training process:  50%|█████     | 25/50 [1:25:56<1:27:55, 211.03s/it]training process:  52%|█████▏    | 26/50 [1:29:09<1:22:14, 205.59s/it]training process:  54%|█████▍    | 27/50 [1:32:28<1:18:00, 203.50s/it]training process:  56%|█████▌    | 28/50 [1:35:45<1:13:54, 201.57s/it]epoch : 29, train loss : 0.077, valid loss : 0.078, train acc : 0.967, valid acc : 0.968, train f1 : 0.967, valid f1 : 0.750
training process:  58%|█████▊    | 29/50 [1:39:43<1:14:24, 212.58s/it]training process:  60%|██████    | 30/50 [1:42:58<1:09:03, 207.17s/it]training process:  62%|██████▏   | 31/50 [1:46:10<1:04:12, 202.77s/it]training process:  64%|██████▍   | 32/50 [1:49:24<1:00:03, 200.21s/it]epoch : 33, train loss : 0.083, valid loss : 0.061, train acc : 0.965, valid acc : 0.977, train f1 : 0.965, valid f1 : 0.791
training process:  66%|██████▌   | 33/50 [1:53:23<59:58, 211.70s/it]  training process:  68%|██████▊   | 34/50 [1:56:40<55:15, 207.22s/it]training process:  70%|███████   | 35/50 [1:59:53<50:44, 202.97s/it]training process:  72%|███████▏  | 36/50 [2:03:06<46:41, 200.12s/it]epoch : 37, train loss : 0.085, valid loss : 0.049, train acc : 0.965, valid acc : 0.987, train f1 : 0.965, valid f1 : 0.853
training process:  74%|███████▍  | 37/50 [2:07:06<45:58, 212.19s/it]training process:  76%|███████▌  | 38/50 [2:10:22<41:25, 207.16s/it]training process:  78%|███████▊  | 39/50 [2:13:38<37:22, 203.88s/it]training process:  80%|████████  | 40/50 [2:16:53<33:31, 201.13s/it]epoch : 41, train loss : 0.075, valid loss : 0.083, train acc : 0.968, valid acc : 0.968, train f1 : 0.968, valid f1 : 0.745
training process:  82%|████████▏ | 41/50 [2:20:52<31:52, 212.48s/it]training process:  84%|████████▍ | 42/50 [2:24:08<27:41, 207.72s/it]training process:  86%|████████▌ | 43/50 [2:27:24<23:49, 204.18s/it]training process:  88%|████████▊ | 44/50 [2:30:42<20:12, 202.16s/it]epoch : 45, train loss : 0.076, valid loss : 0.076, train acc : 0.970, valid acc : 0.974, train f1 : 0.970, valid f1 : 0.765
training process:  90%|█████████ | 45/50 [2:34:45<17:52, 214.59s/it]training process:  92%|█████████▏| 46/50 [2:38:06<14:02, 210.52s/it]training process:  94%|█████████▍| 47/50 [2:41:21<10:17, 205.74s/it]training process:  96%|█████████▌| 48/50 [2:44:35<06:44, 202.27s/it]epoch : 49, train loss : 0.066, valid loss : 0.088, train acc : 0.970, valid acc : 0.964, train f1 : 0.970, valid f1 : 0.733
training process:  98%|█████████▊| 49/50 [2:48:34<03:33, 213.27s/it]training process: 100%|██████████| 50/50 [2:51:49<00:00, 207.78s/it]training process: 100%|██████████| 50/50 [2:51:49<00:00, 206.19s/it]
training process finished, best loss : 0.048 and best acc : 0.992, best f1 : 0.896, best epoch : 4

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.89      0.70        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.79      0.94      0.84      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.84, test AUC : 0.94, test loss : 1.458

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:40, 24.05it/s]  1%|          | 6/981 [00:00<00:39, 24.96it/s]  1%|          | 9/981 [00:00<00:37, 25.60it/s]  1%|          | 12/981 [00:00<00:37, 25.64it/s]  2%|▏         | 15/981 [00:00<00:37, 25.61it/s]  2%|▏         | 18/981 [00:00<00:37, 25.68it/s]  2%|▏         | 21/981 [00:00<00:37, 25.62it/s]  2%|▏         | 24/981 [00:00<00:37, 25.66it/s]  3%|▎         | 27/981 [00:01<00:37, 25.57it/s]  3%|▎         | 30/981 [00:01<00:37, 25.67it/s]  3%|▎         | 33/981 [00:01<00:36, 25.72it/s]  4%|▎         | 36/981 [00:01<00:36, 25.76it/s]  4%|▍         | 39/981 [00:01<00:36, 25.76it/s]  4%|▍         | 42/981 [00:01<00:36, 25.81it/s]  5%|▍         | 45/981 [00:01<00:36, 25.72it/s]  5%|▍         | 48/981 [00:01<00:36, 25.82it/s]  5%|▌         | 51/981 [00:01<00:36, 25.64it/s]  6%|▌         | 54/981 [00:02<00:36, 25.60it/s]  6%|▌         | 57/981 [00:02<00:36, 25.52it/s]  6%|▌         | 60/981 [00:02<00:36, 25.53it/s]  6%|▋         | 63/981 [00:02<00:36, 25.49it/s]  7%|▋         | 66/981 [00:02<00:35, 25.50it/s]  7%|▋         | 69/981 [00:02<00:35, 25.73it/s]  7%|▋         | 72/981 [00:02<00:35, 25.34it/s]  8%|▊         | 75/981 [00:02<00:35, 25.63it/s]  8%|▊         | 78/981 [00:03<00:35, 25.40it/s]  8%|▊         | 81/981 [00:03<00:35, 25.45it/s]  9%|▊         | 84/981 [00:03<00:35, 25.45it/s]  9%|▉         | 87/981 [00:03<00:35, 25.52it/s]  9%|▉         | 90/981 [00:03<00:34, 25.59it/s]  9%|▉         | 93/981 [00:03<00:34, 25.55it/s] 10%|▉         | 96/981 [00:03<00:34, 25.65it/s] 10%|█         | 99/981 [00:03<00:34, 25.62it/s] 10%|█         | 102/981 [00:03<00:34, 25.60it/s] 11%|█         | 105/981 [00:04<00:34, 25.50it/s] 11%|█         | 108/981 [00:04<00:34, 25.36it/s] 11%|█▏        | 111/981 [00:04<00:34, 25.45it/s] 12%|█▏        | 114/981 [00:04<00:34, 25.28it/s] 12%|█▏        | 117/981 [00:04<00:34, 25.39it/s] 12%|█▏        | 120/981 [00:04<00:34, 25.31it/s] 13%|█▎        | 123/981 [00:04<00:33, 25.35it/s] 13%|█▎        | 126/981 [00:04<00:33, 25.39it/s] 13%|█▎        | 129/981 [00:05<00:33, 25.34it/s] 13%|█▎        | 132/981 [00:05<00:33, 25.56it/s] 14%|█▍        | 135/981 [00:05<00:33, 25.56it/s] 14%|█▍        | 138/981 [00:05<00:32, 25.56it/s] 14%|█▍        | 141/981 [00:05<00:32, 25.52it/s] 15%|█▍        | 144/981 [00:05<00:32, 25.60it/s] 15%|█▍        | 147/981 [00:05<00:32, 25.62it/s] 15%|█▌        | 150/981 [00:05<00:32, 25.54it/s] 16%|█▌        | 153/981 [00:05<00:32, 25.50it/s] 16%|█▌        | 156/981 [00:06<00:32, 25.74it/s] 16%|█▌        | 159/981 [00:06<00:32, 25.62it/s] 17%|█▋        | 162/981 [00:06<00:31, 25.78it/s] 17%|█▋        | 165/981 [00:06<00:31, 25.75it/s] 17%|█▋        | 168/981 [00:06<00:31, 25.76it/s] 17%|█▋        | 171/981 [00:06<00:31, 25.77it/s] 18%|█▊        | 174/981 [00:06<00:31, 25.77it/s] 18%|█▊        | 177/981 [00:06<00:31, 25.70it/s] 18%|█▊        | 180/981 [00:07<00:31, 25.66it/s] 19%|█▊        | 183/981 [00:07<00:30, 25.87it/s] 19%|█▉        | 186/981 [00:07<00:30, 26.10it/s] 19%|█▉        | 189/981 [00:07<00:30, 26.21it/s] 20%|█▉        | 192/981 [00:07<00:30, 26.25it/s] 20%|█▉        | 195/981 [00:07<00:29, 26.27it/s] 20%|██        | 198/981 [00:07<00:31, 25.12it/s] 20%|██        | 201/981 [00:07<00:30, 25.33it/s] 21%|██        | 204/981 [00:07<00:30, 25.54it/s] 21%|██        | 207/981 [00:08<00:30, 25.63it/s] 21%|██▏       | 210/981 [00:08<00:30, 25.67it/s] 22%|██▏       | 213/981 [00:08<00:29, 25.67it/s] 22%|██▏       | 216/981 [00:08<00:30, 25.47it/s] 22%|██▏       | 219/981 [00:08<00:30, 25.22it/s] 23%|██▎       | 222/981 [00:08<00:30, 25.15it/s] 23%|██▎       | 225/981 [00:08<00:30, 25.20it/s] 23%|██▎       | 228/981 [00:08<00:29, 25.12it/s] 24%|██▎       | 231/981 [00:09<00:30, 24.99it/s] 24%|██▍       | 234/981 [00:09<00:29, 24.95it/s] 24%|██▍       | 237/981 [00:09<00:29, 24.97it/s] 24%|██▍       | 240/981 [00:09<00:29, 24.91it/s] 25%|██▍       | 243/981 [00:09<00:29, 24.89it/s] 25%|██▌       | 246/981 [00:09<00:29, 24.83it/s] 25%|██▌       | 249/981 [00:09<00:30, 24.32it/s] 26%|██▌       | 252/981 [00:09<00:30, 23.98it/s] 26%|██▌       | 255/981 [00:10<00:29, 24.29it/s] 26%|██▋       | 258/981 [00:10<00:29, 24.60it/s] 27%|██▋       | 261/981 [00:10<00:29, 24.62it/s] 27%|██▋       | 264/981 [00:10<00:28, 24.78it/s] 27%|██▋       | 267/981 [00:10<00:28, 24.96it/s] 28%|██▊       | 270/981 [00:10<00:28, 24.82it/s] 28%|██▊       | 273/981 [00:10<00:28, 24.47it/s] 28%|██▊       | 276/981 [00:10<00:28, 24.72it/s] 28%|██▊       | 279/981 [00:10<00:28, 24.83it/s] 29%|██▊       | 282/981 [00:11<00:27, 25.07it/s] 29%|██▉       | 285/981 [00:11<00:27, 25.10it/s] 29%|██▉       | 288/981 [00:11<00:27, 25.06it/s] 30%|██▉       | 291/981 [00:11<00:27, 25.03it/s] 30%|██▉       | 294/981 [00:11<00:27, 24.99it/s] 30%|███       | 297/981 [00:11<00:27, 25.05it/s] 31%|███       | 300/981 [00:11<00:27, 25.12it/s] 31%|███       | 303/981 [00:11<00:26, 25.13it/s] 31%|███       | 306/981 [00:12<00:26, 25.20it/s] 31%|███▏      | 309/981 [00:12<00:26, 25.21it/s] 32%|███▏      | 312/981 [00:12<00:26, 25.32it/s] 32%|███▏      | 315/981 [00:12<00:26, 25.34it/s] 32%|███▏      | 318/981 [00:12<00:26, 25.45it/s] 33%|███▎      | 321/981 [00:12<00:25, 25.51it/s] 33%|███▎      | 324/981 [00:12<00:25, 25.61it/s] 33%|███▎      | 327/981 [00:12<00:25, 25.34it/s] 34%|███▎      | 330/981 [00:13<00:27, 24.06it/s] 34%|███▍      | 333/981 [00:13<00:27, 23.47it/s] 34%|███▍      | 336/981 [00:13<00:27, 23.05it/s] 35%|███▍      | 339/981 [00:13<00:28, 22.77it/s] 35%|███▍      | 342/981 [00:13<00:27, 23.11it/s] 35%|███▌      | 345/981 [00:13<00:26, 23.60it/s] 35%|███▌      | 348/981 [00:13<00:26, 24.12it/s] 36%|███▌      | 351/981 [00:13<00:25, 24.43it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.75it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.81it/s] 37%|███▋      | 360/981 [00:14<00:24, 24.86it/s] 37%|███▋      | 363/981 [00:14<00:24, 24.84it/s] 37%|███▋      | 366/981 [00:14<00:24, 24.94it/s] 38%|███▊      | 369/981 [00:14<00:24, 24.74it/s] 38%|███▊      | 372/981 [00:14<00:24, 24.86it/s] 38%|███▊      | 375/981 [00:14<00:24, 24.92it/s] 39%|███▊      | 378/981 [00:14<00:24, 25.08it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.94it/s] 39%|███▉      | 384/981 [00:15<00:23, 24.93it/s] 39%|███▉      | 387/981 [00:15<00:23, 24.87it/s] 40%|███▉      | 390/981 [00:15<00:23, 24.80it/s] 40%|████      | 393/981 [00:15<00:23, 24.97it/s] 40%|████      | 396/981 [00:15<00:23, 24.91it/s] 41%|████      | 399/981 [00:15<00:23, 24.98it/s] 41%|████      | 402/981 [00:15<00:23, 25.06it/s] 41%|████▏     | 405/981 [00:16<00:22, 25.12it/s] 42%|████▏     | 408/981 [00:16<00:22, 25.16it/s] 42%|████▏     | 411/981 [00:16<00:22, 24.92it/s] 42%|████▏     | 414/981 [00:16<00:22, 24.72it/s] 43%|████▎     | 417/981 [00:16<00:22, 24.80it/s] 43%|████▎     | 420/981 [00:16<00:22, 24.95it/s] 43%|████▎     | 423/981 [00:16<00:22, 25.26it/s] 43%|████▎     | 426/981 [00:16<00:21, 25.44it/s] 44%|████▎     | 429/981 [00:17<00:21, 25.38it/s] 44%|████▍     | 432/981 [00:17<00:21, 25.67it/s] 44%|████▍     | 435/981 [00:17<00:21, 25.61it/s] 45%|████▍     | 438/981 [00:17<00:21, 25.67it/s] 45%|████▍     | 441/981 [00:17<00:21, 25.66it/s] 45%|████▌     | 444/981 [00:17<00:20, 25.68it/s] 46%|████▌     | 447/981 [00:17<00:21, 25.35it/s] 46%|████▌     | 450/981 [00:17<00:20, 25.36it/s] 46%|████▌     | 453/981 [00:17<00:20, 25.62it/s] 46%|████▋     | 456/981 [00:18<00:20, 25.73it/s] 47%|████▋     | 459/981 [00:18<00:20, 25.66it/s] 47%|████▋     | 462/981 [00:18<00:20, 25.64it/s] 47%|████▋     | 465/981 [00:18<00:20, 25.55it/s] 48%|████▊     | 468/981 [00:18<00:20, 25.54it/s] 48%|████▊     | 471/981 [00:18<00:22, 22.98it/s] 48%|████▊     | 474/981 [00:18<00:21, 23.90it/s] 49%|████▊     | 477/981 [00:18<00:20, 24.43it/s] 49%|████▉     | 480/981 [00:19<00:20, 24.84it/s] 49%|████▉     | 483/981 [00:19<00:19, 25.21it/s] 50%|████▉     | 486/981 [00:19<00:19, 25.45it/s] 50%|████▉     | 489/981 [00:19<00:19, 25.61it/s] 50%|█████     | 492/981 [00:19<00:19, 25.59it/s] 50%|█████     | 495/981 [00:19<00:18, 25.62it/s] 51%|█████     | 498/981 [00:19<00:18, 26.01it/s] 51%|█████     | 501/981 [00:19<00:18, 26.28it/s] 51%|█████▏    | 504/981 [00:19<00:18, 26.08it/s] 52%|█████▏    | 507/981 [00:20<00:18, 26.25it/s] 52%|█████▏    | 510/981 [00:20<00:17, 26.45it/s] 52%|█████▏    | 513/981 [00:20<00:17, 26.61it/s] 53%|█████▎    | 516/981 [00:20<00:17, 26.73it/s] 53%|█████▎    | 519/981 [00:20<00:17, 26.77it/s] 53%|█████▎    | 522/981 [00:20<00:17, 26.85it/s] 54%|█████▎    | 525/981 [00:20<00:16, 26.95it/s] 54%|█████▍    | 528/981 [00:20<00:16, 27.06it/s] 54%|█████▍    | 531/981 [00:20<00:16, 26.97it/s] 54%|█████▍    | 534/981 [00:21<00:16, 27.02it/s] 55%|█████▍    | 537/981 [00:21<00:16, 27.10it/s] 55%|█████▌    | 540/981 [00:21<00:16, 27.09it/s] 55%|█████▌    | 543/981 [00:21<00:16, 27.10it/s] 56%|█████▌    | 546/981 [00:21<00:16, 27.18it/s] 56%|█████▌    | 549/981 [00:21<00:15, 27.31it/s] 56%|█████▋    | 552/981 [00:21<00:15, 27.23it/s] 57%|█████▋    | 555/981 [00:21<00:15, 27.19it/s] 57%|█████▋    | 558/981 [00:21<00:15, 27.28it/s] 57%|█████▋    | 561/981 [00:22<00:15, 27.35it/s] 57%|█████▋    | 564/981 [00:22<00:15, 27.13it/s] 58%|█████▊    | 567/981 [00:22<00:15, 27.16it/s] 58%|█████▊    | 570/981 [00:22<00:15, 27.13it/s] 58%|█████▊    | 573/981 [00:22<00:15, 27.19it/s] 59%|█████▊    | 576/981 [00:22<00:14, 27.13it/s] 59%|█████▉    | 579/981 [00:22<00:14, 27.07it/s] 59%|█████▉    | 582/981 [00:22<00:14, 27.22it/s] 60%|█████▉    | 585/981 [00:22<00:14, 27.30it/s] 60%|█████▉    | 588/981 [00:23<00:14, 27.35it/s] 60%|██████    | 591/981 [00:23<00:14, 27.47it/s] 61%|██████    | 594/981 [00:23<00:14, 27.48it/s] 61%|██████    | 597/981 [00:23<00:13, 27.51it/s] 61%|██████    | 600/981 [00:23<00:13, 27.39it/s] 61%|██████▏   | 603/981 [00:23<00:13, 27.40it/s] 62%|██████▏   | 606/981 [00:23<00:13, 27.35it/s] 62%|██████▏   | 609/981 [00:23<00:13, 27.37it/s] 62%|██████▏   | 612/981 [00:23<00:13, 27.45it/s] 63%|██████▎   | 615/981 [00:24<00:13, 27.53it/s] 63%|██████▎   | 618/981 [00:24<00:13, 27.56it/s] 63%|██████▎   | 621/981 [00:24<00:13, 27.59it/s] 64%|██████▎   | 624/981 [00:24<00:12, 27.63it/s] 64%|██████▍   | 627/981 [00:24<00:12, 27.24it/s] 64%|██████▍   | 630/981 [00:24<00:12, 27.14it/s] 65%|██████▍   | 633/981 [00:24<00:12, 27.10it/s] 65%|██████▍   | 636/981 [00:24<00:12, 27.16it/s] 65%|██████▌   | 639/981 [00:24<00:12, 27.25it/s] 65%|██████▌   | 642/981 [00:25<00:12, 27.38it/s] 66%|██████▌   | 645/981 [00:25<00:12, 27.34it/s] 66%|██████▌   | 648/981 [00:25<00:12, 27.14it/s] 66%|██████▋   | 651/981 [00:25<00:12, 27.23it/s] 67%|██████▋   | 654/981 [00:25<00:12, 27.11it/s] 67%|██████▋   | 657/981 [00:25<00:11, 27.19it/s] 67%|██████▋   | 660/981 [00:25<00:11, 27.26it/s] 68%|██████▊   | 663/981 [00:25<00:11, 27.35it/s] 68%|██████▊   | 666/981 [00:25<00:11, 27.16it/s] 68%|██████▊   | 669/981 [00:26<00:11, 26.85it/s] 69%|██████▊   | 672/981 [00:26<00:11, 27.03it/s] 69%|██████▉   | 675/981 [00:26<00:11, 27.22it/s] 69%|██████▉   | 678/981 [00:26<00:11, 27.08it/s] 69%|██████▉   | 681/981 [00:26<00:11, 27.18it/s] 70%|██████▉   | 684/981 [00:26<00:11, 26.91it/s] 70%|███████   | 687/981 [00:26<00:10, 26.87it/s] 70%|███████   | 690/981 [00:26<00:10, 27.08it/s] 71%|███████   | 693/981 [00:26<00:10, 27.18it/s] 71%|███████   | 696/981 [00:27<00:10, 26.91it/s] 71%|███████▏  | 699/981 [00:27<00:10, 27.10it/s] 72%|███████▏  | 702/981 [00:27<00:10, 26.90it/s] 72%|███████▏  | 705/981 [00:27<00:10, 26.96it/s] 72%|███████▏  | 708/981 [00:27<00:10, 26.95it/s] 72%|███████▏  | 711/981 [00:27<00:10, 26.87it/s] 73%|███████▎  | 714/981 [00:27<00:09, 26.90it/s] 73%|███████▎  | 717/981 [00:27<00:09, 26.85it/s] 73%|███████▎  | 720/981 [00:27<00:09, 26.77it/s] 74%|███████▎  | 723/981 [00:28<00:09, 26.73it/s] 74%|███████▍  | 726/981 [00:28<00:09, 26.69it/s] 74%|███████▍  | 729/981 [00:28<00:09, 26.91it/s] 75%|███████▍  | 732/981 [00:28<00:09, 27.03it/s] 75%|███████▍  | 735/981 [00:28<00:09, 27.06it/s] 75%|███████▌  | 738/981 [00:28<00:08, 27.03it/s] 76%|███████▌  | 741/981 [00:28<00:08, 27.10it/s] 76%|███████▌  | 744/981 [00:28<00:08, 27.17it/s] 76%|███████▌  | 747/981 [00:28<00:08, 27.02it/s] 76%|███████▋  | 750/981 [00:29<00:08, 26.51it/s] 77%|███████▋  | 753/981 [00:29<00:08, 26.28it/s] 77%|███████▋  | 756/981 [00:29<00:08, 26.32it/s] 77%|███████▋  | 759/981 [00:29<00:08, 26.33it/s] 78%|███████▊  | 762/981 [00:29<00:08, 26.53it/s] 78%|███████▊  | 765/981 [00:29<00:08, 26.62it/s] 78%|███████▊  | 768/981 [00:29<00:08, 26.58it/s] 79%|███████▊  | 771/981 [00:29<00:07, 26.54it/s] 79%|███████▉  | 774/981 [00:29<00:07, 26.57it/s] 79%|███████▉  | 777/981 [00:30<00:07, 26.71it/s] 80%|███████▉  | 780/981 [00:30<00:07, 26.83it/s] 80%|███████▉  | 783/981 [00:30<00:07, 27.15it/s] 80%|████████  | 786/981 [00:30<00:07, 27.52it/s] 80%|████████  | 789/981 [00:30<00:06, 28.01it/s] 81%|████████  | 792/981 [00:30<00:06, 28.24it/s] 81%|████████  | 795/981 [00:30<00:06, 28.61it/s] 81%|████████▏ | 798/981 [00:30<00:06, 28.87it/s] 82%|████████▏ | 802/981 [00:30<00:06, 29.38it/s] 82%|████████▏ | 806/981 [00:31<00:05, 29.80it/s] 83%|████████▎ | 810/981 [00:31<00:05, 30.24it/s] 83%|████████▎ | 814/981 [00:31<00:05, 30.60it/s] 83%|████████▎ | 818/981 [00:31<00:05, 30.75it/s] 84%|████████▍ | 822/981 [00:31<00:05, 30.90it/s] 84%|████████▍ | 826/981 [00:31<00:04, 31.03it/s] 85%|████████▍ | 830/981 [00:31<00:04, 31.06it/s] 85%|████████▌ | 834/981 [00:31<00:04, 31.12it/s] 85%|████████▌ | 838/981 [00:32<00:04, 31.20it/s] 86%|████████▌ | 842/981 [00:32<00:04, 31.30it/s] 86%|████████▌ | 846/981 [00:32<00:04, 31.26it/s] 87%|████████▋ | 850/981 [00:32<00:04, 30.87it/s] 87%|████████▋ | 854/981 [00:32<00:04, 31.13it/s] 87%|████████▋ | 858/981 [00:32<00:03, 31.26it/s] 88%|████████▊ | 862/981 [00:32<00:03, 31.40it/s] 88%|████████▊ | 866/981 [00:32<00:03, 31.50it/s] 89%|████████▊ | 870/981 [00:33<00:03, 31.52it/s] 89%|████████▉ | 874/981 [00:33<00:03, 31.61it/s] 90%|████████▉ | 878/981 [00:33<00:03, 31.59it/s] 90%|████████▉ | 882/981 [00:33<00:03, 31.53it/s] 90%|█████████ | 886/981 [00:33<00:03, 31.52it/s] 91%|█████████ | 890/981 [00:33<00:02, 31.59it/s] 91%|█████████ | 894/981 [00:33<00:02, 31.67it/s] 92%|█████████▏| 898/981 [00:33<00:02, 31.73it/s] 92%|█████████▏| 902/981 [00:34<00:02, 31.85it/s] 92%|█████████▏| 906/981 [00:34<00:02, 31.89it/s] 93%|█████████▎| 910/981 [00:34<00:02, 31.89it/s] 93%|█████████▎| 914/981 [00:34<00:02, 31.89it/s] 94%|█████████▎| 918/981 [00:34<00:01, 31.82it/s] 94%|█████████▍| 922/981 [00:34<00:01, 31.88it/s] 94%|█████████▍| 926/981 [00:34<00:01, 31.94it/s] 95%|█████████▍| 930/981 [00:34<00:01, 31.89it/s] 95%|█████████▌| 934/981 [00:35<00:01, 31.86it/s] 96%|█████████▌| 938/981 [00:35<00:01, 31.83it/s] 96%|█████████▌| 942/981 [00:35<00:01, 31.85it/s] 96%|█████████▋| 946/981 [00:35<00:01, 31.88it/s] 97%|█████████▋| 950/981 [00:35<00:00, 31.84it/s] 97%|█████████▋| 954/981 [00:35<00:00, 30.52it/s] 98%|█████████▊| 958/981 [00:35<00:00, 30.83it/s] 98%|█████████▊| 962/981 [00:36<00:00, 31.06it/s] 98%|█████████▊| 966/981 [00:36<00:00, 31.30it/s] 99%|█████████▉| 970/981 [00:36<00:00, 31.46it/s] 99%|█████████▉| 974/981 [00:36<00:00, 31.62it/s]100%|█████████▉| 978/981 [00:36<00:00, 31.64it/s]100%|██████████| 981/981 [00:36<00:00, 26.79it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.037, valid loss : 0.037, train acc : 0.981, valid acc : 0.976, train f1 : 0.511, valid f1 : 0.519
training process:   2%|▏         | 1/50 [03:59<3:15:41, 239.63s/it]training process:   4%|▍         | 2/50 [07:11<2:49:08, 211.43s/it]training process:   6%|▌         | 3/50 [10:21<2:38:07, 201.85s/it]training process:   8%|▊         | 4/50 [13:34<2:31:51, 198.07s/it]epoch : 5, train loss : 0.027, valid loss : 0.031, train acc : 0.988, valid acc : 0.988, train f1 : 0.769, valid f1 : 0.766
training process:  10%|█         | 5/50 [17:29<2:38:36, 211.47s/it]training process:  12%|█▏        | 6/50 [20:41<2:30:15, 204.89s/it]training process:  14%|█▍        | 7/50 [23:54<2:24:02, 200.98s/it]training process:  16%|█▌        | 8/50 [27:08<2:19:14, 198.93s/it]epoch : 9, train loss : 0.026, valid loss : 0.020, train acc : 0.981, valid acc : 0.979, train f1 : 0.699, valid f1 : 0.747
training process:  18%|█▊        | 9/50 [31:04<2:23:51, 210.53s/it]training process:  20%|██        | 10/50 [34:16<2:16:28, 204.72s/it]training process:  22%|██▏       | 11/50 [37:28<2:10:35, 200.92s/it]training process:  24%|██▍       | 12/50 [40:44<2:06:08, 199.18s/it]epoch : 13, train loss : 0.016, valid loss : 0.020, train acc : 0.990, valid acc : 0.994, train f1 : 0.845, valid f1 : 0.909
training process:  26%|██▌       | 13/50 [44:44<2:10:29, 211.61s/it]training process:  28%|██▊       | 14/50 [47:57<2:03:38, 206.08s/it]training process:  30%|███       | 15/50 [51:20<1:59:39, 205.13s/it]training process:  32%|███▏      | 16/50 [55:38<2:05:19, 221.16s/it]epoch : 17, train loss : 0.011, valid loss : 0.016, train acc : 0.993, valid acc : 0.990, train f1 : 0.890, valid f1 : 0.873
training process:  34%|███▍      | 17/50 [1:00:20<2:11:35, 239.25s/it]training process:  36%|███▌      | 18/50 [1:03:30<1:59:42, 224.44s/it]training process:  38%|███▊      | 19/50 [1:06:39<1:50:34, 214.01s/it]training process:  40%|████      | 20/50 [1:09:49<1:43:19, 206.66s/it]epoch : 21, train loss : 0.012, valid loss : 0.015, train acc : 0.994, valid acc : 0.994, train f1 : 0.907, valid f1 : 0.904
training process:  42%|████▏     | 21/50 [1:13:43<1:43:49, 214.83s/it]training process:  44%|████▍     | 22/50 [1:16:55<1:37:06, 208.10s/it]training process:  46%|████▌     | 23/50 [1:20:06<1:31:18, 202.92s/it]training process:  48%|████▊     | 24/50 [1:23:18<1:26:26, 199.46s/it]epoch : 25, train loss : 0.010, valid loss : 0.014, train acc : 0.994, valid acc : 0.995, train f1 : 0.912, valid f1 : 0.919
training process:  50%|█████     | 25/50 [1:27:12<1:27:30, 210.04s/it]training process:  52%|█████▏    | 26/50 [1:30:25<1:21:57, 204.90s/it]training process:  54%|█████▍    | 27/50 [1:33:38<1:17:06, 201.15s/it]training process:  56%|█████▌    | 28/50 [1:36:49<1:12:42, 198.28s/it]epoch : 29, train loss : 0.009, valid loss : 0.013, train acc : 0.995, valid acc : 0.995, train f1 : 0.926, valid f1 : 0.930
training process:  58%|█████▊    | 29/50 [1:40:44<1:13:12, 209.15s/it]training process:  60%|██████    | 30/50 [1:43:54<1:07:52, 203.61s/it]training process:  62%|██████▏   | 31/50 [1:47:06<1:03:18, 199.93s/it]training process:  64%|██████▍   | 32/50 [1:50:16<59:08, 197.13s/it]  epoch : 33, train loss : 0.009, valid loss : 0.011, train acc : 0.995, valid acc : 0.996, train f1 : 0.920, valid f1 : 0.942
training process:  66%|██████▌   | 33/50 [1:54:11<59:04, 208.50s/it]training process:  68%|██████▊   | 34/50 [1:57:22<54:08, 203.03s/it]training process:  70%|███████   | 35/50 [2:00:34<49:57, 199.82s/it]training process:  72%|███████▏  | 36/50 [2:03:46<46:06, 197.62s/it]epoch : 37, train loss : 0.009, valid loss : 0.013, train acc : 0.995, valid acc : 0.996, train f1 : 0.924, valid f1 : 0.932
training process:  74%|███████▍  | 37/50 [2:07:42<45:18, 209.12s/it]training process:  76%|███████▌  | 38/50 [2:10:55<40:51, 204.27s/it]training process:  78%|███████▊  | 39/50 [2:14:09<36:51, 201.02s/it]training process:  80%|████████  | 40/50 [2:17:21<33:05, 198.54s/it]epoch : 41, train loss : 0.008, valid loss : 0.011, train acc : 0.995, valid acc : 0.996, train f1 : 0.926, valid f1 : 0.943
training process:  82%|████████▏ | 41/50 [2:21:16<31:23, 209.22s/it]training process:  84%|████████▍ | 42/50 [2:24:28<27:12, 204.08s/it]training process:  86%|████████▌ | 43/50 [2:27:38<23:18, 199.86s/it]training process:  88%|████████▊ | 44/50 [2:30:50<19:46, 197.68s/it]epoch : 45, train loss : 0.008, valid loss : 0.011, train acc : 0.995, valid acc : 0.993, train f1 : 0.925, valid f1 : 0.907
training process:  90%|█████████ | 45/50 [2:34:44<17:22, 208.59s/it]training process:  92%|█████████▏| 46/50 [2:37:59<13:37, 204.45s/it]training process:  94%|█████████▍| 47/50 [2:41:09<10:00, 200.18s/it]training process:  96%|█████████▌| 48/50 [2:44:21<06:35, 197.73s/it]epoch : 49, train loss : 0.008, valid loss : 0.016, train acc : 0.996, valid acc : 0.994, train f1 : 0.936, valid f1 : 0.915
training process:  98%|█████████▊| 49/50 [2:48:19<03:29, 209.80s/it]training process: 100%|██████████| 50/50 [2:51:29<00:00, 203.82s/it]training process: 100%|██████████| 50/50 [2:51:29<00:00, 205.79s/it]
training process finished, best loss : 0.011 and best acc : 0.996, best f1 : 0.943, best epoch : 40

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.64      0.82      0.72        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.82      0.90      0.86      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.86, test AUC : 0.90, test loss : 0.201

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:42, 23.23it/s]  1%|          | 6/981 [00:00<00:40, 24.00it/s]  1%|          | 9/981 [00:00<00:39, 24.31it/s]  1%|          | 12/981 [00:00<00:39, 24.48it/s]  2%|▏         | 15/981 [00:00<00:39, 24.55it/s]  2%|▏         | 18/981 [00:00<00:39, 24.61it/s]  2%|▏         | 21/981 [00:00<00:38, 24.74it/s]  2%|▏         | 24/981 [00:00<00:38, 24.67it/s]  3%|▎         | 27/981 [00:01<00:38, 24.74it/s]  3%|▎         | 30/981 [00:01<00:38, 24.97it/s]  3%|▎         | 33/981 [00:01<00:37, 24.97it/s]  4%|▎         | 36/981 [00:01<00:37, 24.96it/s]  4%|▍         | 39/981 [00:01<00:37, 24.95it/s]  4%|▍         | 42/981 [00:01<00:37, 24.89it/s]  5%|▍         | 45/981 [00:01<00:37, 24.79it/s]  5%|▍         | 48/981 [00:01<00:37, 24.67it/s]  5%|▌         | 51/981 [00:02<00:37, 24.68it/s]  6%|▌         | 54/981 [00:02<00:37, 24.79it/s]  6%|▌         | 57/981 [00:02<00:37, 24.78it/s]  6%|▌         | 60/981 [00:02<00:36, 25.06it/s]  6%|▋         | 63/981 [00:02<00:36, 25.43it/s]  7%|▋         | 66/981 [00:02<00:35, 25.45it/s]  7%|▋         | 69/981 [00:02<00:35, 25.34it/s]  7%|▋         | 72/981 [00:02<00:35, 25.37it/s]  8%|▊         | 75/981 [00:03<00:35, 25.47it/s]  8%|▊         | 78/981 [00:03<00:35, 25.29it/s]  8%|▊         | 81/981 [00:03<00:35, 25.17it/s]  9%|▊         | 84/981 [00:03<00:35, 24.96it/s]  9%|▉         | 87/981 [00:03<00:36, 24.73it/s]  9%|▉         | 90/981 [00:03<00:36, 24.55it/s]  9%|▉         | 93/981 [00:03<00:36, 24.58it/s] 10%|▉         | 96/981 [00:03<00:35, 24.65it/s] 10%|█         | 99/981 [00:03<00:35, 24.68it/s] 10%|█         | 102/981 [00:04<00:35, 24.68it/s] 11%|█         | 105/981 [00:04<00:35, 24.62it/s] 11%|█         | 108/981 [00:04<00:35, 24.48it/s] 11%|█▏        | 111/981 [00:04<00:35, 24.61it/s] 12%|█▏        | 114/981 [00:04<00:35, 24.57it/s] 12%|█▏        | 117/981 [00:04<00:35, 24.47it/s] 12%|█▏        | 120/981 [00:04<00:35, 24.39it/s] 13%|█▎        | 123/981 [00:04<00:35, 24.16it/s] 13%|█▎        | 126/981 [00:05<00:35, 24.13it/s] 13%|█▎        | 129/981 [00:05<00:35, 24.21it/s] 13%|█▎        | 132/981 [00:05<00:35, 24.22it/s] 14%|█▍        | 135/981 [00:05<00:34, 24.32it/s] 14%|█▍        | 138/981 [00:05<00:34, 24.46it/s] 14%|█▍        | 141/981 [00:05<00:34, 24.53it/s] 15%|█▍        | 144/981 [00:05<00:34, 24.61it/s] 15%|█▍        | 147/981 [00:05<00:33, 24.77it/s] 15%|█▌        | 150/981 [00:06<00:33, 24.71it/s] 16%|█▌        | 153/981 [00:06<00:33, 24.62it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.66it/s] 16%|█▌        | 159/981 [00:06<00:33, 24.40it/s] 17%|█▋        | 162/981 [00:06<00:33, 24.22it/s] 17%|█▋        | 165/981 [00:06<00:33, 24.35it/s] 17%|█▋        | 168/981 [00:06<00:33, 24.13it/s] 17%|█▋        | 171/981 [00:06<00:33, 23.92it/s] 18%|█▊        | 174/981 [00:07<00:33, 24.12it/s] 18%|█▊        | 177/981 [00:07<00:32, 24.41it/s] 18%|█▊        | 180/981 [00:07<00:32, 24.58it/s] 19%|█▊        | 183/981 [00:07<00:32, 24.63it/s] 19%|█▉        | 186/981 [00:07<00:32, 24.66it/s] 19%|█▉        | 189/981 [00:07<00:31, 24.78it/s] 20%|█▉        | 192/981 [00:07<00:31, 24.79it/s] 20%|█▉        | 195/981 [00:07<00:31, 24.59it/s] 20%|██        | 198/981 [00:08<00:31, 24.59it/s] 20%|██        | 201/981 [00:08<00:31, 24.46it/s] 21%|██        | 204/981 [00:08<00:31, 24.35it/s] 21%|██        | 207/981 [00:08<00:32, 24.13it/s] 21%|██▏       | 210/981 [00:08<00:32, 24.05it/s] 22%|██▏       | 213/981 [00:08<00:31, 24.10it/s] 22%|██▏       | 216/981 [00:08<00:31, 24.14it/s] 22%|██▏       | 219/981 [00:08<00:31, 24.30it/s] 23%|██▎       | 222/981 [00:09<00:31, 24.35it/s] 23%|██▎       | 225/981 [00:09<00:31, 24.32it/s] 23%|██▎       | 228/981 [00:09<00:30, 24.33it/s] 24%|██▎       | 231/981 [00:09<00:30, 24.29it/s] 24%|██▍       | 234/981 [00:09<00:30, 24.27it/s] 24%|██▍       | 237/981 [00:09<00:30, 24.33it/s] 24%|██▍       | 240/981 [00:09<00:30, 24.38it/s] 25%|██▍       | 243/981 [00:09<00:30, 23.85it/s] 25%|██▌       | 246/981 [00:10<00:30, 23.97it/s] 25%|██▌       | 249/981 [00:10<00:30, 24.01it/s] 26%|██▌       | 252/981 [00:10<00:30, 23.96it/s] 26%|██▌       | 255/981 [00:10<00:29, 24.27it/s] 26%|██▋       | 258/981 [00:10<00:29, 24.53it/s] 27%|██▋       | 261/981 [00:10<00:29, 24.74it/s] 27%|██▋       | 264/981 [00:10<00:28, 24.87it/s] 27%|██▋       | 267/981 [00:10<00:29, 24.52it/s] 28%|██▊       | 270/981 [00:11<00:29, 24.34it/s] 28%|██▊       | 273/981 [00:11<00:29, 24.23it/s] 28%|██▊       | 276/981 [00:11<00:29, 23.76it/s] 28%|██▊       | 279/981 [00:11<00:29, 23.89it/s] 29%|██▊       | 282/981 [00:11<00:29, 24.02it/s] 29%|██▉       | 285/981 [00:11<00:28, 24.05it/s] 29%|██▉       | 288/981 [00:11<00:28, 23.97it/s] 30%|██▉       | 291/981 [00:11<00:28, 24.23it/s] 30%|██▉       | 294/981 [00:11<00:28, 24.39it/s] 30%|███       | 297/981 [00:12<00:27, 24.59it/s] 31%|███       | 300/981 [00:12<00:27, 24.75it/s] 31%|███       | 303/981 [00:12<00:27, 24.53it/s] 31%|███       | 306/981 [00:12<00:27, 24.31it/s] 31%|███▏      | 309/981 [00:12<00:28, 23.69it/s] 32%|███▏      | 312/981 [00:12<00:28, 23.85it/s] 32%|███▏      | 315/981 [00:12<00:27, 23.92it/s] 32%|███▏      | 318/981 [00:12<00:27, 24.00it/s] 33%|███▎      | 321/981 [00:13<00:27, 24.22it/s] 33%|███▎      | 324/981 [00:13<00:27, 24.14it/s] 33%|███▎      | 327/981 [00:13<00:26, 24.24it/s] 34%|███▎      | 330/981 [00:13<00:26, 24.37it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.35it/s] 34%|███▍      | 336/981 [00:13<00:26, 24.41it/s] 35%|███▍      | 339/981 [00:13<00:26, 24.45it/s] 35%|███▍      | 342/981 [00:13<00:25, 24.65it/s] 35%|███▌      | 345/981 [00:14<00:25, 24.60it/s] 35%|███▌      | 348/981 [00:14<00:25, 24.43it/s] 36%|███▌      | 351/981 [00:14<00:25, 24.29it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.28it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.13it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.11it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.17it/s] 37%|███▋      | 366/981 [00:14<00:25, 24.05it/s] 38%|███▊      | 369/981 [00:15<00:25, 24.20it/s] 38%|███▊      | 372/981 [00:15<00:25, 24.22it/s] 38%|███▊      | 375/981 [00:15<00:24, 24.28it/s] 39%|███▊      | 378/981 [00:15<00:24, 24.21it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.31it/s] 39%|███▉      | 384/981 [00:15<00:24, 24.33it/s] 39%|███▉      | 387/981 [00:15<00:24, 24.20it/s] 40%|███▉      | 390/981 [00:15<00:24, 24.10it/s] 40%|████      | 393/981 [00:16<00:24, 24.08it/s] 40%|████      | 396/981 [00:16<00:24, 24.09it/s] 41%|████      | 399/981 [00:16<00:24, 23.99it/s] 41%|████      | 402/981 [00:16<00:23, 24.19it/s] 41%|████▏     | 405/981 [00:16<00:23, 24.40it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.47it/s] 42%|████▏     | 411/981 [00:16<00:23, 24.20it/s] 42%|████▏     | 414/981 [00:16<00:23, 24.32it/s] 43%|████▎     | 417/981 [00:17<00:23, 24.42it/s] 43%|████▎     | 420/981 [00:17<00:23, 24.39it/s] 43%|████▎     | 423/981 [00:17<00:22, 24.39it/s] 43%|████▎     | 426/981 [00:17<00:22, 24.39it/s] 44%|████▎     | 429/981 [00:17<00:22, 24.32it/s] 44%|████▍     | 432/981 [00:17<00:22, 23.93it/s] 44%|████▍     | 435/981 [00:17<00:22, 23.89it/s] 45%|████▍     | 438/981 [00:17<00:22, 23.81it/s] 45%|████▍     | 441/981 [00:18<00:22, 23.91it/s] 45%|████▌     | 444/981 [00:18<00:22, 24.30it/s] 46%|████▌     | 447/981 [00:18<00:21, 24.60it/s] 46%|████▌     | 450/981 [00:18<00:21, 24.24it/s] 46%|████▌     | 453/981 [00:18<00:21, 24.35it/s] 46%|████▋     | 456/981 [00:18<00:21, 24.42it/s] 47%|████▋     | 459/981 [00:18<00:21, 24.30it/s] 47%|████▋     | 462/981 [00:18<00:21, 24.28it/s] 47%|████▋     | 465/981 [00:19<00:21, 24.29it/s] 48%|████▊     | 468/981 [00:19<00:21, 24.12it/s] 48%|████▊     | 471/981 [00:19<00:21, 24.11it/s] 48%|████▊     | 474/981 [00:19<00:20, 24.15it/s] 49%|████▊     | 477/981 [00:19<00:20, 24.13it/s] 49%|████▉     | 480/981 [00:19<00:20, 24.28it/s] 49%|████▉     | 483/981 [00:19<00:20, 24.39it/s] 50%|████▉     | 486/981 [00:19<00:19, 24.79it/s] 50%|████▉     | 489/981 [00:20<00:19, 24.70it/s] 50%|█████     | 492/981 [00:20<00:19, 24.56it/s] 50%|█████     | 495/981 [00:20<00:19, 24.53it/s] 51%|█████     | 498/981 [00:20<00:19, 24.49it/s] 51%|█████     | 501/981 [00:20<00:19, 24.38it/s] 51%|█████▏    | 504/981 [00:20<00:19, 24.36it/s] 52%|█████▏    | 507/981 [00:20<00:19, 24.47it/s] 52%|█████▏    | 510/981 [00:20<00:19, 24.23it/s] 52%|█████▏    | 513/981 [00:21<00:19, 24.30it/s] 53%|█████▎    | 516/981 [00:21<00:19, 24.15it/s] 53%|█████▎    | 519/981 [00:21<00:18, 24.45it/s] 53%|█████▎    | 522/981 [00:21<00:18, 24.68it/s] 54%|█████▎    | 525/981 [00:21<00:18, 24.82it/s] 54%|█████▍    | 528/981 [00:21<00:18, 25.13it/s] 54%|█████▍    | 531/981 [00:21<00:17, 25.32it/s] 54%|█████▍    | 534/981 [00:21<00:17, 25.16it/s] 55%|█████▍    | 537/981 [00:21<00:17, 24.84it/s] 55%|█████▌    | 540/981 [00:22<00:17, 24.97it/s] 55%|█████▌    | 543/981 [00:22<00:17, 25.00it/s] 56%|█████▌    | 546/981 [00:22<00:17, 24.63it/s] 56%|█████▌    | 549/981 [00:22<00:17, 24.78it/s] 56%|█████▋    | 552/981 [00:22<00:17, 24.85it/s] 57%|█████▋    | 555/981 [00:22<00:17, 25.01it/s] 57%|█████▋    | 558/981 [00:22<00:16, 25.10it/s] 57%|█████▋    | 561/981 [00:22<00:16, 25.18it/s] 57%|█████▋    | 564/981 [00:23<00:16, 25.24it/s] 58%|█████▊    | 567/981 [00:23<00:16, 25.33it/s] 58%|█████▊    | 570/981 [00:23<00:16, 25.50it/s] 58%|█████▊    | 573/981 [00:23<00:15, 25.55it/s] 59%|█████▊    | 576/981 [00:23<00:15, 25.37it/s] 59%|█████▉    | 579/981 [00:23<00:15, 25.26it/s] 59%|█████▉    | 582/981 [00:23<00:15, 25.25it/s] 60%|█████▉    | 585/981 [00:23<00:15, 25.18it/s] 60%|█████▉    | 588/981 [00:24<00:15, 25.10it/s] 60%|██████    | 591/981 [00:24<00:15, 25.14it/s] 61%|██████    | 594/981 [00:24<00:15, 25.23it/s] 61%|██████    | 597/981 [00:24<00:15, 25.27it/s] 61%|██████    | 600/981 [00:24<00:15, 25.23it/s] 61%|██████▏   | 603/981 [00:24<00:14, 25.58it/s] 62%|██████▏   | 606/981 [00:24<00:14, 25.85it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.69it/s] 62%|██████▏   | 612/981 [00:24<00:14, 25.84it/s] 63%|██████▎   | 615/981 [00:25<00:14, 25.83it/s] 63%|██████▎   | 618/981 [00:25<00:14, 25.83it/s] 63%|██████▎   | 621/981 [00:25<00:14, 25.50it/s] 64%|██████▎   | 624/981 [00:25<00:13, 25.50it/s] 64%|██████▍   | 627/981 [00:25<00:13, 25.46it/s] 64%|██████▍   | 630/981 [00:25<00:13, 25.49it/s] 65%|██████▍   | 633/981 [00:25<00:13, 25.51it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.74it/s] 65%|██████▌   | 639/981 [00:25<00:13, 26.00it/s] 65%|██████▌   | 642/981 [00:26<00:12, 26.14it/s] 66%|██████▌   | 645/981 [00:26<00:12, 26.02it/s] 66%|██████▌   | 648/981 [00:26<00:12, 25.92it/s] 66%|██████▋   | 651/981 [00:26<00:13, 25.01it/s] 67%|██████▋   | 654/981 [00:26<00:13, 25.13it/s] 67%|██████▋   | 657/981 [00:26<00:12, 25.17it/s] 67%|██████▋   | 660/981 [00:26<00:12, 25.27it/s] 68%|██████▊   | 663/981 [00:26<00:12, 25.36it/s] 68%|██████▊   | 666/981 [00:27<00:12, 25.39it/s] 68%|██████▊   | 669/981 [00:27<00:12, 25.37it/s] 69%|██████▊   | 672/981 [00:27<00:12, 25.26it/s] 69%|██████▉   | 675/981 [00:27<00:12, 25.18it/s] 69%|██████▉   | 678/981 [00:27<00:11, 25.29it/s] 69%|██████▉   | 681/981 [00:27<00:11, 25.07it/s] 70%|██████▉   | 684/981 [00:27<00:11, 25.20it/s] 70%|███████   | 687/981 [00:27<00:11, 25.24it/s] 70%|███████   | 690/981 [00:28<00:11, 25.15it/s] 71%|███████   | 693/981 [00:28<00:11, 25.01it/s] 71%|███████   | 696/981 [00:28<00:11, 24.97it/s] 71%|███████▏  | 699/981 [00:28<00:11, 24.89it/s] 72%|███████▏  | 702/981 [00:28<00:11, 24.95it/s] 72%|███████▏  | 705/981 [00:28<00:11, 24.62it/s] 72%|███████▏  | 708/981 [00:28<00:11, 24.81it/s] 72%|███████▏  | 711/981 [00:28<00:10, 24.96it/s] 73%|███████▎  | 714/981 [00:28<00:10, 24.88it/s] 73%|███████▎  | 717/981 [00:29<00:10, 25.04it/s] 73%|███████▎  | 720/981 [00:29<00:10, 25.19it/s] 74%|███████▎  | 723/981 [00:29<00:10, 25.18it/s] 74%|███████▍  | 726/981 [00:29<00:10, 25.29it/s] 74%|███████▍  | 729/981 [00:29<00:09, 25.29it/s] 75%|███████▍  | 732/981 [00:29<00:09, 25.38it/s] 75%|███████▍  | 735/981 [00:29<00:09, 25.11it/s] 75%|███████▌  | 738/981 [00:29<00:09, 25.00it/s] 76%|███████▌  | 741/981 [00:30<00:09, 25.04it/s] 76%|███████▌  | 744/981 [00:30<00:09, 24.80it/s] 76%|███████▌  | 747/981 [00:30<00:09, 24.71it/s] 76%|███████▋  | 750/981 [00:30<00:09, 24.55it/s] 77%|███████▋  | 753/981 [00:30<00:09, 24.55it/s] 77%|███████▋  | 756/981 [00:30<00:09, 24.71it/s] 77%|███████▋  | 759/981 [00:30<00:08, 24.76it/s] 78%|███████▊  | 762/981 [00:30<00:08, 24.79it/s] 78%|███████▊  | 765/981 [00:31<00:08, 24.33it/s] 78%|███████▊  | 768/981 [00:31<00:08, 24.29it/s] 79%|███████▊  | 771/981 [00:31<00:08, 24.39it/s] 79%|███████▉  | 774/981 [00:31<00:08, 24.44it/s] 79%|███████▉  | 777/981 [00:31<00:08, 24.61it/s] 80%|███████▉  | 780/981 [00:31<00:08, 24.55it/s] 80%|███████▉  | 783/981 [00:31<00:08, 24.64it/s] 80%|████████  | 786/981 [00:31<00:07, 25.04it/s] 80%|████████  | 789/981 [00:31<00:07, 25.47it/s] 81%|████████  | 792/981 [00:32<00:07, 26.02it/s] 81%|████████  | 795/981 [00:32<00:06, 26.59it/s] 81%|████████▏ | 798/981 [00:32<00:06, 27.08it/s] 82%|████████▏ | 801/981 [00:32<00:06, 27.70it/s] 82%|████████▏ | 804/981 [00:32<00:06, 27.84it/s] 82%|████████▏ | 807/981 [00:32<00:06, 27.99it/s] 83%|████████▎ | 810/981 [00:32<00:06, 28.21it/s] 83%|████████▎ | 813/981 [00:32<00:05, 28.44it/s] 83%|████████▎ | 816/981 [00:32<00:05, 28.44it/s] 83%|████████▎ | 819/981 [00:33<00:05, 28.34it/s] 84%|████████▍ | 822/981 [00:33<00:05, 28.22it/s] 84%|████████▍ | 825/981 [00:33<00:05, 28.20it/s] 84%|████████▍ | 828/981 [00:33<00:05, 28.15it/s] 85%|████████▍ | 831/981 [00:33<00:05, 28.14it/s] 85%|████████▌ | 834/981 [00:33<00:05, 28.26it/s] 85%|████████▌ | 837/981 [00:33<00:05, 28.29it/s] 86%|████████▌ | 840/981 [00:33<00:04, 28.48it/s] 86%|████████▌ | 843/981 [00:33<00:04, 28.64it/s] 86%|████████▌ | 846/981 [00:33<00:04, 28.79it/s] 87%|████████▋ | 849/981 [00:34<00:04, 29.07it/s] 87%|████████▋ | 852/981 [00:34<00:04, 29.08it/s] 87%|████████▋ | 855/981 [00:34<00:04, 29.14it/s] 87%|████████▋ | 858/981 [00:34<00:04, 29.06it/s] 88%|████████▊ | 861/981 [00:34<00:04, 28.94it/s] 88%|████████▊ | 864/981 [00:34<00:04, 28.76it/s] 88%|████████▊ | 867/981 [00:34<00:03, 28.72it/s] 89%|████████▊ | 870/981 [00:34<00:03, 28.68it/s] 89%|████████▉ | 873/981 [00:34<00:03, 28.76it/s] 89%|████████▉ | 876/981 [00:35<00:03, 28.78it/s] 90%|████████▉ | 879/981 [00:35<00:03, 28.83it/s] 90%|████████▉ | 882/981 [00:35<00:03, 28.76it/s] 90%|█████████ | 885/981 [00:35<00:03, 28.51it/s] 91%|█████████ | 888/981 [00:35<00:03, 28.58it/s] 91%|█████████ | 891/981 [00:35<00:03, 28.56it/s] 91%|█████████ | 894/981 [00:35<00:03, 28.55it/s] 91%|█████████▏| 897/981 [00:35<00:02, 28.85it/s] 92%|█████████▏| 900/981 [00:35<00:02, 28.96it/s] 92%|█████████▏| 903/981 [00:35<00:02, 28.92it/s] 92%|█████████▏| 906/981 [00:36<00:02, 28.88it/s] 93%|█████████▎| 909/981 [00:36<00:02, 28.73it/s] 93%|█████████▎| 912/981 [00:36<00:02, 28.67it/s] 93%|█████████▎| 915/981 [00:36<00:02, 28.36it/s] 94%|█████████▎| 918/981 [00:36<00:02, 28.45it/s] 94%|█████████▍| 921/981 [00:36<00:02, 28.41it/s] 94%|█████████▍| 924/981 [00:36<00:01, 28.56it/s] 94%|█████████▍| 927/981 [00:36<00:01, 28.63it/s] 95%|█████████▍| 930/981 [00:36<00:01, 28.81it/s] 95%|█████████▌| 933/981 [00:37<00:01, 28.78it/s] 95%|█████████▌| 936/981 [00:37<00:01, 28.84it/s] 96%|█████████▌| 939/981 [00:37<00:01, 28.98it/s] 96%|█████████▌| 942/981 [00:37<00:01, 28.93it/s] 96%|█████████▋| 945/981 [00:37<00:01, 29.12it/s] 97%|█████████▋| 948/981 [00:37<00:01, 29.12it/s] 97%|█████████▋| 951/981 [00:37<00:01, 29.24it/s] 97%|█████████▋| 954/981 [00:37<00:00, 29.16it/s] 98%|█████████▊| 957/981 [00:37<00:00, 28.60it/s] 98%|█████████▊| 960/981 [00:37<00:00, 28.57it/s] 98%|█████████▊| 963/981 [00:38<00:00, 28.77it/s] 98%|█████████▊| 966/981 [00:38<00:00, 28.84it/s] 99%|█████████▉| 969/981 [00:38<00:00, 28.92it/s] 99%|█████████▉| 972/981 [00:38<00:00, 29.14it/s] 99%|█████████▉| 975/981 [00:38<00:00, 29.26it/s]100%|█████████▉| 978/981 [00:38<00:00, 29.19it/s]100%|██████████| 981/981 [00:38<00:00, 29.30it/s]100%|██████████| 981/981 [00:38<00:00, 25.36it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_RS_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.040, valid loss : 0.019, train acc : 0.744, valid acc : 0.613, train f1 : 0.728, valid f1 : 0.419
training process:   2%|▏         | 1/50 [03:59<3:15:45, 239.70s/it]training process:   4%|▍         | 2/50 [07:17<2:52:02, 215.05s/it]training process:   6%|▌         | 3/50 [10:32<2:41:12, 205.80s/it]training process:   8%|▊         | 4/50 [13:46<2:34:24, 201.41s/it]epoch : 5, train loss : 0.021, valid loss : 0.009, train acc : 0.929, valid acc : 0.924, train f1 : 0.929, valid f1 : 0.635
training process:  10%|█         | 5/50 [17:46<2:41:25, 215.23s/it]training process:  12%|█▏        | 6/50 [21:02<2:32:54, 208.51s/it]training process:  14%|█▍        | 7/50 [24:13<2:25:28, 202.99s/it]training process:  16%|█▌        | 8/50 [27:28<2:20:10, 200.26s/it]epoch : 9, train loss : 0.018, valid loss : 0.009, train acc : 0.934, valid acc : 0.918, train f1 : 0.934, valid f1 : 0.627
training process:  18%|█▊        | 9/50 [31:27<2:25:12, 212.51s/it]training process:  20%|██        | 10/50 [34:39<2:17:20, 206.00s/it]training process:  22%|██▏       | 11/50 [37:51<2:11:17, 201.98s/it]training process:  24%|██▍       | 12/50 [41:04<2:06:06, 199.11s/it]epoch : 13, train loss : 0.015, valid loss : 0.010, train acc : 0.944, valid acc : 0.909, train f1 : 0.943, valid f1 : 0.611
training process:  26%|██▌       | 13/50 [45:02<2:10:05, 210.96s/it]training process:  28%|██▊       | 14/50 [48:15<2:03:18, 205.52s/it]training process:  30%|███       | 15/50 [51:27<1:57:25, 201.30s/it]training process:  32%|███▏      | 16/50 [54:38<1:52:21, 198.29s/it]epoch : 17, train loss : 0.015, valid loss : 0.012, train acc : 0.949, valid acc : 0.928, train f1 : 0.948, valid f1 : 0.638
training process:  34%|███▍      | 17/50 [58:35<1:55:23, 209.80s/it]training process:  36%|███▌      | 18/50 [1:01:48<1:49:20, 205.01s/it]training process:  38%|███▊      | 19/50 [1:05:02<1:44:09, 201.59s/it]training process:  40%|████      | 20/50 [1:08:17<1:39:44, 199.47s/it]epoch : 21, train loss : 0.012, valid loss : 0.014, train acc : 0.955, valid acc : 0.935, train f1 : 0.955, valid f1 : 0.650
training process:  42%|████▏     | 21/50 [1:12:14<1:41:59, 211.02s/it]training process:  44%|████▍     | 22/50 [1:15:30<1:36:18, 206.36s/it]training process:  46%|████▌     | 23/50 [1:18:43<1:31:01, 202.29s/it]training process:  48%|████▊     | 24/50 [1:21:57<1:26:35, 199.83s/it]epoch : 25, train loss : 0.011, valid loss : 0.010, train acc : 0.955, valid acc : 0.930, train f1 : 0.955, valid f1 : 0.645
training process:  50%|█████     | 25/50 [1:25:54<1:27:52, 210.91s/it]training process:  52%|█████▏    | 26/50 [1:29:07<1:22:13, 205.58s/it]training process:  54%|█████▍    | 27/50 [1:32:20<1:17:26, 202.01s/it]training process:  56%|█████▌    | 28/50 [1:35:30<1:12:39, 198.16s/it]epoch : 29, train loss : 0.010, valid loss : 0.010, train acc : 0.961, valid acc : 0.957, train f1 : 0.961, valid f1 : 0.706
training process:  58%|█████▊    | 29/50 [1:39:32<1:13:58, 211.36s/it]training process:  60%|██████    | 30/50 [1:42:43<1:08:24, 205.24s/it]training process:  62%|██████▏   | 31/50 [1:45:56<1:03:48, 201.51s/it]training process:  64%|██████▍   | 32/50 [1:49:06<59:26, 198.15s/it]  epoch : 33, train loss : 0.010, valid loss : 0.014, train acc : 0.963, valid acc : 0.960, train f1 : 0.963, valid f1 : 0.713
training process:  66%|██████▌   | 33/50 [1:53:02<59:20, 209.47s/it]training process:  68%|██████▊   | 34/50 [1:56:17<54:45, 205.32s/it]training process:  70%|███████   | 35/50 [1:59:33<50:36, 202.43s/it]training process:  72%|███████▏  | 36/50 [2:02:46<46:34, 199.59s/it]epoch : 37, train loss : 0.007, valid loss : 0.017, train acc : 0.966, valid acc : 0.934, train f1 : 0.966, valid f1 : 0.648
training process:  74%|███████▍  | 37/50 [2:06:44<45:43, 211.01s/it]training process:  76%|███████▌  | 38/50 [2:09:59<41:15, 206.25s/it]training process:  78%|███████▊  | 39/50 [2:13:11<37:03, 202.12s/it]training process:  80%|████████  | 40/50 [2:16:24<33:13, 199.34s/it]epoch : 41, train loss : 0.006, valid loss : 0.013, train acc : 0.968, valid acc : 0.961, train f1 : 0.968, valid f1 : 0.716
training process:  82%|████████▏ | 41/50 [2:20:21<31:34, 210.56s/it]training process:  84%|████████▍ | 42/50 [2:23:35<27:25, 205.74s/it]training process:  86%|████████▌ | 43/50 [2:26:47<23:30, 201.55s/it]training process:  88%|████████▊ | 44/50 [2:29:59<19:51, 198.61s/it]epoch : 45, train loss : 0.008, valid loss : 0.009, train acc : 0.966, valid acc : 0.954, train f1 : 0.966, valid f1 : 0.700
training process:  90%|█████████ | 45/50 [2:33:59<17:35, 211.13s/it]training process:  92%|█████████▏| 46/50 [2:37:11<13:41, 205.45s/it]training process:  94%|█████████▍| 47/50 [2:40:25<10:05, 201.80s/it]training process:  96%|█████████▌| 48/50 [2:43:41<06:40, 200.02s/it]epoch : 49, train loss : 0.006, valid loss : 0.014, train acc : 0.972, valid acc : 0.975, train f1 : 0.972, valid f1 : 0.770
training process:  98%|█████████▊| 49/50 [2:47:43<03:32, 212.61s/it]training process: 100%|██████████| 50/50 [2:50:58<00:00, 207.49s/it]training process: 100%|██████████| 50/50 [2:50:58<00:00, 205.17s/it]
training process finished, best loss : 0.010 and best acc : 0.976, best f1 : 0.779, best epoch : 18

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.39      0.90      0.55        71
           1       1.00      0.97      0.99      3812

    accuracy                           0.97      3883
   macro avg       0.70      0.94      0.77      3883
weighted avg       0.99      0.97      0.98      3883


# test acc : 0.97, test f1 : 0.77, test AUC : 0.94, test loss : 0.127

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:51, 18.85it/s]  1%|          | 5/981 [00:00<00:44, 21.90it/s]  1%|          | 8/981 [00:00<00:42, 22.79it/s]  1%|          | 11/981 [00:00<00:41, 23.19it/s]  1%|▏         | 14/981 [00:00<00:40, 23.69it/s]  2%|▏         | 17/981 [00:00<00:40, 23.85it/s]  2%|▏         | 20/981 [00:00<00:39, 24.13it/s]  2%|▏         | 23/981 [00:00<00:39, 24.11it/s]  3%|▎         | 26/981 [00:01<00:40, 23.83it/s]  3%|▎         | 29/981 [00:01<00:40, 23.78it/s]  3%|▎         | 32/981 [00:01<00:39, 23.77it/s]  4%|▎         | 35/981 [00:01<00:39, 23.76it/s]  4%|▍         | 38/981 [00:01<00:39, 23.77it/s]  4%|▍         | 41/981 [00:01<00:39, 23.79it/s]  4%|▍         | 44/981 [00:01<00:39, 23.78it/s]  5%|▍         | 47/981 [00:01<00:39, 23.73it/s]  5%|▌         | 50/981 [00:02<00:39, 23.50it/s]  5%|▌         | 53/981 [00:02<00:38, 23.84it/s]  6%|▌         | 56/981 [00:02<00:38, 23.95it/s]  6%|▌         | 59/981 [00:02<00:38, 23.79it/s]  6%|▋         | 62/981 [00:02<00:38, 23.83it/s]  7%|▋         | 65/981 [00:02<00:38, 23.95it/s]  7%|▋         | 68/981 [00:02<00:38, 24.00it/s]  7%|▋         | 71/981 [00:02<00:37, 24.04it/s]  8%|▊         | 74/981 [00:03<00:37, 24.06it/s]  8%|▊         | 77/981 [00:03<00:37, 24.05it/s]  8%|▊         | 80/981 [00:03<00:37, 23.83it/s]  8%|▊         | 83/981 [00:03<00:37, 23.85it/s]  9%|▉         | 86/981 [00:03<00:37, 23.59it/s]  9%|▉         | 89/981 [00:03<00:38, 23.34it/s]  9%|▉         | 92/981 [00:03<00:38, 23.11it/s] 10%|▉         | 95/981 [00:04<00:38, 23.29it/s] 10%|▉         | 98/981 [00:04<00:37, 23.52it/s] 10%|█         | 101/981 [00:04<00:37, 23.37it/s] 11%|█         | 104/981 [00:04<00:37, 23.27it/s] 11%|█         | 107/981 [00:04<00:37, 23.25it/s] 11%|█         | 110/981 [00:04<00:37, 23.24it/s] 12%|█▏        | 113/981 [00:04<00:37, 23.23it/s] 12%|█▏        | 116/981 [00:04<00:37, 23.13it/s] 12%|█▏        | 119/981 [00:05<00:37, 22.98it/s] 12%|█▏        | 122/981 [00:05<00:37, 22.92it/s] 13%|█▎        | 125/981 [00:05<00:37, 22.89it/s] 13%|█▎        | 128/981 [00:05<00:37, 23.02it/s] 13%|█▎        | 131/981 [00:05<00:36, 23.43it/s] 14%|█▎        | 134/981 [00:05<00:36, 23.41it/s] 14%|█▍        | 137/981 [00:05<00:35, 23.67it/s] 14%|█▍        | 140/981 [00:05<00:35, 23.60it/s] 15%|█▍        | 143/981 [00:06<00:35, 23.93it/s] 15%|█▍        | 146/981 [00:06<00:34, 24.05it/s] 15%|█▌        | 149/981 [00:06<00:34, 23.98it/s] 15%|█▌        | 152/981 [00:06<00:34, 24.02it/s] 16%|█▌        | 155/981 [00:06<00:34, 24.04it/s] 16%|█▌        | 158/981 [00:06<00:34, 24.16it/s] 16%|█▋        | 161/981 [00:06<00:33, 24.16it/s] 17%|█▋        | 164/981 [00:06<00:33, 24.09it/s] 17%|█▋        | 167/981 [00:07<00:33, 24.14it/s] 17%|█▋        | 170/981 [00:07<00:33, 24.04it/s] 18%|█▊        | 173/981 [00:07<00:33, 24.00it/s] 18%|█▊        | 176/981 [00:07<00:33, 23.87it/s] 18%|█▊        | 179/981 [00:07<00:33, 23.88it/s] 19%|█▊        | 182/981 [00:07<00:33, 23.87it/s] 19%|█▉        | 185/981 [00:07<00:33, 23.83it/s] 19%|█▉        | 188/981 [00:07<00:33, 23.87it/s] 19%|█▉        | 191/981 [00:08<00:32, 24.06it/s] 20%|█▉        | 194/981 [00:08<00:32, 24.15it/s] 20%|██        | 197/981 [00:08<00:32, 24.06it/s] 20%|██        | 200/981 [00:08<00:32, 23.91it/s] 21%|██        | 203/981 [00:08<00:32, 23.79it/s] 21%|██        | 206/981 [00:08<00:32, 23.70it/s] 21%|██▏       | 209/981 [00:08<00:32, 23.58it/s] 22%|██▏       | 212/981 [00:08<00:32, 23.49it/s] 22%|██▏       | 215/981 [00:09<00:32, 23.40it/s] 22%|██▏       | 218/981 [00:09<00:32, 23.26it/s] 23%|██▎       | 221/981 [00:09<00:32, 23.08it/s] 23%|██▎       | 224/981 [00:09<00:32, 23.18it/s] 23%|██▎       | 227/981 [00:09<00:32, 23.34it/s] 23%|██▎       | 230/981 [00:09<00:32, 23.40it/s] 24%|██▍       | 233/981 [00:09<00:32, 23.10it/s] 24%|██▍       | 236/981 [00:09<00:32, 23.06it/s] 24%|██▍       | 239/981 [00:10<00:32, 22.79it/s] 25%|██▍       | 242/981 [00:10<00:32, 22.94it/s] 25%|██▍       | 245/981 [00:10<00:31, 23.05it/s] 25%|██▌       | 248/981 [00:10<00:31, 23.02it/s] 26%|██▌       | 251/981 [00:10<00:31, 23.34it/s] 26%|██▌       | 254/981 [00:10<00:31, 23.39it/s] 26%|██▌       | 257/981 [00:10<00:30, 23.40it/s] 27%|██▋       | 260/981 [00:11<00:30, 23.55it/s] 27%|██▋       | 263/981 [00:11<00:30, 23.73it/s] 27%|██▋       | 266/981 [00:11<00:30, 23.73it/s] 27%|██▋       | 269/981 [00:11<00:30, 23.13it/s] 28%|██▊       | 272/981 [00:11<00:31, 22.60it/s] 28%|██▊       | 275/981 [00:11<00:31, 22.47it/s] 28%|██▊       | 278/981 [00:11<00:30, 22.83it/s] 29%|██▊       | 281/981 [00:11<00:30, 23.21it/s] 29%|██▉       | 284/981 [00:12<00:29, 23.26it/s] 29%|██▉       | 287/981 [00:12<00:29, 23.57it/s] 30%|██▉       | 290/981 [00:12<00:29, 23.50it/s] 30%|██▉       | 293/981 [00:12<00:29, 23.58it/s] 30%|███       | 296/981 [00:12<00:28, 23.69it/s] 30%|███       | 299/981 [00:12<00:28, 23.77it/s] 31%|███       | 302/981 [00:12<00:28, 23.43it/s] 31%|███       | 305/981 [00:12<00:28, 23.38it/s] 31%|███▏      | 308/981 [00:13<00:28, 23.38it/s] 32%|███▏      | 311/981 [00:13<00:28, 23.34it/s] 32%|███▏      | 314/981 [00:13<00:28, 23.31it/s] 32%|███▏      | 317/981 [00:13<00:28, 23.28it/s] 33%|███▎      | 320/981 [00:13<00:28, 23.27it/s] 33%|███▎      | 323/981 [00:13<00:28, 23.28it/s] 33%|███▎      | 326/981 [00:13<00:28, 23.28it/s] 34%|███▎      | 329/981 [00:13<00:27, 23.31it/s] 34%|███▍      | 332/981 [00:14<00:27, 23.60it/s] 34%|███▍      | 335/981 [00:14<00:27, 23.74it/s] 34%|███▍      | 338/981 [00:14<00:27, 23.60it/s] 35%|███▍      | 341/981 [00:14<00:27, 23.53it/s] 35%|███▌      | 344/981 [00:14<00:27, 23.40it/s] 35%|███▌      | 347/981 [00:14<00:27, 23.40it/s] 36%|███▌      | 350/981 [00:14<00:27, 23.37it/s] 36%|███▌      | 353/981 [00:15<00:26, 23.35it/s] 36%|███▋      | 356/981 [00:15<00:26, 23.30it/s] 37%|███▋      | 359/981 [00:15<00:26, 23.29it/s] 37%|███▋      | 362/981 [00:15<00:26, 23.36it/s] 37%|███▋      | 365/981 [00:15<00:26, 23.57it/s] 38%|███▊      | 368/981 [00:15<00:25, 23.73it/s] 38%|███▊      | 371/981 [00:15<00:25, 23.76it/s] 38%|███▊      | 374/981 [00:15<00:25, 23.62it/s] 38%|███▊      | 377/981 [00:16<00:25, 23.53it/s] 39%|███▊      | 380/981 [00:16<00:25, 23.44it/s] 39%|███▉      | 383/981 [00:16<00:25, 23.38it/s] 39%|███▉      | 386/981 [00:16<00:25, 23.32it/s] 40%|███▉      | 389/981 [00:16<00:25, 23.26it/s] 40%|███▉      | 392/981 [00:16<00:25, 23.23it/s] 40%|████      | 395/981 [00:16<00:25, 23.18it/s] 41%|████      | 398/981 [00:16<00:25, 23.22it/s] 41%|████      | 401/981 [00:17<00:24, 23.47it/s] 41%|████      | 404/981 [00:17<00:24, 23.64it/s] 41%|████▏     | 407/981 [00:17<00:24, 23.62it/s] 42%|████▏     | 410/981 [00:17<00:24, 23.54it/s] 42%|████▏     | 413/981 [00:17<00:24, 23.31it/s] 42%|████▏     | 416/981 [00:17<00:24, 23.30it/s] 43%|████▎     | 419/981 [00:17<00:24, 23.35it/s] 43%|████▎     | 422/981 [00:17<00:23, 23.37it/s] 43%|████▎     | 425/981 [00:18<00:23, 23.38it/s] 44%|████▎     | 428/981 [00:18<00:23, 23.47it/s] 44%|████▍     | 431/981 [00:18<00:23, 23.36it/s] 44%|████▍     | 434/981 [00:18<00:23, 23.54it/s] 45%|████▍     | 437/981 [00:18<00:22, 23.70it/s] 45%|████▍     | 440/981 [00:18<00:22, 23.76it/s] 45%|████▌     | 443/981 [00:18<00:22, 23.71it/s] 45%|████▌     | 446/981 [00:18<00:22, 23.56it/s] 46%|████▌     | 449/981 [00:19<00:22, 23.49it/s] 46%|████▌     | 452/981 [00:19<00:22, 23.18it/s] 46%|████▋     | 455/981 [00:19<00:22, 23.34it/s] 47%|████▋     | 458/981 [00:19<00:22, 23.61it/s] 47%|████▋     | 461/981 [00:19<00:22, 23.47it/s] 47%|████▋     | 464/981 [00:19<00:21, 23.60it/s] 48%|████▊     | 467/981 [00:19<00:21, 23.59it/s] 48%|████▊     | 470/981 [00:19<00:21, 23.70it/s] 48%|████▊     | 473/981 [00:20<00:21, 23.69it/s] 49%|████▊     | 476/981 [00:20<00:21, 23.72it/s] 49%|████▉     | 479/981 [00:20<00:21, 23.63it/s] 49%|████▉     | 482/981 [00:20<00:21, 23.69it/s] 49%|████▉     | 485/981 [00:20<00:20, 23.73it/s] 50%|████▉     | 488/981 [00:20<00:20, 23.66it/s] 50%|█████     | 491/981 [00:20<00:20, 23.61it/s] 50%|█████     | 494/981 [00:21<00:20, 23.55it/s] 51%|█████     | 497/981 [00:21<00:20, 23.52it/s] 51%|█████     | 500/981 [00:21<00:20, 23.46it/s] 51%|█████▏    | 503/981 [00:21<00:20, 23.59it/s] 52%|█████▏    | 506/981 [00:21<00:19, 23.86it/s] 52%|█████▏    | 509/981 [00:21<00:19, 23.98it/s] 52%|█████▏    | 512/981 [00:21<00:19, 24.06it/s] 52%|█████▏    | 515/981 [00:21<00:19, 23.98it/s] 53%|█████▎    | 518/981 [00:22<00:19, 23.93it/s] 53%|█████▎    | 521/981 [00:22<00:19, 23.90it/s] 53%|█████▎    | 524/981 [00:22<00:19, 23.92it/s] 54%|█████▎    | 527/981 [00:22<00:18, 23.91it/s] 54%|█████▍    | 530/981 [00:22<00:18, 23.92it/s] 54%|█████▍    | 533/981 [00:22<00:18, 23.87it/s] 55%|█████▍    | 536/981 [00:22<00:18, 23.82it/s] 55%|█████▍    | 539/981 [00:22<00:18, 24.08it/s] 55%|█████▌    | 542/981 [00:23<00:18, 24.25it/s] 56%|█████▌    | 545/981 [00:23<00:17, 24.39it/s] 56%|█████▌    | 548/981 [00:23<00:17, 24.32it/s] 56%|█████▌    | 551/981 [00:23<00:17, 24.25it/s] 56%|█████▋    | 554/981 [00:23<00:17, 24.19it/s] 57%|█████▋    | 557/981 [00:23<00:17, 24.18it/s] 57%|█████▋    | 560/981 [00:23<00:17, 24.12it/s] 57%|█████▋    | 563/981 [00:23<00:17, 24.12it/s] 58%|█████▊    | 566/981 [00:24<00:17, 24.09it/s] 58%|█████▊    | 569/981 [00:24<00:17, 24.00it/s] 58%|█████▊    | 572/981 [00:24<00:17, 23.99it/s] 59%|█████▊    | 575/981 [00:24<00:16, 24.32it/s] 59%|█████▉    | 578/981 [00:24<00:16, 24.28it/s] 59%|█████▉    | 581/981 [00:24<00:16, 24.46it/s] 60%|█████▉    | 584/981 [00:24<00:16, 24.35it/s] 60%|█████▉    | 587/981 [00:24<00:16, 24.24it/s] 60%|██████    | 590/981 [00:24<00:16, 24.18it/s] 60%|██████    | 593/981 [00:25<00:16, 24.17it/s] 61%|██████    | 596/981 [00:25<00:15, 24.14it/s] 61%|██████    | 599/981 [00:25<00:15, 24.16it/s] 61%|██████▏   | 602/981 [00:25<00:15, 24.14it/s] 62%|██████▏   | 605/981 [00:25<00:15, 24.04it/s] 62%|██████▏   | 608/981 [00:25<00:15, 24.00it/s] 62%|██████▏   | 611/981 [00:25<00:15, 24.25it/s] 63%|██████▎   | 614/981 [00:25<00:14, 24.47it/s] 63%|██████▎   | 617/981 [00:26<00:14, 24.46it/s] 63%|██████▎   | 620/981 [00:26<00:14, 24.36it/s] 64%|██████▎   | 623/981 [00:26<00:14, 24.29it/s] 64%|██████▍   | 626/981 [00:26<00:14, 24.21it/s] 64%|██████▍   | 629/981 [00:26<00:14, 24.18it/s] 64%|██████▍   | 632/981 [00:26<00:14, 24.14it/s] 65%|██████▍   | 635/981 [00:26<00:14, 24.12it/s] 65%|██████▌   | 638/981 [00:26<00:14, 24.11it/s] 65%|██████▌   | 641/981 [00:27<00:14, 24.02it/s] 66%|██████▌   | 644/981 [00:27<00:13, 24.09it/s] 66%|██████▌   | 647/981 [00:27<00:13, 24.27it/s] 66%|██████▋   | 650/981 [00:27<00:13, 24.50it/s] 67%|██████▋   | 653/981 [00:27<00:13, 24.62it/s] 67%|██████▋   | 656/981 [00:27<00:13, 24.51it/s] 67%|██████▋   | 659/981 [00:27<00:13, 24.44it/s] 67%|██████▋   | 662/981 [00:27<00:13, 24.35it/s] 68%|██████▊   | 665/981 [00:28<00:12, 24.32it/s] 68%|██████▊   | 668/981 [00:28<00:12, 24.26it/s] 68%|██████▊   | 671/981 [00:28<00:12, 24.27it/s] 69%|██████▊   | 674/981 [00:28<00:12, 24.20it/s] 69%|██████▉   | 677/981 [00:28<00:12, 24.05it/s] 69%|██████▉   | 680/981 [00:28<00:12, 24.11it/s] 70%|██████▉   | 683/981 [00:28<00:12, 24.40it/s] 70%|██████▉   | 686/981 [00:28<00:12, 24.53it/s] 70%|███████   | 689/981 [00:29<00:11, 24.38it/s] 71%|███████   | 692/981 [00:29<00:11, 24.22it/s] 71%|███████   | 695/981 [00:29<00:11, 24.20it/s] 71%|███████   | 698/981 [00:29<00:11, 24.20it/s] 71%|███████▏  | 701/981 [00:29<00:11, 24.20it/s] 72%|███████▏  | 704/981 [00:29<00:11, 24.20it/s] 72%|███████▏  | 707/981 [00:29<00:11, 24.21it/s] 72%|███████▏  | 710/981 [00:29<00:11, 24.15it/s] 73%|███████▎  | 713/981 [00:30<00:11, 23.97it/s] 73%|███████▎  | 716/981 [00:30<00:10, 24.15it/s] 73%|███████▎  | 719/981 [00:30<00:10, 24.37it/s] 74%|███████▎  | 722/981 [00:30<00:10, 24.55it/s] 74%|███████▍  | 725/981 [00:30<00:10, 24.32it/s] 74%|███████▍  | 728/981 [00:30<00:10, 24.21it/s] 75%|███████▍  | 731/981 [00:30<00:10, 24.17it/s] 75%|███████▍  | 734/981 [00:30<00:10, 24.11it/s] 75%|███████▌  | 737/981 [00:31<00:10, 24.12it/s] 75%|███████▌  | 740/981 [00:31<00:10, 24.00it/s] 76%|███████▌  | 743/981 [00:31<00:09, 23.98it/s] 76%|███████▌  | 746/981 [00:31<00:09, 23.92it/s] 76%|███████▋  | 749/981 [00:31<00:09, 23.80it/s] 77%|███████▋  | 752/981 [00:31<00:09, 23.90it/s] 77%|███████▋  | 755/981 [00:31<00:09, 24.23it/s] 77%|███████▋  | 758/981 [00:31<00:09, 24.37it/s] 78%|███████▊  | 761/981 [00:32<00:09, 24.33it/s] 78%|███████▊  | 764/981 [00:32<00:08, 24.20it/s] 78%|███████▊  | 767/981 [00:32<00:08, 24.09it/s] 78%|███████▊  | 770/981 [00:32<00:08, 24.00it/s] 79%|███████▉  | 773/981 [00:32<00:08, 23.98it/s] 79%|███████▉  | 776/981 [00:32<00:08, 23.94it/s] 79%|███████▉  | 779/981 [00:32<00:08, 23.98it/s] 80%|███████▉  | 782/981 [00:32<00:08, 24.12it/s] 80%|████████  | 785/981 [00:33<00:08, 24.32it/s] 80%|████████  | 788/981 [00:33<00:07, 24.90it/s] 81%|████████  | 791/981 [00:33<00:07, 25.54it/s] 81%|████████  | 794/981 [00:33<00:07, 25.96it/s] 81%|████████  | 797/981 [00:33<00:06, 26.34it/s] 82%|████████▏ | 800/981 [00:33<00:06, 26.59it/s] 82%|████████▏ | 803/981 [00:33<00:06, 26.76it/s] 82%|████████▏ | 806/981 [00:33<00:06, 26.87it/s] 82%|████████▏ | 809/981 [00:33<00:06, 26.97it/s] 83%|████████▎ | 812/981 [00:34<00:06, 27.03it/s] 83%|████████▎ | 815/981 [00:34<00:06, 26.90it/s] 83%|████████▎ | 818/981 [00:34<00:06, 26.98it/s] 84%|████████▎ | 821/981 [00:34<00:05, 27.02it/s] 84%|████████▍ | 824/981 [00:34<00:05, 27.05it/s] 84%|████████▍ | 827/981 [00:34<00:05, 27.29it/s] 85%|████████▍ | 830/981 [00:34<00:05, 27.66it/s] 85%|████████▍ | 833/981 [00:34<00:05, 27.92it/s] 85%|████████▌ | 836/981 [00:34<00:05, 27.94it/s] 86%|████████▌ | 839/981 [00:35<00:05, 27.79it/s] 86%|████████▌ | 842/981 [00:35<00:05, 27.71it/s] 86%|████████▌ | 845/981 [00:35<00:04, 27.64it/s] 86%|████████▋ | 848/981 [00:35<00:04, 27.61it/s] 87%|████████▋ | 851/981 [00:35<00:04, 27.60it/s] 87%|████████▋ | 854/981 [00:35<00:04, 27.57it/s] 87%|████████▋ | 857/981 [00:35<00:04, 27.53it/s] 88%|████████▊ | 860/981 [00:35<00:04, 27.45it/s] 88%|████████▊ | 863/981 [00:35<00:04, 27.40it/s] 88%|████████▊ | 866/981 [00:36<00:04, 27.46it/s] 89%|████████▊ | 869/981 [00:36<00:04, 27.76it/s] 89%|████████▉ | 872/981 [00:36<00:03, 27.93it/s] 89%|████████▉ | 875/981 [00:36<00:03, 28.06it/s] 90%|████████▉ | 878/981 [00:36<00:03, 27.90it/s] 90%|████████▉ | 881/981 [00:36<00:03, 27.80it/s] 90%|█████████ | 884/981 [00:36<00:03, 27.70it/s] 90%|█████████ | 887/981 [00:36<00:03, 27.68it/s] 91%|█████████ | 890/981 [00:36<00:03, 27.67it/s] 91%|█████████ | 893/981 [00:36<00:03, 27.63it/s] 91%|█████████▏| 896/981 [00:37<00:03, 27.60it/s] 92%|█████████▏| 899/981 [00:37<00:02, 27.59it/s] 92%|█████████▏| 902/981 [00:37<00:02, 27.50it/s] 92%|█████████▏| 905/981 [00:37<00:02, 27.48it/s] 93%|█████████▎| 908/981 [00:37<00:02, 27.91it/s] 93%|█████████▎| 911/981 [00:37<00:02, 28.20it/s] 93%|█████████▎| 914/981 [00:37<00:02, 28.42it/s] 93%|█████████▎| 917/981 [00:37<00:02, 28.22it/s] 94%|█████████▍| 920/981 [00:37<00:02, 28.04it/s] 94%|█████████▍| 923/981 [00:38<00:02, 27.91it/s] 94%|█████████▍| 926/981 [00:38<00:01, 27.81it/s] 95%|█████████▍| 929/981 [00:38<00:01, 27.72it/s] 95%|█████████▌| 932/981 [00:38<00:01, 27.67it/s] 95%|█████████▌| 935/981 [00:38<00:01, 27.65it/s] 96%|█████████▌| 938/981 [00:38<00:01, 27.62it/s] 96%|█████████▌| 941/981 [00:38<00:01, 27.60it/s] 96%|█████████▌| 944/981 [00:38<00:01, 27.50it/s] 97%|█████████▋| 947/981 [00:38<00:01, 27.77it/s] 97%|█████████▋| 950/981 [00:39<00:01, 28.10it/s] 97%|█████████▋| 953/981 [00:39<00:00, 28.34it/s] 97%|█████████▋| 956/981 [00:39<00:00, 28.36it/s] 98%|█████████▊| 959/981 [00:39<00:00, 27.98it/s] 98%|█████████▊| 962/981 [00:39<00:00, 27.82it/s] 98%|█████████▊| 965/981 [00:39<00:00, 27.73it/s] 99%|█████████▊| 968/981 [00:39<00:00, 27.68it/s] 99%|█████████▉| 971/981 [00:39<00:00, 27.64it/s] 99%|█████████▉| 974/981 [00:39<00:00, 27.60it/s]100%|█████████▉| 977/981 [00:39<00:00, 27.60it/s]100%|█████████▉| 980/981 [00:40<00:00, 27.57it/s]100%|██████████| 981/981 [00:40<00:00, 24.44it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_DRW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]training process - Deferred Re-weighting:   2%|▏         | 1/50 [03:17<2:41:03, 197.22s/it]epoch : 1, train loss : 0.105, valid loss : 0.113, train f1 : 0.496, valid f1 : 0.495
training process - Deferred Re-weighting:   4%|▍         | 2/50 [06:36<2:38:32, 198.19s/it]training process - Deferred Re-weighting:   6%|▌         | 3/50 [09:50<2:34:01, 196.62s/it]training process - Deferred Re-weighting:   8%|▊         | 4/50 [13:08<2:31:07, 197.13s/it]training process - Deferred Re-weighting:  10%|█         | 5/50 [16:26<2:27:53, 197.20s/it]epoch : 5, train loss : 0.094, valid loss : 0.111, train f1 : 0.640, valid f1 : 0.747
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [19:41<2:24:17, 196.75s/it]training process - Deferred Re-weighting:  14%|█▍        | 7/50 [22:59<2:21:08, 196.94s/it]training process - Deferred Re-weighting:  16%|█▌        | 8/50 [26:16<2:17:55, 197.04s/it]training process - Deferred Re-weighting:  18%|█▊        | 9/50 [29:32<2:14:24, 196.71s/it]epoch : 9, train loss : 0.069, valid loss : 0.076, train f1 : 0.792, valid f1 : 0.785
training process - Deferred Re-weighting:  20%|██        | 10/50 [32:47<2:10:49, 196.23s/it]training process - Deferred Re-weighting:  22%|██▏       | 11/50 [36:01<2:07:03, 195.47s/it]training process - Deferred Re-weighting:  24%|██▍       | 12/50 [39:19<2:04:18, 196.27s/it]training process - Deferred Re-weighting:  26%|██▌       | 13/50 [42:35<2:00:54, 196.06s/it]epoch : 13, train loss : 0.069, valid loss : 0.072, train f1 : 0.788, valid f1 : 0.812
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [45:50<1:57:33, 195.94s/it]training process - Deferred Re-weighting:  30%|███       | 15/50 [49:06<1:54:18, 195.95s/it]training process - Deferred Re-weighting:  32%|███▏      | 16/50 [52:32<1:52:38, 198.79s/it]training process - Deferred Re-weighting:  34%|███▍      | 17/50 [55:53<1:49:46, 199.59s/it]epoch : 17, train loss : 0.069, valid loss : 0.070, train f1 : 0.785, valid f1 : 0.794
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [59:14<1:46:35, 199.87s/it]training process - Deferred Re-weighting:  38%|███▊      | 19/50 [1:02:43<1:44:46, 202.78s/it]training process - Deferred Re-weighting:  40%|████      | 20/50 [1:06:11<1:42:05, 204.18s/it]training process - Deferred Re-weighting:  42%|████▏     | 21/50 [1:09:33<1:38:29, 203.78s/it]epoch : 21, train loss : 0.071, valid loss : 0.073, train f1 : 0.783, valid f1 : 0.801
training process - Deferred Re-weighting:  44%|████▍     | 22/50 [1:12:57<1:35:04, 203.74s/it]training process - Deferred Re-weighting:  46%|████▌     | 23/50 [1:16:24<1:32:03, 204.59s/it]training process - Deferred Re-weighting:  48%|████▊     | 24/50 [1:19:42<1:27:53, 202.84s/it]training process - Deferred Re-weighting:  50%|█████     | 25/50 [1:23:04<1:24:20, 202.41s/it]epoch : 25, train loss : 0.067, valid loss : 0.080, train f1 : 0.805, valid f1 : 0.786
training process - Deferred Re-weighting:  52%|█████▏    | 26/50 [1:26:19<1:20:04, 200.20s/it]training process - Deferred Re-weighting:  54%|█████▍    | 27/50 [1:29:40<1:16:52, 200.53s/it]training process - Deferred Re-weighting:  56%|█████▌    | 28/50 [1:33:11<1:14:37, 203.54s/it]training process - Deferred Re-weighting:  58%|█████▊    | 29/50 [1:36:31<1:10:54, 202.59s/it]epoch : 29, train loss : 0.066, valid loss : 0.070, train f1 : 0.803, valid f1 : 0.803
training process - Deferred Re-weighting:  60%|██████    | 30/50 [1:39:49<1:07:02, 201.14s/it]training process - Deferred Re-weighting:  62%|██████▏   | 31/50 [1:43:02<1:02:54, 198.68s/it]training process - Deferred Re-weighting:  64%|██████▍   | 32/50 [1:46:17<59:16, 197.56s/it]  training process - Deferred Re-weighting:  66%|██████▌   | 33/50 [1:49:31<55:43, 196.67s/it]epoch : 33, train loss : 0.065, valid loss : 0.070, train f1 : 0.800, valid f1 : 0.812
training process - Deferred Re-weighting:  68%|██████▊   | 34/50 [1:52:49<52:33, 197.08s/it]training process - Deferred Re-weighting:  70%|███████   | 35/50 [1:56:06<49:12, 196.80s/it]training process - Deferred Re-weighting:  72%|███████▏  | 36/50 [1:59:25<46:05, 197.53s/it]training process - Deferred Re-weighting:  74%|███████▍  | 37/50 [2:02:50<43:19, 199.97s/it]epoch : 37, train loss : 0.064, valid loss : 0.064, train f1 : 0.813, valid f1 : 0.835
training process - Deferred Re-weighting:  76%|███████▌  | 38/50 [2:06:10<39:59, 199.93s/it]training process - Deferred Re-weighting:  78%|███████▊  | 39/50 [2:09:36<36:58, 201.66s/it]training process - Deferred Re-weighting:  80%|████████  | 40/50 [2:13:03<33:54, 203.42s/it]training process - Deferred Re-weighting:  82%|████████▏ | 41/50 [2:16:25<30:25, 202.84s/it]epoch : 41, train loss : 0.051, valid loss : 0.041, train f1 : 0.847, valid f1 : 0.892
training process - Deferred Re-weighting:  84%|████████▍ | 42/50 [2:19:54<27:18, 204.84s/it]training process - Deferred Re-weighting:  86%|████████▌ | 43/50 [2:23:30<24:16, 208.11s/it]training process - Deferred Re-weighting:  88%|████████▊ | 44/50 [2:27:03<20:56, 209.40s/it]training process - Deferred Re-weighting:  90%|█████████ | 45/50 [2:30:34<17:29, 209.99s/it]epoch : 45, train loss : 0.038, valid loss : 0.033, train f1 : 0.891, valid f1 : 0.932
training process - Deferred Re-weighting:  92%|█████████▏| 46/50 [2:33:52<13:46, 206.51s/it]training process - Deferred Re-weighting:  94%|█████████▍| 47/50 [2:37:08<10:09, 203.18s/it]training process - Deferred Re-weighting:  96%|█████████▌| 48/50 [2:40:26<06:43, 201.69s/it]training process - Deferred Re-weighting:  98%|█████████▊| 49/50 [2:44:03<03:26, 206.22s/it]epoch : 49, train loss : 0.034, valid loss : 0.046, train f1 : 0.907, valid f1 : 0.901
training process - Deferred Re-weighting: 100%|██████████| 50/50 [2:48:02<00:00, 216.14s/it]training process - Deferred Re-weighting: 100%|██████████| 50/50 [2:48:02<00:00, 201.65s/it]
training process finished, best loss : 0.033, best acc : 0.996, best f1 : 0.932, best epoch : 44

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.72      0.80      0.76        71
           1       1.00      0.99      1.00      3812

    accuracy                           0.99      3883
   macro avg       0.86      0.90      0.88      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.88, test AUC : 0.90, test loss : 0.954

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:48, 20.33it/s]  1%|          | 6/981 [00:00<00:48, 20.16it/s]  1%|          | 9/981 [00:00<00:45, 21.24it/s]  1%|          | 12/981 [00:00<00:50, 19.38it/s]  1%|▏         | 14/981 [00:00<00:50, 19.28it/s]  2%|▏         | 17/981 [00:00<00:47, 20.34it/s]  2%|▏         | 20/981 [00:00<00:45, 21.00it/s]  2%|▏         | 23/981 [00:01<00:45, 21.27it/s]  3%|▎         | 26/981 [00:01<00:44, 21.61it/s]  3%|▎         | 29/981 [00:01<00:43, 21.86it/s]  3%|▎         | 32/981 [00:01<00:43, 22.07it/s]  4%|▎         | 35/981 [00:01<00:42, 22.19it/s]  4%|▍         | 38/981 [00:01<00:42, 22.25it/s]  4%|▍         | 41/981 [00:01<00:44, 21.26it/s]  4%|▍         | 44/981 [00:02<00:45, 20.81it/s]  5%|▍         | 47/981 [00:02<00:44, 21.20it/s]  5%|▌         | 50/981 [00:02<00:43, 21.53it/s]  5%|▌         | 53/981 [00:02<00:42, 21.79it/s]  6%|▌         | 56/981 [00:02<00:41, 22.10it/s]  6%|▌         | 59/981 [00:02<00:45, 20.13it/s]  6%|▋         | 62/981 [00:02<00:44, 20.75it/s]  7%|▋         | 65/981 [00:03<00:43, 21.21it/s]  7%|▋         | 68/981 [00:03<00:43, 20.92it/s]  7%|▋         | 71/981 [00:03<00:43, 20.88it/s]  8%|▊         | 74/981 [00:03<00:43, 20.88it/s]  8%|▊         | 77/981 [00:03<00:43, 20.94it/s]  8%|▊         | 80/981 [00:03<00:42, 21.14it/s]  8%|▊         | 83/981 [00:03<00:41, 21.49it/s]  9%|▉         | 86/981 [00:04<00:41, 21.73it/s]  9%|▉         | 89/981 [00:04<00:40, 21.89it/s]  9%|▉         | 92/981 [00:04<00:40, 21.95it/s] 10%|▉         | 95/981 [00:04<00:40, 21.77it/s] 10%|▉         | 98/981 [00:04<00:40, 21.86it/s] 10%|█         | 101/981 [00:04<00:39, 22.11it/s] 11%|█         | 104/981 [00:04<00:40, 21.54it/s] 11%|█         | 107/981 [00:05<00:40, 21.64it/s] 11%|█         | 110/981 [00:05<00:41, 20.88it/s] 12%|█▏        | 113/981 [00:05<00:40, 21.23it/s] 12%|█▏        | 116/981 [00:05<00:40, 21.49it/s] 12%|█▏        | 119/981 [00:05<00:41, 20.94it/s] 12%|█▏        | 122/981 [00:05<00:40, 21.19it/s] 13%|█▎        | 125/981 [00:05<00:39, 21.52it/s] 13%|█▎        | 128/981 [00:06<00:39, 21.74it/s] 13%|█▎        | 131/981 [00:06<00:39, 21.59it/s] 14%|█▎        | 134/981 [00:06<00:43, 19.62it/s] 14%|█▍        | 137/981 [00:06<00:41, 20.34it/s] 14%|█▍        | 140/981 [00:06<00:40, 20.82it/s] 15%|█▍        | 143/981 [00:06<00:42, 19.87it/s] 15%|█▍        | 146/981 [00:06<00:40, 20.57it/s] 15%|█▌        | 149/981 [00:07<00:39, 21.04it/s] 15%|█▌        | 152/981 [00:07<00:45, 18.17it/s] 16%|█▌        | 154/981 [00:07<00:45, 18.23it/s] 16%|█▌        | 157/981 [00:07<00:43, 18.73it/s] 16%|█▋        | 160/981 [00:07<00:41, 19.72it/s] 17%|█▋        | 163/981 [00:07<00:40, 20.43it/s] 17%|█▋        | 166/981 [00:07<00:39, 20.79it/s] 17%|█▋        | 169/981 [00:08<00:38, 21.32it/s] 18%|█▊        | 172/981 [00:08<00:37, 21.60it/s] 18%|█▊        | 175/981 [00:08<00:37, 21.71it/s] 18%|█▊        | 178/981 [00:08<00:36, 21.80it/s] 18%|█▊        | 181/981 [00:08<00:36, 21.89it/s] 19%|█▉        | 184/981 [00:08<00:36, 22.00it/s] 19%|█▉        | 187/981 [00:08<00:35, 22.09it/s] 19%|█▉        | 190/981 [00:09<00:35, 22.04it/s] 20%|█▉        | 193/981 [00:09<00:35, 22.12it/s] 20%|█▉        | 196/981 [00:09<00:35, 22.17it/s] 20%|██        | 199/981 [00:09<00:35, 22.14it/s] 21%|██        | 202/981 [00:09<00:35, 22.08it/s] 21%|██        | 205/981 [00:09<00:35, 21.86it/s] 21%|██        | 208/981 [00:09<00:35, 21.86it/s] 22%|██▏       | 211/981 [00:09<00:35, 21.67it/s] 22%|██▏       | 214/981 [00:10<00:35, 21.51it/s] 22%|██▏       | 217/981 [00:10<00:35, 21.54it/s] 22%|██▏       | 220/981 [00:10<00:35, 21.59it/s] 23%|██▎       | 223/981 [00:10<00:35, 21.56it/s] 23%|██▎       | 226/981 [00:10<00:35, 21.25it/s] 23%|██▎       | 229/981 [00:10<00:35, 21.08it/s] 24%|██▎       | 232/981 [00:10<00:35, 20.85it/s] 24%|██▍       | 235/981 [00:11<00:39, 18.88it/s] 24%|██▍       | 237/981 [00:11<00:39, 18.96it/s] 24%|██▍       | 240/981 [00:11<00:40, 18.40it/s] 25%|██▍       | 242/981 [00:11<00:42, 17.19it/s] 25%|██▍       | 244/981 [00:11<00:42, 17.51it/s] 25%|██▌       | 247/981 [00:11<00:38, 18.82it/s] 25%|██▌       | 250/981 [00:11<00:37, 19.75it/s] 26%|██▌       | 252/981 [00:12<00:37, 19.47it/s] 26%|██▌       | 254/981 [00:12<00:41, 17.39it/s] 26%|██▌       | 257/981 [00:12<00:38, 18.83it/s] 26%|██▋       | 259/981 [00:12<00:38, 18.77it/s] 27%|██▋       | 262/981 [00:12<00:36, 19.75it/s] 27%|██▋       | 265/981 [00:12<00:35, 20.39it/s] 27%|██▋       | 268/981 [00:12<00:39, 18.25it/s] 28%|██▊       | 271/981 [00:13<00:36, 19.22it/s] 28%|██▊       | 274/981 [00:13<00:36, 19.57it/s] 28%|██▊       | 277/981 [00:13<00:35, 20.06it/s] 29%|██▊       | 280/981 [00:13<00:34, 20.24it/s] 29%|██▉       | 283/981 [00:13<00:33, 20.63it/s] 29%|██▉       | 286/981 [00:13<00:33, 20.93it/s] 29%|██▉       | 289/981 [00:13<00:32, 21.18it/s] 30%|██▉       | 292/981 [00:14<00:32, 21.12it/s] 30%|███       | 295/981 [00:14<00:32, 21.30it/s] 30%|███       | 298/981 [00:14<00:31, 21.44it/s] 31%|███       | 301/981 [00:14<00:31, 21.53it/s] 31%|███       | 304/981 [00:14<00:31, 21.53it/s] 31%|███▏      | 307/981 [00:14<00:31, 21.54it/s] 32%|███▏      | 310/981 [00:14<00:31, 21.17it/s] 32%|███▏      | 313/981 [00:15<00:31, 21.23it/s] 32%|███▏      | 316/981 [00:15<00:31, 20.97it/s] 33%|███▎      | 319/981 [00:15<00:31, 21.20it/s] 33%|███▎      | 322/981 [00:15<00:30, 21.39it/s] 33%|███▎      | 325/981 [00:15<00:30, 21.48it/s] 33%|███▎      | 328/981 [00:15<00:30, 21.50it/s] 34%|███▎      | 331/981 [00:15<00:30, 21.52it/s] 34%|███▍      | 334/981 [00:16<00:30, 21.50it/s] 34%|███▍      | 337/981 [00:16<00:29, 21.47it/s] 35%|███▍      | 340/981 [00:16<00:29, 21.58it/s] 35%|███▍      | 343/981 [00:16<00:29, 21.60it/s] 35%|███▌      | 346/981 [00:16<00:29, 21.75it/s] 36%|███▌      | 349/981 [00:16<00:30, 20.85it/s] 36%|███▌      | 352/981 [00:16<00:29, 21.08it/s] 36%|███▌      | 355/981 [00:17<00:31, 19.69it/s] 36%|███▋      | 358/981 [00:17<00:30, 20.32it/s] 37%|███▋      | 361/981 [00:17<00:29, 20.78it/s] 37%|███▋      | 364/981 [00:17<00:29, 21.08it/s] 37%|███▋      | 367/981 [00:17<00:28, 21.39it/s] 38%|███▊      | 370/981 [00:17<00:28, 21.23it/s] 38%|███▊      | 373/981 [00:17<00:28, 21.40it/s] 38%|███▊      | 376/981 [00:18<00:30, 20.10it/s] 39%|███▊      | 379/981 [00:18<00:29, 20.58it/s] 39%|███▉      | 382/981 [00:18<00:28, 20.94it/s] 39%|███▉      | 385/981 [00:18<00:30, 19.53it/s] 40%|███▉      | 388/981 [00:18<00:29, 20.17it/s] 40%|███▉      | 391/981 [00:18<00:28, 20.76it/s] 40%|████      | 394/981 [00:18<00:27, 21.06it/s] 40%|████      | 397/981 [00:19<00:27, 21.26it/s] 41%|████      | 400/981 [00:19<00:27, 21.42it/s] 41%|████      | 403/981 [00:19<00:29, 19.87it/s] 41%|████▏     | 406/981 [00:19<00:28, 20.40it/s] 42%|████▏     | 409/981 [00:19<00:28, 20.29it/s] 42%|████▏     | 412/981 [00:19<00:27, 20.81it/s] 42%|████▏     | 415/981 [00:19<00:26, 21.11it/s] 43%|████▎     | 418/981 [00:20<00:28, 19.74it/s] 43%|████▎     | 421/981 [00:20<00:27, 20.34it/s] 43%|████▎     | 424/981 [00:20<00:26, 20.79it/s] 44%|████▎     | 427/981 [00:20<00:26, 20.99it/s] 44%|████▍     | 430/981 [00:20<00:26, 21.18it/s] 44%|████▍     | 433/981 [00:20<00:25, 21.33it/s] 44%|████▍     | 436/981 [00:20<00:25, 21.10it/s] 45%|████▍     | 439/981 [00:21<00:25, 21.36it/s] 45%|████▌     | 442/981 [00:21<00:25, 21.53it/s] 45%|████▌     | 445/981 [00:21<00:26, 20.24it/s] 46%|████▌     | 448/981 [00:21<00:25, 20.72it/s] 46%|████▌     | 451/981 [00:21<00:25, 21.04it/s] 46%|████▋     | 454/981 [00:21<00:25, 20.61it/s] 47%|████▋     | 457/981 [00:21<00:24, 21.11it/s] 47%|████▋     | 460/981 [00:22<00:24, 21.38it/s] 47%|████▋     | 463/981 [00:22<00:24, 21.58it/s] 48%|████▊     | 466/981 [00:22<00:23, 21.66it/s] 48%|████▊     | 469/981 [00:22<00:24, 20.96it/s] 48%|████▊     | 472/981 [00:22<00:23, 21.23it/s] 48%|████▊     | 475/981 [00:22<00:23, 21.45it/s] 49%|████▊     | 478/981 [00:22<00:23, 21.09it/s] 49%|████▉     | 481/981 [00:23<00:23, 21.41it/s] 49%|████▉     | 484/981 [00:23<00:23, 21.56it/s] 50%|████▉     | 487/981 [00:23<00:22, 21.49it/s] 50%|████▉     | 490/981 [00:23<00:22, 21.67it/s] 50%|█████     | 493/981 [00:23<00:22, 21.75it/s] 51%|█████     | 496/981 [00:23<00:22, 21.78it/s] 51%|█████     | 499/981 [00:23<00:22, 21.76it/s] 51%|█████     | 502/981 [00:24<00:22, 21.63it/s] 51%|█████▏    | 505/981 [00:24<00:21, 21.79it/s] 52%|█████▏    | 508/981 [00:24<00:21, 21.81it/s] 52%|█████▏    | 511/981 [00:24<00:22, 21.01it/s] 52%|█████▏    | 514/981 [00:24<00:21, 21.37it/s] 53%|█████▎    | 517/981 [00:24<00:21, 21.56it/s] 53%|█████▎    | 520/981 [00:24<00:21, 21.76it/s] 53%|█████▎    | 523/981 [00:24<00:20, 21.90it/s] 54%|█████▎    | 526/981 [00:25<00:20, 22.04it/s] 54%|█████▍    | 529/981 [00:25<00:21, 20.69it/s] 54%|█████▍    | 532/981 [00:25<00:21, 21.08it/s] 55%|█████▍    | 535/981 [00:25<00:21, 21.10it/s] 55%|█████▍    | 538/981 [00:25<00:20, 21.40it/s] 55%|█████▌    | 541/981 [00:25<00:20, 21.53it/s] 55%|█████▌    | 544/981 [00:25<00:20, 21.72it/s] 56%|█████▌    | 547/981 [00:26<00:19, 21.88it/s] 56%|█████▌    | 550/981 [00:26<00:19, 22.09it/s] 56%|█████▋    | 553/981 [00:26<00:19, 22.25it/s] 57%|█████▋    | 556/981 [00:26<00:19, 22.35it/s] 57%|█████▋    | 559/981 [00:26<00:18, 22.27it/s] 57%|█████▋    | 562/981 [00:26<00:19, 21.57it/s] 58%|█████▊    | 565/981 [00:26<00:19, 21.82it/s] 58%|█████▊    | 568/981 [00:27<00:18, 22.01it/s] 58%|█████▊    | 571/981 [00:27<00:20, 19.53it/s] 59%|█████▊    | 574/981 [00:27<00:19, 20.35it/s] 59%|█████▉    | 577/981 [00:27<00:19, 20.95it/s] 59%|█████▉    | 580/981 [00:27<00:18, 21.37it/s] 59%|█████▉    | 583/981 [00:27<00:18, 21.72it/s] 60%|█████▉    | 586/981 [00:27<00:18, 21.94it/s] 60%|██████    | 589/981 [00:28<00:17, 22.11it/s] 60%|██████    | 592/981 [00:28<00:17, 22.24it/s] 61%|██████    | 595/981 [00:28<00:18, 20.86it/s] 61%|██████    | 598/981 [00:28<00:17, 21.40it/s] 61%|██████▏   | 601/981 [00:28<00:17, 21.77it/s] 62%|██████▏   | 604/981 [00:28<00:17, 22.06it/s] 62%|██████▏   | 607/981 [00:28<00:16, 22.22it/s] 62%|██████▏   | 610/981 [00:29<00:16, 22.21it/s] 62%|██████▏   | 613/981 [00:29<00:16, 22.19it/s] 63%|██████▎   | 616/981 [00:29<00:16, 22.26it/s] 63%|██████▎   | 619/981 [00:29<00:16, 22.36it/s] 63%|██████▎   | 622/981 [00:29<00:16, 22.34it/s] 64%|██████▎   | 625/981 [00:29<00:15, 22.40it/s] 64%|██████▍   | 628/981 [00:29<00:15, 22.28it/s] 64%|██████▍   | 631/981 [00:29<00:15, 22.22it/s] 65%|██████▍   | 634/981 [00:30<00:15, 22.39it/s] 65%|██████▍   | 637/981 [00:30<00:15, 21.65it/s] 65%|██████▌   | 640/981 [00:30<00:15, 21.88it/s] 66%|██████▌   | 643/981 [00:30<00:15, 22.18it/s] 66%|██████▌   | 646/981 [00:30<00:15, 22.27it/s] 66%|██████▌   | 649/981 [00:30<00:14, 22.34it/s] 66%|██████▋   | 652/981 [00:30<00:15, 21.30it/s] 67%|██████▋   | 655/981 [00:31<00:15, 21.67it/s] 67%|██████▋   | 658/981 [00:31<00:14, 21.93it/s] 67%|██████▋   | 661/981 [00:31<00:14, 22.14it/s] 68%|██████▊   | 664/981 [00:31<00:14, 22.30it/s] 68%|██████▊   | 667/981 [00:31<00:13, 22.56it/s] 68%|██████▊   | 670/981 [00:31<00:13, 22.44it/s] 69%|██████▊   | 673/981 [00:31<00:13, 22.44it/s] 69%|██████▉   | 676/981 [00:31<00:13, 22.42it/s] 69%|██████▉   | 679/981 [00:32<00:17, 17.58it/s] 70%|██████▉   | 682/981 [00:32<00:16, 18.26it/s] 70%|██████▉   | 684/981 [00:32<00:16, 17.97it/s] 70%|██████▉   | 686/981 [00:32<00:16, 17.67it/s] 70%|███████   | 689/981 [00:32<00:16, 17.97it/s] 70%|███████   | 691/981 [00:32<00:15, 18.22it/s] 71%|███████   | 694/981 [00:33<00:14, 19.53it/s] 71%|███████   | 697/981 [00:33<00:13, 20.43it/s] 71%|███████▏  | 700/981 [00:33<00:13, 21.14it/s] 72%|███████▏  | 703/981 [00:33<00:13, 19.96it/s] 72%|███████▏  | 706/981 [00:33<00:13, 20.70it/s] 72%|███████▏  | 709/981 [00:33<00:12, 20.99it/s] 73%|███████▎  | 712/981 [00:33<00:14, 18.29it/s] 73%|███████▎  | 715/981 [00:34<00:14, 18.81it/s] 73%|███████▎  | 718/981 [00:34<00:13, 19.80it/s] 73%|███████▎  | 721/981 [00:34<00:15, 16.76it/s] 74%|███████▍  | 724/981 [00:34<00:14, 18.06it/s] 74%|███████▍  | 727/981 [00:34<00:13, 18.67it/s] 74%|███████▍  | 730/981 [00:34<00:12, 19.66it/s] 75%|███████▍  | 733/981 [00:35<00:12, 20.45it/s] 75%|███████▌  | 736/981 [00:35<00:11, 21.02it/s] 75%|███████▌  | 739/981 [00:35<00:11, 21.40it/s] 76%|███████▌  | 742/981 [00:35<00:11, 21.70it/s] 76%|███████▌  | 745/981 [00:35<00:10, 21.84it/s] 76%|███████▌  | 748/981 [00:35<00:10, 21.94it/s] 77%|███████▋  | 751/981 [00:35<00:10, 22.07it/s] 77%|███████▋  | 754/981 [00:35<00:10, 22.14it/s] 77%|███████▋  | 757/981 [00:36<00:12, 18.04it/s] 77%|███████▋  | 760/981 [00:36<00:11, 19.17it/s] 78%|███████▊  | 763/981 [00:36<00:10, 20.02it/s] 78%|███████▊  | 766/981 [00:36<00:10, 20.62it/s] 78%|███████▊  | 769/981 [00:36<00:10, 21.00it/s] 79%|███████▊  | 772/981 [00:36<00:09, 21.43it/s] 79%|███████▉  | 775/981 [00:37<00:09, 21.30it/s] 79%|███████▉  | 778/981 [00:37<00:09, 21.43it/s] 80%|███████▉  | 781/981 [00:37<00:09, 21.86it/s] 80%|███████▉  | 784/981 [00:37<00:08, 22.31it/s] 80%|████████  | 787/981 [00:37<00:08, 22.31it/s] 81%|████████  | 790/981 [00:37<00:08, 22.86it/s] 81%|████████  | 793/981 [00:37<00:08, 23.33it/s] 81%|████████  | 796/981 [00:37<00:07, 23.74it/s] 81%|████████▏ | 799/981 [00:38<00:07, 24.13it/s] 82%|████████▏ | 802/981 [00:38<00:07, 24.45it/s] 82%|████████▏ | 805/981 [00:38<00:07, 24.66it/s] 82%|████████▏ | 808/981 [00:38<00:06, 24.80it/s] 83%|████████▎ | 811/981 [00:38<00:08, 20.88it/s] 83%|████████▎ | 814/981 [00:38<00:07, 22.04it/s] 83%|████████▎ | 817/981 [00:38<00:07, 22.93it/s] 84%|████████▎ | 820/981 [00:38<00:06, 23.55it/s] 84%|████████▍ | 823/981 [00:39<00:06, 24.16it/s] 84%|████████▍ | 826/981 [00:39<00:06, 23.62it/s] 85%|████████▍ | 829/981 [00:39<00:06, 24.11it/s] 85%|████████▍ | 832/981 [00:39<00:06, 24.43it/s] 85%|████████▌ | 835/981 [00:39<00:05, 24.63it/s] 85%|████████▌ | 838/981 [00:39<00:06, 22.45it/s] 86%|████████▌ | 841/981 [00:39<00:06, 23.29it/s] 86%|████████▌ | 844/981 [00:39<00:05, 23.33it/s] 86%|████████▋ | 847/981 [00:40<00:05, 23.65it/s] 87%|████████▋ | 850/981 [00:40<00:05, 24.20it/s] 87%|████████▋ | 853/981 [00:40<00:05, 24.67it/s] 87%|████████▋ | 856/981 [00:40<00:05, 24.68it/s] 88%|████████▊ | 859/981 [00:40<00:04, 25.01it/s] 88%|████████▊ | 862/981 [00:40<00:04, 25.26it/s] 88%|████████▊ | 865/981 [00:40<00:04, 25.42it/s] 88%|████████▊ | 868/981 [00:40<00:04, 25.50it/s] 89%|████████▉ | 871/981 [00:41<00:04, 25.46it/s] 89%|████████▉ | 874/981 [00:41<00:04, 25.43it/s] 89%|████████▉ | 877/981 [00:41<00:04, 25.44it/s] 90%|████████▉ | 880/981 [00:41<00:04, 23.24it/s] 90%|█████████ | 883/981 [00:41<00:04, 23.91it/s] 90%|█████████ | 886/981 [00:41<00:04, 21.44it/s] 91%|█████████ | 889/981 [00:41<00:04, 19.12it/s] 91%|█████████ | 892/981 [00:42<00:04, 20.74it/s] 91%|█████████ | 895/981 [00:42<00:04, 20.13it/s] 92%|█████████▏| 898/981 [00:42<00:03, 21.53it/s] 92%|█████████▏| 901/981 [00:42<00:03, 22.66it/s] 92%|█████████▏| 904/981 [00:42<00:03, 23.49it/s] 92%|█████████▏| 907/981 [00:42<00:03, 24.10it/s] 93%|█████████▎| 910/981 [00:42<00:02, 24.60it/s] 93%|█████████▎| 913/981 [00:42<00:02, 25.00it/s] 93%|█████████▎| 916/981 [00:42<00:02, 25.21it/s] 94%|█████████▎| 919/981 [00:43<00:02, 25.36it/s] 94%|█████████▍| 922/981 [00:43<00:02, 23.49it/s] 94%|█████████▍| 925/981 [00:43<00:02, 24.12it/s] 95%|█████████▍| 928/981 [00:43<00:02, 24.56it/s] 95%|█████████▍| 931/981 [00:43<00:02, 22.40it/s] 95%|█████████▌| 934/981 [00:43<00:02, 23.33it/s] 96%|█████████▌| 937/981 [00:43<00:01, 23.95it/s] 96%|█████████▌| 940/981 [00:44<00:01, 24.29it/s] 96%|█████████▌| 943/981 [00:44<00:01, 24.61it/s] 96%|█████████▋| 946/981 [00:44<00:01, 24.85it/s] 97%|█████████▋| 949/981 [00:44<00:01, 25.20it/s] 97%|█████████▋| 952/981 [00:44<00:01, 25.23it/s] 97%|█████████▋| 955/981 [00:44<00:01, 25.28it/s] 98%|█████████▊| 958/981 [00:44<00:00, 25.34it/s] 98%|█████████▊| 961/981 [00:44<00:00, 25.31it/s] 98%|█████████▊| 964/981 [00:44<00:00, 25.29it/s] 99%|█████████▊| 967/981 [00:45<00:00, 24.11it/s] 99%|█████████▉| 970/981 [00:45<00:00, 22.15it/s] 99%|█████████▉| 973/981 [00:45<00:00, 20.37it/s] 99%|█████████▉| 976/981 [00:45<00:00, 21.77it/s]100%|█████████▉| 979/981 [00:45<00:00, 22.89it/s]100%|██████████| 981/981 [00:45<00:00, 21.45it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_RS_DRW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.301, valid loss : 0.047, train f1 : 0.855, valid f1 : 0.907
training process - Deferred Re-weighting:   2%|▏         | 1/50 [04:56<4:02:20, 296.74s/it]Best score increase :0.000 -> 0.907
training process - Deferred Re-weighting:   4%|▍         | 2/50 [10:51<4:24:37, 330.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▌         | 3/50 [15:08<3:52:41, 297.05s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   8%|▊         | 4/50 [19:07<3:30:23, 274.41s/it]EarlyStopping counter : 3 out of 12
epoch : 5, train loss : 0.146, valid loss : 0.068, train f1 : 0.937, valid f1 : 0.900
training process - Deferred Re-weighting:  10%|█         | 5/50 [24:08<3:32:56, 283.92s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [28:27<3:21:55, 275.36s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 7/50 [32:51<3:14:41, 271.65s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 8/50 [36:53<3:03:33, 262.23s/it]EarlyStopping counter : 7 out of 12
epoch : 9, train loss : 0.126, valid loss : 0.235, train f1 : 0.950, valid f1 : 0.679
training process - Deferred Re-weighting:  18%|█▊        | 9/50 [41:04<2:56:47, 258.73s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  20%|██        | 10/50 [44:18<2:39:14, 238.85s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 11/50 [47:32<2:26:20, 225.14s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 12/50 [50:47<2:16:38, 215.74s/it]EarlyStopping counter : 11 out of 12
epoch : 13, train loss : 0.123, valid loss : 0.099, train f1 : 0.953, valid f1 : 0.812
training process - Deferred Re-weighting:  24%|██▍       | 12/50 [54:48<2:53:34, 274.05s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 12, best f1 score : 0.907
training process finished, best loss : 0.047, best acc : 0.993, best f1 : 0.907, best epoch : 0

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.82      0.65        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.98      3883
   macro avg       0.77      0.90      0.82      3883
weighted avg       0.99      0.98      0.99      3883


# test acc : 0.98, test f1 : 0.82, test AUC : 0.90, test loss : 1.239

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:38, 25.12it/s]  1%|          | 6/981 [00:00<00:38, 25.40it/s]  1%|          | 9/981 [00:00<00:37, 25.70it/s]  1%|          | 12/981 [00:00<00:37, 25.68it/s]  2%|▏         | 15/981 [00:00<00:37, 25.57it/s]  2%|▏         | 18/981 [00:00<00:37, 25.77it/s]  2%|▏         | 21/981 [00:00<00:37, 25.36it/s]  2%|▏         | 24/981 [00:00<00:37, 25.45it/s]  3%|▎         | 27/981 [00:01<00:37, 25.35it/s]  3%|▎         | 30/981 [00:01<00:37, 25.56it/s]  3%|▎         | 33/981 [00:01<00:36, 25.79it/s]  4%|▎         | 36/981 [00:01<00:36, 25.91it/s]  4%|▍         | 39/981 [00:01<00:36, 25.77it/s]  4%|▍         | 42/981 [00:01<00:36, 25.83it/s]  5%|▍         | 45/981 [00:01<00:35, 26.01it/s]  5%|▍         | 48/981 [00:01<00:35, 25.93it/s]  5%|▌         | 51/981 [00:01<00:35, 25.85it/s]  6%|▌         | 54/981 [00:02<00:35, 25.93it/s]  6%|▌         | 57/981 [00:02<00:35, 25.74it/s]  6%|▌         | 60/981 [00:02<00:35, 25.75it/s]  6%|▋         | 63/981 [00:02<00:35, 25.71it/s]  7%|▋         | 66/981 [00:02<00:35, 25.60it/s]  7%|▋         | 69/981 [00:02<00:36, 25.06it/s]  7%|▋         | 72/981 [00:02<00:35, 25.40it/s]  8%|▊         | 75/981 [00:02<00:35, 25.63it/s]  8%|▊         | 78/981 [00:03<00:35, 25.48it/s]  8%|▊         | 81/981 [00:03<00:35, 25.66it/s]  9%|▊         | 84/981 [00:03<00:34, 25.99it/s]  9%|▉         | 87/981 [00:03<00:33, 26.31it/s]  9%|▉         | 90/981 [00:03<00:34, 26.19it/s]  9%|▉         | 93/981 [00:03<00:34, 25.91it/s] 10%|▉         | 96/981 [00:03<00:34, 25.75it/s] 10%|█         | 99/981 [00:03<00:34, 25.69it/s] 10%|█         | 102/981 [00:03<00:34, 25.35it/s] 11%|█         | 105/981 [00:04<00:34, 25.32it/s] 11%|█         | 108/981 [00:04<00:34, 25.22it/s] 11%|█▏        | 111/981 [00:04<00:34, 25.19it/s] 12%|█▏        | 114/981 [00:04<00:34, 25.21it/s] 12%|█▏        | 117/981 [00:04<00:34, 25.20it/s] 12%|█▏        | 120/981 [00:04<00:34, 25.28it/s] 13%|█▎        | 123/981 [00:04<00:33, 25.34it/s] 13%|█▎        | 126/981 [00:04<00:33, 25.51it/s] 13%|█▎        | 129/981 [00:05<00:33, 25.34it/s] 13%|█▎        | 132/981 [00:05<00:33, 25.24it/s] 14%|█▍        | 135/981 [00:05<00:33, 25.22it/s] 14%|█▍        | 138/981 [00:05<00:33, 24.93it/s] 14%|█▍        | 141/981 [00:05<00:35, 23.79it/s] 15%|█▍        | 144/981 [00:05<00:34, 24.03it/s] 15%|█▍        | 147/981 [00:05<00:34, 23.99it/s] 15%|█▌        | 150/981 [00:05<00:34, 24.20it/s] 16%|█▌        | 153/981 [00:06<00:34, 24.25it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.50it/s] 16%|█▌        | 159/981 [00:06<00:33, 24.59it/s] 17%|█▋        | 162/981 [00:06<00:32, 25.05it/s] 17%|█▋        | 165/981 [00:06<00:33, 24.68it/s] 17%|█▋        | 168/981 [00:06<00:33, 24.24it/s] 17%|█▋        | 171/981 [00:06<00:32, 24.58it/s] 18%|█▊        | 174/981 [00:06<00:32, 24.84it/s] 18%|█▊        | 177/981 [00:07<00:32, 24.74it/s] 18%|█▊        | 180/981 [00:07<00:32, 24.87it/s] 19%|█▊        | 183/981 [00:07<00:32, 24.79it/s] 19%|█▉        | 186/981 [00:07<00:31, 24.95it/s] 19%|█▉        | 189/981 [00:07<00:31, 25.19it/s] 20%|█▉        | 192/981 [00:07<00:31, 25.20it/s] 20%|█▉        | 195/981 [00:07<00:30, 25.36it/s] 20%|██        | 198/981 [00:07<00:31, 25.24it/s] 20%|██        | 201/981 [00:07<00:30, 25.20it/s] 21%|██        | 204/981 [00:08<00:31, 24.65it/s] 21%|██        | 207/981 [00:08<00:31, 24.58it/s] 21%|██▏       | 210/981 [00:08<00:31, 24.52it/s] 22%|██▏       | 213/981 [00:08<00:31, 24.07it/s] 22%|██▏       | 216/981 [00:08<00:32, 23.69it/s] 22%|██▏       | 219/981 [00:08<00:32, 23.70it/s] 23%|██▎       | 222/981 [00:08<00:31, 23.85it/s] 23%|██▎       | 225/981 [00:08<00:31, 24.04it/s] 23%|██▎       | 228/981 [00:09<00:31, 24.22it/s] 24%|██▎       | 231/981 [00:09<00:30, 24.26it/s] 24%|██▍       | 234/981 [00:09<00:30, 24.60it/s] 24%|██▍       | 237/981 [00:09<00:30, 24.76it/s] 24%|██▍       | 240/981 [00:09<00:30, 24.30it/s] 25%|██▍       | 243/981 [00:09<00:30, 24.01it/s] 25%|██▌       | 246/981 [00:09<00:30, 24.28it/s] 25%|██▌       | 249/981 [00:09<00:30, 24.08it/s] 26%|██▌       | 252/981 [00:10<00:30, 23.92it/s] 26%|██▌       | 255/981 [00:10<00:30, 23.91it/s] 26%|██▋       | 258/981 [00:10<00:30, 23.99it/s] 27%|██▋       | 261/981 [00:10<00:29, 24.15it/s] 27%|██▋       | 264/981 [00:10<00:29, 24.38it/s] 27%|██▋       | 267/981 [00:10<00:29, 24.35it/s] 28%|██▊       | 270/981 [00:10<00:28, 24.75it/s] 28%|██▊       | 273/981 [00:10<00:28, 25.05it/s] 28%|██▊       | 276/981 [00:11<00:28, 25.15it/s] 28%|██▊       | 279/981 [00:11<00:28, 25.01it/s] 29%|██▊       | 282/981 [00:11<00:28, 24.68it/s] 29%|██▉       | 285/981 [00:11<00:28, 24.61it/s] 29%|██▉       | 288/981 [00:11<00:28, 24.40it/s] 30%|██▉       | 291/981 [00:11<00:28, 24.21it/s] 30%|██▉       | 294/981 [00:11<00:30, 22.70it/s] 30%|███       | 297/981 [00:11<00:30, 22.33it/s] 31%|███       | 300/981 [00:12<00:30, 22.34it/s] 31%|███       | 303/981 [00:12<00:30, 22.19it/s] 31%|███       | 306/981 [00:12<00:30, 22.33it/s] 31%|███▏      | 309/981 [00:12<00:28, 23.20it/s] 32%|███▏      | 312/981 [00:12<00:28, 23.63it/s] 32%|███▏      | 315/981 [00:12<00:27, 23.93it/s] 32%|███▏      | 318/981 [00:12<00:27, 24.48it/s] 33%|███▎      | 321/981 [00:12<00:27, 24.12it/s] 33%|███▎      | 324/981 [00:13<00:27, 24.21it/s] 33%|███▎      | 327/981 [00:13<00:26, 24.24it/s] 34%|███▎      | 330/981 [00:13<00:27, 24.04it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.29it/s] 34%|███▍      | 336/981 [00:13<00:26, 24.71it/s] 35%|███▍      | 339/981 [00:13<00:25, 24.95it/s] 35%|███▍      | 342/981 [00:13<00:25, 24.71it/s] 35%|███▌      | 345/981 [00:13<00:25, 25.03it/s] 35%|███▌      | 348/981 [00:14<00:25, 24.78it/s] 36%|███▌      | 351/981 [00:14<00:25, 24.69it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.52it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.77it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.78it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.69it/s] 37%|███▋      | 366/981 [00:14<00:25, 24.54it/s] 38%|███▊      | 369/981 [00:14<00:24, 24.55it/s] 38%|███▊      | 372/981 [00:15<00:24, 24.67it/s] 38%|███▊      | 375/981 [00:15<00:24, 24.78it/s] 39%|███▊      | 378/981 [00:15<00:23, 25.14it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.94it/s] 39%|███▉      | 384/981 [00:15<00:23, 25.22it/s] 39%|███▉      | 387/981 [00:15<00:23, 25.60it/s] 40%|███▉      | 390/981 [00:15<00:23, 25.27it/s] 40%|████      | 393/981 [00:15<00:23, 25.26it/s] 40%|████      | 396/981 [00:15<00:23, 25.12it/s] 41%|████      | 399/981 [00:16<00:23, 24.85it/s] 41%|████      | 402/981 [00:16<00:23, 24.73it/s] 41%|████▏     | 405/981 [00:16<00:23, 24.25it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.65it/s] 42%|████▏     | 411/981 [00:16<00:22, 24.87it/s] 42%|████▏     | 414/981 [00:16<00:22, 25.01it/s] 43%|████▎     | 417/981 [00:16<00:22, 25.37it/s] 43%|████▎     | 420/981 [00:16<00:21, 25.52it/s] 43%|████▎     | 423/981 [00:17<00:21, 25.83it/s] 43%|████▎     | 426/981 [00:17<00:21, 25.82it/s] 44%|████▎     | 429/981 [00:17<00:21, 25.63it/s] 44%|████▍     | 432/981 [00:17<00:21, 25.73it/s] 44%|████▍     | 435/981 [00:17<00:21, 25.56it/s] 45%|████▍     | 438/981 [00:17<00:22, 24.54it/s] 45%|████▍     | 441/981 [00:17<00:22, 23.73it/s] 45%|████▌     | 444/981 [00:17<00:22, 23.49it/s] 46%|████▌     | 447/981 [00:18<00:23, 23.11it/s] 46%|████▌     | 450/981 [00:18<00:23, 22.98it/s] 46%|████▌     | 453/981 [00:18<00:23, 22.76it/s] 46%|████▋     | 456/981 [00:18<00:22, 23.68it/s] 47%|████▋     | 459/981 [00:18<00:21, 23.95it/s] 47%|████▋     | 462/981 [00:18<00:21, 24.21it/s] 47%|████▋     | 465/981 [00:18<00:21, 24.12it/s] 48%|████▊     | 468/981 [00:18<00:20, 24.53it/s] 48%|████▊     | 471/981 [00:19<00:20, 24.55it/s] 48%|████▊     | 474/981 [00:19<00:20, 24.55it/s] 49%|████▊     | 477/981 [00:19<00:20, 24.52it/s] 49%|████▉     | 480/981 [00:19<00:20, 24.23it/s] 49%|████▉     | 483/981 [00:19<00:20, 24.28it/s] 50%|████▉     | 486/981 [00:19<00:20, 24.60it/s] 50%|████▉     | 489/981 [00:19<00:19, 24.68it/s] 50%|█████     | 492/981 [00:19<00:19, 25.05it/s] 50%|█████     | 495/981 [00:20<00:19, 25.31it/s] 51%|█████     | 498/981 [00:20<00:18, 25.48it/s] 51%|█████     | 501/981 [00:20<00:19, 25.06it/s] 51%|█████▏    | 504/981 [00:20<00:18, 25.27it/s] 52%|█████▏    | 507/981 [00:20<00:18, 25.35it/s] 52%|█████▏    | 510/981 [00:20<00:18, 24.93it/s] 52%|█████▏    | 513/981 [00:20<00:18, 24.77it/s] 53%|█████▎    | 516/981 [00:20<00:18, 24.51it/s] 53%|█████▎    | 519/981 [00:20<00:18, 24.66it/s] 53%|█████▎    | 522/981 [00:21<00:18, 24.99it/s] 54%|█████▎    | 525/981 [00:21<00:18, 25.33it/s] 54%|█████▍    | 528/981 [00:21<00:17, 25.49it/s] 54%|█████▍    | 531/981 [00:21<00:17, 25.88it/s] 54%|█████▍    | 534/981 [00:21<00:17, 25.72it/s] 55%|█████▍    | 537/981 [00:21<00:17, 25.93it/s] 55%|█████▌    | 540/981 [00:21<00:17, 25.88it/s] 55%|█████▌    | 543/981 [00:21<00:17, 25.73it/s] 56%|█████▌    | 546/981 [00:22<00:17, 25.31it/s] 56%|█████▌    | 549/981 [00:22<00:16, 25.49it/s] 56%|█████▋    | 552/981 [00:22<00:16, 25.43it/s] 57%|█████▋    | 555/981 [00:22<00:16, 25.39it/s] 57%|█████▋    | 558/981 [00:22<00:16, 25.38it/s] 57%|█████▋    | 561/981 [00:22<00:16, 25.61it/s] 57%|█████▋    | 564/981 [00:22<00:16, 25.78it/s] 58%|█████▊    | 567/981 [00:22<00:15, 25.91it/s] 58%|█████▊    | 570/981 [00:22<00:15, 25.92it/s] 58%|█████▊    | 573/981 [00:23<00:15, 26.05it/s] 59%|█████▊    | 576/981 [00:23<00:15, 26.31it/s] 59%|█████▉    | 579/981 [00:23<00:15, 26.46it/s] 59%|█████▉    | 582/981 [00:23<00:15, 26.49it/s] 60%|█████▉    | 585/981 [00:23<00:15, 26.31it/s] 60%|█████▉    | 588/981 [00:23<00:14, 26.46it/s] 60%|██████    | 591/981 [00:23<00:14, 26.13it/s] 61%|██████    | 594/981 [00:23<00:15, 25.41it/s] 61%|██████    | 597/981 [00:23<00:15, 25.39it/s] 61%|██████    | 600/981 [00:24<00:14, 25.54it/s] 61%|██████▏   | 603/981 [00:24<00:14, 25.42it/s] 62%|██████▏   | 606/981 [00:24<00:14, 25.49it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.81it/s] 62%|██████▏   | 612/981 [00:24<00:14, 26.12it/s] 63%|██████▎   | 615/981 [00:24<00:13, 26.39it/s] 63%|██████▎   | 618/981 [00:24<00:13, 26.71it/s] 63%|██████▎   | 621/981 [00:24<00:13, 26.54it/s] 64%|██████▎   | 624/981 [00:25<00:13, 26.43it/s] 64%|██████▍   | 627/981 [00:25<00:13, 26.41it/s] 64%|██████▍   | 630/981 [00:25<00:13, 26.17it/s] 65%|██████▍   | 633/981 [00:25<00:13, 26.00it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.76it/s] 65%|██████▌   | 639/981 [00:25<00:13, 25.68it/s] 65%|██████▌   | 642/981 [00:25<00:13, 25.85it/s] 66%|██████▌   | 645/981 [00:25<00:13, 25.65it/s] 66%|██████▌   | 648/981 [00:25<00:13, 25.58it/s] 66%|██████▋   | 651/981 [00:26<00:12, 25.95it/s] 67%|██████▋   | 654/981 [00:26<00:12, 26.33it/s] 67%|██████▋   | 657/981 [00:26<00:12, 26.47it/s] 67%|██████▋   | 660/981 [00:26<00:12, 26.48it/s] 68%|██████▊   | 663/981 [00:26<00:12, 26.48it/s] 68%|██████▊   | 666/981 [00:26<00:11, 26.38it/s] 68%|██████▊   | 669/981 [00:26<00:11, 26.22it/s] 69%|██████▊   | 672/981 [00:26<00:11, 25.97it/s] 69%|██████▉   | 675/981 [00:26<00:11, 25.76it/s] 69%|██████▉   | 678/981 [00:27<00:11, 25.75it/s] 69%|██████▉   | 681/981 [00:27<00:11, 25.94it/s] 70%|██████▉   | 684/981 [00:27<00:11, 26.01it/s] 70%|███████   | 687/981 [00:27<00:11, 26.05it/s] 70%|███████   | 690/981 [00:27<00:11, 25.68it/s] 71%|███████   | 693/981 [00:27<00:11, 26.05it/s] 71%|███████   | 696/981 [00:27<00:10, 26.46it/s] 71%|███████▏  | 699/981 [00:27<00:10, 26.62it/s] 72%|███████▏  | 702/981 [00:28<00:10, 26.55it/s] 72%|███████▏  | 705/981 [00:28<00:10, 26.43it/s] 72%|███████▏  | 708/981 [00:28<00:10, 26.34it/s] 72%|███████▏  | 711/981 [00:28<00:10, 25.72it/s] 73%|███████▎  | 714/981 [00:28<00:10, 25.76it/s] 73%|███████▎  | 717/981 [00:28<00:10, 25.64it/s] 73%|███████▎  | 720/981 [00:28<00:10, 25.76it/s] 74%|███████▎  | 723/981 [00:28<00:09, 25.88it/s] 74%|███████▍  | 726/981 [00:28<00:09, 25.93it/s] 74%|███████▍  | 729/981 [00:29<00:09, 26.05it/s] 75%|███████▍  | 732/981 [00:29<00:09, 26.47it/s] 75%|███████▍  | 735/981 [00:29<00:09, 26.71it/s] 75%|███████▌  | 738/981 [00:29<00:09, 26.80it/s] 76%|███████▌  | 741/981 [00:29<00:09, 26.58it/s] 76%|███████▌  | 744/981 [00:29<00:08, 26.44it/s] 76%|███████▌  | 747/981 [00:29<00:08, 26.30it/s] 76%|███████▋  | 750/981 [00:29<00:08, 26.12it/s] 77%|███████▋  | 753/981 [00:29<00:08, 25.81it/s] 77%|███████▋  | 756/981 [00:30<00:08, 25.60it/s] 77%|███████▋  | 759/981 [00:30<00:08, 25.45it/s] 78%|███████▊  | 762/981 [00:30<00:08, 25.57it/s] 78%|███████▊  | 765/981 [00:30<00:08, 25.59it/s] 78%|███████▊  | 768/981 [00:30<00:08, 25.64it/s] 79%|███████▊  | 771/981 [00:30<00:08, 25.94it/s] 79%|███████▉  | 774/981 [00:30<00:07, 26.25it/s] 79%|███████▉  | 777/981 [00:30<00:07, 26.40it/s] 80%|███████▉  | 780/981 [00:31<00:07, 26.28it/s] 80%|███████▉  | 783/981 [00:31<00:07, 26.35it/s] 80%|████████  | 786/981 [00:31<00:07, 26.67it/s] 80%|████████  | 789/981 [00:31<00:07, 27.02it/s] 81%|████████  | 792/981 [00:31<00:06, 27.15it/s] 81%|████████  | 795/981 [00:31<00:06, 27.56it/s] 81%|████████▏ | 798/981 [00:31<00:06, 27.92it/s] 82%|████████▏ | 801/981 [00:31<00:06, 28.25it/s] 82%|████████▏ | 804/981 [00:31<00:06, 28.66it/s] 82%|████████▏ | 808/981 [00:31<00:05, 29.22it/s] 83%|████████▎ | 812/981 [00:32<00:05, 29.47it/s] 83%|████████▎ | 816/981 [00:32<00:05, 29.96it/s] 84%|████████▎ | 820/981 [00:32<00:05, 30.42it/s] 84%|████████▍ | 824/981 [00:32<00:05, 30.23it/s] 84%|████████▍ | 828/981 [00:32<00:05, 30.19it/s] 85%|████████▍ | 832/981 [00:32<00:04, 30.12it/s] 85%|████████▌ | 836/981 [00:32<00:04, 30.02it/s] 86%|████████▌ | 840/981 [00:33<00:04, 29.71it/s] 86%|████████▌ | 843/981 [00:33<00:04, 28.93it/s] 86%|████████▌ | 846/981 [00:33<00:04, 28.10it/s] 87%|████████▋ | 850/981 [00:33<00:04, 28.80it/s] 87%|████████▋ | 854/981 [00:33<00:04, 29.24it/s] 87%|████████▋ | 857/981 [00:33<00:04, 29.39it/s] 88%|████████▊ | 861/981 [00:33<00:04, 29.87it/s] 88%|████████▊ | 865/981 [00:33<00:03, 30.21it/s] 89%|████████▊ | 869/981 [00:34<00:03, 30.69it/s] 89%|████████▉ | 873/981 [00:34<00:03, 30.20it/s] 89%|████████▉ | 877/981 [00:34<00:03, 30.23it/s] 90%|████████▉ | 881/981 [00:34<00:03, 30.15it/s] 90%|█████████ | 885/981 [00:34<00:03, 29.65it/s] 91%|█████████ | 888/981 [00:34<00:03, 29.30it/s] 91%|█████████ | 891/981 [00:34<00:03, 29.25it/s] 91%|█████████ | 895/981 [00:34<00:02, 29.56it/s] 92%|█████████▏| 899/981 [00:35<00:02, 29.89it/s] 92%|█████████▏| 903/981 [00:35<00:02, 30.02it/s] 92%|█████████▏| 907/981 [00:35<00:02, 30.42it/s] 93%|█████████▎| 911/981 [00:35<00:02, 30.71it/s] 93%|█████████▎| 915/981 [00:35<00:02, 31.00it/s] 94%|█████████▎| 919/981 [00:35<00:02, 30.59it/s] 94%|█████████▍| 923/981 [00:35<00:01, 30.47it/s] 94%|█████████▍| 927/981 [00:35<00:01, 30.20it/s] 95%|█████████▍| 931/981 [00:36<00:01, 30.15it/s] 95%|█████████▌| 935/981 [00:36<00:01, 28.93it/s] 96%|█████████▌| 938/981 [00:36<00:01, 28.41it/s] 96%|█████████▌| 941/981 [00:36<00:01, 27.93it/s] 96%|█████████▌| 944/981 [00:36<00:01, 27.61it/s] 97%|█████████▋| 947/981 [00:36<00:01, 27.38it/s] 97%|█████████▋| 950/981 [00:36<00:01, 28.02it/s] 97%|█████████▋| 954/981 [00:36<00:00, 29.23it/s] 98%|█████████▊| 958/981 [00:37<00:00, 29.88it/s] 98%|█████████▊| 962/981 [00:37<00:00, 30.03it/s] 98%|█████████▊| 966/981 [00:37<00:00, 30.09it/s] 99%|█████████▉| 970/981 [00:37<00:00, 30.19it/s] 99%|█████████▉| 974/981 [00:37<00:00, 29.93it/s]100%|█████████▉| 977/981 [00:37<00:00, 29.26it/s]100%|█████████▉| 980/981 [00:37<00:00, 28.58it/s]100%|██████████| 981/981 [00:37<00:00, 25.92it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_Focal_Normal
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.036, valid loss : 0.036, train acc : 0.982, valid acc : 0.982, train f1 : 0.495, valid f1 : 0.495
training process:   2%|▏         | 1/50 [03:58<3:14:40, 238.37s/it]Best score increase :0.000 -> 0.495
training process:   4%|▍         | 2/50 [07:13<2:50:24, 213.00s/it]Best score increase :0.495 -> 0.519
training process:   6%|▌         | 3/50 [10:27<2:40:11, 204.50s/it]Best score increase :0.519 -> 0.712
training process:   8%|▊         | 4/50 [13:41<2:33:27, 200.17s/it]Best score increase :0.712 -> 0.785
epoch : 5, train loss : 0.024, valid loss : 0.025, train acc : 0.989, valid acc : 0.989, train f1 : 0.770, valid f1 : 0.794
training process:  10%|█         | 5/50 [17:38<2:40:10, 213.56s/it]Best score increase :0.785 -> 0.794
training process:  12%|█▏        | 6/50 [20:50<2:31:15, 206.27s/it]Best score increase :0.794 -> 0.823
training process:  14%|█▍        | 7/50 [24:06<2:25:23, 202.88s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 8/50 [27:20<2:19:52, 199.81s/it]Best score increase :0.823 -> 0.827
epoch : 9, train loss : 0.024, valid loss : 0.021, train acc : 0.989, valid acc : 0.990, train f1 : 0.761, valid f1 : 0.823
training process:  18%|█▊        | 9/50 [31:18<2:24:41, 211.75s/it]EarlyStopping counter : 1 out of 12
training process:  20%|██        | 10/50 [34:30<2:17:06, 205.67s/it]EarlyStopping counter : 2 out of 12
training process:  22%|██▏       | 11/50 [37:46<2:11:44, 202.67s/it]EarlyStopping counter : 3 out of 12
training process:  24%|██▍       | 12/50 [41:00<2:06:49, 200.25s/it]EarlyStopping counter : 4 out of 12
epoch : 13, train loss : 0.024, valid loss : 0.020, train acc : 0.989, valid acc : 0.989, train f1 : 0.765, valid f1 : 0.794
training process:  26%|██▌       | 13/50 [44:59<2:10:41, 211.92s/it]EarlyStopping counter : 5 out of 12
training process:  28%|██▊       | 14/50 [48:12<2:03:44, 206.23s/it]EarlyStopping counter : 6 out of 12
training process:  30%|███       | 15/50 [51:25<1:57:58, 202.24s/it]EarlyStopping counter : 7 out of 12
training process:  32%|███▏      | 16/50 [54:38<1:53:03, 199.51s/it]EarlyStopping counter : 8 out of 12
epoch : 17, train loss : 0.022, valid loss : 0.024, train acc : 0.990, valid acc : 0.989, train f1 : 0.805, valid f1 : 0.801
training process:  34%|███▍      | 17/50 [58:34<1:55:46, 210.51s/it]EarlyStopping counter : 9 out of 12
training process:  36%|███▌      | 18/50 [1:01:49<1:49:40, 205.65s/it]EarlyStopping counter : 10 out of 12
training process:  38%|███▊      | 19/50 [1:05:00<1:44:04, 201.43s/it]EarlyStopping counter : 11 out of 12
training process:  40%|████      | 20/50 [1:08:13<1:39:20, 198.69s/it]Best score increase :0.827 -> 0.877
epoch : 21, train loss : 0.017, valid loss : 0.017, train acc : 0.991, valid acc : 0.991, train f1 : 0.838, valid f1 : 0.849
training process:  42%|████▏     | 21/50 [1:12:06<1:41:02, 209.04s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 22/50 [1:15:21<1:35:37, 204.93s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 23/50 [1:18:35<1:30:41, 201.55s/it]EarlyStopping counter : 3 out of 12
training process:  48%|████▊     | 24/50 [1:21:48<1:26:17, 199.15s/it]Best score increase :0.877 -> 0.904
epoch : 25, train loss : 0.010, valid loss : 0.013, train acc : 0.994, valid acc : 0.994, train f1 : 0.904, valid f1 : 0.909
training process:  50%|█████     | 25/50 [1:25:47<1:27:51, 210.87s/it]Best score increase :0.904 -> 0.909
training process:  52%|█████▏    | 26/50 [1:29:04<1:22:47, 206.99s/it]Best score increase :0.909 -> 0.923
training process:  54%|█████▍    | 27/50 [1:32:21<1:18:07, 203.82s/it]Best score increase :0.923 -> 0.925
training process:  56%|█████▌    | 28/50 [1:35:34<1:13:35, 200.73s/it]Best score increase :0.925 -> 0.927
epoch : 29, train loss : 0.010, valid loss : 0.011, train acc : 0.994, valid acc : 0.996, train f1 : 0.907, valid f1 : 0.930
training process:  58%|█████▊    | 29/50 [1:39:37<1:14:42, 213.44s/it]Best score increase :0.927 -> 0.930
training process:  60%|██████    | 30/50 [1:42:51<1:09:11, 207.56s/it]EarlyStopping counter : 1 out of 12
training process:  62%|██████▏   | 31/50 [1:46:09<1:04:46, 204.58s/it]EarlyStopping counter : 2 out of 12
training process:  64%|██████▍   | 32/50 [1:49:21<1:00:13, 200.77s/it]Best score increase :0.930 -> 0.935
epoch : 33, train loss : 0.009, valid loss : 0.011, train acc : 0.995, valid acc : 0.996, train f1 : 0.922, valid f1 : 0.930
training process:  66%|██████▌   | 33/50 [1:53:18<1:00:00, 211.78s/it]EarlyStopping counter : 1 out of 12
training process:  68%|██████▊   | 34/50 [1:56:30<54:52, 205.77s/it]  Best score increase :0.935 -> 0.936
training process:  70%|███████   | 35/50 [1:59:40<50:17, 201.14s/it]EarlyStopping counter : 1 out of 12
training process:  72%|███████▏  | 36/50 [2:02:53<46:18, 198.43s/it]EarlyStopping counter : 2 out of 12
epoch : 37, train loss : 0.008, valid loss : 0.009, train acc : 0.995, valid acc : 0.996, train f1 : 0.919, valid f1 : 0.941
training process:  74%|███████▍  | 37/50 [2:06:47<45:20, 209.30s/it]Best score increase :0.936 -> 0.941
training process:  76%|███████▌  | 38/50 [2:10:03<41:03, 205.29s/it]EarlyStopping counter : 1 out of 12
training process:  78%|███████▊  | 39/50 [2:13:16<36:58, 201.68s/it]EarlyStopping counter : 2 out of 12
training process:  80%|████████  | 40/50 [2:16:29<33:08, 198.86s/it]EarlyStopping counter : 3 out of 12
epoch : 41, train loss : 0.008, valid loss : 0.010, train acc : 0.996, valid acc : 0.996, train f1 : 0.934, valid f1 : 0.930
training process:  82%|████████▏ | 41/50 [2:20:22<31:21, 209.08s/it]EarlyStopping counter : 4 out of 12
training process:  84%|████████▍ | 42/50 [2:23:35<27:15, 204.47s/it]EarlyStopping counter : 5 out of 12
training process:  86%|████████▌ | 43/50 [2:26:49<23:28, 201.16s/it]EarlyStopping counter : 6 out of 12
training process:  88%|████████▊ | 44/50 [2:30:02<19:52, 198.73s/it]EarlyStopping counter : 7 out of 12
epoch : 45, train loss : 0.008, valid loss : 0.012, train acc : 0.996, valid acc : 0.995, train f1 : 0.940, valid f1 : 0.916
training process:  90%|█████████ | 45/50 [2:33:59<17:30, 210.19s/it]EarlyStopping counter : 8 out of 12
training process:  92%|█████████▏| 46/50 [2:37:16<13:45, 206.38s/it]EarlyStopping counter : 9 out of 12
training process:  94%|█████████▍| 47/50 [2:40:32<10:09, 203.09s/it]EarlyStopping counter : 10 out of 12
training process:  96%|█████████▌| 48/50 [2:43:46<06:41, 200.52s/it]EarlyStopping counter : 11 out of 12
epoch : 49, train loss : 0.007, valid loss : 0.009, train acc : 0.996, valid acc : 0.996, train f1 : 0.937, valid f1 : 0.937
training process:  96%|█████████▌| 48/50 [2:47:46<06:59, 209.72s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 48, best f1 score : 0.941
training process finished, best loss : 0.009 and best acc : 0.996, best f1 : 0.941, best epoch : 36

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.72      0.82      0.76        71
           1       1.00      0.99      1.00      3812

    accuracy                           0.99      3883
   macro avg       0.86      0.91      0.88      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.88, test AUC : 0.91, test loss : 0.292

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:44, 21.85it/s]  1%|          | 6/981 [00:00<00:41, 23.53it/s]  1%|          | 9/981 [00:00<00:40, 24.28it/s]  1%|          | 12/981 [00:00<00:39, 24.67it/s]  2%|▏         | 15/981 [00:00<00:39, 24.75it/s]  2%|▏         | 18/981 [00:00<00:38, 24.71it/s]  2%|▏         | 21/981 [00:00<00:38, 24.64it/s]  2%|▏         | 24/981 [00:00<00:38, 24.74it/s]  3%|▎         | 27/981 [00:01<00:38, 24.72it/s]  3%|▎         | 30/981 [00:01<00:38, 24.77it/s]  3%|▎         | 33/981 [00:01<00:38, 24.76it/s]  4%|▎         | 36/981 [00:01<00:38, 24.81it/s]  4%|▍         | 39/981 [00:01<00:37, 24.88it/s]  4%|▍         | 42/981 [00:01<00:37, 24.90it/s]  5%|▍         | 45/981 [00:01<00:37, 24.99it/s]  5%|▍         | 48/981 [00:01<00:37, 25.04it/s]  5%|▌         | 51/981 [00:02<00:37, 25.04it/s]  6%|▌         | 54/981 [00:02<00:37, 24.98it/s]  6%|▌         | 57/981 [00:02<00:37, 24.60it/s]  6%|▌         | 60/981 [00:02<00:37, 24.64it/s]  6%|▋         | 63/981 [00:02<00:37, 24.71it/s]  7%|▋         | 66/981 [00:02<00:36, 24.75it/s]  7%|▋         | 69/981 [00:02<00:36, 24.79it/s]  7%|▋         | 72/981 [00:02<00:36, 24.84it/s]  8%|▊         | 75/981 [00:03<00:36, 24.83it/s]  8%|▊         | 78/981 [00:03<00:36, 24.63it/s]  8%|▊         | 81/981 [00:03<00:36, 24.69it/s]  9%|▊         | 84/981 [00:03<00:36, 24.85it/s]  9%|▉         | 87/981 [00:03<00:36, 24.82it/s]  9%|▉         | 90/981 [00:03<00:35, 24.77it/s]  9%|▉         | 93/981 [00:03<00:35, 24.71it/s] 10%|▉         | 96/981 [00:03<00:35, 24.68it/s] 10%|█         | 99/981 [00:04<00:35, 24.62it/s] 10%|█         | 102/981 [00:04<00:35, 24.58it/s] 11%|█         | 105/981 [00:04<00:35, 24.55it/s] 11%|█         | 108/981 [00:04<00:35, 24.53it/s] 11%|█▏        | 111/981 [00:04<00:35, 24.52it/s] 12%|█▏        | 114/981 [00:04<00:35, 24.52it/s] 12%|█▏        | 117/981 [00:04<00:35, 24.51it/s] 12%|█▏        | 120/981 [00:04<00:35, 24.57it/s] 13%|█▎        | 123/981 [00:04<00:34, 24.56it/s] 13%|█▎        | 126/981 [00:05<00:34, 24.53it/s] 13%|█▎        | 129/981 [00:05<00:34, 24.48it/s] 13%|█▎        | 132/981 [00:05<00:34, 24.46it/s] 14%|█▍        | 135/981 [00:05<00:34, 24.45it/s] 14%|█▍        | 138/981 [00:05<00:34, 24.54it/s] 14%|█▍        | 141/981 [00:05<00:34, 24.57it/s] 15%|█▍        | 144/981 [00:05<00:33, 24.64it/s] 15%|█▍        | 147/981 [00:05<00:33, 24.65it/s] 15%|█▌        | 150/981 [00:06<00:33, 24.67it/s] 16%|█▌        | 153/981 [00:06<00:33, 24.85it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.79it/s] 16%|█▌        | 159/981 [00:06<00:33, 24.75it/s] 17%|█▋        | 162/981 [00:06<00:33, 24.65it/s] 17%|█▋        | 165/981 [00:06<00:32, 24.78it/s] 17%|█▋        | 168/981 [00:06<00:32, 24.80it/s] 17%|█▋        | 171/981 [00:06<00:32, 24.82it/s] 18%|█▊        | 174/981 [00:07<00:32, 24.75it/s] 18%|█▊        | 177/981 [00:07<00:32, 24.74it/s] 18%|█▊        | 180/981 [00:07<00:32, 24.61it/s] 19%|█▊        | 183/981 [00:07<00:32, 24.70it/s] 19%|█▉        | 186/981 [00:07<00:32, 24.50it/s] 19%|█▉        | 189/981 [00:07<00:32, 24.71it/s] 20%|█▉        | 192/981 [00:07<00:31, 24.72it/s] 20%|█▉        | 195/981 [00:07<00:32, 24.47it/s] 20%|██        | 198/981 [00:08<00:32, 24.44it/s] 20%|██        | 201/981 [00:08<00:32, 24.35it/s] 21%|██        | 204/981 [00:08<00:31, 24.34it/s] 21%|██        | 207/981 [00:08<00:31, 24.32it/s] 21%|██▏       | 210/981 [00:08<00:31, 24.30it/s] 22%|██▏       | 213/981 [00:08<00:31, 24.23it/s] 22%|██▏       | 216/981 [00:08<00:31, 24.09it/s] 22%|██▏       | 219/981 [00:08<00:31, 24.08it/s] 23%|██▎       | 222/981 [00:09<00:31, 24.21it/s] 23%|██▎       | 225/981 [00:09<00:31, 24.22it/s] 23%|██▎       | 228/981 [00:09<00:31, 24.20it/s] 24%|██▎       | 231/981 [00:09<00:31, 24.05it/s] 24%|██▍       | 234/981 [00:09<00:31, 24.06it/s] 24%|██▍       | 237/981 [00:09<00:30, 24.10it/s] 24%|██▍       | 240/981 [00:09<00:30, 24.20it/s] 25%|██▍       | 243/981 [00:09<00:30, 24.15it/s] 25%|██▌       | 246/981 [00:10<00:30, 24.20it/s] 25%|██▌       | 249/981 [00:10<00:30, 24.21it/s] 26%|██▌       | 252/981 [00:10<00:30, 24.09it/s] 26%|██▌       | 255/981 [00:10<00:30, 24.15it/s] 26%|██▋       | 258/981 [00:10<00:29, 24.32it/s] 27%|██▋       | 261/981 [00:10<00:29, 24.34it/s] 27%|██▋       | 264/981 [00:10<00:29, 24.34it/s] 27%|██▋       | 267/981 [00:10<00:29, 24.30it/s] 28%|██▊       | 270/981 [00:11<00:29, 24.25it/s] 28%|██▊       | 273/981 [00:11<00:29, 24.23it/s] 28%|██▊       | 276/981 [00:11<00:29, 24.17it/s] 28%|██▊       | 279/981 [00:11<00:29, 24.06it/s] 29%|██▊       | 282/981 [00:11<00:28, 24.11it/s] 29%|██▉       | 285/981 [00:11<00:28, 24.18it/s] 29%|██▉       | 288/981 [00:11<00:28, 24.21it/s] 30%|██▉       | 291/981 [00:11<00:28, 24.27it/s] 30%|██▉       | 294/981 [00:11<00:28, 24.48it/s] 30%|███       | 297/981 [00:12<00:27, 24.44it/s] 31%|███       | 300/981 [00:12<00:28, 24.23it/s] 31%|███       | 303/981 [00:12<00:27, 24.24it/s] 31%|███       | 306/981 [00:12<00:27, 24.28it/s] 31%|███▏      | 309/981 [00:12<00:27, 24.32it/s] 32%|███▏      | 312/981 [00:12<00:27, 24.18it/s] 32%|███▏      | 315/981 [00:12<00:27, 24.21it/s] 32%|███▏      | 318/981 [00:12<00:27, 23.95it/s] 33%|███▎      | 321/981 [00:13<00:27, 23.93it/s] 33%|███▎      | 324/981 [00:13<00:27, 24.04it/s] 33%|███▎      | 327/981 [00:13<00:26, 24.25it/s] 34%|███▎      | 330/981 [00:13<00:26, 24.33it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.33it/s] 34%|███▍      | 336/981 [00:13<00:26, 24.30it/s] 35%|███▍      | 339/981 [00:13<00:26, 24.20it/s] 35%|███▍      | 342/981 [00:13<00:26, 24.25it/s] 35%|███▌      | 345/981 [00:14<00:26, 24.24it/s] 35%|███▌      | 348/981 [00:14<00:26, 24.21it/s] 36%|███▌      | 351/981 [00:14<00:25, 24.25it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.24it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.23it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.21it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.38it/s] 37%|███▋      | 366/981 [00:14<00:25, 24.34it/s] 38%|███▊      | 369/981 [00:15<00:25, 24.25it/s] 38%|███▊      | 372/981 [00:15<00:25, 24.20it/s] 38%|███▊      | 375/981 [00:15<00:25, 24.17it/s] 39%|███▊      | 378/981 [00:15<00:24, 24.21it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.09it/s] 39%|███▉      | 384/981 [00:15<00:24, 24.09it/s] 39%|███▉      | 387/981 [00:15<00:24, 24.06it/s] 40%|███▉      | 390/981 [00:15<00:24, 24.06it/s] 40%|████      | 393/981 [00:16<00:24, 24.09it/s] 40%|████      | 396/981 [00:16<00:24, 24.17it/s] 41%|████      | 399/981 [00:16<00:23, 24.27it/s] 41%|████      | 402/981 [00:16<00:23, 24.25it/s] 41%|████▏     | 405/981 [00:16<00:23, 24.10it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.05it/s] 42%|████▏     | 411/981 [00:16<00:23, 23.98it/s] 42%|████▏     | 414/981 [00:16<00:23, 24.08it/s] 43%|████▎     | 417/981 [00:17<00:23, 24.08it/s] 43%|████▎     | 420/981 [00:17<00:23, 24.17it/s] 43%|████▎     | 423/981 [00:17<00:23, 24.20it/s] 43%|████▎     | 426/981 [00:17<00:22, 24.22it/s] 44%|████▎     | 429/981 [00:17<00:22, 24.19it/s] 44%|████▍     | 432/981 [00:17<00:22, 23.94it/s] 44%|████▍     | 435/981 [00:17<00:22, 24.01it/s] 45%|████▍     | 438/981 [00:17<00:22, 24.01it/s] 45%|████▍     | 441/981 [00:18<00:22, 23.72it/s] 45%|████▌     | 444/981 [00:18<00:22, 23.81it/s] 46%|████▌     | 447/981 [00:18<00:22, 24.04it/s] 46%|████▌     | 450/981 [00:18<00:21, 24.22it/s] 46%|████▌     | 453/981 [00:18<00:22, 23.89it/s] 46%|████▋     | 456/981 [00:18<00:21, 24.09it/s] 47%|████▋     | 459/981 [00:18<00:21, 24.24it/s] 47%|████▋     | 462/981 [00:18<00:21, 24.20it/s] 47%|████▋     | 465/981 [00:19<00:21, 24.35it/s] 48%|████▊     | 468/981 [00:19<00:21, 24.40it/s] 48%|████▊     | 471/981 [00:19<00:20, 24.45it/s] 48%|████▊     | 474/981 [00:19<00:20, 24.41it/s] 49%|████▊     | 477/981 [00:19<00:20, 24.39it/s] 49%|████▉     | 480/981 [00:19<00:20, 24.40it/s] 49%|████▉     | 483/981 [00:19<00:20, 24.36it/s] 50%|████▉     | 486/981 [00:19<00:20, 24.31it/s] 50%|████▉     | 489/981 [00:20<00:20, 24.38it/s] 50%|█████     | 492/981 [00:20<00:20, 24.41it/s] 50%|█████     | 495/981 [00:20<00:19, 24.42it/s] 51%|█████     | 498/981 [00:20<00:19, 24.48it/s] 51%|█████     | 501/981 [00:20<00:19, 24.58it/s] 51%|█████▏    | 504/981 [00:20<00:19, 24.65it/s] 52%|█████▏    | 507/981 [00:20<00:19, 24.54it/s] 52%|█████▏    | 510/981 [00:20<00:19, 24.57it/s] 52%|█████▏    | 513/981 [00:21<00:19, 24.62it/s] 53%|█████▎    | 516/981 [00:21<00:18, 24.69it/s] 53%|█████▎    | 519/981 [00:21<00:18, 24.73it/s] 53%|█████▎    | 522/981 [00:21<00:18, 24.76it/s] 54%|█████▎    | 525/981 [00:21<00:18, 24.83it/s] 54%|█████▍    | 528/981 [00:21<00:18, 24.88it/s] 54%|█████▍    | 531/981 [00:21<00:18, 24.93it/s] 54%|█████▍    | 534/981 [00:21<00:17, 25.01it/s] 55%|█████▍    | 537/981 [00:21<00:17, 25.06it/s] 55%|█████▌    | 540/981 [00:22<00:17, 25.07it/s] 55%|█████▌    | 543/981 [00:22<00:17, 24.77it/s] 56%|█████▌    | 546/981 [00:22<00:17, 24.56it/s] 56%|█████▌    | 549/981 [00:22<00:17, 24.79it/s] 56%|█████▋    | 552/981 [00:22<00:17, 24.85it/s] 57%|█████▋    | 555/981 [00:22<00:17, 24.97it/s] 57%|█████▋    | 558/981 [00:22<00:16, 25.03it/s] 57%|█████▋    | 561/981 [00:22<00:16, 25.00it/s] 57%|█████▋    | 564/981 [00:23<00:16, 25.05it/s] 58%|█████▊    | 567/981 [00:23<00:16, 25.05it/s] 58%|█████▊    | 570/981 [00:23<00:16, 25.12it/s] 58%|█████▊    | 573/981 [00:23<00:16, 24.96it/s] 59%|█████▊    | 576/981 [00:23<00:16, 25.00it/s] 59%|█████▉    | 579/981 [00:23<00:16, 24.96it/s] 59%|█████▉    | 582/981 [00:23<00:15, 25.01it/s] 60%|█████▉    | 585/981 [00:23<00:15, 24.86it/s] 60%|█████▉    | 588/981 [00:24<00:15, 24.88it/s] 60%|██████    | 591/981 [00:24<00:15, 24.96it/s] 61%|██████    | 594/981 [00:24<00:15, 24.90it/s] 61%|██████    | 597/981 [00:24<00:15, 25.02it/s] 61%|██████    | 600/981 [00:24<00:15, 24.63it/s] 61%|██████▏   | 603/981 [00:24<00:15, 24.76it/s] 62%|██████▏   | 606/981 [00:24<00:15, 24.99it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.03it/s] 62%|██████▏   | 612/981 [00:25<00:14, 24.84it/s] 63%|██████▎   | 615/981 [00:25<00:14, 24.91it/s] 63%|██████▎   | 618/981 [00:25<00:14, 25.00it/s] 63%|██████▎   | 621/981 [00:25<00:14, 25.01it/s] 64%|██████▎   | 624/981 [00:25<00:14, 25.06it/s] 64%|██████▍   | 627/981 [00:25<00:14, 25.10it/s] 64%|██████▍   | 630/981 [00:25<00:13, 25.09it/s] 65%|██████▍   | 633/981 [00:25<00:13, 25.11it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.07it/s] 65%|██████▌   | 639/981 [00:26<00:13, 25.14it/s] 65%|██████▌   | 642/981 [00:26<00:13, 25.23it/s] 66%|██████▌   | 645/981 [00:26<00:13, 25.25it/s] 66%|██████▌   | 648/981 [00:26<00:13, 25.28it/s] 66%|██████▋   | 651/981 [00:26<00:13, 25.08it/s] 67%|██████▋   | 654/981 [00:26<00:13, 25.11it/s] 67%|██████▋   | 657/981 [00:26<00:12, 25.12it/s] 67%|██████▋   | 660/981 [00:26<00:12, 25.08it/s] 68%|██████▊   | 663/981 [00:27<00:12, 25.20it/s] 68%|██████▊   | 666/981 [00:27<00:12, 25.11it/s] 68%|██████▊   | 669/981 [00:27<00:12, 25.12it/s] 69%|██████▊   | 672/981 [00:27<00:12, 25.16it/s] 69%|██████▉   | 675/981 [00:27<00:12, 25.37it/s] 69%|██████▉   | 678/981 [00:27<00:11, 25.54it/s] 69%|██████▉   | 681/981 [00:27<00:11, 25.67it/s] 70%|██████▉   | 684/981 [00:27<00:11, 25.67it/s] 70%|███████   | 687/981 [00:27<00:11, 25.49it/s] 70%|███████   | 690/981 [00:28<00:11, 25.55it/s] 71%|███████   | 693/981 [00:28<00:11, 25.55it/s] 71%|███████   | 696/981 [00:28<00:11, 25.62it/s] 71%|███████▏  | 699/981 [00:28<00:10, 25.81it/s] 72%|███████▏  | 702/981 [00:28<00:10, 25.78it/s] 72%|███████▏  | 705/981 [00:28<00:10, 25.80it/s] 72%|███████▏  | 708/981 [00:28<00:10, 25.78it/s] 72%|███████▏  | 711/981 [00:28<00:10, 25.63it/s] 73%|███████▎  | 714/981 [00:29<00:10, 25.73it/s] 73%|███████▎  | 717/981 [00:29<00:10, 25.73it/s] 73%|███████▎  | 720/981 [00:29<00:10, 25.69it/s] 74%|███████▎  | 723/981 [00:29<00:10, 25.48it/s] 74%|███████▍  | 726/981 [00:29<00:10, 25.30it/s] 74%|███████▍  | 729/981 [00:29<00:10, 25.19it/s] 75%|███████▍  | 732/981 [00:29<00:09, 25.15it/s] 75%|███████▍  | 735/981 [00:29<00:09, 24.91it/s] 75%|███████▌  | 738/981 [00:29<00:09, 24.98it/s] 76%|███████▌  | 741/981 [00:30<00:09, 24.95it/s] 76%|███████▌  | 744/981 [00:30<00:09, 24.97it/s] 76%|███████▌  | 747/981 [00:30<00:09, 24.91it/s] 76%|███████▋  | 750/981 [00:30<00:09, 24.95it/s] 77%|███████▋  | 753/981 [00:30<00:09, 25.02it/s] 77%|███████▋  | 756/981 [00:30<00:08, 25.02it/s] 77%|███████▋  | 759/981 [00:30<00:08, 24.94it/s] 78%|███████▊  | 762/981 [00:30<00:08, 24.79it/s] 78%|███████▊  | 765/981 [00:31<00:08, 24.81it/s] 78%|███████▊  | 768/981 [00:31<00:08, 24.90it/s] 79%|███████▊  | 771/981 [00:31<00:08, 24.61it/s] 79%|███████▉  | 774/981 [00:31<00:08, 24.68it/s] 79%|███████▉  | 777/981 [00:31<00:08, 24.65it/s] 80%|███████▉  | 780/981 [00:31<00:08, 24.82it/s] 80%|███████▉  | 783/981 [00:31<00:07, 24.84it/s] 80%|████████  | 786/981 [00:31<00:07, 25.11it/s] 80%|████████  | 789/981 [00:32<00:07, 25.72it/s] 81%|████████  | 792/981 [00:32<00:07, 26.29it/s] 81%|████████  | 795/981 [00:32<00:06, 26.75it/s] 81%|████████▏ | 798/981 [00:32<00:06, 27.23it/s] 82%|████████▏ | 801/981 [00:32<00:06, 27.52it/s] 82%|████████▏ | 804/981 [00:32<00:06, 27.70it/s] 82%|████████▏ | 807/981 [00:32<00:06, 27.92it/s] 83%|████████▎ | 810/981 [00:32<00:06, 28.05it/s] 83%|████████▎ | 813/981 [00:32<00:05, 28.15it/s] 83%|████████▎ | 816/981 [00:32<00:05, 28.26it/s] 83%|████████▎ | 819/981 [00:33<00:05, 28.34it/s] 84%|████████▍ | 822/981 [00:33<00:05, 28.43it/s] 84%|████████▍ | 825/981 [00:33<00:05, 28.49it/s] 84%|████████▍ | 828/981 [00:33<00:05, 28.71it/s] 85%|████████▍ | 831/981 [00:33<00:05, 28.90it/s] 85%|████████▌ | 834/981 [00:33<00:05, 28.96it/s] 85%|████████▌ | 837/981 [00:33<00:05, 28.75it/s] 86%|████████▌ | 840/981 [00:33<00:04, 28.66it/s] 86%|████████▌ | 843/981 [00:33<00:04, 28.14it/s] 86%|████████▌ | 846/981 [00:34<00:04, 28.29it/s] 87%|████████▋ | 849/981 [00:34<00:04, 28.50it/s] 87%|████████▋ | 852/981 [00:34<00:04, 28.53it/s] 87%|████████▋ | 855/981 [00:34<00:04, 28.66it/s] 87%|████████▋ | 858/981 [00:34<00:04, 28.74it/s] 88%|████████▊ | 861/981 [00:34<00:04, 28.71it/s] 88%|████████▊ | 864/981 [00:34<00:04, 28.81it/s] 88%|████████▊ | 867/981 [00:34<00:04, 27.91it/s] 89%|████████▊ | 870/981 [00:34<00:04, 27.55it/s] 89%|████████▉ | 873/981 [00:34<00:03, 27.37it/s] 89%|████████▉ | 876/981 [00:35<00:03, 27.33it/s] 90%|████████▉ | 879/981 [00:35<00:03, 27.30it/s] 90%|████████▉ | 882/981 [00:35<00:03, 27.04it/s] 90%|█████████ | 885/981 [00:35<00:03, 27.03it/s] 91%|█████████ | 888/981 [00:35<00:03, 26.65it/s] 91%|█████████ | 891/981 [00:35<00:03, 26.51it/s] 91%|█████████ | 894/981 [00:35<00:03, 26.49it/s] 91%|█████████▏| 897/981 [00:35<00:03, 26.48it/s] 92%|█████████▏| 900/981 [00:36<00:03, 26.32it/s] 92%|█████████▏| 903/981 [00:36<00:02, 26.62it/s] 92%|█████████▏| 906/981 [00:36<00:02, 27.43it/s] 93%|█████████▎| 909/981 [00:36<00:02, 27.99it/s] 93%|█████████▎| 912/981 [00:36<00:02, 28.30it/s] 93%|█████████▎| 915/981 [00:36<00:02, 28.65it/s] 94%|█████████▎| 918/981 [00:36<00:02, 28.76it/s] 94%|█████████▍| 921/981 [00:36<00:02, 28.70it/s] 94%|█████████▍| 924/981 [00:36<00:01, 28.78it/s] 94%|█████████▍| 927/981 [00:36<00:01, 28.94it/s] 95%|█████████▍| 930/981 [00:37<00:01, 28.93it/s] 95%|█████████▌| 933/981 [00:37<00:01, 28.95it/s] 95%|█████████▌| 936/981 [00:37<00:01, 28.97it/s] 96%|█████████▌| 939/981 [00:37<00:01, 28.94it/s] 96%|█████████▌| 942/981 [00:37<00:01, 28.83it/s] 96%|█████████▋| 945/981 [00:37<00:01, 28.84it/s] 97%|█████████▋| 948/981 [00:37<00:01, 29.01it/s] 97%|█████████▋| 951/981 [00:37<00:01, 28.65it/s] 97%|█████████▋| 954/981 [00:37<00:00, 28.84it/s] 98%|█████████▊| 957/981 [00:37<00:00, 28.95it/s] 98%|█████████▊| 960/981 [00:38<00:00, 28.45it/s] 98%|█████████▊| 963/981 [00:38<00:00, 28.22it/s] 98%|█████████▊| 966/981 [00:38<00:00, 28.50it/s] 99%|█████████▉| 969/981 [00:38<00:00, 28.74it/s] 99%|█████████▉| 972/981 [00:38<00:00, 28.50it/s] 99%|█████████▉| 975/981 [00:38<00:00, 28.68it/s]100%|█████████▉| 978/981 [00:38<00:00, 28.60it/s]100%|██████████| 981/981 [00:38<00:00, 28.72it/s]100%|██████████| 981/981 [00:38<00:00, 25.27it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_Focal_RS
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.082, valid loss : 0.052, train acc : 0.843, valid acc : 0.957, train f1 : 0.843, valid f1 : 0.706
training process:   2%|▏         | 1/50 [04:02<3:18:07, 242.60s/it]Best score increase :0.000 -> 0.706
training process:   4%|▍         | 2/50 [07:14<2:50:24, 213.01s/it]Best score increase :0.706 -> 0.783
training process:   6%|▌         | 3/50 [10:27<2:39:28, 203.58s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 4/50 [13:42<2:33:37, 200.38s/it]Best score increase :0.783 -> 0.896
epoch : 5, train loss : 0.039, valid loss : 0.024, train acc : 0.936, valid acc : 0.931, train f1 : 0.936, valid f1 : 0.645
training process:  10%|█         | 5/50 [17:43<2:41:06, 214.82s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 6/50 [21:01<2:33:20, 209.11s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 7/50 [24:18<2:27:01, 205.15s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 8/50 [27:31<2:21:03, 201.51s/it]EarlyStopping counter : 4 out of 12
epoch : 9, train loss : 0.032, valid loss : 0.020, train acc : 0.950, valid acc : 0.952, train f1 : 0.950, valid f1 : 0.699
training process:  18%|█▊        | 9/50 [31:30<2:25:31, 212.97s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 10/50 [34:42<2:17:43, 206.60s/it]EarlyStopping counter : 6 out of 12
training process:  22%|██▏       | 11/50 [37:57<2:12:03, 203.17s/it]EarlyStopping counter : 7 out of 12
training process:  24%|██▍       | 12/50 [41:10<2:06:44, 200.12s/it]EarlyStopping counter : 8 out of 12
epoch : 13, train loss : 0.028, valid loss : 0.013, train acc : 0.955, valid acc : 0.970, train f1 : 0.955, valid f1 : 0.761
training process:  26%|██▌       | 13/50 [45:09<2:10:30, 211.62s/it]EarlyStopping counter : 9 out of 12
training process:  28%|██▊       | 14/50 [48:23<2:03:52, 206.46s/it]EarlyStopping counter : 10 out of 12
training process:  30%|███       | 15/50 [51:36<1:58:03, 202.37s/it]EarlyStopping counter : 11 out of 12
training process:  30%|███       | 15/50 [54:51<2:07:59, 219.41s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 15, best f1 score : 0.896
training process finished, best loss : 0.011 and best acc : 0.992, best f1 : 0.896, best epoch : 3

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.61      0.86      0.71        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.80      0.92      0.85      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.85, test AUC : 0.92, test loss : 0.294

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:43, 22.46it/s]  1%|          | 6/981 [00:00<00:40, 23.96it/s]  1%|          | 9/981 [00:00<00:39, 24.46it/s]  1%|          | 12/981 [00:00<00:39, 24.81it/s]  2%|▏         | 15/981 [00:00<00:39, 24.34it/s]  2%|▏         | 18/981 [00:00<00:39, 24.22it/s]  2%|▏         | 21/981 [00:00<00:39, 24.59it/s]  2%|▏         | 24/981 [00:00<00:38, 24.76it/s]  3%|▎         | 27/981 [00:01<00:38, 24.88it/s]  3%|▎         | 30/981 [00:01<00:38, 24.98it/s]  3%|▎         | 33/981 [00:01<00:37, 25.03it/s]  4%|▎         | 36/981 [00:01<00:37, 25.04it/s]  4%|▍         | 39/981 [00:01<00:37, 25.12it/s]  4%|▍         | 42/981 [00:01<00:37, 24.99it/s]  5%|▍         | 45/981 [00:01<00:37, 25.04it/s]  5%|▍         | 48/981 [00:01<00:37, 25.01it/s]  5%|▌         | 51/981 [00:02<00:37, 24.97it/s]  6%|▌         | 54/981 [00:02<00:37, 24.90it/s]  6%|▌         | 57/981 [00:02<00:36, 25.01it/s]  6%|▌         | 60/981 [00:02<00:36, 25.10it/s]  6%|▋         | 63/981 [00:02<00:36, 25.16it/s]  7%|▋         | 66/981 [00:02<00:36, 25.23it/s]  7%|▋         | 69/981 [00:02<00:35, 25.37it/s]  7%|▋         | 72/981 [00:02<00:35, 25.38it/s]  8%|▊         | 75/981 [00:03<00:35, 25.34it/s]  8%|▊         | 78/981 [00:03<00:35, 25.20it/s]  8%|▊         | 81/981 [00:03<00:35, 25.28it/s]  9%|▊         | 84/981 [00:03<00:35, 25.29it/s]  9%|▉         | 87/981 [00:03<00:35, 25.07it/s]  9%|▉         | 90/981 [00:03<00:35, 25.14it/s]  9%|▉         | 93/981 [00:03<00:35, 25.04it/s] 10%|▉         | 96/981 [00:03<00:35, 25.08it/s] 10%|█         | 99/981 [00:03<00:35, 25.08it/s] 10%|█         | 102/981 [00:04<00:34, 25.13it/s] 11%|█         | 105/981 [00:04<00:34, 25.06it/s] 11%|█         | 108/981 [00:04<00:34, 25.12it/s] 11%|█▏        | 111/981 [00:04<00:34, 25.01it/s] 12%|█▏        | 114/981 [00:04<00:34, 25.08it/s] 12%|█▏        | 117/981 [00:04<00:34, 24.80it/s] 12%|█▏        | 120/981 [00:04<00:34, 24.80it/s] 13%|█▎        | 123/981 [00:04<00:34, 24.87it/s] 13%|█▎        | 126/981 [00:05<00:34, 25.02it/s] 13%|█▎        | 129/981 [00:05<00:34, 24.93it/s] 13%|█▎        | 132/981 [00:05<00:34, 24.93it/s] 14%|█▍        | 135/981 [00:05<00:33, 25.07it/s] 14%|█▍        | 138/981 [00:05<00:33, 24.99it/s] 14%|█▍        | 141/981 [00:05<00:34, 24.45it/s] 15%|█▍        | 144/981 [00:05<00:33, 24.70it/s] 15%|█▍        | 147/981 [00:05<00:33, 24.80it/s] 15%|█▌        | 150/981 [00:06<00:33, 25.00it/s] 16%|█▌        | 153/981 [00:06<00:33, 24.40it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.49it/s] 16%|█▌        | 159/981 [00:06<00:33, 24.71it/s] 17%|█▋        | 162/981 [00:06<00:32, 24.95it/s] 17%|█▋        | 165/981 [00:06<00:32, 25.09it/s] 17%|█▋        | 168/981 [00:06<00:34, 23.90it/s] 17%|█▋        | 171/981 [00:06<00:33, 24.20it/s] 18%|█▊        | 174/981 [00:06<00:32, 24.54it/s] 18%|█▊        | 177/981 [00:07<00:32, 24.88it/s] 18%|█▊        | 180/981 [00:07<00:31, 25.06it/s] 19%|█▊        | 183/981 [00:07<00:31, 25.16it/s] 19%|█▉        | 186/981 [00:07<00:31, 25.24it/s] 19%|█▉        | 189/981 [00:07<00:31, 25.29it/s] 20%|█▉        | 192/981 [00:07<00:31, 25.36it/s] 20%|█▉        | 195/981 [00:07<00:30, 25.42it/s] 20%|██        | 198/981 [00:07<00:30, 25.43it/s] 20%|██        | 201/981 [00:08<00:30, 25.33it/s] 21%|██        | 204/981 [00:08<00:30, 25.11it/s] 21%|██        | 207/981 [00:08<00:31, 24.83it/s] 21%|██▏       | 210/981 [00:08<00:31, 24.74it/s] 22%|██▏       | 213/981 [00:08<00:31, 24.66it/s] 22%|██▏       | 216/981 [00:08<00:31, 24.62it/s] 22%|██▏       | 219/981 [00:08<00:30, 24.65it/s] 23%|██▎       | 222/981 [00:08<00:30, 24.68it/s] 23%|██▎       | 225/981 [00:09<00:30, 24.67it/s] 23%|██▎       | 228/981 [00:09<00:30, 24.48it/s] 24%|██▎       | 231/981 [00:09<00:30, 24.55it/s] 24%|██▍       | 234/981 [00:09<00:30, 24.63it/s] 24%|██▍       | 237/981 [00:09<00:30, 24.70it/s] 24%|██▍       | 240/981 [00:09<00:29, 24.71it/s] 25%|██▍       | 243/981 [00:09<00:30, 24.50it/s] 25%|██▌       | 246/981 [00:09<00:29, 24.59it/s] 25%|██▌       | 249/981 [00:10<00:29, 24.74it/s] 26%|██▌       | 252/981 [00:10<00:30, 24.29it/s] 26%|██▌       | 255/981 [00:10<00:29, 24.43it/s] 26%|██▋       | 258/981 [00:10<00:29, 24.54it/s] 27%|██▋       | 261/981 [00:10<00:29, 24.62it/s] 27%|██▋       | 264/981 [00:10<00:29, 24.71it/s] 27%|██▋       | 267/981 [00:10<00:28, 24.80it/s] 28%|██▊       | 270/981 [00:10<00:28, 24.75it/s] 28%|██▊       | 273/981 [00:10<00:28, 24.81it/s] 28%|██▊       | 276/981 [00:11<00:28, 24.84it/s] 28%|██▊       | 279/981 [00:11<00:28, 24.89it/s] 29%|██▊       | 282/981 [00:11<00:28, 24.92it/s] 29%|██▉       | 285/981 [00:11<00:27, 24.93it/s] 29%|██▉       | 288/981 [00:11<00:28, 24.71it/s] 30%|██▉       | 291/981 [00:11<00:27, 24.84it/s] 30%|██▉       | 294/981 [00:11<00:27, 24.90it/s] 30%|███       | 297/981 [00:11<00:27, 24.67it/s] 31%|███       | 300/981 [00:12<00:27, 24.78it/s] 31%|███       | 303/981 [00:12<00:27, 24.92it/s] 31%|███       | 306/981 [00:12<00:27, 24.85it/s] 31%|███▏      | 309/981 [00:12<00:27, 24.85it/s] 32%|███▏      | 312/981 [00:12<00:26, 24.90it/s] 32%|███▏      | 315/981 [00:12<00:27, 24.00it/s] 32%|███▏      | 318/981 [00:12<00:27, 24.27it/s] 33%|███▎      | 321/981 [00:12<00:26, 24.49it/s] 33%|███▎      | 324/981 [00:13<00:27, 23.72it/s] 33%|███▎      | 327/981 [00:13<00:27, 24.11it/s] 34%|███▎      | 330/981 [00:13<00:26, 24.33it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.44it/s] 34%|███▍      | 336/981 [00:13<00:26, 24.58it/s] 35%|███▍      | 339/981 [00:13<00:26, 24.29it/s] 35%|███▍      | 342/981 [00:13<00:26, 24.16it/s] 35%|███▌      | 345/981 [00:13<00:27, 23.43it/s] 35%|███▌      | 348/981 [00:14<00:26, 23.85it/s] 36%|███▌      | 351/981 [00:14<00:26, 23.99it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.23it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.46it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.34it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.39it/s] 37%|███▋      | 366/981 [00:14<00:25, 24.58it/s] 38%|███▊      | 369/981 [00:14<00:25, 24.39it/s] 38%|███▊      | 372/981 [00:15<00:24, 24.44it/s] 38%|███▊      | 375/981 [00:15<00:24, 24.40it/s] 39%|███▊      | 378/981 [00:15<00:24, 24.41it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.14it/s] 39%|███▉      | 384/981 [00:15<00:24, 24.30it/s] 39%|███▉      | 387/981 [00:15<00:24, 24.37it/s] 40%|███▉      | 390/981 [00:15<00:24, 24.43it/s] 40%|████      | 393/981 [00:15<00:23, 24.57it/s] 40%|████      | 396/981 [00:16<00:23, 24.60it/s] 41%|████      | 399/981 [00:16<00:23, 24.67it/s] 41%|████      | 402/981 [00:16<00:23, 24.78it/s] 41%|████▏     | 405/981 [00:16<00:23, 24.78it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.78it/s] 42%|████▏     | 411/981 [00:16<00:22, 24.83it/s] 42%|████▏     | 414/981 [00:16<00:22, 24.82it/s] 43%|████▎     | 417/981 [00:16<00:23, 24.19it/s] 43%|████▎     | 420/981 [00:16<00:22, 24.45it/s] 43%|████▎     | 423/981 [00:17<00:22, 24.54it/s] 43%|████▎     | 426/981 [00:17<00:22, 24.44it/s] 44%|████▎     | 429/981 [00:17<00:22, 24.61it/s] 44%|████▍     | 432/981 [00:17<00:22, 24.65it/s] 44%|████▍     | 435/981 [00:17<00:22, 24.76it/s] 45%|████▍     | 438/981 [00:17<00:21, 24.73it/s] 45%|████▍     | 441/981 [00:17<00:21, 24.80it/s] 45%|████▌     | 444/981 [00:17<00:21, 24.74it/s] 46%|████▌     | 447/981 [00:18<00:21, 24.85it/s] 46%|████▌     | 450/981 [00:18<00:21, 24.92it/s] 46%|████▌     | 453/981 [00:18<00:22, 23.98it/s] 46%|████▋     | 456/981 [00:18<00:21, 24.28it/s] 47%|████▋     | 459/981 [00:18<00:21, 24.50it/s] 47%|████▋     | 462/981 [00:18<00:21, 24.48it/s] 47%|████▋     | 465/981 [00:18<00:20, 24.59it/s] 48%|████▊     | 468/981 [00:18<00:20, 24.77it/s] 48%|████▊     | 471/981 [00:19<00:21, 23.84it/s] 48%|████▊     | 474/981 [00:19<00:20, 24.19it/s] 49%|████▊     | 477/981 [00:19<00:20, 24.24it/s] 49%|████▉     | 480/981 [00:19<00:20, 24.42it/s] 49%|████▉     | 483/981 [00:19<00:20, 24.48it/s] 50%|████▉     | 486/981 [00:19<00:20, 24.59it/s] 50%|████▉     | 489/981 [00:19<00:19, 24.64it/s] 50%|█████     | 492/981 [00:19<00:19, 24.74it/s] 50%|█████     | 495/981 [00:20<00:19, 24.88it/s] 51%|█████     | 498/981 [00:20<00:19, 24.74it/s] 51%|█████     | 501/981 [00:20<00:19, 24.89it/s] 51%|█████▏    | 504/981 [00:20<00:19, 25.01it/s] 52%|█████▏    | 507/981 [00:20<00:19, 24.73it/s] 52%|█████▏    | 510/981 [00:20<00:19, 24.67it/s] 52%|█████▏    | 513/981 [00:20<00:18, 24.80it/s] 53%|█████▎    | 516/981 [00:20<00:18, 25.00it/s] 53%|█████▎    | 519/981 [00:21<00:18, 25.18it/s] 53%|█████▎    | 522/981 [00:21<00:18, 25.17it/s] 54%|█████▎    | 525/981 [00:21<00:18, 25.26it/s] 54%|█████▍    | 528/981 [00:21<00:18, 24.27it/s] 54%|█████▍    | 531/981 [00:21<00:19, 23.08it/s] 54%|█████▍    | 534/981 [00:21<00:18, 23.66it/s] 55%|█████▍    | 537/981 [00:21<00:18, 24.21it/s] 55%|█████▌    | 540/981 [00:21<00:17, 24.64it/s] 55%|█████▌    | 543/981 [00:21<00:17, 24.95it/s] 56%|█████▌    | 546/981 [00:22<00:17, 25.18it/s] 56%|█████▌    | 549/981 [00:22<00:17, 25.32it/s] 56%|█████▋    | 552/981 [00:22<00:16, 25.42it/s] 57%|█████▋    | 555/981 [00:22<00:16, 25.58it/s] 57%|█████▋    | 558/981 [00:22<00:16, 25.71it/s] 57%|█████▋    | 561/981 [00:22<00:16, 25.24it/s] 57%|█████▋    | 564/981 [00:22<00:16, 25.45it/s] 58%|█████▊    | 567/981 [00:22<00:16, 25.59it/s] 58%|█████▊    | 570/981 [00:23<00:16, 25.69it/s] 58%|█████▊    | 573/981 [00:23<00:15, 25.71it/s] 59%|█████▊    | 576/981 [00:23<00:15, 25.70it/s] 59%|█████▉    | 579/981 [00:23<00:15, 25.61it/s] 59%|█████▉    | 582/981 [00:23<00:15, 25.68it/s] 60%|█████▉    | 585/981 [00:23<00:15, 25.69it/s] 60%|█████▉    | 588/981 [00:23<00:15, 25.64it/s] 60%|██████    | 591/981 [00:23<00:15, 25.68it/s] 61%|██████    | 594/981 [00:23<00:15, 25.74it/s] 61%|██████    | 597/981 [00:24<00:14, 25.74it/s] 61%|██████    | 600/981 [00:24<00:14, 25.80it/s] 61%|██████▏   | 603/981 [00:24<00:14, 25.61it/s] 62%|██████▏   | 606/981 [00:24<00:14, 25.74it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.79it/s] 62%|██████▏   | 612/981 [00:24<00:14, 25.77it/s] 63%|██████▎   | 615/981 [00:24<00:14, 25.83it/s] 63%|██████▎   | 618/981 [00:24<00:14, 25.85it/s] 63%|██████▎   | 621/981 [00:25<00:13, 25.90it/s] 64%|██████▎   | 624/981 [00:25<00:13, 25.85it/s] 64%|██████▍   | 627/981 [00:25<00:13, 25.84it/s] 64%|██████▍   | 630/981 [00:25<00:13, 25.78it/s] 65%|██████▍   | 633/981 [00:25<00:13, 25.86it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.93it/s] 65%|██████▌   | 639/981 [00:25<00:13, 25.94it/s] 65%|██████▌   | 642/981 [00:25<00:13, 25.85it/s] 66%|██████▌   | 645/981 [00:25<00:12, 25.89it/s] 66%|██████▌   | 648/981 [00:26<00:12, 25.94it/s] 66%|██████▋   | 651/981 [00:26<00:12, 25.84it/s] 67%|██████▋   | 654/981 [00:26<00:12, 25.85it/s] 67%|██████▋   | 657/981 [00:26<00:12, 25.21it/s] 67%|██████▋   | 660/981 [00:26<00:13, 24.52it/s] 68%|██████▊   | 663/981 [00:26<00:12, 24.87it/s] 68%|██████▊   | 666/981 [00:26<00:12, 25.23it/s] 68%|██████▊   | 669/981 [00:26<00:12, 25.40it/s] 69%|██████▊   | 672/981 [00:27<00:12, 25.29it/s] 69%|██████▉   | 675/981 [00:27<00:12, 25.48it/s] 69%|██████▉   | 678/981 [00:27<00:11, 25.54it/s] 69%|██████▉   | 681/981 [00:27<00:11, 25.68it/s] 70%|██████▉   | 684/981 [00:27<00:11, 25.75it/s] 70%|███████   | 687/981 [00:27<00:11, 25.85it/s] 70%|███████   | 690/981 [00:27<00:11, 25.78it/s] 71%|███████   | 693/981 [00:27<00:11, 25.80it/s] 71%|███████   | 696/981 [00:27<00:11, 25.84it/s] 71%|███████▏  | 699/981 [00:28<00:10, 25.78it/s] 72%|███████▏  | 702/981 [00:28<00:10, 25.87it/s] 72%|███████▏  | 705/981 [00:28<00:10, 25.90it/s] 72%|███████▏  | 708/981 [00:28<00:10, 25.81it/s] 72%|███████▏  | 711/981 [00:28<00:10, 25.54it/s] 73%|███████▎  | 714/981 [00:28<00:10, 25.62it/s] 73%|███████▎  | 717/981 [00:28<00:10, 25.41it/s] 73%|███████▎  | 720/981 [00:28<00:10, 25.39it/s] 74%|███████▎  | 723/981 [00:29<00:10, 25.55it/s] 74%|███████▍  | 726/981 [00:29<00:09, 25.55it/s] 74%|███████▍  | 729/981 [00:29<00:09, 25.65it/s] 75%|███████▍  | 732/981 [00:29<00:09, 25.69it/s] 75%|███████▍  | 735/981 [00:29<00:09, 25.73it/s] 75%|███████▌  | 738/981 [00:29<00:09, 25.63it/s] 76%|███████▌  | 741/981 [00:29<00:09, 25.62it/s] 76%|███████▌  | 744/981 [00:29<00:09, 25.65it/s] 76%|███████▌  | 747/981 [00:29<00:09, 25.50it/s] 76%|███████▋  | 750/981 [00:30<00:09, 25.44it/s] 77%|███████▋  | 753/981 [00:30<00:08, 25.47it/s] 77%|███████▋  | 756/981 [00:30<00:08, 25.46it/s] 77%|███████▋  | 759/981 [00:30<00:08, 25.53it/s] 78%|███████▊  | 762/981 [00:30<00:08, 25.57it/s] 78%|███████▊  | 765/981 [00:30<00:08, 25.52it/s] 78%|███████▊  | 768/981 [00:30<00:08, 25.14it/s] 79%|███████▊  | 771/981 [00:30<00:08, 24.19it/s] 79%|███████▉  | 774/981 [00:31<00:08, 23.87it/s] 79%|███████▉  | 777/981 [00:31<00:08, 24.43it/s] 80%|███████▉  | 780/981 [00:31<00:08, 24.84it/s] 80%|███████▉  | 783/981 [00:31<00:07, 25.33it/s] 80%|████████  | 786/981 [00:31<00:07, 25.76it/s] 80%|████████  | 789/981 [00:31<00:07, 26.25it/s] 81%|████████  | 792/981 [00:31<00:07, 26.74it/s] 81%|████████  | 795/981 [00:31<00:06, 27.34it/s] 81%|████████▏ | 798/981 [00:31<00:06, 27.79it/s] 82%|████████▏ | 801/981 [00:32<00:06, 28.20it/s] 82%|████████▏ | 804/981 [00:32<00:06, 28.55it/s] 82%|████████▏ | 807/981 [00:32<00:06, 28.81it/s] 83%|████████▎ | 810/981 [00:32<00:05, 28.97it/s] 83%|████████▎ | 813/981 [00:32<00:05, 29.12it/s] 83%|████████▎ | 816/981 [00:32<00:05, 29.23it/s] 83%|████████▎ | 819/981 [00:32<00:05, 29.24it/s] 84%|████████▍ | 822/981 [00:32<00:05, 29.13it/s] 84%|████████▍ | 825/981 [00:32<00:05, 29.24it/s] 84%|████████▍ | 828/981 [00:32<00:05, 29.20it/s] 85%|████████▍ | 831/981 [00:33<00:05, 29.02it/s] 85%|████████▌ | 834/981 [00:33<00:05, 29.23it/s] 85%|████████▌ | 837/981 [00:33<00:04, 29.33it/s] 86%|████████▌ | 840/981 [00:33<00:04, 29.42it/s] 86%|████████▌ | 843/981 [00:33<00:04, 29.35it/s] 86%|████████▌ | 846/981 [00:33<00:04, 29.37it/s] 87%|████████▋ | 849/981 [00:33<00:04, 29.47it/s] 87%|████████▋ | 852/981 [00:33<00:04, 29.57it/s] 87%|████████▋ | 855/981 [00:33<00:04, 29.55it/s] 87%|████████▋ | 858/981 [00:33<00:04, 29.50it/s] 88%|████████▊ | 861/981 [00:34<00:04, 29.59it/s] 88%|████████▊ | 864/981 [00:34<00:03, 29.56it/s] 88%|████████▊ | 867/981 [00:34<00:03, 29.61it/s] 89%|████████▊ | 870/981 [00:34<00:03, 29.62it/s] 89%|████████▉ | 873/981 [00:34<00:03, 29.60it/s] 89%|████████▉ | 876/981 [00:34<00:03, 29.61it/s] 90%|████████▉ | 879/981 [00:34<00:03, 29.68it/s] 90%|████████▉ | 882/981 [00:34<00:03, 29.65it/s] 90%|█████████ | 885/981 [00:34<00:03, 29.67it/s] 91%|█████████ | 888/981 [00:34<00:03, 29.69it/s] 91%|█████████ | 891/981 [00:35<00:03, 29.75it/s] 91%|█████████ | 894/981 [00:35<00:02, 29.77it/s] 91%|█████████▏| 897/981 [00:35<00:02, 29.70it/s] 92%|█████████▏| 900/981 [00:35<00:02, 29.66it/s] 92%|█████████▏| 903/981 [00:35<00:02, 29.75it/s] 92%|█████████▏| 906/981 [00:35<00:02, 29.80it/s] 93%|█████████▎| 909/981 [00:35<00:02, 29.80it/s] 93%|█████████▎| 912/981 [00:35<00:02, 29.66it/s] 93%|█████████▎| 915/981 [00:35<00:02, 29.59it/s] 94%|█████████▎| 918/981 [00:35<00:02, 29.55it/s] 94%|█████████▍| 921/981 [00:36<00:02, 29.59it/s] 94%|█████████▍| 924/981 [00:36<00:01, 29.59it/s] 94%|█████████▍| 927/981 [00:36<00:01, 29.37it/s] 95%|█████████▍| 930/981 [00:36<00:01, 29.53it/s] 95%|█████████▌| 933/981 [00:36<00:01, 29.56it/s] 95%|█████████▌| 936/981 [00:36<00:01, 29.42it/s] 96%|█████████▌| 939/981 [00:36<00:01, 29.51it/s] 96%|█████████▌| 942/981 [00:36<00:01, 29.31it/s] 96%|█████████▋| 945/981 [00:36<00:01, 29.24it/s] 97%|█████████▋| 948/981 [00:37<00:01, 29.30it/s] 97%|█████████▋| 951/981 [00:37<00:01, 29.46it/s] 97%|█████████▋| 954/981 [00:37<00:00, 29.31it/s] 98%|█████████▊| 957/981 [00:37<00:00, 29.32it/s] 98%|█████████▊| 960/981 [00:37<00:00, 29.39it/s] 98%|█████████▊| 963/981 [00:37<00:00, 29.48it/s] 98%|█████████▊| 966/981 [00:37<00:00, 29.30it/s] 99%|█████████▉| 969/981 [00:37<00:00, 29.30it/s] 99%|█████████▉| 973/981 [00:37<00:00, 29.53it/s] 99%|█████████▉| 976/981 [00:37<00:00, 29.58it/s]100%|█████████▉| 979/981 [00:38<00:00, 29.56it/s]100%|██████████| 981/981 [00:38<00:00, 25.73it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_Focal_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.008, valid loss : 0.006, train acc : 0.976, valid acc : 0.953, train f1 : 0.511, valid f1 : 0.636
training process:   2%|▏         | 1/50 [03:59<3:15:54, 239.89s/it]Best score increase :0.000 -> 0.636
training process:   4%|▍         | 2/50 [07:16<2:51:35, 214.49s/it]Best score increase :0.636 -> 0.813
training process:   6%|▌         | 3/50 [10:33<2:41:35, 206.29s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 4/50 [13:48<2:34:56, 202.10s/it]Best score increase :0.813 -> 0.816
epoch : 5, train loss : 0.006, valid loss : 0.008, train acc : 0.985, valid acc : 0.990, train f1 : 0.761, valid f1 : 0.811
training process:  10%|█         | 5/50 [17:50<2:42:17, 216.40s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 6/50 [21:05<2:33:26, 209.24s/it]Best score increase :0.816 -> 0.823
training process:  14%|█▍        | 7/50 [24:22<2:27:00, 205.13s/it]Best score increase :0.823 -> 0.856
training process:  16%|█▌        | 8/50 [27:39<2:21:40, 202.39s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.004, valid loss : 0.009, train acc : 0.981, valid acc : 0.992, train f1 : 0.777, valid f1 : 0.865
training process:  18%|█▊        | 9/50 [31:39<2:26:18, 214.12s/it]Best score increase :0.856 -> 0.865
training process:  20%|██        | 10/50 [34:55<2:19:09, 208.74s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 11/50 [38:12<2:13:21, 205.17s/it]EarlyStopping counter : 2 out of 12
training process:  24%|██▍       | 12/50 [41:28<2:08:11, 202.41s/it]Best score increase :0.865 -> 0.900
epoch : 13, train loss : 0.003, valid loss : 0.004, train acc : 0.987, valid acc : 0.956, train f1 : 0.833, valid f1 : 0.691
training process:  26%|██▌       | 13/50 [45:33<2:12:37, 215.07s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 14/50 [48:49<2:05:41, 209.49s/it]EarlyStopping counter : 2 out of 12
training process:  30%|███       | 15/50 [52:03<1:59:26, 204.75s/it]EarlyStopping counter : 3 out of 12
training process:  32%|███▏      | 16/50 [55:17<1:54:07, 201.41s/it]EarlyStopping counter : 4 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.004, train acc : 0.990, valid acc : 0.992, train f1 : 0.863, valid f1 : 0.890
training process:  34%|███▍      | 17/50 [59:13<1:56:36, 212.01s/it]EarlyStopping counter : 5 out of 12
training process:  36%|███▌      | 18/50 [1:02:28<1:50:16, 206.76s/it]EarlyStopping counter : 6 out of 12
training process:  38%|███▊      | 19/50 [1:05:42<1:44:49, 202.89s/it]EarlyStopping counter : 7 out of 12
training process:  40%|████      | 20/50 [1:08:56<1:40:06, 200.21s/it]EarlyStopping counter : 8 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.003, train acc : 0.991, valid acc : 0.995, train f1 : 0.873, valid f1 : 0.930
training process:  42%|████▏     | 21/50 [1:12:49<1:41:35, 210.17s/it]Best score increase :0.900 -> 0.930
training process:  44%|████▍     | 22/50 [1:16:02<1:35:41, 205.07s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 23/50 [1:19:14<1:30:33, 201.23s/it]EarlyStopping counter : 2 out of 12
training process:  48%|████▊     | 24/50 [1:22:28<1:26:11, 198.90s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.004, train acc : 0.991, valid acc : 0.973, train f1 : 0.873, valid f1 : 0.754
training process:  50%|█████     | 25/50 [1:26:27<1:27:51, 210.87s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 26/50 [1:29:42<1:22:28, 206.17s/it]EarlyStopping counter : 5 out of 12
training process:  54%|█████▍    | 27/50 [1:33:00<1:18:05, 203.70s/it]EarlyStopping counter : 6 out of 12
training process:  56%|█████▌    | 28/50 [1:36:15<1:13:44, 201.10s/it]EarlyStopping counter : 7 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.005, train acc : 0.993, valid acc : 0.995, train f1 : 0.899, valid f1 : 0.929
training process:  58%|█████▊    | 29/50 [1:40:12<1:14:11, 211.98s/it]EarlyStopping counter : 8 out of 12
training process:  60%|██████    | 30/50 [1:43:26<1:08:52, 206.62s/it]EarlyStopping counter : 9 out of 12
training process:  62%|██████▏   | 31/50 [1:46:39<1:04:04, 202.36s/it]EarlyStopping counter : 10 out of 12
training process:  64%|██████▍   | 32/50 [1:49:50<59:40, 198.90s/it]  EarlyStopping counter : 11 out of 12
epoch : 33, train loss : 0.002, valid loss : 0.004, train acc : 0.994, valid acc : 0.993, train f1 : 0.912, valid f1 : 0.907
training process:  64%|██████▍   | 32/50 [1:53:45<1:03:59, 213.31s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 32, best f1 score : 0.930
training process finished, best loss : 0.003 and best acc : 0.995, best f1 : 0.930, best epoch : 20

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.85      0.71        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.81      0.92      0.85      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.85, test AUC : 0.92, test loss : 0.039

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:42, 23.18it/s]  1%|          | 6/981 [00:00<00:41, 23.64it/s]  1%|          | 9/981 [00:00<00:40, 23.73it/s]  1%|          | 12/981 [00:00<00:40, 23.76it/s]  2%|▏         | 15/981 [00:00<00:40, 23.98it/s]  2%|▏         | 18/981 [00:00<00:39, 24.18it/s]  2%|▏         | 21/981 [00:00<00:39, 24.19it/s]  2%|▏         | 24/981 [00:01<00:39, 24.08it/s]  3%|▎         | 27/981 [00:01<00:39, 24.06it/s]  3%|▎         | 30/981 [00:01<00:39, 24.03it/s]  3%|▎         | 33/981 [00:01<00:39, 23.95it/s]  4%|▎         | 36/981 [00:01<00:41, 23.04it/s]  4%|▍         | 39/981 [00:01<00:41, 22.65it/s]  4%|▍         | 42/981 [00:01<00:42, 22.34it/s]  5%|▍         | 45/981 [00:01<00:41, 22.31it/s]  5%|▍         | 48/981 [00:02<00:43, 21.69it/s]  5%|▌         | 51/981 [00:02<00:52, 17.56it/s]  5%|▌         | 53/981 [00:02<00:59, 15.72it/s]  6%|▌         | 55/981 [00:02<00:57, 16.00it/s]  6%|▌         | 57/981 [00:02<00:57, 16.16it/s]  6%|▌         | 59/981 [00:02<01:03, 14.53it/s]  6%|▌         | 61/981 [00:03<01:09, 13.28it/s]  6%|▋         | 63/981 [00:03<01:09, 13.14it/s]  7%|▋         | 65/981 [00:03<01:12, 12.58it/s]  7%|▋         | 67/981 [00:03<01:10, 12.93it/s]  7%|▋         | 69/981 [00:03<01:05, 13.93it/s]  7%|▋         | 72/981 [00:03<00:54, 16.68it/s]  8%|▊         | 75/981 [00:03<00:48, 18.80it/s]  8%|▊         | 78/981 [00:04<00:44, 20.35it/s]  8%|▊         | 81/981 [00:04<00:41, 21.58it/s]  9%|▊         | 84/981 [00:04<00:40, 22.32it/s]  9%|▉         | 87/981 [00:04<00:39, 22.52it/s]  9%|▉         | 90/981 [00:04<00:38, 22.96it/s]  9%|▉         | 93/981 [00:04<00:38, 22.77it/s] 10%|▉         | 96/981 [00:04<00:38, 23.05it/s] 10%|█         | 99/981 [00:04<00:38, 22.84it/s] 10%|█         | 102/981 [00:05<00:38, 23.05it/s] 11%|█         | 105/981 [00:05<00:37, 23.34it/s] 11%|█         | 108/981 [00:05<00:37, 23.50it/s] 11%|█▏        | 111/981 [00:05<00:36, 23.75it/s] 12%|█▏        | 114/981 [00:05<00:36, 23.76it/s] 12%|█▏        | 117/981 [00:05<00:39, 21.76it/s] 12%|█▏        | 120/981 [00:05<00:47, 17.98it/s] 12%|█▏        | 122/981 [00:06<00:51, 16.57it/s] 13%|█▎        | 124/981 [00:06<00:56, 15.10it/s] 13%|█▎        | 126/981 [00:06<00:59, 14.36it/s] 13%|█▎        | 128/981 [00:06<01:00, 14.01it/s] 13%|█▎        | 130/981 [00:06<01:02, 13.58it/s] 13%|█▎        | 132/981 [00:06<01:04, 13.25it/s] 14%|█▎        | 134/981 [00:07<01:08, 12.29it/s] 14%|█▍        | 136/981 [00:07<01:09, 12.17it/s] 14%|█▍        | 138/981 [00:07<01:02, 13.40it/s] 14%|█▍        | 141/981 [00:07<00:52, 16.04it/s] 15%|█▍        | 144/981 [00:07<00:46, 17.82it/s] 15%|█▍        | 147/981 [00:07<00:42, 19.49it/s] 15%|█▌        | 150/981 [00:07<00:40, 20.63it/s] 16%|█▌        | 153/981 [00:08<00:38, 21.66it/s] 16%|█▌        | 156/981 [00:08<00:36, 22.44it/s] 16%|█▌        | 159/981 [00:08<00:35, 22.99it/s] 17%|█▋        | 162/981 [00:08<00:35, 23.29it/s] 17%|█▋        | 165/981 [00:08<00:35, 22.91it/s] 17%|█▋        | 168/981 [00:08<00:34, 23.31it/s] 17%|█▋        | 171/981 [00:08<00:34, 23.71it/s] 18%|█▊        | 174/981 [00:08<00:33, 23.94it/s] 18%|█▊        | 177/981 [00:09<00:33, 24.13it/s] 18%|█▊        | 180/981 [00:09<00:33, 23.63it/s] 19%|█▊        | 183/981 [00:09<00:33, 23.81it/s] 19%|█▉        | 186/981 [00:09<00:33, 23.97it/s] 19%|█▉        | 189/981 [00:09<00:32, 24.06it/s] 20%|█▉        | 192/981 [00:09<00:32, 23.99it/s] 20%|█▉        | 195/981 [00:09<00:32, 24.04it/s] 20%|██        | 198/981 [00:09<00:32, 23.91it/s] 20%|██        | 201/981 [00:10<00:32, 23.67it/s] 21%|██        | 204/981 [00:10<00:32, 23.63it/s] 21%|██        | 207/981 [00:10<00:32, 23.61it/s] 21%|██▏       | 210/981 [00:10<00:32, 23.61it/s] 22%|██▏       | 213/981 [00:10<00:32, 23.51it/s] 22%|██▏       | 216/981 [00:10<00:32, 23.46it/s] 22%|██▏       | 219/981 [00:10<00:32, 23.36it/s] 23%|██▎       | 222/981 [00:10<00:32, 23.32it/s] 23%|██▎       | 225/981 [00:11<00:32, 23.24it/s] 23%|██▎       | 228/981 [00:11<00:32, 23.25it/s] 24%|██▎       | 231/981 [00:11<00:32, 23.34it/s] 24%|██▍       | 234/981 [00:11<00:31, 23.50it/s] 24%|██▍       | 237/981 [00:11<00:31, 23.64it/s] 24%|██▍       | 240/981 [00:11<00:31, 23.75it/s] 25%|██▍       | 243/981 [00:11<00:30, 23.88it/s] 25%|██▌       | 246/981 [00:11<00:30, 23.88it/s] 25%|██▌       | 249/981 [00:12<00:30, 23.88it/s] 26%|██▌       | 252/981 [00:12<00:30, 23.74it/s] 26%|██▌       | 255/981 [00:12<00:30, 23.65it/s] 26%|██▋       | 258/981 [00:12<00:30, 23.34it/s] 27%|██▋       | 261/981 [00:12<00:30, 23.57it/s] 27%|██▋       | 264/981 [00:12<00:30, 23.74it/s] 27%|██▋       | 267/981 [00:12<00:30, 23.77it/s] 28%|██▊       | 270/981 [00:12<00:29, 23.93it/s] 28%|██▊       | 273/981 [00:13<00:29, 24.10it/s] 28%|██▊       | 276/981 [00:13<00:29, 24.19it/s] 28%|██▊       | 279/981 [00:13<00:28, 24.28it/s] 29%|██▊       | 282/981 [00:13<00:29, 24.08it/s] 29%|██▉       | 285/981 [00:13<00:29, 23.90it/s] 29%|██▉       | 288/981 [00:13<00:28, 23.96it/s] 30%|██▉       | 291/981 [00:13<00:29, 23.61it/s] 30%|██▉       | 294/981 [00:13<00:28, 23.80it/s] 30%|███       | 297/981 [00:14<00:28, 23.85it/s] 31%|███       | 300/981 [00:14<00:28, 23.80it/s] 31%|███       | 303/981 [00:14<00:28, 23.84it/s] 31%|███       | 306/981 [00:14<00:28, 23.91it/s] 31%|███▏      | 309/981 [00:14<00:28, 23.88it/s] 32%|███▏      | 312/981 [00:14<00:28, 23.84it/s] 32%|███▏      | 315/981 [00:14<00:28, 23.68it/s] 32%|███▏      | 318/981 [00:14<00:28, 23.66it/s] 33%|███▎      | 321/981 [00:15<00:27, 23.70it/s] 33%|███▎      | 324/981 [00:15<00:27, 23.83it/s] 33%|███▎      | 327/981 [00:15<00:27, 23.81it/s] 34%|███▎      | 330/981 [00:15<00:27, 23.85it/s] 34%|███▍      | 333/981 [00:15<00:27, 23.82it/s] 34%|███▍      | 336/981 [00:15<00:27, 23.80it/s] 35%|███▍      | 339/981 [00:15<00:27, 23.71it/s] 35%|███▍      | 342/981 [00:16<00:27, 22.82it/s] 35%|███▌      | 345/981 [00:16<00:28, 22.33it/s] 35%|███▌      | 348/981 [00:16<00:28, 22.02it/s] 36%|███▌      | 351/981 [00:16<00:28, 21.85it/s] 36%|███▌      | 354/981 [00:16<00:28, 21.75it/s] 36%|███▋      | 357/981 [00:16<00:27, 22.40it/s] 37%|███▋      | 360/981 [00:16<00:27, 22.92it/s] 37%|███▋      | 363/981 [00:16<00:26, 22.89it/s] 37%|███▋      | 366/981 [00:17<00:26, 23.15it/s] 38%|███▊      | 369/981 [00:17<00:26, 23.33it/s] 38%|███▊      | 372/981 [00:17<00:25, 23.51it/s] 38%|███▊      | 375/981 [00:17<00:25, 23.51it/s] 39%|███▊      | 378/981 [00:17<00:25, 23.57it/s] 39%|███▉      | 381/981 [00:17<00:25, 23.50it/s] 39%|███▉      | 384/981 [00:17<00:25, 23.45it/s] 39%|███▉      | 387/981 [00:17<00:25, 23.55it/s] 40%|███▉      | 390/981 [00:18<00:25, 23.54it/s] 40%|████      | 393/981 [00:18<00:24, 23.65it/s] 40%|████      | 396/981 [00:18<00:24, 23.77it/s] 41%|████      | 399/981 [00:18<00:24, 23.73it/s] 41%|████      | 402/981 [00:18<00:24, 23.46it/s] 41%|████▏     | 405/981 [00:18<00:24, 23.51it/s] 42%|████▏     | 408/981 [00:18<00:24, 23.28it/s] 42%|████▏     | 411/981 [00:18<00:24, 23.18it/s] 42%|████▏     | 414/981 [00:19<00:24, 23.01it/s] 43%|████▎     | 417/981 [00:19<00:24, 22.93it/s] 43%|████▎     | 420/981 [00:19<00:24, 23.24it/s] 43%|████▎     | 423/981 [00:19<00:23, 23.42it/s] 43%|████▎     | 426/981 [00:19<00:23, 23.63it/s] 44%|████▎     | 429/981 [00:19<00:23, 23.86it/s] 44%|████▍     | 432/981 [00:19<00:22, 23.97it/s] 44%|████▍     | 435/981 [00:20<00:23, 23.70it/s] 45%|████▍     | 438/981 [00:20<00:22, 23.76it/s] 45%|████▍     | 441/981 [00:20<00:22, 23.65it/s] 45%|████▌     | 444/981 [00:20<00:22, 23.47it/s] 46%|████▌     | 447/981 [00:20<00:22, 23.55it/s] 46%|████▌     | 450/981 [00:20<00:22, 23.31it/s] 46%|████▌     | 453/981 [00:20<00:22, 23.27it/s] 46%|████▋     | 456/981 [00:20<00:22, 23.49it/s] 47%|████▋     | 459/981 [00:21<00:22, 23.53it/s] 47%|████▋     | 462/981 [00:21<00:21, 23.80it/s] 47%|████▋     | 465/981 [00:21<00:21, 23.79it/s] 48%|████▊     | 468/981 [00:21<00:21, 23.90it/s] 48%|████▊     | 471/981 [00:21<00:21, 23.93it/s] 48%|████▊     | 474/981 [00:21<00:21, 23.66it/s] 49%|████▊     | 477/981 [00:21<00:21, 23.81it/s] 49%|████▉     | 480/981 [00:21<00:20, 23.86it/s] 49%|████▉     | 483/981 [00:22<00:20, 23.85it/s] 50%|████▉     | 486/981 [00:22<00:20, 23.75it/s] 50%|████▉     | 489/981 [00:22<00:20, 23.85it/s] 50%|█████     | 492/981 [00:22<00:20, 23.95it/s] 50%|█████     | 495/981 [00:22<00:20, 24.22it/s] 51%|█████     | 498/981 [00:22<00:20, 24.07it/s] 51%|█████     | 501/981 [00:22<00:20, 24.00it/s] 51%|█████▏    | 504/981 [00:22<00:19, 24.07it/s] 52%|█████▏    | 507/981 [00:23<00:19, 23.75it/s] 52%|█████▏    | 510/981 [00:23<00:20, 22.81it/s] 52%|█████▏    | 513/981 [00:23<00:21, 22.16it/s] 53%|█████▎    | 516/981 [00:23<00:20, 22.19it/s] 53%|█████▎    | 519/981 [00:23<00:20, 22.11it/s] 53%|█████▎    | 522/981 [00:23<00:20, 21.96it/s] 54%|█████▎    | 525/981 [00:23<00:20, 22.75it/s] 54%|█████▍    | 528/981 [00:23<00:19, 23.54it/s] 54%|█████▍    | 531/981 [00:24<00:18, 23.96it/s] 54%|█████▍    | 534/981 [00:24<00:18, 24.27it/s] 55%|█████▍    | 537/981 [00:24<00:18, 24.15it/s] 55%|█████▌    | 540/981 [00:24<00:18, 24.27it/s] 55%|█████▌    | 543/981 [00:24<00:17, 24.39it/s] 56%|█████▌    | 546/981 [00:24<00:17, 24.54it/s] 56%|█████▌    | 549/981 [00:24<00:17, 24.27it/s] 56%|█████▋    | 552/981 [00:24<00:17, 24.43it/s] 57%|█████▋    | 555/981 [00:25<00:17, 24.61it/s] 57%|█████▋    | 558/981 [00:25<00:17, 24.34it/s] 57%|█████▋    | 561/981 [00:25<00:17, 24.49it/s] 57%|█████▋    | 564/981 [00:25<00:16, 24.69it/s] 58%|█████▊    | 567/981 [00:25<00:16, 24.73it/s] 58%|█████▊    | 570/981 [00:25<00:16, 24.58it/s] 58%|█████▊    | 573/981 [00:25<00:16, 24.68it/s] 59%|█████▊    | 576/981 [00:25<00:16, 24.73it/s] 59%|█████▉    | 579/981 [00:26<00:16, 24.78it/s] 59%|█████▉    | 582/981 [00:26<00:16, 24.54it/s] 60%|█████▉    | 585/981 [00:26<00:16, 24.57it/s] 60%|█████▉    | 588/981 [00:26<00:15, 24.72it/s] 60%|██████    | 591/981 [00:26<00:15, 24.74it/s] 61%|██████    | 594/981 [00:26<00:15, 24.65it/s] 61%|██████    | 597/981 [00:26<00:15, 24.66it/s] 61%|██████    | 600/981 [00:26<00:15, 24.78it/s] 61%|██████▏   | 603/981 [00:27<00:15, 24.78it/s] 62%|██████▏   | 606/981 [00:27<00:15, 24.33it/s] 62%|██████▏   | 609/981 [00:27<00:15, 24.60it/s] 62%|██████▏   | 612/981 [00:27<00:14, 24.75it/s] 63%|██████▎   | 615/981 [00:27<00:14, 24.49it/s] 63%|██████▎   | 618/981 [00:27<00:15, 24.19it/s] 63%|██████▎   | 621/981 [00:27<00:15, 23.87it/s] 64%|██████▎   | 624/981 [00:27<00:14, 24.30it/s] 64%|██████▍   | 627/981 [00:28<00:14, 24.55it/s] 64%|██████▍   | 630/981 [00:28<00:14, 24.42it/s] 65%|██████▍   | 633/981 [00:28<00:14, 24.58it/s] 65%|██████▍   | 636/981 [00:28<00:14, 24.62it/s] 65%|██████▌   | 639/981 [00:28<00:13, 24.51it/s] 65%|██████▌   | 642/981 [00:28<00:13, 24.67it/s] 66%|██████▌   | 645/981 [00:28<00:13, 24.93it/s] 66%|██████▌   | 648/981 [00:28<00:13, 24.79it/s] 66%|██████▋   | 651/981 [00:28<00:13, 24.52it/s] 67%|██████▋   | 654/981 [00:29<00:13, 24.62it/s] 67%|██████▋   | 657/981 [00:29<00:13, 24.69it/s] 67%|██████▋   | 660/981 [00:29<00:12, 24.74it/s] 68%|██████▊   | 663/981 [00:29<00:13, 24.32it/s] 68%|██████▊   | 666/981 [00:29<00:12, 24.38it/s] 68%|██████▊   | 669/981 [00:29<00:12, 24.59it/s] 69%|██████▊   | 672/981 [00:29<00:12, 24.78it/s] 69%|██████▉   | 675/981 [00:29<00:12, 25.00it/s] 69%|██████▉   | 678/981 [00:30<00:12, 24.97it/s] 69%|██████▉   | 681/981 [00:30<00:11, 25.06it/s] 70%|██████▉   | 684/981 [00:30<00:11, 25.10it/s] 70%|███████   | 687/981 [00:30<00:11, 24.96it/s] 70%|███████   | 690/981 [00:30<00:11, 24.79it/s] 71%|███████   | 693/981 [00:30<00:11, 24.88it/s] 71%|███████   | 696/981 [00:30<00:11, 24.81it/s] 71%|███████▏  | 699/981 [00:30<00:11, 24.88it/s] 72%|███████▏  | 702/981 [00:31<00:11, 24.98it/s] 72%|███████▏  | 705/981 [00:31<00:11, 24.90it/s] 72%|███████▏  | 708/981 [00:31<00:11, 24.81it/s] 72%|███████▏  | 711/981 [00:31<00:10, 24.87it/s] 73%|███████▎  | 714/981 [00:31<00:10, 24.79it/s] 73%|███████▎  | 717/981 [00:31<00:10, 24.72it/s] 73%|███████▎  | 720/981 [00:31<00:10, 24.79it/s] 74%|███████▎  | 723/981 [00:31<00:10, 24.71it/s] 74%|███████▍  | 726/981 [00:32<00:10, 24.72it/s] 74%|███████▍  | 729/981 [00:32<00:10, 24.52it/s] 75%|███████▍  | 732/981 [00:32<00:10, 24.69it/s] 75%|███████▍  | 735/981 [00:32<00:09, 24.71it/s] 75%|███████▌  | 738/981 [00:32<00:10, 24.14it/s] 76%|███████▌  | 741/981 [00:32<00:09, 24.14it/s] 76%|███████▌  | 744/981 [00:32<00:09, 23.94it/s] 76%|███████▌  | 747/981 [00:32<00:09, 24.12it/s] 76%|███████▋  | 750/981 [00:33<00:09, 23.90it/s] 77%|███████▋  | 753/981 [00:33<00:09, 24.02it/s] 77%|███████▋  | 756/981 [00:33<00:09, 23.79it/s] 77%|███████▋  | 759/981 [00:33<00:09, 24.06it/s] 78%|███████▊  | 762/981 [00:33<00:09, 24.00it/s] 78%|███████▊  | 765/981 [00:33<00:08, 24.27it/s] 78%|███████▊  | 768/981 [00:33<00:08, 24.29it/s] 79%|███████▊  | 771/981 [00:33<00:08, 24.47it/s] 79%|███████▉  | 774/981 [00:33<00:08, 24.64it/s] 79%|███████▉  | 777/981 [00:34<00:08, 24.70it/s] 80%|███████▉  | 780/981 [00:34<00:08, 24.93it/s] 80%|███████▉  | 783/981 [00:34<00:07, 25.16it/s] 80%|████████  | 786/981 [00:34<00:07, 25.50it/s] 80%|████████  | 789/981 [00:34<00:07, 25.96it/s] 81%|████████  | 792/981 [00:34<00:07, 26.41it/s] 81%|████████  | 795/981 [00:34<00:06, 26.84it/s] 81%|████████▏ | 798/981 [00:34<00:06, 26.99it/s] 82%|████████▏ | 801/981 [00:35<00:06, 27.21it/s] 82%|████████▏ | 804/981 [00:35<00:06, 27.58it/s] 82%|████████▏ | 807/981 [00:35<00:06, 27.87it/s] 83%|████████▎ | 810/981 [00:35<00:06, 28.04it/s] 83%|████████▎ | 813/981 [00:35<00:05, 28.20it/s] 83%|████████▎ | 816/981 [00:35<00:05, 28.33it/s] 83%|████████▎ | 819/981 [00:35<00:05, 28.44it/s] 84%|████████▍ | 822/981 [00:35<00:05, 28.48it/s] 84%|████████▍ | 825/981 [00:35<00:05, 28.56it/s] 84%|████████▍ | 828/981 [00:35<00:05, 28.58it/s] 85%|████████▍ | 831/981 [00:36<00:05, 28.56it/s] 85%|████████▌ | 834/981 [00:36<00:05, 28.33it/s] 85%|████████▌ | 837/981 [00:36<00:05, 28.37it/s] 86%|████████▌ | 840/981 [00:36<00:04, 28.32it/s] 86%|████████▌ | 843/981 [00:36<00:04, 28.24it/s] 86%|████████▌ | 846/981 [00:36<00:04, 28.32it/s] 87%|████████▋ | 849/981 [00:36<00:04, 28.42it/s] 87%|████████▋ | 852/981 [00:36<00:04, 28.48it/s] 87%|████████▋ | 855/981 [00:36<00:04, 28.64it/s] 87%|████████▋ | 858/981 [00:37<00:04, 28.67it/s] 88%|████████▊ | 861/981 [00:37<00:04, 28.73it/s] 88%|████████▊ | 864/981 [00:37<00:04, 28.83it/s] 88%|████████▊ | 867/981 [00:37<00:03, 28.81it/s] 89%|████████▊ | 870/981 [00:37<00:03, 28.79it/s] 89%|████████▉ | 873/981 [00:37<00:03, 27.78it/s] 89%|████████▉ | 876/981 [00:37<00:03, 27.02it/s] 90%|████████▉ | 879/981 [00:37<00:03, 26.93it/s] 90%|████████▉ | 882/981 [00:37<00:03, 27.01it/s] 90%|█████████ | 885/981 [00:37<00:03, 26.73it/s] 91%|█████████ | 888/981 [00:38<00:03, 27.30it/s] 91%|█████████ | 891/981 [00:38<00:03, 27.95it/s] 91%|█████████ | 894/981 [00:38<00:03, 28.48it/s] 91%|█████████▏| 897/981 [00:38<00:02, 28.80it/s] 92%|█████████▏| 900/981 [00:38<00:02, 28.87it/s] 92%|█████████▏| 903/981 [00:38<00:02, 28.92it/s] 92%|█████████▏| 906/981 [00:38<00:02, 28.73it/s] 93%|█████████▎| 909/981 [00:38<00:02, 28.74it/s] 93%|█████████▎| 912/981 [00:38<00:02, 28.80it/s] 93%|█████████▎| 915/981 [00:39<00:02, 28.76it/s] 94%|█████████▎| 918/981 [00:39<00:02, 28.77it/s] 94%|█████████▍| 921/981 [00:39<00:02, 28.74it/s] 94%|█████████▍| 924/981 [00:39<00:01, 28.71it/s] 94%|█████████▍| 927/981 [00:39<00:01, 28.85it/s] 95%|█████████▍| 930/981 [00:39<00:01, 28.76it/s] 95%|█████████▌| 933/981 [00:39<00:01, 28.77it/s] 95%|█████████▌| 936/981 [00:39<00:01, 28.80it/s] 96%|█████████▌| 939/981 [00:39<00:01, 28.89it/s] 96%|█████████▌| 942/981 [00:39<00:01, 28.79it/s] 96%|█████████▋| 945/981 [00:40<00:01, 28.20it/s] 97%|█████████▋| 948/981 [00:40<00:01, 28.17it/s] 97%|█████████▋| 951/981 [00:40<00:01, 28.33it/s] 97%|█████████▋| 954/981 [00:40<00:00, 28.45it/s] 98%|█████████▊| 957/981 [00:40<00:00, 28.36it/s] 98%|█████████▊| 960/981 [00:40<00:00, 28.35it/s] 98%|█████████▊| 963/981 [00:40<00:00, 28.21it/s] 98%|█████████▊| 966/981 [00:40<00:00, 28.03it/s] 99%|█████████▉| 969/981 [00:40<00:00, 28.11it/s] 99%|█████████▉| 972/981 [00:41<00:00, 28.08it/s] 99%|█████████▉| 975/981 [00:41<00:00, 28.36it/s]100%|█████████▉| 978/981 [00:41<00:00, 28.42it/s]100%|██████████| 981/981 [00:41<00:00, 28.28it/s]100%|██████████| 981/981 [00:41<00:00, 23.73it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_Focal_RS_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.009, valid loss : 0.003, train acc : 0.751, valid acc : 0.835, train f1 : 0.736, valid f1 : 0.545
training process:   2%|▏         | 1/50 [04:10<3:24:16, 250.13s/it]Best score increase :0.000 -> 0.545
training process:   4%|▍         | 2/50 [07:37<2:59:47, 224.75s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▌         | 3/50 [11:13<2:53:11, 221.09s/it]Best score increase :0.545 -> 0.584
training process:   8%|▊         | 4/50 [15:18<2:56:32, 230.28s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.915, valid acc : 0.865, train f1 : 0.915, valid f1 : 0.568
training process:  10%|█         | 5/50 [19:50<3:04:11, 245.58s/it]EarlyStopping counter : 2 out of 12
training process:  12%|█▏        | 6/50 [23:08<2:48:02, 229.15s/it]Best score increase :0.584 -> 0.589
training process:  14%|█▍        | 7/50 [26:22<2:35:57, 217.62s/it]Best score increase :0.589 -> 0.614
training process:  16%|█▌        | 8/50 [29:39<2:27:54, 211.30s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.003, valid loss : 0.003, train acc : 0.924, valid acc : 0.889, train f1 : 0.924, valid f1 : 0.591
training process:  18%|█▊        | 9/50 [33:40<2:30:45, 220.62s/it]EarlyStopping counter : 2 out of 12
training process:  20%|██        | 10/50 [36:52<2:21:06, 211.67s/it]EarlyStopping counter : 3 out of 12
training process:  22%|██▏       | 11/50 [40:01<2:12:59, 204.61s/it]Best score increase :0.614 -> 0.618
training process:  24%|██▍       | 12/50 [43:15<2:07:31, 201.37s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.003, valid loss : 0.004, train acc : 0.936, valid acc : 0.895, train f1 : 0.936, valid f1 : 0.596
training process:  26%|██▌       | 13/50 [47:13<2:11:01, 212.48s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 14/50 [50:29<2:04:33, 207.60s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 15/50 [53:45<1:59:07, 204.22s/it]Best score increase :0.618 -> 0.647
training process:  32%|███▏      | 16/50 [57:00<1:54:08, 201.43s/it]Best score increase :0.647 -> 0.668
epoch : 17, train loss : 0.003, valid loss : 0.003, train acc : 0.938, valid acc : 0.934, train f1 : 0.937, valid f1 : 0.649
training process:  34%|███▍      | 17/50 [1:01:02<1:57:23, 213.43s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 18/50 [1:04:20<1:51:20, 208.76s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 19/50 [1:07:34<1:45:35, 204.37s/it]EarlyStopping counter : 3 out of 12
training process:  40%|████      | 20/50 [1:10:45<1:40:13, 200.44s/it]EarlyStopping counter : 4 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.005, train acc : 0.947, valid acc : 0.900, train f1 : 0.947, valid f1 : 0.600
training process:  42%|████▏     | 21/50 [1:14:46<1:42:45, 212.59s/it]EarlyStopping counter : 5 out of 12
training process:  44%|████▍     | 22/50 [1:17:59<1:36:26, 206.65s/it]EarlyStopping counter : 6 out of 12
training process:  46%|████▌     | 23/50 [1:21:11<1:31:00, 202.25s/it]EarlyStopping counter : 7 out of 12
training process:  48%|████▊     | 24/50 [1:24:24<1:26:29, 199.61s/it]EarlyStopping counter : 8 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.004, train acc : 0.951, valid acc : 0.933, train f1 : 0.951, valid f1 : 0.648
training process:  50%|█████     | 25/50 [1:28:24<1:28:09, 211.57s/it]EarlyStopping counter : 9 out of 12
training process:  52%|█████▏    | 26/50 [1:31:40<1:22:44, 206.87s/it]EarlyStopping counter : 10 out of 12
training process:  54%|█████▍    | 27/50 [1:34:52<1:17:36, 202.44s/it]EarlyStopping counter : 11 out of 12
training process:  54%|█████▍    | 27/50 [1:38:07<1:23:35, 218.06s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 27, best f1 score : 0.668
training process finished, best loss : 0.002 and best acc : 0.939, best f1 : 0.668, best epoch : 15

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.20      0.94      0.34        71
           1       1.00      0.93      0.96      3812

    accuracy                           0.93      3883
   macro avg       0.60      0.94      0.65      3883
weighted avg       0.98      0.93      0.95      3883


# test acc : 0.93, test f1 : 0.65, test AUC : 0.94, test loss : 0.035

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:43, 22.48it/s]  1%|          | 6/981 [00:00<00:42, 22.77it/s]  1%|          | 9/981 [00:00<00:42, 22.89it/s]  1%|          | 12/981 [00:00<00:42, 22.94it/s]  2%|▏         | 15/981 [00:00<00:42, 22.91it/s]  2%|▏         | 18/981 [00:00<00:41, 23.02it/s]  2%|▏         | 21/981 [00:00<00:41, 23.12it/s]  2%|▏         | 24/981 [00:01<00:41, 23.17it/s]  3%|▎         | 27/981 [00:01<00:41, 23.23it/s]  3%|▎         | 30/981 [00:01<00:40, 23.53it/s]  3%|▎         | 33/981 [00:01<00:39, 23.80it/s]  4%|▎         | 36/981 [00:01<00:39, 23.93it/s]  4%|▍         | 39/981 [00:01<00:39, 23.69it/s]  4%|▍         | 42/981 [00:01<00:39, 23.60it/s]  5%|▍         | 45/981 [00:01<00:39, 23.52it/s]  5%|▍         | 48/981 [00:02<00:39, 23.44it/s]  5%|▌         | 51/981 [00:02<00:39, 23.41it/s]  6%|▌         | 54/981 [00:02<00:40, 22.99it/s]  6%|▌         | 57/981 [00:02<00:40, 22.92it/s]  6%|▌         | 60/981 [00:02<00:39, 23.09it/s]  6%|▋         | 63/981 [00:02<00:39, 23.32it/s]  7%|▋         | 66/981 [00:02<00:38, 23.52it/s]  7%|▋         | 69/981 [00:02<00:38, 23.48it/s]  7%|▋         | 72/981 [00:03<00:39, 23.10it/s]  8%|▊         | 75/981 [00:03<00:39, 23.17it/s]  8%|▊         | 78/981 [00:03<00:38, 23.26it/s]  8%|▊         | 81/981 [00:03<00:38, 23.23it/s]  9%|▊         | 84/981 [00:03<00:38, 23.04it/s]  9%|▉         | 87/981 [00:03<00:38, 23.15it/s]  9%|▉         | 90/981 [00:03<00:38, 23.06it/s]  9%|▉         | 93/981 [00:04<00:38, 23.16it/s] 10%|▉         | 96/981 [00:04<00:37, 23.50it/s] 10%|█         | 99/981 [00:04<00:37, 23.66it/s] 10%|█         | 102/981 [00:04<00:37, 23.46it/s] 11%|█         | 105/981 [00:04<00:37, 23.35it/s] 11%|█         | 108/981 [00:04<00:37, 23.11it/s] 11%|█▏        | 111/981 [00:04<00:37, 23.13it/s] 12%|█▏        | 114/981 [00:04<00:37, 23.09it/s] 12%|█▏        | 117/981 [00:05<00:37, 23.22it/s] 12%|█▏        | 120/981 [00:05<00:36, 23.30it/s] 13%|█▎        | 123/981 [00:05<00:36, 23.25it/s] 13%|█▎        | 126/981 [00:05<00:36, 23.34it/s] 13%|█▎        | 129/981 [00:05<00:36, 23.43it/s] 13%|█▎        | 132/981 [00:05<00:35, 23.74it/s] 14%|█▍        | 135/981 [00:05<00:35, 23.50it/s] 14%|█▍        | 138/981 [00:05<00:36, 23.39it/s] 14%|█▍        | 141/981 [00:06<00:36, 23.25it/s] 15%|█▍        | 144/981 [00:06<00:36, 23.23it/s] 15%|█▍        | 147/981 [00:06<00:36, 23.02it/s] 15%|█▌        | 150/981 [00:06<00:35, 23.12it/s] 16%|█▌        | 153/981 [00:06<00:35, 23.15it/s] 16%|█▌        | 156/981 [00:06<00:35, 23.19it/s] 16%|█▌        | 159/981 [00:06<00:34, 23.50it/s] 17%|█▋        | 162/981 [00:06<00:34, 23.76it/s] 17%|█▋        | 165/981 [00:07<00:34, 23.64it/s] 17%|█▋        | 168/981 [00:07<00:34, 23.45it/s] 17%|█▋        | 171/981 [00:07<00:34, 23.57it/s] 18%|█▊        | 174/981 [00:07<00:33, 23.82it/s] 18%|█▊        | 177/981 [00:07<00:33, 23.76it/s] 18%|█▊        | 180/981 [00:07<00:33, 23.87it/s] 19%|█▊        | 183/981 [00:07<00:33, 23.91it/s] 19%|█▉        | 186/981 [00:07<00:33, 24.03it/s] 19%|█▉        | 189/981 [00:08<00:32, 24.01it/s] 20%|█▉        | 192/981 [00:08<00:32, 24.00it/s] 20%|█▉        | 195/981 [00:08<00:32, 24.08it/s] 20%|██        | 198/981 [00:08<00:32, 24.14it/s] 20%|██        | 201/981 [00:08<00:32, 24.16it/s] 21%|██        | 204/981 [00:08<00:32, 23.76it/s] 21%|██        | 207/981 [00:08<00:32, 23.78it/s] 21%|██▏       | 210/981 [00:08<00:32, 23.67it/s] 22%|██▏       | 213/981 [00:09<00:32, 23.42it/s] 22%|██▏       | 216/981 [00:09<00:32, 23.29it/s] 22%|██▏       | 219/981 [00:09<00:32, 23.10it/s] 23%|██▎       | 222/981 [00:09<00:33, 22.83it/s] 23%|██▎       | 225/981 [00:09<00:32, 22.93it/s] 23%|██▎       | 228/981 [00:09<00:32, 23.22it/s] 24%|██▎       | 231/981 [00:09<00:32, 23.40it/s] 24%|██▍       | 234/981 [00:10<00:32, 23.24it/s] 24%|██▍       | 237/981 [00:10<00:32, 23.17it/s] 24%|██▍       | 240/981 [00:10<00:32, 23.08it/s] 25%|██▍       | 243/981 [00:10<00:31, 23.08it/s] 25%|██▌       | 246/981 [00:10<00:31, 23.06it/s] 25%|██▌       | 249/981 [00:10<00:31, 23.06it/s] 26%|██▌       | 252/981 [00:10<00:31, 23.07it/s] 26%|██▌       | 255/981 [00:10<00:31, 23.10it/s] 26%|██▋       | 258/981 [00:11<00:31, 23.30it/s] 27%|██▋       | 261/981 [00:11<00:30, 23.40it/s] 27%|██▋       | 264/981 [00:11<00:30, 23.67it/s] 27%|██▋       | 267/981 [00:11<00:29, 23.81it/s] 28%|██▊       | 270/981 [00:11<00:29, 23.99it/s] 28%|██▊       | 273/981 [00:11<00:29, 24.12it/s] 28%|██▊       | 276/981 [00:11<00:28, 24.65it/s] 28%|██▊       | 279/981 [00:11<00:27, 25.12it/s] 29%|██▊       | 282/981 [00:12<00:27, 25.44it/s] 29%|██▉       | 285/981 [00:12<00:26, 25.80it/s] 29%|██▉       | 288/981 [00:12<00:26, 25.99it/s] 30%|██▉       | 291/981 [00:12<00:26, 26.26it/s] 30%|██▉       | 294/981 [00:12<00:25, 26.62it/s] 30%|███       | 297/981 [00:12<00:25, 26.83it/s] 31%|███       | 300/981 [00:12<00:25, 26.72it/s] 31%|███       | 303/981 [00:12<00:25, 26.39it/s] 31%|███       | 306/981 [00:12<00:25, 26.48it/s] 31%|███▏      | 309/981 [00:13<00:25, 26.47it/s] 32%|███▏      | 312/981 [00:13<00:25, 25.93it/s] 32%|███▏      | 315/981 [00:13<00:29, 22.31it/s] 32%|███▏      | 318/981 [00:13<00:31, 20.78it/s] 33%|███▎      | 321/981 [00:13<00:31, 20.81it/s] 33%|███▎      | 324/981 [00:13<00:30, 21.43it/s] 33%|███▎      | 327/981 [00:13<00:30, 21.77it/s] 34%|███▎      | 330/981 [00:14<00:29, 22.15it/s] 34%|███▍      | 333/981 [00:14<00:28, 22.42it/s] 34%|███▍      | 336/981 [00:14<00:28, 22.62it/s] 35%|███▍      | 339/981 [00:14<00:28, 22.56it/s] 35%|███▍      | 342/981 [00:14<00:29, 21.60it/s] 35%|███▌      | 345/981 [00:14<00:29, 21.33it/s] 35%|███▌      | 348/981 [00:14<00:29, 21.32it/s] 36%|███▌      | 351/981 [00:14<00:29, 21.67it/s] 36%|███▌      | 354/981 [00:15<00:28, 21.99it/s] 36%|███▋      | 357/981 [00:15<00:27, 22.33it/s] 37%|███▋      | 360/981 [00:15<00:27, 22.50it/s] 37%|███▋      | 363/981 [00:15<00:27, 22.64it/s] 37%|███▋      | 366/981 [00:15<00:27, 22.74it/s] 38%|███▊      | 369/981 [00:15<00:26, 22.79it/s] 38%|███▊      | 372/981 [00:15<00:26, 22.87it/s] 38%|███▊      | 375/981 [00:16<00:26, 22.98it/s] 39%|███▊      | 378/981 [00:16<00:26, 22.92it/s] 39%|███▉      | 381/981 [00:16<00:26, 22.82it/s] 39%|███▉      | 384/981 [00:16<00:26, 22.79it/s] 39%|███▉      | 387/981 [00:16<00:26, 22.80it/s] 40%|███▉      | 390/981 [00:16<00:26, 22.66it/s] 40%|████      | 393/981 [00:16<00:25, 22.72it/s] 40%|████      | 396/981 [00:16<00:25, 22.79it/s] 41%|████      | 399/981 [00:17<00:25, 22.84it/s] 41%|████      | 402/981 [00:17<00:25, 22.88it/s] 41%|████▏     | 405/981 [00:17<00:25, 22.92it/s] 42%|████▏     | 408/981 [00:17<00:25, 22.92it/s] 42%|████▏     | 411/981 [00:17<00:24, 22.86it/s] 42%|████▏     | 414/981 [00:17<00:25, 22.56it/s] 43%|████▎     | 417/981 [00:17<00:25, 21.77it/s] 43%|████▎     | 420/981 [00:18<00:26, 21.23it/s] 43%|████▎     | 423/981 [00:18<00:26, 21.33it/s] 43%|████▎     | 426/981 [00:18<00:25, 21.76it/s] 44%|████▎     | 429/981 [00:18<00:25, 21.84it/s] 44%|████▍     | 432/981 [00:18<00:24, 22.08it/s] 44%|████▍     | 435/981 [00:18<00:24, 22.20it/s] 45%|████▍     | 438/981 [00:18<00:24, 22.34it/s] 45%|████▍     | 441/981 [00:18<00:24, 22.28it/s] 45%|████▌     | 444/981 [00:19<00:24, 21.79it/s] 46%|████▌     | 447/981 [00:19<00:24, 21.50it/s] 46%|████▌     | 450/981 [00:19<00:24, 21.53it/s] 46%|████▌     | 453/981 [00:19<00:24, 21.74it/s] 46%|████▋     | 456/981 [00:19<00:23, 21.92it/s] 47%|████▋     | 459/981 [00:19<00:23, 22.00it/s] 47%|████▋     | 462/981 [00:19<00:23, 21.92it/s] 47%|████▋     | 465/981 [00:20<00:23, 21.84it/s] 48%|████▊     | 468/981 [00:20<00:23, 22.03it/s] 48%|████▊     | 471/981 [00:20<00:23, 21.82it/s] 48%|████▊     | 474/981 [00:20<00:23, 22.01it/s] 49%|████▊     | 477/981 [00:20<00:22, 22.11it/s] 49%|████▉     | 480/981 [00:20<00:22, 21.94it/s] 49%|████▉     | 483/981 [00:20<00:23, 21.52it/s] 50%|████▉     | 486/981 [00:21<00:22, 21.91it/s] 50%|████▉     | 489/981 [00:21<00:21, 22.53it/s] 50%|█████     | 492/981 [00:21<00:21, 22.48it/s] 50%|█████     | 495/981 [00:21<00:21, 22.68it/s] 51%|█████     | 498/981 [00:21<00:21, 22.91it/s] 51%|█████     | 501/981 [00:21<00:20, 23.24it/s] 51%|█████▏    | 504/981 [00:21<00:20, 22.73it/s] 52%|█████▏    | 507/981 [00:21<00:20, 22.91it/s] 52%|█████▏    | 510/981 [00:22<00:20, 23.09it/s] 52%|█████▏    | 513/981 [00:22<00:20, 22.97it/s] 53%|█████▎    | 516/981 [00:22<00:20, 23.18it/s] 53%|█████▎    | 519/981 [00:22<00:19, 23.51it/s] 53%|█████▎    | 522/981 [00:22<00:19, 23.76it/s] 54%|█████▎    | 525/981 [00:22<00:19, 23.89it/s] 54%|█████▍    | 528/981 [00:22<00:18, 23.88it/s] 54%|█████▍    | 531/981 [00:22<00:18, 24.20it/s] 54%|█████▍    | 534/981 [00:23<00:18, 24.17it/s] 55%|█████▍    | 537/981 [00:23<00:18, 24.41it/s] 55%|█████▌    | 540/981 [00:23<00:18, 24.26it/s] 55%|█████▌    | 543/981 [00:23<00:18, 24.06it/s] 56%|█████▌    | 546/981 [00:23<00:18, 24.14it/s] 56%|█████▌    | 549/981 [00:23<00:17, 24.05it/s] 56%|█████▋    | 552/981 [00:23<00:17, 24.40it/s] 57%|█████▋    | 555/981 [00:23<00:17, 24.60it/s] 57%|█████▋    | 558/981 [00:24<00:17, 24.79it/s] 57%|█████▋    | 561/981 [00:24<00:17, 24.57it/s] 57%|█████▋    | 564/981 [00:24<00:16, 24.62it/s] 58%|█████▊    | 567/981 [00:24<00:16, 24.54it/s] 58%|█████▊    | 570/981 [00:24<00:16, 24.51it/s] 58%|█████▊    | 573/981 [00:24<00:16, 24.61it/s] 59%|█████▊    | 576/981 [00:24<00:16, 24.73it/s] 59%|█████▉    | 579/981 [00:24<00:16, 24.27it/s] 59%|█████▉    | 582/981 [00:25<00:16, 24.42it/s] 60%|█████▉    | 585/981 [00:25<00:16, 24.54it/s] 60%|█████▉    | 588/981 [00:25<00:15, 24.68it/s] 60%|██████    | 591/981 [00:25<00:15, 24.80it/s] 61%|██████    | 594/981 [00:25<00:15, 24.74it/s] 61%|██████    | 597/981 [00:25<00:15, 24.66it/s] 61%|██████    | 600/981 [00:25<00:15, 24.46it/s] 61%|██████▏   | 603/981 [00:25<00:15, 24.51it/s] 62%|██████▏   | 606/981 [00:26<00:15, 24.42it/s] 62%|██████▏   | 609/981 [00:26<00:15, 24.42it/s] 62%|██████▏   | 612/981 [00:26<00:15, 24.41it/s] 63%|██████▎   | 615/981 [00:26<00:14, 24.56it/s] 63%|██████▎   | 618/981 [00:26<00:14, 24.61it/s] 63%|██████▎   | 621/981 [00:26<00:14, 24.48it/s] 64%|██████▎   | 624/981 [00:26<00:14, 24.55it/s] 64%|██████▍   | 627/981 [00:26<00:14, 24.61it/s] 64%|██████▍   | 630/981 [00:26<00:14, 24.71it/s] 65%|██████▍   | 633/981 [00:27<00:14, 24.77it/s] 65%|██████▍   | 636/981 [00:27<00:13, 24.78it/s] 65%|██████▌   | 639/981 [00:27<00:13, 24.60it/s] 65%|██████▌   | 642/981 [00:27<00:13, 24.51it/s] 66%|██████▌   | 645/981 [00:27<00:13, 24.53it/s] 66%|██████▌   | 648/981 [00:27<00:13, 24.68it/s] 66%|██████▋   | 651/981 [00:27<00:13, 24.83it/s] 67%|██████▋   | 654/981 [00:27<00:13, 24.94it/s] 67%|██████▋   | 657/981 [00:28<00:12, 25.01it/s] 67%|██████▋   | 660/981 [00:28<00:12, 25.02it/s] 68%|██████▊   | 663/981 [00:28<00:12, 24.95it/s] 68%|██████▊   | 666/981 [00:28<00:12, 24.90it/s] 68%|██████▊   | 669/981 [00:28<00:12, 25.03it/s] 69%|██████▊   | 672/981 [00:28<00:12, 24.94it/s] 69%|██████▉   | 675/981 [00:28<00:12, 24.89it/s] 69%|██████▉   | 678/981 [00:28<00:12, 24.87it/s] 69%|██████▉   | 681/981 [00:29<00:12, 24.73it/s] 70%|██████▉   | 684/981 [00:29<00:11, 24.92it/s] 70%|███████   | 687/981 [00:29<00:11, 25.01it/s] 70%|███████   | 690/981 [00:29<00:11, 25.12it/s] 71%|███████   | 693/981 [00:29<00:11, 25.02it/s] 71%|███████   | 696/981 [00:29<00:11, 24.98it/s] 71%|███████▏  | 699/981 [00:29<00:11, 25.10it/s] 72%|███████▏  | 702/981 [00:29<00:11, 25.17it/s] 72%|███████▏  | 705/981 [00:30<00:10, 25.15it/s] 72%|███████▏  | 708/981 [00:30<00:10, 25.12it/s] 72%|███████▏  | 711/981 [00:30<00:10, 24.94it/s] 73%|███████▎  | 714/981 [00:30<00:10, 25.06it/s] 73%|███████▎  | 717/981 [00:30<00:10, 25.09it/s] 73%|███████▎  | 720/981 [00:30<00:10, 25.10it/s] 74%|███████▎  | 723/981 [00:30<00:10, 25.08it/s] 74%|███████▍  | 726/981 [00:30<00:10, 25.13it/s] 74%|███████▍  | 729/981 [00:30<00:10, 25.08it/s] 75%|███████▍  | 732/981 [00:31<00:09, 24.99it/s] 75%|███████▍  | 735/981 [00:31<00:09, 24.91it/s] 75%|███████▌  | 738/981 [00:31<00:09, 24.83it/s] 76%|███████▌  | 741/981 [00:31<00:09, 24.75it/s] 76%|███████▌  | 744/981 [00:31<00:09, 24.75it/s] 76%|███████▌  | 747/981 [00:31<00:09, 24.60it/s] 76%|███████▋  | 750/981 [00:31<00:09, 24.66it/s] 77%|███████▋  | 753/981 [00:31<00:09, 24.67it/s] 77%|███████▋  | 756/981 [00:32<00:09, 24.63it/s] 77%|███████▋  | 759/981 [00:32<00:08, 24.73it/s] 78%|███████▊  | 762/981 [00:32<00:08, 24.46it/s] 78%|███████▊  | 765/981 [00:32<00:08, 24.56it/s] 78%|███████▊  | 768/981 [00:32<00:08, 24.51it/s] 79%|███████▊  | 771/981 [00:32<00:08, 24.45it/s] 79%|███████▉  | 774/981 [00:32<00:08, 24.49it/s] 79%|███████▉  | 777/981 [00:32<00:08, 24.40it/s] 80%|███████▉  | 780/981 [00:33<00:08, 24.61it/s] 80%|███████▉  | 783/981 [00:33<00:08, 24.39it/s] 80%|████████  | 786/981 [00:33<00:07, 24.86it/s] 80%|████████  | 789/981 [00:33<00:07, 25.25it/s] 81%|████████  | 792/981 [00:33<00:07, 25.81it/s] 81%|████████  | 795/981 [00:33<00:07, 26.24it/s] 81%|████████▏ | 798/981 [00:33<00:06, 26.73it/s] 82%|████████▏ | 801/981 [00:33<00:06, 27.11it/s] 82%|████████▏ | 804/981 [00:33<00:06, 27.51it/s] 82%|████████▏ | 807/981 [00:34<00:06, 27.63it/s] 83%|████████▎ | 810/981 [00:34<00:06, 27.64it/s] 83%|████████▎ | 813/981 [00:34<00:06, 27.57it/s] 83%|████████▎ | 816/981 [00:34<00:05, 27.79it/s] 83%|████████▎ | 819/981 [00:34<00:05, 28.07it/s] 84%|████████▍ | 822/981 [00:34<00:05, 28.02it/s] 84%|████████▍ | 825/981 [00:34<00:05, 28.18it/s] 84%|████████▍ | 828/981 [00:34<00:05, 28.28it/s] 85%|████████▍ | 831/981 [00:34<00:05, 28.31it/s] 85%|████████▌ | 834/981 [00:34<00:05, 28.47it/s] 85%|████████▌ | 837/981 [00:35<00:05, 28.53it/s] 86%|████████▌ | 840/981 [00:35<00:04, 28.45it/s] 86%|████████▌ | 843/981 [00:35<00:04, 28.42it/s] 86%|████████▌ | 846/981 [00:35<00:04, 28.47it/s] 87%|████████▋ | 849/981 [00:35<00:04, 28.22it/s] 87%|████████▋ | 852/981 [00:35<00:04, 28.24it/s] 87%|████████▋ | 855/981 [00:35<00:04, 28.15it/s] 87%|████████▋ | 858/981 [00:35<00:04, 28.39it/s] 88%|████████▊ | 861/981 [00:35<00:04, 28.53it/s] 88%|████████▊ | 864/981 [00:36<00:04, 28.41it/s] 88%|████████▊ | 867/981 [00:36<00:04, 28.42it/s] 89%|████████▊ | 870/981 [00:36<00:03, 28.51it/s] 89%|████████▉ | 873/981 [00:36<00:03, 28.59it/s] 89%|████████▉ | 876/981 [00:36<00:03, 28.74it/s] 90%|████████▉ | 879/981 [00:36<00:03, 28.75it/s] 90%|████████▉ | 882/981 [00:36<00:03, 28.53it/s] 90%|█████████ | 885/981 [00:36<00:03, 28.43it/s] 91%|█████████ | 888/981 [00:36<00:03, 28.26it/s] 91%|█████████ | 891/981 [00:37<00:03, 28.20it/s] 91%|█████████ | 894/981 [00:37<00:03, 28.39it/s] 91%|█████████▏| 897/981 [00:37<00:02, 28.44it/s] 92%|█████████▏| 900/981 [00:37<00:02, 28.57it/s] 92%|█████████▏| 903/981 [00:37<00:02, 26.29it/s] 92%|█████████▏| 906/981 [00:37<00:02, 25.89it/s] 93%|█████████▎| 909/981 [00:37<00:02, 26.72it/s] 93%|█████████▎| 912/981 [00:37<00:02, 27.33it/s] 93%|█████████▎| 915/981 [00:37<00:02, 27.67it/s] 94%|█████████▎| 918/981 [00:37<00:02, 28.02it/s] 94%|█████████▍| 921/981 [00:38<00:02, 28.08it/s] 94%|█████████▍| 924/981 [00:38<00:02, 28.17it/s] 94%|█████████▍| 927/981 [00:38<00:01, 28.16it/s] 95%|█████████▍| 930/981 [00:38<00:01, 28.35it/s] 95%|█████████▌| 933/981 [00:38<00:01, 28.40it/s] 95%|█████████▌| 936/981 [00:38<00:01, 28.37it/s] 96%|█████████▌| 939/981 [00:38<00:01, 28.21it/s] 96%|█████████▌| 942/981 [00:38<00:01, 28.35it/s] 96%|█████████▋| 945/981 [00:38<00:01, 28.33it/s] 97%|█████████▋| 948/981 [00:39<00:01, 28.48it/s] 97%|█████████▋| 951/981 [00:39<00:01, 28.46it/s] 97%|█████████▋| 954/981 [00:39<00:00, 28.43it/s] 98%|█████████▊| 957/981 [00:39<00:00, 28.37it/s] 98%|█████████▊| 960/981 [00:39<00:00, 28.17it/s] 98%|█████████▊| 963/981 [00:39<00:00, 28.08it/s] 98%|█████████▊| 966/981 [00:39<00:00, 27.88it/s] 99%|█████████▉| 969/981 [00:39<00:00, 28.03it/s] 99%|█████████▉| 972/981 [00:39<00:00, 28.12it/s] 99%|█████████▉| 975/981 [00:40<00:00, 28.37it/s]100%|█████████▉| 978/981 [00:40<00:00, 28.38it/s]100%|██████████| 981/981 [00:40<00:00, 28.15it/s]100%|██████████| 981/981 [00:40<00:00, 24.39it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_Focal_DRW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.033, valid loss : 0.022, train f1 : 0.589, valid f1 : 0.807
training process - Deferred Re-weighting:   2%|▏         | 1/50 [03:59<3:15:11, 239.02s/it]Best score increase :0.000 -> 0.807
training process - Deferred Re-weighting:   4%|▍         | 2/50 [07:10<2:48:54, 211.13s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▌         | 3/50 [10:23<2:38:58, 202.94s/it]Best score increase :0.807 -> 0.823
training process - Deferred Re-weighting:   8%|▊         | 4/50 [13:37<2:32:39, 199.11s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.016, valid loss : 0.012, train f1 : 0.839, valid f1 : 0.880
training process - Deferred Re-weighting:  10%|█         | 5/50 [17:36<2:40:10, 213.56s/it]Best score increase :0.823 -> 0.880
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [20:50<2:31:48, 207.01s/it]Best score increase :0.880 -> 0.902
training process - Deferred Re-weighting:  14%|█▍        | 7/50 [24:05<2:25:32, 203.08s/it]Best score increase :0.902 -> 0.907
training process - Deferred Re-weighting:  16%|█▌        | 8/50 [27:16<2:19:33, 199.38s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.011, valid loss : 0.011, train f1 : 0.905, valid f1 : 0.917
training process - Deferred Re-weighting:  18%|█▊        | 9/50 [31:16<2:24:54, 212.06s/it]Best score increase :0.907 -> 0.917
training process - Deferred Re-weighting:  20%|██        | 10/50 [34:34<2:18:20, 207.52s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 11/50 [37:48<2:12:16, 203.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 12/50 [41:05<2:07:38, 201.53s/it]Best score increase :0.917 -> 0.927
epoch : 13, train loss : 0.010, valid loss : 0.010, train f1 : 0.920, valid f1 : 0.915
training process - Deferred Re-weighting:  26%|██▌       | 13/50 [45:02<2:10:54, 212.28s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [48:18<2:04:23, 207.33s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|███       | 15/50 [51:35<1:59:03, 204.09s/it]Best score increase :0.927 -> 0.938
training process - Deferred Re-weighting:  32%|███▏      | 16/50 [54:51<1:54:14, 201.60s/it]Best score increase :0.938 -> 0.941
epoch : 17, train loss : 0.010, valid loss : 0.011, train f1 : 0.906, valid f1 : 0.904
training process - Deferred Re-weighting:  34%|███▍      | 17/50 [58:40<1:55:26, 209.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [1:01:44<1:47:49, 202.17s/it]Best score increase :0.941 -> 0.947
training process - Deferred Re-weighting:  38%|███▊      | 19/50 [1:04:47<1:41:32, 196.53s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  40%|████      | 20/50 [1:07:51<1:36:21, 192.70s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.009, valid loss : 0.011, train f1 : 0.931, valid f1 : 0.925
training process - Deferred Re-weighting:  42%|████▏     | 21/50 [1:11:36<1:37:47, 202.31s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 22/50 [1:14:39<1:31:45, 196.63s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 23/50 [1:17:44<1:26:55, 193.17s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 24/50 [1:20:50<1:22:41, 190.84s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.008, valid loss : 0.011, train f1 : 0.930, valid f1 : 0.917
training process - Deferred Re-weighting:  50%|█████     | 25/50 [1:24:35<1:23:48, 201.15s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 26/50 [1:27:41<1:18:39, 196.63s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  54%|█████▍    | 27/50 [1:30:47<1:14:08, 193.41s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  56%|█████▌    | 28/50 [1:33:50<1:09:49, 190.44s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.009, valid loss : 0.007, train f1 : 0.917, valid f1 : 0.933
training process - Deferred Re-weighting:  58%|█████▊    | 29/50 [1:37:35<1:10:13, 200.66s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 29/50 [1:40:39<1:12:53, 208.27s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 29, best f1 score : 0.947
training process finished, best loss : 0.008, best acc : 0.996, best f1 : 0.947, best epoch : 17

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.82      0.74        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.84      0.90      0.87      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.87, test AUC : 0.90, test loss : 0.270

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:38, 25.11it/s]  1%|          | 6/981 [00:00<00:38, 25.14it/s]  1%|          | 9/981 [00:00<00:38, 25.16it/s]  1%|          | 12/981 [00:00<00:39, 24.49it/s]  2%|▏         | 15/981 [00:00<00:39, 24.52it/s]  2%|▏         | 18/981 [00:00<00:38, 24.93it/s]  2%|▏         | 21/981 [00:00<00:38, 25.14it/s]  2%|▏         | 24/981 [00:00<00:37, 25.51it/s]  3%|▎         | 27/981 [00:01<00:37, 25.61it/s]  3%|▎         | 30/981 [00:01<00:37, 25.49it/s]  3%|▎         | 33/981 [00:01<00:36, 25.69it/s]  4%|▎         | 36/981 [00:01<00:36, 25.71it/s]  4%|▍         | 39/981 [00:01<00:36, 25.68it/s]  4%|▍         | 42/981 [00:01<00:36, 25.56it/s]  5%|▍         | 45/981 [00:01<00:36, 25.61it/s]  5%|▍         | 48/981 [00:01<00:36, 25.70it/s]  5%|▌         | 51/981 [00:02<00:36, 25.46it/s]  6%|▌         | 54/981 [00:02<00:36, 25.54it/s]  6%|▌         | 57/981 [00:02<00:36, 25.49it/s]  6%|▌         | 60/981 [00:02<00:35, 25.81it/s]  6%|▋         | 63/981 [00:02<00:35, 25.88it/s]  7%|▋         | 66/981 [00:02<00:35, 25.98it/s]  7%|▋         | 69/981 [00:02<00:35, 26.05it/s]  7%|▋         | 72/981 [00:02<00:35, 25.93it/s]  8%|▊         | 75/981 [00:02<00:34, 25.94it/s]  8%|▊         | 78/981 [00:03<00:34, 25.90it/s]  8%|▊         | 81/981 [00:03<00:34, 25.83it/s]  9%|▊         | 84/981 [00:03<00:34, 25.71it/s]  9%|▉         | 87/981 [00:03<00:35, 25.51it/s]  9%|▉         | 90/981 [00:03<00:34, 25.55it/s]  9%|▉         | 93/981 [00:03<00:34, 25.58it/s] 10%|▉         | 96/981 [00:03<00:34, 25.51it/s] 10%|█         | 99/981 [00:03<00:34, 25.52it/s] 10%|█         | 102/981 [00:03<00:34, 25.55it/s] 11%|█         | 105/981 [00:04<00:34, 25.56it/s] 11%|█         | 108/981 [00:04<00:34, 25.36it/s] 11%|█▏        | 111/981 [00:04<00:34, 25.26it/s] 12%|█▏        | 114/981 [00:04<00:34, 25.28it/s] 12%|█▏        | 117/981 [00:04<00:34, 25.10it/s] 12%|█▏        | 120/981 [00:04<00:34, 24.96it/s] 13%|█▎        | 123/981 [00:04<00:34, 25.07it/s] 13%|█▎        | 126/981 [00:04<00:34, 25.13it/s] 13%|█▎        | 129/981 [00:05<00:33, 25.14it/s] 13%|█▎        | 132/981 [00:05<00:33, 25.20it/s] 14%|█▍        | 135/981 [00:05<00:33, 25.44it/s] 14%|█▍        | 138/981 [00:05<00:32, 25.67it/s] 14%|█▍        | 141/981 [00:05<00:32, 25.69it/s] 15%|█▍        | 144/981 [00:05<00:32, 25.61it/s] 15%|█▍        | 147/981 [00:05<00:32, 25.76it/s] 15%|█▌        | 150/981 [00:05<00:32, 25.72it/s] 16%|█▌        | 153/981 [00:05<00:32, 25.82it/s] 16%|█▌        | 156/981 [00:06<00:32, 25.49it/s] 16%|█▌        | 159/981 [00:06<00:32, 25.34it/s] 17%|█▋        | 162/981 [00:06<00:32, 25.16it/s] 17%|█▋        | 165/981 [00:06<00:32, 25.44it/s] 17%|█▋        | 168/981 [00:06<00:31, 25.44it/s] 17%|█▋        | 171/981 [00:06<00:32, 25.28it/s] 18%|█▊        | 174/981 [00:06<00:31, 25.68it/s] 18%|█▊        | 177/981 [00:06<00:31, 25.80it/s] 18%|█▊        | 180/981 [00:07<00:31, 25.71it/s] 19%|█▊        | 183/981 [00:07<00:31, 25.67it/s] 19%|█▉        | 186/981 [00:07<00:31, 25.59it/s] 19%|█▉        | 189/981 [00:07<00:30, 25.64it/s] 20%|█▉        | 192/981 [00:07<00:30, 25.65it/s] 20%|█▉        | 195/981 [00:07<00:30, 25.47it/s] 20%|██        | 198/981 [00:07<00:30, 25.52it/s] 20%|██        | 201/981 [00:07<00:30, 25.51it/s] 21%|██        | 204/981 [00:07<00:30, 25.44it/s] 21%|██        | 207/981 [00:08<00:30, 25.36it/s] 21%|██▏       | 210/981 [00:08<00:30, 25.45it/s] 22%|██▏       | 213/981 [00:08<00:30, 25.24it/s] 22%|██▏       | 216/981 [00:08<00:30, 25.15it/s] 22%|██▏       | 219/981 [00:08<00:30, 25.01it/s] 23%|██▎       | 222/981 [00:08<00:30, 25.00it/s] 23%|██▎       | 225/981 [00:08<00:30, 24.95it/s] 23%|██▎       | 228/981 [00:08<00:30, 24.91it/s] 24%|██▎       | 231/981 [00:09<00:30, 24.93it/s] 24%|██▍       | 234/981 [00:09<00:30, 24.84it/s] 24%|██▍       | 237/981 [00:09<00:29, 24.88it/s] 24%|██▍       | 240/981 [00:09<00:30, 24.69it/s] 25%|██▍       | 243/981 [00:09<00:29, 24.96it/s] 25%|██▌       | 246/981 [00:09<00:29, 25.10it/s] 25%|██▌       | 249/981 [00:09<00:29, 25.11it/s] 26%|██▌       | 252/981 [00:09<00:29, 24.94it/s] 26%|██▌       | 255/981 [00:10<00:29, 24.84it/s] 26%|██▋       | 258/981 [00:10<00:29, 24.91it/s] 27%|██▋       | 261/981 [00:10<00:28, 24.97it/s] 27%|██▋       | 264/981 [00:10<00:28, 24.86it/s] 27%|██▋       | 267/981 [00:10<00:28, 24.90it/s] 28%|██▊       | 270/981 [00:10<00:28, 25.19it/s] 28%|██▊       | 273/981 [00:10<00:28, 25.28it/s] 28%|██▊       | 276/981 [00:10<00:27, 25.50it/s] 28%|██▊       | 279/981 [00:10<00:27, 25.58it/s] 29%|██▊       | 282/981 [00:11<00:27, 25.58it/s] 29%|██▉       | 285/981 [00:11<00:27, 25.44it/s] 29%|██▉       | 288/981 [00:11<00:27, 25.37it/s] 30%|██▉       | 291/981 [00:11<00:27, 25.20it/s] 30%|██▉       | 294/981 [00:11<00:27, 25.22it/s] 30%|███       | 297/981 [00:11<00:27, 25.02it/s] 31%|███       | 300/981 [00:11<00:27, 24.94it/s] 31%|███       | 303/981 [00:11<00:27, 24.99it/s] 31%|███       | 306/981 [00:12<00:26, 25.09it/s] 31%|███▏      | 309/981 [00:12<00:26, 25.09it/s] 32%|███▏      | 312/981 [00:12<00:26, 25.06it/s] 32%|███▏      | 315/981 [00:12<00:26, 25.12it/s] 32%|███▏      | 318/981 [00:12<00:26, 24.67it/s] 33%|███▎      | 321/981 [00:12<00:26, 24.64it/s] 33%|███▎      | 324/981 [00:12<00:26, 24.80it/s] 33%|███▎      | 327/981 [00:12<00:26, 24.74it/s] 34%|███▎      | 330/981 [00:13<00:26, 24.78it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.84it/s] 34%|███▍      | 336/981 [00:13<00:25, 25.03it/s] 35%|███▍      | 339/981 [00:13<00:25, 25.21it/s] 35%|███▍      | 342/981 [00:13<00:25, 25.09it/s] 35%|███▌      | 345/981 [00:13<00:25, 25.22it/s] 35%|███▌      | 348/981 [00:13<00:25, 25.23it/s] 36%|███▌      | 351/981 [00:13<00:25, 25.12it/s] 36%|███▌      | 354/981 [00:13<00:25, 24.99it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.89it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.66it/s] 37%|███▋      | 363/981 [00:14<00:24, 24.79it/s] 37%|███▋      | 366/981 [00:14<00:24, 24.75it/s] 38%|███▊      | 369/981 [00:14<00:24, 24.64it/s] 38%|███▊      | 372/981 [00:14<00:24, 24.71it/s] 38%|███▊      | 375/981 [00:14<00:24, 24.81it/s] 39%|███▊      | 378/981 [00:14<00:24, 24.71it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.94it/s] 39%|███▉      | 384/981 [00:15<00:23, 24.90it/s] 39%|███▉      | 387/981 [00:15<00:24, 24.74it/s] 40%|███▉      | 390/981 [00:15<00:23, 24.83it/s] 40%|████      | 393/981 [00:15<00:23, 24.88it/s] 40%|████      | 396/981 [00:15<00:23, 24.78it/s] 41%|████      | 399/981 [00:15<00:23, 24.87it/s] 41%|████      | 402/981 [00:15<00:23, 24.94it/s] 41%|████▏     | 405/981 [00:16<00:23, 25.00it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.86it/s] 42%|████▏     | 411/981 [00:16<00:22, 24.98it/s] 42%|████▏     | 414/981 [00:16<00:22, 25.20it/s] 43%|████▎     | 417/981 [00:16<00:22, 25.24it/s] 43%|████▎     | 420/981 [00:16<00:22, 25.20it/s] 43%|████▎     | 423/981 [00:16<00:22, 25.14it/s] 43%|████▎     | 426/981 [00:16<00:22, 25.12it/s] 44%|████▎     | 429/981 [00:17<00:22, 24.93it/s] 44%|████▍     | 432/981 [00:17<00:21, 24.96it/s] 44%|████▍     | 435/981 [00:17<00:21, 24.88it/s] 45%|████▍     | 438/981 [00:17<00:21, 24.95it/s] 45%|████▍     | 441/981 [00:17<00:21, 24.89it/s] 45%|████▌     | 444/981 [00:17<00:21, 24.87it/s] 46%|████▌     | 447/981 [00:17<00:21, 25.09it/s] 46%|████▌     | 450/981 [00:17<00:21, 25.23it/s] 46%|████▌     | 453/981 [00:17<00:21, 24.99it/s] 46%|████▋     | 456/981 [00:18<00:20, 25.06it/s] 47%|████▋     | 459/981 [00:18<00:20, 25.07it/s] 47%|████▋     | 462/981 [00:18<00:20, 25.09it/s] 47%|████▋     | 465/981 [00:18<00:20, 25.12it/s] 48%|████▊     | 468/981 [00:18<00:20, 25.07it/s] 48%|████▊     | 471/981 [00:18<00:20, 25.10it/s] 48%|████▊     | 474/981 [00:18<00:20, 25.09it/s] 49%|████▊     | 477/981 [00:18<00:19, 25.27it/s] 49%|████▉     | 480/981 [00:19<00:19, 25.19it/s] 49%|████▉     | 483/981 [00:19<00:19, 25.44it/s] 50%|████▉     | 486/981 [00:19<00:19, 25.46it/s] 50%|████▉     | 489/981 [00:19<00:19, 25.44it/s] 50%|█████     | 492/981 [00:19<00:19, 25.42it/s] 50%|█████     | 495/981 [00:19<00:19, 25.37it/s] 51%|█████     | 498/981 [00:19<00:19, 25.34it/s] 51%|█████     | 501/981 [00:19<00:19, 25.20it/s] 51%|█████▏    | 504/981 [00:19<00:18, 25.22it/s] 52%|█████▏    | 507/981 [00:20<00:18, 25.09it/s] 52%|█████▏    | 510/981 [00:20<00:18, 25.13it/s] 52%|█████▏    | 513/981 [00:20<00:18, 25.03it/s] 53%|█████▎    | 516/981 [00:20<00:18, 25.25it/s] 53%|█████▎    | 519/981 [00:20<00:18, 25.60it/s] 53%|█████▎    | 522/981 [00:20<00:17, 25.56it/s] 54%|█████▎    | 525/981 [00:20<00:17, 25.64it/s] 54%|█████▍    | 528/981 [00:20<00:17, 25.43it/s] 54%|█████▍    | 531/981 [00:21<00:17, 25.51it/s] 54%|█████▍    | 534/981 [00:21<00:17, 25.36it/s] 55%|█████▍    | 537/981 [00:21<00:17, 25.34it/s] 55%|█████▌    | 540/981 [00:21<00:17, 25.46it/s] 55%|█████▌    | 543/981 [00:21<00:17, 25.57it/s] 56%|█████▌    | 546/981 [00:21<00:16, 25.73it/s] 56%|█████▌    | 549/981 [00:21<00:16, 25.84it/s] 56%|█████▋    | 552/981 [00:21<00:16, 26.12it/s] 57%|█████▋    | 555/981 [00:21<00:16, 26.22it/s] 57%|█████▋    | 558/981 [00:22<00:16, 26.08it/s] 57%|█████▋    | 561/981 [00:22<00:16, 25.89it/s] 57%|█████▋    | 564/981 [00:22<00:16, 25.91it/s] 58%|█████▊    | 567/981 [00:22<00:15, 25.97it/s] 58%|█████▊    | 570/981 [00:22<00:15, 26.01it/s] 58%|█████▊    | 573/981 [00:22<00:15, 25.96it/s] 59%|█████▊    | 576/981 [00:22<00:15, 26.00it/s] 59%|█████▉    | 579/981 [00:22<00:15, 26.04it/s] 59%|█████▉    | 582/981 [00:23<00:15, 26.07it/s] 60%|█████▉    | 585/981 [00:23<00:15, 25.94it/s] 60%|█████▉    | 588/981 [00:23<00:15, 25.87it/s] 60%|██████    | 591/981 [00:23<00:14, 26.06it/s] 61%|██████    | 594/981 [00:23<00:14, 26.12it/s] 61%|██████    | 597/981 [00:23<00:14, 25.99it/s] 61%|██████    | 600/981 [00:23<00:14, 26.02it/s] 61%|██████▏   | 603/981 [00:23<00:14, 26.06it/s] 62%|██████▏   | 606/981 [00:23<00:14, 25.73it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.59it/s] 62%|██████▏   | 612/981 [00:24<00:14, 25.75it/s] 63%|██████▎   | 615/981 [00:24<00:14, 25.98it/s] 63%|██████▎   | 618/981 [00:24<00:13, 26.05it/s] 63%|██████▎   | 621/981 [00:24<00:13, 26.07it/s] 64%|██████▎   | 624/981 [00:24<00:13, 26.18it/s] 64%|██████▍   | 627/981 [00:24<00:13, 26.17it/s] 64%|██████▍   | 630/981 [00:24<00:13, 26.06it/s] 65%|██████▍   | 633/981 [00:24<00:13, 26.03it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.86it/s] 65%|██████▌   | 639/981 [00:25<00:13, 25.69it/s] 65%|██████▌   | 642/981 [00:25<00:13, 25.83it/s] 66%|██████▌   | 645/981 [00:25<00:12, 25.94it/s] 66%|██████▌   | 648/981 [00:25<00:12, 26.02it/s] 66%|██████▋   | 651/981 [00:25<00:12, 25.89it/s] 67%|██████▋   | 654/981 [00:25<00:12, 25.96it/s] 67%|██████▋   | 657/981 [00:25<00:12, 26.05it/s] 67%|██████▋   | 660/981 [00:26<00:12, 26.18it/s] 68%|██████▊   | 663/981 [00:26<00:12, 26.18it/s] 68%|██████▊   | 666/981 [00:26<00:12, 26.21it/s] 68%|██████▊   | 669/981 [00:26<00:11, 26.23it/s] 69%|██████▊   | 672/981 [00:26<00:11, 26.16it/s] 69%|██████▉   | 675/981 [00:26<00:11, 26.15it/s] 69%|██████▉   | 678/981 [00:26<00:11, 26.18it/s] 69%|██████▉   | 681/981 [00:26<00:11, 26.16it/s] 70%|██████▉   | 684/981 [00:26<00:11, 26.15it/s] 70%|███████   | 687/981 [00:27<00:11, 26.14it/s] 70%|███████   | 690/981 [00:27<00:11, 26.01it/s] 71%|███████   | 693/981 [00:27<00:11, 26.09it/s] 71%|███████   | 696/981 [00:27<00:10, 26.27it/s] 71%|███████▏  | 699/981 [00:27<00:10, 26.30it/s] 72%|███████▏  | 702/981 [00:27<00:10, 26.25it/s] 72%|███████▏  | 705/981 [00:27<00:10, 26.24it/s] 72%|███████▏  | 708/981 [00:27<00:10, 26.20it/s] 72%|███████▏  | 711/981 [00:27<00:10, 26.19it/s] 73%|███████▎  | 714/981 [00:28<00:10, 26.06it/s] 73%|███████▎  | 717/981 [00:28<00:10, 25.72it/s] 73%|███████▎  | 720/981 [00:28<00:10, 25.86it/s] 74%|███████▎  | 723/981 [00:28<00:10, 25.77it/s] 74%|███████▍  | 726/981 [00:28<00:09, 25.86it/s] 74%|███████▍  | 729/981 [00:28<00:09, 25.97it/s] 75%|███████▍  | 732/981 [00:28<00:09, 26.15it/s] 75%|███████▍  | 735/981 [00:28<00:09, 25.97it/s] 75%|███████▌  | 738/981 [00:29<00:09, 25.96it/s] 76%|███████▌  | 741/981 [00:29<00:09, 25.97it/s] 76%|███████▌  | 744/981 [00:29<00:09, 25.93it/s] 76%|███████▌  | 747/981 [00:29<00:09, 25.91it/s] 76%|███████▋  | 750/981 [00:29<00:08, 25.88it/s] 77%|███████▋  | 753/981 [00:29<00:08, 25.73it/s] 77%|███████▋  | 756/981 [00:29<00:08, 25.77it/s] 77%|███████▋  | 759/981 [00:29<00:08, 25.76it/s] 78%|███████▊  | 762/981 [00:29<00:08, 25.72it/s] 78%|███████▊  | 765/981 [00:30<00:08, 25.31it/s] 78%|███████▊  | 768/981 [00:30<00:08, 25.69it/s] 79%|███████▊  | 771/981 [00:30<00:08, 25.70it/s] 79%|███████▉  | 774/981 [00:30<00:08, 25.73it/s] 79%|███████▉  | 777/981 [00:30<00:07, 25.65it/s] 80%|███████▉  | 780/981 [00:30<00:07, 25.58it/s] 80%|███████▉  | 783/981 [00:30<00:07, 25.86it/s] 80%|████████  | 786/981 [00:30<00:07, 26.20it/s] 80%|████████  | 789/981 [00:30<00:07, 26.63it/s] 81%|████████  | 792/981 [00:31<00:06, 27.28it/s] 81%|████████  | 795/981 [00:31<00:06, 27.91it/s] 81%|████████▏ | 798/981 [00:31<00:06, 28.26it/s] 82%|████████▏ | 801/981 [00:31<00:06, 28.63it/s] 82%|████████▏ | 804/981 [00:31<00:06, 28.90it/s] 82%|████████▏ | 807/981 [00:31<00:05, 29.08it/s] 83%|████████▎ | 810/981 [00:31<00:05, 29.26it/s] 83%|████████▎ | 813/981 [00:31<00:05, 29.35it/s] 83%|████████▎ | 816/981 [00:31<00:05, 29.48it/s] 83%|████████▎ | 819/981 [00:31<00:05, 29.53it/s] 84%|████████▍ | 822/981 [00:32<00:05, 29.55it/s] 84%|████████▍ | 825/981 [00:32<00:05, 29.11it/s] 84%|████████▍ | 828/981 [00:32<00:05, 29.06it/s] 85%|████████▍ | 831/981 [00:32<00:05, 29.16it/s] 85%|████████▌ | 835/981 [00:32<00:04, 29.56it/s] 86%|████████▌ | 839/981 [00:32<00:04, 30.03it/s] 86%|████████▌ | 842/981 [00:32<00:04, 29.95it/s] 86%|████████▌ | 846/981 [00:32<00:04, 29.98it/s] 87%|████████▋ | 849/981 [00:33<00:04, 29.93it/s] 87%|████████▋ | 852/981 [00:33<00:04, 29.92it/s] 87%|████████▋ | 855/981 [00:33<00:04, 29.90it/s] 87%|████████▋ | 858/981 [00:33<00:04, 29.92it/s] 88%|████████▊ | 862/981 [00:33<00:03, 29.98it/s] 88%|████████▊ | 865/981 [00:33<00:03, 29.97it/s] 89%|████████▊ | 869/981 [00:33<00:03, 30.00it/s] 89%|████████▉ | 873/981 [00:33<00:03, 30.08it/s] 89%|████████▉ | 877/981 [00:33<00:03, 30.35it/s] 90%|████████▉ | 881/981 [00:34<00:03, 30.21it/s] 90%|█████████ | 885/981 [00:34<00:03, 30.05it/s] 91%|█████████ | 889/981 [00:34<00:03, 29.94it/s] 91%|█████████ | 892/981 [00:34<00:02, 29.93it/s] 91%|█████████▏| 896/981 [00:34<00:02, 29.95it/s] 92%|█████████▏| 900/981 [00:34<00:02, 30.39it/s] 92%|█████████▏| 904/981 [00:34<00:02, 30.73it/s] 93%|█████████▎| 908/981 [00:34<00:02, 30.92it/s] 93%|█████████▎| 912/981 [00:35<00:02, 31.08it/s] 93%|█████████▎| 916/981 [00:35<00:02, 31.61it/s] 94%|█████████▍| 920/981 [00:35<00:01, 32.00it/s] 94%|█████████▍| 924/981 [00:35<00:01, 31.94it/s] 95%|█████████▍| 928/981 [00:35<00:01, 32.11it/s] 95%|█████████▌| 932/981 [00:35<00:01, 32.20it/s] 95%|█████████▌| 936/981 [00:35<00:01, 31.52it/s] 96%|█████████▌| 940/981 [00:35<00:01, 30.95it/s] 96%|█████████▌| 944/981 [00:36<00:01, 30.86it/s] 97%|█████████▋| 948/981 [00:36<00:01, 31.21it/s] 97%|█████████▋| 952/981 [00:36<00:00, 31.39it/s] 97%|█████████▋| 956/981 [00:36<00:00, 31.59it/s] 98%|█████████▊| 960/981 [00:36<00:00, 31.74it/s] 98%|█████████▊| 964/981 [00:36<00:00, 31.85it/s] 99%|█████████▊| 968/981 [00:36<00:00, 31.99it/s] 99%|█████████▉| 972/981 [00:36<00:00, 32.06it/s] 99%|█████████▉| 976/981 [00:37<00:00, 32.10it/s]100%|█████████▉| 980/981 [00:37<00:00, 32.10it/s]100%|██████████| 981/981 [00:37<00:00, 26.34it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_Focal_RS_DRW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.087, valid loss : 0.142, train f1 : 0.832, valid f1 : 0.526
training process - Deferred Re-weighting:   2%|▏         | 1/50 [03:49<3:07:10, 229.19s/it]Best score increase :0.000 -> 0.526
training process - Deferred Re-weighting:   4%|▍         | 2/50 [06:52<2:41:48, 202.25s/it]Best score increase :0.526 -> 0.891
training process - Deferred Re-weighting:   6%|▌         | 3/50 [09:57<2:32:13, 194.34s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 4/50 [13:00<2:25:29, 189.76s/it]Best score increase :0.891 -> 0.898
epoch : 5, train loss : 0.040, valid loss : 0.027, train f1 : 0.933, valid f1 : 0.686
training process - Deferred Re-weighting:  10%|█         | 5/50 [16:45<2:32:02, 202.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [19:49<2:23:53, 196.23s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 7/50 [22:54<2:17:52, 192.39s/it]Best score increase :0.898 -> 0.903
training process - Deferred Re-weighting:  16%|█▌        | 8/50 [25:59<2:13:09, 190.24s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.038, valid loss : 0.056, train f1 : 0.941, valid f1 : 0.630
training process - Deferred Re-weighting:  18%|█▊        | 9/50 [29:46<2:17:44, 201.56s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 10/50 [32:49<2:10:43, 196.08s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 11/50 [35:54<2:05:06, 192.47s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 12/50 [38:57<2:00:08, 189.71s/it]EarlyStopping counter : 5 out of 12
epoch : 13, train loss : 0.033, valid loss : 0.023, train f1 : 0.947, valid f1 : 0.710
training process - Deferred Re-weighting:  26%|██▌       | 13/50 [42:42<2:03:32, 200.35s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [45:46<1:57:12, 195.35s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  30%|███       | 15/50 [48:50<1:52:03, 192.11s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  32%|███▏      | 16/50 [51:54<1:47:23, 189.52s/it]EarlyStopping counter : 9 out of 12
epoch : 17, train loss : 0.031, valid loss : 0.027, train f1 : 0.954, valid f1 : 0.748
training process - Deferred Re-weighting:  34%|███▍      | 17/50 [55:38<1:50:00, 200.01s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [58:42<1:44:06, 195.19s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [1:01:47<1:49:50, 205.96s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 18, best f1 score : 0.903
training process finished, best loss : 0.016, best acc : 0.993, best f1 : 0.903, best epoch : 6

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.52      0.79      0.63        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.98      3883
   macro avg       0.76      0.89      0.81      3883
weighted avg       0.99      0.98      0.98      3883


# test acc : 0.98, test f1 : 0.81, test AUC : 0.89, test loss : 0.460

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:51, 19.13it/s]  1%|          | 5/981 [00:00<00:41, 23.66it/s]  1%|          | 8/981 [00:00<00:38, 25.01it/s]  1%|          | 11/981 [00:00<00:37, 25.59it/s]  1%|▏         | 14/981 [00:00<00:37, 25.89it/s]  2%|▏         | 17/981 [00:00<00:37, 25.97it/s]  2%|▏         | 20/981 [00:00<00:36, 25.98it/s]  2%|▏         | 23/981 [00:00<00:36, 26.08it/s]  3%|▎         | 26/981 [00:01<00:36, 26.07it/s]  3%|▎         | 29/981 [00:01<00:36, 26.23it/s]  3%|▎         | 32/981 [00:01<00:36, 26.36it/s]  4%|▎         | 35/981 [00:01<00:35, 26.43it/s]  4%|▍         | 38/981 [00:01<00:35, 26.49it/s]  4%|▍         | 41/981 [00:01<00:35, 26.49it/s]  4%|▍         | 44/981 [00:01<00:35, 26.54it/s]  5%|▍         | 47/981 [00:01<00:35, 26.56it/s]  5%|▌         | 50/981 [00:01<00:35, 26.57it/s]  5%|▌         | 53/981 [00:02<00:35, 26.46it/s]  6%|▌         | 56/981 [00:02<00:35, 26.23it/s]  6%|▌         | 59/981 [00:02<00:35, 26.31it/s]  6%|▋         | 62/981 [00:02<00:34, 26.40it/s]  7%|▋         | 65/981 [00:02<00:34, 26.49it/s]  7%|▋         | 68/981 [00:02<00:34, 26.52it/s]  7%|▋         | 71/981 [00:02<00:34, 26.45it/s]  8%|▊         | 74/981 [00:02<00:34, 26.48it/s]  8%|▊         | 77/981 [00:02<00:34, 26.38it/s]  8%|▊         | 80/981 [00:03<00:34, 25.84it/s]  8%|▊         | 83/981 [00:03<00:34, 25.85it/s]  9%|▉         | 86/981 [00:03<00:34, 25.96it/s]  9%|▉         | 89/981 [00:03<00:34, 25.88it/s]  9%|▉         | 92/981 [00:03<00:33, 26.19it/s] 10%|▉         | 95/981 [00:03<00:33, 26.46it/s] 10%|▉         | 98/981 [00:03<00:33, 26.62it/s] 10%|█         | 101/981 [00:03<00:32, 26.72it/s] 11%|█         | 104/981 [00:03<00:32, 26.82it/s] 11%|█         | 107/981 [00:04<00:33, 26.13it/s] 11%|█         | 110/981 [00:04<00:32, 26.41it/s] 12%|█▏        | 113/981 [00:04<00:32, 26.59it/s] 12%|█▏        | 116/981 [00:04<00:32, 26.72it/s] 12%|█▏        | 119/981 [00:04<00:32, 26.79it/s] 12%|█▏        | 122/981 [00:04<00:32, 26.47it/s] 13%|█▎        | 125/981 [00:04<00:32, 26.61it/s] 13%|█▎        | 128/981 [00:04<00:32, 26.52it/s] 13%|█▎        | 131/981 [00:04<00:32, 26.50it/s] 14%|█▎        | 134/981 [00:05<00:32, 26.42it/s] 14%|█▍        | 137/981 [00:05<00:31, 26.59it/s] 14%|█▍        | 140/981 [00:05<00:31, 26.73it/s] 15%|█▍        | 143/981 [00:05<00:31, 26.82it/s] 15%|█▍        | 146/981 [00:05<00:31, 26.71it/s] 15%|█▌        | 149/981 [00:05<00:31, 26.78it/s] 15%|█▌        | 152/981 [00:05<00:33, 24.89it/s] 16%|█▌        | 155/981 [00:05<00:36, 22.88it/s] 16%|█▌        | 158/981 [00:06<00:36, 22.65it/s] 16%|█▋        | 161/981 [00:06<00:39, 20.75it/s] 17%|█▋        | 164/981 [00:06<00:37, 21.52it/s] 17%|█▋        | 167/981 [00:06<00:35, 22.77it/s] 17%|█▋        | 170/981 [00:06<00:34, 23.78it/s] 18%|█▊        | 173/981 [00:06<00:32, 24.56it/s] 18%|█▊        | 176/981 [00:06<00:32, 24.94it/s] 18%|█▊        | 179/981 [00:06<00:31, 25.45it/s] 19%|█▊        | 182/981 [00:07<00:30, 25.79it/s] 19%|█▉        | 185/981 [00:07<00:30, 26.04it/s] 19%|█▉        | 188/981 [00:07<00:30, 26.26it/s] 19%|█▉        | 191/981 [00:07<00:30, 26.29it/s] 20%|█▉        | 194/981 [00:07<00:29, 26.36it/s] 20%|██        | 197/981 [00:07<00:29, 26.27it/s] 20%|██        | 200/981 [00:07<00:29, 26.40it/s] 21%|██        | 203/981 [00:07<00:29, 26.56it/s] 21%|██        | 206/981 [00:07<00:29, 26.57it/s] 21%|██▏       | 209/981 [00:08<00:29, 26.39it/s] 22%|██▏       | 212/981 [00:08<00:29, 26.28it/s] 22%|██▏       | 215/981 [00:08<00:29, 26.33it/s] 22%|██▏       | 218/981 [00:08<00:28, 26.33it/s] 23%|██▎       | 221/981 [00:08<00:28, 26.38it/s] 23%|██▎       | 224/981 [00:08<00:28, 26.39it/s] 23%|██▎       | 227/981 [00:08<00:28, 26.41it/s] 23%|██▎       | 230/981 [00:08<00:28, 26.42it/s] 24%|██▍       | 233/981 [00:09<00:28, 26.43it/s] 24%|██▍       | 236/981 [00:09<00:28, 26.42it/s] 24%|██▍       | 239/981 [00:09<00:28, 26.42it/s] 25%|██▍       | 242/981 [00:09<00:28, 26.21it/s] 25%|██▍       | 245/981 [00:09<00:29, 25.35it/s] 25%|██▌       | 248/981 [00:09<00:29, 24.59it/s] 26%|██▌       | 251/981 [00:09<00:32, 22.36it/s] 26%|██▌       | 254/981 [00:09<00:35, 20.29it/s] 26%|██▌       | 257/981 [00:10<00:36, 19.59it/s] 27%|██▋       | 260/981 [00:10<00:34, 20.81it/s] 27%|██▋       | 263/981 [00:10<00:32, 22.16it/s] 27%|██▋       | 266/981 [00:10<00:32, 21.92it/s] 27%|██▋       | 269/981 [00:10<00:33, 21.03it/s] 28%|██▊       | 272/981 [00:10<00:34, 20.46it/s] 28%|██▊       | 275/981 [00:10<00:32, 21.87it/s] 28%|██▊       | 278/981 [00:11<00:30, 22.99it/s] 29%|██▊       | 281/981 [00:11<00:29, 23.77it/s] 29%|██▉       | 284/981 [00:11<00:28, 24.37it/s] 29%|██▉       | 287/981 [00:11<00:28, 24.51it/s] 30%|██▉       | 290/981 [00:11<00:27, 24.92it/s] 30%|██▉       | 293/981 [00:11<00:27, 25.24it/s] 30%|███       | 296/981 [00:11<00:27, 25.21it/s] 30%|███       | 299/981 [00:11<00:26, 25.46it/s] 31%|███       | 302/981 [00:11<00:26, 25.65it/s] 31%|███       | 305/981 [00:12<00:27, 24.83it/s] 31%|███▏      | 308/981 [00:12<00:26, 25.18it/s] 32%|███▏      | 311/981 [00:12<00:26, 25.41it/s] 32%|███▏      | 314/981 [00:12<00:26, 25.29it/s] 32%|███▏      | 317/981 [00:12<00:26, 25.26it/s] 33%|███▎      | 320/981 [00:12<00:26, 24.87it/s] 33%|███▎      | 323/981 [00:12<00:26, 25.15it/s] 33%|███▎      | 326/981 [00:12<00:25, 25.42it/s] 34%|███▎      | 329/981 [00:13<00:25, 25.63it/s] 34%|███▍      | 332/981 [00:13<00:25, 25.76it/s] 34%|███▍      | 335/981 [00:13<00:25, 25.71it/s] 34%|███▍      | 338/981 [00:13<00:24, 25.85it/s] 35%|███▍      | 341/981 [00:13<00:24, 25.92it/s] 35%|███▌      | 344/981 [00:13<00:24, 25.96it/s] 35%|███▌      | 347/981 [00:13<00:24, 26.00it/s] 36%|███▌      | 350/981 [00:13<00:24, 25.73it/s] 36%|███▌      | 353/981 [00:13<00:24, 25.63it/s] 36%|███▋      | 356/981 [00:14<00:24, 25.64it/s] 37%|███▋      | 359/981 [00:14<00:24, 25.51it/s] 37%|███▋      | 362/981 [00:14<00:24, 25.46it/s] 37%|███▋      | 365/981 [00:14<00:24, 25.41it/s] 38%|███▊      | 368/981 [00:14<00:24, 25.39it/s] 38%|███▊      | 371/981 [00:14<00:24, 25.38it/s] 38%|███▊      | 374/981 [00:14<00:23, 25.31it/s] 38%|███▊      | 377/981 [00:14<00:23, 25.26it/s] 39%|███▊      | 380/981 [00:15<00:23, 25.25it/s] 39%|███▉      | 383/981 [00:15<00:23, 25.05it/s] 39%|███▉      | 386/981 [00:15<00:23, 25.01it/s] 40%|███▉      | 389/981 [00:15<00:24, 24.55it/s] 40%|███▉      | 392/981 [00:15<00:23, 24.66it/s] 40%|████      | 395/981 [00:15<00:23, 24.80it/s] 41%|████      | 398/981 [00:15<00:23, 25.07it/s] 41%|████      | 401/981 [00:15<00:22, 25.34it/s] 41%|████      | 404/981 [00:15<00:22, 25.40it/s] 41%|████▏     | 407/981 [00:16<00:22, 25.50it/s] 42%|████▏     | 410/981 [00:16<00:22, 25.67it/s] 42%|████▏     | 413/981 [00:16<00:22, 25.81it/s] 42%|████▏     | 416/981 [00:16<00:21, 25.87it/s] 43%|████▎     | 419/981 [00:16<00:21, 25.85it/s] 43%|████▎     | 422/981 [00:16<00:21, 25.89it/s] 43%|████▎     | 425/981 [00:16<00:21, 25.95it/s] 44%|████▎     | 428/981 [00:16<00:21, 25.90it/s] 44%|████▍     | 431/981 [00:17<00:21, 25.95it/s] 44%|████▍     | 434/981 [00:17<00:21, 26.00it/s] 45%|████▍     | 437/981 [00:17<00:20, 26.03it/s] 45%|████▍     | 440/981 [00:17<00:21, 25.75it/s] 45%|████▌     | 443/981 [00:17<00:20, 25.83it/s] 45%|████▌     | 446/981 [00:17<00:20, 25.54it/s] 46%|████▌     | 449/981 [00:17<00:20, 25.51it/s] 46%|████▌     | 452/981 [00:17<00:20, 25.46it/s] 46%|████▋     | 455/981 [00:17<00:20, 25.42it/s] 47%|████▋     | 458/981 [00:18<00:20, 25.14it/s] 47%|████▋     | 461/981 [00:18<00:20, 25.43it/s] 47%|████▋     | 464/981 [00:18<00:20, 24.73it/s] 48%|████▊     | 467/981 [00:18<00:20, 25.12it/s] 48%|████▊     | 470/981 [00:18<00:20, 25.38it/s] 48%|████▊     | 473/981 [00:18<00:19, 25.54it/s] 49%|████▊     | 476/981 [00:18<00:19, 25.53it/s] 49%|████▉     | 479/981 [00:18<00:19, 25.51it/s] 49%|████▉     | 482/981 [00:19<00:19, 25.32it/s] 49%|████▉     | 485/981 [00:19<00:19, 25.19it/s] 50%|████▉     | 488/981 [00:19<00:19, 25.14it/s] 50%|█████     | 491/981 [00:19<00:19, 25.09it/s] 50%|█████     | 494/981 [00:19<00:19, 25.04it/s] 51%|█████     | 497/981 [00:19<00:19, 25.01it/s] 51%|█████     | 500/981 [00:19<00:19, 24.97it/s] 51%|█████▏    | 503/981 [00:19<00:19, 25.09it/s] 52%|█████▏    | 506/981 [00:19<00:18, 25.49it/s] 52%|█████▏    | 509/981 [00:20<00:18, 25.81it/s] 52%|█████▏    | 512/981 [00:20<00:18, 26.02it/s] 52%|█████▏    | 515/981 [00:20<00:17, 26.25it/s] 53%|█████▎    | 518/981 [00:20<00:17, 26.43it/s] 53%|█████▎    | 521/981 [00:20<00:17, 26.55it/s] 53%|█████▎    | 524/981 [00:20<00:17, 26.64it/s] 54%|█████▎    | 527/981 [00:20<00:16, 26.73it/s] 54%|█████▍    | 530/981 [00:20<00:16, 26.72it/s] 54%|█████▍    | 533/981 [00:21<00:16, 26.74it/s] 55%|█████▍    | 536/981 [00:21<00:16, 26.40it/s] 55%|█████▍    | 539/981 [00:21<00:16, 26.35it/s] 55%|█████▌    | 542/981 [00:21<00:16, 26.34it/s] 56%|█████▌    | 545/981 [00:21<00:16, 26.32it/s] 56%|█████▌    | 548/981 [00:21<00:16, 26.31it/s] 56%|█████▌    | 551/981 [00:21<00:16, 26.30it/s] 56%|█████▋    | 554/981 [00:21<00:16, 26.27it/s] 57%|█████▋    | 557/981 [00:21<00:16, 26.31it/s] 57%|█████▋    | 560/981 [00:22<00:16, 26.29it/s] 57%|█████▋    | 563/981 [00:22<00:15, 26.22it/s] 58%|█████▊    | 566/981 [00:22<00:15, 26.26it/s] 58%|█████▊    | 569/981 [00:22<00:15, 26.16it/s] 58%|█████▊    | 572/981 [00:22<00:15, 26.21it/s] 59%|█████▊    | 575/981 [00:22<00:15, 26.25it/s] 59%|█████▉    | 578/981 [00:22<00:15, 26.29it/s] 59%|█████▉    | 581/981 [00:22<00:15, 26.33it/s] 60%|█████▉    | 584/981 [00:22<00:15, 26.25it/s] 60%|█████▉    | 587/981 [00:23<00:15, 26.25it/s] 60%|██████    | 590/981 [00:23<00:14, 26.27it/s] 60%|██████    | 593/981 [00:23<00:14, 26.25it/s] 61%|██████    | 596/981 [00:23<00:14, 26.31it/s] 61%|██████    | 599/981 [00:23<00:14, 26.32it/s] 61%|██████▏   | 602/981 [00:23<00:14, 26.22it/s] 62%|██████▏   | 605/981 [00:23<00:14, 26.26it/s] 62%|██████▏   | 608/981 [00:23<00:14, 26.41it/s] 62%|██████▏   | 611/981 [00:23<00:13, 26.57it/s] 63%|██████▎   | 614/981 [00:24<00:13, 26.74it/s] 63%|██████▎   | 617/981 [00:24<00:13, 26.80it/s] 63%|██████▎   | 620/981 [00:24<00:13, 26.53it/s] 64%|██████▎   | 623/981 [00:24<00:13, 26.55it/s] 64%|██████▍   | 626/981 [00:24<00:13, 26.42it/s] 64%|██████▍   | 629/981 [00:24<00:13, 26.46it/s] 64%|██████▍   | 632/981 [00:24<00:13, 26.47it/s] 65%|██████▍   | 635/981 [00:24<00:13, 26.42it/s] 65%|██████▌   | 638/981 [00:24<00:12, 26.42it/s] 65%|██████▌   | 641/981 [00:25<00:12, 26.30it/s] 66%|██████▌   | 644/981 [00:25<00:12, 26.23it/s] 66%|██████▌   | 647/981 [00:25<00:12, 26.20it/s] 66%|██████▋   | 650/981 [00:25<00:12, 26.26it/s] 67%|██████▋   | 653/981 [00:25<00:12, 26.25it/s] 67%|██████▋   | 656/981 [00:25<00:12, 26.20it/s] 67%|██████▋   | 659/981 [00:25<00:12, 26.29it/s] 67%|██████▋   | 662/981 [00:25<00:12, 26.30it/s] 68%|██████▊   | 665/981 [00:26<00:12, 26.23it/s] 68%|██████▊   | 668/981 [00:26<00:11, 26.20it/s] 68%|██████▊   | 671/981 [00:26<00:11, 26.26it/s] 69%|██████▊   | 674/981 [00:26<00:11, 26.26it/s] 69%|██████▉   | 677/981 [00:26<00:11, 26.12it/s] 69%|██████▉   | 680/981 [00:26<00:11, 26.20it/s] 70%|██████▉   | 683/981 [00:26<00:11, 26.22it/s] 70%|██████▉   | 686/981 [00:26<00:11, 26.22it/s] 70%|███████   | 689/981 [00:26<00:11, 26.28it/s] 71%|███████   | 692/981 [00:27<00:10, 26.32it/s] 71%|███████   | 695/981 [00:27<00:10, 26.27it/s] 71%|███████   | 698/981 [00:27<00:10, 26.17it/s] 71%|███████▏  | 701/981 [00:27<00:10, 26.22it/s] 72%|███████▏  | 704/981 [00:27<00:10, 26.24it/s] 72%|███████▏  | 707/981 [00:27<00:10, 26.17it/s] 72%|███████▏  | 710/981 [00:27<00:10, 26.03it/s] 73%|███████▎  | 713/981 [00:27<00:10, 26.08it/s] 73%|███████▎  | 716/981 [00:27<00:10, 26.15it/s] 73%|███████▎  | 719/981 [00:28<00:09, 26.20it/s] 74%|███████▎  | 722/981 [00:28<00:09, 26.26it/s] 74%|███████▍  | 725/981 [00:28<00:09, 26.24it/s] 74%|███████▍  | 728/981 [00:28<00:09, 26.05it/s] 75%|███████▍  | 731/981 [00:28<00:09, 25.75it/s] 75%|███████▍  | 734/981 [00:28<00:09, 25.92it/s] 75%|███████▌  | 737/981 [00:28<00:09, 26.01it/s] 75%|███████▌  | 740/981 [00:28<00:09, 26.05it/s] 76%|███████▌  | 743/981 [00:29<00:09, 25.87it/s] 76%|███████▌  | 746/981 [00:29<00:08, 26.12it/s] 76%|███████▋  | 749/981 [00:29<00:08, 26.25it/s] 77%|███████▋  | 752/981 [00:29<00:08, 26.32it/s] 77%|███████▋  | 755/981 [00:29<00:08, 26.40it/s] 77%|███████▋  | 758/981 [00:29<00:08, 26.45it/s] 78%|███████▊  | 761/981 [00:29<00:08, 26.53it/s] 78%|███████▊  | 764/981 [00:29<00:08, 26.56it/s] 78%|███████▊  | 767/981 [00:29<00:08, 26.58it/s] 78%|███████▊  | 770/981 [00:30<00:07, 26.60it/s] 79%|███████▉  | 773/981 [00:30<00:07, 26.65it/s] 79%|███████▉  | 776/981 [00:30<00:07, 26.71it/s] 79%|███████▉  | 779/981 [00:30<00:07, 26.86it/s] 80%|███████▉  | 782/981 [00:30<00:07, 27.04it/s] 80%|████████  | 785/981 [00:30<00:07, 27.35it/s] 80%|████████  | 788/981 [00:30<00:06, 27.68it/s] 81%|████████  | 791/981 [00:30<00:06, 28.13it/s] 81%|████████  | 794/981 [00:30<00:06, 28.55it/s] 81%|████████▏ | 798/981 [00:31<00:06, 29.18it/s] 82%|████████▏ | 802/981 [00:31<00:06, 29.60it/s] 82%|████████▏ | 806/981 [00:31<00:05, 29.75it/s] 83%|████████▎ | 810/981 [00:31<00:05, 29.84it/s] 83%|████████▎ | 813/981 [00:31<00:05, 29.88it/s] 83%|████████▎ | 816/981 [00:31<00:05, 29.90it/s] 84%|████████▎ | 820/981 [00:31<00:05, 29.94it/s] 84%|████████▍ | 823/981 [00:31<00:05, 29.87it/s] 84%|████████▍ | 826/981 [00:31<00:05, 29.82it/s] 85%|████████▍ | 829/981 [00:32<00:05, 29.87it/s] 85%|████████▍ | 832/981 [00:32<00:04, 29.84it/s] 85%|████████▌ | 835/981 [00:32<00:04, 29.88it/s] 85%|████████▌ | 838/981 [00:32<00:04, 29.78it/s] 86%|████████▌ | 842/981 [00:32<00:04, 29.85it/s] 86%|████████▌ | 846/981 [00:32<00:04, 29.97it/s] 87%|████████▋ | 850/981 [00:32<00:04, 30.01it/s] 87%|████████▋ | 854/981 [00:32<00:04, 30.08it/s] 87%|████████▋ | 858/981 [00:33<00:04, 30.10it/s] 88%|████████▊ | 862/981 [00:33<00:04, 29.68it/s] 88%|████████▊ | 866/981 [00:33<00:03, 29.07it/s] 89%|████████▊ | 869/981 [00:33<00:03, 28.16it/s] 89%|████████▉ | 873/981 [00:33<00:03, 28.71it/s] 89%|████████▉ | 877/981 [00:33<00:03, 29.24it/s] 90%|████████▉ | 881/981 [00:33<00:03, 29.74it/s] 90%|█████████ | 885/981 [00:33<00:03, 30.10it/s] 91%|█████████ | 889/981 [00:34<00:03, 30.40it/s] 91%|█████████ | 893/981 [00:34<00:02, 30.60it/s] 91%|█████████▏| 897/981 [00:34<00:02, 30.70it/s] 92%|█████████▏| 901/981 [00:34<00:02, 30.59it/s] 92%|█████████▏| 905/981 [00:34<00:02, 30.42it/s] 93%|█████████▎| 909/981 [00:34<00:02, 30.29it/s] 93%|█████████▎| 913/981 [00:34<00:02, 30.19it/s] 93%|█████████▎| 917/981 [00:34<00:02, 30.16it/s] 94%|█████████▍| 921/981 [00:35<00:01, 30.04it/s] 94%|█████████▍| 925/981 [00:35<00:01, 30.12it/s] 95%|█████████▍| 929/981 [00:35<00:01, 30.16it/s] 95%|█████████▌| 933/981 [00:35<00:01, 30.05it/s] 96%|█████████▌| 937/981 [00:35<00:01, 30.09it/s] 96%|█████████▌| 941/981 [00:35<00:01, 30.15it/s] 96%|█████████▋| 945/981 [00:35<00:01, 30.15it/s] 97%|█████████▋| 949/981 [00:36<00:01, 30.02it/s] 97%|█████████▋| 953/981 [00:36<00:00, 30.07it/s] 98%|█████████▊| 957/981 [00:36<00:00, 30.03it/s] 98%|█████████▊| 961/981 [00:36<00:00, 29.95it/s] 98%|█████████▊| 964/981 [00:36<00:00, 29.93it/s] 99%|█████████▊| 968/981 [00:36<00:00, 30.04it/s] 99%|█████████▉| 972/981 [00:36<00:00, 30.07it/s] 99%|█████████▉| 976/981 [00:36<00:00, 30.12it/s]100%|█████████▉| 980/981 [00:37<00:00, 30.14it/s]100%|██████████| 981/981 [00:37<00:00, 26.43it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_LDAM_Normal
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.006, valid loss : 0.007, train acc : 0.983, valid acc : 0.982, train f1 : 0.509, valid f1 : 0.495
training process:   2%|▏         | 1/50 [03:47<3:05:34, 227.24s/it]Best score increase :0.000 -> 0.495
training process:   4%|▍         | 2/50 [06:53<2:42:20, 202.92s/it]EarlyStopping counter : 1 out of 12
training process:   6%|▌         | 3/50 [09:57<2:32:12, 194.30s/it]Best score increase :0.495 -> 0.784
training process:   8%|▊         | 4/50 [13:03<2:26:24, 190.96s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.004, train acc : 0.988, valid acc : 0.988, train f1 : 0.742, valid f1 : 0.799
training process:  10%|█         | 5/50 [16:49<2:32:51, 203.81s/it]Best score increase :0.784 -> 0.799
training process:  12%|█▏        | 6/50 [19:53<2:24:30, 197.07s/it]EarlyStopping counter : 1 out of 12
training process:  14%|█▍        | 7/50 [22:57<2:18:02, 192.61s/it]Best score increase :0.799 -> 0.804
training process:  16%|█▌        | 8/50 [26:01<2:13:00, 190.00s/it]EarlyStopping counter : 1 out of 12
epoch : 9, train loss : 0.004, valid loss : 0.004, train acc : 0.990, valid acc : 0.990, train f1 : 0.787, valid f1 : 0.811
training process:  18%|█▊        | 9/50 [29:49<2:18:00, 201.96s/it]Best score increase :0.804 -> 0.811
training process:  20%|██        | 10/50 [32:55<2:11:19, 196.98s/it]EarlyStopping counter : 1 out of 12
training process:  22%|██▏       | 11/50 [36:02<2:06:07, 194.03s/it]Best score increase :0.811 -> 0.831
training process:  24%|██▍       | 12/50 [39:05<2:00:46, 190.70s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.002, valid loss : 0.003, train acc : 0.993, valid acc : 0.991, train f1 : 0.869, valid f1 : 0.842
training process:  26%|██▌       | 13/50 [42:53<2:04:28, 201.84s/it]Best score increase :0.831 -> 0.842
training process:  28%|██▊       | 14/50 [45:56<1:57:46, 196.30s/it]Best score increase :0.842 -> 0.890
training process:  30%|███       | 15/50 [49:02<1:52:39, 193.12s/it]Best score increase :0.890 -> 0.925
training process:  32%|███▏      | 16/50 [52:07<1:47:56, 190.49s/it]EarlyStopping counter : 1 out of 12
epoch : 17, train loss : 0.002, valid loss : 0.002, train acc : 0.994, valid acc : 0.995, train f1 : 0.893, valid f1 : 0.919
training process:  34%|███▍      | 17/50 [55:54<1:50:52, 201.59s/it]EarlyStopping counter : 2 out of 12
training process:  36%|███▌      | 18/50 [59:00<1:45:05, 197.05s/it]EarlyStopping counter : 3 out of 12
training process:  38%|███▊      | 19/50 [1:02:08<1:40:20, 194.21s/it]EarlyStopping counter : 4 out of 12
training process:  40%|████      | 20/50 [1:05:13<1:35:45, 191.51s/it]Best score increase :0.925 -> 0.929
epoch : 21, train loss : 0.002, valid loss : 0.002, train acc : 0.995, valid acc : 0.996, train f1 : 0.924, valid f1 : 0.936
training process:  42%|████▏     | 21/50 [1:09:02<1:37:57, 202.66s/it]Best score increase :0.929 -> 0.936
training process:  44%|████▍     | 22/50 [1:12:10<1:32:29, 198.20s/it]EarlyStopping counter : 1 out of 12
training process:  46%|████▌     | 23/50 [1:15:15<1:27:28, 194.38s/it]EarlyStopping counter : 2 out of 12
training process:  48%|████▊     | 24/50 [1:18:23<1:23:22, 192.42s/it]EarlyStopping counter : 3 out of 12
epoch : 25, train loss : 0.001, valid loss : 0.002, train acc : 0.996, valid acc : 0.996, train f1 : 0.927, valid f1 : 0.929
training process:  50%|█████     | 25/50 [1:22:10<1:24:31, 202.87s/it]EarlyStopping counter : 4 out of 12
training process:  52%|█████▏    | 26/50 [1:25:18<1:19:21, 198.40s/it]EarlyStopping counter : 5 out of 12
training process:  54%|█████▍    | 27/50 [1:28:25<1:14:40, 194.81s/it]EarlyStopping counter : 6 out of 12
training process:  56%|█████▌    | 28/50 [1:31:32<1:10:37, 192.61s/it]EarlyStopping counter : 7 out of 12
epoch : 29, train loss : 0.001, valid loss : 0.002, train acc : 0.995, valid acc : 0.993, train f1 : 0.926, valid f1 : 0.905
training process:  58%|█████▊    | 29/50 [1:35:21<1:11:15, 203.61s/it]EarlyStopping counter : 8 out of 12
training process:  60%|██████    | 30/50 [1:38:27<1:06:03, 198.15s/it]EarlyStopping counter : 9 out of 12
training process:  62%|██████▏   | 31/50 [1:41:34<1:01:41, 194.83s/it]Best score increase :0.936 -> 0.942
training process:  64%|██████▍   | 32/50 [1:44:39<57:35, 191.99s/it]  EarlyStopping counter : 1 out of 12
epoch : 33, train loss : 0.001, valid loss : 0.001, train acc : 0.996, valid acc : 0.996, train f1 : 0.941, valid f1 : 0.946
training process:  66%|██████▌   | 33/50 [1:48:26<57:20, 202.41s/it]Best score increase :0.942 -> 0.946
training process:  68%|██████▊   | 34/50 [1:51:31<52:34, 197.14s/it]EarlyStopping counter : 1 out of 12
training process:  70%|███████   | 35/50 [1:54:38<48:32, 194.14s/it]EarlyStopping counter : 2 out of 12
training process:  72%|███████▏  | 36/50 [1:57:43<44:38, 191.33s/it]EarlyStopping counter : 3 out of 12
epoch : 37, train loss : 0.001, valid loss : 0.001, train acc : 0.996, valid acc : 0.995, train f1 : 0.928, valid f1 : 0.929
training process:  74%|███████▍  | 37/50 [2:01:29<43:43, 201.78s/it]EarlyStopping counter : 4 out of 12
training process:  76%|███████▌  | 38/50 [2:04:35<39:24, 197.03s/it]EarlyStopping counter : 5 out of 12
training process:  78%|███████▊  | 39/50 [2:07:40<35:28, 193.48s/it]EarlyStopping counter : 6 out of 12
training process:  80%|████████  | 40/50 [2:10:45<31:49, 190.97s/it]EarlyStopping counter : 7 out of 12
epoch : 41, train loss : 0.001, valid loss : 0.002, train acc : 0.996, valid acc : 0.995, train f1 : 0.935, valid f1 : 0.926
training process:  82%|████████▏ | 41/50 [2:14:32<30:16, 201.87s/it]EarlyStopping counter : 8 out of 12
training process:  84%|████████▍ | 42/50 [2:17:38<26:14, 196.85s/it]EarlyStopping counter : 9 out of 12
training process:  86%|████████▌ | 43/50 [2:20:44<22:35, 193.68s/it]EarlyStopping counter : 10 out of 12
training process:  88%|████████▊ | 44/50 [2:23:49<19:07, 191.18s/it]EarlyStopping counter : 11 out of 12
epoch : 45, train loss : 0.001, valid loss : 0.001, train acc : 0.996, valid acc : 0.996, train f1 : 0.942, valid f1 : 0.934
training process:  88%|████████▊ | 44/50 [2:27:35<20:07, 201.27s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 44, best f1 score : 0.946
training process finished, best loss : 0.001 and best acc : 0.996, best f1 : 0.946, best epoch : 32

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.76      0.83      0.79        71
           1       1.00      1.00      1.00      3812

    accuracy                           0.99      3883
   macro avg       0.88      0.91      0.89      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.89, test AUC : 0.91, test loss : 0.033

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:37, 26.15it/s]  1%|          | 6/981 [00:00<00:37, 26.29it/s]  1%|          | 9/981 [00:00<00:36, 26.43it/s]  1%|          | 12/981 [00:00<00:36, 26.44it/s]  2%|▏         | 15/981 [00:00<00:36, 26.43it/s]  2%|▏         | 18/981 [00:00<00:36, 26.25it/s]  2%|▏         | 21/981 [00:00<00:36, 26.34it/s]  2%|▏         | 24/981 [00:00<00:36, 26.50it/s]  3%|▎         | 27/981 [00:01<00:36, 26.43it/s]  3%|▎         | 30/981 [00:01<00:35, 26.53it/s]  3%|▎         | 33/981 [00:01<00:35, 26.35it/s]  4%|▎         | 36/981 [00:01<00:35, 26.54it/s]  4%|▍         | 39/981 [00:01<00:35, 26.64it/s]  4%|▍         | 42/981 [00:01<00:35, 26.74it/s]  5%|▍         | 45/981 [00:01<00:34, 26.78it/s]  5%|▍         | 48/981 [00:01<00:34, 26.81it/s]  5%|▌         | 51/981 [00:01<00:34, 26.81it/s]  6%|▌         | 54/981 [00:02<00:34, 26.75it/s]  6%|▌         | 57/981 [00:02<00:34, 26.82it/s]  6%|▌         | 60/981 [00:02<00:34, 26.81it/s]  6%|▋         | 63/981 [00:02<00:34, 26.87it/s]  7%|▋         | 66/981 [00:02<00:34, 26.88it/s]  7%|▋         | 69/981 [00:02<00:33, 26.84it/s]  7%|▋         | 72/981 [00:02<00:33, 26.82it/s]  8%|▊         | 75/981 [00:02<00:33, 26.85it/s]  8%|▊         | 78/981 [00:02<00:33, 26.83it/s]  8%|▊         | 81/981 [00:03<00:33, 26.85it/s]  9%|▊         | 84/981 [00:03<00:33, 26.77it/s]  9%|▉         | 87/981 [00:03<00:33, 26.75it/s]  9%|▉         | 90/981 [00:03<00:33, 26.56it/s]  9%|▉         | 93/981 [00:03<00:33, 26.56it/s] 10%|▉         | 96/981 [00:03<00:33, 26.59it/s] 10%|█         | 99/981 [00:03<00:33, 26.58it/s] 10%|█         | 102/981 [00:03<00:33, 26.58it/s] 11%|█         | 105/981 [00:03<00:32, 26.61it/s] 11%|█         | 108/981 [00:04<00:32, 26.58it/s] 11%|█▏        | 111/981 [00:04<00:32, 26.56it/s] 12%|█▏        | 114/981 [00:04<00:32, 26.47it/s] 12%|█▏        | 117/981 [00:04<00:33, 26.17it/s] 12%|█▏        | 120/981 [00:04<00:32, 26.24it/s] 13%|█▎        | 123/981 [00:04<00:32, 26.19it/s] 13%|█▎        | 126/981 [00:04<00:32, 26.12it/s] 13%|█▎        | 129/981 [00:04<00:32, 26.23it/s] 13%|█▎        | 132/981 [00:04<00:32, 26.30it/s] 14%|█▍        | 135/981 [00:05<00:32, 26.32it/s] 14%|█▍        | 138/981 [00:05<00:31, 26.37it/s] 14%|█▍        | 141/981 [00:05<00:31, 26.47it/s] 15%|█▍        | 144/981 [00:05<00:31, 26.58it/s] 15%|█▍        | 147/981 [00:05<00:31, 26.55it/s] 15%|█▌        | 150/981 [00:05<00:31, 26.57it/s] 16%|█▌        | 153/981 [00:05<00:31, 26.61it/s] 16%|█▌        | 156/981 [00:05<00:30, 26.65it/s] 16%|█▌        | 159/981 [00:05<00:31, 26.52it/s] 17%|█▋        | 162/981 [00:06<00:30, 26.49it/s] 17%|█▋        | 165/981 [00:06<00:30, 26.58it/s] 17%|█▋        | 168/981 [00:06<00:30, 26.66it/s] 17%|█▋        | 171/981 [00:06<00:30, 26.62it/s] 18%|█▊        | 174/981 [00:06<00:30, 26.72it/s] 18%|█▊        | 177/981 [00:06<00:29, 26.80it/s] 18%|█▊        | 180/981 [00:06<00:29, 26.84it/s] 19%|█▊        | 183/981 [00:06<00:29, 26.83it/s] 19%|█▉        | 186/981 [00:06<00:29, 26.93it/s] 19%|█▉        | 189/981 [00:07<00:29, 26.95it/s] 20%|█▉        | 192/981 [00:07<00:29, 26.85it/s] 20%|█▉        | 195/981 [00:07<00:29, 26.70it/s] 20%|██        | 198/981 [00:07<00:29, 26.68it/s] 20%|██        | 201/981 [00:07<00:29, 26.67it/s] 21%|██        | 204/981 [00:07<00:29, 26.35it/s] 21%|██        | 207/981 [00:07<00:29, 26.36it/s] 21%|██▏       | 210/981 [00:07<00:29, 26.31it/s] 22%|██▏       | 213/981 [00:08<00:29, 26.25it/s] 22%|██▏       | 216/981 [00:08<00:29, 26.21it/s] 22%|██▏       | 219/981 [00:08<00:29, 26.21it/s] 23%|██▎       | 222/981 [00:08<00:29, 26.15it/s] 23%|██▎       | 225/981 [00:08<00:28, 26.07it/s] 23%|██▎       | 228/981 [00:08<00:29, 25.90it/s] 24%|██▎       | 231/981 [00:08<00:28, 25.86it/s] 24%|██▍       | 234/981 [00:08<00:28, 25.93it/s] 24%|██▍       | 237/981 [00:08<00:28, 25.95it/s] 24%|██▍       | 240/981 [00:09<00:28, 25.98it/s] 25%|██▍       | 243/981 [00:09<00:28, 25.74it/s] 25%|██▌       | 246/981 [00:09<00:28, 25.81it/s] 25%|██▌       | 249/981 [00:09<00:28, 25.87it/s] 26%|██▌       | 252/981 [00:09<00:28, 25.97it/s] 26%|██▌       | 255/981 [00:09<00:27, 26.06it/s] 26%|██▋       | 258/981 [00:09<00:27, 26.11it/s] 27%|██▋       | 261/981 [00:09<00:27, 26.03it/s] 27%|██▋       | 264/981 [00:09<00:27, 25.98it/s] 27%|██▋       | 267/981 [00:10<00:27, 26.11it/s] 28%|██▊       | 270/981 [00:10<00:27, 26.12it/s] 28%|██▊       | 273/981 [00:10<00:27, 26.15it/s] 28%|██▊       | 276/981 [00:10<00:26, 26.17it/s] 28%|██▊       | 279/981 [00:10<00:26, 26.07it/s] 29%|██▊       | 282/981 [00:10<00:26, 26.10it/s] 29%|██▉       | 285/981 [00:10<00:26, 26.16it/s] 29%|██▉       | 288/981 [00:10<00:26, 26.19it/s] 30%|██▉       | 291/981 [00:11<00:26, 26.24it/s] 30%|██▉       | 294/981 [00:11<00:26, 25.98it/s] 30%|███       | 297/981 [00:11<00:26, 25.73it/s] 31%|███       | 300/981 [00:11<00:26, 25.85it/s] 31%|███       | 303/981 [00:11<00:26, 25.93it/s] 31%|███       | 306/981 [00:11<00:25, 26.01it/s] 31%|███▏      | 309/981 [00:11<00:25, 26.09it/s] 32%|███▏      | 312/981 [00:11<00:25, 26.14it/s] 32%|███▏      | 315/981 [00:11<00:25, 26.20it/s] 32%|███▏      | 318/981 [00:12<00:25, 26.23it/s] 33%|███▎      | 321/981 [00:12<00:25, 26.25it/s] 33%|███▎      | 324/981 [00:12<00:25, 26.26it/s] 33%|███▎      | 327/981 [00:12<00:24, 26.25it/s] 34%|███▎      | 330/981 [00:12<00:24, 26.08it/s] 34%|███▍      | 333/981 [00:12<00:25, 25.89it/s] 34%|███▍      | 336/981 [00:12<00:24, 25.82it/s] 35%|███▍      | 339/981 [00:12<00:24, 25.97it/s] 35%|███▍      | 342/981 [00:12<00:24, 26.07it/s] 35%|███▌      | 345/981 [00:13<00:24, 26.10it/s] 35%|███▌      | 348/981 [00:13<00:24, 26.13it/s] 36%|███▌      | 351/981 [00:13<00:24, 26.16it/s] 36%|███▌      | 354/981 [00:13<00:23, 26.22it/s] 36%|███▋      | 357/981 [00:13<00:23, 26.20it/s] 37%|███▋      | 360/981 [00:13<00:23, 26.17it/s] 37%|███▋      | 363/981 [00:13<00:23, 26.04it/s] 37%|███▋      | 366/981 [00:13<00:23, 25.72it/s] 38%|███▊      | 369/981 [00:14<00:23, 25.80it/s] 38%|███▊      | 372/981 [00:14<00:23, 25.87it/s] 38%|███▊      | 375/981 [00:14<00:23, 25.92it/s] 39%|███▊      | 378/981 [00:14<00:23, 25.98it/s] 39%|███▉      | 381/981 [00:14<00:23, 26.02it/s] 39%|███▉      | 384/981 [00:14<00:22, 26.05it/s] 39%|███▉      | 387/981 [00:14<00:22, 26.06it/s] 40%|███▉      | 390/981 [00:14<00:22, 26.04it/s] 40%|████      | 393/981 [00:14<00:22, 26.06it/s] 40%|████      | 396/981 [00:15<00:22, 26.02it/s] 41%|████      | 399/981 [00:15<00:22, 25.66it/s] 41%|████      | 402/981 [00:15<00:22, 25.80it/s] 41%|████▏     | 405/981 [00:15<00:22, 25.91it/s] 42%|████▏     | 408/981 [00:15<00:22, 26.03it/s] 42%|████▏     | 411/981 [00:15<00:21, 26.09it/s] 42%|████▏     | 414/981 [00:15<00:21, 26.15it/s] 43%|████▎     | 417/981 [00:15<00:21, 26.18it/s] 43%|████▎     | 420/981 [00:15<00:21, 26.06it/s] 43%|████▎     | 423/981 [00:16<00:21, 26.14it/s] 43%|████▎     | 426/981 [00:16<00:21, 26.20it/s] 44%|████▎     | 429/981 [00:16<00:21, 26.25it/s] 44%|████▍     | 432/981 [00:16<00:21, 26.09it/s] 44%|████▍     | 435/981 [00:16<00:20, 26.11it/s] 45%|████▍     | 438/981 [00:16<00:20, 26.08it/s] 45%|████▍     | 441/981 [00:16<00:20, 26.09it/s] 45%|████▌     | 444/981 [00:16<00:20, 26.10it/s] 46%|████▌     | 447/981 [00:17<00:20, 25.83it/s] 46%|████▌     | 450/981 [00:17<00:20, 25.95it/s] 46%|████▌     | 453/981 [00:17<00:20, 26.07it/s] 46%|████▋     | 456/981 [00:17<00:20, 26.15it/s] 47%|████▋     | 459/981 [00:17<00:19, 26.18it/s] 47%|████▋     | 462/981 [00:17<00:19, 26.19it/s] 47%|████▋     | 465/981 [00:17<00:19, 26.09it/s] 48%|████▊     | 468/981 [00:17<00:19, 26.10it/s] 48%|████▊     | 471/981 [00:17<00:19, 26.16it/s] 48%|████▊     | 474/981 [00:18<00:19, 26.23it/s] 49%|████▊     | 477/981 [00:18<00:19, 26.21it/s] 49%|████▉     | 480/981 [00:18<00:19, 25.93it/s] 49%|████▉     | 483/981 [00:18<00:19, 26.01it/s] 50%|████▉     | 486/981 [00:18<00:18, 26.15it/s] 50%|████▉     | 489/981 [00:18<00:19, 25.75it/s] 50%|█████     | 492/981 [00:18<00:19, 24.60it/s] 50%|█████     | 495/981 [00:18<00:20, 23.90it/s] 51%|█████     | 498/981 [00:19<00:20, 23.34it/s] 51%|█████     | 501/981 [00:19<00:20, 23.06it/s] 51%|█████▏    | 504/981 [00:19<00:20, 23.25it/s] 52%|█████▏    | 507/981 [00:19<00:19, 24.12it/s] 52%|█████▏    | 510/981 [00:19<00:18, 24.80it/s] 52%|█████▏    | 513/981 [00:19<00:18, 25.36it/s] 53%|█████▎    | 516/981 [00:19<00:18, 25.71it/s] 53%|█████▎    | 519/981 [00:19<00:17, 26.06it/s] 53%|█████▎    | 522/981 [00:19<00:17, 26.29it/s] 54%|█████▎    | 525/981 [00:20<00:17, 26.46it/s] 54%|█████▍    | 528/981 [00:20<00:17, 26.59it/s] 54%|█████▍    | 531/981 [00:20<00:16, 26.54it/s] 54%|█████▍    | 534/981 [00:20<00:16, 26.62it/s] 55%|█████▍    | 537/981 [00:20<00:16, 26.70it/s] 55%|█████▌    | 540/981 [00:20<00:16, 26.76it/s] 55%|█████▌    | 543/981 [00:20<00:16, 26.79it/s] 56%|█████▌    | 546/981 [00:20<00:16, 26.82it/s] 56%|█████▌    | 549/981 [00:20<00:16, 26.91it/s] 56%|█████▋    | 552/981 [00:21<00:15, 26.95it/s] 57%|█████▋    | 555/981 [00:21<00:15, 27.03it/s] 57%|█████▋    | 558/981 [00:21<00:15, 27.04it/s] 57%|█████▋    | 561/981 [00:21<00:15, 27.12it/s] 57%|█████▋    | 564/981 [00:21<00:15, 27.07it/s] 58%|█████▊    | 567/981 [00:21<00:15, 26.91it/s] 58%|█████▊    | 570/981 [00:21<00:15, 26.88it/s] 58%|█████▊    | 573/981 [00:21<00:15, 27.00it/s] 59%|█████▊    | 576/981 [00:21<00:15, 26.87it/s] 59%|█████▉    | 579/981 [00:22<00:15, 26.79it/s] 59%|█████▉    | 582/981 [00:22<00:14, 26.88it/s] 60%|█████▉    | 585/981 [00:22<00:14, 26.99it/s] 60%|█████▉    | 588/981 [00:22<00:14, 27.06it/s] 60%|██████    | 591/981 [00:22<00:14, 27.11it/s] 61%|██████    | 594/981 [00:22<00:14, 27.16it/s] 61%|██████    | 597/981 [00:22<00:14, 27.10it/s] 61%|██████    | 600/981 [00:22<00:14, 27.06it/s] 61%|██████▏   | 603/981 [00:22<00:14, 26.95it/s] 62%|██████▏   | 606/981 [00:23<00:14, 26.55it/s] 62%|██████▏   | 609/981 [00:23<00:13, 26.70it/s] 62%|██████▏   | 612/981 [00:23<00:13, 26.81it/s] 63%|██████▎   | 615/981 [00:23<00:13, 26.91it/s] 63%|██████▎   | 618/981 [00:23<00:13, 26.94it/s] 63%|██████▎   | 621/981 [00:23<00:13, 27.00it/s] 64%|██████▎   | 624/981 [00:23<00:13, 26.99it/s] 64%|██████▍   | 627/981 [00:23<00:13, 27.01it/s] 64%|██████▍   | 630/981 [00:23<00:12, 27.07it/s] 65%|██████▍   | 633/981 [00:24<00:12, 27.12it/s] 65%|██████▍   | 636/981 [00:24<00:12, 26.99it/s] 65%|██████▌   | 639/981 [00:24<00:12, 27.03it/s] 65%|██████▌   | 642/981 [00:24<00:12, 27.06it/s] 66%|██████▌   | 645/981 [00:24<00:12, 27.09it/s] 66%|██████▌   | 648/981 [00:24<00:12, 27.04it/s] 66%|██████▋   | 651/981 [00:24<00:12, 27.04it/s] 67%|██████▋   | 654/981 [00:24<00:12, 27.05it/s] 67%|██████▋   | 657/981 [00:24<00:11, 27.05it/s] 67%|██████▋   | 660/981 [00:25<00:11, 27.06it/s] 68%|██████▊   | 663/981 [00:25<00:11, 27.08it/s] 68%|██████▊   | 666/981 [00:25<00:11, 27.12it/s] 68%|██████▊   | 669/981 [00:25<00:11, 27.12it/s] 69%|██████▊   | 672/981 [00:25<00:11, 26.94it/s] 69%|██████▉   | 675/981 [00:25<00:11, 26.95it/s] 69%|██████▉   | 678/981 [00:25<00:11, 27.01it/s] 69%|██████▉   | 681/981 [00:25<00:11, 27.05it/s] 70%|██████▉   | 684/981 [00:25<00:10, 27.10it/s] 70%|███████   | 687/981 [00:26<00:10, 27.13it/s] 70%|███████   | 690/981 [00:26<00:10, 27.11it/s] 71%|███████   | 693/981 [00:26<00:10, 27.07it/s] 71%|███████   | 696/981 [00:26<00:10, 26.96it/s] 71%|███████▏  | 699/981 [00:26<00:10, 27.01it/s] 72%|███████▏  | 702/981 [00:26<00:10, 27.10it/s] 72%|███████▏  | 705/981 [00:26<00:10, 27.05it/s] 72%|███████▏  | 708/981 [00:26<00:10, 26.93it/s] 72%|███████▏  | 711/981 [00:26<00:10, 26.90it/s] 73%|███████▎  | 714/981 [00:27<00:09, 26.94it/s] 73%|███████▎  | 717/981 [00:27<00:09, 26.97it/s] 73%|███████▎  | 720/981 [00:27<00:09, 26.68it/s] 74%|███████▎  | 723/981 [00:27<00:09, 26.85it/s] 74%|███████▍  | 726/981 [00:27<00:09, 26.86it/s] 74%|███████▍  | 729/981 [00:27<00:09, 26.90it/s] 75%|███████▍  | 732/981 [00:27<00:09, 26.89it/s] 75%|███████▍  | 735/981 [00:27<00:09, 26.86it/s] 75%|███████▌  | 738/981 [00:27<00:09, 26.87it/s] 76%|███████▌  | 741/981 [00:28<00:08, 26.75it/s] 76%|███████▌  | 744/981 [00:28<00:08, 26.71it/s] 76%|███████▌  | 747/981 [00:28<00:08, 26.77it/s] 76%|███████▋  | 750/981 [00:28<00:08, 27.02it/s] 77%|███████▋  | 753/981 [00:28<00:08, 27.18it/s] 77%|███████▋  | 756/981 [00:28<00:08, 27.12it/s] 77%|███████▋  | 759/981 [00:28<00:08, 26.88it/s] 78%|███████▊  | 762/981 [00:28<00:08, 26.77it/s] 78%|███████▊  | 765/981 [00:28<00:08, 25.95it/s] 78%|███████▊  | 768/981 [00:29<00:08, 24.53it/s] 79%|███████▊  | 771/981 [00:29<00:08, 24.57it/s] 79%|███████▉  | 774/981 [00:29<00:08, 25.41it/s] 79%|███████▉  | 777/981 [00:29<00:07, 26.01it/s] 80%|███████▉  | 780/981 [00:29<00:07, 26.36it/s] 80%|███████▉  | 783/981 [00:29<00:07, 27.04it/s] 80%|████████  | 786/981 [00:29<00:07, 27.73it/s] 80%|████████  | 789/981 [00:29<00:06, 28.37it/s] 81%|████████  | 793/981 [00:30<00:06, 29.11it/s] 81%|████████  | 797/981 [00:30<00:06, 29.92it/s] 82%|████████▏ | 801/981 [00:30<00:05, 30.54it/s] 82%|████████▏ | 805/981 [00:30<00:05, 30.98it/s] 82%|████████▏ | 809/981 [00:30<00:05, 31.29it/s] 83%|████████▎ | 813/981 [00:30<00:05, 31.51it/s] 83%|████████▎ | 817/981 [00:30<00:05, 31.49it/s] 84%|████████▎ | 821/981 [00:30<00:05, 31.57it/s] 84%|████████▍ | 825/981 [00:31<00:04, 31.52it/s] 85%|████████▍ | 829/981 [00:31<00:04, 31.63it/s] 85%|████████▍ | 833/981 [00:31<00:04, 31.65it/s] 85%|████████▌ | 837/981 [00:31<00:04, 31.71it/s] 86%|████████▌ | 841/981 [00:31<00:04, 31.83it/s] 86%|████████▌ | 845/981 [00:31<00:04, 31.90it/s] 87%|████████▋ | 849/981 [00:31<00:04, 31.97it/s] 87%|████████▋ | 853/981 [00:31<00:03, 32.00it/s] 87%|████████▋ | 857/981 [00:32<00:03, 32.02it/s] 88%|████████▊ | 861/981 [00:32<00:03, 31.97it/s] 88%|████████▊ | 865/981 [00:32<00:03, 32.01it/s] 89%|████████▊ | 869/981 [00:32<00:03, 31.95it/s] 89%|████████▉ | 873/981 [00:32<00:03, 31.81it/s] 89%|████████▉ | 877/981 [00:32<00:03, 31.83it/s] 90%|████████▉ | 881/981 [00:32<00:03, 31.86it/s] 90%|█████████ | 885/981 [00:32<00:02, 32.01it/s] 91%|█████████ | 889/981 [00:33<00:02, 31.94it/s] 91%|█████████ | 893/981 [00:33<00:02, 31.52it/s] 91%|█████████▏| 897/981 [00:33<00:02, 31.58it/s] 92%|█████████▏| 901/981 [00:33<00:02, 31.66it/s] 92%|█████████▏| 905/981 [00:33<00:02, 31.76it/s] 93%|█████████▎| 909/981 [00:33<00:02, 31.68it/s] 93%|█████████▎| 913/981 [00:33<00:02, 31.74it/s] 93%|█████████▎| 917/981 [00:33<00:02, 31.70it/s] 94%|█████████▍| 921/981 [00:34<00:01, 31.86it/s] 94%|█████████▍| 925/981 [00:34<00:01, 31.93it/s] 95%|█████████▍| 929/981 [00:34<00:01, 32.02it/s] 95%|█████████▌| 933/981 [00:34<00:01, 31.96it/s] 96%|█████████▌| 937/981 [00:34<00:01, 31.75it/s] 96%|█████████▌| 941/981 [00:34<00:01, 31.86it/s] 96%|█████████▋| 945/981 [00:34<00:01, 31.83it/s] 97%|█████████▋| 949/981 [00:34<00:01, 31.84it/s] 97%|█████████▋| 953/981 [00:35<00:00, 31.83it/s] 98%|█████████▊| 957/981 [00:35<00:00, 31.83it/s] 98%|█████████▊| 961/981 [00:35<00:00, 31.88it/s] 98%|█████████▊| 965/981 [00:35<00:00, 31.91it/s] 99%|█████████▉| 969/981 [00:35<00:00, 32.00it/s] 99%|█████████▉| 973/981 [00:35<00:00, 32.00it/s]100%|█████████▉| 977/981 [00:35<00:00, 32.05it/s]100%|██████████| 981/981 [00:35<00:00, 32.08it/s]100%|██████████| 981/981 [00:35<00:00, 27.32it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_LDAM_RS
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.023, valid loss : 0.032, train acc : 0.848, valid acc : 0.828, train f1 : 0.848, valid f1 : 0.534
training process:   2%|▏         | 1/50 [03:48<3:06:35, 228.48s/it]Best score increase :0.000 -> 0.534
training process:   4%|▍         | 2/50 [06:53<2:42:06, 202.64s/it]Best score increase :0.534 -> 0.647
training process:   6%|▌         | 3/50 [09:59<2:32:50, 195.11s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 4/50 [13:04<2:26:32, 191.15s/it]Best score increase :0.647 -> 0.718
epoch : 5, train loss : 0.010, valid loss : 0.005, train acc : 0.937, valid acc : 0.960, train f1 : 0.937, valid f1 : 0.718
training process:  10%|█         | 5/50 [16:52<2:33:27, 204.60s/it]EarlyStopping counter : 1 out of 12
training process:  12%|█▏        | 6/50 [19:58<2:25:24, 198.28s/it]EarlyStopping counter : 2 out of 12
training process:  14%|█▍        | 7/50 [23:03<2:18:53, 193.79s/it]EarlyStopping counter : 3 out of 12
training process:  16%|█▌        | 8/50 [26:07<2:13:31, 190.74s/it]EarlyStopping counter : 4 out of 12
epoch : 9, train loss : 0.008, valid loss : 0.009, train acc : 0.947, valid acc : 0.926, train f1 : 0.947, valid f1 : 0.642
training process:  18%|█▊        | 9/50 [29:55<2:18:21, 202.47s/it]EarlyStopping counter : 5 out of 12
training process:  20%|██        | 10/50 [33:00<2:11:16, 196.90s/it]EarlyStopping counter : 6 out of 12
training process:  22%|██▏       | 11/50 [36:05<2:05:41, 193.37s/it]Best score increase :0.718 -> 0.816
training process:  24%|██▍       | 12/50 [39:07<2:00:12, 189.79s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.008, valid loss : 0.011, train acc : 0.946, valid acc : 0.936, train f1 : 0.946, valid f1 : 0.654
training process:  26%|██▌       | 13/50 [42:33<2:00:05, 194.75s/it]EarlyStopping counter : 2 out of 12
training process:  28%|██▊       | 14/50 [45:21<1:52:03, 186.77s/it]EarlyStopping counter : 3 out of 12
training process:  30%|███       | 15/50 [48:11<1:45:55, 181.60s/it]EarlyStopping counter : 4 out of 12
training process:  32%|███▏      | 16/50 [51:00<1:40:52, 178.02s/it]EarlyStopping counter : 5 out of 12
epoch : 17, train loss : 0.007, valid loss : 0.011, train acc : 0.954, valid acc : 0.916, train f1 : 0.954, valid f1 : 0.619
training process:  34%|███▍      | 17/50 [54:27<1:42:42, 186.74s/it]EarlyStopping counter : 6 out of 12
training process:  36%|███▌      | 18/50 [57:18<1:36:58, 181.82s/it]EarlyStopping counter : 7 out of 12
training process:  38%|███▊      | 19/50 [1:00:09<1:32:21, 178.75s/it]Best score increase :0.816 -> 0.861
training process:  40%|████      | 20/50 [1:02:59<1:27:59, 175.98s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.006, valid loss : 0.006, train acc : 0.958, valid acc : 0.947, train f1 : 0.958, valid f1 : 0.676
training process:  42%|████▏     | 21/50 [1:06:29<1:29:58, 186.16s/it]EarlyStopping counter : 2 out of 12
training process:  44%|████▍     | 22/50 [1:09:19<1:24:34, 181.25s/it]EarlyStopping counter : 3 out of 12
training process:  46%|████▌     | 23/50 [1:12:08<1:19:59, 177.76s/it]EarlyStopping counter : 4 out of 12
training process:  48%|████▊     | 24/50 [1:14:57<1:15:53, 175.15s/it]EarlyStopping counter : 5 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.008, train acc : 0.964, valid acc : 0.954, train f1 : 0.964, valid f1 : 0.700
training process:  50%|█████     | 25/50 [1:18:26<1:17:07, 185.09s/it]EarlyStopping counter : 6 out of 12
training process:  52%|█████▏    | 26/50 [1:21:14<1:12:01, 180.08s/it]EarlyStopping counter : 7 out of 12
training process:  54%|█████▍    | 27/50 [1:24:02<1:07:36, 176.36s/it]EarlyStopping counter : 8 out of 12
training process:  56%|█████▌    | 28/50 [1:26:51<1:03:51, 174.17s/it]EarlyStopping counter : 9 out of 12
epoch : 29, train loss : 0.005, valid loss : 0.004, train acc : 0.966, valid acc : 0.971, train f1 : 0.966, valid f1 : 0.753
training process:  58%|█████▊    | 29/50 [1:30:19<1:04:31, 184.38s/it]EarlyStopping counter : 10 out of 12
training process:  60%|██████    | 30/50 [1:33:09<59:58, 179.94s/it]  EarlyStopping counter : 11 out of 12
training process:  60%|██████    | 30/50 [1:35:57<1:03:58, 191.93s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 30, best f1 score : 0.861
training process finished, best loss : 0.003 and best acc : 0.988, best f1 : 0.861, best epoch : 18

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.83      0.70        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.80      0.91      0.85      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.85, test AUC : 0.91, test loss : 0.075

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:41, 23.80it/s]  1%|          | 6/981 [00:00<00:38, 25.18it/s]  1%|          | 9/981 [00:00<00:37, 25.88it/s]  1%|          | 12/981 [00:00<00:37, 26.04it/s]  2%|▏         | 15/981 [00:00<00:36, 26.25it/s]  2%|▏         | 18/981 [00:00<00:36, 26.45it/s]  2%|▏         | 21/981 [00:00<00:36, 26.57it/s]  2%|▏         | 24/981 [00:00<00:35, 26.59it/s]  3%|▎         | 27/981 [00:01<00:35, 26.60it/s]  3%|▎         | 30/981 [00:01<00:35, 26.49it/s]  3%|▎         | 33/981 [00:01<00:35, 26.64it/s]  4%|▎         | 36/981 [00:01<00:35, 26.65it/s]  4%|▍         | 39/981 [00:01<00:35, 26.72it/s]  4%|▍         | 42/981 [00:01<00:35, 26.31it/s]  5%|▍         | 45/981 [00:01<00:35, 26.25it/s]  5%|▍         | 48/981 [00:01<00:35, 26.30it/s]  5%|▌         | 51/981 [00:01<00:35, 26.46it/s]  6%|▌         | 54/981 [00:02<00:34, 26.62it/s]  6%|▌         | 57/981 [00:02<00:34, 26.54it/s]  6%|▌         | 60/981 [00:02<00:34, 26.64it/s]  6%|▋         | 63/981 [00:02<00:34, 26.68it/s]  7%|▋         | 66/981 [00:02<00:34, 26.72it/s]  7%|▋         | 69/981 [00:02<00:34, 26.46it/s]  7%|▋         | 72/981 [00:02<00:34, 26.46it/s]  8%|▊         | 75/981 [00:02<00:35, 25.30it/s]  8%|▊         | 78/981 [00:02<00:37, 23.96it/s]  8%|▊         | 81/981 [00:03<00:38, 23.40it/s]  9%|▊         | 84/981 [00:03<00:40, 22.23it/s]  9%|▉         | 87/981 [00:03<00:40, 21.89it/s]  9%|▉         | 90/981 [00:03<00:40, 22.04it/s]  9%|▉         | 93/981 [00:03<00:39, 22.26it/s] 10%|▉         | 96/981 [00:03<00:39, 22.32it/s] 10%|█         | 99/981 [00:03<00:39, 22.42it/s] 10%|█         | 102/981 [00:04<00:38, 23.07it/s] 11%|█         | 105/981 [00:04<00:36, 23.70it/s] 11%|█         | 108/981 [00:04<00:35, 24.25it/s] 11%|█▏        | 111/981 [00:04<00:35, 24.84it/s] 12%|█▏        | 114/981 [00:04<00:38, 22.66it/s] 12%|█▏        | 117/981 [00:04<00:39, 22.05it/s] 12%|█▏        | 120/981 [00:04<00:37, 23.02it/s] 13%|█▎        | 123/981 [00:04<00:36, 23.70it/s] 13%|█▎        | 126/981 [00:05<00:35, 24.24it/s] 13%|█▎        | 129/981 [00:05<00:34, 24.67it/s] 13%|█▎        | 132/981 [00:05<00:34, 24.94it/s] 14%|█▍        | 135/981 [00:05<00:33, 25.20it/s] 14%|█▍        | 138/981 [00:05<00:33, 25.23it/s] 14%|█▍        | 141/981 [00:05<00:34, 24.37it/s] 15%|█▍        | 144/981 [00:05<00:35, 23.59it/s] 15%|█▍        | 147/981 [00:05<00:35, 23.37it/s] 15%|█▌        | 150/981 [00:06<00:35, 23.14it/s] 16%|█▌        | 153/981 [00:06<00:34, 23.71it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.43it/s] 16%|█▌        | 159/981 [00:06<00:32, 25.34it/s] 17%|█▋        | 162/981 [00:06<00:31, 25.78it/s] 17%|█▋        | 165/981 [00:06<00:30, 26.33it/s] 17%|█▋        | 168/981 [00:06<00:30, 26.70it/s] 17%|█▋        | 171/981 [00:06<00:30, 26.99it/s] 18%|█▊        | 174/981 [00:06<00:29, 27.28it/s] 18%|█▊        | 177/981 [00:07<00:29, 27.45it/s] 18%|█▊        | 180/981 [00:07<00:29, 27.43it/s] 19%|█▊        | 183/981 [00:07<00:28, 27.54it/s] 19%|█▉        | 186/981 [00:07<00:28, 27.65it/s] 19%|█▉        | 189/981 [00:07<00:28, 27.72it/s] 20%|█▉        | 192/981 [00:07<00:28, 27.72it/s] 20%|█▉        | 195/981 [00:07<00:28, 27.58it/s] 20%|██        | 198/981 [00:07<00:28, 27.51it/s] 20%|██        | 201/981 [00:07<00:28, 27.50it/s] 21%|██        | 204/981 [00:08<00:28, 27.44it/s] 21%|██        | 207/981 [00:08<00:28, 27.41it/s] 21%|██▏       | 210/981 [00:08<00:28, 27.23it/s] 22%|██▏       | 213/981 [00:08<00:28, 27.25it/s] 22%|██▏       | 216/981 [00:08<00:28, 27.17it/s] 22%|██▏       | 219/981 [00:08<00:28, 27.12it/s] 23%|██▎       | 222/981 [00:08<00:28, 26.98it/s] 23%|██▎       | 225/981 [00:08<00:28, 26.82it/s] 23%|██▎       | 228/981 [00:08<00:28, 26.87it/s] 24%|██▎       | 231/981 [00:09<00:27, 26.88it/s] 24%|██▍       | 234/981 [00:09<00:27, 26.92it/s] 24%|██▍       | 237/981 [00:09<00:27, 26.92it/s] 24%|██▍       | 240/981 [00:09<00:27, 26.95it/s] 25%|██▍       | 243/981 [00:09<00:27, 26.93it/s] 25%|██▌       | 246/981 [00:09<00:27, 26.86it/s] 25%|██▌       | 249/981 [00:09<00:27, 26.89it/s] 26%|██▌       | 252/981 [00:09<00:27, 26.89it/s] 26%|██▌       | 255/981 [00:09<00:26, 26.97it/s] 26%|██▋       | 258/981 [00:10<00:26, 26.99it/s] 27%|██▋       | 261/981 [00:10<00:26, 27.07it/s] 27%|██▋       | 264/981 [00:10<00:26, 27.13it/s] 27%|██▋       | 267/981 [00:10<00:26, 27.11it/s] 28%|██▊       | 270/981 [00:10<00:26, 26.68it/s] 28%|██▊       | 273/981 [00:10<00:26, 26.68it/s] 28%|██▊       | 276/981 [00:10<00:26, 26.65it/s] 28%|██▊       | 279/981 [00:10<00:26, 26.68it/s] 29%|██▊       | 282/981 [00:10<00:26, 26.69it/s] 29%|██▉       | 285/981 [00:11<00:26, 26.71it/s] 29%|██▉       | 288/981 [00:11<00:25, 26.73it/s] 30%|██▉       | 291/981 [00:11<00:25, 26.69it/s] 30%|██▉       | 294/981 [00:11<00:25, 26.70it/s] 30%|███       | 297/981 [00:11<00:25, 26.74it/s] 31%|███       | 300/981 [00:11<00:25, 26.68it/s] 31%|███       | 303/981 [00:11<00:25, 26.67it/s] 31%|███       | 306/981 [00:11<00:25, 26.68it/s] 31%|███▏      | 309/981 [00:11<00:25, 26.43it/s] 32%|███▏      | 312/981 [00:12<00:25, 26.41it/s] 32%|███▏      | 315/981 [00:12<00:25, 26.59it/s] 32%|███▏      | 318/981 [00:12<00:24, 26.78it/s] 33%|███▎      | 321/981 [00:12<00:25, 26.30it/s] 33%|███▎      | 324/981 [00:12<00:26, 24.60it/s] 33%|███▎      | 327/981 [00:12<00:27, 23.40it/s] 34%|███▎      | 330/981 [00:12<00:28, 22.65it/s] 34%|███▍      | 333/981 [00:13<00:29, 21.96it/s] 34%|███▍      | 336/981 [00:13<00:28, 22.30it/s] 35%|███▍      | 339/981 [00:13<00:27, 23.15it/s] 35%|███▍      | 342/981 [00:13<00:27, 23.32it/s] 35%|███▌      | 345/981 [00:13<00:27, 22.80it/s] 35%|███▌      | 348/981 [00:13<00:28, 22.45it/s] 36%|███▌      | 351/981 [00:13<00:28, 22.32it/s] 36%|███▌      | 354/981 [00:13<00:28, 22.19it/s] 36%|███▋      | 357/981 [00:14<00:27, 23.01it/s] 37%|███▋      | 360/981 [00:14<00:26, 23.85it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.25it/s] 37%|███▋      | 366/981 [00:14<00:24, 24.85it/s] 38%|███▊      | 369/981 [00:14<00:24, 25.23it/s] 38%|███▊      | 372/981 [00:14<00:24, 25.18it/s] 38%|███▊      | 375/981 [00:14<00:23, 25.46it/s] 39%|███▊      | 378/981 [00:14<00:23, 25.59it/s] 39%|███▉      | 381/981 [00:14<00:23, 25.56it/s] 39%|███▉      | 384/981 [00:15<00:23, 25.86it/s] 39%|███▉      | 387/981 [00:15<00:22, 26.00it/s] 40%|███▉      | 390/981 [00:15<00:22, 26.02it/s] 40%|████      | 393/981 [00:15<00:22, 26.13it/s] 40%|████      | 396/981 [00:15<00:22, 26.08it/s] 41%|████      | 399/981 [00:15<00:22, 26.15it/s] 41%|████      | 402/981 [00:15<00:22, 26.24it/s] 41%|████▏     | 405/981 [00:15<00:21, 26.28it/s] 42%|████▏     | 408/981 [00:16<00:21, 26.25it/s] 42%|████▏     | 411/981 [00:16<00:21, 26.28it/s] 42%|████▏     | 414/981 [00:16<00:21, 26.29it/s] 43%|████▎     | 417/981 [00:16<00:21, 26.28it/s] 43%|████▎     | 420/981 [00:16<00:21, 26.31it/s] 43%|████▎     | 423/981 [00:16<00:21, 26.19it/s] 43%|████▎     | 426/981 [00:16<00:21, 26.06it/s] 44%|████▎     | 429/981 [00:16<00:21, 25.87it/s] 44%|████▍     | 432/981 [00:16<00:21, 25.81it/s] 44%|████▍     | 435/981 [00:17<00:21, 25.85it/s] 45%|████▍     | 438/981 [00:17<00:21, 25.84it/s] 45%|████▍     | 441/981 [00:17<00:20, 25.84it/s] 45%|████▌     | 444/981 [00:17<00:20, 25.78it/s] 46%|████▌     | 447/981 [00:17<00:20, 25.75it/s] 46%|████▌     | 450/981 [00:17<00:20, 25.81it/s] 46%|████▌     | 453/981 [00:17<00:20, 25.82it/s] 46%|████▋     | 456/981 [00:17<00:20, 25.80it/s] 47%|████▋     | 459/981 [00:17<00:20, 25.75it/s] 47%|████▋     | 462/981 [00:18<00:20, 25.67it/s] 47%|████▋     | 465/981 [00:18<00:20, 25.79it/s] 48%|████▊     | 468/981 [00:18<00:19, 25.82it/s] 48%|████▊     | 471/981 [00:18<00:19, 25.80it/s] 48%|████▊     | 474/981 [00:18<00:19, 25.78it/s] 49%|████▊     | 477/981 [00:18<00:19, 25.78it/s] 49%|████▉     | 480/981 [00:18<00:19, 25.87it/s] 49%|████▉     | 483/981 [00:18<00:19, 25.84it/s] 50%|████▉     | 486/981 [00:19<00:19, 25.84it/s] 50%|████▉     | 489/981 [00:19<00:19, 25.77it/s] 50%|█████     | 492/981 [00:19<00:18, 25.81it/s] 50%|█████     | 495/981 [00:19<00:18, 25.91it/s] 51%|█████     | 498/981 [00:19<00:18, 25.91it/s] 51%|█████     | 501/981 [00:19<00:18, 25.86it/s] 51%|█████▏    | 504/981 [00:19<00:18, 25.87it/s] 52%|█████▏    | 507/981 [00:19<00:18, 25.98it/s] 52%|█████▏    | 510/981 [00:19<00:18, 26.04it/s] 52%|█████▏    | 513/981 [00:20<00:17, 26.07it/s] 53%|█████▎    | 516/981 [00:20<00:17, 26.18it/s] 53%|█████▎    | 519/981 [00:20<00:17, 26.29it/s] 53%|█████▎    | 522/981 [00:20<00:17, 26.24it/s] 54%|█████▎    | 525/981 [00:20<00:17, 26.28it/s] 54%|█████▍    | 528/981 [00:20<00:17, 26.37it/s] 54%|█████▍    | 531/981 [00:20<00:17, 26.39it/s] 54%|█████▍    | 534/981 [00:20<00:16, 26.48it/s] 55%|█████▍    | 537/981 [00:20<00:16, 26.49it/s] 55%|█████▌    | 540/981 [00:21<00:16, 26.46it/s] 55%|█████▌    | 543/981 [00:21<00:16, 26.56it/s] 56%|█████▌    | 546/981 [00:21<00:16, 26.57it/s] 56%|█████▌    | 549/981 [00:21<00:16, 26.59it/s] 56%|█████▋    | 552/981 [00:21<00:15, 26.84it/s] 57%|█████▋    | 555/981 [00:21<00:15, 26.93it/s] 57%|█████▋    | 558/981 [00:21<00:15, 27.10it/s] 57%|█████▋    | 561/981 [00:21<00:15, 27.12it/s] 57%|█████▋    | 564/981 [00:21<00:15, 27.24it/s] 58%|█████▊    | 567/981 [00:22<00:15, 26.86it/s] 58%|█████▊    | 570/981 [00:22<00:15, 27.00it/s] 58%|█████▊    | 573/981 [00:22<00:15, 27.04it/s] 59%|█████▊    | 576/981 [00:22<00:15, 25.66it/s] 59%|█████▉    | 579/981 [00:22<00:16, 24.47it/s] 59%|█████▉    | 582/981 [00:22<00:16, 23.76it/s] 60%|█████▉    | 585/981 [00:22<00:17, 23.18it/s] 60%|█████▉    | 588/981 [00:22<00:17, 22.92it/s] 60%|██████    | 591/981 [00:23<00:16, 23.81it/s] 61%|██████    | 594/981 [00:23<00:15, 24.40it/s] 61%|██████    | 597/981 [00:23<00:15, 24.81it/s] 61%|██████    | 600/981 [00:23<00:15, 25.07it/s] 61%|██████▏   | 603/981 [00:23<00:15, 24.58it/s] 62%|██████▏   | 606/981 [00:23<00:15, 23.60it/s] 62%|██████▏   | 609/981 [00:23<00:15, 23.47it/s] 62%|██████▏   | 612/981 [00:23<00:15, 23.50it/s] 63%|██████▎   | 615/981 [00:24<00:15, 23.03it/s] 63%|██████▎   | 618/981 [00:24<00:14, 24.32it/s] 63%|██████▎   | 621/981 [00:24<00:14, 25.40it/s] 64%|██████▎   | 624/981 [00:24<00:13, 26.15it/s] 64%|██████▍   | 627/981 [00:24<00:13, 26.39it/s] 64%|██████▍   | 630/981 [00:24<00:13, 26.89it/s] 65%|██████▍   | 633/981 [00:24<00:12, 26.91it/s] 65%|██████▍   | 636/981 [00:24<00:12, 27.27it/s] 65%|██████▌   | 639/981 [00:24<00:12, 27.52it/s] 65%|██████▌   | 642/981 [00:25<00:12, 27.71it/s] 66%|██████▌   | 645/981 [00:25<00:12, 27.91it/s] 66%|██████▌   | 648/981 [00:25<00:11, 28.02it/s] 66%|██████▋   | 651/981 [00:25<00:11, 28.05it/s] 67%|██████▋   | 654/981 [00:25<00:11, 27.99it/s] 67%|██████▋   | 657/981 [00:25<00:11, 28.08it/s] 67%|██████▋   | 660/981 [00:25<00:11, 28.14it/s] 68%|██████▊   | 663/981 [00:25<00:11, 28.20it/s] 68%|██████▊   | 666/981 [00:25<00:11, 28.27it/s] 68%|██████▊   | 669/981 [00:26<00:11, 28.34it/s] 69%|██████▊   | 672/981 [00:26<00:10, 28.29it/s] 69%|██████▉   | 675/981 [00:26<00:10, 28.31it/s] 69%|██████▉   | 678/981 [00:26<00:10, 28.38it/s] 69%|██████▉   | 681/981 [00:26<00:10, 28.29it/s] 70%|██████▉   | 684/981 [00:26<00:10, 28.10it/s] 70%|███████   | 687/981 [00:26<00:10, 28.18it/s] 70%|███████   | 690/981 [00:26<00:10, 28.24it/s] 71%|███████   | 693/981 [00:26<00:10, 28.26it/s] 71%|███████   | 696/981 [00:26<00:10, 28.36it/s] 71%|███████▏  | 699/981 [00:27<00:09, 28.27it/s] 72%|███████▏  | 702/981 [00:27<00:09, 28.27it/s] 72%|███████▏  | 705/981 [00:27<00:09, 28.27it/s] 72%|███████▏  | 708/981 [00:27<00:09, 28.33it/s] 72%|███████▏  | 711/981 [00:27<00:09, 28.37it/s] 73%|███████▎  | 714/981 [00:27<00:09, 28.35it/s] 73%|███████▎  | 717/981 [00:27<00:09, 28.35it/s] 73%|███████▎  | 720/981 [00:27<00:09, 28.41it/s] 74%|███████▎  | 723/981 [00:27<00:09, 28.38it/s] 74%|███████▍  | 726/981 [00:28<00:08, 28.34it/s] 74%|███████▍  | 729/981 [00:28<00:08, 28.30it/s] 75%|███████▍  | 732/981 [00:28<00:08, 28.25it/s] 75%|███████▍  | 735/981 [00:28<00:08, 28.14it/s] 75%|███████▌  | 738/981 [00:28<00:08, 28.22it/s] 76%|███████▌  | 741/981 [00:28<00:08, 28.19it/s] 76%|███████▌  | 744/981 [00:28<00:08, 28.21it/s] 76%|███████▌  | 747/981 [00:28<00:08, 28.14it/s] 76%|███████▋  | 750/981 [00:28<00:08, 28.12it/s] 77%|███████▋  | 753/981 [00:28<00:08, 28.09it/s] 77%|███████▋  | 756/981 [00:29<00:08, 28.02it/s] 77%|███████▋  | 759/981 [00:29<00:07, 27.99it/s] 78%|███████▊  | 762/981 [00:29<00:07, 28.01it/s] 78%|███████▊  | 765/981 [00:29<00:07, 28.03it/s] 78%|███████▊  | 768/981 [00:29<00:07, 28.01it/s] 79%|███████▊  | 771/981 [00:29<00:07, 27.97it/s] 79%|███████▉  | 774/981 [00:29<00:07, 28.02it/s] 79%|███████▉  | 777/981 [00:29<00:07, 28.00it/s] 80%|███████▉  | 780/981 [00:29<00:07, 28.15it/s] 80%|███████▉  | 783/981 [00:30<00:06, 28.37it/s] 80%|████████  | 786/981 [00:30<00:06, 28.77it/s] 81%|████████  | 790/981 [00:30<00:06, 29.26it/s] 81%|████████  | 794/981 [00:30<00:06, 29.62it/s] 81%|████████▏ | 798/981 [00:30<00:06, 30.32it/s] 82%|████████▏ | 802/981 [00:30<00:05, 30.71it/s] 82%|████████▏ | 806/981 [00:30<00:05, 31.07it/s] 83%|████████▎ | 810/981 [00:30<00:05, 31.44it/s] 83%|████████▎ | 814/981 [00:31<00:05, 31.48it/s] 83%|████████▎ | 818/981 [00:31<00:05, 31.72it/s] 84%|████████▍ | 822/981 [00:31<00:04, 31.84it/s] 84%|████████▍ | 826/981 [00:31<00:04, 31.96it/s] 85%|████████▍ | 830/981 [00:31<00:04, 32.02it/s] 85%|████████▌ | 834/981 [00:31<00:04, 31.80it/s] 85%|████████▌ | 838/981 [00:31<00:04, 31.93it/s] 86%|████████▌ | 842/981 [00:31<00:04, 31.76it/s] 86%|████████▌ | 846/981 [00:32<00:04, 31.84it/s] 87%|████████▋ | 850/981 [00:32<00:04, 31.85it/s] 87%|████████▋ | 854/981 [00:32<00:03, 31.79it/s] 87%|████████▋ | 858/981 [00:32<00:03, 31.50it/s] 88%|████████▊ | 862/981 [00:32<00:03, 31.54it/s] 88%|████████▊ | 866/981 [00:32<00:03, 31.63it/s] 89%|████████▊ | 870/981 [00:32<00:03, 31.59it/s] 89%|████████▉ | 874/981 [00:32<00:03, 31.55it/s] 90%|████████▉ | 878/981 [00:33<00:03, 31.03it/s] 90%|████████▉ | 882/981 [00:33<00:03, 31.18it/s] 90%|█████████ | 886/981 [00:33<00:03, 31.33it/s] 91%|█████████ | 890/981 [00:33<00:02, 31.46it/s] 91%|█████████ | 894/981 [00:33<00:02, 31.53it/s] 92%|█████████▏| 898/981 [00:33<00:02, 30.75it/s] 92%|█████████▏| 902/981 [00:33<00:02, 30.83it/s] 92%|█████████▏| 906/981 [00:33<00:02, 30.88it/s] 93%|█████████▎| 910/981 [00:34<00:02, 31.06it/s] 93%|█████████▎| 914/981 [00:34<00:02, 31.24it/s] 94%|█████████▎| 918/981 [00:34<00:02, 31.43it/s] 94%|█████████▍| 922/981 [00:34<00:01, 31.33it/s] 94%|█████████▍| 926/981 [00:34<00:01, 31.46it/s] 95%|█████████▍| 930/981 [00:34<00:01, 31.56it/s] 95%|█████████▌| 934/981 [00:34<00:01, 31.64it/s] 96%|█████████▌| 938/981 [00:34<00:01, 31.66it/s] 96%|█████████▌| 942/981 [00:35<00:01, 31.69it/s] 96%|█████████▋| 946/981 [00:35<00:01, 31.76it/s] 97%|█████████▋| 950/981 [00:35<00:00, 31.71it/s] 97%|█████████▋| 954/981 [00:35<00:00, 31.70it/s] 98%|█████████▊| 958/981 [00:35<00:00, 31.74it/s] 98%|█████████▊| 962/981 [00:35<00:00, 31.77it/s] 98%|█████████▊| 966/981 [00:35<00:00, 31.80it/s] 99%|█████████▉| 970/981 [00:35<00:00, 31.79it/s] 99%|█████████▉| 974/981 [00:36<00:00, 31.70it/s]100%|█████████▉| 978/981 [00:36<00:00, 31.75it/s]100%|██████████| 981/981 [00:36<00:00, 26.99it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_LDAM_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.047, valid loss : 0.035, train acc : 0.982, valid acc : 0.984, train f1 : 0.585, valid f1 : 0.760
training process:   2%|▏         | 1/50 [03:30<2:51:35, 210.12s/it]Best score increase :0.000 -> 0.760
training process:   4%|▍         | 2/50 [06:21<2:29:39, 187.08s/it]Best score increase :0.760 -> 0.776
training process:   6%|▌         | 3/50 [09:10<2:20:21, 179.19s/it]EarlyStopping counter : 1 out of 12
training process:   8%|▊         | 4/50 [12:01<2:14:42, 175.70s/it]EarlyStopping counter : 2 out of 12
epoch : 5, train loss : 0.035, valid loss : 0.030, train acc : 0.989, valid acc : 0.985, train f1 : 0.783, valid f1 : 0.775
training process:  10%|█         | 5/50 [15:28<2:20:25, 187.24s/it]EarlyStopping counter : 3 out of 12
training process:  12%|█▏        | 6/50 [18:18<2:12:55, 181.25s/it]Best score increase :0.776 -> 0.811
training process:  14%|█▍        | 7/50 [21:10<2:07:38, 178.10s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 8/50 [24:01<2:03:09, 175.94s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.033, valid loss : 0.040, train acc : 0.989, valid acc : 0.989, train f1 : 0.781, valid f1 : 0.776
training process:  18%|█▊        | 9/50 [27:31<2:07:36, 186.74s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 10/50 [30:22<2:01:05, 181.64s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 11/50 [33:12<1:55:53, 178.30s/it]EarlyStopping counter : 5 out of 12
training process:  24%|██▍       | 12/50 [36:01<1:51:07, 175.45s/it]Best score increase :0.811 -> 0.866
epoch : 13, train loss : 0.022, valid loss : 0.025, train acc : 0.991, valid acc : 0.992, train f1 : 0.848, valid f1 : 0.865
training process:  26%|██▌       | 13/50 [39:32<1:54:44, 186.08s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 14/50 [42:21<1:48:36, 181.02s/it]Best score increase :0.866 -> 0.907
training process:  30%|███       | 15/50 [45:10<1:43:31, 177.46s/it]EarlyStopping counter : 1 out of 12
training process:  32%|███▏      | 16/50 [48:00<1:39:14, 175.14s/it]Best score increase :0.907 -> 0.929
epoch : 17, train loss : 0.016, valid loss : 0.020, train acc : 0.993, valid acc : 0.995, train f1 : 0.892, valid f1 : 0.919
training process:  34%|███▍      | 17/50 [51:27<1:41:37, 184.77s/it]EarlyStopping counter : 1 out of 12
training process:  36%|███▌      | 18/50 [54:17<1:36:10, 180.33s/it]EarlyStopping counter : 2 out of 12
training process:  38%|███▊      | 19/50 [57:08<1:31:41, 177.45s/it]EarlyStopping counter : 3 out of 12
training process:  40%|████      | 20/50 [59:57<1:27:27, 174.92s/it]Best score increase :0.929 -> 0.932
epoch : 21, train loss : 0.014, valid loss : 0.016, train acc : 0.995, valid acc : 0.995, train f1 : 0.919, valid f1 : 0.925
training process:  42%|████▏     | 21/50 [1:03:23<1:29:06, 184.34s/it]EarlyStopping counter : 1 out of 12
training process:  44%|████▍     | 22/50 [1:06:14<1:24:06, 180.23s/it]EarlyStopping counter : 2 out of 12
training process:  46%|████▌     | 23/50 [1:09:03<1:19:35, 176.85s/it]Best score increase :0.932 -> 0.936
training process:  48%|████▊     | 24/50 [1:11:52<1:15:39, 174.60s/it]EarlyStopping counter : 1 out of 12
epoch : 25, train loss : 0.013, valid loss : 0.014, train acc : 0.995, valid acc : 0.996, train f1 : 0.917, valid f1 : 0.938
training process:  50%|█████     | 25/50 [1:15:20<1:16:55, 184.61s/it]Best score increase :0.936 -> 0.938
training process:  52%|█████▏    | 26/50 [1:18:12<1:12:16, 180.67s/it]EarlyStopping counter : 1 out of 12
training process:  54%|█████▍    | 27/50 [1:21:03<1:08:10, 177.85s/it]EarlyStopping counter : 2 out of 12
training process:  56%|█████▌    | 28/50 [1:23:54<1:04:27, 175.82s/it]EarlyStopping counter : 3 out of 12
epoch : 29, train loss : 0.012, valid loss : 0.012, train acc : 0.996, valid acc : 0.994, train f1 : 0.929, valid f1 : 0.913
training process:  58%|█████▊    | 29/50 [1:27:24<1:05:05, 185.97s/it]EarlyStopping counter : 4 out of 12
training process:  60%|██████    | 30/50 [1:30:14<1:00:26, 181.31s/it]EarlyStopping counter : 5 out of 12
training process:  62%|██████▏   | 31/50 [1:33:04<56:18, 177.83s/it]  EarlyStopping counter : 6 out of 12
training process:  64%|██████▍   | 32/50 [1:35:54<52:39, 175.51s/it]EarlyStopping counter : 7 out of 12
epoch : 33, train loss : 0.010, valid loss : 0.015, train acc : 0.996, valid acc : 0.995, train f1 : 0.933, valid f1 : 0.923
training process:  66%|██████▌   | 33/50 [1:39:23<52:31, 185.41s/it]EarlyStopping counter : 8 out of 12
training process:  68%|██████▊   | 34/50 [1:42:11<48:06, 180.43s/it]EarlyStopping counter : 9 out of 12
training process:  70%|███████   | 35/50 [1:44:59<44:10, 176.70s/it]EarlyStopping counter : 10 out of 12
training process:  72%|███████▏  | 36/50 [1:47:49<40:42, 174.45s/it]EarlyStopping counter : 11 out of 12
epoch : 37, train loss : 0.011, valid loss : 0.010, train acc : 0.996, valid acc : 0.996, train f1 : 0.931, valid f1 : 0.936
training process:  72%|███████▏  | 36/50 [1:51:16<43:16, 185.46s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 36, best f1 score : 0.938
training process finished, best loss : 0.014 and best acc : 0.996, best f1 : 0.938, best epoch : 24

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.68      0.86      0.76        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.84      0.93      0.88      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.88, test AUC : 0.93, test loss : 0.190

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:39, 24.69it/s]  1%|          | 6/981 [00:00<00:37, 25.73it/s]  1%|          | 9/981 [00:00<00:37, 26.26it/s]  1%|          | 12/981 [00:00<00:36, 26.65it/s]  2%|▏         | 15/981 [00:00<00:36, 26.81it/s]  2%|▏         | 18/981 [00:00<00:35, 26.77it/s]  2%|▏         | 21/981 [00:00<00:35, 26.92it/s]  2%|▏         | 24/981 [00:00<00:35, 26.81it/s]  3%|▎         | 27/981 [00:01<00:35, 26.97it/s]  3%|▎         | 30/981 [00:01<00:35, 27.07it/s]  3%|▎         | 33/981 [00:01<00:35, 26.88it/s]  4%|▎         | 36/981 [00:01<00:35, 26.95it/s]  4%|▍         | 39/981 [00:01<00:34, 27.04it/s]  4%|▍         | 42/981 [00:01<00:35, 26.65it/s]  5%|▍         | 45/981 [00:01<00:35, 26.62it/s]  5%|▍         | 48/981 [00:01<00:35, 26.55it/s]  5%|▌         | 51/981 [00:01<00:34, 26.77it/s]  6%|▌         | 54/981 [00:02<00:34, 26.97it/s]  6%|▌         | 57/981 [00:02<00:34, 26.92it/s]  6%|▌         | 60/981 [00:02<00:34, 26.98it/s]  6%|▋         | 63/981 [00:02<00:33, 27.10it/s]  7%|▋         | 66/981 [00:02<00:33, 27.00it/s]  7%|▋         | 69/981 [00:02<00:33, 27.05it/s]  7%|▋         | 72/981 [00:02<00:33, 27.11it/s]  8%|▊         | 75/981 [00:02<00:33, 27.18it/s]  8%|▊         | 78/981 [00:02<00:33, 27.24it/s]  8%|▊         | 81/981 [00:03<00:33, 27.13it/s]  9%|▊         | 84/981 [00:03<00:32, 27.20it/s]  9%|▉         | 87/981 [00:03<00:32, 27.16it/s]  9%|▉         | 90/981 [00:03<00:32, 27.20it/s]  9%|▉         | 93/981 [00:03<00:32, 27.16it/s] 10%|▉         | 96/981 [00:03<00:32, 27.14it/s] 10%|█         | 99/981 [00:03<00:32, 26.98it/s] 10%|█         | 102/981 [00:03<00:32, 26.79it/s] 11%|█         | 105/981 [00:03<00:32, 26.82it/s] 11%|█         | 108/981 [00:04<00:32, 26.73it/s] 11%|█▏        | 111/981 [00:04<00:32, 26.52it/s] 12%|█▏        | 114/981 [00:04<00:32, 26.65it/s] 12%|█▏        | 117/981 [00:04<00:32, 26.71it/s] 12%|█▏        | 120/981 [00:04<00:32, 26.60it/s] 13%|█▎        | 123/981 [00:04<00:32, 26.69it/s] 13%|█▎        | 126/981 [00:04<00:31, 26.77it/s] 13%|█▎        | 129/981 [00:04<00:32, 26.23it/s] 13%|█▎        | 132/981 [00:04<00:32, 26.23it/s] 14%|█▍        | 135/981 [00:05<00:32, 26.43it/s] 14%|█▍        | 138/981 [00:05<00:31, 26.57it/s] 14%|█▍        | 141/981 [00:05<00:31, 26.74it/s] 15%|█▍        | 144/981 [00:05<00:31, 26.86it/s] 15%|█▍        | 147/981 [00:05<00:30, 26.93it/s] 15%|█▌        | 150/981 [00:05<00:30, 27.01it/s] 16%|█▌        | 153/981 [00:05<00:30, 27.12it/s] 16%|█▌        | 156/981 [00:05<00:30, 27.14it/s] 16%|█▌        | 159/981 [00:05<00:30, 27.08it/s] 17%|█▋        | 162/981 [00:06<00:30, 26.95it/s] 17%|█▋        | 165/981 [00:06<00:30, 26.78it/s] 17%|█▋        | 168/981 [00:06<00:30, 26.74it/s] 17%|█▋        | 171/981 [00:06<00:30, 26.89it/s] 18%|█▊        | 174/981 [00:06<00:29, 26.99it/s] 18%|█▊        | 177/981 [00:06<00:29, 27.12it/s] 18%|█▊        | 180/981 [00:06<00:29, 27.22it/s] 19%|█▊        | 183/981 [00:06<00:29, 27.24it/s] 19%|█▉        | 186/981 [00:06<00:29, 27.28it/s] 19%|█▉        | 189/981 [00:07<00:28, 27.32it/s] 20%|█▉        | 192/981 [00:07<00:29, 27.13it/s] 20%|█▉        | 195/981 [00:07<00:28, 27.21it/s] 20%|██        | 198/981 [00:07<00:28, 27.17it/s] 20%|██        | 201/981 [00:07<00:28, 27.11it/s] 21%|██        | 204/981 [00:07<00:28, 26.99it/s] 21%|██        | 207/981 [00:07<00:28, 26.95it/s] 21%|██▏       | 210/981 [00:07<00:28, 26.85it/s] 22%|██▏       | 213/981 [00:07<00:28, 26.71it/s] 22%|██▏       | 216/981 [00:08<00:28, 26.59it/s] 22%|██▏       | 219/981 [00:08<00:29, 26.05it/s] 23%|██▎       | 222/981 [00:08<00:29, 25.85it/s] 23%|██▎       | 225/981 [00:08<00:29, 25.96it/s] 23%|██▎       | 228/981 [00:08<00:28, 26.11it/s] 24%|██▎       | 231/981 [00:08<00:28, 26.21it/s] 24%|██▍       | 234/981 [00:08<00:28, 26.27it/s] 24%|██▍       | 237/981 [00:08<00:28, 26.27it/s] 24%|██▍       | 240/981 [00:08<00:28, 26.20it/s] 25%|██▍       | 243/981 [00:09<00:27, 26.37it/s] 25%|██▌       | 246/981 [00:09<00:27, 26.27it/s] 25%|██▌       | 249/981 [00:09<00:27, 26.36it/s] 26%|██▌       | 252/981 [00:09<00:27, 26.45it/s] 26%|██▌       | 255/981 [00:09<00:27, 26.53it/s] 26%|██▋       | 258/981 [00:09<00:27, 26.53it/s] 27%|██▋       | 261/981 [00:09<00:27, 26.56it/s] 27%|██▋       | 264/981 [00:09<00:26, 26.59it/s] 27%|██▋       | 267/981 [00:09<00:26, 26.62it/s] 28%|██▊       | 270/981 [00:10<00:26, 26.62it/s] 28%|██▊       | 273/981 [00:10<00:26, 26.60it/s] 28%|██▊       | 276/981 [00:10<00:26, 26.56it/s] 28%|██▊       | 279/981 [00:10<00:26, 26.57it/s] 29%|██▊       | 282/981 [00:10<00:26, 26.63it/s] 29%|██▉       | 285/981 [00:10<00:26, 26.53it/s] 29%|██▉       | 288/981 [00:10<00:26, 26.38it/s] 30%|██▉       | 291/981 [00:10<00:26, 26.34it/s] 30%|██▉       | 294/981 [00:10<00:26, 26.34it/s] 30%|███       | 297/981 [00:11<00:25, 26.49it/s] 31%|███       | 300/981 [00:11<00:25, 26.56it/s] 31%|███       | 303/981 [00:11<00:25, 26.56it/s] 31%|███       | 306/981 [00:11<00:25, 26.54it/s] 31%|███▏      | 309/981 [00:11<00:25, 26.57it/s] 32%|███▏      | 312/981 [00:11<00:25, 26.58it/s] 32%|███▏      | 315/981 [00:11<00:25, 26.58it/s] 32%|███▏      | 318/981 [00:11<00:24, 26.60it/s] 33%|███▎      | 321/981 [00:12<00:24, 26.59it/s] 33%|███▎      | 324/981 [00:12<00:24, 26.52it/s] 33%|███▎      | 327/981 [00:12<00:24, 26.48it/s] 34%|███▎      | 330/981 [00:12<00:24, 26.50it/s] 34%|███▍      | 333/981 [00:12<00:24, 26.52it/s] 34%|███▍      | 336/981 [00:12<00:24, 26.56it/s] 35%|███▍      | 339/981 [00:12<00:24, 26.59it/s] 35%|███▍      | 342/981 [00:12<00:24, 26.58it/s] 35%|███▌      | 345/981 [00:12<00:24, 26.13it/s] 35%|███▌      | 348/981 [00:13<00:24, 26.16it/s] 36%|███▌      | 351/981 [00:13<00:24, 25.96it/s] 36%|███▌      | 354/981 [00:13<00:24, 26.05it/s] 36%|███▋      | 357/981 [00:13<00:23, 26.22it/s] 37%|███▋      | 360/981 [00:13<00:23, 26.29it/s] 37%|███▋      | 363/981 [00:13<00:24, 24.98it/s] 37%|███▋      | 366/981 [00:13<00:25, 24.11it/s] 38%|███▊      | 369/981 [00:13<00:25, 23.58it/s] 38%|███▊      | 372/981 [00:14<00:26, 23.27it/s] 38%|███▊      | 375/981 [00:14<00:26, 23.06it/s] 39%|███▊      | 378/981 [00:14<00:25, 23.76it/s] 39%|███▉      | 381/981 [00:14<00:24, 24.62it/s] 39%|███▉      | 384/981 [00:14<00:23, 25.20it/s] 39%|███▉      | 387/981 [00:14<00:23, 25.65it/s] 40%|███▉      | 390/981 [00:14<00:22, 25.98it/s] 40%|████      | 393/981 [00:14<00:22, 26.16it/s] 40%|████      | 396/981 [00:14<00:22, 26.38it/s] 41%|████      | 399/981 [00:15<00:21, 26.52it/s] 41%|████      | 402/981 [00:15<00:21, 26.61it/s] 41%|████▏     | 405/981 [00:15<00:21, 26.35it/s] 42%|████▏     | 408/981 [00:15<00:21, 26.49it/s] 42%|████▏     | 411/981 [00:15<00:21, 26.59it/s] 42%|████▏     | 414/981 [00:15<00:21, 26.72it/s] 43%|████▎     | 417/981 [00:15<00:21, 26.81it/s] 43%|████▎     | 420/981 [00:15<00:20, 26.83it/s] 43%|████▎     | 423/981 [00:15<00:20, 26.83it/s] 43%|████▎     | 426/981 [00:16<00:20, 26.88it/s] 44%|████▎     | 429/981 [00:16<00:20, 26.91it/s] 44%|████▍     | 432/981 [00:16<00:20, 26.95it/s] 44%|████▍     | 435/981 [00:16<00:20, 26.97it/s] 45%|████▍     | 438/981 [00:16<00:20, 27.00it/s] 45%|████▍     | 441/981 [00:16<00:20, 26.81it/s] 45%|████▌     | 444/981 [00:16<00:20, 26.53it/s] 46%|████▌     | 447/981 [00:16<00:20, 26.40it/s] 46%|████▌     | 450/981 [00:16<00:19, 26.56it/s] 46%|████▌     | 453/981 [00:17<00:19, 26.54it/s] 46%|████▋     | 456/981 [00:17<00:19, 26.64it/s] 47%|████▋     | 459/981 [00:17<00:19, 26.69it/s] 47%|████▋     | 462/981 [00:17<00:19, 26.46it/s] 47%|████▋     | 465/981 [00:17<00:19, 26.16it/s] 48%|████▊     | 468/981 [00:17<00:19, 26.18it/s] 48%|████▊     | 471/981 [00:17<00:19, 26.36it/s] 48%|████▊     | 474/981 [00:17<00:19, 26.53it/s] 49%|████▊     | 477/981 [00:17<00:18, 26.61it/s] 49%|████▉     | 480/981 [00:18<00:18, 26.73it/s] 49%|████▉     | 483/981 [00:18<00:18, 26.75it/s] 50%|████▉     | 486/981 [00:18<00:18, 26.75it/s] 50%|████▉     | 489/981 [00:18<00:18, 26.85it/s] 50%|█████     | 492/981 [00:18<00:18, 26.88it/s] 50%|█████     | 495/981 [00:18<00:18, 26.94it/s] 51%|█████     | 498/981 [00:18<00:18, 26.78it/s] 51%|█████     | 501/981 [00:18<00:17, 26.89it/s] 51%|█████▏    | 504/981 [00:18<00:17, 26.95it/s] 52%|█████▏    | 507/981 [00:19<00:17, 26.54it/s] 52%|█████▏    | 510/981 [00:19<00:17, 26.73it/s] 52%|█████▏    | 513/981 [00:19<00:17, 26.64it/s] 53%|█████▎    | 516/981 [00:19<00:17, 26.56it/s] 53%|█████▎    | 519/981 [00:19<00:17, 26.57it/s] 53%|█████▎    | 522/981 [00:19<00:17, 26.82it/s] 54%|█████▎    | 525/981 [00:19<00:17, 26.69it/s] 54%|█████▍    | 528/981 [00:19<00:17, 26.51it/s] 54%|█████▍    | 531/981 [00:20<00:16, 26.53it/s] 54%|█████▍    | 534/981 [00:20<00:16, 26.61it/s] 55%|█████▍    | 537/981 [00:20<00:16, 26.92it/s] 55%|█████▌    | 540/981 [00:20<00:16, 26.94it/s] 55%|█████▌    | 543/981 [00:20<00:16, 27.19it/s] 56%|█████▌    | 546/981 [00:20<00:15, 27.39it/s] 56%|█████▌    | 549/981 [00:20<00:15, 27.56it/s] 56%|█████▋    | 552/981 [00:20<00:15, 27.49it/s] 57%|█████▋    | 555/981 [00:20<00:15, 27.63it/s] 57%|█████▋    | 558/981 [00:20<00:15, 27.74it/s] 57%|█████▋    | 561/981 [00:21<00:15, 27.78it/s] 57%|█████▋    | 564/981 [00:21<00:15, 27.29it/s] 58%|█████▊    | 567/981 [00:21<00:15, 27.43it/s] 58%|█████▊    | 570/981 [00:21<00:14, 27.55it/s] 58%|█████▊    | 573/981 [00:21<00:14, 27.50it/s] 59%|█████▊    | 576/981 [00:21<00:14, 27.46it/s] 59%|█████▉    | 579/981 [00:21<00:14, 27.43it/s] 59%|█████▉    | 582/981 [00:21<00:14, 27.57it/s] 60%|█████▉    | 585/981 [00:21<00:14, 27.57it/s] 60%|█████▉    | 588/981 [00:22<00:14, 27.66it/s] 60%|██████    | 591/981 [00:22<00:14, 27.45it/s] 61%|██████    | 594/981 [00:22<00:14, 27.56it/s] 61%|██████    | 597/981 [00:22<00:13, 27.64it/s] 61%|██████    | 600/981 [00:22<00:13, 27.66it/s] 61%|██████▏   | 603/981 [00:22<00:13, 27.74it/s] 62%|██████▏   | 606/981 [00:22<00:13, 27.73it/s] 62%|██████▏   | 609/981 [00:22<00:13, 27.61it/s] 62%|██████▏   | 612/981 [00:22<00:13, 27.02it/s] 63%|██████▎   | 615/981 [00:23<00:13, 26.99it/s] 63%|██████▎   | 618/981 [00:23<00:13, 27.13it/s] 63%|██████▎   | 621/981 [00:23<00:13, 27.26it/s] 64%|██████▎   | 624/981 [00:23<00:13, 27.35it/s] 64%|██████▍   | 627/981 [00:23<00:12, 27.49it/s] 64%|██████▍   | 630/981 [00:23<00:12, 27.52it/s] 65%|██████▍   | 633/981 [00:23<00:12, 27.33it/s] 65%|██████▍   | 636/981 [00:23<00:12, 27.40it/s] 65%|██████▌   | 639/981 [00:23<00:12, 27.31it/s] 65%|██████▌   | 642/981 [00:24<00:12, 27.43it/s] 66%|██████▌   | 645/981 [00:24<00:12, 27.55it/s] 66%|██████▌   | 648/981 [00:24<00:12, 27.50it/s] 66%|██████▋   | 651/981 [00:24<00:12, 27.48it/s] 67%|██████▋   | 654/981 [00:24<00:11, 27.60it/s] 67%|██████▋   | 657/981 [00:24<00:11, 27.66it/s] 67%|██████▋   | 660/981 [00:24<00:11, 27.59it/s] 68%|██████▊   | 663/981 [00:24<00:11, 27.66it/s] 68%|██████▊   | 666/981 [00:24<00:11, 27.72it/s] 68%|██████▊   | 669/981 [00:25<00:11, 27.72it/s] 69%|██████▊   | 672/981 [00:25<00:11, 27.59it/s] 69%|██████▉   | 675/981 [00:25<00:11, 27.65it/s] 69%|██████▉   | 678/981 [00:25<00:10, 27.73it/s] 69%|██████▉   | 681/981 [00:25<00:10, 27.77it/s] 70%|██████▉   | 684/981 [00:25<00:10, 27.64it/s] 70%|███████   | 687/981 [00:25<00:10, 27.67it/s] 70%|███████   | 690/981 [00:25<00:10, 27.78it/s] 71%|███████   | 693/981 [00:25<00:10, 27.76it/s] 71%|███████   | 696/981 [00:26<00:10, 27.82it/s] 71%|███████▏  | 699/981 [00:26<00:10, 27.84it/s] 72%|███████▏  | 702/981 [00:26<00:10, 27.84it/s] 72%|███████▏  | 705/981 [00:26<00:09, 27.87it/s] 72%|███████▏  | 708/981 [00:26<00:09, 27.86it/s] 72%|███████▏  | 711/981 [00:26<00:09, 27.87it/s] 73%|███████▎  | 714/981 [00:26<00:09, 27.92it/s] 73%|███████▎  | 717/981 [00:26<00:09, 27.94it/s] 73%|███████▎  | 720/981 [00:26<00:09, 27.93it/s] 74%|███████▎  | 723/981 [00:26<00:09, 27.90it/s] 74%|███████▍  | 726/981 [00:27<00:09, 27.88it/s] 74%|███████▍  | 729/981 [00:27<00:09, 27.82it/s] 75%|███████▍  | 732/981 [00:27<00:08, 27.82it/s] 75%|███████▍  | 735/981 [00:27<00:08, 27.83it/s] 75%|███████▌  | 738/981 [00:27<00:08, 27.77it/s] 76%|███████▌  | 741/981 [00:27<00:08, 27.72it/s] 76%|███████▌  | 744/981 [00:27<00:08, 27.69it/s] 76%|███████▌  | 747/981 [00:27<00:08, 27.66it/s] 76%|███████▋  | 750/981 [00:27<00:08, 27.64it/s] 77%|███████▋  | 753/981 [00:28<00:08, 27.62it/s] 77%|███████▋  | 756/981 [00:28<00:08, 27.62it/s] 77%|███████▋  | 759/981 [00:28<00:08, 27.59it/s] 78%|███████▊  | 762/981 [00:28<00:07, 27.52it/s] 78%|███████▊  | 765/981 [00:28<00:07, 27.36it/s] 78%|███████▊  | 768/981 [00:28<00:07, 27.23it/s] 79%|███████▊  | 771/981 [00:28<00:07, 27.30it/s] 79%|███████▉  | 774/981 [00:28<00:07, 27.17it/s] 79%|███████▉  | 777/981 [00:28<00:07, 27.32it/s] 80%|███████▉  | 780/981 [00:29<00:07, 27.54it/s] 80%|███████▉  | 783/981 [00:29<00:07, 27.87it/s] 80%|████████  | 786/981 [00:29<00:06, 28.23it/s] 80%|████████  | 789/981 [00:29<00:06, 28.68it/s] 81%|████████  | 793/981 [00:29<00:06, 29.22it/s] 81%|████████  | 797/981 [00:29<00:06, 29.91it/s] 82%|████████▏ | 801/981 [00:29<00:05, 30.40it/s] 82%|████████▏ | 805/981 [00:29<00:05, 30.82it/s] 82%|████████▏ | 809/981 [00:29<00:05, 31.10it/s] 83%|████████▎ | 813/981 [00:30<00:05, 31.29it/s] 83%|████████▎ | 817/981 [00:30<00:05, 31.42it/s] 84%|████████▎ | 821/981 [00:30<00:05, 31.56it/s] 84%|████████▍ | 825/981 [00:30<00:04, 31.66it/s] 85%|████████▍ | 829/981 [00:30<00:04, 31.77it/s] 85%|████████▍ | 833/981 [00:30<00:04, 31.63it/s] 85%|████████▌ | 837/981 [00:30<00:04, 31.70it/s] 86%|████████▌ | 841/981 [00:30<00:04, 31.73it/s] 86%|████████▌ | 845/981 [00:31<00:04, 31.81it/s] 87%|████████▋ | 849/981 [00:31<00:04, 31.49it/s] 87%|████████▋ | 853/981 [00:31<00:04, 31.70it/s] 87%|████████▋ | 857/981 [00:31<00:03, 31.80it/s] 88%|████████▊ | 861/981 [00:31<00:03, 31.87it/s] 88%|████████▊ | 865/981 [00:31<00:03, 31.96it/s] 89%|████████▊ | 869/981 [00:31<00:03, 31.96it/s] 89%|████████▉ | 873/981 [00:31<00:03, 31.96it/s] 89%|████████▉ | 877/981 [00:32<00:03, 31.46it/s] 90%|████████▉ | 881/981 [00:32<00:03, 31.60it/s] 90%|█████████ | 885/981 [00:32<00:03, 31.79it/s] 91%|█████████ | 889/981 [00:32<00:02, 31.91it/s] 91%|█████████ | 893/981 [00:32<00:02, 32.03it/s] 91%|█████████▏| 897/981 [00:32<00:02, 32.00it/s] 92%|█████████▏| 901/981 [00:32<00:02, 32.04it/s] 92%|█████████▏| 905/981 [00:33<00:02, 32.07it/s] 93%|█████████▎| 909/981 [00:33<00:02, 32.12it/s] 93%|█████████▎| 913/981 [00:33<00:02, 32.14it/s] 93%|█████████▎| 917/981 [00:33<00:01, 32.11it/s] 94%|█████████▍| 921/981 [00:33<00:01, 32.09it/s] 94%|█████████▍| 925/981 [00:33<00:01, 32.08it/s] 95%|█████████▍| 929/981 [00:33<00:01, 31.87it/s] 95%|█████████▌| 933/981 [00:33<00:01, 29.55it/s] 96%|█████████▌| 937/981 [00:34<00:01, 29.79it/s] 96%|█████████▌| 941/981 [00:34<00:01, 28.91it/s] 96%|█████████▌| 944/981 [00:34<00:01, 28.58it/s] 97%|█████████▋| 947/981 [00:34<00:01, 27.99it/s] 97%|█████████▋| 950/981 [00:34<00:01, 27.86it/s] 97%|█████████▋| 954/981 [00:34<00:00, 29.00it/s] 98%|█████████▊| 958/981 [00:34<00:00, 29.95it/s] 98%|█████████▊| 962/981 [00:34<00:00, 30.65it/s] 98%|█████████▊| 966/981 [00:35<00:00, 31.06it/s] 99%|█████████▉| 970/981 [00:35<00:00, 31.37it/s] 99%|█████████▉| 974/981 [00:35<00:00, 31.60it/s]100%|█████████▉| 978/981 [00:35<00:00, 31.84it/s]100%|██████████| 981/981 [00:35<00:00, 27.64it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_LDAM_RS_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.005, valid loss : 0.106, train acc : 0.616, valid acc : 0.551, train f1 : 0.551, valid f1 : 0.389
training process:   2%|▏         | 1/50 [03:30<2:51:44, 210.30s/it]Best score increase :0.000 -> 0.389
training process:   4%|▍         | 2/50 [06:20<2:29:31, 186.92s/it]Best score increase :0.389 -> 0.497
training process:   6%|▌         | 3/50 [09:12<2:21:05, 180.12s/it]Best score increase :0.497 -> 0.536
training process:   8%|▊         | 4/50 [12:04<2:15:37, 176.91s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.002, valid loss : 0.029, train acc : 0.886, valid acc : 0.875, train f1 : 0.884, valid f1 : 0.574
training process:  10%|█         | 5/50 [15:34<2:21:26, 188.59s/it]Best score increase :0.536 -> 0.574
training process:  12%|█▏        | 6/50 [18:26<2:14:15, 183.09s/it]Best score increase :0.574 -> 0.582
training process:  14%|█▍        | 7/50 [21:16<2:08:12, 178.91s/it]EarlyStopping counter : 1 out of 12
training process:  16%|█▌        | 8/50 [24:08<2:03:42, 176.73s/it]EarlyStopping counter : 2 out of 12
epoch : 9, train loss : 0.001, valid loss : 0.033, train acc : 0.907, valid acc : 0.870, train f1 : 0.906, valid f1 : 0.571
training process:  18%|█▊        | 9/50 [27:39<2:07:53, 187.16s/it]EarlyStopping counter : 3 out of 12
training process:  20%|██        | 10/50 [30:29<2:01:15, 181.89s/it]EarlyStopping counter : 4 out of 12
training process:  22%|██▏       | 11/50 [33:18<1:55:39, 177.93s/it]EarlyStopping counter : 5 out of 12
training process:  24%|██▍       | 12/50 [36:07<1:51:03, 175.36s/it]Best score increase :0.582 -> 0.590
epoch : 13, train loss : 0.002, valid loss : 0.034, train acc : 0.911, valid acc : 0.853, train f1 : 0.910, valid f1 : 0.555
training process:  26%|██▌       | 13/50 [39:35<1:54:14, 185.25s/it]EarlyStopping counter : 1 out of 12
training process:  28%|██▊       | 14/50 [42:25<1:48:24, 180.67s/it]Best score increase :0.590 -> 0.591
training process:  30%|███       | 15/50 [45:15<1:43:29, 177.40s/it]EarlyStopping counter : 1 out of 12
training process:  32%|███▏      | 16/50 [48:04<1:39:08, 174.97s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.001, valid loss : 0.026, train acc : 0.914, valid acc : 0.889, train f1 : 0.914, valid f1 : 0.589
training process:  34%|███▍      | 17/50 [51:32<1:41:41, 184.89s/it]EarlyStopping counter : 3 out of 12
training process:  36%|███▌      | 18/50 [54:20<1:35:51, 179.73s/it]EarlyStopping counter : 4 out of 12
training process:  38%|███▊      | 19/50 [57:12<1:31:42, 177.49s/it]Best score increase :0.591 -> 0.595
training process:  40%|████      | 20/50 [1:00:05<1:28:05, 176.19s/it]EarlyStopping counter : 1 out of 12
epoch : 21, train loss : 0.002, valid loss : 0.023, train acc : 0.906, valid acc : 0.897, train f1 : 0.905, valid f1 : 0.598
training process:  42%|████▏     | 21/50 [1:03:36<1:30:09, 186.52s/it]Best score increase :0.595 -> 0.598
training process:  44%|████▍     | 22/50 [1:06:26<1:24:46, 181.65s/it]Best score increase :0.598 -> 0.611
training process:  46%|████▌     | 23/50 [1:09:16<1:20:11, 178.20s/it]EarlyStopping counter : 1 out of 12
training process:  48%|████▊     | 24/50 [1:12:05<1:15:59, 175.37s/it]EarlyStopping counter : 2 out of 12
epoch : 25, train loss : 0.001, valid loss : 0.027, train acc : 0.926, valid acc : 0.875, train f1 : 0.926, valid f1 : 0.575
training process:  50%|█████     | 25/50 [1:15:32<1:16:56, 184.68s/it]EarlyStopping counter : 3 out of 12
training process:  52%|█████▏    | 26/50 [1:18:23<1:12:15, 180.63s/it]EarlyStopping counter : 4 out of 12
training process:  54%|█████▍    | 27/50 [1:21:14<1:08:12, 177.93s/it]EarlyStopping counter : 5 out of 12
training process:  56%|█████▌    | 28/50 [1:24:06<1:04:32, 176.03s/it]EarlyStopping counter : 6 out of 12
epoch : 29, train loss : 0.001, valid loss : 0.049, train acc : 0.930, valid acc : 0.822, train f1 : 0.930, valid f1 : 0.533
training process:  58%|█████▊    | 29/50 [1:27:37<1:05:15, 186.46s/it]EarlyStopping counter : 7 out of 12
training process:  60%|██████    | 30/50 [1:30:27<1:00:31, 181.59s/it]EarlyStopping counter : 8 out of 12
training process:  62%|██████▏   | 31/50 [1:33:19<56:33, 178.62s/it]  Best score increase :0.611 -> 0.629
training process:  64%|██████▍   | 32/50 [1:36:09<52:49, 176.11s/it]Best score increase :0.629 -> 0.631
epoch : 33, train loss : 0.001, valid loss : 0.022, train acc : 0.927, valid acc : 0.891, train f1 : 0.927, valid f1 : 0.591
training process:  66%|██████▌   | 33/50 [1:39:38<52:42, 186.01s/it]EarlyStopping counter : 1 out of 12
training process:  68%|██████▊   | 34/50 [1:42:30<48:27, 181.72s/it]EarlyStopping counter : 2 out of 12
training process:  70%|███████   | 35/50 [1:45:19<44:30, 178.05s/it]EarlyStopping counter : 3 out of 12
training process:  72%|███████▏  | 36/50 [1:48:10<41:00, 175.78s/it]EarlyStopping counter : 4 out of 12
epoch : 37, train loss : 0.001, valid loss : 0.021, train acc : 0.928, valid acc : 0.919, train f1 : 0.928, valid f1 : 0.628
training process:  74%|███████▍  | 37/50 [1:51:39<40:14, 185.75s/it]EarlyStopping counter : 5 out of 12
training process:  76%|███████▌  | 38/50 [1:54:29<36:11, 180.98s/it]EarlyStopping counter : 6 out of 12
training process:  78%|███████▊  | 39/50 [1:57:18<32:31, 177.38s/it]EarlyStopping counter : 7 out of 12
training process:  80%|████████  | 40/50 [2:00:06<29:05, 174.56s/it]EarlyStopping counter : 8 out of 12
epoch : 41, train loss : 0.001, valid loss : 0.031, train acc : 0.935, valid acc : 0.873, train f1 : 0.935, valid f1 : 0.573
training process:  82%|████████▏ | 41/50 [2:03:33<27:40, 184.55s/it]EarlyStopping counter : 9 out of 12
training process:  84%|████████▍ | 42/50 [2:06:23<24:01, 180.17s/it]Best score increase :0.631 -> 0.639
training process:  86%|████████▌ | 43/50 [2:09:14<20:41, 177.40s/it]EarlyStopping counter : 1 out of 12
training process:  88%|████████▊ | 44/50 [2:12:06<17:33, 175.63s/it]Best score increase :0.639 -> 0.644
epoch : 45, train loss : 0.001, valid loss : 0.028, train acc : 0.936, valid acc : 0.904, train f1 : 0.936, valid f1 : 0.607
training process:  90%|█████████ | 45/50 [2:15:33<15:25, 185.19s/it]EarlyStopping counter : 1 out of 12
training process:  92%|█████████▏| 46/50 [2:18:26<12:05, 181.28s/it]EarlyStopping counter : 2 out of 12
training process:  94%|█████████▍| 47/50 [2:21:17<08:54, 178.26s/it]Best score increase :0.644 -> 0.645
training process:  96%|█████████▌| 48/50 [2:24:08<05:52, 176.07s/it]EarlyStopping counter : 1 out of 12
epoch : 49, train loss : 0.001, valid loss : 0.021, train acc : 0.936, valid acc : 0.923, train f1 : 0.936, valid f1 : 0.633
training process:  98%|█████████▊| 49/50 [2:27:37<03:06, 186.02s/it]EarlyStopping counter : 2 out of 12
training process: 100%|██████████| 50/50 [2:30:25<00:00, 180.62s/it]training process: 100%|██████████| 50/50 [2:30:25<00:00, 180.51s/it]
EarlyStopping counter : 3 out of 12
training process finished, best loss : 0.022 and best acc : 0.929, best f1 : 0.645, best epoch : 46

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.14      0.89      0.24        71
           1       1.00      0.90      0.94      3812

    accuracy                           0.90      3883
   macro avg       0.57      0.89      0.59      3883
weighted avg       0.98      0.90      0.93      3883


# test acc : 0.90, test f1 : 0.59, test AUC : 0.89, test loss : 0.457

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:39, 25.00it/s]  1%|          | 6/981 [00:00<00:37, 26.09it/s]  1%|          | 9/981 [00:00<00:36, 26.43it/s]  1%|          | 12/981 [00:00<00:36, 26.62it/s]  2%|▏         | 15/981 [00:00<00:36, 26.73it/s]  2%|▏         | 18/981 [00:00<00:35, 26.82it/s]  2%|▏         | 21/981 [00:00<00:35, 26.86it/s]  2%|▏         | 24/981 [00:00<00:35, 26.98it/s]  3%|▎         | 27/981 [00:01<00:35, 26.97it/s]  3%|▎         | 30/981 [00:01<00:35, 26.93it/s]  3%|▎         | 33/981 [00:01<00:35, 26.93it/s]  4%|▎         | 36/981 [00:01<00:35, 26.92it/s]  4%|▍         | 39/981 [00:01<00:35, 26.80it/s]  4%|▍         | 42/981 [00:01<00:34, 26.89it/s]  5%|▍         | 45/981 [00:01<00:34, 26.93it/s]  5%|▍         | 48/981 [00:01<00:34, 26.94it/s]  5%|▌         | 51/981 [00:01<00:34, 27.01it/s]  6%|▌         | 54/981 [00:02<00:34, 26.98it/s]  6%|▌         | 57/981 [00:02<00:34, 26.75it/s]  6%|▌         | 60/981 [00:02<00:34, 26.33it/s]  6%|▋         | 63/981 [00:02<00:36, 25.16it/s]  7%|▋         | 66/981 [00:02<00:37, 24.44it/s]  7%|▋         | 69/981 [00:02<00:38, 23.93it/s]  7%|▋         | 72/981 [00:02<00:38, 23.92it/s]  8%|▊         | 75/981 [00:02<00:36, 24.76it/s]  8%|▊         | 78/981 [00:02<00:35, 25.40it/s]  8%|▊         | 81/981 [00:03<00:34, 25.78it/s]  9%|▊         | 84/981 [00:03<00:34, 26.14it/s]  9%|▉         | 87/981 [00:03<00:33, 26.41it/s]  9%|▉         | 90/981 [00:03<00:33, 26.44it/s]  9%|▉         | 93/981 [00:03<00:33, 26.17it/s] 10%|▉         | 96/981 [00:03<00:33, 26.31it/s] 10%|█         | 99/981 [00:03<00:33, 26.13it/s] 10%|█         | 102/981 [00:03<00:33, 26.38it/s] 11%|█         | 105/981 [00:04<00:33, 26.54it/s] 11%|█         | 108/981 [00:04<00:32, 26.55it/s] 11%|█▏        | 111/981 [00:04<00:32, 26.63it/s] 12%|█▏        | 114/981 [00:04<00:32, 26.61it/s] 12%|█▏        | 117/981 [00:04<00:32, 26.67it/s] 12%|█▏        | 120/981 [00:04<00:32, 26.73it/s] 13%|█▎        | 123/981 [00:04<00:32, 26.75it/s] 13%|█▎        | 126/981 [00:04<00:31, 26.83it/s] 13%|█▎        | 129/981 [00:04<00:31, 26.78it/s] 13%|█▎        | 132/981 [00:05<00:31, 26.77it/s] 14%|█▍        | 135/981 [00:05<00:31, 26.71it/s] 14%|█▍        | 138/981 [00:05<00:31, 26.74it/s] 14%|█▍        | 141/981 [00:05<00:31, 26.81it/s] 15%|█▍        | 144/981 [00:05<00:31, 26.87it/s] 15%|█▍        | 147/981 [00:05<00:31, 26.82it/s] 15%|█▌        | 150/981 [00:05<00:30, 26.93it/s] 16%|█▌        | 153/981 [00:05<00:31, 26.54it/s] 16%|█▌        | 156/981 [00:05<00:30, 26.72it/s] 16%|█▌        | 159/981 [00:06<00:30, 26.63it/s] 17%|█▋        | 162/981 [00:06<00:30, 26.52it/s] 17%|█▋        | 165/981 [00:06<00:30, 26.71it/s] 17%|█▋        | 168/981 [00:06<00:30, 26.74it/s] 17%|█▋        | 171/981 [00:06<00:30, 26.74it/s] 18%|█▊        | 174/981 [00:06<00:30, 26.73it/s] 18%|█▊        | 177/981 [00:06<00:29, 26.91it/s] 18%|█▊        | 180/981 [00:06<00:29, 26.84it/s] 19%|█▊        | 183/981 [00:06<00:29, 26.97it/s] 19%|█▉        | 186/981 [00:07<00:29, 27.06it/s] 19%|█▉        | 189/981 [00:07<00:29, 27.08it/s] 20%|█▉        | 192/981 [00:07<00:29, 27.13it/s] 20%|█▉        | 195/981 [00:07<00:28, 27.14it/s] 20%|██        | 198/981 [00:07<00:28, 27.11it/s] 20%|██        | 201/981 [00:07<00:28, 27.04it/s] 21%|██        | 204/981 [00:07<00:28, 26.99it/s] 21%|██        | 207/981 [00:07<00:28, 26.85it/s] 21%|██▏       | 210/981 [00:07<00:28, 26.74it/s] 22%|██▏       | 213/981 [00:08<00:28, 26.67it/s] 22%|██▏       | 216/981 [00:08<00:28, 26.55it/s] 22%|██▏       | 219/981 [00:08<00:28, 26.38it/s] 23%|██▎       | 222/981 [00:08<00:28, 26.36it/s] 23%|██▎       | 225/981 [00:08<00:28, 26.40it/s] 23%|██▎       | 228/981 [00:08<00:28, 26.42it/s] 24%|██▎       | 231/981 [00:08<00:28, 26.29it/s] 24%|██▍       | 234/981 [00:08<00:28, 26.30it/s] 24%|██▍       | 237/981 [00:08<00:29, 25.36it/s] 24%|██▍       | 240/981 [00:09<00:30, 23.91it/s] 25%|██▍       | 243/981 [00:09<00:32, 23.03it/s] 25%|██▌       | 246/981 [00:09<00:32, 22.73it/s] 25%|██▌       | 249/981 [00:09<00:31, 23.51it/s] 26%|██▌       | 252/981 [00:09<00:30, 24.08it/s] 26%|██▌       | 255/981 [00:09<00:29, 24.46it/s] 26%|██▋       | 258/981 [00:09<00:29, 24.78it/s] 27%|██▋       | 261/981 [00:09<00:29, 24.74it/s] 27%|██▋       | 264/981 [00:10<00:29, 24.23it/s] 27%|██▋       | 267/981 [00:10<00:28, 24.87it/s] 28%|██▊       | 270/981 [00:10<00:28, 25.02it/s] 28%|██▊       | 273/981 [00:10<00:27, 25.50it/s] 28%|██▊       | 276/981 [00:10<00:27, 25.83it/s] 28%|██▊       | 279/981 [00:10<00:26, 26.08it/s] 29%|██▊       | 282/981 [00:10<00:26, 26.26it/s] 29%|██▉       | 285/981 [00:10<00:26, 26.14it/s] 29%|██▉       | 288/981 [00:11<00:26, 26.15it/s] 30%|██▉       | 291/981 [00:11<00:26, 26.21it/s] 30%|██▉       | 294/981 [00:11<00:26, 26.30it/s] 30%|███       | 297/981 [00:11<00:26, 26.30it/s] 31%|███       | 300/981 [00:11<00:25, 26.21it/s] 31%|███       | 303/981 [00:11<00:25, 26.26it/s] 31%|███       | 306/981 [00:11<00:25, 26.32it/s] 31%|███▏      | 309/981 [00:11<00:25, 26.34it/s] 32%|███▏      | 312/981 [00:11<00:25, 25.75it/s] 32%|███▏      | 315/981 [00:12<00:25, 25.91it/s] 32%|███▏      | 318/981 [00:12<00:25, 25.98it/s] 33%|███▎      | 321/981 [00:12<00:25, 26.03it/s] 33%|███▎      | 324/981 [00:12<00:25, 26.17it/s] 33%|███▎      | 327/981 [00:12<00:24, 26.31it/s] 34%|███▎      | 330/981 [00:12<00:24, 26.24it/s] 34%|███▍      | 333/981 [00:12<00:24, 26.37it/s] 34%|███▍      | 336/981 [00:12<00:24, 26.40it/s] 35%|███▍      | 339/981 [00:12<00:24, 26.32it/s] 35%|███▍      | 342/981 [00:13<00:24, 26.41it/s] 35%|███▌      | 345/981 [00:13<00:24, 25.92it/s] 35%|███▌      | 348/981 [00:13<00:24, 25.86it/s] 36%|███▌      | 351/981 [00:13<00:24, 26.03it/s] 36%|███▌      | 354/981 [00:13<00:23, 26.15it/s] 36%|███▋      | 357/981 [00:13<00:23, 26.15it/s] 37%|███▋      | 360/981 [00:13<00:23, 26.18it/s] 37%|███▋      | 363/981 [00:13<00:23, 26.31it/s] 37%|███▋      | 366/981 [00:13<00:23, 26.37it/s] 38%|███▊      | 369/981 [00:14<00:23, 26.37it/s] 38%|███▊      | 372/981 [00:14<00:23, 26.38it/s] 38%|███▊      | 375/981 [00:14<00:22, 26.43it/s] 39%|███▊      | 378/981 [00:14<00:22, 26.33it/s] 39%|███▉      | 381/981 [00:14<00:22, 26.39it/s] 39%|███▉      | 384/981 [00:14<00:22, 26.09it/s] 39%|███▉      | 387/981 [00:14<00:22, 26.18it/s] 40%|███▉      | 390/981 [00:14<00:22, 26.30it/s] 40%|████      | 393/981 [00:15<00:22, 26.36it/s] 40%|████      | 396/981 [00:15<00:22, 26.19it/s] 41%|████      | 399/981 [00:15<00:22, 26.26it/s] 41%|████      | 402/981 [00:15<00:21, 26.33it/s] 41%|████▏     | 405/981 [00:15<00:21, 26.28it/s] 42%|████▏     | 408/981 [00:15<00:21, 26.38it/s] 42%|████▏     | 411/981 [00:15<00:21, 26.50it/s] 42%|████▏     | 414/981 [00:15<00:21, 26.53it/s] 43%|████▎     | 417/981 [00:15<00:21, 26.60it/s] 43%|████▎     | 420/981 [00:16<00:21, 26.60it/s] 43%|████▎     | 423/981 [00:16<00:21, 26.56it/s] 43%|████▎     | 426/981 [00:16<00:20, 26.59it/s] 44%|████▎     | 429/981 [00:16<00:20, 26.60it/s] 44%|████▍     | 432/981 [00:16<00:20, 26.49it/s] 44%|████▍     | 435/981 [00:16<00:20, 26.42it/s] 45%|████▍     | 438/981 [00:16<00:20, 26.38it/s] 45%|████▍     | 441/981 [00:16<00:20, 26.41it/s] 45%|████▌     | 444/981 [00:16<00:20, 26.45it/s] 46%|████▌     | 447/981 [00:17<00:20, 26.47it/s] 46%|████▌     | 450/981 [00:17<00:20, 26.48it/s] 46%|████▌     | 453/981 [00:17<00:19, 26.53it/s] 46%|████▋     | 456/981 [00:17<00:19, 26.54it/s] 47%|████▋     | 459/981 [00:17<00:19, 26.56it/s] 47%|████▋     | 462/981 [00:17<00:19, 26.53it/s] 47%|████▋     | 465/981 [00:17<00:19, 26.58it/s] 48%|████▊     | 468/981 [00:17<00:19, 26.63it/s] 48%|████▊     | 471/981 [00:17<00:19, 26.41it/s] 48%|████▊     | 474/981 [00:18<00:19, 26.42it/s] 49%|████▊     | 477/981 [00:18<00:19, 26.50it/s] 49%|████▉     | 480/981 [00:18<00:19, 26.29it/s] 49%|████▉     | 483/981 [00:18<00:18, 26.42it/s] 50%|████▉     | 486/981 [00:18<00:19, 25.39it/s] 50%|████▉     | 489/981 [00:18<00:20, 23.65it/s] 50%|█████     | 492/981 [00:18<00:20, 24.41it/s] 50%|█████     | 495/981 [00:18<00:19, 25.12it/s] 51%|█████     | 498/981 [00:19<00:18, 25.59it/s] 51%|█████     | 501/981 [00:19<00:18, 25.90it/s] 51%|█████▏    | 504/981 [00:19<00:18, 25.95it/s] 52%|█████▏    | 507/981 [00:19<00:18, 26.21it/s] 52%|█████▏    | 510/981 [00:19<00:17, 26.29it/s] 52%|█████▏    | 513/981 [00:19<00:17, 26.34it/s] 53%|█████▎    | 516/981 [00:19<00:17, 26.62it/s] 53%|█████▎    | 519/981 [00:19<00:17, 26.66it/s] 53%|█████▎    | 522/981 [00:19<00:17, 26.45it/s] 54%|█████▎    | 525/981 [00:20<00:17, 26.67it/s] 54%|█████▍    | 528/981 [00:20<00:16, 26.72it/s] 54%|█████▍    | 531/981 [00:20<00:16, 26.54it/s] 54%|█████▍    | 534/981 [00:20<00:16, 26.75it/s] 55%|█████▍    | 537/981 [00:20<00:16, 26.98it/s] 55%|█████▌    | 540/981 [00:20<00:16, 26.57it/s] 55%|█████▌    | 543/981 [00:20<00:16, 26.84it/s] 56%|█████▌    | 546/981 [00:20<00:16, 27.06it/s] 56%|█████▌    | 549/981 [00:20<00:15, 27.21it/s] 56%|█████▋    | 552/981 [00:21<00:15, 27.33it/s] 57%|█████▋    | 555/981 [00:21<00:15, 27.34it/s] 57%|█████▋    | 558/981 [00:21<00:15, 27.40it/s] 57%|█████▋    | 561/981 [00:21<00:15, 27.44it/s] 57%|█████▋    | 564/981 [00:21<00:15, 27.32it/s] 58%|█████▊    | 567/981 [00:21<00:15, 27.39it/s] 58%|█████▊    | 570/981 [00:21<00:14, 27.48it/s] 58%|█████▊    | 573/981 [00:21<00:14, 27.51it/s] 59%|█████▊    | 576/981 [00:21<00:14, 27.57it/s] 59%|█████▉    | 579/981 [00:22<00:14, 27.59it/s] 59%|█████▉    | 582/981 [00:22<00:14, 27.58it/s] 60%|█████▉    | 585/981 [00:22<00:14, 27.38it/s] 60%|█████▉    | 588/981 [00:22<00:14, 27.27it/s] 60%|██████    | 591/981 [00:22<00:14, 27.39it/s] 61%|██████    | 594/981 [00:22<00:14, 27.46it/s] 61%|██████    | 597/981 [00:22<00:14, 27.37it/s] 61%|██████    | 600/981 [00:22<00:13, 27.28it/s] 61%|██████▏   | 603/981 [00:22<00:13, 27.38it/s] 62%|██████▏   | 606/981 [00:23<00:13, 27.47it/s] 62%|██████▏   | 609/981 [00:23<00:13, 27.26it/s] 62%|██████▏   | 612/981 [00:23<00:13, 27.29it/s] 63%|██████▎   | 615/981 [00:23<00:13, 27.38it/s] 63%|██████▎   | 618/981 [00:23<00:13, 27.41it/s] 63%|██████▎   | 621/981 [00:23<00:13, 27.50it/s] 64%|██████▎   | 624/981 [00:23<00:12, 27.58it/s] 64%|██████▍   | 627/981 [00:23<00:12, 27.58it/s] 64%|██████▍   | 630/981 [00:23<00:12, 27.60it/s] 65%|██████▍   | 633/981 [00:23<00:12, 27.45it/s] 65%|██████▍   | 636/981 [00:24<00:12, 27.46it/s] 65%|██████▌   | 639/981 [00:24<00:12, 27.44it/s] 65%|██████▌   | 642/981 [00:24<00:12, 27.11it/s] 66%|██████▌   | 645/981 [00:24<00:12, 27.22it/s] 66%|██████▌   | 648/981 [00:24<00:12, 27.35it/s] 66%|██████▋   | 651/981 [00:24<00:12, 27.45it/s] 67%|██████▋   | 654/981 [00:24<00:11, 27.52it/s] 67%|██████▋   | 657/981 [00:24<00:11, 27.51it/s] 67%|██████▋   | 660/981 [00:24<00:11, 27.54it/s] 68%|██████▊   | 663/981 [00:25<00:11, 27.38it/s] 68%|██████▊   | 666/981 [00:25<00:11, 27.26it/s] 68%|██████▊   | 669/981 [00:25<00:11, 27.30it/s] 69%|██████▊   | 672/981 [00:25<00:11, 27.36it/s] 69%|██████▉   | 675/981 [00:25<00:11, 27.45it/s] 69%|██████▉   | 678/981 [00:25<00:11, 27.50it/s] 69%|██████▉   | 681/981 [00:25<00:10, 27.56it/s] 70%|██████▉   | 684/981 [00:25<00:10, 27.43it/s] 70%|███████   | 687/981 [00:25<00:10, 27.49it/s] 70%|███████   | 690/981 [00:26<00:10, 27.54it/s] 71%|███████   | 693/981 [00:26<00:10, 27.47it/s] 71%|███████   | 696/981 [00:26<00:10, 27.53it/s] 71%|███████▏  | 699/981 [00:26<00:10, 27.51it/s] 72%|███████▏  | 702/981 [00:26<00:10, 27.54it/s] 72%|███████▏  | 705/981 [00:26<00:10, 27.54it/s] 72%|███████▏  | 708/981 [00:26<00:09, 27.56it/s] 72%|███████▏  | 711/981 [00:26<00:09, 27.46it/s] 73%|███████▎  | 714/981 [00:26<00:09, 27.17it/s] 73%|███████▎  | 717/981 [00:27<00:09, 26.63it/s] 73%|███████▎  | 720/981 [00:27<00:09, 26.79it/s] 74%|███████▎  | 723/981 [00:27<00:09, 26.85it/s] 74%|███████▍  | 726/981 [00:27<00:09, 27.01it/s] 74%|███████▍  | 729/981 [00:27<00:09, 27.16it/s] 75%|███████▍  | 732/981 [00:27<00:09, 27.25it/s] 75%|███████▍  | 735/981 [00:27<00:08, 27.35it/s] 75%|███████▌  | 738/981 [00:27<00:08, 27.32it/s] 76%|███████▌  | 741/981 [00:27<00:08, 27.24it/s] 76%|███████▌  | 744/981 [00:28<00:08, 27.22it/s] 76%|███████▌  | 747/981 [00:28<00:08, 27.19it/s] 76%|███████▋  | 750/981 [00:28<00:08, 27.06it/s] 77%|███████▋  | 753/981 [00:28<00:08, 27.05it/s] 77%|███████▋  | 756/981 [00:28<00:08, 27.11it/s] 77%|███████▋  | 759/981 [00:28<00:08, 27.13it/s] 78%|███████▊  | 762/981 [00:28<00:08, 27.14it/s] 78%|███████▊  | 765/981 [00:28<00:07, 27.11it/s] 78%|███████▊  | 768/981 [00:28<00:07, 26.75it/s] 79%|███████▊  | 771/981 [00:29<00:07, 26.82it/s] 79%|███████▉  | 774/981 [00:29<00:07, 26.70it/s] 79%|███████▉  | 777/981 [00:29<00:07, 26.72it/s] 80%|███████▉  | 780/981 [00:29<00:07, 26.95it/s] 80%|███████▉  | 783/981 [00:29<00:07, 27.29it/s] 80%|████████  | 786/981 [00:29<00:07, 27.66it/s] 80%|████████  | 789/981 [00:29<00:06, 28.18it/s] 81%|████████  | 792/981 [00:29<00:06, 28.45it/s] 81%|████████  | 796/981 [00:29<00:06, 29.20it/s] 82%|████████▏ | 800/981 [00:30<00:06, 29.83it/s] 82%|████████▏ | 804/981 [00:30<00:05, 30.14it/s] 82%|████████▏ | 808/981 [00:30<00:05, 30.30it/s] 83%|████████▎ | 812/981 [00:30<00:05, 28.66it/s] 83%|████████▎ | 815/981 [00:30<00:05, 28.65it/s] 83%|████████▎ | 819/981 [00:30<00:05, 29.10it/s] 84%|████████▍ | 822/981 [00:30<00:05, 29.30it/s] 84%|████████▍ | 826/981 [00:30<00:05, 29.97it/s] 85%|████████▍ | 829/981 [00:31<00:05, 29.97it/s] 85%|████████▍ | 833/981 [00:31<00:04, 30.42it/s] 85%|████████▌ | 837/981 [00:31<00:04, 30.78it/s] 86%|████████▌ | 841/981 [00:31<00:04, 30.65it/s] 86%|████████▌ | 845/981 [00:31<00:04, 30.20it/s] 87%|████████▋ | 849/981 [00:31<00:04, 30.11it/s] 87%|████████▋ | 853/981 [00:31<00:04, 30.15it/s] 87%|████████▋ | 857/981 [00:31<00:04, 30.17it/s] 88%|████████▊ | 861/981 [00:32<00:04, 29.64it/s] 88%|████████▊ | 865/981 [00:32<00:03, 29.91it/s] 88%|████████▊ | 868/981 [00:32<00:03, 29.93it/s] 89%|████████▉ | 872/981 [00:32<00:03, 30.02it/s] 89%|████████▉ | 876/981 [00:32<00:03, 30.18it/s] 90%|████████▉ | 880/981 [00:32<00:03, 30.27it/s] 90%|█████████ | 884/981 [00:32<00:03, 30.35it/s] 91%|█████████ | 888/981 [00:32<00:03, 30.51it/s] 91%|█████████ | 892/981 [00:33<00:02, 30.20it/s] 91%|█████████▏| 896/981 [00:33<00:02, 30.27it/s] 92%|█████████▏| 900/981 [00:33<00:02, 30.32it/s] 92%|█████████▏| 904/981 [00:33<00:02, 29.33it/s] 92%|█████████▏| 907/981 [00:33<00:02, 28.79it/s] 93%|█████████▎| 910/981 [00:33<00:02, 28.27it/s] 93%|█████████▎| 913/981 [00:33<00:02, 27.98it/s] 93%|█████████▎| 916/981 [00:33<00:02, 27.78it/s] 94%|█████████▎| 919/981 [00:34<00:02, 27.39it/s] 94%|█████████▍| 923/981 [00:34<00:02, 28.71it/s] 94%|█████████▍| 927/981 [00:34<00:01, 29.63it/s] 95%|█████████▍| 931/981 [00:34<00:01, 30.25it/s] 95%|█████████▌| 935/981 [00:34<00:01, 30.66it/s] 96%|█████████▌| 939/981 [00:34<00:01, 31.03it/s] 96%|█████████▌| 943/981 [00:34<00:01, 31.24it/s] 97%|█████████▋| 947/981 [00:34<00:01, 31.38it/s] 97%|█████████▋| 951/981 [00:35<00:00, 31.49it/s] 97%|█████████▋| 955/981 [00:35<00:00, 31.41it/s] 98%|█████████▊| 959/981 [00:35<00:00, 31.09it/s] 98%|█████████▊| 963/981 [00:35<00:00, 31.24it/s] 99%|█████████▊| 967/981 [00:35<00:00, 30.98it/s] 99%|█████████▉| 971/981 [00:35<00:00, 31.21it/s] 99%|█████████▉| 975/981 [00:35<00:00, 31.37it/s]100%|█████████▉| 979/981 [00:36<00:00, 31.49it/s]100%|██████████| 981/981 [00:36<00:00, 27.20it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_LDAM_DRW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.006, valid loss : 0.007, train f1 : 0.509, valid f1 : 0.495
training process - Deferred Re-weighting:   2%|▏         | 1/50 [03:33<2:54:06, 213.19s/it]Best score increase :0.000 -> 0.495
training process - Deferred Re-weighting:   4%|▍         | 2/50 [06:24<2:30:47, 188.49s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▌         | 3/50 [09:15<2:21:31, 180.67s/it]Best score increase :0.495 -> 0.784
training process - Deferred Re-weighting:   8%|▊         | 4/50 [12:05<2:15:16, 176.44s/it]EarlyStopping counter : 1 out of 12
epoch : 5, train loss : 0.004, valid loss : 0.005, train f1 : 0.756, valid f1 : 0.770
training process - Deferred Re-weighting:  10%|█         | 5/50 [15:36<2:21:36, 188.82s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [18:26<2:13:54, 182.59s/it]Best score increase :0.784 -> 0.794
training process - Deferred Re-weighting:  14%|█▍        | 7/50 [21:17<2:08:06, 178.75s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 8/50 [24:08<2:03:21, 176.22s/it]Best score increase :0.794 -> 0.804
epoch : 9, train loss : 0.004, valid loss : 0.003, train f1 : 0.788, valid f1 : 0.819
training process - Deferred Re-weighting:  18%|█▊        | 9/50 [27:38<2:07:35, 186.73s/it]Best score increase :0.804 -> 0.819
training process - Deferred Re-weighting:  20%|██        | 10/50 [30:28<2:01:06, 181.66s/it]Best score increase :0.819 -> 0.831
training process - Deferred Re-weighting:  22%|██▏       | 11/50 [33:20<1:56:07, 178.64s/it]Best score increase :0.831 -> 0.884
training process - Deferred Re-weighting:  24%|██▍       | 12/50 [36:11<1:51:36, 176.22s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.002, valid loss : 0.004, train f1 : 0.881, valid f1 : 0.794
training process - Deferred Re-weighting:  26%|██▌       | 13/50 [39:41<1:55:01, 186.53s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [42:30<1:48:47, 181.33s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|███       | 15/50 [45:20<1:43:47, 177.94s/it]Best score increase :0.884 -> 0.901
training process - Deferred Re-weighting:  32%|███▏      | 16/50 [48:09<1:39:15, 175.18s/it]Best score increase :0.901 -> 0.913
epoch : 17, train loss : 0.002, valid loss : 0.002, train f1 : 0.894, valid f1 : 0.922
training process - Deferred Re-weighting:  34%|███▍      | 17/50 [51:35<1:41:28, 184.50s/it]Best score increase :0.913 -> 0.922
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [54:25<1:36:00, 180.02s/it]Best score increase :0.922 -> 0.942
training process - Deferred Re-weighting:  38%|███▊      | 19/50 [57:14<1:31:22, 176.84s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  40%|████      | 20/50 [1:00:05<1:27:31, 175.03s/it]EarlyStopping counter : 2 out of 12
epoch : 21, train loss : 0.001, valid loss : 0.002, train f1 : 0.928, valid f1 : 0.926
training process - Deferred Re-weighting:  42%|████▏     | 21/50 [1:03:32<1:29:15, 184.66s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 22/50 [1:06:24<1:24:21, 180.77s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 23/50 [1:09:15<1:20:00, 177.80s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 24/50 [1:12:06<1:16:09, 175.74s/it]EarlyStopping counter : 6 out of 12
epoch : 25, train loss : 0.002, valid loss : 0.002, train f1 : 0.915, valid f1 : 0.906
training process - Deferred Re-weighting:  50%|█████     | 25/50 [1:15:35<1:17:23, 185.74s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  52%|█████▏    | 26/50 [1:18:26<1:12:31, 181.32s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  54%|█████▍    | 27/50 [1:21:16<1:08:10, 177.83s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  56%|█████▌    | 28/50 [1:24:07<1:04:28, 175.86s/it]EarlyStopping counter : 10 out of 12
epoch : 29, train loss : 0.002, valid loss : 0.002, train f1 : 0.922, valid f1 : 0.920
training process - Deferred Re-weighting:  58%|█████▊    | 29/50 [1:27:36<1:05:02, 185.82s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  58%|█████▊    | 29/50 [1:30:25<1:05:28, 187.09s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 29, best f1 score : 0.942
training process finished, best loss : 0.001, best acc : 0.996, best f1 : 0.942, best epoch : 17

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.77      0.72        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.83      0.88      0.86      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.86, test AUC : 0.88, test loss : 0.057

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:43, 22.53it/s]  1%|          | 6/981 [00:00<00:38, 25.01it/s]  1%|          | 9/981 [00:00<00:37, 25.99it/s]  1%|          | 12/981 [00:00<00:36, 26.44it/s]  2%|▏         | 15/981 [00:00<00:36, 26.65it/s]  2%|▏         | 18/981 [00:00<00:35, 26.80it/s]  2%|▏         | 21/981 [00:00<00:35, 26.90it/s]  2%|▏         | 24/981 [00:00<00:35, 26.86it/s]  3%|▎         | 27/981 [00:01<00:35, 26.89it/s]  3%|▎         | 30/981 [00:01<00:35, 26.99it/s]  3%|▎         | 33/981 [00:01<00:35, 27.08it/s]  4%|▎         | 36/981 [00:01<00:35, 26.93it/s]  4%|▍         | 39/981 [00:01<00:34, 26.94it/s]  4%|▍         | 42/981 [00:01<00:34, 26.98it/s]  5%|▍         | 45/981 [00:01<00:34, 26.94it/s]  5%|▍         | 48/981 [00:01<00:34, 27.03it/s]  5%|▌         | 51/981 [00:01<00:34, 27.07it/s]  6%|▌         | 54/981 [00:02<00:34, 27.17it/s]  6%|▌         | 57/981 [00:02<00:33, 27.18it/s]  6%|▌         | 60/981 [00:02<00:33, 27.26it/s]  6%|▋         | 63/981 [00:02<00:33, 27.21it/s]  7%|▋         | 66/981 [00:02<00:33, 27.24it/s]  7%|▋         | 69/981 [00:02<00:33, 27.26it/s]  7%|▋         | 72/981 [00:02<00:33, 27.12it/s]  8%|▊         | 75/981 [00:02<00:33, 27.23it/s]  8%|▊         | 78/981 [00:02<00:33, 27.29it/s]  8%|▊         | 81/981 [00:03<00:33, 27.27it/s]  9%|▊         | 84/981 [00:03<00:32, 27.29it/s]  9%|▉         | 87/981 [00:03<00:32, 27.17it/s]  9%|▉         | 90/981 [00:03<00:32, 27.26it/s]  9%|▉         | 93/981 [00:03<00:32, 27.20it/s] 10%|▉         | 96/981 [00:03<00:32, 26.94it/s] 10%|█         | 99/981 [00:03<00:32, 26.97it/s] 10%|█         | 102/981 [00:03<00:33, 26.56it/s] 11%|█         | 105/981 [00:03<00:32, 26.68it/s] 11%|█         | 108/981 [00:04<00:32, 26.82it/s] 11%|█▏        | 111/981 [00:04<00:32, 26.83it/s] 12%|█▏        | 114/981 [00:04<00:32, 26.70it/s] 12%|█▏        | 117/981 [00:04<00:32, 26.82it/s] 12%|█▏        | 120/981 [00:04<00:31, 26.91it/s] 13%|█▎        | 123/981 [00:04<00:31, 26.93it/s] 13%|█▎        | 126/981 [00:04<00:32, 26.70it/s] 13%|█▎        | 129/981 [00:04<00:31, 26.81it/s] 13%|█▎        | 132/981 [00:04<00:31, 26.92it/s] 14%|█▍        | 135/981 [00:05<00:31, 26.88it/s] 14%|█▍        | 138/981 [00:05<00:31, 26.70it/s] 14%|█▍        | 141/981 [00:05<00:31, 26.68it/s] 15%|█▍        | 144/981 [00:05<00:34, 24.43it/s] 15%|█▍        | 147/981 [00:05<00:35, 23.67it/s] 15%|█▌        | 150/981 [00:05<00:36, 22.86it/s] 16%|█▌        | 153/981 [00:05<00:36, 22.95it/s] 16%|█▌        | 156/981 [00:05<00:35, 22.96it/s] 16%|█▌        | 159/981 [00:06<00:36, 22.68it/s] 17%|█▋        | 162/981 [00:06<00:35, 22.84it/s] 17%|█▋        | 165/981 [00:06<00:34, 23.55it/s] 17%|█▋        | 168/981 [00:06<00:33, 24.54it/s] 17%|█▋        | 171/981 [00:06<00:32, 25.20it/s] 18%|█▊        | 174/981 [00:06<00:31, 25.59it/s] 18%|█▊        | 177/981 [00:06<00:30, 26.04it/s] 18%|█▊        | 180/981 [00:06<00:30, 26.42it/s] 19%|█▊        | 183/981 [00:06<00:29, 26.62it/s] 19%|█▉        | 186/981 [00:07<00:29, 26.81it/s] 19%|█▉        | 189/981 [00:07<00:29, 26.90it/s] 20%|█▉        | 192/981 [00:07<00:29, 27.00it/s] 20%|█▉        | 195/981 [00:07<00:29, 26.93it/s] 20%|██        | 198/981 [00:07<00:29, 26.92it/s] 20%|██        | 201/981 [00:07<00:29, 26.89it/s] 21%|██        | 204/981 [00:07<00:28, 26.90it/s] 21%|██        | 207/981 [00:07<00:29, 26.63it/s] 21%|██▏       | 210/981 [00:07<00:29, 26.25it/s] 22%|██▏       | 213/981 [00:08<00:29, 26.35it/s] 22%|██▏       | 216/981 [00:08<00:28, 26.42it/s] 22%|██▏       | 219/981 [00:08<00:28, 26.44it/s] 23%|██▎       | 222/981 [00:08<00:28, 26.46it/s] 23%|██▎       | 225/981 [00:08<00:28, 26.40it/s] 23%|██▎       | 228/981 [00:08<00:28, 26.31it/s] 24%|██▎       | 231/981 [00:08<00:28, 26.35it/s] 24%|██▍       | 234/981 [00:08<00:28, 26.38it/s] 24%|██▍       | 237/981 [00:09<00:28, 26.41it/s] 24%|██▍       | 240/981 [00:09<00:28, 26.38it/s] 25%|██▍       | 243/981 [00:09<00:27, 26.43it/s] 25%|██▌       | 246/981 [00:09<00:27, 26.52it/s] 25%|██▌       | 249/981 [00:09<00:27, 26.55it/s] 26%|██▌       | 252/981 [00:09<00:27, 26.50it/s] 26%|██▌       | 255/981 [00:09<00:27, 26.56it/s] 26%|██▋       | 258/981 [00:09<00:27, 26.60it/s] 27%|██▋       | 261/981 [00:09<00:27, 26.62it/s] 27%|██▋       | 264/981 [00:10<00:26, 26.64it/s] 27%|██▋       | 267/981 [00:10<00:26, 26.67it/s] 28%|██▊       | 270/981 [00:10<00:26, 26.67it/s] 28%|██▊       | 273/981 [00:10<00:26, 26.51it/s] 28%|██▊       | 276/981 [00:10<00:26, 26.57it/s] 28%|██▊       | 279/981 [00:10<00:26, 26.32it/s] 29%|██▊       | 282/981 [00:10<00:26, 26.47it/s] 29%|██▉       | 285/981 [00:10<00:26, 26.60it/s] 29%|██▉       | 288/981 [00:10<00:26, 26.64it/s] 30%|██▉       | 291/981 [00:11<00:25, 26.63it/s] 30%|██▉       | 294/981 [00:11<00:25, 26.66it/s] 30%|███       | 297/981 [00:11<00:25, 26.57it/s] 31%|███       | 300/981 [00:11<00:25, 26.66it/s] 31%|███       | 303/981 [00:11<00:25, 26.68it/s] 31%|███       | 306/981 [00:11<00:25, 26.63it/s] 31%|███▏      | 309/981 [00:11<00:25, 26.46it/s] 32%|███▏      | 312/981 [00:11<00:25, 26.29it/s] 32%|███▏      | 315/981 [00:11<00:25, 26.36it/s] 32%|███▏      | 318/981 [00:12<00:25, 26.43it/s] 33%|███▎      | 321/981 [00:12<00:25, 26.36it/s] 33%|███▎      | 324/981 [00:12<00:24, 26.46it/s] 33%|███▎      | 327/981 [00:12<00:24, 26.53it/s] 34%|███▎      | 330/981 [00:12<00:24, 26.52it/s] 34%|███▍      | 333/981 [00:12<00:24, 26.52it/s] 34%|███▍      | 336/981 [00:12<00:24, 26.57it/s] 35%|███▍      | 339/981 [00:12<00:24, 26.60it/s] 35%|███▍      | 342/981 [00:12<00:24, 26.62it/s] 35%|███▌      | 345/981 [00:13<00:23, 26.56it/s] 35%|███▌      | 348/981 [00:13<00:23, 26.59it/s] 36%|███▌      | 351/981 [00:13<00:23, 26.62it/s] 36%|███▌      | 354/981 [00:13<00:23, 26.63it/s] 36%|███▋      | 357/981 [00:13<00:23, 26.47it/s] 37%|███▋      | 360/981 [00:13<00:23, 26.49it/s] 37%|███▋      | 363/981 [00:13<00:23, 26.53it/s] 37%|███▋      | 366/981 [00:13<00:23, 26.55it/s] 38%|███▊      | 369/981 [00:13<00:23, 26.51it/s] 38%|███▊      | 372/981 [00:14<00:22, 26.57it/s] 38%|███▊      | 375/981 [00:14<00:22, 26.59it/s] 39%|███▊      | 378/981 [00:14<00:22, 26.58it/s] 39%|███▉      | 381/981 [00:14<00:22, 26.56it/s] 39%|███▉      | 384/981 [00:14<00:22, 26.57it/s] 39%|███▉      | 387/981 [00:14<00:22, 26.59it/s] 40%|███▉      | 390/981 [00:14<00:22, 26.62it/s] 40%|████      | 393/981 [00:14<00:22, 26.59it/s] 40%|████      | 396/981 [00:15<00:22, 26.39it/s] 41%|████      | 399/981 [00:15<00:21, 26.46it/s] 41%|████      | 402/981 [00:15<00:21, 26.48it/s] 41%|████▏     | 405/981 [00:15<00:21, 26.55it/s] 42%|████▏     | 408/981 [00:15<00:21, 26.54it/s] 42%|████▏     | 411/981 [00:15<00:21, 26.52it/s] 42%|████▏     | 414/981 [00:15<00:21, 26.34it/s] 43%|████▎     | 417/981 [00:15<00:21, 26.47it/s] 43%|████▎     | 420/981 [00:15<00:21, 26.43it/s] 43%|████▎     | 423/981 [00:16<00:21, 26.16it/s] 43%|████▎     | 426/981 [00:16<00:21, 26.34it/s] 44%|████▎     | 429/981 [00:16<00:20, 26.44it/s] 44%|████▍     | 432/981 [00:16<00:20, 26.36it/s] 44%|████▍     | 435/981 [00:16<00:20, 26.23it/s] 45%|████▍     | 438/981 [00:16<00:20, 26.25it/s] 45%|████▍     | 441/981 [00:16<00:20, 26.03it/s] 45%|████▌     | 444/981 [00:16<00:20, 26.15it/s] 46%|████▌     | 447/981 [00:16<00:20, 26.33it/s] 46%|████▌     | 450/981 [00:17<00:20, 26.13it/s] 46%|████▌     | 453/981 [00:17<00:20, 26.13it/s] 46%|████▋     | 456/981 [00:17<00:19, 26.32it/s] 47%|████▋     | 459/981 [00:17<00:19, 26.27it/s] 47%|████▋     | 462/981 [00:17<00:19, 26.31it/s] 47%|████▋     | 465/981 [00:17<00:19, 26.26it/s] 48%|████▊     | 468/981 [00:17<00:19, 26.22it/s] 48%|████▊     | 471/981 [00:17<00:19, 26.37it/s] 48%|████▊     | 474/981 [00:17<00:19, 26.32it/s] 49%|████▊     | 477/981 [00:18<00:19, 26.33it/s] 49%|████▉     | 480/981 [00:18<00:18, 26.44it/s] 49%|████▉     | 483/981 [00:18<00:18, 26.60it/s] 50%|████▉     | 486/981 [00:18<00:18, 26.59it/s] 50%|████▉     | 489/981 [00:18<00:18, 26.63it/s] 50%|█████     | 492/981 [00:18<00:18, 26.70it/s] 50%|█████     | 495/981 [00:18<00:18, 26.75it/s] 51%|█████     | 498/981 [00:18<00:18, 26.81it/s] 51%|█████     | 501/981 [00:18<00:17, 26.86it/s] 51%|█████▏    | 504/981 [00:19<00:17, 26.72it/s] 52%|█████▏    | 507/981 [00:19<00:17, 26.81it/s] 52%|█████▏    | 510/981 [00:19<00:17, 26.74it/s] 52%|█████▏    | 513/981 [00:19<00:17, 26.54it/s] 53%|█████▎    | 516/981 [00:19<00:17, 26.73it/s] 53%|█████▎    | 519/981 [00:19<00:17, 26.87it/s] 53%|█████▎    | 522/981 [00:19<00:16, 27.01it/s] 54%|█████▎    | 525/981 [00:19<00:16, 27.06it/s] 54%|█████▍    | 528/981 [00:19<00:16, 27.14it/s] 54%|█████▍    | 531/981 [00:20<00:16, 27.04it/s] 54%|█████▍    | 534/981 [00:20<00:16, 26.80it/s] 55%|█████▍    | 537/981 [00:20<00:16, 26.96it/s] 55%|█████▌    | 540/981 [00:20<00:16, 27.11it/s] 55%|█████▌    | 543/981 [00:20<00:16, 27.00it/s] 56%|█████▌    | 546/981 [00:20<00:16, 27.04it/s] 56%|█████▌    | 549/981 [00:20<00:15, 27.16it/s] 56%|█████▋    | 552/981 [00:20<00:15, 27.28it/s] 57%|█████▋    | 555/981 [00:20<00:15, 27.40it/s] 57%|█████▋    | 558/981 [00:21<00:15, 27.42it/s] 57%|█████▋    | 561/981 [00:21<00:15, 27.50it/s] 57%|█████▋    | 564/981 [00:21<00:15, 27.54it/s] 58%|█████▊    | 567/981 [00:21<00:15, 27.47it/s] 58%|█████▊    | 570/981 [00:21<00:14, 27.47it/s] 58%|█████▊    | 573/981 [00:21<00:14, 27.48it/s] 59%|█████▊    | 576/981 [00:21<00:14, 27.53it/s] 59%|█████▉    | 579/981 [00:21<00:14, 27.55it/s] 59%|█████▉    | 582/981 [00:21<00:14, 27.56it/s] 60%|█████▉    | 585/981 [00:22<00:14, 27.55it/s] 60%|█████▉    | 588/981 [00:22<00:14, 27.61it/s] 60%|██████    | 591/981 [00:22<00:14, 27.42it/s] 61%|██████    | 594/981 [00:22<00:14, 27.51it/s] 61%|██████    | 597/981 [00:22<00:14, 27.37it/s] 61%|██████    | 600/981 [00:22<00:13, 27.41it/s] 61%|██████▏   | 603/981 [00:22<00:13, 27.52it/s] 62%|██████▏   | 606/981 [00:22<00:13, 27.55it/s] 62%|██████▏   | 609/981 [00:22<00:13, 27.67it/s] 62%|██████▏   | 612/981 [00:23<00:13, 27.62it/s] 63%|██████▎   | 615/981 [00:23<00:13, 27.53it/s] 63%|██████▎   | 618/981 [00:23<00:13, 27.61it/s] 63%|██████▎   | 621/981 [00:23<00:13, 27.69it/s] 64%|██████▎   | 624/981 [00:23<00:12, 27.72it/s] 64%|██████▍   | 627/981 [00:23<00:12, 27.66it/s] 64%|██████▍   | 630/981 [00:23<00:12, 27.69it/s] 65%|██████▍   | 633/981 [00:23<00:12, 27.69it/s] 65%|██████▍   | 636/981 [00:23<00:12, 27.36it/s] 65%|██████▌   | 639/981 [00:24<00:12, 27.49it/s] 65%|██████▌   | 642/981 [00:24<00:12, 27.33it/s] 66%|██████▌   | 645/981 [00:24<00:12, 27.22it/s] 66%|██████▌   | 648/981 [00:24<00:12, 27.38it/s] 66%|██████▋   | 651/981 [00:24<00:12, 27.37it/s] 67%|██████▋   | 654/981 [00:24<00:11, 27.34it/s] 67%|██████▋   | 657/981 [00:24<00:11, 27.48it/s] 67%|██████▋   | 660/981 [00:24<00:11, 27.50it/s] 68%|██████▊   | 663/981 [00:24<00:11, 27.58it/s] 68%|██████▊   | 666/981 [00:25<00:11, 27.45it/s] 68%|██████▊   | 669/981 [00:25<00:11, 27.48it/s] 69%|██████▊   | 672/981 [00:25<00:11, 27.53it/s] 69%|██████▉   | 675/981 [00:25<00:11, 27.58it/s] 69%|██████▉   | 678/981 [00:25<00:10, 27.58it/s] 69%|██████▉   | 681/981 [00:25<00:10, 27.59it/s] 70%|██████▉   | 684/981 [00:25<00:10, 27.58it/s] 70%|███████   | 687/981 [00:25<00:10, 27.60it/s] 70%|███████   | 690/981 [00:25<00:10, 27.49it/s] 71%|███████   | 693/981 [00:25<00:10, 27.61it/s] 71%|███████   | 696/981 [00:26<00:10, 27.63it/s] 71%|███████▏  | 699/981 [00:26<00:10, 27.69it/s] 72%|███████▏  | 702/981 [00:26<00:10, 27.70it/s] 72%|███████▏  | 705/981 [00:26<00:09, 27.76it/s] 72%|███████▏  | 708/981 [00:26<00:09, 27.73it/s] 72%|███████▏  | 711/981 [00:26<00:09, 27.63it/s] 73%|███████▎  | 714/981 [00:26<00:09, 27.67it/s] 73%|███████▎  | 717/981 [00:26<00:09, 27.65it/s] 73%|███████▎  | 720/981 [00:26<00:09, 27.66it/s] 74%|███████▎  | 723/981 [00:27<00:09, 27.68it/s] 74%|███████▍  | 726/981 [00:27<00:09, 27.55it/s] 74%|███████▍  | 729/981 [00:27<00:09, 27.58it/s] 75%|███████▍  | 732/981 [00:27<00:09, 27.57it/s] 75%|███████▍  | 735/981 [00:27<00:08, 27.58it/s] 75%|███████▌  | 738/981 [00:27<00:08, 27.52it/s] 76%|███████▌  | 741/981 [00:27<00:08, 27.54it/s] 76%|███████▌  | 744/981 [00:27<00:08, 27.54it/s] 76%|███████▌  | 747/981 [00:27<00:08, 27.48it/s] 76%|███████▋  | 750/981 [00:28<00:08, 27.29it/s] 77%|███████▋  | 753/981 [00:28<00:08, 27.34it/s] 77%|███████▋  | 756/981 [00:28<00:08, 27.36it/s] 77%|███████▋  | 759/981 [00:28<00:08, 27.38it/s] 78%|███████▊  | 762/981 [00:28<00:08, 27.37it/s] 78%|███████▊  | 765/981 [00:28<00:07, 27.25it/s] 78%|███████▊  | 768/981 [00:28<00:07, 27.14it/s] 79%|███████▊  | 771/981 [00:28<00:07, 27.21it/s] 79%|███████▉  | 774/981 [00:28<00:07, 27.26it/s] 79%|███████▉  | 777/981 [00:29<00:07, 27.28it/s] 80%|███████▉  | 780/981 [00:29<00:07, 27.30it/s] 80%|███████▉  | 783/981 [00:29<00:07, 27.57it/s] 80%|████████  | 786/981 [00:29<00:06, 27.93it/s] 80%|████████  | 789/981 [00:29<00:06, 28.40it/s] 81%|████████  | 793/981 [00:29<00:06, 29.01it/s] 81%|████████  | 797/981 [00:29<00:06, 29.73it/s] 82%|████████▏ | 801/981 [00:29<00:05, 30.26it/s] 82%|████████▏ | 805/981 [00:29<00:05, 30.59it/s] 82%|████████▏ | 809/981 [00:30<00:05, 30.89it/s] 83%|████████▎ | 813/981 [00:30<00:05, 31.07it/s] 83%|████████▎ | 817/981 [00:30<00:05, 31.24it/s] 84%|████████▎ | 821/981 [00:30<00:05, 31.38it/s] 84%|████████▍ | 825/981 [00:30<00:04, 31.43it/s] 85%|████████▍ | 829/981 [00:30<00:04, 31.50it/s] 85%|████████▍ | 833/981 [00:30<00:04, 31.57it/s] 85%|████████▌ | 837/981 [00:30<00:04, 31.58it/s] 86%|████████▌ | 841/981 [00:31<00:04, 31.61it/s] 86%|████████▌ | 845/981 [00:31<00:04, 31.62it/s] 87%|████████▋ | 849/981 [00:31<00:04, 31.72it/s] 87%|████████▋ | 853/981 [00:31<00:04, 31.74it/s] 87%|████████▋ | 857/981 [00:31<00:03, 31.63it/s] 88%|████████▊ | 861/981 [00:31<00:03, 31.70it/s] 88%|████████▊ | 865/981 [00:31<00:03, 31.66it/s] 89%|████████▊ | 869/981 [00:32<00:03, 31.70it/s] 89%|████████▉ | 873/981 [00:32<00:03, 31.63it/s] 89%|████████▉ | 877/981 [00:32<00:03, 31.73it/s] 90%|████████▉ | 881/981 [00:32<00:03, 31.57it/s] 90%|█████████ | 885/981 [00:32<00:03, 31.65it/s] 91%|█████████ | 889/981 [00:32<00:02, 31.60it/s] 91%|█████████ | 893/981 [00:32<00:02, 31.67it/s] 91%|█████████▏| 897/981 [00:32<00:02, 31.74it/s] 92%|█████████▏| 901/981 [00:33<00:02, 31.55it/s] 92%|█████████▏| 905/981 [00:33<00:02, 31.70it/s] 93%|█████████▎| 909/981 [00:33<00:02, 31.82it/s] 93%|█████████▎| 913/981 [00:33<00:02, 31.82it/s] 93%|█████████▎| 917/981 [00:33<00:02, 31.88it/s] 94%|█████████▍| 921/981 [00:33<00:01, 31.85it/s] 94%|█████████▍| 925/981 [00:33<00:01, 31.93it/s] 95%|█████████▍| 929/981 [00:33<00:01, 31.94it/s] 95%|█████████▌| 933/981 [00:34<00:01, 31.91it/s] 96%|█████████▌| 937/981 [00:34<00:01, 31.89it/s] 96%|█████████▌| 941/981 [00:34<00:01, 31.90it/s] 96%|█████████▋| 945/981 [00:34<00:01, 31.92it/s] 97%|█████████▋| 949/981 [00:34<00:01, 31.96it/s] 97%|█████████▋| 953/981 [00:34<00:00, 31.91it/s] 98%|█████████▊| 957/981 [00:34<00:00, 31.93it/s] 98%|█████████▊| 961/981 [00:34<00:00, 31.91it/s] 98%|█████████▊| 965/981 [00:35<00:00, 31.90it/s] 99%|█████████▉| 969/981 [00:35<00:00, 31.94it/s] 99%|█████████▉| 973/981 [00:35<00:00, 31.95it/s]100%|█████████▉| 977/981 [00:35<00:00, 31.92it/s]100%|██████████| 981/981 [00:35<00:00, 31.87it/s]100%|██████████| 981/981 [00:35<00:00, 27.62it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_LDAM_RS_DRW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.023, valid loss : 0.032, train f1 : 0.848, valid f1 : 0.534
training process - Deferred Re-weighting:   2%|▏         | 1/50 [03:31<2:52:57, 211.79s/it]Best score increase :0.000 -> 0.534
training process - Deferred Re-weighting:   4%|▍         | 2/50 [06:21<2:29:43, 187.16s/it]Best score increase :0.534 -> 0.647
training process - Deferred Re-weighting:   6%|▌         | 3/50 [09:13<2:21:05, 180.11s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 4/50 [12:03<2:15:07, 176.26s/it]Best score increase :0.647 -> 0.718
epoch : 5, train loss : 0.010, valid loss : 0.010, train f1 : 0.936, valid f1 : 0.672
training process - Deferred Re-weighting:  10%|█         | 5/50 [15:32<2:20:50, 187.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [18:21<2:13:08, 181.57s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 7/50 [21:13<2:07:53, 178.45s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 8/50 [24:04<2:03:14, 176.05s/it]EarlyStopping counter : 4 out of 12
epoch : 9, train loss : 0.009, valid loss : 0.012, train f1 : 0.944, valid f1 : 0.619
training process - Deferred Re-weighting:  18%|█▊        | 9/50 [27:34<2:07:33, 186.66s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 10/50 [30:23<2:00:45, 181.14s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 11/50 [33:13<1:55:33, 177.77s/it]Best score increase :0.718 -> 0.733
training process - Deferred Re-weighting:  24%|██▍       | 12/50 [36:03<1:51:10, 175.55s/it]EarlyStopping counter : 1 out of 12
epoch : 13, train loss : 0.007, valid loss : 0.007, train f1 : 0.948, valid f1 : 0.676
training process - Deferred Re-weighting:  26%|██▌       | 13/50 [39:34<1:54:45, 186.10s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [42:25<1:48:56, 181.58s/it]Best score increase :0.733 -> 0.862
training process - Deferred Re-weighting:  30%|███       | 15/50 [45:17<1:44:14, 178.71s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  32%|███▏      | 16/50 [48:07<1:39:50, 176.19s/it]EarlyStopping counter : 2 out of 12
epoch : 17, train loss : 0.007, valid loss : 0.010, train f1 : 0.954, valid f1 : 0.626
training process - Deferred Re-weighting:  34%|███▍      | 17/50 [51:38<1:42:37, 186.59s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [54:31<1:37:17, 182.43s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  38%|███▊      | 19/50 [57:23<1:32:38, 179.30s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  40%|████      | 20/50 [1:00:13<1:28:20, 176.70s/it]EarlyStopping counter : 6 out of 12
epoch : 21, train loss : 0.007, valid loss : 0.013, train f1 : 0.955, valid f1 : 0.670
training process - Deferred Re-weighting:  42%|████▏     | 21/50 [1:03:41<1:29:53, 186.00s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  44%|████▍     | 22/50 [1:06:30<1:24:27, 180.99s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  46%|████▌     | 23/50 [1:09:20<1:19:55, 177.60s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  48%|████▊     | 24/50 [1:12:10<1:15:54, 175.19s/it]EarlyStopping counter : 10 out of 12
epoch : 25, train loss : 0.006, valid loss : 0.010, train f1 : 0.962, valid f1 : 0.652
training process - Deferred Re-weighting:  50%|█████     | 25/50 [1:15:38<1:17:11, 185.26s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  50%|█████     | 25/50 [1:18:28<1:18:28, 188.33s/it]
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 25, best f1 score : 0.862
training process finished, best loss : 0.004, best acc : 0.988, best f1 : 0.862, best epoch : 13

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.87      0.67        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.98      3883
   macro avg       0.77      0.93      0.83      3883
weighted avg       0.99      0.98      0.99      3883


# test acc : 0.98, test f1 : 0.83, test AUC : 0.93, test loss : 0.095

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:38, 25.31it/s]  1%|          | 6/981 [00:00<00:37, 26.24it/s]  1%|          | 9/981 [00:00<00:36, 26.46it/s]  1%|          | 12/981 [00:00<00:36, 26.52it/s]  2%|▏         | 15/981 [00:00<00:36, 26.58it/s]  2%|▏         | 18/981 [00:00<00:36, 26.64it/s]  2%|▏         | 21/981 [00:00<00:35, 26.75it/s]  2%|▏         | 24/981 [00:00<00:35, 26.78it/s]  3%|▎         | 27/981 [00:01<00:35, 26.84it/s]  3%|▎         | 30/981 [00:01<00:35, 26.63it/s]  3%|▎         | 33/981 [00:01<00:35, 26.76it/s]  4%|▎         | 36/981 [00:01<00:35, 26.79it/s]  4%|▍         | 39/981 [00:01<00:35, 26.60it/s]  4%|▍         | 42/981 [00:01<00:35, 26.65it/s]  5%|▍         | 45/981 [00:01<00:35, 26.74it/s]  5%|▍         | 48/981 [00:01<00:35, 26.58it/s]  5%|▌         | 51/981 [00:01<00:35, 26.54it/s]  6%|▌         | 54/981 [00:02<00:34, 26.71it/s]  6%|▌         | 57/981 [00:02<00:34, 26.79it/s]  6%|▌         | 60/981 [00:02<00:34, 26.83it/s]  6%|▋         | 63/981 [00:02<00:34, 26.89it/s]  7%|▋         | 66/981 [00:02<00:34, 26.91it/s]  7%|▋         | 69/981 [00:02<00:33, 26.91it/s]  7%|▋         | 72/981 [00:02<00:33, 26.98it/s]  8%|▊         | 75/981 [00:02<00:33, 26.95it/s]  8%|▊         | 78/981 [00:02<00:33, 26.93it/s]  8%|▊         | 81/981 [00:03<00:33, 26.84it/s]  9%|▊         | 84/981 [00:03<00:33, 26.86it/s]  9%|▉         | 87/981 [00:03<00:33, 26.88it/s]  9%|▉         | 90/981 [00:03<00:33, 26.88it/s]  9%|▉         | 93/981 [00:03<00:33, 26.70it/s] 10%|▉         | 96/981 [00:03<00:33, 26.68it/s] 10%|█         | 99/981 [00:03<00:33, 26.52it/s] 10%|█         | 102/981 [00:03<00:33, 26.60it/s] 11%|█         | 105/981 [00:03<00:33, 26.54it/s] 11%|█         | 108/981 [00:04<00:33, 26.45it/s] 11%|█▏        | 111/981 [00:04<00:32, 26.51it/s] 12%|█▏        | 114/981 [00:04<00:32, 26.52it/s] 12%|█▏        | 117/981 [00:04<00:32, 26.52it/s] 12%|█▏        | 120/981 [00:04<00:32, 26.36it/s] 13%|█▎        | 123/981 [00:04<00:32, 26.35it/s] 13%|█▎        | 126/981 [00:04<00:32, 26.43it/s] 13%|█▎        | 129/981 [00:04<00:32, 26.40it/s] 13%|█▎        | 132/981 [00:04<00:32, 26.39it/s] 14%|█▍        | 135/981 [00:05<00:31, 26.51it/s] 14%|█▍        | 138/981 [00:05<00:31, 26.56it/s] 14%|█▍        | 141/981 [00:05<00:31, 26.59it/s] 15%|█▍        | 144/981 [00:05<00:31, 26.62it/s] 15%|█▍        | 147/981 [00:05<00:31, 26.45it/s] 15%|█▌        | 150/981 [00:05<00:31, 26.36it/s] 16%|█▌        | 153/981 [00:05<00:31, 26.55it/s] 16%|█▌        | 156/981 [00:05<00:30, 26.62it/s] 16%|█▌        | 159/981 [00:05<00:30, 26.69it/s] 17%|█▋        | 162/981 [00:06<00:30, 26.72it/s] 17%|█▋        | 165/981 [00:06<00:30, 26.76it/s] 17%|█▋        | 168/981 [00:06<00:30, 26.65it/s] 17%|█▋        | 171/981 [00:06<00:30, 26.46it/s] 18%|█▊        | 174/981 [00:06<00:30, 26.48it/s] 18%|█▊        | 177/981 [00:06<00:30, 26.60it/s] 18%|█▊        | 180/981 [00:06<00:30, 26.63it/s] 19%|█▊        | 183/981 [00:06<00:30, 26.58it/s] 19%|█▉        | 186/981 [00:06<00:29, 26.74it/s] 19%|█▉        | 189/981 [00:07<00:29, 26.83it/s] 20%|█▉        | 192/981 [00:07<00:29, 26.80it/s] 20%|█▉        | 195/981 [00:07<00:29, 26.68it/s] 20%|██        | 198/981 [00:07<00:29, 26.73it/s] 20%|██        | 201/981 [00:07<00:29, 26.64it/s] 21%|██        | 204/981 [00:07<00:29, 26.52it/s] 21%|██        | 207/981 [00:07<00:29, 26.45it/s] 21%|██▏       | 210/981 [00:07<00:29, 26.36it/s] 22%|██▏       | 213/981 [00:08<00:29, 26.26it/s] 22%|██▏       | 216/981 [00:08<00:29, 26.21it/s] 22%|██▏       | 219/981 [00:08<00:29, 25.90it/s] 23%|██▎       | 222/981 [00:08<00:29, 25.95it/s] 23%|██▎       | 225/981 [00:08<00:29, 25.97it/s] 23%|██▎       | 228/981 [00:08<00:29, 25.87it/s] 24%|██▎       | 231/981 [00:08<00:28, 25.88it/s] 24%|██▍       | 234/981 [00:08<00:28, 25.91it/s] 24%|██▍       | 237/981 [00:08<00:28, 25.80it/s] 24%|██▍       | 240/981 [00:09<00:28, 25.94it/s] 25%|██▍       | 243/981 [00:09<00:28, 26.01it/s] 25%|██▌       | 246/981 [00:09<00:28, 26.10it/s] 25%|██▌       | 249/981 [00:09<00:27, 26.18it/s] 26%|██▌       | 252/981 [00:09<00:27, 26.08it/s] 26%|██▌       | 255/981 [00:09<00:28, 25.87it/s] 26%|██▋       | 258/981 [00:09<00:27, 25.89it/s] 27%|██▋       | 261/981 [00:09<00:27, 26.06it/s] 27%|██▋       | 264/981 [00:09<00:27, 25.88it/s] 27%|██▋       | 267/981 [00:10<00:27, 26.00it/s] 28%|██▊       | 270/981 [00:10<00:27, 26.11it/s] 28%|██▊       | 273/981 [00:10<00:27, 26.15it/s] 28%|██▊       | 276/981 [00:10<00:26, 26.17it/s] 28%|██▊       | 279/981 [00:10<00:27, 26.00it/s] 29%|██▊       | 282/981 [00:10<00:26, 26.09it/s] 29%|██▉       | 285/981 [00:10<00:26, 26.15it/s] 29%|██▉       | 288/981 [00:10<00:26, 26.24it/s] 30%|██▉       | 291/981 [00:10<00:26, 26.30it/s] 30%|██▉       | 294/981 [00:11<00:26, 26.29it/s] 30%|███       | 297/981 [00:11<00:26, 26.27it/s] 31%|███       | 300/981 [00:11<00:25, 26.27it/s] 31%|███       | 303/981 [00:11<00:25, 26.19it/s] 31%|███       | 306/981 [00:11<00:25, 26.13it/s] 31%|███▏      | 309/981 [00:11<00:25, 26.15it/s] 32%|███▏      | 312/981 [00:11<00:25, 26.23it/s] 32%|███▏      | 315/981 [00:11<00:25, 26.26it/s] 32%|███▏      | 318/981 [00:12<00:25, 26.25it/s] 33%|███▎      | 321/981 [00:12<00:25, 26.26it/s] 33%|███▎      | 324/981 [00:12<00:25, 26.23it/s] 33%|███▎      | 327/981 [00:12<00:24, 26.21it/s] 34%|███▎      | 330/981 [00:12<00:24, 26.23it/s] 34%|███▍      | 333/981 [00:12<00:24, 26.24it/s] 34%|███▍      | 336/981 [00:12<00:24, 26.24it/s] 35%|███▍      | 339/981 [00:12<00:24, 26.27it/s] 35%|███▍      | 342/981 [00:12<00:24, 26.14it/s] 35%|███▌      | 345/981 [00:13<00:24, 26.11it/s] 35%|███▌      | 348/981 [00:13<00:24, 26.17it/s] 36%|███▌      | 351/981 [00:13<00:24, 26.07it/s] 36%|███▌      | 354/981 [00:13<00:24, 25.86it/s] 36%|███▋      | 357/981 [00:13<00:24, 25.76it/s] 37%|███▋      | 360/981 [00:13<00:24, 25.71it/s] 37%|███▋      | 363/981 [00:13<00:24, 25.64it/s] 37%|███▋      | 366/981 [00:13<00:23, 25.81it/s] 38%|███▊      | 369/981 [00:13<00:23, 25.95it/s] 38%|███▊      | 372/981 [00:14<00:23, 26.02it/s] 38%|███▊      | 375/981 [00:14<00:23, 26.05it/s] 39%|███▊      | 378/981 [00:14<00:23, 25.94it/s] 39%|███▉      | 381/981 [00:14<00:23, 25.99it/s] 39%|███▉      | 384/981 [00:14<00:22, 25.97it/s] 39%|███▉      | 387/981 [00:14<00:22, 25.86it/s] 40%|███▉      | 390/981 [00:14<00:22, 25.96it/s] 40%|████      | 393/981 [00:14<00:22, 26.06it/s] 40%|████      | 396/981 [00:15<00:22, 26.13it/s] 41%|████      | 399/981 [00:15<00:22, 26.08it/s] 41%|████      | 402/981 [00:15<00:22, 26.16it/s] 41%|████▏     | 405/981 [00:15<00:22, 26.16it/s] 42%|████▏     | 408/981 [00:15<00:21, 26.17it/s] 42%|████▏     | 411/981 [00:15<00:21, 26.19it/s] 42%|████▏     | 414/981 [00:15<00:21, 26.29it/s] 43%|████▎     | 417/981 [00:15<00:21, 26.15it/s] 43%|████▎     | 420/981 [00:15<00:21, 26.17it/s] 43%|████▎     | 423/981 [00:16<00:21, 26.27it/s] 43%|████▎     | 426/981 [00:16<00:21, 26.26it/s] 44%|████▎     | 429/981 [00:16<00:21, 26.27it/s] 44%|████▍     | 432/981 [00:16<00:21, 26.10it/s] 44%|████▍     | 435/981 [00:16<00:20, 26.03it/s] 45%|████▍     | 438/981 [00:16<00:20, 26.13it/s] 45%|████▍     | 441/981 [00:16<00:20, 26.21it/s] 45%|████▌     | 444/981 [00:16<00:21, 25.26it/s] 46%|████▌     | 447/981 [00:17<00:22, 24.03it/s] 46%|████▌     | 450/981 [00:17<00:22, 23.22it/s] 46%|████▌     | 453/981 [00:17<00:23, 22.64it/s] 46%|████▋     | 456/981 [00:17<00:22, 23.19it/s] 47%|████▋     | 459/981 [00:17<00:21, 23.96it/s] 47%|████▋     | 462/981 [00:17<00:21, 24.50it/s] 47%|████▋     | 465/981 [00:17<00:20, 24.89it/s] 48%|████▊     | 468/981 [00:17<00:20, 25.12it/s] 48%|████▊     | 471/981 [00:18<00:20, 25.02it/s] 48%|████▊     | 474/981 [00:18<00:20, 25.21it/s] 49%|████▊     | 477/981 [00:18<00:19, 25.32it/s] 49%|████▉     | 480/981 [00:18<00:19, 25.42it/s] 49%|████▉     | 483/981 [00:18<00:19, 25.37it/s] 50%|████▉     | 486/981 [00:18<00:19, 25.40it/s] 50%|████▉     | 489/981 [00:18<00:19, 25.40it/s] 50%|█████     | 492/981 [00:18<00:19, 25.46it/s] 50%|█████     | 495/981 [00:18<00:19, 25.45it/s] 51%|█████     | 498/981 [00:19<00:18, 25.45it/s] 51%|█████     | 501/981 [00:19<00:18, 25.42it/s] 51%|█████▏    | 504/981 [00:19<00:18, 25.42it/s] 52%|█████▏    | 507/981 [00:19<00:18, 25.41it/s] 52%|█████▏    | 510/981 [00:19<00:18, 25.46it/s] 52%|█████▏    | 513/981 [00:19<00:18, 25.55it/s] 53%|█████▎    | 516/981 [00:19<00:18, 25.62it/s] 53%|█████▎    | 519/981 [00:19<00:18, 25.54it/s] 53%|█████▎    | 522/981 [00:19<00:17, 25.61it/s] 54%|█████▎    | 525/981 [00:20<00:17, 25.67it/s] 54%|█████▍    | 528/981 [00:20<00:17, 25.75it/s] 54%|█████▍    | 531/981 [00:20<00:17, 25.82it/s] 54%|█████▍    | 534/981 [00:20<00:17, 25.91it/s] 55%|█████▍    | 537/981 [00:20<00:17, 25.89it/s] 55%|█████▌    | 540/981 [00:20<00:17, 25.83it/s] 55%|█████▌    | 543/981 [00:20<00:16, 25.92it/s] 56%|█████▌    | 546/981 [00:20<00:16, 25.97it/s] 56%|█████▌    | 549/981 [00:21<00:16, 25.99it/s] 56%|█████▋    | 552/981 [00:21<00:16, 25.99it/s] 57%|█████▋    | 555/981 [00:21<00:16, 25.91it/s] 57%|█████▋    | 558/981 [00:21<00:16, 26.00it/s] 57%|█████▋    | 561/981 [00:21<00:16, 26.07it/s] 57%|█████▋    | 564/981 [00:21<00:15, 26.09it/s] 58%|█████▊    | 567/981 [00:21<00:15, 26.09it/s] 58%|█████▊    | 570/981 [00:21<00:15, 26.12it/s] 58%|█████▊    | 573/981 [00:21<00:15, 26.10it/s] 59%|█████▊    | 576/981 [00:22<00:15, 26.12it/s] 59%|█████▉    | 579/981 [00:22<00:15, 26.16it/s] 59%|█████▉    | 582/981 [00:22<00:15, 26.19it/s] 60%|█████▉    | 585/981 [00:22<00:15, 26.05it/s] 60%|█████▉    | 588/981 [00:22<00:15, 26.08it/s] 60%|██████    | 591/981 [00:22<00:14, 26.13it/s] 61%|██████    | 594/981 [00:22<00:14, 26.14it/s] 61%|██████    | 597/981 [00:22<00:14, 26.10it/s] 61%|██████    | 600/981 [00:22<00:14, 26.18it/s] 61%|██████▏   | 603/981 [00:23<00:14, 26.16it/s] 62%|██████▏   | 606/981 [00:23<00:14, 26.12it/s] 62%|██████▏   | 609/981 [00:23<00:14, 26.12it/s] 62%|██████▏   | 612/981 [00:23<00:14, 26.19it/s] 63%|██████▎   | 615/981 [00:23<00:13, 26.20it/s] 63%|██████▎   | 618/981 [00:23<00:13, 26.20it/s] 63%|██████▎   | 621/981 [00:23<00:13, 26.20it/s] 64%|██████▎   | 624/981 [00:23<00:13, 26.24it/s] 64%|██████▍   | 627/981 [00:24<00:13, 26.07it/s] 64%|██████▍   | 630/981 [00:24<00:13, 26.00it/s] 65%|██████▍   | 633/981 [00:24<00:13, 25.93it/s] 65%|██████▍   | 636/981 [00:24<00:13, 26.00it/s] 65%|██████▌   | 639/981 [00:24<00:13, 26.04it/s] 65%|██████▌   | 642/981 [00:24<00:13, 26.03it/s] 66%|██████▌   | 645/981 [00:24<00:12, 26.09it/s] 66%|██████▌   | 648/981 [00:24<00:12, 26.16it/s] 66%|██████▋   | 651/981 [00:24<00:12, 26.14it/s] 67%|██████▋   | 654/981 [00:25<00:12, 26.19it/s] 67%|██████▋   | 657/981 [00:25<00:12, 26.17it/s] 67%|██████▋   | 660/981 [00:25<00:12, 26.14it/s] 68%|██████▊   | 663/981 [00:25<00:12, 26.14it/s] 68%|██████▊   | 666/981 [00:25<00:12, 26.17it/s] 68%|██████▊   | 669/981 [00:25<00:11, 26.20it/s] 69%|██████▊   | 672/981 [00:25<00:11, 26.17it/s] 69%|██████▉   | 675/981 [00:25<00:11, 26.16it/s] 69%|██████▉   | 678/981 [00:25<00:11, 26.17it/s] 69%|██████▉   | 681/981 [00:26<00:11, 26.18it/s] 70%|██████▉   | 684/981 [00:26<00:11, 26.14it/s] 70%|███████   | 687/981 [00:26<00:11, 26.14it/s] 70%|███████   | 690/981 [00:26<00:11, 26.17it/s] 71%|███████   | 693/981 [00:26<00:11, 26.15it/s] 71%|███████   | 696/981 [00:26<00:10, 26.03it/s] 71%|███████▏  | 699/981 [00:26<00:10, 25.92it/s] 72%|███████▏  | 702/981 [00:26<00:10, 26.21it/s] 72%|███████▏  | 705/981 [00:27<00:10, 26.15it/s] 72%|███████▏  | 708/981 [00:27<00:10, 26.25it/s] 72%|███████▏  | 711/981 [00:27<00:10, 26.33it/s] 73%|███████▎  | 714/981 [00:27<00:10, 25.55it/s] 73%|███████▎  | 717/981 [00:27<00:10, 25.80it/s] 73%|███████▎  | 720/981 [00:27<00:10, 25.63it/s] 74%|███████▎  | 723/981 [00:27<00:10, 25.74it/s] 74%|███████▍  | 726/981 [00:27<00:09, 25.99it/s] 74%|███████▍  | 729/981 [00:27<00:09, 26.00it/s] 75%|███████▍  | 732/981 [00:28<00:09, 26.10it/s] 75%|███████▍  | 735/981 [00:28<00:09, 26.02it/s] 75%|███████▌  | 738/981 [00:28<00:09, 24.69it/s] 76%|███████▌  | 741/981 [00:28<00:09, 25.45it/s] 76%|███████▌  | 744/981 [00:28<00:09, 25.90it/s] 76%|███████▌  | 747/981 [00:28<00:09, 25.91it/s] 76%|███████▋  | 750/981 [00:28<00:08, 25.81it/s] 77%|███████▋  | 753/981 [00:28<00:08, 25.51it/s] 77%|███████▋  | 756/981 [00:28<00:08, 25.81it/s] 77%|███████▋  | 759/981 [00:29<00:08, 26.10it/s] 78%|███████▊  | 762/981 [00:29<00:08, 26.30it/s] 78%|███████▊  | 765/981 [00:29<00:08, 26.42it/s] 78%|███████▊  | 768/981 [00:29<00:08, 26.55it/s] 79%|███████▊  | 771/981 [00:29<00:07, 26.54it/s] 79%|███████▉  | 774/981 [00:29<00:07, 26.75it/s] 79%|███████▉  | 777/981 [00:29<00:07, 26.71it/s] 80%|███████▉  | 780/981 [00:29<00:07, 26.99it/s] 80%|███████▉  | 783/981 [00:29<00:07, 27.34it/s] 80%|████████  | 786/981 [00:30<00:07, 27.47it/s] 80%|████████  | 789/981 [00:30<00:06, 27.73it/s] 81%|████████  | 792/981 [00:30<00:06, 28.34it/s] 81%|████████  | 796/981 [00:30<00:06, 29.21it/s] 82%|████████▏ | 800/981 [00:30<00:06, 29.72it/s] 82%|████████▏ | 804/981 [00:30<00:05, 29.86it/s] 82%|████████▏ | 808/981 [00:30<00:05, 30.26it/s] 83%|████████▎ | 812/981 [00:30<00:05, 30.52it/s] 83%|████████▎ | 816/981 [00:31<00:05, 30.73it/s] 84%|████████▎ | 820/981 [00:31<00:05, 30.92it/s] 84%|████████▍ | 824/981 [00:31<00:05, 31.08it/s] 84%|████████▍ | 828/981 [00:31<00:04, 31.25it/s] 85%|████████▍ | 832/981 [00:31<00:04, 31.21it/s] 85%|████████▌ | 836/981 [00:31<00:04, 31.20it/s] 86%|████████▌ | 840/981 [00:31<00:04, 31.16it/s] 86%|████████▌ | 844/981 [00:31<00:04, 31.15it/s] 86%|████████▋ | 848/981 [00:32<00:04, 31.10it/s] 87%|████████▋ | 852/981 [00:32<00:04, 31.17it/s] 87%|████████▋ | 856/981 [00:32<00:04, 31.21it/s] 88%|████████▊ | 860/981 [00:32<00:03, 31.32it/s] 88%|████████▊ | 864/981 [00:32<00:03, 31.30it/s] 88%|████████▊ | 868/981 [00:32<00:03, 31.41it/s] 89%|████████▉ | 872/981 [00:32<00:03, 31.48it/s] 89%|████████▉ | 876/981 [00:32<00:03, 31.46it/s] 90%|████████▉ | 880/981 [00:33<00:03, 31.41it/s] 90%|█████████ | 884/981 [00:33<00:03, 31.44it/s] 91%|█████████ | 888/981 [00:33<00:02, 31.44it/s] 91%|█████████ | 892/981 [00:33<00:02, 31.46it/s] 91%|█████████▏| 896/981 [00:33<00:02, 31.50it/s] 92%|█████████▏| 900/981 [00:33<00:02, 31.56it/s] 92%|█████████▏| 904/981 [00:33<00:02, 31.56it/s] 93%|█████████▎| 908/981 [00:34<00:02, 31.60it/s] 93%|█████████▎| 912/981 [00:34<00:02, 31.55it/s] 93%|█████████▎| 916/981 [00:34<00:02, 31.61it/s] 94%|█████████▍| 920/981 [00:34<00:01, 31.57it/s] 94%|█████████▍| 924/981 [00:34<00:01, 31.54it/s] 95%|█████████▍| 928/981 [00:34<00:01, 31.58it/s] 95%|█████████▌| 932/981 [00:34<00:01, 31.62it/s] 95%|█████████▌| 936/981 [00:34<00:01, 31.56it/s] 96%|█████████▌| 940/981 [00:35<00:01, 31.56it/s] 96%|█████████▌| 944/981 [00:35<00:01, 31.54it/s] 97%|█████████▋| 948/981 [00:35<00:01, 31.59it/s] 97%|█████████▋| 952/981 [00:35<00:00, 31.63it/s] 97%|█████████▋| 956/981 [00:35<00:00, 31.61it/s] 98%|█████████▊| 960/981 [00:35<00:00, 31.59it/s] 98%|█████████▊| 964/981 [00:35<00:00, 31.49it/s] 99%|█████████▊| 968/981 [00:35<00:00, 31.49it/s] 99%|█████████▉| 972/981 [00:36<00:00, 31.44it/s] 99%|█████████▉| 976/981 [00:36<00:00, 31.42it/s]100%|█████████▉| 980/981 [00:36<00:00, 31.34it/s]100%|██████████| 981/981 [00:36<00:00, 27.00it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
