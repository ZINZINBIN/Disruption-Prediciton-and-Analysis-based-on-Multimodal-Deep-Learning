/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.011, valid loss : 0.011, train acc : 0.983, valid acc : 0.982, train f1 : 0.504, valid f1 : 0.495
training process:   2%|▏         | 1/50 [17:05<13:57:42, 1025.77s/it]training process:   4%|▍         | 2/50 [34:01<13:35:47, 1019.75s/it]training process:   6%|▌         | 3/50 [51:54<13:37:57, 1044.21s/it]training process:   8%|▊         | 4/50 [1:10:22<13:39:49, 1069.34s/it]epoch : 5, train loss : 0.008, valid loss : 0.009, train acc : 0.987, valid acc : 0.987, train f1 : 0.718, valid f1 : 0.713
training process:  10%|█         | 5/50 [1:26:25<12:53:08, 1030.86s/it]training process:  12%|█▏        | 6/50 [1:43:11<12:29:45, 1022.40s/it]training process:  14%|█▍        | 7/50 [2:00:15<12:13:12, 1023.09s/it]training process:  16%|█▌        | 8/50 [2:17:52<12:03:47, 1033.98s/it]epoch : 9, train loss : 0.007, valid loss : 0.008, train acc : 0.988, valid acc : 0.984, train f1 : 0.764, valid f1 : 0.773
training process:  18%|█▊        | 9/50 [2:34:26<11:38:00, 1021.48s/it]training process:  20%|██        | 10/50 [2:51:08<11:16:48, 1015.22s/it]training process:  22%|██▏       | 11/50 [3:01:54<9:46:30, 902.32s/it]  training process:  24%|██▍       | 12/50 [3:09:56<8:10:25, 774.36s/it]epoch : 13, train loss : 0.007, valid loss : 0.008, train acc : 0.989, valid acc : 0.987, train f1 : 0.780, valid f1 : 0.784
training process:  26%|██▌       | 13/50 [3:17:51<7:01:37, 683.72s/it]training process:  28%|██▊       | 14/50 [3:25:44<6:12:07, 620.22s/it]training process:  30%|███       | 15/50 [3:33:37<5:35:55, 575.86s/it]training process:  32%|███▏      | 16/50 [3:41:33<5:09:16, 545.78s/it]epoch : 17, train loss : 0.007, valid loss : 0.007, train acc : 0.989, valid acc : 0.989, train f1 : 0.792, valid f1 : 0.820
training process:  34%|███▍      | 17/50 [3:49:21<4:47:18, 522.36s/it]training process:  36%|███▌      | 18/50 [3:57:09<4:29:54, 506.07s/it]training process:  38%|███▊      | 19/50 [4:04:57<4:15:27, 494.44s/it]training process:  40%|████      | 20/50 [4:12:45<4:03:21, 486.70s/it]epoch : 21, train loss : 0.007, valid loss : 0.007, train acc : 0.989, valid acc : 0.989, train f1 : 0.790, valid f1 : 0.795
training process:  42%|████▏     | 21/50 [4:20:16<3:50:02, 475.94s/it]training process:  44%|████▍     | 22/50 [4:27:47<3:38:33, 468.35s/it]training process:  46%|████▌     | 23/50 [4:35:20<3:28:38, 463.67s/it]training process:  48%|████▊     | 24/50 [4:42:50<3:19:09, 459.61s/it]epoch : 25, train loss : 0.007, valid loss : 0.007, train acc : 0.989, valid acc : 0.990, train f1 : 0.792, valid f1 : 0.811
training process:  50%|█████     | 25/50 [4:50:42<3:13:05, 463.42s/it]training process:  52%|█████▏    | 26/50 [4:58:34<3:06:25, 466.07s/it]training process:  54%|█████▍    | 27/50 [5:06:27<2:59:22, 467.93s/it]training process:  56%|█████▌    | 28/50 [5:14:14<2:51:29, 467.70s/it]epoch : 29, train loss : 0.007, valid loss : 0.006, train acc : 0.990, valid acc : 0.991, train f1 : 0.795, valid f1 : 0.827
training process:  58%|█████▊    | 29/50 [5:21:46<2:42:05, 463.14s/it]training process:  60%|██████    | 30/50 [5:29:17<2:33:08, 459.45s/it]training process:  62%|██████▏   | 31/50 [5:36:46<2:24:31, 456.41s/it]training process:  64%|██████▍   | 32/50 [5:44:16<2:16:19, 454.39s/it]epoch : 33, train loss : 0.006, valid loss : 0.006, train acc : 0.990, valid acc : 0.990, train f1 : 0.804, valid f1 : 0.811
training process:  66%|██████▌   | 33/50 [5:52:01<2:09:39, 457.64s/it]training process:  68%|██████▊   | 34/50 [5:59:51<2:03:00, 461.31s/it]training process:  70%|███████   | 35/50 [6:07:42<1:56:02, 464.17s/it]training process:  72%|███████▏  | 36/50 [6:15:29<1:48:31, 465.09s/it]epoch : 37, train loss : 0.006, valid loss : 0.006, train acc : 0.991, valid acc : 0.990, train f1 : 0.820, valid f1 : 0.823
training process:  74%|███████▍  | 37/50 [6:23:00<1:39:50, 460.80s/it]training process:  76%|███████▌  | 38/50 [6:30:29<1:31:26, 457.21s/it]training process:  78%|███████▊  | 39/50 [6:38:00<1:23:28, 455.34s/it]training process:  80%|████████  | 40/50 [6:45:28<1:15:33, 453.31s/it]epoch : 41, train loss : 0.005, valid loss : 0.005, train acc : 0.991, valid acc : 0.992, train f1 : 0.826, valid f1 : 0.857
training process:  82%|████████▏ | 41/50 [6:53:19<1:08:47, 458.64s/it]training process:  84%|████████▍ | 42/50 [7:01:12<1:01:43, 462.91s/it]training process:  86%|████████▌ | 43/50 [7:09:04<54:19, 465.63s/it]  training process:  88%|████████▊ | 44/50 [7:16:54<46:41, 466.91s/it]epoch : 45, train loss : 0.005, valid loss : 0.006, train acc : 0.990, valid acc : 0.992, train f1 : 0.829, valid f1 : 0.861
training process:  90%|█████████ | 45/50 [7:24:21<38:24, 460.81s/it]training process:  92%|█████████▏| 46/50 [7:31:50<30:29, 457.33s/it]training process:  94%|█████████▍| 47/50 [7:39:16<22:42, 454.03s/it]training process:  96%|█████████▌| 48/50 [7:46:46<15:05, 452.72s/it]epoch : 49, train loss : 0.004, valid loss : 0.005, train acc : 0.992, valid acc : 0.991, train f1 : 0.865, valid f1 : 0.842
training process:  98%|█████████▊| 49/50 [7:54:33<07:37, 457.08s/it]training process: 100%|██████████| 50/50 [8:02:17<00:00, 459.21s/it]training process: 100%|██████████| 50/50 [8:02:17<00:00, 578.76s/it]
training process finished, best loss : 0.005 and best acc : 0.992, best f1 : 0.876, best epoch : 42

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.61      0.63        71
           1       0.99      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.82      0.80      0.81      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.81, test AUC : 0.80, test loss : 0.056

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:46, 21.12it/s]  1%|          | 6/981 [00:00<00:45, 21.33it/s]  1%|          | 9/981 [00:00<00:45, 21.32it/s]  1%|          | 12/981 [00:00<00:45, 21.19it/s]  2%|▏         | 15/981 [00:00<00:45, 21.35it/s]  2%|▏         | 18/981 [00:00<00:45, 21.26it/s]  2%|▏         | 21/981 [00:00<00:45, 21.12it/s]  2%|▏         | 24/981 [00:01<00:45, 21.18it/s]  3%|▎         | 27/981 [00:01<00:45, 20.96it/s]  3%|▎         | 30/981 [00:01<00:45, 20.91it/s]  3%|▎         | 33/981 [00:01<00:45, 20.86it/s]  4%|▎         | 36/981 [00:01<00:45, 20.79it/s]  4%|▍         | 39/981 [00:01<00:44, 20.95it/s]  4%|▍         | 42/981 [00:01<00:44, 20.87it/s]  5%|▍         | 45/981 [00:02<00:44, 20.82it/s]  5%|▍         | 48/981 [00:02<00:44, 20.98it/s]  5%|▌         | 51/981 [00:02<00:44, 20.95it/s]  6%|▌         | 54/981 [00:02<00:44, 21.00it/s]  6%|▌         | 57/981 [00:02<00:43, 21.09it/s]  6%|▌         | 60/981 [00:02<00:43, 21.03it/s]  6%|▋         | 63/981 [00:02<00:43, 21.33it/s]  7%|▋         | 66/981 [00:03<00:43, 21.14it/s]  7%|▋         | 69/981 [00:03<00:43, 21.08it/s]  7%|▋         | 72/981 [00:03<00:42, 21.22it/s]  8%|▊         | 75/981 [00:03<00:42, 21.08it/s]  8%|▊         | 78/981 [00:03<00:42, 21.26it/s]  8%|▊         | 81/981 [00:03<00:42, 21.27it/s]  9%|▊         | 84/981 [00:03<00:42, 21.14it/s]  9%|▉         | 87/981 [00:04<00:42, 21.25it/s]  9%|▉         | 90/981 [00:04<00:42, 21.05it/s]  9%|▉         | 93/981 [00:04<00:42, 21.06it/s] 10%|▉         | 96/981 [00:04<00:42, 21.02it/s] 10%|█         | 99/981 [00:04<00:42, 20.90it/s] 10%|█         | 102/981 [00:04<00:41, 21.00it/s] 11%|█         | 105/981 [00:04<00:41, 21.00it/s] 11%|█         | 108/981 [00:05<00:41, 20.98it/s] 11%|█▏        | 111/981 [00:05<00:42, 20.69it/s] 12%|█▏        | 114/981 [00:05<00:42, 20.26it/s] 12%|█▏        | 117/981 [00:05<00:41, 20.65it/s] 12%|█▏        | 120/981 [00:05<00:41, 20.75it/s] 13%|█▎        | 123/981 [00:05<00:41, 20.80it/s] 13%|█▎        | 126/981 [00:05<00:40, 20.90it/s] 13%|█▎        | 129/981 [00:06<00:40, 20.85it/s] 13%|█▎        | 132/981 [00:06<00:40, 21.02it/s] 14%|█▍        | 135/981 [00:06<00:40, 20.97it/s] 14%|█▍        | 138/981 [00:06<00:40, 20.90it/s] 14%|█▍        | 141/981 [00:06<00:39, 21.03it/s] 15%|█▍        | 144/981 [00:06<00:40, 20.85it/s] 15%|█▍        | 147/981 [00:06<00:39, 21.08it/s] 15%|█▌        | 150/981 [00:07<00:39, 21.08it/s] 16%|█▌        | 153/981 [00:07<00:39, 20.93it/s] 16%|█▌        | 156/981 [00:07<00:39, 21.11it/s] 16%|█▌        | 159/981 [00:07<00:39, 21.06it/s] 17%|█▋        | 162/981 [00:07<00:39, 20.98it/s] 17%|█▋        | 165/981 [00:07<00:38, 21.22it/s] 17%|█▋        | 168/981 [00:07<00:38, 21.17it/s] 17%|█▋        | 171/981 [00:08<00:38, 21.17it/s] 18%|█▊        | 174/981 [00:08<00:38, 21.20it/s] 18%|█▊        | 177/981 [00:08<00:38, 21.04it/s] 18%|█▊        | 180/981 [00:08<00:37, 21.13it/s] 19%|█▊        | 183/981 [00:08<00:37, 21.01it/s] 19%|█▉        | 186/981 [00:08<00:37, 20.99it/s] 19%|█▉        | 189/981 [00:08<00:37, 21.11it/s] 20%|█▉        | 192/981 [00:09<00:37, 20.99it/s] 20%|█▉        | 195/981 [00:09<00:37, 20.91it/s] 20%|██        | 198/981 [00:09<00:37, 21.15it/s] 20%|██        | 201/981 [00:09<00:37, 20.97it/s] 21%|██        | 204/981 [00:09<00:36, 21.19it/s] 21%|██        | 207/981 [00:09<00:36, 21.20it/s] 21%|██▏       | 210/981 [00:09<00:36, 21.09it/s] 22%|██▏       | 213/981 [00:10<00:36, 21.15it/s] 22%|██▏       | 216/981 [00:10<00:36, 20.99it/s] 22%|██▏       | 219/981 [00:10<00:36, 20.87it/s] 23%|██▎       | 222/981 [00:10<00:36, 20.87it/s] 23%|██▎       | 225/981 [00:10<00:36, 20.84it/s] 23%|██▎       | 228/981 [00:10<00:35, 20.94it/s] 24%|██▎       | 231/981 [00:10<00:35, 20.91it/s] 24%|██▍       | 234/981 [00:11<00:35, 20.83it/s] 24%|██▍       | 237/981 [00:11<00:35, 20.68it/s] 24%|██▍       | 240/981 [00:11<00:36, 20.53it/s] 25%|██▍       | 243/981 [00:11<00:35, 20.57it/s] 25%|██▌       | 246/981 [00:11<00:36, 20.04it/s] 25%|██▌       | 249/981 [00:11<00:36, 20.25it/s] 26%|██▌       | 252/981 [00:12<00:35, 20.56it/s] 26%|██▌       | 255/981 [00:12<00:35, 20.55it/s] 26%|██▋       | 258/981 [00:12<00:35, 20.63it/s] 27%|██▋       | 261/981 [00:12<00:34, 20.63it/s] 27%|██▋       | 264/981 [00:12<00:34, 20.56it/s] 27%|██▋       | 267/981 [00:12<00:34, 20.70it/s] 28%|██▊       | 270/981 [00:12<00:34, 20.73it/s] 28%|██▊       | 273/981 [00:13<00:34, 20.71it/s] 28%|██▊       | 276/981 [00:13<00:33, 20.78it/s] 28%|██▊       | 279/981 [00:13<00:34, 20.64it/s] 29%|██▊       | 282/981 [00:13<00:33, 20.77it/s] 29%|██▉       | 285/981 [00:13<00:33, 20.79it/s] 29%|██▉       | 288/981 [00:13<00:33, 20.72it/s] 30%|██▉       | 291/981 [00:13<00:32, 20.91it/s] 30%|██▉       | 294/981 [00:14<00:32, 20.82it/s] 30%|███       | 297/981 [00:14<00:32, 20.84it/s] 31%|███       | 300/981 [00:14<00:32, 20.83it/s] 31%|███       | 303/981 [00:14<00:32, 20.75it/s] 31%|███       | 306/981 [00:14<00:32, 20.93it/s] 31%|███▏      | 309/981 [00:14<00:32, 20.68it/s] 32%|███▏      | 312/981 [00:14<00:32, 20.88it/s] 32%|███▏      | 315/981 [00:15<00:31, 20.90it/s] 32%|███▏      | 318/981 [00:15<00:31, 20.77it/s] 33%|███▎      | 321/981 [00:15<00:31, 20.91it/s] 33%|███▎      | 324/981 [00:15<00:31, 20.67it/s] 33%|███▎      | 327/981 [00:15<00:31, 20.80it/s] 34%|███▎      | 330/981 [00:15<00:32, 20.25it/s] 34%|███▍      | 333/981 [00:15<00:31, 20.27it/s] 34%|███▍      | 336/981 [00:16<00:31, 20.57it/s] 35%|███▍      | 339/981 [00:16<00:33, 18.91it/s] 35%|███▍      | 342/981 [00:16<00:33, 19.24it/s] 35%|███▌      | 344/981 [00:16<00:34, 18.46it/s] 35%|███▌      | 347/981 [00:16<00:33, 19.09it/s] 36%|███▌      | 350/981 [00:16<00:32, 19.64it/s] 36%|███▌      | 353/981 [00:16<00:31, 19.90it/s] 36%|███▋      | 356/981 [00:17<00:30, 20.29it/s] 37%|███▋      | 359/981 [00:17<00:30, 20.40it/s] 37%|███▋      | 362/981 [00:17<00:30, 20.56it/s] 37%|███▋      | 365/981 [00:17<00:29, 20.78it/s] 38%|███▊      | 368/981 [00:17<00:29, 20.69it/s] 38%|███▊      | 371/981 [00:17<00:29, 20.89it/s] 38%|███▊      | 374/981 [00:17<00:28, 21.03it/s] 38%|███▊      | 377/981 [00:18<00:29, 20.80it/s] 39%|███▊      | 380/981 [00:18<00:28, 20.92it/s] 39%|███▉      | 383/981 [00:18<00:28, 20.82it/s] 39%|███▉      | 386/981 [00:18<00:28, 20.80it/s] 40%|███▉      | 389/981 [00:18<00:28, 20.95it/s] 40%|███▉      | 392/981 [00:18<00:28, 20.68it/s] 40%|████      | 395/981 [00:18<00:28, 20.87it/s] 41%|████      | 398/981 [00:19<00:27, 20.84it/s] 41%|████      | 401/981 [00:19<00:28, 20.65it/s] 41%|████      | 404/981 [00:19<00:27, 20.84it/s] 41%|████▏     | 407/981 [00:19<00:27, 20.66it/s] 42%|████▏     | 410/981 [00:19<00:27, 20.71it/s] 42%|████▏     | 413/981 [00:19<00:27, 20.83it/s] 42%|████▏     | 416/981 [00:20<00:27, 20.61it/s] 43%|████▎     | 419/981 [00:20<00:27, 20.79it/s] 43%|████▎     | 422/981 [00:20<00:26, 20.74it/s] 43%|████▎     | 425/981 [00:20<00:27, 20.15it/s] 44%|████▎     | 428/981 [00:20<00:27, 20.41it/s] 44%|████▍     | 431/981 [00:20<00:27, 20.32it/s] 44%|████▍     | 434/981 [00:20<00:26, 20.54it/s] 45%|████▍     | 437/981 [00:21<00:26, 20.76it/s] 45%|████▍     | 440/981 [00:21<00:26, 20.59it/s] 45%|████▌     | 443/981 [00:21<00:25, 20.83it/s] 45%|████▌     | 446/981 [00:21<00:25, 20.91it/s] 46%|████▌     | 449/981 [00:21<00:25, 20.80it/s] 46%|████▌     | 452/981 [00:21<00:25, 21.01it/s] 46%|████▋     | 455/981 [00:21<00:25, 20.78it/s] 47%|████▋     | 458/981 [00:22<00:25, 20.88it/s] 47%|████▋     | 461/981 [00:22<00:24, 20.98it/s] 47%|████▋     | 464/981 [00:22<00:24, 20.82it/s] 48%|████▊     | 467/981 [00:22<00:24, 21.04it/s] 48%|████▊     | 470/981 [00:22<00:24, 21.02it/s] 48%|████▊     | 473/981 [00:22<00:24, 20.99it/s] 49%|████▊     | 476/981 [00:22<00:24, 21.04it/s] 49%|████▉     | 479/981 [00:23<00:24, 20.88it/s] 49%|████▉     | 482/981 [00:23<00:23, 20.88it/s] 49%|████▉     | 485/981 [00:23<00:23, 20.96it/s] 50%|████▉     | 488/981 [00:23<00:23, 20.75it/s] 50%|█████     | 491/981 [00:23<00:23, 20.86it/s] 50%|█████     | 494/981 [00:23<00:23, 20.89it/s] 51%|█████     | 497/981 [00:23<00:23, 20.84it/s] 51%|█████     | 500/981 [00:24<00:22, 20.96it/s] 51%|█████▏    | 503/981 [00:24<00:23, 20.62it/s] 52%|█████▏    | 506/981 [00:24<00:22, 20.80it/s] 52%|█████▏    | 509/981 [00:24<00:22, 20.90it/s] 52%|█████▏    | 512/981 [00:24<00:22, 20.85it/s] 52%|█████▏    | 515/981 [00:24<00:22, 21.11it/s] 53%|█████▎    | 518/981 [00:24<00:21, 21.08it/s] 53%|█████▎    | 521/981 [00:25<00:22, 20.73it/s] 53%|█████▎    | 524/981 [00:25<00:21, 20.93it/s] 54%|█████▎    | 527/981 [00:25<00:21, 20.84it/s] 54%|█████▍    | 530/981 [00:25<00:21, 21.17it/s] 54%|█████▍    | 533/981 [00:25<00:21, 21.29it/s] 55%|█████▍    | 536/981 [00:25<00:20, 21.25it/s] 55%|█████▍    | 539/981 [00:25<00:20, 21.41it/s] 55%|█████▌    | 542/981 [00:26<00:20, 21.22it/s] 56%|█████▌    | 545/981 [00:26<00:20, 21.33it/s] 56%|█████▌    | 548/981 [00:26<00:20, 21.53it/s] 56%|█████▌    | 551/981 [00:26<00:20, 20.58it/s] 56%|█████▋    | 554/981 [00:26<00:20, 20.69it/s] 57%|█████▋    | 557/981 [00:26<00:20, 20.63it/s] 57%|█████▋    | 560/981 [00:26<00:20, 20.69it/s] 57%|█████▋    | 563/981 [00:27<00:20, 20.85it/s] 58%|█████▊    | 566/981 [00:27<00:19, 20.80it/s] 58%|█████▊    | 569/981 [00:27<00:19, 20.99it/s] 58%|█████▊    | 572/981 [00:27<00:19, 21.03it/s] 59%|█████▊    | 575/981 [00:27<00:19, 21.03it/s] 59%|█████▉    | 578/981 [00:27<00:18, 21.24it/s] 59%|█████▉    | 581/981 [00:27<00:19, 20.53it/s] 60%|█████▉    | 584/981 [00:28<00:18, 21.05it/s] 60%|█████▉    | 587/981 [00:28<00:18, 21.11it/s] 60%|██████    | 590/981 [00:28<00:18, 21.31it/s] 60%|██████    | 593/981 [00:28<00:18, 21.54it/s] 61%|██████    | 596/981 [00:28<00:18, 21.32it/s] 61%|██████    | 599/981 [00:28<00:17, 21.53it/s] 61%|██████▏   | 602/981 [00:28<00:17, 21.61it/s] 62%|██████▏   | 605/981 [00:29<00:17, 21.52it/s] 62%|██████▏   | 608/981 [00:29<00:17, 21.75it/s] 62%|██████▏   | 611/981 [00:29<00:17, 21.53it/s] 63%|██████▎   | 614/981 [00:29<00:16, 21.65it/s] 63%|██████▎   | 617/981 [00:29<00:16, 21.83it/s] 63%|██████▎   | 620/981 [00:29<00:16, 21.67it/s] 64%|██████▎   | 623/981 [00:29<00:16, 21.83it/s] 64%|██████▍   | 626/981 [00:30<00:17, 20.59it/s] 64%|██████▍   | 629/981 [00:30<00:16, 20.88it/s] 64%|██████▍   | 632/981 [00:30<00:16, 20.97it/s] 65%|██████▍   | 635/981 [00:30<00:17, 19.85it/s] 65%|██████▌   | 638/981 [00:30<00:16, 20.20it/s] 65%|██████▌   | 641/981 [00:30<00:17, 19.28it/s] 66%|██████▌   | 644/981 [00:30<00:16, 19.99it/s] 66%|██████▌   | 647/981 [00:31<00:16, 20.41it/s] 66%|██████▋   | 650/981 [00:31<00:16, 20.60it/s] 67%|██████▋   | 653/981 [00:31<00:15, 20.99it/s] 67%|██████▋   | 656/981 [00:31<00:15, 21.01it/s] 67%|██████▋   | 659/981 [00:31<00:15, 21.26it/s] 67%|██████▋   | 662/981 [00:31<00:14, 21.50it/s] 68%|██████▊   | 665/981 [00:31<00:14, 21.28it/s] 68%|██████▊   | 668/981 [00:32<00:14, 21.53it/s] 68%|██████▊   | 671/981 [00:32<00:14, 21.57it/s] 69%|██████▊   | 674/981 [00:32<00:14, 21.31it/s] 69%|██████▉   | 677/981 [00:32<00:14, 21.50it/s] 69%|██████▉   | 680/981 [00:32<00:14, 21.37it/s] 70%|██████▉   | 683/981 [00:32<00:13, 21.49it/s] 70%|██████▉   | 686/981 [00:32<00:13, 21.72it/s] 70%|███████   | 689/981 [00:32<00:13, 21.48it/s] 71%|███████   | 692/981 [00:33<00:13, 21.71it/s] 71%|███████   | 695/981 [00:33<00:13, 21.72it/s] 71%|███████   | 698/981 [00:33<00:13, 21.57it/s] 71%|███████▏  | 701/981 [00:33<00:12, 21.73it/s] 72%|███████▏  | 704/981 [00:33<00:12, 21.50it/s] 72%|███████▏  | 707/981 [00:33<00:12, 21.49it/s] 72%|███████▏  | 710/981 [00:33<00:12, 21.65it/s] 73%|███████▎  | 713/981 [00:34<00:12, 21.36it/s] 73%|███████▎  | 716/981 [00:34<00:12, 21.51it/s] 73%|███████▎  | 719/981 [00:34<00:12, 21.58it/s] 74%|███████▎  | 722/981 [00:34<00:12, 21.36it/s] 74%|███████▍  | 725/981 [00:34<00:11, 21.35it/s] 74%|███████▍  | 728/981 [00:34<00:12, 21.01it/s] 75%|███████▍  | 731/981 [00:34<00:12, 20.75it/s] 75%|███████▍  | 734/981 [00:35<00:11, 21.11it/s] 75%|███████▌  | 737/981 [00:35<00:11, 21.12it/s] 75%|███████▌  | 740/981 [00:35<00:11, 21.29it/s] 76%|███████▌  | 743/981 [00:35<00:11, 21.51it/s] 76%|███████▌  | 746/981 [00:35<00:11, 21.29it/s] 76%|███████▋  | 749/981 [00:35<00:10, 21.46it/s] 77%|███████▋  | 752/981 [00:35<00:10, 21.47it/s] 77%|███████▋  | 755/981 [00:36<00:10, 21.35it/s] 77%|███████▋  | 758/981 [00:36<00:10, 21.46it/s] 78%|███████▊  | 761/981 [00:36<00:10, 21.28it/s] 78%|███████▊  | 764/981 [00:36<00:10, 21.07it/s] 78%|███████▊  | 767/981 [00:36<00:10, 20.91it/s] 78%|███████▊  | 770/981 [00:36<00:10, 20.89it/s] 79%|███████▉  | 773/981 [00:36<00:09, 21.08it/s] 79%|███████▉  | 776/981 [00:37<00:09, 21.13it/s] 79%|███████▉  | 779/981 [00:37<00:09, 20.75it/s] 80%|███████▉  | 782/981 [00:37<00:09, 21.13it/s] 80%|████████  | 785/981 [00:37<00:09, 21.07it/s] 80%|████████  | 788/981 [00:37<00:08, 21.78it/s] 81%|████████  | 791/981 [00:37<00:08, 22.59it/s] 81%|████████  | 794/981 [00:37<00:08, 22.80it/s] 81%|████████  | 797/981 [00:38<00:07, 23.24it/s] 82%|████████▏ | 800/981 [00:38<00:07, 23.65it/s] 82%|████████▏ | 803/981 [00:38<00:07, 23.24it/s] 82%|████████▏ | 806/981 [00:38<00:07, 23.82it/s] 82%|████████▏ | 809/981 [00:38<00:07, 24.42it/s] 83%|████████▎ | 812/981 [00:38<00:06, 24.64it/s] 83%|████████▎ | 815/981 [00:38<00:06, 24.77it/s] 83%|████████▎ | 818/981 [00:38<00:06, 25.04it/s] 84%|████████▎ | 821/981 [00:38<00:06, 25.01it/s] 84%|████████▍ | 824/981 [00:39<00:06, 24.97it/s] 84%|████████▍ | 827/981 [00:39<00:06, 25.25it/s] 85%|████████▍ | 830/981 [00:39<00:05, 25.37it/s] 85%|████████▍ | 833/981 [00:39<00:05, 25.16it/s] 85%|████████▌ | 836/981 [00:39<00:05, 25.40it/s] 86%|████████▌ | 839/981 [00:39<00:05, 25.52it/s] 86%|████████▌ | 842/981 [00:39<00:05, 25.36it/s] 86%|████████▌ | 845/981 [00:39<00:05, 25.48it/s] 86%|████████▋ | 848/981 [00:40<00:05, 25.49it/s] 87%|████████▋ | 851/981 [00:40<00:05, 25.25it/s] 87%|████████▋ | 854/981 [00:40<00:04, 25.43it/s] 87%|████████▋ | 857/981 [00:40<00:04, 25.62it/s] 88%|████████▊ | 860/981 [00:40<00:04, 25.34it/s] 88%|████████▊ | 863/981 [00:40<00:04, 25.54it/s] 88%|████████▊ | 866/981 [00:40<00:04, 25.65it/s] 89%|████████▊ | 869/981 [00:40<00:04, 25.42it/s] 89%|████████▉ | 872/981 [00:40<00:04, 25.38it/s] 89%|████████▉ | 875/981 [00:41<00:04, 24.97it/s] 90%|████████▉ | 878/981 [00:41<00:04, 24.90it/s] 90%|████████▉ | 881/981 [00:41<00:04, 24.99it/s] 90%|█████████ | 884/981 [00:41<00:03, 25.07it/s] 90%|█████████ | 887/981 [00:41<00:03, 25.09it/s] 91%|█████████ | 890/981 [00:41<00:03, 24.96it/s] 91%|█████████ | 893/981 [00:41<00:03, 25.17it/s] 91%|█████████▏| 896/981 [00:41<00:03, 25.17it/s] 92%|█████████▏| 899/981 [00:42<00:03, 24.97it/s] 92%|█████████▏| 902/981 [00:42<00:03, 25.06it/s] 92%|█████████▏| 905/981 [00:42<00:03, 25.11it/s] 93%|█████████▎| 908/981 [00:42<00:02, 25.11it/s] 93%|█████████▎| 911/981 [00:42<00:02, 25.15it/s] 93%|█████████▎| 914/981 [00:42<00:02, 25.46it/s] 93%|█████████▎| 917/981 [00:42<00:02, 25.63it/s] 94%|█████████▍| 920/981 [00:42<00:02, 25.42it/s] 94%|█████████▍| 923/981 [00:43<00:02, 25.56it/s] 94%|█████████▍| 926/981 [00:43<00:02, 25.72it/s] 95%|█████████▍| 929/981 [00:43<00:02, 25.69it/s] 95%|█████████▌| 932/981 [00:43<00:01, 25.58it/s] 95%|█████████▌| 935/981 [00:43<00:01, 25.62it/s] 96%|█████████▌| 938/981 [00:43<00:01, 25.72it/s] 96%|█████████▌| 941/981 [00:43<00:01, 25.33it/s] 96%|█████████▌| 944/981 [00:43<00:01, 25.46it/s] 97%|█████████▋| 947/981 [00:43<00:01, 25.67it/s] 97%|█████████▋| 950/981 [00:44<00:01, 25.46it/s] 97%|█████████▋| 953/981 [00:44<00:01, 25.49it/s] 97%|█████████▋| 956/981 [00:44<00:00, 25.64it/s] 98%|█████████▊| 959/981 [00:44<00:00, 25.39it/s] 98%|█████████▊| 962/981 [00:44<00:00, 25.47it/s] 98%|█████████▊| 965/981 [00:44<00:00, 25.44it/s] 99%|█████████▊| 968/981 [00:44<00:00, 25.37it/s] 99%|█████████▉| 971/981 [00:44<00:00, 25.40it/s] 99%|█████████▉| 974/981 [00:45<00:00, 25.24it/s]100%|█████████▉| 977/981 [00:45<00:00, 25.20it/s]100%|█████████▉| 980/981 [00:45<00:00, 25.15it/s]100%|██████████| 981/981 [00:45<00:00, 21.66it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.085, valid loss : 0.053, train acc : 0.550, valid acc : 0.950, train f1 : 0.548, valid f1 : 0.638
training process:   2%|▏         | 1/50 [08:08<6:39:20, 488.99s/it]training process:   4%|▍         | 2/50 [16:05<6:25:31, 481.91s/it]training process:   6%|▌         | 3/50 [23:59<6:14:23, 477.95s/it]training process:   8%|▊         | 4/50 [31:54<6:05:46, 477.09s/it]epoch : 5, train loss : 0.035, valid loss : 0.018, train acc : 0.880, valid acc : 0.967, train f1 : 0.880, valid f1 : 0.729
training process:  10%|█         | 5/50 [39:47<5:56:31, 475.37s/it]training process:  12%|█▏        | 6/50 [47:41<5:48:12, 474.83s/it]training process:  14%|█▍        | 7/50 [55:32<5:39:24, 473.58s/it]training process:  16%|█▌        | 8/50 [1:03:23<5:31:06, 473.01s/it]epoch : 9, train loss : 0.028, valid loss : 0.016, train acc : 0.895, valid acc : 0.979, train f1 : 0.895, valid f1 : 0.786
training process:  18%|█▊        | 9/50 [1:11:15<5:22:51, 472.47s/it]training process:  20%|██        | 10/50 [1:19:05<5:14:28, 471.72s/it]training process:  22%|██▏       | 11/50 [1:26:58<5:06:57, 472.24s/it]training process:  24%|██▍       | 12/50 [1:34:47<4:58:30, 471.34s/it]epoch : 13, train loss : 0.028, valid loss : 0.013, train acc : 0.899, valid acc : 0.986, train f1 : 0.899, valid f1 : 0.827
training process:  26%|██▌       | 13/50 [1:42:40<4:50:51, 471.66s/it]training process:  28%|██▊       | 14/50 [1:50:32<4:43:08, 471.90s/it]training process:  30%|███       | 15/50 [1:58:27<4:35:47, 472.80s/it]training process:  32%|███▏      | 16/50 [2:06:18<4:27:40, 472.37s/it]epoch : 17, train loss : 0.024, valid loss : 0.013, train acc : 0.909, valid acc : 0.983, train f1 : 0.909, valid f1 : 0.820
training process:  34%|███▍      | 17/50 [2:14:13<4:20:06, 472.91s/it]training process:  36%|███▌      | 18/50 [2:22:04<4:12:01, 472.56s/it]training process:  38%|███▊      | 19/50 [2:30:00<4:04:40, 473.55s/it]training process:  40%|████      | 20/50 [2:37:57<3:57:12, 474.42s/it]epoch : 21, train loss : 0.022, valid loss : 0.014, train acc : 0.918, valid acc : 0.975, train f1 : 0.918, valid f1 : 0.771
training process:  42%|████▏     | 21/50 [2:45:50<3:49:11, 474.19s/it]training process:  44%|████▍     | 22/50 [2:53:46<3:41:26, 474.51s/it]training process:  46%|████▌     | 23/50 [3:01:36<3:32:59, 473.30s/it]training process:  48%|████▊     | 24/50 [3:09:29<3:24:59, 473.06s/it]epoch : 25, train loss : 0.022, valid loss : 0.012, train acc : 0.919, valid acc : 0.950, train f1 : 0.919, valid f1 : 0.684
training process:  50%|█████     | 25/50 [3:17:21<3:17:02, 472.90s/it]training process:  52%|█████▏    | 26/50 [3:25:10<3:08:39, 471.64s/it]training process:  54%|█████▍    | 27/50 [3:32:59<3:00:32, 470.99s/it]training process:  56%|█████▌    | 28/50 [3:40:49<2:52:31, 470.52s/it]epoch : 29, train loss : 0.022, valid loss : 0.011, train acc : 0.917, valid acc : 0.978, train f1 : 0.917, valid f1 : 0.781
training process:  58%|█████▊    | 29/50 [3:48:41<2:44:51, 471.02s/it]training process:  60%|██████    | 30/50 [3:56:30<2:36:48, 470.42s/it]training process:  62%|██████▏   | 31/50 [4:04:23<2:29:13, 471.24s/it]training process:  64%|██████▍   | 32/50 [4:12:13<2:21:16, 470.90s/it]epoch : 33, train loss : 0.020, valid loss : 0.014, train acc : 0.924, valid acc : 0.968, train f1 : 0.924, valid f1 : 0.734
training process:  66%|██████▌   | 33/50 [4:20:02<2:13:13, 470.18s/it]training process:  68%|██████▊   | 34/50 [4:27:53<2:05:26, 470.39s/it]training process:  70%|███████   | 35/50 [4:35:44<1:57:40, 470.68s/it]training process:  72%|███████▏  | 36/50 [4:43:37<1:49:57, 471.25s/it]epoch : 37, train loss : 0.020, valid loss : 0.014, train acc : 0.923, valid acc : 0.967, train f1 : 0.923, valid f1 : 0.733
training process:  74%|███████▍  | 37/50 [4:51:28<1:42:06, 471.28s/it]training process:  76%|███████▌  | 38/50 [4:59:16<1:34:03, 470.30s/it]training process:  78%|███████▊  | 39/50 [5:07:11<1:26:28, 471.68s/it]training process:  80%|████████  | 40/50 [5:15:03<1:18:39, 471.92s/it]epoch : 41, train loss : 0.019, valid loss : 0.007, train acc : 0.926, valid acc : 0.981, train f1 : 0.926, valid f1 : 0.810
training process:  82%|████████▏ | 41/50 [5:22:59<1:10:57, 473.09s/it]training process:  84%|████████▍ | 42/50 [5:30:49<1:02:56, 472.07s/it]training process:  86%|████████▌ | 43/50 [5:38:45<55:12, 473.26s/it]  training process:  88%|████████▊ | 44/50 [5:46:40<47:23, 473.83s/it]epoch : 45, train loss : 0.019, valid loss : 0.009, train acc : 0.928, valid acc : 0.979, train f1 : 0.928, valid f1 : 0.788
training process:  90%|█████████ | 45/50 [5:54:34<39:29, 473.84s/it]training process:  92%|█████████▏| 46/50 [6:02:28<31:35, 473.79s/it]training process:  94%|█████████▍| 47/50 [6:10:23<23:43, 474.36s/it]training process:  96%|█████████▌| 48/50 [6:18:17<15:48, 474.13s/it]epoch : 49, train loss : 0.017, valid loss : 0.009, train acc : 0.933, valid acc : 0.980, train f1 : 0.933, valid f1 : 0.801
training process:  98%|█████████▊| 49/50 [6:26:14<07:54, 475.00s/it]training process: 100%|██████████| 50/50 [6:34:03<00:00, 473.18s/it]training process: 100%|██████████| 50/50 [6:34:03<00:00, 472.87s/it]
training process finished, best loss : 0.004 and best acc : 0.992, best f1 : 0.893, best epoch : 41

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.58      0.80      0.67        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.79      0.90      0.83      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.83, test AUC : 0.90, test loss : 0.079

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:50, 19.40it/s]  1%|          | 5/981 [00:00<00:46, 20.96it/s]  1%|          | 8/981 [00:00<00:46, 20.86it/s]  1%|          | 11/981 [00:00<00:46, 21.03it/s]  1%|▏         | 14/981 [00:00<00:45, 21.21it/s]  2%|▏         | 17/981 [00:00<00:45, 21.16it/s]  2%|▏         | 20/981 [00:00<00:45, 21.33it/s]  2%|▏         | 23/981 [00:01<00:44, 21.34it/s]  3%|▎         | 26/981 [00:01<00:45, 21.17it/s]  3%|▎         | 29/981 [00:01<00:45, 21.12it/s]  3%|▎         | 32/981 [00:01<00:44, 21.13it/s]  4%|▎         | 35/981 [00:01<00:44, 21.20it/s]  4%|▍         | 38/981 [00:01<00:44, 21.24it/s]  4%|▍         | 41/981 [00:01<00:44, 21.08it/s]  4%|▍         | 44/981 [00:02<00:44, 21.16it/s]  5%|▍         | 47/981 [00:02<00:44, 21.13it/s]  5%|▌         | 50/981 [00:02<00:44, 21.03it/s]  5%|▌         | 53/981 [00:02<00:43, 21.13it/s]  6%|▌         | 56/981 [00:02<00:43, 21.16it/s]  6%|▌         | 59/981 [00:02<00:43, 21.06it/s]  6%|▋         | 62/981 [00:02<00:43, 21.26it/s]  7%|▋         | 65/981 [00:03<00:43, 21.15it/s]  7%|▋         | 68/981 [00:03<00:42, 21.24it/s]  7%|▋         | 71/981 [00:03<00:42, 21.35it/s]  8%|▊         | 74/981 [00:03<00:43, 20.88it/s]  8%|▊         | 77/981 [00:03<00:42, 21.04it/s]  8%|▊         | 80/981 [00:03<00:42, 21.04it/s]  8%|▊         | 83/981 [00:03<00:43, 20.87it/s]  9%|▉         | 86/981 [00:04<00:42, 20.88it/s]  9%|▉         | 89/981 [00:04<00:42, 20.91it/s]  9%|▉         | 92/981 [00:04<00:42, 20.97it/s] 10%|▉         | 95/981 [00:04<00:42, 20.96it/s] 10%|▉         | 98/981 [00:04<00:42, 20.83it/s] 10%|█         | 101/981 [00:04<00:42, 20.95it/s] 11%|█         | 104/981 [00:04<00:41, 21.03it/s] 11%|█         | 107/981 [00:05<00:41, 21.04it/s] 11%|█         | 110/981 [00:05<00:41, 20.95it/s] 12%|█▏        | 113/981 [00:05<00:41, 20.78it/s] 12%|█▏        | 116/981 [00:05<00:41, 20.76it/s] 12%|█▏        | 119/981 [00:05<00:41, 20.73it/s] 12%|█▏        | 122/981 [00:05<00:41, 20.74it/s] 13%|█▎        | 125/981 [00:05<00:41, 20.85it/s] 13%|█▎        | 128/981 [00:06<00:41, 20.78it/s] 13%|█▎        | 131/981 [00:06<00:40, 20.79it/s] 14%|█▎        | 134/981 [00:06<00:40, 20.89it/s] 14%|█▍        | 137/981 [00:06<00:40, 20.80it/s] 14%|█▍        | 140/981 [00:06<00:40, 20.86it/s] 15%|█▍        | 143/981 [00:06<00:40, 20.86it/s] 15%|█▍        | 146/981 [00:06<00:39, 20.91it/s] 15%|█▌        | 149/981 [00:07<00:39, 20.90it/s] 15%|█▌        | 152/981 [00:07<00:39, 20.81it/s] 16%|█▌        | 155/981 [00:07<00:39, 20.87it/s] 16%|█▌        | 158/981 [00:07<00:39, 20.93it/s] 16%|█▋        | 161/981 [00:07<00:39, 20.92it/s] 17%|█▋        | 164/981 [00:07<00:39, 20.61it/s] 17%|█▋        | 167/981 [00:07<00:39, 20.55it/s] 17%|█▋        | 170/981 [00:08<00:39, 20.54it/s] 18%|█▊        | 173/981 [00:08<00:38, 20.89it/s] 18%|█▊        | 176/981 [00:08<00:38, 20.73it/s] 18%|█▊        | 179/981 [00:08<00:38, 20.81it/s] 19%|█▊        | 182/981 [00:08<00:38, 21.00it/s] 19%|█▉        | 185/981 [00:08<00:38, 20.90it/s] 19%|█▉        | 188/981 [00:08<00:37, 21.12it/s] 19%|█▉        | 191/981 [00:09<00:37, 21.08it/s] 20%|█▉        | 194/981 [00:09<00:37, 21.14it/s] 20%|██        | 197/981 [00:09<00:36, 21.32it/s] 20%|██        | 200/981 [00:09<00:37, 21.10it/s] 21%|██        | 203/981 [00:09<00:36, 21.23it/s] 21%|██        | 206/981 [00:09<00:36, 21.18it/s] 21%|██▏       | 209/981 [00:09<00:36, 20.90it/s] 22%|██▏       | 212/981 [00:10<00:36, 20.92it/s] 22%|██▏       | 215/981 [00:10<00:37, 20.68it/s] 22%|██▏       | 218/981 [00:10<00:36, 20.72it/s] 23%|██▎       | 221/981 [00:10<00:36, 20.66it/s] 23%|██▎       | 224/981 [00:10<00:37, 20.44it/s] 23%|██▎       | 227/981 [00:10<00:36, 20.39it/s] 23%|██▎       | 230/981 [00:11<00:37, 19.89it/s] 24%|██▍       | 233/981 [00:11<00:37, 20.10it/s] 24%|██▍       | 236/981 [00:11<00:36, 20.33it/s] 24%|██▍       | 239/981 [00:11<00:36, 20.36it/s] 25%|██▍       | 242/981 [00:11<00:36, 20.53it/s] 25%|██▍       | 245/981 [00:11<00:35, 20.46it/s] 25%|██▌       | 248/981 [00:11<00:35, 20.57it/s] 26%|██▌       | 251/981 [00:12<00:35, 20.69it/s] 26%|██▌       | 254/981 [00:12<00:35, 20.56it/s] 26%|██▌       | 257/981 [00:12<00:34, 20.70it/s] 27%|██▋       | 260/981 [00:12<00:34, 20.69it/s] 27%|██▋       | 263/981 [00:12<00:34, 20.71it/s] 27%|██▋       | 266/981 [00:12<00:34, 20.86it/s] 27%|██▋       | 269/981 [00:12<00:34, 20.80it/s] 28%|██▊       | 272/981 [00:13<00:34, 20.83it/s] 28%|██▊       | 275/981 [00:13<00:33, 20.87it/s] 28%|██▊       | 278/981 [00:13<00:33, 20.82it/s] 29%|██▊       | 281/981 [00:13<00:33, 20.92it/s] 29%|██▉       | 284/981 [00:13<00:33, 20.74it/s] 29%|██▉       | 287/981 [00:13<00:34, 20.20it/s] 30%|██▉       | 290/981 [00:13<00:34, 19.89it/s] 30%|██▉       | 292/981 [00:14<00:34, 19.82it/s] 30%|██▉       | 294/981 [00:14<00:34, 19.74it/s] 30%|███       | 297/981 [00:14<00:34, 20.09it/s] 31%|███       | 300/981 [00:14<00:33, 20.43it/s] 31%|███       | 303/981 [00:14<00:33, 20.43it/s] 31%|███       | 306/981 [00:14<00:32, 20.68it/s] 31%|███▏      | 309/981 [00:14<00:33, 20.35it/s] 32%|███▏      | 312/981 [00:14<00:32, 20.54it/s] 32%|███▏      | 315/981 [00:15<00:31, 20.86it/s] 32%|███▏      | 318/981 [00:15<00:31, 20.99it/s] 33%|███▎      | 321/981 [00:15<00:31, 20.86it/s] 33%|███▎      | 324/981 [00:15<00:31, 20.83it/s] 33%|███▎      | 327/981 [00:15<00:31, 20.72it/s] 34%|███▎      | 330/981 [00:15<00:35, 18.43it/s] 34%|███▍      | 332/981 [00:16<00:34, 18.72it/s] 34%|███▍      | 335/981 [00:16<00:34, 18.94it/s] 34%|███▍      | 337/981 [00:16<00:33, 19.15it/s] 35%|███▍      | 340/981 [00:16<00:32, 19.80it/s] 35%|███▍      | 343/981 [00:16<00:31, 20.24it/s] 35%|███▌      | 346/981 [00:16<00:30, 20.65it/s] 36%|███▌      | 349/981 [00:16<00:30, 20.86it/s] 36%|███▌      | 352/981 [00:16<00:30, 20.73it/s] 36%|███▌      | 355/981 [00:17<00:29, 20.97it/s] 36%|███▋      | 358/981 [00:17<00:29, 21.09it/s] 37%|███▋      | 361/981 [00:17<00:29, 21.10it/s] 37%|███▋      | 364/981 [00:17<00:29, 20.99it/s] 37%|███▋      | 367/981 [00:17<00:30, 20.35it/s] 38%|███▊      | 370/981 [00:17<00:30, 20.20it/s] 38%|███▊      | 373/981 [00:18<00:30, 20.25it/s] 38%|███▊      | 376/981 [00:18<00:29, 20.38it/s] 39%|███▊      | 379/981 [00:18<00:29, 20.37it/s] 39%|███▉      | 382/981 [00:18<00:29, 20.38it/s] 39%|███▉      | 385/981 [00:18<00:29, 20.50it/s] 40%|███▉      | 388/981 [00:18<00:29, 20.41it/s] 40%|███▉      | 391/981 [00:18<00:28, 20.45it/s] 40%|████      | 394/981 [00:19<00:28, 20.34it/s] 40%|████      | 397/981 [00:19<00:28, 20.39it/s] 41%|████      | 400/981 [00:19<00:28, 20.55it/s] 41%|████      | 403/981 [00:19<00:27, 20.76it/s] 41%|████▏     | 406/981 [00:19<00:27, 21.15it/s] 42%|████▏     | 409/981 [00:19<00:29, 19.62it/s] 42%|████▏     | 411/981 [00:19<00:29, 19.38it/s] 42%|████▏     | 413/981 [00:20<00:30, 18.46it/s] 42%|████▏     | 415/981 [00:20<00:30, 18.34it/s] 43%|████▎     | 417/981 [00:20<00:30, 18.20it/s] 43%|████▎     | 420/981 [00:20<00:29, 19.29it/s] 43%|████▎     | 423/981 [00:20<00:28, 19.76it/s] 43%|████▎     | 426/981 [00:20<00:27, 20.07it/s] 44%|████▎     | 428/981 [00:20<00:27, 20.01it/s] 44%|████▍     | 431/981 [00:20<00:27, 20.18it/s] 44%|████▍     | 434/981 [00:21<00:27, 19.93it/s] 44%|████▍     | 436/981 [00:21<00:28, 19.00it/s] 45%|████▍     | 438/981 [00:21<00:28, 19.09it/s] 45%|████▍     | 440/981 [00:21<00:28, 19.03it/s] 45%|████▌     | 442/981 [00:21<00:28, 18.64it/s] 45%|████▌     | 445/981 [00:21<00:27, 19.53it/s] 46%|████▌     | 448/981 [00:21<00:26, 20.08it/s] 46%|████▌     | 451/981 [00:21<00:25, 20.48it/s] 46%|████▋     | 454/981 [00:22<00:25, 20.88it/s] 47%|████▋     | 457/981 [00:22<00:24, 21.04it/s] 47%|████▋     | 460/981 [00:22<00:24, 20.93it/s] 47%|████▋     | 463/981 [00:22<00:24, 21.22it/s] 48%|████▊     | 466/981 [00:22<00:24, 20.99it/s] 48%|████▊     | 469/981 [00:22<00:24, 21.20it/s] 48%|████▊     | 472/981 [00:22<00:24, 21.20it/s] 48%|████▊     | 475/981 [00:23<00:23, 21.22it/s] 49%|████▊     | 478/981 [00:23<00:23, 21.42it/s] 49%|████▉     | 481/981 [00:23<00:24, 20.72it/s] 49%|████▉     | 484/981 [00:23<00:23, 20.86it/s] 50%|████▉     | 487/981 [00:23<00:23, 20.85it/s] 50%|████▉     | 490/981 [00:23<00:23, 20.73it/s] 50%|█████     | 493/981 [00:23<00:23, 20.58it/s] 51%|█████     | 496/981 [00:24<00:23, 20.58it/s] 51%|█████     | 499/981 [00:24<00:23, 20.58it/s] 51%|█████     | 502/981 [00:24<00:22, 20.88it/s] 51%|█████▏    | 505/981 [00:24<00:23, 20.54it/s] 52%|█████▏    | 508/981 [00:24<00:23, 20.56it/s] 52%|█████▏    | 511/981 [00:24<00:23, 20.36it/s] 52%|█████▏    | 514/981 [00:24<00:22, 20.47it/s] 53%|█████▎    | 517/981 [00:25<00:22, 20.68it/s] 53%|█████▎    | 520/981 [00:25<00:22, 20.53it/s] 53%|█████▎    | 523/981 [00:25<00:21, 21.15it/s] 54%|█████▎    | 526/981 [00:25<00:21, 21.40it/s] 54%|█████▍    | 529/981 [00:25<00:20, 21.63it/s] 54%|█████▍    | 532/981 [00:25<00:20, 21.85it/s] 55%|█████▍    | 535/981 [00:25<00:20, 21.90it/s] 55%|█████▍    | 538/981 [00:26<00:20, 21.77it/s] 55%|█████▌    | 541/981 [00:26<00:20, 21.99it/s] 55%|█████▌    | 544/981 [00:26<00:19, 21.99it/s] 56%|█████▌    | 547/981 [00:26<00:19, 21.82it/s] 56%|█████▌    | 550/981 [00:26<00:19, 21.76it/s] 56%|█████▋    | 553/981 [00:26<00:19, 21.67it/s] 57%|█████▋    | 556/981 [00:26<00:19, 21.81it/s] 57%|█████▋    | 559/981 [00:27<00:19, 21.97it/s] 57%|█████▋    | 562/981 [00:27<00:19, 22.03it/s] 58%|█████▊    | 565/981 [00:27<00:18, 22.17it/s] 58%|█████▊    | 568/981 [00:27<00:18, 22.11it/s] 58%|█████▊    | 571/981 [00:27<00:18, 21.70it/s] 59%|█████▊    | 574/981 [00:27<00:18, 21.81it/s] 59%|█████▉    | 577/981 [00:27<00:18, 21.81it/s] 59%|█████▉    | 580/981 [00:27<00:18, 21.97it/s] 59%|█████▉    | 583/981 [00:28<00:18, 21.78it/s] 60%|█████▉    | 586/981 [00:28<00:18, 21.23it/s] 60%|██████    | 589/981 [00:28<00:18, 21.58it/s] 60%|██████    | 592/981 [00:28<00:19, 19.93it/s] 61%|██████    | 595/981 [00:28<00:20, 19.12it/s] 61%|██████    | 597/981 [00:28<00:20, 18.66it/s] 61%|██████    | 600/981 [00:28<00:19, 19.67it/s] 61%|██████▏   | 603/981 [00:29<00:18, 20.49it/s] 62%|██████▏   | 606/981 [00:29<00:17, 21.03it/s] 62%|██████▏   | 609/981 [00:29<00:17, 21.37it/s] 62%|██████▏   | 612/981 [00:29<00:16, 21.73it/s] 63%|██████▎   | 615/981 [00:29<00:16, 21.84it/s] 63%|██████▎   | 618/981 [00:29<00:16, 22.01it/s] 63%|██████▎   | 621/981 [00:29<00:16, 22.09it/s] 64%|██████▎   | 624/981 [00:30<00:16, 22.08it/s] 64%|██████▍   | 627/981 [00:30<00:15, 22.18it/s] 64%|██████▍   | 630/981 [00:30<00:16, 21.82it/s] 65%|██████▍   | 633/981 [00:30<00:15, 21.91it/s] 65%|██████▍   | 636/981 [00:30<00:15, 22.08it/s] 65%|██████▌   | 639/981 [00:30<00:15, 21.68it/s] 65%|██████▌   | 642/981 [00:30<00:15, 21.99it/s] 66%|██████▌   | 645/981 [00:31<00:15, 22.09it/s] 66%|██████▌   | 648/981 [00:31<00:15, 22.02it/s] 66%|██████▋   | 651/981 [00:31<00:14, 22.18it/s] 67%|██████▋   | 654/981 [00:31<00:14, 22.04it/s] 67%|██████▋   | 657/981 [00:31<00:14, 22.06it/s] 67%|██████▋   | 660/981 [00:31<00:14, 22.21it/s] 68%|██████▊   | 663/981 [00:31<00:14, 22.10it/s] 68%|██████▊   | 666/981 [00:31<00:14, 22.27it/s] 68%|██████▊   | 669/981 [00:32<00:13, 22.36it/s] 69%|██████▊   | 672/981 [00:32<00:13, 22.18it/s] 69%|██████▉   | 675/981 [00:32<00:13, 22.10it/s] 69%|██████▉   | 678/981 [00:32<00:13, 21.99it/s] 69%|██████▉   | 681/981 [00:32<00:13, 21.96it/s] 70%|██████▉   | 684/981 [00:32<00:13, 22.04it/s] 70%|███████   | 687/981 [00:32<00:13, 22.17it/s] 70%|███████   | 690/981 [00:33<00:13, 22.22it/s] 71%|███████   | 693/981 [00:33<00:12, 22.42it/s] 71%|███████   | 696/981 [00:33<00:12, 22.37it/s] 71%|███████▏  | 699/981 [00:33<00:12, 22.42it/s] 72%|███████▏  | 702/981 [00:33<00:12, 22.54it/s] 72%|███████▏  | 705/981 [00:33<00:12, 22.41it/s] 72%|███████▏  | 708/981 [00:33<00:12, 22.52it/s] 72%|███████▏  | 711/981 [00:33<00:12, 22.50it/s] 73%|███████▎  | 714/981 [00:34<00:11, 22.34it/s] 73%|███████▎  | 717/981 [00:34<00:11, 22.44it/s] 73%|███████▎  | 720/981 [00:34<00:11, 22.29it/s] 74%|███████▎  | 723/981 [00:34<00:11, 22.31it/s] 74%|███████▍  | 726/981 [00:34<00:11, 22.42it/s] 74%|███████▍  | 729/981 [00:34<00:11, 22.34it/s] 75%|███████▍  | 732/981 [00:34<00:11, 22.38it/s] 75%|███████▍  | 735/981 [00:35<00:10, 22.45it/s] 75%|███████▌  | 738/981 [00:35<00:11, 21.91it/s] 76%|███████▌  | 741/981 [00:35<00:10, 21.94it/s] 76%|███████▌  | 744/981 [00:35<00:11, 21.53it/s] 76%|███████▌  | 747/981 [00:35<00:11, 21.26it/s] 76%|███████▋  | 750/981 [00:35<00:10, 21.52it/s] 77%|███████▋  | 753/981 [00:35<00:10, 21.52it/s] 77%|███████▋  | 756/981 [00:36<00:10, 21.56it/s] 77%|███████▋  | 759/981 [00:36<00:10, 21.47it/s] 78%|███████▊  | 762/981 [00:36<00:10, 21.29it/s] 78%|███████▊  | 765/981 [00:36<00:10, 21.24it/s] 78%|███████▊  | 768/981 [00:36<00:10, 21.20it/s] 79%|███████▊  | 771/981 [00:36<00:09, 21.16it/s] 79%|███████▉  | 774/981 [00:36<00:09, 21.39it/s] 79%|███████▉  | 777/981 [00:37<00:09, 21.34it/s] 80%|███████▉  | 780/981 [00:37<00:09, 21.54it/s] 80%|███████▉  | 783/981 [00:37<00:08, 22.09it/s] 80%|████████  | 786/981 [00:37<00:08, 22.57it/s] 80%|████████  | 789/981 [00:37<00:08, 23.25it/s] 81%|████████  | 792/981 [00:37<00:07, 23.85it/s] 81%|████████  | 795/981 [00:37<00:07, 24.18it/s] 81%|████████▏ | 798/981 [00:37<00:07, 24.75it/s] 82%|████████▏ | 801/981 [00:38<00:07, 25.17it/s] 82%|████████▏ | 804/981 [00:38<00:06, 25.33it/s] 82%|████████▏ | 807/981 [00:38<00:06, 25.54it/s] 83%|████████▎ | 810/981 [00:38<00:06, 25.88it/s] 83%|████████▎ | 813/981 [00:38<00:06, 25.95it/s] 83%|████████▎ | 816/981 [00:38<00:06, 26.15it/s] 83%|████████▎ | 819/981 [00:38<00:06, 26.36it/s] 84%|████████▍ | 822/981 [00:38<00:06, 26.45it/s] 84%|████████▍ | 825/981 [00:38<00:05, 26.39it/s] 84%|████████▍ | 828/981 [00:39<00:05, 26.53it/s] 85%|████████▍ | 831/981 [00:39<00:05, 26.52it/s] 85%|████████▌ | 834/981 [00:39<00:05, 26.34it/s] 85%|████████▌ | 837/981 [00:39<00:05, 26.52it/s] 86%|████████▌ | 840/981 [00:39<00:05, 26.46it/s] 86%|████████▌ | 843/981 [00:39<00:05, 26.34it/s] 86%|████████▌ | 846/981 [00:39<00:05, 26.33it/s] 87%|████████▋ | 849/981 [00:39<00:05, 26.27it/s] 87%|████████▋ | 852/981 [00:39<00:04, 26.03it/s] 87%|████████▋ | 855/981 [00:40<00:04, 25.96it/s] 87%|████████▋ | 858/981 [00:40<00:04, 26.11it/s] 88%|████████▊ | 861/981 [00:40<00:04, 26.23it/s] 88%|████████▊ | 864/981 [00:40<00:04, 26.21it/s] 88%|████████▊ | 867/981 [00:40<00:04, 26.40it/s] 89%|████████▊ | 870/981 [00:40<00:04, 26.30it/s] 89%|████████▉ | 873/981 [00:40<00:04, 25.94it/s] 89%|████████▉ | 876/981 [00:40<00:04, 26.03it/s] 90%|████████▉ | 879/981 [00:40<00:03, 26.07it/s] 90%|████████▉ | 882/981 [00:41<00:03, 25.73it/s] 90%|█████████ | 885/981 [00:41<00:03, 25.72it/s] 91%|█████████ | 888/981 [00:41<00:03, 25.73it/s] 91%|█████████ | 891/981 [00:41<00:03, 25.47it/s] 91%|█████████ | 894/981 [00:41<00:03, 25.54it/s] 91%|█████████▏| 897/981 [00:41<00:03, 25.72it/s] 92%|█████████▏| 900/981 [00:41<00:03, 25.65it/s] 92%|█████████▏| 903/981 [00:41<00:03, 25.78it/s] 92%|█████████▏| 906/981 [00:42<00:02, 25.87it/s] 93%|█████████▎| 909/981 [00:42<00:02, 25.29it/s] 93%|█████████▎| 912/981 [00:42<00:02, 25.64it/s] 93%|█████████▎| 915/981 [00:42<00:02, 25.99it/s] 94%|█████████▎| 918/981 [00:42<00:02, 26.06it/s] 94%|█████████▍| 921/981 [00:42<00:02, 26.05it/s] 94%|█████████▍| 924/981 [00:42<00:02, 26.26it/s] 94%|█████████▍| 927/981 [00:42<00:02, 26.32it/s] 95%|█████████▍| 930/981 [00:42<00:01, 25.61it/s] 95%|█████████▌| 933/981 [00:43<00:01, 25.74it/s] 95%|█████████▌| 936/981 [00:43<00:01, 25.88it/s] 96%|█████████▌| 939/981 [00:43<00:01, 25.41it/s] 96%|█████████▌| 942/981 [00:43<00:01, 25.71it/s] 96%|█████████▋| 945/981 [00:43<00:01, 23.53it/s] 97%|█████████▋| 948/981 [00:43<00:01, 22.45it/s] 97%|█████████▋| 951/981 [00:43<00:01, 22.76it/s] 97%|█████████▋| 954/981 [00:43<00:01, 23.11it/s] 98%|█████████▊| 957/981 [00:44<00:01, 23.88it/s] 98%|█████████▊| 960/981 [00:44<00:00, 24.46it/s] 98%|█████████▊| 963/981 [00:44<00:00, 24.89it/s] 98%|█████████▊| 966/981 [00:44<00:00, 24.23it/s] 99%|█████████▉| 969/981 [00:44<00:00, 24.65it/s] 99%|█████████▉| 972/981 [00:44<00:00, 25.14it/s] 99%|█████████▉| 975/981 [00:44<00:00, 25.40it/s]100%|█████████▉| 978/981 [00:44<00:00, 25.77it/s]100%|██████████| 981/981 [00:45<00:00, 26.04it/s]100%|██████████| 981/981 [00:45<00:00, 21.78it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.058, valid loss : 0.046, train acc : 0.983, valid acc : 0.972, train f1 : 0.581, valid f1 : 0.701
training process:   2%|▏         | 1/50 [08:06<6:36:57, 486.06s/it]training process:   4%|▍         | 2/50 [16:01<6:23:42, 479.64s/it]training process:   6%|▌         | 3/50 [23:55<6:13:52, 477.29s/it]training process:   8%|▊         | 4/50 [31:56<6:07:01, 478.73s/it]epoch : 5, train loss : 0.065, valid loss : 0.068, train acc : 0.983, valid acc : 0.982, train f1 : 0.496, valid f1 : 0.495
training process:  10%|█         | 5/50 [39:45<5:56:28, 475.30s/it]training process:  12%|█▏        | 6/50 [47:33<5:46:38, 472.70s/it]training process:  14%|█▍        | 7/50 [55:31<5:39:58, 474.39s/it]training process:  16%|█▌        | 8/50 [1:03:27<5:32:23, 474.84s/it]epoch : 9, train loss : 0.047, valid loss : 0.036, train acc : 0.986, valid acc : 0.979, train f1 : 0.693, valid f1 : 0.745
training process:  18%|█▊        | 9/50 [1:11:19<5:23:53, 473.98s/it]training process:  20%|██        | 10/50 [1:19:10<5:15:30, 473.26s/it]training process:  22%|██▏       | 11/50 [1:27:00<5:06:51, 472.08s/it]training process:  24%|██▍       | 12/50 [1:34:49<4:58:25, 471.19s/it]epoch : 13, train loss : 0.040, valid loss : 0.038, train acc : 0.989, valid acc : 0.986, train f1 : 0.778, valid f1 : 0.785
training process:  26%|██▌       | 13/50 [1:42:38<4:50:09, 470.51s/it]training process:  28%|██▊       | 14/50 [1:50:27<4:42:00, 470.01s/it]training process:  30%|███       | 15/50 [1:58:19<4:34:33, 470.67s/it]training process:  32%|███▏      | 16/50 [2:06:09<4:26:32, 470.38s/it]epoch : 17, train loss : 0.040, valid loss : 0.042, train acc : 0.988, valid acc : 0.989, train f1 : 0.766, valid f1 : 0.799
training process:  34%|███▍      | 17/50 [2:14:00<4:18:55, 470.77s/it]training process:  36%|███▌      | 18/50 [2:21:52<4:11:16, 471.14s/it]training process:  38%|███▊      | 19/50 [2:29:43<4:03:18, 470.93s/it]training process:  40%|████      | 20/50 [2:37:32<3:55:13, 470.44s/it]epoch : 21, train loss : 0.044, valid loss : 0.038, train acc : 0.987, valid acc : 0.989, train f1 : 0.716, valid f1 : 0.812
training process:  42%|████▏     | 21/50 [2:45:21<3:47:09, 469.99s/it]training process:  44%|████▍     | 22/50 [2:53:10<3:39:13, 469.77s/it]training process:  46%|████▌     | 23/50 [3:01:02<3:31:35, 470.21s/it]training process:  48%|████▊     | 24/50 [3:08:52<3:23:46, 470.25s/it]epoch : 25, train loss : 0.041, valid loss : 0.034, train acc : 0.989, valid acc : 0.990, train f1 : 0.773, valid f1 : 0.816
training process:  50%|█████     | 25/50 [3:16:40<3:15:39, 469.58s/it]training process:  52%|█████▏    | 26/50 [3:24:36<3:08:33, 471.40s/it]training process:  54%|█████▍    | 27/50 [3:32:22<3:00:07, 469.90s/it]training process:  56%|█████▌    | 28/50 [3:40:13<2:52:25, 470.27s/it]epoch : 29, train loss : 0.039, valid loss : 0.035, train acc : 0.989, valid acc : 0.991, train f1 : 0.771, valid f1 : 0.831
training process:  58%|█████▊    | 29/50 [3:48:01<2:44:20, 469.54s/it]training process:  60%|██████    | 30/50 [3:55:52<2:36:40, 470.02s/it]training process:  62%|██████▏   | 31/50 [4:03:42<2:28:48, 469.94s/it]training process:  64%|██████▍   | 32/50 [4:11:32<2:21:00, 470.00s/it]epoch : 33, train loss : 0.037, valid loss : 0.039, train acc : 0.988, valid acc : 0.990, train f1 : 0.777, valid f1 : 0.815
training process:  66%|██████▌   | 33/50 [4:19:22<2:13:09, 469.98s/it]training process:  68%|██████▊   | 34/50 [4:27:14<2:05:29, 470.58s/it]training process:  70%|███████   | 35/50 [4:35:00<1:57:16, 469.13s/it]training process:  72%|███████▏  | 36/50 [4:42:45<1:49:11, 467.95s/it]epoch : 37, train loss : 0.039, valid loss : 0.040, train acc : 0.989, valid acc : 0.990, train f1 : 0.769, valid f1 : 0.802
training process:  74%|███████▍  | 37/50 [4:50:32<1:41:21, 467.84s/it]training process:  76%|███████▌  | 38/50 [4:58:26<1:33:53, 469.48s/it]training process:  78%|███████▊  | 39/50 [5:06:17<1:26:09, 469.96s/it]training process:  80%|████████  | 40/50 [5:14:06<1:18:16, 469.67s/it]epoch : 41, train loss : 0.038, valid loss : 0.041, train acc : 0.990, valid acc : 0.989, train f1 : 0.788, valid f1 : 0.794
training process:  82%|████████▏ | 41/50 [5:21:58<1:10:32, 470.33s/it]training process:  84%|████████▍ | 42/50 [5:29:47<1:02:40, 470.07s/it]training process:  86%|████████▌ | 43/50 [5:37:37<54:49, 469.89s/it]  training process:  88%|████████▊ | 44/50 [5:45:25<46:57, 469.58s/it]epoch : 45, train loss : 0.037, valid loss : 0.036, train acc : 0.990, valid acc : 0.989, train f1 : 0.796, valid f1 : 0.799
training process:  90%|█████████ | 45/50 [5:53:15<39:07, 469.59s/it]training process:  92%|█████████▏| 46/50 [6:01:09<31:23, 470.81s/it]training process:  94%|█████████▍| 47/50 [6:08:58<23:31, 470.46s/it]training process:  96%|█████████▌| 48/50 [6:16:47<15:39, 469.80s/it]epoch : 49, train loss : 0.034, valid loss : 0.034, train acc : 0.990, valid acc : 0.991, train f1 : 0.808, valid f1 : 0.842
training process:  98%|█████████▊| 49/50 [6:24:34<07:49, 469.17s/it]training process: 100%|██████████| 50/50 [6:32:23<00:00, 468.94s/it]training process: 100%|██████████| 50/50 [6:32:23<00:00, 470.86s/it]
training process finished, best loss : 0.034 and best acc : 0.991, best f1 : 0.842, best epoch : 48

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.54      0.51      0.52        71
           1       0.99      0.99      0.99      3812

    accuracy                           0.98      3883
   macro avg       0.76      0.75      0.76      3883
weighted avg       0.98      0.98      0.98      3883


# test acc : 0.98, test f1 : 0.76, test AUC : 0.75, test loss : 0.330

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:42, 22.83it/s]  1%|          | 6/981 [00:00<00:43, 22.50it/s]  1%|          | 9/981 [00:00<00:44, 21.74it/s]  1%|          | 12/981 [00:00<00:44, 21.69it/s]  2%|▏         | 15/981 [00:00<00:44, 21.68it/s]  2%|▏         | 18/981 [00:00<00:44, 21.53it/s]  2%|▏         | 21/981 [00:00<00:43, 21.85it/s]  2%|▏         | 24/981 [00:01<00:44, 21.60it/s]  3%|▎         | 27/981 [00:01<00:44, 21.64it/s]  3%|▎         | 30/981 [00:01<00:43, 21.81it/s]  3%|▎         | 33/981 [00:01<00:43, 21.63it/s]  4%|▎         | 36/981 [00:01<00:43, 21.52it/s]  4%|▍         | 39/981 [00:01<00:43, 21.46it/s]  4%|▍         | 42/981 [00:01<00:43, 21.39it/s]  5%|▍         | 45/981 [00:02<00:43, 21.50it/s]  5%|▍         | 48/981 [00:02<00:43, 21.47it/s]  5%|▌         | 51/981 [00:02<00:42, 21.70it/s]  6%|▌         | 54/981 [00:02<00:42, 21.64it/s]  6%|▌         | 57/981 [00:02<00:43, 21.48it/s]  6%|▌         | 60/981 [00:02<00:42, 21.61it/s]  6%|▋         | 63/981 [00:02<00:42, 21.46it/s]  7%|▋         | 66/981 [00:03<00:42, 21.61it/s]  7%|▋         | 69/981 [00:03<00:41, 21.75it/s]  7%|▋         | 72/981 [00:03<00:42, 21.56it/s]  8%|▊         | 75/981 [00:03<00:41, 21.58it/s]  8%|▊         | 78/981 [00:03<00:42, 21.34it/s]  8%|▊         | 81/981 [00:03<00:42, 21.24it/s]  9%|▊         | 84/981 [00:03<00:42, 21.19it/s]  9%|▉         | 87/981 [00:04<00:42, 21.13it/s]  9%|▉         | 90/981 [00:04<00:41, 21.29it/s]  9%|▉         | 93/981 [00:04<00:42, 21.06it/s] 10%|▉         | 96/981 [00:04<00:41, 21.31it/s] 10%|█         | 99/981 [00:04<00:40, 21.61it/s] 10%|█         | 102/981 [00:04<00:41, 21.43it/s] 11%|█         | 105/981 [00:04<00:40, 21.55it/s] 11%|█         | 108/981 [00:05<00:40, 21.43it/s] 11%|█▏        | 111/981 [00:05<00:40, 21.36it/s] 12%|█▏        | 114/981 [00:05<00:40, 21.26it/s] 12%|█▏        | 117/981 [00:05<00:40, 21.13it/s] 12%|█▏        | 120/981 [00:05<00:40, 21.33it/s] 13%|█▎        | 123/981 [00:05<00:40, 21.13it/s] 13%|█▎        | 126/981 [00:05<00:40, 21.12it/s] 13%|█▎        | 129/981 [00:06<00:40, 21.20it/s] 13%|█▎        | 132/981 [00:06<00:40, 21.16it/s] 14%|█▍        | 135/981 [00:06<00:39, 21.30it/s] 14%|█▍        | 138/981 [00:06<00:39, 21.36it/s] 14%|█▍        | 141/981 [00:06<00:39, 21.30it/s] 15%|█▍        | 144/981 [00:06<00:39, 21.35it/s] 15%|█▍        | 147/981 [00:06<00:39, 21.32it/s] 15%|█▌        | 150/981 [00:06<00:38, 21.51it/s] 16%|█▌        | 153/981 [00:07<00:38, 21.65it/s] 16%|█▌        | 156/981 [00:07<00:38, 21.55it/s] 16%|█▌        | 159/981 [00:07<00:38, 21.59it/s] 17%|█▋        | 162/981 [00:07<00:37, 21.68it/s] 17%|█▋        | 165/981 [00:07<00:38, 21.46it/s] 17%|█▋        | 168/981 [00:07<00:37, 21.45it/s] 17%|█▋        | 171/981 [00:07<00:38, 21.18it/s] 18%|█▊        | 174/981 [00:08<00:38, 20.71it/s] 18%|█▊        | 177/981 [00:08<00:38, 21.02it/s] 18%|█▊        | 180/981 [00:08<00:37, 21.10it/s] 19%|█▊        | 183/981 [00:08<00:37, 21.32it/s] 19%|█▉        | 186/981 [00:08<00:37, 21.28it/s] 19%|█▉        | 189/981 [00:08<00:36, 21.44it/s] 20%|█▉        | 192/981 [00:08<00:36, 21.59it/s] 20%|█▉        | 195/981 [00:09<00:36, 21.35it/s] 20%|██        | 198/981 [00:09<00:36, 21.27it/s] 20%|██        | 201/981 [00:09<00:37, 21.04it/s] 21%|██        | 204/981 [00:09<00:36, 21.07it/s] 21%|██        | 207/981 [00:09<00:36, 21.06it/s] 21%|██▏       | 210/981 [00:09<00:36, 20.86it/s] 22%|██▏       | 213/981 [00:09<00:36, 21.02it/s] 22%|██▏       | 216/981 [00:10<00:36, 20.81it/s] 22%|██▏       | 219/981 [00:10<00:36, 20.86it/s] 23%|██▎       | 222/981 [00:10<00:36, 20.86it/s] 23%|██▎       | 225/981 [00:10<00:36, 20.73it/s] 23%|██▎       | 228/981 [00:10<00:36, 20.89it/s] 24%|██▎       | 231/981 [00:10<00:36, 20.80it/s] 24%|██▍       | 234/981 [00:10<00:35, 20.89it/s] 24%|██▍       | 237/981 [00:11<00:35, 20.99it/s] 24%|██▍       | 240/981 [00:11<00:35, 20.95it/s] 25%|██▍       | 243/981 [00:11<00:35, 20.98it/s] 25%|██▌       | 246/981 [00:11<00:35, 20.87it/s] 25%|██▌       | 249/981 [00:11<00:34, 20.94it/s] 26%|██▌       | 252/981 [00:11<00:34, 21.13it/s] 26%|██▌       | 255/981 [00:11<00:34, 21.16it/s] 26%|██▋       | 258/981 [00:12<00:33, 21.45it/s] 27%|██▋       | 261/981 [00:12<00:33, 21.29it/s] 27%|██▋       | 264/981 [00:12<00:33, 21.43it/s] 27%|██▋       | 267/981 [00:12<00:33, 21.48it/s] 28%|██▊       | 270/981 [00:12<00:33, 21.34it/s] 28%|██▊       | 273/981 [00:12<00:33, 21.31it/s] 28%|██▊       | 276/981 [00:12<00:33, 21.12it/s] 28%|██▊       | 279/981 [00:13<00:32, 21.29it/s] 29%|██▊       | 282/981 [00:13<00:33, 21.16it/s] 29%|██▉       | 285/981 [00:13<00:32, 21.35it/s] 29%|██▉       | 288/981 [00:13<00:32, 21.44it/s] 30%|██▉       | 291/981 [00:13<00:32, 21.36it/s] 30%|██▉       | 294/981 [00:13<00:32, 21.42it/s] 30%|███       | 297/981 [00:13<00:31, 21.38it/s] 31%|███       | 300/981 [00:14<00:31, 21.33it/s] 31%|███       | 303/981 [00:14<00:31, 21.50it/s] 31%|███       | 306/981 [00:14<00:31, 21.40it/s] 31%|███▏      | 309/981 [00:14<00:31, 21.51it/s] 32%|███▏      | 312/981 [00:14<00:31, 21.55it/s] 32%|███▏      | 315/981 [00:14<00:31, 21.23it/s] 32%|███▏      | 318/981 [00:14<00:30, 21.39it/s] 33%|███▎      | 321/981 [00:15<00:30, 21.32it/s] 33%|███▎      | 324/981 [00:15<00:31, 21.00it/s] 33%|███▎      | 327/981 [00:15<00:31, 20.88it/s] 34%|███▎      | 330/981 [00:15<00:31, 20.71it/s] 34%|███▍      | 333/981 [00:15<00:30, 20.94it/s] 34%|███▍      | 336/981 [00:15<00:30, 21.10it/s] 35%|███▍      | 339/981 [00:15<00:30, 21.07it/s] 35%|███▍      | 342/981 [00:16<00:30, 21.26it/s] 35%|███▌      | 345/981 [00:16<00:30, 21.20it/s] 35%|███▌      | 348/981 [00:16<00:30, 21.04it/s] 36%|███▌      | 351/981 [00:16<00:29, 21.09it/s] 36%|███▌      | 354/981 [00:16<00:29, 20.90it/s] 36%|███▋      | 357/981 [00:16<00:29, 21.08it/s] 37%|███▋      | 360/981 [00:16<00:30, 20.49it/s] 37%|███▋      | 363/981 [00:17<00:30, 20.38it/s] 37%|███▋      | 366/981 [00:17<00:29, 20.74it/s] 38%|███▊      | 369/981 [00:17<00:29, 20.74it/s] 38%|███▊      | 372/981 [00:17<00:29, 20.99it/s] 38%|███▊      | 375/981 [00:17<00:28, 20.95it/s] 39%|███▊      | 378/981 [00:17<00:28, 21.13it/s] 39%|███▉      | 381/981 [00:17<00:28, 21.19it/s] 39%|███▉      | 384/981 [00:18<00:28, 21.15it/s] 39%|███▉      | 387/981 [00:18<00:27, 21.34it/s] 40%|███▉      | 390/981 [00:18<00:27, 21.20it/s] 40%|████      | 393/981 [00:18<00:27, 21.28it/s] 40%|████      | 396/981 [00:18<00:27, 21.34it/s] 41%|████      | 399/981 [00:18<00:27, 21.26it/s] 41%|████      | 402/981 [00:18<00:27, 21.38it/s] 41%|████▏     | 405/981 [00:19<00:27, 21.27it/s] 42%|████▏     | 408/981 [00:19<00:27, 21.22it/s] 42%|████▏     | 411/981 [00:19<00:26, 21.28it/s] 42%|████▏     | 414/981 [00:19<00:26, 21.15it/s] 43%|████▎     | 417/981 [00:19<00:26, 21.26it/s] 43%|████▎     | 420/981 [00:19<00:26, 21.31it/s] 43%|████▎     | 423/981 [00:19<00:26, 21.27it/s] 43%|████▎     | 426/981 [00:20<00:26, 21.27it/s] 44%|████▎     | 429/981 [00:20<00:26, 21.08it/s] 44%|████▍     | 432/981 [00:20<00:25, 21.15it/s] 44%|████▍     | 435/981 [00:20<00:25, 21.29it/s] 45%|████▍     | 438/981 [00:20<00:25, 21.36it/s] 45%|████▍     | 441/981 [00:20<00:25, 21.41it/s] 45%|████▌     | 444/981 [00:20<00:25, 21.32it/s] 46%|████▌     | 447/981 [00:21<00:25, 21.33it/s] 46%|████▌     | 450/981 [00:21<00:24, 21.41it/s] 46%|████▌     | 453/981 [00:21<00:24, 21.31it/s] 46%|████▋     | 456/981 [00:21<00:24, 21.35it/s] 47%|████▋     | 459/981 [00:21<00:24, 21.34it/s] 47%|████▋     | 462/981 [00:21<00:24, 21.51it/s] 47%|████▋     | 465/981 [00:21<00:23, 21.57it/s] 48%|████▊     | 468/981 [00:21<00:23, 21.52it/s] 48%|████▊     | 471/981 [00:22<00:23, 21.56it/s] 48%|████▊     | 474/981 [00:22<00:23, 21.42it/s] 49%|████▊     | 477/981 [00:22<00:23, 21.57it/s] 49%|████▉     | 480/981 [00:22<00:23, 21.60it/s] 49%|████▉     | 483/981 [00:22<00:23, 21.40it/s] 50%|████▉     | 486/981 [00:22<00:22, 21.57it/s] 50%|████▉     | 489/981 [00:22<00:22, 21.49it/s] 50%|█████     | 492/981 [00:23<00:22, 21.52it/s] 50%|█████     | 495/981 [00:23<00:22, 21.59it/s] 51%|█████     | 498/981 [00:23<00:22, 21.55it/s] 51%|█████     | 501/981 [00:23<00:22, 21.56it/s] 51%|█████▏    | 504/981 [00:23<00:22, 21.56it/s] 52%|█████▏    | 507/981 [00:23<00:22, 21.32it/s] 52%|█████▏    | 510/981 [00:23<00:22, 21.12it/s] 52%|█████▏    | 513/981 [00:24<00:22, 20.95it/s] 53%|█████▎    | 516/981 [00:24<00:22, 21.12it/s] 53%|█████▎    | 519/981 [00:24<00:21, 21.34it/s] 53%|█████▎    | 522/981 [00:24<00:21, 21.52it/s] 54%|█████▎    | 525/981 [00:24<00:21, 21.54it/s] 54%|█████▍    | 528/981 [00:24<00:20, 21.66it/s] 54%|█████▍    | 531/981 [00:24<00:20, 21.79it/s] 54%|█████▍    | 534/981 [00:25<00:20, 21.87it/s] 55%|█████▍    | 537/981 [00:25<00:20, 21.81it/s] 55%|█████▌    | 540/981 [00:25<00:20, 21.93it/s] 55%|█████▌    | 543/981 [00:25<00:19, 21.98it/s] 56%|█████▌    | 546/981 [00:25<00:19, 21.90it/s] 56%|█████▌    | 549/981 [00:25<00:19, 21.94it/s] 56%|█████▋    | 552/981 [00:25<00:19, 21.96it/s] 57%|█████▋    | 555/981 [00:26<00:19, 21.93it/s] 57%|█████▋    | 558/981 [00:26<00:19, 22.11it/s] 57%|█████▋    | 561/981 [00:26<00:19, 21.95it/s] 57%|█████▋    | 564/981 [00:26<00:18, 22.06it/s] 58%|█████▊    | 567/981 [00:26<00:18, 22.11it/s] 58%|█████▊    | 570/981 [00:26<00:18, 22.11it/s] 58%|█████▊    | 573/981 [00:26<00:18, 22.19it/s] 59%|█████▊    | 576/981 [00:26<00:18, 22.09it/s] 59%|█████▉    | 579/981 [00:27<00:18, 22.12it/s] 59%|█████▉    | 582/981 [00:27<00:18, 22.08it/s] 60%|█████▉    | 585/981 [00:27<00:17, 22.03it/s] 60%|█████▉    | 588/981 [00:27<00:17, 21.97it/s] 60%|██████    | 591/981 [00:27<00:17, 22.03it/s] 61%|██████    | 594/981 [00:27<00:17, 21.96it/s] 61%|██████    | 597/981 [00:27<00:17, 21.94it/s] 61%|██████    | 600/981 [00:28<00:17, 21.86it/s] 61%|██████▏   | 603/981 [00:28<00:17, 21.85it/s] 62%|██████▏   | 606/981 [00:28<00:17, 21.93it/s] 62%|██████▏   | 609/981 [00:28<00:16, 21.90it/s] 62%|██████▏   | 612/981 [00:28<00:16, 22.17it/s] 63%|██████▎   | 615/981 [00:28<00:16, 22.20it/s] 63%|██████▎   | 618/981 [00:28<00:16, 22.08it/s] 63%|██████▎   | 621/981 [00:29<00:16, 22.18it/s] 64%|██████▎   | 624/981 [00:29<00:16, 21.73it/s] 64%|██████▍   | 627/981 [00:29<00:16, 21.81it/s] 64%|██████▍   | 630/981 [00:29<00:16, 21.30it/s] 65%|██████▍   | 633/981 [00:29<00:16, 21.61it/s] 65%|██████▍   | 636/981 [00:29<00:15, 21.90it/s] 65%|██████▌   | 639/981 [00:29<00:15, 21.60it/s] 65%|██████▌   | 642/981 [00:29<00:15, 21.70it/s] 66%|██████▌   | 645/981 [00:30<00:15, 22.02it/s] 66%|██████▌   | 648/981 [00:30<00:15, 22.02it/s] 66%|██████▋   | 651/981 [00:30<00:14, 22.09it/s] 67%|██████▋   | 654/981 [00:30<00:14, 21.89it/s] 67%|██████▋   | 657/981 [00:30<00:14, 22.22it/s] 67%|██████▋   | 660/981 [00:30<00:14, 22.13it/s] 68%|██████▊   | 663/981 [00:30<00:14, 22.25it/s] 68%|██████▊   | 666/981 [00:31<00:14, 22.27it/s] 68%|██████▊   | 669/981 [00:31<00:14, 22.07it/s] 69%|██████▊   | 672/981 [00:31<00:14, 21.94it/s] 69%|██████▉   | 675/981 [00:31<00:14, 21.73it/s] 69%|██████▉   | 678/981 [00:31<00:14, 21.51it/s] 69%|██████▉   | 681/981 [00:31<00:13, 21.57it/s] 70%|██████▉   | 684/981 [00:31<00:13, 21.51it/s] 70%|███████   | 687/981 [00:32<00:13, 21.63it/s] 70%|███████   | 690/981 [00:32<00:13, 21.67it/s] 71%|███████   | 693/981 [00:32<00:13, 21.79it/s] 71%|███████   | 696/981 [00:32<00:12, 21.97it/s] 71%|███████▏  | 699/981 [00:32<00:12, 22.00it/s] 72%|███████▏  | 702/981 [00:32<00:12, 22.08it/s] 72%|███████▏  | 705/981 [00:32<00:12, 22.12it/s] 72%|███████▏  | 708/981 [00:32<00:12, 22.04it/s] 72%|███████▏  | 711/981 [00:33<00:12, 22.12it/s] 73%|███████▎  | 714/981 [00:33<00:12, 22.21it/s] 73%|███████▎  | 717/981 [00:33<00:11, 22.27it/s] 73%|███████▎  | 720/981 [00:33<00:11, 22.36it/s] 74%|███████▎  | 723/981 [00:33<00:11, 22.01it/s] 74%|███████▍  | 726/981 [00:33<00:11, 22.00it/s] 74%|███████▍  | 729/981 [00:33<00:11, 22.07it/s] 75%|███████▍  | 732/981 [00:34<00:11, 21.67it/s] 75%|███████▍  | 735/981 [00:34<00:11, 21.77it/s] 75%|███████▌  | 738/981 [00:34<00:11, 21.94it/s] 76%|███████▌  | 741/981 [00:34<00:10, 21.84it/s] 76%|███████▌  | 744/981 [00:34<00:10, 21.87it/s] 76%|███████▌  | 747/981 [00:34<00:10, 21.79it/s] 76%|███████▋  | 750/981 [00:34<00:10, 21.69it/s] 77%|███████▋  | 753/981 [00:35<00:10, 21.67it/s] 77%|███████▋  | 756/981 [00:35<00:10, 21.41it/s] 77%|███████▋  | 759/981 [00:35<00:10, 21.44it/s] 78%|███████▊  | 762/981 [00:35<00:10, 21.48it/s] 78%|███████▊  | 765/981 [00:35<00:10, 21.37it/s] 78%|███████▊  | 768/981 [00:35<00:09, 21.49it/s] 79%|███████▊  | 771/981 [00:35<00:09, 21.42it/s] 79%|███████▉  | 774/981 [00:36<00:09, 21.50it/s] 79%|███████▉  | 777/981 [00:36<00:09, 21.60it/s] 80%|███████▉  | 780/981 [00:36<00:09, 21.65it/s] 80%|███████▉  | 783/981 [00:36<00:09, 21.99it/s] 80%|████████  | 786/981 [00:36<00:08, 22.49it/s] 80%|████████  | 789/981 [00:36<00:08, 22.97it/s] 81%|████████  | 792/981 [00:36<00:08, 23.47it/s] 81%|████████  | 795/981 [00:36<00:07, 23.93it/s] 81%|████████▏ | 798/981 [00:37<00:07, 24.15it/s] 82%|████████▏ | 801/981 [00:37<00:07, 24.69it/s] 82%|████████▏ | 804/981 [00:37<00:07, 25.00it/s] 82%|████████▏ | 807/981 [00:37<00:06, 25.17it/s] 83%|████████▎ | 810/981 [00:37<00:06, 25.56it/s] 83%|████████▎ | 813/981 [00:37<00:06, 25.76it/s] 83%|████████▎ | 816/981 [00:37<00:06, 25.66it/s] 83%|████████▎ | 819/981 [00:37<00:06, 25.73it/s] 84%|████████▍ | 822/981 [00:37<00:06, 25.85it/s] 84%|████████▍ | 825/981 [00:38<00:06, 25.89it/s] 84%|████████▍ | 828/981 [00:38<00:05, 25.99it/s] 85%|████████▍ | 831/981 [00:38<00:05, 25.95it/s] 85%|████████▌ | 834/981 [00:38<00:05, 25.07it/s] 85%|████████▌ | 837/981 [00:38<00:05, 25.24it/s] 86%|████████▌ | 840/981 [00:38<00:05, 24.75it/s] 86%|████████▌ | 843/981 [00:38<00:05, 24.34it/s] 86%|████████▌ | 846/981 [00:38<00:05, 24.66it/s] 87%|████████▋ | 849/981 [00:39<00:05, 25.13it/s] 87%|████████▋ | 852/981 [00:39<00:05, 25.23it/s] 87%|████████▋ | 855/981 [00:39<00:05, 24.84it/s] 87%|████████▋ | 858/981 [00:39<00:04, 25.33it/s] 88%|████████▊ | 861/981 [00:39<00:05, 23.57it/s] 88%|████████▊ | 864/981 [00:39<00:04, 24.38it/s] 88%|████████▊ | 867/981 [00:39<00:04, 24.98it/s] 89%|████████▊ | 870/981 [00:39<00:04, 25.34it/s] 89%|████████▉ | 873/981 [00:40<00:04, 24.63it/s] 89%|████████▉ | 876/981 [00:40<00:04, 25.17it/s] 90%|████████▉ | 879/981 [00:40<00:03, 25.59it/s] 90%|████████▉ | 882/981 [00:40<00:03, 25.45it/s] 90%|█████████ | 885/981 [00:40<00:03, 25.78it/s] 91%|█████████ | 888/981 [00:40<00:03, 25.90it/s] 91%|█████████ | 891/981 [00:40<00:03, 25.85it/s] 91%|█████████ | 894/981 [00:40<00:03, 25.92it/s] 91%|█████████▏| 897/981 [00:40<00:03, 26.07it/s] 92%|█████████▏| 900/981 [00:41<00:03, 26.03it/s] 92%|█████████▏| 903/981 [00:41<00:02, 26.08it/s] 92%|█████████▏| 906/981 [00:41<00:02, 26.13it/s] 93%|█████████▎| 909/981 [00:41<00:02, 26.12it/s] 93%|█████████▎| 912/981 [00:41<00:02, 26.10it/s] 93%|█████████▎| 915/981 [00:41<00:02, 26.24it/s] 94%|█████████▎| 918/981 [00:41<00:02, 26.36it/s] 94%|█████████▍| 921/981 [00:41<00:02, 26.10it/s] 94%|█████████▍| 924/981 [00:41<00:02, 26.25it/s] 94%|█████████▍| 927/981 [00:42<00:02, 26.34it/s] 95%|█████████▍| 930/981 [00:42<00:01, 26.09it/s] 95%|█████████▌| 933/981 [00:42<00:01, 26.16it/s] 95%|█████████▌| 936/981 [00:42<00:01, 26.15it/s] 96%|█████████▌| 939/981 [00:42<00:01, 26.05it/s] 96%|█████████▌| 942/981 [00:42<00:01, 25.95it/s] 96%|█████████▋| 945/981 [00:42<00:01, 25.81it/s] 97%|█████████▋| 948/981 [00:42<00:01, 25.98it/s] 97%|█████████▋| 951/981 [00:43<00:01, 25.71it/s] 97%|█████████▋| 954/981 [00:43<00:01, 25.14it/s] 98%|█████████▊| 957/981 [00:43<00:00, 25.57it/s] 98%|█████████▊| 960/981 [00:43<00:00, 24.80it/s] 98%|█████████▊| 963/981 [00:43<00:00, 25.33it/s] 98%|█████████▊| 966/981 [00:43<00:00, 25.76it/s] 99%|█████████▉| 969/981 [00:43<00:00, 25.74it/s] 99%|█████████▉| 972/981 [00:43<00:00, 25.95it/s] 99%|█████████▉| 975/981 [00:43<00:00, 26.19it/s]100%|█████████▉| 978/981 [00:44<00:00, 26.16it/s]100%|██████████| 981/981 [00:44<00:00, 26.23it/s]100%|██████████| 981/981 [00:44<00:00, 22.20it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.266, train acc : 0.512, valid acc : 0.018, train f1 : 0.348, valid f1 : 0.018
training process:   2%|▏         | 1/50 [08:05<6:36:53, 485.99s/it]training process:   4%|▍         | 2/50 [16:00<6:23:21, 479.19s/it]training process:   6%|▌         | 3/50 [23:53<6:13:04, 476.27s/it]training process:   8%|▊         | 4/50 [31:46<6:04:08, 474.96s/it]epoch : 5, train loss : 0.007, valid loss : 0.111, train acc : 0.754, valid acc : 0.663, train f1 : 0.738, valid f1 : 0.446
training process:  10%|█         | 5/50 [39:41<5:56:24, 475.22s/it]training process:  12%|█▏        | 6/50 [47:35<5:47:59, 474.53s/it]training process:  14%|█▍        | 7/50 [55:23<5:38:36, 472.47s/it]training process:  16%|█▌        | 8/50 [1:03:06<5:28:42, 469.58s/it]epoch : 9, train loss : 0.007, valid loss : 0.111, train acc : 0.792, valid acc : 0.667, train f1 : 0.784, valid f1 : 0.447
training process:  18%|█▊        | 9/50 [1:10:55<5:20:40, 469.28s/it]training process:  20%|██        | 10/50 [1:18:40<5:12:05, 468.15s/it]training process:  22%|██▏       | 11/50 [1:26:31<5:04:43, 468.80s/it]training process:  24%|██▍       | 12/50 [1:34:23<4:57:39, 469.99s/it]epoch : 13, train loss : 0.006, valid loss : 0.081, train acc : 0.805, valid acc : 0.811, train f1 : 0.797, valid f1 : 0.525
training process:  26%|██▌       | 13/50 [1:42:13<4:49:41, 469.78s/it]training process:  28%|██▊       | 14/50 [1:50:00<4:41:21, 468.93s/it]training process:  30%|███       | 15/50 [1:57:47<4:33:19, 468.54s/it]training process:  32%|███▏      | 16/50 [2:05:39<4:25:57, 469.35s/it]epoch : 17, train loss : 0.006, valid loss : 0.061, train acc : 0.793, valid acc : 0.866, train f1 : 0.784, valid f1 : 0.568
training process:  34%|███▍      | 17/50 [2:13:25<4:17:41, 468.53s/it]training process:  36%|███▌      | 18/50 [2:21:14<4:09:53, 468.53s/it]training process:  38%|███▊      | 19/50 [2:29:02<4:02:04, 468.53s/it]training process:  40%|████      | 20/50 [2:36:51<3:54:17, 468.59s/it]epoch : 21, train loss : 0.006, valid loss : 0.070, train acc : 0.832, valid acc : 0.825, train f1 : 0.828, valid f1 : 0.535
training process:  42%|████▏     | 21/50 [2:44:42<3:46:54, 469.47s/it]training process:  44%|████▍     | 22/50 [2:52:34<3:39:21, 470.05s/it]training process:  46%|████▌     | 23/50 [3:00:25<3:31:37, 470.28s/it]training process:  48%|████▊     | 24/50 [3:08:16<3:23:58, 470.71s/it]epoch : 25, train loss : 0.005, valid loss : 0.065, train acc : 0.845, valid acc : 0.811, train f1 : 0.841, valid f1 : 0.524
training process:  50%|█████     | 25/50 [3:16:10<3:16:32, 471.69s/it]training process:  52%|█████▏    | 26/50 [3:23:59<3:08:15, 470.65s/it]training process:  54%|█████▍    | 27/50 [3:31:46<3:00:03, 469.72s/it]training process:  56%|█████▌    | 28/50 [3:39:31<2:51:40, 468.19s/it]epoch : 29, train loss : 0.006, valid loss : 0.058, train acc : 0.851, valid acc : 0.833, train f1 : 0.848, valid f1 : 0.540
training process:  58%|█████▊    | 29/50 [3:47:16<2:43:31, 467.21s/it]training process:  60%|██████    | 30/50 [3:55:01<2:35:31, 466.58s/it]training process:  62%|██████▏   | 31/50 [4:02:50<2:27:57, 467.23s/it]training process:  64%|██████▍   | 32/50 [4:10:35<2:19:59, 466.61s/it]epoch : 33, train loss : 0.005, valid loss : 0.053, train acc : 0.862, valid acc : 0.863, train f1 : 0.860, valid f1 : 0.562
training process:  66%|██████▌   | 33/50 [4:18:20<2:12:04, 466.16s/it]training process:  68%|██████▊   | 34/50 [4:26:07<2:04:22, 466.40s/it]training process:  70%|███████   | 35/50 [4:33:53<1:56:34, 466.29s/it]training process:  72%|███████▏  | 36/50 [4:41:40<1:48:51, 466.52s/it]epoch : 37, train loss : 0.004, valid loss : 0.056, train acc : 0.866, valid acc : 0.859, train f1 : 0.864, valid f1 : 0.562
training process:  74%|███████▍  | 37/50 [4:49:29<1:41:15, 467.31s/it]training process:  76%|███████▌  | 38/50 [4:57:13<1:33:15, 466.30s/it]training process:  78%|███████▊  | 39/50 [5:05:02<1:25:36, 466.99s/it]training process:  80%|████████  | 40/50 [5:12:51<1:17:56, 467.64s/it]epoch : 41, train loss : 0.004, valid loss : 0.040, train acc : 0.877, valid acc : 0.906, train f1 : 0.876, valid f1 : 0.608
training process:  82%|████████▏ | 41/50 [5:20:34<1:09:57, 466.36s/it]training process:  84%|████████▍ | 42/50 [5:28:18<1:02:06, 465.77s/it]training process:  86%|████████▌ | 43/50 [5:36:06<54:23, 466.18s/it]  training process:  88%|████████▊ | 44/50 [5:43:50<46:34, 465.78s/it]epoch : 45, train loss : 0.004, valid loss : 0.044, train acc : 0.885, valid acc : 0.891, train f1 : 0.884, valid f1 : 0.592
training process:  90%|█████████ | 45/50 [5:51:40<38:54, 466.95s/it]training process:  92%|█████████▏| 46/50 [5:59:28<31:09, 467.37s/it]training process:  94%|█████████▍| 47/50 [6:07:18<23:24, 468.07s/it]training process:  96%|█████████▌| 48/50 [6:15:05<15:35, 467.77s/it]epoch : 49, train loss : 0.004, valid loss : 0.044, train acc : 0.901, valid acc : 0.888, train f1 : 0.900, valid f1 : 0.584
training process:  98%|█████████▊| 49/50 [6:22:54<07:48, 468.06s/it]training process: 100%|██████████| 50/50 [6:30:43<00:00, 468.35s/it]training process: 100%|██████████| 50/50 [6:30:43<00:00, 468.87s/it]
training process finished, best loss : 0.029 and best acc : 0.927, best f1 : 0.637, best epoch : 45

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.18      0.92      0.30        71
           1       1.00      0.92      0.96      3812

    accuracy                           0.92      3883
   macro avg       0.59      0.92      0.63      3883
weighted avg       0.98      0.92      0.95      3883


# test acc : 0.92, test f1 : 0.63, test AUC : 0.92, test loss : 0.274

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:49, 19.63it/s]  1%|          | 5/981 [00:00<00:46, 20.98it/s]  1%|          | 8/981 [00:00<00:45, 21.50it/s]  1%|          | 11/981 [00:00<00:47, 20.62it/s]  1%|▏         | 14/981 [00:00<00:45, 21.18it/s]  2%|▏         | 17/981 [00:00<00:45, 21.39it/s]  2%|▏         | 20/981 [00:00<00:44, 21.46it/s]  2%|▏         | 23/981 [00:01<00:44, 21.64it/s]  3%|▎         | 26/981 [00:01<00:43, 21.72it/s]  3%|▎         | 29/981 [00:01<00:43, 21.91it/s]  3%|▎         | 32/981 [00:01<00:43, 21.93it/s]  4%|▎         | 35/981 [00:01<00:43, 21.78it/s]  4%|▍         | 38/981 [00:01<00:43, 21.84it/s]  4%|▍         | 41/981 [00:01<00:42, 21.87it/s]  4%|▍         | 44/981 [00:02<00:42, 21.88it/s]  5%|▍         | 47/981 [00:02<00:42, 21.75it/s]  5%|▌         | 50/981 [00:02<00:42, 21.79it/s]  5%|▌         | 53/981 [00:02<00:42, 21.91it/s]  6%|▌         | 56/981 [00:02<00:42, 21.82it/s]  6%|▌         | 59/981 [00:02<00:42, 21.88it/s]  6%|▋         | 62/981 [00:02<00:42, 21.85it/s]  7%|▋         | 65/981 [00:02<00:41, 21.88it/s]  7%|▋         | 68/981 [00:03<00:41, 21.78it/s]  7%|▋         | 71/981 [00:03<00:41, 21.74it/s]  8%|▊         | 74/981 [00:03<00:41, 21.91it/s]  8%|▊         | 77/981 [00:03<00:41, 21.83it/s]  8%|▊         | 80/981 [00:03<00:41, 21.83it/s]  8%|▊         | 83/981 [00:03<00:40, 21.92it/s]  9%|▉         | 86/981 [00:03<00:40, 21.91it/s]  9%|▉         | 89/981 [00:04<00:40, 21.94it/s]  9%|▉         | 92/981 [00:04<00:40, 21.85it/s] 10%|▉         | 95/981 [00:04<00:40, 21.93it/s] 10%|▉         | 98/981 [00:04<00:40, 21.88it/s] 10%|█         | 101/981 [00:04<00:40, 21.78it/s] 11%|█         | 104/981 [00:04<00:40, 21.78it/s] 11%|█         | 107/981 [00:04<00:40, 21.77it/s] 11%|█         | 110/981 [00:05<00:40, 21.69it/s] 12%|█▏        | 113/981 [00:05<00:40, 21.62it/s] 12%|█▏        | 116/981 [00:05<00:39, 21.72it/s] 12%|█▏        | 119/981 [00:05<00:39, 21.55it/s] 12%|█▏        | 122/981 [00:05<00:40, 21.46it/s] 13%|█▎        | 125/981 [00:05<00:39, 21.52it/s] 13%|█▎        | 128/981 [00:05<00:40, 21.07it/s] 13%|█▎        | 131/981 [00:06<00:39, 21.30it/s] 14%|█▎        | 134/981 [00:06<00:39, 21.29it/s] 14%|█▍        | 137/981 [00:06<00:39, 21.37it/s] 14%|█▍        | 140/981 [00:06<00:39, 21.53it/s] 15%|█▍        | 143/981 [00:06<00:39, 21.46it/s] 15%|█▍        | 146/981 [00:06<00:38, 21.55it/s] 15%|█▌        | 149/981 [00:06<00:38, 21.63it/s] 15%|█▌        | 152/981 [00:07<00:38, 21.60it/s] 16%|█▌        | 155/981 [00:07<00:37, 21.76it/s] 16%|█▌        | 158/981 [00:07<00:38, 21.66it/s] 16%|█▋        | 161/981 [00:07<00:37, 21.64it/s] 17%|█▋        | 164/981 [00:07<00:37, 21.63it/s] 17%|█▋        | 167/981 [00:07<00:37, 21.64it/s] 17%|█▋        | 170/981 [00:07<00:37, 21.71it/s] 18%|█▊        | 173/981 [00:07<00:37, 21.76it/s] 18%|█▊        | 176/981 [00:08<00:37, 21.70it/s] 18%|█▊        | 179/981 [00:08<00:36, 21.76it/s] 19%|█▊        | 182/981 [00:08<00:36, 21.85it/s] 19%|█▉        | 185/981 [00:08<00:36, 21.67it/s] 19%|█▉        | 188/981 [00:08<00:36, 21.71it/s] 19%|█▉        | 191/981 [00:08<00:36, 21.71it/s] 20%|█▉        | 194/981 [00:08<00:37, 21.11it/s] 20%|██        | 197/981 [00:09<00:37, 20.93it/s] 20%|██        | 200/981 [00:09<00:38, 20.43it/s] 21%|██        | 203/981 [00:09<00:38, 20.46it/s] 21%|██        | 206/981 [00:09<00:37, 20.76it/s] 21%|██▏       | 209/981 [00:09<00:36, 20.89it/s] 22%|██▏       | 212/981 [00:09<00:36, 21.09it/s] 22%|██▏       | 215/981 [00:09<00:36, 21.04it/s] 22%|██▏       | 218/981 [00:10<00:36, 21.04it/s] 23%|██▎       | 221/981 [00:10<00:35, 21.15it/s] 23%|██▎       | 224/981 [00:10<00:35, 21.15it/s] 23%|██▎       | 227/981 [00:10<00:35, 21.11it/s] 23%|██▎       | 230/981 [00:10<00:35, 21.29it/s] 24%|██▍       | 233/981 [00:10<00:35, 21.23it/s] 24%|██▍       | 236/981 [00:10<00:35, 21.25it/s] 24%|██▍       | 239/981 [00:11<00:34, 21.35it/s] 25%|██▍       | 242/981 [00:11<00:34, 21.25it/s] 25%|██▍       | 245/981 [00:11<00:34, 21.32it/s] 25%|██▌       | 248/981 [00:11<00:34, 21.32it/s] 26%|██▌       | 251/981 [00:11<00:34, 21.31it/s] 26%|██▌       | 254/981 [00:11<00:33, 21.52it/s] 26%|██▌       | 257/981 [00:11<00:34, 21.29it/s] 27%|██▋       | 260/981 [00:12<00:33, 21.33it/s] 27%|██▋       | 263/981 [00:12<00:33, 21.37it/s] 27%|██▋       | 266/981 [00:12<00:33, 21.29it/s] 27%|██▋       | 269/981 [00:12<00:33, 21.39it/s] 28%|██▊       | 272/981 [00:12<00:33, 21.29it/s] 28%|██▊       | 275/981 [00:12<00:33, 21.25it/s] 28%|██▊       | 278/981 [00:12<00:33, 21.18it/s] 29%|██▊       | 281/981 [00:13<00:33, 21.05it/s] 29%|██▉       | 284/981 [00:13<00:32, 21.19it/s] 29%|██▉       | 287/981 [00:13<00:32, 21.29it/s] 30%|██▉       | 290/981 [00:13<00:32, 21.26it/s] 30%|██▉       | 293/981 [00:13<00:32, 21.30it/s] 30%|███       | 296/981 [00:13<00:32, 21.33it/s] 30%|███       | 299/981 [00:13<00:32, 21.30it/s] 31%|███       | 302/981 [00:14<00:31, 21.42it/s] 31%|███       | 305/981 [00:14<00:31, 21.24it/s] 31%|███▏      | 308/981 [00:14<00:31, 21.31it/s] 32%|███▏      | 311/981 [00:14<00:31, 21.37it/s] 32%|███▏      | 314/981 [00:14<00:31, 21.27it/s] 32%|███▏      | 317/981 [00:14<00:31, 21.36it/s] 33%|███▎      | 320/981 [00:14<00:31, 21.31it/s] 33%|███▎      | 323/981 [00:15<00:30, 21.35it/s] 33%|███▎      | 326/981 [00:15<00:30, 21.47it/s] 34%|███▎      | 329/981 [00:15<00:30, 21.34it/s] 34%|███▍      | 332/981 [00:15<00:30, 21.37it/s] 34%|███▍      | 335/981 [00:15<00:30, 21.30it/s] 34%|███▍      | 338/981 [00:15<00:30, 21.27it/s] 35%|███▍      | 341/981 [00:15<00:30, 21.33it/s] 35%|███▌      | 344/981 [00:16<00:29, 21.29it/s] 35%|███▌      | 347/981 [00:16<00:29, 21.28it/s] 36%|███▌      | 350/981 [00:16<00:29, 21.40it/s] 36%|███▌      | 353/981 [00:16<00:29, 21.24it/s] 36%|███▋      | 356/981 [00:16<00:29, 21.26it/s] 37%|███▋      | 359/981 [00:16<00:29, 21.24it/s] 37%|███▋      | 362/981 [00:16<00:29, 21.20it/s] 37%|███▋      | 365/981 [00:17<00:29, 21.21it/s] 38%|███▊      | 368/981 [00:17<00:28, 21.27it/s] 38%|███▊      | 371/981 [00:17<00:28, 21.20it/s] 38%|███▊      | 374/981 [00:17<00:28, 21.35it/s] 38%|███▊      | 377/981 [00:17<00:28, 20.91it/s] 39%|███▊      | 380/981 [00:17<00:28, 21.00it/s] 39%|███▉      | 383/981 [00:17<00:28, 21.13it/s] 39%|███▉      | 386/981 [00:18<00:28, 20.94it/s] 40%|███▉      | 389/981 [00:18<00:28, 21.05it/s] 40%|███▉      | 392/981 [00:18<00:28, 20.99it/s] 40%|████      | 395/981 [00:18<00:27, 21.03it/s] 41%|████      | 398/981 [00:18<00:27, 21.15it/s] 41%|████      | 401/981 [00:18<00:30, 19.08it/s] 41%|████      | 404/981 [00:18<00:29, 19.74it/s] 41%|████▏     | 407/981 [00:19<00:28, 19.98it/s] 42%|████▏     | 410/981 [00:19<00:28, 20.39it/s] 42%|████▏     | 413/981 [00:19<00:27, 20.72it/s] 42%|████▏     | 416/981 [00:19<00:27, 20.87it/s] 43%|████▎     | 419/981 [00:19<00:26, 21.10it/s] 43%|████▎     | 422/981 [00:19<00:26, 21.23it/s] 43%|████▎     | 425/981 [00:19<00:26, 21.31it/s] 44%|████▎     | 428/981 [00:20<00:25, 21.35it/s] 44%|████▍     | 431/981 [00:20<00:25, 21.38it/s] 44%|████▍     | 434/981 [00:20<00:25, 21.44it/s] 45%|████▍     | 437/981 [00:20<00:25, 21.45it/s] 45%|████▍     | 440/981 [00:20<00:25, 21.45it/s] 45%|████▌     | 443/981 [00:20<00:25, 21.41it/s] 45%|████▌     | 446/981 [00:20<00:24, 21.61it/s] 46%|████▌     | 449/981 [00:21<00:24, 21.46it/s] 46%|████▌     | 452/981 [00:21<00:24, 21.58it/s] 46%|████▋     | 455/981 [00:21<00:24, 21.48it/s] 47%|████▋     | 458/981 [00:21<00:24, 21.45it/s] 47%|████▋     | 461/981 [00:21<00:24, 21.54it/s] 47%|████▋     | 464/981 [00:21<00:24, 21.42it/s] 48%|████▊     | 467/981 [00:21<00:23, 21.43it/s] 48%|████▊     | 470/981 [00:22<00:24, 20.87it/s] 48%|████▊     | 473/981 [00:22<00:24, 20.92it/s] 49%|████▊     | 476/981 [00:22<00:24, 21.04it/s] 49%|████▉     | 479/981 [00:22<00:23, 21.10it/s] 49%|████▉     | 482/981 [00:22<00:23, 21.24it/s] 49%|████▉     | 485/981 [00:22<00:23, 21.31it/s] 50%|████▉     | 488/981 [00:22<00:23, 21.38it/s] 50%|█████     | 491/981 [00:22<00:22, 21.34it/s] 50%|█████     | 494/981 [00:23<00:22, 21.52it/s] 51%|█████     | 497/981 [00:23<00:22, 21.55it/s] 51%|█████     | 500/981 [00:23<00:22, 21.60it/s] 51%|█████▏    | 503/981 [00:23<00:21, 21.77it/s] 52%|█████▏    | 506/981 [00:23<00:21, 21.60it/s] 52%|█████▏    | 509/981 [00:23<00:21, 21.75it/s] 52%|█████▏    | 512/981 [00:23<00:21, 21.82it/s] 52%|█████▏    | 515/981 [00:24<00:21, 21.79it/s] 53%|█████▎    | 518/981 [00:24<00:21, 21.98it/s] 53%|█████▎    | 521/981 [00:24<00:21, 21.80it/s] 53%|█████▎    | 524/981 [00:24<00:20, 21.94it/s] 54%|█████▎    | 527/981 [00:24<00:20, 22.04it/s] 54%|█████▍    | 530/981 [00:24<00:20, 21.96it/s] 54%|█████▍    | 533/981 [00:24<00:20, 22.13it/s] 55%|█████▍    | 536/981 [00:25<00:20, 22.12it/s] 55%|█████▍    | 539/981 [00:25<00:20, 22.04it/s] 55%|█████▌    | 542/981 [00:25<00:19, 22.04it/s] 56%|█████▌    | 545/981 [00:25<00:19, 21.97it/s] 56%|█████▌    | 548/981 [00:25<00:19, 21.96it/s] 56%|█████▌    | 551/981 [00:25<00:19, 22.01it/s] 56%|█████▋    | 554/981 [00:25<00:19, 22.25it/s] 57%|█████▋    | 557/981 [00:25<00:19, 22.16it/s] 57%|█████▋    | 560/981 [00:26<00:18, 22.27it/s] 57%|█████▋    | 563/981 [00:26<00:18, 22.31it/s] 58%|█████▊    | 566/981 [00:26<00:18, 22.24it/s] 58%|█████▊    | 569/981 [00:26<00:18, 22.31it/s] 58%|█████▊    | 572/981 [00:26<00:18, 22.27it/s] 59%|█████▊    | 575/981 [00:26<00:18, 22.18it/s] 59%|█████▉    | 578/981 [00:26<00:18, 22.26it/s] 59%|█████▉    | 581/981 [00:27<00:18, 22.21it/s] 60%|█████▉    | 584/981 [00:27<00:17, 22.24it/s] 60%|█████▉    | 587/981 [00:27<00:17, 22.28it/s] 60%|██████    | 590/981 [00:27<00:17, 22.35it/s] 60%|██████    | 593/981 [00:27<00:17, 22.27it/s] 61%|██████    | 596/981 [00:27<00:17, 22.25it/s] 61%|██████    | 599/981 [00:27<00:17, 22.21it/s] 61%|██████▏   | 602/981 [00:28<00:17, 22.11it/s] 62%|██████▏   | 605/981 [00:28<00:16, 22.29it/s] 62%|██████▏   | 608/981 [00:28<00:16, 22.23it/s] 62%|██████▏   | 611/981 [00:28<00:16, 22.13it/s] 63%|██████▎   | 614/981 [00:28<00:16, 22.21it/s] 63%|██████▎   | 617/981 [00:28<00:16, 22.15it/s] 63%|██████▎   | 620/981 [00:28<00:16, 22.20it/s] 64%|██████▎   | 623/981 [00:28<00:16, 22.33it/s] 64%|██████▍   | 626/981 [00:29<00:15, 22.21it/s] 64%|██████▍   | 629/981 [00:29<00:15, 22.26it/s] 64%|██████▍   | 632/981 [00:29<00:15, 22.28it/s] 65%|██████▍   | 635/981 [00:29<00:15, 22.20it/s] 65%|██████▌   | 638/981 [00:29<00:15, 22.31it/s] 65%|██████▌   | 641/981 [00:29<00:15, 22.20it/s] 66%|██████▌   | 644/981 [00:29<00:15, 22.22it/s] 66%|██████▌   | 647/981 [00:30<00:15, 22.24it/s] 66%|██████▋   | 650/981 [00:30<00:14, 22.16it/s] 67%|██████▋   | 653/981 [00:30<00:14, 22.22it/s] 67%|██████▋   | 656/981 [00:30<00:14, 22.18it/s] 67%|██████▋   | 659/981 [00:30<00:14, 22.12it/s] 67%|██████▋   | 662/981 [00:30<00:14, 22.18it/s] 68%|██████▊   | 665/981 [00:30<00:14, 22.24it/s] 68%|██████▊   | 668/981 [00:30<00:14, 22.20it/s] 68%|██████▊   | 671/981 [00:31<00:13, 22.25it/s] 69%|██████▊   | 674/981 [00:31<00:13, 22.31it/s] 69%|██████▉   | 677/981 [00:31<00:13, 22.24it/s] 69%|██████▉   | 680/981 [00:31<00:13, 22.26it/s] 70%|██████▉   | 683/981 [00:31<00:13, 22.29it/s] 70%|██████▉   | 686/981 [00:31<00:13, 21.96it/s] 70%|███████   | 689/981 [00:31<00:13, 22.03it/s] 71%|███████   | 692/981 [00:32<00:13, 21.45it/s] 71%|███████   | 695/981 [00:32<00:13, 20.74it/s] 71%|███████   | 698/981 [00:32<00:13, 20.37it/s] 71%|███████▏  | 701/981 [00:32<00:13, 20.24it/s] 72%|███████▏  | 704/981 [00:32<00:13, 20.31it/s] 72%|███████▏  | 707/981 [00:32<00:13, 19.94it/s] 72%|███████▏  | 710/981 [00:32<00:13, 20.24it/s] 73%|███████▎  | 713/981 [00:33<00:13, 20.50it/s] 73%|███████▎  | 716/981 [00:33<00:12, 20.94it/s] 73%|███████▎  | 719/981 [00:33<00:12, 21.34it/s] 74%|███████▎  | 722/981 [00:33<00:12, 21.56it/s] 74%|███████▍  | 725/981 [00:33<00:11, 21.87it/s] 74%|███████▍  | 728/981 [00:33<00:11, 22.16it/s] 75%|███████▍  | 731/981 [00:33<00:11, 22.30it/s] 75%|███████▍  | 734/981 [00:34<00:10, 22.46it/s] 75%|███████▌  | 737/981 [00:34<00:10, 22.70it/s] 75%|███████▌  | 740/981 [00:34<00:10, 22.74it/s] 76%|███████▌  | 743/981 [00:34<00:10, 22.78it/s] 76%|███████▌  | 746/981 [00:34<00:10, 22.78it/s] 76%|███████▋  | 749/981 [00:34<00:11, 21.06it/s] 77%|███████▋  | 752/981 [00:34<00:10, 21.43it/s] 77%|███████▋  | 755/981 [00:35<00:10, 21.58it/s] 77%|███████▋  | 758/981 [00:35<00:10, 21.63it/s] 78%|███████▊  | 761/981 [00:35<00:10, 21.60it/s] 78%|███████▊  | 764/981 [00:35<00:10, 21.45it/s] 78%|███████▊  | 767/981 [00:35<00:09, 21.53it/s] 78%|███████▊  | 770/981 [00:35<00:09, 21.68it/s] 79%|███████▉  | 773/981 [00:35<00:09, 21.74it/s] 79%|███████▉  | 776/981 [00:35<00:09, 21.80it/s] 79%|███████▉  | 779/981 [00:36<00:09, 21.99it/s] 80%|███████▉  | 782/981 [00:36<00:08, 22.24it/s] 80%|████████  | 785/981 [00:36<00:08, 22.73it/s] 80%|████████  | 788/981 [00:36<00:08, 23.20it/s] 81%|████████  | 791/981 [00:36<00:08, 23.56it/s] 81%|████████  | 794/981 [00:36<00:07, 23.93it/s] 81%|████████  | 797/981 [00:36<00:07, 24.45it/s] 82%|████████▏ | 800/981 [00:36<00:07, 24.93it/s] 82%|████████▏ | 803/981 [00:37<00:07, 25.42it/s] 82%|████████▏ | 806/981 [00:37<00:06, 25.74it/s] 82%|████████▏ | 809/981 [00:37<00:06, 25.91it/s] 83%|████████▎ | 812/981 [00:37<00:06, 26.13it/s] 83%|████████▎ | 815/981 [00:37<00:06, 26.24it/s] 83%|████████▎ | 818/981 [00:37<00:06, 26.27it/s] 84%|████████▎ | 821/981 [00:37<00:06, 26.26it/s] 84%|████████▍ | 824/981 [00:37<00:05, 26.31it/s] 84%|████████▍ | 827/981 [00:38<00:05, 26.47it/s] 85%|████████▍ | 830/981 [00:38<00:05, 26.25it/s] 85%|████████▍ | 833/981 [00:38<00:05, 25.78it/s] 85%|████████▌ | 836/981 [00:38<00:05, 25.89it/s] 86%|████████▌ | 839/981 [00:38<00:05, 25.98it/s] 86%|████████▌ | 842/981 [00:38<00:05, 26.12it/s] 86%|████████▌ | 845/981 [00:38<00:05, 26.14it/s] 86%|████████▋ | 848/981 [00:38<00:05, 26.12it/s] 87%|████████▋ | 851/981 [00:38<00:04, 26.25it/s] 87%|████████▋ | 854/981 [00:39<00:04, 26.40it/s] 87%|████████▋ | 857/981 [00:39<00:04, 26.05it/s] 88%|████████▊ | 860/981 [00:39<00:04, 26.33it/s] 88%|████████▊ | 863/981 [00:39<00:04, 26.30it/s] 88%|████████▊ | 866/981 [00:39<00:04, 26.38it/s] 89%|████████▊ | 869/981 [00:39<00:04, 26.25it/s] 89%|████████▉ | 872/981 [00:39<00:04, 26.38it/s] 89%|████████▉ | 875/981 [00:39<00:04, 25.92it/s] 90%|████████▉ | 878/981 [00:39<00:03, 26.08it/s] 90%|████████▉ | 881/981 [00:40<00:03, 26.25it/s] 90%|█████████ | 884/981 [00:40<00:03, 26.36it/s] 90%|█████████ | 887/981 [00:40<00:03, 26.44it/s] 91%|█████████ | 890/981 [00:40<00:03, 26.38it/s] 91%|█████████ | 893/981 [00:40<00:03, 26.44it/s] 91%|█████████▏| 896/981 [00:40<00:03, 26.47it/s] 92%|█████████▏| 899/981 [00:40<00:03, 26.16it/s] 92%|█████████▏| 902/981 [00:40<00:03, 26.25it/s] 92%|█████████▏| 905/981 [00:40<00:02, 26.04it/s] 93%|█████████▎| 908/981 [00:41<00:02, 26.18it/s] 93%|█████████▎| 911/981 [00:41<00:02, 26.22it/s] 93%|█████████▎| 914/981 [00:41<00:02, 25.99it/s] 93%|█████████▎| 917/981 [00:41<00:02, 26.26it/s] 94%|█████████▍| 920/981 [00:41<00:02, 26.30it/s] 94%|█████████▍| 923/981 [00:41<00:02, 26.38it/s] 94%|█████████▍| 926/981 [00:41<00:02, 26.60it/s] 95%|█████████▍| 929/981 [00:41<00:01, 26.62it/s] 95%|█████████▌| 932/981 [00:42<00:01, 26.51it/s] 95%|█████████▌| 935/981 [00:42<00:01, 26.64it/s] 96%|█████████▌| 938/981 [00:42<00:01, 26.66it/s] 96%|█████████▌| 941/981 [00:42<00:01, 26.54it/s] 96%|█████████▌| 944/981 [00:42<00:01, 26.61it/s] 97%|█████████▋| 947/981 [00:42<00:01, 26.69it/s] 97%|█████████▋| 950/981 [00:42<00:01, 26.57it/s] 97%|█████████▋| 953/981 [00:42<00:01, 26.65it/s] 97%|█████████▋| 956/981 [00:42<00:00, 26.75it/s] 98%|█████████▊| 959/981 [00:43<00:00, 26.70it/s] 98%|█████████▊| 962/981 [00:43<00:00, 26.63it/s] 98%|█████████▊| 965/981 [00:43<00:00, 26.86it/s] 99%|█████████▊| 968/981 [00:43<00:00, 26.89it/s] 99%|█████████▉| 971/981 [00:43<00:00, 26.65it/s] 99%|█████████▉| 974/981 [00:43<00:00, 26.72it/s]100%|█████████▉| 977/981 [00:43<00:00, 26.77it/s]100%|█████████▉| 980/981 [00:43<00:00, 26.76it/s]100%|██████████| 981/981 [00:43<00:00, 22.38it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.037, valid loss : 0.034, train acc : 0.982, valid acc : 0.982, train f1 : 0.495, valid f1 : 0.495
training process:   2%|▏         | 1/50 [08:03<6:34:57, 483.61s/it]training process:   4%|▍         | 2/50 [16:01<6:23:58, 479.97s/it]training process:   6%|▌         | 3/50 [23:54<6:13:30, 476.81s/it]training process:   8%|▊         | 4/50 [31:47<6:04:37, 475.60s/it]epoch : 5, train loss : 0.035, valid loss : 0.037, train acc : 0.983, valid acc : 0.982, train f1 : 0.496, valid f1 : 0.495
training process:  10%|█         | 5/50 [39:33<5:54:08, 472.18s/it]training process:  12%|█▏        | 6/50 [47:23<5:45:31, 471.16s/it]training process:  14%|█▍        | 7/50 [55:24<5:40:03, 474.50s/it]training process:  16%|█▌        | 8/50 [1:03:22<5:32:51, 475.52s/it]epoch : 9, train loss : 0.035, valid loss : 0.037, train acc : 0.983, valid acc : 0.982, train f1 : 0.496, valid f1 : 0.495
training process:  18%|█▊        | 9/50 [1:11:12<5:23:50, 473.92s/it]training process:  20%|██        | 10/50 [1:19:03<5:15:25, 473.13s/it]training process:  22%|██▏       | 11/50 [1:26:51<5:06:28, 471.51s/it]training process:  24%|██▍       | 12/50 [1:34:41<4:58:14, 470.90s/it]epoch : 13, train loss : 0.030, valid loss : 0.026, train acc : 0.982, valid acc : 0.986, train f1 : 0.605, valid f1 : 0.790
training process:  26%|██▌       | 13/50 [1:42:32<4:50:28, 471.05s/it]training process:  28%|██▊       | 14/50 [1:50:23<4:42:29, 470.83s/it]training process:  30%|███       | 15/50 [1:58:09<4:33:54, 469.55s/it]training process:  32%|███▏      | 16/50 [2:05:57<4:25:43, 468.94s/it]epoch : 17, train loss : 0.024, valid loss : 0.022, train acc : 0.988, valid acc : 0.990, train f1 : 0.754, valid f1 : 0.807
training process:  34%|███▍      | 17/50 [2:13:46<4:17:57, 469.00s/it]training process:  36%|███▌      | 18/50 [2:21:29<4:09:08, 467.14s/it]training process:  38%|███▊      | 19/50 [2:29:19<4:01:53, 468.17s/it]training process:  40%|████      | 20/50 [2:37:04<3:53:35, 467.17s/it]epoch : 21, train loss : 0.023, valid loss : 0.024, train acc : 0.986, valid acc : 0.988, train f1 : 0.748, valid f1 : 0.778
training process:  42%|████▏     | 21/50 [2:44:47<3:45:10, 465.89s/it]training process:  44%|████▍     | 22/50 [2:52:31<3:37:08, 465.32s/it]training process:  46%|████▌     | 23/50 [3:00:18<3:29:40, 465.94s/it]training process:  48%|████▊     | 24/50 [3:08:08<3:22:20, 466.95s/it]epoch : 25, train loss : 0.023, valid loss : 0.024, train acc : 0.989, valid acc : 0.989, train f1 : 0.776, valid f1 : 0.785
training process:  50%|█████     | 25/50 [3:15:58<3:14:56, 467.86s/it]training process:  52%|█████▏    | 26/50 [3:23:46<3:07:15, 468.15s/it]training process:  54%|█████▍    | 27/50 [3:31:33<2:59:18, 467.75s/it]training process:  56%|█████▌    | 28/50 [3:39:20<2:51:23, 467.43s/it]epoch : 29, train loss : 0.022, valid loss : 0.026, train acc : 0.990, valid acc : 0.988, train f1 : 0.791, valid f1 : 0.778
training process:  58%|█████▊    | 29/50 [3:47:09<2:43:45, 467.87s/it]training process:  60%|██████    | 30/50 [3:54:54<2:35:40, 467.04s/it]training process:  62%|██████▏   | 31/50 [4:02:43<2:28:05, 467.66s/it]training process:  64%|██████▍   | 32/50 [4:10:35<2:20:43, 469.06s/it]epoch : 33, train loss : 0.021, valid loss : 0.025, train acc : 0.990, valid acc : 0.989, train f1 : 0.799, valid f1 : 0.786
training process:  66%|██████▌   | 33/50 [4:18:28<2:13:13, 470.20s/it]training process:  68%|██████▊   | 34/50 [4:26:21<2:05:35, 470.94s/it]training process:  70%|███████   | 35/50 [4:34:11<1:57:38, 470.56s/it]training process:  72%|███████▏  | 36/50 [4:42:03<1:49:55, 471.11s/it]epoch : 37, train loss : 0.020, valid loss : 0.021, train acc : 0.990, valid acc : 0.988, train f1 : 0.802, valid f1 : 0.778
training process:  74%|███████▍  | 37/50 [4:49:53<1:42:00, 470.84s/it]training process:  76%|███████▌  | 38/50 [4:57:42<1:34:03, 470.28s/it]training process:  78%|███████▊  | 39/50 [5:05:32<1:26:10, 470.04s/it]training process:  80%|████████  | 40/50 [5:13:18<1:18:08, 468.88s/it]epoch : 41, train loss : 0.021, valid loss : 0.025, train acc : 0.989, valid acc : 0.989, train f1 : 0.777, valid f1 : 0.791
training process:  82%|████████▏ | 41/50 [5:21:12<1:10:33, 470.44s/it]training process:  84%|████████▍ | 42/50 [5:29:00<1:02:37, 469.67s/it]training process:  86%|████████▌ | 43/50 [5:36:55<55:00, 471.43s/it]  training process:  88%|████████▊ | 44/50 [5:44:44<47:03, 470.62s/it]epoch : 45, train loss : 0.020, valid loss : 0.022, train acc : 0.990, valid acc : 0.989, train f1 : 0.805, valid f1 : 0.808
training process:  90%|█████████ | 45/50 [5:52:30<39:05, 469.13s/it]training process:  92%|█████████▏| 46/50 [6:00:17<31:14, 468.66s/it]training process:  94%|█████████▍| 47/50 [6:08:03<23:23, 467.86s/it]training process:  96%|█████████▌| 48/50 [6:15:48<15:33, 466.85s/it]epoch : 49, train loss : 0.016, valid loss : 0.018, train acc : 0.991, valid acc : 0.990, train f1 : 0.828, valid f1 : 0.831
training process:  98%|█████████▊| 49/50 [6:23:32<07:46, 466.00s/it]training process: 100%|██████████| 50/50 [6:31:19<00:00, 466.44s/it]training process: 100%|██████████| 50/50 [6:31:19<00:00, 469.59s/it]
training process finished, best loss : 0.018 and best acc : 0.990, best f1 : 0.831, best epoch : 48

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.75      0.51      0.61        71
           1       0.99      1.00      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.87      0.75      0.80      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.80, test AUC : 0.75, test loss : 0.164

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:49, 19.72it/s]  1%|          | 5/981 [00:00<00:46, 20.82it/s]  1%|          | 8/981 [00:00<00:47, 20.34it/s]  1%|          | 11/981 [00:00<00:46, 20.70it/s]  1%|▏         | 14/981 [00:00<00:45, 21.04it/s]  2%|▏         | 17/981 [00:00<00:45, 21.06it/s]  2%|▏         | 20/981 [00:00<00:45, 21.18it/s]  2%|▏         | 23/981 [00:01<00:44, 21.38it/s]  3%|▎         | 26/981 [00:01<00:44, 21.23it/s]  3%|▎         | 29/981 [00:01<00:44, 21.48it/s]  3%|▎         | 32/981 [00:01<00:44, 21.25it/s]  4%|▎         | 35/981 [00:01<00:44, 21.19it/s]  4%|▍         | 38/981 [00:01<00:44, 21.32it/s]  4%|▍         | 41/981 [00:01<00:44, 21.25it/s]  4%|▍         | 44/981 [00:02<00:43, 21.40it/s]  5%|▍         | 47/981 [00:02<00:44, 20.94it/s]  5%|▌         | 50/981 [00:02<00:44, 21.02it/s]  5%|▌         | 53/981 [00:02<00:43, 21.25it/s]  6%|▌         | 56/981 [00:02<00:43, 21.17it/s]  6%|▌         | 59/981 [00:02<00:43, 21.24it/s]  6%|▋         | 62/981 [00:02<00:43, 21.15it/s]  7%|▋         | 65/981 [00:03<00:43, 21.08it/s]  7%|▋         | 68/981 [00:03<00:44, 20.33it/s]  7%|▋         | 71/981 [00:03<00:47, 19.08it/s]  7%|▋         | 73/981 [00:03<00:49, 18.48it/s]  8%|▊         | 75/981 [00:03<00:50, 17.98it/s]  8%|▊         | 77/981 [00:03<00:51, 17.49it/s]  8%|▊         | 79/981 [00:03<00:52, 17.19it/s]  8%|▊         | 81/981 [00:04<00:53, 16.81it/s]  9%|▊         | 84/981 [00:04<00:49, 18.10it/s]  9%|▉         | 87/981 [00:04<00:46, 19.21it/s]  9%|▉         | 90/981 [00:04<00:45, 19.65it/s]  9%|▉         | 93/981 [00:04<00:44, 20.18it/s] 10%|▉         | 96/981 [00:04<00:43, 20.43it/s] 10%|█         | 99/981 [00:04<00:42, 20.59it/s] 10%|█         | 102/981 [00:05<00:42, 20.88it/s] 11%|█         | 105/981 [00:05<00:42, 20.75it/s] 11%|█         | 108/981 [00:05<00:41, 21.03it/s] 11%|█▏        | 111/981 [00:05<00:41, 21.12it/s] 12%|█▏        | 114/981 [00:05<00:41, 21.07it/s] 12%|█▏        | 117/981 [00:05<00:40, 21.25it/s] 12%|█▏        | 120/981 [00:05<00:40, 21.10it/s] 13%|█▎        | 123/981 [00:06<00:40, 21.20it/s] 13%|█▎        | 126/981 [00:06<00:40, 21.31it/s] 13%|█▎        | 129/981 [00:06<00:40, 21.06it/s] 13%|█▎        | 132/981 [00:06<00:40, 21.16it/s] 14%|█▍        | 135/981 [00:06<00:40, 21.14it/s] 14%|█▍        | 138/981 [00:06<00:39, 21.09it/s] 14%|█▍        | 141/981 [00:06<00:40, 20.91it/s] 15%|█▍        | 144/981 [00:07<00:39, 20.94it/s] 15%|█▍        | 147/981 [00:07<00:39, 21.02it/s] 15%|█▌        | 150/981 [00:07<00:39, 21.16it/s] 16%|█▌        | 153/981 [00:07<00:41, 19.97it/s] 16%|█▌        | 156/981 [00:07<00:40, 20.30it/s] 16%|█▌        | 159/981 [00:07<00:40, 20.52it/s] 17%|█▋        | 162/981 [00:07<00:39, 20.75it/s] 17%|█▋        | 165/981 [00:08<00:38, 20.95it/s] 17%|█▋        | 168/981 [00:08<00:40, 20.23it/s] 17%|█▋        | 171/981 [00:08<00:39, 20.57it/s] 18%|█▊        | 174/981 [00:08<00:38, 20.80it/s] 18%|█▊        | 177/981 [00:08<00:38, 20.84it/s] 18%|█▊        | 180/981 [00:08<00:38, 21.00it/s] 19%|█▊        | 183/981 [00:08<00:37, 21.03it/s] 19%|█▉        | 186/981 [00:09<00:37, 21.16it/s] 19%|█▉        | 189/981 [00:09<00:37, 21.40it/s] 20%|█▉        | 192/981 [00:09<00:36, 21.33it/s] 20%|█▉        | 195/981 [00:09<00:36, 21.43it/s] 20%|██        | 198/981 [00:09<00:36, 21.48it/s] 20%|██        | 201/981 [00:09<00:36, 21.17it/s] 21%|██        | 204/981 [00:09<00:36, 21.32it/s] 21%|██        | 207/981 [00:10<00:36, 21.25it/s] 21%|██▏       | 210/981 [00:10<00:36, 21.12it/s] 22%|██▏       | 213/981 [00:10<00:36, 21.17it/s] 22%|██▏       | 216/981 [00:10<00:36, 20.95it/s] 22%|██▏       | 219/981 [00:10<00:36, 20.93it/s] 23%|██▎       | 222/981 [00:10<00:36, 20.93it/s] 23%|██▎       | 225/981 [00:10<00:36, 20.77it/s] 23%|██▎       | 228/981 [00:11<00:36, 20.83it/s] 24%|██▎       | 231/981 [00:11<00:36, 20.62it/s] 24%|██▍       | 234/981 [00:11<00:37, 19.82it/s] 24%|██▍       | 236/981 [00:11<00:38, 19.16it/s] 24%|██▍       | 238/981 [00:11<00:38, 19.25it/s] 25%|██▍       | 241/981 [00:11<00:37, 19.48it/s] 25%|██▍       | 243/981 [00:11<00:37, 19.59it/s] 25%|██▍       | 245/981 [00:11<00:37, 19.67it/s] 25%|██▌       | 247/981 [00:12<00:37, 19.62it/s] 25%|██▌       | 250/981 [00:12<00:36, 20.22it/s] 26%|██▌       | 253/981 [00:12<00:35, 20.25it/s] 26%|██▌       | 256/981 [00:12<00:35, 20.54it/s] 26%|██▋       | 259/981 [00:12<00:34, 20.68it/s] 27%|██▋       | 262/981 [00:12<00:34, 20.68it/s] 27%|██▋       | 265/981 [00:12<00:34, 20.55it/s] 27%|██▋       | 268/981 [00:13<00:34, 20.58it/s] 28%|██▊       | 271/981 [00:13<00:34, 20.79it/s] 28%|██▊       | 274/981 [00:13<00:33, 21.04it/s] 28%|██▊       | 277/981 [00:13<00:33, 20.94it/s] 29%|██▊       | 280/981 [00:13<00:33, 21.07it/s] 29%|██▉       | 283/981 [00:13<00:33, 20.87it/s] 29%|██▉       | 286/981 [00:13<00:33, 20.87it/s] 29%|██▉       | 289/981 [00:14<00:33, 20.70it/s] 30%|██▉       | 292/981 [00:14<00:33, 20.71it/s] 30%|███       | 295/981 [00:14<00:32, 20.87it/s] 30%|███       | 298/981 [00:14<00:33, 20.11it/s] 31%|███       | 301/981 [00:14<00:33, 20.40it/s] 31%|███       | 304/981 [00:14<00:32, 20.52it/s] 31%|███▏      | 307/981 [00:14<00:32, 20.56it/s] 32%|███▏      | 310/981 [00:15<00:32, 20.70it/s] 32%|███▏      | 313/981 [00:15<00:32, 20.33it/s] 32%|███▏      | 316/981 [00:15<00:32, 20.57it/s] 33%|███▎      | 319/981 [00:15<00:32, 20.52it/s] 33%|███▎      | 322/981 [00:15<00:32, 20.54it/s] 33%|███▎      | 325/981 [00:15<00:31, 20.76it/s] 33%|███▎      | 328/981 [00:15<00:31, 20.79it/s] 34%|███▎      | 331/981 [00:16<00:31, 20.88it/s] 34%|███▍      | 334/981 [00:16<00:30, 20.96it/s] 34%|███▍      | 337/981 [00:16<00:30, 20.88it/s] 35%|███▍      | 340/981 [00:16<00:30, 21.04it/s] 35%|███▍      | 343/981 [00:16<00:30, 21.10it/s] 35%|███▌      | 346/981 [00:16<00:30, 20.98it/s] 36%|███▌      | 349/981 [00:16<00:29, 21.12it/s] 36%|███▌      | 352/981 [00:17<00:29, 21.06it/s] 36%|███▌      | 355/981 [00:17<00:29, 20.99it/s] 36%|███▋      | 358/981 [00:17<00:29, 21.11it/s] 37%|███▋      | 361/981 [00:17<00:29, 20.93it/s] 37%|███▋      | 364/981 [00:17<00:29, 20.92it/s] 37%|███▋      | 367/981 [00:17<00:29, 20.79it/s] 38%|███▊      | 370/981 [00:17<00:29, 20.49it/s] 38%|███▊      | 373/981 [00:18<00:29, 20.52it/s] 38%|███▊      | 376/981 [00:18<00:29, 20.37it/s] 39%|███▊      | 379/981 [00:18<00:29, 20.38it/s] 39%|███▉      | 382/981 [00:18<00:29, 20.40it/s] 39%|███▉      | 385/981 [00:18<00:29, 20.49it/s] 40%|███▉      | 388/981 [00:18<00:28, 20.66it/s] 40%|███▉      | 391/981 [00:18<00:28, 20.56it/s] 40%|████      | 394/981 [00:19<00:28, 20.74it/s] 40%|████      | 397/981 [00:19<00:28, 20.82it/s] 41%|████      | 400/981 [00:19<00:27, 20.82it/s] 41%|████      | 403/981 [00:19<00:27, 20.99it/s] 41%|████▏     | 406/981 [00:19<00:27, 20.89it/s] 42%|████▏     | 409/981 [00:19<00:27, 20.98it/s] 42%|████▏     | 412/981 [00:19<00:27, 20.96it/s] 42%|████▏     | 415/981 [00:20<00:27, 20.89it/s] 43%|████▎     | 418/981 [00:20<00:26, 20.96it/s] 43%|████▎     | 421/981 [00:20<00:26, 21.04it/s] 43%|████▎     | 424/981 [00:20<00:26, 21.09it/s] 44%|████▎     | 427/981 [00:20<00:26, 21.10it/s] 44%|████▍     | 430/981 [00:20<00:26, 20.42it/s] 44%|████▍     | 433/981 [00:20<00:26, 20.83it/s] 44%|████▍     | 436/981 [00:21<00:26, 20.94it/s] 45%|████▍     | 439/981 [00:21<00:26, 20.82it/s] 45%|████▌     | 442/981 [00:21<00:26, 20.63it/s] 45%|████▌     | 445/981 [00:21<00:25, 20.63it/s] 46%|████▌     | 448/981 [00:21<00:25, 20.75it/s] 46%|████▌     | 451/981 [00:21<00:25, 20.84it/s] 46%|████▋     | 454/981 [00:21<00:25, 20.76it/s] 47%|████▋     | 457/981 [00:22<00:25, 20.94it/s] 47%|████▋     | 460/981 [00:22<00:25, 20.77it/s] 47%|████▋     | 463/981 [00:22<00:24, 20.85it/s] 48%|████▊     | 466/981 [00:22<00:24, 20.99it/s] 48%|████▊     | 469/981 [00:22<00:24, 20.77it/s] 48%|████▊     | 472/981 [00:22<00:24, 20.95it/s] 48%|████▊     | 475/981 [00:22<00:24, 20.82it/s] 49%|████▊     | 478/981 [00:23<00:24, 20.83it/s] 49%|████▉     | 481/981 [00:23<00:23, 21.13it/s] 49%|████▉     | 484/981 [00:23<00:23, 21.03it/s] 50%|████▉     | 487/981 [00:23<00:23, 21.10it/s] 50%|████▉     | 490/981 [00:23<00:23, 21.27it/s] 50%|█████     | 493/981 [00:23<00:23, 21.01it/s] 51%|█████     | 496/981 [00:23<00:22, 21.10it/s] 51%|█████     | 499/981 [00:24<00:22, 21.10it/s] 51%|█████     | 502/981 [00:24<00:22, 21.14it/s] 51%|█████▏    | 505/981 [00:24<00:22, 21.23it/s] 52%|█████▏    | 508/981 [00:24<00:22, 21.13it/s] 52%|█████▏    | 511/981 [00:24<00:22, 21.23it/s] 52%|█████▏    | 514/981 [00:24<00:22, 21.19it/s] 53%|█████▎    | 517/981 [00:24<00:21, 21.17it/s] 53%|█████▎    | 520/981 [00:25<00:21, 21.37it/s] 53%|█████▎    | 523/981 [00:25<00:21, 21.36it/s] 54%|█████▎    | 526/981 [00:25<00:21, 21.51it/s] 54%|█████▍    | 529/981 [00:25<00:21, 21.40it/s] 54%|█████▍    | 532/981 [00:25<00:22, 20.11it/s] 55%|█████▍    | 535/981 [00:25<00:21, 20.57it/s] 55%|█████▍    | 538/981 [00:25<00:21, 20.23it/s] 55%|█████▌    | 541/981 [00:26<00:21, 20.23it/s] 55%|█████▌    | 544/981 [00:26<00:21, 20.62it/s] 56%|█████▌    | 547/981 [00:26<00:21, 20.22it/s] 56%|█████▌    | 550/981 [00:26<00:20, 20.65it/s] 56%|█████▋    | 553/981 [00:26<00:20, 21.00it/s] 57%|█████▋    | 556/981 [00:26<00:20, 21.01it/s] 57%|█████▋    | 559/981 [00:26<00:19, 21.36it/s] 57%|█████▋    | 562/981 [00:27<00:19, 21.48it/s] 58%|█████▊    | 565/981 [00:27<00:19, 21.47it/s] 58%|█████▊    | 568/981 [00:27<00:19, 21.56it/s] 58%|█████▊    | 571/981 [00:27<00:19, 21.53it/s] 59%|█████▊    | 574/981 [00:27<00:18, 21.60it/s] 59%|█████▉    | 577/981 [00:27<00:18, 21.77it/s] 59%|█████▉    | 580/981 [00:27<00:18, 21.81it/s] 59%|█████▉    | 583/981 [00:28<00:18, 21.96it/s] 60%|█████▉    | 586/981 [00:28<00:18, 21.83it/s] 60%|██████    | 589/981 [00:28<00:17, 21.85it/s] 60%|██████    | 592/981 [00:28<00:17, 21.99it/s] 61%|██████    | 595/981 [00:28<00:17, 21.80it/s] 61%|██████    | 598/981 [00:28<00:17, 21.77it/s] 61%|██████▏   | 601/981 [00:28<00:17, 21.84it/s] 62%|██████▏   | 604/981 [00:29<00:18, 20.93it/s] 62%|██████▏   | 607/981 [00:29<00:17, 21.21it/s] 62%|██████▏   | 610/981 [00:29<00:17, 21.31it/s] 62%|██████▏   | 613/981 [00:29<00:17, 21.32it/s] 63%|██████▎   | 616/981 [00:29<00:17, 21.44it/s] 63%|██████▎   | 619/981 [00:29<00:16, 21.46it/s] 63%|██████▎   | 622/981 [00:29<00:16, 21.51it/s] 64%|██████▎   | 625/981 [00:30<00:16, 21.67it/s] 64%|██████▍   | 628/981 [00:30<00:16, 21.49it/s] 64%|██████▍   | 631/981 [00:30<00:16, 21.73it/s] 65%|██████▍   | 634/981 [00:30<00:15, 21.93it/s] 65%|██████▍   | 637/981 [00:30<00:15, 21.70it/s] 65%|██████▌   | 640/981 [00:30<00:15, 21.84it/s] 66%|██████▌   | 643/981 [00:30<00:15, 21.92it/s] 66%|██████▌   | 646/981 [00:30<00:15, 21.75it/s] 66%|██████▌   | 649/981 [00:31<00:15, 21.94it/s] 66%|██████▋   | 652/981 [00:31<00:15, 21.81it/s] 67%|██████▋   | 655/981 [00:31<00:14, 21.83it/s] 67%|██████▋   | 658/981 [00:31<00:14, 21.99it/s] 67%|██████▋   | 661/981 [00:31<00:14, 21.73it/s] 68%|██████▊   | 664/981 [00:31<00:14, 21.86it/s] 68%|██████▊   | 667/981 [00:31<00:14, 21.85it/s] 68%|██████▊   | 670/981 [00:32<00:14, 21.63it/s] 69%|██████▊   | 673/981 [00:32<00:14, 21.78it/s] 69%|██████▉   | 676/981 [00:32<00:14, 21.69it/s] 69%|██████▉   | 679/981 [00:32<00:13, 21.60it/s] 70%|██████▉   | 682/981 [00:32<00:13, 21.72it/s] 70%|██████▉   | 685/981 [00:32<00:13, 21.36it/s] 70%|███████   | 688/981 [00:32<00:13, 21.25it/s] 70%|███████   | 691/981 [00:33<00:13, 21.38it/s] 71%|███████   | 694/981 [00:33<00:13, 21.34it/s] 71%|███████   | 697/981 [00:33<00:13, 21.59it/s] 71%|███████▏  | 700/981 [00:33<00:13, 21.25it/s] 72%|███████▏  | 703/981 [00:33<00:13, 21.34it/s] 72%|███████▏  | 706/981 [00:33<00:12, 21.61it/s] 72%|███████▏  | 709/981 [00:33<00:12, 21.45it/s] 73%|███████▎  | 712/981 [00:34<00:12, 21.70it/s] 73%|███████▎  | 715/981 [00:34<00:12, 21.74it/s] 73%|███████▎  | 718/981 [00:34<00:12, 21.64it/s] 73%|███████▎  | 721/981 [00:34<00:11, 21.82it/s] 74%|███████▍  | 724/981 [00:34<00:11, 21.72it/s] 74%|███████▍  | 727/981 [00:34<00:11, 21.69it/s] 74%|███████▍  | 730/981 [00:34<00:11, 21.87it/s] 75%|███████▍  | 733/981 [00:35<00:11, 21.59it/s] 75%|███████▌  | 736/981 [00:35<00:11, 21.75it/s] 75%|███████▌  | 739/981 [00:35<00:11, 21.72it/s] 76%|███████▌  | 742/981 [00:35<00:11, 21.53it/s] 76%|███████▌  | 745/981 [00:35<00:10, 21.70it/s] 76%|███████▌  | 748/981 [00:35<00:10, 21.50it/s] 77%|███████▋  | 751/981 [00:35<00:10, 21.37it/s] 77%|███████▋  | 754/981 [00:35<00:10, 21.39it/s] 77%|███████▋  | 757/981 [00:36<00:10, 21.18it/s] 77%|███████▋  | 760/981 [00:36<00:10, 21.30it/s] 78%|███████▊  | 763/981 [00:36<00:10, 21.40it/s] 78%|███████▊  | 766/981 [00:36<00:10, 21.11it/s] 78%|███████▊  | 769/981 [00:36<00:09, 21.37it/s] 79%|███████▊  | 772/981 [00:36<00:09, 21.38it/s] 79%|███████▉  | 775/981 [00:36<00:09, 21.31it/s] 79%|███████▉  | 778/981 [00:37<00:09, 21.46it/s] 80%|███████▉  | 781/981 [00:37<00:09, 21.44it/s] 80%|███████▉  | 784/981 [00:37<00:09, 21.81it/s] 80%|████████  | 787/981 [00:37<00:08, 22.44it/s] 81%|████████  | 790/981 [00:37<00:08, 22.70it/s] 81%|████████  | 793/981 [00:37<00:08, 23.35it/s] 81%|████████  | 796/981 [00:37<00:07, 23.91it/s] 81%|████████▏ | 799/981 [00:38<00:07, 24.16it/s] 82%|████████▏ | 802/981 [00:38<00:07, 24.63it/s] 82%|████████▏ | 805/981 [00:38<00:07, 25.08it/s] 82%|████████▏ | 808/981 [00:38<00:06, 25.21it/s] 83%|████████▎ | 811/981 [00:38<00:06, 25.39it/s] 83%|████████▎ | 814/981 [00:38<00:06, 25.68it/s] 83%|████████▎ | 817/981 [00:38<00:06, 25.64it/s] 84%|████████▎ | 820/981 [00:38<00:06, 25.59it/s] 84%|████████▍ | 823/981 [00:38<00:06, 25.86it/s] 84%|████████▍ | 826/981 [00:39<00:06, 25.60it/s] 85%|████████▍ | 829/981 [00:39<00:06, 25.24it/s] 85%|████████▍ | 832/981 [00:39<00:05, 24.98it/s] 85%|████████▌ | 835/981 [00:39<00:05, 24.83it/s] 85%|████████▌ | 838/981 [00:39<00:05, 24.88it/s] 86%|████████▌ | 841/981 [00:39<00:05, 25.26it/s] 86%|████████▌ | 844/981 [00:39<00:05, 25.45it/s] 86%|████████▋ | 847/981 [00:39<00:05, 25.22it/s] 87%|████████▋ | 850/981 [00:40<00:05, 25.41it/s] 87%|████████▋ | 853/981 [00:40<00:04, 25.62it/s] 87%|████████▋ | 856/981 [00:40<00:04, 25.30it/s] 88%|████████▊ | 859/981 [00:40<00:04, 25.37it/s] 88%|████████▊ | 862/981 [00:40<00:04, 25.32it/s] 88%|████████▊ | 865/981 [00:40<00:04, 24.95it/s] 88%|████████▊ | 868/981 [00:40<00:04, 25.18it/s] 89%|████████▉ | 871/981 [00:40<00:04, 25.50it/s] 89%|████████▉ | 874/981 [00:40<00:04, 25.49it/s] 89%|████████▉ | 877/981 [00:41<00:04, 25.61it/s] 90%|████████▉ | 880/981 [00:41<00:03, 25.94it/s] 90%|█████████ | 883/981 [00:41<00:03, 25.98it/s] 90%|█████████ | 886/981 [00:41<00:03, 25.90it/s] 91%|█████████ | 889/981 [00:41<00:03, 26.14it/s] 91%|█████████ | 892/981 [00:41<00:03, 26.29it/s] 91%|█████████ | 895/981 [00:41<00:03, 25.97it/s] 92%|█████████▏| 898/981 [00:41<00:03, 26.17it/s] 92%|█████████▏| 901/981 [00:41<00:03, 26.30it/s] 92%|█████████▏| 904/981 [00:42<00:02, 25.98it/s] 92%|█████████▏| 907/981 [00:42<00:02, 26.06it/s] 93%|█████████▎| 910/981 [00:42<00:02, 26.29it/s] 93%|█████████▎| 913/981 [00:42<00:02, 26.11it/s] 93%|█████████▎| 916/981 [00:42<00:02, 26.02it/s] 94%|█████████▎| 919/981 [00:42<00:02, 26.19it/s] 94%|█████████▍| 922/981 [00:42<00:02, 26.12it/s] 94%|█████████▍| 925/981 [00:42<00:02, 25.90it/s] 95%|█████████▍| 928/981 [00:43<00:02, 26.14it/s] 95%|█████████▍| 931/981 [00:43<00:01, 26.42it/s] 95%|█████████▌| 934/981 [00:43<00:01, 26.05it/s] 96%|█████████▌| 937/981 [00:43<00:01, 26.07it/s] 96%|█████████▌| 940/981 [00:43<00:01, 26.01it/s] 96%|█████████▌| 943/981 [00:43<00:01, 25.78it/s] 96%|█████████▋| 946/981 [00:43<00:01, 25.66it/s] 97%|█████████▋| 949/981 [00:43<00:01, 25.78it/s] 97%|█████████▋| 952/981 [00:43<00:01, 25.68it/s] 97%|█████████▋| 955/981 [00:44<00:01, 25.53it/s] 98%|█████████▊| 958/981 [00:44<00:00, 25.73it/s] 98%|█████████▊| 961/981 [00:44<00:00, 25.71it/s] 98%|█████████▊| 964/981 [00:44<00:00, 25.47it/s] 99%|█████████▊| 967/981 [00:44<00:00, 25.64it/s] 99%|█████████▉| 970/981 [00:44<00:00, 25.91it/s] 99%|█████████▉| 973/981 [00:44<00:00, 25.68it/s] 99%|█████████▉| 976/981 [00:44<00:00, 25.88it/s]100%|█████████▉| 979/981 [00:44<00:00, 26.18it/s]100%|██████████| 981/981 [00:45<00:00, 21.77it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.041, train acc : 0.738, valid acc : 0.979, train f1 : 0.734, valid f1 : 0.776
training process:   2%|▏         | 1/50 [08:00<6:32:36, 480.74s/it]training process:   4%|▍         | 2/50 [15:55<6:21:37, 477.04s/it]training process:   6%|▌         | 3/50 [23:47<6:11:58, 474.86s/it]training process:   8%|▊         | 4/50 [31:36<6:02:21, 472.65s/it]epoch : 5, train loss : 0.078, valid loss : 0.020, train acc : 0.888, valid acc : 0.985, train f1 : 0.888, valid f1 : 0.822
training process:  10%|█         | 5/50 [39:26<5:53:47, 471.71s/it]training process:  12%|█▏        | 6/50 [47:13<5:44:48, 470.19s/it]training process:  14%|█▍        | 7/50 [55:03<5:36:45, 469.90s/it]training process:  16%|█▌        | 8/50 [1:02:50<5:28:25, 469.18s/it]epoch : 9, train loss : 0.065, valid loss : 0.028, train acc : 0.901, valid acc : 0.978, train f1 : 0.901, valid f1 : 0.787
training process:  18%|█▊        | 9/50 [1:10:36<5:19:46, 467.95s/it]training process:  20%|██        | 10/50 [1:18:25<5:12:18, 468.47s/it]training process:  22%|██▏       | 11/50 [1:26:13<5:04:21, 468.24s/it]training process:  24%|██▍       | 12/50 [1:34:03<4:56:48, 468.64s/it]epoch : 13, train loss : 0.058, valid loss : 0.023, train acc : 0.911, valid acc : 0.979, train f1 : 0.911, valid f1 : 0.791
training process:  26%|██▌       | 13/50 [1:41:50<4:48:44, 468.23s/it]training process:  28%|██▊       | 14/50 [1:49:38<4:40:52, 468.11s/it]training process:  30%|███       | 15/50 [1:57:25<4:32:59, 467.99s/it]training process:  32%|███▏      | 16/50 [2:05:14<4:25:16, 468.14s/it]epoch : 17, train loss : 0.054, valid loss : 0.021, train acc : 0.918, valid acc : 0.984, train f1 : 0.918, valid f1 : 0.822
training process:  34%|███▍      | 17/50 [2:13:03<4:17:42, 468.57s/it]training process:  36%|███▌      | 18/50 [2:20:55<4:10:25, 469.54s/it]training process:  38%|███▊      | 19/50 [2:28:46<4:02:43, 469.78s/it]training process:  40%|████      | 20/50 [2:36:34<3:54:41, 469.38s/it]epoch : 21, train loss : 0.054, valid loss : 0.012, train acc : 0.919, valid acc : 0.992, train f1 : 0.919, valid f1 : 0.888
training process:  42%|████▏     | 21/50 [2:44:28<3:47:29, 470.67s/it]training process:  44%|████▍     | 22/50 [2:52:16<3:39:16, 469.87s/it]training process:  46%|████▌     | 23/50 [3:00:06<3:31:30, 470.01s/it]training process:  48%|████▊     | 24/50 [3:07:57<3:23:45, 470.21s/it]epoch : 25, train loss : 0.050, valid loss : 0.018, train acc : 0.925, valid acc : 0.991, train f1 : 0.925, valid f1 : 0.882
training process:  50%|█████     | 25/50 [3:15:46<3:15:50, 470.01s/it]training process:  52%|█████▏    | 26/50 [3:23:38<3:08:09, 470.41s/it]training process:  54%|█████▍    | 27/50 [3:31:28<3:00:17, 470.34s/it]training process:  56%|█████▌    | 28/50 [3:39:19<2:52:29, 470.45s/it]epoch : 29, train loss : 0.051, valid loss : 0.023, train acc : 0.924, valid acc : 0.956, train f1 : 0.924, valid f1 : 0.696
training process:  58%|█████▊    | 29/50 [3:47:09<2:44:39, 470.47s/it]training process:  60%|██████    | 30/50 [3:55:00<2:36:53, 470.66s/it]training process:  62%|██████▏   | 31/50 [4:02:50<2:28:56, 470.35s/it]training process:  64%|██████▍   | 32/50 [4:10:41<2:21:10, 470.61s/it]epoch : 33, train loss : 0.045, valid loss : 0.026, train acc : 0.929, valid acc : 0.982, train f1 : 0.929, valid f1 : 0.814
training process:  66%|██████▌   | 33/50 [4:18:32<2:13:21, 470.68s/it]training process:  68%|██████▊   | 34/50 [4:26:24<2:05:38, 471.14s/it]training process:  70%|███████   | 35/50 [4:34:16<1:57:50, 471.37s/it]training process:  72%|███████▏  | 36/50 [4:42:09<1:50:08, 472.00s/it]epoch : 37, train loss : 0.045, valid loss : 0.019, train acc : 0.932, valid acc : 0.983, train f1 : 0.932, valid f1 : 0.818
training process:  74%|███████▍  | 37/50 [4:49:59<1:42:05, 471.22s/it]training process:  76%|███████▌  | 38/50 [4:57:48<1:34:07, 470.59s/it]training process:  78%|███████▊  | 39/50 [5:05:39<1:26:18, 470.77s/it]training process:  80%|████████  | 40/50 [5:13:27<1:18:18, 469.83s/it]epoch : 41, train loss : 0.046, valid loss : 0.018, train acc : 0.929, valid acc : 0.986, train f1 : 0.929, valid f1 : 0.835
training process:  82%|████████▏ | 41/50 [5:21:12<1:10:16, 468.46s/it]training process:  84%|████████▍ | 42/50 [5:29:02<1:02:30, 468.79s/it]training process:  86%|████████▌ | 43/50 [5:36:51<54:42, 468.95s/it]  training process:  88%|████████▊ | 44/50 [5:44:41<46:56, 469.41s/it]epoch : 45, train loss : 0.044, valid loss : 0.029, train acc : 0.935, valid acc : 0.973, train f1 : 0.935, valid f1 : 0.761
training process:  90%|█████████ | 45/50 [5:52:39<39:19, 471.88s/it]training process:  92%|█████████▏| 46/50 [6:00:29<31:24, 471.17s/it]training process:  94%|█████████▍| 47/50 [6:08:17<23:31, 470.48s/it]training process:  96%|█████████▌| 48/50 [6:16:08<15:41, 470.62s/it]epoch : 49, train loss : 0.042, valid loss : 0.026, train acc : 0.935, valid acc : 0.984, train f1 : 0.935, valid f1 : 0.822
training process:  98%|█████████▊| 49/50 [6:23:58<07:50, 470.42s/it]training process: 100%|██████████| 50/50 [6:31:47<00:00, 470.01s/it]training process: 100%|██████████| 50/50 [6:31:47<00:00, 470.16s/it]
training process finished, best loss : 0.011 and best acc : 0.993, best f1 : 0.909, best epoch : 15

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.83      0.68        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.78      0.91      0.84      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.84, test AUC : 0.91, test loss : 0.221

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:51, 19.11it/s]  1%|          | 5/981 [00:00<00:47, 20.49it/s]  1%|          | 8/981 [00:00<00:47, 20.70it/s]  1%|          | 11/981 [00:00<00:46, 20.87it/s]  1%|▏         | 14/981 [00:00<00:46, 21.02it/s]  2%|▏         | 17/981 [00:00<00:46, 20.95it/s]  2%|▏         | 20/981 [00:00<00:45, 20.96it/s]  2%|▏         | 23/981 [00:01<00:45, 21.29it/s]  3%|▎         | 26/981 [00:01<00:44, 21.26it/s]  3%|▎         | 29/981 [00:01<00:44, 21.27it/s]  3%|▎         | 32/981 [00:01<00:44, 21.24it/s]  4%|▎         | 35/981 [00:01<00:44, 21.07it/s]  4%|▍         | 38/981 [00:01<00:44, 21.33it/s]  4%|▍         | 41/981 [00:01<00:44, 21.21it/s]  4%|▍         | 44/981 [00:02<00:44, 21.19it/s]  5%|▍         | 47/981 [00:02<00:43, 21.34it/s]  5%|▌         | 50/981 [00:02<00:44, 21.15it/s]  5%|▌         | 53/981 [00:02<00:43, 21.24it/s]  6%|▌         | 56/981 [00:02<00:43, 21.04it/s]  6%|▌         | 59/981 [00:02<00:43, 21.10it/s]  6%|▋         | 62/981 [00:02<00:43, 21.14it/s]  7%|▋         | 65/981 [00:03<00:43, 21.04it/s]  7%|▋         | 68/981 [00:03<00:43, 21.08it/s]  7%|▋         | 71/981 [00:03<00:43, 21.12it/s]  8%|▊         | 74/981 [00:03<00:43, 21.09it/s]  8%|▊         | 77/981 [00:03<00:42, 21.17it/s]  8%|▊         | 80/981 [00:03<00:42, 21.10it/s]  8%|▊         | 83/981 [00:03<00:42, 21.21it/s]  9%|▉         | 86/981 [00:04<00:42, 21.16it/s]  9%|▉         | 89/981 [00:04<00:42, 21.10it/s]  9%|▉         | 92/981 [00:04<00:41, 21.26it/s] 10%|▉         | 95/981 [00:04<00:41, 21.19it/s] 10%|▉         | 98/981 [00:04<00:41, 21.06it/s] 10%|█         | 101/981 [00:04<00:41, 21.10it/s] 11%|█         | 104/981 [00:04<00:41, 21.07it/s] 11%|█         | 107/981 [00:05<00:41, 21.05it/s] 11%|█         | 110/981 [00:05<00:41, 21.10it/s] 12%|█▏        | 113/981 [00:05<00:41, 20.93it/s] 12%|█▏        | 116/981 [00:05<00:41, 21.02it/s] 12%|█▏        | 119/981 [00:05<00:41, 20.92it/s] 12%|█▏        | 122/981 [00:05<00:40, 20.98it/s] 13%|█▎        | 125/981 [00:05<00:40, 21.01it/s] 13%|█▎        | 128/981 [00:06<00:41, 20.64it/s] 13%|█▎        | 131/981 [00:06<00:41, 20.63it/s] 14%|█▎        | 134/981 [00:06<00:41, 20.46it/s] 14%|█▍        | 137/981 [00:06<00:41, 20.41it/s] 14%|█▍        | 140/981 [00:06<00:40, 20.59it/s] 15%|█▍        | 143/981 [00:06<00:40, 20.66it/s] 15%|█▍        | 146/981 [00:06<00:40, 20.62it/s] 15%|█▌        | 149/981 [00:07<00:40, 20.73it/s] 15%|█▌        | 152/981 [00:07<00:39, 20.77it/s] 16%|█▌        | 155/981 [00:07<00:39, 20.83it/s] 16%|█▌        | 158/981 [00:07<00:39, 20.97it/s] 16%|█▋        | 161/981 [00:07<00:39, 20.97it/s] 17%|█▋        | 164/981 [00:07<00:38, 21.03it/s] 17%|█▋        | 167/981 [00:07<00:38, 21.09it/s] 17%|█▋        | 170/981 [00:08<00:38, 20.96it/s] 18%|█▊        | 173/981 [00:08<00:38, 21.02it/s] 18%|█▊        | 176/981 [00:08<00:38, 21.10it/s] 18%|█▊        | 179/981 [00:08<00:38, 21.03it/s] 19%|█▊        | 182/981 [00:08<00:37, 21.12it/s] 19%|█▉        | 185/981 [00:08<00:37, 21.05it/s] 19%|█▉        | 188/981 [00:08<00:37, 21.04it/s] 19%|█▉        | 191/981 [00:09<00:37, 21.25it/s] 20%|█▉        | 194/981 [00:09<00:37, 21.13it/s] 20%|██        | 197/981 [00:09<00:36, 21.30it/s] 20%|██        | 200/981 [00:09<00:36, 21.24it/s] 21%|██        | 203/981 [00:09<00:36, 21.21it/s] 21%|██        | 206/981 [00:09<00:36, 21.29it/s] 21%|██▏       | 209/981 [00:09<00:36, 21.00it/s] 22%|██▏       | 212/981 [00:10<00:36, 21.09it/s] 22%|██▏       | 215/981 [00:10<00:36, 20.97it/s] 22%|██▏       | 218/981 [00:10<00:36, 20.70it/s] 23%|██▎       | 221/981 [00:10<00:36, 20.94it/s] 23%|██▎       | 224/981 [00:10<00:36, 20.46it/s] 23%|██▎       | 227/981 [00:10<00:36, 20.62it/s] 23%|██▎       | 230/981 [00:10<00:36, 20.56it/s] 24%|██▍       | 233/981 [00:11<00:37, 20.15it/s] 24%|██▍       | 236/981 [00:11<00:37, 20.08it/s] 24%|██▍       | 239/981 [00:11<00:37, 19.93it/s] 25%|██▍       | 241/981 [00:11<00:37, 19.71it/s] 25%|██▍       | 244/981 [00:11<00:36, 19.99it/s] 25%|██▌       | 246/981 [00:11<00:36, 19.97it/s] 25%|██▌       | 249/981 [00:11<00:36, 20.31it/s] 26%|██▌       | 252/981 [00:12<00:35, 20.51it/s] 26%|██▌       | 255/981 [00:12<00:35, 20.51it/s] 26%|██▋       | 258/981 [00:12<00:34, 20.90it/s] 27%|██▋       | 261/981 [00:12<00:34, 20.73it/s] 27%|██▋       | 264/981 [00:12<00:34, 20.75it/s] 27%|██▋       | 267/981 [00:12<00:34, 20.92it/s] 28%|██▊       | 270/981 [00:12<00:34, 20.32it/s] 28%|██▊       | 273/981 [00:13<00:33, 20.84it/s] 28%|██▊       | 276/981 [00:13<00:34, 20.70it/s] 28%|██▊       | 279/981 [00:13<00:33, 20.80it/s] 29%|██▊       | 282/981 [00:13<00:33, 20.92it/s] 29%|██▉       | 285/981 [00:13<00:33, 20.68it/s] 29%|██▉       | 288/981 [00:13<00:33, 20.75it/s] 30%|██▉       | 291/981 [00:13<00:33, 20.67it/s] 30%|██▉       | 294/981 [00:14<00:33, 20.61it/s] 30%|███       | 297/981 [00:14<00:32, 20.74it/s] 31%|███       | 300/981 [00:14<00:33, 20.07it/s] 31%|███       | 303/981 [00:14<00:33, 20.43it/s] 31%|███       | 306/981 [00:14<00:33, 20.06it/s] 31%|███▏      | 309/981 [00:14<00:33, 19.95it/s] 32%|███▏      | 312/981 [00:14<00:33, 20.06it/s] 32%|███▏      | 315/981 [00:15<00:33, 19.62it/s] 32%|███▏      | 318/981 [00:15<00:32, 20.11it/s] 33%|███▎      | 321/981 [00:15<00:33, 19.59it/s] 33%|███▎      | 324/981 [00:15<00:32, 20.09it/s] 33%|███▎      | 327/981 [00:15<00:32, 20.24it/s] 34%|███▎      | 330/981 [00:15<00:32, 20.26it/s] 34%|███▍      | 333/981 [00:16<00:31, 20.41it/s] 34%|███▍      | 336/981 [00:16<00:31, 20.57it/s] 35%|███▍      | 339/981 [00:16<00:32, 20.02it/s] 35%|███▍      | 342/981 [00:16<00:31, 20.44it/s] 35%|███▌      | 345/981 [00:16<00:31, 20.47it/s] 35%|███▌      | 348/981 [00:16<00:31, 20.38it/s] 36%|███▌      | 351/981 [00:16<00:30, 20.36it/s] 36%|███▌      | 354/981 [00:17<00:30, 20.40it/s] 36%|███▋      | 357/981 [00:17<00:30, 20.38it/s] 37%|███▋      | 360/981 [00:17<00:30, 20.39it/s] 37%|███▋      | 363/981 [00:17<00:30, 20.39it/s] 37%|███▋      | 366/981 [00:17<00:30, 20.48it/s] 38%|███▊      | 369/981 [00:17<00:29, 20.44it/s] 38%|███▊      | 372/981 [00:17<00:29, 20.34it/s] 38%|███▊      | 375/981 [00:18<00:29, 20.47it/s] 39%|███▊      | 378/981 [00:18<00:29, 20.36it/s] 39%|███▉      | 381/981 [00:18<00:29, 20.46it/s] 39%|███▉      | 384/981 [00:18<00:29, 20.53it/s] 39%|███▉      | 387/981 [00:18<00:29, 20.48it/s] 40%|███▉      | 390/981 [00:18<00:28, 20.62it/s] 40%|████      | 393/981 [00:18<00:28, 20.49it/s] 40%|████      | 396/981 [00:19<00:28, 20.56it/s] 41%|████      | 399/981 [00:19<00:28, 20.67it/s] 41%|████      | 402/981 [00:19<00:28, 20.61it/s] 41%|████▏     | 405/981 [00:19<00:27, 20.79it/s] 42%|████▏     | 408/981 [00:19<00:27, 20.69it/s] 42%|████▏     | 411/981 [00:19<00:27, 20.75it/s] 42%|████▏     | 414/981 [00:19<00:27, 20.85it/s] 43%|████▎     | 417/981 [00:20<00:27, 20.74it/s] 43%|████▎     | 420/981 [00:20<00:26, 20.85it/s] 43%|████▎     | 423/981 [00:20<00:26, 20.86it/s] 43%|████▎     | 426/981 [00:20<00:26, 20.85it/s] 44%|████▎     | 429/981 [00:20<00:26, 21.08it/s] 44%|████▍     | 432/981 [00:20<00:26, 20.92it/s] 44%|████▍     | 435/981 [00:20<00:26, 20.75it/s] 45%|████▍     | 438/981 [00:21<00:26, 20.56it/s] 45%|████▍     | 441/981 [00:21<00:26, 20.54it/s] 45%|████▌     | 444/981 [00:21<00:25, 20.75it/s] 46%|████▌     | 447/981 [00:21<00:30, 17.57it/s] 46%|████▌     | 449/981 [00:21<00:30, 17.22it/s] 46%|████▌     | 451/981 [00:21<00:30, 17.25it/s] 46%|████▌     | 453/981 [00:21<00:29, 17.83it/s] 46%|████▋     | 456/981 [00:22<00:27, 18.86it/s] 47%|████▋     | 459/981 [00:22<00:26, 19.45it/s] 47%|████▋     | 462/981 [00:22<00:26, 19.85it/s] 47%|████▋     | 465/981 [00:22<00:25, 20.13it/s] 48%|████▊     | 468/981 [00:22<00:25, 20.25it/s] 48%|████▊     | 471/981 [00:22<00:24, 20.57it/s] 48%|████▊     | 474/981 [00:22<00:24, 20.65it/s] 49%|████▊     | 477/981 [00:23<00:24, 20.52it/s] 49%|████▉     | 480/981 [00:23<00:24, 20.83it/s] 49%|████▉     | 483/981 [00:23<00:24, 20.70it/s] 50%|████▉     | 486/981 [00:23<00:23, 20.64it/s] 50%|████▉     | 489/981 [00:23<00:24, 20.18it/s] 50%|█████     | 492/981 [00:23<00:24, 20.37it/s] 50%|█████     | 495/981 [00:24<00:23, 20.64it/s] 51%|█████     | 498/981 [00:24<00:23, 20.62it/s] 51%|█████     | 501/981 [00:24<00:22, 20.94it/s] 51%|█████▏    | 504/981 [00:24<00:22, 20.95it/s] 52%|█████▏    | 507/981 [00:24<00:23, 20.25it/s] 52%|█████▏    | 510/981 [00:24<00:22, 20.69it/s] 52%|█████▏    | 513/981 [00:24<00:22, 20.69it/s] 53%|█████▎    | 516/981 [00:25<00:22, 21.01it/s] 53%|█████▎    | 519/981 [00:25<00:21, 21.22it/s] 53%|█████▎    | 522/981 [00:25<00:21, 21.00it/s] 54%|█████▎    | 525/981 [00:25<00:21, 21.37it/s] 54%|█████▍    | 528/981 [00:25<00:21, 21.30it/s] 54%|█████▍    | 531/981 [00:25<00:21, 21.29it/s] 54%|█████▍    | 534/981 [00:25<00:20, 21.55it/s] 55%|█████▍    | 537/981 [00:26<00:20, 21.38it/s] 55%|█████▌    | 540/981 [00:26<00:20, 21.58it/s] 55%|█████▌    | 543/981 [00:26<00:20, 21.70it/s] 56%|█████▌    | 546/981 [00:26<00:20, 21.37it/s] 56%|█████▌    | 549/981 [00:26<00:20, 21.56it/s] 56%|█████▋    | 552/981 [00:26<00:20, 21.24it/s] 57%|█████▋    | 555/981 [00:26<00:20, 21.23it/s] 57%|█████▋    | 558/981 [00:26<00:19, 21.48it/s] 57%|█████▋    | 561/981 [00:27<00:19, 21.36it/s] 57%|█████▋    | 564/981 [00:27<00:19, 21.36it/s] 58%|█████▊    | 567/981 [00:27<00:19, 21.44it/s] 58%|█████▊    | 570/981 [00:27<00:19, 21.37it/s] 58%|█████▊    | 573/981 [00:27<00:18, 21.57it/s] 59%|█████▊    | 576/981 [00:27<00:18, 21.45it/s] 59%|█████▉    | 579/981 [00:27<00:18, 21.33it/s] 59%|█████▉    | 582/981 [00:28<00:18, 21.57it/s] 60%|█████▉    | 585/981 [00:28<00:18, 21.29it/s] 60%|█████▉    | 588/981 [00:28<00:18, 21.31it/s] 60%|██████    | 591/981 [00:28<00:18, 21.18it/s] 61%|██████    | 594/981 [00:28<00:18, 21.06it/s] 61%|██████    | 597/981 [00:28<00:18, 21.19it/s] 61%|██████    | 600/981 [00:28<00:17, 21.35it/s] 61%|██████▏   | 603/981 [00:29<00:17, 21.45it/s] 62%|██████▏   | 606/981 [00:29<00:17, 21.43it/s] 62%|██████▏   | 609/981 [00:29<00:17, 21.68it/s] 62%|██████▏   | 612/981 [00:29<00:17, 21.52it/s] 63%|██████▎   | 615/981 [00:29<00:17, 21.43it/s] 63%|██████▎   | 618/981 [00:29<00:16, 21.49it/s] 63%|██████▎   | 621/981 [00:29<00:16, 21.43it/s] 64%|██████▎   | 624/981 [00:30<00:16, 21.46it/s] 64%|██████▍   | 627/981 [00:30<00:16, 21.70it/s] 64%|██████▍   | 630/981 [00:30<00:16, 21.62it/s] 65%|██████▍   | 633/981 [00:30<00:17, 19.61it/s] 65%|██████▍   | 635/981 [00:30<00:17, 19.35it/s] 65%|██████▌   | 638/981 [00:30<00:17, 19.87it/s] 65%|██████▌   | 641/981 [00:30<00:16, 20.18it/s] 66%|██████▌   | 644/981 [00:31<00:16, 20.58it/s] 66%|██████▌   | 647/981 [00:31<00:15, 21.09it/s] 66%|██████▋   | 650/981 [00:31<00:15, 21.14it/s] 67%|██████▋   | 653/981 [00:31<00:15, 21.38it/s] 67%|██████▋   | 656/981 [00:31<00:15, 21.64it/s] 67%|██████▋   | 659/981 [00:31<00:15, 21.43it/s] 67%|██████▋   | 662/981 [00:31<00:14, 21.28it/s] 68%|██████▊   | 665/981 [00:32<00:14, 21.29it/s] 68%|██████▊   | 668/981 [00:32<00:14, 20.93it/s] 68%|██████▊   | 671/981 [00:32<00:14, 20.97it/s] 69%|██████▊   | 674/981 [00:32<00:14, 21.21it/s] 69%|██████▉   | 677/981 [00:32<00:14, 20.95it/s] 69%|██████▉   | 680/981 [00:32<00:14, 21.25it/s] 70%|██████▉   | 683/981 [00:32<00:13, 21.29it/s] 70%|██████▉   | 686/981 [00:33<00:13, 21.47it/s] 70%|███████   | 689/981 [00:33<00:13, 21.73it/s] 71%|███████   | 692/981 [00:33<00:13, 21.48it/s] 71%|███████   | 695/981 [00:33<00:13, 21.44it/s] 71%|███████   | 698/981 [00:33<00:13, 21.72it/s] 71%|███████▏  | 701/981 [00:33<00:12, 21.63it/s] 72%|███████▏  | 704/981 [00:33<00:12, 21.73it/s] 72%|███████▏  | 707/981 [00:33<00:12, 21.70it/s] 72%|███████▏  | 710/981 [00:34<00:12, 21.62it/s] 73%|███████▎  | 713/981 [00:34<00:12, 21.74it/s] 73%|███████▎  | 716/981 [00:34<00:12, 21.57it/s] 73%|███████▎  | 719/981 [00:34<00:12, 21.55it/s] 74%|███████▎  | 722/981 [00:34<00:12, 21.57it/s] 74%|███████▍  | 725/981 [00:34<00:11, 21.44it/s] 74%|███████▍  | 728/981 [00:34<00:11, 21.70it/s] 75%|███████▍  | 731/981 [00:35<00:11, 21.89it/s] 75%|███████▍  | 734/981 [00:35<00:11, 21.99it/s] 75%|███████▌  | 737/981 [00:35<00:11, 21.57it/s] 75%|███████▌  | 740/981 [00:35<00:11, 20.13it/s] 76%|███████▌  | 743/981 [00:35<00:11, 20.68it/s] 76%|███████▌  | 746/981 [00:35<00:11, 20.89it/s] 76%|███████▋  | 749/981 [00:35<00:11, 20.65it/s] 77%|███████▋  | 752/981 [00:36<00:10, 21.19it/s] 77%|███████▋  | 755/981 [00:36<00:10, 21.42it/s] 77%|███████▋  | 758/981 [00:36<00:10, 21.87it/s] 78%|███████▊  | 761/981 [00:36<00:09, 22.21it/s] 78%|███████▊  | 764/981 [00:36<00:09, 22.32it/s] 78%|███████▊  | 767/981 [00:36<00:09, 22.50it/s] 78%|███████▊  | 770/981 [00:36<00:09, 22.61it/s] 79%|███████▉  | 773/981 [00:37<00:09, 22.65it/s] 79%|███████▉  | 776/981 [00:37<00:08, 22.78it/s] 79%|███████▉  | 779/981 [00:37<00:08, 22.99it/s] 80%|███████▉  | 782/981 [00:37<00:08, 22.90it/s] 80%|████████  | 785/981 [00:37<00:08, 23.33it/s] 80%|████████  | 788/981 [00:37<00:08, 24.07it/s] 81%|████████  | 791/981 [00:37<00:07, 24.49it/s] 81%|████████  | 794/981 [00:37<00:07, 24.90it/s] 81%|████████  | 797/981 [00:38<00:07, 25.57it/s] 82%|████████▏ | 800/981 [00:38<00:06, 25.99it/s] 82%|████████▏ | 803/981 [00:38<00:06, 26.31it/s] 82%|████████▏ | 806/981 [00:38<00:06, 26.79it/s] 82%|████████▏ | 809/981 [00:38<00:06, 26.74it/s] 83%|████████▎ | 812/981 [00:38<00:06, 26.82it/s] 83%|████████▎ | 815/981 [00:38<00:06, 26.88it/s] 83%|████████▎ | 818/981 [00:38<00:06, 27.14it/s] 84%|████████▎ | 821/981 [00:38<00:06, 25.75it/s] 84%|████████▍ | 824/981 [00:39<00:05, 26.22it/s] 84%|████████▍ | 827/981 [00:39<00:05, 26.78it/s] 85%|████████▍ | 830/981 [00:39<00:05, 26.42it/s] 85%|████████▍ | 833/981 [00:39<00:05, 26.89it/s] 85%|████████▌ | 836/981 [00:39<00:05, 27.22it/s] 86%|████████▌ | 839/981 [00:39<00:05, 27.42it/s] 86%|████████▌ | 842/981 [00:39<00:05, 27.33it/s] 86%|████████▌ | 845/981 [00:39<00:04, 27.52it/s] 86%|████████▋ | 848/981 [00:39<00:04, 27.58it/s] 87%|████████▋ | 851/981 [00:39<00:04, 27.74it/s] 87%|████████▋ | 854/981 [00:40<00:04, 27.90it/s] 87%|████████▋ | 857/981 [00:40<00:04, 27.74it/s] 88%|████████▊ | 860/981 [00:40<00:04, 27.76it/s] 88%|████████▊ | 863/981 [00:40<00:04, 27.81it/s] 88%|████████▊ | 866/981 [00:40<00:04, 27.66it/s] 89%|████████▊ | 869/981 [00:40<00:04, 27.33it/s] 89%|████████▉ | 872/981 [00:40<00:04, 27.01it/s] 89%|████████▉ | 875/981 [00:40<00:03, 26.54it/s] 90%|████████▉ | 878/981 [00:40<00:03, 26.57it/s] 90%|████████▉ | 881/981 [00:41<00:03, 26.52it/s] 90%|█████████ | 884/981 [00:41<00:03, 26.76it/s] 90%|█████████ | 887/981 [00:41<00:03, 26.54it/s] 91%|█████████ | 890/981 [00:41<00:03, 26.68it/s] 91%|█████████ | 893/981 [00:41<00:03, 26.88it/s] 91%|█████████▏| 896/981 [00:41<00:03, 26.92it/s] 92%|█████████▏| 899/981 [00:41<00:03, 26.99it/s] 92%|█████████▏| 902/981 [00:41<00:02, 27.03it/s] 92%|█████████▏| 905/981 [00:41<00:02, 27.09it/s] 93%|█████████▎| 908/981 [00:42<00:02, 26.90it/s] 93%|█████████▎| 911/981 [00:42<00:02, 27.06it/s] 93%|█████████▎| 914/981 [00:42<00:02, 27.08it/s] 93%|█████████▎| 917/981 [00:42<00:02, 27.02it/s] 94%|█████████▍| 920/981 [00:42<00:02, 26.92it/s] 94%|█████████▍| 923/981 [00:42<00:02, 26.90it/s] 94%|█████████▍| 926/981 [00:42<00:02, 27.04it/s] 95%|█████████▍| 929/981 [00:42<00:01, 27.09it/s] 95%|█████████▌| 932/981 [00:42<00:01, 26.99it/s] 95%|█████████▌| 935/981 [00:43<00:01, 26.86it/s] 96%|█████████▌| 938/981 [00:43<00:01, 26.91it/s] 96%|█████████▌| 941/981 [00:43<00:01, 26.84it/s] 96%|█████████▌| 944/981 [00:43<00:01, 26.82it/s] 97%|█████████▋| 947/981 [00:43<00:01, 26.77it/s] 97%|█████████▋| 950/981 [00:43<00:01, 26.74it/s] 97%|█████████▋| 953/981 [00:43<00:01, 26.71it/s] 97%|█████████▋| 956/981 [00:43<00:00, 26.73it/s] 98%|█████████▊| 959/981 [00:44<00:00, 26.57it/s] 98%|█████████▊| 962/981 [00:44<00:00, 26.78it/s] 98%|█████████▊| 965/981 [00:44<00:00, 26.79it/s] 99%|█████████▊| 968/981 [00:44<00:00, 26.68it/s] 99%|█████████▉| 971/981 [00:44<00:00, 26.61it/s] 99%|█████████▉| 974/981 [00:44<00:00, 26.71it/s]100%|█████████▉| 977/981 [00:44<00:00, 26.55it/s]100%|█████████▉| 980/981 [00:44<00:00, 26.62it/s]100%|██████████| 981/981 [00:44<00:00, 21.88it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.008, valid loss : 0.007, train acc : 0.977, valid acc : 0.982, train f1 : 0.564, valid f1 : 0.513
training process:   2%|▏         | 1/50 [07:59<6:31:49, 479.79s/it]training process:   4%|▍         | 2/50 [15:54<6:21:27, 476.83s/it]training process:   6%|▌         | 3/50 [23:52<6:13:45, 477.13s/it]training process:   8%|▊         | 4/50 [31:44<6:04:31, 475.47s/it]epoch : 5, train loss : 0.006, valid loss : 0.006, train acc : 0.973, valid acc : 0.972, train f1 : 0.544, valid f1 : 0.705
training process:  10%|█         | 5/50 [39:34<5:55:02, 473.40s/it]training process:  12%|█▏        | 6/50 [47:23<5:45:54, 471.69s/it]training process:  14%|█▍        | 7/50 [55:18<5:38:57, 472.96s/it]training process:  16%|█▌        | 8/50 [1:03:15<5:31:54, 474.15s/it]epoch : 9, train loss : 0.005, valid loss : 0.005, train acc : 0.981, valid acc : 0.990, train f1 : 0.719, valid f1 : 0.816
training process:  18%|█▊        | 9/50 [1:11:02<5:22:30, 471.97s/it]training process:  20%|██        | 10/50 [1:18:46<5:13:01, 469.53s/it]training process:  22%|██▏       | 11/50 [1:26:35<5:05:06, 469.39s/it]training process:  24%|██▍       | 12/50 [1:34:22<4:56:47, 468.61s/it]epoch : 13, train loss : 0.005, valid loss : 0.004, train acc : 0.974, valid acc : 0.985, train f1 : 0.666, valid f1 : 0.774
training process:  26%|██▌       | 13/50 [1:42:09<4:48:39, 468.10s/it]training process:  28%|██▊       | 14/50 [1:50:00<4:41:19, 468.86s/it]training process:  30%|███       | 15/50 [1:57:48<4:33:25, 468.74s/it]training process:  32%|███▏      | 16/50 [2:05:36<4:25:28, 468.49s/it]epoch : 17, train loss : 0.005, valid loss : 0.004, train acc : 0.980, valid acc : 0.990, train f1 : 0.688, valid f1 : 0.819
training process:  34%|███▍      | 17/50 [2:13:25<4:17:48, 468.75s/it]training process:  36%|███▌      | 18/50 [2:21:12<4:09:38, 468.06s/it]training process:  38%|███▊      | 19/50 [2:28:59<4:01:46, 467.96s/it]training process:  40%|████      | 20/50 [2:36:48<3:54:06, 468.22s/it]epoch : 21, train loss : 0.004, valid loss : 0.004, train acc : 0.988, valid acc : 0.988, train f1 : 0.773, valid f1 : 0.802
training process:  42%|████▏     | 21/50 [2:44:42<3:47:02, 469.74s/it]training process:  44%|████▍     | 22/50 [2:52:37<3:40:02, 471.52s/it]training process:  46%|████▌     | 23/50 [3:00:29<3:32:15, 471.69s/it]training process:  48%|████▊     | 24/50 [3:08:20<3:24:18, 471.50s/it]epoch : 25, train loss : 0.004, valid loss : 0.004, train acc : 0.986, valid acc : 0.986, train f1 : 0.752, valid f1 : 0.790
training process:  50%|█████     | 25/50 [3:16:08<3:15:59, 470.40s/it]training process:  52%|█████▏    | 26/50 [3:23:57<3:07:59, 469.98s/it]training process:  54%|█████▍    | 27/50 [3:31:47<3:00:11, 470.07s/it]training process:  56%|█████▌    | 28/50 [3:39:36<2:52:14, 469.74s/it]epoch : 29, train loss : 0.004, valid loss : 0.004, train acc : 0.985, valid acc : 0.985, train f1 : 0.754, valid f1 : 0.783
training process:  58%|█████▊    | 29/50 [3:47:26<2:44:23, 469.67s/it]training process:  60%|██████    | 30/50 [3:55:11<2:36:04, 468.24s/it]training process:  62%|██████▏   | 31/50 [4:03:04<2:28:45, 469.76s/it]training process:  64%|██████▍   | 32/50 [4:10:56<2:21:06, 470.33s/it]epoch : 33, train loss : 0.004, valid loss : 0.004, train acc : 0.959, valid acc : 0.986, train f1 : 0.629, valid f1 : 0.792
training process:  66%|██████▌   | 33/50 [4:18:47<2:13:20, 470.61s/it]training process:  68%|██████▊   | 34/50 [4:26:37<2:05:26, 470.40s/it]training process:  70%|███████   | 35/50 [4:34:33<1:58:00, 472.06s/it]training process:  72%|███████▏  | 36/50 [4:42:23<1:50:00, 471.50s/it]epoch : 37, train loss : 0.004, valid loss : 0.004, train acc : 0.937, valid acc : 0.991, train f1 : 0.617, valid f1 : 0.849
training process:  74%|███████▍  | 37/50 [4:50:18<1:42:20, 472.38s/it]training process:  76%|███████▌  | 38/50 [4:58:02<1:34:01, 470.14s/it]training process:  78%|███████▊  | 39/50 [5:05:50<1:26:04, 469.50s/it]training process:  80%|████████  | 40/50 [5:13:40<1:18:15, 469.53s/it]epoch : 41, train loss : 0.003, valid loss : 0.004, train acc : 0.941, valid acc : 0.989, train f1 : 0.637, valid f1 : 0.845
training process:  82%|████████▏ | 41/50 [5:21:30<1:10:27, 469.74s/it]training process:  84%|████████▍ | 42/50 [5:29:20<1:02:37, 469.66s/it]training process:  86%|████████▌ | 43/50 [5:37:13<54:54, 470.65s/it]  training process:  88%|████████▊ | 44/50 [5:45:00<46:57, 469.51s/it]epoch : 45, train loss : 0.003, valid loss : 0.006, train acc : 0.942, valid acc : 0.991, train f1 : 0.636, valid f1 : 0.858
training process:  90%|█████████ | 45/50 [5:52:48<39:05, 469.14s/it]training process:  92%|█████████▏| 46/50 [6:00:32<31:10, 467.67s/it]training process:  94%|█████████▍| 47/50 [6:08:16<23:19, 466.62s/it]training process:  96%|█████████▌| 48/50 [6:16:09<15:37, 468.56s/it]epoch : 49, train loss : 0.003, valid loss : 0.007, train acc : 0.956, valid acc : 0.991, train f1 : 0.679, valid f1 : 0.860
training process:  98%|█████████▊| 49/50 [6:24:02<07:49, 469.66s/it]training process: 100%|██████████| 50/50 [6:31:50<00:00, 469.29s/it]training process: 100%|██████████| 50/50 [6:31:50<00:00, 470.21s/it]
training process finished, best loss : 0.003 and best acc : 0.990, best f1 : 0.861, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.60      0.69      0.64        71
           1       0.99      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.80      0.84      0.82      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.82, test AUC : 0.84, test loss : 0.030

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:45, 21.54it/s]  1%|          | 6/981 [00:00<00:46, 21.10it/s]  1%|          | 9/981 [00:00<00:45, 21.37it/s]  1%|          | 12/981 [00:00<00:44, 21.87it/s]  2%|▏         | 15/981 [00:00<00:43, 22.00it/s]  2%|▏         | 18/981 [00:00<00:43, 22.17it/s]  2%|▏         | 21/981 [00:00<00:43, 22.24it/s]  2%|▏         | 24/981 [00:01<00:42, 22.26it/s]  3%|▎         | 27/981 [00:01<00:42, 22.34it/s]  3%|▎         | 30/981 [00:01<00:42, 22.27it/s]  3%|▎         | 33/981 [00:01<00:42, 22.17it/s]  4%|▎         | 36/981 [00:01<00:42, 22.12it/s]  4%|▍         | 39/981 [00:01<00:42, 22.04it/s]  4%|▍         | 42/981 [00:01<00:42, 22.08it/s]  5%|▍         | 45/981 [00:02<00:42, 22.10it/s]  5%|▍         | 48/981 [00:02<00:42, 22.07it/s]  5%|▌         | 51/981 [00:02<00:42, 21.92it/s]  6%|▌         | 54/981 [00:02<00:42, 21.77it/s]  6%|▌         | 57/981 [00:02<00:42, 21.78it/s]  6%|▌         | 60/981 [00:02<00:42, 21.86it/s]  6%|▋         | 63/981 [00:02<00:41, 22.05it/s]  7%|▋         | 66/981 [00:03<00:41, 21.98it/s]  7%|▋         | 69/981 [00:03<00:41, 21.74it/s]  7%|▋         | 72/981 [00:03<00:42, 21.60it/s]  8%|▊         | 75/981 [00:03<00:41, 21.57it/s]  8%|▊         | 78/981 [00:03<00:41, 21.58it/s]  8%|▊         | 81/981 [00:03<00:41, 21.69it/s]  9%|▊         | 84/981 [00:03<00:41, 21.81it/s]  9%|▉         | 87/981 [00:03<00:40, 21.83it/s]  9%|▉         | 90/981 [00:04<00:40, 21.94it/s]  9%|▉         | 93/981 [00:04<00:40, 22.04it/s] 10%|▉         | 96/981 [00:04<00:39, 22.16it/s] 10%|█         | 99/981 [00:04<00:39, 22.06it/s] 10%|█         | 102/981 [00:04<00:40, 21.63it/s] 11%|█         | 105/981 [00:04<00:40, 21.59it/s] 11%|█         | 108/981 [00:04<00:41, 21.21it/s] 11%|█▏        | 111/981 [00:05<00:40, 21.42it/s] 12%|█▏        | 114/981 [00:05<00:40, 21.58it/s] 12%|█▏        | 117/981 [00:05<00:40, 21.43it/s] 12%|█▏        | 120/981 [00:05<00:40, 21.02it/s] 13%|█▎        | 123/981 [00:05<00:40, 20.94it/s] 13%|█▎        | 126/981 [00:05<00:40, 21.26it/s] 13%|█▎        | 129/981 [00:05<00:39, 21.57it/s] 13%|█▎        | 132/981 [00:06<00:39, 21.75it/s] 14%|█▍        | 135/981 [00:06<00:38, 21.84it/s] 14%|█▍        | 138/981 [00:06<00:38, 21.90it/s] 14%|█▍        | 141/981 [00:06<00:38, 21.65it/s] 15%|█▍        | 144/981 [00:06<00:38, 21.58it/s] 15%|█▍        | 147/981 [00:06<00:38, 21.48it/s] 15%|█▌        | 150/981 [00:06<00:39, 21.27it/s] 16%|█▌        | 153/981 [00:07<00:38, 21.52it/s] 16%|█▌        | 156/981 [00:07<00:37, 21.78it/s] 16%|█▌        | 159/981 [00:07<00:37, 21.89it/s] 17%|█▋        | 162/981 [00:07<00:37, 22.03it/s] 17%|█▋        | 165/981 [00:07<00:36, 22.12it/s] 17%|█▋        | 168/981 [00:07<00:36, 22.12it/s] 17%|█▋        | 171/981 [00:07<00:36, 22.11it/s] 18%|█▊        | 174/981 [00:07<00:36, 22.07it/s] 18%|█▊        | 177/981 [00:08<00:36, 22.03it/s] 18%|█▊        | 180/981 [00:08<00:36, 22.09it/s] 19%|█▊        | 183/981 [00:08<00:36, 22.06it/s] 19%|█▉        | 186/981 [00:08<00:36, 22.07it/s] 19%|█▉        | 189/981 [00:08<00:36, 21.84it/s] 20%|█▉        | 192/981 [00:08<00:36, 21.90it/s] 20%|█▉        | 195/981 [00:08<00:35, 22.00it/s] 20%|██        | 198/981 [00:09<00:35, 22.12it/s] 20%|██        | 201/981 [00:09<00:35, 22.12it/s] 21%|██        | 204/981 [00:09<00:35, 22.08it/s] 21%|██        | 207/981 [00:09<00:35, 22.07it/s] 21%|██▏       | 210/981 [00:09<00:35, 21.96it/s] 22%|██▏       | 213/981 [00:09<00:35, 21.63it/s] 22%|██▏       | 216/981 [00:09<00:35, 21.37it/s] 22%|██▏       | 219/981 [00:10<00:35, 21.24it/s] 23%|██▎       | 222/981 [00:10<00:36, 21.06it/s] 23%|██▎       | 225/981 [00:10<00:35, 21.09it/s] 23%|██▎       | 228/981 [00:10<00:35, 21.25it/s] 24%|██▎       | 231/981 [00:10<00:35, 21.33it/s] 24%|██▍       | 234/981 [00:10<00:35, 21.29it/s] 24%|██▍       | 237/981 [00:10<00:34, 21.36it/s] 24%|██▍       | 240/981 [00:11<00:34, 21.30it/s] 25%|██▍       | 243/981 [00:11<00:34, 21.10it/s] 25%|██▌       | 246/981 [00:11<00:34, 21.06it/s] 25%|██▌       | 249/981 [00:11<00:34, 21.18it/s] 26%|██▌       | 252/981 [00:11<00:34, 21.17it/s] 26%|██▌       | 255/981 [00:11<00:34, 21.17it/s] 26%|██▋       | 258/981 [00:11<00:34, 21.13it/s] 27%|██▋       | 261/981 [00:12<00:33, 21.40it/s] 27%|██▋       | 264/981 [00:12<00:33, 21.59it/s] 27%|██▋       | 267/981 [00:12<00:32, 21.67it/s] 28%|██▊       | 270/981 [00:12<00:32, 21.77it/s] 28%|██▊       | 273/981 [00:12<00:32, 21.77it/s] 28%|██▊       | 276/981 [00:12<00:32, 21.78it/s] 28%|██▊       | 279/981 [00:12<00:32, 21.93it/s] 29%|██▊       | 282/981 [00:12<00:32, 21.73it/s] 29%|██▉       | 285/981 [00:13<00:32, 21.64it/s] 29%|██▉       | 288/981 [00:13<00:32, 21.48it/s] 30%|██▉       | 291/981 [00:13<00:32, 21.34it/s] 30%|██▉       | 294/981 [00:13<00:32, 21.23it/s] 30%|███       | 297/981 [00:13<00:32, 21.37it/s] 31%|███       | 300/981 [00:13<00:31, 21.33it/s] 31%|███       | 303/981 [00:13<00:31, 21.53it/s] 31%|███       | 306/981 [00:14<00:31, 21.51it/s] 31%|███▏      | 309/981 [00:14<00:31, 21.60it/s] 32%|███▏      | 312/981 [00:14<00:30, 21.70it/s] 32%|███▏      | 315/981 [00:14<00:30, 21.66it/s] 32%|███▏      | 318/981 [00:14<00:30, 21.58it/s] 33%|███▎      | 321/981 [00:14<00:30, 21.41it/s] 33%|███▎      | 324/981 [00:14<00:30, 21.28it/s] 33%|███▎      | 327/981 [00:15<00:30, 21.35it/s] 34%|███▎      | 330/981 [00:15<00:30, 21.30it/s] 34%|███▍      | 333/981 [00:15<00:30, 21.24it/s] 34%|███▍      | 336/981 [00:15<00:30, 21.43it/s] 35%|███▍      | 339/981 [00:15<00:29, 21.61it/s] 35%|███▍      | 342/981 [00:15<00:29, 21.71it/s] 35%|███▌      | 345/981 [00:15<00:29, 21.73it/s] 35%|███▌      | 348/981 [00:16<00:29, 21.76it/s] 36%|███▌      | 351/981 [00:16<00:28, 21.75it/s] 36%|███▌      | 354/981 [00:16<00:28, 21.76it/s] 36%|███▋      | 357/981 [00:16<00:28, 21.55it/s] 37%|███▋      | 360/981 [00:16<00:29, 21.37it/s] 37%|███▋      | 363/981 [00:16<00:29, 21.23it/s] 37%|███▋      | 366/981 [00:16<00:29, 21.10it/s] 38%|███▊      | 369/981 [00:17<00:28, 21.27it/s] 38%|███▊      | 372/981 [00:17<00:28, 21.26it/s] 38%|███▊      | 375/981 [00:17<00:28, 21.38it/s] 39%|███▊      | 378/981 [00:17<00:28, 21.47it/s] 39%|███▉      | 381/981 [00:17<00:28, 21.42it/s] 39%|███▉      | 384/981 [00:17<00:29, 20.56it/s] 39%|███▉      | 387/981 [00:17<00:29, 20.13it/s] 40%|███▉      | 390/981 [00:18<00:30, 19.60it/s] 40%|███▉      | 392/981 [00:18<00:29, 19.66it/s] 40%|████      | 395/981 [00:18<00:29, 19.94it/s] 41%|████      | 398/981 [00:18<00:28, 20.33it/s] 41%|████      | 401/981 [00:18<00:27, 20.77it/s] 41%|████      | 404/981 [00:18<00:27, 20.98it/s] 41%|████▏     | 407/981 [00:18<00:27, 21.17it/s] 42%|████▏     | 410/981 [00:19<00:26, 21.27it/s] 42%|████▏     | 413/981 [00:19<00:26, 21.38it/s] 42%|████▏     | 416/981 [00:19<00:26, 21.48it/s] 43%|████▎     | 419/981 [00:19<00:26, 21.57it/s] 43%|████▎     | 422/981 [00:19<00:25, 21.53it/s] 43%|████▎     | 425/981 [00:19<00:26, 21.35it/s] 44%|████▎     | 428/981 [00:19<00:26, 21.07it/s] 44%|████▍     | 431/981 [00:20<00:26, 21.03it/s] 44%|████▍     | 434/981 [00:20<00:26, 20.95it/s] 45%|████▍     | 437/981 [00:20<00:25, 21.07it/s] 45%|████▍     | 440/981 [00:20<00:25, 21.26it/s] 45%|████▌     | 443/981 [00:20<00:25, 21.42it/s] 45%|████▌     | 446/981 [00:20<00:24, 21.53it/s] 46%|████▌     | 449/981 [00:20<00:24, 21.58it/s] 46%|████▌     | 452/981 [00:20<00:24, 21.62it/s] 46%|████▋     | 455/981 [00:21<00:24, 21.36it/s] 47%|████▋     | 458/981 [00:21<00:24, 21.18it/s] 47%|████▋     | 461/981 [00:21<00:24, 21.38it/s] 47%|████▋     | 464/981 [00:21<00:23, 21.57it/s] 48%|████▊     | 467/981 [00:21<00:23, 21.76it/s] 48%|████▊     | 470/981 [00:21<00:23, 21.74it/s] 48%|████▊     | 473/981 [00:21<00:23, 21.83it/s] 49%|████▊     | 476/981 [00:22<00:23, 21.91it/s] 49%|████▉     | 479/981 [00:22<00:22, 21.96it/s] 49%|████▉     | 482/981 [00:22<00:22, 22.02it/s] 49%|████▉     | 485/981 [00:22<00:22, 22.10it/s] 50%|████▉     | 488/981 [00:22<00:22, 22.14it/s] 50%|█████     | 491/981 [00:22<00:22, 21.48it/s] 50%|█████     | 494/981 [00:22<00:22, 21.30it/s] 51%|█████     | 497/981 [00:23<00:22, 21.20it/s] 51%|█████     | 500/981 [00:23<00:22, 21.05it/s] 51%|█████▏    | 503/981 [00:23<00:22, 21.04it/s] 52%|█████▏    | 506/981 [00:23<00:22, 21.37it/s] 52%|█████▏    | 509/981 [00:23<00:21, 21.62it/s] 52%|█████▏    | 512/981 [00:23<00:21, 21.76it/s] 52%|█████▏    | 515/981 [00:23<00:21, 21.86it/s] 53%|█████▎    | 518/981 [00:24<00:21, 21.91it/s] 53%|█████▎    | 521/981 [00:24<00:21, 21.75it/s] 53%|█████▎    | 524/981 [00:24<00:21, 21.75it/s] 54%|█████▎    | 527/981 [00:24<00:20, 21.70it/s] 54%|█████▍    | 530/981 [00:24<00:20, 21.88it/s] 54%|█████▍    | 533/981 [00:24<00:20, 21.91it/s] 55%|█████▍    | 536/981 [00:24<00:20, 22.13it/s] 55%|█████▍    | 539/981 [00:24<00:19, 22.25it/s] 55%|█████▌    | 542/981 [00:25<00:19, 22.31it/s] 56%|█████▌    | 545/981 [00:25<00:19, 22.15it/s] 56%|█████▌    | 548/981 [00:25<00:19, 22.05it/s] 56%|█████▌    | 551/981 [00:25<00:19, 22.15it/s] 56%|█████▋    | 554/981 [00:25<00:20, 21.29it/s] 57%|█████▋    | 557/981 [00:25<00:19, 21.73it/s] 57%|█████▋    | 560/981 [00:25<00:19, 22.05it/s] 57%|█████▋    | 563/981 [00:26<00:21, 19.86it/s] 58%|█████▊    | 566/981 [00:26<00:22, 18.64it/s] 58%|█████▊    | 568/981 [00:26<00:22, 18.16it/s] 58%|█████▊    | 570/981 [00:26<00:22, 18.07it/s] 58%|█████▊    | 573/981 [00:26<00:21, 19.21it/s] 59%|█████▊    | 576/981 [00:26<00:20, 20.18it/s] 59%|█████▉    | 579/981 [00:27<00:29, 13.76it/s] 59%|█████▉    | 582/981 [00:27<00:25, 15.58it/s] 60%|█████▉    | 584/981 [00:27<00:24, 16.22it/s] 60%|█████▉    | 587/981 [00:27<00:22, 17.46it/s] 60%|██████    | 590/981 [00:27<00:20, 18.81it/s] 60%|██████    | 593/981 [00:27<00:19, 19.63it/s] 61%|██████    | 596/981 [00:27<00:18, 20.36it/s] 61%|██████    | 599/981 [00:28<00:18, 20.68it/s] 61%|██████▏   | 602/981 [00:28<00:18, 20.41it/s] 62%|██████▏   | 605/981 [00:28<00:17, 20.90it/s] 62%|██████▏   | 608/981 [00:28<00:17, 21.00it/s] 62%|██████▏   | 611/981 [00:28<00:17, 21.37it/s] 63%|██████▎   | 614/981 [00:28<00:16, 21.76it/s] 63%|██████▎   | 617/981 [00:28<00:16, 21.96it/s] 63%|██████▎   | 620/981 [00:29<00:16, 22.02it/s] 64%|██████▎   | 623/981 [00:29<00:16, 22.17it/s] 64%|██████▍   | 626/981 [00:29<00:16, 21.82it/s] 64%|██████▍   | 629/981 [00:29<00:16, 21.56it/s] 64%|██████▍   | 632/981 [00:29<00:16, 21.35it/s] 65%|██████▍   | 635/981 [00:29<00:16, 21.23it/s] 65%|██████▌   | 638/981 [00:29<00:16, 21.25it/s] 65%|██████▌   | 641/981 [00:30<00:15, 21.56it/s] 66%|██████▌   | 644/981 [00:30<00:15, 21.57it/s] 66%|██████▌   | 647/981 [00:30<00:15, 21.69it/s] 66%|██████▋   | 650/981 [00:30<00:15, 21.84it/s] 67%|██████▋   | 653/981 [00:30<00:15, 21.54it/s] 67%|██████▋   | 656/981 [00:30<00:15, 21.51it/s] 67%|██████▋   | 659/981 [00:30<00:14, 21.69it/s] 67%|██████▋   | 662/981 [00:31<00:14, 21.88it/s] 68%|██████▊   | 665/981 [00:31<00:14, 22.09it/s] 68%|██████▊   | 668/981 [00:31<00:14, 22.14it/s] 68%|██████▊   | 671/981 [00:31<00:13, 22.19it/s] 69%|██████▊   | 674/981 [00:31<00:13, 22.28it/s] 69%|██████▉   | 677/981 [00:31<00:13, 22.27it/s] 69%|██████▉   | 680/981 [00:31<00:13, 22.29it/s] 70%|██████▉   | 683/981 [00:31<00:13, 22.43it/s] 70%|██████▉   | 686/981 [00:32<00:13, 22.34it/s] 70%|███████   | 689/981 [00:32<00:13, 22.34it/s] 71%|███████   | 692/981 [00:32<00:13, 22.17it/s] 71%|███████   | 695/981 [00:32<00:12, 22.18it/s] 71%|███████   | 698/981 [00:32<00:12, 22.30it/s] 71%|███████▏  | 701/981 [00:32<00:12, 22.27it/s] 72%|███████▏  | 704/981 [00:32<00:12, 22.14it/s] 72%|███████▏  | 707/981 [00:33<00:12, 21.69it/s] 72%|███████▏  | 710/981 [00:33<00:12, 21.46it/s] 73%|███████▎  | 713/981 [00:33<00:12, 21.65it/s] 73%|███████▎  | 716/981 [00:33<00:12, 21.78it/s] 73%|███████▎  | 719/981 [00:33<00:12, 21.82it/s] 74%|███████▎  | 722/981 [00:33<00:12, 21.55it/s] 74%|███████▍  | 725/981 [00:33<00:11, 21.68it/s] 74%|███████▍  | 728/981 [00:34<00:11, 21.86it/s] 75%|███████▍  | 731/981 [00:34<00:11, 21.91it/s] 75%|███████▍  | 734/981 [00:34<00:11, 22.09it/s] 75%|███████▌  | 737/981 [00:34<00:11, 22.18it/s] 75%|███████▌  | 740/981 [00:34<00:10, 22.18it/s] 76%|███████▌  | 743/981 [00:34<00:10, 22.26it/s] 76%|███████▌  | 746/981 [00:34<00:10, 22.19it/s] 76%|███████▋  | 749/981 [00:34<00:10, 22.20it/s] 77%|███████▋  | 752/981 [00:35<00:10, 22.18it/s] 77%|███████▋  | 755/981 [00:35<00:10, 22.19it/s] 77%|███████▋  | 758/981 [00:35<00:10, 22.19it/s] 78%|███████▊  | 761/981 [00:35<00:09, 22.12it/s] 78%|███████▊  | 764/981 [00:35<00:09, 22.11it/s] 78%|███████▊  | 767/981 [00:35<00:09, 22.00it/s] 78%|███████▊  | 770/981 [00:35<00:09, 21.83it/s] 79%|███████▉  | 773/981 [00:36<00:09, 21.77it/s] 79%|███████▉  | 776/981 [00:36<00:09, 21.87it/s] 79%|███████▉  | 779/981 [00:36<00:09, 21.79it/s] 80%|███████▉  | 782/981 [00:36<00:09, 22.02it/s] 80%|████████  | 785/981 [00:36<00:08, 22.30it/s] 80%|████████  | 788/981 [00:36<00:08, 22.79it/s] 81%|████████  | 791/981 [00:36<00:08, 23.33it/s] 81%|████████  | 794/981 [00:36<00:07, 23.78it/s] 81%|████████  | 797/981 [00:37<00:07, 24.04it/s] 82%|████████▏ | 800/981 [00:37<00:07, 24.62it/s] 82%|████████▏ | 803/981 [00:37<00:07, 25.05it/s] 82%|████████▏ | 806/981 [00:37<00:06, 25.15it/s] 82%|████████▏ | 809/981 [00:37<00:06, 25.39it/s] 83%|████████▎ | 812/981 [00:37<00:06, 25.71it/s] 83%|████████▎ | 815/981 [00:37<00:06, 25.94it/s] 83%|████████▎ | 818/981 [00:37<00:06, 26.07it/s] 84%|████████▎ | 821/981 [00:38<00:06, 26.25it/s] 84%|████████▍ | 824/981 [00:38<00:05, 26.35it/s] 84%|████████▍ | 827/981 [00:38<00:05, 26.36it/s] 85%|████████▍ | 830/981 [00:38<00:05, 26.40it/s] 85%|████████▍ | 833/981 [00:38<00:05, 26.42it/s] 85%|████████▌ | 836/981 [00:38<00:05, 26.28it/s] 86%|████████▌ | 839/981 [00:38<00:05, 26.35it/s] 86%|████████▌ | 842/981 [00:38<00:05, 26.34it/s] 86%|████████▌ | 845/981 [00:38<00:05, 26.42it/s] 86%|████████▋ | 848/981 [00:39<00:05, 24.60it/s] 87%|████████▋ | 851/981 [00:39<00:05, 23.96it/s] 87%|████████▋ | 854/981 [00:39<00:05, 23.31it/s] 87%|████████▋ | 857/981 [00:39<00:05, 23.19it/s] 88%|████████▊ | 860/981 [00:39<00:05, 23.02it/s] 88%|████████▊ | 863/981 [00:39<00:05, 23.46it/s] 88%|████████▊ | 866/981 [00:39<00:04, 23.81it/s] 89%|████████▊ | 869/981 [00:39<00:04, 24.06it/s] 89%|████████▉ | 872/981 [00:40<00:04, 24.08it/s] 89%|████████▉ | 875/981 [00:40<00:04, 24.39it/s] 90%|████████▉ | 878/981 [00:40<00:04, 24.59it/s] 90%|████████▉ | 881/981 [00:40<00:04, 24.70it/s] 90%|█████████ | 884/981 [00:40<00:03, 24.70it/s] 90%|█████████ | 887/981 [00:40<00:03, 24.88it/s] 91%|█████████ | 890/981 [00:40<00:03, 24.93it/s] 91%|█████████ | 893/981 [00:40<00:03, 24.91it/s] 91%|█████████▏| 896/981 [00:41<00:03, 24.93it/s] 92%|█████████▏| 899/981 [00:41<00:03, 24.93it/s] 92%|█████████▏| 902/981 [00:41<00:03, 24.88it/s] 92%|█████████▏| 905/981 [00:41<00:03, 24.63it/s] 93%|█████████▎| 908/981 [00:41<00:03, 24.32it/s] 93%|█████████▎| 911/981 [00:41<00:02, 24.23it/s] 93%|█████████▎| 914/981 [00:41<00:02, 24.20it/s] 93%|█████████▎| 917/981 [00:41<00:02, 24.13it/s] 94%|█████████▍| 920/981 [00:42<00:02, 24.09it/s] 94%|█████████▍| 923/981 [00:42<00:02, 24.23it/s] 94%|█████████▍| 926/981 [00:42<00:02, 23.69it/s] 95%|█████████▍| 929/981 [00:42<00:02, 24.34it/s] 95%|█████████▌| 932/981 [00:42<00:01, 24.90it/s] 95%|█████████▌| 935/981 [00:42<00:01, 25.07it/s] 96%|█████████▌| 938/981 [00:42<00:01, 25.01it/s] 96%|█████████▌| 941/981 [00:42<00:01, 23.77it/s] 96%|█████████▌| 944/981 [00:43<00:01, 22.92it/s] 97%|█████████▋| 947/981 [00:43<00:01, 22.43it/s] 97%|█████████▋| 950/981 [00:43<00:01, 22.47it/s] 97%|█████████▋| 953/981 [00:43<00:01, 23.00it/s] 97%|█████████▋| 956/981 [00:43<00:01, 23.92it/s] 98%|█████████▊| 959/981 [00:43<00:00, 24.67it/s] 98%|█████████▊| 962/981 [00:43<00:00, 25.23it/s] 98%|█████████▊| 965/981 [00:43<00:00, 25.57it/s] 99%|█████████▊| 968/981 [00:44<00:00, 25.92it/s] 99%|█████████▉| 971/981 [00:44<00:00, 26.10it/s] 99%|█████████▉| 974/981 [00:44<00:00, 25.83it/s]100%|█████████▉| 977/981 [00:44<00:00, 25.88it/s]100%|█████████▉| 980/981 [00:44<00:00, 26.14it/s]100%|██████████| 981/981 [00:44<00:00, 22.05it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.013, valid loss : 0.012, train acc : 0.491, valid acc : 0.018, train f1 : 0.331, valid f1 : 0.018
training process:   2%|▏         | 1/50 [08:04<6:35:48, 484.66s/it]training process:   4%|▍         | 2/50 [15:56<6:21:29, 476.87s/it]training process:   6%|▌         | 3/50 [23:46<6:11:16, 473.97s/it]training process:   8%|▊         | 4/50 [31:35<6:01:51, 471.99s/it]epoch : 5, train loss : 0.008, valid loss : 0.005, train acc : 0.650, valid acc : 0.490, train f1 : 0.597, valid f1 : 0.358
training process:  10%|█         | 5/50 [39:26<5:53:35, 471.46s/it]training process:  12%|█▏        | 6/50 [47:17<5:45:39, 471.35s/it]training process:  14%|█▍        | 7/50 [55:09<5:38:05, 471.76s/it]training process:  16%|█▌        | 8/50 [1:02:58<5:29:32, 470.76s/it]epoch : 9, train loss : 0.008, valid loss : 0.006, train acc : 0.654, valid acc : 0.267, train f1 : 0.603, valid f1 : 0.226
training process:  18%|█▊        | 9/50 [1:10:46<5:21:07, 469.94s/it]training process:  20%|██        | 10/50 [1:18:33<5:12:45, 469.13s/it]training process:  22%|██▏       | 11/50 [1:26:23<5:05:04, 469.35s/it]training process:  24%|██▍       | 12/50 [1:34:13<4:57:14, 469.33s/it]epoch : 13, train loss : 0.009, valid loss : 0.007, train acc : 0.581, valid acc : 0.457, train f1 : 0.499, valid f1 : 0.339
training process:  26%|██▌       | 13/50 [1:42:02<4:49:21, 469.24s/it]training process:  28%|██▊       | 14/50 [1:49:46<4:40:42, 467.85s/it]training process:  30%|███       | 15/50 [1:57:32<4:32:30, 467.16s/it]training process:  32%|███▏      | 16/50 [2:05:18<4:24:37, 466.97s/it]epoch : 17, train loss : 0.008, valid loss : 0.007, train acc : 0.540, valid acc : 0.344, train f1 : 0.417, valid f1 : 0.276
training process:  34%|███▍      | 17/50 [2:13:09<4:17:24, 468.01s/it]training process:  36%|███▌      | 18/50 [2:21:02<4:10:23, 469.48s/it]training process:  38%|███▊      | 19/50 [2:28:53<4:02:54, 470.13s/it]training process:  40%|████      | 20/50 [2:36:42<3:54:52, 469.75s/it]epoch : 21, train loss : 0.006, valid loss : 0.007, train acc : 0.733, valid acc : 0.435, train f1 : 0.714, valid f1 : 0.328
training process:  42%|████▏     | 21/50 [2:44:34<3:47:17, 470.25s/it]training process:  44%|████▍     | 22/50 [2:52:26<3:39:44, 470.88s/it]training process:  46%|████▌     | 23/50 [3:00:18<3:32:02, 471.21s/it]training process:  48%|████▊     | 24/50 [3:08:06<3:23:50, 470.42s/it]epoch : 25, train loss : 0.006, valid loss : 0.005, train acc : 0.758, valid acc : 0.618, train f1 : 0.745, valid f1 : 0.422
training process:  50%|█████     | 25/50 [3:15:57<3:16:04, 470.57s/it]training process:  52%|█████▏    | 26/50 [3:23:46<3:08:00, 470.01s/it]training process:  54%|█████▍    | 27/50 [3:31:35<3:00:05, 469.80s/it]training process:  56%|█████▌    | 28/50 [3:39:26<2:52:19, 469.98s/it]epoch : 29, train loss : 0.006, valid loss : 0.005, train acc : 0.753, valid acc : 0.647, train f1 : 0.738, valid f1 : 0.435
training process:  58%|█████▊    | 29/50 [3:47:15<2:44:25, 469.77s/it]training process:  60%|██████    | 30/50 [3:55:06<2:36:40, 470.00s/it]training process:  62%|██████▏   | 31/50 [4:02:53<2:28:36, 469.30s/it]training process:  64%|██████▍   | 32/50 [4:10:43<2:20:47, 469.32s/it]epoch : 33, train loss : 0.005, valid loss : 0.003, train acc : 0.820, valid acc : 0.782, train f1 : 0.814, valid f1 : 0.507
training process:  66%|██████▌   | 33/50 [4:18:35<2:13:13, 470.19s/it]training process:  68%|██████▊   | 34/50 [4:26:22<2:05:09, 469.32s/it]training process:  70%|███████   | 35/50 [4:34:13<1:57:26, 469.75s/it]training process:  72%|███████▏  | 36/50 [4:42:00<1:49:25, 468.97s/it]epoch : 37, train loss : 0.005, valid loss : 0.002, train acc : 0.835, valid acc : 0.876, train f1 : 0.831, valid f1 : 0.574
training process:  74%|███████▍  | 37/50 [4:49:46<1:41:24, 468.03s/it]training process:  76%|███████▌  | 38/50 [4:57:29<1:33:20, 466.68s/it]training process:  78%|███████▊  | 39/50 [5:05:15<1:25:28, 466.24s/it]training process:  80%|████████  | 40/50 [5:13:00<1:17:39, 465.95s/it]epoch : 41, train loss : 0.005, valid loss : 0.002, train acc : 0.836, valid acc : 0.933, train f1 : 0.831, valid f1 : 0.650
training process:  82%|████████▏ | 41/50 [5:20:46<1:09:53, 465.98s/it]training process:  84%|████████▍ | 42/50 [5:28:32<1:02:08, 466.02s/it]training process:  86%|████████▌ | 43/50 [5:36:18<54:21, 466.00s/it]  training process:  88%|████████▊ | 44/50 [5:44:07<46:41, 466.89s/it]epoch : 45, train loss : 0.004, valid loss : 0.003, train acc : 0.850, valid acc : 0.906, train f1 : 0.846, valid f1 : 0.604
training process:  90%|█████████ | 45/50 [5:51:54<38:55, 467.05s/it]training process:  92%|█████████▏| 46/50 [5:59:47<31:14, 468.73s/it]training process:  94%|█████████▍| 47/50 [6:07:42<23:31, 470.51s/it]training process:  96%|█████████▌| 48/50 [6:15:29<15:39, 469.67s/it]epoch : 49, train loss : 0.004, valid loss : 0.003, train acc : 0.863, valid acc : 0.811, train f1 : 0.861, valid f1 : 0.523
training process:  98%|█████████▊| 49/50 [6:23:17<07:49, 469.05s/it]training process: 100%|██████████| 50/50 [6:31:04<00:00, 468.51s/it]training process: 100%|██████████| 50/50 [6:31:04<00:00, 469.30s/it]
training process finished, best loss : 0.004 and best acc : 0.970, best f1 : 0.741, best epoch : 49

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.28      0.86      0.42        71
           1       1.00      0.96      0.98      3812

    accuracy                           0.96      3883
   macro avg       0.64      0.91      0.70      3883
weighted avg       0.98      0.96      0.97      3883


# test acc : 0.96, test f1 : 0.70, test AUC : 0.91, test loss : 0.029

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:45, 21.60it/s]  1%|          | 6/981 [00:00<00:45, 21.62it/s]  1%|          | 9/981 [00:00<00:45, 21.38it/s]  1%|          | 12/981 [00:00<00:45, 21.48it/s]  2%|▏         | 15/981 [00:00<00:44, 21.53it/s]  2%|▏         | 18/981 [00:00<00:45, 21.27it/s]  2%|▏         | 21/981 [00:00<00:44, 21.39it/s]  2%|▏         | 24/981 [00:01<00:45, 20.84it/s]  3%|▎         | 27/981 [00:01<00:45, 20.91it/s]  3%|▎         | 30/981 [00:01<00:44, 21.18it/s]  3%|▎         | 33/981 [00:01<00:44, 21.13it/s]  4%|▎         | 36/981 [00:01<00:44, 21.17it/s]  4%|▍         | 39/981 [00:01<00:44, 21.33it/s]  4%|▍         | 42/981 [00:01<00:44, 21.09it/s]  5%|▍         | 45/981 [00:02<00:44, 20.96it/s]  5%|▍         | 48/981 [00:02<00:44, 20.98it/s]  5%|▌         | 51/981 [00:02<00:44, 20.91it/s]  6%|▌         | 54/981 [00:02<00:44, 20.90it/s]  6%|▌         | 57/981 [00:02<00:44, 20.84it/s]  6%|▌         | 60/981 [00:02<00:44, 20.78it/s]  6%|▋         | 63/981 [00:02<00:44, 20.84it/s]  7%|▋         | 66/981 [00:03<00:43, 20.82it/s]  7%|▋         | 69/981 [00:03<00:43, 21.17it/s]  7%|▋         | 72/981 [00:03<00:42, 21.24it/s]  8%|▊         | 75/981 [00:03<00:42, 21.35it/s]  8%|▊         | 78/981 [00:03<00:41, 21.55it/s]  8%|▊         | 81/981 [00:03<00:42, 21.35it/s]  9%|▊         | 84/981 [00:03<00:41, 21.41it/s]  9%|▉         | 87/981 [00:04<00:42, 21.27it/s]  9%|▉         | 90/981 [00:04<00:41, 21.22it/s]  9%|▉         | 93/981 [00:04<00:41, 21.38it/s] 10%|▉         | 96/981 [00:04<00:41, 21.30it/s] 10%|█         | 99/981 [00:04<00:41, 21.28it/s] 10%|█         | 102/981 [00:04<00:41, 21.41it/s] 11%|█         | 105/981 [00:04<00:42, 20.72it/s] 11%|█         | 108/981 [00:05<00:41, 21.01it/s] 11%|█▏        | 111/981 [00:05<00:41, 21.08it/s] 12%|█▏        | 114/981 [00:05<00:41, 21.13it/s] 12%|█▏        | 117/981 [00:05<00:40, 21.23it/s] 12%|█▏        | 120/981 [00:05<00:40, 21.11it/s] 13%|█▎        | 123/981 [00:05<00:40, 21.18it/s] 13%|█▎        | 126/981 [00:05<00:40, 21.27it/s] 13%|█▎        | 129/981 [00:06<00:40, 20.90it/s] 13%|█▎        | 132/981 [00:06<00:40, 21.15it/s] 14%|█▍        | 135/981 [00:06<00:39, 21.19it/s] 14%|█▍        | 138/981 [00:06<00:39, 21.08it/s] 14%|█▍        | 141/981 [00:06<00:39, 21.23it/s] 15%|█▍        | 144/981 [00:06<00:39, 21.06it/s] 15%|█▍        | 147/981 [00:06<00:39, 21.19it/s] 15%|█▌        | 150/981 [00:07<00:38, 21.40it/s] 16%|█▌        | 153/981 [00:07<00:39, 21.17it/s] 16%|█▌        | 156/981 [00:07<00:38, 21.39it/s] 16%|█▌        | 159/981 [00:07<00:38, 21.39it/s] 17%|█▋        | 162/981 [00:07<00:38, 21.34it/s] 17%|█▋        | 165/981 [00:07<00:37, 21.63it/s] 17%|█▋        | 168/981 [00:07<00:37, 21.49it/s] 17%|█▋        | 171/981 [00:08<00:37, 21.50it/s] 18%|█▊        | 174/981 [00:08<00:37, 21.65it/s] 18%|█▊        | 177/981 [00:08<00:37, 21.38it/s] 18%|█▊        | 180/981 [00:08<00:37, 21.64it/s] 19%|█▊        | 183/981 [00:08<00:36, 21.65it/s] 19%|█▉        | 186/981 [00:08<00:37, 21.49it/s] 19%|█▉        | 189/981 [00:08<00:36, 21.68it/s] 20%|█▉        | 192/981 [00:09<00:36, 21.48it/s] 20%|█▉        | 195/981 [00:09<00:36, 21.46it/s] 20%|██        | 198/981 [00:09<00:36, 21.51it/s] 20%|██        | 201/981 [00:09<00:36, 21.11it/s] 21%|██        | 204/981 [00:09<00:36, 21.24it/s] 21%|██        | 207/981 [00:09<00:36, 21.17it/s] 21%|██▏       | 210/981 [00:09<00:37, 20.81it/s] 22%|██▏       | 213/981 [00:10<00:36, 20.81it/s] 22%|██▏       | 216/981 [00:10<00:37, 20.66it/s] 22%|██▏       | 219/981 [00:10<00:36, 20.75it/s] 23%|██▎       | 222/981 [00:10<00:36, 20.83it/s] 23%|██▎       | 225/981 [00:10<00:36, 20.73it/s] 23%|██▎       | 228/981 [00:10<00:35, 20.95it/s] 24%|██▎       | 231/981 [00:10<00:35, 20.95it/s] 24%|██▍       | 234/981 [00:11<00:35, 20.98it/s] 24%|██▍       | 237/981 [00:11<00:35, 21.08it/s] 24%|██▍       | 240/981 [00:11<00:35, 20.86it/s] 25%|██▍       | 243/981 [00:11<00:35, 21.04it/s] 25%|██▌       | 246/981 [00:11<00:34, 21.04it/s] 25%|██▌       | 249/981 [00:11<00:34, 20.96it/s] 26%|██▌       | 252/981 [00:11<00:34, 21.17it/s] 26%|██▌       | 255/981 [00:12<00:34, 21.06it/s] 26%|██▋       | 258/981 [00:12<00:34, 21.20it/s] 27%|██▋       | 261/981 [00:12<00:33, 21.34it/s] 27%|██▋       | 264/981 [00:12<00:34, 21.06it/s] 27%|██▋       | 267/981 [00:12<00:33, 21.28it/s] 28%|██▊       | 270/981 [00:12<00:33, 21.19it/s] 28%|██▊       | 273/981 [00:12<00:33, 21.06it/s] 28%|██▊       | 276/981 [00:13<00:33, 21.04it/s] 28%|██▊       | 279/981 [00:13<00:33, 20.75it/s] 29%|██▊       | 282/981 [00:13<00:33, 20.67it/s] 29%|██▉       | 285/981 [00:13<00:33, 20.55it/s] 29%|██▉       | 288/981 [00:13<00:33, 20.52it/s] 30%|██▉       | 291/981 [00:13<00:33, 20.51it/s] 30%|██▉       | 294/981 [00:13<00:33, 20.44it/s] 30%|███       | 297/981 [00:14<00:33, 20.54it/s] 31%|███       | 300/981 [00:14<00:32, 20.74it/s] 31%|███       | 303/981 [00:14<00:32, 20.70it/s] 31%|███       | 306/981 [00:14<00:32, 20.99it/s] 31%|███▏      | 309/981 [00:14<00:31, 21.02it/s] 32%|███▏      | 312/981 [00:14<00:31, 20.92it/s] 32%|███▏      | 315/981 [00:14<00:31, 21.13it/s] 32%|███▏      | 318/981 [00:15<00:31, 21.04it/s] 33%|███▎      | 321/981 [00:15<00:31, 21.16it/s] 33%|███▎      | 324/981 [00:15<00:31, 21.13it/s] 33%|███▎      | 327/981 [00:15<00:31, 20.94it/s] 34%|███▎      | 330/981 [00:15<00:30, 21.08it/s] 34%|███▍      | 333/981 [00:15<00:30, 20.93it/s] 34%|███▍      | 336/981 [00:15<00:30, 20.97it/s] 35%|███▍      | 339/981 [00:16<00:30, 20.88it/s] 35%|███▍      | 342/981 [00:16<00:31, 20.56it/s] 35%|███▌      | 345/981 [00:16<00:30, 20.60it/s] 35%|███▌      | 348/981 [00:16<00:30, 20.59it/s] 36%|███▌      | 351/981 [00:16<00:30, 20.67it/s] 36%|███▌      | 354/981 [00:16<00:30, 20.80it/s] 36%|███▋      | 357/981 [00:16<00:30, 20.71it/s] 37%|███▋      | 360/981 [00:17<00:29, 20.87it/s] 37%|███▋      | 363/981 [00:17<00:29, 20.76it/s] 37%|███▋      | 366/981 [00:17<00:29, 20.62it/s] 38%|███▊      | 369/981 [00:17<00:29, 20.80it/s] 38%|███▊      | 372/981 [00:17<00:29, 20.61it/s] 38%|███▊      | 375/981 [00:17<00:29, 20.72it/s] 39%|███▊      | 378/981 [00:17<00:28, 20.84it/s] 39%|███▉      | 381/981 [00:18<00:28, 20.88it/s] 39%|███▉      | 384/981 [00:18<00:28, 21.08it/s] 39%|███▉      | 387/981 [00:18<00:28, 21.10it/s] 40%|███▉      | 390/981 [00:18<00:28, 20.98it/s] 40%|████      | 393/981 [00:18<00:27, 21.09it/s] 40%|████      | 396/981 [00:18<00:27, 20.93it/s] 41%|████      | 399/981 [00:18<00:27, 21.11it/s] 41%|████      | 402/981 [00:19<00:27, 21.21it/s] 41%|████▏     | 405/981 [00:19<00:27, 21.02it/s] 42%|████▏     | 408/981 [00:19<00:27, 21.15it/s] 42%|████▏     | 411/981 [00:19<00:27, 21.03it/s] 42%|████▏     | 414/981 [00:19<00:26, 21.08it/s] 43%|████▎     | 417/981 [00:19<00:26, 21.17it/s] 43%|████▎     | 420/981 [00:19<00:26, 20.87it/s] 43%|████▎     | 423/981 [00:20<00:26, 20.90it/s] 43%|████▎     | 426/981 [00:20<00:26, 20.99it/s] 44%|████▎     | 429/981 [00:20<00:26, 20.85it/s] 44%|████▍     | 432/981 [00:20<00:26, 20.92it/s] 44%|████▍     | 435/981 [00:20<00:26, 20.74it/s] 45%|████▍     | 438/981 [00:20<00:26, 20.85it/s] 45%|████▍     | 441/981 [00:20<00:25, 20.88it/s] 45%|████▌     | 444/981 [00:21<00:25, 20.71it/s] 46%|████▌     | 447/981 [00:21<00:25, 20.87it/s] 46%|████▌     | 450/981 [00:21<00:25, 20.77it/s] 46%|████▌     | 453/981 [00:21<00:25, 20.75it/s] 46%|████▋     | 456/981 [00:21<00:25, 20.92it/s] 47%|████▋     | 459/981 [00:21<00:25, 20.76it/s] 47%|████▋     | 462/981 [00:21<00:24, 20.90it/s] 47%|████▋     | 465/981 [00:22<00:24, 20.93it/s] 48%|████▊     | 468/981 [00:22<00:24, 20.92it/s] 48%|████▊     | 471/981 [00:22<00:24, 21.04it/s] 48%|████▊     | 474/981 [00:22<00:24, 20.87it/s] 49%|████▊     | 477/981 [00:22<00:23, 21.06it/s] 49%|████▉     | 480/981 [00:22<00:23, 21.11it/s] 49%|████▉     | 483/981 [00:22<00:23, 20.99it/s] 50%|████▉     | 486/981 [00:23<00:23, 21.12it/s] 50%|████▉     | 489/981 [00:23<00:23, 21.00it/s] 50%|█████     | 492/981 [00:23<00:23, 20.46it/s] 50%|█████     | 495/981 [00:23<00:23, 20.75it/s] 51%|█████     | 498/981 [00:23<00:23, 20.46it/s] 51%|█████     | 501/981 [00:23<00:23, 20.77it/s] 51%|█████▏    | 504/981 [00:23<00:22, 20.81it/s] 52%|█████▏    | 507/981 [00:24<00:22, 20.77it/s] 52%|█████▏    | 510/981 [00:24<00:22, 20.95it/s] 52%|█████▏    | 513/981 [00:24<00:22, 20.93it/s] 53%|█████▎    | 516/981 [00:24<00:22, 21.04it/s] 53%|█████▎    | 519/981 [00:24<00:21, 21.19it/s] 53%|█████▎    | 522/981 [00:24<00:21, 21.06it/s] 54%|█████▎    | 525/981 [00:24<00:21, 21.16it/s] 54%|█████▍    | 528/981 [00:25<00:21, 21.17it/s] 54%|█████▍    | 531/981 [00:25<00:21, 21.16it/s] 54%|█████▍    | 534/981 [00:25<00:21, 21.28it/s] 55%|█████▍    | 537/981 [00:25<00:20, 21.24it/s] 55%|█████▌    | 540/981 [00:25<00:20, 21.35it/s] 55%|█████▌    | 543/981 [00:25<00:20, 21.50it/s] 56%|█████▌    | 546/981 [00:25<00:20, 21.46it/s] 56%|█████▌    | 549/981 [00:26<00:19, 21.63it/s] 56%|█████▋    | 552/981 [00:26<00:19, 21.82it/s] 57%|█████▋    | 555/981 [00:26<00:19, 21.51it/s] 57%|█████▋    | 558/981 [00:26<00:19, 21.36it/s] 57%|█████▋    | 561/981 [00:26<00:19, 21.37it/s] 57%|█████▋    | 564/981 [00:26<00:19, 21.30it/s] 58%|█████▊    | 567/981 [00:26<00:19, 21.53it/s] 58%|█████▊    | 570/981 [00:27<00:19, 21.35it/s] 58%|█████▊    | 573/981 [00:27<00:18, 21.49it/s] 59%|█████▊    | 576/981 [00:27<00:18, 21.68it/s] 59%|█████▉    | 579/981 [00:27<00:18, 21.46it/s] 59%|█████▉    | 582/981 [00:27<00:18, 21.69it/s] 60%|█████▉    | 585/981 [00:27<00:18, 21.55it/s] 60%|█████▉    | 588/981 [00:27<00:18, 21.48it/s] 60%|██████    | 591/981 [00:28<00:18, 21.65it/s] 61%|██████    | 594/981 [00:28<00:19, 19.75it/s] 61%|██████    | 597/981 [00:28<00:18, 20.31it/s] 61%|██████    | 600/981 [00:28<00:18, 20.75it/s] 61%|██████▏   | 603/981 [00:28<00:19, 19.83it/s] 62%|██████▏   | 606/981 [00:28<00:18, 20.38it/s] 62%|██████▏   | 609/981 [00:28<00:18, 19.85it/s] 62%|██████▏   | 612/981 [00:29<00:18, 20.31it/s] 63%|██████▎   | 615/981 [00:29<00:17, 20.78it/s] 63%|██████▎   | 618/981 [00:29<00:17, 20.87it/s] 63%|██████▎   | 621/981 [00:29<00:16, 21.30it/s] 64%|██████▎   | 624/981 [00:29<00:16, 21.41it/s] 64%|██████▍   | 627/981 [00:29<00:16, 21.42it/s] 64%|██████▍   | 630/981 [00:29<00:16, 21.67it/s] 65%|██████▍   | 633/981 [00:30<00:16, 21.56it/s] 65%|██████▍   | 636/981 [00:30<00:15, 21.65it/s] 65%|██████▌   | 639/981 [00:30<00:15, 21.81it/s] 65%|██████▌   | 642/981 [00:30<00:15, 21.53it/s] 66%|██████▌   | 645/981 [00:30<00:15, 21.61it/s] 66%|██████▌   | 648/981 [00:30<00:15, 21.50it/s] 66%|██████▋   | 651/981 [00:30<00:15, 21.45it/s] 67%|██████▋   | 654/981 [00:31<00:15, 21.63it/s] 67%|██████▋   | 657/981 [00:31<00:15, 21.49it/s] 67%|██████▋   | 660/981 [00:31<00:14, 21.53it/s] 68%|██████▊   | 663/981 [00:31<00:14, 21.67it/s] 68%|██████▊   | 666/981 [00:31<00:15, 20.15it/s] 68%|██████▊   | 669/981 [00:31<00:15, 20.66it/s] 69%|██████▊   | 672/981 [00:31<00:14, 20.94it/s] 69%|██████▉   | 675/981 [00:32<00:14, 21.00it/s] 69%|██████▉   | 678/981 [00:32<00:14, 21.09it/s] 69%|██████▉   | 681/981 [00:32<00:14, 21.01it/s] 70%|██████▉   | 684/981 [00:32<00:14, 21.11it/s] 70%|███████   | 687/981 [00:32<00:13, 21.30it/s] 70%|███████   | 690/981 [00:32<00:13, 21.02it/s] 71%|███████   | 693/981 [00:32<00:13, 21.29it/s] 71%|███████   | 696/981 [00:33<00:13, 21.45it/s] 71%|███████▏  | 699/981 [00:33<00:13, 21.19it/s] 72%|███████▏  | 702/981 [00:33<00:12, 21.48it/s] 72%|███████▏  | 705/981 [00:33<00:12, 21.51it/s] 72%|███████▏  | 708/981 [00:33<00:12, 21.45it/s] 72%|███████▏  | 711/981 [00:33<00:12, 21.65it/s] 73%|███████▎  | 714/981 [00:33<00:12, 21.56it/s] 73%|███████▎  | 717/981 [00:34<00:12, 21.59it/s] 73%|███████▎  | 720/981 [00:34<00:12, 21.72it/s] 74%|███████▎  | 723/981 [00:34<00:12, 21.42it/s] 74%|███████▍  | 726/981 [00:34<00:11, 21.60it/s] 74%|███████▍  | 729/981 [00:34<00:11, 21.49it/s] 75%|███████▍  | 732/981 [00:34<00:11, 21.41it/s] 75%|███████▍  | 735/981 [00:34<00:11, 21.62it/s] 75%|███████▌  | 738/981 [00:34<00:11, 21.49it/s] 76%|███████▌  | 741/981 [00:35<00:11, 21.48it/s] 76%|███████▌  | 744/981 [00:35<00:11, 21.51it/s] 76%|███████▌  | 747/981 [00:35<00:11, 21.25it/s] 76%|███████▋  | 750/981 [00:35<00:10, 21.29it/s] 77%|███████▋  | 753/981 [00:35<00:10, 21.25it/s] 77%|███████▋  | 756/981 [00:35<00:10, 21.20it/s] 77%|███████▋  | 759/981 [00:35<00:10, 21.36it/s] 78%|███████▊  | 762/981 [00:36<00:10, 21.20it/s] 78%|███████▊  | 765/981 [00:36<00:10, 21.26it/s] 78%|███████▊  | 768/981 [00:36<00:09, 21.32it/s] 79%|███████▊  | 771/981 [00:36<00:09, 21.19it/s] 79%|███████▉  | 774/981 [00:36<00:09, 21.36it/s] 79%|███████▉  | 777/981 [00:36<00:09, 21.37it/s] 80%|███████▉  | 780/981 [00:36<00:09, 21.43it/s] 80%|███████▉  | 783/981 [00:37<00:09, 21.83it/s] 80%|████████  | 786/981 [00:37<00:08, 22.12it/s] 80%|████████  | 789/981 [00:37<00:08, 22.66it/s] 81%|████████  | 792/981 [00:37<00:08, 23.22it/s] 81%|████████  | 795/981 [00:37<00:07, 23.40it/s] 81%|████████▏ | 798/981 [00:37<00:07, 23.93it/s] 82%|████████▏ | 801/981 [00:37<00:07, 24.33it/s] 82%|████████▏ | 804/981 [00:37<00:07, 24.58it/s] 82%|████████▏ | 807/981 [00:38<00:07, 24.75it/s] 83%|████████▎ | 810/981 [00:38<00:06, 24.98it/s] 83%|████████▎ | 813/981 [00:38<00:06, 25.16it/s] 83%|████████▎ | 816/981 [00:38<00:06, 25.11it/s] 83%|████████▎ | 819/981 [00:38<00:06, 25.37it/s] 84%|████████▍ | 822/981 [00:38<00:06, 25.50it/s] 84%|████████▍ | 825/981 [00:38<00:06, 25.33it/s] 84%|████████▍ | 828/981 [00:38<00:06, 25.38it/s] 85%|████████▍ | 831/981 [00:38<00:05, 25.61it/s] 85%|████████▌ | 834/981 [00:39<00:05, 25.30it/s] 85%|████████▌ | 837/981 [00:39<00:05, 25.08it/s] 86%|████████▌ | 840/981 [00:39<00:05, 25.37it/s] 86%|████████▌ | 843/981 [00:39<00:05, 25.41it/s] 86%|████████▌ | 846/981 [00:39<00:05, 25.26it/s] 87%|████████▋ | 849/981 [00:39<00:05, 25.50it/s] 87%|████████▋ | 852/981 [00:39<00:05, 24.76it/s] 87%|████████▋ | 855/981 [00:39<00:05, 23.90it/s] 87%|████████▋ | 858/981 [00:40<00:05, 24.51it/s] 88%|████████▊ | 861/981 [00:40<00:05, 23.64it/s] 88%|████████▊ | 864/981 [00:40<00:04, 24.13it/s] 88%|████████▊ | 867/981 [00:40<00:04, 24.79it/s] 89%|████████▊ | 870/981 [00:40<00:04, 25.15it/s] 89%|████████▉ | 873/981 [00:40<00:04, 25.16it/s] 89%|████████▉ | 876/981 [00:40<00:04, 25.55it/s] 90%|████████▉ | 879/981 [00:40<00:03, 25.78it/s] 90%|████████▉ | 882/981 [00:41<00:03, 25.57it/s] 90%|█████████ | 885/981 [00:41<00:03, 25.73it/s] 91%|█████████ | 888/981 [00:41<00:03, 25.98it/s] 91%|█████████ | 891/981 [00:41<00:03, 25.94it/s] 91%|█████████ | 894/981 [00:41<00:03, 25.92it/s] 91%|█████████▏| 897/981 [00:41<00:03, 26.05it/s] 92%|█████████▏| 900/981 [00:41<00:03, 25.96it/s] 92%|█████████▏| 903/981 [00:41<00:03, 25.82it/s] 92%|█████████▏| 906/981 [00:41<00:02, 25.95it/s] 93%|█████████▎| 909/981 [00:42<00:02, 26.13it/s] 93%|█████████▎| 912/981 [00:42<00:02, 25.78it/s] 93%|█████████▎| 915/981 [00:42<00:02, 25.97it/s] 94%|█████████▎| 918/981 [00:42<00:02, 26.18it/s] 94%|█████████▍| 921/981 [00:42<00:02, 25.82it/s] 94%|█████████▍| 924/981 [00:42<00:02, 25.71it/s] 94%|█████████▍| 927/981 [00:42<00:02, 25.81it/s] 95%|█████████▍| 930/981 [00:42<00:02, 25.47it/s] 95%|█████████▌| 933/981 [00:43<00:01, 25.46it/s] 95%|█████████▌| 936/981 [00:43<00:01, 25.70it/s] 96%|█████████▌| 939/981 [00:43<00:01, 25.75it/s] 96%|█████████▌| 942/981 [00:43<00:01, 25.63it/s] 96%|█████████▋| 945/981 [00:43<00:01, 25.76it/s] 97%|█████████▋| 948/981 [00:43<00:01, 25.71it/s] 97%|█████████▋| 951/981 [00:43<00:01, 25.51it/s] 97%|█████████▋| 954/981 [00:43<00:01, 25.68it/s] 98%|█████████▊| 957/981 [00:43<00:00, 25.66it/s] 98%|█████████▊| 960/981 [00:44<00:00, 25.60it/s] 98%|█████████▊| 963/981 [00:44<00:00, 25.76it/s] 98%|█████████▊| 966/981 [00:44<00:00, 25.92it/s] 99%|█████████▉| 969/981 [00:44<00:00, 25.95it/s] 99%|█████████▉| 972/981 [00:44<00:00, 25.88it/s] 99%|█████████▉| 975/981 [00:44<00:00, 26.03it/s]100%|█████████▉| 978/981 [00:44<00:00, 25.89it/s]100%|██████████| 981/981 [00:44<00:00, 25.92it/s]100%|██████████| 981/981 [00:44<00:00, 21.86it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]training process - Deferred Re-weighting:   2%|▏         | 1/50 [06:34<5:22:21, 394.73s/it]epoch : 1, train loss : 0.030, valid loss : 0.029, train f1 : 0.690, valid f1 : 0.792
training process - Deferred Re-weighting:   4%|▍         | 2/50 [12:56<5:09:48, 387.27s/it]training process - Deferred Re-weighting:   6%|▌         | 3/50 [19:17<5:01:04, 384.35s/it]training process - Deferred Re-weighting:   8%|▊         | 4/50 [25:42<4:54:41, 384.39s/it]training process - Deferred Re-weighting:  10%|█         | 5/50 [32:09<4:49:06, 385.47s/it]epoch : 5, train loss : 0.031, valid loss : 0.038, train f1 : 0.630, valid f1 : 0.743
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [38:38<4:43:27, 386.53s/it]training process - Deferred Re-weighting:  14%|█▍        | 7/50 [45:05<4:37:18, 386.94s/it]training process - Deferred Re-weighting:  16%|█▌        | 8/50 [51:34<4:31:19, 387.61s/it]training process - Deferred Re-weighting:  18%|█▊        | 9/50 [58:06<4:25:37, 388.73s/it]epoch : 9, train loss : 0.027, valid loss : 0.027, train f1 : 0.686, valid f1 : 0.745
training process - Deferred Re-weighting:  20%|██        | 10/50 [1:04:35<4:19:19, 388.98s/it]training process - Deferred Re-weighting:  22%|██▏       | 11/50 [1:11:01<4:12:17, 388.13s/it]training process - Deferred Re-weighting:  24%|██▍       | 12/50 [1:17:30<4:05:51, 388.20s/it]training process - Deferred Re-weighting:  26%|██▌       | 13/50 [1:24:00<3:59:42, 388.71s/it]epoch : 13, train loss : 0.033, valid loss : 0.034, train f1 : 0.496, valid f1 : 0.495
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [1:30:28<3:53:10, 388.62s/it]training process - Deferred Re-weighting:  30%|███       | 15/50 [1:36:58<3:46:52, 388.94s/it]training process - Deferred Re-weighting:  32%|███▏      | 16/50 [1:43:28<3:40:39, 389.38s/it]training process - Deferred Re-weighting:  34%|███▍      | 17/50 [1:49:59<3:34:22, 389.76s/it]epoch : 17, train loss : 0.026, valid loss : 0.022, train f1 : 0.709, valid f1 : 0.786
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [1:56:25<3:27:20, 388.75s/it]training process - Deferred Re-weighting:  38%|███▊      | 19/50 [2:02:53<3:20:47, 388.63s/it]training process - Deferred Re-weighting:  40%|████      | 20/50 [2:09:22<3:14:19, 388.64s/it]training process - Deferred Re-weighting:  42%|████▏     | 21/50 [2:15:54<3:08:17, 389.57s/it]epoch : 21, train loss : 0.024, valid loss : 0.022, train f1 : 0.752, valid f1 : 0.815
training process - Deferred Re-weighting:  44%|████▍     | 22/50 [2:22:21<3:01:25, 388.76s/it]training process - Deferred Re-weighting:  46%|████▌     | 23/50 [2:28:51<2:55:08, 389.20s/it]training process - Deferred Re-weighting:  48%|████▊     | 24/50 [2:35:20<2:48:34, 389.04s/it]training process - Deferred Re-weighting:  50%|█████     | 25/50 [2:41:48<2:41:57, 388.71s/it]epoch : 25, train loss : 0.021, valid loss : 0.019, train f1 : 0.755, valid f1 : 0.811
training process - Deferred Re-weighting:  52%|█████▏    | 26/50 [2:48:15<2:35:17, 388.24s/it]training process - Deferred Re-weighting:  54%|█████▍    | 27/50 [2:54:45<2:29:02, 388.80s/it]training process - Deferred Re-weighting:  56%|█████▌    | 28/50 [3:01:15<2:22:39, 389.09s/it]training process - Deferred Re-weighting:  58%|█████▊    | 29/50 [3:07:45<2:16:21, 389.59s/it]epoch : 29, train loss : 0.020, valid loss : 0.019, train f1 : 0.786, valid f1 : 0.816
training process - Deferred Re-weighting:  60%|██████    | 30/50 [3:14:11<2:09:26, 388.33s/it]training process - Deferred Re-weighting:  62%|██████▏   | 31/50 [3:20:41<2:03:11, 389.04s/it]training process - Deferred Re-weighting:  64%|██████▍   | 32/50 [3:27:11<1:56:43, 389.06s/it]training process - Deferred Re-weighting:  66%|██████▌   | 33/50 [3:33:48<1:50:58, 391.66s/it]epoch : 33, train loss : 0.021, valid loss : 0.022, train f1 : 0.779, valid f1 : 0.794
training process - Deferred Re-weighting:  68%|██████▊   | 34/50 [3:40:18<1:44:17, 391.09s/it]training process - Deferred Re-weighting:  70%|███████   | 35/50 [3:46:48<1:37:39, 390.63s/it]training process - Deferred Re-weighting:  72%|███████▏  | 36/50 [3:53:14<1:30:50, 389.34s/it]training process - Deferred Re-weighting:  74%|███████▍  | 37/50 [3:59:45<1:24:26, 389.76s/it]epoch : 37, train loss : 0.021, valid loss : 0.022, train f1 : 0.783, valid f1 : 0.799
training process - Deferred Re-weighting:  76%|███████▌  | 38/50 [4:06:09<1:17:38, 388.21s/it]training process - Deferred Re-weighting:  78%|███████▊  | 39/50 [4:12:37<1:11:09, 388.10s/it]training process - Deferred Re-weighting:  80%|████████  | 40/50 [4:19:01<1:04:29, 386.92s/it]training process - Deferred Re-weighting:  82%|████████▏ | 41/50 [4:25:29<58:04, 387.20s/it]  epoch : 41, train loss : 0.019, valid loss : 0.021, train f1 : 0.810, valid f1 : 0.820
training process - Deferred Re-weighting:  84%|████████▍ | 42/50 [4:32:12<52:14, 391.84s/it]training process - Deferred Re-weighting:  86%|████████▌ | 43/50 [4:38:34<45:21, 388.85s/it]training process - Deferred Re-weighting:  88%|████████▊ | 44/50 [4:44:47<38:25, 384.24s/it]training process - Deferred Re-weighting:  90%|█████████ | 45/50 [4:50:46<31:22, 376.57s/it]epoch : 45, train loss : 0.018, valid loss : 0.019, train f1 : 0.813, valid f1 : 0.844
training process - Deferred Re-weighting:  92%|█████████▏| 46/50 [4:56:44<24:44, 371.05s/it]training process - Deferred Re-weighting:  94%|█████████▍| 47/50 [5:02:41<18:20, 366.83s/it]training process - Deferred Re-weighting:  96%|█████████▌| 48/50 [5:08:42<12:10, 365.15s/it]training process - Deferred Re-weighting:  96%|█████████▌| 48/50 [5:08:42<12:51, 385.89s/it]
Traceback (most recent call last):
  File "/home/jinsukim/codes_for_study/research-predict-disruption/train_vision_network.py", line 322, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train_DRW(
  File "/home/jinsukim/codes_for_study/research-predict-disruption/src/train.py", line 334, in train_DRW
    per_cls_weights = _update_per_cls_weights(epoch, betas, cls_num_list)
  File "/home/jinsukim/codes_for_study/research-predict-disruption/src/train.py", line 319, in _update_per_cls_weights
    beta = betas[idx]
IndexError: list index out of range
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]training process - Deferred Re-weighting:   2%|▏         | 1/50 [06:15<5:06:45, 375.61s/it]epoch : 1, train loss : 0.130, valid loss : 0.039, train f1 : 0.766, valid f1 : 0.796
training process - Deferred Re-weighting:   4%|▍         | 2/50 [12:20<4:55:24, 369.26s/it]training process - Deferred Re-weighting:   6%|▌         | 3/50 [18:24<4:47:28, 366.98s/it]training process - Deferred Re-weighting:   8%|▊         | 4/50 [24:48<4:46:18, 373.46s/it]training process - Deferred Re-weighting:  10%|█         | 5/50 [31:20<4:45:14, 380.32s/it]epoch : 5, train loss : 0.075, valid loss : 0.039, train f1 : 0.896, valid f1 : 0.756
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [37:56<4:42:51, 385.71s/it]training process - Deferred Re-weighting:  14%|█▍        | 7/50 [44:31<4:38:33, 388.69s/it]training process - Deferred Re-weighting:  16%|█▌        | 8/50 [51:05<4:33:12, 390.30s/it]training process - Deferred Re-weighting:  18%|█▊        | 9/50 [57:37<4:27:00, 390.75s/it]epoch : 9, train loss : 0.067, valid loss : 0.031, train f1 : 0.901, valid f1 : 0.783
training process - Deferred Re-weighting:  20%|██        | 10/50 [1:04:14<4:21:57, 392.93s/it]training process - Deferred Re-weighting:  22%|██▏       | 11/50 [1:10:25<4:11:03, 386.24s/it]training process - Deferred Re-weighting:  24%|██▍       | 12/50 [1:16:31<4:00:37, 379.94s/it]training process - Deferred Re-weighting:  26%|██▌       | 13/50 [1:22:39<3:52:09, 376.47s/it]epoch : 13, train loss : 0.063, valid loss : 0.013, train f1 : 0.908, valid f1 : 0.873
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [1:28:48<3:44:27, 374.09s/it]training process - Deferred Re-weighting:  30%|███       | 15/50 [1:34:56<3:37:10, 372.31s/it]training process - Deferred Re-weighting:  32%|███▏      | 16/50 [1:41:08<3:30:52, 372.13s/it]training process - Deferred Re-weighting:  34%|███▍      | 17/50 [1:47:16<3:23:59, 370.91s/it]epoch : 17, train loss : 0.068, valid loss : 0.013, train f1 : 0.898, valid f1 : 0.844
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [1:53:20<3:16:46, 368.97s/it]training process - Deferred Re-weighting:  38%|███▊      | 19/50 [1:59:26<3:10:07, 367.99s/it]training process - Deferred Re-weighting:  40%|████      | 20/50 [2:05:34<3:04:01, 368.05s/it]training process - Deferred Re-weighting:  42%|████▏     | 21/50 [2:11:37<2:57:08, 366.51s/it]epoch : 21, train loss : 0.057, valid loss : 0.029, train f1 : 0.915, valid f1 : 0.798
training process - Deferred Re-weighting:  44%|████▍     | 22/50 [2:17:38<2:50:17, 364.90s/it]training process - Deferred Re-weighting:  46%|████▌     | 23/50 [2:23:39<2:43:34, 363.48s/it]training process - Deferred Re-weighting:  48%|████▊     | 24/50 [2:29:37<2:36:51, 361.99s/it]training process - Deferred Re-weighting:  50%|█████     | 25/50 [2:35:38<2:30:39, 361.58s/it]epoch : 25, train loss : 0.059, valid loss : 0.012, train f1 : 0.914, valid f1 : 0.865
training process - Deferred Re-weighting:  52%|█████▏    | 26/50 [2:41:37<2:24:20, 360.85s/it]training process - Deferred Re-weighting:  54%|█████▍    | 27/50 [2:47:36<2:18:08, 360.38s/it]training process - Deferred Re-weighting:  56%|█████▌    | 28/50 [2:53:42<2:12:45, 362.07s/it]training process - Deferred Re-weighting:  58%|█████▊    | 29/50 [2:59:45<2:06:46, 362.20s/it]epoch : 29, train loss : 0.057, valid loss : 0.012, train f1 : 0.912, valid f1 : 0.886
training process - Deferred Re-weighting:  60%|██████    | 30/50 [3:05:51<2:01:06, 363.32s/it]training process - Deferred Re-weighting:  62%|██████▏   | 31/50 [3:11:54<1:55:04, 363.41s/it]training process - Deferred Re-weighting:  64%|██████▍   | 32/50 [3:18:03<1:49:28, 364.94s/it]training process - Deferred Re-weighting:  66%|██████▌   | 33/50 [3:24:03<1:42:57, 363.40s/it]epoch : 33, train loss : 0.053, valid loss : 0.020, train f1 : 0.920, valid f1 : 0.727
training process - Deferred Re-weighting:  68%|██████▊   | 34/50 [3:30:10<1:37:11, 364.46s/it]training process - Deferred Re-weighting:  70%|███████   | 35/50 [3:36:10<1:30:49, 363.32s/it]training process - Deferred Re-weighting:  72%|███████▏  | 36/50 [3:42:11<1:24:37, 362.68s/it]training process - Deferred Re-weighting:  74%|███████▍  | 37/50 [3:48:18<1:18:50, 363.87s/it]epoch : 37, train loss : 0.052, valid loss : 0.027, train f1 : 0.920, valid f1 : 0.793
training process - Deferred Re-weighting:  76%|███████▌  | 38/50 [3:54:23<1:12:50, 364.22s/it]training process - Deferred Re-weighting:  78%|███████▊  | 39/50 [4:00:27<1:06:46, 364.23s/it]training process - Deferred Re-weighting:  80%|████████  | 40/50 [4:06:27<1:00:29, 362.97s/it]training process - Deferred Re-weighting:  82%|████████▏ | 41/50 [4:12:33<54:34, 363.84s/it]  epoch : 41, train loss : 0.054, valid loss : 0.014, train f1 : 0.915, valid f1 : 0.868
training process - Deferred Re-weighting:  84%|████████▍ | 42/50 [4:18:38<48:33, 364.21s/it]training process - Deferred Re-weighting:  86%|████████▌ | 43/50 [4:24:45<42:34, 364.86s/it]training process - Deferred Re-weighting:  88%|████████▊ | 44/50 [4:30:48<36:26, 364.34s/it]training process - Deferred Re-weighting:  90%|█████████ | 45/50 [4:36:55<30:26, 365.32s/it]epoch : 45, train loss : 0.054, valid loss : 0.016, train f1 : 0.920, valid f1 : 0.840
training process - Deferred Re-weighting:  92%|█████████▏| 46/50 [4:43:02<24:22, 365.58s/it]training process - Deferred Re-weighting:  94%|█████████▍| 47/50 [4:49:05<18:15, 365.05s/it]training process - Deferred Re-weighting:  96%|█████████▌| 48/50 [4:55:10<12:09, 364.96s/it]training process - Deferred Re-weighting:  96%|█████████▌| 48/50 [4:55:10<12:17, 368.97s/it]
Traceback (most recent call last):
  File "/home/jinsukim/codes_for_study/research-predict-disruption/train_vision_network.py", line 322, in <module>
    train_loss,  train_acc, train_f1, valid_loss, valid_acc, valid_f1 = train_DRW(
  File "/home/jinsukim/codes_for_study/research-predict-disruption/src/train.py", line 334, in train_DRW
    per_cls_weights = _update_per_cls_weights(epoch, betas, cls_num_list)
  File "/home/jinsukim/codes_for_study/research-predict-disruption/src/train.py", line 319, in _update_per_cls_weights
    beta = betas[idx]
IndexError: list index out of range
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.012, valid loss : 0.013, train acc : 0.983, valid acc : 0.982, train f1 : 0.496, valid f1 : 0.495
training process:   2%|▏         | 1/50 [07:23<6:02:25, 443.79s/it]training process:   4%|▍         | 2/50 [14:51<5:56:41, 445.86s/it]training process:   6%|▌         | 3/50 [22:23<5:51:36, 448.87s/it]training process:   8%|▊         | 4/50 [29:49<5:43:10, 447.61s/it]epoch : 5, train loss : 0.011, valid loss : 0.013, train acc : 0.982, valid acc : 0.982, train f1 : 0.576, valid f1 : 0.495
training process:  10%|█         | 5/50 [37:02<5:31:51, 442.48s/it]training process:  12%|█▏        | 6/50 [44:23<5:23:59, 441.81s/it]training process:  14%|█▍        | 7/50 [51:43<5:16:11, 441.20s/it]training process:  16%|█▌        | 8/50 [59:04<5:08:51, 441.22s/it]epoch : 9, train loss : 0.010, valid loss : 0.008, train acc : 0.985, valid acc : 0.987, train f1 : 0.702, valid f1 : 0.804
training process:  18%|█▊        | 9/50 [1:06:08<4:57:55, 436.00s/it]training process:  20%|██        | 10/50 [1:13:16<4:49:00, 433.51s/it]training process:  22%|██▏       | 11/50 [1:20:19<4:39:34, 430.13s/it]training process:  24%|██▍       | 12/50 [1:27:26<4:31:52, 429.28s/it]epoch : 13, train loss : 0.012, valid loss : 0.013, train acc : 0.983, valid acc : 0.982, train f1 : 0.496, valid f1 : 0.495
training process:  26%|██▌       | 13/50 [1:35:12<4:31:34, 440.39s/it]training process:  28%|██▊       | 14/50 [1:43:12<4:31:28, 452.47s/it]training process:  30%|███       | 15/50 [1:51:12<4:28:44, 460.71s/it]training process:  32%|███▏      | 16/50 [1:59:18<4:25:19, 468.22s/it]epoch : 17, train loss : 0.008, valid loss : 0.009, train acc : 0.989, valid acc : 0.988, train f1 : 0.769, valid f1 : 0.757
training process:  34%|███▍      | 17/50 [2:07:02<4:16:46, 466.87s/it]training process:  36%|███▌      | 18/50 [2:14:42<4:07:53, 464.81s/it]training process:  38%|███▊      | 19/50 [2:22:25<3:59:54, 464.32s/it]training process:  40%|████      | 20/50 [2:30:24<3:54:26, 468.89s/it]epoch : 21, train loss : 0.009, valid loss : 0.008, train acc : 0.988, valid acc : 0.990, train f1 : 0.768, valid f1 : 0.827
training process:  42%|████▏     | 21/50 [2:38:24<3:48:07, 471.98s/it]training process:  44%|████▍     | 22/50 [2:46:22<3:41:11, 474.00s/it]training process:  46%|████▌     | 23/50 [2:54:24<3:34:21, 476.36s/it]training process:  48%|████▊     | 24/50 [3:01:58<3:23:27, 469.53s/it]epoch : 25, train loss : 0.009, valid loss : 0.008, train acc : 0.987, valid acc : 0.988, train f1 : 0.747, valid f1 : 0.810
training process:  50%|█████     | 25/50 [3:08:57<3:09:21, 454.47s/it]training process:  52%|█████▏    | 26/50 [3:15:59<2:57:49, 444.57s/it]training process:  54%|█████▍    | 27/50 [3:22:57<2:47:23, 436.65s/it]training process:  56%|█████▌    | 28/50 [3:30:12<2:39:58, 436.28s/it]epoch : 29, train loss : 0.008, valid loss : 0.008, train acc : 0.988, valid acc : 0.990, train f1 : 0.782, valid f1 : 0.811
training process:  58%|█████▊    | 29/50 [3:37:33<2:33:10, 437.62s/it]training process:  60%|██████    | 30/50 [3:44:53<2:26:05, 438.28s/it]training process:  62%|██████▏   | 31/50 [3:52:12<2:18:51, 438.50s/it]training process:  64%|██████▍   | 32/50 [3:59:34<2:11:54, 439.68s/it]epoch : 33, train loss : 0.007, valid loss : 0.007, train acc : 0.990, valid acc : 0.991, train f1 : 0.808, valid f1 : 0.839
training process:  66%|██████▌   | 33/50 [4:06:36<2:03:04, 434.38s/it]training process:  68%|██████▊   | 34/50 [4:13:36<1:54:38, 429.90s/it]training process:  70%|███████   | 35/50 [4:20:38<1:46:56, 427.78s/it]training process:  72%|███████▏  | 36/50 [4:28:00<1:40:46, 431.88s/it]epoch : 37, train loss : 0.008, valid loss : 0.008, train acc : 0.989, valid acc : 0.990, train f1 : 0.777, valid f1 : 0.811
training process:  74%|███████▍  | 37/50 [4:35:18<1:33:58, 433.70s/it]training process:  76%|███████▌  | 38/50 [4:42:39<1:27:09, 435.83s/it]training process:  78%|███████▊  | 39/50 [4:49:58<1:20:06, 436.97s/it]training process:  80%|████████  | 40/50 [4:57:16<1:12:51, 437.17s/it]epoch : 41, train loss : 0.008, valid loss : 0.007, train acc : 0.989, valid acc : 0.991, train f1 : 0.793, valid f1 : 0.827
training process:  82%|████████▏ | 41/50 [5:04:34<1:05:37, 437.45s/it]training process:  84%|████████▍ | 42/50 [5:11:34<57:37, 432.18s/it]  training process:  86%|████████▌ | 43/50 [5:18:37<50:06, 429.57s/it]training process:  88%|████████▊ | 44/50 [5:25:58<43:16, 432.81s/it]epoch : 45, train loss : 0.007, valid loss : 0.007, train acc : 0.990, valid acc : 0.991, train f1 : 0.812, valid f1 : 0.842
training process:  90%|█████████ | 45/50 [5:33:15<36:10, 434.18s/it]training process:  92%|█████████▏| 46/50 [5:40:28<28:55, 433.90s/it]training process:  94%|█████████▍| 47/50 [5:47:50<21:48, 436.16s/it]training process:  96%|█████████▌| 48/50 [5:55:10<14:35, 437.51s/it]epoch : 49, train loss : 0.007, valid loss : 0.008, train acc : 0.991, valid acc : 0.990, train f1 : 0.823, valid f1 : 0.819
training process:  98%|█████████▊| 49/50 [6:02:33<07:18, 438.89s/it]training process: 100%|██████████| 50/50 [6:09:40<00:00, 435.43s/it]training process: 100%|██████████| 50/50 [6:09:40<00:00, 443.61s/it]
training process finished, best loss : 0.007 and best acc : 0.991, best f1 : 0.842, best epoch : 44

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.56      0.48      0.52        71
           1       0.99      0.99      0.99      3812

    accuracy                           0.98      3883
   macro avg       0.77      0.74      0.75      3883
weighted avg       0.98      0.98      0.98      3883


# test acc : 0.98, test f1 : 0.75, test AUC : 0.74, test loss : 0.084

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:57, 17.10it/s]  0%|          | 4/981 [00:00<00:58, 16.72it/s]  1%|          | 6/981 [00:00<00:55, 17.50it/s]  1%|          | 8/981 [00:00<00:57, 16.91it/s]  1%|          | 10/981 [00:00<00:58, 16.64it/s]  1%|          | 12/981 [00:00<00:59, 16.27it/s]  1%|▏         | 14/981 [00:00<00:57, 16.95it/s]  2%|▏         | 16/981 [00:00<00:54, 17.61it/s]  2%|▏         | 18/981 [00:01<00:55, 17.30it/s]  2%|▏         | 20/981 [00:01<00:56, 17.09it/s]  2%|▏         | 23/981 [00:01<00:51, 18.44it/s]  3%|▎         | 26/981 [00:01<00:51, 18.48it/s]  3%|▎         | 28/981 [00:01<00:51, 18.52it/s]  3%|▎         | 30/981 [00:01<00:51, 18.53it/s]  3%|▎         | 32/981 [00:01<00:54, 17.52it/s]  4%|▎         | 35/981 [00:01<00:52, 18.08it/s]  4%|▍         | 38/981 [00:02<00:49, 18.92it/s]  4%|▍         | 40/981 [00:02<00:50, 18.49it/s]  4%|▍         | 42/981 [00:02<00:51, 18.11it/s]  4%|▍         | 44/981 [00:02<00:52, 17.84it/s]  5%|▍         | 46/981 [00:02<00:52, 17.95it/s]  5%|▍         | 49/981 [00:02<00:49, 18.73it/s]  5%|▌         | 52/981 [00:02<00:49, 18.71it/s]  6%|▌         | 54/981 [00:03<00:49, 18.72it/s]  6%|▌         | 56/981 [00:03<00:48, 19.00it/s]  6%|▌         | 58/981 [00:03<00:48, 19.09it/s]  6%|▌         | 61/981 [00:03<00:47, 19.47it/s]  6%|▋         | 63/981 [00:03<00:47, 19.46it/s]  7%|▋         | 66/981 [00:03<00:45, 19.95it/s]  7%|▋         | 68/981 [00:03<00:46, 19.51it/s]  7%|▋         | 70/981 [00:03<00:48, 18.61it/s]  7%|▋         | 72/981 [00:03<00:51, 17.69it/s]  8%|▊         | 74/981 [00:04<00:50, 18.05it/s]  8%|▊         | 77/981 [00:04<00:47, 18.88it/s]  8%|▊         | 79/981 [00:04<00:47, 19.15it/s]  8%|▊         | 81/981 [00:04<00:46, 19.33it/s]  9%|▊         | 84/981 [00:04<00:45, 19.66it/s]  9%|▉         | 86/981 [00:04<00:47, 18.99it/s]  9%|▉         | 88/981 [00:04<00:48, 18.53it/s]  9%|▉         | 91/981 [00:04<00:47, 18.92it/s] 10%|▉         | 94/981 [00:05<00:45, 19.32it/s] 10%|▉         | 96/981 [00:05<00:47, 18.81it/s] 10%|▉         | 98/981 [00:05<00:46, 18.96it/s] 10%|█         | 100/981 [00:05<00:48, 18.12it/s] 10%|█         | 102/981 [00:05<00:50, 17.50it/s] 11%|█         | 105/981 [00:05<00:47, 18.50it/s] 11%|█         | 107/981 [00:05<00:47, 18.46it/s] 11%|█         | 109/981 [00:05<00:46, 18.73it/s] 11%|█▏        | 111/981 [00:06<00:46, 18.80it/s] 12%|█▏        | 113/981 [00:06<00:48, 17.95it/s] 12%|█▏        | 115/981 [00:06<00:48, 17.69it/s] 12%|█▏        | 117/981 [00:06<00:47, 18.00it/s] 12%|█▏        | 119/981 [00:06<00:46, 18.49it/s] 12%|█▏        | 121/981 [00:06<00:46, 18.54it/s] 13%|█▎        | 123/981 [00:06<00:46, 18.51it/s] 13%|█▎        | 125/981 [00:06<00:48, 17.65it/s] 13%|█▎        | 128/981 [00:06<00:45, 18.79it/s] 13%|█▎        | 130/981 [00:07<00:46, 18.19it/s] 14%|█▎        | 133/981 [00:07<00:45, 18.51it/s] 14%|█▍        | 136/981 [00:07<00:44, 19.20it/s] 14%|█▍        | 139/981 [00:07<00:42, 19.70it/s] 14%|█▍        | 141/981 [00:07<00:43, 19.36it/s] 15%|█▍        | 143/981 [00:07<00:46, 17.93it/s] 15%|█▍        | 145/981 [00:07<00:45, 18.28it/s] 15%|█▌        | 148/981 [00:08<00:43, 19.18it/s] 15%|█▌        | 151/981 [00:08<00:42, 19.67it/s] 16%|█▌        | 153/981 [00:08<00:44, 18.65it/s] 16%|█▌        | 155/981 [00:08<00:44, 18.58it/s] 16%|█▌        | 157/981 [00:08<00:43, 18.78it/s] 16%|█▌        | 159/981 [00:08<00:45, 18.17it/s] 16%|█▋        | 161/981 [00:08<00:45, 18.06it/s] 17%|█▋        | 164/981 [00:08<00:43, 18.98it/s] 17%|█▋        | 167/981 [00:09<00:42, 19.30it/s] 17%|█▋        | 169/981 [00:09<00:44, 18.17it/s] 17%|█▋        | 171/981 [00:09<00:44, 18.24it/s] 18%|█▊        | 173/981 [00:09<00:46, 17.42it/s] 18%|█▊        | 175/981 [00:09<00:46, 17.26it/s] 18%|█▊        | 177/981 [00:09<00:49, 16.29it/s] 18%|█▊        | 180/981 [00:09<00:44, 17.83it/s] 19%|█▊        | 183/981 [00:09<00:43, 18.47it/s] 19%|█▉        | 185/981 [00:10<00:43, 18.23it/s] 19%|█▉        | 187/981 [00:10<00:42, 18.66it/s] 19%|█▉        | 190/981 [00:10<00:41, 19.12it/s] 20%|█▉        | 192/981 [00:10<00:41, 19.11it/s] 20%|█▉        | 195/981 [00:10<00:39, 19.68it/s] 20%|██        | 197/981 [00:10<00:40, 19.52it/s] 20%|██        | 199/981 [00:10<00:41, 18.69it/s] 21%|██        | 202/981 [00:10<00:40, 19.18it/s] 21%|██        | 205/981 [00:11<00:39, 19.60it/s] 21%|██        | 208/981 [00:11<00:39, 19.62it/s] 22%|██▏       | 211/981 [00:11<00:38, 19.99it/s] 22%|██▏       | 214/981 [00:11<00:38, 20.13it/s] 22%|██▏       | 217/981 [00:11<00:38, 20.03it/s] 22%|██▏       | 220/981 [00:11<00:40, 18.71it/s] 23%|██▎       | 222/981 [00:11<00:41, 18.16it/s] 23%|██▎       | 224/981 [00:12<00:42, 18.01it/s] 23%|██▎       | 226/981 [00:12<00:41, 18.41it/s] 23%|██▎       | 228/981 [00:12<00:40, 18.44it/s] 23%|██▎       | 230/981 [00:12<00:39, 18.84it/s] 24%|██▎       | 232/981 [00:12<00:41, 18.03it/s] 24%|██▍       | 235/981 [00:12<00:39, 18.93it/s] 24%|██▍       | 237/981 [00:12<00:39, 18.61it/s] 24%|██▍       | 239/981 [00:12<00:39, 18.63it/s] 25%|██▍       | 242/981 [00:13<00:38, 19.24it/s] 25%|██▍       | 245/981 [00:13<00:37, 19.67it/s] 25%|██▌       | 247/981 [00:13<00:38, 19.23it/s] 25%|██▌       | 250/981 [00:13<00:37, 19.41it/s] 26%|██▌       | 253/981 [00:13<00:36, 19.83it/s] 26%|██▌       | 256/981 [00:13<00:36, 20.04it/s] 26%|██▋       | 258/981 [00:13<00:36, 19.57it/s] 27%|██▋       | 260/981 [00:13<00:38, 18.96it/s] 27%|██▋       | 263/981 [00:14<00:36, 19.50it/s] 27%|██▋       | 265/981 [00:14<00:37, 19.24it/s] 27%|██▋       | 268/981 [00:14<00:36, 19.49it/s] 28%|██▊       | 271/981 [00:14<00:36, 19.72it/s] 28%|██▊       | 274/981 [00:14<00:35, 19.98it/s] 28%|██▊       | 277/981 [00:14<00:34, 20.14it/s] 29%|██▊       | 280/981 [00:14<00:34, 20.28it/s] 29%|██▉       | 283/981 [00:15<00:34, 20.01it/s] 29%|██▉       | 285/981 [00:15<00:34, 19.93it/s] 29%|██▉       | 288/981 [00:15<00:34, 19.99it/s] 30%|██▉       | 290/981 [00:15<00:35, 19.34it/s] 30%|██▉       | 292/981 [00:15<00:35, 19.17it/s] 30%|███       | 295/981 [00:15<00:35, 19.23it/s] 30%|███       | 297/981 [00:15<00:36, 18.79it/s] 30%|███       | 299/981 [00:15<00:36, 18.88it/s] 31%|███       | 301/981 [00:16<00:36, 18.50it/s] 31%|███       | 303/981 [00:16<00:37, 18.16it/s] 31%|███       | 305/981 [00:16<00:37, 18.07it/s] 31%|███▏      | 307/981 [00:16<00:39, 16.88it/s] 31%|███▏      | 309/981 [00:16<00:39, 17.13it/s] 32%|███▏      | 311/981 [00:16<00:39, 16.88it/s] 32%|███▏      | 313/981 [00:16<00:40, 16.34it/s] 32%|███▏      | 316/981 [00:16<00:37, 17.83it/s] 32%|███▏      | 318/981 [00:17<00:36, 18.14it/s] 33%|███▎      | 320/981 [00:17<00:37, 17.77it/s] 33%|███▎      | 322/981 [00:17<00:38, 17.08it/s] 33%|███▎      | 324/981 [00:17<00:36, 17.83it/s] 33%|███▎      | 326/981 [00:17<00:37, 17.66it/s] 33%|███▎      | 328/981 [00:17<00:37, 17.56it/s] 34%|███▎      | 330/981 [00:17<00:36, 17.71it/s] 34%|███▍      | 332/981 [00:17<00:36, 17.87it/s] 34%|███▍      | 334/981 [00:17<00:38, 16.74it/s] 34%|███▍      | 336/981 [00:18<00:38, 16.90it/s] 34%|███▍      | 338/981 [00:18<00:38, 16.61it/s] 35%|███▍      | 340/981 [00:18<00:39, 16.42it/s] 35%|███▍      | 342/981 [00:18<00:37, 16.86it/s] 35%|███▌      | 344/981 [00:18<00:36, 17.52it/s] 35%|███▌      | 346/981 [00:18<00:36, 17.18it/s] 35%|███▌      | 348/981 [00:18<00:35, 17.91it/s] 36%|███▌      | 350/981 [00:18<00:34, 18.07it/s] 36%|███▌      | 352/981 [00:19<00:34, 18.06it/s] 36%|███▌      | 354/981 [00:19<00:34, 18.00it/s] 36%|███▋      | 356/981 [00:19<00:35, 17.86it/s] 36%|███▋      | 358/981 [00:19<00:36, 17.11it/s] 37%|███▋      | 361/981 [00:19<00:34, 17.82it/s] 37%|███▋      | 363/981 [00:19<00:34, 17.89it/s] 37%|███▋      | 365/981 [00:19<00:35, 17.26it/s] 37%|███▋      | 367/981 [00:19<00:35, 17.22it/s] 38%|███▊      | 369/981 [00:19<00:35, 17.31it/s] 38%|███▊      | 371/981 [00:20<00:36, 16.59it/s] 38%|███▊      | 374/981 [00:20<00:34, 17.54it/s] 38%|███▊      | 376/981 [00:20<00:34, 17.62it/s] 39%|███▊      | 378/981 [00:20<00:34, 17.73it/s] 39%|███▊      | 380/981 [00:20<00:33, 18.01it/s] 39%|███▉      | 382/981 [00:20<00:33, 18.05it/s] 39%|███▉      | 384/981 [00:20<00:34, 17.44it/s] 39%|███▉      | 386/981 [00:20<00:33, 17.93it/s] 40%|███▉      | 388/981 [00:21<00:33, 17.51it/s] 40%|███▉      | 390/981 [00:21<00:33, 17.63it/s] 40%|████      | 393/981 [00:21<00:32, 18.23it/s] 40%|████      | 395/981 [00:21<00:32, 18.06it/s] 40%|████      | 397/981 [00:21<00:33, 17.19it/s] 41%|████      | 399/981 [00:21<00:34, 17.01it/s] 41%|████      | 402/981 [00:21<00:31, 18.16it/s] 41%|████      | 404/981 [00:21<00:32, 17.59it/s] 41%|████▏     | 406/981 [00:22<00:33, 17.30it/s] 42%|████▏     | 408/981 [00:22<00:32, 17.69it/s] 42%|████▏     | 410/981 [00:22<00:33, 17.18it/s] 42%|████▏     | 412/981 [00:22<00:32, 17.34it/s] 42%|████▏     | 414/981 [00:22<00:33, 16.97it/s] 42%|████▏     | 416/981 [00:22<00:32, 17.17it/s] 43%|████▎     | 418/981 [00:22<00:32, 17.31it/s] 43%|████▎     | 421/981 [00:22<00:30, 18.29it/s] 43%|████▎     | 423/981 [00:23<00:33, 16.83it/s] 43%|████▎     | 425/981 [00:23<00:33, 16.64it/s] 44%|████▎     | 428/981 [00:23<00:31, 17.29it/s] 44%|████▍     | 430/981 [00:23<00:30, 17.81it/s] 44%|████▍     | 432/981 [00:23<00:31, 17.70it/s] 44%|████▍     | 434/981 [00:23<00:30, 17.95it/s] 45%|████▍     | 437/981 [00:23<00:29, 18.23it/s] 45%|████▍     | 439/981 [00:23<00:29, 18.44it/s] 45%|████▍     | 441/981 [00:24<00:31, 17.36it/s] 45%|████▌     | 443/981 [00:24<00:31, 17.06it/s] 45%|████▌     | 446/981 [00:24<00:29, 18.24it/s] 46%|████▌     | 448/981 [00:24<00:29, 18.21it/s] 46%|████▌     | 450/981 [00:24<00:29, 17.75it/s] 46%|████▌     | 452/981 [00:24<00:29, 17.65it/s] 46%|████▋     | 454/981 [00:24<00:29, 17.85it/s] 46%|████▋     | 456/981 [00:24<00:29, 17.57it/s] 47%|████▋     | 458/981 [00:25<00:29, 17.86it/s] 47%|████▋     | 460/981 [00:25<00:28, 18.09it/s] 47%|████▋     | 462/981 [00:25<00:28, 18.30it/s] 47%|████▋     | 464/981 [00:25<00:29, 17.75it/s] 48%|████▊     | 466/981 [00:25<00:29, 17.41it/s] 48%|████▊     | 469/981 [00:25<00:28, 17.90it/s] 48%|████▊     | 471/981 [00:25<00:28, 18.15it/s] 48%|████▊     | 473/981 [00:25<00:28, 17.97it/s] 48%|████▊     | 475/981 [00:25<00:28, 17.89it/s] 49%|████▊     | 477/981 [00:26<00:28, 17.79it/s] 49%|████▉     | 480/981 [00:26<00:27, 18.52it/s] 49%|████▉     | 482/981 [00:26<00:26, 18.55it/s] 49%|████▉     | 484/981 [00:26<00:27, 18.27it/s] 50%|████▉     | 486/981 [00:26<00:26, 18.36it/s] 50%|████▉     | 488/981 [00:26<00:27, 18.03it/s] 50%|█████     | 491/981 [00:26<00:25, 19.03it/s] 50%|█████     | 493/981 [00:26<00:25, 19.14it/s] 50%|█████     | 495/981 [00:27<00:25, 18.84it/s] 51%|█████     | 497/981 [00:27<00:26, 18.52it/s] 51%|█████     | 499/981 [00:27<00:25, 18.60it/s] 51%|█████     | 501/981 [00:27<00:25, 18.94it/s] 51%|█████▏    | 503/981 [00:27<00:25, 18.80it/s] 51%|█████▏    | 505/981 [00:27<00:25, 18.73it/s] 52%|█████▏    | 507/981 [00:27<00:25, 18.47it/s] 52%|█████▏    | 509/981 [00:27<00:26, 18.15it/s] 52%|█████▏    | 511/981 [00:27<00:26, 17.81it/s] 52%|█████▏    | 513/981 [00:28<00:27, 17.09it/s] 53%|█████▎    | 516/981 [00:28<00:26, 17.80it/s] 53%|█████▎    | 518/981 [00:28<00:26, 17.54it/s] 53%|█████▎    | 520/981 [00:28<00:25, 17.85it/s] 53%|█████▎    | 522/981 [00:28<00:25, 17.75it/s] 54%|█████▎    | 525/981 [00:28<00:24, 18.27it/s] 54%|█████▎    | 527/981 [00:28<00:24, 18.67it/s] 54%|█████▍    | 530/981 [00:28<00:23, 18.96it/s] 54%|█████▍    | 532/981 [00:29<00:23, 19.01it/s] 55%|█████▍    | 535/981 [00:29<00:22, 19.46it/s] 55%|█████▍    | 537/981 [00:29<00:22, 19.50it/s] 55%|█████▍    | 539/981 [00:29<00:22, 19.49it/s] 55%|█████▌    | 541/981 [00:29<00:22, 19.40it/s] 55%|█████▌    | 543/981 [00:29<00:22, 19.25it/s] 56%|█████▌    | 545/981 [00:29<00:22, 19.02it/s] 56%|█████▌    | 548/981 [00:29<00:22, 19.09it/s] 56%|█████▌    | 550/981 [00:29<00:22, 19.12it/s] 56%|█████▋    | 552/981 [00:30<00:22, 19.19it/s] 56%|█████▋    | 554/981 [00:30<00:22, 19.03it/s] 57%|█████▋    | 556/981 [00:30<00:22, 19.03it/s] 57%|█████▋    | 558/981 [00:30<00:22, 19.06it/s] 57%|█████▋    | 560/981 [00:30<00:23, 18.29it/s] 57%|█████▋    | 562/981 [00:30<00:23, 18.18it/s] 58%|█████▊    | 565/981 [00:30<00:22, 18.43it/s] 58%|█████▊    | 567/981 [00:30<00:22, 18.79it/s] 58%|█████▊    | 570/981 [00:31<00:20, 19.61it/s] 58%|█████▊    | 573/981 [00:31<00:20, 19.60it/s] 59%|█████▊    | 575/981 [00:31<00:20, 19.63it/s] 59%|█████▉    | 578/981 [00:31<00:20, 19.53it/s] 59%|█████▉    | 581/981 [00:31<00:20, 19.74it/s] 59%|█████▉    | 583/981 [00:31<00:20, 19.73it/s] 60%|█████▉    | 585/981 [00:31<00:20, 19.25it/s] 60%|█████▉    | 587/981 [00:31<00:21, 18.49it/s] 60%|██████    | 589/981 [00:32<00:22, 17.26it/s] 60%|██████    | 591/981 [00:32<00:23, 16.35it/s] 60%|██████    | 593/981 [00:32<00:23, 16.61it/s] 61%|██████    | 595/981 [00:32<00:22, 17.24it/s] 61%|██████    | 598/981 [00:32<00:20, 18.32it/s] 61%|██████    | 600/981 [00:32<00:20, 18.16it/s] 61%|██████▏   | 602/981 [00:32<00:20, 18.36it/s] 62%|██████▏   | 604/981 [00:32<00:21, 17.66it/s] 62%|██████▏   | 606/981 [00:33<00:20, 17.99it/s] 62%|██████▏   | 608/981 [00:33<00:20, 18.16it/s] 62%|██████▏   | 610/981 [00:33<00:20, 17.94it/s] 62%|██████▏   | 612/981 [00:33<00:20, 18.38it/s] 63%|██████▎   | 615/981 [00:33<00:19, 18.58it/s] 63%|██████▎   | 617/981 [00:33<00:19, 18.31it/s] 63%|██████▎   | 619/981 [00:33<00:20, 18.02it/s] 63%|██████▎   | 621/981 [00:33<00:19, 18.18it/s] 64%|██████▎   | 624/981 [00:33<00:18, 18.94it/s] 64%|██████▍   | 627/981 [00:34<00:18, 19.02it/s] 64%|██████▍   | 630/981 [00:34<00:17, 19.59it/s] 64%|██████▍   | 632/981 [00:34<00:17, 19.57it/s] 65%|██████▍   | 634/981 [00:34<00:17, 19.41it/s] 65%|██████▍   | 636/981 [00:34<00:18, 18.41it/s] 65%|██████▌   | 638/981 [00:34<00:18, 18.36it/s] 65%|██████▌   | 640/981 [00:34<00:18, 18.48it/s] 66%|██████▌   | 643/981 [00:34<00:17, 19.43it/s] 66%|██████▌   | 645/981 [00:35<00:17, 19.04it/s] 66%|██████▌   | 647/981 [00:35<00:17, 18.95it/s] 66%|██████▌   | 649/981 [00:35<00:17, 18.49it/s] 66%|██████▋   | 651/981 [00:35<00:18, 17.63it/s] 67%|██████▋   | 653/981 [00:35<00:18, 17.36it/s] 67%|██████▋   | 656/981 [00:35<00:18, 17.64it/s] 67%|██████▋   | 658/981 [00:35<00:18, 17.59it/s] 67%|██████▋   | 660/981 [00:35<00:18, 17.30it/s] 67%|██████▋   | 662/981 [00:36<00:18, 16.99it/s] 68%|██████▊   | 664/981 [00:36<00:18, 17.49it/s] 68%|██████▊   | 666/981 [00:36<00:17, 17.50it/s] 68%|██████▊   | 669/981 [00:36<00:17, 18.14it/s] 68%|██████▊   | 671/981 [00:36<00:17, 17.38it/s] 69%|██████▊   | 673/981 [00:36<00:17, 17.53it/s] 69%|██████▉   | 676/981 [00:36<00:16, 18.42it/s] 69%|██████▉   | 679/981 [00:36<00:15, 19.22it/s] 69%|██████▉   | 681/981 [00:37<00:15, 19.22it/s] 70%|██████▉   | 683/981 [00:37<00:15, 19.40it/s] 70%|██████▉   | 685/981 [00:37<00:15, 18.78it/s] 70%|███████   | 687/981 [00:37<00:15, 19.01it/s] 70%|███████   | 689/981 [00:37<00:15, 19.05it/s] 70%|███████   | 691/981 [00:37<00:15, 19.05it/s] 71%|███████   | 693/981 [00:37<00:15, 19.00it/s] 71%|███████   | 695/981 [00:37<00:15, 19.06it/s] 71%|███████   | 697/981 [00:37<00:14, 18.97it/s] 71%|███████▏  | 699/981 [00:38<00:15, 18.47it/s] 71%|███████▏  | 701/981 [00:38<00:15, 18.01it/s] 72%|███████▏  | 703/981 [00:38<00:15, 18.51it/s] 72%|███████▏  | 705/981 [00:38<00:15, 18.39it/s] 72%|███████▏  | 707/981 [00:38<00:14, 18.53it/s] 72%|███████▏  | 710/981 [00:38<00:14, 19.04it/s] 73%|███████▎  | 713/981 [00:38<00:13, 19.47it/s] 73%|███████▎  | 716/981 [00:38<00:13, 19.58it/s] 73%|███████▎  | 719/981 [00:39<00:13, 19.60it/s] 73%|███████▎  | 721/981 [00:39<00:13, 18.97it/s] 74%|███████▎  | 723/981 [00:39<00:14, 18.39it/s] 74%|███████▍  | 726/981 [00:39<00:13, 19.01it/s] 74%|███████▍  | 728/981 [00:39<00:13, 18.71it/s] 75%|███████▍  | 731/981 [00:39<00:12, 19.53it/s] 75%|███████▍  | 734/981 [00:39<00:12, 19.35it/s] 75%|███████▌  | 736/981 [00:40<00:12, 19.10it/s] 75%|███████▌  | 739/981 [00:40<00:12, 19.53it/s] 76%|███████▌  | 741/981 [00:40<00:12, 19.16it/s] 76%|███████▌  | 744/981 [00:40<00:11, 19.91it/s] 76%|███████▌  | 746/981 [00:40<00:12, 19.33it/s] 76%|███████▌  | 748/981 [00:40<00:12, 18.94it/s] 76%|███████▋  | 750/981 [00:40<00:12, 19.18it/s] 77%|███████▋  | 752/981 [00:40<00:11, 19.34it/s] 77%|███████▋  | 754/981 [00:40<00:11, 19.08it/s] 77%|███████▋  | 757/981 [00:41<00:11, 19.70it/s] 77%|███████▋  | 759/981 [00:41<00:11, 18.58it/s] 78%|███████▊  | 762/981 [00:41<00:11, 19.23it/s] 78%|███████▊  | 764/981 [00:41<00:11, 18.98it/s] 78%|███████▊  | 766/981 [00:41<00:11, 18.25it/s] 78%|███████▊  | 768/981 [00:41<00:12, 17.65it/s] 78%|███████▊  | 770/981 [00:41<00:12, 17.57it/s] 79%|███████▊  | 772/981 [00:41<00:11, 17.88it/s] 79%|███████▉  | 774/981 [00:42<00:12, 17.22it/s] 79%|███████▉  | 776/981 [00:42<00:11, 17.23it/s] 79%|███████▉  | 778/981 [00:42<00:11, 17.52it/s] 80%|███████▉  | 781/981 [00:42<00:10, 18.21it/s] 80%|███████▉  | 783/981 [00:42<00:11, 17.30it/s] 80%|████████  | 785/981 [00:42<00:11, 17.29it/s] 80%|████████  | 787/981 [00:42<00:11, 17.44it/s] 80%|████████  | 789/981 [00:42<00:10, 17.74it/s] 81%|████████  | 791/981 [00:43<00:10, 17.96it/s] 81%|████████  | 794/981 [00:43<00:09, 19.64it/s] 81%|████████  | 796/981 [00:43<00:09, 19.41it/s] 81%|████████▏ | 799/981 [00:43<00:08, 20.43it/s] 82%|████████▏ | 802/981 [00:43<00:08, 20.20it/s] 82%|████████▏ | 805/981 [00:43<00:08, 20.23it/s] 82%|████████▏ | 808/981 [00:43<00:08, 19.82it/s] 83%|████████▎ | 811/981 [00:43<00:08, 19.77it/s] 83%|████████▎ | 814/981 [00:44<00:08, 19.99it/s] 83%|████████▎ | 816/981 [00:44<00:08, 19.73it/s] 83%|████████▎ | 818/981 [00:44<00:08, 19.80it/s] 84%|████████▎ | 821/981 [00:44<00:08, 19.95it/s] 84%|████████▍ | 823/981 [00:44<00:07, 19.78it/s] 84%|████████▍ | 825/981 [00:44<00:07, 19.62it/s] 84%|████████▍ | 828/981 [00:44<00:07, 20.92it/s] 85%|████████▍ | 831/981 [00:44<00:07, 20.24it/s] 85%|████████▌ | 834/981 [00:45<00:07, 20.68it/s] 85%|████████▌ | 837/981 [00:45<00:06, 21.61it/s] 86%|████████▌ | 840/981 [00:45<00:06, 21.30it/s] 86%|████████▌ | 843/981 [00:45<00:06, 21.35it/s] 86%|████████▌ | 846/981 [00:45<00:06, 20.87it/s] 87%|████████▋ | 849/981 [00:45<00:06, 21.08it/s] 87%|████████▋ | 852/981 [00:45<00:06, 20.76it/s] 87%|████████▋ | 855/981 [00:46<00:06, 20.37it/s] 87%|████████▋ | 858/981 [00:46<00:06, 19.96it/s] 88%|████████▊ | 861/981 [00:46<00:05, 21.12it/s] 88%|████████▊ | 864/981 [00:46<00:05, 20.81it/s] 88%|████████▊ | 867/981 [00:46<00:05, 20.78it/s] 89%|████████▊ | 870/981 [00:46<00:05, 21.48it/s] 89%|████████▉ | 873/981 [00:46<00:05, 20.53it/s] 89%|████████▉ | 876/981 [00:47<00:05, 20.38it/s] 90%|████████▉ | 879/981 [00:47<00:04, 20.54it/s] 90%|████████▉ | 882/981 [00:47<00:04, 20.74it/s] 90%|█████████ | 885/981 [00:47<00:04, 20.99it/s] 91%|█████████ | 888/981 [00:47<00:04, 19.93it/s] 91%|█████████ | 891/981 [00:47<00:04, 20.20it/s] 91%|█████████ | 894/981 [00:48<00:04, 20.22it/s] 91%|█████████▏| 897/981 [00:48<00:04, 20.88it/s] 92%|█████████▏| 900/981 [00:48<00:04, 20.25it/s] 92%|█████████▏| 903/981 [00:48<00:03, 20.63it/s] 92%|█████████▏| 906/981 [00:48<00:03, 20.97it/s] 93%|█████████▎| 909/981 [00:48<00:03, 20.47it/s] 93%|█████████▎| 912/981 [00:48<00:03, 19.96it/s] 93%|█████████▎| 915/981 [00:49<00:03, 19.37it/s] 93%|█████████▎| 917/981 [00:49<00:03, 19.49it/s] 94%|█████████▍| 920/981 [00:49<00:03, 20.25it/s] 94%|█████████▍| 923/981 [00:49<00:02, 20.84it/s] 94%|█████████▍| 926/981 [00:49<00:02, 20.60it/s] 95%|█████████▍| 929/981 [00:49<00:02, 20.97it/s] 95%|█████████▌| 932/981 [00:49<00:02, 20.99it/s] 95%|█████████▌| 935/981 [00:50<00:02, 20.17it/s] 96%|█████████▌| 938/981 [00:50<00:02, 19.72it/s] 96%|█████████▌| 941/981 [00:50<00:02, 19.75it/s] 96%|█████████▌| 944/981 [00:50<00:01, 20.59it/s] 97%|█████████▋| 947/981 [00:50<00:01, 21.40it/s] 97%|█████████▋| 950/981 [00:50<00:01, 21.06it/s] 97%|█████████▋| 953/981 [00:50<00:01, 21.50it/s] 97%|█████████▋| 956/981 [00:51<00:01, 21.87it/s] 98%|█████████▊| 959/981 [00:51<00:01, 20.84it/s] 98%|█████████▊| 962/981 [00:51<00:00, 19.85it/s] 98%|█████████▊| 965/981 [00:51<00:00, 19.66it/s] 99%|█████████▊| 967/981 [00:51<00:00, 19.23it/s] 99%|█████████▉| 970/981 [00:51<00:00, 20.41it/s] 99%|█████████▉| 973/981 [00:51<00:00, 20.10it/s] 99%|█████████▉| 976/981 [00:52<00:00, 19.75it/s]100%|█████████▉| 978/981 [00:52<00:00, 19.45it/s]100%|█████████▉| 980/981 [00:52<00:00, 19.22it/s]100%|██████████| 981/981 [00:52<00:00, 18.75it/s]
time :  1002
prob :  1002
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]       1,578,240       1,578,240
           ViViT      Transformer-5             [8, 22, 128]       1,578,240       1,578,240
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 3,263,426
Trainable params: 3,263,426
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.092, valid loss : 0.053, train acc : 0.687, valid acc : 0.972, train f1 : 0.679, valid f1 : 0.710
training process:   2%|▏         | 1/50 [07:42<6:17:20, 462.06s/it]training process:   4%|▍         | 2/50 [15:09<6:02:41, 453.37s/it]training process:   6%|▌         | 3/50 [22:37<5:53:07, 450.80s/it]training process:   8%|▊         | 4/50 [29:52<5:40:57, 444.72s/it]epoch : 5, train loss : 0.042, valid loss : 0.015, train acc : 0.879, valid acc : 0.986, train f1 : 0.879, valid f1 : 0.827
training process:  10%|█         | 5/50 [37:20<5:34:32, 446.05s/it]training process:  12%|█▏        | 6/50 [44:54<5:29:06, 448.79s/it]training process:  14%|█▍        | 7/50 [52:13<5:19:19, 445.56s/it]training process:  16%|█▌        | 8/50 [59:32<5:10:14, 443.21s/it]epoch : 9, train loss : 0.035, valid loss : 0.019, train acc : 0.897, valid acc : 0.961, train f1 : 0.897, valid f1 : 0.706
training process:  18%|█▊        | 9/50 [1:06:52<5:02:17, 442.37s/it]training process:  20%|██        | 10/50 [1:14:11<4:54:14, 441.35s/it]training process:  22%|██▏       | 11/50 [1:21:33<4:46:53, 441.37s/it]training process:  24%|██▍       | 12/50 [1:28:54<4:39:38, 441.53s/it]epoch : 13, train loss : 0.030, valid loss : 0.011, train acc : 0.912, valid acc : 0.986, train f1 : 0.912, valid f1 : 0.832
training process:  26%|██▌       | 13/50 [1:36:07<4:30:32, 438.72s/it]training process:  28%|██▊       | 14/50 [1:43:26<4:23:24, 439.01s/it]training process:  30%|███       | 15/50 [1:50:41<4:15:16, 437.62s/it]training process:  32%|███▏      | 16/50 [1:57:56<4:07:34, 436.89s/it]epoch : 17, train loss : 0.030, valid loss : 0.013, train acc : 0.913, valid acc : 0.950, train f1 : 0.913, valid f1 : 0.685
training process:  34%|███▍      | 17/50 [2:05:11<3:59:58, 436.31s/it]training process:  36%|███▌      | 18/50 [2:12:27<3:52:35, 436.12s/it]training process:  38%|███▊      | 19/50 [2:19:38<3:44:34, 434.66s/it]training process:  40%|████      | 20/50 [2:26:52<3:37:10, 434.36s/it]