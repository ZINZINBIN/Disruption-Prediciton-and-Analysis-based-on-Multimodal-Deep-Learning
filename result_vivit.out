############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_1_Focal_RS_DRW_seed_40
train data : 14427, disrupt : 227, non-disrupt : 14200
valid data : 3519, disrupt : 57, non-disrupt : 3462
test data : 4062, disrupt : 71, non-disrupt : 3991

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.059, valid loss : 0.037, train f1 : 0.890, valid f1 : 0.632
Best score increase :0.000 -> 0.632
training process - Deferred Re-weighting:   1%|          | 1/128 [09:56<21:03:12, 596.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 2/128 [19:04<19:53:05, 568.14s/it]Best score increase :0.632 -> 0.854
training process - Deferred Re-weighting:   2%|▏         | 3/128 [28:12<19:24:20, 558.89s/it]Best score increase :0.854 -> 0.860
training process - Deferred Re-weighting:   3%|▎         | 4/128 [37:20<19:06:12, 554.62s/it]epoch : 5, train loss : 0.022, valid loss : 0.017, train f1 : 0.957, valid f1 : 0.652
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [47:15<19:26:39, 569.10s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [56:25<19:03:57, 562.60s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [1:05:33<18:45:06, 557.91s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [1:14:50<18:35:02, 557.52s/it]epoch : 9, train loss : 0.021, valid loss : 0.045, train f1 : 0.958, valid f1 : 0.591
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [1:24:42<18:46:55, 568.20s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [1:33:49<18:24:28, 561.59s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [1:42:58<18:07:37, 557.75s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [1:52:07<17:53:24, 555.21s/it]epoch : 13, train loss : 0.019, valid loss : 0.039, train f1 : 0.961, valid f1 : 0.612
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [2:02:03<18:07:59, 567.65s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [2:11:11<17:47:11, 561.68s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [2:20:34<17:38:24, 561.98s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 15, best f1 score : 0.860
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [2:29:50<18:48:50, 599.38s/it]
training process finished, best loss : 0.017, best acc : 0.989, best f1 : 0.860, best epoch : 3

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.83      0.89      0.86        71
           1       1.00      1.00      1.00      3991

    accuracy                           0.99      4062
   macro avg       0.91      0.94      0.93      4062
weighted avg       1.00      0.99      0.99      4062


# test acc : 0.99, test f1 : 0.93, test AUC : 0.94, test loss : 0.490

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/983 [00:00<?, ?it/s]  0%|          | 2/983 [00:00<01:05, 15.08it/s]  0%|          | 4/983 [00:00<01:16, 12.76it/s]  1%|          | 6/983 [00:00<01:38,  9.90it/s]  1%|          | 8/983 [00:00<02:08,  7.58it/s]  1%|          | 9/983 [00:01<02:02,  7.97it/s]  1%|          | 10/983 [00:01<02:13,  7.27it/s]  1%|▏         | 13/983 [00:01<01:27, 11.03it/s]  2%|▏         | 16/983 [00:01<01:08, 14.08it/s]  2%|▏         | 18/983 [00:01<01:05, 14.79it/s]  2%|▏         | 21/983 [00:01<00:57, 16.64it/s]  2%|▏         | 24/983 [00:01<00:51, 18.60it/s]  3%|▎         | 27/983 [00:01<00:47, 20.05it/s]  3%|▎         | 30/983 [00:02<00:45, 21.12it/s]  3%|▎         | 33/983 [00:02<00:53, 17.61it/s]  4%|▎         | 35/983 [00:02<00:59, 15.92it/s]  4%|▍         | 37/983 [00:02<01:07, 14.06it/s]  4%|▍         | 39/983 [00:02<01:15, 12.50it/s]  4%|▍         | 41/983 [00:03<01:21, 11.52it/s]  4%|▍         | 43/983 [00:03<01:29, 10.47it/s]  5%|▍         | 46/983 [00:03<01:11, 13.04it/s]  5%|▍         | 49/983 [00:03<01:00, 15.47it/s]  5%|▌         | 52/983 [00:03<00:53, 17.53it/s]  6%|▌         | 55/983 [00:03<00:48, 19.15it/s]  6%|▌         | 58/983 [00:03<00:45, 20.42it/s]  6%|▌         | 61/983 [00:04<00:43, 21.37it/s]  7%|▋         | 64/983 [00:04<00:41, 22.05it/s]  7%|▋         | 67/983 [00:04<00:43, 21.17it/s]  7%|▋         | 70/983 [00:04<00:49, 18.58it/s]  7%|▋         | 72/983 [00:04<01:03, 14.39it/s]  8%|▊         | 74/983 [00:05<01:10, 12.91it/s]  8%|▊         | 76/983 [00:05<01:10, 12.88it/s]  8%|▊         | 78/983 [00:05<01:09, 13.00it/s]  8%|▊         | 80/983 [00:05<01:09, 12.95it/s]  8%|▊         | 82/983 [00:05<01:06, 13.62it/s]  9%|▊         | 85/983 [00:05<00:57, 15.67it/s]  9%|▉         | 88/983 [00:05<00:50, 17.65it/s]  9%|▉         | 91/983 [00:06<00:46, 19.27it/s] 10%|▉         | 94/983 [00:06<00:43, 20.42it/s] 10%|▉         | 97/983 [00:06<00:41, 21.24it/s] 10%|█         | 100/983 [00:06<00:49, 17.87it/s] 10%|█         | 102/983 [00:06<00:53, 16.46it/s] 11%|█         | 104/983 [00:06<00:58, 15.03it/s] 11%|█         | 106/983 [00:07<01:08, 12.76it/s] 11%|█         | 108/983 [00:07<01:09, 12.56it/s] 11%|█         | 110/983 [00:07<01:13, 11.84it/s] 11%|█▏        | 112/983 [00:07<01:07, 12.88it/s] 12%|█▏        | 115/983 [00:07<00:55, 15.61it/s] 12%|█▏        | 118/983 [00:07<00:48, 17.75it/s] 12%|█▏        | 121/983 [00:07<00:44, 19.31it/s] 13%|█▎        | 124/983 [00:08<00:42, 20.29it/s] 13%|█▎        | 127/983 [00:08<00:40, 21.18it/s] 13%|█▎        | 130/983 [00:08<00:39, 21.75it/s] 14%|█▎        | 133/983 [00:08<00:44, 19.11it/s] 14%|█▎        | 135/983 [00:08<00:49, 17.24it/s] 14%|█▍        | 137/983 [00:08<00:52, 16.14it/s] 14%|█▍        | 139/983 [00:08<00:54, 15.58it/s] 14%|█▍        | 141/983 [00:09<00:57, 14.70it/s] 15%|█▍        | 143/983 [00:09<00:57, 14.61it/s] 15%|█▍        | 145/983 [00:09<00:59, 14.16it/s] 15%|█▍        | 147/983 [00:09<01:05, 12.83it/s] 15%|█▌        | 150/983 [00:09<00:53, 15.61it/s] 16%|█▌        | 153/983 [00:09<00:46, 17.83it/s] 16%|█▌        | 156/983 [00:09<00:42, 19.56it/s] 16%|█▌        | 159/983 [00:10<00:39, 20.77it/s] 16%|█▋        | 162/983 [00:10<00:38, 21.51it/s] 17%|█▋        | 165/983 [00:10<00:36, 22.22it/s] 17%|█▋        | 168/983 [00:10<00:36, 22.61it/s] 17%|█▋        | 171/983 [00:10<00:40, 20.26it/s] 18%|█▊        | 174/983 [00:11<00:55, 14.54it/s] 18%|█▊        | 176/983 [00:11<01:03, 12.77it/s] 18%|█▊        | 178/983 [00:11<01:00, 13.35it/s] 18%|█▊        | 180/983 [00:11<01:07, 11.87it/s] 19%|█▊        | 182/983 [00:11<01:03, 12.66it/s] 19%|█▉        | 185/983 [00:11<00:52, 15.16it/s] 19%|█▉        | 188/983 [00:11<00:45, 17.35it/s] 19%|█▉        | 191/983 [00:12<00:41, 19.11it/s] 20%|█▉        | 194/983 [00:12<00:38, 20.32it/s] 20%|██        | 197/983 [00:12<00:37, 21.24it/s] 20%|██        | 200/983 [00:12<00:35, 21.80it/s] 21%|██        | 203/983 [00:12<00:39, 19.99it/s] 21%|██        | 206/983 [00:12<00:44, 17.43it/s] 21%|██        | 208/983 [00:13<00:51, 14.95it/s] 21%|██▏       | 210/983 [00:13<01:02, 12.29it/s] 22%|██▏       | 212/983 [00:13<01:10, 11.00it/s] 22%|██▏       | 214/983 [00:13<01:13, 10.52it/s] 22%|██▏       | 216/983 [00:13<01:04, 11.98it/s] 22%|██▏       | 219/983 [00:14<00:52, 14.64it/s] 23%|██▎       | 222/983 [00:14<00:45, 16.78it/s] 23%|██▎       | 225/983 [00:14<00:41, 18.44it/s] 23%|██▎       | 228/983 [00:14<00:38, 19.61it/s] 23%|██▎       | 231/983 [00:14<00:36, 20.66it/s] 24%|██▍       | 234/983 [00:14<00:35, 21.06it/s] 24%|██▍       | 237/983 [00:14<00:43, 17.06it/s] 24%|██▍       | 239/983 [00:15<00:48, 15.26it/s] 25%|██▍       | 241/983 [00:15<00:50, 14.77it/s] 25%|██▍       | 243/983 [00:15<01:03, 11.71it/s] 25%|██▍       | 245/983 [00:15<01:09, 10.69it/s] 25%|██▌       | 247/983 [00:15<01:04, 11.48it/s] 25%|██▌       | 249/983 [00:16<00:56, 13.00it/s] 26%|██▌       | 252/983 [00:16<00:47, 15.36it/s] 26%|██▌       | 255/983 [00:16<00:41, 17.39it/s] 26%|██▌       | 258/983 [00:16<00:38, 18.88it/s] 27%|██▋       | 261/983 [00:16<00:36, 19.94it/s] 27%|██▋       | 264/983 [00:16<00:34, 20.82it/s] 27%|██▋       | 267/983 [00:16<00:35, 20.36it/s] 27%|██▋       | 270/983 [00:17<00:48, 14.62it/s] 28%|██▊       | 272/983 [00:17<00:50, 14.13it/s] 28%|██▊       | 274/983 [00:17<00:53, 13.17it/s] 28%|██▊       | 276/983 [00:17<01:01, 11.44it/s] 28%|██▊       | 278/983 [00:17<01:03, 11.16it/s] 28%|██▊       | 280/983 [00:18<00:56, 12.38it/s] 29%|██▉       | 283/983 [00:18<00:46, 14.99it/s] 29%|██▉       | 286/983 [00:18<00:40, 17.13it/s] 29%|██▉       | 289/983 [00:18<00:36, 18.78it/s] 30%|██▉       | 292/983 [00:18<00:34, 19.95it/s] 30%|███       | 295/983 [00:18<00:33, 20.78it/s] 30%|███       | 298/983 [00:18<00:32, 21.40it/s] 31%|███       | 301/983 [00:19<00:38, 17.89it/s] 31%|███       | 303/983 [00:19<00:47, 14.30it/s] 31%|███       | 305/983 [00:19<00:49, 13.74it/s] 31%|███       | 307/983 [00:19<00:48, 13.80it/s] 31%|███▏      | 309/983 [00:19<00:50, 13.38it/s] 32%|███▏      | 311/983 [00:20<01:02, 10.83it/s] 32%|███▏      | 314/983 [00:20<00:50, 13.17it/s] 32%|███▏      | 317/983 [00:20<00:43, 15.38it/s] 33%|███▎      | 320/983 [00:20<00:38, 17.17it/s] 33%|███▎      | 323/983 [00:20<00:35, 18.60it/s] 33%|███▎      | 326/983 [00:20<00:33, 19.70it/s] 33%|███▎      | 329/983 [00:20<00:31, 20.60it/s] 34%|███▍      | 332/983 [00:20<00:30, 21.45it/s] 34%|███▍      | 335/983 [00:21<00:35, 18.50it/s] 34%|███▍      | 337/983 [00:21<00:45, 14.32it/s] 34%|███▍      | 339/983 [00:21<00:49, 13.07it/s] 35%|███▍      | 341/983 [00:21<00:49, 12.99it/s] 35%|███▍      | 343/983 [00:21<00:48, 13.33it/s] 35%|███▌      | 345/983 [00:22<00:53, 11.84it/s] 35%|███▌      | 348/983 [00:22<00:44, 14.43it/s] 36%|███▌      | 351/983 [00:22<00:37, 16.68it/s] 36%|███▌      | 354/983 [00:22<00:34, 18.38it/s] 36%|███▋      | 357/983 [00:22<00:31, 19.78it/s] 37%|███▋      | 360/983 [00:22<00:29, 20.87it/s] 37%|███▋      | 363/983 [00:22<00:30, 20.65it/s] 37%|███▋      | 366/983 [00:23<00:29, 20.61it/s] 38%|███▊      | 369/983 [00:23<00:34, 17.87it/s] 38%|███▊      | 371/983 [00:23<00:37, 16.38it/s] 38%|███▊      | 373/983 [00:23<00:41, 14.59it/s] 38%|███▊      | 375/983 [00:23<00:42, 14.48it/s] 38%|███▊      | 377/983 [00:23<00:47, 12.78it/s] 39%|███▊      | 379/983 [00:24<00:50, 11.86it/s] 39%|███▉      | 382/983 [00:24<00:41, 14.48it/s] 39%|███▉      | 385/983 [00:24<00:35, 16.79it/s] 39%|███▉      | 388/983 [00:24<00:31, 18.62it/s] 40%|███▉      | 391/983 [00:24<00:29, 20.09it/s] 40%|████      | 394/983 [00:24<00:28, 20.88it/s] 40%|████      | 397/983 [00:24<00:28, 20.32it/s] 41%|████      | 400/983 [00:25<00:34, 17.14it/s] 41%|████      | 402/983 [00:25<00:39, 14.59it/s] 41%|████      | 404/983 [00:25<00:49, 11.74it/s] 41%|████▏     | 406/983 [00:25<00:50, 11.34it/s] 42%|████▏     | 408/983 [00:26<00:59,  9.60it/s] 42%|████▏     | 411/983 [00:26<00:46, 12.24it/s] 42%|████▏     | 414/983 [00:26<00:38, 14.63it/s] 42%|████▏     | 417/983 [00:26<00:33, 16.71it/s] 43%|████▎     | 420/983 [00:26<00:30, 18.38it/s] 43%|████▎     | 423/983 [00:26<00:28, 19.84it/s] 43%|████▎     | 426/983 [00:26<00:26, 20.90it/s] 44%|████▎     | 429/983 [00:27<00:25, 21.56it/s] 44%|████▍     | 432/983 [00:27<00:26, 20.61it/s] 44%|████▍     | 435/983 [00:27<00:33, 16.27it/s] 44%|████▍     | 437/983 [00:27<00:40, 13.54it/s] 45%|████▍     | 439/983 [00:27<00:41, 13.24it/s] 45%|████▍     | 441/983 [00:28<00:38, 14.16it/s] 45%|████▌     | 443/983 [00:28<00:43, 12.54it/s] 45%|████▌     | 445/983 [00:28<00:40, 13.17it/s] 46%|████▌     | 448/983 [00:28<00:34, 15.67it/s] 46%|████▌     | 451/983 [00:28<00:29, 17.76it/s] 46%|████▌     | 454/983 [00:28<00:27, 19.46it/s] 46%|████▋     | 457/983 [00:28<00:25, 20.64it/s] 47%|████▋     | 460/983 [00:28<00:24, 21.45it/s] 47%|████▋     | 463/983 [00:29<00:23, 22.11it/s] 47%|████▋     | 466/983 [00:29<00:23, 21.82it/s] 48%|████▊     | 469/983 [00:29<00:27, 18.81it/s] 48%|████▊     | 471/983 [00:29<00:29, 17.13it/s] 48%|████▊     | 473/983 [00:29<00:31, 16.08it/s] 48%|████▊     | 475/983 [00:29<00:36, 14.05it/s] 49%|████▊     | 477/983 [00:30<00:37, 13.67it/s] 49%|████▊     | 479/983 [00:30<00:40, 12.30it/s] 49%|████▉     | 481/983 [00:30<00:37, 13.27it/s] 49%|████▉     | 484/983 [00:30<00:31, 15.64it/s] 50%|████▉     | 487/983 [00:30<00:28, 17.69it/s] 50%|████▉     | 490/983 [00:30<00:25, 19.33it/s] 50%|█████     | 493/983 [00:30<00:23, 20.44it/s] 50%|█████     | 496/983 [00:31<00:22, 21.29it/s] 51%|█████     | 499/983 [00:31<00:22, 21.82it/s] 51%|█████     | 502/983 [00:31<00:26, 17.88it/s] 51%|█████▏    | 504/983 [00:31<00:31, 15.40it/s] 51%|█████▏    | 506/983 [00:31<00:36, 13.11it/s] 52%|█████▏    | 508/983 [00:32<00:40, 11.60it/s] 52%|█████▏    | 510/983 [00:32<00:45, 10.35it/s] 52%|█████▏    | 512/983 [00:32<00:40, 11.67it/s] 52%|█████▏    | 515/983 [00:32<00:32, 14.41it/s] 53%|█████▎    | 518/983 [00:32<00:27, 16.73it/s] 53%|█████▎    | 521/983 [00:32<00:24, 18.49it/s] 53%|█████▎    | 524/983 [00:32<00:23, 19.94it/s] 54%|█████▎    | 527/983 [00:33<00:21, 21.02it/s] 54%|█████▍    | 530/983 [00:33<00:20, 21.84it/s] 54%|█████▍    | 533/983 [00:33<00:20, 21.61it/s] 55%|█████▍    | 536/983 [00:33<00:25, 17.60it/s] 55%|█████▍    | 538/983 [00:33<00:27, 15.90it/s] 55%|█████▍    | 540/983 [00:34<00:36, 12.17it/s] 55%|█████▌    | 542/983 [00:34<00:39, 11.15it/s] 55%|█████▌    | 544/983 [00:34<00:40, 10.74it/s] 56%|█████▌    | 547/983 [00:34<00:32, 13.45it/s] 56%|█████▌    | 550/983 [00:34<00:27, 15.90it/s] 56%|█████▋    | 553/983 [00:34<00:23, 18.00it/s] 57%|█████▋    | 556/983 [00:34<00:21, 19.65it/s] 57%|█████▋    | 559/983 [00:35<00:20, 20.78it/s] 57%|█████▋    | 562/983 [00:35<00:19, 21.66it/s] 57%|█████▋    | 565/983 [00:35<00:18, 22.06it/s] 58%|█████▊    | 568/983 [00:35<00:23, 18.01it/s] 58%|█████▊    | 570/983 [00:35<00:26, 15.44it/s] 58%|█████▊    | 572/983 [00:35<00:28, 14.35it/s] 58%|█████▊    | 574/983 [00:36<00:31, 12.88it/s] 59%|█████▊    | 576/983 [00:36<00:39, 10.33it/s] 59%|█████▉    | 579/983 [00:36<00:31, 12.91it/s] 59%|█████▉    | 582/983 [00:36<00:26, 15.42it/s] 60%|█████▉    | 585/983 [00:36<00:22, 17.61it/s] 60%|█████▉    | 588/983 [00:36<00:20, 19.47it/s] 60%|██████    | 591/983 [00:37<00:18, 20.85it/s] 60%|██████    | 594/983 [00:37<00:17, 21.67it/s] 61%|██████    | 597/983 [00:37<00:17, 22.54it/s] 61%|██████    | 600/983 [00:37<00:16, 22.67it/s] 61%|██████▏   | 603/983 [00:37<00:19, 19.06it/s] 62%|██████▏   | 606/983 [00:37<00:23, 16.21it/s] 62%|██████▏   | 608/983 [00:38<00:25, 14.99it/s] 62%|██████▏   | 610/983 [00:38<00:26, 13.81it/s] 62%|██████▏   | 612/983 [00:38<00:27, 13.38it/s] 62%|██████▏   | 614/983 [00:38<00:27, 13.19it/s] 63%|██████▎   | 617/983 [00:38<00:24, 15.09it/s] 63%|██████▎   | 620/983 [00:38<00:21, 16.91it/s] 63%|██████▎   | 623/983 [00:39<00:19, 18.91it/s] 64%|██████▎   | 626/983 [00:39<00:17, 20.47it/s] 64%|██████▍   | 629/983 [00:39<00:16, 21.39it/s] 64%|██████▍   | 632/983 [00:39<00:15, 22.27it/s] 65%|██████▍   | 635/983 [00:39<00:15, 22.84it/s] 65%|██████▍   | 638/983 [00:39<00:17, 19.97it/s] 65%|██████▌   | 641/983 [00:40<00:23, 14.46it/s] 65%|██████▌   | 643/983 [00:40<00:28, 12.08it/s] 66%|██████▌   | 645/983 [00:40<00:32, 10.37it/s] 66%|██████▌   | 647/983 [00:40<00:32, 10.45it/s] 66%|██████▌   | 649/983 [00:40<00:28, 11.82it/s] 66%|██████▋   | 652/983 [00:41<00:23, 14.13it/s] 67%|██████▋   | 655/983 [00:41<00:19, 16.50it/s] 67%|██████▋   | 658/983 [00:41<00:17, 18.47it/s] 67%|██████▋   | 661/983 [00:41<00:16, 20.07it/s] 68%|██████▊   | 664/983 [00:41<00:14, 21.31it/s] 68%|██████▊   | 667/983 [00:41<00:15, 20.77it/s] 68%|██████▊   | 670/983 [00:41<00:18, 17.18it/s] 68%|██████▊   | 672/983 [00:42<00:19, 15.74it/s] 69%|██████▊   | 674/983 [00:42<00:23, 13.36it/s] 69%|██████▉   | 676/983 [00:42<00:24, 12.58it/s] 69%|██████▉   | 678/983 [00:42<00:28, 10.87it/s] 69%|██████▉   | 680/983 [00:42<00:25, 11.81it/s] 69%|██████▉   | 683/983 [00:42<00:20, 14.53it/s] 70%|██████▉   | 685/983 [00:43<00:19, 14.97it/s] 70%|██████▉   | 687/983 [00:43<00:18, 16.04it/s] 70%|███████   | 690/983 [00:43<00:16, 17.89it/s] 70%|███████   | 693/983 [00:43<00:14, 19.37it/s] 71%|███████   | 696/983 [00:43<00:15, 18.45it/s] 71%|███████   | 698/983 [00:43<00:16, 17.75it/s] 71%|███████   | 700/983 [00:43<00:16, 16.96it/s] 71%|███████▏  | 702/983 [00:44<00:19, 14.60it/s] 72%|███████▏  | 704/983 [00:44<00:19, 14.62it/s] 72%|███████▏  | 706/983 [00:44<00:21, 12.78it/s] 72%|███████▏  | 708/983 [00:44<00:25, 10.76it/s] 72%|███████▏  | 710/983 [00:44<00:28,  9.70it/s] 72%|███████▏  | 712/983 [00:45<00:25, 10.73it/s] 73%|███████▎  | 714/983 [00:45<00:23, 11.57it/s] 73%|███████▎  | 717/983 [00:45<00:18, 14.55it/s] 73%|███████▎  | 720/983 [00:45<00:15, 17.06it/s] 74%|███████▎  | 723/983 [00:45<00:13, 19.06it/s] 74%|███████▍  | 726/983 [00:45<00:12, 20.65it/s] 74%|███████▍  | 729/983 [00:45<00:11, 21.49it/s] 74%|███████▍  | 732/983 [00:46<00:13, 19.10it/s] 75%|███████▍  | 735/983 [00:46<00:15, 16.06it/s] 75%|███████▍  | 737/983 [00:46<00:15, 15.78it/s] 75%|███████▌  | 739/983 [00:46<00:16, 15.13it/s] 75%|███████▌  | 741/983 [00:46<00:16, 14.74it/s] 76%|███████▌  | 743/983 [00:46<00:16, 14.36it/s] 76%|███████▌  | 745/983 [00:46<00:16, 14.79it/s] 76%|███████▌  | 748/983 [00:47<00:13, 17.28it/s] 76%|███████▋  | 751/983 [00:47<00:12, 19.18it/s] 77%|███████▋  | 754/983 [00:47<00:11, 20.48it/s] 77%|███████▋  | 757/983 [00:47<00:10, 21.38it/s] 77%|███████▋  | 760/983 [00:47<00:10, 21.79it/s] 78%|███████▊  | 763/983 [00:47<00:09, 22.05it/s] 78%|███████▊  | 766/983 [00:47<00:09, 22.09it/s] 78%|███████▊  | 769/983 [00:48<00:12, 17.14it/s] 78%|███████▊  | 771/983 [00:48<00:16, 13.17it/s] 79%|███████▊  | 773/983 [00:48<00:16, 12.73it/s] 79%|███████▉  | 775/983 [00:48<00:20, 10.23it/s] 79%|███████▉  | 778/983 [00:49<00:16, 12.66it/s] 79%|███████▉  | 781/983 [00:49<00:13, 15.15it/s] 80%|███████▉  | 784/983 [00:49<00:11, 17.28it/s] 80%|████████  | 787/983 [00:49<00:10, 19.01it/s] 80%|████████  | 790/983 [00:49<00:09, 19.96it/s] 81%|████████  | 793/983 [00:49<00:09, 19.71it/s] 81%|████████  | 796/983 [00:49<00:08, 21.07it/s] 81%|████████▏ | 799/983 [00:49<00:08, 20.80it/s] 82%|████████▏ | 802/983 [00:50<00:12, 15.01it/s] 82%|████████▏ | 804/983 [00:50<00:13, 13.69it/s] 82%|████████▏ | 806/983 [00:50<00:14, 12.26it/s] 82%|████████▏ | 808/983 [00:50<00:14, 11.92it/s] 82%|████████▏ | 810/983 [00:51<00:14, 11.69it/s] 83%|████████▎ | 813/983 [00:51<00:11, 14.63it/s] 83%|████████▎ | 816/983 [00:51<00:09, 17.33it/s] 83%|████████▎ | 819/983 [00:51<00:08, 19.64it/s] 84%|████████▎ | 822/983 [00:51<00:07, 21.44it/s] 84%|████████▍ | 825/983 [00:51<00:06, 22.90it/s] 84%|████████▍ | 828/983 [00:51<00:06, 23.90it/s] 85%|████████▍ | 831/983 [00:51<00:06, 24.74it/s] 85%|████████▍ | 834/983 [00:51<00:05, 24.88it/s] 85%|████████▌ | 837/983 [00:52<00:07, 20.40it/s] 85%|████████▌ | 840/983 [00:52<00:08, 16.02it/s] 86%|████████▌ | 842/983 [00:52<00:11, 12.56it/s] 86%|████████▌ | 844/983 [00:52<00:12, 11.44it/s] 86%|████████▌ | 846/983 [00:53<00:12, 10.93it/s] 86%|████████▋ | 849/983 [00:53<00:10, 13.35it/s] 87%|████████▋ | 852/983 [00:53<00:08, 16.02it/s] 87%|████████▋ | 855/983 [00:53<00:06, 18.37it/s] 87%|████████▋ | 858/983 [00:53<00:06, 20.36it/s] 88%|████████▊ | 861/983 [00:53<00:05, 21.96it/s] 88%|████████▊ | 864/983 [00:53<00:05, 23.03it/s] 88%|████████▊ | 867/983 [00:53<00:04, 23.73it/s] 89%|████████▊ | 870/983 [00:54<00:04, 23.36it/s] 89%|████████▉ | 873/983 [00:54<00:06, 16.84it/s] 89%|████████▉ | 875/983 [00:54<00:06, 16.35it/s] 89%|████████▉ | 878/983 [00:54<00:05, 18.41it/s] 90%|████████▉ | 881/983 [00:54<00:05, 17.38it/s] 90%|████████▉ | 883/983 [00:54<00:05, 16.79it/s] 90%|█████████ | 885/983 [00:55<00:06, 14.18it/s] 90%|█████████ | 888/983 [00:55<00:05, 16.93it/s] 91%|█████████ | 891/983 [00:55<00:04, 19.46it/s] 91%|█████████ | 894/983 [00:55<00:04, 21.49it/s] 91%|█████████▏| 897/983 [00:55<00:03, 22.13it/s] 92%|█████████▏| 900/983 [00:55<00:03, 23.10it/s] 92%|█████████▏| 903/983 [00:55<00:03, 24.20it/s] 92%|█████████▏| 906/983 [00:55<00:03, 25.17it/s] 92%|█████████▏| 909/983 [00:56<00:02, 25.42it/s] 93%|█████████▎| 912/983 [00:56<00:03, 18.68it/s] 93%|█████████▎| 915/983 [00:56<00:04, 15.44it/s] 93%|█████████▎| 917/983 [00:56<00:05, 12.68it/s] 93%|█████████▎| 919/983 [00:57<00:04, 13.18it/s] 94%|█████████▎| 921/983 [00:57<00:05, 11.95it/s] 94%|█████████▍| 924/983 [00:57<00:03, 14.82it/s] 94%|█████████▍| 927/983 [00:57<00:03, 17.38it/s] 95%|█████████▍| 930/983 [00:57<00:02, 19.45it/s] 95%|█████████▍| 933/983 [00:57<00:02, 21.05it/s] 95%|█████████▌| 936/983 [00:57<00:02, 22.36it/s] 96%|█████████▌| 939/983 [00:57<00:01, 23.30it/s] 96%|█████████▌| 942/983 [00:58<00:01, 21.25it/s] 96%|█████████▌| 945/983 [00:58<00:01, 19.80it/s] 96%|█████████▋| 948/983 [00:58<00:02, 15.22it/s] 97%|█████████▋| 950/983 [00:58<00:02, 11.75it/s] 97%|█████████▋| 952/983 [00:59<00:02, 11.28it/s] 97%|█████████▋| 954/983 [00:59<00:02, 10.87it/s] 97%|█████████▋| 957/983 [00:59<00:01, 13.43it/s] 98%|█████████▊| 960/983 [00:59<00:01, 16.03it/s] 98%|█████████▊| 963/983 [00:59<00:01, 17.68it/s] 98%|█████████▊| 966/983 [00:59<00:00, 18.87it/s] 99%|█████████▊| 969/983 [00:59<00:00, 20.73it/s] 99%|█████████▉| 972/983 [01:00<00:00, 22.41it/s] 99%|█████████▉| 975/983 [01:00<00:00, 23.74it/s] 99%|█████████▉| 978/983 [01:00<00:00, 24.89it/s]100%|█████████▉| 981/983 [01:00<00:00, 23.15it/s]100%|██████████| 983/983 [01:00<00:00, 16.23it/s]
time :  1340
prob :  1340
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_2_Focal_RS_DRW_seed_40
train data : 14418, disrupt : 227, non-disrupt : 14191
valid data : 3514, disrupt : 57, non-disrupt : 3457
test data : 4058, disrupt : 71, non-disrupt : 3987

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.069, valid loss : 0.034, train f1 : 0.863, valid f1 : 0.655
Best score increase :0.000 -> 0.655
training process - Deferred Re-weighting:   1%|          | 1/128 [09:53<20:56:51, 593.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 2/128 [19:01<19:50:03, 566.69s/it]Best score increase :0.655 -> 0.722
training process - Deferred Re-weighting:   2%|▏         | 3/128 [28:10<19:23:24, 558.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [37:33<19:18:07, 560.38s/it]epoch : 5, train loss : 0.026, valid loss : 0.022, train f1 : 0.951, valid f1 : 0.635
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [47:22<19:29:58, 570.72s/it]Best score increase :0.722 -> 0.796
training process - Deferred Re-weighting:   5%|▍         | 6/128 [56:30<19:05:02, 563.14s/it]Best score increase :0.796 -> 0.841
training process - Deferred Re-weighting:   5%|▌         | 7/128 [1:05:39<18:46:07, 558.41s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [1:14:47<18:29:59, 555.00s/it]epoch : 9, train loss : 0.021, valid loss : 0.025, train f1 : 0.958, valid f1 : 0.643
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [1:24:38<18:43:02, 566.24s/it]Best score increase :0.841 -> 0.857
training process - Deferred Re-weighting:   8%|▊         | 10/128 [1:33:48<18:24:10, 561.44s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [1:42:58<18:07:30, 557.69s/it]Best score increase :0.857 -> 0.905
training process - Deferred Re-weighting:   9%|▉         | 12/128 [1:52:11<17:55:47, 556.44s/it]epoch : 13, train loss : 0.020, valid loss : 0.031, train f1 : 0.964, valid f1 : 0.645
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [2:02:06<18:08:57, 568.15s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [2:11:13<17:46:53, 561.52s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [2:20:21<17:30:12, 557.64s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [2:29:28<17:14:51, 554.39s/it]epoch : 17, train loss : 0.018, valid loss : 0.047, train f1 : 0.967, valid f1 : 0.651
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [2:39:24<17:28:46, 566.91s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [2:48:35<17:10:38, 562.17s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [2:57:52<16:58:24, 560.59s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [3:06:59<16:41:41, 556.50s/it]epoch : 21, train loss : 0.018, valid loss : 0.016, train f1 : 0.967, valid f1 : 0.808
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [3:16:49<16:50:27, 566.61s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [3:25:58<16:31:18, 561.12s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [3:35:05<16:14:53, 557.08s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 23, best f1 score : 0.905
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [3:44:14<17:03:41, 584.97s/it]
training process finished, best loss : 0.012, best acc : 0.994, best f1 : 0.905, best epoch : 11

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.89      0.89      0.89        71
           1       1.00      1.00      1.00      3987

    accuracy                           1.00      4058
   macro avg       0.94      0.94      0.94      4058
weighted avg       1.00      1.00      1.00      4058


# test acc : 1.00, test f1 : 0.94, test AUC : 0.94, test loss : 0.363

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/982 [00:00<?, ?it/s]  0%|          | 2/982 [00:00<00:53, 18.41it/s]  0%|          | 4/982 [00:00<01:01, 15.94it/s]  1%|          | 6/982 [00:00<01:03, 15.44it/s]  1%|          | 8/982 [00:00<01:06, 14.55it/s]  1%|          | 10/982 [00:00<01:09, 14.03it/s]  1%|          | 12/982 [00:00<01:21, 11.91it/s]  1%|▏         | 14/982 [00:01<01:23, 11.64it/s]  2%|▏         | 16/982 [00:01<01:17, 12.48it/s]  2%|▏         | 19/982 [00:01<01:02, 15.40it/s]  2%|▏         | 22/982 [00:01<00:53, 17.86it/s]  3%|▎         | 25/982 [00:01<00:48, 19.76it/s]  3%|▎         | 28/982 [00:01<00:45, 20.99it/s]  3%|▎         | 31/982 [00:01<00:43, 21.77it/s]  3%|▎         | 34/982 [00:01<00:45, 21.03it/s]  4%|▍         | 37/982 [00:02<00:45, 20.65it/s]  4%|▍         | 40/982 [00:02<00:52, 18.09it/s]  4%|▍         | 42/982 [00:02<00:56, 16.63it/s]  4%|▍         | 44/982 [00:02<01:05, 14.35it/s]  5%|▍         | 46/982 [00:02<01:05, 14.24it/s]  5%|▍         | 48/982 [00:03<01:13, 12.76it/s]  5%|▌         | 50/982 [00:03<01:19, 11.73it/s]  5%|▌         | 53/982 [00:03<01:03, 14.56it/s]  6%|▌         | 56/982 [00:03<00:54, 16.96it/s]  6%|▌         | 59/982 [00:03<00:49, 18.80it/s]  6%|▋         | 62/982 [00:03<00:45, 20.30it/s]  7%|▋         | 65/982 [00:03<00:42, 21.43it/s]  7%|▋         | 68/982 [00:03<00:41, 22.17it/s]  7%|▋         | 71/982 [00:04<00:40, 22.72it/s]  8%|▊         | 74/982 [00:04<00:45, 19.90it/s]  8%|▊         | 77/982 [00:04<00:59, 15.27it/s]  8%|▊         | 79/982 [00:04<01:01, 14.63it/s]  8%|▊         | 81/982 [00:04<01:02, 14.43it/s]  8%|▊         | 83/982 [00:05<01:02, 14.27it/s]  9%|▊         | 85/982 [00:05<01:14, 12.05it/s]  9%|▉         | 88/982 [00:05<01:00, 14.77it/s]  9%|▉         | 91/982 [00:05<00:52, 17.01it/s] 10%|▉         | 94/982 [00:05<00:47, 18.76it/s] 10%|▉         | 97/982 [00:05<00:43, 20.13it/s] 10%|█         | 100/982 [00:05<00:48, 18.30it/s] 10%|█         | 103/982 [00:06<00:44, 19.63it/s] 11%|█         | 106/982 [00:06<00:43, 20.31it/s] 11%|█         | 109/982 [00:06<00:44, 19.58it/s] 11%|█▏        | 112/982 [00:06<00:56, 15.53it/s] 12%|█▏        | 115/982 [00:06<00:59, 14.57it/s] 12%|█▏        | 118/982 [00:07<00:54, 15.85it/s] 12%|█▏        | 120/982 [00:07<01:02, 13.75it/s] 12%|█▏        | 122/982 [00:07<01:00, 14.11it/s] 13%|█▎        | 125/982 [00:07<00:53, 16.13it/s] 13%|█▎        | 128/982 [00:07<00:47, 18.08it/s] 13%|█▎        | 131/982 [00:07<00:43, 19.55it/s] 14%|█▎        | 134/982 [00:07<00:40, 20.70it/s] 14%|█▍        | 137/982 [00:08<00:39, 21.62it/s] 14%|█▍        | 140/982 [00:08<00:38, 21.85it/s] 15%|█▍        | 143/982 [00:08<00:38, 21.59it/s] 15%|█▍        | 146/982 [00:08<00:48, 17.36it/s] 15%|█▌        | 148/982 [00:08<00:53, 15.67it/s] 15%|█▌        | 150/982 [00:08<00:56, 14.61it/s] 15%|█▌        | 152/982 [00:09<00:59, 14.00it/s] 16%|█▌        | 154/982 [00:09<01:01, 13.56it/s] 16%|█▌        | 156/982 [00:09<01:07, 12.33it/s] 16%|█▌        | 159/982 [00:09<00:55, 14.78it/s] 16%|█▋        | 162/982 [00:09<00:47, 17.13it/s] 17%|█▋        | 165/982 [00:09<00:43, 18.98it/s] 17%|█▋        | 168/982 [00:09<00:40, 20.16it/s] 17%|█▋        | 171/982 [00:10<00:38, 21.14it/s] 18%|█▊        | 174/982 [00:10<00:36, 21.86it/s] 18%|█▊        | 177/982 [00:10<00:36, 22.00it/s] 18%|█▊        | 180/982 [00:10<00:43, 18.59it/s] 19%|█▊        | 182/982 [00:10<00:46, 17.19it/s] 19%|█▊        | 184/982 [00:10<00:49, 16.19it/s] 19%|█▉        | 186/982 [00:11<00:51, 15.44it/s] 19%|█▉        | 188/982 [00:11<00:53, 14.79it/s] 19%|█▉        | 190/982 [00:11<00:54, 14.47it/s] 20%|█▉        | 192/982 [00:11<00:56, 14.05it/s] 20%|█▉        | 195/982 [00:11<00:48, 16.20it/s] 20%|██        | 198/982 [00:11<00:42, 18.28it/s] 20%|██        | 201/982 [00:11<00:42, 18.42it/s] 21%|██        | 204/982 [00:12<00:40, 19.08it/s] 21%|██        | 207/982 [00:12<00:38, 20.21it/s] 21%|██▏       | 210/982 [00:12<00:36, 21.15it/s] 22%|██▏       | 213/982 [00:12<00:43, 17.63it/s] 22%|██▏       | 215/982 [00:12<00:44, 17.24it/s] 22%|██▏       | 217/982 [00:12<00:47, 16.08it/s] 22%|██▏       | 219/982 [00:12<00:51, 14.85it/s] 23%|██▎       | 221/982 [00:13<00:49, 15.47it/s] 23%|██▎       | 223/982 [00:13<00:50, 15.10it/s] 23%|██▎       | 225/982 [00:13<00:53, 14.23it/s] 23%|██▎       | 227/982 [00:13<00:55, 13.50it/s] 23%|██▎       | 229/982 [00:13<00:50, 14.83it/s] 24%|██▎       | 231/982 [00:13<00:47, 15.94it/s] 24%|██▍       | 234/982 [00:13<00:41, 18.09it/s] 24%|██▍       | 237/982 [00:14<00:37, 19.69it/s] 24%|██▍       | 240/982 [00:14<00:35, 20.74it/s] 25%|██▍       | 243/982 [00:14<00:34, 21.49it/s] 25%|██▌       | 246/982 [00:14<00:33, 22.18it/s] 25%|██▌       | 249/982 [00:14<00:34, 21.23it/s] 26%|██▌       | 252/982 [00:14<00:49, 14.61it/s] 26%|██▌       | 254/982 [00:15<00:56, 12.96it/s] 26%|██▌       | 256/982 [00:15<01:03, 11.49it/s] 26%|██▋       | 258/982 [00:15<01:10, 10.22it/s] 26%|██▋       | 260/982 [00:15<01:01, 11.67it/s] 27%|██▋       | 262/982 [00:15<00:55, 12.87it/s] 27%|██▋       | 265/982 [00:15<00:46, 15.46it/s] 27%|██▋       | 268/982 [00:16<00:40, 17.54it/s] 28%|██▊       | 271/982 [00:16<00:37, 19.12it/s] 28%|██▊       | 274/982 [00:16<00:34, 20.36it/s] 28%|██▊       | 277/982 [00:16<00:33, 21.26it/s] 29%|██▊       | 280/982 [00:16<00:32, 21.59it/s] 29%|██▉       | 283/982 [00:16<00:41, 16.77it/s] 29%|██▉       | 285/982 [00:17<00:49, 14.17it/s] 29%|██▉       | 287/982 [00:17<00:47, 14.49it/s] 29%|██▉       | 289/982 [00:17<00:45, 15.33it/s] 30%|██▉       | 291/982 [00:17<00:49, 14.07it/s] 30%|██▉       | 293/982 [00:17<00:50, 13.62it/s] 30%|███       | 295/982 [00:17<00:47, 14.39it/s] 30%|███       | 298/982 [00:17<00:40, 16.88it/s] 31%|███       | 301/982 [00:18<00:36, 18.79it/s] 31%|███       | 304/982 [00:18<00:33, 20.18it/s] 31%|███▏      | 307/982 [00:18<00:31, 21.12it/s] 32%|███▏      | 310/982 [00:18<00:30, 21.82it/s] 32%|███▏      | 313/982 [00:18<00:29, 22.40it/s] 32%|███▏      | 316/982 [00:18<00:30, 21.94it/s] 32%|███▏      | 319/982 [00:18<00:36, 18.04it/s] 33%|███▎      | 321/982 [00:19<00:44, 15.01it/s] 33%|███▎      | 323/982 [00:19<00:52, 12.57it/s] 33%|███▎      | 325/982 [00:19<00:55, 11.94it/s] 33%|███▎      | 327/982 [00:19<01:00, 10.82it/s] 34%|███▎      | 329/982 [00:19<00:55, 11.86it/s] 34%|███▍      | 332/982 [00:20<00:44, 14.56it/s] 34%|███▍      | 335/982 [00:20<00:38, 16.73it/s] 34%|███▍      | 338/982 [00:20<00:34, 18.48it/s] 35%|███▍      | 341/982 [00:20<00:32, 19.94it/s] 35%|███▌      | 344/982 [00:20<00:34, 18.72it/s] 35%|███▌      | 347/982 [00:20<00:32, 19.54it/s] 36%|███▌      | 350/982 [00:20<00:33, 19.06it/s] 36%|███▌      | 352/982 [00:21<00:35, 17.72it/s] 36%|███▌      | 354/982 [00:21<00:38, 16.43it/s] 36%|███▋      | 356/982 [00:21<00:44, 14.12it/s] 36%|███▋      | 358/982 [00:21<00:52, 11.91it/s] 37%|███▋      | 360/982 [00:21<01:00, 10.26it/s] 37%|███▋      | 362/982 [00:22<00:52, 11.75it/s] 37%|███▋      | 365/982 [00:22<00:42, 14.57it/s] 37%|███▋      | 368/982 [00:22<00:36, 16.88it/s] 38%|███▊      | 371/982 [00:22<00:32, 18.65it/s] 38%|███▊      | 374/982 [00:22<00:30, 19.94it/s] 38%|███▊      | 377/982 [00:22<00:28, 20.89it/s] 39%|███▊      | 380/982 [00:22<00:30, 19.69it/s] 39%|███▉      | 383/982 [00:22<00:31, 18.82it/s] 39%|███▉      | 385/982 [00:23<00:33, 17.98it/s] 39%|███▉      | 387/982 [00:23<00:33, 17.53it/s] 40%|███▉      | 389/982 [00:23<00:35, 16.64it/s] 40%|███▉      | 391/982 [00:23<00:38, 15.45it/s] 40%|████      | 393/982 [00:23<00:38, 15.19it/s] 40%|████      | 395/982 [00:23<00:38, 15.16it/s] 40%|████      | 397/982 [00:23<00:43, 13.35it/s] 41%|████      | 399/982 [00:24<00:42, 13.88it/s] 41%|████      | 402/982 [00:24<00:35, 16.51it/s] 41%|████      | 405/982 [00:24<00:31, 18.55it/s] 42%|████▏     | 408/982 [00:24<00:28, 20.00it/s] 42%|████▏     | 411/982 [00:24<00:27, 21.03it/s] 42%|████▏     | 414/982 [00:24<00:26, 21.72it/s] 42%|████▏     | 417/982 [00:24<00:25, 22.41it/s] 43%|████▎     | 420/982 [00:25<00:24, 22.49it/s] 43%|████▎     | 423/982 [00:25<00:33, 16.56it/s] 43%|████▎     | 425/982 [00:25<00:35, 15.58it/s] 43%|████▎     | 427/982 [00:25<00:36, 15.12it/s] 44%|████▎     | 429/982 [00:25<00:38, 14.54it/s] 44%|████▍     | 431/982 [00:25<00:39, 13.95it/s] 44%|████▍     | 433/982 [00:26<00:44, 12.33it/s] 44%|████▍     | 436/982 [00:26<00:36, 14.99it/s] 45%|████▍     | 439/982 [00:26<00:31, 17.18it/s] 45%|████▌     | 442/982 [00:26<00:28, 18.83it/s] 45%|████▌     | 445/982 [00:26<00:26, 20.21it/s] 46%|████▌     | 448/982 [00:26<00:25, 21.20it/s] 46%|████▌     | 451/982 [00:26<00:24, 21.98it/s] 46%|████▌     | 454/982 [00:27<00:23, 22.49it/s] 47%|████▋     | 457/982 [00:27<00:27, 19.08it/s] 47%|████▋     | 460/982 [00:27<00:30, 16.92it/s] 47%|████▋     | 462/982 [00:27<00:32, 15.86it/s] 47%|████▋     | 464/982 [00:27<00:35, 14.61it/s] 47%|████▋     | 466/982 [00:27<00:35, 14.59it/s] 48%|████▊     | 468/982 [00:28<00:35, 14.34it/s] 48%|████▊     | 470/982 [00:28<00:38, 13.44it/s] 48%|████▊     | 473/982 [00:28<00:32, 15.84it/s] 48%|████▊     | 476/982 [00:28<00:27, 18.09it/s] 49%|████▉     | 479/982 [00:28<00:25, 19.86it/s] 49%|████▉     | 482/982 [00:28<00:23, 21.20it/s] 49%|████▉     | 485/982 [00:28<00:22, 22.24it/s] 50%|████▉     | 488/982 [00:28<00:21, 23.05it/s] 50%|█████     | 491/982 [00:29<00:20, 23.68it/s] 50%|█████     | 494/982 [00:29<00:23, 21.14it/s] 51%|█████     | 497/982 [00:29<00:26, 18.15it/s] 51%|█████     | 499/982 [00:29<00:28, 17.16it/s] 51%|█████     | 501/982 [00:29<00:30, 15.53it/s] 51%|█████     | 503/982 [00:30<00:40, 11.91it/s] 51%|█████▏    | 505/982 [00:30<00:42, 11.26it/s] 52%|█████▏    | 508/982 [00:30<00:33, 13.96it/s] 52%|█████▏    | 511/982 [00:30<00:28, 16.31it/s] 52%|█████▏    | 514/982 [00:30<00:25, 18.36it/s] 53%|█████▎    | 517/982 [00:30<00:23, 20.05it/s] 53%|█████▎    | 520/982 [00:30<00:21, 21.49it/s] 53%|█████▎    | 523/982 [00:31<00:20, 22.48it/s] 54%|█████▎    | 526/982 [00:31<00:19, 23.04it/s] 54%|█████▍    | 529/982 [00:31<00:22, 20.16it/s] 54%|█████▍    | 532/982 [00:31<00:27, 16.22it/s] 54%|█████▍    | 534/982 [00:31<00:32, 13.81it/s] 55%|█████▍    | 536/982 [00:31<00:31, 14.15it/s] 55%|█████▍    | 538/982 [00:32<00:32, 13.81it/s] 55%|█████▍    | 540/982 [00:32<00:33, 13.16it/s] 55%|█████▌    | 543/982 [00:32<00:27, 15.76it/s] 56%|█████▌    | 546/982 [00:32<00:24, 18.05it/s] 56%|█████▌    | 549/982 [00:32<00:21, 20.02it/s] 56%|█████▌    | 552/982 [00:32<00:19, 21.57it/s] 57%|█████▋    | 555/982 [00:32<00:18, 22.72it/s] 57%|█████▋    | 558/982 [00:32<00:18, 23.48it/s] 57%|█████▋    | 561/982 [00:33<00:17, 24.08it/s] 57%|█████▋    | 564/982 [00:33<00:17, 23.68it/s] 58%|█████▊    | 567/982 [00:33<00:20, 19.97it/s] 58%|█████▊    | 570/982 [00:33<00:28, 14.36it/s] 58%|█████▊    | 572/982 [00:33<00:30, 13.49it/s] 58%|█████▊    | 574/982 [00:34<00:31, 13.12it/s] 59%|█████▊    | 576/982 [00:34<00:32, 12.34it/s] 59%|█████▉    | 578/982 [00:34<00:32, 12.43it/s] 59%|█████▉    | 580/982 [00:34<00:29, 13.74it/s] 59%|█████▉    | 583/982 [00:34<00:24, 16.25it/s] 60%|█████▉    | 586/982 [00:34<00:21, 18.65it/s] 60%|█████▉    | 589/982 [00:34<00:19, 20.53it/s] 60%|██████    | 592/982 [00:35<00:17, 22.00it/s] 61%|██████    | 595/982 [00:35<00:16, 23.14it/s] 61%|██████    | 598/982 [00:35<00:15, 24.01it/s] 61%|██████    | 601/982 [00:35<00:19, 19.13it/s] 62%|██████▏   | 604/982 [00:35<00:23, 15.78it/s] 62%|██████▏   | 606/982 [00:35<00:27, 13.59it/s] 62%|██████▏   | 608/982 [00:36<00:30, 12.22it/s] 62%|██████▏   | 610/982 [00:36<00:32, 11.36it/s] 62%|██████▏   | 612/982 [00:36<00:29, 12.50it/s] 63%|██████▎   | 615/982 [00:36<00:23, 15.35it/s] 63%|██████▎   | 618/982 [00:36<00:20, 17.73it/s] 63%|██████▎   | 621/982 [00:36<00:18, 19.70it/s] 64%|██████▎   | 624/982 [00:37<00:16, 21.33it/s] 64%|██████▍   | 627/982 [00:37<00:15, 22.22it/s] 64%|██████▍   | 630/982 [00:37<00:15, 22.93it/s] 64%|██████▍   | 633/982 [00:37<00:14, 23.30it/s] 65%|██████▍   | 636/982 [00:37<00:17, 20.31it/s] 65%|██████▌   | 639/982 [00:37<00:22, 15.11it/s] 65%|██████▌   | 641/982 [00:38<00:24, 13.78it/s] 65%|██████▌   | 643/982 [00:38<00:26, 12.89it/s] 66%|██████▌   | 645/982 [00:38<00:29, 11.51it/s] 66%|██████▌   | 647/982 [00:38<00:26, 12.65it/s] 66%|██████▌   | 650/982 [00:38<00:21, 15.40it/s] 66%|██████▋   | 653/982 [00:38<00:18, 17.67it/s] 67%|██████▋   | 656/982 [00:38<00:16, 19.49it/s] 67%|██████▋   | 659/982 [00:39<00:15, 20.85it/s] 67%|██████▋   | 662/982 [00:39<00:14, 21.73it/s] 68%|██████▊   | 665/982 [00:39<00:14, 22.38it/s] 68%|██████▊   | 668/982 [00:39<00:14, 22.13it/s] 68%|██████▊   | 671/982 [00:39<00:16, 18.83it/s] 69%|██████▊   | 674/982 [00:39<00:17, 17.28it/s] 69%|██████▉   | 676/982 [00:40<00:18, 16.68it/s] 69%|██████▉   | 678/982 [00:40<00:20, 14.58it/s] 69%|██████▉   | 680/982 [00:40<00:20, 14.44it/s] 69%|██████▉   | 682/982 [00:40<00:21, 13.71it/s] 70%|██████▉   | 684/982 [00:40<00:21, 13.94it/s] 70%|██████▉   | 687/982 [00:40<00:17, 16.59it/s] 70%|███████   | 690/982 [00:40<00:15, 18.63it/s] 71%|███████   | 693/982 [00:41<00:14, 20.15it/s] 71%|███████   | 696/982 [00:41<00:13, 21.27it/s] 71%|███████   | 699/982 [00:41<00:12, 22.33it/s] 71%|███████▏  | 702/982 [00:41<00:12, 23.08it/s] 72%|███████▏  | 705/982 [00:41<00:12, 22.97it/s] 72%|███████▏  | 708/982 [00:41<00:12, 21.76it/s] 72%|███████▏  | 711/982 [00:41<00:14, 19.16it/s] 73%|███████▎  | 713/982 [00:42<00:14, 18.18it/s] 73%|███████▎  | 715/982 [00:42<00:15, 16.80it/s] 73%|███████▎  | 717/982 [00:42<00:17, 15.15it/s] 73%|███████▎  | 719/982 [00:42<00:18, 14.57it/s] 73%|███████▎  | 721/982 [00:42<00:18, 13.91it/s] 74%|███████▎  | 723/982 [00:42<00:17, 15.17it/s] 74%|███████▍  | 726/982 [00:42<00:14, 17.50it/s] 74%|███████▍  | 729/982 [00:43<00:13, 19.38it/s] 75%|███████▍  | 732/982 [00:43<00:12, 20.73it/s] 75%|███████▍  | 735/982 [00:43<00:11, 21.78it/s] 75%|███████▌  | 738/982 [00:43<00:10, 22.65it/s] 75%|███████▌  | 741/982 [00:43<00:10, 23.40it/s] 76%|███████▌  | 744/982 [00:43<00:10, 23.05it/s] 76%|███████▌  | 747/982 [00:43<00:11, 19.95it/s] 76%|███████▋  | 750/982 [00:44<00:13, 16.64it/s] 77%|███████▋  | 752/982 [00:44<00:14, 16.12it/s] 77%|███████▋  | 754/982 [00:44<00:14, 16.28it/s] 77%|███████▋  | 756/982 [00:44<00:13, 16.58it/s] 77%|███████▋  | 758/982 [00:44<00:17, 12.75it/s] 77%|███████▋  | 761/982 [00:44<00:14, 14.82it/s] 78%|███████▊  | 764/982 [00:44<00:12, 16.99it/s] 78%|███████▊  | 767/982 [00:45<00:11, 18.74it/s] 78%|███████▊  | 770/982 [00:45<00:10, 20.06it/s] 79%|███████▊  | 773/982 [00:45<00:10, 19.67it/s] 79%|███████▉  | 776/982 [00:45<00:10, 20.08it/s] 79%|███████▉  | 779/982 [00:45<00:09, 20.97it/s] 80%|███████▉  | 782/982 [00:45<00:11, 17.75it/s] 80%|███████▉  | 784/982 [00:46<00:11, 16.61it/s] 80%|████████  | 786/982 [00:46<00:11, 16.80it/s] 80%|████████  | 788/982 [00:46<00:12, 16.13it/s] 80%|████████  | 790/982 [00:46<00:11, 16.03it/s] 81%|████████  | 792/982 [00:46<00:12, 15.42it/s] 81%|████████  | 794/982 [00:46<00:12, 14.79it/s] 81%|████████  | 796/982 [00:46<00:12, 14.78it/s] 81%|████████▏ | 798/982 [00:46<00:11, 15.68it/s] 82%|████████▏ | 801/982 [00:47<00:09, 18.43it/s] 82%|████████▏ | 804/982 [00:47<00:08, 20.64it/s] 82%|████████▏ | 807/982 [00:47<00:07, 22.28it/s] 82%|████████▏ | 810/982 [00:47<00:07, 23.44it/s] 83%|████████▎ | 813/982 [00:47<00:07, 23.99it/s] 83%|████████▎ | 816/982 [00:47<00:06, 24.58it/s] 83%|████████▎ | 819/982 [00:47<00:06, 25.06it/s] 84%|████████▎ | 822/982 [00:47<00:07, 22.48it/s] 84%|████████▍ | 825/982 [00:48<00:07, 20.87it/s] 84%|████████▍ | 828/982 [00:48<00:07, 19.51it/s] 85%|████████▍ | 831/982 [00:48<00:08, 17.92it/s] 85%|████████▍ | 833/982 [00:48<00:08, 16.77it/s] 85%|████████▌ | 835/982 [00:48<00:09, 15.12it/s] 85%|████████▌ | 837/982 [00:48<00:10, 13.40it/s] 86%|████████▌ | 840/982 [00:49<00:08, 16.26it/s] 86%|████████▌ | 843/982 [00:49<00:07, 17.57it/s] 86%|████████▌ | 846/982 [00:49<00:06, 19.81it/s] 86%|████████▋ | 849/982 [00:49<00:06, 21.67it/s] 87%|████████▋ | 852/982 [00:49<00:05, 23.09it/s] 87%|████████▋ | 855/982 [00:49<00:05, 24.23it/s] 87%|████████▋ | 858/982 [00:49<00:04, 25.13it/s] 88%|████████▊ | 861/982 [00:49<00:05, 24.19it/s] 88%|████████▊ | 864/982 [00:50<00:04, 23.62it/s] 88%|████████▊ | 867/982 [00:50<00:06, 18.19it/s] 89%|████████▊ | 870/982 [00:50<00:06, 16.29it/s] 89%|████████▉ | 872/982 [00:50<00:07, 13.98it/s] 89%|████████▉ | 874/982 [00:50<00:08, 13.12it/s] 89%|████████▉ | 876/982 [00:51<00:07, 13.81it/s] 90%|████████▉ | 879/982 [00:51<00:06, 16.32it/s] 90%|████████▉ | 882/982 [00:51<00:05, 18.82it/s] 90%|█████████ | 885/982 [00:51<00:04, 20.86it/s] 90%|█████████ | 888/982 [00:51<00:04, 22.43it/s] 91%|█████████ | 891/982 [00:51<00:03, 23.65it/s] 91%|█████████ | 894/982 [00:51<00:03, 24.53it/s] 91%|█████████▏| 897/982 [00:51<00:03, 25.23it/s] 92%|█████████▏| 900/982 [00:51<00:03, 23.78it/s] 92%|█████████▏| 903/982 [00:52<00:04, 19.10it/s] 92%|█████████▏| 906/982 [00:52<00:05, 13.32it/s] 92%|█████████▏| 908/982 [00:52<00:06, 10.83it/s] 93%|█████████▎| 910/982 [00:53<00:06, 10.86it/s] 93%|█████████▎| 913/982 [00:53<00:05, 13.66it/s] 93%|█████████▎| 916/982 [00:53<00:04, 16.29it/s] 94%|█████████▎| 919/982 [00:53<00:03, 18.69it/s] 94%|█████████▍| 922/982 [00:53<00:02, 20.62it/s] 94%|█████████▍| 925/982 [00:53<00:02, 22.12it/s] 95%|█████████▍| 928/982 [00:53<00:02, 23.26it/s] 95%|█████████▍| 931/982 [00:53<00:02, 24.15it/s] 95%|█████████▌| 934/982 [00:54<00:02, 22.90it/s] 95%|█████████▌| 937/982 [00:54<00:02, 21.05it/s] 96%|█████████▌| 940/982 [00:54<00:02, 16.09it/s] 96%|█████████▌| 942/982 [00:54<00:02, 15.81it/s] 96%|█████████▌| 944/982 [00:54<00:02, 13.96it/s] 96%|█████████▋| 946/982 [00:54<00:02, 14.60it/s] 97%|█████████▋| 948/982 [00:55<00:02, 14.11it/s] 97%|█████████▋| 950/982 [00:55<00:02, 14.48it/s] 97%|█████████▋| 952/982 [00:55<00:01, 15.65it/s] 97%|█████████▋| 954/982 [00:55<00:01, 16.28it/s] 97%|█████████▋| 956/982 [00:55<00:01, 16.62it/s] 98%|█████████▊| 959/982 [00:55<00:01, 18.54it/s] 98%|█████████▊| 962/982 [00:55<00:00, 20.80it/s] 98%|█████████▊| 965/982 [00:55<00:00, 22.50it/s] 99%|█████████▊| 968/982 [00:56<00:00, 23.68it/s] 99%|█████████▉| 971/982 [00:56<00:00, 23.62it/s] 99%|█████████▉| 974/982 [00:56<00:00, 17.75it/s] 99%|█████████▉| 977/982 [00:56<00:00, 15.47it/s]100%|█████████▉| 979/982 [00:56<00:00, 13.21it/s]100%|█████████▉| 981/982 [00:57<00:00, 13.53it/s]100%|██████████| 982/982 [00:57<00:00, 17.21it/s]
time :  1339
prob :  1339
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_3_Focal_RS_DRW_seed_40
train data : 14410, disrupt : 227, non-disrupt : 14183
valid data : 3512, disrupt : 57, non-disrupt : 3455
test data : 4053, disrupt : 71, non-disrupt : 3982

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.085, valid loss : 0.039, train f1 : 0.833, valid f1 : 0.642
Best score increase :0.000 -> 0.642
training process - Deferred Re-weighting:   1%|          | 1/128 [10:12<21:36:52, 612.70s/it]Best score increase :0.642 -> 0.653
training process - Deferred Re-weighting:   2%|▏         | 2/128 [19:20<20:06:22, 574.47s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [28:27<19:30:39, 561.92s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [37:37<19:11:47, 557.32s/it]epoch : 5, train loss : 0.034, valid loss : 0.029, train f1 : 0.945, valid f1 : 0.608
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [47:32<19:29:53, 570.68s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [56:45<19:08:20, 564.76s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [1:05:52<18:47:26, 559.06s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [1:14:59<18:30:15, 555.13s/it]epoch : 9, train loss : 0.031, valid loss : 0.039, train f1 : 0.950, valid f1 : 0.598
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [1:24:46<18:40:59, 565.20s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [1:33:53<18:20:13, 559.43s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [1:43:01<18:04:31, 556.16s/it]Best score increase :0.653 -> 0.835
training process - Deferred Re-weighting:   9%|▉         | 12/128 [1:52:10<17:50:42, 553.82s/it]epoch : 13, train loss : 0.026, valid loss : 0.026, train f1 : 0.950, valid f1 : 0.668
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [2:01:59<18:02:11, 564.62s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [2:11:05<17:42:05, 558.99s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [2:20:12<17:25:54, 555.35s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [2:29:20<17:12:13, 552.98s/it]epoch : 17, train loss : 0.026, valid loss : 0.027, train f1 : 0.952, valid f1 : 0.625
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [2:39:07<17:22:15, 563.39s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [2:48:13<17:02:59, 558.00s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [2:57:19<16:47:30, 554.59s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [3:06:45<16:43:56, 557.74s/it]epoch : 21, train loss : 0.025, valid loss : 0.017, train f1 : 0.956, valid f1 : 0.872
Best score increase :0.835 -> 0.872
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [3:16:41<16:55:07, 569.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [3:25:54<16:37:22, 564.55s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [3:35:04<16:20:27, 560.26s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [3:44:14<16:05:38, 557.10s/it]epoch : 25, train loss : 0.021, valid loss : 0.023, train f1 : 0.961, valid f1 : 0.707
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [3:54:10<16:16:12, 568.66s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [4:03:17<15:55:47, 562.23s/it]Best score increase :0.872 -> 0.876
training process - Deferred Re-weighting:  21%|██        | 27/128 [4:12:24<15:38:48, 557.71s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [4:21:31<15:23:51, 554.31s/it]epoch : 29, train loss : 0.023, valid loss : 0.026, train f1 : 0.959, valid f1 : 0.788
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [4:31:23<15:33:39, 565.85s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [4:40:31<15:15:24, 560.45s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [4:49:39<14:59:58, 556.69s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [4:58:46<14:45:55, 553.71s/it]epoch : 33, train loss : 0.022, valid loss : 0.037, train f1 : 0.962, valid f1 : 0.620
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [5:08:42<14:56:55, 566.48s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [5:17:50<14:38:56, 561.02s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [5:26:59<14:23:56, 557.38s/it]Best score increase :0.876 -> 0.919
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [5:36:07<14:10:05, 554.41s/it]epoch : 37, train loss : 0.022, valid loss : 0.021, train f1 : 0.960, valid f1 : 0.686
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [5:46:01<14:18:53, 566.30s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [5:55:11<14:02:10, 561.45s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [6:06:44<14:51:12, 600.81s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [6:18:32<15:28:27, 633.04s/it]epoch : 41, train loss : 0.020, valid loss : 0.026, train f1 : 0.965, valid f1 : 0.701
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [6:28:22<14:59:25, 620.30s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [6:39:40<15:13:53, 637.60s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [6:51:33<15:35:07, 660.09s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [7:00:41<14:37:11, 626.56s/it]epoch : 45, train loss : 0.019, valid loss : 0.018, train f1 : 0.967, valid f1 : 0.835
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [7:14:05<15:40:07, 679.61s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  36%|███▌      | 46/128 [7:25:06<15:21:09, 674.02s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [7:34:38<14:28:34, 643.39s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 47, best f1 score : 0.919
training process - Deferred Re-weighting:  37%|███▋      | 47/128 [7:43:47<13:19:18, 592.08s/it]
training process finished, best loss : 0.010, best acc : 0.995, best f1 : 0.919, best epoch : 35

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.92      0.85      0.88        71
           1       1.00      1.00      1.00      3982

    accuracy                           1.00      4053
   macro avg       0.96      0.92      0.94      4053
weighted avg       1.00      1.00      1.00      4053


# test acc : 1.00, test f1 : 0.94, test AUC : 0.92, test loss : 0.283

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:58, 16.74it/s]  0%|          | 4/981 [00:00<01:06, 14.71it/s]  1%|          | 6/981 [00:00<01:28, 11.04it/s]  1%|          | 8/981 [00:00<01:53,  8.58it/s]  1%|          | 9/981 [00:00<01:52,  8.66it/s]  1%|          | 11/981 [00:01<01:47,  8.98it/s]  1%|▏         | 13/981 [00:01<01:30, 10.66it/s]  2%|▏         | 16/981 [00:01<01:10, 13.63it/s]  2%|▏         | 19/981 [00:01<00:59, 16.14it/s]  2%|▏         | 21/981 [00:01<00:59, 16.11it/s]  2%|▏         | 24/981 [00:01<00:52, 18.07it/s]  3%|▎         | 27/981 [00:01<00:48, 19.86it/s]  3%|▎         | 30/981 [00:02<00:44, 21.23it/s]  3%|▎         | 33/981 [00:02<00:50, 18.73it/s]  4%|▎         | 35/981 [00:02<00:56, 16.64it/s]  4%|▍         | 37/981 [00:02<01:02, 15.10it/s]  4%|▍         | 39/981 [00:02<01:09, 13.52it/s]  4%|▍         | 41/981 [00:02<01:10, 13.26it/s]  4%|▍         | 43/981 [00:03<01:07, 13.84it/s]  5%|▍         | 45/981 [00:03<01:16, 12.25it/s]  5%|▍         | 47/981 [00:03<01:12, 12.86it/s]  5%|▌         | 50/981 [00:03<01:00, 15.37it/s]  5%|▌         | 53/981 [00:03<00:52, 17.68it/s]  6%|▌         | 56/981 [00:03<00:47, 19.53it/s]  6%|▌         | 59/981 [00:03<00:43, 20.96it/s]  6%|▋         | 62/981 [00:04<00:41, 21.91it/s]  7%|▋         | 65/981 [00:04<00:40, 22.61it/s]  7%|▋         | 68/981 [00:04<00:40, 22.31it/s]  7%|▋         | 71/981 [00:04<00:47, 19.16it/s]  8%|▊         | 74/981 [00:04<00:53, 16.93it/s]  8%|▊         | 76/981 [00:04<00:55, 16.30it/s]  8%|▊         | 78/981 [00:05<01:00, 14.88it/s]  8%|▊         | 80/981 [00:05<01:09, 12.88it/s]  8%|▊         | 82/981 [00:05<01:14, 12.06it/s]  9%|▊         | 84/981 [00:05<01:06, 13.40it/s]  9%|▉         | 87/981 [00:05<00:56, 15.94it/s]  9%|▉         | 90/981 [00:05<00:49, 17.88it/s]  9%|▉         | 93/981 [00:05<00:46, 19.06it/s] 10%|▉         | 96/981 [00:06<00:44, 20.08it/s] 10%|█         | 99/981 [00:06<00:42, 20.88it/s] 10%|█         | 102/981 [00:06<00:45, 19.28it/s] 11%|█         | 104/981 [00:06<00:49, 17.77it/s] 11%|█         | 106/981 [00:06<00:57, 15.14it/s] 11%|█         | 108/981 [00:06<00:58, 14.85it/s] 11%|█         | 110/981 [00:06<01:00, 14.44it/s] 11%|█▏        | 112/981 [00:07<01:01, 14.15it/s] 12%|█▏        | 114/981 [00:07<01:01, 14.05it/s] 12%|█▏        | 116/981 [00:07<01:04, 13.40it/s] 12%|█▏        | 119/981 [00:07<00:54, 15.79it/s] 12%|█▏        | 122/981 [00:07<00:47, 17.97it/s] 13%|█▎        | 125/981 [00:07<00:43, 19.54it/s] 13%|█▎        | 128/981 [00:07<00:40, 20.86it/s] 13%|█▎        | 131/981 [00:08<00:39, 21.53it/s] 14%|█▎        | 134/981 [00:08<00:37, 22.35it/s] 14%|█▍        | 137/981 [00:08<00:42, 19.90it/s] 14%|█▍        | 140/981 [00:08<00:52, 15.96it/s] 14%|█▍        | 142/981 [00:08<01:04, 12.95it/s] 15%|█▍        | 144/981 [00:09<01:10, 11.90it/s] 15%|█▍        | 146/981 [00:09<01:17, 10.71it/s] 15%|█▌        | 148/981 [00:09<01:16, 10.82it/s] 15%|█▌        | 151/981 [00:09<01:02, 13.36it/s] 16%|█▌        | 154/981 [00:09<00:52, 15.63it/s] 16%|█▌        | 157/981 [00:09<00:47, 17.48it/s] 16%|█▋        | 160/981 [00:10<00:43, 18.88it/s] 17%|█▋        | 163/981 [00:10<00:41, 19.95it/s] 17%|█▋        | 166/981 [00:10<00:39, 20.66it/s] 17%|█▋        | 169/981 [00:10<00:38, 20.90it/s] 18%|█▊        | 172/981 [00:10<00:48, 16.70it/s] 18%|█▊        | 174/981 [00:10<00:54, 14.70it/s] 18%|█▊        | 176/981 [00:11<01:00, 13.31it/s] 18%|█▊        | 178/981 [00:11<01:03, 12.68it/s] 18%|█▊        | 180/981 [00:11<01:02, 12.79it/s] 19%|█▊        | 182/981 [00:11<01:08, 11.71it/s] 19%|█▉        | 185/981 [00:11<00:54, 14.56it/s] 19%|█▉        | 188/981 [00:11<00:46, 17.03it/s] 19%|█▉        | 191/981 [00:12<00:41, 19.10it/s] 20%|█▉        | 194/981 [00:12<00:37, 20.74it/s] 20%|██        | 197/981 [00:12<00:35, 21.80it/s] 20%|██        | 200/981 [00:12<00:34, 22.61it/s] 21%|██        | 203/981 [00:12<00:33, 23.16it/s] 21%|██        | 206/981 [00:12<00:34, 22.25it/s] 21%|██▏       | 209/981 [00:12<00:42, 17.98it/s] 22%|██▏       | 211/981 [00:13<00:51, 15.04it/s] 22%|██▏       | 213/981 [00:13<00:56, 13.53it/s] 22%|██▏       | 215/981 [00:13<00:58, 13.20it/s] 22%|██▏       | 217/981 [00:13<01:03, 12.07it/s] 22%|██▏       | 219/981 [00:13<00:59, 12.88it/s] 23%|██▎       | 222/981 [00:13<00:49, 15.35it/s] 23%|██▎       | 225/981 [00:14<00:43, 17.47it/s] 23%|██▎       | 228/981 [00:14<00:39, 19.16it/s] 24%|██▎       | 231/981 [00:14<00:36, 20.43it/s] 24%|██▍       | 234/981 [00:14<00:34, 21.41it/s] 24%|██▍       | 237/981 [00:14<00:33, 22.13it/s] 24%|██▍       | 240/981 [00:14<00:33, 21.88it/s] 25%|██▍       | 243/981 [00:14<00:38, 18.98it/s] 25%|██▍       | 245/981 [00:15<00:42, 17.22it/s] 25%|██▌       | 247/981 [00:15<00:45, 15.96it/s] 25%|██▌       | 249/981 [00:15<00:51, 14.34it/s] 26%|██▌       | 251/981 [00:15<00:52, 14.03it/s] 26%|██▌       | 253/981 [00:15<00:51, 14.03it/s] 26%|██▌       | 255/981 [00:15<00:53, 13.64it/s] 26%|██▋       | 258/981 [00:15<00:45, 15.93it/s] 27%|██▋       | 261/981 [00:16<00:40, 17.79it/s] 27%|██▋       | 264/981 [00:16<00:37, 19.29it/s] 27%|██▋       | 267/981 [00:16<00:34, 20.60it/s] 28%|██▊       | 270/981 [00:16<00:33, 21.52it/s] 28%|██▊       | 273/981 [00:16<00:31, 22.21it/s] 28%|██▊       | 276/981 [00:16<00:31, 22.69it/s] 28%|██▊       | 279/981 [00:16<00:35, 19.68it/s] 29%|██▊       | 282/981 [00:17<00:40, 17.46it/s] 29%|██▉       | 284/981 [00:17<00:42, 16.56it/s] 29%|██▉       | 286/981 [00:17<00:43, 16.14it/s] 29%|██▉       | 288/981 [00:17<00:44, 15.56it/s] 30%|██▉       | 290/981 [00:17<00:46, 14.85it/s] 30%|██▉       | 292/981 [00:17<00:48, 14.31it/s] 30%|██▉       | 294/981 [00:18<00:46, 14.80it/s] 30%|███       | 297/981 [00:18<00:39, 17.20it/s] 31%|███       | 300/981 [00:18<00:35, 19.13it/s] 31%|███       | 303/981 [00:18<00:33, 20.54it/s] 31%|███       | 306/981 [00:18<00:31, 21.57it/s] 31%|███▏      | 309/981 [00:18<00:30, 22.20it/s] 32%|███▏      | 312/981 [00:18<00:29, 22.50it/s] 32%|███▏      | 315/981 [00:18<00:29, 22.49it/s] 32%|███▏      | 318/981 [00:19<00:35, 18.93it/s] 33%|███▎      | 320/981 [00:19<00:37, 17.79it/s] 33%|███▎      | 322/981 [00:19<00:39, 16.65it/s] 33%|███▎      | 324/981 [00:19<00:46, 14.05it/s] 33%|███▎      | 326/981 [00:19<00:54, 12.05it/s] 33%|███▎      | 328/981 [00:20<01:00, 10.72it/s] 34%|███▎      | 330/981 [00:20<00:54, 11.86it/s] 34%|███▍      | 333/981 [00:20<00:45, 14.39it/s] 34%|███▍      | 336/981 [00:20<00:39, 16.51it/s] 35%|███▍      | 339/981 [00:20<00:35, 18.29it/s] 35%|███▍      | 342/981 [00:20<00:32, 19.78it/s] 35%|███▌      | 345/981 [00:20<00:30, 20.89it/s] 35%|███▌      | 348/981 [00:20<00:29, 21.56it/s] 36%|███▌      | 351/981 [00:21<00:29, 21.05it/s] 36%|███▌      | 354/981 [00:21<00:33, 18.49it/s] 36%|███▋      | 356/981 [00:21<00:40, 15.62it/s] 36%|███▋      | 358/981 [00:21<00:49, 12.56it/s] 37%|███▋      | 360/981 [00:22<01:01, 10.03it/s] 37%|███▋      | 363/981 [00:22<00:51, 12.03it/s] 37%|███▋      | 366/981 [00:22<00:43, 14.27it/s] 38%|███▊      | 369/981 [00:22<00:37, 16.40it/s] 38%|███▊      | 372/981 [00:22<00:33, 18.00it/s] 38%|███▊      | 375/981 [00:22<00:31, 19.42it/s] 39%|███▊      | 378/981 [00:22<00:29, 20.59it/s] 39%|███▉      | 381/981 [00:23<00:28, 21.28it/s] 39%|███▉      | 384/981 [00:23<00:31, 19.08it/s] 39%|███▉      | 387/981 [00:23<00:34, 17.08it/s] 40%|███▉      | 389/981 [00:23<00:42, 13.99it/s] 40%|███▉      | 391/981 [00:23<00:46, 12.62it/s] 40%|████      | 393/981 [00:24<00:52, 11.29it/s] 40%|████      | 395/981 [00:24<00:48, 12.06it/s] 41%|████      | 398/981 [00:24<00:40, 14.39it/s] 41%|████      | 401/981 [00:24<00:34, 16.68it/s] 41%|████      | 404/981 [00:24<00:31, 18.60it/s] 41%|████▏     | 407/981 [00:24<00:28, 19.85it/s] 42%|████▏     | 410/981 [00:24<00:27, 20.99it/s] 42%|████▏     | 413/981 [00:25<00:25, 21.96it/s] 42%|████▏     | 416/981 [00:25<00:26, 21.05it/s] 43%|████▎     | 419/981 [00:25<00:34, 16.16it/s] 43%|████▎     | 421/981 [00:25<00:36, 15.26it/s] 43%|████▎     | 423/981 [00:25<00:37, 14.84it/s] 43%|████▎     | 425/981 [00:25<00:42, 13.23it/s] 44%|████▎     | 427/981 [00:26<00:47, 11.60it/s] 44%|████▎     | 429/981 [00:26<00:44, 12.37it/s] 44%|████▍     | 432/981 [00:26<00:37, 14.74it/s] 44%|████▍     | 435/981 [00:26<00:32, 16.98it/s] 45%|████▍     | 438/981 [00:26<00:28, 18.78it/s] 45%|████▍     | 441/981 [00:26<00:26, 20.19it/s] 45%|████▌     | 444/981 [00:26<00:25, 21.36it/s] 46%|████▌     | 447/981 [00:27<00:24, 22.04it/s] 46%|████▌     | 450/981 [00:27<00:24, 21.59it/s] 46%|████▌     | 453/981 [00:27<00:28, 18.65it/s] 46%|████▋     | 455/981 [00:27<00:33, 15.53it/s] 47%|████▋     | 457/981 [00:27<00:40, 13.07it/s] 47%|████▋     | 459/981 [00:28<00:43, 12.00it/s] 47%|████▋     | 461/981 [00:28<00:46, 11.22it/s] 47%|████▋     | 463/981 [00:28<00:41, 12.49it/s] 48%|████▊     | 466/981 [00:28<00:34, 14.72it/s] 48%|████▊     | 469/981 [00:28<00:30, 17.05it/s] 48%|████▊     | 472/981 [00:28<00:26, 19.08it/s] 48%|████▊     | 475/981 [00:28<00:24, 20.69it/s] 49%|████▊     | 478/981 [00:29<00:23, 21.79it/s] 49%|████▉     | 481/981 [00:29<00:22, 22.59it/s] 49%|████▉     | 484/981 [00:29<00:21, 22.68it/s] 50%|████▉     | 487/981 [00:29<00:24, 20.39it/s] 50%|████▉     | 490/981 [00:29<00:36, 13.63it/s] 50%|█████     | 492/981 [00:30<00:40, 12.02it/s] 50%|█████     | 494/981 [00:30<00:50,  9.58it/s] 51%|█████     | 496/981 [00:30<00:45, 10.64it/s] 51%|█████     | 498/981 [00:30<00:40, 11.87it/s] 51%|█████     | 500/981 [00:30<00:40, 11.82it/s] 51%|█████     | 502/981 [00:31<00:48,  9.90it/s] 51%|█████▏    | 504/981 [00:31<00:51,  9.20it/s] 52%|█████▏    | 506/981 [00:31<00:50,  9.47it/s] 52%|█████▏    | 509/981 [00:31<00:39, 12.04it/s] 52%|█████▏    | 512/981 [00:31<00:32, 14.55it/s] 52%|█████▏    | 515/981 [00:31<00:27, 16.68it/s] 53%|█████▎    | 518/981 [00:32<00:25, 18.38it/s] 53%|█████▎    | 521/981 [00:32<00:23, 19.99it/s] 53%|█████▎    | 524/981 [00:32<00:21, 21.30it/s] 54%|█████▎    | 527/981 [00:32<00:20, 22.25it/s] 54%|█████▍    | 530/981 [00:32<00:21, 20.96it/s] 54%|█████▍    | 533/981 [00:32<00:23, 18.67it/s] 55%|█████▍    | 535/981 [00:32<00:25, 17.82it/s] 55%|█████▍    | 537/981 [00:33<00:26, 16.59it/s] 55%|█████▍    | 539/981 [00:33<00:27, 16.28it/s] 55%|█████▌    | 541/981 [00:33<00:27, 15.75it/s] 55%|█████▌    | 543/981 [00:33<00:28, 15.29it/s] 56%|█████▌    | 545/981 [00:33<00:29, 14.56it/s] 56%|█████▌    | 548/981 [00:33<00:25, 16.76it/s] 56%|█████▌    | 551/981 [00:33<00:22, 18.95it/s] 56%|█████▋    | 554/981 [00:34<00:20, 20.68it/s] 57%|█████▋    | 557/981 [00:34<00:19, 22.05it/s] 57%|█████▋    | 560/981 [00:34<00:18, 23.06it/s] 57%|█████▋    | 563/981 [00:34<00:18, 22.99it/s] 58%|█████▊    | 566/981 [00:34<00:18, 22.96it/s] 58%|█████▊    | 569/981 [00:34<00:21, 19.00it/s] 58%|█████▊    | 572/981 [00:35<00:26, 15.45it/s] 59%|█████▊    | 574/981 [00:35<00:29, 13.61it/s] 59%|█████▊    | 576/981 [00:35<00:32, 12.51it/s] 59%|█████▉    | 578/981 [00:35<00:35, 11.36it/s] 59%|█████▉    | 581/981 [00:35<00:29, 13.54it/s] 60%|█████▉    | 584/981 [00:35<00:25, 15.82it/s] 60%|█████▉    | 587/981 [00:36<00:23, 16.88it/s] 60%|██████    | 589/981 [00:36<00:23, 17.03it/s] 60%|██████    | 592/981 [00:36<00:20, 18.56it/s] 61%|██████    | 595/981 [00:36<00:19, 19.93it/s] 61%|██████    | 598/981 [00:36<00:18, 21.25it/s] 61%|██████▏   | 601/981 [00:36<00:19, 19.35it/s] 62%|██████▏   | 604/981 [00:37<00:23, 16.28it/s] 62%|██████▏   | 606/981 [00:37<00:25, 14.67it/s] 62%|██████▏   | 608/981 [00:37<00:28, 13.29it/s] 62%|██████▏   | 610/981 [00:37<00:28, 12.96it/s] 62%|██████▏   | 612/981 [00:37<00:28, 12.79it/s] 63%|██████▎   | 615/981 [00:37<00:24, 14.66it/s] 63%|██████▎   | 618/981 [00:38<00:21, 16.93it/s] 63%|██████▎   | 621/981 [00:38<00:19, 18.78it/s] 64%|██████▎   | 624/981 [00:38<00:17, 20.25it/s] 64%|██████▍   | 627/981 [00:38<00:16, 21.37it/s] 64%|██████▍   | 630/981 [00:38<00:15, 22.37it/s] 65%|██████▍   | 633/981 [00:38<00:15, 23.20it/s] 65%|██████▍   | 636/981 [00:38<00:16, 20.83it/s] 65%|██████▌   | 639/981 [00:39<00:18, 18.40it/s] 65%|██████▌   | 641/981 [00:39<00:19, 17.50it/s] 66%|██████▌   | 643/981 [00:39<00:20, 16.37it/s] 66%|██████▌   | 645/981 [00:39<00:25, 13.24it/s] 66%|██████▌   | 647/981 [00:39<00:31, 10.53it/s] 66%|██████▌   | 649/981 [00:39<00:28, 11.69it/s] 66%|██████▋   | 651/981 [00:40<00:28, 11.48it/s] 67%|██████▋   | 653/981 [00:40<00:35,  9.31it/s] 67%|██████▋   | 655/981 [00:40<00:29, 10.96it/s] 67%|██████▋   | 657/981 [00:40<00:26, 12.13it/s] 67%|██████▋   | 659/981 [00:40<00:24, 13.23it/s] 67%|██████▋   | 661/981 [00:40<00:23, 13.45it/s] 68%|██████▊   | 663/981 [00:41<00:21, 14.56it/s] 68%|██████▊   | 666/981 [00:41<00:18, 16.90it/s] 68%|██████▊   | 669/981 [00:41<00:16, 18.75it/s] 69%|██████▊   | 672/981 [00:41<00:15, 20.05it/s] 69%|██████▉   | 675/981 [00:41<00:14, 20.98it/s] 69%|██████▉   | 678/981 [00:41<00:13, 22.22it/s] 69%|██████▉   | 681/981 [00:41<00:12, 23.20it/s] 70%|██████▉   | 684/981 [00:41<00:13, 22.01it/s] 70%|███████   | 687/981 [00:42<00:16, 18.35it/s] 70%|███████   | 689/981 [00:42<00:16, 17.50it/s] 70%|███████   | 691/981 [00:42<00:17, 16.61it/s] 71%|███████   | 693/981 [00:42<00:18, 15.16it/s] 71%|███████   | 695/981 [00:42<00:20, 13.96it/s] 71%|███████   | 697/981 [00:42<00:21, 12.92it/s] 71%|███████▏  | 699/981 [00:43<00:21, 13.20it/s] 72%|███████▏  | 702/981 [00:43<00:17, 15.98it/s] 72%|███████▏  | 705/981 [00:43<00:15, 18.27it/s] 72%|███████▏  | 708/981 [00:43<00:13, 19.98it/s] 72%|███████▏  | 711/981 [00:43<00:12, 21.38it/s] 73%|███████▎  | 714/981 [00:43<00:11, 22.36it/s] 73%|███████▎  | 717/981 [00:43<00:12, 21.83it/s] 73%|███████▎  | 720/981 [00:44<00:12, 21.40it/s] 74%|███████▎  | 723/981 [00:44<00:16, 15.92it/s] 74%|███████▍  | 725/981 [00:44<00:19, 13.24it/s] 74%|███████▍  | 727/981 [00:44<00:20, 12.21it/s] 74%|███████▍  | 729/981 [00:44<00:22, 11.37it/s] 75%|███████▍  | 731/981 [00:45<00:23, 10.64it/s] 75%|███████▍  | 734/981 [00:45<00:18, 13.28it/s] 75%|███████▌  | 737/981 [00:45<00:15, 15.45it/s] 75%|███████▌  | 739/981 [00:45<00:14, 16.29it/s] 76%|███████▌  | 742/981 [00:45<00:13, 17.96it/s] 76%|███████▌  | 745/981 [00:45<00:12, 19.32it/s] 76%|███████▌  | 748/981 [00:45<00:11, 20.30it/s] 77%|███████▋  | 751/981 [00:46<00:10, 21.14it/s] 77%|███████▋  | 754/981 [00:46<00:10, 20.65it/s] 77%|███████▋  | 757/981 [00:46<00:10, 20.43it/s] 77%|███████▋  | 760/981 [00:46<00:11, 19.11it/s] 78%|███████▊  | 762/981 [00:46<00:12, 17.96it/s] 78%|███████▊  | 764/981 [00:46<00:12, 16.92it/s] 78%|███████▊  | 766/981 [00:47<00:14, 14.90it/s] 78%|███████▊  | 768/981 [00:47<00:17, 12.44it/s] 78%|███████▊  | 770/981 [00:47<00:16, 13.10it/s] 79%|███████▉  | 773/981 [00:47<00:13, 15.24it/s] 79%|███████▉  | 776/981 [00:47<00:12, 16.71it/s] 79%|███████▉  | 779/981 [00:47<00:11, 18.27it/s] 80%|███████▉  | 782/981 [00:47<00:10, 18.88it/s] 80%|███████▉  | 784/981 [00:48<00:10, 18.44it/s] 80%|████████  | 787/981 [00:48<00:09, 19.54it/s] 80%|████████  | 789/981 [00:48<00:09, 19.62it/s] 81%|████████  | 791/981 [00:48<00:09, 19.02it/s] 81%|████████  | 793/981 [00:48<00:12, 14.53it/s] 81%|████████  | 795/981 [00:48<00:14, 12.70it/s] 81%|████████  | 797/981 [00:49<00:14, 13.00it/s] 81%|████████▏ | 799/981 [00:49<00:14, 12.49it/s] 82%|████████▏ | 801/981 [00:49<00:15, 11.64it/s] 82%|████████▏ | 804/981 [00:49<00:11, 14.91it/s] 82%|████████▏ | 807/981 [00:49<00:09, 17.46it/s] 83%|████████▎ | 810/981 [00:49<00:08, 19.64it/s] 83%|████████▎ | 813/981 [00:49<00:07, 21.79it/s] 83%|████████▎ | 816/981 [00:49<00:07, 23.55it/s] 83%|████████▎ | 819/981 [00:50<00:06, 24.93it/s] 84%|████████▍ | 822/981 [00:50<00:06, 25.90it/s] 84%|████████▍ | 825/981 [00:50<00:05, 26.55it/s] 84%|████████▍ | 828/981 [00:50<00:05, 25.80it/s] 85%|████████▍ | 831/981 [00:50<00:06, 22.82it/s] 85%|████████▌ | 834/981 [00:50<00:07, 20.31it/s] 85%|████████▌ | 837/981 [00:50<00:07, 18.64it/s] 86%|████████▌ | 839/981 [00:51<00:07, 18.41it/s] 86%|████████▌ | 841/981 [00:51<00:08, 15.73it/s] 86%|████████▌ | 843/981 [00:51<00:09, 13.90it/s] 86%|████████▌ | 846/981 [00:51<00:08, 15.83it/s] 87%|████████▋ | 849/981 [00:51<00:07, 18.43it/s] 87%|████████▋ | 852/981 [00:51<00:06, 20.70it/s] 87%|████████▋ | 855/981 [00:51<00:05, 22.55it/s] 87%|████████▋ | 858/981 [00:51<00:05, 24.10it/s] 88%|████████▊ | 861/981 [00:52<00:04, 25.37it/s] 88%|████████▊ | 864/981 [00:52<00:04, 26.08it/s] 88%|████████▊ | 867/981 [00:52<00:04, 26.74it/s] 89%|████████▊ | 870/981 [00:52<00:04, 23.95it/s] 89%|████████▉ | 873/981 [00:52<00:05, 20.48it/s] 89%|████████▉ | 876/981 [00:52<00:05, 18.66it/s] 90%|████████▉ | 879/981 [00:53<00:05, 17.94it/s] 90%|████████▉ | 881/981 [00:53<00:05, 17.30it/s] 90%|█████████ | 883/981 [00:53<00:05, 17.07it/s] 90%|█████████ | 885/981 [00:53<00:05, 16.51it/s] 90%|█████████ | 887/981 [00:53<00:05, 16.58it/s] 91%|█████████ | 890/981 [00:53<00:04, 19.47it/s] 91%|█████████ | 893/981 [00:53<00:04, 21.15it/s] 91%|█████████▏| 896/981 [00:53<00:04, 20.46it/s] 92%|█████████▏| 899/981 [00:54<00:03, 21.67it/s] 92%|█████████▏| 902/981 [00:54<00:03, 23.15it/s] 92%|█████████▏| 905/981 [00:54<00:03, 24.62it/s] 93%|█████████▎| 908/981 [00:54<00:03, 24.32it/s] 93%|█████████▎| 911/981 [00:54<00:03, 19.51it/s] 93%|█████████▎| 914/981 [00:54<00:03, 18.17it/s] 93%|█████████▎| 916/981 [00:54<00:03, 16.97it/s] 94%|█████████▎| 918/981 [00:55<00:04, 14.98it/s] 94%|█████████▍| 920/981 [00:55<00:04, 13.78it/s] 94%|█████████▍| 922/981 [00:55<00:04, 13.00it/s] 94%|█████████▍| 924/981 [00:55<00:04, 14.03it/s] 94%|█████████▍| 927/981 [00:55<00:03, 17.16it/s] 95%|█████████▍| 930/981 [00:55<00:02, 19.80it/s] 95%|█████████▌| 933/981 [00:55<00:02, 21.99it/s] 95%|█████████▌| 936/981 [00:56<00:01, 23.74it/s] 96%|█████████▌| 939/981 [00:56<00:01, 25.11it/s] 96%|█████████▌| 942/981 [00:56<00:01, 26.22it/s] 96%|█████████▋| 945/981 [00:56<00:01, 26.97it/s] 97%|█████████▋| 948/981 [00:56<00:01, 27.50it/s] 97%|█████████▋| 951/981 [00:56<00:01, 24.48it/s] 97%|█████████▋| 954/981 [00:56<00:01, 18.85it/s] 98%|█████████▊| 957/981 [00:57<00:01, 14.25it/s] 98%|█████████▊| 959/981 [00:57<00:01, 12.77it/s] 98%|█████████▊| 961/981 [00:57<00:01, 11.90it/s] 98%|█████████▊| 963/981 [00:57<00:01, 13.26it/s] 98%|█████████▊| 966/981 [00:57<00:00, 15.92it/s] 99%|█████████▉| 969/981 [00:57<00:00, 18.07it/s] 99%|█████████▉| 972/981 [00:58<00:00, 19.86it/s] 99%|█████████▉| 975/981 [00:58<00:00, 21.30it/s]100%|█████████▉| 978/981 [00:58<00:00, 22.45it/s]100%|██████████| 981/981 [00:58<00:00, 21.22it/s]100%|██████████| 981/981 [00:58<00:00, 16.79it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_4_Focal_RS_DRW_seed_40
train data : 14398, disrupt : 227, non-disrupt : 14171
valid data : 3508, disrupt : 57, non-disrupt : 3451
test data : 4051, disrupt : 71, non-disrupt : 3980

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.120, valid loss : 0.067, train f1 : 0.748, valid f1 : 0.599
Best score increase :0.000 -> 0.599
training process - Deferred Re-weighting:   1%|          | 1/128 [14:56<31:38:27, 896.91s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 2/128 [24:05<24:13:00, 691.91s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [37:49<26:07:13, 752.27s/it]Best score increase :0.599 -> 0.622
training process - Deferred Re-weighting:   3%|▎         | 4/128 [47:44<23:46:18, 690.15s/it]epoch : 5, train loss : 0.043, valid loss : 0.024, train f1 : 0.929, valid f1 : 0.624
Best score increase :0.622 -> 0.624
training process - Deferred Re-weighting:   4%|▍         | 5/128 [1:02:14<25:47:54, 755.08s/it]Best score increase :0.624 -> 0.677
training process - Deferred Re-weighting:   5%|▍         | 6/128 [1:11:19<23:10:23, 683.80s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [1:20:31<21:32:06, 640.71s/it]Best score increase :0.677 -> 0.710
training process - Deferred Re-weighting:   6%|▋         | 8/128 [1:30:38<20:59:33, 629.78s/it]epoch : 9, train loss : 0.035, valid loss : 0.047, train f1 : 0.945, valid f1 : 0.631
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [1:46:22<24:04:13, 728.18s/it]Best score increase :0.710 -> 0.745
training process - Deferred Re-weighting:   8%|▊         | 10/128 [1:59:09<24:15:32, 740.10s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [2:08:20<22:10:02, 682.07s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [2:21:57<23:18:00, 723.11s/it]epoch : 13, train loss : 0.030, valid loss : 0.041, train f1 : 0.949, valid f1 : 0.623
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [2:32:46<22:23:19, 700.87s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [2:41:59<20:46:26, 656.02s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [2:54:08<21:17:06, 678.11s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [3:05:19<21:01:39, 675.89s/it]epoch : 17, train loss : 0.027, valid loss : 0.051, train f1 : 0.958, valid f1 : 0.716
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [3:20:10<22:49:57, 740.52s/it]Best score increase :0.745 -> 0.783
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [3:32:19<22:31:39, 737.27s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [3:43:52<21:54:59, 723.85s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [3:57:26<22:31:54, 751.06s/it]epoch : 21, train loss : 0.028, valid loss : 0.046, train f1 : 0.959, valid f1 : 0.627
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [4:07:19<20:54:49, 703.64s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [4:16:29<19:21:26, 657.42s/it]Best score increase :0.783 -> 0.797
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [4:25:44<18:16:52, 626.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [4:34:58<17:28:37, 604.97s/it]epoch : 25, train loss : 0.025, valid loss : 0.039, train f1 : 0.960, valid f1 : 0.642
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [4:44:50<17:11:30, 600.87s/it]Best score increase :0.797 -> 0.809
training process - Deferred Re-weighting:  20%|██        | 26/128 [4:53:54<16:32:25, 583.78s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [5:03:00<16:03:53, 572.61s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [5:12:07<15:41:17, 564.78s/it]epoch : 29, train loss : 0.025, valid loss : 0.042, train f1 : 0.964, valid f1 : 0.711
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [5:22:03<15:47:15, 574.09s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [5:31:10<15:24:31, 566.04s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [5:40:16<15:05:23, 560.04s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [5:49:22<14:49:14, 555.78s/it]epoch : 33, train loss : 0.023, valid loss : 0.051, train f1 : 0.967, valid f1 : 0.707
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [5:59:27<15:03:28, 570.61s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [6:08:41<14:46:07, 565.62s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [6:17:47<14:27:45, 559.85s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [6:26:55<14:12:38, 556.07s/it]epoch : 37, train loss : 0.023, valid loss : 0.029, train f1 : 0.968, valid f1 : 0.719
EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [6:36:49<14:21:01, 567.71s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.809
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [6:45:57<16:38:25, 658.30s/it]
training process finished, best loss : 0.021, best acc : 0.985, best f1 : 0.809, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.53      0.82      0.64        71
           1       1.00      0.99      0.99      3980

    accuracy                           0.98      4051
   macro avg       0.76      0.90      0.82      4051
weighted avg       0.99      0.98      0.99      4051


# test acc : 0.98, test f1 : 0.82, test AUC : 0.90, test loss : 0.658

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/980 [00:00<?, ?it/s]  0%|          | 2/980 [00:00<00:52, 18.77it/s]  0%|          | 4/980 [00:00<01:20, 12.16it/s]  1%|          | 6/980 [00:00<01:21, 11.88it/s]  1%|          | 8/980 [00:00<01:50,  8.82it/s]  1%|          | 10/980 [00:01<01:51,  8.70it/s]  1%|          | 11/980 [00:01<01:52,  8.61it/s]  1%|          | 12/980 [00:01<01:51,  8.69it/s]  2%|▏         | 15/980 [00:01<01:17, 12.41it/s]  2%|▏         | 18/980 [00:01<01:02, 15.51it/s]  2%|▏         | 21/980 [00:01<00:53, 17.88it/s]  2%|▏         | 24/980 [00:01<00:49, 19.34it/s]  3%|▎         | 27/980 [00:02<00:56, 17.02it/s]  3%|▎         | 30/980 [00:02<00:53, 17.87it/s]  3%|▎         | 32/980 [00:02<00:52, 17.91it/s]  3%|▎         | 34/980 [00:02<00:57, 16.37it/s]  4%|▎         | 36/980 [00:02<01:09, 13.65it/s]  4%|▍         | 38/980 [00:02<01:11, 13.11it/s]  4%|▍         | 40/980 [00:03<01:25, 10.96it/s]  4%|▍         | 42/980 [00:03<01:32, 10.16it/s]  4%|▍         | 44/980 [00:03<01:23, 11.20it/s]  5%|▍         | 47/980 [00:03<01:06, 13.94it/s]  5%|▌         | 50/980 [00:03<00:56, 16.36it/s]  5%|▌         | 53/980 [00:03<00:50, 18.27it/s]  6%|▌         | 56/980 [00:03<00:47, 19.33it/s]  6%|▌         | 59/980 [00:04<00:45, 20.38it/s]  6%|▋         | 62/980 [00:04<00:44, 20.53it/s]  7%|▋         | 65/980 [00:04<00:50, 18.14it/s]  7%|▋         | 67/980 [00:04<00:54, 16.73it/s]  7%|▋         | 69/980 [00:04<01:03, 14.34it/s]  7%|▋         | 71/980 [00:05<01:14, 12.25it/s]  7%|▋         | 73/980 [00:05<01:27, 10.36it/s]  8%|▊         | 75/980 [00:05<01:16, 11.88it/s]  8%|▊         | 78/980 [00:05<01:02, 14.47it/s]  8%|▊         | 81/980 [00:05<00:53, 16.78it/s]  9%|▊         | 84/980 [00:05<00:47, 18.68it/s]  9%|▉         | 87/980 [00:05<00:44, 19.96it/s]  9%|▉         | 90/980 [00:06<00:42, 21.01it/s]  9%|▉         | 93/980 [00:06<00:40, 21.72it/s] 10%|▉         | 96/980 [00:06<00:40, 21.60it/s] 10%|█         | 99/980 [00:06<00:44, 19.68it/s] 10%|█         | 102/980 [00:06<01:02, 14.10it/s] 11%|█         | 104/980 [00:07<01:09, 12.58it/s] 11%|█         | 106/980 [00:07<01:08, 12.70it/s] 11%|█         | 108/980 [00:07<01:10, 12.38it/s] 11%|█         | 110/980 [00:07<01:05, 13.29it/s] 12%|█▏        | 113/980 [00:07<00:54, 15.94it/s] 12%|█▏        | 116/980 [00:07<00:47, 18.04it/s] 12%|█▏        | 119/980 [00:07<00:44, 19.49it/s] 12%|█▏        | 122/980 [00:07<00:41, 20.71it/s] 13%|█▎        | 125/980 [00:08<00:39, 21.61it/s] 13%|█▎        | 128/980 [00:08<00:38, 22.18it/s] 13%|█▎        | 131/980 [00:08<00:38, 22.14it/s] 14%|█▎        | 134/980 [00:08<00:52, 16.04it/s] 14%|█▍        | 136/980 [00:08<00:54, 15.41it/s] 14%|█▍        | 138/980 [00:08<00:56, 14.95it/s] 14%|█▍        | 140/980 [00:09<00:57, 14.74it/s] 14%|█▍        | 142/980 [00:09<01:04, 13.08it/s] 15%|█▍        | 144/980 [00:09<01:09, 12.10it/s] 15%|█▌        | 147/980 [00:09<00:56, 14.82it/s] 15%|█▌        | 150/980 [00:09<00:48, 17.11it/s] 16%|█▌        | 153/980 [00:09<00:43, 18.84it/s] 16%|█▌        | 156/980 [00:10<00:40, 20.14it/s] 16%|█▌        | 159/980 [00:10<00:38, 21.17it/s] 17%|█▋        | 162/980 [00:10<00:37, 21.84it/s] 17%|█▋        | 165/980 [00:10<00:36, 22.35it/s] 17%|█▋        | 168/980 [00:10<00:37, 21.62it/s] 17%|█▋        | 171/980 [00:10<00:52, 15.39it/s] 18%|█▊        | 173/980 [00:11<00:58, 13.86it/s] 18%|█▊        | 175/980 [00:11<01:09, 11.56it/s] 18%|█▊        | 177/980 [00:11<01:15, 10.63it/s] 18%|█▊        | 179/980 [00:11<01:08, 11.72it/s] 19%|█▊        | 182/980 [00:11<00:55, 14.27it/s] 19%|█▉        | 185/980 [00:11<00:47, 16.61it/s] 19%|█▉        | 188/980 [00:12<00:42, 18.55it/s] 19%|█▉        | 191/980 [00:12<00:39, 19.98it/s] 20%|█▉        | 194/980 [00:12<00:39, 19.66it/s] 20%|██        | 197/980 [00:12<00:40, 19.24it/s] 20%|██        | 199/980 [00:12<00:47, 16.39it/s] 21%|██        | 201/980 [00:12<00:52, 14.75it/s] 21%|██        | 203/980 [00:13<00:55, 14.01it/s] 21%|██        | 205/980 [00:13<00:56, 13.60it/s] 21%|██        | 207/980 [00:13<00:59, 13.01it/s] 21%|██▏       | 209/980 [00:13<01:05, 11.70it/s] 22%|██▏       | 211/980 [00:13<01:12, 10.61it/s] 22%|██▏       | 213/980 [00:13<01:03, 12.16it/s] 22%|██▏       | 216/980 [00:14<00:51, 14.87it/s] 22%|██▏       | 219/980 [00:14<00:44, 17.12it/s] 23%|██▎       | 222/980 [00:14<00:40, 18.80it/s] 23%|██▎       | 225/980 [00:14<00:37, 19.94it/s] 23%|██▎       | 228/980 [00:14<00:36, 20.70it/s] 24%|██▎       | 231/980 [00:14<00:36, 20.26it/s] 24%|██▍       | 234/980 [00:14<00:46, 16.07it/s] 24%|██▍       | 236/980 [00:15<00:57, 12.84it/s] 24%|██▍       | 238/980 [00:15<01:07, 10.92it/s] 24%|██▍       | 240/980 [00:15<01:07, 11.00it/s] 25%|██▍       | 242/980 [00:15<01:05, 11.35it/s] 25%|██▌       | 245/980 [00:16<00:53, 13.68it/s] 25%|██▌       | 248/980 [00:16<00:46, 15.81it/s] 26%|██▌       | 251/980 [00:16<00:41, 17.63it/s] 26%|██▌       | 254/980 [00:16<00:39, 18.57it/s] 26%|██▌       | 257/980 [00:16<00:36, 19.87it/s] 27%|██▋       | 260/980 [00:16<00:34, 20.83it/s] 27%|██▋       | 263/980 [00:16<00:33, 21.13it/s] 27%|██▋       | 266/980 [00:16<00:35, 20.03it/s] 27%|██▋       | 269/980 [00:17<00:41, 17.10it/s] 28%|██▊       | 271/980 [00:17<00:49, 14.25it/s] 28%|██▊       | 273/980 [00:17<00:48, 14.47it/s] 28%|██▊       | 275/980 [00:17<00:56, 12.57it/s] 28%|██▊       | 277/980 [00:17<00:55, 12.67it/s] 28%|██▊       | 279/980 [00:18<00:51, 13.60it/s] 29%|██▊       | 281/980 [00:18<00:47, 14.58it/s] 29%|██▉       | 284/980 [00:18<00:40, 17.06it/s] 29%|██▉       | 287/980 [00:18<00:36, 18.91it/s] 30%|██▉       | 290/980 [00:18<00:34, 20.26it/s] 30%|██▉       | 293/980 [00:18<00:32, 21.01it/s] 30%|███       | 296/980 [00:18<00:31, 21.67it/s] 31%|███       | 299/980 [00:19<00:36, 18.53it/s] 31%|███       | 301/980 [00:19<00:41, 16.34it/s] 31%|███       | 303/980 [00:19<00:43, 15.53it/s] 31%|███       | 305/980 [00:19<00:46, 14.65it/s] 31%|███▏      | 307/980 [00:19<00:46, 14.50it/s] 32%|███▏      | 309/980 [00:19<00:47, 14.20it/s] 32%|███▏      | 311/980 [00:19<00:50, 13.28it/s] 32%|███▏      | 313/980 [00:20<00:50, 13.14it/s] 32%|███▏      | 316/980 [00:20<00:42, 15.45it/s] 33%|███▎      | 319/980 [00:20<00:37, 17.66it/s] 33%|███▎      | 322/980 [00:20<00:34, 19.33it/s] 33%|███▎      | 325/980 [00:20<00:31, 20.56it/s] 33%|███▎      | 328/980 [00:20<00:30, 21.33it/s] 34%|███▍      | 331/980 [00:20<00:30, 21.53it/s] 34%|███▍      | 334/980 [00:21<00:34, 18.66it/s] 34%|███▍      | 336/980 [00:21<00:47, 13.69it/s] 34%|███▍      | 338/980 [00:21<01:00, 10.53it/s] 35%|███▍      | 340/980 [00:21<01:06,  9.68it/s] 35%|███▍      | 342/980 [00:22<00:57, 11.08it/s] 35%|███▌      | 345/980 [00:22<00:46, 13.66it/s] 36%|███▌      | 348/980 [00:22<00:39, 15.95it/s] 36%|███▌      | 351/980 [00:22<00:35, 17.85it/s] 36%|███▌      | 354/980 [00:22<00:32, 19.33it/s] 36%|███▋      | 357/980 [00:22<00:30, 20.46it/s] 37%|███▋      | 360/980 [00:22<00:29, 21.28it/s] 37%|███▋      | 363/980 [00:23<00:29, 20.66it/s] 37%|███▋      | 366/980 [00:23<00:42, 14.52it/s] 38%|███▊      | 368/980 [00:23<00:47, 12.76it/s] 38%|███▊      | 370/980 [00:23<00:55, 11.04it/s] 38%|███▊      | 372/980 [00:24<00:58, 10.32it/s] 38%|███▊      | 375/980 [00:24<00:48, 12.53it/s] 39%|███▊      | 378/980 [00:24<00:40, 14.89it/s] 39%|███▉      | 381/980 [00:24<00:35, 16.92it/s] 39%|███▉      | 384/980 [00:24<00:32, 18.53it/s] 39%|███▉      | 387/980 [00:24<00:29, 19.82it/s] 40%|███▉      | 390/980 [00:24<00:28, 20.77it/s] 40%|████      | 393/980 [00:24<00:27, 21.14it/s] 40%|████      | 396/980 [00:25<00:31, 18.47it/s] 41%|████      | 398/980 [00:25<00:43, 13.40it/s] 41%|████      | 400/980 [00:25<00:46, 12.51it/s] 41%|████      | 402/980 [00:25<00:54, 10.55it/s] 41%|████      | 404/980 [00:26<00:52, 10.95it/s] 42%|████▏     | 407/980 [00:26<00:43, 13.31it/s] 42%|████▏     | 410/980 [00:26<00:36, 15.52it/s] 42%|████▏     | 413/980 [00:26<00:32, 17.51it/s] 42%|████▏     | 416/980 [00:26<00:29, 19.07it/s] 43%|████▎     | 419/980 [00:26<00:27, 20.28it/s] 43%|████▎     | 422/980 [00:26<00:26, 21.17it/s] 43%|████▎     | 425/980 [00:27<00:26, 21.12it/s] 44%|████▎     | 428/980 [00:27<00:34, 16.08it/s] 44%|████▍     | 430/980 [00:27<00:38, 14.39it/s] 44%|████▍     | 432/980 [00:27<00:43, 12.48it/s] 44%|████▍     | 434/980 [00:27<00:49, 11.10it/s] 44%|████▍     | 436/980 [00:28<00:51, 10.46it/s] 45%|████▍     | 438/980 [00:28<00:45, 11.97it/s] 45%|████▌     | 441/980 [00:28<00:36, 14.64it/s] 45%|████▌     | 444/980 [00:28<00:31, 16.80it/s] 46%|████▌     | 447/980 [00:28<00:28, 18.47it/s] 46%|████▌     | 450/980 [00:28<00:26, 19.84it/s] 46%|████▌     | 453/980 [00:28<00:25, 20.74it/s] 47%|████▋     | 456/980 [00:29<00:24, 21.56it/s] 47%|████▋     | 459/980 [00:29<00:24, 20.99it/s] 47%|████▋     | 462/980 [00:29<00:31, 16.58it/s] 47%|████▋     | 464/980 [00:29<00:33, 15.21it/s] 48%|████▊     | 466/980 [00:29<00:40, 12.60it/s] 48%|████▊     | 468/980 [00:30<00:42, 12.06it/s] 48%|████▊     | 470/980 [00:30<00:46, 11.07it/s] 48%|████▊     | 473/980 [00:30<00:37, 13.53it/s] 49%|████▊     | 476/980 [00:30<00:31, 15.87it/s] 49%|████▉     | 479/980 [00:30<00:28, 17.81it/s] 49%|████▉     | 482/980 [00:30<00:25, 19.27it/s] 49%|████▉     | 485/980 [00:30<00:24, 20.31it/s] 50%|████▉     | 488/980 [00:31<00:23, 21.20it/s] 50%|█████     | 491/980 [00:31<00:22, 21.33it/s] 50%|█████     | 494/980 [00:31<00:26, 18.44it/s] 51%|█████     | 496/980 [00:31<00:33, 14.53it/s] 51%|█████     | 498/980 [00:31<00:35, 13.53it/s] 51%|█████     | 500/980 [00:32<00:41, 11.62it/s] 51%|█████     | 502/980 [00:32<00:48,  9.95it/s] 52%|█████▏    | 505/980 [00:32<00:37, 12.65it/s] 52%|█████▏    | 508/980 [00:32<00:31, 15.13it/s] 52%|█████▏    | 511/980 [00:32<00:27, 17.24it/s] 52%|█████▏    | 514/980 [00:32<00:24, 19.01it/s] 53%|█████▎    | 517/980 [00:33<00:25, 18.43it/s] 53%|█████▎    | 520/980 [00:33<00:23, 19.37it/s] 53%|█████▎    | 523/980 [00:33<00:22, 20.43it/s] 54%|█████▎    | 526/980 [00:33<00:23, 19.58it/s] 54%|█████▍    | 529/980 [00:33<00:31, 14.17it/s] 54%|█████▍    | 531/980 [00:34<00:39, 11.27it/s] 54%|█████▍    | 533/980 [00:34<00:45,  9.89it/s] 55%|█████▍    | 535/980 [00:34<00:39, 11.30it/s] 55%|█████▍    | 538/980 [00:34<00:32, 13.81it/s] 55%|█████▌    | 541/980 [00:34<00:27, 16.07it/s] 56%|█████▌    | 544/980 [00:34<00:25, 17.30it/s] 56%|█████▌    | 547/980 [00:35<00:23, 18.58it/s] 56%|█████▌    | 550/980 [00:35<00:21, 19.85it/s] 56%|█████▋    | 553/980 [00:35<00:20, 20.85it/s] 57%|█████▋    | 556/980 [00:35<00:20, 20.57it/s] 57%|█████▋    | 559/980 [00:35<00:23, 17.97it/s] 57%|█████▋    | 561/980 [00:35<00:27, 15.51it/s] 57%|█████▋    | 563/980 [00:36<00:29, 13.90it/s] 58%|█████▊    | 565/980 [00:36<00:34, 12.18it/s] 58%|█████▊    | 567/980 [00:36<00:39, 10.40it/s] 58%|█████▊    | 569/980 [00:36<00:34, 11.80it/s] 58%|█████▊    | 571/980 [00:36<00:30, 13.27it/s] 59%|█████▊    | 574/980 [00:36<00:25, 16.06it/s] 59%|█████▉    | 577/980 [00:37<00:22, 18.19it/s] 59%|█████▉    | 580/980 [00:37<00:20, 19.93it/s] 59%|█████▉    | 583/980 [00:37<00:18, 21.05it/s] 60%|█████▉    | 586/980 [00:37<00:17, 21.97it/s] 60%|██████    | 589/980 [00:37<00:17, 22.65it/s] 60%|██████    | 592/980 [00:37<00:20, 19.23it/s] 61%|██████    | 595/980 [00:37<00:23, 16.21it/s] 61%|██████    | 597/980 [00:38<00:27, 14.13it/s] 61%|██████    | 599/980 [00:38<00:31, 11.99it/s] 61%|██████▏   | 601/980 [00:38<00:33, 11.26it/s] 62%|██████▏   | 603/980 [00:38<00:30, 12.45it/s] 62%|██████▏   | 606/980 [00:38<00:26, 14.37it/s] 62%|██████▏   | 609/980 [00:39<00:22, 16.64it/s] 62%|██████▏   | 612/980 [00:39<00:20, 17.94it/s] 63%|██████▎   | 615/980 [00:39<00:18, 19.49it/s] 63%|██████▎   | 618/980 [00:39<00:17, 20.82it/s] 63%|██████▎   | 621/980 [00:39<00:16, 21.83it/s] 64%|██████▎   | 624/980 [00:39<00:16, 22.06it/s] 64%|██████▍   | 627/980 [00:39<00:17, 20.13it/s] 64%|██████▍   | 630/980 [00:40<00:18, 19.02it/s] 64%|██████▍   | 632/980 [00:40<00:19, 17.50it/s] 65%|██████▍   | 634/980 [00:40<00:21, 15.88it/s] 65%|██████▍   | 636/980 [00:40<00:24, 13.87it/s] 65%|██████▌   | 638/980 [00:40<00:28, 12.09it/s] 65%|██████▌   | 640/980 [00:40<00:26, 12.88it/s] 66%|██████▌   | 643/980 [00:41<00:21, 15.74it/s] 66%|██████▌   | 646/980 [00:41<00:18, 18.07it/s] 66%|██████▌   | 648/980 [00:41<00:18, 18.03it/s] 66%|██████▋   | 650/980 [00:41<00:18, 18.12it/s] 67%|██████▋   | 653/980 [00:41<00:16, 19.55it/s] 67%|██████▋   | 656/980 [00:41<00:15, 20.89it/s] 67%|██████▋   | 659/980 [00:41<00:15, 21.08it/s] 68%|██████▊   | 662/980 [00:42<00:19, 16.66it/s] 68%|██████▊   | 664/980 [00:42<00:25, 12.42it/s] 68%|██████▊   | 666/980 [00:42<00:26, 12.03it/s] 68%|██████▊   | 668/980 [00:42<00:25, 12.25it/s] 68%|██████▊   | 670/980 [00:42<00:25, 12.09it/s] 69%|██████▊   | 673/980 [00:42<00:21, 14.58it/s] 69%|██████▉   | 676/980 [00:43<00:17, 17.01it/s] 69%|██████▉   | 679/980 [00:43<00:15, 18.89it/s] 70%|██████▉   | 682/980 [00:43<00:14, 20.46it/s] 70%|██████▉   | 685/980 [00:43<00:13, 21.55it/s] 70%|███████   | 688/980 [00:43<00:13, 22.37it/s] 71%|███████   | 691/980 [00:43<00:12, 22.96it/s] 71%|███████   | 694/980 [00:43<00:13, 21.58it/s] 71%|███████   | 697/980 [00:44<00:17, 16.53it/s] 71%|███████▏  | 699/980 [00:44<00:20, 13.50it/s] 72%|███████▏  | 701/980 [00:44<00:23, 11.71it/s] 72%|███████▏  | 703/980 [00:44<00:23, 11.84it/s] 72%|███████▏  | 705/980 [00:44<00:21, 12.74it/s] 72%|███████▏  | 708/980 [00:45<00:17, 15.41it/s] 73%|███████▎  | 711/980 [00:45<00:15, 17.66it/s] 73%|███████▎  | 714/980 [00:45<00:13, 19.42it/s] 73%|███████▎  | 717/980 [00:45<00:13, 19.55it/s] 73%|███████▎  | 720/980 [00:45<00:12, 20.59it/s] 74%|███████▍  | 723/980 [00:45<00:11, 21.61it/s] 74%|███████▍  | 726/980 [00:45<00:12, 21.11it/s] 74%|███████▍  | 729/980 [00:46<00:16, 15.51it/s] 75%|███████▍  | 731/980 [00:46<00:19, 13.05it/s] 75%|███████▍  | 733/980 [00:46<00:19, 12.81it/s] 75%|███████▌  | 735/980 [00:46<00:20, 11.72it/s] 75%|███████▌  | 737/980 [00:46<00:22, 10.96it/s] 76%|███████▌  | 740/980 [00:47<00:17, 13.57it/s] 76%|███████▌  | 743/980 [00:47<00:14, 15.97it/s] 76%|███████▌  | 746/980 [00:47<00:13, 17.93it/s] 76%|███████▋  | 749/980 [00:47<00:11, 19.48it/s] 77%|███████▋  | 752/980 [00:47<00:10, 20.76it/s] 77%|███████▋  | 755/980 [00:47<00:10, 21.75it/s] 77%|███████▋  | 758/980 [00:47<00:09, 22.41it/s] 78%|███████▊  | 761/980 [00:48<00:12, 17.93it/s] 78%|███████▊  | 763/980 [00:48<00:14, 14.72it/s] 78%|███████▊  | 765/980 [00:48<00:17, 12.34it/s] 78%|███████▊  | 767/980 [00:48<00:18, 11.57it/s] 78%|███████▊  | 769/980 [00:48<00:20, 10.49it/s] 79%|███████▊  | 771/980 [00:49<00:18, 11.47it/s] 79%|███████▉  | 774/980 [00:49<00:14, 14.20it/s] 79%|███████▉  | 777/980 [00:49<00:12, 16.71it/s] 80%|███████▉  | 780/980 [00:49<00:10, 18.82it/s] 80%|███████▉  | 783/980 [00:49<00:09, 20.44it/s] 80%|████████  | 786/980 [00:49<00:08, 21.81it/s] 81%|████████  | 789/980 [00:49<00:08, 22.80it/s] 81%|████████  | 792/980 [00:49<00:07, 23.62it/s] 81%|████████  | 795/980 [00:50<00:08, 22.30it/s] 81%|████████▏ | 798/980 [00:50<00:10, 17.93it/s] 82%|████████▏ | 800/980 [00:50<00:10, 16.89it/s] 82%|████████▏ | 802/980 [00:50<00:11, 14.90it/s] 82%|████████▏ | 804/980 [00:50<00:14, 12.53it/s] 82%|████████▏ | 806/980 [00:51<00:15, 11.52it/s] 83%|████████▎ | 809/980 [00:51<00:11, 14.60it/s] 83%|████████▎ | 812/980 [00:51<00:09, 17.36it/s] 83%|████████▎ | 815/980 [00:51<00:08, 19.64it/s] 83%|████████▎ | 818/980 [00:51<00:07, 21.47it/s] 84%|████████▍ | 821/980 [00:51<00:06, 22.72it/s] 84%|████████▍ | 824/980 [00:51<00:06, 23.76it/s] 84%|████████▍ | 827/980 [00:51<00:06, 24.55it/s] 85%|████████▍ | 830/980 [00:52<00:05, 25.25it/s] 85%|████████▌ | 833/980 [00:52<00:06, 23.67it/s] 85%|████████▌ | 836/980 [00:52<00:07, 20.12it/s] 86%|████████▌ | 839/980 [00:52<00:09, 15.22it/s] 86%|████████▌ | 841/980 [00:52<00:10, 12.96it/s] 86%|████████▌ | 843/980 [00:53<00:13, 10.34it/s] 86%|████████▋ | 846/980 [00:53<00:10, 13.06it/s] 87%|████████▋ | 849/980 [00:53<00:08, 15.69it/s] 87%|████████▋ | 852/980 [00:53<00:07, 18.00it/s] 87%|████████▋ | 855/980 [00:53<00:06, 20.04it/s] 88%|████████▊ | 858/980 [00:53<00:05, 21.69it/s] 88%|████████▊ | 861/980 [00:53<00:05, 22.82it/s] 88%|████████▊ | 864/980 [00:54<00:05, 22.71it/s] 88%|████████▊ | 867/980 [00:54<00:04, 23.57it/s] 89%|████████▉ | 870/980 [00:54<00:05, 21.82it/s] 89%|████████▉ | 873/980 [00:54<00:06, 15.97it/s] 89%|████████▉ | 875/980 [00:54<00:07, 14.15it/s] 89%|████████▉ | 877/980 [00:54<00:07, 13.28it/s] 90%|████████▉ | 879/980 [00:55<00:08, 12.38it/s] 90%|████████▉ | 881/980 [00:55<00:08, 11.91it/s] 90%|█████████ | 884/980 [00:55<00:06, 14.68it/s] 91%|█████████ | 887/980 [00:55<00:05, 17.35it/s] 91%|█████████ | 890/980 [00:55<00:04, 19.63it/s] 91%|█████████ | 893/980 [00:55<00:04, 21.59it/s] 91%|█████████▏| 896/980 [00:55<00:03, 23.19it/s] 92%|█████████▏| 899/980 [00:56<00:03, 24.21it/s] 92%|█████████▏| 902/980 [00:56<00:03, 24.99it/s] 92%|█████████▏| 905/980 [00:56<00:03, 24.79it/s] 93%|█████████▎| 908/980 [00:56<00:03, 21.25it/s] 93%|█████████▎| 911/980 [00:56<00:03, 18.36it/s] 93%|█████████▎| 913/980 [00:56<00:03, 16.85it/s] 93%|█████████▎| 915/980 [00:57<00:04, 14.03it/s] 94%|█████████▎| 917/980 [00:57<00:05, 11.32it/s] 94%|█████████▍| 920/980 [00:57<00:04, 12.99it/s] 94%|█████████▍| 922/980 [00:57<00:04, 13.47it/s] 94%|█████████▍| 924/980 [00:57<00:04, 13.24it/s] 94%|█████████▍| 926/980 [00:58<00:04, 11.64it/s] 95%|█████████▍| 928/980 [00:58<00:04, 11.77it/s] 95%|█████████▍| 930/980 [00:58<00:04, 10.75it/s] 95%|█████████▌| 932/980 [00:58<00:03, 12.38it/s] 95%|█████████▌| 935/980 [00:58<00:02, 15.68it/s] 96%|█████████▌| 938/980 [00:58<00:02, 18.52it/s] 96%|█████████▌| 941/980 [00:58<00:01, 20.63it/s] 96%|█████████▋| 944/980 [00:58<00:01, 22.39it/s] 97%|█████████▋| 947/980 [00:59<00:01, 23.62it/s] 97%|█████████▋| 950/980 [00:59<00:01, 24.07it/s] 97%|█████████▋| 953/980 [00:59<00:01, 24.63it/s] 98%|█████████▊| 956/980 [00:59<00:01, 23.68it/s] 98%|█████████▊| 959/980 [00:59<00:01, 19.26it/s] 98%|█████████▊| 962/980 [00:59<00:01, 14.78it/s] 98%|█████████▊| 964/980 [01:00<00:01, 12.50it/s] 99%|█████████▊| 966/980 [01:00<00:01, 11.75it/s] 99%|█████████▉| 968/980 [01:00<00:00, 12.62it/s] 99%|█████████▉| 971/980 [01:00<00:00, 15.57it/s] 99%|█████████▉| 974/980 [01:00<00:00, 18.22it/s]100%|█████████▉| 977/980 [01:00<00:00, 20.35it/s]100%|██████████| 980/980 [01:00<00:00, 21.95it/s]100%|██████████| 980/980 [01:00<00:00, 16.07it/s]
time :  1337
prob :  1337
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_5_Focal_RS_DRW_seed_40
train data : 14374, disrupt : 227, non-disrupt : 14147
valid data : 3506, disrupt : 57, non-disrupt : 3449
test data : 4049, disrupt : 71, non-disrupt : 3978

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.140, valid loss : 0.057, train f1 : 0.697, valid f1 : 0.601
Best score increase :0.000 -> 0.601
training process - Deferred Re-weighting:   1%|          | 1/128 [09:54<20:57:52, 594.27s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 2/128 [18:59<19:47:52, 565.66s/it]Best score increase :0.601 -> 0.620
training process - Deferred Re-weighting:   2%|▏         | 3/128 [28:05<19:19:25, 556.52s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [37:12<19:02:42, 552.92s/it]epoch : 5, train loss : 0.059, valid loss : 0.063, train f1 : 0.893, valid f1 : 0.554
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [47:18<19:32:03, 571.74s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [56:24<19:05:18, 563.27s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [1:05:34<18:46:37, 558.65s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [1:14:36<18:26:43, 553.36s/it]epoch : 9, train loss : 0.049, valid loss : 0.105, train f1 : 0.918, valid f1 : 0.533
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [1:24:28<18:41:52, 565.65s/it]Best score increase :0.620 -> 0.675
training process - Deferred Re-weighting:   8%|▊         | 10/128 [1:33:36<18:21:32, 560.11s/it]Best score increase :0.675 -> 0.682
training process - Deferred Re-weighting:   9%|▊         | 11/128 [1:42:43<18:04:31, 556.16s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [1:51:48<17:48:36, 552.73s/it]epoch : 13, train loss : 0.042, valid loss : 0.065, train f1 : 0.926, valid f1 : 0.630
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [2:01:38<18:01:18, 564.16s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [2:10:45<17:41:36, 558.74s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [2:20:03<17:32:05, 558.63s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [2:29:15<17:19:05, 556.65s/it]epoch : 17, train loss : 0.038, valid loss : 0.101, train f1 : 0.939, valid f1 : 0.531
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [2:39:35<17:44:42, 575.52s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [2:48:40<17:18:23, 566.39s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [2:57:43<16:56:19, 559.44s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [3:06:46<16:38:17, 554.61s/it]epoch : 21, train loss : 0.033, valid loss : 0.102, train f1 : 0.941, valid f1 : 0.615
EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [3:16:39<16:49:19, 565.97s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [3:22:37<14:49:45, 503.64s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 22, best f1 score : 0.682
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [3:26:07<16:33:10, 562.17s/it]
training process finished, best loss : 0.042, best acc : 0.967, best f1 : 0.682, best epoch : 10

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.29      0.73      0.42        71
           1       1.00      0.97      0.98      3978

    accuracy                           0.96      4049
   macro avg       0.64      0.85      0.70      4049
weighted avg       0.98      0.96      0.97      4049


# test acc : 0.96, test f1 : 0.70, test AUC : 0.85, test loss : 1.371

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/979 [00:00<?, ?it/s]  0%|          | 2/979 [00:00<00:52, 18.44it/s]  0%|          | 4/979 [00:00<00:59, 16.38it/s]  1%|          | 6/979 [00:00<01:10, 13.87it/s]  1%|          | 8/979 [00:00<01:16, 12.77it/s]  1%|          | 10/979 [00:00<01:12, 13.30it/s]  1%|          | 12/979 [00:00<01:14, 13.01it/s]  1%|▏         | 14/979 [00:01<01:19, 12.13it/s]  2%|▏         | 16/979 [00:01<01:24, 11.36it/s]  2%|▏         | 19/979 [00:01<01:05, 14.66it/s]  2%|▏         | 22/979 [00:01<00:55, 17.40it/s]  3%|▎         | 25/979 [00:01<00:48, 19.64it/s]  3%|▎         | 28/979 [00:01<00:44, 21.40it/s]  3%|▎         | 31/979 [00:01<00:41, 22.77it/s]  3%|▎         | 34/979 [00:01<00:39, 23.70it/s]  4%|▍         | 37/979 [00:02<00:39, 23.83it/s]  4%|▍         | 40/979 [00:02<00:50, 18.45it/s]  4%|▍         | 43/979 [00:02<01:02, 14.94it/s]  5%|▍         | 45/979 [00:02<00:59, 15.69it/s]  5%|▍         | 47/979 [00:02<00:59, 15.73it/s]  5%|▌         | 49/979 [00:03<01:08, 13.53it/s]  5%|▌         | 51/979 [00:03<01:17, 11.92it/s]  6%|▌         | 54/979 [00:03<01:04, 14.40it/s]  6%|▌         | 57/979 [00:03<00:54, 16.80it/s]  6%|▌         | 60/979 [00:03<00:48, 18.94it/s]  6%|▋         | 63/979 [00:03<00:44, 20.75it/s]  7%|▋         | 66/979 [00:03<00:41, 22.15it/s]  7%|▋         | 69/979 [00:04<00:39, 23.19it/s]  7%|▋         | 72/979 [00:04<00:37, 24.01it/s]  8%|▊         | 75/979 [00:04<00:38, 23.55it/s]  8%|▊         | 78/979 [00:04<00:49, 18.32it/s]  8%|▊         | 81/979 [00:04<00:59, 14.97it/s]  8%|▊         | 83/979 [00:04<01:07, 13.20it/s]  9%|▊         | 85/979 [00:05<01:13, 12.10it/s]  9%|▉         | 87/979 [00:05<01:24, 10.56it/s]  9%|▉         | 89/979 [00:05<01:26, 10.33it/s]  9%|▉         | 92/979 [00:05<01:09, 12.72it/s] 10%|▉         | 95/979 [00:05<00:59, 14.80it/s] 10%|▉         | 97/979 [00:06<00:56, 15.64it/s] 10%|█         | 100/979 [00:06<00:48, 18.12it/s] 11%|█         | 103/979 [00:06<00:43, 19.99it/s] 11%|█         | 106/979 [00:06<00:47, 18.35it/s] 11%|█         | 108/979 [00:06<00:53, 16.24it/s] 11%|█         | 110/979 [00:06<01:05, 13.25it/s] 11%|█▏        | 112/979 [00:07<01:11, 12.10it/s] 12%|█▏        | 114/979 [00:07<01:20, 10.73it/s] 12%|█▏        | 116/979 [00:07<01:15, 11.36it/s] 12%|█▏        | 119/979 [00:07<01:01, 13.92it/s] 12%|█▏        | 122/979 [00:07<00:52, 16.41it/s] 13%|█▎        | 125/979 [00:07<00:46, 18.54it/s] 13%|█▎        | 128/979 [00:07<00:42, 20.24it/s] 13%|█▎        | 131/979 [00:08<00:38, 21.79it/s] 14%|█▎        | 134/979 [00:08<00:36, 22.98it/s] 14%|█▍        | 137/979 [00:08<00:35, 23.83it/s] 14%|█▍        | 140/979 [00:08<00:36, 23.10it/s] 15%|█▍        | 143/979 [00:08<00:46, 17.84it/s] 15%|█▍        | 146/979 [00:08<00:50, 16.46it/s] 15%|█▌        | 148/979 [00:09<00:54, 15.18it/s] 15%|█▌        | 150/979 [00:09<00:55, 14.99it/s] 16%|█▌        | 152/979 [00:09<00:52, 15.80it/s] 16%|█▌        | 154/979 [00:09<01:02, 13.16it/s] 16%|█▌        | 156/979 [00:09<00:56, 14.45it/s] 16%|█▌        | 158/979 [00:09<00:54, 15.02it/s] 16%|█▋        | 161/979 [00:09<00:46, 17.65it/s] 17%|█▋        | 164/979 [00:10<00:40, 19.97it/s] 17%|█▋        | 167/979 [00:10<00:37, 21.69it/s] 17%|█▋        | 170/979 [00:10<00:35, 22.69it/s] 18%|█▊        | 173/979 [00:10<00:35, 22.84it/s] 18%|█▊        | 176/979 [00:10<00:44, 18.24it/s] 18%|█▊        | 179/979 [00:11<01:01, 12.98it/s] 18%|█▊        | 181/979 [00:11<01:09, 11.49it/s] 19%|█▊        | 183/979 [00:11<01:23,  9.48it/s] 19%|█▉        | 186/979 [00:11<01:05, 12.10it/s] 19%|█▉        | 189/979 [00:11<00:54, 14.45it/s] 20%|█▉        | 192/979 [00:11<00:47, 16.56it/s] 20%|█▉        | 195/979 [00:12<00:42, 18.58it/s] 20%|██        | 198/979 [00:12<00:38, 20.32it/s] 21%|██        | 201/979 [00:12<00:36, 21.59it/s] 21%|██        | 204/979 [00:12<00:34, 22.49it/s] 21%|██        | 207/979 [00:12<00:34, 22.25it/s] 21%|██▏       | 210/979 [00:12<00:46, 16.66it/s] 22%|██▏       | 212/979 [00:13<00:56, 13.50it/s] 22%|██▏       | 214/979 [00:13<01:06, 11.53it/s] 22%|██▏       | 216/979 [00:13<01:13, 10.41it/s] 22%|██▏       | 218/979 [00:13<01:04, 11.83it/s] 23%|██▎       | 221/979 [00:13<00:52, 14.56it/s] 23%|██▎       | 224/979 [00:13<00:44, 17.08it/s] 23%|██▎       | 227/979 [00:14<00:39, 19.12it/s] 23%|██▎       | 230/979 [00:14<00:36, 20.72it/s] 24%|██▍       | 233/979 [00:14<00:33, 21.99it/s] 24%|██▍       | 236/979 [00:14<00:32, 22.93it/s] 24%|██▍       | 239/979 [00:14<00:32, 22.87it/s] 25%|██▍       | 242/979 [00:14<00:41, 17.89it/s] 25%|██▌       | 245/979 [00:15<01:02, 11.69it/s] 25%|██▌       | 247/979 [00:15<00:59, 12.38it/s] 25%|██▌       | 249/979 [00:15<00:56, 12.93it/s] 26%|██▌       | 251/979 [00:15<00:55, 13.04it/s] 26%|██▌       | 253/979 [00:15<00:53, 13.64it/s] 26%|██▌       | 255/979 [00:15<00:48, 14.87it/s] 26%|██▋       | 258/979 [00:16<00:42, 17.14it/s] 27%|██▋       | 261/979 [00:16<00:37, 19.13it/s] 27%|██▋       | 264/979 [00:16<00:34, 20.93it/s] 27%|██▋       | 267/979 [00:16<00:31, 22.30it/s] 28%|██▊       | 270/979 [00:16<00:30, 23.16it/s] 28%|██▊       | 273/979 [00:16<00:33, 21.22it/s] 28%|██▊       | 276/979 [00:16<00:35, 19.66it/s] 28%|██▊       | 279/979 [00:17<00:44, 15.80it/s] 29%|██▊       | 281/979 [00:17<00:49, 14.17it/s] 29%|██▉       | 283/979 [00:17<00:53, 13.12it/s] 29%|██▉       | 285/979 [00:17<00:57, 12.17it/s] 29%|██▉       | 287/979 [00:17<00:54, 12.81it/s] 30%|██▉       | 290/979 [00:17<00:44, 15.64it/s] 30%|██▉       | 293/979 [00:18<00:38, 17.99it/s] 30%|███       | 296/979 [00:18<00:34, 19.95it/s] 31%|███       | 299/979 [00:18<00:31, 21.45it/s] 31%|███       | 302/979 [00:18<00:30, 22.55it/s] 31%|███       | 305/979 [00:18<00:29, 23.22it/s] 31%|███▏      | 308/979 [00:18<00:28, 23.73it/s] 32%|███▏      | 311/979 [00:18<00:32, 20.83it/s] 32%|███▏      | 314/979 [00:19<00:45, 14.52it/s] 32%|███▏      | 316/979 [00:19<00:51, 12.82it/s] 32%|███▏      | 318/979 [00:19<00:54, 12.19it/s] 33%|███▎      | 320/979 [00:19<00:57, 11.47it/s] 33%|███▎      | 323/979 [00:19<00:46, 14.22it/s] 33%|███▎      | 326/979 [00:20<00:39, 16.71it/s] 34%|███▎      | 329/979 [00:20<00:34, 18.86it/s] 34%|███▍      | 332/979 [00:20<00:31, 20.75it/s] 34%|███▍      | 335/979 [00:20<00:29, 22.19it/s] 35%|███▍      | 338/979 [00:20<00:27, 23.22it/s] 35%|███▍      | 341/979 [00:20<00:27, 23.57it/s] 35%|███▌      | 344/979 [00:20<00:27, 23.29it/s] 35%|███▌      | 347/979 [00:20<00:29, 21.48it/s] 36%|███▌      | 350/979 [00:21<00:36, 17.10it/s] 36%|███▌      | 352/979 [00:21<00:36, 17.17it/s] 36%|███▌      | 354/979 [00:21<00:35, 17.72it/s] 36%|███▋      | 356/979 [00:21<00:39, 15.70it/s] 37%|███▋      | 358/979 [00:21<00:43, 14.40it/s] 37%|███▋      | 360/979 [00:21<00:45, 13.62it/s] 37%|███▋      | 363/979 [00:22<00:38, 16.01it/s] 37%|███▋      | 366/979 [00:22<00:33, 18.33it/s] 38%|███▊      | 369/979 [00:22<00:30, 20.13it/s] 38%|███▊      | 372/979 [00:22<00:28, 21.57it/s] 38%|███▊      | 375/979 [00:22<00:26, 22.66it/s] 39%|███▊      | 378/979 [00:22<00:25, 23.23it/s] 39%|███▉      | 381/979 [00:22<00:25, 23.59it/s] 39%|███▉      | 384/979 [00:22<00:26, 22.57it/s] 40%|███▉      | 387/979 [00:23<00:31, 19.02it/s] 40%|███▉      | 390/979 [00:23<00:37, 15.91it/s] 40%|████      | 392/979 [00:23<00:36, 15.94it/s] 40%|████      | 394/979 [00:23<00:35, 16.27it/s] 40%|████      | 396/979 [00:23<00:34, 16.92it/s] 41%|████      | 398/979 [00:23<00:35, 16.25it/s] 41%|████      | 400/979 [00:24<00:37, 15.28it/s] 41%|████      | 403/979 [00:24<00:33, 17.39it/s] 41%|████▏     | 406/979 [00:24<00:29, 19.62it/s] 42%|████▏     | 409/979 [00:24<00:26, 21.35it/s] 42%|████▏     | 412/979 [00:24<00:26, 21.08it/s] 42%|████▏     | 415/979 [00:24<00:25, 21.99it/s] 43%|████▎     | 418/979 [00:24<00:27, 20.42it/s] 43%|████▎     | 421/979 [00:25<00:32, 16.98it/s] 43%|████▎     | 423/979 [00:25<00:34, 16.12it/s] 43%|████▎     | 425/979 [00:25<00:36, 15.07it/s] 44%|████▎     | 427/979 [00:25<00:44, 12.49it/s] 44%|████▍     | 429/979 [00:25<00:47, 11.53it/s] 44%|████▍     | 431/979 [00:26<00:49, 11.05it/s] 44%|████▍     | 434/979 [00:26<00:38, 14.01it/s] 45%|████▍     | 437/979 [00:26<00:32, 16.59it/s] 45%|████▍     | 440/979 [00:26<00:28, 18.89it/s] 45%|████▌     | 443/979 [00:26<00:25, 20.71it/s] 46%|████▌     | 446/979 [00:26<00:24, 22.10it/s] 46%|████▌     | 449/979 [00:26<00:22, 23.08it/s] 46%|████▌     | 452/979 [00:26<00:31, 16.84it/s] 46%|████▋     | 455/979 [00:27<00:36, 14.39it/s] 47%|████▋     | 457/979 [00:27<00:41, 12.53it/s] 47%|████▋     | 459/979 [00:27<00:44, 11.63it/s] 47%|████▋     | 461/979 [00:27<00:45, 11.39it/s] 47%|████▋     | 463/979 [00:28<00:46, 11.07it/s] 48%|████▊     | 466/979 [00:28<00:37, 13.72it/s] 48%|████▊     | 469/979 [00:28<00:31, 16.27it/s] 48%|████▊     | 472/979 [00:28<00:27, 18.45it/s] 49%|████▊     | 475/979 [00:28<00:24, 20.35it/s] 49%|████▉     | 478/979 [00:28<00:22, 22.15it/s] 49%|████▉     | 481/979 [00:28<00:21, 23.42it/s] 49%|████▉     | 484/979 [00:28<00:20, 24.56it/s] 50%|████▉     | 487/979 [00:29<00:19, 24.79it/s] 50%|█████     | 490/979 [00:29<00:23, 20.57it/s] 50%|█████     | 493/979 [00:29<00:27, 17.95it/s] 51%|█████     | 495/979 [00:29<00:29, 16.54it/s] 51%|█████     | 497/979 [00:29<00:29, 16.08it/s] 51%|█████     | 499/979 [00:29<00:35, 13.49it/s] 51%|█████     | 501/979 [00:30<00:36, 12.96it/s] 51%|█████▏    | 503/979 [00:30<00:35, 13.47it/s] 52%|█████▏    | 505/979 [00:30<00:32, 14.78it/s] 52%|█████▏    | 508/979 [00:30<00:26, 17.77it/s] 52%|█████▏    | 511/979 [00:30<00:23, 20.19it/s] 53%|█████▎    | 514/979 [00:30<00:22, 20.51it/s] 53%|█████▎    | 517/979 [00:30<00:21, 21.77it/s] 53%|█████▎    | 520/979 [00:30<00:20, 22.95it/s] 53%|█████▎    | 523/979 [00:31<00:20, 22.64it/s] 54%|█████▎    | 526/979 [00:31<00:25, 18.11it/s] 54%|█████▍    | 528/979 [00:31<00:28, 16.02it/s] 54%|█████▍    | 530/979 [00:31<00:28, 15.57it/s] 54%|█████▍    | 532/979 [00:31<00:29, 15.25it/s] 55%|█████▍    | 534/979 [00:32<00:34, 13.01it/s] 55%|█████▍    | 536/979 [00:32<00:36, 12.19it/s] 55%|█████▌    | 539/979 [00:32<00:28, 15.40it/s] 55%|█████▌    | 542/979 [00:32<00:23, 18.26it/s] 56%|█████▌    | 545/979 [00:32<00:20, 20.71it/s] 56%|█████▌    | 548/979 [00:32<00:18, 22.69it/s] 56%|█████▋    | 551/979 [00:32<00:17, 24.12it/s] 57%|█████▋    | 554/979 [00:32<00:16, 25.26it/s] 57%|█████▋    | 557/979 [00:32<00:16, 25.89it/s] 57%|█████▋    | 560/979 [00:33<00:16, 26.16it/s] 58%|█████▊    | 563/979 [00:33<00:17, 23.99it/s] 58%|█████▊    | 566/979 [00:33<00:20, 19.89it/s] 58%|█████▊    | 569/979 [00:33<00:27, 14.94it/s] 58%|█████▊    | 571/979 [00:33<00:31, 12.92it/s] 59%|█████▊    | 573/979 [00:34<00:34, 11.71it/s] 59%|█████▊    | 575/979 [00:34<00:33, 12.20it/s] 59%|█████▉    | 578/979 [00:34<00:27, 14.76it/s] 59%|█████▉    | 581/979 [00:34<00:22, 17.36it/s] 60%|█████▉    | 584/979 [00:34<00:20, 19.58it/s] 60%|█████▉    | 587/979 [00:34<00:18, 21.41it/s] 60%|██████    | 590/979 [00:34<00:17, 22.87it/s] 61%|██████    | 593/979 [00:35<00:16, 24.04it/s] 61%|██████    | 596/979 [00:35<00:15, 25.00it/s] 61%|██████    | 599/979 [00:35<00:18, 20.34it/s] 61%|██████▏   | 602/979 [00:35<00:28, 13.40it/s] 62%|██████▏   | 604/979 [00:35<00:28, 12.96it/s] 62%|██████▏   | 606/979 [00:36<00:34, 10.94it/s] 62%|██████▏   | 608/979 [00:36<00:35, 10.47it/s] 62%|██████▏   | 610/979 [00:36<00:32, 11.34it/s] 63%|██████▎   | 612/979 [00:36<00:30, 11.87it/s] 63%|██████▎   | 614/979 [00:36<00:27, 13.23it/s] 63%|██████▎   | 616/979 [00:36<00:25, 14.47it/s] 63%|██████▎   | 618/979 [00:36<00:23, 15.47it/s] 63%|██████▎   | 621/979 [00:37<00:20, 17.17it/s] 64%|██████▎   | 624/979 [00:37<00:18, 18.73it/s] 64%|██████▍   | 627/979 [00:37<00:17, 19.74it/s] 64%|██████▍   | 630/979 [00:37<00:16, 20.95it/s] 65%|██████▍   | 633/979 [00:37<00:15, 22.20it/s] 65%|██████▍   | 636/979 [00:37<00:14, 22.95it/s] 65%|██████▌   | 639/979 [00:37<00:14, 24.06it/s] 66%|██████▌   | 642/979 [00:37<00:13, 24.86it/s] 66%|██████▌   | 645/979 [00:38<00:13, 25.50it/s] 66%|██████▌   | 648/979 [00:38<00:12, 26.07it/s] 66%|██████▋   | 651/979 [00:38<00:12, 25.98it/s] 67%|██████▋   | 654/979 [00:38<00:13, 24.00it/s] 67%|██████▋   | 657/979 [00:38<00:15, 21.01it/s] 67%|██████▋   | 660/979 [00:38<00:16, 19.04it/s] 68%|██████▊   | 663/979 [00:39<00:17, 17.74it/s] 68%|██████▊   | 665/979 [00:39<00:18, 17.09it/s] 68%|██████▊   | 667/979 [00:39<00:18, 16.55it/s] 68%|██████▊   | 669/979 [00:39<00:19, 15.63it/s] 69%|██████▊   | 671/979 [00:39<00:20, 15.26it/s] 69%|██████▉   | 674/979 [00:39<00:17, 17.25it/s] 69%|██████▉   | 677/979 [00:39<00:15, 19.67it/s] 69%|██████▉   | 680/979 [00:39<00:13, 21.62it/s] 70%|██████▉   | 683/979 [00:40<00:12, 23.21it/s] 70%|███████   | 686/979 [00:40<00:11, 24.50it/s] 70%|███████   | 689/979 [00:40<00:11, 25.45it/s] 71%|███████   | 692/979 [00:40<00:11, 24.70it/s] 71%|███████   | 695/979 [00:40<00:12, 21.85it/s] 71%|███████▏  | 698/979 [00:40<00:18, 15.20it/s] 72%|███████▏  | 700/979 [00:41<00:19, 14.55it/s] 72%|███████▏  | 702/979 [00:41<00:19, 13.91it/s] 72%|███████▏  | 704/979 [00:41<00:21, 13.02it/s] 72%|███████▏  | 706/979 [00:41<00:20, 13.61it/s] 72%|███████▏  | 709/979 [00:41<00:16, 16.32it/s] 73%|███████▎  | 711/979 [00:41<00:15, 16.97it/s] 73%|███████▎  | 714/979 [00:41<00:14, 18.40it/s] 73%|███████▎  | 717/979 [00:42<00:12, 20.40it/s] 74%|███████▎  | 720/979 [00:42<00:11, 22.14it/s] 74%|███████▍  | 723/979 [00:42<00:10, 23.68it/s] 74%|███████▍  | 726/979 [00:42<00:10, 24.89it/s] 74%|███████▍  | 729/979 [00:42<00:10, 24.63it/s] 75%|███████▍  | 732/979 [00:42<00:11, 21.52it/s] 75%|███████▌  | 735/979 [00:42<00:13, 18.31it/s] 75%|███████▌  | 737/979 [00:43<00:14, 16.85it/s] 75%|███████▌  | 739/979 [00:43<00:16, 14.48it/s] 76%|███████▌  | 741/979 [00:43<00:16, 14.87it/s] 76%|███████▌  | 743/979 [00:43<00:16, 14.45it/s] 76%|███████▌  | 745/979 [00:43<00:15, 15.06it/s] 76%|███████▋  | 748/979 [00:43<00:12, 17.79it/s] 77%|███████▋  | 751/979 [00:43<00:11, 20.04it/s] 77%|███████▋  | 754/979 [00:43<00:10, 22.11it/s] 77%|███████▋  | 757/979 [00:44<00:09, 23.57it/s] 78%|███████▊  | 760/979 [00:44<00:08, 24.75it/s] 78%|███████▊  | 763/979 [00:44<00:08, 25.56it/s] 78%|███████▊  | 766/979 [00:44<00:08, 26.16it/s] 79%|███████▊  | 769/979 [00:44<00:08, 26.06it/s] 79%|███████▉  | 772/979 [00:44<00:08, 25.66it/s] 79%|███████▉  | 775/979 [00:44<00:09, 21.80it/s] 79%|███████▉  | 778/979 [00:45<00:11, 18.04it/s] 80%|███████▉  | 780/979 [00:45<00:12, 16.02it/s] 80%|███████▉  | 782/979 [00:45<00:13, 14.62it/s] 80%|████████  | 784/979 [00:45<00:13, 14.59it/s] 80%|████████  | 786/979 [00:45<00:12, 14.94it/s] 80%|████████  | 788/979 [00:45<00:12, 15.24it/s] 81%|████████  | 792/979 [00:45<00:09, 19.49it/s] 81%|████████▏ | 796/979 [00:46<00:08, 22.82it/s] 82%|████████▏ | 800/979 [00:46<00:07, 25.33it/s] 82%|████████▏ | 804/979 [00:46<00:06, 27.14it/s] 83%|████████▎ | 808/979 [00:46<00:06, 28.45it/s] 83%|████████▎ | 811/979 [00:46<00:05, 28.73it/s] 83%|████████▎ | 814/979 [00:46<00:06, 25.86it/s] 83%|████████▎ | 817/979 [00:46<00:07, 22.27it/s] 84%|████████▍ | 820/979 [00:47<00:09, 16.76it/s] 84%|████████▍ | 822/979 [00:47<00:10, 15.24it/s] 84%|████████▍ | 824/979 [00:47<00:11, 13.90it/s] 84%|████████▍ | 826/979 [00:47<00:11, 13.79it/s] 85%|████████▍ | 829/979 [00:47<00:09, 16.10it/s] 85%|████████▍ | 832/979 [00:47<00:07, 18.64it/s] 85%|████████▌ | 835/979 [00:48<00:06, 21.03it/s] 86%|████████▌ | 838/979 [00:48<00:06, 23.02it/s] 86%|████████▌ | 841/979 [00:48<00:05, 24.58it/s] 86%|████████▋ | 845/979 [00:48<00:05, 26.53it/s] 87%|████████▋ | 848/979 [00:48<00:04, 27.12it/s] 87%|████████▋ | 852/979 [00:48<00:04, 28.18it/s] 87%|████████▋ | 855/979 [00:48<00:05, 24.52it/s] 88%|████████▊ | 858/979 [00:48<00:05, 23.83it/s] 88%|████████▊ | 861/979 [00:49<00:05, 20.90it/s] 88%|████████▊ | 864/979 [00:49<00:06, 16.93it/s] 88%|████████▊ | 866/979 [00:49<00:06, 16.20it/s] 89%|████████▊ | 868/979 [00:49<00:07, 14.60it/s] 89%|████████▉ | 870/979 [00:49<00:07, 14.64it/s] 89%|████████▉ | 872/979 [00:49<00:07, 14.76it/s] 89%|████████▉ | 875/979 [00:50<00:05, 17.98it/s] 90%|████████▉ | 878/979 [00:50<00:05, 19.62it/s] 90%|████████▉ | 881/979 [00:50<00:04, 20.53it/s] 90%|█████████ | 885/979 [00:50<00:04, 23.49it/s] 91%|█████████ | 889/979 [00:50<00:03, 25.76it/s] 91%|█████████ | 892/979 [00:50<00:03, 25.94it/s] 91%|█████████▏| 895/979 [00:50<00:03, 23.26it/s] 92%|█████████▏| 898/979 [00:50<00:03, 20.71it/s] 92%|█████████▏| 901/979 [00:51<00:03, 19.70it/s] 92%|█████████▏| 904/979 [00:51<00:04, 15.37it/s] 93%|█████████▎| 906/979 [00:51<00:05, 13.46it/s] 93%|█████████▎| 908/979 [00:51<00:04, 14.51it/s] 93%|█████████▎| 911/979 [00:51<00:03, 17.22it/s] 93%|█████████▎| 914/979 [00:52<00:03, 19.49it/s] 94%|█████████▎| 917/979 [00:52<00:03, 19.68it/s] 94%|█████████▍| 920/979 [00:52<00:02, 20.58it/s] 94%|█████████▍| 923/979 [00:52<00:02, 22.47it/s] 95%|█████████▍| 926/979 [00:52<00:02, 22.62it/s] 95%|█████████▍| 929/979 [00:52<00:02, 22.86it/s] 95%|█████████▌| 932/979 [00:52<00:02, 18.91it/s] 96%|█████████▌| 935/979 [00:53<00:02, 18.49it/s] 96%|█████████▌| 937/979 [00:53<00:02, 16.89it/s] 96%|█████████▌| 939/979 [00:53<00:02, 15.33it/s] 96%|█████████▌| 941/979 [00:53<00:02, 13.94it/s] 96%|█████████▋| 943/979 [00:53<00:02, 14.91it/s] 97%|█████████▋| 945/979 [00:53<00:02, 15.19it/s] 97%|█████████▋| 947/979 [00:53<00:02, 13.33it/s] 97%|█████████▋| 951/979 [00:54<00:01, 17.98it/s] 98%|█████████▊| 955/979 [00:54<00:01, 21.60it/s] 98%|█████████▊| 959/979 [00:54<00:00, 24.33it/s] 98%|█████████▊| 963/979 [00:54<00:00, 26.14it/s] 99%|█████████▊| 966/979 [00:54<00:00, 26.62it/s] 99%|█████████▉| 970/979 [00:54<00:00, 27.38it/s] 99%|█████████▉| 973/979 [00:54<00:00, 25.90it/s]100%|█████████▉| 976/979 [00:55<00:00, 21.03it/s]100%|██████████| 979/979 [00:55<00:00, 17.67it/s]100%|██████████| 979/979 [00:55<00:00, 17.70it/s]
time :  1336
prob :  1336
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_1_Focal_RS_DRW_seed_41
train data : 14427, disrupt : 227, non-disrupt : 14200
valid data : 3519, disrupt : 57, non-disrupt : 3462
test data : 4062, disrupt : 71, non-disrupt : 3991

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.062, valid loss : 0.020, train f1 : 0.880, valid f1 : 0.708
Best score increase :0.000 -> 0.708
training process - Deferred Re-weighting:   1%|          | 1/128 [04:06<8:40:45, 246.02s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:20<7:32:41, 215.57s/it]Best score increase :0.708 -> 0.878
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:38<7:12:27, 207.58s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:54<6:59:28, 202.98s/it]epoch : 5, train loss : 0.022, valid loss : 0.035, train f1 : 0.956, valid f1 : 0.641
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:54<7:23:44, 216.46s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [21:09<7:05:20, 209.18s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:24<6:52:39, 204.62s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [27:39<6:42:42, 201.35s/it]epoch : 9, train loss : 0.020, valid loss : 0.019, train f1 : 0.959, valid f1 : 0.865
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [31:40<7:03:57, 213.76s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [34:55<6:49:22, 208.15s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [38:10<6:38:04, 204.14s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [41:26<6:29:52, 201.66s/it]epoch : 13, train loss : 0.019, valid loss : 0.041, train f1 : 0.964, valid f1 : 0.690
EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [45:27<6:49:22, 213.58s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [48:42<6:35:01, 207.91s/it]Best score increase :0.878 -> 0.905
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [51:59<6:25:08, 204.50s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [55:29<6:24:48, 206.15s/it]epoch : 17, train loss : 0.016, valid loss : 0.050, train f1 : 0.969, valid f1 : 0.672
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [1:00:14<7:05:32, 230.02s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:03:36<6:45:50, 221.37s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:06:52<6:28:17, 213.74s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:10:07<6:14:51, 208.25s/it]epoch : 21, train loss : 0.017, valid loss : 0.084, train f1 : 0.969, valid f1 : 0.618
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:14:07<6:28:15, 217.71s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:17:23<6:13:14, 211.27s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:20:40<6:01:57, 206.83s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:23:56<5:52:55, 203.61s/it]epoch : 25, train loss : 0.017, valid loss : 0.023, train f1 : 0.971, valid f1 : 0.734
EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:27:57<6:08:57, 214.92s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:31:11<5:54:56, 208.79s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 26, best f1 score : 0.905
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:34:25<6:10:27, 217.92s/it]
training process finished, best loss : 0.012, best acc : 0.993, best f1 : 0.905, best epoch : 14

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.80      0.92      0.86        71
           1       1.00      1.00      1.00      3991

    accuracy                           0.99      4062
   macro avg       0.90      0.96      0.93      4062
weighted avg       1.00      0.99      0.99      4062


# test acc : 0.99, test f1 : 0.93, test AUC : 0.96, test loss : 0.348

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/983 [00:00<?, ?it/s]  0%|          | 2/983 [00:00<01:01, 15.96it/s]  0%|          | 4/983 [00:00<01:03, 15.53it/s]  1%|          | 6/983 [00:00<01:05, 14.88it/s]  1%|          | 8/983 [00:00<01:28, 11.07it/s]  1%|          | 10/983 [00:00<01:31, 10.61it/s]  1%|          | 12/983 [00:01<01:46,  9.09it/s]  1%|▏         | 14/983 [00:01<01:28, 10.93it/s]  2%|▏         | 17/983 [00:01<01:07, 14.34it/s]  2%|▏         | 20/983 [00:01<00:59, 16.17it/s]  2%|▏         | 22/983 [00:01<00:58, 16.42it/s]  3%|▎         | 25/983 [00:01<00:50, 18.86it/s]  3%|▎         | 28/983 [00:01<00:48, 19.76it/s]  3%|▎         | 31/983 [00:02<00:46, 20.61it/s]  3%|▎         | 34/983 [00:02<00:43, 21.95it/s]  4%|▍         | 37/983 [00:02<00:45, 20.73it/s]  4%|▍         | 40/983 [00:02<01:02, 15.13it/s]  4%|▍         | 42/983 [00:02<01:18, 12.04it/s]  4%|▍         | 44/983 [00:03<01:15, 12.40it/s]  5%|▍         | 46/983 [00:03<01:24, 11.07it/s]  5%|▍         | 48/983 [00:03<01:15, 12.39it/s]  5%|▌         | 51/983 [00:03<01:00, 15.36it/s]  5%|▌         | 54/983 [00:03<00:51, 17.94it/s]  6%|▌         | 57/983 [00:03<00:46, 19.99it/s]  6%|▌         | 60/983 [00:03<00:42, 21.70it/s]  6%|▋         | 63/983 [00:03<00:40, 22.95it/s]  7%|▋         | 66/983 [00:04<00:38, 23.90it/s]  7%|▋         | 69/983 [00:04<00:36, 24.81it/s]  7%|▋         | 72/983 [00:04<00:37, 24.44it/s]  8%|▊         | 75/983 [00:04<00:45, 20.14it/s]  8%|▊         | 78/983 [00:04<01:03, 14.28it/s]  8%|▊         | 80/983 [00:05<01:08, 13.12it/s]  8%|▊         | 82/983 [00:05<01:07, 13.29it/s]  9%|▊         | 84/983 [00:05<01:13, 12.21it/s]  9%|▊         | 86/983 [00:05<01:08, 13.07it/s]  9%|▉         | 89/983 [00:05<00:57, 15.63it/s]  9%|▉         | 92/983 [00:05<00:49, 18.06it/s] 10%|▉         | 95/983 [00:05<00:44, 19.97it/s] 10%|▉         | 98/983 [00:06<00:41, 21.11it/s] 10%|█         | 101/983 [00:06<00:39, 22.60it/s] 11%|█         | 104/983 [00:06<00:36, 23.83it/s] 11%|█         | 107/983 [00:06<00:35, 24.79it/s] 11%|█         | 110/983 [00:06<00:36, 23.70it/s] 11%|█▏        | 113/983 [00:06<00:42, 20.28it/s] 12%|█▏        | 116/983 [00:06<00:56, 15.30it/s] 12%|█▏        | 118/983 [00:07<01:02, 13.79it/s] 12%|█▏        | 120/983 [00:07<01:01, 14.09it/s] 12%|█▏        | 122/983 [00:07<01:02, 13.82it/s] 13%|█▎        | 124/983 [00:07<01:02, 13.84it/s] 13%|█▎        | 126/983 [00:07<00:59, 14.40it/s] 13%|█▎        | 129/983 [00:07<00:49, 17.26it/s] 13%|█▎        | 132/983 [00:07<00:43, 19.55it/s] 14%|█▎        | 135/983 [00:08<00:39, 21.27it/s] 14%|█▍        | 138/983 [00:08<00:37, 22.61it/s] 14%|█▍        | 141/983 [00:08<00:35, 23.75it/s] 15%|█▍        | 144/983 [00:08<00:34, 24.62it/s] 15%|█▍        | 147/983 [00:08<00:36, 23.11it/s] 15%|█▌        | 150/983 [00:08<00:50, 16.47it/s] 15%|█▌        | 152/983 [00:09<01:00, 13.68it/s] 16%|█▌        | 154/983 [00:09<01:06, 12.51it/s] 16%|█▌        | 156/983 [00:09<01:20, 10.30it/s] 16%|█▌        | 159/983 [00:09<01:04, 12.77it/s] 16%|█▋        | 162/983 [00:09<00:53, 15.31it/s] 17%|█▋        | 165/983 [00:09<00:46, 17.67it/s] 17%|█▋        | 168/983 [00:10<00:41, 19.84it/s] 17%|█▋        | 171/983 [00:10<00:37, 21.62it/s] 18%|█▊        | 174/983 [00:10<00:34, 23.13it/s] 18%|█▊        | 177/983 [00:10<00:33, 24.07it/s] 18%|█▊        | 180/983 [00:10<00:32, 24.72it/s] 19%|█▊        | 183/983 [00:10<00:33, 23.68it/s] 19%|█▉        | 186/983 [00:10<00:45, 17.57it/s] 19%|█▉        | 189/983 [00:11<00:53, 14.92it/s] 19%|█▉        | 191/983 [00:11<00:53, 14.70it/s] 20%|█▉        | 193/983 [00:11<01:05, 12.12it/s] 20%|█▉        | 196/983 [00:11<00:53, 14.76it/s] 20%|██        | 199/983 [00:11<00:45, 17.15it/s] 21%|██        | 202/983 [00:11<00:40, 19.27it/s] 21%|██        | 205/983 [00:12<00:37, 20.90it/s] 21%|██        | 208/983 [00:12<00:35, 22.04it/s] 21%|██▏       | 211/983 [00:12<00:33, 22.89it/s] 22%|██▏       | 214/983 [00:12<00:32, 23.61it/s] 22%|██▏       | 217/983 [00:12<00:31, 24.17it/s] 22%|██▏       | 220/983 [00:12<00:37, 20.10it/s] 23%|██▎       | 223/983 [00:12<00:44, 16.92it/s] 23%|██▎       | 225/983 [00:13<00:47, 15.84it/s] 23%|██▎       | 227/983 [00:13<00:53, 14.19it/s] 23%|██▎       | 229/983 [00:13<00:52, 14.38it/s] 23%|██▎       | 231/983 [00:13<01:06, 11.36it/s] 24%|██▎       | 233/983 [00:13<01:08, 10.94it/s] 24%|██▍       | 235/983 [00:14<01:01, 12.07it/s] 24%|██▍       | 237/983 [00:14<00:55, 13.50it/s] 24%|██▍       | 240/983 [00:14<00:44, 16.53it/s] 25%|██▍       | 242/983 [00:14<00:43, 17.09it/s] 25%|██▍       | 244/983 [00:14<00:42, 17.54it/s] 25%|██▌       | 247/983 [00:14<00:37, 19.47it/s] 25%|██▌       | 250/983 [00:14<00:35, 20.55it/s] 26%|██▌       | 253/983 [00:14<00:39, 18.48it/s] 26%|██▌       | 255/983 [00:15<00:41, 17.52it/s] 26%|██▌       | 257/983 [00:15<00:42, 17.00it/s] 26%|██▋       | 259/983 [00:15<00:43, 16.55it/s] 27%|██▋       | 261/983 [00:15<00:46, 15.43it/s] 27%|██▋       | 263/983 [00:15<00:47, 15.15it/s] 27%|██▋       | 265/983 [00:15<00:56, 12.61it/s] 27%|██▋       | 267/983 [00:15<00:52, 13.72it/s] 27%|██▋       | 270/983 [00:16<00:42, 16.61it/s] 28%|██▊       | 273/983 [00:16<00:37, 18.85it/s] 28%|██▊       | 276/983 [00:16<00:34, 20.71it/s] 28%|██▊       | 279/983 [00:16<00:31, 22.35it/s] 29%|██▊       | 282/983 [00:16<00:29, 23.77it/s] 29%|██▉       | 285/983 [00:16<00:28, 24.68it/s] 29%|██▉       | 288/983 [00:16<00:27, 25.33it/s] 30%|██▉       | 291/983 [00:16<00:29, 23.34it/s] 30%|██▉       | 294/983 [00:17<00:34, 19.92it/s] 30%|███       | 297/983 [00:17<00:37, 18.38it/s] 30%|███       | 299/983 [00:17<00:38, 17.62it/s] 31%|███       | 301/983 [00:17<00:40, 17.02it/s] 31%|███       | 303/983 [00:17<00:40, 16.66it/s] 31%|███       | 305/983 [00:17<00:45, 14.97it/s] 31%|███       | 307/983 [00:18<00:44, 15.22it/s] 32%|███▏      | 310/983 [00:18<00:37, 17.86it/s] 32%|███▏      | 313/983 [00:18<00:33, 19.83it/s] 32%|███▏      | 316/983 [00:18<00:30, 21.63it/s] 32%|███▏      | 319/983 [00:18<00:28, 23.18it/s] 33%|███▎      | 322/983 [00:18<00:27, 24.35it/s] 33%|███▎      | 325/983 [00:18<00:25, 25.37it/s] 33%|███▎      | 328/983 [00:18<00:25, 26.16it/s] 34%|███▎      | 331/983 [00:18<00:24, 26.13it/s] 34%|███▍      | 334/983 [00:19<00:29, 22.20it/s] 34%|███▍      | 337/983 [00:19<00:31, 20.23it/s] 35%|███▍      | 340/983 [00:19<00:34, 18.50it/s] 35%|███▍      | 342/983 [00:19<00:35, 17.94it/s] 35%|███▌      | 345/983 [00:19<00:34, 18.24it/s] 35%|███▌      | 347/983 [00:19<00:36, 17.38it/s] 36%|███▌      | 349/983 [00:20<00:45, 14.05it/s] 36%|███▌      | 352/983 [00:20<00:39, 16.10it/s] 36%|███▌      | 355/983 [00:20<00:33, 18.57it/s] 36%|███▋      | 358/983 [00:20<00:30, 20.59it/s] 37%|███▋      | 361/983 [00:20<00:27, 22.21it/s] 37%|███▋      | 364/983 [00:20<00:26, 23.34it/s] 37%|███▋      | 367/983 [00:20<00:25, 24.03it/s] 38%|███▊      | 370/983 [00:20<00:24, 24.68it/s] 38%|███▊      | 373/983 [00:21<00:25, 23.92it/s] 38%|███▊      | 376/983 [00:21<00:29, 20.55it/s] 39%|███▊      | 379/983 [00:21<00:33, 18.09it/s] 39%|███▉      | 381/983 [00:21<00:36, 16.55it/s] 39%|███▉      | 383/983 [00:21<00:36, 16.28it/s] 39%|███▉      | 385/983 [00:21<00:37, 16.10it/s] 39%|███▉      | 387/983 [00:22<00:49, 12.07it/s] 40%|███▉      | 389/983 [00:22<00:44, 13.26it/s] 40%|███▉      | 391/983 [00:22<00:41, 14.42it/s] 40%|████      | 394/983 [00:22<00:33, 17.36it/s] 40%|████      | 397/983 [00:22<00:29, 19.79it/s] 41%|████      | 400/983 [00:22<00:26, 21.64it/s] 41%|████      | 403/983 [00:22<00:25, 23.03it/s] 41%|████▏     | 406/983 [00:22<00:24, 23.81it/s] 42%|████▏     | 409/983 [00:23<00:23, 24.68it/s] 42%|████▏     | 412/983 [00:23<00:23, 23.93it/s] 42%|████▏     | 415/983 [00:23<00:27, 20.57it/s] 43%|████▎     | 418/983 [00:23<00:30, 18.71it/s] 43%|████▎     | 420/983 [00:23<00:31, 17.93it/s] 43%|████▎     | 422/983 [00:23<00:32, 17.29it/s] 43%|████▎     | 424/983 [00:23<00:33, 16.80it/s] 43%|████▎     | 426/983 [00:24<00:33, 16.49it/s] 44%|████▎     | 428/983 [00:24<00:37, 14.81it/s] 44%|████▍     | 431/983 [00:24<00:33, 16.48it/s] 44%|████▍     | 434/983 [00:24<00:30, 18.17it/s] 44%|████▍     | 437/983 [00:24<00:27, 20.15it/s] 45%|████▍     | 440/983 [00:24<00:24, 22.00it/s] 45%|████▌     | 443/983 [00:24<00:23, 23.38it/s] 45%|████▌     | 446/983 [00:24<00:21, 24.47it/s] 46%|████▌     | 449/983 [00:25<00:21, 25.30it/s] 46%|████▌     | 452/983 [00:25<00:22, 23.44it/s] 46%|████▋     | 455/983 [00:25<00:24, 21.40it/s] 47%|████▋     | 458/983 [00:25<00:26, 19.93it/s] 47%|████▋     | 461/983 [00:25<00:27, 19.10it/s] 47%|████▋     | 463/983 [00:25<00:28, 18.06it/s] 47%|████▋     | 465/983 [00:26<00:30, 17.25it/s] 48%|████▊     | 467/983 [00:26<00:30, 16.66it/s] 48%|████▊     | 469/983 [00:26<00:32, 15.70it/s] 48%|████▊     | 472/983 [00:26<00:28, 17.79it/s] 48%|████▊     | 475/983 [00:26<00:25, 20.25it/s] 49%|████▊     | 478/983 [00:26<00:22, 22.17it/s] 49%|████▉     | 481/983 [00:26<00:21, 23.58it/s] 49%|████▉     | 484/983 [00:26<00:20, 24.71it/s] 50%|████▉     | 487/983 [00:26<00:19, 25.52it/s] 50%|████▉     | 490/983 [00:27<00:18, 26.10it/s] 50%|█████     | 493/983 [00:27<00:18, 26.70it/s] 50%|█████     | 496/983 [00:27<00:19, 25.16it/s] 51%|█████     | 499/983 [00:27<00:20, 23.44it/s] 51%|█████     | 502/983 [00:27<00:23, 20.47it/s] 51%|█████▏    | 505/983 [00:27<00:25, 18.58it/s] 52%|█████▏    | 507/983 [00:27<00:26, 17.90it/s] 52%|█████▏    | 509/983 [00:28<00:27, 17.38it/s] 52%|█████▏    | 511/983 [00:28<00:28, 16.47it/s] 52%|█████▏    | 513/983 [00:28<00:29, 16.01it/s] 52%|█████▏    | 516/983 [00:28<00:26, 17.68it/s] 53%|█████▎    | 519/983 [00:28<00:23, 19.92it/s] 53%|█████▎    | 522/983 [00:28<00:21, 21.53it/s] 53%|█████▎    | 525/983 [00:28<00:20, 22.87it/s] 54%|█████▎    | 528/983 [00:28<00:18, 24.04it/s] 54%|█████▍    | 531/983 [00:29<00:18, 24.98it/s] 54%|█████▍    | 534/983 [00:29<00:17, 25.74it/s] 55%|█████▍    | 537/983 [00:29<00:20, 21.64it/s] 55%|█████▍    | 540/983 [00:29<00:24, 17.96it/s] 55%|█████▌    | 542/983 [00:29<00:25, 17.24it/s] 55%|█████▌    | 544/983 [00:30<00:34, 12.87it/s] 56%|█████▌    | 546/983 [00:30<00:40, 10.78it/s] 56%|█████▌    | 548/983 [00:30<00:36, 12.02it/s] 56%|█████▌    | 551/983 [00:30<00:28, 15.12it/s] 56%|█████▋    | 554/983 [00:30<00:24, 17.82it/s] 57%|█████▋    | 557/983 [00:30<00:21, 20.00it/s] 57%|█████▋    | 560/983 [00:30<00:19, 22.03it/s] 57%|█████▋    | 563/983 [00:30<00:17, 23.64it/s] 58%|█████▊    | 566/983 [00:31<00:16, 24.84it/s] 58%|█████▊    | 569/983 [00:31<00:15, 25.88it/s] 58%|█████▊    | 572/983 [00:31<00:16, 25.63it/s] 58%|█████▊    | 575/983 [00:31<00:16, 24.10it/s] 59%|█████▉    | 578/983 [00:31<00:19, 21.00it/s] 59%|█████▉    | 581/983 [00:31<00:20, 19.32it/s] 59%|█████▉    | 584/983 [00:31<00:21, 18.21it/s] 60%|█████▉    | 586/983 [00:32<00:22, 17.76it/s] 60%|█████▉    | 588/983 [00:32<00:22, 17.39it/s] 60%|██████    | 590/983 [00:32<00:24, 15.81it/s] 60%|██████    | 592/983 [00:32<00:23, 16.67it/s] 61%|██████    | 595/983 [00:32<00:21, 18.24it/s] 61%|██████    | 598/983 [00:32<00:18, 20.28it/s] 61%|██████    | 601/983 [00:32<00:17, 21.96it/s] 61%|██████▏   | 604/983 [00:32<00:16, 23.28it/s] 62%|██████▏   | 607/983 [00:33<00:16, 22.94it/s] 62%|██████▏   | 610/983 [00:33<00:17, 20.92it/s] 62%|██████▏   | 613/983 [00:33<00:18, 20.20it/s] 63%|██████▎   | 616/983 [00:33<00:20, 17.81it/s] 63%|██████▎   | 618/983 [00:33<00:21, 16.85it/s] 63%|██████▎   | 620/983 [00:34<00:25, 14.11it/s] 63%|██████▎   | 622/983 [00:34<00:25, 14.24it/s] 63%|██████▎   | 624/983 [00:34<00:24, 14.45it/s] 64%|██████▎   | 626/983 [00:34<00:24, 14.66it/s] 64%|██████▍   | 628/983 [00:34<00:22, 15.73it/s] 64%|██████▍   | 631/983 [00:34<00:18, 18.82it/s] 64%|██████▍   | 634/983 [00:34<00:16, 21.19it/s] 65%|██████▍   | 637/983 [00:34<00:15, 22.97it/s] 65%|██████▌   | 640/983 [00:34<00:14, 24.36it/s] 65%|██████▌   | 643/983 [00:35<00:13, 25.23it/s] 66%|██████▌   | 646/983 [00:35<00:13, 25.71it/s] 66%|██████▌   | 649/983 [00:35<00:12, 26.45it/s] 66%|██████▋   | 652/983 [00:35<00:13, 25.44it/s] 67%|██████▋   | 655/983 [00:35<00:15, 21.75it/s] 67%|██████▋   | 658/983 [00:35<00:16, 19.80it/s] 67%|██████▋   | 661/983 [00:35<00:17, 18.68it/s] 67%|██████▋   | 663/983 [00:36<00:17, 18.14it/s] 68%|██████▊   | 665/983 [00:36<00:17, 17.71it/s] 68%|██████▊   | 667/983 [00:36<00:18, 17.38it/s] 68%|██████▊   | 669/983 [00:36<00:18, 16.55it/s] 68%|██████▊   | 672/983 [00:36<00:16, 18.61it/s] 69%|██████▊   | 675/983 [00:36<00:15, 20.16it/s] 69%|██████▉   | 678/983 [00:36<00:13, 22.35it/s] 69%|██████▉   | 681/983 [00:36<00:12, 24.03it/s] 70%|██████▉   | 684/983 [00:37<00:11, 25.29it/s] 70%|██████▉   | 687/983 [00:37<00:11, 26.22it/s] 70%|███████   | 690/983 [00:37<00:10, 27.00it/s] 70%|███████   | 693/983 [00:37<00:10, 27.60it/s] 71%|███████   | 696/983 [00:37<00:10, 26.52it/s] 71%|███████   | 699/983 [00:37<00:13, 21.72it/s] 71%|███████▏  | 702/983 [00:37<00:13, 20.87it/s] 72%|███████▏  | 705/983 [00:37<00:14, 19.64it/s] 72%|███████▏  | 708/983 [00:38<00:14, 18.54it/s] 72%|███████▏  | 710/983 [00:38<00:15, 18.04it/s] 72%|███████▏  | 712/983 [00:38<00:17, 15.45it/s] 73%|███████▎  | 714/983 [00:38<00:17, 15.65it/s] 73%|███████▎  | 717/983 [00:38<00:14, 18.27it/s] 73%|███████▎  | 720/983 [00:38<00:12, 20.34it/s] 74%|███████▎  | 723/983 [00:38<00:11, 21.95it/s] 74%|███████▍  | 726/983 [00:39<00:10, 23.56it/s] 74%|███████▍  | 729/983 [00:39<00:10, 24.89it/s] 74%|███████▍  | 732/983 [00:39<00:09, 25.97it/s] 75%|███████▍  | 735/983 [00:39<00:09, 26.76it/s] 75%|███████▌  | 738/983 [00:39<00:09, 26.51it/s] 75%|███████▌  | 741/983 [00:39<00:09, 25.00it/s] 76%|███████▌  | 744/983 [00:39<00:11, 21.01it/s] 76%|███████▌  | 747/983 [00:39<00:12, 19.28it/s] 76%|███████▋  | 750/983 [00:40<00:12, 18.29it/s] 77%|███████▋  | 752/983 [00:40<00:13, 17.76it/s] 77%|███████▋  | 754/983 [00:40<00:13, 17.34it/s] 77%|███████▋  | 756/983 [00:40<00:13, 16.56it/s] 77%|███████▋  | 759/983 [00:40<00:12, 18.49it/s] 78%|███████▊  | 762/983 [00:40<00:10, 20.92it/s] 78%|███████▊  | 765/983 [00:40<00:09, 22.84it/s] 78%|███████▊  | 768/983 [00:41<00:08, 24.32it/s] 78%|███████▊  | 771/983 [00:41<00:08, 25.36it/s] 79%|███████▊  | 774/983 [00:41<00:07, 26.24it/s] 79%|███████▉  | 777/983 [00:41<00:08, 24.07it/s] 79%|███████▉  | 780/983 [00:41<00:08, 23.74it/s] 80%|███████▉  | 783/983 [00:41<00:08, 22.58it/s] 80%|███████▉  | 786/983 [00:41<00:10, 19.69it/s] 80%|████████  | 789/983 [00:42<00:13, 14.67it/s] 80%|████████  | 791/983 [00:42<00:14, 13.71it/s] 81%|████████  | 793/983 [00:42<00:15, 12.29it/s] 81%|████████  | 795/983 [00:42<00:14, 13.08it/s] 81%|████████  | 798/983 [00:42<00:11, 16.27it/s] 82%|████████▏ | 802/983 [00:42<00:08, 20.26it/s] 82%|████████▏ | 806/983 [00:43<00:07, 23.27it/s] 82%|████████▏ | 809/983 [00:43<00:07, 23.01it/s] 83%|████████▎ | 813/983 [00:43<00:06, 25.18it/s] 83%|████████▎ | 816/983 [00:43<00:06, 26.17it/s] 83%|████████▎ | 820/983 [00:43<00:06, 27.02it/s] 84%|████████▎ | 823/983 [00:43<00:08, 19.90it/s] 84%|████████▍ | 826/983 [00:43<00:08, 19.50it/s] 84%|████████▍ | 829/983 [00:44<00:08, 17.76it/s] 85%|████████▍ | 831/983 [00:44<00:08, 17.96it/s] 85%|████████▍ | 833/983 [00:44<00:08, 18.17it/s] 85%|████████▍ | 835/983 [00:44<00:08, 18.35it/s] 85%|████████▌ | 837/983 [00:44<00:09, 15.82it/s] 85%|████████▌ | 840/983 [00:44<00:07, 18.90it/s] 86%|████████▌ | 844/983 [00:44<00:06, 22.55it/s] 86%|████████▋ | 848/983 [00:45<00:05, 25.18it/s] 87%|████████▋ | 852/983 [00:45<00:04, 26.99it/s] 87%|████████▋ | 856/983 [00:45<00:04, 28.36it/s] 87%|████████▋ | 860/983 [00:45<00:04, 29.11it/s] 88%|████████▊ | 864/983 [00:45<00:03, 29.80it/s] 88%|████████▊ | 868/983 [00:45<00:04, 24.92it/s] 89%|████████▊ | 871/983 [00:45<00:04, 22.95it/s] 89%|████████▉ | 874/983 [00:46<00:05, 21.23it/s] 89%|████████▉ | 877/983 [00:46<00:05, 20.42it/s] 90%|████████▉ | 880/983 [00:46<00:05, 19.81it/s] 90%|████████▉ | 883/983 [00:46<00:05, 18.48it/s] 90%|█████████ | 885/983 [00:46<00:05, 18.52it/s] 90%|█████████ | 888/983 [00:46<00:04, 20.69it/s] 91%|█████████ | 891/983 [00:46<00:04, 21.51it/s] 91%|█████████ | 895/983 [00:47<00:03, 24.43it/s] 91%|█████████▏| 899/983 [00:47<00:03, 26.71it/s] 92%|█████████▏| 903/983 [00:47<00:02, 28.37it/s] 92%|█████████▏| 907/983 [00:47<00:02, 29.32it/s] 93%|█████████▎| 911/983 [00:47<00:02, 30.38it/s] 93%|█████████▎| 915/983 [00:47<00:02, 28.79it/s] 93%|█████████▎| 918/983 [00:47<00:02, 25.53it/s] 94%|█████████▎| 921/983 [00:48<00:02, 23.45it/s] 94%|█████████▍| 924/983 [00:48<00:02, 22.07it/s] 94%|█████████▍| 927/983 [00:48<00:02, 21.14it/s] 95%|█████████▍| 930/983 [00:48<00:02, 20.45it/s] 95%|█████████▍| 933/983 [00:48<00:02, 19.52it/s] 95%|█████████▌| 935/983 [00:48<00:02, 19.41it/s] 95%|█████████▌| 937/983 [00:48<00:02, 19.35it/s] 96%|█████████▌| 940/983 [00:48<00:01, 21.64it/s] 96%|█████████▌| 944/983 [00:49<00:01, 24.88it/s] 96%|█████████▋| 948/983 [00:49<00:01, 27.10it/s] 97%|█████████▋| 952/983 [00:49<00:01, 28.64it/s] 97%|█████████▋| 956/983 [00:49<00:00, 29.68it/s] 98%|█████████▊| 960/983 [00:49<00:00, 29.42it/s] 98%|█████████▊| 963/983 [00:49<00:00, 28.73it/s] 98%|█████████▊| 966/983 [00:49<00:00, 25.34it/s] 99%|█████████▊| 969/983 [00:50<00:00, 23.23it/s] 99%|█████████▉| 972/983 [00:50<00:00, 21.88it/s] 99%|█████████▉| 975/983 [00:50<00:00, 20.98it/s] 99%|█████████▉| 978/983 [00:50<00:00, 20.39it/s]100%|█████████▉| 981/983 [00:50<00:00, 19.48it/s]100%|██████████| 983/983 [00:50<00:00, 19.35it/s]
time :  1340
prob :  1340
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_2_Focal_RS_DRW_seed_41
train data : 14418, disrupt : 227, non-disrupt : 14191
valid data : 3514, disrupt : 57, non-disrupt : 3457
test data : 4058, disrupt : 71, non-disrupt : 3987

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.064, valid loss : 0.065, train f1 : 0.876, valid f1 : 0.578
Best score increase :0.000 -> 0.578
training process - Deferred Re-weighting:   1%|          | 1/128 [03:58<8:24:04, 238.14s/it]Best score increase :0.578 -> 0.635
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:13<7:27:15, 212.98s/it]Best score increase :0.635 -> 0.657
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:29<7:07:16, 205.09s/it]Best score increase :0.657 -> 0.837
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:45<6:56:45, 201.66s/it]epoch : 5, train loss : 0.026, valid loss : 0.025, train f1 : 0.948, valid f1 : 0.681
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:45<7:21:54, 215.57s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [21:01<7:04:22, 208.71s/it]Best score increase :0.837 -> 0.875
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:13<6:49:50, 203.23s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [27:26<6:40:22, 200.19s/it]epoch : 9, train loss : 0.024, valid loss : 0.036, train f1 : 0.955, valid f1 : 0.810
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [31:28<7:02:42, 213.13s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [34:46<6:49:58, 208.46s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [38:00<6:37:44, 203.97s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [41:11<6:26:52, 200.11s/it]epoch : 13, train loss : 0.022, valid loss : 0.031, train f1 : 0.960, valid f1 : 0.670
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [45:13<6:48:04, 212.91s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [48:49<6:45:57, 213.66s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [52:35<6:49:33, 217.47s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [56:07<6:42:53, 215.83s/it]epoch : 17, train loss : 0.021, valid loss : 0.021, train f1 : 0.964, valid f1 : 0.688
EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [1:00:02<6:50:07, 221.69s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:03:20<6:33:15, 214.50s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 18, best f1 score : 0.875
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:06:33<6:46:47, 221.89s/it]
training process finished, best loss : 0.014, best acc : 0.991, best f1 : 0.875, best epoch : 6

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.65      0.87      0.74        71
           1       1.00      0.99      0.99      3987

    accuracy                           0.99      4058
   macro avg       0.82      0.93      0.87      4058
weighted avg       0.99      0.99      0.99      4058


# test acc : 0.99, test f1 : 0.87, test AUC : 0.93, test loss : 0.530

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/982 [00:00<?, ?it/s]  0%|          | 2/982 [00:00<00:49, 19.73it/s]  0%|          | 4/982 [00:00<01:36, 10.11it/s]  1%|          | 6/982 [00:00<01:44,  9.35it/s]  1%|          | 8/982 [00:00<01:40,  9.71it/s]  1%|          | 10/982 [00:01<01:55,  8.42it/s]  1%|▏         | 13/982 [00:01<01:24, 11.51it/s]  2%|▏         | 16/982 [00:01<01:05, 14.79it/s]  2%|▏         | 19/982 [00:01<00:54, 17.73it/s]  2%|▏         | 22/982 [00:01<00:47, 20.32it/s]  3%|▎         | 25/982 [00:01<00:42, 22.31it/s]  3%|▎         | 28/982 [00:01<00:39, 23.87it/s]  3%|▎         | 31/982 [00:01<00:38, 24.95it/s]  3%|▎         | 34/982 [00:01<00:36, 25.74it/s]  4%|▍         | 37/982 [00:02<00:36, 25.84it/s]  4%|▍         | 40/982 [00:02<00:44, 21.39it/s]  4%|▍         | 43/982 [00:02<00:54, 17.17it/s]  5%|▍         | 45/982 [00:02<01:04, 14.49it/s]  5%|▍         | 47/982 [00:02<01:10, 13.29it/s]  5%|▌         | 50/982 [00:03<01:06, 14.04it/s]  5%|▌         | 52/982 [00:03<01:04, 14.40it/s]  6%|▌         | 55/982 [00:03<00:56, 16.52it/s]  6%|▌         | 58/982 [00:03<00:48, 19.04it/s]  6%|▌         | 61/982 [00:03<00:43, 21.35it/s]  7%|▋         | 64/982 [00:03<00:39, 23.29it/s]  7%|▋         | 67/982 [00:03<00:36, 24.79it/s]  7%|▋         | 70/982 [00:03<00:35, 25.90it/s]  7%|▋         | 73/982 [00:04<00:34, 26.56it/s]  8%|▊         | 76/982 [00:04<00:34, 26.01it/s]  8%|▊         | 79/982 [00:04<00:39, 22.82it/s]  8%|▊         | 82/982 [00:04<00:49, 18.04it/s]  9%|▊         | 85/982 [00:04<00:56, 15.92it/s]  9%|▉         | 87/982 [00:04<00:59, 15.12it/s]  9%|▉         | 89/982 [00:05<01:01, 14.52it/s]  9%|▉         | 91/982 [00:05<01:02, 14.33it/s]  9%|▉         | 93/982 [00:05<01:00, 14.79it/s] 10%|▉         | 96/982 [00:05<00:52, 16.74it/s] 10%|█         | 99/982 [00:05<00:46, 18.90it/s] 10%|█         | 102/982 [00:05<00:42, 20.50it/s] 11%|█         | 105/982 [00:05<00:40, 21.42it/s] 11%|█         | 108/982 [00:06<00:41, 21.17it/s] 11%|█▏        | 111/982 [00:06<00:39, 22.05it/s] 12%|█▏        | 114/982 [00:06<00:42, 20.60it/s] 12%|█▏        | 117/982 [00:06<00:52, 16.60it/s] 12%|█▏        | 119/982 [00:06<00:56, 15.34it/s] 12%|█▏        | 121/982 [00:06<01:01, 14.07it/s] 13%|█▎        | 123/982 [00:07<01:05, 13.19it/s] 13%|█▎        | 125/982 [00:07<01:09, 12.33it/s] 13%|█▎        | 127/982 [00:07<01:03, 13.40it/s] 13%|█▎        | 130/982 [00:07<00:51, 16.59it/s] 14%|█▎        | 133/982 [00:07<00:45, 18.86it/s] 14%|█▍        | 136/982 [00:07<00:41, 20.59it/s] 14%|█▍        | 139/982 [00:07<00:37, 22.47it/s] 14%|█▍        | 142/982 [00:07<00:35, 23.82it/s] 15%|█▍        | 145/982 [00:08<00:33, 24.80it/s] 15%|█▌        | 148/982 [00:08<00:32, 25.72it/s] 15%|█▌        | 151/982 [00:08<00:33, 25.02it/s] 16%|█▌        | 154/982 [00:08<00:38, 21.55it/s] 16%|█▌        | 157/982 [00:08<00:54, 15.27it/s] 16%|█▌        | 159/982 [00:09<01:01, 13.40it/s] 16%|█▋        | 161/982 [00:09<01:10, 11.63it/s] 17%|█▋        | 164/982 [00:09<01:00, 13.57it/s] 17%|█▋        | 167/982 [00:09<00:51, 15.79it/s] 17%|█▋        | 170/982 [00:09<00:45, 17.95it/s] 18%|█▊        | 173/982 [00:09<00:40, 19.78it/s] 18%|█▊        | 176/982 [00:09<00:37, 21.25it/s] 18%|█▊        | 179/982 [00:10<00:35, 22.69it/s] 19%|█▊        | 182/982 [00:10<00:33, 23.96it/s] 19%|█▉        | 185/982 [00:10<00:32, 24.73it/s] 19%|█▉        | 188/982 [00:10<00:32, 24.11it/s] 19%|█▉        | 191/982 [00:10<00:38, 20.66it/s] 20%|█▉        | 194/982 [00:10<00:41, 18.80it/s] 20%|██        | 197/982 [00:10<00:47, 16.49it/s] 20%|██        | 199/982 [00:11<00:51, 15.14it/s] 20%|██        | 201/982 [00:11<01:00, 12.94it/s] 21%|██        | 203/982 [00:11<00:57, 13.61it/s] 21%|██        | 206/982 [00:11<00:47, 16.23it/s] 21%|██▏       | 209/982 [00:11<00:41, 18.73it/s] 22%|██▏       | 212/982 [00:11<00:41, 18.69it/s] 22%|██▏       | 215/982 [00:12<00:37, 20.21it/s] 22%|██▏       | 218/982 [00:12<00:34, 21.83it/s] 23%|██▎       | 221/982 [00:12<00:32, 23.22it/s] 23%|██▎       | 224/982 [00:12<00:32, 23.38it/s] 23%|██▎       | 227/982 [00:12<00:33, 22.84it/s] 23%|██▎       | 230/982 [00:12<00:40, 18.45it/s] 24%|██▎       | 233/982 [00:13<00:53, 14.08it/s] 24%|██▍       | 235/982 [00:13<00:54, 13.68it/s] 24%|██▍       | 237/982 [00:13<01:02, 11.86it/s] 24%|██▍       | 239/982 [00:13<00:58, 12.70it/s] 25%|██▍       | 242/982 [00:13<00:47, 15.67it/s] 25%|██▍       | 245/982 [00:13<00:40, 18.32it/s] 25%|██▌       | 248/982 [00:13<00:36, 20.35it/s] 26%|██▌       | 251/982 [00:14<00:33, 21.99it/s] 26%|██▌       | 254/982 [00:14<00:31, 23.30it/s] 26%|██▌       | 257/982 [00:14<00:29, 24.48it/s] 26%|██▋       | 260/982 [00:14<00:29, 24.60it/s] 27%|██▋       | 263/982 [00:14<00:33, 21.70it/s] 27%|██▋       | 266/982 [00:14<00:38, 18.36it/s] 27%|██▋       | 269/982 [00:14<00:40, 17.39it/s] 28%|██▊       | 271/982 [00:15<00:41, 16.93it/s] 28%|██▊       | 273/982 [00:15<00:43, 16.13it/s] 28%|██▊       | 275/982 [00:15<00:51, 13.79it/s] 28%|██▊       | 277/982 [00:15<00:49, 14.13it/s] 29%|██▊       | 280/982 [00:15<00:41, 16.84it/s] 29%|██▉       | 283/982 [00:15<00:36, 18.99it/s] 29%|██▉       | 286/982 [00:15<00:33, 20.61it/s] 29%|██▉       | 289/982 [00:16<00:32, 21.66it/s] 30%|██▉       | 292/982 [00:16<00:30, 22.40it/s] 30%|███       | 295/982 [00:16<00:33, 20.58it/s] 30%|███       | 298/982 [00:16<00:36, 18.96it/s] 31%|███       | 300/982 [00:16<00:38, 17.81it/s] 31%|███       | 302/982 [00:16<00:45, 14.79it/s] 31%|███       | 304/982 [00:17<00:51, 13.13it/s] 31%|███       | 306/982 [00:17<00:55, 12.17it/s] 31%|███▏      | 308/982 [00:17<00:55, 12.20it/s] 32%|███▏      | 310/982 [00:17<01:04, 10.43it/s] 32%|███▏      | 312/982 [00:17<00:56, 11.93it/s] 32%|███▏      | 314/982 [00:17<00:51, 12.95it/s] 32%|███▏      | 317/982 [00:18<00:42, 15.73it/s] 33%|███▎      | 320/982 [00:18<00:35, 18.39it/s] 33%|███▎      | 323/982 [00:18<00:33, 19.38it/s] 33%|███▎      | 326/982 [00:18<00:33, 19.74it/s] 34%|███▎      | 329/982 [00:18<00:33, 19.39it/s] 34%|███▎      | 331/982 [00:18<00:37, 17.22it/s] 34%|███▍      | 333/982 [00:19<00:44, 14.61it/s] 34%|███▍      | 335/982 [00:19<00:54, 11.89it/s] 34%|███▍      | 337/982 [00:19<00:57, 11.24it/s] 35%|███▍      | 339/982 [00:19<01:01, 10.53it/s] 35%|███▍      | 341/982 [00:19<00:55, 11.63it/s] 35%|███▌      | 344/982 [00:19<00:44, 14.46it/s] 35%|███▌      | 347/982 [00:20<00:37, 17.03it/s] 36%|███▌      | 350/982 [00:20<00:33, 19.15it/s] 36%|███▌      | 353/982 [00:20<00:30, 20.82it/s] 36%|███▋      | 356/982 [00:20<00:28, 21.90it/s] 37%|███▋      | 359/982 [00:20<00:27, 22.60it/s] 37%|███▋      | 362/982 [00:20<00:31, 19.61it/s] 37%|███▋      | 365/982 [00:20<00:33, 18.35it/s] 37%|███▋      | 367/982 [00:21<00:35, 17.53it/s] 38%|███▊      | 369/982 [00:21<00:36, 16.91it/s] 38%|███▊      | 371/982 [00:21<00:36, 16.58it/s] 38%|███▊      | 373/982 [00:21<00:37, 16.33it/s] 38%|███▊      | 375/982 [00:21<00:37, 16.15it/s] 38%|███▊      | 377/982 [00:21<00:37, 16.02it/s] 39%|███▊      | 379/982 [00:21<00:39, 15.21it/s] 39%|███▉      | 382/982 [00:21<00:35, 17.01it/s] 39%|███▉      | 385/982 [00:22<00:31, 18.82it/s] 40%|███▉      | 388/982 [00:22<00:28, 21.21it/s] 40%|███▉      | 391/982 [00:22<00:25, 23.21it/s] 40%|████      | 394/982 [00:22<00:23, 24.57it/s] 40%|████      | 397/982 [00:22<00:22, 25.65it/s] 41%|████      | 400/982 [00:22<00:21, 26.50it/s] 41%|████      | 403/982 [00:22<00:21, 27.06it/s] 41%|████▏     | 406/982 [00:22<00:22, 25.44it/s] 42%|████▏     | 409/982 [00:23<00:26, 21.43it/s] 42%|████▏     | 412/982 [00:23<00:29, 19.44it/s] 42%|████▏     | 415/982 [00:23<00:34, 16.59it/s] 42%|████▏     | 417/982 [00:23<00:34, 16.37it/s] 43%|████▎     | 419/982 [00:23<00:36, 15.52it/s] 43%|████▎     | 421/982 [00:23<00:40, 13.75it/s] 43%|████▎     | 424/982 [00:24<00:33, 16.64it/s] 43%|████▎     | 427/982 [00:24<00:28, 19.29it/s] 44%|████▍     | 430/982 [00:24<00:25, 21.56it/s] 44%|████▍     | 433/982 [00:24<00:23, 23.34it/s] 44%|████▍     | 436/982 [00:24<00:22, 24.74it/s] 45%|████▍     | 439/982 [00:24<00:21, 25.81it/s] 45%|████▌     | 442/982 [00:24<00:20, 26.43it/s] 45%|████▌     | 445/982 [00:24<00:19, 27.03it/s] 46%|████▌     | 448/982 [00:24<00:20, 26.22it/s] 46%|████▌     | 451/982 [00:25<00:23, 22.13it/s] 46%|████▌     | 454/982 [00:25<00:27, 19.16it/s] 47%|████▋     | 457/982 [00:25<00:28, 18.59it/s] 47%|████▋     | 459/982 [00:25<00:28, 18.41it/s] 47%|████▋     | 461/982 [00:25<00:30, 16.89it/s] 47%|████▋     | 463/982 [00:26<00:39, 13.26it/s] 47%|████▋     | 465/982 [00:26<00:36, 14.00it/s] 48%|████▊     | 468/982 [00:26<00:31, 16.17it/s] 48%|████▊     | 471/982 [00:26<00:27, 18.43it/s] 48%|████▊     | 474/982 [00:26<00:25, 20.18it/s] 49%|████▊     | 477/982 [00:26<00:22, 21.96it/s] 49%|████▉     | 480/982 [00:26<00:21, 23.67it/s] 49%|████▉     | 483/982 [00:26<00:19, 24.97it/s] 49%|████▉     | 486/982 [00:26<00:19, 25.94it/s] 50%|████▉     | 489/982 [00:27<00:19, 25.40it/s] 50%|█████     | 492/982 [00:27<00:24, 19.93it/s] 50%|█████     | 495/982 [00:27<00:28, 17.02it/s] 51%|█████     | 497/982 [00:27<00:28, 16.74it/s] 51%|█████     | 499/982 [00:27<00:29, 16.54it/s] 51%|█████     | 501/982 [00:27<00:29, 16.37it/s] 51%|█████     | 503/982 [00:28<00:30, 15.65it/s] 51%|█████▏    | 505/982 [00:28<00:30, 15.63it/s] 52%|█████▏    | 508/982 [00:28<00:25, 18.58it/s] 52%|█████▏    | 511/982 [00:28<00:22, 20.93it/s] 52%|█████▏    | 514/982 [00:28<00:20, 22.78it/s] 53%|█████▎    | 517/982 [00:28<00:19, 24.29it/s] 53%|█████▎    | 520/982 [00:28<00:18, 25.36it/s] 53%|█████▎    | 523/982 [00:28<00:17, 26.11it/s] 54%|█████▎    | 526/982 [00:28<00:17, 26.70it/s] 54%|█████▍    | 529/982 [00:29<00:17, 26.28it/s] 54%|█████▍    | 532/982 [00:29<00:19, 22.80it/s] 54%|█████▍    | 535/982 [00:29<00:24, 18.24it/s] 55%|█████▍    | 538/982 [00:29<00:27, 16.20it/s] 55%|█████▍    | 540/982 [00:29<00:31, 13.86it/s] 55%|█████▌    | 542/982 [00:30<00:38, 11.54it/s] 55%|█████▌    | 544/982 [00:30<00:34, 12.63it/s] 56%|█████▌    | 547/982 [00:30<00:28, 15.30it/s] 56%|█████▌    | 550/982 [00:30<00:24, 17.83it/s] 56%|█████▋    | 553/982 [00:30<00:21, 20.34it/s] 57%|█████▋    | 556/982 [00:30<00:18, 22.44it/s] 57%|█████▋    | 559/982 [00:30<00:17, 24.02it/s] 57%|█████▋    | 562/982 [00:30<00:16, 25.42it/s] 58%|█████▊    | 565/982 [00:31<00:15, 26.55it/s] 58%|█████▊    | 568/982 [00:31<00:15, 26.21it/s] 58%|█████▊    | 571/982 [00:31<00:17, 23.41it/s] 58%|█████▊    | 574/982 [00:31<00:19, 20.77it/s] 59%|█████▉    | 577/982 [00:31<00:23, 17.41it/s] 59%|█████▉    | 579/982 [00:31<00:27, 14.44it/s] 59%|█████▉    | 581/982 [00:32<00:27, 14.49it/s] 59%|█████▉    | 583/982 [00:32<00:30, 12.96it/s] 60%|█████▉    | 586/982 [00:32<00:25, 15.70it/s] 60%|█████▉    | 589/982 [00:32<00:21, 18.17it/s] 60%|██████    | 592/982 [00:32<00:19, 20.21it/s] 61%|██████    | 595/982 [00:32<00:17, 22.23it/s] 61%|██████    | 598/982 [00:32<00:16, 23.97it/s] 61%|██████    | 601/982 [00:32<00:15, 25.25it/s] 62%|██████▏   | 604/982 [00:33<00:14, 26.35it/s] 62%|██████▏   | 607/982 [00:33<00:13, 27.20it/s] 62%|██████▏   | 610/982 [00:33<00:14, 25.99it/s] 62%|██████▏   | 613/982 [00:33<00:20, 17.76it/s] 63%|██████▎   | 616/982 [00:33<00:26, 14.06it/s] 63%|██████▎   | 618/982 [00:34<00:27, 13.42it/s] 63%|██████▎   | 620/982 [00:34<00:29, 12.38it/s] 63%|██████▎   | 622/982 [00:34<00:26, 13.42it/s] 64%|██████▎   | 625/982 [00:34<00:22, 15.97it/s] 64%|██████▍   | 628/982 [00:34<00:19, 18.36it/s] 64%|██████▍   | 631/982 [00:34<00:17, 20.30it/s] 65%|██████▍   | 634/982 [00:34<00:15, 22.24it/s] 65%|██████▍   | 637/982 [00:34<00:14, 23.90it/s] 65%|██████▌   | 640/982 [00:35<00:13, 25.32it/s] 65%|██████▌   | 643/982 [00:35<00:12, 26.39it/s] 66%|██████▌   | 646/982 [00:35<00:12, 26.63it/s] 66%|██████▌   | 649/982 [00:35<00:14, 23.55it/s] 66%|██████▋   | 652/982 [00:35<00:16, 20.53it/s] 67%|██████▋   | 655/982 [00:35<00:17, 18.30it/s] 67%|██████▋   | 657/982 [00:35<00:20, 16.22it/s] 67%|██████▋   | 659/982 [00:36<00:22, 14.08it/s] 67%|██████▋   | 661/982 [00:36<00:25, 12.59it/s] 68%|██████▊   | 664/982 [00:36<00:21, 14.81it/s] 68%|██████▊   | 667/982 [00:36<00:18, 17.36it/s] 68%|██████▊   | 670/982 [00:36<00:15, 19.52it/s] 69%|██████▊   | 673/982 [00:36<00:14, 21.27it/s] 69%|██████▉   | 676/982 [00:36<00:13, 22.64it/s] 69%|██████▉   | 679/982 [00:37<00:14, 21.15it/s] 69%|██████▉   | 682/982 [00:37<00:13, 21.80it/s] 70%|██████▉   | 685/982 [00:37<00:13, 21.69it/s] 70%|███████   | 688/982 [00:37<00:17, 16.42it/s] 70%|███████   | 690/982 [00:37<00:19, 15.19it/s] 70%|███████   | 692/982 [00:38<00:20, 14.49it/s] 71%|███████   | 694/982 [00:38<00:21, 13.10it/s] 71%|███████   | 696/982 [00:38<00:22, 12.61it/s] 71%|███████   | 698/982 [00:38<00:21, 13.15it/s] 71%|███████▏  | 700/982 [00:38<00:19, 14.21it/s] 72%|███████▏  | 703/982 [00:38<00:16, 16.85it/s] 72%|███████▏  | 706/982 [00:38<00:14, 19.21it/s] 72%|███████▏  | 709/982 [00:38<00:12, 21.34it/s] 73%|███████▎  | 712/982 [00:39<00:11, 23.30it/s] 73%|███████▎  | 715/982 [00:39<00:10, 24.90it/s] 73%|███████▎  | 718/982 [00:39<00:10, 26.12it/s] 73%|███████▎  | 721/982 [00:39<00:09, 26.40it/s] 74%|███████▎  | 724/982 [00:39<00:10, 24.56it/s] 74%|███████▍  | 727/982 [00:39<00:11, 21.35it/s] 74%|███████▍  | 730/982 [00:39<00:12, 19.59it/s] 75%|███████▍  | 733/982 [00:40<00:14, 17.49it/s] 75%|███████▍  | 735/982 [00:40<00:16, 15.28it/s] 75%|███████▌  | 737/982 [00:40<00:16, 14.75it/s] 75%|███████▌  | 739/982 [00:40<00:15, 15.54it/s] 75%|███████▌  | 741/982 [00:40<00:14, 16.42it/s] 76%|███████▌  | 744/982 [00:40<00:12, 19.35it/s] 76%|███████▌  | 747/982 [00:40<00:10, 21.64it/s] 76%|███████▋  | 750/982 [00:41<00:09, 23.45it/s] 77%|███████▋  | 753/982 [00:41<00:09, 24.83it/s] 77%|███████▋  | 756/982 [00:41<00:08, 25.67it/s] 77%|███████▋  | 759/982 [00:41<00:09, 22.59it/s] 78%|███████▊  | 762/982 [00:41<00:10, 20.74it/s] 78%|███████▊  | 765/982 [00:41<00:11, 18.85it/s] 78%|███████▊  | 767/982 [00:41<00:11, 18.01it/s] 78%|███████▊  | 769/982 [00:42<00:12, 17.35it/s] 79%|███████▊  | 771/982 [00:42<00:12, 16.82it/s] 79%|███████▊  | 773/982 [00:42<00:12, 16.43it/s] 79%|███████▉  | 775/982 [00:42<00:12, 16.20it/s] 79%|███████▉  | 777/982 [00:42<00:13, 14.73it/s] 79%|███████▉  | 780/982 [00:42<00:12, 16.46it/s] 80%|███████▉  | 783/982 [00:42<00:10, 18.40it/s] 80%|████████  | 786/982 [00:42<00:09, 20.56it/s] 80%|████████  | 789/982 [00:43<00:08, 22.44it/s] 81%|████████  | 792/982 [00:43<00:07, 24.00it/s] 81%|████████  | 795/982 [00:43<00:07, 25.29it/s] 81%|████████▏ | 798/982 [00:43<00:07, 26.27it/s] 82%|████████▏ | 801/982 [00:43<00:06, 25.96it/s] 82%|████████▏ | 804/982 [00:43<00:08, 20.76it/s] 82%|████████▏ | 807/982 [00:43<00:09, 18.37it/s] 82%|████████▏ | 810/982 [00:44<00:10, 16.53it/s] 83%|████████▎ | 812/982 [00:44<00:10, 16.32it/s] 83%|████████▎ | 815/982 [00:44<00:09, 17.43it/s] 83%|████████▎ | 817/982 [00:44<00:10, 16.16it/s] 83%|████████▎ | 819/982 [00:44<00:10, 15.99it/s] 84%|████████▎ | 822/982 [00:44<00:08, 18.15it/s] 84%|████████▍ | 825/982 [00:44<00:07, 20.77it/s] 84%|████████▍ | 828/982 [00:45<00:06, 22.93it/s] 85%|████████▍ | 831/982 [00:45<00:06, 24.35it/s] 85%|████████▍ | 834/982 [00:45<00:05, 25.64it/s] 85%|████████▌ | 837/982 [00:45<00:05, 26.56it/s] 86%|████████▌ | 840/982 [00:45<00:05, 27.00it/s] 86%|████████▌ | 843/982 [00:45<00:05, 26.87it/s] 86%|████████▌ | 846/982 [00:45<00:05, 25.12it/s] 86%|████████▋ | 849/982 [00:45<00:06, 20.67it/s] 87%|████████▋ | 852/982 [00:46<00:07, 17.26it/s] 87%|████████▋ | 854/982 [00:46<00:07, 16.51it/s] 87%|████████▋ | 856/982 [00:46<00:08, 15.66it/s] 87%|████████▋ | 858/982 [00:46<00:09, 12.90it/s] 88%|████████▊ | 861/982 [00:46<00:07, 15.44it/s] 88%|████████▊ | 864/982 [00:46<00:06, 18.32it/s] 88%|████████▊ | 868/982 [00:47<00:05, 21.99it/s] 89%|████████▉ | 872/982 [00:47<00:04, 24.88it/s] 89%|████████▉ | 876/982 [00:47<00:03, 27.12it/s] 90%|████████▉ | 880/982 [00:47<00:03, 28.81it/s] 90%|█████████ | 884/982 [00:47<00:03, 30.04it/s] 90%|█████████ | 888/982 [00:47<00:03, 30.94it/s] 91%|█████████ | 892/982 [00:47<00:03, 26.56it/s] 91%|█████████ | 895/982 [00:48<00:03, 21.84it/s] 91%|█████████▏| 898/982 [00:48<00:04, 19.96it/s] 92%|█████████▏| 901/982 [00:48<00:04, 19.15it/s] 92%|█████████▏| 904/982 [00:48<00:04, 17.73it/s] 92%|█████████▏| 906/982 [00:48<00:04, 16.73it/s] 93%|█████████▎| 909/982 [00:48<00:04, 18.13it/s] 93%|█████████▎| 912/982 [00:48<00:03, 20.02it/s] 93%|█████████▎| 916/982 [00:49<00:02, 23.38it/s] 94%|█████████▎| 920/982 [00:49<00:02, 25.17it/s] 94%|█████████▍| 923/982 [00:49<00:02, 25.47it/s] 94%|█████████▍| 926/982 [00:49<00:02, 24.49it/s] 95%|█████████▍| 929/982 [00:49<00:02, 23.90it/s] 95%|█████████▍| 932/982 [00:49<00:02, 23.40it/s] 95%|█████████▌| 935/982 [00:49<00:02, 19.39it/s] 96%|█████████▌| 938/982 [00:50<00:02, 16.80it/s] 96%|█████████▌| 940/982 [00:50<00:02, 16.61it/s] 96%|█████████▌| 942/982 [00:50<00:02, 16.08it/s] 96%|█████████▌| 944/982 [00:50<00:02, 15.69it/s] 96%|█████████▋| 946/982 [00:50<00:02, 15.63it/s] 97%|█████████▋| 949/982 [00:50<00:01, 17.42it/s] 97%|█████████▋| 952/982 [00:50<00:01, 19.22it/s] 97%|█████████▋| 955/982 [00:51<00:01, 21.61it/s] 98%|█████████▊| 958/982 [00:51<00:01, 23.61it/s] 98%|█████████▊| 961/982 [00:51<00:00, 25.21it/s] 98%|█████████▊| 964/982 [00:51<00:00, 26.34it/s] 98%|█████████▊| 967/982 [00:51<00:00, 27.19it/s] 99%|█████████▉| 970/982 [00:51<00:00, 27.75it/s] 99%|█████████▉| 973/982 [00:51<00:00, 26.04it/s] 99%|█████████▉| 976/982 [00:51<00:00, 19.78it/s]100%|█████████▉| 979/982 [00:52<00:00, 18.08it/s]100%|██████████| 982/982 [00:52<00:00, 16.58it/s]100%|██████████| 982/982 [00:52<00:00, 18.74it/s]
time :  1339
prob :  1339
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_3_Focal_RS_DRW_seed_41
train data : 14410, disrupt : 227, non-disrupt : 14183
valid data : 3512, disrupt : 57, non-disrupt : 3455
test data : 4053, disrupt : 71, non-disrupt : 3982

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.087, valid loss : 0.038, train f1 : 0.834, valid f1 : 0.626
Best score increase :0.000 -> 0.626
training process - Deferred Re-weighting:   1%|          | 1/128 [04:01<8:30:07, 241.01s/it]Best score increase :0.626 -> 0.788
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:10<7:22:07, 210.53s/it]Best score increase :0.788 -> 0.830
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:24<7:03:20, 203.21s/it]Best score increase :0.830 -> 0.889
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:37<6:51:35, 199.16s/it]epoch : 5, train loss : 0.033, valid loss : 0.026, train f1 : 0.945, valid f1 : 0.794
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:40<7:20:32, 214.90s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:51<7:00:28, 206.79s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:08<6:50:39, 203.63s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [27:20<6:39:42, 199.85s/it]epoch : 9, train loss : 0.030, valid loss : 0.017, train f1 : 0.950, valid f1 : 0.731
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [31:16<6:58:54, 211.22s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [34:30<6:44:59, 205.93s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [37:46<6:35:17, 202.71s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [40:58<6:25:35, 199.44s/it]epoch : 13, train loss : 0.028, valid loss : 0.052, train f1 : 0.953, valid f1 : 0.595
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [44:56<6:44:39, 211.13s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [48:10<6:31:15, 205.93s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [51:22<6:20:20, 201.95s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 15, best f1 score : 0.889
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [54:32<6:50:51, 218.16s/it]
training process finished, best loss : 0.014, best acc : 0.993, best f1 : 0.889, best epoch : 3

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.76      0.87      0.81        71
           1       1.00      0.99      1.00      3982

    accuracy                           0.99      4053
   macro avg       0.88      0.93      0.90      4053
weighted avg       0.99      0.99      0.99      4053


# test acc : 0.99, test f1 : 0.90, test AUC : 0.93, test loss : 0.473

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<01:04, 15.16it/s]  0%|          | 4/981 [00:00<01:03, 15.28it/s]  1%|          | 6/981 [00:00<00:59, 16.42it/s]  1%|          | 9/981 [00:00<00:49, 19.49it/s]  1%|          | 12/981 [00:00<00:44, 21.82it/s]  2%|▏         | 15/981 [00:00<00:41, 23.35it/s]  2%|▏         | 18/981 [00:00<00:39, 24.38it/s]  2%|▏         | 21/981 [00:00<00:38, 24.99it/s]  2%|▏         | 24/981 [00:01<00:43, 22.06it/s]  3%|▎         | 27/981 [00:01<00:45, 21.17it/s]  3%|▎         | 30/981 [00:01<00:52, 18.06it/s]  3%|▎         | 32/981 [00:01<01:00, 15.69it/s]  3%|▎         | 34/981 [00:01<01:06, 14.34it/s]  4%|▎         | 36/981 [00:02<01:07, 14.04it/s]  4%|▍         | 38/981 [00:02<01:10, 13.47it/s]  4%|▍         | 40/981 [00:02<01:07, 13.91it/s]  4%|▍         | 43/981 [00:02<00:57, 16.24it/s]  5%|▍         | 46/981 [00:02<00:49, 18.77it/s]  5%|▍         | 49/981 [00:02<00:44, 20.84it/s]  5%|▌         | 52/981 [00:02<00:41, 22.42it/s]  6%|▌         | 55/981 [00:02<00:39, 23.50it/s]  6%|▌         | 58/981 [00:03<00:37, 24.47it/s]  6%|▌         | 61/981 [00:03<00:38, 24.16it/s]  7%|▋         | 64/981 [00:03<00:49, 18.62it/s]  7%|▋         | 67/981 [00:03<01:11, 12.81it/s]  7%|▋         | 69/981 [00:03<01:15, 12.06it/s]  7%|▋         | 71/981 [00:04<01:16, 11.83it/s]  7%|▋         | 73/981 [00:04<01:09, 12.99it/s]  8%|▊         | 76/981 [00:04<00:57, 15.79it/s]  8%|▊         | 79/981 [00:04<00:50, 18.03it/s]  8%|▊         | 82/981 [00:04<00:46, 19.41it/s]  9%|▊         | 85/981 [00:04<00:42, 21.13it/s]  9%|▉         | 88/981 [00:04<00:39, 22.56it/s]  9%|▉         | 91/981 [00:04<00:37, 23.66it/s] 10%|▉         | 94/981 [00:05<00:35, 24.69it/s] 10%|▉         | 97/981 [00:05<00:35, 24.87it/s] 10%|█         | 100/981 [00:05<00:45, 19.46it/s] 10%|█         | 103/981 [00:05<00:44, 19.88it/s] 11%|█         | 106/981 [00:05<00:42, 20.58it/s] 11%|█         | 109/981 [00:05<00:41, 21.04it/s] 11%|█▏        | 112/981 [00:06<00:46, 18.74it/s] 12%|█▏        | 114/981 [00:06<00:55, 15.66it/s] 12%|█▏        | 116/981 [00:06<00:54, 15.74it/s] 12%|█▏        | 119/981 [00:06<00:48, 17.60it/s] 12%|█▏        | 122/981 [00:06<00:43, 19.61it/s] 13%|█▎        | 125/981 [00:06<00:40, 21.17it/s] 13%|█▎        | 128/981 [00:06<00:38, 22.43it/s] 13%|█▎        | 131/981 [00:06<00:36, 23.57it/s] 14%|█▎        | 134/981 [00:07<00:34, 24.43it/s] 14%|█▍        | 137/981 [00:07<00:33, 25.05it/s] 14%|█▍        | 140/981 [00:07<00:39, 21.31it/s] 15%|█▍        | 143/981 [00:07<00:54, 15.25it/s] 15%|█▍        | 145/981 [00:07<01:03, 13.18it/s] 15%|█▍        | 147/981 [00:08<01:03, 13.15it/s] 15%|█▌        | 149/981 [00:08<01:01, 13.58it/s] 15%|█▌        | 151/981 [00:08<01:01, 13.58it/s] 16%|█▌        | 153/981 [00:08<00:59, 14.00it/s] 16%|█▌        | 156/981 [00:08<00:49, 16.56it/s] 16%|█▌        | 159/981 [00:08<00:43, 18.96it/s] 17%|█▋        | 162/981 [00:08<00:39, 20.94it/s] 17%|█▋        | 165/981 [00:08<00:36, 22.53it/s] 17%|█▋        | 168/981 [00:09<00:34, 23.71it/s] 17%|█▋        | 171/981 [00:09<00:32, 24.66it/s] 18%|█▊        | 174/981 [00:09<00:33, 24.41it/s] 18%|█▊        | 177/981 [00:09<00:38, 20.80it/s] 18%|█▊        | 180/981 [00:09<00:54, 14.58it/s] 19%|█▊        | 182/981 [00:10<01:07, 11.91it/s] 19%|█▉        | 184/981 [00:10<01:15, 10.61it/s] 19%|█▉        | 186/981 [00:10<01:05, 12.05it/s] 19%|█▉        | 189/981 [00:10<00:54, 14.51it/s] 19%|█▉        | 191/981 [00:10<00:53, 14.66it/s] 20%|█▉        | 193/981 [00:10<00:57, 13.72it/s] 20%|█▉        | 195/981 [00:11<00:58, 13.39it/s] 20%|██        | 197/981 [00:11<01:02, 12.49it/s] 20%|██        | 199/981 [00:11<01:09, 11.24it/s] 20%|██        | 201/981 [00:11<01:07, 11.62it/s] 21%|██        | 204/981 [00:11<00:54, 14.32it/s] 21%|██        | 207/981 [00:11<00:45, 16.98it/s] 21%|██▏       | 210/981 [00:11<00:40, 19.25it/s] 22%|██▏       | 213/981 [00:12<00:36, 20.96it/s] 22%|██▏       | 216/981 [00:12<00:34, 22.19it/s] 22%|██▏       | 219/981 [00:12<00:32, 23.23it/s] 23%|██▎       | 222/981 [00:12<00:33, 22.93it/s] 23%|██▎       | 225/981 [00:12<00:40, 18.65it/s] 23%|██▎       | 228/981 [00:12<00:41, 18.06it/s] 23%|██▎       | 230/981 [00:13<00:43, 17.42it/s] 24%|██▎       | 232/981 [00:13<00:44, 16.87it/s] 24%|██▍       | 234/981 [00:13<00:45, 16.30it/s] 24%|██▍       | 236/981 [00:13<00:53, 13.97it/s] 24%|██▍       | 238/981 [00:13<00:50, 14.71it/s] 25%|██▍       | 241/981 [00:13<00:42, 17.43it/s] 25%|██▍       | 243/981 [00:13<00:44, 16.72it/s] 25%|██▍       | 245/981 [00:13<00:46, 15.98it/s] 25%|██▌       | 247/981 [00:14<00:48, 14.99it/s] 25%|██▌       | 249/981 [00:14<00:54, 13.40it/s] 26%|██▌       | 251/981 [00:14<01:01, 11.91it/s] 26%|██▌       | 253/981 [00:14<01:02, 11.71it/s] 26%|██▌       | 255/981 [00:14<00:58, 12.45it/s] 26%|██▋       | 258/981 [00:15<00:48, 14.83it/s] 27%|██▋       | 260/981 [00:15<00:45, 15.75it/s] 27%|██▋       | 263/981 [00:15<00:40, 17.92it/s] 27%|██▋       | 266/981 [00:15<00:35, 19.97it/s] 27%|██▋       | 269/981 [00:15<00:33, 21.19it/s] 28%|██▊       | 272/981 [00:15<00:37, 18.66it/s] 28%|██▊       | 274/981 [00:15<00:37, 18.71it/s] 28%|██▊       | 276/981 [00:15<00:37, 18.76it/s] 28%|██▊       | 278/981 [00:16<00:41, 17.14it/s] 29%|██▊       | 280/981 [00:16<00:42, 16.58it/s] 29%|██▉       | 283/981 [00:16<00:38, 18.36it/s] 29%|██▉       | 285/981 [00:16<00:38, 17.93it/s] 29%|██▉       | 287/981 [00:16<00:41, 16.68it/s] 30%|██▉       | 290/981 [00:16<00:37, 18.56it/s] 30%|██▉       | 293/981 [00:16<00:33, 20.82it/s] 30%|███       | 296/981 [00:16<00:30, 22.37it/s] 30%|███       | 299/981 [00:17<00:29, 23.37it/s] 31%|███       | 302/981 [00:17<00:28, 24.19it/s] 31%|███       | 305/981 [00:17<00:27, 24.78it/s] 31%|███▏      | 308/981 [00:17<00:26, 25.25it/s] 32%|███▏      | 311/981 [00:17<00:26, 25.01it/s] 32%|███▏      | 314/981 [00:17<00:29, 22.29it/s] 32%|███▏      | 317/981 [00:17<00:41, 16.01it/s] 33%|███▎      | 319/981 [00:18<00:51, 12.86it/s] 33%|███▎      | 321/981 [00:18<00:56, 11.74it/s] 33%|███▎      | 323/981 [00:18<00:56, 11.62it/s] 33%|███▎      | 326/981 [00:18<00:46, 14.03it/s] 34%|███▎      | 329/981 [00:18<00:40, 16.22it/s] 34%|███▍      | 332/981 [00:19<00:35, 18.26it/s] 34%|███▍      | 335/981 [00:19<00:32, 20.10it/s] 34%|███▍      | 338/981 [00:19<00:29, 21.72it/s] 35%|███▍      | 341/981 [00:19<00:27, 22.88it/s] 35%|███▌      | 344/981 [00:19<00:26, 23.80it/s] 35%|███▌      | 347/981 [00:19<00:27, 23.48it/s] 36%|███▌      | 350/981 [00:19<00:31, 20.10it/s] 36%|███▌      | 353/981 [00:20<00:39, 16.04it/s] 36%|███▌      | 355/981 [00:20<00:45, 13.90it/s] 36%|███▋      | 357/981 [00:20<00:50, 12.41it/s] 37%|███▋      | 359/981 [00:20<00:52, 11.80it/s] 37%|███▋      | 361/981 [00:20<00:51, 12.02it/s] 37%|███▋      | 363/981 [00:20<00:46, 13.42it/s] 37%|███▋      | 366/981 [00:21<00:38, 15.78it/s] 38%|███▊      | 369/981 [00:21<00:33, 18.25it/s] 38%|███▊      | 372/981 [00:21<00:30, 20.27it/s] 38%|███▊      | 375/981 [00:21<00:27, 21.82it/s] 39%|███▊      | 378/981 [00:21<00:27, 22.01it/s] 39%|███▉      | 381/981 [00:21<00:32, 18.73it/s] 39%|███▉      | 384/981 [00:22<00:46, 12.79it/s] 39%|███▉      | 386/981 [00:22<00:51, 11.66it/s] 40%|███▉      | 388/981 [00:22<00:53, 11.02it/s] 40%|███▉      | 390/981 [00:22<00:49, 12.03it/s] 40%|████      | 393/981 [00:22<00:39, 14.84it/s] 40%|████      | 396/981 [00:22<00:33, 17.25it/s] 41%|████      | 399/981 [00:23<00:30, 19.35it/s] 41%|████      | 402/981 [00:23<00:27, 21.07it/s] 41%|████▏     | 405/981 [00:23<00:25, 22.56it/s] 42%|████▏     | 408/981 [00:23<00:24, 23.70it/s] 42%|████▏     | 411/981 [00:23<00:23, 24.58it/s] 42%|████▏     | 414/981 [00:23<00:23, 24.25it/s] 43%|████▎     | 417/981 [00:23<00:32, 17.30it/s] 43%|████▎     | 420/981 [00:24<00:39, 14.31it/s] 43%|████▎     | 422/981 [00:24<00:41, 13.39it/s] 43%|████▎     | 424/981 [00:24<00:48, 11.47it/s] 43%|████▎     | 426/981 [00:24<00:43, 12.84it/s] 44%|████▎     | 428/981 [00:24<00:41, 13.37it/s] 44%|████▍     | 431/981 [00:25<00:34, 16.14it/s] 44%|████▍     | 434/981 [00:25<00:29, 18.52it/s] 45%|████▍     | 437/981 [00:25<00:26, 20.41it/s] 45%|████▍     | 440/981 [00:25<00:24, 22.00it/s] 45%|████▌     | 443/981 [00:25<00:23, 23.25it/s] 45%|████▌     | 446/981 [00:25<00:22, 24.29it/s] 46%|████▌     | 449/981 [00:25<00:24, 21.95it/s] 46%|████▌     | 452/981 [00:26<00:32, 16.51it/s] 46%|████▋     | 454/981 [00:26<00:36, 14.39it/s] 46%|████▋     | 456/981 [00:26<00:39, 13.39it/s] 47%|████▋     | 458/981 [00:26<00:37, 13.82it/s] 47%|████▋     | 460/981 [00:26<00:37, 13.76it/s] 47%|████▋     | 462/981 [00:26<00:36, 14.31it/s] 47%|████▋     | 464/981 [00:26<00:35, 14.49it/s] 48%|████▊     | 467/981 [00:27<00:29, 17.41it/s] 48%|████▊     | 470/981 [00:27<00:25, 19.69it/s] 48%|████▊     | 473/981 [00:27<00:23, 21.50it/s] 49%|████▊     | 476/981 [00:27<00:21, 23.04it/s] 49%|████▉     | 479/981 [00:27<00:20, 24.12it/s] 49%|████▉     | 482/981 [00:27<00:19, 24.96it/s] 49%|████▉     | 485/981 [00:27<00:20, 24.36it/s] 50%|████▉     | 488/981 [00:28<00:25, 19.43it/s] 50%|█████     | 491/981 [00:28<00:28, 17.30it/s] 50%|█████     | 493/981 [00:28<00:33, 14.52it/s] 50%|█████     | 495/981 [00:28<00:34, 14.28it/s] 51%|█████     | 497/981 [00:28<00:33, 14.49it/s] 51%|█████     | 499/981 [00:28<00:33, 14.18it/s] 51%|█████     | 502/981 [00:29<00:29, 16.40it/s] 51%|█████▏    | 505/981 [00:29<00:25, 18.87it/s] 52%|█████▏    | 508/981 [00:29<00:22, 21.02it/s] 52%|█████▏    | 511/981 [00:29<00:20, 22.68it/s] 52%|█████▏    | 514/981 [00:29<00:19, 23.91it/s] 53%|█████▎    | 517/981 [00:29<00:18, 24.84it/s] 53%|█████▎    | 520/981 [00:29<00:18, 25.51it/s] 53%|█████▎    | 523/981 [00:29<00:17, 26.19it/s] 54%|█████▎    | 526/981 [00:29<00:17, 25.50it/s] 54%|█████▍    | 529/981 [00:30<00:24, 18.40it/s] 54%|█████▍    | 532/981 [00:30<00:30, 14.88it/s] 54%|█████▍    | 534/981 [00:30<00:33, 13.27it/s] 55%|█████▍    | 536/981 [00:30<00:37, 11.83it/s] 55%|█████▍    | 538/981 [00:31<00:34, 12.95it/s] 55%|█████▌    | 541/981 [00:31<00:27, 15.76it/s] 55%|█████▌    | 543/981 [00:31<00:32, 13.61it/s] 56%|█████▌    | 545/981 [00:31<00:32, 13.59it/s] 56%|█████▌    | 547/981 [00:31<00:30, 14.09it/s] 56%|█████▌    | 549/981 [00:31<00:29, 14.74it/s] 56%|█████▌    | 551/981 [00:31<00:30, 14.31it/s] 56%|█████▋    | 553/981 [00:31<00:27, 15.55it/s] 57%|█████▋    | 556/981 [00:32<00:23, 17.90it/s] 57%|█████▋    | 559/981 [00:32<00:20, 20.17it/s] 57%|█████▋    | 562/981 [00:32<00:19, 21.81it/s] 58%|█████▊    | 565/981 [00:32<00:18, 22.90it/s] 58%|█████▊    | 568/981 [00:32<00:17, 23.69it/s] 58%|█████▊    | 571/981 [00:32<00:16, 24.40it/s] 59%|█████▊    | 574/981 [00:32<00:16, 24.99it/s] 59%|█████▉    | 577/981 [00:32<00:15, 25.45it/s] 59%|█████▉    | 580/981 [00:33<00:16, 24.24it/s] 59%|█████▉    | 583/981 [00:33<00:20, 19.60it/s] 60%|█████▉    | 586/981 [00:33<00:21, 18.46it/s] 60%|█████▉    | 588/981 [00:33<00:21, 17.93it/s] 60%|██████    | 590/981 [00:33<00:24, 15.85it/s] 60%|██████    | 592/981 [00:34<00:32, 12.13it/s] 61%|██████    | 595/981 [00:34<00:25, 14.91it/s] 61%|██████    | 598/981 [00:34<00:21, 17.45it/s] 61%|██████▏   | 601/981 [00:34<00:19, 19.51it/s] 62%|██████▏   | 604/981 [00:34<00:17, 21.29it/s] 62%|██████▏   | 607/981 [00:34<00:16, 22.59it/s] 62%|██████▏   | 610/981 [00:34<00:15, 23.73it/s] 62%|██████▏   | 613/981 [00:34<00:14, 24.54it/s] 63%|██████▎   | 616/981 [00:34<00:14, 25.18it/s] 63%|██████▎   | 619/981 [00:35<00:15, 23.74it/s] 63%|██████▎   | 622/981 [00:35<00:22, 16.19it/s] 64%|██████▎   | 624/981 [00:35<00:26, 13.46it/s] 64%|██████▍   | 627/981 [00:35<00:24, 14.70it/s] 64%|██████▍   | 629/981 [00:36<00:27, 12.64it/s] 64%|██████▍   | 631/981 [00:36<00:25, 13.73it/s] 65%|██████▍   | 634/981 [00:36<00:21, 16.45it/s] 65%|██████▍   | 637/981 [00:36<00:19, 17.73it/s] 65%|██████▌   | 640/981 [00:36<00:17, 19.56it/s] 66%|██████▌   | 643/981 [00:36<00:15, 21.19it/s] 66%|██████▌   | 646/981 [00:36<00:14, 22.55it/s] 66%|██████▌   | 649/981 [00:36<00:14, 23.35it/s] 66%|██████▋   | 652/981 [00:36<00:13, 24.01it/s] 67%|██████▋   | 655/981 [00:37<00:13, 23.50it/s] 67%|██████▋   | 658/981 [00:37<00:16, 19.58it/s] 67%|██████▋   | 661/981 [00:37<00:17, 17.91it/s] 68%|██████▊   | 663/981 [00:37<00:18, 17.16it/s] 68%|██████▊   | 665/981 [00:37<00:19, 16.47it/s] 68%|██████▊   | 667/981 [00:37<00:19, 15.80it/s] 68%|██████▊   | 669/981 [00:38<00:20, 14.96it/s] 68%|██████▊   | 671/981 [00:38<00:20, 14.88it/s] 69%|██████▊   | 674/981 [00:38<00:18, 16.87it/s] 69%|██████▉   | 677/981 [00:38<00:15, 19.29it/s] 69%|██████▉   | 680/981 [00:38<00:14, 21.25it/s] 70%|██████▉   | 683/981 [00:38<00:13, 22.72it/s] 70%|██████▉   | 686/981 [00:38<00:12, 23.79it/s] 70%|███████   | 689/981 [00:38<00:11, 24.55it/s] 71%|███████   | 692/981 [00:39<00:11, 25.13it/s] 71%|███████   | 695/981 [00:39<00:12, 23.55it/s] 71%|███████   | 698/981 [00:39<00:14, 19.04it/s] 71%|███████▏  | 701/981 [00:39<00:18, 15.26it/s] 72%|███████▏  | 703/981 [00:39<00:20, 13.80it/s] 72%|███████▏  | 705/981 [00:40<00:22, 12.02it/s] 72%|███████▏  | 707/981 [00:40<00:20, 13.14it/s] 72%|███████▏  | 709/981 [00:40<00:19, 14.31it/s] 73%|███████▎  | 712/981 [00:40<00:15, 16.94it/s] 73%|███████▎  | 715/981 [00:40<00:13, 19.08it/s] 73%|███████▎  | 718/981 [00:40<00:12, 20.76it/s] 73%|███████▎  | 721/981 [00:40<00:11, 22.26it/s] 74%|███████▍  | 724/981 [00:40<00:10, 23.40it/s] 74%|███████▍  | 727/981 [00:41<00:10, 24.16it/s] 74%|███████▍  | 730/981 [00:41<00:10, 23.68it/s] 75%|███████▍  | 733/981 [00:41<00:13, 18.56it/s] 75%|███████▌  | 736/981 [00:41<00:13, 17.55it/s] 75%|███████▌  | 738/981 [00:41<00:17, 13.99it/s] 75%|███████▌  | 740/981 [00:42<00:22, 10.70it/s] 76%|███████▌  | 743/981 [00:42<00:18, 13.01it/s] 76%|███████▌  | 746/981 [00:42<00:15, 15.52it/s] 76%|███████▋  | 749/981 [00:42<00:13, 17.79it/s] 77%|███████▋  | 752/981 [00:42<00:11, 19.67it/s] 77%|███████▋  | 755/981 [00:42<00:10, 21.18it/s] 77%|███████▋  | 758/981 [00:42<00:09, 22.34it/s] 78%|███████▊  | 761/981 [00:43<00:09, 23.16it/s] 78%|███████▊  | 764/981 [00:43<00:09, 23.74it/s] 78%|███████▊  | 767/981 [00:43<00:11, 19.25it/s] 78%|███████▊  | 770/981 [00:43<00:17, 12.40it/s] 79%|███████▊  | 772/981 [00:44<00:18, 11.25it/s] 79%|███████▉  | 774/981 [00:44<00:18, 11.26it/s] 79%|███████▉  | 776/981 [00:44<00:17, 12.00it/s] 79%|███████▉  | 779/981 [00:44<00:13, 14.84it/s] 80%|███████▉  | 782/981 [00:44<00:11, 17.45it/s] 80%|████████  | 785/981 [00:44<00:09, 19.79it/s] 80%|████████  | 788/981 [00:44<00:08, 21.72it/s] 81%|████████  | 791/981 [00:44<00:08, 23.46it/s] 81%|████████  | 794/981 [00:45<00:07, 24.87it/s] 81%|████████  | 797/981 [00:45<00:07, 26.06it/s] 82%|████████▏ | 800/981 [00:45<00:06, 26.32it/s] 82%|████████▏ | 803/981 [00:45<00:07, 23.24it/s] 82%|████████▏ | 806/981 [00:45<00:08, 21.10it/s] 82%|████████▏ | 809/981 [00:45<00:08, 20.25it/s] 83%|████████▎ | 812/981 [00:46<00:11, 14.63it/s] 83%|████████▎ | 814/981 [00:46<00:11, 14.21it/s] 83%|████████▎ | 816/981 [00:46<00:12, 13.45it/s] 83%|████████▎ | 819/981 [00:46<00:10, 15.93it/s] 84%|████████▍ | 822/981 [00:46<00:08, 18.54it/s] 84%|████████▍ | 825/981 [00:46<00:07, 21.07it/s] 84%|████████▍ | 828/981 [00:46<00:06, 23.21it/s] 85%|████████▍ | 831/981 [00:46<00:06, 24.87it/s] 85%|████████▌ | 834/981 [00:47<00:05, 26.10it/s] 85%|████████▌ | 837/981 [00:47<00:05, 26.90it/s] 86%|████████▌ | 840/981 [00:47<00:05, 27.59it/s] 86%|████████▌ | 843/981 [00:47<00:05, 26.47it/s] 86%|████████▌ | 846/981 [00:47<00:05, 22.98it/s] 87%|████████▋ | 849/981 [00:47<00:07, 16.68it/s] 87%|████████▋ | 852/981 [00:48<00:08, 15.59it/s] 87%|████████▋ | 854/981 [00:48<00:08, 15.32it/s] 87%|████████▋ | 856/981 [00:48<00:08, 14.35it/s] 87%|████████▋ | 858/981 [00:48<00:08, 14.16it/s] 88%|████████▊ | 861/981 [00:48<00:07, 16.57it/s] 88%|████████▊ | 864/981 [00:48<00:06, 19.34it/s] 88%|████████▊ | 868/981 [00:48<00:04, 22.62it/s] 89%|████████▉ | 872/981 [00:48<00:04, 24.91it/s] 89%|████████▉ | 875/981 [00:49<00:04, 26.12it/s] 90%|████████▉ | 879/981 [00:49<00:03, 27.70it/s] 90%|█████████ | 883/981 [00:49<00:03, 28.14it/s] 90%|█████████ | 886/981 [00:49<00:03, 27.97it/s] 91%|█████████ | 889/981 [00:49<00:04, 19.85it/s] 91%|█████████ | 892/981 [00:50<00:05, 15.43it/s] 91%|█████████ | 894/981 [00:50<00:06, 14.48it/s] 91%|█████████▏| 896/981 [00:50<00:06, 13.36it/s] 92%|█████████▏| 898/981 [00:50<00:06, 13.76it/s] 92%|█████████▏| 900/981 [00:50<00:05, 14.58it/s] 92%|█████████▏| 903/981 [00:50<00:04, 17.67it/s] 92%|█████████▏| 907/981 [00:50<00:03, 21.44it/s] 93%|█████████▎| 911/981 [00:51<00:02, 24.22it/s] 93%|█████████▎| 915/981 [00:51<00:02, 25.96it/s] 94%|█████████▎| 919/981 [00:51<00:02, 27.50it/s] 94%|█████████▍| 923/981 [00:51<00:02, 27.98it/s] 94%|█████████▍| 926/981 [00:51<00:02, 25.29it/s] 95%|█████████▍| 929/981 [00:51<00:02, 22.65it/s] 95%|█████████▌| 932/981 [00:51<00:02, 18.11it/s] 95%|█████████▌| 934/981 [00:52<00:03, 14.35it/s] 95%|█████████▌| 936/981 [00:52<00:03, 13.03it/s] 96%|█████████▌| 938/981 [00:52<00:03, 13.68it/s] 96%|█████████▌| 940/981 [00:52<00:02, 14.25it/s] 96%|█████████▌| 943/981 [00:52<00:02, 17.17it/s] 96%|█████████▋| 945/981 [00:52<00:02, 17.79it/s] 97%|█████████▋| 948/981 [00:53<00:01, 20.13it/s] 97%|█████████▋| 951/981 [00:53<00:01, 22.54it/s] 97%|█████████▋| 954/981 [00:53<00:01, 24.52it/s] 98%|█████████▊| 958/981 [00:53<00:00, 26.58it/s] 98%|█████████▊| 961/981 [00:53<00:00, 27.05it/s] 98%|█████████▊| 964/981 [00:53<00:00, 22.94it/s] 99%|█████████▊| 967/981 [00:53<00:00, 17.82it/s] 99%|█████████▉| 970/981 [00:54<00:00, 15.97it/s] 99%|█████████▉| 972/981 [00:54<00:00, 16.67it/s] 99%|█████████▉| 974/981 [00:54<00:00, 15.04it/s] 99%|█████████▉| 976/981 [00:54<00:00, 13.91it/s]100%|█████████▉| 979/981 [00:54<00:00, 17.10it/s]100%|██████████| 981/981 [00:54<00:00, 17.92it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_4_Focal_RS_DRW_seed_41
train data : 14398, disrupt : 227, non-disrupt : 14171
valid data : 3508, disrupt : 57, non-disrupt : 3451
test data : 4051, disrupt : 71, non-disrupt : 3980

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.120, valid loss : 0.177, train f1 : 0.747, valid f1 : 0.478
Best score increase :0.000 -> 0.478
training process - Deferred Re-weighting:   1%|          | 1/128 [03:54<8:15:49, 234.25s/it]Best score increase :0.478 -> 0.659
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:04<7:17:50, 208.49s/it]Best score increase :0.659 -> 0.731
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:16<6:58:24, 200.84s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:30<6:49:08, 197.97s/it]epoch : 5, train loss : 0.044, valid loss : 0.049, train f1 : 0.924, valid f1 : 0.568
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:26<7:14:23, 211.89s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:54<7:08:20, 210.66s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:47<7:19:02, 217.71s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [28:10<7:06:19, 213.16s/it]epoch : 9, train loss : 0.037, valid loss : 0.033, train f1 : 0.938, valid f1 : 0.608
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [32:11<7:19:44, 221.72s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [35:24<6:58:44, 212.92s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [38:37<6:43:12, 206.78s/it]Best score increase :0.731 -> 0.839
training process - Deferred Re-weighting:   9%|▉         | 12/128 [41:50<6:31:53, 202.70s/it]epoch : 13, train loss : 0.035, valid loss : 0.032, train f1 : 0.941, valid f1 : 0.765
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [45:49<6:49:21, 213.58s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [49:04<6:35:23, 208.10s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [52:17<6:23:19, 203.53s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [55:30<6:13:58, 200.35s/it]epoch : 17, train loss : 0.033, valid loss : 0.145, train f1 : 0.945, valid f1 : 0.526
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [59:26<6:30:14, 210.95s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:02:41<6:18:07, 206.25s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:05:54<6:07:17, 202.18s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:09:05<5:58:14, 199.03s/it]epoch : 21, train loss : 0.028, valid loss : 0.024, train f1 : 0.950, valid f1 : 0.653
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:13:07<6:17:52, 211.89s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:16:22<6:05:03, 206.64s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:19:38<5:56:20, 203.62s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 23, best f1 score : 0.839
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:22:54<6:18:29, 216.28s/it]
training process finished, best loss : 0.016, best acc : 0.989, best f1 : 0.839, best epoch : 11

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.36      0.86      0.50        71
           1       1.00      0.97      0.98      3980

    accuracy                           0.97      4051
   macro avg       0.68      0.92      0.74      4051
weighted avg       0.99      0.97      0.98      4051


# test acc : 0.97, test f1 : 0.74, test AUC : 0.92, test loss : 0.483

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/980 [00:00<?, ?it/s]  0%|          | 3/980 [00:00<00:42, 22.84it/s]  1%|          | 6/980 [00:00<01:01, 15.81it/s]  1%|          | 8/980 [00:00<01:20, 12.08it/s]  1%|          | 10/980 [00:00<01:42,  9.51it/s]  1%|          | 12/980 [00:01<01:51,  8.67it/s]  1%|▏         | 14/980 [00:01<01:36,  9.99it/s]  2%|▏         | 16/980 [00:01<01:25, 11.21it/s]  2%|▏         | 18/980 [00:01<01:33, 10.26it/s]  2%|▏         | 20/980 [00:02<01:55,  8.28it/s]  2%|▏         | 22/980 [00:02<01:47,  8.93it/s]  2%|▏         | 24/980 [00:02<01:30, 10.56it/s]  3%|▎         | 27/980 [00:02<01:11, 13.27it/s]  3%|▎         | 30/980 [00:02<01:02, 15.29it/s]  3%|▎         | 33/980 [00:02<00:53, 17.60it/s]  4%|▎         | 36/980 [00:02<00:48, 19.53it/s]  4%|▍         | 39/980 [00:02<00:44, 21.08it/s]  4%|▍         | 42/980 [00:03<00:42, 22.19it/s]  5%|▍         | 45/980 [00:03<00:41, 22.33it/s]  5%|▍         | 48/980 [00:03<00:42, 21.96it/s]  5%|▌         | 51/980 [00:03<00:50, 18.31it/s]  5%|▌         | 53/980 [00:03<00:56, 16.32it/s]  6%|▌         | 55/980 [00:03<01:02, 14.78it/s]  6%|▌         | 57/980 [00:04<01:08, 13.49it/s]  6%|▌         | 59/980 [00:04<01:13, 12.47it/s]  6%|▋         | 62/980 [00:04<01:01, 15.03it/s]  7%|▋         | 65/980 [00:04<00:52, 17.47it/s]  7%|▋         | 68/980 [00:04<00:46, 19.56it/s]  7%|▋         | 71/980 [00:04<00:42, 21.14it/s]  8%|▊         | 74/980 [00:04<00:40, 22.26it/s]  8%|▊         | 77/980 [00:05<00:39, 23.05it/s]  8%|▊         | 80/980 [00:05<00:37, 23.70it/s]  8%|▊         | 83/980 [00:05<00:40, 22.33it/s]  9%|▉         | 86/980 [00:05<00:52, 16.98it/s]  9%|▉         | 88/980 [00:05<00:57, 15.55it/s]  9%|▉         | 90/980 [00:05<00:59, 15.07it/s]  9%|▉         | 92/980 [00:06<01:23, 10.68it/s] 10%|▉         | 94/980 [00:06<01:24, 10.54it/s] 10%|▉         | 97/980 [00:06<01:05, 13.46it/s] 10%|█         | 100/980 [00:06<00:54, 16.09it/s] 11%|█         | 103/980 [00:06<00:47, 18.37it/s] 11%|█         | 106/980 [00:06<00:43, 20.22it/s] 11%|█         | 109/980 [00:06<00:40, 21.57it/s] 11%|█▏        | 112/980 [00:07<00:38, 22.61it/s] 12%|█▏        | 115/980 [00:07<00:37, 23.31it/s] 12%|█▏        | 118/980 [00:07<00:43, 19.94it/s] 12%|█▏        | 121/980 [00:07<00:52, 16.26it/s] 13%|█▎        | 123/980 [00:07<00:52, 16.19it/s] 13%|█▎        | 125/980 [00:07<00:55, 15.49it/s] 13%|█▎        | 127/980 [00:08<00:52, 16.24it/s] 13%|█▎        | 129/980 [00:08<00:55, 15.20it/s] 13%|█▎        | 131/980 [00:08<01:00, 14.08it/s] 14%|█▎        | 133/980 [00:08<00:59, 14.22it/s] 14%|█▍        | 136/980 [00:08<00:50, 16.57it/s] 14%|█▍        | 139/980 [00:08<00:44, 18.92it/s] 14%|█▍        | 142/980 [00:08<00:40, 20.84it/s] 15%|█▍        | 145/980 [00:09<00:37, 22.30it/s] 15%|█▌        | 148/980 [00:09<00:35, 23.48it/s] 15%|█▌        | 151/980 [00:09<00:33, 24.43it/s] 16%|█▌        | 154/980 [00:09<00:33, 24.86it/s] 16%|█▌        | 157/980 [00:09<00:38, 21.43it/s] 16%|█▋        | 160/980 [00:09<00:50, 16.35it/s] 17%|█▋        | 162/980 [00:09<00:51, 15.93it/s] 17%|█▋        | 164/980 [00:10<00:57, 14.29it/s] 17%|█▋        | 166/980 [00:10<00:55, 14.57it/s] 17%|█▋        | 168/980 [00:10<00:58, 13.89it/s] 17%|█▋        | 170/980 [00:10<00:56, 14.27it/s] 18%|█▊        | 173/980 [00:10<00:48, 16.57it/s] 18%|█▊        | 176/980 [00:10<00:42, 18.93it/s] 18%|█▊        | 179/980 [00:10<00:38, 20.86it/s] 19%|█▊        | 182/980 [00:11<00:35, 22.30it/s] 19%|█▉        | 185/980 [00:11<00:38, 20.79it/s] 19%|█▉        | 188/980 [00:11<00:37, 21.14it/s] 19%|█▉        | 191/980 [00:11<00:41, 18.98it/s] 20%|█▉        | 193/980 [00:11<00:44, 17.52it/s] 20%|█▉        | 195/980 [00:11<00:48, 16.19it/s] 20%|██        | 197/980 [00:12<00:54, 14.45it/s] 20%|██        | 199/980 [00:12<00:54, 14.24it/s] 21%|██        | 201/980 [00:12<00:54, 14.26it/s] 21%|██        | 203/980 [00:12<00:55, 13.91it/s] 21%|██        | 205/980 [00:12<00:56, 13.67it/s] 21%|██        | 208/980 [00:12<00:47, 16.38it/s] 22%|██▏       | 211/980 [00:12<00:41, 18.68it/s] 22%|██▏       | 214/980 [00:12<00:37, 20.41it/s] 22%|██▏       | 217/980 [00:13<00:35, 21.60it/s] 22%|██▏       | 220/980 [00:13<00:33, 22.58it/s] 23%|██▎       | 223/980 [00:13<00:32, 23.11it/s] 23%|██▎       | 226/980 [00:13<00:32, 23.45it/s] 23%|██▎       | 229/980 [00:13<00:35, 21.27it/s] 24%|██▎       | 232/980 [00:13<00:40, 18.59it/s] 24%|██▍       | 234/980 [00:14<00:50, 14.70it/s] 24%|██▍       | 236/980 [00:14<01:00, 12.20it/s] 24%|██▍       | 238/980 [00:14<01:04, 11.45it/s] 24%|██▍       | 240/980 [00:14<00:59, 12.49it/s] 25%|██▍       | 242/980 [00:14<00:54, 13.62it/s] 25%|██▌       | 245/980 [00:14<00:45, 16.05it/s] 25%|██▌       | 248/980 [00:15<00:39, 18.30it/s] 26%|██▌       | 251/980 [00:15<00:36, 20.06it/s] 26%|██▌       | 254/980 [00:15<00:33, 21.48it/s] 26%|██▌       | 257/980 [00:15<00:32, 22.55it/s] 27%|██▋       | 260/980 [00:15<00:30, 23.28it/s] 27%|██▋       | 263/980 [00:15<00:34, 20.52it/s] 27%|██▋       | 266/980 [00:15<00:41, 17.31it/s] 27%|██▋       | 268/980 [00:16<00:44, 16.15it/s] 28%|██▊       | 270/980 [00:16<00:48, 14.57it/s] 28%|██▊       | 272/980 [00:16<00:52, 13.38it/s] 28%|██▊       | 274/980 [00:16<00:53, 13.28it/s] 28%|██▊       | 276/980 [00:16<00:50, 13.99it/s] 28%|██▊       | 279/980 [00:16<00:42, 16.53it/s] 29%|██▉       | 282/980 [00:16<00:37, 18.77it/s] 29%|██▉       | 285/980 [00:17<00:33, 20.48it/s] 29%|██▉       | 288/980 [00:17<00:31, 21.82it/s] 30%|██▉       | 291/980 [00:17<00:30, 22.87it/s] 30%|███       | 294/980 [00:17<00:29, 23.45it/s] 30%|███       | 297/980 [00:17<00:28, 23.85it/s] 31%|███       | 300/980 [00:17<00:30, 22.23it/s] 31%|███       | 303/980 [00:17<00:39, 17.14it/s] 31%|███       | 305/980 [00:18<00:42, 16.07it/s] 31%|███▏      | 307/980 [00:18<00:43, 15.40it/s] 32%|███▏      | 309/980 [00:18<00:46, 14.41it/s] 32%|███▏      | 311/980 [00:18<00:46, 14.50it/s] 32%|███▏      | 313/980 [00:18<00:47, 14.06it/s] 32%|███▏      | 316/980 [00:18<00:41, 16.01it/s] 33%|███▎      | 319/980 [00:18<00:36, 17.87it/s] 33%|███▎      | 322/980 [00:19<00:33, 19.43it/s] 33%|███▎      | 325/980 [00:19<00:31, 20.93it/s] 33%|███▎      | 328/980 [00:19<00:30, 21.45it/s] 34%|███▍      | 331/980 [00:19<00:30, 21.58it/s] 34%|███▍      | 334/980 [00:19<00:29, 21.97it/s] 34%|███▍      | 337/980 [00:19<00:35, 18.02it/s] 35%|███▍      | 339/980 [00:20<00:41, 15.41it/s] 35%|███▍      | 341/980 [00:20<00:55, 11.54it/s] 35%|███▌      | 343/980 [00:20<00:50, 12.68it/s] 35%|███▌      | 345/980 [00:20<00:48, 13.09it/s] 35%|███▌      | 347/980 [00:20<00:47, 13.24it/s] 36%|███▌      | 349/980 [00:20<00:43, 14.59it/s] 36%|███▌      | 352/980 [00:20<00:36, 17.21it/s] 36%|███▌      | 355/980 [00:21<00:31, 19.55it/s] 37%|███▋      | 358/980 [00:21<00:28, 21.53it/s] 37%|███▋      | 361/980 [00:21<00:26, 22.98it/s] 37%|███▋      | 364/980 [00:21<00:25, 24.05it/s] 37%|███▋      | 367/980 [00:21<00:24, 24.83it/s] 38%|███▊      | 370/980 [00:21<00:24, 25.34it/s] 38%|███▊      | 373/980 [00:21<00:28, 21.47it/s] 38%|███▊      | 376/980 [00:22<00:32, 18.74it/s] 39%|███▊      | 379/980 [00:22<00:39, 15.09it/s] 39%|███▉      | 381/980 [00:22<00:43, 13.89it/s] 39%|███▉      | 383/980 [00:22<00:49, 12.03it/s] 39%|███▉      | 385/980 [00:22<00:45, 13.11it/s] 40%|███▉      | 388/980 [00:23<00:38, 15.27it/s] 40%|███▉      | 391/980 [00:23<00:33, 17.62it/s] 40%|████      | 394/980 [00:23<00:29, 19.75it/s] 41%|████      | 397/980 [00:23<00:27, 21.54it/s] 41%|████      | 400/980 [00:23<00:25, 22.99it/s] 41%|████      | 403/980 [00:23<00:24, 23.97it/s] 41%|████▏     | 406/980 [00:23<00:23, 24.71it/s] 42%|████▏     | 409/980 [00:23<00:23, 24.01it/s] 42%|████▏     | 412/980 [00:24<00:26, 21.39it/s] 42%|████▏     | 415/980 [00:24<00:29, 19.07it/s] 43%|████▎     | 418/980 [00:24<00:36, 15.43it/s] 43%|████▎     | 420/980 [00:24<00:38, 14.43it/s] 43%|████▎     | 422/980 [00:24<00:40, 13.80it/s] 43%|████▎     | 424/980 [00:24<00:40, 13.88it/s] 43%|████▎     | 426/980 [00:25<00:36, 15.08it/s] 44%|████▍     | 429/980 [00:25<00:31, 17.46it/s] 44%|████▍     | 431/980 [00:25<00:32, 17.11it/s] 44%|████▍     | 434/980 [00:25<00:28, 19.00it/s] 45%|████▍     | 437/980 [00:25<00:26, 20.81it/s] 45%|████▍     | 440/980 [00:25<00:24, 22.16it/s] 45%|████▌     | 443/980 [00:25<00:23, 23.33it/s] 46%|████▌     | 446/980 [00:25<00:23, 23.21it/s] 46%|████▌     | 449/980 [00:26<00:27, 19.42it/s] 46%|████▌     | 452/980 [00:26<00:29, 18.13it/s] 46%|████▋     | 454/980 [00:26<00:29, 17.58it/s] 47%|████▋     | 456/980 [00:26<00:30, 17.13it/s] 47%|████▋     | 458/980 [00:26<00:31, 16.77it/s] 47%|████▋     | 460/980 [00:26<00:31, 16.51it/s] 47%|████▋     | 462/980 [00:27<00:36, 14.17it/s] 47%|████▋     | 465/980 [00:27<00:30, 16.83it/s] 48%|████▊     | 468/980 [00:27<00:26, 19.08it/s] 48%|████▊     | 471/980 [00:27<00:24, 20.63it/s] 48%|████▊     | 474/980 [00:27<00:23, 21.30it/s] 49%|████▊     | 477/980 [00:27<00:23, 21.65it/s] 49%|████▉     | 480/980 [00:27<00:21, 22.81it/s] 49%|████▉     | 483/980 [00:27<00:20, 23.91it/s] 50%|████▉     | 486/980 [00:28<00:21, 23.27it/s] 50%|████▉     | 489/980 [00:28<00:24, 19.68it/s] 50%|█████     | 492/980 [00:28<00:29, 16.43it/s] 50%|█████     | 494/980 [00:28<00:30, 16.07it/s] 51%|█████     | 496/980 [00:28<00:30, 15.64it/s] 51%|█████     | 498/980 [00:28<00:31, 15.09it/s] 51%|█████     | 500/980 [00:29<00:32, 14.57it/s] 51%|█████▏    | 503/980 [00:29<00:28, 16.77it/s] 52%|█████▏    | 506/980 [00:29<00:24, 19.31it/s] 52%|█████▏    | 509/980 [00:29<00:21, 21.56it/s] 52%|█████▏    | 512/980 [00:29<00:20, 23.01it/s] 53%|█████▎    | 515/980 [00:29<00:19, 24.19it/s] 53%|█████▎    | 518/980 [00:29<00:18, 24.79it/s] 53%|█████▎    | 521/980 [00:29<00:18, 25.35it/s] 53%|█████▎    | 524/980 [00:29<00:17, 25.90it/s] 54%|█████▍    | 527/980 [00:30<00:19, 23.16it/s] 54%|█████▍    | 530/980 [00:30<00:24, 18.63it/s] 54%|█████▍    | 533/980 [00:30<00:35, 12.65it/s] 55%|█████▍    | 535/980 [00:30<00:35, 12.60it/s] 55%|█████▍    | 537/980 [00:31<00:34, 12.92it/s] 55%|█████▌    | 539/980 [00:31<00:34, 12.97it/s] 55%|█████▌    | 542/980 [00:31<00:27, 15.66it/s] 56%|█████▌    | 545/980 [00:31<00:24, 17.94it/s] 56%|█████▌    | 548/980 [00:31<00:21, 19.94it/s] 56%|█████▌    | 551/980 [00:31<00:19, 21.53it/s] 57%|█████▋    | 554/980 [00:31<00:18, 22.67it/s] 57%|█████▋    | 557/980 [00:31<00:18, 23.42it/s] 57%|█████▋    | 560/980 [00:32<00:17, 24.06it/s] 57%|█████▋    | 563/980 [00:32<00:19, 20.88it/s] 58%|█████▊    | 566/980 [00:32<00:25, 16.43it/s] 58%|█████▊    | 568/980 [00:32<00:29, 14.08it/s] 58%|█████▊    | 570/980 [00:32<00:30, 13.34it/s] 58%|█████▊    | 572/980 [00:33<00:38, 10.64it/s] 59%|█████▊    | 575/980 [00:33<00:30, 13.29it/s] 59%|█████▉    | 578/980 [00:33<00:25, 15.85it/s] 59%|█████▉    | 581/980 [00:33<00:21, 18.14it/s] 60%|█████▉    | 584/980 [00:33<00:19, 20.09it/s] 60%|█████▉    | 587/980 [00:33<00:18, 21.59it/s] 60%|██████    | 590/980 [00:33<00:17, 22.62it/s] 61%|██████    | 593/980 [00:34<00:16, 23.42it/s] 61%|██████    | 596/980 [00:34<00:15, 24.46it/s] 61%|██████    | 599/980 [00:34<00:16, 23.04it/s] 61%|██████▏   | 602/980 [00:34<00:19, 18.92it/s] 62%|██████▏   | 605/980 [00:34<00:25, 15.00it/s] 62%|██████▏   | 607/980 [00:34<00:27, 13.50it/s] 62%|██████▏   | 609/980 [00:35<00:28, 13.17it/s] 62%|██████▏   | 611/980 [00:35<00:27, 13.43it/s] 63%|██████▎   | 613/980 [00:35<00:25, 14.17it/s] 63%|██████▎   | 615/980 [00:35<00:23, 15.34it/s] 63%|██████▎   | 617/980 [00:35<00:22, 15.96it/s] 63%|██████▎   | 620/980 [00:35<00:19, 18.16it/s] 64%|██████▎   | 623/980 [00:35<00:17, 20.25it/s] 64%|██████▍   | 626/980 [00:35<00:16, 21.76it/s] 64%|██████▍   | 629/980 [00:36<00:15, 22.95it/s] 64%|██████▍   | 632/980 [00:36<00:14, 23.29it/s] 65%|██████▍   | 635/980 [00:36<00:18, 18.84it/s] 65%|██████▌   | 638/980 [00:36<00:21, 16.12it/s] 65%|██████▌   | 640/980 [00:36<00:21, 15.73it/s] 66%|██████▌   | 642/980 [00:37<00:23, 14.44it/s] 66%|██████▌   | 644/980 [00:37<00:25, 13.01it/s] 66%|██████▌   | 646/980 [00:37<00:27, 11.93it/s] 66%|██████▌   | 648/980 [00:37<00:24, 13.34it/s] 66%|██████▋   | 651/980 [00:37<00:20, 15.70it/s] 67%|██████▋   | 654/980 [00:37<00:17, 18.15it/s] 67%|██████▋   | 657/980 [00:37<00:16, 20.15it/s] 67%|██████▋   | 660/980 [00:38<00:14, 21.41it/s] 68%|██████▊   | 663/980 [00:38<00:14, 22.61it/s] 68%|██████▊   | 666/980 [00:38<00:14, 21.98it/s] 68%|██████▊   | 669/980 [00:38<00:15, 19.48it/s] 69%|██████▊   | 672/980 [00:38<00:20, 14.70it/s] 69%|██████▉   | 674/980 [00:38<00:23, 12.83it/s] 69%|██████▉   | 676/980 [00:39<00:25, 11.91it/s] 69%|██████▉   | 678/980 [00:39<00:28, 10.45it/s] 69%|██████▉   | 680/980 [00:39<00:25, 11.74it/s] 70%|██████▉   | 683/980 [00:39<00:20, 14.27it/s] 70%|███████   | 686/980 [00:39<00:17, 17.07it/s] 70%|███████   | 689/980 [00:39<00:15, 19.39it/s] 71%|███████   | 692/980 [00:40<00:13, 21.45it/s] 71%|███████   | 695/980 [00:40<00:12, 23.06it/s] 71%|███████   | 698/980 [00:40<00:11, 24.21it/s] 72%|███████▏  | 701/980 [00:40<00:11, 24.88it/s] 72%|███████▏  | 704/980 [00:40<00:11, 23.49it/s] 72%|███████▏  | 707/980 [00:40<00:17, 15.77it/s] 72%|███████▏  | 709/980 [00:41<00:20, 13.44it/s] 73%|███████▎  | 711/980 [00:41<00:21, 12.37it/s] 73%|███████▎  | 713/980 [00:41<00:23, 11.42it/s] 73%|███████▎  | 715/980 [00:41<00:20, 12.63it/s] 73%|███████▎  | 718/980 [00:41<00:17, 15.14it/s] 74%|███████▎  | 721/980 [00:41<00:14, 17.79it/s] 74%|███████▍  | 724/980 [00:41<00:12, 20.17it/s] 74%|███████▍  | 727/980 [00:42<00:11, 22.14it/s] 74%|███████▍  | 730/980 [00:42<00:10, 23.46it/s] 75%|███████▍  | 733/980 [00:42<00:10, 24.35it/s] 75%|███████▌  | 736/980 [00:42<00:09, 24.70it/s] 75%|███████▌  | 739/980 [00:42<00:10, 23.74it/s] 76%|███████▌  | 742/980 [00:42<00:17, 13.66it/s] 76%|███████▌  | 744/980 [00:43<00:16, 13.93it/s] 76%|███████▌  | 746/980 [00:43<00:17, 13.40it/s] 76%|███████▋  | 748/980 [00:43<00:21, 10.84it/s] 77%|███████▋  | 751/980 [00:43<00:17, 13.22it/s] 77%|███████▋  | 754/980 [00:43<00:14, 15.56it/s] 77%|███████▋  | 757/980 [00:43<00:12, 18.03it/s] 78%|███████▊  | 760/980 [00:44<00:10, 20.16it/s] 78%|███████▊  | 763/980 [00:44<00:09, 21.98it/s] 78%|███████▊  | 766/980 [00:44<00:09, 23.06it/s] 78%|███████▊  | 769/980 [00:44<00:08, 24.07it/s] 79%|███████▉  | 772/980 [00:44<00:08, 24.87it/s] 79%|███████▉  | 775/980 [00:44<00:08, 24.43it/s] 79%|███████▉  | 778/980 [00:44<00:10, 19.53it/s] 80%|███████▉  | 781/980 [00:45<00:11, 17.16it/s] 80%|███████▉  | 783/980 [00:45<00:13, 14.93it/s] 80%|████████  | 785/980 [00:45<00:13, 14.45it/s] 80%|████████  | 787/980 [00:45<00:16, 11.46it/s] 81%|████████  | 790/980 [00:45<00:13, 14.17it/s] 81%|████████  | 793/980 [00:45<00:11, 16.72it/s] 81%|████████  | 796/980 [00:46<00:09, 19.44it/s] 82%|████████▏ | 799/980 [00:46<00:08, 20.89it/s] 82%|████████▏ | 802/980 [00:46<00:08, 22.02it/s] 82%|████████▏ | 805/980 [00:46<00:07, 23.60it/s] 82%|████████▏ | 808/980 [00:46<00:07, 23.09it/s] 83%|████████▎ | 811/980 [00:46<00:07, 23.26it/s] 83%|████████▎ | 814/980 [00:46<00:07, 21.42it/s] 83%|████████▎ | 817/980 [00:46<00:08, 19.47it/s] 84%|████████▎ | 820/980 [00:47<00:08, 17.91it/s] 84%|████████▍ | 823/980 [00:47<00:08, 18.37it/s] 84%|████████▍ | 825/980 [00:47<00:08, 18.14it/s] 84%|████████▍ | 827/980 [00:47<00:08, 18.21it/s] 85%|████████▍ | 829/980 [00:47<00:08, 17.60it/s] 85%|████████▍ | 831/980 [00:47<00:08, 18.10it/s] 85%|████████▌ | 834/980 [00:47<00:07, 20.33it/s] 85%|████████▌ | 837/980 [00:48<00:06, 22.72it/s] 86%|████████▌ | 840/980 [00:48<00:06, 22.99it/s] 86%|████████▌ | 843/980 [00:48<00:05, 22.96it/s] 86%|████████▋ | 846/980 [00:48<00:05, 24.26it/s] 87%|████████▋ | 849/980 [00:48<00:05, 25.66it/s] 87%|████████▋ | 852/980 [00:48<00:04, 26.41it/s] 87%|████████▋ | 855/980 [00:48<00:04, 26.48it/s] 88%|████████▊ | 858/980 [00:48<00:05, 23.46it/s] 88%|████████▊ | 861/980 [00:49<00:06, 19.44it/s] 88%|████████▊ | 864/980 [00:49<00:06, 17.11it/s] 88%|████████▊ | 866/980 [00:49<00:07, 15.74it/s] 89%|████████▊ | 868/980 [00:49<00:07, 15.23it/s] 89%|████████▉ | 870/980 [00:49<00:08, 13.54it/s] 89%|████████▉ | 872/980 [00:49<00:07, 13.81it/s] 89%|████████▉ | 875/980 [00:50<00:06, 16.78it/s] 90%|████████▉ | 878/980 [00:50<00:05, 19.62it/s] 90%|█████████ | 882/980 [00:50<00:04, 23.17it/s] 90%|█████████ | 886/980 [00:50<00:03, 25.78it/s] 91%|█████████ | 890/980 [00:50<00:03, 27.43it/s] 91%|█████████ | 894/980 [00:50<00:02, 28.92it/s] 92%|█████████▏| 898/980 [00:50<00:02, 28.83it/s] 92%|█████████▏| 901/980 [00:50<00:02, 27.21it/s] 92%|█████████▏| 904/980 [00:51<00:03, 24.40it/s] 93%|█████████▎| 907/980 [00:51<00:03, 22.65it/s] 93%|█████████▎| 910/980 [00:51<00:03, 21.50it/s] 93%|█████████▎| 913/980 [00:51<00:03, 20.75it/s] 93%|█████████▎| 916/980 [00:51<00:04, 15.31it/s] 94%|█████████▎| 918/980 [00:51<00:03, 15.91it/s] 94%|█████████▍| 921/980 [00:52<00:03, 18.57it/s] 94%|█████████▍| 924/980 [00:52<00:02, 20.73it/s] 95%|█████████▍| 928/980 [00:52<00:02, 23.55it/s] 95%|█████████▌| 932/980 [00:52<00:01, 25.76it/s] 96%|█████████▌| 936/980 [00:52<00:01, 27.33it/s] 96%|█████████▌| 940/980 [00:52<00:01, 28.58it/s] 96%|█████████▋| 944/980 [00:52<00:01, 29.43it/s] 97%|█████████▋| 947/980 [00:52<00:01, 27.37it/s] 97%|█████████▋| 950/980 [00:53<00:01, 22.18it/s] 97%|█████████▋| 953/980 [00:53<00:01, 19.82it/s] 98%|█████████▊| 956/980 [00:53<00:01, 16.22it/s] 98%|█████████▊| 958/980 [00:53<00:01, 14.80it/s] 98%|█████████▊| 960/980 [00:53<00:01, 14.84it/s] 98%|█████████▊| 962/980 [00:54<00:01, 15.69it/s] 98%|█████████▊| 965/980 [00:54<00:00, 18.02it/s] 99%|█████████▉| 968/980 [00:54<00:00, 20.11it/s] 99%|█████████▉| 971/980 [00:54<00:00, 22.11it/s] 99%|█████████▉| 974/980 [00:54<00:00, 23.91it/s]100%|█████████▉| 977/980 [00:54<00:00, 25.13it/s]100%|██████████| 980/980 [00:54<00:00, 26.26it/s]100%|██████████| 980/980 [00:54<00:00, 17.91it/s]
time :  1337
prob :  1337
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_5_Focal_RS_DRW_seed_41
train data : 14374, disrupt : 227, non-disrupt : 14147
valid data : 3506, disrupt : 57, non-disrupt : 3449
test data : 4049, disrupt : 71, non-disrupt : 3978

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.055, train f1 : 0.677, valid f1 : 0.618
Best score increase :0.000 -> 0.618
training process - Deferred Re-weighting:   1%|          | 1/128 [04:02<8:32:27, 242.11s/it]Best score increase :0.618 -> 0.643
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:15<7:28:05, 213.38s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:26<7:03:34, 203.32s/it]Best score increase :0.643 -> 0.645
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:41<6:53:14, 199.96s/it]epoch : 5, train loss : 0.060, valid loss : 0.044, train f1 : 0.898, valid f1 : 0.573
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:43<7:20:52, 215.06s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:56<7:02:09, 207.62s/it]Best score increase :0.645 -> 0.646
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:18<6:54:52, 205.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [27:32<6:44:10, 202.09s/it]epoch : 9, train loss : 0.051, valid loss : 0.040, train f1 : 0.912, valid f1 : 0.662
Best score increase :0.646 -> 0.662
training process - Deferred Re-weighting:   7%|▋         | 9/128 [31:32<7:03:54, 213.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [34:44<6:47:35, 207.25s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [37:59<6:36:50, 203.51s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [41:13<6:27:28, 200.42s/it]epoch : 13, train loss : 0.045, valid loss : 0.066, train f1 : 0.926, valid f1 : 0.549
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [45:26<6:54:48, 216.43s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [49:09<6:54:51, 218.35s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [52:48<6:51:42, 218.60s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [56:04<6:35:37, 211.94s/it]epoch : 17, train loss : 0.038, valid loss : 0.044, train f1 : 0.935, valid f1 : 0.668
Best score increase :0.662 -> 0.668
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [1:00:01<6:45:41, 219.29s/it]Best score increase :0.668 -> 0.677
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:03:16<6:28:56, 212.15s/it]Best score increase :0.677 -> 0.679
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:06:44<6:22:48, 210.72s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:10:45<6:35:37, 219.79s/it]epoch : 21, train loss : 0.035, valid loss : 0.054, train f1 : 0.938, valid f1 : 0.649
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:14:42<6:41:24, 225.09s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:17:57<6:21:46, 216.10s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:21:13<6:07:17, 209.88s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:24:26<5:55:01, 204.82s/it]epoch : 25, train loss : 0.036, valid loss : 0.052, train f1 : 0.941, valid f1 : 0.589
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:28:23<6:08:36, 214.73s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:31:38<5:54:50, 208.73s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:34:54<5:44:45, 204.80s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:38:10<5:36:51, 202.12s/it]epoch : 29, train loss : 0.032, valid loss : 0.057, train f1 : 0.947, valid f1 : 0.570
EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:42:08<5:51:39, 213.13s/it]Best score increase :0.679 -> 0.683
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [1:45:24<5:39:17, 207.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:48:39<5:29:46, 203.98s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [1:51:53<5:21:52, 201.17s/it]epoch : 33, train loss : 0.031, valid loss : 0.053, train f1 : 0.950, valid f1 : 0.618
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [1:55:50<5:35:07, 211.66s/it]Best score increase :0.683 -> 0.707
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [1:59:03<5:23:04, 206.21s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [2:02:20<5:15:13, 203.37s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [2:05:43<5:11:56, 203.44s/it]epoch : 37, train loss : 0.030, valid loss : 0.069, train f1 : 0.951, valid f1 : 0.569
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [2:09:38<5:22:41, 212.77s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [2:13:10<5:19:01, 212.68s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [2:16:43<5:15:19, 212.58s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [2:20:34<5:19:53, 218.10s/it]epoch : 41, train loss : 0.029, valid loss : 0.051, train f1 : 0.957, valid f1 : 0.638
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [2:24:30<5:24:13, 223.60s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  33%|███▎      | 42/128 [2:27:43<5:07:05, 214.25s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  34%|███▎      | 43/128 [2:30:58<4:55:41, 208.72s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  34%|███▍      | 44/128 [2:34:13<4:46:25, 204.59s/it]epoch : 45, train loss : 0.027, valid loss : 0.055, train f1 : 0.957, valid f1 : 0.610
EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [2:38:09<4:55:47, 213.82s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 45, best f1 score : 0.707
training process - Deferred Re-weighting:  35%|███▌      | 45/128 [2:41:20<4:57:35, 215.13s/it]
training process finished, best loss : 0.036, best acc : 0.970, best f1 : 0.707, best epoch : 33

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.27      0.75      0.39        71
           1       1.00      0.96      0.98      3978

    accuracy                           0.96      4049
   macro avg       0.63      0.85      0.69      4049
weighted avg       0.98      0.96      0.97      4049


# test acc : 0.96, test f1 : 0.69, test AUC : 0.85, test loss : 1.788

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/979 [00:00<?, ?it/s]  0%|          | 2/979 [00:00<01:05, 15.00it/s]  0%|          | 4/979 [00:00<01:09, 14.10it/s]  1%|          | 6/979 [00:00<01:13, 13.18it/s]  1%|          | 8/979 [00:00<01:25, 11.37it/s]  1%|          | 10/979 [00:00<01:34, 10.29it/s]  1%|          | 12/979 [00:01<01:44,  9.25it/s]  1%|▏         | 14/979 [00:01<01:27, 11.08it/s]  2%|▏         | 17/979 [00:01<01:05, 14.63it/s]  2%|▏         | 20/979 [00:01<00:54, 17.52it/s]  2%|▏         | 23/979 [00:01<00:48, 19.81it/s]  3%|▎         | 26/979 [00:01<00:43, 21.77it/s]  3%|▎         | 29/979 [00:01<00:41, 23.16it/s]  3%|▎         | 32/979 [00:01<00:39, 24.18it/s]  4%|▎         | 35/979 [00:02<00:37, 24.90it/s]  4%|▍         | 38/979 [00:02<00:38, 24.41it/s]  4%|▍         | 41/979 [00:02<00:43, 21.68it/s]  4%|▍         | 44/979 [00:02<00:54, 17.07it/s]  5%|▍         | 46/979 [00:02<01:07, 13.77it/s]  5%|▍         | 48/979 [00:03<01:18, 11.88it/s]  5%|▌         | 50/979 [00:03<01:20, 11.47it/s]  5%|▌         | 52/979 [00:03<01:21, 11.36it/s]  6%|▌         | 55/979 [00:03<01:07, 13.77it/s]  6%|▌         | 58/979 [00:03<00:56, 16.43it/s]  6%|▌         | 61/979 [00:03<00:48, 18.79it/s]  7%|▋         | 64/979 [00:03<00:44, 20.50it/s]  7%|▋         | 67/979 [00:04<00:41, 21.81it/s]  7%|▋         | 70/979 [00:04<00:40, 22.47it/s]  7%|▋         | 73/979 [00:04<00:51, 17.67it/s]  8%|▊         | 75/979 [00:04<01:05, 13.77it/s]  8%|▊         | 77/979 [00:04<01:17, 11.69it/s]  8%|▊         | 79/979 [00:05<01:23, 10.84it/s]  8%|▊         | 81/979 [00:05<01:24, 10.58it/s]  9%|▊         | 84/979 [00:05<01:07, 13.29it/s]  9%|▉         | 87/979 [00:05<00:56, 15.93it/s]  9%|▉         | 90/979 [00:05<00:48, 18.19it/s]  9%|▉         | 93/979 [00:05<00:44, 20.11it/s] 10%|▉         | 96/979 [00:05<00:40, 21.78it/s] 10%|█         | 99/979 [00:06<00:38, 22.94it/s] 10%|█         | 102/979 [00:06<00:36, 23.84it/s] 11%|█         | 105/979 [00:06<00:36, 23.99it/s] 11%|█         | 108/979 [00:06<00:38, 22.36it/s] 11%|█▏        | 111/979 [00:06<00:45, 19.08it/s] 12%|█▏        | 114/979 [00:06<00:50, 17.11it/s] 12%|█▏        | 116/979 [00:07<00:51, 16.77it/s] 12%|█▏        | 118/979 [00:07<01:00, 14.20it/s] 12%|█▏        | 120/979 [00:07<01:08, 12.49it/s] 12%|█▏        | 122/979 [00:07<01:05, 13.00it/s] 13%|█▎        | 125/979 [00:07<00:53, 15.97it/s] 13%|█▎        | 128/979 [00:07<00:45, 18.54it/s] 13%|█▎        | 131/979 [00:07<00:41, 20.59it/s] 14%|█▎        | 134/979 [00:08<00:38, 22.08it/s] 14%|█▍        | 137/979 [00:08<00:36, 23.03it/s] 14%|█▍        | 140/979 [00:08<00:35, 23.83it/s] 15%|█▍        | 143/979 [00:08<00:34, 23.99it/s] 15%|█▍        | 146/979 [00:08<00:37, 22.36it/s] 15%|█▌        | 149/979 [00:08<00:42, 19.46it/s] 16%|█▌        | 152/979 [00:09<00:56, 14.74it/s] 16%|█▌        | 154/979 [00:09<01:04, 12.84it/s] 16%|█▌        | 156/979 [00:09<01:05, 12.64it/s] 16%|█▌        | 158/979 [00:09<01:02, 13.23it/s] 16%|█▋        | 160/979 [00:09<01:00, 13.57it/s] 17%|█▋        | 163/979 [00:09<00:49, 16.53it/s] 17%|█▋        | 166/979 [00:09<00:42, 18.94it/s] 17%|█▋        | 169/979 [00:10<00:38, 21.00it/s] 18%|█▊        | 172/979 [00:10<00:35, 22.55it/s] 18%|█▊        | 175/979 [00:10<00:33, 23.71it/s] 18%|█▊        | 178/979 [00:10<00:32, 24.61it/s] 18%|█▊        | 181/979 [00:10<00:33, 23.82it/s] 19%|█▉        | 184/979 [00:10<00:41, 19.18it/s] 19%|█▉        | 187/979 [00:11<00:52, 14.95it/s] 19%|█▉        | 189/979 [00:11<01:02, 12.62it/s] 20%|█▉        | 191/979 [00:11<01:01, 12.82it/s] 20%|█▉        | 193/979 [00:11<00:57, 13.59it/s] 20%|██        | 196/979 [00:11<00:47, 16.34it/s] 20%|██        | 199/979 [00:11<00:42, 18.50it/s] 21%|██        | 202/979 [00:11<00:37, 20.51it/s] 21%|██        | 205/979 [00:12<00:34, 22.20it/s] 21%|██        | 208/979 [00:12<00:33, 23.30it/s] 22%|██▏       | 211/979 [00:12<00:31, 24.06it/s] 22%|██▏       | 214/979 [00:12<00:31, 24.28it/s] 22%|██▏       | 217/979 [00:12<00:32, 23.22it/s] 22%|██▏       | 220/979 [00:12<00:39, 19.15it/s] 23%|██▎       | 223/979 [00:13<00:50, 14.87it/s] 23%|██▎       | 225/979 [00:13<01:01, 12.32it/s] 23%|██▎       | 227/979 [00:13<00:58, 12.76it/s] 23%|██▎       | 229/979 [00:13<00:58, 12.74it/s] 24%|██▎       | 231/979 [00:13<00:53, 14.02it/s] 24%|██▍       | 234/979 [00:13<00:45, 16.48it/s] 24%|██▍       | 237/979 [00:13<00:39, 18.58it/s] 25%|██▍       | 240/979 [00:14<00:37, 19.80it/s] 25%|██▍       | 243/979 [00:14<00:34, 21.18it/s] 25%|██▌       | 246/979 [00:14<00:32, 22.39it/s] 25%|██▌       | 249/979 [00:14<00:31, 23.20it/s] 26%|██▌       | 252/979 [00:14<00:34, 21.11it/s] 26%|██▌       | 255/979 [00:14<00:39, 18.39it/s] 26%|██▋       | 257/979 [00:15<00:46, 15.55it/s] 26%|██▋       | 259/979 [00:15<00:55, 13.07it/s] 27%|██▋       | 261/979 [00:15<00:58, 12.28it/s] 27%|██▋       | 263/979 [00:15<01:06, 10.84it/s] 27%|██▋       | 266/979 [00:15<00:52, 13.46it/s] 27%|██▋       | 269/979 [00:15<00:44, 15.91it/s] 28%|██▊       | 272/979 [00:16<00:40, 17.51it/s] 28%|██▊       | 275/979 [00:16<00:36, 19.29it/s] 28%|██▊       | 278/979 [00:16<00:33, 20.96it/s] 29%|██▊       | 281/979 [00:16<00:31, 22.11it/s] 29%|██▉       | 284/979 [00:16<00:30, 22.99it/s] 29%|██▉       | 287/979 [00:16<00:29, 23.34it/s] 30%|██▉       | 290/979 [00:17<00:43, 15.97it/s] 30%|██▉       | 292/979 [00:17<00:50, 13.60it/s] 30%|███       | 294/979 [00:17<00:49, 13.84it/s] 30%|███       | 296/979 [00:17<00:48, 14.01it/s] 30%|███       | 298/979 [00:17<00:49, 13.75it/s] 31%|███       | 300/979 [00:17<00:55, 12.31it/s] 31%|███       | 303/979 [00:17<00:46, 14.69it/s] 31%|███▏      | 306/979 [00:18<00:39, 17.18it/s] 32%|███▏      | 309/979 [00:18<00:34, 19.47it/s] 32%|███▏      | 312/979 [00:18<00:31, 21.17it/s] 32%|███▏      | 315/979 [00:18<00:29, 22.65it/s] 32%|███▏      | 318/979 [00:18<00:27, 23.85it/s] 33%|███▎      | 321/979 [00:18<00:26, 24.83it/s] 33%|███▎      | 324/979 [00:18<00:27, 24.06it/s] 33%|███▎      | 327/979 [00:19<00:34, 18.65it/s] 34%|███▎      | 330/979 [00:19<00:48, 13.52it/s] 34%|███▍      | 332/979 [00:19<00:50, 12.72it/s] 34%|███▍      | 334/979 [00:19<00:56, 11.51it/s] 34%|███▍      | 336/979 [00:19<00:51, 12.52it/s] 35%|███▍      | 339/979 [00:20<00:41, 15.38it/s] 35%|███▍      | 342/979 [00:20<00:35, 17.91it/s] 35%|███▌      | 345/979 [00:20<00:32, 19.44it/s] 36%|███▌      | 348/979 [00:20<00:32, 19.66it/s] 36%|███▌      | 351/979 [00:20<00:29, 21.32it/s] 36%|███▌      | 354/979 [00:20<00:27, 22.59it/s] 36%|███▋      | 357/979 [00:20<00:27, 22.35it/s] 37%|███▋      | 360/979 [00:21<00:31, 19.51it/s] 37%|███▋      | 363/979 [00:21<00:42, 14.63it/s] 37%|███▋      | 365/979 [00:21<00:50, 12.04it/s] 37%|███▋      | 367/979 [00:21<01:00, 10.12it/s] 38%|███▊      | 370/979 [00:22<00:49, 12.18it/s] 38%|███▊      | 373/979 [00:22<00:41, 14.72it/s] 38%|███▊      | 376/979 [00:22<00:35, 17.08it/s] 39%|███▊      | 379/979 [00:22<00:31, 19.05it/s] 39%|███▉      | 382/979 [00:22<00:28, 20.67it/s] 39%|███▉      | 385/979 [00:22<00:26, 22.01it/s] 40%|███▉      | 388/979 [00:22<00:25, 22.87it/s] 40%|███▉      | 391/979 [00:22<00:25, 22.72it/s] 40%|████      | 394/979 [00:23<00:32, 18.24it/s] 41%|████      | 397/979 [00:23<00:44, 12.98it/s] 41%|████      | 399/979 [00:23<00:47, 12.31it/s] 41%|████      | 401/979 [00:23<00:50, 11.47it/s] 41%|████      | 403/979 [00:24<00:47, 12.20it/s] 41%|████▏     | 406/979 [00:24<00:38, 14.90it/s] 42%|████▏     | 409/979 [00:24<00:32, 17.35it/s] 42%|████▏     | 412/979 [00:24<00:29, 19.35it/s] 42%|████▏     | 415/979 [00:24<00:26, 20.94it/s] 43%|████▎     | 418/979 [00:24<00:25, 22.12it/s] 43%|████▎     | 421/979 [00:24<00:24, 23.02it/s] 43%|████▎     | 424/979 [00:24<00:24, 22.91it/s] 44%|████▎     | 427/979 [00:25<00:31, 17.36it/s] 44%|████▍     | 429/979 [00:25<00:36, 15.10it/s] 44%|████▍     | 431/979 [00:25<00:42, 13.01it/s] 44%|████▍     | 433/979 [00:25<00:47, 11.55it/s] 44%|████▍     | 435/979 [00:26<00:49, 11.08it/s] 45%|████▍     | 438/979 [00:26<00:38, 13.98it/s] 45%|████▌     | 441/979 [00:26<00:32, 16.51it/s] 45%|████▌     | 444/979 [00:26<00:28, 18.61it/s] 46%|████▌     | 447/979 [00:26<00:26, 20.45it/s] 46%|████▌     | 450/979 [00:26<00:23, 22.04it/s] 46%|████▋     | 453/979 [00:26<00:22, 23.23it/s] 47%|████▋     | 456/979 [00:26<00:21, 24.13it/s] 47%|████▋     | 459/979 [00:26<00:21, 24.37it/s] 47%|████▋     | 462/979 [00:27<00:23, 21.55it/s] 47%|████▋     | 465/979 [00:27<00:26, 19.42it/s] 48%|████▊     | 468/979 [00:27<00:28, 18.13it/s] 48%|████▊     | 470/979 [00:27<00:28, 17.59it/s] 48%|████▊     | 472/979 [00:27<00:29, 17.17it/s] 48%|████▊     | 474/979 [00:27<00:29, 16.84it/s] 49%|████▊     | 476/979 [00:28<00:31, 16.08it/s] 49%|████▉     | 478/979 [00:28<00:30, 16.24it/s] 49%|████▉     | 481/979 [00:28<00:26, 19.07it/s] 49%|████▉     | 484/979 [00:28<00:23, 21.25it/s] 50%|████▉     | 487/979 [00:28<00:21, 22.80it/s] 50%|█████     | 490/979 [00:28<00:20, 23.65it/s] 50%|█████     | 493/979 [00:28<00:19, 24.54it/s] 51%|█████     | 496/979 [00:28<00:19, 25.26it/s] 51%|█████     | 499/979 [00:28<00:18, 25.90it/s] 51%|█████▏    | 502/979 [00:29<00:19, 24.28it/s] 52%|█████▏    | 505/979 [00:29<00:25, 18.56it/s] 52%|█████▏    | 508/979 [00:29<00:30, 15.33it/s] 52%|█████▏    | 510/979 [00:29<00:34, 13.79it/s] 52%|█████▏    | 512/979 [00:29<00:35, 13.04it/s] 53%|█████▎    | 514/979 [00:30<00:38, 12.03it/s] 53%|█████▎    | 516/979 [00:30<00:35, 13.16it/s] 53%|█████▎    | 518/979 [00:30<00:31, 14.44it/s] 53%|█████▎    | 520/979 [00:30<00:29, 15.52it/s] 53%|█████▎    | 523/979 [00:30<00:25, 17.91it/s] 54%|█████▎    | 526/979 [00:30<00:22, 20.21it/s] 54%|█████▍    | 529/979 [00:30<00:20, 21.97it/s] 54%|█████▍    | 532/979 [00:30<00:19, 23.21it/s] 55%|█████▍    | 535/979 [00:31<00:18, 24.23it/s] 55%|█████▍    | 538/979 [00:31<00:17, 24.60it/s] 55%|█████▌    | 541/979 [00:31<00:20, 21.90it/s] 56%|█████▌    | 544/979 [00:31<00:21, 19.83it/s] 56%|█████▌    | 547/979 [00:31<00:22, 18.80it/s] 56%|█████▌    | 549/979 [00:31<00:23, 18.14it/s] 56%|█████▋    | 551/979 [00:31<00:24, 17.69it/s] 56%|█████▋    | 553/979 [00:32<00:25, 16.57it/s] 57%|█████▋    | 555/979 [00:32<00:26, 15.87it/s] 57%|█████▋    | 557/979 [00:32<00:26, 16.19it/s] 57%|█████▋    | 560/979 [00:32<00:21, 19.18it/s] 58%|█████▊    | 563/979 [00:32<00:19, 21.59it/s] 58%|█████▊    | 566/979 [00:32<00:17, 23.38it/s] 58%|█████▊    | 569/979 [00:32<00:16, 24.63it/s] 58%|█████▊    | 572/979 [00:32<00:15, 25.49it/s] 59%|█████▊    | 575/979 [00:33<00:15, 26.08it/s] 59%|█████▉    | 578/979 [00:33<00:15, 26.27it/s] 59%|█████▉    | 581/979 [00:33<00:15, 25.94it/s] 60%|█████▉    | 584/979 [00:33<00:18, 20.94it/s] 60%|█████▉    | 587/979 [00:33<00:19, 20.18it/s] 60%|██████    | 590/979 [00:33<00:20, 19.19it/s] 61%|██████    | 593/979 [00:33<00:21, 18.13it/s] 61%|██████    | 595/979 [00:34<00:21, 17.63it/s] 61%|██████    | 597/979 [00:34<00:21, 17.48it/s] 61%|██████    | 599/979 [00:34<00:26, 14.61it/s] 61%|██████▏   | 602/979 [00:34<00:22, 17.12it/s] 62%|██████▏   | 605/979 [00:34<00:19, 19.32it/s] 62%|██████▏   | 608/979 [00:34<00:17, 21.07it/s] 62%|██████▏   | 611/979 [00:34<00:16, 22.41it/s] 63%|██████▎   | 614/979 [00:34<00:15, 24.03it/s] 63%|██████▎   | 617/979 [00:35<00:14, 25.37it/s] 63%|██████▎   | 620/979 [00:35<00:13, 26.39it/s] 64%|██████▎   | 623/979 [00:35<00:13, 26.53it/s] 64%|██████▍   | 626/979 [00:35<00:15, 23.05it/s] 64%|██████▍   | 629/979 [00:35<00:17, 20.37it/s] 65%|██████▍   | 632/979 [00:35<00:18, 18.53it/s] 65%|██████▍   | 634/979 [00:35<00:19, 17.81it/s] 65%|██████▍   | 636/979 [00:36<00:20, 16.81it/s] 65%|██████▌   | 638/979 [00:36<00:25, 13.62it/s] 65%|██████▌   | 640/979 [00:36<00:23, 14.53it/s] 66%|██████▌   | 643/979 [00:36<00:19, 17.29it/s] 66%|██████▌   | 646/979 [00:36<00:16, 19.69it/s] 66%|██████▋   | 649/979 [00:36<00:15, 21.61it/s] 67%|██████▋   | 652/979 [00:36<00:14, 23.11it/s] 67%|██████▋   | 655/979 [00:37<00:13, 24.45it/s] 67%|██████▋   | 658/979 [00:37<00:12, 25.53it/s] 68%|██████▊   | 661/979 [00:37<00:12, 26.14it/s] 68%|██████▊   | 664/979 [00:37<00:12, 26.20it/s] 68%|██████▊   | 667/979 [00:37<00:12, 24.96it/s] 68%|██████▊   | 670/979 [00:37<00:17, 17.38it/s] 69%|██████▊   | 673/979 [00:37<00:19, 16.09it/s] 69%|██████▉   | 675/979 [00:38<00:21, 14.24it/s] 69%|██████▉   | 677/979 [00:38<00:24, 12.27it/s] 69%|██████▉   | 679/979 [00:38<00:24, 12.13it/s] 70%|██████▉   | 682/979 [00:38<00:20, 14.53it/s] 70%|██████▉   | 685/979 [00:38<00:17, 17.24it/s] 70%|███████   | 688/979 [00:38<00:14, 19.65it/s] 71%|███████   | 691/979 [00:39<00:13, 21.67it/s] 71%|███████   | 694/979 [00:39<00:12, 23.32it/s] 71%|███████   | 697/979 [00:39<00:11, 24.71it/s] 72%|███████▏  | 700/979 [00:39<00:10, 25.74it/s] 72%|███████▏  | 703/979 [00:39<00:10, 25.32it/s] 72%|███████▏  | 706/979 [00:39<00:13, 20.86it/s] 72%|███████▏  | 709/979 [00:40<00:18, 14.63it/s] 73%|███████▎  | 711/979 [00:40<00:18, 14.25it/s] 73%|███████▎  | 713/979 [00:40<00:18, 14.58it/s] 73%|███████▎  | 715/979 [00:40<00:19, 13.24it/s] 73%|███████▎  | 718/979 [00:40<00:16, 16.16it/s] 74%|███████▎  | 721/979 [00:40<00:13, 18.81it/s] 74%|███████▍  | 724/979 [00:40<00:12, 21.02it/s] 74%|███████▍  | 727/979 [00:40<00:11, 22.85it/s] 75%|███████▍  | 730/979 [00:41<00:10, 24.15it/s] 75%|███████▍  | 733/979 [00:41<00:09, 25.15it/s] 75%|███████▌  | 736/979 [00:41<00:09, 25.94it/s] 75%|███████▌  | 739/979 [00:41<00:09, 26.44it/s] 76%|███████▌  | 742/979 [00:41<00:09, 25.52it/s] 76%|███████▌  | 745/979 [00:41<00:10, 21.84it/s] 76%|███████▋  | 748/979 [00:41<00:12, 19.01it/s] 77%|███████▋  | 751/979 [00:42<00:16, 14.13it/s] 77%|███████▋  | 753/979 [00:42<00:17, 13.25it/s] 77%|███████▋  | 755/979 [00:42<00:18, 12.36it/s] 77%|███████▋  | 758/979 [00:42<00:14, 14.85it/s] 78%|███████▊  | 761/979 [00:42<00:12, 17.16it/s] 78%|███████▊  | 764/979 [00:42<00:11, 19.07it/s] 78%|███████▊  | 767/979 [00:43<00:10, 19.67it/s] 79%|███████▊  | 770/979 [00:43<00:10, 20.42it/s] 79%|███████▉  | 773/979 [00:43<00:10, 20.03it/s] 79%|███████▉  | 776/979 [00:43<00:10, 19.67it/s] 80%|███████▉  | 779/979 [00:43<00:11, 17.65it/s] 80%|███████▉  | 781/979 [00:43<00:13, 14.89it/s] 80%|███████▉  | 783/979 [00:44<00:16, 12.08it/s] 80%|████████  | 785/979 [00:44<00:15, 12.14it/s] 80%|████████  | 787/979 [00:44<00:15, 12.28it/s] 81%|████████  | 789/979 [00:44<00:14, 13.21it/s] 81%|████████  | 792/979 [00:44<00:11, 15.62it/s] 81%|████████  | 795/979 [00:44<00:09, 18.42it/s] 82%|████████▏ | 798/979 [00:45<00:08, 20.13it/s] 82%|████████▏ | 801/979 [00:45<00:08, 21.12it/s] 82%|████████▏ | 804/979 [00:45<00:07, 23.18it/s] 83%|████████▎ | 808/979 [00:45<00:06, 25.77it/s] 83%|████████▎ | 812/979 [00:45<00:05, 27.92it/s] 83%|████████▎ | 815/979 [00:45<00:06, 26.30it/s] 84%|████████▎ | 818/979 [00:45<00:06, 23.69it/s] 84%|████████▍ | 821/979 [00:46<00:07, 20.03it/s] 84%|████████▍ | 824/979 [00:46<00:07, 19.69it/s] 84%|████████▍ | 827/979 [00:46<00:07, 19.46it/s] 85%|████████▍ | 830/979 [00:46<00:07, 19.29it/s] 85%|████████▍ | 832/979 [00:46<00:07, 18.62it/s] 85%|████████▌ | 834/979 [00:46<00:07, 18.70it/s] 85%|████████▌ | 837/979 [00:46<00:06, 21.25it/s] 86%|████████▌ | 841/979 [00:46<00:05, 24.10it/s] 86%|████████▌ | 844/979 [00:47<00:05, 25.51it/s] 87%|████████▋ | 848/979 [00:47<00:04, 27.24it/s] 87%|████████▋ | 852/979 [00:47<00:04, 28.54it/s] 87%|████████▋ | 856/979 [00:47<00:04, 29.21it/s] 88%|████████▊ | 860/979 [00:47<00:04, 29.66it/s] 88%|████████▊ | 863/979 [00:47<00:04, 26.48it/s] 88%|████████▊ | 866/979 [00:47<00:05, 20.38it/s] 89%|████████▉ | 869/979 [00:48<00:06, 16.37it/s] 89%|████████▉ | 871/979 [00:48<00:08, 13.21it/s] 89%|████████▉ | 873/979 [00:48<00:08, 12.45it/s] 89%|████████▉ | 876/979 [00:48<00:06, 15.05it/s] 90%|████████▉ | 879/979 [00:48<00:05, 17.74it/s] 90%|█████████ | 882/979 [00:49<00:04, 20.13it/s] 90%|█████████ | 885/979 [00:49<00:04, 22.11it/s] 91%|█████████ | 888/979 [00:49<00:03, 23.74it/s] 91%|█████████ | 891/979 [00:49<00:03, 24.12it/s] 91%|█████████▏| 894/979 [00:49<00:03, 23.67it/s] 92%|█████████▏| 897/979 [00:49<00:03, 25.02it/s] 92%|█████████▏| 900/979 [00:49<00:03, 25.49it/s] 92%|█████████▏| 903/979 [00:49<00:03, 19.94it/s] 93%|█████████▎| 906/979 [00:50<00:04, 16.27it/s] 93%|█████████▎| 908/979 [00:50<00:05, 13.86it/s] 93%|█████████▎| 910/979 [00:50<00:05, 13.08it/s] 93%|█████████▎| 912/979 [00:50<00:05, 12.58it/s] 93%|█████████▎| 914/979 [00:50<00:04, 13.70it/s] 94%|█████████▎| 916/979 [00:50<00:04, 14.76it/s] 94%|█████████▍| 918/979 [00:51<00:03, 15.64it/s] 94%|█████████▍| 920/979 [00:51<00:03, 16.01it/s] 94%|█████████▍| 922/979 [00:51<00:03, 16.51it/s] 94%|█████████▍| 924/979 [00:51<00:03, 16.57it/s] 95%|█████████▍| 926/979 [00:51<00:03, 16.99it/s] 95%|█████████▍| 928/979 [00:51<00:02, 17.45it/s] 95%|█████████▍| 930/979 [00:51<00:02, 16.69it/s] 95%|█████████▌| 932/979 [00:51<00:03, 15.29it/s] 95%|█████████▌| 934/979 [00:52<00:02, 15.84it/s] 96%|█████████▌| 936/979 [00:52<00:02, 15.53it/s] 96%|█████████▌| 938/979 [00:52<00:02, 15.62it/s] 96%|█████████▌| 940/979 [00:52<00:02, 13.37it/s] 96%|█████████▋| 943/979 [00:52<00:02, 15.96it/s] 97%|█████████▋| 946/979 [00:52<00:01, 18.45it/s] 97%|█████████▋| 948/979 [00:52<00:01, 18.57it/s] 97%|█████████▋| 952/979 [00:53<00:01, 22.34it/s] 98%|█████████▊| 956/979 [00:53<00:00, 25.04it/s] 98%|█████████▊| 960/979 [00:53<00:00, 26.86it/s] 98%|█████████▊| 964/979 [00:53<00:00, 27.91it/s] 99%|█████████▉| 968/979 [00:53<00:00, 28.90it/s] 99%|█████████▉| 972/979 [00:53<00:00, 29.87it/s]100%|█████████▉| 975/979 [00:53<00:00, 29.70it/s]100%|█████████▉| 978/979 [00:53<00:00, 26.94it/s]100%|██████████| 979/979 [00:54<00:00, 18.13it/s]
time :  1336
prob :  1336
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_1_Focal_RS_DRW_seed_42
train data : 14427, disrupt : 227, non-disrupt : 14200
valid data : 3519, disrupt : 57, non-disrupt : 3462
test data : 4062, disrupt : 71, non-disrupt : 3991

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.057, valid loss : 0.046, train f1 : 0.889, valid f1 : 0.601
Best score increase :0.000 -> 0.601
training process - Deferred Re-weighting:   1%|          | 1/128 [04:16<9:02:56, 256.51s/it]Best score increase :0.601 -> 0.617
training process - Deferred Re-weighting:   2%|▏         | 2/128 [08:03<8:21:37, 238.87s/it]Best score increase :0.617 -> 0.654
training process - Deferred Re-weighting:   2%|▏         | 3/128 [11:33<7:51:03, 226.11s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [14:46<7:19:49, 212.82s/it]epoch : 5, train loss : 0.023, valid loss : 0.064, train f1 : 0.953, valid f1 : 0.584
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [18:49<7:38:30, 223.67s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [22:03<7:14:04, 213.48s/it]Best score increase :0.654 -> 0.661
training process - Deferred Re-weighting:   5%|▌         | 7/128 [25:30<7:06:44, 211.61s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [28:46<6:52:59, 206.50s/it]epoch : 9, train loss : 0.021, valid loss : 0.021, train f1 : 0.959, valid f1 : 0.644
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [32:49<7:12:05, 217.86s/it]Best score increase :0.661 -> 0.706
training process - Deferred Re-weighting:   8%|▊         | 10/128 [36:03<6:53:53, 210.45s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [39:13<6:38:27, 204.34s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [42:29<6:30:07, 201.78s/it]epoch : 13, train loss : 0.020, valid loss : 0.019, train f1 : 0.962, valid f1 : 0.662
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [46:32<6:50:50, 214.35s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [49:44<6:34:19, 207.54s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [52:55<6:21:25, 202.53s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [56:08<6:12:45, 199.69s/it]epoch : 17, train loss : 0.019, valid loss : 0.017, train f1 : 0.963, valid f1 : 0.675
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [1:00:07<6:31:03, 211.38s/it]Best score increase :0.706 -> 0.710
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:03:21<6:18:15, 206.32s/it]Best score increase :0.710 -> 0.752
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:06:38<6:09:40, 203.49s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:09:54<6:02:17, 201.28s/it]epoch : 21, train loss : 0.020, valid loss : 0.014, train f1 : 0.963, valid f1 : 0.681
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:13:55<6:20:12, 213.20s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:17:15<6:09:33, 209.18s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:20:33<6:00:27, 205.98s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:23:47<5:50:33, 202.24s/it]epoch : 25, train loss : 0.019, valid loss : 0.026, train f1 : 0.965, valid f1 : 0.769
Best score increase :0.752 -> 0.769
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:27:51<6:08:36, 214.73s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:31:06<5:55:06, 208.89s/it]Best score increase :0.769 -> 0.882
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:34:44<5:56:25, 211.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:38:51<6:10:07, 222.07s/it]epoch : 29, train loss : 0.017, valid loss : 0.018, train f1 : 0.970, valid f1 : 0.733
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:42:55<6:17:25, 228.74s/it]Best score increase :0.882 -> 0.921
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [1:46:09<5:56:50, 218.47s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:49:21<5:40:19, 210.51s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [1:52:36<5:29:22, 205.86s/it]epoch : 33, train loss : 0.016, valid loss : 0.019, train f1 : 0.970, valid f1 : 0.717
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [1:56:38<5:43:06, 216.70s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [1:59:53<5:29:01, 210.02s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [2:03:09<5:19:06, 205.88s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [2:06:23<5:10:23, 202.43s/it]epoch : 37, train loss : 0.016, valid loss : 0.021, train f1 : 0.970, valid f1 : 0.713
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [2:10:20<5:22:36, 212.71s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [2:13:37<5:11:59, 208.00s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [2:16:56<5:04:29, 205.27s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  31%|███▏      | 40/128 [2:20:13<4:57:13, 202.66s/it]epoch : 41, train loss : 0.015, valid loss : 0.028, train f1 : 0.973, valid f1 : 0.715
EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [2:24:09<5:08:34, 212.81s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 41, best f1 score : 0.921
training process - Deferred Re-weighting:  32%|███▏      | 41/128 [2:27:24<5:12:47, 215.72s/it]
training process finished, best loss : 0.009, best acc : 0.995, best f1 : 0.921, best epoch : 29

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.84      0.92      0.88        71
           1       1.00      1.00      1.00      3991

    accuracy                           1.00      4062
   macro avg       0.92      0.96      0.94      4062
weighted avg       1.00      1.00      1.00      4062


# test acc : 1.00, test f1 : 0.94, test AUC : 0.96, test loss : 0.289

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/983 [00:00<?, ?it/s]  0%|          | 3/983 [00:00<00:51, 19.04it/s]  1%|          | 5/983 [00:00<01:04, 15.09it/s]  1%|          | 7/983 [00:00<01:18, 12.49it/s]  1%|          | 9/983 [00:00<01:34, 10.27it/s]  1%|          | 11/983 [00:01<01:41,  9.60it/s]  1%|▏         | 13/983 [00:01<01:40,  9.63it/s]  2%|▏         | 16/983 [00:01<01:18, 12.36it/s]  2%|▏         | 18/983 [00:01<01:10, 13.75it/s]  2%|▏         | 21/983 [00:01<00:59, 16.29it/s]  2%|▏         | 24/983 [00:01<00:51, 18.66it/s]  3%|▎         | 27/983 [00:01<00:46, 20.60it/s]  3%|▎         | 30/983 [00:01<00:43, 21.80it/s]  3%|▎         | 33/983 [00:02<00:41, 22.71it/s]  4%|▎         | 36/983 [00:02<00:41, 22.59it/s]  4%|▍         | 39/983 [00:02<00:49, 19.19it/s]  4%|▍         | 42/983 [00:02<01:13, 12.84it/s]  4%|▍         | 44/983 [00:03<01:23, 11.22it/s]  5%|▍         | 46/983 [00:03<01:23, 11.21it/s]  5%|▍         | 49/983 [00:03<01:07, 13.79it/s]  5%|▌         | 52/983 [00:03<00:57, 16.27it/s]  6%|▌         | 55/983 [00:03<00:50, 18.51it/s]  6%|▌         | 58/983 [00:03<00:45, 20.36it/s]  6%|▌         | 61/983 [00:03<00:42, 21.71it/s]  7%|▋         | 64/983 [00:03<00:40, 22.60it/s]  7%|▋         | 67/983 [00:04<00:39, 23.36it/s]  7%|▋         | 70/983 [00:04<00:39, 23.18it/s]  7%|▋         | 73/983 [00:04<00:42, 21.41it/s]  8%|▊         | 76/983 [00:04<00:52, 17.12it/s]  8%|▊         | 78/983 [00:04<00:56, 16.04it/s]  8%|▊         | 80/983 [00:04<00:59, 15.10it/s]  8%|▊         | 82/983 [00:05<01:06, 13.46it/s]  9%|▊         | 84/983 [00:05<01:10, 12.74it/s]  9%|▉         | 87/983 [00:05<00:57, 15.48it/s]  9%|▉         | 90/983 [00:05<00:49, 18.06it/s]  9%|▉         | 93/983 [00:05<00:43, 20.25it/s] 10%|▉         | 96/983 [00:05<00:40, 21.96it/s] 10%|█         | 99/983 [00:05<00:37, 23.30it/s] 10%|█         | 102/983 [00:05<00:36, 24.27it/s] 11%|█         | 105/983 [00:06<00:35, 25.00it/s] 11%|█         | 108/983 [00:06<00:35, 24.73it/s] 11%|█▏        | 111/983 [00:06<00:52, 16.67it/s] 12%|█▏        | 114/983 [00:06<01:09, 12.50it/s] 12%|█▏        | 116/983 [00:07<01:14, 11.63it/s] 12%|█▏        | 118/983 [00:07<01:17, 11.21it/s] 12%|█▏        | 120/983 [00:07<01:12, 11.96it/s] 13%|█▎        | 123/983 [00:07<00:58, 14.76it/s] 13%|█▎        | 126/983 [00:07<00:49, 17.26it/s] 13%|█▎        | 129/983 [00:07<00:44, 19.36it/s] 13%|█▎        | 132/983 [00:07<00:40, 21.01it/s] 14%|█▎        | 135/983 [00:08<00:38, 22.28it/s] 14%|█▍        | 138/983 [00:08<00:36, 23.09it/s] 14%|█▍        | 141/983 [00:08<00:40, 20.54it/s] 15%|█▍        | 144/983 [00:08<00:50, 16.77it/s] 15%|█▍        | 146/983 [00:08<01:02, 13.41it/s] 15%|█▌        | 148/983 [00:09<01:07, 12.39it/s] 15%|█▌        | 150/983 [00:09<01:09, 11.91it/s] 15%|█▌        | 152/983 [00:09<01:17, 10.78it/s] 16%|█▌        | 155/983 [00:09<01:01, 13.52it/s] 16%|█▌        | 158/983 [00:09<00:51, 16.13it/s] 16%|█▋        | 161/983 [00:09<00:44, 18.36it/s] 17%|█▋        | 164/983 [00:09<00:40, 20.20it/s] 17%|█▋        | 167/983 [00:10<00:37, 21.72it/s] 17%|█▋        | 170/983 [00:10<00:35, 22.89it/s] 18%|█▊        | 173/983 [00:10<00:34, 23.71it/s] 18%|█▊        | 176/983 [00:10<00:38, 20.80it/s] 18%|█▊        | 179/983 [00:10<00:43, 18.37it/s] 18%|█▊        | 181/983 [00:10<00:46, 17.31it/s] 19%|█▊        | 183/983 [00:10<00:47, 16.77it/s] 19%|█▉        | 185/983 [00:11<00:50, 15.87it/s] 19%|█▉        | 187/983 [00:11<01:00, 13.06it/s] 19%|█▉        | 189/983 [00:11<01:02, 12.70it/s] 19%|█▉        | 191/983 [00:11<01:02, 12.71it/s] 20%|█▉        | 194/983 [00:11<00:51, 15.42it/s] 20%|██        | 197/983 [00:11<00:43, 18.13it/s] 20%|██        | 200/983 [00:12<00:38, 20.29it/s] 21%|██        | 203/983 [00:12<00:40, 19.39it/s] 21%|██        | 206/983 [00:12<00:37, 20.72it/s] 21%|██▏       | 209/983 [00:12<00:34, 22.37it/s] 22%|██▏       | 212/983 [00:12<00:33, 22.69it/s] 22%|██▏       | 215/983 [00:12<00:38, 19.99it/s] 22%|██▏       | 218/983 [00:12<00:42, 18.21it/s] 22%|██▏       | 220/983 [00:13<00:45, 16.92it/s] 23%|██▎       | 222/983 [00:13<00:50, 14.97it/s] 23%|██▎       | 224/983 [00:13<00:53, 14.26it/s] 23%|██▎       | 226/983 [00:13<00:54, 13.82it/s] 23%|██▎       | 229/983 [00:13<00:46, 16.10it/s] 24%|██▎       | 232/983 [00:13<00:40, 18.58it/s] 24%|██▍       | 235/983 [00:13<00:36, 20.59it/s] 24%|██▍       | 238/983 [00:14<00:33, 22.12it/s] 25%|██▍       | 241/983 [00:14<00:31, 23.25it/s] 25%|██▍       | 244/983 [00:14<00:30, 23.98it/s] 25%|██▌       | 247/983 [00:14<00:30, 24.35it/s] 25%|██▌       | 250/983 [00:14<00:29, 24.71it/s] 26%|██▌       | 253/983 [00:14<00:36, 20.02it/s] 26%|██▌       | 256/983 [00:14<00:39, 18.60it/s] 26%|██▌       | 258/983 [00:15<00:42, 17.14it/s] 26%|██▋       | 260/983 [00:15<00:47, 15.09it/s] 27%|██▋       | 262/983 [00:15<00:51, 13.98it/s] 27%|██▋       | 264/983 [00:15<00:55, 12.86it/s] 27%|██▋       | 266/983 [00:15<00:53, 13.30it/s] 27%|██▋       | 269/983 [00:15<00:46, 15.51it/s] 28%|██▊       | 272/983 [00:16<00:39, 18.07it/s] 28%|██▊       | 275/983 [00:16<00:35, 20.21it/s] 28%|██▊       | 278/983 [00:16<00:32, 21.82it/s] 29%|██▊       | 281/983 [00:16<00:30, 23.11it/s] 29%|██▉       | 284/983 [00:16<00:30, 23.00it/s] 29%|██▉       | 287/983 [00:16<00:34, 20.40it/s] 30%|██▉       | 290/983 [00:16<00:44, 15.62it/s] 30%|██▉       | 292/983 [00:17<00:48, 14.32it/s] 30%|██▉       | 294/983 [00:17<01:01, 11.27it/s] 30%|███       | 296/983 [00:17<01:12,  9.46it/s] 30%|███       | 298/983 [00:17<01:06, 10.24it/s] 31%|███       | 300/983 [00:18<00:58, 11.61it/s] 31%|███       | 303/983 [00:18<00:46, 14.52it/s] 31%|███       | 306/983 [00:18<00:39, 17.23it/s] 31%|███▏      | 309/983 [00:18<00:34, 19.37it/s] 32%|███▏      | 312/983 [00:18<00:31, 21.09it/s] 32%|███▏      | 315/983 [00:18<00:29, 22.47it/s] 32%|███▏      | 318/983 [00:18<00:28, 23.19it/s] 33%|███▎      | 321/983 [00:18<00:28, 22.90it/s] 33%|███▎      | 324/983 [00:19<00:41, 16.03it/s] 33%|███▎      | 326/983 [00:19<00:49, 13.38it/s] 33%|███▎      | 328/983 [00:19<00:52, 12.51it/s] 34%|███▎      | 330/983 [00:19<00:55, 11.87it/s] 34%|███▍      | 332/983 [00:19<00:50, 12.81it/s] 34%|███▍      | 335/983 [00:20<00:41, 15.60it/s] 34%|███▍      | 338/983 [00:20<00:35, 17.95it/s] 35%|███▍      | 341/983 [00:20<00:32, 19.92it/s] 35%|███▍      | 344/983 [00:20<00:29, 21.73it/s] 35%|███▌      | 347/983 [00:20<00:27, 23.29it/s] 36%|███▌      | 350/983 [00:20<00:25, 24.39it/s] 36%|███▌      | 353/983 [00:20<00:25, 25.12it/s] 36%|███▌      | 356/983 [00:20<00:25, 24.44it/s] 37%|███▋      | 359/983 [00:21<00:30, 20.66it/s] 37%|███▋      | 362/983 [00:21<00:43, 14.40it/s] 37%|███▋      | 364/983 [00:21<00:46, 13.20it/s] 37%|███▋      | 366/983 [00:21<00:48, 12.60it/s] 37%|███▋      | 368/983 [00:21<00:53, 11.46it/s] 38%|███▊      | 371/983 [00:22<00:43, 14.15it/s] 38%|███▊      | 374/983 [00:22<00:36, 16.47it/s] 38%|███▊      | 377/983 [00:22<00:32, 18.77it/s] 39%|███▊      | 380/983 [00:22<00:28, 20.80it/s] 39%|███▉      | 383/983 [00:22<00:26, 22.34it/s] 39%|███▉      | 386/983 [00:22<00:25, 23.63it/s] 40%|███▉      | 389/983 [00:22<00:24, 24.67it/s] 40%|███▉      | 392/983 [00:22<00:23, 24.96it/s] 40%|████      | 395/983 [00:23<00:24, 23.69it/s] 40%|████      | 398/983 [00:23<00:28, 20.63it/s] 41%|████      | 401/983 [00:23<00:31, 18.54it/s] 41%|████      | 403/983 [00:23<00:32, 17.88it/s] 41%|████      | 405/983 [00:23<00:33, 17.36it/s] 41%|████▏     | 407/983 [00:23<00:35, 16.41it/s] 42%|████▏     | 409/983 [00:23<00:38, 14.90it/s] 42%|████▏     | 411/983 [00:24<00:36, 15.71it/s] 42%|████▏     | 414/983 [00:24<00:30, 18.63it/s] 42%|████▏     | 417/983 [00:24<00:28, 19.56it/s] 43%|████▎     | 420/983 [00:24<00:28, 19.75it/s] 43%|████▎     | 423/983 [00:24<00:26, 21.34it/s] 43%|████▎     | 426/983 [00:24<00:24, 22.98it/s] 44%|████▎     | 429/983 [00:24<00:22, 24.33it/s] 44%|████▍     | 432/983 [00:24<00:21, 25.30it/s] 44%|████▍     | 435/983 [00:25<00:22, 24.65it/s] 45%|████▍     | 438/983 [00:25<00:26, 20.51it/s] 45%|████▍     | 441/983 [00:25<00:41, 13.16it/s] 45%|████▌     | 443/983 [00:25<00:41, 12.95it/s] 45%|████▌     | 445/983 [00:26<00:43, 12.42it/s] 45%|████▌     | 447/983 [00:26<00:41, 12.97it/s] 46%|████▌     | 450/983 [00:26<00:34, 15.27it/s] 46%|████▌     | 453/983 [00:26<00:30, 17.47it/s] 46%|████▋     | 456/983 [00:26<00:27, 19.34it/s] 47%|████▋     | 459/983 [00:26<00:25, 20.70it/s] 47%|████▋     | 462/983 [00:26<00:23, 21.72it/s] 47%|████▋     | 465/983 [00:26<00:22, 23.11it/s] 48%|████▊     | 468/983 [00:27<00:21, 24.24it/s] 48%|████▊     | 471/983 [00:27<00:21, 23.90it/s] 48%|████▊     | 474/983 [00:27<00:22, 22.56it/s] 49%|████▊     | 477/983 [00:27<00:25, 19.82it/s] 49%|████▉     | 480/983 [00:27<00:28, 17.51it/s] 49%|████▉     | 482/983 [00:27<00:29, 17.14it/s] 49%|████▉     | 484/983 [00:27<00:29, 16.84it/s] 49%|████▉     | 486/983 [00:28<00:31, 15.91it/s] 50%|████▉     | 488/983 [00:28<00:30, 16.00it/s] 50%|████▉     | 490/983 [00:28<00:30, 16.14it/s] 50%|█████     | 493/983 [00:28<00:26, 18.82it/s] 50%|█████     | 496/983 [00:28<00:23, 21.13it/s] 51%|█████     | 499/983 [00:28<00:21, 22.91it/s] 51%|█████     | 502/983 [00:28<00:19, 24.26it/s] 51%|█████▏    | 505/983 [00:28<00:18, 25.25it/s] 52%|█████▏    | 508/983 [00:28<00:18, 26.06it/s] 52%|█████▏    | 511/983 [00:29<00:18, 26.17it/s] 52%|█████▏    | 514/983 [00:29<00:21, 21.48it/s] 53%|█████▎    | 517/983 [00:29<00:28, 16.55it/s] 53%|█████▎    | 519/983 [00:29<00:30, 15.01it/s] 53%|█████▎    | 521/983 [00:29<00:32, 14.30it/s] 53%|█████▎    | 523/983 [00:30<00:32, 13.97it/s] 53%|█████▎    | 525/983 [00:30<00:34, 13.13it/s] 54%|█████▎    | 528/983 [00:30<00:28, 15.86it/s] 54%|█████▍    | 531/983 [00:30<00:24, 18.55it/s] 54%|█████▍    | 534/983 [00:30<00:21, 20.80it/s] 55%|█████▍    | 537/983 [00:30<00:19, 22.64it/s] 55%|█████▍    | 540/983 [00:30<00:18, 24.08it/s] 55%|█████▌    | 543/983 [00:30<00:17, 25.20it/s] 56%|█████▌    | 546/983 [00:31<00:16, 26.13it/s] 56%|█████▌    | 549/983 [00:31<00:16, 26.93it/s] 56%|█████▌    | 552/983 [00:31<00:16, 26.37it/s] 56%|█████▋    | 555/983 [00:31<00:19, 21.88it/s] 57%|█████▋    | 558/983 [00:31<00:21, 19.93it/s] 57%|█████▋    | 561/983 [00:31<00:22, 18.79it/s] 57%|█████▋    | 563/983 [00:31<00:24, 17.29it/s] 57%|█████▋    | 565/983 [00:32<00:26, 15.61it/s] 58%|█████▊    | 567/983 [00:32<00:30, 13.63it/s] 58%|█████▊    | 570/983 [00:32<00:25, 16.36it/s] 58%|█████▊    | 573/983 [00:32<00:22, 17.90it/s] 59%|█████▊    | 576/983 [00:32<00:21, 19.26it/s] 59%|█████▉    | 579/983 [00:32<00:19, 21.17it/s] 59%|█████▉    | 582/983 [00:32<00:17, 22.99it/s] 60%|█████▉    | 585/983 [00:33<00:16, 24.48it/s] 60%|█████▉    | 588/983 [00:33<00:15, 25.75it/s] 60%|██████    | 591/983 [00:33<00:14, 26.16it/s] 60%|██████    | 594/983 [00:33<00:17, 21.65it/s] 61%|██████    | 597/983 [00:33<00:20, 18.92it/s] 61%|██████    | 600/983 [00:33<00:21, 18.06it/s] 61%|██████▏   | 603/983 [00:33<00:20, 18.18it/s] 62%|██████▏   | 605/983 [00:34<00:21, 17.56it/s] 62%|██████▏   | 607/983 [00:34<00:21, 17.24it/s] 62%|██████▏   | 609/983 [00:34<00:22, 16.47it/s] 62%|██████▏   | 612/983 [00:34<00:20, 18.37it/s] 63%|██████▎   | 615/983 [00:34<00:17, 20.66it/s] 63%|██████▎   | 618/983 [00:34<00:16, 22.57it/s] 63%|██████▎   | 621/983 [00:34<00:15, 24.03it/s] 63%|██████▎   | 624/983 [00:34<00:14, 25.13it/s] 64%|██████▍   | 627/983 [00:35<00:13, 25.98it/s] 64%|██████▍   | 630/983 [00:35<00:13, 26.63it/s] 64%|██████▍   | 633/983 [00:35<00:12, 27.18it/s] 65%|██████▍   | 636/983 [00:35<00:13, 26.34it/s] 65%|██████▌   | 639/983 [00:35<00:15, 22.39it/s] 65%|██████▌   | 642/983 [00:35<00:19, 17.07it/s] 66%|██████▌   | 644/983 [00:35<00:19, 17.02it/s] 66%|██████▌   | 646/983 [00:36<00:21, 15.80it/s] 66%|██████▌   | 648/983 [00:36<00:21, 15.65it/s] 66%|██████▌   | 650/983 [00:36<00:23, 14.18it/s] 66%|██████▋   | 652/983 [00:36<00:22, 14.55it/s] 67%|██████▋   | 655/983 [00:36<00:18, 17.39it/s] 67%|██████▋   | 658/983 [00:36<00:16, 19.75it/s] 67%|██████▋   | 661/983 [00:36<00:14, 21.73it/s] 68%|██████▊   | 664/983 [00:36<00:13, 23.32it/s] 68%|██████▊   | 667/983 [00:37<00:12, 24.55it/s] 68%|██████▊   | 670/983 [00:37<00:12, 25.55it/s] 68%|██████▊   | 673/983 [00:37<00:11, 26.20it/s] 69%|██████▉   | 676/983 [00:37<00:12, 25.52it/s] 69%|██████▉   | 679/983 [00:37<00:14, 21.59it/s] 69%|██████▉   | 682/983 [00:37<00:15, 19.50it/s] 70%|██████▉   | 685/983 [00:38<00:17, 16.93it/s] 70%|██████▉   | 687/983 [00:38<00:18, 16.13it/s] 70%|███████   | 689/983 [00:38<00:20, 14.64it/s] 70%|███████   | 691/983 [00:38<00:22, 13.15it/s] 71%|███████   | 694/983 [00:38<00:18, 15.92it/s] 71%|███████   | 697/983 [00:38<00:15, 18.30it/s] 71%|███████   | 700/983 [00:38<00:13, 20.22it/s] 72%|███████▏  | 703/983 [00:38<00:12, 22.23it/s] 72%|███████▏  | 706/983 [00:39<00:11, 23.84it/s] 72%|███████▏  | 709/983 [00:39<00:10, 25.02it/s] 72%|███████▏  | 712/983 [00:39<00:10, 25.83it/s] 73%|███████▎  | 715/983 [00:39<00:10, 25.73it/s] 73%|███████▎  | 718/983 [00:39<00:12, 21.28it/s] 73%|███████▎  | 721/983 [00:39<00:15, 16.62it/s] 74%|███████▎  | 723/983 [00:40<00:16, 16.08it/s] 74%|███████▍  | 725/983 [00:40<00:16, 15.94it/s] 74%|███████▍  | 727/983 [00:40<00:15, 16.76it/s] 74%|███████▍  | 729/983 [00:40<00:17, 14.43it/s] 74%|███████▍  | 732/983 [00:40<00:15, 16.47it/s] 75%|███████▍  | 735/983 [00:40<00:13, 18.75it/s] 75%|███████▌  | 738/983 [00:40<00:11, 20.63it/s] 75%|███████▌  | 741/983 [00:40<00:11, 21.97it/s] 76%|███████▌  | 744/983 [00:41<00:10, 22.97it/s] 76%|███████▌  | 747/983 [00:41<00:10, 23.53it/s] 76%|███████▋  | 750/983 [00:41<00:09, 23.94it/s] 77%|███████▋  | 753/983 [00:41<00:09, 24.28it/s] 77%|███████▋  | 756/983 [00:41<00:11, 20.35it/s] 77%|███████▋  | 759/983 [00:41<00:11, 18.74it/s] 77%|███████▋  | 761/983 [00:41<00:13, 16.85it/s] 78%|███████▊  | 763/983 [00:42<00:13, 16.86it/s] 78%|███████▊  | 765/983 [00:42<00:12, 17.00it/s] 78%|███████▊  | 767/983 [00:42<00:13, 15.63it/s] 78%|███████▊  | 769/983 [00:42<00:14, 14.47it/s] 78%|███████▊  | 771/983 [00:42<00:14, 14.73it/s] 79%|███████▊  | 774/983 [00:42<00:12, 17.31it/s] 79%|███████▉  | 777/983 [00:42<00:10, 19.46it/s] 79%|███████▉  | 780/983 [00:43<00:09, 21.16it/s] 80%|███████▉  | 783/983 [00:43<00:08, 22.52it/s] 80%|███████▉  | 786/983 [00:43<00:08, 23.62it/s] 80%|████████  | 789/983 [00:43<00:07, 24.40it/s] 81%|████████  | 792/983 [00:43<00:08, 22.43it/s] 81%|████████  | 795/983 [00:43<00:08, 22.12it/s] 81%|████████  | 798/983 [00:43<00:10, 18.22it/s] 81%|████████▏ | 800/983 [00:44<00:11, 15.96it/s] 82%|████████▏ | 802/983 [00:44<00:11, 15.31it/s] 82%|████████▏ | 804/983 [00:44<00:12, 14.76it/s] 82%|████████▏ | 806/983 [00:44<00:11, 14.78it/s] 82%|████████▏ | 808/983 [00:44<00:11, 14.65it/s] 82%|████████▏ | 810/983 [00:44<00:11, 15.12it/s] 83%|████████▎ | 813/983 [00:44<00:09, 18.04it/s] 83%|████████▎ | 816/983 [00:44<00:08, 20.78it/s] 83%|████████▎ | 819/983 [00:45<00:07, 22.86it/s] 84%|████████▎ | 822/983 [00:45<00:06, 24.48it/s] 84%|████████▍ | 825/983 [00:45<00:06, 25.41it/s] 84%|████████▍ | 828/983 [00:45<00:05, 26.25it/s] 85%|████████▍ | 831/983 [00:45<00:06, 23.90it/s] 85%|████████▍ | 834/983 [00:45<00:06, 24.00it/s] 85%|████████▌ | 837/983 [00:45<00:05, 24.42it/s] 85%|████████▌ | 840/983 [00:45<00:06, 22.39it/s] 86%|████████▌ | 843/983 [00:46<00:06, 21.24it/s] 86%|████████▌ | 846/983 [00:46<00:06, 20.55it/s] 86%|████████▋ | 849/983 [00:46<00:06, 20.13it/s] 87%|████████▋ | 852/983 [00:46<00:06, 19.84it/s] 87%|████████▋ | 855/983 [00:46<00:06, 19.02it/s] 87%|████████▋ | 858/983 [00:46<00:06, 20.34it/s] 88%|████████▊ | 862/983 [00:47<00:05, 23.34it/s] 88%|████████▊ | 866/983 [00:47<00:04, 25.61it/s] 89%|████████▊ | 870/983 [00:47<00:04, 27.35it/s] 89%|████████▉ | 874/983 [00:47<00:03, 28.69it/s] 89%|████████▉ | 878/983 [00:47<00:03, 29.57it/s] 90%|████████▉ | 882/983 [00:47<00:03, 30.31it/s] 90%|█████████ | 886/983 [00:47<00:03, 28.24it/s] 90%|█████████ | 889/983 [00:47<00:03, 25.19it/s] 91%|█████████ | 892/983 [00:48<00:03, 23.21it/s] 91%|█████████ | 895/983 [00:48<00:04, 21.07it/s] 91%|█████████▏| 898/983 [00:48<00:04, 20.35it/s] 92%|█████████▏| 901/983 [00:48<00:04, 19.12it/s] 92%|█████████▏| 903/983 [00:48<00:04, 18.54it/s] 92%|█████████▏| 905/983 [00:48<00:04, 18.63it/s] 92%|█████████▏| 908/983 [00:48<00:03, 21.16it/s] 93%|█████████▎| 912/983 [00:49<00:02, 24.30it/s] 93%|█████████▎| 916/983 [00:49<00:02, 26.56it/s] 94%|█████████▎| 920/983 [00:49<00:02, 28.23it/s] 94%|█████████▍| 924/983 [00:49<00:02, 29.16it/s] 94%|█████████▍| 928/983 [00:49<00:01, 30.02it/s] 95%|█████████▍| 932/983 [00:49<00:01, 30.58it/s] 95%|█████████▌| 936/983 [00:49<00:01, 26.73it/s] 96%|█████████▌| 939/983 [00:50<00:01, 23.22it/s] 96%|█████████▌| 942/983 [00:50<00:01, 21.92it/s] 96%|█████████▌| 945/983 [00:50<00:01, 21.02it/s] 96%|█████████▋| 948/983 [00:50<00:01, 20.40it/s] 97%|█████████▋| 951/983 [00:50<00:01, 19.97it/s] 97%|█████████▋| 954/983 [00:50<00:01, 18.94it/s] 97%|█████████▋| 957/983 [00:51<00:01, 21.01it/s] 98%|█████████▊| 961/983 [00:51<00:00, 23.70it/s] 98%|█████████▊| 965/983 [00:51<00:00, 25.96it/s] 99%|█████████▊| 969/983 [00:51<00:00, 27.62it/s] 99%|█████████▉| 973/983 [00:51<00:00, 26.34it/s] 99%|█████████▉| 977/983 [00:51<00:00, 27.72it/s]100%|█████████▉| 980/983 [00:51<00:00, 28.16it/s]100%|██████████| 983/983 [00:51<00:00, 23.60it/s]100%|██████████| 983/983 [00:51<00:00, 18.92it/s]
time :  1340
prob :  1340
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_2_Focal_RS_DRW_seed_42
train data : 14418, disrupt : 227, non-disrupt : 14191
valid data : 3514, disrupt : 57, non-disrupt : 3457
test data : 4058, disrupt : 71, non-disrupt : 3987

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.065, valid loss : 0.106, train f1 : 0.878, valid f1 : 0.497
Best score increase :0.000 -> 0.497
training process - Deferred Re-weighting:   1%|          | 1/128 [04:01<8:31:38, 241.72s/it]Best score increase :0.497 -> 0.629
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:20<7:34:19, 216.34s/it]Best score increase :0.629 -> 0.745
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:34<7:09:23, 206.11s/it]Best score increase :0.745 -> 0.890
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:47<6:55:30, 201.05s/it]epoch : 5, train loss : 0.026, valid loss : 0.021, train f1 : 0.954, valid f1 : 0.691
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:45<7:19:15, 214.28s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [21:01<7:02:55, 208.00s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:19<6:53:27, 205.02s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [27:37<6:45:06, 202.55s/it]epoch : 9, train loss : 0.022, valid loss : 0.016, train f1 : 0.958, valid f1 : 0.922
Best score increase :0.890 -> 0.922
training process - Deferred Re-weighting:   7%|▋         | 9/128 [31:40<7:06:40, 215.13s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [34:50<6:48:19, 207.62s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [38:02<6:35:22, 202.76s/it]Best score increase :0.922 -> 0.933
training process - Deferred Re-weighting:   9%|▉         | 12/128 [41:17<6:27:15, 200.31s/it]epoch : 13, train loss : 0.019, valid loss : 0.020, train f1 : 0.964, valid f1 : 0.874
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [45:12<6:43:55, 210.74s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [48:24<6:30:01, 205.28s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [51:38<6:19:52, 201.70s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [54:54<6:13:24, 200.04s/it]epoch : 17, train loss : 0.019, valid loss : 0.015, train f1 : 0.963, valid f1 : 0.723
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [59:00<6:35:59, 214.05s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:02:13<6:20:22, 207.48s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:05:25<6:08:31, 202.86s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:08:34<5:58:04, 198.93s/it]epoch : 21, train loss : 0.018, valid loss : 0.020, train f1 : 0.965, valid f1 : 0.684
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:12:31<6:14:55, 210.24s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:15:47<6:03:36, 205.81s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:19:07<5:57:34, 204.33s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 23, best f1 score : 0.933
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:22:18<6:15:46, 214.73s/it]
training process finished, best loss : 0.012, best acc : 0.996, best f1 : 0.933, best epoch : 11

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.86      0.87      0.87        71
           1       1.00      1.00      1.00      3987

    accuracy                           1.00      4058
   macro avg       0.93      0.94      0.93      4058
weighted avg       1.00      1.00      1.00      4058


# test acc : 1.00, test f1 : 0.93, test AUC : 0.94, test loss : 0.477

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/982 [00:00<?, ?it/s]  0%|          | 2/982 [00:00<01:03, 15.49it/s]  0%|          | 4/982 [00:00<00:57, 16.87it/s]  1%|          | 6/982 [00:00<00:59, 16.34it/s]  1%|          | 8/982 [00:00<01:01, 15.88it/s]  1%|          | 10/982 [00:00<01:01, 15.88it/s]  1%|          | 12/982 [00:00<01:04, 14.99it/s]  1%|▏         | 14/982 [00:00<01:06, 14.58it/s]  2%|▏         | 16/982 [00:01<01:05, 14.76it/s]  2%|▏         | 18/982 [00:01<01:14, 12.86it/s]  2%|▏         | 21/982 [00:01<00:59, 16.06it/s]  2%|▏         | 24/982 [00:01<00:51, 18.69it/s]  3%|▎         | 27/982 [00:01<00:46, 20.64it/s]  3%|▎         | 30/982 [00:01<00:42, 22.15it/s]  3%|▎         | 33/982 [00:01<00:43, 21.85it/s]  4%|▎         | 36/982 [00:02<00:44, 21.05it/s]  4%|▍         | 39/982 [00:02<00:44, 21.32it/s]  4%|▍         | 42/982 [00:02<00:52, 17.87it/s]  4%|▍         | 44/982 [00:02<00:58, 16.15it/s]  5%|▍         | 46/982 [00:02<01:11, 13.18it/s]  5%|▍         | 48/982 [00:03<01:22, 11.26it/s]  5%|▌         | 50/982 [00:03<01:22, 11.26it/s]  5%|▌         | 52/982 [00:03<01:15, 12.37it/s]  5%|▌         | 54/982 [00:03<01:09, 13.27it/s]  6%|▌         | 57/982 [00:03<00:57, 16.21it/s]  6%|▌         | 60/982 [00:03<00:48, 18.96it/s]  6%|▋         | 63/982 [00:03<00:43, 21.20it/s]  7%|▋         | 66/982 [00:03<00:40, 22.86it/s]  7%|▋         | 69/982 [00:04<00:38, 24.03it/s]  7%|▋         | 72/982 [00:04<00:36, 24.93it/s]  8%|▊         | 75/982 [00:04<00:37, 24.10it/s]  8%|▊         | 78/982 [00:04<00:44, 20.18it/s]  8%|▊         | 81/982 [00:04<00:48, 18.67it/s]  8%|▊         | 83/982 [00:04<00:54, 16.43it/s]  9%|▊         | 85/982 [00:05<01:08, 13.11it/s]  9%|▉         | 87/982 [00:05<01:05, 13.71it/s]  9%|▉         | 89/982 [00:05<01:12, 12.38it/s]  9%|▉         | 92/982 [00:05<01:00, 14.74it/s] 10%|▉         | 95/982 [00:05<00:51, 17.32it/s] 10%|▉         | 98/982 [00:05<00:45, 19.44it/s] 10%|█         | 101/982 [00:05<00:41, 21.10it/s] 11%|█         | 104/982 [00:05<00:39, 22.31it/s] 11%|█         | 107/982 [00:06<00:37, 23.22it/s] 11%|█         | 110/982 [00:06<00:41, 20.99it/s] 12%|█▏        | 113/982 [00:06<00:47, 18.18it/s] 12%|█▏        | 115/982 [00:06<00:50, 17.30it/s] 12%|█▏        | 117/982 [00:06<00:58, 14.72it/s] 12%|█▏        | 119/982 [00:06<01:00, 14.20it/s] 12%|█▏        | 121/982 [00:07<01:02, 13.86it/s] 13%|█▎        | 123/982 [00:07<01:04, 13.31it/s] 13%|█▎        | 125/982 [00:07<01:03, 13.43it/s] 13%|█▎        | 127/982 [00:07<00:59, 14.47it/s] 13%|█▎        | 130/982 [00:07<00:50, 16.72it/s] 14%|█▎        | 133/982 [00:07<00:44, 19.06it/s] 14%|█▍        | 136/982 [00:07<00:39, 21.16it/s] 14%|█▍        | 139/982 [00:08<00:37, 22.70it/s] 14%|█▍        | 142/982 [00:08<00:34, 24.21it/s] 15%|█▍        | 145/982 [00:08<00:33, 25.25it/s] 15%|█▌        | 148/982 [00:08<00:31, 26.17it/s] 15%|█▌        | 151/982 [00:08<00:34, 23.92it/s] 16%|█▌        | 154/982 [00:08<00:39, 20.81it/s] 16%|█▌        | 157/982 [00:08<00:43, 18.83it/s] 16%|█▋        | 160/982 [00:09<00:46, 17.87it/s] 16%|█▋        | 162/982 [00:09<00:48, 16.78it/s] 17%|█▋        | 164/982 [00:09<00:49, 16.58it/s] 17%|█▋        | 166/982 [00:09<00:51, 15.92it/s] 17%|█▋        | 168/982 [00:09<00:48, 16.83it/s] 17%|█▋        | 171/982 [00:09<00:41, 19.60it/s] 18%|█▊        | 174/982 [00:09<00:36, 21.85it/s] 18%|█▊        | 177/982 [00:09<00:34, 23.60it/s] 18%|█▊        | 180/982 [00:10<00:32, 24.98it/s] 19%|█▊        | 183/982 [00:10<00:30, 25.78it/s] 19%|█▉        | 186/982 [00:10<00:30, 26.44it/s] 19%|█▉        | 189/982 [00:10<00:29, 27.09it/s] 20%|█▉        | 192/982 [00:10<00:29, 27.12it/s] 20%|█▉        | 195/982 [00:10<00:33, 23.36it/s] 20%|██        | 198/982 [00:10<00:38, 20.48it/s] 20%|██        | 201/982 [00:10<00:41, 18.84it/s] 21%|██        | 204/982 [00:11<00:45, 16.97it/s] 21%|██        | 206/982 [00:11<00:47, 16.47it/s] 21%|██        | 208/982 [00:11<00:49, 15.71it/s] 21%|██▏       | 210/982 [00:11<00:48, 16.01it/s] 22%|██▏       | 213/982 [00:11<00:41, 18.63it/s] 22%|██▏       | 216/982 [00:11<00:36, 20.87it/s] 22%|██▏       | 219/982 [00:11<00:33, 22.66it/s] 23%|██▎       | 222/982 [00:12<00:32, 23.67it/s] 23%|██▎       | 225/982 [00:12<00:30, 24.48it/s] 23%|██▎       | 228/982 [00:12<00:29, 25.16it/s] 24%|██▎       | 231/982 [00:12<00:29, 25.30it/s] 24%|██▍       | 234/982 [00:12<00:32, 22.73it/s] 24%|██▍       | 237/982 [00:12<00:46, 15.92it/s] 24%|██▍       | 239/982 [00:13<00:48, 15.19it/s] 25%|██▍       | 241/982 [00:13<00:48, 15.23it/s] 25%|██▍       | 243/982 [00:13<00:48, 15.10it/s] 25%|██▍       | 245/982 [00:13<00:48, 15.20it/s] 25%|██▌       | 247/982 [00:13<00:49, 14.79it/s] 25%|██▌       | 249/982 [00:13<00:46, 15.91it/s] 26%|██▌       | 252/982 [00:13<00:38, 18.84it/s] 26%|██▌       | 255/982 [00:13<00:34, 20.97it/s] 26%|██▋       | 258/982 [00:14<00:32, 22.60it/s] 27%|██▋       | 261/982 [00:14<00:30, 23.75it/s] 27%|██▋       | 264/982 [00:14<00:29, 24.48it/s] 27%|██▋       | 267/982 [00:14<00:28, 25.03it/s] 27%|██▋       | 270/982 [00:14<00:27, 25.50it/s] 28%|██▊       | 273/982 [00:14<00:30, 22.92it/s] 28%|██▊       | 276/982 [00:14<00:37, 18.66it/s] 28%|██▊       | 279/982 [00:15<00:49, 14.22it/s] 29%|██▊       | 281/982 [00:15<00:51, 13.55it/s] 29%|██▉       | 283/982 [00:15<00:53, 12.95it/s] 29%|██▉       | 285/982 [00:15<00:52, 13.35it/s] 29%|██▉       | 288/982 [00:15<00:43, 15.81it/s] 30%|██▉       | 291/982 [00:15<00:38, 18.07it/s] 30%|██▉       | 294/982 [00:16<00:34, 19.87it/s] 30%|███       | 297/982 [00:16<00:32, 21.29it/s] 31%|███       | 300/982 [00:16<00:30, 22.30it/s] 31%|███       | 303/982 [00:16<00:29, 23.09it/s] 31%|███       | 306/982 [00:16<00:28, 23.47it/s] 31%|███▏      | 309/982 [00:16<00:31, 21.27it/s] 32%|███▏      | 312/982 [00:16<00:34, 19.69it/s] 32%|███▏      | 315/982 [00:17<00:34, 19.15it/s] 32%|███▏      | 317/982 [00:17<00:38, 17.32it/s] 32%|███▏      | 319/982 [00:17<00:42, 15.66it/s] 33%|███▎      | 321/982 [00:17<00:48, 13.68it/s] 33%|███▎      | 323/982 [00:17<00:54, 12.12it/s] 33%|███▎      | 326/982 [00:17<00:44, 14.83it/s] 34%|███▎      | 329/982 [00:18<00:37, 17.34it/s] 34%|███▍      | 332/982 [00:18<00:33, 19.22it/s] 34%|███▍      | 335/982 [00:18<00:32, 19.90it/s] 34%|███▍      | 338/982 [00:18<00:30, 21.21it/s] 35%|███▍      | 341/982 [00:18<00:36, 17.56it/s] 35%|███▌      | 344/982 [00:18<00:34, 18.23it/s] 35%|███▌      | 346/982 [00:18<00:38, 16.66it/s] 35%|███▌      | 348/982 [00:19<00:40, 15.46it/s] 36%|███▌      | 350/982 [00:19<00:45, 13.79it/s] 36%|███▌      | 352/982 [00:19<00:51, 12.15it/s] 36%|███▌      | 354/982 [00:19<00:55, 11.35it/s] 36%|███▋      | 356/982 [00:19<00:58, 10.67it/s] 36%|███▋      | 358/982 [00:20<00:56, 11.09it/s] 37%|███▋      | 360/982 [00:20<00:51, 12.10it/s] 37%|███▋      | 363/982 [00:20<00:41, 15.00it/s] 37%|███▋      | 366/982 [00:20<00:36, 16.86it/s] 38%|███▊      | 369/982 [00:20<00:32, 18.73it/s] 38%|███▊      | 372/982 [00:20<00:29, 20.42it/s] 38%|███▊      | 375/982 [00:20<00:28, 21.31it/s] 38%|███▊      | 378/982 [00:21<00:31, 19.29it/s] 39%|███▉      | 381/982 [00:21<00:36, 16.49it/s] 39%|███▉      | 383/982 [00:21<00:39, 15.20it/s] 39%|███▉      | 385/982 [00:21<00:42, 13.98it/s] 39%|███▉      | 387/982 [00:21<00:40, 14.83it/s] 40%|███▉      | 389/982 [00:21<00:43, 13.53it/s] 40%|███▉      | 391/982 [00:22<00:41, 14.28it/s] 40%|████      | 394/982 [00:22<00:34, 17.08it/s] 40%|████      | 397/982 [00:22<00:30, 19.25it/s] 41%|████      | 400/982 [00:22<00:27, 20.91it/s] 41%|████      | 403/982 [00:22<00:25, 22.38it/s] 41%|████▏     | 406/982 [00:22<00:24, 23.71it/s] 42%|████▏     | 409/982 [00:22<00:23, 24.69it/s] 42%|████▏     | 412/982 [00:22<00:22, 25.02it/s] 42%|████▏     | 415/982 [00:22<00:23, 23.63it/s] 43%|████▎     | 418/982 [00:23<00:28, 19.73it/s] 43%|████▎     | 421/982 [00:23<00:31, 18.10it/s] 43%|████▎     | 423/982 [00:23<00:33, 16.89it/s] 43%|████▎     | 425/982 [00:23<00:33, 16.69it/s] 43%|████▎     | 427/982 [00:23<00:35, 15.77it/s] 44%|████▎     | 429/982 [00:23<00:39, 14.14it/s] 44%|████▍     | 431/982 [00:24<00:38, 14.28it/s] 44%|████▍     | 434/982 [00:24<00:32, 16.97it/s] 45%|████▍     | 437/982 [00:24<00:28, 19.15it/s] 45%|████▍     | 440/982 [00:24<00:26, 20.84it/s] 45%|████▌     | 443/982 [00:24<00:24, 22.10it/s] 45%|████▌     | 446/982 [00:24<00:23, 22.98it/s] 46%|████▌     | 449/982 [00:24<00:22, 23.60it/s] 46%|████▌     | 452/982 [00:24<00:22, 23.91it/s] 46%|████▋     | 455/982 [00:25<00:22, 22.97it/s] 47%|████▋     | 458/982 [00:25<00:24, 21.31it/s] 47%|████▋     | 461/982 [00:25<00:29, 17.84it/s] 47%|████▋     | 463/982 [00:25<00:32, 15.88it/s] 47%|████▋     | 465/982 [00:25<00:37, 13.72it/s] 48%|████▊     | 467/982 [00:26<00:43, 11.89it/s] 48%|████▊     | 469/982 [00:26<00:39, 12.95it/s] 48%|████▊     | 472/982 [00:26<00:32, 15.78it/s] 48%|████▊     | 475/982 [00:26<00:27, 18.32it/s] 49%|████▊     | 478/982 [00:26<00:24, 20.42it/s] 49%|████▉     | 481/982 [00:26<00:22, 22.20it/s] 49%|████▉     | 484/982 [00:26<00:21, 23.59it/s] 50%|████▉     | 487/982 [00:26<00:20, 24.56it/s] 50%|████▉     | 490/982 [00:27<00:19, 25.26it/s] 50%|█████     | 493/982 [00:27<00:20, 24.31it/s] 51%|█████     | 496/982 [00:27<00:23, 20.84it/s] 51%|█████     | 499/982 [00:27<00:25, 19.07it/s] 51%|█████     | 502/982 [00:27<00:26, 17.97it/s] 51%|█████▏    | 504/982 [00:27<00:27, 17.48it/s] 52%|█████▏    | 506/982 [00:27<00:27, 17.12it/s] 52%|█████▏    | 508/982 [00:28<00:37, 12.51it/s] 52%|█████▏    | 511/982 [00:28<00:31, 14.87it/s] 52%|█████▏    | 514/982 [00:28<00:27, 17.09it/s] 53%|█████▎    | 517/982 [00:28<00:24, 19.24it/s] 53%|█████▎    | 520/982 [00:28<00:21, 21.02it/s] 53%|█████▎    | 523/982 [00:28<00:20, 22.37it/s] 54%|█████▎    | 526/982 [00:28<00:19, 23.30it/s] 54%|█████▍    | 529/982 [00:29<00:18, 23.94it/s] 54%|█████▍    | 532/982 [00:29<00:19, 23.59it/s] 54%|█████▍    | 535/982 [00:29<00:21, 20.85it/s] 55%|█████▍    | 538/982 [00:29<00:23, 19.04it/s] 55%|█████▌    | 541/982 [00:29<00:27, 16.19it/s] 55%|█████▌    | 543/982 [00:29<00:28, 15.50it/s] 55%|█████▌    | 545/982 [00:30<00:29, 14.80it/s] 56%|█████▌    | 547/982 [00:30<00:33, 13.12it/s] 56%|█████▌    | 550/982 [00:30<00:27, 15.94it/s] 56%|█████▋    | 553/982 [00:30<00:23, 18.34it/s] 57%|█████▋    | 556/982 [00:30<00:20, 20.30it/s] 57%|█████▋    | 559/982 [00:30<00:19, 21.86it/s] 57%|█████▋    | 562/982 [00:30<00:18, 23.08it/s] 58%|█████▊    | 565/982 [00:31<00:17, 23.80it/s] 58%|█████▊    | 568/982 [00:31<00:18, 22.87it/s] 58%|█████▊    | 571/982 [00:31<00:18, 22.52it/s] 58%|█████▊    | 574/982 [00:31<00:20, 20.18it/s] 59%|█████▉    | 577/982 [00:31<00:22, 17.83it/s] 59%|█████▉    | 579/982 [00:31<00:26, 15.40it/s] 59%|█████▉    | 581/982 [00:32<00:28, 13.90it/s] 59%|█████▉    | 583/982 [00:32<00:29, 13.59it/s] 60%|█████▉    | 585/982 [00:32<00:28, 13.83it/s] 60%|█████▉    | 587/982 [00:32<00:26, 14.86it/s] 60%|██████    | 590/982 [00:32<00:21, 17.98it/s] 60%|██████    | 593/982 [00:32<00:18, 20.57it/s] 61%|██████    | 596/982 [00:32<00:17, 22.34it/s] 61%|██████    | 599/982 [00:32<00:15, 24.00it/s] 61%|██████▏   | 602/982 [00:33<00:15, 25.12it/s] 62%|██████▏   | 605/982 [00:33<00:14, 26.02it/s] 62%|██████▏   | 608/982 [00:33<00:13, 26.81it/s] 62%|██████▏   | 611/982 [00:33<00:14, 26.20it/s] 63%|██████▎   | 614/982 [00:33<00:16, 22.36it/s] 63%|██████▎   | 617/982 [00:33<00:18, 20.20it/s] 63%|██████▎   | 620/982 [00:33<00:19, 18.92it/s] 63%|██████▎   | 622/982 [00:34<00:21, 16.70it/s] 64%|██████▎   | 625/982 [00:34<00:18, 18.87it/s] 64%|██████▍   | 628/982 [00:34<00:20, 17.45it/s] 64%|██████▍   | 630/982 [00:34<00:20, 17.33it/s] 64%|██████▍   | 633/982 [00:34<00:17, 19.93it/s] 65%|██████▍   | 636/982 [00:34<00:15, 22.07it/s] 65%|██████▌   | 639/982 [00:34<00:14, 23.69it/s] 65%|██████▌   | 642/982 [00:34<00:13, 25.07it/s] 66%|██████▌   | 645/982 [00:35<00:12, 26.14it/s] 66%|██████▌   | 648/982 [00:35<00:12, 26.84it/s] 66%|██████▋   | 651/982 [00:35<00:12, 27.08it/s] 67%|██████▋   | 654/982 [00:35<00:11, 27.76it/s] 67%|██████▋   | 657/982 [00:35<00:12, 25.14it/s] 67%|██████▋   | 660/982 [00:35<00:14, 21.76it/s] 68%|██████▊   | 663/982 [00:35<00:17, 17.73it/s] 68%|██████▊   | 665/982 [00:36<00:20, 15.68it/s] 68%|██████▊   | 667/982 [00:36<00:20, 15.29it/s] 68%|██████▊   | 669/982 [00:36<00:22, 14.06it/s] 68%|██████▊   | 671/982 [00:36<00:22, 14.00it/s] 69%|██████▊   | 674/982 [00:36<00:18, 16.61it/s] 69%|██████▉   | 677/982 [00:36<00:16, 19.05it/s] 69%|██████▉   | 680/982 [00:36<00:14, 21.12it/s] 70%|██████▉   | 683/982 [00:37<00:12, 23.07it/s] 70%|██████▉   | 686/982 [00:37<00:12, 24.10it/s] 70%|███████   | 689/982 [00:37<00:11, 25.43it/s] 70%|███████   | 692/982 [00:37<00:11, 24.99it/s] 71%|███████   | 695/982 [00:37<00:14, 19.79it/s] 71%|███████   | 698/982 [00:37<00:19, 14.64it/s] 71%|███████▏  | 700/982 [00:38<00:19, 14.84it/s] 71%|███████▏  | 702/982 [00:38<00:20, 13.71it/s] 72%|███████▏  | 704/982 [00:38<00:25, 11.10it/s] 72%|███████▏  | 707/982 [00:38<00:20, 13.67it/s] 72%|███████▏  | 710/982 [00:38<00:16, 16.45it/s] 73%|███████▎  | 713/982 [00:38<00:15, 17.81it/s] 73%|███████▎  | 716/982 [00:39<00:14, 18.83it/s] 73%|███████▎  | 719/982 [00:39<00:12, 20.66it/s] 74%|███████▎  | 722/982 [00:39<00:11, 22.43it/s] 74%|███████▍  | 725/982 [00:39<00:10, 23.93it/s] 74%|███████▍  | 728/982 [00:39<00:10, 24.91it/s] 74%|███████▍  | 731/982 [00:39<00:10, 24.32it/s] 75%|███████▍  | 734/982 [00:39<00:11, 21.22it/s] 75%|███████▌  | 737/982 [00:39<00:12, 19.16it/s] 75%|███████▌  | 740/982 [00:40<00:16, 14.62it/s] 76%|███████▌  | 742/982 [00:40<00:17, 13.58it/s] 76%|███████▌  | 744/982 [00:40<00:19, 12.26it/s] 76%|███████▌  | 747/982 [00:40<00:15, 14.96it/s] 76%|███████▋  | 750/982 [00:40<00:13, 17.40it/s] 77%|███████▋  | 753/982 [00:40<00:11, 19.72it/s] 77%|███████▋  | 756/982 [00:41<00:10, 21.76it/s] 77%|███████▋  | 759/982 [00:41<00:09, 23.34it/s] 78%|███████▊  | 762/982 [00:41<00:08, 24.64it/s] 78%|███████▊  | 765/982 [00:41<00:08, 25.76it/s] 78%|███████▊  | 768/982 [00:41<00:08, 26.10it/s] 79%|███████▊  | 771/982 [00:41<00:09, 23.31it/s] 79%|███████▉  | 774/982 [00:41<00:10, 20.02it/s] 79%|███████▉  | 777/982 [00:42<00:11, 18.18it/s] 79%|███████▉  | 779/982 [00:42<00:11, 17.60it/s] 80%|███████▉  | 781/982 [00:42<00:11, 17.19it/s] 80%|███████▉  | 783/982 [00:42<00:11, 16.92it/s] 80%|███████▉  | 785/982 [00:42<00:12, 16.12it/s] 80%|████████  | 787/982 [00:42<00:12, 16.13it/s] 80%|████████  | 789/982 [00:42<00:11, 16.41it/s] 81%|████████  | 792/982 [00:42<00:09, 19.15it/s] 81%|████████  | 795/982 [00:43<00:08, 21.56it/s] 81%|████████▏ | 798/982 [00:43<00:07, 23.44it/s] 82%|████████▏ | 801/982 [00:43<00:07, 24.95it/s] 82%|████████▏ | 804/982 [00:43<00:06, 26.05it/s] 82%|████████▏ | 807/982 [00:43<00:06, 26.92it/s] 82%|████████▏ | 810/982 [00:43<00:06, 26.35it/s] 83%|████████▎ | 813/982 [00:43<00:07, 23.17it/s] 83%|████████▎ | 816/982 [00:43<00:08, 20.46it/s] 83%|████████▎ | 819/982 [00:44<00:09, 17.26it/s] 84%|████████▎ | 821/982 [00:44<00:09, 17.08it/s] 84%|████████▍ | 823/982 [00:44<00:09, 16.71it/s] 84%|████████▍ | 825/982 [00:44<00:10, 15.40it/s] 84%|████████▍ | 827/982 [00:44<00:10, 15.28it/s] 85%|████████▍ | 830/982 [00:44<00:08, 18.46it/s] 85%|████████▍ | 833/982 [00:44<00:07, 21.11it/s] 85%|████████▌ | 836/982 [00:45<00:06, 23.21it/s] 85%|████████▌ | 839/982 [00:45<00:05, 24.86it/s] 86%|████████▌ | 842/982 [00:45<00:05, 26.06it/s] 86%|████████▌ | 846/982 [00:45<00:04, 27.68it/s] 87%|████████▋ | 850/982 [00:45<00:04, 28.72it/s] 87%|████████▋ | 853/982 [00:45<00:04, 28.47it/s] 87%|████████▋ | 856/982 [00:45<00:04, 28.50it/s] 87%|████████▋ | 859/982 [00:45<00:04, 25.35it/s] 88%|████████▊ | 862/982 [00:46<00:05, 22.30it/s] 88%|████████▊ | 865/982 [00:46<00:05, 21.58it/s] 88%|████████▊ | 868/982 [00:46<00:04, 23.39it/s] 89%|████████▊ | 871/982 [00:46<00:05, 21.79it/s] 89%|████████▉ | 874/982 [00:46<00:05, 20.07it/s] 89%|████████▉ | 877/982 [00:46<00:05, 20.28it/s] 90%|████████▉ | 881/982 [00:46<00:04, 23.34it/s] 90%|█████████ | 885/982 [00:47<00:03, 25.78it/s] 91%|█████████ | 889/982 [00:47<00:03, 27.69it/s] 91%|█████████ | 893/982 [00:47<00:03, 29.24it/s] 91%|█████████▏| 897/982 [00:47<00:02, 30.28it/s] 92%|█████████▏| 901/982 [00:47<00:02, 30.95it/s] 92%|█████████▏| 905/982 [00:47<00:02, 30.63it/s] 93%|█████████▎| 909/982 [00:47<00:02, 26.39it/s] 93%|█████████▎| 912/982 [00:48<00:02, 23.98it/s] 93%|█████████▎| 915/982 [00:48<00:04, 16.19it/s] 93%|█████████▎| 917/982 [00:48<00:03, 16.37it/s] 94%|█████████▎| 919/982 [00:48<00:04, 15.73it/s] 94%|█████████▍| 921/982 [00:48<00:04, 13.75it/s] 94%|█████████▍| 925/982 [00:48<00:03, 17.86it/s] 95%|█████████▍| 929/982 [00:49<00:02, 21.26it/s] 95%|█████████▌| 933/982 [00:49<00:02, 24.20it/s] 95%|█████████▌| 937/982 [00:49<00:01, 26.42it/s] 96%|█████████▌| 941/982 [00:49<00:01, 28.01it/s] 96%|█████████▌| 945/982 [00:49<00:01, 29.17it/s] 97%|█████████▋| 949/982 [00:49<00:01, 30.04it/s] 97%|█████████▋| 953/982 [00:49<00:01, 26.87it/s] 97%|█████████▋| 956/982 [00:50<00:01, 24.15it/s] 98%|█████████▊| 959/982 [00:50<00:01, 22.44it/s] 98%|█████████▊| 962/982 [00:50<00:00, 20.58it/s] 98%|█████████▊| 965/982 [00:50<00:00, 17.56it/s] 98%|█████████▊| 967/982 [00:50<00:00, 17.78it/s] 99%|█████████▊| 969/982 [00:50<00:00, 17.43it/s] 99%|█████████▉| 972/982 [00:50<00:00, 19.13it/s] 99%|█████████▉| 976/982 [00:51<00:00, 22.65it/s]100%|█████████▉| 979/982 [00:51<00:00, 24.40it/s]100%|██████████| 982/982 [00:51<00:00, 19.14it/s]
time :  1339
prob :  1339
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_3_Focal_RS_DRW_seed_42
train data : 14410, disrupt : 227, non-disrupt : 14183
valid data : 3512, disrupt : 57, non-disrupt : 3455
test data : 4053, disrupt : 71, non-disrupt : 3982

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.080, valid loss : 0.090, train f1 : 0.850, valid f1 : 0.547
Best score increase :0.000 -> 0.547
training process - Deferred Re-weighting:   1%|          | 1/128 [03:58<8:24:19, 238.26s/it]Best score increase :0.547 -> 0.612
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:10<7:23:28, 211.18s/it]Best score increase :0.612 -> 0.659
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:23<7:02:23, 202.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:39<6:53:29, 200.07s/it]epoch : 5, train loss : 0.034, valid loss : 0.035, train f1 : 0.946, valid f1 : 0.607
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:41<7:21:13, 215.23s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:58<7:05:19, 209.17s/it]Best score increase :0.659 -> 0.683
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:14<6:53:06, 204.84s/it]Best score increase :0.683 -> 0.784
training process - Deferred Re-weighting:   6%|▋         | 8/128 [27:27<6:41:46, 200.89s/it]epoch : 9, train loss : 0.028, valid loss : 0.025, train f1 : 0.954, valid f1 : 0.643
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [31:38<7:09:37, 216.62s/it]Best score increase :0.784 -> 0.818
training process - Deferred Re-weighting:   8%|▊         | 10/128 [34:54<6:53:54, 210.46s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [39:05<7:14:18, 222.72s/it]Best score increase :0.818 -> 0.825
training process - Deferred Re-weighting:   9%|▉         | 12/128 [42:17<6:52:24, 213.32s/it]epoch : 13, train loss : 0.027, valid loss : 0.029, train f1 : 0.954, valid f1 : 0.773
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [46:18<7:04:52, 221.67s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [49:30<6:44:19, 212.80s/it]Best score increase :0.825 -> 0.883
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [52:47<6:31:36, 207.93s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [56:15<6:28:09, 207.94s/it]epoch : 17, train loss : 0.025, valid loss : 0.031, train f1 : 0.953, valid f1 : 0.640
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [1:01:03<7:09:14, 232.02s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:04:18<6:44:58, 220.90s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:07:35<6:28:20, 213.77s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:10:49<6:14:18, 207.95s/it]epoch : 21, train loss : 0.024, valid loss : 0.033, train f1 : 0.955, valid f1 : 0.594
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:14:51<6:28:50, 218.04s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:18:05<6:12:49, 211.04s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:21:22<6:01:50, 206.76s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:24:37<5:52:19, 203.26s/it]epoch : 25, train loss : 0.022, valid loss : 0.032, train f1 : 0.959, valid f1 : 0.641
EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:28:37<6:07:30, 214.08s/it]Best score increase :0.883 -> 0.886
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:31:49<5:52:37, 207.43s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:34:58<5:40:10, 202.08s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:38:11<5:32:00, 199.21s/it]epoch : 29, train loss : 0.020, valid loss : 0.020, train f1 : 0.964, valid f1 : 0.705
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:42:12<5:49:32, 211.84s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [1:45:28<5:38:20, 207.15s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:48:41<5:27:56, 202.85s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [1:51:58<5:21:39, 201.04s/it]epoch : 33, train loss : 0.018, valid loss : 0.028, train f1 : 0.966, valid f1 : 0.679
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [1:56:11<5:42:58, 216.62s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [2:00:17<5:53:29, 225.63s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [2:03:38<5:38:04, 218.11s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [2:06:57<5:25:49, 212.50s/it]epoch : 37, train loss : 0.018, valid loss : 0.022, train f1 : 0.966, valid f1 : 0.847
EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [2:11:02<5:36:48, 222.07s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 37, best f1 score : 0.886
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [2:14:17<5:30:16, 217.76s/it]
training process finished, best loss : 0.016, best acc : 0.992, best f1 : 0.886, best epoch : 25

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.78      0.86      0.82        71
           1       1.00      1.00      1.00      3982

    accuracy                           0.99      4053
   macro avg       0.89      0.93      0.91      4053
weighted avg       0.99      0.99      0.99      4053


# test acc : 0.99, test f1 : 0.91, test AUC : 0.93, test loss : 0.467

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:49, 19.70it/s]  1%|          | 5/981 [00:00<01:05, 14.93it/s]  1%|          | 7/981 [00:00<01:07, 14.53it/s]  1%|          | 9/981 [00:00<01:10, 13.84it/s]  1%|          | 11/981 [00:00<01:20, 12.08it/s]  1%|▏         | 13/981 [00:00<01:15, 12.88it/s]  2%|▏         | 15/981 [00:01<01:14, 12.90it/s]  2%|▏         | 17/981 [00:01<01:11, 13.41it/s]  2%|▏         | 19/981 [00:01<01:10, 13.73it/s]  2%|▏         | 22/981 [00:01<00:56, 17.11it/s]  3%|▎         | 25/981 [00:01<00:48, 19.90it/s]  3%|▎         | 28/981 [00:01<00:43, 22.00it/s]  3%|▎         | 31/981 [00:01<00:40, 23.49it/s]  3%|▎         | 34/981 [00:01<00:38, 24.58it/s]  4%|▍         | 37/981 [00:02<00:37, 25.38it/s]  4%|▍         | 40/981 [00:02<00:37, 24.80it/s]  4%|▍         | 43/981 [00:02<00:39, 23.67it/s]  5%|▍         | 46/981 [00:02<00:55, 16.78it/s]  5%|▍         | 48/981 [00:02<01:09, 13.47it/s]  5%|▌         | 50/981 [00:03<01:13, 12.65it/s]  5%|▌         | 52/981 [00:03<01:15, 12.34it/s]  6%|▌         | 54/981 [00:03<01:08, 13.54it/s]  6%|▌         | 56/981 [00:03<01:13, 12.53it/s]  6%|▌         | 58/981 [00:03<01:12, 12.75it/s]  6%|▌         | 60/981 [00:03<01:14, 12.31it/s]  6%|▋         | 62/981 [00:03<01:10, 13.11it/s]  7%|▋         | 64/981 [00:04<01:05, 13.94it/s]  7%|▋         | 66/981 [00:04<01:08, 13.29it/s]  7%|▋         | 68/981 [00:04<01:06, 13.83it/s]  7%|▋         | 70/981 [00:04<01:00, 15.14it/s]  7%|▋         | 73/981 [00:04<00:53, 17.01it/s]  8%|▊         | 75/981 [00:04<00:52, 17.29it/s]  8%|▊         | 77/981 [00:04<01:05, 13.70it/s]  8%|▊         | 80/981 [00:05<00:56, 15.93it/s]  8%|▊         | 83/981 [00:05<00:50, 17.67it/s]  9%|▊         | 85/981 [00:05<00:51, 17.55it/s]  9%|▉         | 87/981 [00:05<00:53, 16.82it/s]  9%|▉         | 89/981 [00:05<00:52, 17.10it/s]  9%|▉         | 91/981 [00:05<01:08, 12.97it/s]  9%|▉         | 93/981 [00:06<01:17, 11.52it/s] 10%|▉         | 95/981 [00:06<01:22, 10.78it/s] 10%|▉         | 97/981 [00:06<01:17, 11.47it/s] 10%|█         | 99/981 [00:06<01:12, 12.10it/s] 10%|█         | 102/981 [00:06<00:57, 15.31it/s] 11%|█         | 105/981 [00:06<00:48, 18.02it/s] 11%|█         | 108/981 [00:06<00:43, 20.27it/s] 11%|█▏        | 111/981 [00:07<00:39, 21.92it/s] 12%|█▏        | 114/981 [00:07<00:42, 20.20it/s] 12%|█▏        | 117/981 [00:07<00:45, 18.80it/s] 12%|█▏        | 119/981 [00:07<00:48, 17.77it/s] 12%|█▏        | 121/981 [00:07<00:50, 16.90it/s] 13%|█▎        | 123/981 [00:07<00:52, 16.24it/s] 13%|█▎        | 125/981 [00:07<00:54, 15.79it/s] 13%|█▎        | 127/981 [00:08<00:55, 15.47it/s] 13%|█▎        | 129/981 [00:08<00:55, 15.24it/s] 13%|█▎        | 131/981 [00:08<00:58, 14.47it/s] 14%|█▎        | 133/981 [00:08<00:56, 14.96it/s] 14%|█▍        | 136/981 [00:08<00:46, 18.07it/s] 14%|█▍        | 139/981 [00:08<00:41, 20.37it/s] 14%|█▍        | 142/981 [00:08<00:37, 22.16it/s] 15%|█▍        | 145/981 [00:08<00:35, 23.35it/s] 15%|█▌        | 148/981 [00:09<00:34, 24.14it/s] 15%|█▌        | 151/981 [00:09<00:33, 24.65it/s] 16%|█▌        | 154/981 [00:09<00:32, 25.29it/s] 16%|█▌        | 157/981 [00:09<00:34, 23.92it/s] 16%|█▋        | 160/981 [00:09<00:54, 15.17it/s] 17%|█▋        | 162/981 [00:10<01:05, 12.53it/s] 17%|█▋        | 164/981 [00:10<01:03, 12.92it/s] 17%|█▋        | 166/981 [00:10<01:01, 13.35it/s] 17%|█▋        | 168/981 [00:10<01:00, 13.40it/s] 17%|█▋        | 171/981 [00:10<00:51, 15.60it/s] 18%|█▊        | 174/981 [00:10<00:45, 17.93it/s] 18%|█▊        | 177/981 [00:10<00:40, 20.02it/s] 18%|█▊        | 180/981 [00:10<00:36, 21.74it/s] 19%|█▊        | 183/981 [00:11<00:34, 22.99it/s] 19%|█▉        | 186/981 [00:11<00:33, 23.95it/s] 19%|█▉        | 189/981 [00:11<00:32, 24.70it/s] 20%|█▉        | 192/981 [00:11<00:31, 24.93it/s] 20%|█▉        | 195/981 [00:11<00:33, 23.43it/s] 20%|██        | 198/981 [00:11<00:38, 20.36it/s] 20%|██        | 201/981 [00:12<00:48, 16.11it/s] 21%|██        | 203/981 [00:12<00:48, 16.15it/s] 21%|██        | 205/981 [00:12<00:50, 15.30it/s] 21%|██        | 207/981 [00:12<00:51, 15.14it/s] 21%|██▏       | 209/981 [00:12<00:57, 13.53it/s] 22%|██▏       | 212/981 [00:12<00:47, 16.35it/s] 22%|██▏       | 215/981 [00:12<00:41, 18.64it/s] 22%|██▏       | 218/981 [00:12<00:37, 20.36it/s] 23%|██▎       | 221/981 [00:13<00:35, 21.59it/s] 23%|██▎       | 224/981 [00:13<00:38, 19.78it/s] 23%|██▎       | 227/981 [00:13<00:36, 20.86it/s] 23%|██▎       | 230/981 [00:13<00:44, 17.05it/s] 24%|██▎       | 232/981 [00:13<00:48, 15.29it/s] 24%|██▍       | 234/981 [00:14<00:55, 13.37it/s] 24%|██▍       | 236/981 [00:14<01:02, 11.84it/s] 24%|██▍       | 238/981 [00:14<01:10, 10.48it/s] 24%|██▍       | 240/981 [00:14<01:01, 11.97it/s] 25%|██▍       | 243/981 [00:14<00:49, 14.92it/s] 25%|██▌       | 246/981 [00:14<00:42, 17.48it/s] 25%|██▌       | 249/981 [00:14<00:37, 19.57it/s] 26%|██▌       | 252/981 [00:15<00:34, 21.30it/s] 26%|██▌       | 255/981 [00:15<00:32, 22.52it/s] 26%|██▋       | 258/981 [00:15<00:30, 23.44it/s] 27%|██▋       | 261/981 [00:15<00:29, 24.01it/s] 27%|██▋       | 264/981 [00:15<00:32, 21.87it/s] 27%|██▋       | 267/981 [00:15<00:44, 16.21it/s] 27%|██▋       | 269/981 [00:16<00:55, 12.91it/s] 28%|██▊       | 271/981 [00:16<01:00, 11.80it/s] 28%|██▊       | 274/981 [00:16<00:54, 12.99it/s] 28%|██▊       | 276/981 [00:16<00:51, 13.70it/s] 28%|██▊       | 279/981 [00:16<00:43, 16.31it/s] 29%|██▊       | 282/981 [00:16<00:37, 18.57it/s] 29%|██▉       | 285/981 [00:17<00:34, 20.42it/s] 29%|██▉       | 288/981 [00:17<00:31, 21.88it/s] 30%|██▉       | 291/981 [00:17<00:30, 22.98it/s] 30%|██▉       | 294/981 [00:17<00:28, 23.73it/s] 30%|███       | 297/981 [00:17<00:28, 24.29it/s] 31%|███       | 300/981 [00:17<00:30, 22.66it/s] 31%|███       | 303/981 [00:17<00:37, 18.12it/s] 31%|███       | 306/981 [00:18<00:48, 13.81it/s] 31%|███▏      | 308/981 [00:18<00:50, 13.33it/s] 32%|███▏      | 310/981 [00:18<00:52, 12.80it/s] 32%|███▏      | 312/981 [00:18<00:57, 11.61it/s] 32%|███▏      | 315/981 [00:18<00:46, 14.38it/s] 32%|███▏      | 318/981 [00:19<00:39, 16.83it/s] 33%|███▎      | 321/981 [00:19<00:34, 18.94it/s] 33%|███▎      | 324/981 [00:19<00:31, 20.65it/s] 33%|███▎      | 327/981 [00:19<00:29, 21.82it/s] 34%|███▎      | 330/981 [00:19<00:28, 22.82it/s] 34%|███▍      | 333/981 [00:19<00:27, 23.51it/s] 34%|███▍      | 336/981 [00:19<00:27, 23.15it/s] 35%|███▍      | 339/981 [00:20<00:36, 17.56it/s] 35%|███▍      | 341/981 [00:20<00:39, 16.08it/s] 35%|███▍      | 343/981 [00:20<00:52, 12.20it/s] 35%|███▌      | 345/981 [00:20<01:02, 10.17it/s] 35%|███▌      | 347/981 [00:20<00:55, 11.41it/s] 36%|███▌      | 350/981 [00:20<00:44, 14.30it/s] 36%|███▌      | 353/981 [00:21<00:37, 16.81it/s] 36%|███▋      | 356/981 [00:21<00:32, 19.08it/s] 37%|███▋      | 359/981 [00:21<00:29, 20.92it/s] 37%|███▋      | 362/981 [00:21<00:27, 22.27it/s] 37%|███▋      | 365/981 [00:21<00:26, 23.25it/s] 38%|███▊      | 368/981 [00:21<00:25, 23.95it/s] 38%|███▊      | 371/981 [00:21<00:26, 23.38it/s] 38%|███▊      | 374/981 [00:22<00:32, 18.64it/s] 38%|███▊      | 377/981 [00:22<00:44, 13.61it/s] 39%|███▊      | 379/981 [00:22<00:45, 13.22it/s] 39%|███▉      | 381/981 [00:22<00:45, 13.25it/s] 39%|███▉      | 383/981 [00:22<00:46, 12.81it/s] 39%|███▉      | 386/981 [00:23<00:39, 15.04it/s] 40%|███▉      | 389/981 [00:23<00:34, 17.04it/s] 40%|███▉      | 392/981 [00:23<00:30, 19.14it/s] 40%|████      | 395/981 [00:23<00:28, 20.88it/s] 41%|████      | 398/981 [00:23<00:26, 22.13it/s] 41%|████      | 401/981 [00:23<00:25, 23.18it/s] 41%|████      | 404/981 [00:23<00:24, 23.85it/s] 41%|████▏     | 407/981 [00:23<00:25, 22.89it/s] 42%|████▏     | 410/981 [00:24<00:29, 19.35it/s] 42%|████▏     | 413/981 [00:24<00:31, 17.97it/s] 42%|████▏     | 415/981 [00:24<00:33, 17.11it/s] 43%|████▎     | 417/981 [00:24<00:34, 16.45it/s] 43%|████▎     | 419/981 [00:24<00:35, 15.95it/s] 43%|████▎     | 421/981 [00:24<00:38, 14.73it/s] 43%|████▎     | 423/981 [00:25<00:38, 14.65it/s] 43%|████▎     | 426/981 [00:25<00:32, 16.96it/s] 44%|████▎     | 429/981 [00:25<00:28, 19.19it/s] 44%|████▍     | 432/981 [00:25<00:26, 20.97it/s] 44%|████▍     | 435/981 [00:25<00:24, 22.23it/s] 45%|████▍     | 438/981 [00:25<00:23, 23.26it/s] 45%|████▍     | 441/981 [00:25<00:22, 24.00it/s] 45%|████▌     | 444/981 [00:25<00:22, 24.29it/s] 46%|████▌     | 447/981 [00:26<00:24, 21.39it/s] 46%|████▌     | 450/981 [00:26<00:33, 15.62it/s] 46%|████▌     | 452/981 [00:26<00:41, 12.87it/s] 46%|████▋     | 454/981 [00:26<00:43, 12.11it/s] 46%|████▋     | 456/981 [00:26<00:45, 11.60it/s] 47%|████▋     | 458/981 [00:27<00:42, 12.30it/s] 47%|████▋     | 461/981 [00:27<00:34, 15.24it/s] 47%|████▋     | 464/981 [00:27<00:29, 17.80it/s] 48%|████▊     | 467/981 [00:27<00:25, 19.91it/s] 48%|████▊     | 470/981 [00:27<00:23, 21.58it/s] 48%|████▊     | 473/981 [00:27<00:22, 22.79it/s] 49%|████▊     | 476/981 [00:27<00:21, 23.70it/s] 49%|████▉     | 479/981 [00:27<00:20, 24.18it/s] 49%|████▉     | 482/981 [00:28<00:20, 23.77it/s] 49%|████▉     | 485/981 [00:28<00:32, 15.08it/s] 50%|████▉     | 487/981 [00:28<00:38, 12.76it/s] 50%|████▉     | 489/981 [00:28<00:44, 10.94it/s] 50%|█████     | 491/981 [00:29<00:46, 10.52it/s] 50%|█████     | 494/981 [00:29<00:37, 13.01it/s] 51%|█████     | 497/981 [00:29<00:31, 15.60it/s] 51%|█████     | 500/981 [00:29<00:27, 17.66it/s] 51%|█████▏    | 503/981 [00:29<00:24, 19.37it/s] 52%|█████▏    | 506/981 [00:29<00:22, 20.77it/s] 52%|█████▏    | 509/981 [00:29<00:21, 21.77it/s] 52%|█████▏    | 512/981 [00:30<00:21, 21.68it/s] 52%|█████▏    | 515/981 [00:30<00:26, 17.56it/s] 53%|█████▎    | 517/981 [00:30<00:30, 15.36it/s] 53%|█████▎    | 519/981 [00:30<00:33, 13.73it/s] 53%|█████▎    | 521/981 [00:30<00:33, 13.58it/s] 53%|█████▎    | 523/981 [00:30<00:34, 13.20it/s] 54%|█████▎    | 525/981 [00:31<00:37, 12.22it/s] 54%|█████▎    | 527/981 [00:31<00:35, 12.91it/s] 54%|█████▍    | 530/981 [00:31<00:29, 15.47it/s] 54%|█████▍    | 533/981 [00:31<00:24, 17.95it/s] 55%|█████▍    | 535/981 [00:31<00:25, 17.59it/s] 55%|█████▍    | 538/981 [00:31<00:22, 19.88it/s] 55%|█████▌    | 541/981 [00:31<00:20, 21.74it/s] 55%|█████▌    | 544/981 [00:31<00:18, 23.10it/s] 56%|█████▌    | 547/981 [00:32<00:18, 24.02it/s] 56%|█████▌    | 550/981 [00:32<00:19, 22.20it/s] 56%|█████▋    | 553/981 [00:32<00:24, 17.28it/s] 57%|█████▋    | 555/981 [00:32<00:28, 15.15it/s] 57%|█████▋    | 557/981 [00:32<00:35, 11.96it/s] 57%|█████▋    | 559/981 [00:33<00:40, 10.48it/s] 57%|█████▋    | 561/981 [00:33<00:36, 11.57it/s] 57%|█████▋    | 564/981 [00:33<00:28, 14.46it/s] 58%|█████▊    | 567/981 [00:33<00:24, 17.21it/s] 58%|█████▊    | 570/981 [00:33<00:21, 19.50it/s] 58%|█████▊    | 573/981 [00:33<00:19, 21.41it/s] 59%|█████▊    | 576/981 [00:33<00:17, 22.85it/s] 59%|█████▉    | 579/981 [00:34<00:16, 23.96it/s] 59%|█████▉    | 582/981 [00:34<00:16, 24.82it/s] 60%|█████▉    | 585/981 [00:34<00:17, 22.48it/s] 60%|█████▉    | 588/981 [00:34<00:21, 18.57it/s] 60%|██████    | 591/981 [00:34<00:23, 16.32it/s] 60%|██████    | 593/981 [00:34<00:26, 14.84it/s] 61%|██████    | 595/981 [00:35<00:28, 13.34it/s] 61%|██████    | 597/981 [00:35<00:31, 12.15it/s] 61%|██████    | 600/981 [00:35<00:25, 14.70it/s] 61%|██████▏   | 603/981 [00:35<00:21, 17.27it/s] 62%|██████▏   | 606/981 [00:35<00:19, 19.40it/s] 62%|██████▏   | 609/981 [00:35<00:17, 21.13it/s] 62%|██████▏   | 612/981 [00:35<00:16, 22.53it/s] 63%|██████▎   | 615/981 [00:36<00:17, 20.68it/s] 63%|██████▎   | 618/981 [00:36<00:17, 21.35it/s] 63%|██████▎   | 621/981 [00:36<00:18, 19.65it/s] 64%|██████▎   | 624/981 [00:36<00:21, 16.81it/s] 64%|██████▍   | 626/981 [00:36<00:22, 15.84it/s] 64%|██████▍   | 628/981 [00:37<00:26, 13.29it/s] 64%|██████▍   | 630/981 [00:37<00:28, 12.23it/s] 64%|██████▍   | 632/981 [00:37<00:27, 12.72it/s] 65%|██████▍   | 634/981 [00:37<00:24, 14.10it/s] 65%|██████▍   | 637/981 [00:37<00:20, 16.84it/s] 65%|██████▌   | 640/981 [00:37<00:17, 19.09it/s] 66%|██████▌   | 643/981 [00:37<00:16, 20.82it/s] 66%|██████▌   | 646/981 [00:37<00:15, 22.15it/s] 66%|██████▌   | 649/981 [00:38<00:14, 22.86it/s] 66%|██████▋   | 652/981 [00:38<00:14, 23.34it/s] 67%|██████▋   | 655/981 [00:38<00:14, 22.90it/s] 67%|██████▋   | 658/981 [00:38<00:15, 21.13it/s] 67%|██████▋   | 661/981 [00:38<00:17, 17.92it/s] 68%|██████▊   | 663/981 [00:38<00:18, 17.10it/s] 68%|██████▊   | 665/981 [00:39<00:20, 15.43it/s] 68%|██████▊   | 667/981 [00:39<00:20, 15.64it/s] 68%|██████▊   | 669/981 [00:39<00:20, 15.32it/s] 68%|██████▊   | 671/981 [00:39<00:21, 14.61it/s] 69%|██████▊   | 673/981 [00:39<00:20, 15.17it/s] 69%|██████▉   | 675/981 [00:39<00:19, 15.79it/s] 69%|██████▉   | 678/981 [00:39<00:16, 18.74it/s] 69%|██████▉   | 681/981 [00:39<00:14, 21.18it/s] 70%|██████▉   | 684/981 [00:40<00:12, 23.05it/s] 70%|███████   | 687/981 [00:40<00:12, 24.32it/s] 70%|███████   | 690/981 [00:40<00:11, 25.09it/s] 71%|███████   | 693/981 [00:40<00:11, 25.63it/s] 71%|███████   | 696/981 [00:40<00:12, 23.50it/s] 71%|███████▏  | 699/981 [00:40<00:15, 18.28it/s] 72%|███████▏  | 702/981 [00:41<00:18, 15.33it/s] 72%|███████▏  | 704/981 [00:41<00:19, 14.50it/s] 72%|███████▏  | 706/981 [00:41<00:22, 12.15it/s] 72%|███████▏  | 708/981 [00:41<00:20, 13.10it/s] 72%|███████▏  | 711/981 [00:41<00:17, 15.85it/s] 73%|███████▎  | 714/981 [00:41<00:14, 18.23it/s] 73%|███████▎  | 717/981 [00:41<00:13, 20.24it/s] 73%|███████▎  | 720/981 [00:41<00:11, 21.82it/s] 74%|███████▎  | 723/981 [00:42<00:11, 22.89it/s] 74%|███████▍  | 726/981 [00:42<00:10, 23.68it/s] 74%|███████▍  | 729/981 [00:42<00:10, 24.54it/s] 75%|███████▍  | 732/981 [00:42<00:10, 23.78it/s] 75%|███████▍  | 735/981 [00:42<00:15, 15.68it/s] 75%|███████▌  | 737/981 [00:43<00:20, 12.19it/s] 75%|███████▌  | 739/981 [00:43<00:20, 11.56it/s] 76%|███████▌  | 741/981 [00:43<00:22, 10.73it/s] 76%|███████▌  | 743/981 [00:43<00:19, 12.25it/s] 76%|███████▌  | 746/981 [00:43<00:15, 15.13it/s] 76%|███████▋  | 749/981 [00:43<00:13, 16.79it/s] 77%|███████▋  | 752/981 [00:44<00:12, 18.73it/s] 77%|███████▋  | 755/981 [00:44<00:11, 20.54it/s] 77%|███████▋  | 758/981 [00:44<00:10, 21.77it/s] 78%|███████▊  | 761/981 [00:44<00:09, 23.26it/s] 78%|███████▊  | 764/981 [00:44<00:08, 24.49it/s] 78%|███████▊  | 767/981 [00:44<00:09, 23.71it/s] 78%|███████▊  | 770/981 [00:44<00:10, 20.22it/s] 79%|███████▉  | 773/981 [00:44<00:11, 18.49it/s] 79%|███████▉  | 775/981 [00:45<00:11, 17.69it/s] 79%|███████▉  | 777/981 [00:45<00:14, 14.48it/s] 79%|███████▉  | 779/981 [00:45<00:15, 13.15it/s] 80%|███████▉  | 781/981 [00:45<00:14, 13.80it/s] 80%|███████▉  | 784/981 [00:45<00:11, 16.69it/s] 80%|████████  | 787/981 [00:45<00:10, 19.18it/s] 81%|████████  | 790/981 [00:45<00:08, 21.36it/s] 81%|████████  | 793/981 [00:46<00:08, 23.19it/s] 81%|████████  | 796/981 [00:46<00:07, 24.60it/s] 81%|████████▏ | 799/981 [00:46<00:07, 25.71it/s] 82%|████████▏ | 802/981 [00:46<00:06, 26.45it/s] 82%|████████▏ | 805/981 [00:46<00:07, 24.45it/s] 82%|████████▏ | 808/981 [00:46<00:08, 21.61it/s] 83%|████████▎ | 811/981 [00:46<00:08, 20.44it/s] 83%|████████▎ | 814/981 [00:47<00:10, 15.53it/s] 83%|████████▎ | 816/981 [00:47<00:13, 12.60it/s] 83%|████████▎ | 818/981 [00:47<00:13, 11.87it/s] 84%|████████▎ | 821/981 [00:47<00:11, 14.09it/s] 84%|████████▍ | 824/981 [00:47<00:09, 16.90it/s] 84%|████████▍ | 827/981 [00:48<00:07, 19.57it/s] 85%|████████▍ | 830/981 [00:48<00:06, 21.79it/s] 85%|████████▍ | 833/981 [00:48<00:06, 23.59it/s] 85%|████████▌ | 836/981 [00:48<00:05, 25.11it/s] 86%|████████▌ | 839/981 [00:48<00:05, 26.28it/s] 86%|████████▌ | 842/981 [00:48<00:05, 26.81it/s] 86%|████████▌ | 845/981 [00:48<00:05, 26.00it/s] 86%|████████▋ | 848/981 [00:48<00:06, 21.52it/s] 87%|████████▋ | 851/981 [00:49<00:06, 20.26it/s] 87%|████████▋ | 854/981 [00:49<00:06, 19.53it/s] 87%|████████▋ | 857/981 [00:49<00:06, 19.07it/s] 88%|████████▊ | 859/981 [00:49<00:06, 18.83it/s] 88%|████████▊ | 861/981 [00:49<00:06, 17.50it/s] 88%|████████▊ | 863/981 [00:49<00:06, 17.02it/s] 88%|████████▊ | 866/981 [00:49<00:06, 18.36it/s] 89%|████████▊ | 869/981 [00:49<00:05, 19.74it/s] 89%|████████▉ | 873/981 [00:50<00:04, 23.07it/s] 89%|████████▉ | 877/981 [00:50<00:04, 25.25it/s] 90%|████████▉ | 881/981 [00:50<00:03, 26.93it/s] 90%|█████████ | 885/981 [00:50<00:03, 28.09it/s] 91%|█████████ | 889/981 [00:50<00:03, 29.02it/s] 91%|█████████ | 892/981 [00:50<00:03, 27.46it/s] 91%|█████████ | 895/981 [00:50<00:03, 22.70it/s] 92%|█████████▏| 898/981 [00:51<00:04, 18.88it/s] 92%|█████████▏| 901/981 [00:51<00:04, 18.51it/s] 92%|█████████▏| 903/981 [00:51<00:04, 18.29it/s] 92%|█████████▏| 905/981 [00:51<00:04, 17.92it/s] 92%|█████████▏| 907/981 [00:51<00:04, 16.02it/s] 93%|█████████▎| 909/981 [00:51<00:04, 16.01it/s] 93%|█████████▎| 912/981 [00:51<00:03, 19.16it/s] 93%|█████████▎| 916/981 [00:52<00:02, 22.54it/s] 94%|█████████▍| 920/981 [00:52<00:02, 25.11it/s] 94%|█████████▍| 924/981 [00:52<00:02, 26.99it/s] 95%|█████████▍| 928/981 [00:52<00:01, 28.37it/s] 95%|█████████▌| 932/981 [00:52<00:01, 29.30it/s] 95%|█████████▌| 936/981 [00:52<00:01, 29.65it/s] 96%|█████████▌| 939/981 [00:52<00:01, 26.14it/s] 96%|█████████▌| 942/981 [00:53<00:01, 23.55it/s] 96%|█████████▋| 945/981 [00:53<00:01, 21.96it/s] 97%|█████████▋| 948/981 [00:53<00:01, 20.90it/s] 97%|█████████▋| 951/981 [00:53<00:01, 20.01it/s] 97%|█████████▋| 954/981 [00:53<00:01, 19.71it/s] 97%|█████████▋| 956/981 [00:53<00:01, 18.81it/s] 98%|█████████▊| 959/981 [00:53<00:01, 20.23it/s] 98%|█████████▊| 963/981 [00:54<00:00, 23.28it/s] 99%|█████████▊| 967/981 [00:54<00:00, 25.56it/s] 99%|█████████▉| 971/981 [00:54<00:00, 27.22it/s] 99%|█████████▉| 975/981 [00:54<00:00, 28.49it/s]100%|█████████▉| 979/981 [00:54<00:00, 29.38it/s]100%|██████████| 981/981 [00:54<00:00, 17.94it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_4_Focal_RS_DRW_seed_42
train data : 14398, disrupt : 227, non-disrupt : 14171
valid data : 3508, disrupt : 57, non-disrupt : 3451
test data : 4051, disrupt : 71, non-disrupt : 3980

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.110, valid loss : 0.120, train f1 : 0.776, valid f1 : 0.503
Best score increase :0.000 -> 0.503
training process - Deferred Re-weighting:   1%|          | 1/128 [04:34<9:41:35, 274.77s/it]Best score increase :0.503 -> 0.643
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:59<8:10:39, 233.65s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [11:14<7:29:31, 215.77s/it]Best score increase :0.643 -> 0.688
training process - Deferred Re-weighting:   3%|▎         | 4/128 [14:28<7:08:36, 207.39s/it]epoch : 5, train loss : 0.040, valid loss : 0.035, train f1 : 0.931, valid f1 : 0.726
Best score increase :0.688 -> 0.726
training process - Deferred Re-weighting:   4%|▍         | 5/128 [18:27<7:28:30, 218.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [21:38<7:05:17, 209.16s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:53<6:52:54, 204.74s/it]Best score increase :0.726 -> 0.761
training process - Deferred Re-weighting:   6%|▋         | 8/128 [28:07<6:42:12, 201.10s/it]epoch : 9, train loss : 0.031, valid loss : 0.034, train f1 : 0.948, valid f1 : 0.731
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [32:08<7:03:57, 213.76s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [35:22<6:48:10, 207.55s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [38:35<6:36:06, 203.14s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [41:47<6:26:22, 199.85s/it]epoch : 13, train loss : 0.029, valid loss : 0.030, train f1 : 0.953, valid f1 : 0.792
Best score increase :0.761 -> 0.792
training process - Deferred Re-weighting:  10%|█         | 13/128 [45:41<6:42:32, 210.02s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [48:50<6:26:54, 203.63s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [52:04<6:18:11, 200.81s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [55:14<6:08:52, 197.61s/it]epoch : 17, train loss : 0.027, valid loss : 0.053, train f1 : 0.956, valid f1 : 0.606
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [59:12<6:27:48, 209.63s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:02:24<6:14:34, 204.31s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:05:38<6:05:40, 201.29s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:08:54<5:59:19, 199.62s/it]epoch : 21, train loss : 0.025, valid loss : 0.049, train f1 : 0.961, valid f1 : 0.635
EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:12:54<6:17:41, 211.79s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:16:08<6:04:48, 206.49s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:19:21<5:54:07, 202.36s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:22:33<5:45:35, 199.38s/it]epoch : 25, train loss : 0.022, valid loss : 0.056, train f1 : 0.964, valid f1 : 0.720
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 24, best f1 score : 0.792
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:26:32<6:14:59, 216.34s/it]
training process finished, best loss : 0.030, best acc : 0.982, best f1 : 0.792, best epoch : 12

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.48      0.80      0.60        71
           1       1.00      0.98      0.99      3980

    accuracy                           0.98      4051
   macro avg       0.74      0.89      0.80      4051
weighted avg       0.99      0.98      0.98      4051


# test acc : 0.98, test f1 : 0.80, test AUC : 0.89, test loss : 0.774

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/980 [00:00<?, ?it/s]  0%|          | 2/980 [00:00<00:54, 17.80it/s]  0%|          | 4/980 [00:00<01:21, 12.01it/s]  1%|          | 6/980 [00:00<01:29, 10.84it/s]  1%|          | 8/980 [00:00<01:48,  8.99it/s]  1%|          | 9/980 [00:00<01:48,  8.95it/s]  1%|          | 11/980 [00:01<01:41,  9.53it/s]  1%|          | 12/980 [00:01<01:42,  9.46it/s]  2%|▏         | 15/980 [00:01<01:13, 13.17it/s]  2%|▏         | 17/980 [00:01<01:06, 14.43it/s]  2%|▏         | 20/980 [00:01<00:57, 16.56it/s]  2%|▏         | 23/980 [00:01<00:51, 18.70it/s]  3%|▎         | 26/980 [00:01<00:45, 20.81it/s]  3%|▎         | 29/980 [00:01<00:42, 22.29it/s]  3%|▎         | 32/980 [00:02<00:40, 23.49it/s]  4%|▎         | 35/980 [00:02<00:43, 21.75it/s]  4%|▍         | 38/980 [00:02<00:58, 16.06it/s]  4%|▍         | 40/980 [00:02<01:01, 15.25it/s]  4%|▍         | 42/980 [00:02<01:02, 15.02it/s]  4%|▍         | 44/980 [00:02<01:07, 13.86it/s]  5%|▍         | 46/980 [00:03<01:12, 12.84it/s]  5%|▍         | 48/980 [00:03<01:10, 13.21it/s]  5%|▌         | 51/980 [00:03<00:58, 15.86it/s]  6%|▌         | 54/980 [00:03<00:50, 18.18it/s]  6%|▌         | 57/980 [00:03<00:45, 20.31it/s]  6%|▌         | 60/980 [00:03<00:41, 22.03it/s]  6%|▋         | 63/980 [00:03<00:39, 23.36it/s]  7%|▋         | 66/980 [00:04<00:37, 24.26it/s]  7%|▋         | 69/980 [00:04<00:37, 24.37it/s]  7%|▋         | 72/980 [00:04<00:43, 20.71it/s]  8%|▊         | 75/980 [00:04<00:57, 15.61it/s]  8%|▊         | 77/980 [00:04<01:05, 13.70it/s]  8%|▊         | 79/980 [00:05<01:09, 13.04it/s]  8%|▊         | 81/980 [00:05<01:09, 12.94it/s]  8%|▊         | 83/980 [00:05<01:06, 13.39it/s]  9%|▉         | 86/980 [00:05<00:54, 16.27it/s]  9%|▉         | 89/980 [00:05<00:47, 18.64it/s]  9%|▉         | 92/980 [00:05<00:42, 20.69it/s] 10%|▉         | 95/980 [00:05<00:39, 22.23it/s] 10%|█         | 98/980 [00:05<00:37, 23.47it/s] 10%|█         | 101/980 [00:05<00:35, 24.49it/s] 11%|█         | 104/980 [00:06<00:34, 25.10it/s] 11%|█         | 107/980 [00:06<00:37, 23.11it/s] 11%|█         | 110/980 [00:06<00:55, 15.59it/s] 11%|█▏        | 112/980 [00:06<00:57, 15.13it/s] 12%|█▏        | 114/980 [00:06<00:56, 15.28it/s] 12%|█▏        | 116/980 [00:07<01:04, 13.44it/s] 12%|█▏        | 118/980 [00:07<01:09, 12.34it/s] 12%|█▏        | 121/980 [00:07<00:56, 15.33it/s] 13%|█▎        | 124/980 [00:07<00:48, 17.82it/s] 13%|█▎        | 127/980 [00:07<00:42, 19.98it/s] 13%|█▎        | 130/980 [00:07<00:39, 21.75it/s] 14%|█▎        | 133/980 [00:07<00:36, 23.03it/s] 14%|█▍        | 136/980 [00:07<00:35, 24.06it/s] 14%|█▍        | 139/980 [00:08<00:33, 24.89it/s] 14%|█▍        | 142/980 [00:08<00:33, 25.33it/s] 15%|█▍        | 145/980 [00:08<00:36, 22.95it/s] 15%|█▌        | 148/980 [00:08<00:43, 19.30it/s] 15%|█▌        | 151/980 [00:08<00:55, 14.93it/s] 16%|█▌        | 153/980 [00:09<01:06, 12.52it/s] 16%|█▌        | 155/980 [00:09<01:13, 11.29it/s] 16%|█▌        | 157/980 [00:09<01:06, 12.33it/s] 16%|█▋        | 160/980 [00:09<00:53, 15.27it/s] 17%|█▋        | 163/980 [00:09<00:45, 17.83it/s] 17%|█▋        | 166/980 [00:09<00:40, 20.16it/s] 17%|█▋        | 169/980 [00:09<00:36, 21.93it/s] 18%|█▊        | 172/980 [00:09<00:34, 23.23it/s] 18%|█▊        | 175/980 [00:10<00:33, 24.26it/s] 18%|█▊        | 178/980 [00:10<00:31, 25.07it/s] 18%|█▊        | 181/980 [00:10<00:32, 24.69it/s] 19%|█▉        | 184/980 [00:10<00:41, 19.06it/s] 19%|█▉        | 187/980 [00:10<00:48, 16.42it/s] 19%|█▉        | 189/980 [00:10<00:48, 16.38it/s] 19%|█▉        | 191/980 [00:11<00:50, 15.53it/s] 20%|█▉        | 193/980 [00:11<00:56, 13.92it/s] 20%|█▉        | 195/980 [00:11<00:57, 13.64it/s] 20%|██        | 197/980 [00:11<00:52, 14.86it/s] 20%|██        | 200/980 [00:11<00:44, 17.48it/s] 21%|██        | 203/980 [00:11<00:39, 19.85it/s] 21%|██        | 206/980 [00:11<00:35, 21.66it/s] 21%|██▏       | 209/980 [00:12<00:33, 22.95it/s] 22%|██▏       | 212/980 [00:12<00:32, 23.89it/s] 22%|██▏       | 215/980 [00:12<00:31, 24.48it/s] 22%|██▏       | 218/980 [00:12<00:30, 25.00it/s] 23%|██▎       | 221/980 [00:12<00:35, 21.52it/s] 23%|██▎       | 224/980 [00:12<00:50, 15.02it/s] 23%|██▎       | 226/980 [00:13<00:59, 12.67it/s] 23%|██▎       | 228/980 [00:13<01:03, 11.81it/s] 23%|██▎       | 230/980 [00:13<01:11, 10.44it/s] 24%|██▎       | 232/980 [00:13<01:05, 11.44it/s] 24%|██▍       | 234/980 [00:13<01:01, 12.07it/s] 24%|██▍       | 237/980 [00:13<00:49, 15.04it/s] 24%|██▍       | 240/980 [00:14<00:41, 17.75it/s] 25%|██▍       | 243/980 [00:14<00:36, 20.12it/s] 25%|██▌       | 246/980 [00:14<00:33, 21.98it/s] 25%|██▌       | 249/980 [00:14<00:31, 23.44it/s] 26%|██▌       | 252/980 [00:14<00:32, 22.12it/s] 26%|██▌       | 255/980 [00:14<00:38, 18.82it/s] 26%|██▋       | 258/980 [00:15<00:51, 14.11it/s] 27%|██▋       | 260/980 [00:15<00:55, 12.96it/s] 27%|██▋       | 262/980 [00:15<01:00, 11.85it/s] 27%|██▋       | 264/980 [00:15<00:55, 12.79it/s] 27%|██▋       | 266/980 [00:15<00:50, 14.12it/s] 27%|██▋       | 269/980 [00:15<00:43, 16.36it/s] 28%|██▊       | 272/980 [00:15<00:37, 18.83it/s] 28%|██▊       | 275/980 [00:16<00:33, 20.87it/s] 28%|██▊       | 278/980 [00:16<00:31, 22.41it/s] 29%|██▊       | 281/980 [00:16<00:29, 23.50it/s] 29%|██▉       | 284/980 [00:16<00:28, 24.46it/s] 29%|██▉       | 287/980 [00:16<00:29, 23.66it/s] 30%|██▉       | 290/980 [00:16<00:34, 20.10it/s] 30%|██▉       | 293/980 [00:17<00:42, 16.12it/s] 30%|███       | 295/980 [00:17<00:46, 14.83it/s] 30%|███       | 297/980 [00:17<00:48, 14.19it/s] 31%|███       | 299/980 [00:17<00:50, 13.42it/s] 31%|███       | 301/980 [00:17<00:48, 14.11it/s] 31%|███       | 304/980 [00:17<00:41, 16.11it/s] 31%|███▏      | 307/980 [00:17<00:36, 18.40it/s] 32%|███▏      | 310/980 [00:18<00:33, 20.16it/s] 32%|███▏      | 313/980 [00:18<00:30, 21.66it/s] 32%|███▏      | 316/980 [00:18<00:28, 22.93it/s] 33%|███▎      | 319/980 [00:18<00:27, 23.80it/s] 33%|███▎      | 322/980 [00:18<00:26, 24.63it/s] 33%|███▎      | 325/980 [00:18<00:28, 22.94it/s] 33%|███▎      | 328/980 [00:18<00:31, 20.52it/s] 34%|███▍      | 331/980 [00:19<00:34, 18.83it/s] 34%|███▍      | 333/980 [00:19<00:42, 15.32it/s] 34%|███▍      | 335/980 [00:19<00:43, 14.78it/s] 34%|███▍      | 337/980 [00:19<00:44, 14.58it/s] 35%|███▍      | 339/980 [00:19<00:45, 14.02it/s] 35%|███▍      | 342/980 [00:19<00:39, 16.16it/s] 35%|███▌      | 345/980 [00:19<00:35, 18.13it/s] 36%|███▌      | 348/980 [00:20<00:31, 20.02it/s] 36%|███▌      | 351/980 [00:20<00:29, 21.28it/s] 36%|███▌      | 354/980 [00:20<00:28, 22.20it/s] 36%|███▋      | 357/980 [00:20<00:26, 23.12it/s] 37%|███▋      | 360/980 [00:20<00:26, 23.74it/s] 37%|███▋      | 363/980 [00:20<00:26, 23.07it/s] 37%|███▋      | 366/980 [00:20<00:33, 18.40it/s] 38%|███▊      | 369/980 [00:21<00:41, 14.82it/s] 38%|███▊      | 371/980 [00:21<00:44, 13.77it/s] 38%|███▊      | 373/980 [00:21<00:53, 11.32it/s] 38%|███▊      | 375/980 [00:21<00:47, 12.67it/s] 39%|███▊      | 378/980 [00:21<00:39, 15.29it/s] 39%|███▉      | 381/980 [00:22<00:34, 17.59it/s] 39%|███▉      | 384/980 [00:22<00:30, 19.37it/s] 39%|███▉      | 387/980 [00:22<00:28, 20.90it/s] 40%|███▉      | 390/980 [00:22<00:26, 22.42it/s] 40%|████      | 393/980 [00:22<00:24, 23.71it/s] 40%|████      | 396/980 [00:22<00:23, 24.83it/s] 41%|████      | 399/980 [00:22<00:23, 24.32it/s] 41%|████      | 402/980 [00:22<00:25, 23.01it/s] 41%|████▏     | 405/980 [00:23<00:30, 19.01it/s] 42%|████▏     | 408/980 [00:23<00:34, 16.43it/s] 42%|████▏     | 410/980 [00:23<00:42, 13.54it/s] 42%|████▏     | 412/980 [00:23<00:45, 12.47it/s] 42%|████▏     | 414/980 [00:23<00:43, 12.98it/s] 43%|████▎     | 417/980 [00:24<00:36, 15.43it/s] 43%|████▎     | 420/980 [00:24<00:31, 17.82it/s] 43%|████▎     | 423/980 [00:24<00:28, 19.75it/s] 43%|████▎     | 426/980 [00:24<00:26, 21.27it/s] 44%|████▍     | 429/980 [00:24<00:24, 22.49it/s] 44%|████▍     | 432/980 [00:24<00:23, 23.67it/s] 44%|████▍     | 435/980 [00:24<00:22, 24.68it/s] 45%|████▍     | 438/980 [00:24<00:23, 23.51it/s] 45%|████▌     | 441/980 [00:25<00:30, 17.89it/s] 45%|████▌     | 444/980 [00:25<00:39, 13.73it/s] 46%|████▌     | 446/980 [00:25<00:41, 12.87it/s] 46%|████▌     | 448/980 [00:25<00:40, 13.01it/s] 46%|████▌     | 450/980 [00:25<00:38, 13.72it/s] 46%|████▌     | 453/980 [00:26<00:32, 16.07it/s] 47%|████▋     | 456/980 [00:26<00:28, 18.58it/s] 47%|████▋     | 459/980 [00:26<00:27, 18.66it/s] 47%|████▋     | 462/980 [00:26<00:25, 20.15it/s] 47%|████▋     | 465/980 [00:26<00:23, 21.65it/s] 48%|████▊     | 468/980 [00:26<00:21, 23.31it/s] 48%|████▊     | 471/980 [00:26<00:20, 24.58it/s] 48%|████▊     | 474/980 [00:26<00:22, 22.15it/s] 49%|████▊     | 477/980 [00:27<00:28, 17.56it/s] 49%|████▉     | 479/980 [00:27<00:31, 15.66it/s] 49%|████▉     | 481/980 [00:27<00:33, 14.73it/s] 49%|████▉     | 483/980 [00:27<00:35, 13.99it/s] 49%|████▉     | 485/980 [00:27<00:40, 12.35it/s] 50%|████▉     | 487/980 [00:28<00:37, 13.31it/s] 50%|████▉     | 489/980 [00:28<00:34, 14.31it/s] 50%|█████     | 491/980 [00:28<00:31, 15.39it/s] 50%|█████     | 494/980 [00:28<00:27, 17.75it/s] 51%|█████     | 497/980 [00:28<00:24, 19.70it/s] 51%|█████     | 500/980 [00:28<00:22, 21.21it/s] 51%|█████▏    | 503/980 [00:28<00:20, 23.03it/s] 52%|█████▏    | 506/980 [00:28<00:19, 24.58it/s] 52%|█████▏    | 509/980 [00:28<00:19, 24.02it/s] 52%|█████▏    | 512/980 [00:29<00:25, 18.09it/s] 53%|█████▎    | 515/980 [00:29<00:29, 16.02it/s] 53%|█████▎    | 517/980 [00:29<00:33, 13.95it/s] 53%|█████▎    | 519/980 [00:29<00:33, 13.69it/s] 53%|█████▎    | 521/980 [00:30<00:41, 11.07it/s] 53%|█████▎    | 524/980 [00:30<00:34, 13.35it/s] 54%|█████▎    | 526/980 [00:30<00:34, 13.03it/s] 54%|█████▍    | 528/980 [00:30<00:37, 12.08it/s] 54%|█████▍    | 530/980 [00:30<00:36, 12.42it/s] 54%|█████▍    | 532/980 [00:30<00:35, 12.50it/s] 54%|█████▍    | 534/980 [00:31<00:36, 12.17it/s] 55%|█████▍    | 536/980 [00:31<00:38, 11.65it/s] 55%|█████▌    | 539/980 [00:31<00:30, 14.65it/s] 55%|█████▌    | 542/980 [00:31<00:25, 17.37it/s] 56%|█████▌    | 545/980 [00:31<00:24, 17.98it/s] 56%|█████▌    | 548/980 [00:31<00:22, 19.33it/s] 56%|█████▌    | 551/980 [00:31<00:20, 21.17it/s] 57%|█████▋    | 554/980 [00:32<00:18, 22.79it/s] 57%|█████▋    | 557/980 [00:32<00:17, 24.29it/s] 57%|█████▋    | 560/980 [00:32<00:17, 24.43it/s] 57%|█████▋    | 563/980 [00:32<00:22, 18.15it/s] 58%|█████▊    | 566/980 [00:32<00:28, 14.60it/s] 58%|█████▊    | 568/980 [00:32<00:30, 13.54it/s] 58%|█████▊    | 570/980 [00:33<00:32, 12.47it/s] 58%|█████▊    | 572/980 [00:33<00:35, 11.44it/s] 59%|█████▊    | 575/980 [00:33<00:28, 14.27it/s] 59%|█████▉    | 578/980 [00:33<00:23, 17.08it/s] 59%|█████▉    | 581/980 [00:33<00:20, 19.60it/s] 60%|█████▉    | 584/980 [00:33<00:18, 21.67it/s] 60%|█████▉    | 587/980 [00:33<00:16, 23.19it/s] 60%|██████    | 590/980 [00:34<00:16, 24.30it/s] 61%|██████    | 593/980 [00:34<00:15, 25.49it/s] 61%|██████    | 596/980 [00:34<00:14, 26.35it/s] 61%|██████    | 599/980 [00:34<00:16, 23.79it/s] 61%|██████▏   | 602/980 [00:34<00:18, 20.60it/s] 62%|██████▏   | 605/980 [00:34<00:19, 18.98it/s] 62%|██████▏   | 608/980 [00:34<00:20, 17.74it/s] 62%|██████▏   | 610/980 [00:35<00:21, 17.26it/s] 62%|██████▏   | 612/980 [00:35<00:22, 16.69it/s] 63%|██████▎   | 614/980 [00:35<00:23, 15.87it/s] 63%|██████▎   | 616/980 [00:35<00:24, 14.77it/s] 63%|██████▎   | 619/980 [00:35<00:21, 17.06it/s] 63%|██████▎   | 622/980 [00:35<00:18, 19.69it/s] 64%|██████▍   | 625/980 [00:35<00:16, 21.70it/s] 64%|██████▍   | 628/980 [00:36<00:15, 22.09it/s] 64%|██████▍   | 631/980 [00:36<00:16, 21.76it/s] 65%|██████▍   | 634/980 [00:36<00:14, 23.10it/s] 65%|██████▌   | 637/980 [00:36<00:15, 21.95it/s] 65%|██████▌   | 640/980 [00:36<00:17, 19.32it/s] 66%|██████▌   | 643/980 [00:36<00:24, 13.96it/s] 66%|██████▌   | 645/980 [00:37<00:25, 13.26it/s] 66%|██████▌   | 647/980 [00:37<00:27, 11.93it/s] 66%|██████▌   | 649/980 [00:37<00:26, 12.50it/s] 66%|██████▋   | 651/980 [00:37<00:24, 13.35it/s] 67%|██████▋   | 654/980 [00:37<00:20, 15.73it/s] 67%|██████▋   | 657/980 [00:37<00:17, 18.14it/s] 67%|██████▋   | 660/980 [00:38<00:15, 20.31it/s] 68%|██████▊   | 663/980 [00:38<00:14, 22.15it/s] 68%|██████▊   | 666/980 [00:38<00:13, 23.74it/s] 68%|██████▊   | 669/980 [00:38<00:12, 24.67it/s] 69%|██████▊   | 672/980 [00:38<00:14, 21.52it/s] 69%|██████▉   | 675/980 [00:38<00:21, 14.37it/s] 69%|██████▉   | 677/980 [00:39<00:24, 12.55it/s] 69%|██████▉   | 679/980 [00:39<00:24, 12.34it/s] 69%|██████▉   | 681/980 [00:39<00:26, 11.18it/s] 70%|██████▉   | 683/980 [00:39<00:23, 12.58it/s] 70%|███████   | 686/980 [00:39<00:18, 15.77it/s] 70%|███████   | 689/980 [00:39<00:16, 17.37it/s] 71%|███████   | 691/980 [00:39<00:16, 17.86it/s] 71%|███████   | 694/980 [00:40<00:14, 19.63it/s] 71%|███████   | 697/980 [00:40<00:13, 21.34it/s] 71%|███████▏  | 700/980 [00:40<00:12, 22.85it/s] 72%|███████▏  | 703/980 [00:40<00:13, 20.61it/s] 72%|███████▏  | 706/980 [00:40<00:14, 19.17it/s] 72%|███████▏  | 709/980 [00:40<00:14, 18.14it/s] 73%|███████▎  | 711/980 [00:40<00:15, 17.57it/s] 73%|███████▎  | 713/980 [00:41<00:15, 17.18it/s] 73%|███████▎  | 715/980 [00:41<00:15, 16.79it/s] 73%|███████▎  | 717/980 [00:41<00:15, 16.52it/s] 73%|███████▎  | 719/980 [00:41<00:17, 14.92it/s] 74%|███████▎  | 721/980 [00:41<00:16, 15.52it/s] 74%|███████▍  | 724/980 [00:41<00:13, 18.75it/s] 74%|███████▍  | 727/980 [00:41<00:11, 21.41it/s] 74%|███████▍  | 730/980 [00:41<00:10, 23.46it/s] 75%|███████▍  | 733/980 [00:42<00:09, 24.92it/s] 75%|███████▌  | 736/980 [00:42<00:09, 26.07it/s] 75%|███████▌  | 739/980 [00:42<00:08, 26.98it/s] 76%|███████▌  | 742/980 [00:42<00:08, 27.61it/s] 76%|███████▌  | 745/980 [00:42<00:08, 27.99it/s] 76%|███████▋  | 748/980 [00:42<00:09, 25.17it/s] 77%|███████▋  | 751/980 [00:42<00:10, 21.49it/s] 77%|███████▋  | 754/980 [00:42<00:11, 19.29it/s] 77%|███████▋  | 757/980 [00:43<00:13, 16.82it/s] 77%|███████▋  | 759/980 [00:43<00:15, 14.41it/s] 78%|███████▊  | 761/980 [00:43<00:17, 12.64it/s] 78%|███████▊  | 764/980 [00:43<00:14, 15.29it/s] 78%|███████▊  | 767/980 [00:43<00:12, 17.56it/s] 79%|███████▊  | 770/980 [00:44<00:10, 19.82it/s] 79%|███████▉  | 773/980 [00:44<00:11, 18.37it/s] 79%|███████▉  | 776/980 [00:44<00:09, 20.56it/s] 79%|███████▉  | 779/980 [00:44<00:08, 22.41it/s] 80%|███████▉  | 782/980 [00:44<00:08, 24.05it/s] 80%|████████  | 785/980 [00:44<00:08, 24.34it/s] 80%|████████  | 788/980 [00:44<00:08, 22.63it/s] 81%|████████  | 791/980 [00:44<00:09, 20.88it/s] 81%|████████  | 794/980 [00:45<00:11, 16.69it/s] 81%|████████  | 796/980 [00:45<00:12, 14.52it/s] 81%|████████▏ | 798/980 [00:45<00:13, 13.10it/s] 82%|████████▏ | 800/980 [00:45<00:12, 14.02it/s] 82%|████████▏ | 803/980 [00:45<00:10, 17.01it/s] 82%|████████▏ | 806/980 [00:45<00:08, 19.74it/s] 83%|████████▎ | 809/980 [00:46<00:07, 22.06it/s] 83%|████████▎ | 813/980 [00:46<00:06, 24.74it/s] 83%|████████▎ | 816/980 [00:46<00:06, 26.03it/s] 84%|████████▎ | 819/980 [00:46<00:06, 24.85it/s] 84%|████████▍ | 822/980 [00:46<00:06, 24.57it/s] 84%|████████▍ | 825/980 [00:46<00:06, 24.31it/s] 84%|████████▍ | 828/980 [00:46<00:06, 21.79it/s] 85%|████████▍ | 831/980 [00:46<00:07, 20.68it/s] 85%|████████▌ | 834/980 [00:47<00:07, 18.66it/s] 85%|████████▌ | 836/980 [00:47<00:08, 16.26it/s] 86%|████████▌ | 838/980 [00:47<00:09, 15.26it/s] 86%|████████▌ | 840/980 [00:47<00:10, 13.39it/s] 86%|████████▌ | 843/980 [00:47<00:08, 15.83it/s] 86%|████████▋ | 846/980 [00:47<00:07, 18.60it/s] 87%|████████▋ | 849/980 [00:48<00:06, 21.17it/s] 87%|████████▋ | 853/980 [00:48<00:05, 23.92it/s] 87%|████████▋ | 857/980 [00:48<00:04, 25.96it/s] 88%|████████▊ | 861/980 [00:48<00:04, 27.61it/s] 88%|████████▊ | 865/980 [00:48<00:03, 28.88it/s] 89%|████████▊ | 868/980 [00:48<00:04, 26.31it/s] 89%|████████▉ | 871/980 [00:48<00:04, 21.82it/s] 89%|████████▉ | 874/980 [00:49<00:06, 16.14it/s] 89%|████████▉ | 876/980 [00:49<00:07, 14.03it/s] 90%|████████▉ | 878/980 [00:49<00:08, 11.72it/s] 90%|████████▉ | 880/980 [00:49<00:07, 12.84it/s] 90%|█████████ | 883/980 [00:49<00:06, 15.85it/s] 90%|█████████ | 886/980 [00:50<00:05, 18.66it/s] 91%|█████████ | 889/980 [00:50<00:04, 21.03it/s] 91%|█████████ | 892/980 [00:50<00:03, 23.01it/s] 91%|█████████▏| 895/980 [00:50<00:03, 24.66it/s] 92%|█████████▏| 898/980 [00:50<00:03, 25.69it/s] 92%|█████████▏| 901/980 [00:50<00:02, 26.35it/s] 92%|█████████▏| 904/980 [00:50<00:02, 26.96it/s] 93%|█████████▎| 907/980 [00:50<00:02, 25.36it/s] 93%|█████████▎| 910/980 [00:50<00:02, 24.36it/s] 93%|█████████▎| 913/980 [00:51<00:02, 22.55it/s] 93%|█████████▎| 916/980 [00:51<00:03, 19.33it/s] 94%|█████████▍| 919/980 [00:51<00:03, 15.53it/s] 94%|█████████▍| 921/980 [00:51<00:04, 14.49it/s] 94%|█████████▍| 923/980 [00:51<00:03, 14.80it/s] 94%|█████████▍| 926/980 [00:51<00:03, 17.81it/s] 95%|█████████▍| 929/980 [00:52<00:02, 20.12it/s] 95%|█████████▌| 932/980 [00:52<00:02, 22.27it/s] 95%|█████████▌| 935/980 [00:52<00:01, 24.11it/s] 96%|█████████▌| 939/980 [00:52<00:01, 26.29it/s] 96%|█████████▌| 943/980 [00:52<00:01, 28.07it/s] 97%|█████████▋| 947/980 [00:52<00:01, 29.48it/s] 97%|█████████▋| 951/980 [00:52<00:00, 29.33it/s] 97%|█████████▋| 954/980 [00:52<00:01, 25.60it/s] 98%|█████████▊| 957/980 [00:53<00:01, 21.95it/s] 98%|█████████▊| 960/980 [00:53<00:00, 20.92it/s] 98%|█████████▊| 963/980 [00:53<00:00, 19.80it/s] 99%|█████████▊| 966/980 [00:53<00:00, 16.25it/s] 99%|█████████▉| 968/980 [00:53<00:00, 14.34it/s] 99%|█████████▉| 971/980 [00:54<00:00, 17.00it/s] 99%|█████████▉| 974/980 [00:54<00:00, 19.59it/s]100%|█████████▉| 978/980 [00:54<00:00, 22.88it/s]100%|██████████| 980/980 [00:54<00:00, 18.03it/s]
time :  1337
prob :  1337
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_5_Focal_RS_DRW_seed_42
train data : 14374, disrupt : 227, non-disrupt : 14147
valid data : 3506, disrupt : 57, non-disrupt : 3449
test data : 4049, disrupt : 71, non-disrupt : 3978

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.142, valid loss : 0.102, train f1 : 0.687, valid f1 : 0.514
Best score increase :0.000 -> 0.514
training process - Deferred Re-weighting:   1%|          | 1/128 [04:01<8:30:13, 241.05s/it]Best score increase :0.514 -> 0.576
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:10<7:22:35, 210.76s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:26<7:04:46, 203.89s/it]Best score increase :0.576 -> 0.596
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:40<6:53:18, 199.99s/it]epoch : 5, train loss : 0.061, valid loss : 0.036, train f1 : 0.893, valid f1 : 0.590
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:52<7:28:53, 218.97s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [21:43<7:33:27, 223.01s/it]Best score increase :0.596 -> 0.606
training process - Deferred Re-weighting:   5%|▌         | 7/128 [25:08<7:17:21, 216.88s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [28:20<6:58:02, 209.02s/it]epoch : 9, train loss : 0.049, valid loss : 0.060, train f1 : 0.919, valid f1 : 0.544
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [32:18<7:12:47, 218.21s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [35:33<6:54:47, 210.91s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [38:47<6:41:11, 205.74s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [41:58<6:29:15, 201.34s/it]epoch : 13, train loss : 0.042, valid loss : 0.040, train f1 : 0.928, valid f1 : 0.667
Best score increase :0.606 -> 0.667
training process - Deferred Re-weighting:  10%|█         | 13/128 [45:56<6:47:15, 212.49s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [49:12<6:34:13, 207.49s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [52:27<6:23:23, 203.57s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [55:39<6:13:37, 200.15s/it]epoch : 17, train loss : 0.037, valid loss : 0.059, train f1 : 0.933, valid f1 : 0.567
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [59:39<6:32:36, 212.22s/it]Best score increase :0.667 -> 0.703
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:02:57<6:20:55, 207.77s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:06:07<6:08:02, 202.59s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:09:19<5:58:38, 199.25s/it]epoch : 21, train loss : 0.034, valid loss : 0.041, train f1 : 0.944, valid f1 : 0.595
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:13:16<6:15:41, 210.67s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:16:26<6:01:31, 204.63s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:19:40<5:52:20, 201.34s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:23:07<5:51:48, 202.96s/it]epoch : 25, train loss : 0.033, valid loss : 0.053, train f1 : 0.946, valid f1 : 0.637
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:28:04<6:37:00, 231.26s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:31:50<6:30:24, 229.65s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:35:21<6:17:02, 223.98s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:38:28<5:54:45, 212.85s/it]epoch : 29, train loss : 0.033, valid loss : 0.041, train f1 : 0.950, valid f1 : 0.702
EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:42:20<6:00:55, 218.74s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 29, best f1 score : 0.704
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:45:29<6:00:06, 218.25s/it]
training process finished, best loss : 0.044, best acc : 0.969, best f1 : 0.704, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.27      0.70      0.39        71
           1       0.99      0.97      0.98      3978

    accuracy                           0.96      4049
   macro avg       0.63      0.84      0.69      4049
weighted avg       0.98      0.96      0.97      4049


# test acc : 0.96, test f1 : 0.69, test AUC : 0.84, test loss : 2.128

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/979 [00:00<?, ?it/s]  0%|          | 2/979 [00:00<00:48, 19.96it/s]  1%|          | 5/979 [00:00<00:48, 19.90it/s]  1%|          | 7/979 [00:00<00:53, 18.09it/s]  1%|          | 9/979 [00:00<00:56, 17.29it/s]  1%|          | 11/979 [00:00<00:57, 16.88it/s]  1%|▏         | 13/979 [00:00<00:58, 16.64it/s]  2%|▏         | 15/979 [00:00<00:58, 16.42it/s]  2%|▏         | 17/979 [00:00<00:58, 16.32it/s]  2%|▏         | 19/979 [00:01<01:01, 15.72it/s]  2%|▏         | 22/979 [00:01<00:52, 18.16it/s]  3%|▎         | 25/979 [00:01<00:45, 20.88it/s]  3%|▎         | 28/979 [00:01<00:41, 22.98it/s]  3%|▎         | 31/979 [00:01<00:38, 24.55it/s]  3%|▎         | 34/979 [00:01<00:36, 25.71it/s]  4%|▍         | 37/979 [00:01<00:35, 26.49it/s]  4%|▍         | 40/979 [00:01<00:34, 27.11it/s]  4%|▍         | 43/979 [00:01<00:33, 27.58it/s]  5%|▍         | 46/979 [00:02<00:34, 26.67it/s]  5%|▌         | 49/979 [00:02<00:34, 26.73it/s]  5%|▌         | 52/979 [00:02<00:39, 23.21it/s]  6%|▌         | 55/979 [00:02<00:44, 20.57it/s]  6%|▌         | 58/979 [00:02<00:48, 19.05it/s]  6%|▌         | 61/979 [00:02<00:50, 18.13it/s]  6%|▋         | 63/979 [00:03<00:53, 17.24it/s]  7%|▋         | 65/979 [00:03<00:53, 17.11it/s]  7%|▋         | 68/979 [00:03<00:47, 19.29it/s]  7%|▋         | 71/979 [00:03<00:44, 20.36it/s]  8%|▊         | 74/979 [00:03<00:40, 22.46it/s]  8%|▊         | 77/979 [00:03<00:37, 24.16it/s]  8%|▊         | 80/979 [00:03<00:35, 25.46it/s]  8%|▊         | 83/979 [00:03<00:33, 26.36it/s]  9%|▉         | 86/979 [00:03<00:32, 27.06it/s]  9%|▉         | 89/979 [00:04<00:32, 27.16it/s]  9%|▉         | 92/979 [00:04<00:37, 23.47it/s] 10%|▉         | 95/979 [00:04<00:42, 20.69it/s] 10%|█         | 98/979 [00:04<00:46, 19.09it/s] 10%|█         | 101/979 [00:04<00:45, 19.24it/s] 11%|█         | 104/979 [00:04<00:41, 21.27it/s] 11%|█         | 107/979 [00:05<00:41, 20.82it/s] 11%|█         | 110/979 [00:05<00:47, 18.13it/s] 11%|█▏        | 112/979 [00:05<00:47, 18.42it/s] 12%|█▏        | 115/979 [00:05<00:44, 19.48it/s] 12%|█▏        | 118/979 [00:05<00:39, 21.58it/s] 12%|█▏        | 121/979 [00:05<00:36, 23.27it/s] 13%|█▎        | 124/979 [00:05<00:34, 24.52it/s] 13%|█▎        | 127/979 [00:05<00:33, 25.62it/s] 13%|█▎        | 130/979 [00:06<00:32, 26.47it/s] 14%|█▎        | 133/979 [00:06<00:31, 26.59it/s] 14%|█▍        | 136/979 [00:06<00:36, 23.17it/s] 14%|█▍        | 139/979 [00:06<00:41, 20.49it/s] 15%|█▍        | 142/979 [00:06<00:44, 18.93it/s] 15%|█▍        | 145/979 [00:06<00:46, 17.99it/s] 15%|█▌        | 147/979 [00:07<00:50, 16.39it/s] 15%|█▌        | 149/979 [00:07<00:59, 13.95it/s] 15%|█▌        | 151/979 [00:07<00:56, 14.66it/s] 16%|█▌        | 154/979 [00:07<00:48, 17.07it/s] 16%|█▌        | 157/979 [00:07<00:42, 19.44it/s] 16%|█▋        | 160/979 [00:07<00:37, 21.72it/s] 17%|█▋        | 163/979 [00:07<00:34, 23.52it/s] 17%|█▋        | 166/979 [00:07<00:32, 24.88it/s] 17%|█▋        | 169/979 [00:07<00:31, 25.94it/s] 18%|█▊        | 172/979 [00:08<00:30, 26.74it/s] 18%|█▊        | 175/979 [00:08<00:29, 26.88it/s] 18%|█▊        | 178/979 [00:08<00:34, 23.23it/s] 18%|█▊        | 181/979 [00:08<00:44, 17.88it/s] 19%|█▉        | 184/979 [00:08<00:46, 17.21it/s] 19%|█▉        | 186/979 [00:08<00:46, 16.88it/s] 19%|█▉        | 188/979 [00:09<00:47, 16.59it/s] 19%|█▉        | 190/979 [00:09<00:47, 16.46it/s] 20%|█▉        | 192/979 [00:09<00:50, 15.68it/s] 20%|█▉        | 195/979 [00:09<00:44, 17.57it/s] 20%|██        | 197/979 [00:09<00:44, 17.59it/s] 20%|██        | 200/979 [00:09<00:38, 20.20it/s] 21%|██        | 203/979 [00:09<00:34, 22.31it/s] 21%|██        | 206/979 [00:09<00:32, 23.86it/s] 21%|██▏       | 209/979 [00:10<00:30, 24.98it/s] 22%|██▏       | 212/979 [00:10<00:29, 25.88it/s] 22%|██▏       | 215/979 [00:10<00:28, 26.57it/s] 22%|██▏       | 218/979 [00:10<00:29, 25.45it/s] 23%|██▎       | 221/979 [00:10<00:31, 24.10it/s] 23%|██▎       | 224/979 [00:10<00:36, 20.67it/s] 23%|██▎       | 227/979 [00:10<00:40, 18.75it/s] 23%|██▎       | 229/979 [00:11<00:41, 18.13it/s] 24%|██▎       | 231/979 [00:11<00:42, 17.40it/s] 24%|██▍       | 233/979 [00:11<00:44, 16.91it/s] 24%|██▍       | 235/979 [00:11<00:46, 16.05it/s] 24%|██▍       | 238/979 [00:11<00:41, 17.84it/s] 25%|██▍       | 241/979 [00:11<00:36, 20.28it/s] 25%|██▍       | 244/979 [00:11<00:33, 22.20it/s] 25%|██▌       | 247/979 [00:11<00:30, 23.68it/s] 26%|██▌       | 250/979 [00:12<00:33, 22.04it/s] 26%|██▌       | 253/979 [00:12<00:32, 22.52it/s] 26%|██▌       | 256/979 [00:12<00:30, 23.85it/s] 26%|██▋       | 259/979 [00:12<00:29, 24.17it/s] 27%|██▋       | 262/979 [00:12<00:29, 24.43it/s] 27%|██▋       | 265/979 [00:12<00:34, 20.99it/s] 27%|██▋       | 268/979 [00:12<00:37, 19.16it/s] 28%|██▊       | 271/979 [00:13<00:39, 18.06it/s] 28%|██▊       | 273/979 [00:13<00:40, 17.53it/s] 28%|██▊       | 275/979 [00:13<00:41, 17.13it/s] 28%|██▊       | 277/979 [00:13<00:47, 14.68it/s] 29%|██▊       | 280/979 [00:13<00:39, 17.56it/s] 29%|██▉       | 283/979 [00:13<00:34, 19.93it/s] 29%|██▉       | 286/979 [00:13<00:31, 21.89it/s] 30%|██▉       | 289/979 [00:13<00:29, 23.46it/s] 30%|██▉       | 292/979 [00:14<00:27, 24.66it/s] 30%|███       | 295/979 [00:14<00:26, 25.51it/s] 30%|███       | 298/979 [00:14<00:25, 26.21it/s] 31%|███       | 301/979 [00:14<00:25, 26.73it/s] 31%|███       | 304/979 [00:14<00:29, 22.50it/s] 31%|███▏      | 307/979 [00:14<00:35, 19.15it/s] 32%|███▏      | 310/979 [00:14<00:38, 17.45it/s] 32%|███▏      | 312/979 [00:15<00:38, 17.21it/s] 32%|███▏      | 314/979 [00:15<00:39, 16.79it/s] 32%|███▏      | 316/979 [00:15<00:41, 16.02it/s] 32%|███▏      | 318/979 [00:15<00:45, 14.40it/s] 33%|███▎      | 321/979 [00:15<00:38, 17.04it/s] 33%|███▎      | 324/979 [00:15<00:33, 19.62it/s] 33%|███▎      | 327/979 [00:15<00:30, 21.70it/s] 34%|███▎      | 330/979 [00:16<00:27, 23.32it/s] 34%|███▍      | 333/979 [00:16<00:26, 24.60it/s] 34%|███▍      | 336/979 [00:16<00:25, 25.50it/s] 35%|███▍      | 339/979 [00:16<00:24, 26.02it/s] 35%|███▍      | 342/979 [00:16<00:23, 26.64it/s] 35%|███▌      | 345/979 [00:16<00:26, 23.91it/s] 36%|███▌      | 348/979 [00:16<00:30, 20.74it/s] 36%|███▌      | 351/979 [00:16<00:33, 18.99it/s] 36%|███▌      | 354/979 [00:17<00:34, 17.91it/s] 36%|███▋      | 356/979 [00:17<00:35, 17.61it/s] 37%|███▋      | 358/979 [00:17<00:36, 17.01it/s] 37%|███▋      | 360/979 [00:17<00:40, 15.10it/s] 37%|███▋      | 362/979 [00:17<00:40, 15.29it/s] 37%|███▋      | 365/979 [00:17<00:34, 18.06it/s] 38%|███▊      | 368/979 [00:17<00:31, 19.62it/s] 38%|███▊      | 371/979 [00:18<00:29, 20.43it/s] 38%|███▊      | 374/979 [00:18<00:27, 21.81it/s] 39%|███▊      | 377/979 [00:18<00:26, 23.00it/s] 39%|███▉      | 380/979 [00:18<00:25, 23.72it/s] 39%|███▉      | 383/979 [00:18<00:24, 24.45it/s] 39%|███▉      | 386/979 [00:18<00:25, 22.82it/s] 40%|███▉      | 389/979 [00:18<00:26, 22.06it/s] 40%|████      | 392/979 [00:19<00:30, 19.11it/s] 40%|████      | 395/979 [00:19<00:33, 17.57it/s] 41%|████      | 397/979 [00:19<00:36, 15.85it/s] 41%|████      | 399/979 [00:19<00:39, 14.78it/s] 41%|████      | 402/979 [00:19<00:34, 16.57it/s] 41%|████▏     | 404/979 [00:19<00:36, 15.60it/s] 41%|████▏     | 406/979 [00:19<00:34, 16.53it/s] 42%|████▏     | 409/979 [00:20<00:29, 19.13it/s] 42%|████▏     | 412/979 [00:20<00:27, 20.85it/s] 42%|████▏     | 415/979 [00:20<00:29, 19.36it/s] 43%|████▎     | 418/979 [00:20<00:26, 20.80it/s] 43%|████▎     | 421/979 [00:20<00:25, 22.07it/s] 43%|████▎     | 424/979 [00:20<00:26, 21.03it/s] 44%|████▎     | 427/979 [00:20<00:27, 19.77it/s] 44%|████▍     | 430/979 [00:21<00:29, 18.48it/s] 44%|████▍     | 432/979 [00:21<00:29, 18.48it/s] 44%|████▍     | 434/979 [00:21<00:30, 17.96it/s] 45%|████▍     | 436/979 [00:21<00:31, 17.43it/s] 45%|████▍     | 438/979 [00:21<00:31, 17.26it/s] 45%|████▌     | 441/979 [00:21<00:29, 18.06it/s] 45%|████▌     | 443/979 [00:21<00:30, 17.73it/s] 46%|████▌     | 446/979 [00:22<00:27, 19.65it/s] 46%|████▌     | 449/979 [00:22<00:24, 21.38it/s] 46%|████▌     | 452/979 [00:22<00:23, 22.79it/s] 46%|████▋     | 455/979 [00:22<00:22, 23.74it/s] 47%|████▋     | 458/979 [00:22<00:21, 24.34it/s] 47%|████▋     | 461/979 [00:22<00:20, 24.84it/s] 47%|████▋     | 464/979 [00:22<00:20, 24.99it/s] 48%|████▊     | 467/979 [00:22<00:22, 22.84it/s] 48%|████▊     | 470/979 [00:23<00:22, 22.58it/s] 48%|████▊     | 473/979 [00:23<00:23, 21.39it/s] 49%|████▊     | 476/979 [00:23<00:22, 22.24it/s] 49%|████▉     | 479/979 [00:23<00:22, 22.19it/s] 49%|████▉     | 482/979 [00:23<00:22, 21.99it/s] 50%|████▉     | 485/979 [00:23<00:22, 21.82it/s] 50%|████▉     | 488/979 [00:23<00:22, 22.20it/s] 50%|█████     | 491/979 [00:23<00:21, 22.69it/s] 50%|█████     | 494/979 [00:24<00:20, 23.69it/s] 51%|█████     | 497/979 [00:24<00:19, 24.43it/s] 51%|█████     | 500/979 [00:24<00:19, 25.00it/s] 51%|█████▏    | 503/979 [00:24<00:18, 25.32it/s] 52%|█████▏    | 506/979 [00:24<00:18, 25.74it/s] 52%|█████▏    | 509/979 [00:24<00:18, 26.00it/s] 52%|█████▏    | 512/979 [00:24<00:17, 26.26it/s] 53%|█████▎    | 515/979 [00:24<00:19, 24.28it/s] 53%|█████▎    | 518/979 [00:25<00:19, 23.71it/s] 53%|█████▎    | 521/979 [00:25<00:20, 22.47it/s] 54%|█████▎    | 524/979 [00:25<00:19, 23.72it/s] 54%|█████▍    | 527/979 [00:25<00:22, 19.98it/s] 54%|█████▍    | 530/979 [00:25<00:23, 18.73it/s] 54%|█████▍    | 532/979 [00:25<00:23, 18.65it/s] 55%|█████▍    | 534/979 [00:25<00:28, 15.38it/s] 55%|█████▍    | 537/979 [00:26<00:24, 17.98it/s] 55%|█████▌    | 540/979 [00:26<00:21, 20.16it/s] 55%|█████▌    | 543/979 [00:26<00:21, 20.53it/s] 56%|█████▌    | 546/979 [00:26<00:21, 20.45it/s] 56%|█████▌    | 549/979 [00:26<00:19, 21.85it/s] 56%|█████▋    | 552/979 [00:26<00:18, 23.26it/s] 57%|█████▋    | 555/979 [00:26<00:17, 24.38it/s] 57%|█████▋    | 558/979 [00:26<00:17, 23.92it/s] 57%|█████▋    | 561/979 [00:27<00:18, 22.55it/s] 58%|█████▊    | 564/979 [00:27<00:19, 20.99it/s] 58%|█████▊    | 567/979 [00:27<00:28, 14.36it/s] 58%|█████▊    | 569/979 [00:27<00:29, 13.69it/s] 58%|█████▊    | 571/979 [00:27<00:29, 13.97it/s] 59%|█████▊    | 574/979 [00:28<00:25, 15.77it/s] 59%|█████▉    | 577/979 [00:28<00:22, 18.20it/s] 59%|█████▉    | 580/979 [00:28<00:19, 20.33it/s] 60%|█████▉    | 583/979 [00:28<00:17, 22.00it/s] 60%|█████▉    | 586/979 [00:28<00:16, 23.31it/s] 60%|██████    | 589/979 [00:28<00:18, 21.24it/s] 60%|██████    | 592/979 [00:28<00:17, 22.21it/s] 61%|██████    | 595/979 [00:28<00:16, 22.80it/s] 61%|██████    | 598/979 [00:29<00:15, 24.38it/s] 61%|██████▏   | 601/979 [00:29<00:18, 20.35it/s] 62%|██████▏   | 604/979 [00:29<00:23, 15.78it/s] 62%|██████▏   | 606/979 [00:29<00:24, 15.00it/s] 62%|██████▏   | 608/979 [00:29<00:24, 15.20it/s] 62%|██████▏   | 610/979 [00:29<00:24, 14.83it/s] 63%|██████▎   | 612/979 [00:30<00:24, 15.18it/s] 63%|██████▎   | 615/979 [00:30<00:19, 18.36it/s] 63%|██████▎   | 618/979 [00:30<00:17, 21.01it/s] 63%|██████▎   | 621/979 [00:30<00:15, 23.18it/s] 64%|██████▎   | 624/979 [00:30<00:14, 24.85it/s] 64%|██████▍   | 627/979 [00:30<00:13, 26.11it/s] 64%|██████▍   | 630/979 [00:30<00:12, 27.12it/s] 65%|██████▍   | 633/979 [00:30<00:12, 27.86it/s] 65%|██████▌   | 637/979 [00:30<00:11, 28.62it/s] 65%|██████▌   | 640/979 [00:31<00:13, 25.88it/s] 66%|██████▌   | 643/979 [00:31<00:15, 22.21it/s] 66%|██████▌   | 646/979 [00:31<00:16, 20.21it/s] 66%|██████▋   | 649/979 [00:31<00:17, 18.97it/s] 66%|██████▋   | 651/979 [00:31<00:17, 18.56it/s] 67%|██████▋   | 653/979 [00:31<00:18, 17.74it/s] 67%|██████▋   | 655/979 [00:32<00:20, 15.57it/s] 67%|██████▋   | 657/979 [00:32<00:20, 15.79it/s] 67%|██████▋   | 660/979 [00:32<00:17, 18.65it/s] 68%|██████▊   | 663/979 [00:32<00:15, 20.89it/s] 68%|██████▊   | 666/979 [00:32<00:13, 22.62it/s] 68%|██████▊   | 669/979 [00:32<00:12, 23.91it/s] 69%|██████▊   | 672/979 [00:32<00:12, 24.77it/s] 69%|██████▉   | 675/979 [00:32<00:11, 25.47it/s] 69%|██████▉   | 678/979 [00:32<00:11, 26.01it/s] 70%|██████▉   | 681/979 [00:33<00:12, 23.77it/s] 70%|██████▉   | 684/979 [00:33<00:12, 22.79it/s] 70%|███████   | 687/979 [00:33<00:14, 20.54it/s] 70%|███████   | 690/979 [00:33<00:15, 19.20it/s] 71%|███████   | 692/979 [00:33<00:15, 18.56it/s] 71%|███████   | 694/979 [00:33<00:15, 18.06it/s] 71%|███████   | 696/979 [00:34<00:17, 16.13it/s] 71%|███████▏  | 698/979 [00:34<00:20, 13.70it/s] 72%|███████▏  | 701/979 [00:34<00:16, 16.65it/s] 72%|███████▏  | 703/979 [00:34<00:15, 17.35it/s] 72%|███████▏  | 705/979 [00:34<00:15, 17.85it/s] 72%|███████▏  | 708/979 [00:34<00:13, 19.87it/s] 73%|███████▎  | 711/979 [00:34<00:12, 21.82it/s] 73%|███████▎  | 714/979 [00:34<00:11, 23.35it/s] 73%|███████▎  | 717/979 [00:34<00:10, 24.44it/s] 74%|███████▎  | 720/979 [00:35<00:10, 25.22it/s] 74%|███████▍  | 723/979 [00:35<00:10, 23.28it/s] 74%|███████▍  | 726/979 [00:35<00:12, 20.66it/s] 74%|███████▍  | 729/979 [00:35<00:14, 16.78it/s] 75%|███████▍  | 731/979 [00:35<00:16, 14.82it/s] 75%|███████▍  | 733/979 [00:36<00:16, 14.66it/s] 75%|███████▌  | 735/979 [00:36<00:20, 11.77it/s] 75%|███████▌  | 738/979 [00:36<00:16, 14.37it/s] 76%|███████▌  | 741/979 [00:36<00:13, 17.03it/s] 76%|███████▌  | 744/979 [00:36<00:12, 19.40it/s] 76%|███████▋  | 747/979 [00:36<00:10, 21.30it/s] 77%|███████▋  | 750/979 [00:36<00:10, 22.83it/s] 77%|███████▋  | 753/979 [00:36<00:09, 24.35it/s] 77%|███████▋  | 756/979 [00:37<00:08, 25.17it/s] 78%|███████▊  | 759/979 [00:37<00:08, 25.48it/s] 78%|███████▊  | 762/979 [00:37<00:08, 24.92it/s] 78%|███████▊  | 765/979 [00:37<00:09, 23.30it/s] 78%|███████▊  | 768/979 [00:37<00:09, 21.21it/s] 79%|███████▉  | 771/979 [00:37<00:10, 20.33it/s] 79%|███████▉  | 774/979 [00:37<00:11, 18.50it/s] 79%|███████▉  | 776/979 [00:38<00:10, 18.47it/s] 79%|███████▉  | 778/979 [00:38<00:11, 17.78it/s] 80%|███████▉  | 780/979 [00:38<00:11, 16.86it/s] 80%|███████▉  | 783/979 [00:38<00:10, 18.54it/s] 80%|████████  | 786/979 [00:38<00:09, 20.91it/s] 81%|████████  | 789/979 [00:38<00:08, 22.94it/s] 81%|████████  | 792/979 [00:38<00:07, 24.60it/s] 81%|████████▏ | 796/979 [00:38<00:06, 26.46it/s] 82%|████████▏ | 800/979 [00:39<00:06, 27.64it/s] 82%|████████▏ | 804/979 [00:39<00:06, 28.69it/s] 82%|████████▏ | 807/979 [00:39<00:06, 28.37it/s] 83%|████████▎ | 810/979 [00:39<00:07, 24.07it/s] 83%|████████▎ | 813/979 [00:39<00:07, 21.30it/s] 83%|████████▎ | 816/979 [00:39<00:09, 16.66it/s] 84%|████████▎ | 818/979 [00:40<00:10, 14.99it/s] 84%|████████▍ | 820/979 [00:40<00:12, 12.72it/s] 84%|████████▍ | 822/979 [00:40<00:11, 13.95it/s] 84%|████████▍ | 826/979 [00:40<00:08, 17.97it/s] 85%|████████▍ | 830/979 [00:40<00:07, 21.25it/s] 85%|████████▌ | 834/979 [00:40<00:06, 23.81it/s] 86%|████████▌ | 838/979 [00:40<00:05, 25.78it/s] 86%|████████▌ | 842/979 [00:41<00:05, 27.18it/s] 86%|████████▋ | 846/979 [00:41<00:04, 28.11it/s] 87%|████████▋ | 849/979 [00:41<00:04, 27.04it/s] 87%|████████▋ | 852/979 [00:41<00:05, 24.49it/s] 87%|████████▋ | 855/979 [00:41<00:07, 16.49it/s] 88%|████████▊ | 858/979 [00:42<00:08, 14.18it/s] 88%|████████▊ | 860/979 [00:42<00:08, 13.59it/s] 88%|████████▊ | 862/979 [00:42<00:09, 12.81it/s] 88%|████████▊ | 865/979 [00:42<00:07, 15.22it/s] 89%|████████▊ | 868/979 [00:42<00:06, 17.86it/s] 89%|████████▉ | 872/979 [00:42<00:05, 21.13it/s] 89%|████████▉ | 876/979 [00:42<00:04, 23.65it/s] 90%|████████▉ | 880/979 [00:43<00:03, 25.57it/s] 90%|█████████ | 884/979 [00:43<00:03, 26.90it/s] 91%|█████████ | 888/979 [00:43<00:03, 28.54it/s] 91%|█████████ | 891/979 [00:43<00:03, 28.50it/s] 91%|█████████▏| 895/979 [00:43<00:02, 28.90it/s] 92%|█████████▏| 898/979 [00:43<00:03, 25.59it/s] 92%|█████████▏| 901/979 [00:43<00:03, 23.54it/s] 92%|█████████▏| 904/979 [00:44<00:04, 17.85it/s] 93%|█████████▎| 907/979 [00:44<00:04, 15.08it/s] 93%|█████████▎| 909/979 [00:44<00:04, 15.01it/s] 93%|█████████▎| 913/979 [00:44<00:03, 18.70it/s] 94%|█████████▎| 917/979 [00:44<00:02, 22.02it/s] 94%|█████████▍| 921/979 [00:44<00:02, 24.80it/s] 94%|█████████▍| 925/979 [00:45<00:01, 27.05it/s] 95%|█████████▍| 929/979 [00:45<00:01, 28.77it/s] 95%|█████████▌| 933/979 [00:45<00:01, 30.10it/s] 96%|█████████▌| 937/979 [00:45<00:01, 30.55it/s] 96%|█████████▌| 941/979 [00:45<00:01, 26.68it/s] 96%|█████████▋| 944/979 [00:45<00:01, 24.32it/s] 97%|█████████▋| 947/979 [00:45<00:01, 22.44it/s] 97%|█████████▋| 950/979 [00:46<00:01, 21.26it/s] 97%|█████████▋| 953/979 [00:46<00:01, 20.62it/s] 98%|█████████▊| 956/979 [00:46<00:01, 20.19it/s] 98%|█████████▊| 959/979 [00:46<00:01, 19.42it/s] 98%|█████████▊| 963/979 [00:46<00:00, 22.39it/s] 99%|█████████▉| 967/979 [00:46<00:00, 25.03it/s] 99%|█████████▉| 970/979 [00:47<00:00, 24.78it/s] 99%|█████████▉| 974/979 [00:47<00:00, 26.89it/s]100%|█████████▉| 978/979 [00:47<00:00, 28.57it/s]100%|██████████| 979/979 [00:47<00:00, 20.71it/s]
time :  1336
prob :  1336
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_1_Focal_RS_DRW_seed_43
train data : 14427, disrupt : 227, non-disrupt : 14200
valid data : 3519, disrupt : 57, non-disrupt : 3462
test data : 4062, disrupt : 71, non-disrupt : 3991

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.055, valid loss : 0.049, train f1 : 0.902, valid f1 : 0.562
Best score increase :0.000 -> 0.562
training process - Deferred Re-weighting:   1%|          | 1/128 [03:55<8:18:49, 235.66s/it]Best score increase :0.562 -> 0.614
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:06<7:19:18, 209.19s/it]Best score increase :0.614 -> 0.618
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:18<6:59:56, 201.57s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:25<6:44:16, 195.62s/it]epoch : 5, train loss : 0.024, valid loss : 0.026, train f1 : 0.952, valid f1 : 0.688
Best score increase :0.618 -> 0.688
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:14<7:05:57, 207.78s/it]Best score increase :0.688 -> 0.782
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:22<6:49:01, 201.16s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [23:35<6:39:57, 198.33s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [26:41<6:28:35, 194.30s/it]epoch : 9, train loss : 0.021, valid loss : 0.053, train f1 : 0.960, valid f1 : 0.613
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [30:32<6:48:34, 206.01s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [33:43<6:35:44, 201.23s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [36:53<6:25:54, 197.90s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [40:02<6:17:12, 195.11s/it]epoch : 13, train loss : 0.020, valid loss : 0.023, train f1 : 0.961, valid f1 : 0.645
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [43:55<6:36:12, 206.72s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [47:07<6:23:51, 202.03s/it]Best score increase :0.782 -> 0.908
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [50:13<6:11:42, 197.37s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [53:20<6:02:34, 194.24s/it]epoch : 17, train loss : 0.018, valid loss : 0.023, train f1 : 0.966, valid f1 : 0.788
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [57:12<6:20:08, 205.48s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:00:16<6:04:49, 199.00s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:03:22<5:54:41, 195.25s/it]Best score increase :0.908 -> 0.914
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:06:28<5:46:29, 192.49s/it]epoch : 21, train loss : 0.017, valid loss : 0.022, train f1 : 0.969, valid f1 : 0.697
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:10:17<6:02:31, 203.28s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:13:24<5:50:52, 198.61s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:16:36<5:43:59, 196.56s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:19:42<5:35:07, 193.34s/it]epoch : 25, train loss : 0.018, valid loss : 0.023, train f1 : 0.967, valid f1 : 0.663
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:23:31<5:50:25, 204.13s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:26:38<5:38:17, 198.99s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:29:43<5:27:55, 194.81s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:32:48<5:19:23, 191.64s/it]epoch : 29, train loss : 0.017, valid loss : 0.021, train f1 : 0.972, valid f1 : 0.727
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:36:38<5:35:32, 203.36s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [1:39:45<5:24:02, 198.39s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:42:51<5:14:52, 194.77s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 31, best f1 score : 0.914
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:45:58<5:31:35, 205.11s/it]
training process finished, best loss : 0.012, best acc : 0.994, best f1 : 0.914, best epoch : 19

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.97      0.90      0.93        71
           1       1.00      1.00      1.00      3991

    accuracy                           1.00      4062
   macro avg       0.98      0.95      0.97      4062
weighted avg       1.00      1.00      1.00      4062


# test acc : 1.00, test f1 : 0.97, test AUC : 0.95, test loss : 0.278

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/983 [00:00<?, ?it/s]  0%|          | 2/983 [00:00<00:55, 17.54it/s]  1%|          | 5/983 [00:00<00:52, 18.69it/s]  1%|          | 7/983 [00:00<01:07, 14.46it/s]  1%|          | 9/983 [00:00<01:19, 12.32it/s]  1%|          | 11/983 [00:00<01:23, 11.58it/s]  1%|▏         | 13/983 [00:01<01:32, 10.54it/s]  2%|▏         | 15/983 [00:01<01:19, 12.16it/s]  2%|▏         | 18/983 [00:01<01:00, 15.87it/s]  2%|▏         | 21/983 [00:01<00:50, 19.03it/s]  2%|▏         | 24/983 [00:01<00:44, 21.62it/s]  3%|▎         | 27/983 [00:01<00:40, 23.64it/s]  3%|▎         | 30/983 [00:01<00:37, 25.12it/s]  3%|▎         | 33/983 [00:01<00:36, 26.28it/s]  4%|▎         | 36/983 [00:01<00:34, 27.08it/s]  4%|▍         | 39/983 [00:02<00:34, 27.70it/s]  4%|▍         | 42/983 [00:02<00:35, 26.80it/s]  5%|▍         | 45/983 [00:02<00:37, 25.14it/s]  5%|▍         | 48/983 [00:02<00:43, 21.58it/s]  5%|▌         | 51/983 [00:02<00:47, 19.62it/s]  5%|▌         | 54/983 [00:02<00:50, 18.26it/s]  6%|▌         | 56/983 [00:02<00:52, 17.57it/s]  6%|▌         | 58/983 [00:03<00:55, 16.53it/s]  6%|▌         | 60/983 [00:03<00:56, 16.41it/s]  6%|▋         | 63/983 [00:03<00:53, 17.31it/s]  7%|▋         | 66/983 [00:03<00:46, 19.51it/s]  7%|▋         | 69/983 [00:03<00:42, 21.35it/s]  7%|▋         | 72/983 [00:03<00:40, 22.76it/s]  8%|▊         | 75/983 [00:03<00:38, 23.78it/s]  8%|▊         | 78/983 [00:03<00:36, 24.58it/s]  8%|▊         | 81/983 [00:04<00:35, 25.07it/s]  9%|▊         | 84/983 [00:04<00:39, 22.61it/s]  9%|▉         | 87/983 [00:04<00:52, 17.07it/s]  9%|▉         | 89/983 [00:04<01:00, 14.88it/s]  9%|▉         | 91/983 [00:04<01:07, 13.17it/s]  9%|▉         | 93/983 [00:05<01:05, 13.62it/s] 10%|▉         | 95/983 [00:05<01:02, 14.11it/s] 10%|▉         | 98/983 [00:05<00:51, 17.18it/s] 10%|█         | 101/983 [00:05<00:46, 19.10it/s] 11%|█         | 104/983 [00:05<00:42, 20.51it/s] 11%|█         | 107/983 [00:05<00:39, 22.06it/s] 11%|█         | 110/983 [00:05<00:37, 23.36it/s] 11%|█▏        | 113/983 [00:05<00:35, 24.22it/s] 12%|█▏        | 116/983 [00:05<00:34, 24.86it/s] 12%|█▏        | 119/983 [00:06<00:34, 25.27it/s] 12%|█▏        | 122/983 [00:06<00:34, 24.70it/s] 13%|█▎        | 125/983 [00:06<00:36, 23.62it/s] 13%|█▎        | 128/983 [00:06<00:41, 20.44it/s] 13%|█▎        | 131/983 [00:06<00:45, 18.92it/s] 14%|█▎        | 133/983 [00:06<00:50, 16.91it/s] 14%|█▎        | 135/983 [00:07<00:53, 15.73it/s] 14%|█▍        | 137/983 [00:07<01:04, 13.08it/s] 14%|█▍        | 139/983 [00:07<01:00, 13.96it/s] 14%|█▍        | 142/983 [00:07<00:49, 16.95it/s] 15%|█▍        | 145/983 [00:07<00:43, 19.43it/s] 15%|█▌        | 148/983 [00:07<00:38, 21.57it/s] 15%|█▌        | 151/983 [00:07<00:35, 23.26it/s] 16%|█▌        | 154/983 [00:07<00:33, 24.55it/s] 16%|█▌        | 157/983 [00:08<00:32, 25.53it/s] 16%|█▋        | 160/983 [00:08<00:31, 26.23it/s] 17%|█▋        | 163/983 [00:08<00:31, 26.19it/s] 17%|█▋        | 166/983 [00:08<00:36, 22.50it/s] 17%|█▋        | 169/983 [00:08<00:46, 17.38it/s] 17%|█▋        | 172/983 [00:09<00:57, 14.09it/s] 18%|█▊        | 174/983 [00:09<01:03, 12.81it/s] 18%|█▊        | 176/983 [00:09<01:02, 12.87it/s] 18%|█▊        | 179/983 [00:09<00:52, 15.31it/s] 19%|█▊        | 182/983 [00:09<00:44, 17.97it/s] 19%|█▉        | 185/983 [00:09<00:39, 20.44it/s] 19%|█▉        | 188/983 [00:09<00:35, 22.50it/s] 19%|█▉        | 191/983 [00:09<00:32, 24.23it/s] 20%|█▉        | 194/983 [00:10<00:30, 25.55it/s] 20%|██        | 197/983 [00:10<00:29, 26.54it/s] 20%|██        | 200/983 [00:10<00:28, 27.30it/s] 21%|██        | 203/983 [00:10<00:29, 26.05it/s] 21%|██        | 206/983 [00:10<00:38, 20.13it/s] 21%|██▏       | 209/983 [00:10<00:42, 18.21it/s] 22%|██▏       | 212/983 [00:10<00:44, 17.37it/s] 22%|██▏       | 215/983 [00:11<00:41, 18.30it/s] 22%|██▏       | 217/983 [00:11<00:42, 18.16it/s] 22%|██▏       | 219/983 [00:11<00:45, 16.78it/s] 22%|██▏       | 221/983 [00:11<00:45, 16.81it/s] 23%|██▎       | 224/983 [00:11<00:39, 19.42it/s] 23%|██▎       | 227/983 [00:11<00:35, 21.54it/s] 23%|██▎       | 230/983 [00:11<00:32, 23.16it/s] 24%|██▎       | 233/983 [00:11<00:30, 24.23it/s] 24%|██▍       | 236/983 [00:12<00:29, 25.07it/s] 24%|██▍       | 239/983 [00:12<00:28, 25.74it/s] 25%|██▍       | 242/983 [00:12<00:28, 26.22it/s] 25%|██▍       | 245/983 [00:12<00:28, 26.19it/s] 25%|██▌       | 248/983 [00:12<00:29, 25.16it/s] 26%|██▌       | 251/983 [00:12<00:34, 21.29it/s] 26%|██▌       | 254/983 [00:12<00:39, 18.23it/s] 26%|██▌       | 256/983 [00:13<00:46, 15.66it/s] 26%|██▌       | 258/983 [00:13<00:46, 15.59it/s] 26%|██▋       | 260/983 [00:13<00:46, 15.56it/s] 27%|██▋       | 262/983 [00:13<00:47, 15.17it/s] 27%|██▋       | 264/983 [00:13<00:44, 16.20it/s] 27%|██▋       | 267/983 [00:13<00:44, 16.08it/s] 27%|██▋       | 270/983 [00:13<00:39, 18.22it/s] 28%|██▊       | 273/983 [00:14<00:34, 20.66it/s] 28%|██▊       | 276/983 [00:14<00:31, 22.66it/s] 28%|██▊       | 279/983 [00:14<00:29, 24.24it/s] 29%|██▊       | 282/983 [00:14<00:27, 25.37it/s] 29%|██▉       | 285/983 [00:14<00:27, 25.71it/s] 29%|██▉       | 288/983 [00:14<00:26, 25.78it/s] 30%|██▉       | 291/983 [00:14<00:31, 21.96it/s] 30%|██▉       | 294/983 [00:14<00:35, 19.16it/s] 30%|███       | 297/983 [00:15<00:38, 17.80it/s] 30%|███       | 299/983 [00:15<00:40, 17.05it/s] 31%|███       | 301/983 [00:15<00:41, 16.45it/s] 31%|███       | 303/983 [00:15<00:39, 17.18it/s] 31%|███       | 305/983 [00:15<00:39, 17.27it/s] 31%|███       | 307/983 [00:15<00:41, 16.45it/s] 32%|███▏      | 310/983 [00:15<00:34, 19.39it/s] 32%|███▏      | 313/983 [00:15<00:30, 21.66it/s] 32%|███▏      | 316/983 [00:16<00:28, 23.43it/s] 32%|███▏      | 319/983 [00:16<00:26, 24.81it/s] 33%|███▎      | 322/983 [00:16<00:25, 25.86it/s] 33%|███▎      | 325/983 [00:16<00:24, 26.65it/s] 33%|███▎      | 328/983 [00:16<00:25, 26.12it/s] 34%|███▎      | 331/983 [00:16<00:27, 23.89it/s] 34%|███▍      | 334/983 [00:16<00:31, 20.73it/s] 34%|███▍      | 337/983 [00:17<00:34, 18.83it/s] 34%|███▍      | 339/983 [00:17<00:37, 17.24it/s] 35%|███▍      | 341/983 [00:17<00:38, 16.88it/s] 35%|███▍      | 343/983 [00:17<00:38, 16.60it/s] 35%|███▌      | 345/983 [00:17<00:40, 15.91it/s] 35%|███▌      | 348/983 [00:17<00:35, 17.99it/s] 36%|███▌      | 351/983 [00:17<00:30, 20.56it/s] 36%|███▌      | 354/983 [00:17<00:27, 22.64it/s] 36%|███▋      | 357/983 [00:18<00:25, 24.23it/s] 37%|███▋      | 360/983 [00:18<00:24, 25.39it/s] 37%|███▋      | 363/983 [00:18<00:24, 25.57it/s] 37%|███▋      | 366/983 [00:18<00:24, 25.54it/s] 38%|███▊      | 369/983 [00:18<00:23, 25.86it/s] 38%|███▊      | 372/983 [00:18<00:27, 22.41it/s] 38%|███▊      | 375/983 [00:18<00:30, 19.62it/s] 38%|███▊      | 378/983 [00:19<00:35, 16.91it/s] 39%|███▊      | 380/983 [00:19<00:44, 13.60it/s] 39%|███▉      | 382/983 [00:19<00:53, 11.34it/s] 39%|███▉      | 384/983 [00:19<00:48, 12.36it/s] 39%|███▉      | 387/983 [00:19<00:40, 14.84it/s] 40%|███▉      | 390/983 [00:19<00:34, 17.29it/s] 40%|███▉      | 393/983 [00:20<00:30, 19.33it/s] 40%|████      | 396/983 [00:20<00:27, 21.39it/s] 41%|████      | 399/983 [00:20<00:25, 23.10it/s] 41%|████      | 402/983 [00:20<00:23, 24.43it/s] 41%|████      | 405/983 [00:20<00:22, 25.42it/s] 42%|████▏     | 408/983 [00:20<00:22, 25.12it/s] 42%|████▏     | 411/983 [00:20<00:26, 21.24it/s] 42%|████▏     | 414/983 [00:21<00:29, 19.20it/s] 42%|████▏     | 417/983 [00:21<00:31, 17.95it/s] 43%|████▎     | 419/983 [00:21<00:32, 17.40it/s] 43%|████▎     | 421/983 [00:21<00:33, 16.85it/s] 43%|████▎     | 423/983 [00:21<00:35, 15.85it/s] 43%|████▎     | 425/983 [00:21<00:35, 15.63it/s] 44%|████▎     | 428/983 [00:21<00:29, 18.57it/s] 44%|████▍     | 431/983 [00:21<00:26, 20.91it/s] 44%|████▍     | 434/983 [00:22<00:24, 22.81it/s] 44%|████▍     | 437/983 [00:22<00:22, 24.29it/s] 45%|████▍     | 440/983 [00:22<00:21, 24.98it/s] 45%|████▌     | 443/983 [00:22<00:20, 25.93it/s] 45%|████▌     | 446/983 [00:22<00:20, 26.65it/s] 46%|████▌     | 449/983 [00:22<00:20, 26.62it/s] 46%|████▌     | 452/983 [00:22<00:23, 23.04it/s] 46%|████▋     | 455/983 [00:23<00:26, 20.21it/s] 47%|████▋     | 458/983 [00:23<00:28, 18.64it/s] 47%|████▋     | 460/983 [00:23<00:29, 17.92it/s] 47%|████▋     | 462/983 [00:23<00:30, 17.34it/s] 47%|████▋     | 464/983 [00:23<00:30, 16.93it/s] 47%|████▋     | 466/983 [00:23<00:32, 15.98it/s] 48%|████▊     | 468/983 [00:23<00:31, 16.33it/s] 48%|████▊     | 471/983 [00:23<00:26, 19.34it/s] 48%|████▊     | 474/983 [00:24<00:23, 21.77it/s] 49%|████▊     | 477/983 [00:24<00:21, 23.60it/s] 49%|████▉     | 480/983 [00:24<00:20, 25.01it/s] 49%|████▉     | 483/983 [00:24<00:19, 26.07it/s] 49%|████▉     | 486/983 [00:24<00:18, 26.80it/s] 50%|████▉     | 489/983 [00:24<00:18, 27.34it/s] 50%|█████     | 492/983 [00:24<00:17, 27.70it/s] 50%|█████     | 495/983 [00:24<00:19, 24.91it/s] 51%|█████     | 498/983 [00:25<00:22, 21.25it/s] 51%|█████     | 501/983 [00:25<00:24, 19.28it/s] 51%|█████▏    | 504/983 [00:25<00:26, 18.00it/s] 51%|█████▏    | 506/983 [00:25<00:27, 17.51it/s] 52%|█████▏    | 508/983 [00:25<00:28, 16.87it/s] 52%|█████▏    | 510/983 [00:25<00:29, 16.20it/s] 52%|█████▏    | 512/983 [00:25<00:28, 16.31it/s] 52%|█████▏    | 515/983 [00:26<00:24, 19.32it/s] 53%|█████▎    | 518/983 [00:26<00:21, 21.78it/s] 53%|█████▎    | 521/983 [00:26<00:19, 23.75it/s] 53%|█████▎    | 524/983 [00:26<00:18, 25.23it/s] 54%|█████▎    | 527/983 [00:26<00:17, 26.28it/s] 54%|█████▍    | 530/983 [00:26<00:16, 27.14it/s] 54%|█████▍    | 533/983 [00:26<00:16, 27.81it/s] 55%|█████▍    | 536/983 [00:26<00:15, 28.21it/s] 55%|█████▍    | 539/983 [00:26<00:15, 27.97it/s] 55%|█████▌    | 542/983 [00:26<00:17, 25.21it/s] 55%|█████▌    | 545/983 [00:27<00:22, 19.05it/s] 56%|█████▌    | 548/983 [00:27<00:25, 17.22it/s] 56%|█████▌    | 550/983 [00:27<00:25, 17.17it/s] 56%|█████▌    | 552/983 [00:27<00:29, 14.81it/s] 56%|█████▋    | 554/983 [00:27<00:32, 13.39it/s] 57%|█████▋    | 557/983 [00:28<00:26, 16.24it/s] 57%|█████▋    | 560/983 [00:28<00:22, 19.03it/s] 57%|█████▋    | 563/983 [00:28<00:19, 21.45it/s] 58%|█████▊    | 566/983 [00:28<00:17, 23.45it/s] 58%|█████▊    | 569/983 [00:28<00:16, 24.91it/s] 58%|█████▊    | 572/983 [00:28<00:15, 26.05it/s] 58%|█████▊    | 575/983 [00:28<00:15, 27.03it/s] 59%|█████▉    | 578/983 [00:28<00:14, 27.73it/s] 59%|█████▉    | 581/983 [00:28<00:14, 27.76it/s] 59%|█████▉    | 584/983 [00:29<00:14, 27.55it/s] 60%|█████▉    | 587/983 [00:29<00:16, 23.57it/s] 60%|██████    | 590/983 [00:29<00:18, 20.80it/s] 60%|██████    | 593/983 [00:29<00:20, 19.18it/s] 61%|██████    | 596/983 [00:29<00:21, 17.82it/s] 61%|██████    | 598/983 [00:29<00:21, 17.62it/s] 61%|██████    | 600/983 [00:29<00:22, 16.83it/s] 61%|██████    | 602/983 [00:30<00:22, 16.66it/s] 61%|██████▏   | 604/983 [00:30<00:21, 17.33it/s] 62%|██████▏   | 607/983 [00:30<00:18, 20.23it/s] 62%|██████▏   | 610/983 [00:30<00:16, 22.52it/s] 62%|██████▏   | 613/983 [00:30<00:15, 24.26it/s] 63%|██████▎   | 616/983 [00:30<00:14, 25.65it/s] 63%|██████▎   | 619/983 [00:30<00:13, 26.63it/s] 63%|██████▎   | 622/983 [00:30<00:13, 27.32it/s] 64%|██████▎   | 625/983 [00:30<00:13, 26.80it/s] 64%|██████▍   | 628/983 [00:31<00:13, 26.31it/s] 64%|██████▍   | 631/983 [00:31<00:16, 21.22it/s] 64%|██████▍   | 634/983 [00:31<00:22, 15.67it/s] 65%|██████▍   | 636/983 [00:31<00:23, 14.62it/s] 65%|██████▍   | 638/983 [00:31<00:24, 14.02it/s] 65%|██████▌   | 640/983 [00:32<00:24, 14.25it/s] 65%|██████▌   | 643/983 [00:32<00:20, 16.35it/s] 66%|██████▌   | 646/983 [00:32<00:18, 18.71it/s] 66%|██████▌   | 649/983 [00:32<00:16, 20.72it/s] 66%|██████▋   | 652/983 [00:32<00:14, 22.20it/s] 67%|██████▋   | 655/983 [00:32<00:14, 23.24it/s] 67%|██████▋   | 658/983 [00:32<00:13, 24.67it/s] 67%|██████▋   | 661/983 [00:32<00:12, 25.91it/s] 68%|██████▊   | 664/983 [00:32<00:11, 26.63it/s] 68%|██████▊   | 667/983 [00:33<00:12, 25.20it/s] 68%|██████▊   | 670/983 [00:33<00:14, 21.30it/s] 68%|██████▊   | 673/983 [00:33<00:16, 19.15it/s] 69%|██████▉   | 676/983 [00:33<00:19, 15.60it/s] 69%|██████▉   | 678/983 [00:33<00:20, 15.17it/s] 69%|██████▉   | 680/983 [00:34<00:20, 14.86it/s] 69%|██████▉   | 682/983 [00:34<00:19, 15.33it/s] 70%|██████▉   | 685/983 [00:34<00:16, 18.31it/s] 70%|██████▉   | 688/983 [00:34<00:14, 20.96it/s] 70%|███████   | 691/983 [00:34<00:12, 23.12it/s] 71%|███████   | 694/983 [00:34<00:11, 24.80it/s] 71%|███████   | 697/983 [00:34<00:10, 26.02it/s] 71%|███████   | 700/983 [00:34<00:10, 26.87it/s] 72%|███████▏  | 703/983 [00:34<00:10, 27.51it/s] 72%|███████▏  | 706/983 [00:34<00:09, 28.03it/s] 72%|███████▏  | 709/983 [00:35<00:10, 26.30it/s] 72%|███████▏  | 712/983 [00:35<00:10, 25.90it/s] 73%|███████▎  | 715/983 [00:35<00:12, 21.95it/s] 73%|███████▎  | 718/983 [00:35<00:13, 19.90it/s] 73%|███████▎  | 721/983 [00:35<00:14, 18.61it/s] 74%|███████▎  | 723/983 [00:35<00:14, 17.89it/s] 74%|███████▍  | 726/983 [00:36<00:13, 19.71it/s] 74%|███████▍  | 729/983 [00:36<00:14, 17.56it/s] 74%|███████▍  | 732/983 [00:36<00:12, 19.70it/s] 75%|███████▍  | 735/983 [00:36<00:11, 21.50it/s] 75%|███████▌  | 738/983 [00:36<00:10, 22.91it/s] 75%|███████▌  | 741/983 [00:36<00:10, 22.63it/s] 76%|███████▌  | 744/983 [00:36<00:10, 23.57it/s] 76%|███████▌  | 747/983 [00:36<00:09, 24.95it/s] 76%|███████▋  | 750/983 [00:37<00:08, 26.09it/s] 77%|███████▋  | 753/983 [00:37<00:08, 25.82it/s] 77%|███████▋  | 756/983 [00:37<00:10, 21.71it/s] 77%|███████▋  | 759/983 [00:37<00:11, 19.61it/s] 78%|███████▊  | 762/983 [00:37<00:12, 18.38it/s] 78%|███████▊  | 764/983 [00:37<00:12, 17.80it/s] 78%|███████▊  | 766/983 [00:37<00:12, 17.26it/s] 78%|███████▊  | 768/983 [00:38<00:12, 16.93it/s] 78%|███████▊  | 770/983 [00:38<00:13, 15.94it/s] 79%|███████▊  | 773/983 [00:38<00:11, 18.12it/s] 79%|███████▉  | 776/983 [00:38<00:10, 20.10it/s] 79%|███████▉  | 779/983 [00:38<00:09, 22.09it/s] 80%|███████▉  | 782/983 [00:38<00:08, 24.03it/s] 80%|███████▉  | 786/983 [00:38<00:07, 26.08it/s] 80%|████████  | 790/983 [00:38<00:06, 27.74it/s] 81%|████████  | 794/983 [00:39<00:06, 29.06it/s] 81%|████████  | 797/983 [00:39<00:06, 29.27it/s] 81%|████████▏ | 801/983 [00:39<00:06, 29.62it/s] 82%|████████▏ | 804/983 [00:39<00:06, 29.56it/s] 82%|████████▏ | 807/983 [00:39<00:07, 23.68it/s] 82%|████████▏ | 810/983 [00:39<00:09, 19.04it/s] 83%|████████▎ | 813/983 [00:40<00:09, 18.77it/s] 83%|████████▎ | 816/983 [00:40<00:10, 16.65it/s] 83%|████████▎ | 818/983 [00:40<00:09, 17.02it/s] 84%|████████▎ | 821/983 [00:40<00:08, 19.41it/s] 84%|████████▍ | 825/983 [00:40<00:06, 22.92it/s] 84%|████████▍ | 829/983 [00:40<00:06, 25.58it/s] 85%|████████▍ | 833/983 [00:40<00:05, 27.68it/s] 85%|████████▌ | 837/983 [00:40<00:04, 29.30it/s] 86%|████████▌ | 841/983 [00:41<00:04, 30.33it/s] 86%|████████▌ | 845/983 [00:41<00:04, 31.17it/s] 86%|████████▋ | 849/983 [00:41<00:04, 27.61it/s] 87%|████████▋ | 852/983 [00:41<00:05, 24.69it/s] 87%|████████▋ | 855/983 [00:41<00:05, 22.82it/s] 87%|████████▋ | 858/983 [00:41<00:06, 18.60it/s] 88%|████████▊ | 861/983 [00:42<00:07, 17.04it/s] 88%|████████▊ | 863/983 [00:42<00:07, 16.81it/s] 88%|████████▊ | 865/983 [00:42<00:06, 17.00it/s] 88%|████████▊ | 868/983 [00:42<00:05, 19.71it/s] 89%|████████▊ | 872/983 [00:42<00:04, 23.27it/s] 89%|████████▉ | 876/983 [00:42<00:04, 25.93it/s] 90%|████████▉ | 880/983 [00:42<00:03, 27.88it/s] 90%|████████▉ | 884/983 [00:42<00:03, 29.40it/s] 90%|█████████ | 888/983 [00:43<00:03, 30.43it/s] 91%|█████████ | 892/983 [00:43<00:02, 31.28it/s] 91%|█████████ | 896/983 [00:43<00:02, 29.54it/s] 92%|█████████▏| 900/983 [00:43<00:02, 29.25it/s] 92%|█████████▏| 903/983 [00:43<00:03, 25.64it/s] 92%|█████████▏| 906/983 [00:43<00:03, 23.23it/s] 92%|█████████▏| 909/983 [00:43<00:03, 21.96it/s] 93%|█████████▎| 912/983 [00:44<00:03, 21.34it/s] 93%|█████████▎| 915/983 [00:44<00:03, 21.58it/s] 93%|█████████▎| 918/983 [00:44<00:03, 20.21it/s] 94%|█████████▎| 921/983 [00:44<00:02, 22.26it/s] 94%|█████████▍| 925/983 [00:44<00:02, 24.94it/s] 95%|█████████▍| 929/983 [00:44<00:02, 26.91it/s] 95%|█████████▍| 933/983 [00:44<00:01, 28.45it/s] 95%|█████████▌| 937/983 [00:45<00:01, 29.65it/s] 96%|█████████▌| 941/983 [00:45<00:01, 30.57it/s] 96%|█████████▌| 945/983 [00:45<00:01, 31.10it/s] 97%|█████████▋| 949/983 [00:45<00:01, 29.54it/s] 97%|█████████▋| 952/983 [00:45<00:01, 25.96it/s] 97%|█████████▋| 955/983 [00:45<00:01, 23.67it/s] 97%|█████████▋| 958/983 [00:45<00:01, 22.17it/s] 98%|█████████▊| 961/983 [00:46<00:01, 21.13it/s] 98%|█████████▊| 964/983 [00:46<00:00, 20.39it/s] 98%|█████████▊| 967/983 [00:46<00:00, 19.46it/s] 99%|█████████▊| 969/983 [00:46<00:00, 18.90it/s] 99%|█████████▉| 972/983 [00:46<00:00, 21.31it/s] 99%|█████████▉| 976/983 [00:46<00:00, 23.97it/s]100%|█████████▉| 980/983 [00:46<00:00, 26.02it/s]100%|██████████| 983/983 [00:46<00:00, 20.92it/s]
time :  1340
prob :  1340
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_2_Focal_RS_DRW_seed_43
train data : 14418, disrupt : 227, non-disrupt : 14191
valid data : 3514, disrupt : 57, non-disrupt : 3457
test data : 4058, disrupt : 71, non-disrupt : 3987

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.064, valid loss : 0.056, train f1 : 0.884, valid f1 : 0.691
Best score increase :0.000 -> 0.691
training process - Deferred Re-weighting:   1%|          | 1/128 [03:50<8:07:08, 230.14s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 2/128 [06:58<7:12:12, 205.81s/it]Best score increase :0.691 -> 0.757
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:05<6:50:15, 196.93s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:11<6:38:15, 192.71s/it]epoch : 5, train loss : 0.025, valid loss : 0.065, train f1 : 0.947, valid f1 : 0.602
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:00<7:01:31, 205.62s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:06<6:44:41, 199.03s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [23:13<6:33:33, 195.15s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [26:20<6:24:54, 192.46s/it]epoch : 9, train loss : 0.024, valid loss : 0.044, train f1 : 0.952, valid f1 : 0.587
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [30:12<6:46:17, 204.85s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [33:20<6:32:58, 199.81s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [36:26<6:20:57, 195.36s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [39:35<6:14:20, 193.62s/it]epoch : 13, train loss : 0.021, valid loss : 0.021, train f1 : 0.958, valid f1 : 0.846
Best score increase :0.757 -> 0.846
training process - Deferred Re-weighting:  10%|█         | 13/128 [43:42<6:41:54, 209.69s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [47:33<6:51:00, 216.32s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [50:39<6:30:07, 207.15s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [53:48<6:16:26, 201.67s/it]epoch : 17, train loss : 0.019, valid loss : 0.016, train f1 : 0.965, valid f1 : 0.720
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [57:39<6:29:18, 210.44s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:00:49<6:14:21, 204.19s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:03:58<6:02:35, 199.59s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:07:04<5:51:52, 195.49s/it]epoch : 21, train loss : 0.019, valid loss : 0.021, train f1 : 0.966, valid f1 : 0.710
EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:10:54<6:07:16, 205.95s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:14:02<5:54:25, 200.62s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:17:07<5:42:54, 195.94s/it]Best score increase :0.846 -> 0.926
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:20:16<5:36:08, 193.93s/it]epoch : 25, train loss : 0.017, valid loss : 0.015, train f1 : 0.971, valid f1 : 0.790
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:24:14<5:55:19, 206.99s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:27:25<5:44:01, 202.37s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:30:35<5:34:05, 198.47s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:33:47<5:27:41, 196.62s/it]epoch : 29, train loss : 0.017, valid loss : 0.015, train f1 : 0.971, valid f1 : 0.748
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:37:42<5:43:23, 208.11s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [1:40:52<5:30:46, 202.52s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:44:04<5:22:18, 199.37s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [1:47:15<5:15:10, 196.99s/it]epoch : 33, train loss : 0.015, valid loss : 0.013, train f1 : 0.973, valid f1 : 0.884
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [1:51:09<5:29:18, 207.99s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [1:54:20<5:17:56, 202.94s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [1:57:31<5:09:00, 199.36s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 35, best f1 score : 0.926
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [2:00:39<5:20:37, 206.86s/it]
training process finished, best loss : 0.009, best acc : 0.995, best f1 : 0.926, best epoch : 23

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.62      0.89      0.73        71
           1       1.00      0.99      0.99      3987

    accuracy                           0.99      4058
   macro avg       0.81      0.94      0.86      4058
weighted avg       0.99      0.99      0.99      4058


# test acc : 0.99, test f1 : 0.86, test AUC : 0.94, test loss : 0.816

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/982 [00:00<?, ?it/s]  0%|          | 2/982 [00:00<01:14, 13.08it/s]  0%|          | 4/982 [00:00<01:31, 10.71it/s]  1%|          | 6/982 [00:00<01:25, 11.39it/s]  1%|          | 8/982 [00:00<01:15, 12.86it/s]  1%|          | 10/982 [00:00<01:28, 10.98it/s]  1%|          | 12/982 [00:01<01:41,  9.53it/s]  1%|▏         | 14/982 [00:01<01:31, 10.60it/s]  2%|▏         | 17/982 [00:01<01:10, 13.63it/s]  2%|▏         | 20/982 [00:01<00:57, 16.59it/s]  2%|▏         | 23/982 [00:01<00:50, 19.02it/s]  3%|▎         | 26/982 [00:01<00:46, 20.55it/s]  3%|▎         | 29/982 [00:01<00:45, 21.06it/s]  3%|▎         | 32/982 [00:02<00:42, 22.36it/s]  4%|▎         | 35/982 [00:02<00:41, 22.67it/s]  4%|▍         | 38/982 [00:02<00:48, 19.36it/s]  4%|▍         | 41/982 [00:02<01:04, 14.48it/s]  4%|▍         | 43/982 [00:02<01:11, 13.06it/s]  5%|▍         | 45/982 [00:03<01:09, 13.41it/s]  5%|▍         | 47/982 [00:03<01:16, 12.26it/s]  5%|▍         | 49/982 [00:03<01:08, 13.55it/s]  5%|▌         | 52/982 [00:03<00:56, 16.51it/s]  6%|▌         | 55/982 [00:03<00:48, 18.98it/s]  6%|▌         | 58/982 [00:03<00:44, 20.98it/s]  6%|▌         | 61/982 [00:03<00:40, 22.47it/s]  7%|▋         | 64/982 [00:03<00:38, 23.68it/s]  7%|▋         | 67/982 [00:04<00:37, 24.52it/s]  7%|▋         | 70/982 [00:04<00:37, 24.34it/s]  7%|▋         | 73/982 [00:04<00:41, 21.95it/s]  8%|▊         | 76/982 [00:04<00:57, 15.63it/s]  8%|▊         | 78/982 [00:04<01:08, 13.24it/s]  8%|▊         | 80/982 [00:05<01:12, 12.48it/s]  8%|▊         | 82/982 [00:05<01:11, 12.67it/s]  9%|▊         | 84/982 [00:05<01:11, 12.61it/s]  9%|▉         | 87/982 [00:05<00:58, 15.25it/s]  9%|▉         | 90/982 [00:05<00:49, 17.91it/s]  9%|▉         | 93/982 [00:05<00:44, 20.16it/s] 10%|▉         | 96/982 [00:05<00:40, 21.93it/s] 10%|█         | 99/982 [00:05<00:37, 23.24it/s] 10%|█         | 102/982 [00:06<00:36, 24.40it/s] 11%|█         | 105/982 [00:06<00:34, 25.21it/s] 11%|█         | 108/982 [00:06<00:33, 25.83it/s] 11%|█▏        | 111/982 [00:06<00:38, 22.37it/s] 12%|█▏        | 114/982 [00:06<00:49, 17.48it/s] 12%|█▏        | 116/982 [00:06<00:52, 16.64it/s] 12%|█▏        | 119/982 [00:07<00:53, 16.03it/s] 12%|█▏        | 121/982 [00:07<00:58, 14.69it/s] 13%|█▎        | 123/982 [00:07<00:59, 14.45it/s] 13%|█▎        | 125/982 [00:07<00:57, 14.95it/s] 13%|█▎        | 128/982 [00:07<00:48, 17.63it/s] 13%|█▎        | 131/982 [00:07<00:42, 19.80it/s] 14%|█▎        | 134/982 [00:07<00:39, 21.50it/s] 14%|█▍        | 137/982 [00:07<00:37, 22.65it/s] 14%|█▍        | 140/982 [00:08<00:35, 23.54it/s] 15%|█▍        | 143/982 [00:08<00:34, 24.08it/s] 15%|█▍        | 146/982 [00:08<00:34, 24.50it/s] 15%|█▌        | 149/982 [00:08<00:34, 23.98it/s] 15%|█▌        | 152/982 [00:08<00:39, 21.02it/s] 16%|█▌        | 155/982 [00:08<00:44, 18.71it/s] 16%|█▌        | 157/982 [00:08<00:48, 16.96it/s] 16%|█▌        | 159/982 [00:09<00:58, 14.18it/s] 16%|█▋        | 161/982 [00:09<01:12, 11.30it/s] 17%|█▋        | 163/982 [00:09<01:04, 12.65it/s] 17%|█▋        | 166/982 [00:09<00:54, 15.00it/s] 17%|█▋        | 169/982 [00:09<00:46, 17.67it/s] 18%|█▊        | 172/982 [00:09<00:40, 19.97it/s] 18%|█▊        | 175/982 [00:10<00:36, 21.89it/s] 18%|█▊        | 178/982 [00:10<00:34, 23.36it/s] 18%|█▊        | 181/982 [00:10<00:32, 24.36it/s] 19%|█▊        | 184/982 [00:10<00:31, 24.95it/s] 19%|█▉        | 187/982 [00:10<00:33, 24.00it/s] 19%|█▉        | 190/982 [00:10<00:45, 17.36it/s] 20%|█▉        | 193/982 [00:11<00:56, 13.95it/s] 20%|█▉        | 195/982 [00:11<01:02, 12.52it/s] 20%|██        | 197/982 [00:11<01:07, 11.58it/s] 20%|██        | 199/982 [00:11<01:02, 12.50it/s] 20%|██        | 201/982 [00:11<00:58, 13.29it/s] 21%|██        | 204/982 [00:11<00:48, 16.11it/s] 21%|██        | 207/982 [00:11<00:41, 18.54it/s] 21%|██▏       | 210/982 [00:12<00:37, 20.50it/s] 22%|██▏       | 213/982 [00:12<00:35, 21.92it/s] 22%|██▏       | 216/982 [00:12<00:33, 23.13it/s] 22%|██▏       | 219/982 [00:12<00:31, 24.03it/s] 23%|██▎       | 222/982 [00:12<00:37, 20.18it/s] 23%|██▎       | 225/982 [00:12<00:49, 15.33it/s] 23%|██▎       | 227/982 [00:13<00:49, 15.25it/s] 23%|██▎       | 229/982 [00:13<00:49, 15.19it/s] 24%|██▎       | 231/982 [00:13<00:52, 14.17it/s] 24%|██▎       | 233/982 [00:13<00:53, 13.92it/s] 24%|██▍       | 235/982 [00:13<00:53, 13.99it/s] 24%|██▍       | 237/982 [00:13<00:49, 14.98it/s] 24%|██▍       | 240/982 [00:13<00:41, 17.87it/s] 25%|██▍       | 243/982 [00:14<00:36, 20.07it/s] 25%|██▌       | 246/982 [00:14<00:34, 21.64it/s] 25%|██▌       | 249/982 [00:14<00:31, 22.91it/s] 26%|██▌       | 252/982 [00:14<00:30, 23.86it/s] 26%|██▌       | 255/982 [00:14<00:29, 24.61it/s] 26%|██▋       | 258/982 [00:14<00:37, 19.06it/s] 27%|██▋       | 261/982 [00:15<00:54, 13.12it/s] 27%|██▋       | 263/982 [00:15<01:00, 11.83it/s] 27%|██▋       | 265/982 [00:15<00:57, 12.47it/s] 27%|██▋       | 267/982 [00:15<00:56, 12.72it/s] 27%|██▋       | 269/982 [00:15<00:53, 13.26it/s] 28%|██▊       | 272/982 [00:15<00:45, 15.63it/s] 28%|██▊       | 275/982 [00:16<00:41, 17.11it/s] 28%|██▊       | 277/982 [00:16<00:39, 17.64it/s] 29%|██▊       | 280/982 [00:16<00:36, 19.50it/s] 29%|██▉       | 283/982 [00:16<00:32, 21.27it/s] 29%|██▉       | 286/982 [00:16<00:30, 22.65it/s] 29%|██▉       | 289/982 [00:16<00:30, 22.63it/s] 30%|██▉       | 292/982 [00:16<00:36, 18.81it/s] 30%|███       | 295/982 [00:17<00:53, 12.90it/s] 30%|███       | 297/982 [00:17<00:58, 11.75it/s] 30%|███       | 299/982 [00:17<00:59, 11.55it/s] 31%|███       | 301/982 [00:17<00:54, 12.61it/s] 31%|███       | 303/982 [00:17<00:50, 13.33it/s] 31%|███       | 306/982 [00:18<00:43, 15.53it/s] 31%|███▏      | 309/982 [00:18<00:37, 18.06it/s] 32%|███▏      | 311/982 [00:18<00:38, 17.52it/s] 32%|███▏      | 313/982 [00:18<00:39, 17.09it/s] 32%|███▏      | 316/982 [00:18<00:35, 18.75it/s] 32%|███▏      | 319/982 [00:18<00:33, 20.02it/s] 33%|███▎      | 322/982 [00:18<00:34, 19.41it/s] 33%|███▎      | 324/982 [00:19<00:42, 15.59it/s] 33%|███▎      | 326/982 [00:19<00:48, 13.59it/s] 33%|███▎      | 328/982 [00:19<00:47, 13.66it/s] 34%|███▎      | 330/982 [00:19<00:46, 14.09it/s] 34%|███▍      | 332/982 [00:19<00:51, 12.66it/s] 34%|███▍      | 334/982 [00:19<00:49, 12.99it/s] 34%|███▍      | 336/982 [00:19<00:45, 14.30it/s] 35%|███▍      | 339/982 [00:20<00:37, 17.26it/s] 35%|███▍      | 342/982 [00:20<00:32, 19.58it/s] 35%|███▌      | 345/982 [00:20<00:29, 21.33it/s] 35%|███▌      | 348/982 [00:20<00:29, 21.41it/s] 36%|███▌      | 351/982 [00:20<00:30, 20.69it/s] 36%|███▌      | 354/982 [00:20<00:30, 20.36it/s] 36%|███▋      | 357/982 [00:20<00:36, 17.07it/s] 37%|███▋      | 359/982 [00:21<00:42, 14.80it/s] 37%|███▋      | 361/982 [00:21<00:46, 13.46it/s] 37%|███▋      | 363/982 [00:21<00:46, 13.36it/s] 37%|███▋      | 365/982 [00:21<00:44, 13.71it/s] 37%|███▋      | 367/982 [00:21<00:41, 14.77it/s] 38%|███▊      | 369/982 [00:21<00:42, 14.37it/s] 38%|███▊      | 372/982 [00:22<00:36, 16.69it/s] 38%|███▊      | 375/982 [00:22<00:31, 19.03it/s] 38%|███▊      | 378/982 [00:22<00:28, 20.96it/s] 39%|███▉      | 381/982 [00:22<00:26, 22.45it/s] 39%|███▉      | 384/982 [00:22<00:25, 23.56it/s] 39%|███▉      | 387/982 [00:22<00:24, 24.26it/s] 40%|███▉      | 390/982 [00:22<00:24, 23.87it/s] 40%|████      | 393/982 [00:23<00:32, 18.04it/s] 40%|████      | 396/982 [00:23<00:34, 16.79it/s] 41%|████      | 398/982 [00:23<00:35, 16.32it/s] 41%|████      | 400/982 [00:23<00:36, 15.89it/s] 41%|████      | 402/982 [00:23<00:36, 15.74it/s] 41%|████      | 404/982 [00:23<00:38, 15.17it/s] 41%|████▏     | 406/982 [00:23<00:37, 15.24it/s] 42%|████▏     | 408/982 [00:24<00:37, 15.34it/s] 42%|████▏     | 411/982 [00:24<00:31, 18.34it/s] 42%|████▏     | 414/982 [00:24<00:27, 20.68it/s] 42%|████▏     | 417/982 [00:24<00:25, 22.50it/s] 43%|████▎     | 420/982 [00:24<00:23, 23.71it/s] 43%|████▎     | 423/982 [00:24<00:22, 24.76it/s] 43%|████▎     | 426/982 [00:24<00:21, 25.46it/s] 44%|████▎     | 429/982 [00:24<00:22, 24.43it/s] 44%|████▍     | 432/982 [00:25<00:27, 19.99it/s] 44%|████▍     | 435/982 [00:25<00:35, 15.35it/s] 45%|████▍     | 437/982 [00:25<00:38, 14.08it/s] 45%|████▍     | 439/982 [00:25<00:38, 13.97it/s] 45%|████▍     | 441/982 [00:25<00:39, 13.83it/s] 45%|████▌     | 443/982 [00:25<00:38, 14.02it/s] 45%|████▌     | 445/982 [00:26<00:37, 14.45it/s] 46%|████▌     | 448/982 [00:26<00:32, 16.49it/s] 46%|████▌     | 451/982 [00:26<00:28, 18.77it/s] 46%|████▌     | 454/982 [00:26<00:25, 20.96it/s] 47%|████▋     | 457/982 [00:26<00:23, 22.56it/s] 47%|████▋     | 460/982 [00:26<00:22, 23.62it/s] 47%|████▋     | 463/982 [00:26<00:21, 24.45it/s] 47%|████▋     | 466/982 [00:26<00:25, 20.46it/s] 48%|████▊     | 469/982 [00:27<00:33, 15.31it/s] 48%|████▊     | 471/982 [00:27<00:35, 14.33it/s] 48%|████▊     | 473/982 [00:27<00:36, 14.06it/s] 48%|████▊     | 475/982 [00:27<00:35, 14.29it/s] 49%|████▊     | 477/982 [00:27<00:38, 12.98it/s] 49%|████▉     | 480/982 [00:28<00:33, 14.83it/s] 49%|████▉     | 483/982 [00:28<00:29, 17.12it/s] 49%|████▉     | 486/982 [00:28<00:25, 19.29it/s] 50%|████▉     | 489/982 [00:28<00:23, 21.24it/s] 50%|█████     | 492/982 [00:28<00:21, 22.82it/s] 50%|█████     | 495/982 [00:28<00:20, 23.79it/s] 51%|█████     | 498/982 [00:28<00:19, 24.58it/s] 51%|█████     | 501/982 [00:28<00:19, 24.29it/s] 51%|█████▏    | 504/982 [00:29<00:21, 22.08it/s] 52%|█████▏    | 507/982 [00:29<00:28, 16.42it/s] 52%|█████▏    | 509/982 [00:29<00:32, 14.65it/s] 52%|█████▏    | 511/982 [00:29<00:33, 14.12it/s] 52%|█████▏    | 513/982 [00:29<00:33, 13.90it/s] 52%|█████▏    | 515/982 [00:30<00:36, 12.80it/s] 53%|█████▎    | 518/982 [00:30<00:29, 15.98it/s] 53%|█████▎    | 521/982 [00:30<00:24, 18.71it/s] 53%|█████▎    | 524/982 [00:30<00:21, 20.83it/s] 54%|█████▎    | 527/982 [00:30<00:20, 22.46it/s] 54%|█████▍    | 530/982 [00:30<00:18, 24.03it/s] 54%|█████▍    | 533/982 [00:30<00:17, 25.07it/s] 55%|█████▍    | 536/982 [00:30<00:17, 25.85it/s] 55%|█████▍    | 539/982 [00:30<00:16, 26.51it/s] 55%|█████▌    | 542/982 [00:31<00:18, 24.10it/s] 55%|█████▌    | 545/982 [00:31<00:20, 20.87it/s] 56%|█████▌    | 548/982 [00:31<00:22, 19.09it/s] 56%|█████▌    | 551/982 [00:31<00:23, 18.01it/s] 56%|█████▋    | 553/982 [00:31<00:24, 17.44it/s] 57%|█████▋    | 555/982 [00:31<00:27, 15.76it/s] 57%|█████▋    | 557/982 [00:32<00:30, 13.92it/s] 57%|█████▋    | 560/982 [00:32<00:25, 16.48it/s] 57%|█████▋    | 563/982 [00:32<00:21, 19.19it/s] 58%|█████▊    | 566/982 [00:32<00:19, 21.42it/s] 58%|█████▊    | 569/982 [00:32<00:17, 23.31it/s] 58%|█████▊    | 572/982 [00:32<00:16, 24.63it/s] 59%|█████▊    | 575/982 [00:32<00:15, 25.59it/s] 59%|█████▉    | 578/982 [00:32<00:15, 26.35it/s] 59%|█████▉    | 581/982 [00:32<00:14, 26.95it/s] 59%|█████▉    | 584/982 [00:33<00:15, 24.94it/s] 60%|█████▉    | 587/982 [00:33<00:21, 18.75it/s] 60%|██████    | 590/982 [00:33<00:27, 14.35it/s] 60%|██████    | 592/982 [00:33<00:30, 12.70it/s] 60%|██████    | 594/982 [00:34<00:32, 11.88it/s] 61%|██████    | 597/982 [00:34<00:26, 14.62it/s] 61%|██████    | 600/982 [00:34<00:22, 17.06it/s] 61%|██████▏   | 603/982 [00:34<00:19, 19.21it/s] 62%|██████▏   | 606/982 [00:34<00:17, 21.07it/s] 62%|██████▏   | 609/982 [00:34<00:16, 22.52it/s] 62%|██████▏   | 612/982 [00:34<00:15, 23.68it/s] 63%|██████▎   | 615/982 [00:34<00:14, 24.50it/s] 63%|██████▎   | 618/982 [00:35<00:14, 25.10it/s] 63%|██████▎   | 621/982 [00:35<00:15, 23.84it/s] 64%|██████▎   | 624/982 [00:35<00:16, 21.33it/s] 64%|██████▍   | 627/982 [00:35<00:19, 17.99it/s] 64%|██████▍   | 629/982 [00:35<00:25, 13.69it/s] 64%|██████▍   | 631/982 [00:36<00:26, 13.05it/s] 64%|██████▍   | 633/982 [00:36<00:29, 12.02it/s] 65%|██████▍   | 636/982 [00:36<00:24, 14.34it/s] 65%|██████▌   | 639/982 [00:36<00:20, 17.02it/s] 65%|██████▌   | 642/982 [00:36<00:17, 19.40it/s] 66%|██████▌   | 645/982 [00:36<00:15, 21.44it/s] 66%|██████▌   | 648/982 [00:36<00:14, 23.05it/s] 66%|██████▋   | 651/982 [00:36<00:13, 24.39it/s] 67%|██████▋   | 654/982 [00:36<00:12, 25.40it/s] 67%|██████▋   | 657/982 [00:37<00:12, 26.12it/s] 67%|██████▋   | 660/982 [00:37<00:14, 22.73it/s] 68%|██████▊   | 663/982 [00:37<00:17, 18.44it/s] 68%|██████▊   | 666/982 [00:37<00:21, 14.93it/s] 68%|██████▊   | 668/982 [00:37<00:21, 14.58it/s] 68%|██████▊   | 670/982 [00:38<00:21, 14.84it/s] 68%|██████▊   | 672/982 [00:38<00:21, 14.63it/s] 69%|██████▊   | 674/982 [00:38<00:20, 15.00it/s] 69%|██████▉   | 676/982 [00:38<00:19, 15.83it/s] 69%|██████▉   | 679/982 [00:38<00:16, 18.52it/s] 69%|██████▉   | 682/982 [00:38<00:14, 20.90it/s] 70%|██████▉   | 685/982 [00:38<00:13, 22.68it/s] 70%|███████   | 688/982 [00:38<00:12, 24.16it/s] 70%|███████   | 691/982 [00:38<00:11, 25.20it/s] 71%|███████   | 694/982 [00:39<00:11, 26.01it/s] 71%|███████   | 697/982 [00:39<00:11, 25.64it/s] 71%|███████▏  | 700/982 [00:39<00:12, 22.76it/s] 72%|███████▏  | 703/982 [00:39<00:13, 20.39it/s] 72%|███████▏  | 706/982 [00:39<00:14, 19.02it/s] 72%|███████▏  | 708/982 [00:39<00:15, 17.34it/s] 72%|███████▏  | 710/982 [00:40<00:17, 15.74it/s] 73%|███████▎  | 712/982 [00:40<00:17, 15.40it/s] 73%|███████▎  | 714/982 [00:40<00:18, 14.42it/s] 73%|███████▎  | 717/982 [00:40<00:16, 16.56it/s] 73%|███████▎  | 720/982 [00:40<00:14, 18.62it/s] 74%|███████▎  | 723/982 [00:40<00:13, 19.31it/s] 74%|███████▍  | 725/982 [00:40<00:13, 19.26it/s] 74%|███████▍  | 728/982 [00:40<00:12, 20.82it/s] 74%|███████▍  | 731/982 [00:41<00:11, 22.69it/s] 75%|███████▍  | 734/982 [00:41<00:10, 24.23it/s] 75%|███████▌  | 737/982 [00:41<00:10, 24.12it/s] 75%|███████▌  | 740/982 [00:41<00:09, 24.26it/s] 76%|███████▌  | 743/982 [00:41<00:11, 21.13it/s] 76%|███████▌  | 746/982 [00:41<00:12, 19.17it/s] 76%|███████▋  | 749/982 [00:42<00:12, 18.20it/s] 76%|███████▋  | 751/982 [00:42<00:13, 17.73it/s] 77%|███████▋  | 753/982 [00:42<00:13, 17.35it/s] 77%|███████▋  | 755/982 [00:42<00:14, 15.76it/s] 77%|███████▋  | 758/982 [00:42<00:12, 17.95it/s] 77%|███████▋  | 761/982 [00:42<00:10, 20.33it/s] 78%|███████▊  | 764/982 [00:42<00:09, 22.23it/s] 78%|███████▊  | 767/982 [00:42<00:09, 23.73it/s] 78%|███████▊  | 770/982 [00:42<00:08, 24.73it/s] 79%|███████▊  | 773/982 [00:43<00:08, 25.60it/s] 79%|███████▉  | 776/982 [00:43<00:08, 24.60it/s] 79%|███████▉  | 779/982 [00:43<00:08, 25.13it/s] 80%|███████▉  | 782/982 [00:43<00:08, 22.26it/s] 80%|███████▉  | 785/982 [00:43<00:11, 16.72it/s] 80%|████████  | 787/982 [00:44<00:13, 14.09it/s] 80%|████████  | 789/982 [00:44<00:13, 14.12it/s] 81%|████████  | 791/982 [00:44<00:12, 14.79it/s] 81%|████████  | 793/982 [00:44<00:12, 14.72it/s] 81%|████████  | 795/982 [00:44<00:12, 15.46it/s] 81%|████████▏ | 798/982 [00:44<00:09, 18.68it/s] 82%|████████▏ | 801/982 [00:44<00:08, 21.32it/s] 82%|████████▏ | 804/982 [00:44<00:07, 23.18it/s] 82%|████████▏ | 807/982 [00:44<00:07, 22.44it/s] 82%|████████▏ | 810/982 [00:45<00:07, 22.98it/s] 83%|████████▎ | 813/982 [00:45<00:06, 24.26it/s] 83%|████████▎ | 816/982 [00:45<00:06, 25.56it/s] 83%|████████▎ | 819/982 [00:45<00:06, 25.45it/s] 84%|████████▎ | 822/982 [00:45<00:06, 23.61it/s] 84%|████████▍ | 825/982 [00:45<00:09, 16.78it/s] 84%|████████▍ | 827/982 [00:46<00:11, 14.06it/s] 84%|████████▍ | 829/982 [00:46<00:10, 14.02it/s] 85%|████████▍ | 831/982 [00:46<00:10, 14.76it/s] 85%|████████▍ | 833/982 [00:46<00:10, 14.78it/s] 85%|████████▌ | 835/982 [00:46<00:09, 15.42it/s] 85%|████████▌ | 838/982 [00:46<00:07, 18.77it/s] 86%|████████▌ | 841/982 [00:46<00:06, 21.55it/s] 86%|████████▌ | 845/982 [00:46<00:05, 24.29it/s] 86%|████████▋ | 848/982 [00:47<00:05, 25.68it/s] 87%|████████▋ | 852/982 [00:47<00:04, 27.15it/s] 87%|████████▋ | 855/982 [00:47<00:04, 27.69it/s] 87%|████████▋ | 859/982 [00:47<00:04, 28.54it/s] 88%|████████▊ | 862/982 [00:47<00:04, 28.15it/s] 88%|████████▊ | 865/982 [00:47<00:04, 28.61it/s] 88%|████████▊ | 868/982 [00:47<00:04, 24.92it/s] 89%|████████▊ | 871/982 [00:47<00:04, 22.52it/s] 89%|████████▉ | 874/982 [00:48<00:05, 21.15it/s] 89%|████████▉ | 877/982 [00:48<00:05, 20.31it/s] 90%|████████▉ | 880/982 [00:48<00:05, 19.04it/s] 90%|████████▉ | 882/982 [00:48<00:05, 18.24it/s] 90%|█████████ | 885/982 [00:48<00:04, 20.35it/s] 91%|█████████ | 889/982 [00:48<00:03, 23.45it/s] 91%|█████████ | 893/982 [00:48<00:03, 25.49it/s] 91%|█████████▏| 897/982 [00:49<00:03, 27.12it/s] 92%|█████████▏| 901/982 [00:49<00:02, 28.43it/s] 92%|█████████▏| 904/982 [00:49<00:03, 24.50it/s] 92%|█████████▏| 907/982 [00:49<00:03, 23.16it/s] 93%|█████████▎| 910/982 [00:49<00:03, 23.63it/s] 93%|█████████▎| 913/982 [00:49<00:02, 24.76it/s] 93%|█████████▎| 916/982 [00:49<00:02, 25.74it/s] 94%|█████████▎| 919/982 [00:49<00:02, 26.60it/s] 94%|█████████▍| 922/982 [00:50<00:02, 27.24it/s] 94%|█████████▍| 925/982 [00:50<00:02, 27.76it/s] 95%|█████████▍| 928/982 [00:50<00:02, 24.82it/s] 95%|█████████▍| 931/982 [00:50<00:02, 25.18it/s] 95%|█████████▌| 934/982 [00:50<00:01, 25.17it/s] 95%|█████████▌| 937/982 [00:50<00:01, 23.23it/s] 96%|█████████▌| 940/982 [00:50<00:02, 20.11it/s] 96%|█████████▌| 943/982 [00:51<00:02, 14.15it/s] 96%|█████████▌| 945/982 [00:51<00:02, 13.82it/s] 96%|█████████▋| 947/982 [00:51<00:02, 13.51it/s] 97%|█████████▋| 949/982 [00:51<00:02, 14.53it/s] 97%|█████████▋| 951/982 [00:51<00:02, 15.49it/s] 97%|█████████▋| 953/982 [00:51<00:01, 16.30it/s] 97%|█████████▋| 956/982 [00:51<00:01, 19.63it/s] 98%|█████████▊| 960/982 [00:52<00:00, 23.24it/s] 98%|█████████▊| 964/982 [00:52<00:00, 25.74it/s] 99%|█████████▊| 968/982 [00:52<00:00, 27.58it/s] 99%|█████████▉| 972/982 [00:52<00:00, 28.66it/s] 99%|█████████▉| 975/982 [00:52<00:00, 28.33it/s]100%|█████████▉| 979/982 [00:52<00:00, 28.46it/s]100%|██████████| 982/982 [00:52<00:00, 25.15it/s]100%|██████████| 982/982 [00:52<00:00, 18.56it/s]
time :  1339
prob :  1339
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_3_Focal_RS_DRW_seed_43
train data : 14410, disrupt : 227, non-disrupt : 14183
valid data : 3512, disrupt : 57, non-disrupt : 3455
test data : 4053, disrupt : 71, non-disrupt : 3982

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.081, valid loss : 0.017, train f1 : 0.855, valid f1 : 0.809
Best score increase :0.000 -> 0.809
training process - Deferred Re-weighting:   1%|          | 1/128 [04:02<8:32:21, 242.06s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:15<7:27:51, 213.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:26<7:03:37, 203.34s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:36<6:49:28, 198.14s/it]epoch : 5, train loss : 0.032, valid loss : 0.041, train f1 : 0.942, valid f1 : 0.617
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:35<7:15:58, 212.67s/it]Best score increase :0.809 -> 0.840
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:50<7:00:22, 206.74s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [24:02<6:46:58, 201.81s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [27:13<6:37:04, 198.54s/it]epoch : 9, train loss : 0.028, valid loss : 0.042, train f1 : 0.946, valid f1 : 0.591
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [31:12<6:58:35, 211.06s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [34:21<6:41:53, 204.35s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [37:34<6:31:23, 200.71s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   9%|▉         | 12/128 [40:45<6:22:32, 197.86s/it]epoch : 13, train loss : 0.025, valid loss : 0.030, train f1 : 0.953, valid f1 : 0.635
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [44:40<6:40:37, 209.02s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [47:55<6:29:04, 204.77s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [51:10<6:20:24, 201.99s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [54:24<6:12:31, 199.57s/it]epoch : 17, train loss : 0.023, valid loss : 0.018, train f1 : 0.959, valid f1 : 0.879
Best score increase :0.840 -> 0.879
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [58:21<6:29:54, 210.76s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:01:37<6:18:05, 206.23s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:04:48<6:06:35, 201.79s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:08:14<6:05:24, 203.00s/it]epoch : 21, train loss : 0.021, valid loss : 0.024, train f1 : 0.957, valid f1 : 0.709
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:12:33<6:32:20, 220.01s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:16:05<6:23:56, 217.32s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:19:19<6:08:04, 210.33s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:22:30<5:54:33, 204.55s/it]epoch : 25, train loss : 0.020, valid loss : 0.030, train f1 : 0.962, valid f1 : 0.643
EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:26:23<6:06:12, 213.32s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:29:35<5:51:24, 206.71s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:32:47<5:40:39, 202.37s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:35:55<5:30:15, 198.15s/it]epoch : 29, train loss : 0.020, valid loss : 0.021, train f1 : 0.965, valid f1 : 0.669
EarlyStopping counter : 12 out of 12
Early stopping | epoch : 28, best f1 score : 0.879
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:39:47<5:56:24, 213.85s/it]
training process finished, best loss : 0.018, best acc : 0.992, best f1 : 0.879, best epoch : 16

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.84      0.86      0.85        71
           1       1.00      1.00      1.00      3982

    accuracy                           0.99      4053
   macro avg       0.92      0.93      0.92      4053
weighted avg       0.99      0.99      0.99      4053


# test acc : 0.99, test f1 : 0.92, test AUC : 0.93, test loss : 0.531

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:51, 18.91it/s]  0%|          | 4/981 [00:00<00:54, 17.98it/s]  1%|          | 6/981 [00:00<00:58, 16.67it/s]  1%|          | 8/981 [00:00<01:00, 16.15it/s]  1%|          | 10/981 [00:00<01:01, 15.88it/s]  1%|          | 12/981 [00:00<01:01, 15.72it/s]  1%|▏         | 14/981 [00:00<01:01, 15.60it/s]  2%|▏         | 16/981 [00:01<01:02, 15.52it/s]  2%|▏         | 18/981 [00:01<01:03, 15.05it/s]  2%|▏         | 21/981 [00:01<00:55, 17.41it/s]  2%|▏         | 24/981 [00:01<00:48, 19.88it/s]  3%|▎         | 27/981 [00:01<00:43, 21.74it/s]  3%|▎         | 30/981 [00:01<00:41, 23.08it/s]  3%|▎         | 33/981 [00:01<00:39, 24.09it/s]  4%|▎         | 36/981 [00:01<00:38, 24.85it/s]  4%|▍         | 39/981 [00:01<00:37, 25.42it/s]  4%|▍         | 42/981 [00:02<00:37, 25.33it/s]  5%|▍         | 45/981 [00:02<00:42, 22.10it/s]  5%|▍         | 48/981 [00:02<00:47, 19.50it/s]  5%|▌         | 51/981 [00:02<00:51, 18.09it/s]  5%|▌         | 53/981 [00:02<00:53, 17.42it/s]  6%|▌         | 55/981 [00:02<00:54, 16.91it/s]  6%|▌         | 57/981 [00:03<00:55, 16.53it/s]  6%|▌         | 59/981 [00:03<00:54, 16.89it/s]  6%|▋         | 62/981 [00:03<00:48, 19.13it/s]  7%|▋         | 65/981 [00:03<00:43, 21.20it/s]  7%|▋         | 68/981 [00:03<00:40, 22.67it/s]  7%|▋         | 71/981 [00:03<00:38, 23.73it/s]  8%|▊         | 74/981 [00:03<00:37, 24.26it/s]  8%|▊         | 77/981 [00:03<00:36, 24.91it/s]  8%|▊         | 80/981 [00:03<00:35, 25.30it/s]  8%|▊         | 83/981 [00:04<00:35, 25.59it/s]  9%|▉         | 86/981 [00:04<00:35, 24.88it/s]  9%|▉         | 89/981 [00:04<00:39, 22.74it/s]  9%|▉         | 92/981 [00:04<00:44, 19.87it/s] 10%|▉         | 95/981 [00:04<00:48, 18.27it/s] 10%|▉         | 97/981 [00:04<00:50, 17.53it/s] 10%|█         | 99/981 [00:04<00:52, 16.93it/s] 10%|█         | 101/981 [00:05<00:54, 16.09it/s] 10%|█         | 103/981 [00:05<00:54, 16.13it/s] 11%|█         | 106/981 [00:05<00:46, 18.84it/s] 11%|█         | 109/981 [00:05<00:41, 20.87it/s] 11%|█▏        | 112/981 [00:05<00:38, 22.38it/s] 12%|█▏        | 115/981 [00:05<00:36, 23.54it/s] 12%|█▏        | 118/981 [00:05<00:40, 21.48it/s] 12%|█▏        | 121/981 [00:06<00:38, 22.35it/s] 13%|█▎        | 124/981 [00:06<00:36, 23.65it/s] 13%|█▎        | 127/981 [00:06<00:35, 23.84it/s] 13%|█▎        | 130/981 [00:06<00:37, 22.75it/s] 14%|█▎        | 133/981 [00:06<00:42, 20.15it/s] 14%|█▍        | 136/981 [00:06<00:45, 18.67it/s] 14%|█▍        | 138/981 [00:06<00:46, 17.97it/s] 14%|█▍        | 141/981 [00:07<00:43, 19.33it/s] 15%|█▍        | 143/981 [00:07<00:44, 18.96it/s] 15%|█▍        | 145/981 [00:07<00:47, 17.65it/s] 15%|█▌        | 148/981 [00:07<00:43, 19.01it/s] 15%|█▌        | 151/981 [00:07<00:39, 21.12it/s] 16%|█▌        | 154/981 [00:07<00:36, 22.68it/s] 16%|█▌        | 157/981 [00:07<00:34, 23.95it/s] 16%|█▋        | 160/981 [00:07<00:32, 24.93it/s] 17%|█▋        | 163/981 [00:07<00:31, 25.66it/s] 17%|█▋        | 166/981 [00:08<00:31, 26.28it/s] 17%|█▋        | 169/981 [00:08<00:30, 26.69it/s] 18%|█▊        | 172/981 [00:08<00:33, 24.37it/s] 18%|█▊        | 175/981 [00:08<00:38, 21.00it/s] 18%|█▊        | 178/981 [00:08<00:41, 19.21it/s] 18%|█▊        | 181/981 [00:08<00:44, 18.15it/s] 19%|█▊        | 183/981 [00:08<00:45, 17.64it/s] 19%|█▉        | 185/981 [00:09<00:46, 17.22it/s] 19%|█▉        | 187/981 [00:09<00:46, 17.00it/s] 19%|█▉        | 190/981 [00:09<00:43, 18.23it/s] 20%|█▉        | 193/981 [00:09<00:38, 20.55it/s] 20%|█▉        | 196/981 [00:09<00:35, 22.36it/s] 20%|██        | 199/981 [00:09<00:32, 23.74it/s] 21%|██        | 202/981 [00:09<00:31, 24.74it/s] 21%|██        | 205/981 [00:09<00:30, 25.46it/s] 21%|██        | 208/981 [00:10<00:29, 25.95it/s] 22%|██▏       | 211/981 [00:10<00:29, 26.27it/s] 22%|██▏       | 214/981 [00:10<00:29, 26.17it/s] 22%|██▏       | 217/981 [00:10<00:33, 22.64it/s] 22%|██▏       | 220/981 [00:10<00:38, 19.91it/s] 23%|██▎       | 223/981 [00:10<00:41, 18.16it/s] 23%|██▎       | 225/981 [00:10<00:43, 17.48it/s] 23%|██▎       | 227/981 [00:11<00:44, 16.94it/s] 23%|██▎       | 229/981 [00:11<00:45, 16.54it/s] 24%|██▎       | 231/981 [00:11<00:47, 15.87it/s] 24%|██▍       | 234/981 [00:11<00:41, 17.82it/s] 24%|██▍       | 237/981 [00:11<00:36, 20.14it/s] 24%|██▍       | 240/981 [00:11<00:33, 21.96it/s] 25%|██▍       | 243/981 [00:11<00:31, 23.35it/s] 25%|██▌       | 246/981 [00:11<00:30, 24.38it/s] 25%|██▌       | 249/981 [00:12<00:29, 25.16it/s] 26%|██▌       | 252/981 [00:12<00:28, 25.74it/s] 26%|██▌       | 255/981 [00:12<00:27, 26.18it/s] 26%|██▋       | 258/981 [00:12<00:30, 23.88it/s] 27%|██▋       | 261/981 [00:12<00:34, 20.57it/s] 27%|██▋       | 264/981 [00:12<00:38, 18.78it/s] 27%|██▋       | 266/981 [00:12<00:39, 17.98it/s] 27%|██▋       | 268/981 [00:13<00:41, 17.36it/s] 28%|██▊       | 270/981 [00:13<00:42, 16.90it/s] 28%|██▊       | 272/981 [00:13<00:43, 16.19it/s] 28%|██▊       | 274/981 [00:13<00:43, 16.27it/s] 28%|██▊       | 277/981 [00:13<00:36, 19.10it/s] 29%|██▊       | 280/981 [00:13<00:32, 21.31it/s] 29%|██▉       | 283/981 [00:13<00:30, 22.95it/s] 29%|██▉       | 286/981 [00:13<00:28, 24.16it/s] 29%|██▉       | 289/981 [00:14<00:27, 25.07it/s] 30%|██▉       | 292/981 [00:14<00:26, 25.77it/s] 30%|███       | 295/981 [00:14<00:26, 26.26it/s] 30%|███       | 298/981 [00:14<00:26, 26.19it/s] 31%|███       | 301/981 [00:14<00:26, 25.62it/s] 31%|███       | 304/981 [00:14<00:32, 20.94it/s] 31%|███▏      | 307/981 [00:14<00:35, 19.03it/s] 32%|███▏      | 310/981 [00:15<00:37, 17.88it/s] 32%|███▏      | 312/981 [00:15<00:38, 17.31it/s] 32%|███▏      | 314/981 [00:15<00:39, 16.87it/s] 32%|███▏      | 316/981 [00:15<00:41, 16.16it/s] 33%|███▎      | 319/981 [00:15<00:36, 18.01it/s] 33%|███▎      | 322/981 [00:15<00:32, 20.30it/s] 33%|███▎      | 325/981 [00:15<00:29, 22.07it/s] 33%|███▎      | 328/981 [00:15<00:27, 23.47it/s] 34%|███▎      | 331/981 [00:16<00:26, 24.48it/s] 34%|███▍      | 334/981 [00:16<00:25, 25.25it/s] 34%|███▍      | 337/981 [00:16<00:24, 25.84it/s] 35%|███▍      | 340/981 [00:16<00:27, 23.47it/s] 35%|███▍      | 343/981 [00:16<00:28, 22.22it/s] 35%|███▌      | 346/981 [00:16<00:32, 19.62it/s] 36%|███▌      | 349/981 [00:16<00:34, 18.24it/s] 36%|███▌      | 351/981 [00:17<00:35, 17.62it/s] 36%|███▌      | 353/981 [00:17<00:36, 17.10it/s] 36%|███▌      | 355/981 [00:17<00:37, 16.71it/s] 36%|███▋      | 357/981 [00:17<00:38, 16.04it/s] 37%|███▋      | 359/981 [00:17<00:38, 16.13it/s] 37%|███▋      | 362/981 [00:17<00:32, 18.99it/s] 37%|███▋      | 365/981 [00:17<00:29, 20.91it/s] 38%|███▊      | 368/981 [00:17<00:27, 22.58it/s] 38%|███▊      | 371/981 [00:18<00:25, 23.86it/s] 38%|███▊      | 374/981 [00:18<00:24, 24.79it/s] 38%|███▊      | 377/981 [00:18<00:23, 25.48it/s] 39%|███▊      | 380/981 [00:18<00:23, 25.94it/s] 39%|███▉      | 383/981 [00:18<00:23, 25.88it/s] 39%|███▉      | 386/981 [00:18<00:26, 22.52it/s] 40%|███▉      | 389/981 [00:18<00:29, 19.89it/s] 40%|███▉      | 392/981 [00:19<00:32, 18.39it/s] 40%|████      | 394/981 [00:19<00:33, 17.71it/s] 40%|████      | 396/981 [00:19<00:34, 17.16it/s] 41%|████      | 398/981 [00:19<00:34, 16.75it/s] 41%|████      | 400/981 [00:19<00:36, 16.04it/s] 41%|████      | 403/981 [00:19<00:32, 17.98it/s] 41%|████▏     | 406/981 [00:19<00:28, 20.31it/s] 42%|████▏     | 409/981 [00:19<00:25, 22.17it/s] 42%|████▏     | 412/981 [00:20<00:24, 23.56it/s] 42%|████▏     | 415/981 [00:20<00:22, 24.62it/s] 43%|████▎     | 418/981 [00:20<00:22, 25.36it/s] 43%|████▎     | 421/981 [00:20<00:21, 25.88it/s] 43%|████▎     | 424/981 [00:20<00:21, 26.29it/s] 44%|████▎     | 427/981 [00:20<00:23, 23.98it/s] 44%|████▍     | 430/981 [00:20<00:26, 20.73it/s] 44%|████▍     | 433/981 [00:20<00:28, 18.92it/s] 44%|████▍     | 436/981 [00:21<00:30, 17.81it/s] 45%|████▍     | 438/981 [00:21<00:31, 17.29it/s] 45%|████▍     | 440/981 [00:21<00:31, 17.44it/s] 45%|████▌     | 442/981 [00:21<00:30, 17.89it/s] 45%|████▌     | 444/981 [00:21<00:31, 17.24it/s] 46%|████▌     | 447/981 [00:21<00:26, 19.89it/s] 46%|████▌     | 450/981 [00:21<00:24, 21.86it/s] 46%|████▌     | 453/981 [00:21<00:22, 23.35it/s] 46%|████▋     | 456/981 [00:22<00:21, 24.44it/s] 47%|████▋     | 459/981 [00:22<00:20, 25.22it/s] 47%|████▋     | 462/981 [00:22<00:20, 25.85it/s] 47%|████▋     | 465/981 [00:22<00:19, 26.22it/s] 48%|████▊     | 468/981 [00:22<00:19, 26.10it/s] 48%|████▊     | 471/981 [00:22<00:19, 25.87it/s] 48%|████▊     | 474/981 [00:22<00:22, 22.27it/s] 49%|████▊     | 477/981 [00:23<00:25, 19.83it/s] 49%|████▉     | 480/981 [00:23<00:26, 18.58it/s] 49%|████▉     | 483/981 [00:23<00:26, 19.10it/s] 49%|████▉     | 485/981 [00:23<00:27, 18.25it/s] 50%|████▉     | 487/981 [00:23<00:28, 17.18it/s] 50%|████▉     | 490/981 [00:23<00:26, 18.75it/s] 50%|█████     | 493/981 [00:23<00:23, 20.85it/s] 51%|█████     | 496/981 [00:23<00:21, 22.51it/s] 51%|█████     | 499/981 [00:24<00:20, 23.78it/s] 51%|█████     | 502/981 [00:24<00:19, 24.79it/s] 51%|█████▏    | 505/981 [00:24<00:18, 25.52it/s] 52%|█████▏    | 508/981 [00:24<00:18, 26.07it/s] 52%|█████▏    | 511/981 [00:24<00:17, 26.44it/s] 52%|█████▏    | 514/981 [00:24<00:19, 24.16it/s] 53%|█████▎    | 517/981 [00:24<00:22, 20.99it/s] 53%|█████▎    | 520/981 [00:25<00:23, 19.25it/s] 53%|█████▎    | 523/981 [00:25<00:25, 18.18it/s] 54%|█████▎    | 525/981 [00:25<00:25, 17.69it/s] 54%|█████▎    | 527/981 [00:25<00:26, 17.24it/s] 54%|█████▍    | 529/981 [00:25<00:27, 16.54it/s] 54%|█████▍    | 531/981 [00:25<00:27, 16.66it/s] 54%|█████▍    | 534/981 [00:25<00:22, 19.50it/s] 55%|█████▍    | 537/981 [00:25<00:20, 21.71it/s] 55%|█████▌    | 540/981 [00:26<00:18, 23.38it/s] 55%|█████▌    | 543/981 [00:26<00:17, 24.65it/s] 56%|█████▌    | 546/981 [00:26<00:16, 25.69it/s] 56%|█████▌    | 549/981 [00:26<00:16, 26.34it/s] 56%|█████▋    | 552/981 [00:26<00:15, 26.84it/s] 57%|█████▋    | 555/981 [00:26<00:15, 27.17it/s] 57%|█████▋    | 558/981 [00:26<00:17, 24.73it/s] 57%|█████▋    | 561/981 [00:26<00:19, 21.42it/s] 57%|█████▋    | 564/981 [00:27<00:21, 19.58it/s] 58%|█████▊    | 567/981 [00:27<00:22, 18.49it/s] 58%|█████▊    | 569/981 [00:27<00:22, 17.97it/s] 58%|█████▊    | 571/981 [00:27<00:23, 17.54it/s] 58%|█████▊    | 573/981 [00:27<00:24, 16.84it/s] 59%|█████▊    | 575/981 [00:27<00:24, 16.83it/s] 59%|█████▉    | 578/981 [00:27<00:20, 19.70it/s] 59%|█████▉    | 581/981 [00:27<00:18, 21.86it/s] 60%|█████▉    | 584/981 [00:28<00:16, 23.48it/s] 60%|█████▉    | 587/981 [00:28<00:15, 24.69it/s] 60%|██████    | 590/981 [00:28<00:15, 25.57it/s] 60%|██████    | 593/981 [00:28<00:14, 26.26it/s] 61%|██████    | 596/981 [00:28<00:14, 26.66it/s] 61%|██████    | 599/981 [00:28<00:14, 27.06it/s] 61%|██████▏   | 602/981 [00:28<00:15, 24.70it/s] 62%|██████▏   | 605/981 [00:28<00:17, 21.37it/s] 62%|██████▏   | 608/981 [00:29<00:19, 19.55it/s] 62%|██████▏   | 611/981 [00:29<00:20, 18.45it/s] 62%|██████▏   | 613/981 [00:29<00:20, 17.78it/s] 63%|██████▎   | 615/981 [00:29<00:20, 17.55it/s] 63%|██████▎   | 617/981 [00:29<00:21, 16.65it/s] 63%|██████▎   | 619/981 [00:29<00:21, 16.75it/s] 63%|██████▎   | 622/981 [00:29<00:18, 19.61it/s] 64%|██████▎   | 625/981 [00:30<00:16, 21.81it/s] 64%|██████▍   | 628/981 [00:30<00:15, 23.50it/s] 64%|██████▍   | 631/981 [00:30<00:14, 24.75it/s] 65%|██████▍   | 634/981 [00:30<00:13, 25.69it/s] 65%|██████▍   | 637/981 [00:30<00:13, 26.32it/s] 65%|██████▌   | 640/981 [00:30<00:12, 26.77it/s] 66%|██████▌   | 643/981 [00:30<00:12, 27.17it/s] 66%|██████▌   | 646/981 [00:30<00:12, 26.37it/s] 66%|██████▌   | 649/981 [00:30<00:14, 23.34it/s] 66%|██████▋   | 652/981 [00:31<00:15, 20.64it/s] 67%|██████▋   | 655/981 [00:31<00:17, 19.11it/s] 67%|██████▋   | 658/981 [00:31<00:17, 18.16it/s] 67%|██████▋   | 660/981 [00:31<00:18, 17.70it/s] 67%|██████▋   | 662/981 [00:31<00:18, 16.94it/s] 68%|██████▊   | 664/981 [00:31<00:18, 16.93it/s] 68%|██████▊   | 667/981 [00:32<00:16, 19.59it/s] 68%|██████▊   | 670/981 [00:32<00:14, 21.77it/s] 69%|██████▊   | 673/981 [00:32<00:13, 23.45it/s] 69%|██████▉   | 676/981 [00:32<00:12, 24.70it/s] 69%|██████▉   | 679/981 [00:32<00:11, 25.66it/s] 70%|██████▉   | 682/981 [00:32<00:11, 26.34it/s] 70%|██████▉   | 685/981 [00:32<00:11, 26.81it/s] 70%|███████   | 688/981 [00:32<00:10, 27.12it/s] 70%|███████   | 691/981 [00:32<00:11, 24.76it/s] 71%|███████   | 694/981 [00:33<00:13, 21.43it/s] 71%|███████   | 697/981 [00:33<00:14, 19.55it/s] 71%|███████▏  | 700/981 [00:33<00:15, 18.35it/s] 72%|███████▏  | 702/981 [00:33<00:15, 17.91it/s] 72%|███████▏  | 704/981 [00:33<00:15, 17.49it/s] 72%|███████▏  | 706/981 [00:33<00:16, 16.76it/s] 72%|███████▏  | 708/981 [00:33<00:16, 16.79it/s] 72%|███████▏  | 711/981 [00:34<00:13, 19.63it/s] 73%|███████▎  | 714/981 [00:34<00:12, 21.85it/s] 73%|███████▎  | 717/981 [00:34<00:11, 23.51it/s] 73%|███████▎  | 720/981 [00:34<00:10, 24.75it/s] 74%|███████▎  | 723/981 [00:34<00:10, 25.66it/s] 74%|███████▍  | 726/981 [00:34<00:11, 22.91it/s] 74%|███████▍  | 729/981 [00:34<00:10, 23.55it/s] 75%|███████▍  | 732/981 [00:34<00:10, 23.80it/s] 75%|███████▍  | 735/981 [00:35<00:10, 22.49it/s] 75%|███████▌  | 738/981 [00:35<00:12, 20.17it/s] 76%|███████▌  | 741/981 [00:35<00:12, 18.81it/s] 76%|███████▌  | 743/981 [00:35<00:13, 18.16it/s] 76%|███████▌  | 745/981 [00:35<00:13, 17.64it/s] 76%|███████▌  | 747/981 [00:35<00:13, 17.23it/s] 76%|███████▋  | 749/981 [00:35<00:14, 16.52it/s] 77%|███████▋  | 751/981 [00:36<00:13, 16.61it/s] 77%|███████▋  | 754/981 [00:36<00:11, 19.49it/s] 77%|███████▋  | 757/981 [00:36<00:10, 21.73it/s] 77%|███████▋  | 760/981 [00:36<00:09, 23.40it/s] 78%|███████▊  | 763/981 [00:36<00:08, 24.63it/s] 78%|███████▊  | 766/981 [00:36<00:08, 25.48it/s] 78%|███████▊  | 769/981 [00:36<00:08, 26.07it/s] 79%|███████▊  | 772/981 [00:36<00:07, 26.56it/s] 79%|███████▉  | 775/981 [00:36<00:07, 26.55it/s] 79%|███████▉  | 778/981 [00:37<00:07, 26.36it/s] 80%|███████▉  | 781/981 [00:37<00:08, 22.85it/s] 80%|███████▉  | 784/981 [00:37<00:09, 20.66it/s] 80%|████████  | 787/981 [00:37<00:09, 19.50it/s] 81%|████████  | 790/981 [00:37<00:10, 18.88it/s] 81%|████████  | 793/981 [00:37<00:09, 20.23it/s] 81%|████████  | 796/981 [00:37<00:08, 21.51it/s] 81%|████████▏ | 799/981 [00:38<00:08, 22.10it/s] 82%|████████▏ | 802/981 [00:38<00:07, 23.99it/s] 82%|████████▏ | 805/981 [00:38<00:06, 25.51it/s] 82%|████████▏ | 808/981 [00:38<00:06, 26.61it/s] 83%|████████▎ | 812/981 [00:38<00:06, 27.83it/s] 83%|████████▎ | 815/981 [00:38<00:05, 28.39it/s] 83%|████████▎ | 819/981 [00:38<00:05, 27.78it/s] 84%|████████▍ | 823/981 [00:38<00:05, 28.58it/s] 84%|████████▍ | 826/981 [00:39<00:05, 27.76it/s] 85%|████████▍ | 829/981 [00:39<00:05, 27.93it/s] 85%|████████▍ | 832/981 [00:39<00:06, 23.87it/s] 85%|████████▌ | 835/981 [00:39<00:06, 21.96it/s] 85%|████████▌ | 838/981 [00:39<00:06, 20.83it/s] 86%|████████▌ | 841/981 [00:39<00:06, 20.19it/s] 86%|████████▌ | 844/981 [00:39<00:07, 19.45it/s] 86%|████████▌ | 846/981 [00:40<00:06, 19.44it/s] 87%|████████▋ | 849/981 [00:40<00:06, 21.52it/s] 87%|████████▋ | 853/981 [00:40<00:05, 24.44it/s] 87%|████████▋ | 857/981 [00:40<00:04, 26.56it/s] 88%|████████▊ | 861/981 [00:40<00:04, 28.05it/s] 88%|████████▊ | 865/981 [00:40<00:03, 29.15it/s] 89%|████████▊ | 869/981 [00:40<00:03, 29.86it/s] 89%|████████▉ | 873/981 [00:40<00:03, 30.38it/s] 89%|████████▉ | 877/981 [00:41<00:03, 27.09it/s] 90%|████████▉ | 880/981 [00:41<00:04, 24.35it/s] 90%|█████████ | 883/981 [00:41<00:04, 22.60it/s] 90%|█████████ | 886/981 [00:41<00:04, 21.42it/s] 91%|█████████ | 889/981 [00:41<00:04, 20.61it/s] 91%|█████████ | 892/981 [00:41<00:04, 20.06it/s] 91%|█████████ | 895/981 [00:42<00:04, 19.29it/s] 92%|█████████▏| 898/981 [00:42<00:04, 20.52it/s] 92%|█████████▏| 902/981 [00:42<00:03, 23.34it/s] 92%|█████████▏| 906/981 [00:42<00:02, 25.69it/s] 93%|█████████▎| 910/981 [00:42<00:02, 27.40it/s] 93%|█████████▎| 914/981 [00:42<00:02, 28.71it/s] 94%|█████████▎| 918/981 [00:42<00:02, 29.76it/s] 94%|█████████▍| 922/981 [00:42<00:01, 30.50it/s] 94%|█████████▍| 926/981 [00:43<00:01, 28.62it/s] 95%|█████████▍| 929/981 [00:43<00:02, 23.41it/s] 95%|█████████▌| 932/981 [00:43<00:02, 22.03it/s] 95%|█████████▌| 935/981 [00:43<00:02, 20.92it/s] 96%|█████████▌| 938/981 [00:43<00:02, 20.27it/s] 96%|█████████▌| 941/981 [00:43<00:02, 19.83it/s] 96%|█████████▌| 944/981 [00:44<00:01, 19.02it/s] 97%|█████████▋| 947/981 [00:44<00:01, 20.28it/s] 97%|█████████▋| 951/981 [00:44<00:01, 23.22it/s] 97%|█████████▋| 955/981 [00:44<00:01, 25.50it/s] 98%|█████████▊| 959/981 [00:44<00:00, 27.23it/s] 98%|█████████▊| 963/981 [00:44<00:00, 28.47it/s] 99%|█████████▊| 967/981 [00:44<00:00, 29.37it/s] 99%|█████████▉| 970/981 [00:45<00:00, 26.71it/s] 99%|█████████▉| 973/981 [00:45<00:00, 26.29it/s] 99%|█████████▉| 976/981 [00:45<00:00, 24.38it/s]100%|█████████▉| 979/981 [00:45<00:00, 22.46it/s]100%|██████████| 981/981 [00:45<00:00, 21.52it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_4_Focal_RS_DRW_seed_43
train data : 14398, disrupt : 227, non-disrupt : 14171
valid data : 3508, disrupt : 57, non-disrupt : 3451
test data : 4051, disrupt : 71, non-disrupt : 3980

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.108, valid loss : 0.087, train f1 : 0.780, valid f1 : 0.556
Best score increase :0.000 -> 0.556
training process - Deferred Re-weighting:   1%|          | 1/128 [03:54<8:16:37, 234.62s/it]Best score increase :0.556 -> 0.573
training process - Deferred Re-weighting:   2%|▏         | 2/128 [07:10<7:24:24, 211.62s/it]Best score increase :0.573 -> 0.744
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:19<6:59:18, 201.27s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:26<6:44:36, 195.77s/it]epoch : 5, train loss : 0.042, valid loss : 0.049, train f1 : 0.926, valid f1 : 0.605
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:18<7:08:08, 208.85s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:26<6:50:25, 201.85s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [23:33<6:36:59, 196.85s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [26:41<6:27:52, 193.94s/it]epoch : 9, train loss : 0.032, valid loss : 0.054, train f1 : 0.946, valid f1 : 0.630
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [30:33<6:48:23, 205.92s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [33:44<6:35:45, 201.24s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [36:57<6:27:35, 198.76s/it]Best score increase :0.744 -> 0.777
training process - Deferred Re-weighting:   9%|▉         | 12/128 [40:07<6:19:05, 196.08s/it]epoch : 13, train loss : 0.030, valid loss : 0.048, train f1 : 0.953, valid f1 : 0.612
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [44:03<6:39:00, 208.18s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [47:14<6:25:47, 203.05s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [50:21<6:13:22, 198.25s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [53:34<6:07:06, 196.66s/it]epoch : 17, train loss : 0.027, valid loss : 0.022, train f1 : 0.955, valid f1 : 0.794
Best score increase :0.777 -> 0.794
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [57:27<6:24:11, 207.68s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [1:00:35<6:09:45, 201.68s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:03:43<5:59:04, 197.66s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:06:55<5:52:46, 195.99s/it]epoch : 21, train loss : 0.023, valid loss : 0.031, train f1 : 0.960, valid f1 : 0.644
EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:10:50<6:10:03, 207.51s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:13:59<5:56:51, 201.99s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:17:07<5:46:02, 197.74s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:20:17<5:38:40, 195.39s/it]epoch : 25, train loss : 0.023, valid loss : 0.028, train f1 : 0.966, valid f1 : 0.682
EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:24:15<5:57:21, 208.17s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:27:21<5:43:03, 201.80s/it]Best score increase :0.794 -> 0.830
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:30:27<5:31:30, 196.93s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:33:35<5:23:44, 194.25s/it]epoch : 29, train loss : 0.023, valid loss : 0.034, train f1 : 0.965, valid f1 : 0.778
EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:37:26<5:38:45, 205.30s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [1:40:37<5:28:05, 200.88s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:43:46<5:19:07, 197.40s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [1:46:55<5:11:55, 194.95s/it]epoch : 33, train loss : 0.021, valid loss : 0.036, train f1 : 0.967, valid f1 : 0.771
EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [1:50:51<5:28:02, 207.19s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [1:54:04<5:17:46, 202.84s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [1:57:12<5:07:47, 198.57s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [2:00:22<5:00:27, 195.95s/it]epoch : 37, train loss : 0.020, valid loss : 0.025, train f1 : 0.969, valid f1 : 0.825
EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [2:04:11<5:12:21, 205.95s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [2:07:21<5:01:42, 201.14s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 38, best f1 score : 0.830
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [2:10:29<5:09:03, 206.03s/it]
training process finished, best loss : 0.023, best acc : 0.987, best f1 : 0.830, best epoch : 26

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.33      0.86      0.48        71
           1       1.00      0.97      0.98      3980

    accuracy                           0.97      4051
   macro avg       0.66      0.91      0.73      4051
weighted avg       0.99      0.97      0.97      4051


# test acc : 0.97, test f1 : 0.73, test AUC : 0.91, test loss : 0.679

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/980 [00:00<?, ?it/s]  0%|          | 2/980 [00:00<00:51, 18.83it/s]  1%|          | 5/980 [00:00<00:40, 23.93it/s]  1%|          | 8/980 [00:00<00:38, 25.57it/s]  1%|          | 11/980 [00:00<00:46, 20.64it/s]  1%|▏         | 14/980 [00:00<00:51, 18.74it/s]  2%|▏         | 16/980 [00:00<00:53, 17.99it/s]  2%|▏         | 18/980 [00:00<00:55, 17.46it/s]  2%|▏         | 20/980 [00:01<00:57, 16.60it/s]  2%|▏         | 22/980 [00:01<00:57, 16.54it/s]  3%|▎         | 25/980 [00:01<00:48, 19.69it/s]  3%|▎         | 28/980 [00:01<00:43, 22.11it/s]  3%|▎         | 31/980 [00:01<00:39, 23.95it/s]  3%|▎         | 34/980 [00:01<00:37, 25.40it/s]  4%|▍         | 37/980 [00:01<00:35, 26.39it/s]  4%|▍         | 40/980 [00:01<00:34, 27.07it/s]  4%|▍         | 43/980 [00:01<00:33, 27.57it/s]  5%|▍         | 46/980 [00:02<00:33, 27.94it/s]  5%|▌         | 49/980 [00:02<00:36, 25.31it/s]  5%|▌         | 52/980 [00:02<00:42, 21.65it/s]  6%|▌         | 55/980 [00:02<00:46, 19.75it/s]  6%|▌         | 58/980 [00:02<00:49, 18.62it/s]  6%|▌         | 60/980 [00:02<00:50, 18.07it/s]  6%|▋         | 62/980 [00:02<00:51, 17.65it/s]  7%|▋         | 64/980 [00:03<00:54, 16.87it/s]  7%|▋         | 66/980 [00:03<00:54, 16.67it/s]  7%|▋         | 69/980 [00:03<00:46, 19.58it/s]  7%|▋         | 72/980 [00:03<00:41, 21.86it/s]  8%|▊         | 75/980 [00:03<00:38, 23.69it/s]  8%|▊         | 78/980 [00:03<00:36, 24.62it/s]  8%|▊         | 81/980 [00:03<00:36, 24.77it/s]  9%|▊         | 84/980 [00:03<00:34, 25.78it/s]  9%|▉         | 87/980 [00:03<00:33, 26.63it/s]  9%|▉         | 90/980 [00:04<00:33, 26.76it/s]  9%|▉         | 93/980 [00:04<00:37, 23.36it/s] 10%|▉         | 96/980 [00:04<00:42, 20.61it/s] 10%|█         | 99/980 [00:04<00:46, 19.01it/s] 10%|█         | 102/980 [00:04<00:49, 17.74it/s] 11%|█         | 104/980 [00:04<00:51, 17.17it/s] 11%|█         | 107/980 [00:05<00:46, 18.74it/s] 11%|█         | 109/980 [00:05<00:48, 17.90it/s] 11%|█▏        | 111/980 [00:05<00:47, 18.24it/s] 12%|█▏        | 114/980 [00:05<00:41, 20.89it/s] 12%|█▏        | 117/980 [00:05<00:37, 22.82it/s] 12%|█▏        | 120/980 [00:05<00:35, 24.33it/s] 13%|█▎        | 123/980 [00:05<00:33, 25.50it/s] 13%|█▎        | 126/980 [00:05<00:32, 26.33it/s] 13%|█▎        | 129/980 [00:05<00:31, 26.89it/s] 13%|█▎        | 132/980 [00:06<00:31, 27.34it/s] 14%|█▍        | 135/980 [00:06<00:30, 27.27it/s] 14%|█▍        | 138/980 [00:06<00:35, 23.63it/s] 14%|█▍        | 141/980 [00:06<00:40, 20.76it/s] 15%|█▍        | 144/980 [00:06<00:37, 22.59it/s] 15%|█▌        | 147/980 [00:06<00:35, 23.36it/s] 15%|█▌        | 150/980 [00:06<00:40, 20.63it/s] 16%|█▌        | 153/980 [00:07<00:43, 19.09it/s] 16%|█▌        | 156/980 [00:07<00:46, 17.79it/s] 16%|█▌        | 159/980 [00:07<00:41, 20.00it/s] 17%|█▋        | 162/980 [00:07<00:37, 21.95it/s] 17%|█▋        | 165/980 [00:07<00:34, 23.57it/s] 17%|█▋        | 168/980 [00:07<00:32, 24.87it/s] 17%|█▋        | 171/980 [00:07<00:31, 25.93it/s] 18%|█▊        | 174/980 [00:07<00:30, 26.72it/s] 18%|█▊        | 177/980 [00:08<00:29, 27.32it/s] 18%|█▊        | 180/980 [00:08<00:28, 27.73it/s] 19%|█▊        | 183/980 [00:08<00:29, 26.78it/s] 19%|█▉        | 186/980 [00:08<00:32, 24.41it/s] 19%|█▉        | 189/980 [00:08<00:33, 23.95it/s] 20%|█▉        | 192/980 [00:08<00:36, 21.37it/s] 20%|█▉        | 195/980 [00:08<00:40, 19.54it/s] 20%|██        | 198/980 [00:09<00:42, 18.40it/s] 20%|██        | 200/980 [00:09<00:45, 17.32it/s] 21%|██        | 202/980 [00:09<00:45, 17.20it/s] 21%|██        | 205/980 [00:09<00:39, 19.77it/s] 21%|██        | 208/980 [00:09<00:35, 21.92it/s] 22%|██▏       | 211/980 [00:09<00:34, 22.10it/s] 22%|██▏       | 214/980 [00:09<00:35, 21.71it/s] 22%|██▏       | 217/980 [00:09<00:33, 22.92it/s] 22%|██▏       | 220/980 [00:10<00:31, 24.17it/s] 23%|██▎       | 223/980 [00:10<00:30, 25.09it/s] 23%|██▎       | 226/980 [00:10<00:29, 25.36it/s] 23%|██▎       | 229/980 [00:10<00:31, 23.52it/s] 24%|██▎       | 232/980 [00:10<00:36, 20.39it/s] 24%|██▍       | 235/980 [00:10<00:39, 18.68it/s] 24%|██▍       | 237/980 [00:10<00:41, 17.90it/s] 24%|██▍       | 239/980 [00:11<00:42, 17.31it/s] 25%|██▍       | 241/980 [00:11<00:43, 16.82it/s] 25%|██▍       | 243/980 [00:11<00:45, 16.09it/s] 25%|██▌       | 246/980 [00:11<00:40, 18.06it/s] 25%|██▌       | 249/980 [00:11<00:35, 20.45it/s] 26%|██▌       | 252/980 [00:11<00:32, 22.25it/s] 26%|██▌       | 255/980 [00:11<00:30, 23.74it/s] 26%|██▋       | 258/980 [00:11<00:29, 24.78it/s] 27%|██▋       | 261/980 [00:12<00:28, 25.61it/s] 27%|██▋       | 264/980 [00:12<00:27, 26.28it/s] 27%|██▋       | 267/980 [00:12<00:26, 26.61it/s] 28%|██▊       | 270/980 [00:12<00:31, 22.27it/s] 28%|██▊       | 273/980 [00:12<00:33, 21.00it/s] 28%|██▊       | 276/980 [00:12<00:37, 18.84it/s] 28%|██▊       | 279/980 [00:12<00:39, 17.68it/s] 29%|██▊       | 281/980 [00:13<00:40, 17.20it/s] 29%|██▉       | 284/980 [00:13<00:37, 18.79it/s] 29%|██▉       | 286/980 [00:13<00:38, 17.94it/s] 29%|██▉       | 289/980 [00:13<00:35, 19.73it/s] 30%|██▉       | 292/980 [00:13<00:31, 21.77it/s] 30%|███       | 295/980 [00:13<00:29, 23.39it/s] 30%|███       | 298/980 [00:13<00:27, 24.67it/s] 31%|███       | 301/980 [00:13<00:26, 25.59it/s] 31%|███       | 304/980 [00:14<00:25, 26.35it/s] 31%|███▏      | 307/980 [00:14<00:25, 26.82it/s] 32%|███▏      | 310/980 [00:14<00:24, 27.06it/s] 32%|███▏      | 313/980 [00:14<00:24, 27.22it/s] 32%|███▏      | 316/980 [00:14<00:27, 24.59it/s] 33%|███▎      | 319/980 [00:14<00:31, 21.10it/s] 33%|███▎      | 322/980 [00:14<00:34, 19.20it/s] 33%|███▎      | 325/980 [00:15<00:36, 18.06it/s] 33%|███▎      | 327/980 [00:15<00:37, 17.52it/s] 34%|███▎      | 329/980 [00:15<00:38, 17.10it/s] 34%|███▍      | 331/980 [00:15<00:39, 16.39it/s] 34%|███▍      | 333/980 [00:15<00:39, 16.37it/s] 34%|███▍      | 336/980 [00:15<00:33, 19.26it/s] 35%|███▍      | 339/980 [00:15<00:29, 21.52it/s] 35%|███▍      | 342/980 [00:15<00:27, 23.23it/s] 35%|███▌      | 345/980 [00:16<00:25, 24.55it/s] 36%|███▌      | 348/980 [00:16<00:24, 25.57it/s] 36%|███▌      | 351/980 [00:16<00:23, 26.22it/s] 36%|███▌      | 354/980 [00:16<00:23, 26.70it/s] 36%|███▋      | 357/980 [00:16<00:23, 26.59it/s] 37%|███▋      | 360/980 [00:16<00:26, 23.04it/s] 37%|███▋      | 363/980 [00:16<00:30, 20.23it/s] 37%|███▋      | 366/980 [00:16<00:32, 18.68it/s] 38%|███▊      | 368/980 [00:17<00:34, 17.98it/s] 38%|███▊      | 370/980 [00:17<00:35, 17.41it/s] 38%|███▊      | 373/980 [00:17<00:32, 18.86it/s] 38%|███▊      | 375/980 [00:17<00:34, 17.56it/s] 38%|███▊      | 377/980 [00:17<00:34, 17.25it/s] 39%|███▉      | 380/980 [00:17<00:30, 19.93it/s] 39%|███▉      | 383/980 [00:17<00:27, 22.05it/s] 39%|███▉      | 386/980 [00:17<00:25, 23.66it/s] 40%|███▉      | 389/980 [00:18<00:24, 23.67it/s] 40%|████      | 392/980 [00:18<00:26, 22.28it/s] 40%|████      | 395/980 [00:18<00:25, 23.31it/s] 41%|████      | 398/980 [00:18<00:23, 24.48it/s] 41%|████      | 401/980 [00:18<00:23, 24.49it/s] 41%|████      | 404/980 [00:18<00:25, 22.79it/s] 42%|████▏     | 407/980 [00:18<00:25, 22.42it/s] 42%|████▏     | 410/980 [00:19<00:24, 23.10it/s] 42%|████▏     | 413/980 [00:19<00:27, 20.37it/s] 42%|████▏     | 416/980 [00:19<00:29, 18.81it/s] 43%|████▎     | 418/980 [00:19<00:31, 18.08it/s] 43%|████▎     | 420/980 [00:19<00:32, 17.11it/s] 43%|████▎     | 423/980 [00:19<00:29, 18.70it/s] 43%|████▎     | 426/980 [00:19<00:26, 21.02it/s] 44%|████▍     | 429/980 [00:19<00:24, 22.87it/s] 44%|████▍     | 432/980 [00:20<00:22, 24.29it/s] 44%|████▍     | 435/980 [00:20<00:21, 25.38it/s] 45%|████▍     | 438/980 [00:20<00:20, 26.16it/s] 45%|████▌     | 441/980 [00:20<00:20, 26.67it/s] 45%|████▌     | 444/980 [00:20<00:19, 26.96it/s] 46%|████▌     | 447/980 [00:20<00:20, 26.25it/s] 46%|████▌     | 450/980 [00:20<00:24, 21.99it/s] 46%|████▌     | 453/980 [00:21<00:26, 19.76it/s] 47%|████▋     | 456/980 [00:21<00:28, 18.45it/s] 47%|████▋     | 458/980 [00:21<00:29, 17.82it/s] 47%|████▋     | 460/980 [00:21<00:29, 17.34it/s] 47%|████▋     | 462/980 [00:21<00:32, 16.14it/s] 47%|████▋     | 464/980 [00:21<00:31, 16.46it/s] 48%|████▊     | 467/980 [00:21<00:26, 19.37it/s] 48%|████▊     | 470/980 [00:21<00:23, 21.67it/s] 48%|████▊     | 473/980 [00:22<00:21, 23.42it/s] 49%|████▊     | 476/980 [00:22<00:20, 24.73it/s] 49%|████▉     | 479/980 [00:22<00:19, 25.67it/s] 49%|████▉     | 482/980 [00:22<00:18, 26.35it/s] 49%|████▉     | 485/980 [00:22<00:18, 26.90it/s] 50%|████▉     | 488/980 [00:22<00:18, 27.24it/s] 50%|█████     | 491/980 [00:22<00:18, 26.44it/s] 50%|█████     | 494/980 [00:22<00:20, 23.60it/s] 51%|█████     | 497/980 [00:23<00:23, 20.64it/s] 51%|█████     | 500/980 [00:23<00:25, 19.04it/s] 51%|█████▏    | 503/980 [00:23<00:26, 18.08it/s] 52%|█████▏    | 505/980 [00:23<00:27, 17.58it/s] 52%|█████▏    | 507/980 [00:23<00:28, 16.82it/s] 52%|█████▏    | 509/980 [00:23<00:28, 16.66it/s] 52%|█████▏    | 512/980 [00:23<00:23, 19.53it/s] 53%|█████▎    | 515/980 [00:24<00:21, 21.81it/s] 53%|█████▎    | 518/980 [00:24<00:19, 23.68it/s] 53%|█████▎    | 521/980 [00:24<00:18, 25.07it/s] 53%|█████▎    | 524/980 [00:24<00:17, 26.04it/s] 54%|█████▍    | 527/980 [00:24<00:16, 26.82it/s] 54%|█████▍    | 530/980 [00:24<00:16, 27.40it/s] 54%|█████▍    | 533/980 [00:24<00:16, 27.80it/s] 55%|█████▍    | 536/980 [00:24<00:16, 27.08it/s] 55%|█████▌    | 539/980 [00:24<00:17, 24.56it/s] 55%|█████▌    | 542/980 [00:25<00:20, 21.41it/s] 56%|█████▌    | 545/980 [00:25<00:22, 19.64it/s] 56%|█████▌    | 548/980 [00:25<00:21, 19.73it/s] 56%|█████▌    | 551/980 [00:25<00:21, 19.84it/s] 57%|█████▋    | 554/980 [00:25<00:23, 18.29it/s] 57%|█████▋    | 557/980 [00:25<00:21, 19.51it/s] 57%|█████▋    | 560/980 [00:25<00:19, 21.65it/s] 57%|█████▋    | 563/980 [00:26<00:17, 23.34it/s] 58%|█████▊    | 566/980 [00:26<00:16, 24.92it/s] 58%|█████▊    | 569/980 [00:26<00:18, 21.91it/s] 58%|█████▊    | 572/980 [00:26<00:17, 22.96it/s] 59%|█████▊    | 575/980 [00:26<00:16, 24.50it/s] 59%|█████▉    | 578/980 [00:26<00:15, 25.30it/s] 59%|█████▉    | 581/980 [00:26<00:15, 25.60it/s] 60%|█████▉    | 584/980 [00:26<00:17, 22.37it/s] 60%|█████▉    | 587/980 [00:27<00:19, 20.16it/s] 60%|██████    | 590/980 [00:27<00:20, 18.88it/s] 60%|██████    | 592/980 [00:27<00:21, 18.27it/s] 61%|██████    | 594/980 [00:27<00:21, 17.80it/s] 61%|██████    | 596/980 [00:27<00:22, 16.99it/s] 61%|██████    | 598/980 [00:27<00:22, 16.81it/s] 61%|██████▏   | 601/980 [00:27<00:19, 19.81it/s] 62%|██████▏   | 604/980 [00:28<00:16, 22.18it/s] 62%|██████▏   | 607/980 [00:28<00:15, 24.00it/s] 62%|██████▏   | 610/980 [00:28<00:14, 25.32it/s] 63%|██████▎   | 613/980 [00:28<00:13, 26.34it/s] 63%|██████▎   | 616/980 [00:28<00:13, 27.00it/s] 63%|██████▎   | 619/980 [00:28<00:13, 27.54it/s] 63%|██████▎   | 622/980 [00:28<00:12, 27.91it/s] 64%|██████▍   | 625/980 [00:28<00:13, 26.70it/s] 64%|██████▍   | 628/980 [00:28<00:14, 24.56it/s] 64%|██████▍   | 631/980 [00:29<00:16, 21.35it/s] 65%|██████▍   | 634/980 [00:29<00:15, 21.78it/s] 65%|██████▌   | 637/980 [00:29<00:17, 19.78it/s] 65%|██████▌   | 640/980 [00:29<00:18, 18.59it/s] 66%|██████▌   | 642/980 [00:29<00:19, 17.61it/s] 66%|██████▌   | 644/980 [00:29<00:19, 17.30it/s] 66%|██████▌   | 647/980 [00:30<00:16, 19.98it/s] 66%|██████▋   | 650/980 [00:30<00:14, 22.14it/s] 67%|██████▋   | 653/980 [00:30<00:15, 21.77it/s] 67%|██████▋   | 656/980 [00:30<00:14, 22.26it/s] 67%|██████▋   | 659/980 [00:30<00:13, 23.67it/s] 68%|██████▊   | 662/980 [00:30<00:12, 25.09it/s] 68%|██████▊   | 665/980 [00:30<00:12, 26.10it/s] 68%|██████▊   | 668/980 [00:30<00:12, 25.90it/s] 68%|██████▊   | 671/980 [00:30<00:12, 25.72it/s] 69%|██████▉   | 674/980 [00:31<00:13, 22.04it/s] 69%|██████▉   | 677/980 [00:31<00:15, 20.02it/s] 69%|██████▉   | 680/980 [00:31<00:15, 18.80it/s] 70%|██████▉   | 683/980 [00:31<00:14, 20.33it/s] 70%|███████   | 686/980 [00:31<00:15, 18.67it/s] 70%|███████   | 688/980 [00:31<00:15, 18.61it/s] 71%|███████   | 691/980 [00:31<00:13, 21.07it/s] 71%|███████   | 694/980 [00:32<00:12, 23.06it/s] 71%|███████   | 697/980 [00:32<00:11, 23.62it/s] 71%|███████▏  | 700/980 [00:32<00:11, 24.70it/s] 72%|███████▏  | 703/980 [00:32<00:10, 25.86it/s] 72%|███████▏  | 706/980 [00:32<00:10, 26.41it/s] 72%|███████▏  | 709/980 [00:32<00:10, 27.09it/s] 73%|███████▎  | 712/980 [00:32<00:09, 27.57it/s] 73%|███████▎  | 715/980 [00:32<00:09, 26.87it/s] 73%|███████▎  | 718/980 [00:32<00:09, 26.26it/s] 74%|███████▎  | 721/980 [00:33<00:11, 22.30it/s] 74%|███████▍  | 724/980 [00:33<00:12, 20.17it/s] 74%|███████▍  | 727/980 [00:33<00:13, 18.93it/s] 74%|███████▍  | 729/980 [00:33<00:13, 18.32it/s] 75%|███████▍  | 731/980 [00:33<00:13, 18.51it/s] 75%|███████▍  | 734/980 [00:33<00:12, 20.13it/s] 75%|███████▌  | 737/980 [00:34<00:11, 20.73it/s] 76%|███████▌  | 740/980 [00:34<00:10, 22.77it/s] 76%|███████▌  | 743/980 [00:34<00:09, 24.36it/s] 76%|███████▌  | 746/980 [00:34<00:09, 25.51it/s] 76%|███████▋  | 749/980 [00:34<00:08, 26.44it/s] 77%|███████▋  | 752/980 [00:34<00:08, 27.15it/s] 77%|███████▋  | 755/980 [00:34<00:08, 27.52it/s] 77%|███████▋  | 758/980 [00:34<00:07, 27.79it/s] 78%|███████▊  | 761/980 [00:34<00:08, 26.93it/s] 78%|███████▊  | 764/980 [00:35<00:09, 22.48it/s] 78%|███████▊  | 767/980 [00:35<00:10, 20.19it/s] 79%|███████▊  | 770/980 [00:35<00:11, 18.84it/s] 79%|███████▉  | 773/980 [00:35<00:11, 17.99it/s] 79%|███████▉  | 775/980 [00:35<00:11, 17.74it/s] 79%|███████▉  | 778/980 [00:35<00:10, 19.04it/s] 80%|███████▉  | 780/980 [00:35<00:10, 18.41it/s] 80%|███████▉  | 783/980 [00:36<00:09, 20.66it/s] 80%|████████  | 787/980 [00:36<00:08, 23.57it/s] 81%|████████  | 791/980 [00:36<00:07, 25.83it/s] 81%|████████  | 795/980 [00:36<00:06, 27.64it/s] 82%|████████▏ | 799/980 [00:36<00:06, 29.06it/s] 82%|████████▏ | 803/980 [00:36<00:05, 30.05it/s] 82%|████████▏ | 807/980 [00:36<00:06, 27.33it/s] 83%|████████▎ | 810/980 [00:37<00:06, 26.85it/s] 83%|████████▎ | 813/980 [00:37<00:06, 24.64it/s] 83%|████████▎ | 816/980 [00:37<00:07, 22.62it/s] 84%|████████▎ | 819/980 [00:37<00:07, 21.38it/s] 84%|████████▍ | 822/980 [00:37<00:07, 20.55it/s] 84%|████████▍ | 825/980 [00:37<00:07, 19.98it/s] 84%|████████▍ | 828/980 [00:37<00:07, 19.17it/s] 85%|████████▍ | 830/980 [00:38<00:07, 19.09it/s] 85%|████████▌ | 833/980 [00:38<00:06, 21.59it/s] 85%|████████▌ | 837/980 [00:38<00:05, 24.64it/s] 86%|████████▌ | 841/980 [00:38<00:05, 26.88it/s] 86%|████████▌ | 845/980 [00:38<00:04, 28.53it/s] 87%|████████▋ | 849/980 [00:38<00:04, 29.71it/s] 87%|████████▋ | 853/980 [00:38<00:04, 30.55it/s] 87%|████████▋ | 857/980 [00:38<00:04, 30.61it/s] 88%|████████▊ | 861/980 [00:39<00:03, 30.52it/s] 88%|████████▊ | 865/980 [00:39<00:04, 27.50it/s] 89%|████████▊ | 868/980 [00:39<00:04, 24.70it/s] 89%|████████▉ | 871/980 [00:39<00:04, 22.88it/s] 89%|████████▉ | 874/980 [00:39<00:04, 21.64it/s] 89%|████████▉ | 877/980 [00:39<00:04, 20.80it/s] 90%|████████▉ | 880/980 [00:40<00:05, 19.84it/s] 90%|█████████ | 883/980 [00:40<00:04, 20.85it/s] 91%|█████████ | 887/980 [00:40<00:03, 23.96it/s] 91%|█████████ | 891/980 [00:40<00:03, 26.34it/s] 91%|█████████▏| 895/980 [00:40<00:03, 28.10it/s] 92%|█████████▏| 899/980 [00:40<00:02, 29.51it/s] 92%|█████████▏| 903/980 [00:40<00:02, 30.52it/s] 93%|█████████▎| 907/980 [00:40<00:02, 31.27it/s] 93%|█████████▎| 911/980 [00:41<00:02, 30.77it/s] 93%|█████████▎| 915/980 [00:41<00:02, 29.92it/s] 94%|█████████▍| 919/980 [00:41<00:02, 25.57it/s] 94%|█████████▍| 922/980 [00:41<00:02, 23.72it/s] 94%|█████████▍| 925/980 [00:41<00:02, 22.38it/s] 95%|█████████▍| 928/980 [00:41<00:02, 23.65it/s] 95%|█████████▌| 932/980 [00:41<00:01, 25.72it/s] 95%|█████████▌| 935/980 [00:42<00:01, 23.06it/s] 96%|█████████▌| 938/980 [00:42<00:01, 23.03it/s] 96%|█████████▌| 942/980 [00:42<00:01, 25.72it/s] 97%|█████████▋| 946/980 [00:42<00:01, 27.78it/s] 97%|█████████▋| 950/980 [00:42<00:01, 29.32it/s] 97%|█████████▋| 954/980 [00:42<00:00, 30.25it/s] 98%|█████████▊| 958/980 [00:42<00:00, 30.84it/s] 98%|█████████▊| 962/980 [00:42<00:00, 31.40it/s] 99%|█████████▊| 966/980 [00:43<00:00, 30.69it/s] 99%|█████████▉| 970/980 [00:43<00:00, 31.06it/s] 99%|█████████▉| 974/980 [00:43<00:00, 26.20it/s]100%|█████████▉| 977/980 [00:43<00:00, 24.04it/s]100%|██████████| 980/980 [00:43<00:00, 22.55it/s]100%|██████████| 980/980 [00:43<00:00, 22.40it/s]
time :  1337
prob :  1337
thermal quench :  5.342
current quench:  5.368
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT_clip_21_dist_5_Focal_RS_DRW_seed_43
train data : 14374, disrupt : 227, non-disrupt : 14147
valid data : 3506, disrupt : 57, non-disrupt : 3449
test data : 4049, disrupt : 71, non-disrupt : 3978

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/128 [00:00<?, ?it/s]epoch : 1, train loss : 0.141, valid loss : 0.057, train f1 : 0.673, valid f1 : 0.646
Best score increase :0.000 -> 0.646
training process - Deferred Re-weighting:   1%|          | 1/128 [03:50<8:06:57, 230.06s/it]Best score increase :0.646 -> 0.660
training process - Deferred Re-weighting:   2%|▏         | 2/128 [06:57<7:10:03, 204.79s/it]EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:   2%|▏         | 3/128 [10:05<6:51:25, 197.48s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:   3%|▎         | 4/128 [13:11<6:38:21, 192.76s/it]epoch : 5, train loss : 0.057, valid loss : 0.071, train f1 : 0.900, valid f1 : 0.539
EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:   4%|▍         | 5/128 [17:00<7:01:56, 205.82s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:   5%|▍         | 6/128 [20:07<6:45:23, 199.37s/it]EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:   5%|▌         | 7/128 [23:14<6:33:56, 195.35s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:   6%|▋         | 8/128 [26:22<6:25:48, 192.91s/it]epoch : 9, train loss : 0.043, valid loss : 0.050, train f1 : 0.926, valid f1 : 0.556
EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:   7%|▋         | 9/128 [30:14<6:47:23, 205.40s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:   8%|▊         | 10/128 [33:22<6:33:14, 199.95s/it]EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:   9%|▊         | 11/128 [36:28<6:21:34, 195.68s/it]Best score increase :0.660 -> 0.694
training process - Deferred Re-weighting:   9%|▉         | 12/128 [39:35<6:12:59, 192.92s/it]epoch : 13, train loss : 0.039, valid loss : 0.060, train f1 : 0.932, valid f1 : 0.563
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  10%|█         | 13/128 [43:26<6:31:48, 204.42s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  11%|█         | 14/128 [46:33<6:18:48, 199.37s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  12%|█▏        | 15/128 [49:40<6:08:25, 195.62s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  12%|█▎        | 16/128 [52:47<6:00:19, 193.03s/it]epoch : 17, train loss : 0.035, valid loss : 0.052, train f1 : 0.939, valid f1 : 0.588
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  13%|█▎        | 17/128 [56:39<6:18:29, 204.59s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  14%|█▍        | 18/128 [59:47<6:05:55, 199.60s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  15%|█▍        | 19/128 [1:03:00<5:59:03, 197.65s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  16%|█▌        | 20/128 [1:06:08<5:50:37, 194.79s/it]epoch : 21, train loss : 0.032, valid loss : 0.062, train f1 : 0.946, valid f1 : 0.585
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  16%|█▋        | 21/128 [1:09:59<6:06:57, 205.77s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  17%|█▋        | 22/128 [1:13:07<5:53:44, 200.24s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  18%|█▊        | 23/128 [1:16:14<5:43:26, 196.25s/it]Best score increase :0.694 -> 0.715
training process - Deferred Re-weighting:  19%|█▉        | 24/128 [1:19:22<5:36:17, 194.02s/it]epoch : 25, train loss : 0.031, valid loss : 0.054, train f1 : 0.949, valid f1 : 0.616
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  20%|█▉        | 25/128 [1:23:21<5:55:47, 207.26s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  20%|██        | 26/128 [1:26:29<5:42:42, 201.59s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  21%|██        | 27/128 [1:29:36<5:31:45, 197.08s/it]Best score increase :0.715 -> 0.726
training process - Deferred Re-weighting:  22%|██▏       | 28/128 [1:32:41<5:22:44, 193.65s/it]epoch : 29, train loss : 0.031, valid loss : 0.038, train f1 : 0.953, valid f1 : 0.664
EarlyStopping counter : 1 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 29/128 [1:36:29<5:36:33, 203.97s/it]EarlyStopping counter : 2 out of 12
training process - Deferred Re-weighting:  23%|██▎       | 30/128 [1:39:38<5:25:38, 199.37s/it]EarlyStopping counter : 3 out of 12
training process - Deferred Re-weighting:  24%|██▍       | 31/128 [1:42:49<5:18:24, 196.96s/it]EarlyStopping counter : 4 out of 12
training process - Deferred Re-weighting:  25%|██▌       | 32/128 [1:45:55<5:09:49, 193.64s/it]epoch : 33, train loss : 0.029, valid loss : 0.069, train f1 : 0.955, valid f1 : 0.646
EarlyStopping counter : 5 out of 12
training process - Deferred Re-weighting:  26%|██▌       | 33/128 [1:49:46<5:24:04, 204.68s/it]EarlyStopping counter : 6 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 34/128 [1:52:52<5:12:17, 199.33s/it]EarlyStopping counter : 7 out of 12
training process - Deferred Re-weighting:  27%|██▋       | 35/128 [1:56:02<5:04:32, 196.48s/it]EarlyStopping counter : 8 out of 12
training process - Deferred Re-weighting:  28%|██▊       | 36/128 [1:59:11<4:57:33, 194.06s/it]epoch : 37, train loss : 0.027, valid loss : 0.063, train f1 : 0.959, valid f1 : 0.583
EarlyStopping counter : 9 out of 12
training process - Deferred Re-weighting:  29%|██▉       | 37/128 [2:03:02<5:11:17, 205.25s/it]EarlyStopping counter : 10 out of 12
training process - Deferred Re-weighting:  30%|██▉       | 38/128 [2:06:10<5:00:04, 200.05s/it]EarlyStopping counter : 11 out of 12
training process - Deferred Re-weighting:  30%|███       | 39/128 [2:09:18<4:51:24, 196.46s/it]EarlyStopping counter : 12 out of 12
Early stopping | epoch : 39, best f1 score : 0.726
training process - Deferred Re-weighting:  30%|███       | 39/128 [2:12:27<5:02:16, 203.78s/it]
training process finished, best loss : 0.038, best acc : 0.974, best f1 : 0.726, best epoch : 27

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.38      0.75      0.50        71
           1       1.00      0.98      0.99      3978

    accuracy                           0.97      4049
   macro avg       0.69      0.86      0.75      4049
weighted avg       0.98      0.97      0.98      4049


# test acc : 0.97, test f1 : 0.75, test AUC : 0.86, test loss : 1.118

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/979 [00:00<?, ?it/s]  0%|          | 2/979 [00:00<00:53, 18.14it/s]  1%|          | 5/979 [00:00<00:46, 21.05it/s]  1%|          | 8/979 [00:00<00:54, 17.78it/s]  1%|          | 10/979 [00:00<00:57, 16.92it/s]  1%|          | 12/979 [00:00<00:59, 16.35it/s]  1%|▏         | 14/979 [00:00<01:00, 16.02it/s]  2%|▏         | 16/979 [00:00<01:00, 15.81it/s]  2%|▏         | 18/979 [00:01<01:03, 15.05it/s]  2%|▏         | 20/979 [00:01<01:01, 15.49it/s]  2%|▏         | 23/979 [00:01<00:51, 18.55it/s]  3%|▎         | 26/979 [00:01<00:45, 20.85it/s]  3%|▎         | 29/979 [00:01<00:42, 22.54it/s]  3%|▎         | 32/979 [00:01<00:39, 23.82it/s]  4%|▎         | 35/979 [00:01<00:38, 24.70it/s]  4%|▍         | 38/979 [00:01<00:37, 25.33it/s]  4%|▍         | 41/979 [00:02<00:36, 25.83it/s]  4%|▍         | 44/979 [00:02<00:37, 25.23it/s]  5%|▍         | 47/979 [00:02<00:44, 21.07it/s]  5%|▌         | 50/979 [00:02<00:48, 18.98it/s]  5%|▌         | 53/979 [00:02<00:52, 17.73it/s]  6%|▌         | 55/979 [00:02<00:53, 17.15it/s]  6%|▌         | 57/979 [00:02<00:55, 16.71it/s]  6%|▌         | 59/979 [00:03<00:57, 15.89it/s]  6%|▌         | 61/979 [00:03<00:56, 16.17it/s]  7%|▋         | 64/979 [00:03<00:48, 18.90it/s]  7%|▋         | 67/979 [00:03<00:43, 21.06it/s]  7%|▋         | 70/979 [00:03<00:40, 22.62it/s]  7%|▋         | 73/979 [00:03<00:38, 23.79it/s]  8%|▊         | 76/979 [00:03<00:36, 24.63it/s]  8%|▊         | 79/979 [00:03<00:35, 25.28it/s]  8%|▊         | 82/979 [00:04<00:35, 25.61it/s]  9%|▊         | 85/979 [00:04<00:36, 24.74it/s]  9%|▉         | 88/979 [00:04<00:36, 24.29it/s]  9%|▉         | 91/979 [00:04<00:41, 21.15it/s] 10%|▉         | 94/979 [00:04<00:46, 18.98it/s] 10%|▉         | 97/979 [00:04<00:49, 17.70it/s] 10%|█         | 99/979 [00:04<00:51, 17.10it/s] 10%|█         | 101/979 [00:05<00:53, 16.26it/s] 11%|█         | 103/979 [00:05<00:54, 16.18it/s] 11%|█         | 106/979 [00:05<00:46, 18.76it/s] 11%|█         | 109/979 [00:05<00:41, 20.85it/s] 11%|█▏        | 112/979 [00:05<00:38, 22.40it/s] 12%|█▏        | 115/979 [00:05<00:36, 23.54it/s] 12%|█▏        | 118/979 [00:05<00:35, 24.35it/s] 12%|█▏        | 121/979 [00:05<00:34, 25.00it/s] 13%|█▎        | 124/979 [00:06<00:33, 25.45it/s] 13%|█▎        | 127/979 [00:06<00:34, 24.88it/s] 13%|█▎        | 130/979 [00:06<00:34, 24.70it/s] 14%|█▎        | 133/979 [00:06<00:40, 20.80it/s] 14%|█▍        | 136/979 [00:06<00:44, 18.74it/s] 14%|█▍        | 138/979 [00:06<00:47, 17.83it/s] 14%|█▍        | 140/979 [00:06<00:48, 17.16it/s] 15%|█▍        | 142/979 [00:07<00:50, 16.64it/s] 15%|█▍        | 144/979 [00:07<00:52, 15.89it/s] 15%|█▌        | 147/979 [00:07<00:46, 17.73it/s] 15%|█▌        | 150/979 [00:07<00:41, 20.00it/s] 16%|█▌        | 153/979 [00:07<00:37, 21.82it/s] 16%|█▌        | 156/979 [00:07<00:35, 22.96it/s] 16%|█▌        | 159/979 [00:07<00:34, 24.00it/s] 17%|█▋        | 162/979 [00:07<00:32, 24.80it/s] 17%|█▋        | 165/979 [00:08<00:32, 25.37it/s] 17%|█▋        | 168/979 [00:08<00:31, 25.42it/s] 17%|█▋        | 171/979 [00:08<00:36, 22.13it/s] 18%|█▊        | 174/979 [00:08<00:41, 19.56it/s] 18%|█▊        | 177/979 [00:08<00:44, 18.08it/s] 18%|█▊        | 179/979 [00:08<00:45, 17.41it/s] 18%|█▊        | 181/979 [00:08<00:47, 16.89it/s] 19%|█▊        | 183/979 [00:09<00:48, 16.50it/s] 19%|█▉        | 185/979 [00:09<00:50, 15.83it/s] 19%|█▉        | 188/979 [00:09<00:44, 17.72it/s] 20%|█▉        | 191/979 [00:09<00:39, 20.03it/s] 20%|█▉        | 194/979 [00:09<00:35, 21.87it/s] 20%|██        | 197/979 [00:09<00:33, 23.19it/s] 20%|██        | 200/979 [00:09<00:32, 24.19it/s] 21%|██        | 203/979 [00:09<00:31, 24.85it/s] 21%|██        | 206/979 [00:10<00:30, 25.31it/s] 21%|██▏       | 209/979 [00:10<00:30, 25.28it/s] 22%|██▏       | 212/979 [00:10<00:35, 21.89it/s] 22%|██▏       | 215/979 [00:10<00:39, 19.22it/s] 22%|██▏       | 218/979 [00:10<00:42, 17.71it/s] 22%|██▏       | 220/979 [00:10<00:44, 17.01it/s] 23%|██▎       | 222/979 [00:11<00:45, 16.46it/s] 23%|██▎       | 224/979 [00:11<00:46, 16.14it/s] 23%|██▎       | 226/979 [00:11<00:48, 15.47it/s] 23%|██▎       | 229/979 [00:11<00:43, 17.34it/s] 24%|██▎       | 232/979 [00:11<00:38, 19.60it/s] 24%|██▍       | 235/979 [00:11<00:34, 21.39it/s] 24%|██▍       | 238/979 [00:11<00:32, 22.72it/s] 25%|██▍       | 241/979 [00:11<00:31, 23.67it/s] 25%|██▍       | 244/979 [00:12<00:30, 24.40it/s] 25%|██▌       | 247/979 [00:12<00:29, 24.97it/s] 26%|██▌       | 250/979 [00:12<00:29, 24.98it/s] 26%|██▌       | 253/979 [00:12<00:33, 21.72it/s] 26%|██▌       | 256/979 [00:12<00:37, 19.08it/s] 26%|██▋       | 259/979 [00:12<00:40, 17.67it/s] 27%|██▋       | 261/979 [00:12<00:42, 17.02it/s] 27%|██▋       | 263/979 [00:13<00:43, 16.51it/s] 27%|██▋       | 265/979 [00:13<00:44, 16.11it/s] 27%|██▋       | 267/979 [00:13<00:46, 15.43it/s] 28%|██▊       | 270/979 [00:13<00:40, 17.36it/s] 28%|██▊       | 273/979 [00:13<00:35, 19.66it/s] 28%|██▊       | 276/979 [00:13<00:32, 21.48it/s] 28%|██▊       | 279/979 [00:13<00:30, 22.82it/s] 29%|██▉       | 282/979 [00:13<00:29, 23.85it/s] 29%|██▉       | 285/979 [00:14<00:28, 24.60it/s] 29%|██▉       | 288/979 [00:14<00:27, 25.11it/s] 30%|██▉       | 291/979 [00:14<00:27, 25.14it/s] 30%|███       | 294/979 [00:14<00:31, 21.88it/s] 30%|███       | 297/979 [00:14<00:35, 19.28it/s] 31%|███       | 300/979 [00:14<00:38, 17.81it/s] 31%|███       | 302/979 [00:15<00:39, 17.13it/s] 31%|███       | 304/979 [00:15<00:40, 16.59it/s] 31%|███▏      | 306/979 [00:15<00:41, 16.18it/s] 31%|███▏      | 308/979 [00:15<00:43, 15.39it/s] 32%|███▏      | 310/979 [00:15<00:41, 16.19it/s] 32%|███▏      | 313/979 [00:15<00:34, 19.04it/s] 32%|███▏      | 316/979 [00:15<00:37, 17.71it/s] 33%|███▎      | 319/979 [00:15<00:34, 19.04it/s] 33%|███▎      | 322/979 [00:16<00:31, 20.69it/s] 33%|███▎      | 325/979 [00:16<00:29, 22.24it/s] 34%|███▎      | 328/979 [00:16<00:27, 23.58it/s] 34%|███▍      | 331/979 [00:16<00:26, 24.16it/s] 34%|███▍      | 334/979 [00:16<00:30, 20.87it/s] 34%|███▍      | 337/979 [00:16<00:34, 18.68it/s] 35%|███▍      | 339/979 [00:16<00:36, 17.72it/s] 35%|███▍      | 341/979 [00:17<00:37, 16.97it/s] 35%|███▌      | 343/979 [00:17<00:38, 16.39it/s] 35%|███▌      | 345/979 [00:17<00:39, 15.94it/s] 35%|███▌      | 347/979 [00:17<00:41, 15.23it/s] 36%|███▌      | 350/979 [00:17<00:36, 17.37it/s] 36%|███▌      | 353/979 [00:17<00:31, 19.87it/s] 36%|███▋      | 356/979 [00:17<00:28, 21.83it/s] 37%|███▋      | 359/979 [00:17<00:26, 23.29it/s] 37%|███▋      | 362/979 [00:18<00:25, 24.42it/s] 37%|███▋      | 365/979 [00:18<00:24, 25.22it/s] 38%|███▊      | 368/979 [00:18<00:23, 25.85it/s] 38%|███▊      | 371/979 [00:18<00:23, 26.27it/s] 38%|███▊      | 374/979 [00:18<00:25, 23.88it/s] 39%|███▊      | 377/979 [00:18<00:29, 20.63it/s] 39%|███▉      | 380/979 [00:18<00:31, 18.84it/s] 39%|███▉      | 382/979 [00:19<00:33, 17.98it/s] 39%|███▉      | 384/979 [00:19<00:34, 17.36it/s] 40%|███▉      | 387/979 [00:19<00:31, 19.01it/s] 40%|███▉      | 389/979 [00:19<00:33, 17.62it/s] 40%|███▉      | 391/979 [00:19<00:34, 17.26it/s] 40%|████      | 394/979 [00:19<00:29, 19.86it/s] 41%|████      | 397/979 [00:19<00:26, 21.84it/s] 41%|████      | 400/979 [00:19<00:24, 23.34it/s] 41%|████      | 403/979 [00:20<00:23, 24.45it/s] 41%|████▏     | 406/979 [00:20<00:22, 25.28it/s] 42%|████▏     | 409/979 [00:20<00:22, 25.88it/s] 42%|████▏     | 412/979 [00:20<00:21, 26.32it/s] 42%|████▏     | 415/979 [00:20<00:21, 26.23it/s] 43%|████▎     | 418/979 [00:20<00:24, 22.80it/s] 43%|████▎     | 421/979 [00:20<00:28, 19.77it/s] 43%|████▎     | 424/979 [00:21<00:30, 18.33it/s] 44%|████▎     | 426/979 [00:21<00:30, 18.40it/s] 44%|████▍     | 429/979 [00:21<00:28, 19.03it/s] 44%|████▍     | 431/979 [00:21<00:30, 18.12it/s] 44%|████▍     | 433/979 [00:21<00:32, 16.98it/s] 45%|████▍     | 436/979 [00:21<00:29, 18.58it/s] 45%|████▍     | 439/979 [00:21<00:25, 20.83it/s] 45%|████▌     | 442/979 [00:21<00:23, 22.53it/s] 45%|████▌     | 445/979 [00:22<00:22, 23.86it/s] 46%|████▌     | 448/979 [00:22<00:21, 24.85it/s] 46%|████▌     | 451/979 [00:22<00:20, 25.63it/s] 46%|████▋     | 454/979 [00:22<00:20, 26.13it/s] 47%|████▋     | 457/979 [00:22<00:19, 26.52it/s] 47%|████▋     | 460/979 [00:22<00:20, 25.36it/s] 47%|████▋     | 463/979 [00:22<00:19, 25.90it/s] 48%|████▊     | 466/979 [00:22<00:19, 26.31it/s] 48%|████▊     | 469/979 [00:22<00:19, 26.62it/s] 48%|████▊     | 472/979 [00:23<00:18, 26.81it/s] 49%|████▊     | 475/979 [00:23<00:18, 26.90it/s] 49%|████▉     | 478/979 [00:23<00:18, 27.00it/s] 49%|████▉     | 481/979 [00:23<00:18, 27.07it/s] 49%|████▉     | 484/979 [00:23<00:18, 27.08it/s] 50%|████▉     | 487/979 [00:23<00:18, 26.69it/s] 50%|█████     | 490/979 [00:23<00:18, 26.87it/s] 50%|█████     | 493/979 [00:23<00:17, 27.04it/s] 51%|█████     | 496/979 [00:23<00:17, 27.16it/s] 51%|█████     | 499/979 [00:24<00:17, 27.20it/s] 51%|█████▏    | 502/979 [00:24<00:17, 27.30it/s] 52%|█████▏    | 505/979 [00:24<00:17, 27.41it/s] 52%|█████▏    | 508/979 [00:24<00:17, 27.39it/s] 52%|█████▏    | 511/979 [00:24<00:17, 27.49it/s] 53%|█████▎    | 514/979 [00:24<00:17, 26.07it/s] 53%|█████▎    | 517/979 [00:24<00:17, 26.56it/s] 53%|█████▎    | 520/979 [00:24<00:17, 26.91it/s] 53%|█████▎    | 523/979 [00:24<00:16, 27.10it/s] 54%|█████▎    | 526/979 [00:25<00:16, 27.35it/s] 54%|█████▍    | 529/979 [00:25<00:16, 27.55it/s] 54%|█████▍    | 532/979 [00:25<00:16, 27.68it/s] 55%|█████▍    | 535/979 [00:25<00:15, 27.78it/s] 55%|█████▍    | 538/979 [00:25<00:15, 27.82it/s] 55%|█████▌    | 541/979 [00:25<00:15, 27.43it/s] 56%|█████▌    | 544/979 [00:25<00:15, 27.35it/s] 56%|█████▌    | 547/979 [00:25<00:15, 27.58it/s] 56%|█████▌    | 550/979 [00:25<00:15, 27.69it/s] 56%|█████▋    | 553/979 [00:25<00:15, 27.81it/s] 57%|█████▋    | 556/979 [00:26<00:15, 27.96it/s] 57%|█████▋    | 559/979 [00:26<00:14, 28.04it/s] 57%|█████▋    | 562/979 [00:26<00:14, 28.10it/s] 58%|█████▊    | 565/979 [00:26<00:14, 28.11it/s] 58%|█████▊    | 568/979 [00:26<00:14, 28.09it/s] 58%|█████▊    | 571/979 [00:26<00:15, 27.03it/s] 59%|█████▊    | 574/979 [00:26<00:16, 23.89it/s] 59%|█████▉    | 577/979 [00:26<00:19, 20.97it/s] 59%|█████▉    | 580/979 [00:27<00:20, 19.30it/s] 60%|█████▉    | 583/979 [00:27<00:21, 18.26it/s] 60%|█████▉    | 585/979 [00:27<00:22, 17.77it/s] 60%|█████▉    | 587/979 [00:27<00:23, 16.98it/s] 60%|██████    | 589/979 [00:27<00:23, 16.77it/s] 60%|██████    | 592/979 [00:27<00:19, 19.53it/s] 61%|██████    | 595/979 [00:27<00:17, 21.74it/s] 61%|██████    | 598/979 [00:28<00:16, 23.47it/s] 61%|██████▏   | 601/979 [00:28<00:15, 24.66it/s] 62%|██████▏   | 604/979 [00:28<00:14, 25.55it/s] 62%|██████▏   | 607/979 [00:28<00:14, 26.17it/s] 62%|██████▏   | 610/979 [00:28<00:13, 26.58it/s] 63%|██████▎   | 613/979 [00:28<00:13, 26.58it/s] 63%|██████▎   | 616/979 [00:28<00:14, 25.45it/s] 63%|██████▎   | 619/979 [00:28<00:14, 25.28it/s] 64%|██████▎   | 622/979 [00:28<00:14, 24.68it/s] 64%|██████▍   | 625/979 [00:29<00:15, 22.56it/s] 64%|██████▍   | 628/979 [00:29<00:14, 23.98it/s] 64%|██████▍   | 631/979 [00:29<00:16, 21.63it/s] 65%|██████▍   | 634/979 [00:29<00:16, 21.10it/s] 65%|██████▌   | 637/979 [00:29<00:17, 19.45it/s] 65%|██████▌   | 640/979 [00:29<00:16, 20.99it/s] 66%|██████▌   | 643/979 [00:29<00:14, 22.67it/s] 66%|██████▌   | 646/979 [00:30<00:13, 24.06it/s] 66%|██████▋   | 649/979 [00:30<00:13, 25.09it/s] 67%|██████▋   | 652/979 [00:30<00:12, 25.96it/s] 67%|██████▋   | 655/979 [00:30<00:12, 26.59it/s] 67%|██████▋   | 658/979 [00:30<00:11, 27.01it/s] 68%|██████▊   | 661/979 [00:30<00:11, 26.88it/s] 68%|██████▊   | 664/979 [00:30<00:11, 26.59it/s] 68%|██████▊   | 667/979 [00:30<00:13, 23.05it/s] 68%|██████▊   | 670/979 [00:31<00:15, 20.43it/s] 69%|██████▊   | 673/979 [00:31<00:16, 19.00it/s] 69%|██████▉   | 676/979 [00:31<00:16, 18.13it/s] 69%|██████▉   | 678/979 [00:31<00:16, 17.71it/s] 69%|██████▉   | 680/979 [00:31<00:17, 16.92it/s] 70%|██████▉   | 683/979 [00:31<00:16, 18.50it/s] 70%|███████   | 686/979 [00:31<00:14, 20.82it/s] 70%|███████   | 689/979 [00:32<00:12, 22.70it/s] 71%|███████   | 692/979 [00:32<00:11, 24.22it/s] 71%|███████   | 695/979 [00:32<00:11, 25.34it/s] 71%|███████▏  | 698/979 [00:32<00:10, 26.19it/s] 72%|███████▏  | 701/979 [00:32<00:10, 26.71it/s] 72%|███████▏  | 704/979 [00:32<00:10, 27.19it/s] 72%|███████▏  | 707/979 [00:32<00:10, 27.02it/s] 73%|███████▎  | 710/979 [00:32<00:09, 27.28it/s] 73%|███████▎  | 713/979 [00:32<00:09, 27.48it/s] 73%|███████▎  | 716/979 [00:33<00:09, 27.65it/s] 73%|███████▎  | 719/979 [00:33<00:09, 27.75it/s] 74%|███████▎  | 722/979 [00:33<00:09, 27.83it/s] 74%|███████▍  | 725/979 [00:33<00:09, 27.86it/s] 74%|███████▍  | 728/979 [00:33<00:09, 27.74it/s] 75%|███████▍  | 731/979 [00:33<00:08, 27.62it/s] 75%|███████▍  | 734/979 [00:33<00:08, 27.27it/s] 75%|███████▌  | 737/979 [00:33<00:08, 27.46it/s] 76%|███████▌  | 740/979 [00:33<00:08, 27.54it/s] 76%|███████▌  | 743/979 [00:34<00:08, 27.66it/s] 76%|███████▌  | 746/979 [00:34<00:08, 27.71it/s] 77%|███████▋  | 749/979 [00:34<00:08, 27.72it/s] 77%|███████▋  | 752/979 [00:34<00:08, 27.75it/s] 77%|███████▋  | 755/979 [00:34<00:08, 27.74it/s] 77%|███████▋  | 758/979 [00:34<00:07, 27.74it/s] 78%|███████▊  | 761/979 [00:34<00:07, 27.68it/s] 78%|███████▊  | 764/979 [00:34<00:07, 27.17it/s] 78%|███████▊  | 767/979 [00:34<00:07, 27.15it/s] 79%|███████▊  | 770/979 [00:34<00:07, 27.26it/s] 79%|███████▉  | 773/979 [00:35<00:07, 27.37it/s] 79%|███████▉  | 776/979 [00:35<00:07, 27.45it/s] 80%|███████▉  | 779/979 [00:35<00:07, 27.54it/s] 80%|███████▉  | 782/979 [00:35<00:07, 27.74it/s] 80%|████████  | 785/979 [00:35<00:06, 28.00it/s] 80%|████████  | 788/979 [00:35<00:06, 28.15it/s] 81%|████████  | 791/979 [00:35<00:06, 26.92it/s] 81%|████████  | 794/979 [00:35<00:06, 27.10it/s] 82%|████████▏ | 798/979 [00:35<00:06, 28.34it/s] 82%|████████▏ | 802/979 [00:36<00:06, 29.16it/s] 82%|████████▏ | 806/979 [00:36<00:05, 29.77it/s] 83%|████████▎ | 810/979 [00:36<00:05, 30.21it/s] 83%|████████▎ | 814/979 [00:36<00:05, 30.58it/s] 84%|████████▎ | 818/979 [00:36<00:05, 30.85it/s] 84%|████████▍ | 822/979 [00:36<00:05, 29.55it/s] 84%|████████▍ | 826/979 [00:36<00:05, 29.71it/s] 85%|████████▍ | 830/979 [00:37<00:04, 30.04it/s] 85%|████████▌ | 834/979 [00:37<00:04, 30.27it/s] 86%|████████▌ | 838/979 [00:37<00:04, 30.47it/s] 86%|████████▌ | 842/979 [00:37<00:04, 30.64it/s] 86%|████████▋ | 846/979 [00:37<00:04, 30.87it/s] 87%|████████▋ | 850/979 [00:37<00:04, 30.91it/s] 87%|████████▋ | 854/979 [00:37<00:04, 30.52it/s] 88%|████████▊ | 858/979 [00:37<00:03, 30.76it/s] 88%|████████▊ | 862/979 [00:38<00:03, 30.97it/s] 88%|████████▊ | 866/979 [00:38<00:03, 31.08it/s] 89%|████████▉ | 870/979 [00:38<00:03, 31.22it/s] 89%|████████▉ | 874/979 [00:38<00:03, 31.34it/s] 90%|████████▉ | 878/979 [00:38<00:03, 31.41it/s] 90%|█████████ | 882/979 [00:38<00:03, 31.45it/s] 91%|█████████ | 886/979 [00:38<00:03, 30.45it/s] 91%|█████████ | 890/979 [00:38<00:02, 30.68it/s] 91%|█████████▏| 894/979 [00:39<00:02, 30.88it/s] 92%|█████████▏| 898/979 [00:39<00:02, 29.72it/s] 92%|█████████▏| 902/979 [00:39<00:02, 30.23it/s] 93%|█████████▎| 906/979 [00:39<00:02, 30.56it/s] 93%|█████████▎| 910/979 [00:39<00:02, 30.78it/s] 93%|█████████▎| 914/979 [00:39<00:02, 30.58it/s] 94%|█████████▍| 918/979 [00:39<00:01, 30.83it/s] 94%|█████████▍| 922/979 [00:40<00:01, 31.02it/s] 95%|█████████▍| 926/979 [00:40<00:01, 31.08it/s] 95%|█████████▍| 930/979 [00:40<00:01, 31.10it/s] 95%|█████████▌| 934/979 [00:40<00:01, 31.37it/s] 96%|█████████▌| 938/979 [00:40<00:01, 31.54it/s] 96%|█████████▌| 942/979 [00:40<00:01, 31.67it/s] 97%|█████████▋| 946/979 [00:40<00:01, 31.21it/s] 97%|█████████▋| 950/979 [00:40<00:00, 29.07it/s] 97%|█████████▋| 953/979 [00:41<00:00, 26.70it/s] 98%|█████████▊| 956/979 [00:41<00:00, 24.11it/s] 98%|█████████▊| 959/979 [00:41<00:00, 22.39it/s] 98%|█████████▊| 962/979 [00:41<00:00, 21.26it/s] 99%|█████████▊| 965/979 [00:41<00:00, 20.50it/s] 99%|█████████▉| 968/979 [00:41<00:00, 19.50it/s] 99%|█████████▉| 971/979 [00:42<00:00, 20.59it/s]100%|█████████▉| 975/979 [00:42<00:00, 23.53it/s]100%|██████████| 979/979 [00:42<00:00, 25.80it/s]100%|██████████| 979/979 [00:42<00:00, 23.16it/s]
time :  1336
prob :  1336
thermal quench :  5.342
current quench:  5.368
