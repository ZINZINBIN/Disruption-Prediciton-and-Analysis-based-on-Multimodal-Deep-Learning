/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_Normal
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.106, valid loss : 0.113, train acc : 0.982, valid acc : 0.982, train f1 : 0.495, valid f1 : 0.495
training process:   2%|▏         | 1/50 [04:07<3:22:00, 247.37s/it]training process:   4%|▍         | 2/50 [07:26<2:55:19, 219.15s/it]training process:   6%|▌         | 3/50 [10:45<2:44:17, 209.73s/it]training process:   8%|▊         | 4/50 [14:02<2:36:54, 204.67s/it]epoch : 5, train loss : 0.073, valid loss : 0.072, train acc : 0.988, valid acc : 0.990, train f1 : 0.771, valid f1 : 0.802
training process:  10%|█         | 5/50 [18:03<2:43:19, 217.76s/it]training process:  12%|█▏        | 6/50 [21:17<2:33:51, 209.80s/it]training process:  14%|█▍        | 7/50 [24:33<2:27:00, 205.13s/it]training process:  16%|█▌        | 8/50 [27:47<2:21:08, 201.62s/it]epoch : 9, train loss : 0.067, valid loss : 0.068, train acc : 0.989, valid acc : 0.990, train f1 : 0.786, valid f1 : 0.811
training process:  18%|█▊        | 9/50 [31:46<2:25:45, 213.31s/it]training process:  20%|██        | 10/50 [35:03<2:18:50, 208.27s/it]training process:  22%|██▏       | 11/50 [38:16<2:12:25, 203.72s/it]training process:  24%|██▍       | 12/50 [41:29<2:06:57, 200.45s/it]epoch : 13, train loss : 0.050, valid loss : 0.044, train acc : 0.991, valid acc : 0.992, train f1 : 0.843, valid f1 : 0.865
training process:  26%|██▌       | 13/50 [45:27<2:10:38, 211.85s/it]training process:  28%|██▊       | 14/50 [48:41<2:03:54, 206.52s/it]training process:  30%|███       | 15/50 [51:56<1:58:22, 202.92s/it]training process:  32%|███▏      | 16/50 [55:08<1:53:05, 199.58s/it]epoch : 17, train loss : 0.036, valid loss : 0.050, train acc : 0.993, valid acc : 0.993, train f1 : 0.891, valid f1 : 0.879
training process:  34%|███▍      | 17/50 [59:05<1:56:00, 210.93s/it]training process:  36%|███▌      | 18/50 [1:02:17<1:49:30, 205.33s/it]training process:  38%|███▊      | 19/50 [1:05:29<1:43:55, 201.16s/it]training process:  40%|████      | 20/50 [1:08:41<1:39:11, 198.40s/it]epoch : 21, train loss : 0.037, valid loss : 0.033, train acc : 0.993, valid acc : 0.996, train f1 : 0.882, valid f1 : 0.929
training process:  42%|████▏     | 21/50 [1:12:36<1:41:16, 209.54s/it]training process:  44%|████▍     | 22/50 [1:15:47<1:35:10, 203.95s/it]training process:  46%|████▌     | 23/50 [1:19:01<1:30:20, 200.78s/it]training process:  48%|████▊     | 24/50 [1:22:13<1:25:52, 198.16s/it]epoch : 25, train loss : 0.031, valid loss : 0.041, train acc : 0.995, valid acc : 0.995, train f1 : 0.913, valid f1 : 0.911
training process:  50%|█████     | 25/50 [1:26:11<1:27:39, 210.37s/it]training process:  52%|█████▏    | 26/50 [1:29:27<1:22:20, 205.84s/it]training process:  54%|█████▍    | 27/50 [1:32:44<1:17:53, 203.21s/it]training process:  56%|█████▌    | 28/50 [1:35:57<1:13:22, 200.10s/it]epoch : 29, train loss : 0.029, valid loss : 0.058, train acc : 0.995, valid acc : 0.990, train f1 : 0.918, valid f1 : 0.862
training process:  58%|█████▊    | 29/50 [1:39:56<1:14:07, 211.76s/it]training process:  60%|██████    | 30/50 [1:43:13<1:09:09, 207.48s/it]training process:  62%|██████▏   | 31/50 [1:46:31<1:04:44, 204.47s/it]training process:  64%|██████▍   | 32/50 [1:49:47<1:00:35, 202.00s/it]epoch : 33, train loss : 0.028, valid loss : 0.043, train acc : 0.995, valid acc : 0.993, train f1 : 0.920, valid f1 : 0.894
training process:  66%|██████▌   | 33/50 [1:53:48<1:00:31, 213.62s/it]training process:  68%|██████▊   | 34/50 [1:56:58<55:08, 206.78s/it]  training process:  70%|███████   | 35/50 [2:00:10<50:33, 202.26s/it]training process:  72%|███████▏  | 36/50 [2:03:21<46:24, 198.88s/it]epoch : 37, train loss : 0.027, valid loss : 0.038, train acc : 0.996, valid acc : 0.995, train f1 : 0.930, valid f1 : 0.921
training process:  74%|███████▍  | 37/50 [2:07:20<45:40, 210.82s/it]training process:  76%|███████▌  | 38/50 [2:10:32<41:04, 205.34s/it]training process:  78%|███████▊  | 39/50 [2:13:47<37:04, 202.23s/it]training process:  80%|████████  | 40/50 [2:17:01<33:17, 199.72s/it]epoch : 41, train loss : 0.026, valid loss : 0.142, train acc : 0.996, valid acc : 0.970, train f1 : 0.931, valid f1 : 0.735
training process:  82%|████████▏ | 41/50 [2:21:00<31:44, 211.58s/it]training process:  84%|████████▍ | 42/50 [2:24:15<27:32, 206.54s/it]training process:  86%|████████▌ | 43/50 [2:27:31<23:42, 203.26s/it]training process:  88%|████████▊ | 44/50 [2:30:45<20:02, 200.42s/it]epoch : 45, train loss : 0.027, valid loss : 0.036, train acc : 0.995, valid acc : 0.995, train f1 : 0.924, valid f1 : 0.916
training process:  90%|█████████ | 45/50 [2:34:44<17:40, 212.18s/it]training process:  92%|█████████▏| 46/50 [2:37:59<13:48, 207.03s/it]training process:  94%|█████████▍| 47/50 [2:41:13<10:09, 203.21s/it]training process:  96%|█████████▌| 48/50 [2:44:26<06:39, 199.90s/it]epoch : 49, train loss : 0.026, valid loss : 0.040, train acc : 0.996, valid acc : 0.992, train f1 : 0.928, valid f1 : 0.888
training process:  98%|█████████▊| 49/50 [2:48:23<03:31, 211.16s/it]training process: 100%|██████████| 50/50 [2:51:35<00:00, 205.42s/it]training process: 100%|██████████| 50/50 [2:51:35<00:00, 205.91s/it]
training process finished, best loss : 0.033 and best acc : 0.996, best f1 : 0.929, best epoch : 20

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.67      0.65      0.66        71
           1       0.99      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.83      0.82      0.83      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.83, test AUC : 0.82, test loss : 1.147

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:41, 23.40it/s]  1%|          | 6/981 [00:00<00:39, 24.38it/s]  1%|          | 9/981 [00:00<00:39, 24.54it/s]  1%|          | 12/981 [00:00<00:38, 24.87it/s]  2%|▏         | 15/981 [00:00<00:38, 24.96it/s]  2%|▏         | 18/981 [00:00<00:38, 25.02it/s]  2%|▏         | 21/981 [00:00<00:38, 25.01it/s]  2%|▏         | 24/981 [00:00<00:38, 24.98it/s]  3%|▎         | 27/981 [00:01<00:38, 24.92it/s]  3%|▎         | 30/981 [00:01<00:38, 24.99it/s]  3%|▎         | 33/981 [00:01<00:37, 25.08it/s]  4%|▎         | 36/981 [00:01<00:37, 25.03it/s]  4%|▍         | 39/981 [00:01<00:37, 25.11it/s]  4%|▍         | 42/981 [00:01<00:37, 25.09it/s]  5%|▍         | 45/981 [00:01<00:37, 25.00it/s]  5%|▍         | 48/981 [00:01<00:37, 24.97it/s]  5%|▌         | 51/981 [00:02<00:37, 24.95it/s]  6%|▌         | 54/981 [00:02<00:37, 24.65it/s]  6%|▌         | 57/981 [00:02<00:37, 24.69it/s]  6%|▌         | 60/981 [00:02<00:36, 24.94it/s]  6%|▋         | 63/981 [00:02<00:36, 24.86it/s]  7%|▋         | 66/981 [00:02<00:36, 24.89it/s]  7%|▋         | 69/981 [00:02<00:36, 24.93it/s]  7%|▋         | 72/981 [00:02<00:36, 25.06it/s]  8%|▊         | 75/981 [00:03<00:36, 24.74it/s]  8%|▊         | 78/981 [00:03<00:36, 24.80it/s]  8%|▊         | 81/981 [00:03<00:36, 24.78it/s]  9%|▊         | 84/981 [00:03<00:36, 24.82it/s]  9%|▉         | 87/981 [00:03<00:35, 24.84it/s]  9%|▉         | 90/981 [00:03<00:35, 24.83it/s]  9%|▉         | 93/981 [00:03<00:35, 24.74it/s] 10%|▉         | 96/981 [00:03<00:35, 24.80it/s] 10%|█         | 99/981 [00:03<00:35, 24.53it/s] 10%|█         | 102/981 [00:04<00:35, 24.58it/s] 11%|█         | 105/981 [00:04<00:35, 24.64it/s] 11%|█         | 108/981 [00:04<00:35, 24.66it/s] 11%|█▏        | 111/981 [00:04<00:35, 24.60it/s] 12%|█▏        | 114/981 [00:04<00:35, 24.38it/s] 12%|█▏        | 117/981 [00:04<00:35, 24.49it/s] 12%|█▏        | 120/981 [00:04<00:35, 24.26it/s] 13%|█▎        | 123/981 [00:04<00:35, 24.35it/s] 13%|█▎        | 126/981 [00:05<00:34, 24.45it/s] 13%|█▎        | 129/981 [00:05<00:34, 24.49it/s] 13%|█▎        | 132/981 [00:05<00:34, 24.48it/s] 14%|█▍        | 135/981 [00:05<00:34, 24.64it/s] 14%|█▍        | 138/981 [00:05<00:34, 24.68it/s] 14%|█▍        | 141/981 [00:05<00:34, 24.12it/s] 15%|█▍        | 144/981 [00:05<00:34, 24.32it/s] 15%|█▍        | 147/981 [00:05<00:34, 24.43it/s] 15%|█▌        | 150/981 [00:06<00:34, 24.16it/s] 16%|█▌        | 153/981 [00:06<00:33, 24.36it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.52it/s] 16%|█▌        | 159/981 [00:06<00:33, 24.39it/s] 17%|█▋        | 162/981 [00:06<00:33, 24.55it/s] 17%|█▋        | 165/981 [00:06<00:32, 24.76it/s] 17%|█▋        | 168/981 [00:06<00:32, 24.76it/s] 17%|█▋        | 171/981 [00:06<00:32, 24.90it/s] 18%|█▊        | 174/981 [00:07<00:32, 24.80it/s] 18%|█▊        | 177/981 [00:07<00:32, 24.76it/s] 18%|█▊        | 180/981 [00:07<00:32, 24.55it/s] 19%|█▊        | 183/981 [00:07<00:32, 24.61it/s] 19%|█▉        | 186/981 [00:07<00:32, 24.64it/s] 19%|█▉        | 189/981 [00:07<00:32, 24.71it/s] 20%|█▉        | 192/981 [00:07<00:31, 24.76it/s] 20%|█▉        | 195/981 [00:07<00:31, 24.72it/s] 20%|██        | 198/981 [00:08<00:31, 24.63it/s] 20%|██        | 201/981 [00:08<00:31, 24.43it/s] 21%|██        | 204/981 [00:08<00:31, 24.47it/s] 21%|██        | 207/981 [00:08<00:31, 24.59it/s] 21%|██▏       | 210/981 [00:08<00:31, 24.45it/s] 22%|██▏       | 213/981 [00:08<00:31, 24.45it/s] 22%|██▏       | 216/981 [00:08<00:31, 24.43it/s] 22%|██▏       | 219/981 [00:08<00:31, 24.55it/s] 23%|██▎       | 222/981 [00:09<00:31, 24.38it/s] 23%|██▎       | 225/981 [00:09<00:31, 24.31it/s] 23%|██▎       | 228/981 [00:09<00:31, 24.16it/s] 24%|██▎       | 231/981 [00:09<00:31, 24.08it/s] 24%|██▍       | 234/981 [00:09<00:30, 24.19it/s] 24%|██▍       | 237/981 [00:09<00:30, 24.32it/s] 24%|██▍       | 240/981 [00:09<00:30, 24.07it/s] 25%|██▍       | 243/981 [00:09<00:30, 23.81it/s] 25%|██▌       | 246/981 [00:10<00:30, 23.91it/s] 25%|██▌       | 249/981 [00:10<00:30, 24.19it/s] 26%|██▌       | 252/981 [00:10<00:29, 24.33it/s] 26%|██▌       | 255/981 [00:10<00:30, 24.16it/s] 26%|██▋       | 258/981 [00:10<00:30, 23.76it/s] 27%|██▋       | 261/981 [00:10<00:30, 23.87it/s] 27%|██▋       | 264/981 [00:10<00:29, 24.18it/s] 27%|██▋       | 267/981 [00:10<00:29, 24.33it/s] 28%|██▊       | 270/981 [00:10<00:29, 24.47it/s] 28%|██▊       | 273/981 [00:11<00:28, 24.66it/s] 28%|██▊       | 276/981 [00:11<00:28, 24.71it/s] 28%|██▊       | 279/981 [00:11<00:28, 24.73it/s] 29%|██▊       | 282/981 [00:11<00:28, 24.83it/s] 29%|██▉       | 285/981 [00:11<00:27, 24.90it/s] 29%|██▉       | 288/981 [00:11<00:27, 24.95it/s] 30%|██▉       | 291/981 [00:11<00:27, 25.01it/s] 30%|██▉       | 294/981 [00:11<00:27, 24.95it/s] 30%|███       | 297/981 [00:12<00:27, 24.97it/s] 31%|███       | 300/981 [00:12<00:27, 25.00it/s] 31%|███       | 303/981 [00:12<00:27, 25.04it/s] 31%|███       | 306/981 [00:12<00:26, 25.07it/s] 31%|███▏      | 309/981 [00:12<00:26, 25.05it/s] 32%|███▏      | 312/981 [00:12<00:26, 24.94it/s] 32%|███▏      | 315/981 [00:12<00:26, 24.97it/s] 32%|███▏      | 318/981 [00:12<00:26, 24.86it/s] 33%|███▎      | 321/981 [00:13<00:26, 24.83it/s] 33%|███▎      | 324/981 [00:13<00:26, 24.79it/s] 33%|███▎      | 327/981 [00:13<00:26, 24.86it/s] 34%|███▎      | 330/981 [00:13<00:26, 24.80it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.78it/s] 34%|███▍      | 336/981 [00:13<00:25, 24.85it/s] 35%|███▍      | 339/981 [00:13<00:25, 24.91it/s] 35%|███▍      | 342/981 [00:13<00:25, 24.93it/s] 35%|███▌      | 345/981 [00:13<00:25, 24.87it/s] 35%|███▌      | 348/981 [00:14<00:25, 24.83it/s] 36%|███▌      | 351/981 [00:14<00:25, 24.85it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.66it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.65it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.72it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.71it/s] 37%|███▋      | 366/981 [00:14<00:24, 24.68it/s] 38%|███▊      | 369/981 [00:14<00:24, 24.66it/s] 38%|███▊      | 372/981 [00:15<00:25, 24.30it/s] 38%|███▊      | 375/981 [00:15<00:24, 24.34it/s] 39%|███▊      | 378/981 [00:15<00:24, 24.33it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.43it/s] 39%|███▉      | 384/981 [00:15<00:24, 24.54it/s] 39%|███▉      | 387/981 [00:15<00:24, 24.56it/s] 40%|███▉      | 390/981 [00:15<00:23, 24.69it/s] 40%|████      | 393/981 [00:15<00:23, 24.72it/s] 40%|████      | 396/981 [00:16<00:23, 24.68it/s] 41%|████      | 399/981 [00:16<00:23, 24.73it/s] 41%|████      | 402/981 [00:16<00:23, 24.63it/s] 41%|████▏     | 405/981 [00:16<00:23, 24.50it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.59it/s] 42%|████▏     | 411/981 [00:16<00:23, 24.69it/s] 42%|████▏     | 414/981 [00:16<00:22, 24.79it/s] 43%|████▎     | 417/981 [00:16<00:22, 24.85it/s] 43%|████▎     | 420/981 [00:17<00:22, 24.86it/s] 43%|████▎     | 423/981 [00:17<00:22, 24.86it/s] 43%|████▎     | 426/981 [00:17<00:22, 24.84it/s] 44%|████▎     | 429/981 [00:17<00:22, 24.82it/s] 44%|████▍     | 432/981 [00:17<00:22, 24.85it/s] 44%|████▍     | 435/981 [00:17<00:21, 24.92it/s] 45%|████▍     | 438/981 [00:17<00:21, 24.87it/s] 45%|████▍     | 441/981 [00:17<00:21, 24.85it/s] 45%|████▌     | 444/981 [00:18<00:21, 24.85it/s] 46%|████▌     | 447/981 [00:18<00:21, 24.87it/s] 46%|████▌     | 450/981 [00:18<00:21, 24.89it/s] 46%|████▌     | 453/981 [00:18<00:21, 24.85it/s] 46%|████▋     | 456/981 [00:18<00:21, 24.88it/s] 47%|████▋     | 459/981 [00:18<00:21, 24.84it/s] 47%|████▋     | 462/981 [00:18<00:20, 24.89it/s] 47%|████▋     | 465/981 [00:18<00:20, 25.04it/s] 48%|████▊     | 468/981 [00:18<00:20, 25.09it/s] 48%|████▊     | 471/981 [00:19<00:20, 25.11it/s] 48%|████▊     | 474/981 [00:19<00:20, 25.20it/s] 49%|████▊     | 477/981 [00:19<00:19, 25.29it/s] 49%|████▉     | 480/981 [00:19<00:19, 25.22it/s] 49%|████▉     | 483/981 [00:19<00:19, 25.08it/s] 50%|████▉     | 486/981 [00:19<00:19, 25.06it/s] 50%|████▉     | 489/981 [00:19<00:19, 25.07it/s] 50%|█████     | 492/981 [00:19<00:19, 24.97it/s] 50%|█████     | 495/981 [00:20<00:19, 24.94it/s] 51%|█████     | 498/981 [00:20<00:19, 24.95it/s] 51%|█████     | 501/981 [00:20<00:19, 24.95it/s] 51%|█████▏    | 504/981 [00:20<00:19, 25.03it/s] 52%|█████▏    | 507/981 [00:20<00:18, 25.00it/s] 52%|█████▏    | 510/981 [00:20<00:18, 25.10it/s] 52%|█████▏    | 513/981 [00:20<00:18, 25.21it/s] 53%|█████▎    | 516/981 [00:20<00:18, 25.30it/s] 53%|█████▎    | 519/981 [00:20<00:18, 25.36it/s] 53%|█████▎    | 522/981 [00:21<00:18, 25.42it/s] 54%|█████▎    | 525/981 [00:21<00:17, 25.48it/s] 54%|█████▍    | 528/981 [00:21<00:17, 25.63it/s] 54%|█████▍    | 531/981 [00:21<00:17, 25.61it/s] 54%|█████▍    | 534/981 [00:21<00:17, 25.61it/s] 55%|█████▍    | 537/981 [00:21<00:17, 25.67it/s] 55%|█████▌    | 540/981 [00:21<00:17, 25.67it/s] 55%|█████▌    | 543/981 [00:21<00:17, 25.60it/s] 56%|█████▌    | 546/981 [00:22<00:17, 25.27it/s] 56%|█████▌    | 549/981 [00:22<00:17, 25.30it/s] 56%|█████▋    | 552/981 [00:22<00:16, 25.51it/s] 57%|█████▋    | 555/981 [00:22<00:16, 25.84it/s] 57%|█████▋    | 558/981 [00:22<00:16, 25.96it/s] 57%|█████▋    | 561/981 [00:22<00:16, 26.03it/s] 57%|█████▋    | 564/981 [00:22<00:16, 25.95it/s] 58%|█████▊    | 567/981 [00:22<00:16, 25.78it/s] 58%|█████▊    | 570/981 [00:22<00:15, 25.74it/s] 58%|█████▊    | 573/981 [00:23<00:15, 25.78it/s] 59%|█████▊    | 576/981 [00:23<00:15, 25.76it/s] 59%|█████▉    | 579/981 [00:23<00:15, 25.74it/s] 59%|█████▉    | 582/981 [00:23<00:15, 25.75it/s] 60%|█████▉    | 585/981 [00:23<00:15, 25.69it/s] 60%|█████▉    | 588/981 [00:23<00:15, 25.75it/s] 60%|██████    | 591/981 [00:23<00:15, 25.80it/s] 61%|██████    | 594/981 [00:23<00:14, 25.90it/s] 61%|██████    | 597/981 [00:24<00:14, 25.92it/s] 61%|██████    | 600/981 [00:24<00:14, 25.93it/s] 61%|██████▏   | 603/981 [00:24<00:14, 25.83it/s] 62%|██████▏   | 606/981 [00:24<00:14, 25.90it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.96it/s] 62%|██████▏   | 612/981 [00:24<00:14, 26.00it/s] 63%|██████▎   | 615/981 [00:24<00:14, 26.13it/s] 63%|██████▎   | 618/981 [00:24<00:13, 26.03it/s] 63%|██████▎   | 621/981 [00:24<00:13, 25.89it/s] 64%|██████▎   | 624/981 [00:25<00:13, 25.95it/s] 64%|██████▍   | 627/981 [00:25<00:13, 25.92it/s] 64%|██████▍   | 630/981 [00:25<00:13, 25.96it/s] 65%|██████▍   | 633/981 [00:25<00:13, 25.99it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.94it/s] 65%|██████▌   | 639/981 [00:25<00:13, 25.85it/s] 65%|██████▌   | 642/981 [00:25<00:13, 25.78it/s] 66%|██████▌   | 645/981 [00:25<00:13, 25.72it/s] 66%|██████▌   | 648/981 [00:25<00:12, 25.70it/s] 66%|██████▋   | 651/981 [00:26<00:12, 25.71it/s] 67%|██████▋   | 654/981 [00:26<00:12, 25.68it/s] 67%|██████▋   | 657/981 [00:26<00:12, 25.76it/s] 67%|██████▋   | 660/981 [00:26<00:12, 25.79it/s] 68%|██████▊   | 663/981 [00:26<00:12, 25.73it/s] 68%|██████▊   | 666/981 [00:26<00:12, 25.76it/s] 68%|██████▊   | 669/981 [00:26<00:12, 25.74it/s] 69%|██████▊   | 672/981 [00:26<00:12, 25.74it/s] 69%|██████▉   | 675/981 [00:27<00:11, 25.72it/s] 69%|██████▉   | 678/981 [00:27<00:11, 25.83it/s] 69%|██████▉   | 681/981 [00:27<00:11, 25.76it/s] 70%|██████▉   | 684/981 [00:27<00:11, 25.39it/s] 70%|███████   | 687/981 [00:27<00:11, 25.33it/s] 70%|███████   | 690/981 [00:27<00:11, 25.14it/s] 71%|███████   | 693/981 [00:27<00:11, 25.25it/s] 71%|███████   | 696/981 [00:27<00:11, 25.17it/s] 71%|███████▏  | 699/981 [00:27<00:11, 25.38it/s] 72%|███████▏  | 702/981 [00:28<00:10, 25.39it/s] 72%|███████▏  | 705/981 [00:28<00:10, 25.41it/s] 72%|███████▏  | 708/981 [00:28<00:10, 25.52it/s] 72%|███████▏  | 711/981 [00:28<00:10, 25.57it/s] 73%|███████▎  | 714/981 [00:28<00:10, 25.65it/s] 73%|███████▎  | 717/981 [00:28<00:10, 25.68it/s] 73%|███████▎  | 720/981 [00:28<00:10, 25.89it/s] 74%|███████▎  | 723/981 [00:28<00:09, 25.91it/s] 74%|███████▍  | 726/981 [00:29<00:10, 25.42it/s] 74%|███████▍  | 729/981 [00:29<00:09, 25.46it/s] 75%|███████▍  | 732/981 [00:29<00:09, 25.38it/s] 75%|███████▍  | 735/981 [00:29<00:09, 25.63it/s] 75%|███████▌  | 738/981 [00:29<00:09, 25.73it/s] 76%|███████▌  | 741/981 [00:29<00:09, 25.75it/s] 76%|███████▌  | 744/981 [00:29<00:09, 25.70it/s] 76%|███████▌  | 747/981 [00:29<00:09, 25.67it/s] 76%|███████▋  | 750/981 [00:29<00:09, 25.60it/s] 77%|███████▋  | 753/981 [00:30<00:08, 25.57it/s] 77%|███████▋  | 756/981 [00:30<00:08, 25.56it/s] 77%|███████▋  | 759/981 [00:30<00:08, 25.61it/s] 78%|███████▊  | 762/981 [00:30<00:08, 25.61it/s] 78%|███████▊  | 765/981 [00:30<00:08, 25.29it/s] 78%|███████▊  | 768/981 [00:30<00:08, 25.39it/s] 79%|███████▊  | 771/981 [00:30<00:08, 25.44it/s] 79%|███████▉  | 774/981 [00:30<00:08, 25.35it/s] 79%|███████▉  | 777/981 [00:31<00:08, 25.28it/s] 80%|███████▉  | 780/981 [00:31<00:07, 25.42it/s] 80%|███████▉  | 783/981 [00:31<00:07, 25.61it/s] 80%|████████  | 786/981 [00:31<00:07, 25.97it/s] 80%|████████  | 789/981 [00:31<00:07, 26.38it/s] 81%|████████  | 792/981 [00:31<00:07, 26.85it/s] 81%|████████  | 795/981 [00:31<00:06, 27.36it/s] 81%|████████▏ | 798/981 [00:31<00:06, 27.89it/s] 82%|████████▏ | 801/981 [00:31<00:06, 28.25it/s] 82%|████████▏ | 804/981 [00:32<00:06, 28.41it/s] 82%|████████▏ | 807/981 [00:32<00:06, 28.81it/s] 83%|████████▎ | 810/981 [00:32<00:05, 28.97it/s] 83%|████████▎ | 813/981 [00:32<00:05, 29.03it/s] 83%|████████▎ | 816/981 [00:32<00:05, 29.21it/s] 83%|████████▎ | 819/981 [00:32<00:05, 29.29it/s] 84%|████████▍ | 822/981 [00:32<00:05, 29.34it/s] 84%|████████▍ | 825/981 [00:32<00:05, 29.42it/s] 84%|████████▍ | 828/981 [00:32<00:05, 29.49it/s] 85%|████████▍ | 831/981 [00:32<00:05, 29.46it/s] 85%|████████▌ | 834/981 [00:33<00:04, 29.41it/s] 85%|████████▌ | 837/981 [00:33<00:04, 29.50it/s] 86%|████████▌ | 840/981 [00:33<00:04, 29.50it/s] 86%|████████▌ | 843/981 [00:33<00:04, 29.61it/s] 86%|████████▌ | 846/981 [00:33<00:04, 29.61it/s] 87%|████████▋ | 849/981 [00:33<00:04, 29.52it/s] 87%|████████▋ | 852/981 [00:33<00:04, 29.56it/s] 87%|████████▋ | 855/981 [00:33<00:04, 29.64it/s] 87%|████████▋ | 858/981 [00:33<00:04, 29.71it/s] 88%|████████▊ | 861/981 [00:33<00:04, 29.71it/s] 88%|████████▊ | 864/981 [00:34<00:03, 29.44it/s] 88%|████████▊ | 867/981 [00:34<00:03, 29.19it/s] 89%|████████▊ | 870/981 [00:34<00:03, 28.97it/s] 89%|████████▉ | 873/981 [00:34<00:03, 29.15it/s] 89%|████████▉ | 876/981 [00:34<00:03, 29.27it/s] 90%|████████▉ | 879/981 [00:34<00:03, 29.36it/s] 90%|████████▉ | 882/981 [00:34<00:03, 29.50it/s] 90%|█████████ | 885/981 [00:34<00:03, 29.51it/s] 91%|█████████ | 888/981 [00:34<00:03, 29.60it/s] 91%|█████████ | 891/981 [00:34<00:03, 29.62it/s] 91%|█████████ | 894/981 [00:35<00:02, 29.67it/s] 91%|█████████▏| 897/981 [00:35<00:02, 29.72it/s] 92%|█████████▏| 900/981 [00:35<00:02, 29.74it/s] 92%|█████████▏| 903/981 [00:35<00:02, 29.72it/s] 92%|█████████▏| 906/981 [00:35<00:02, 29.79it/s] 93%|█████████▎| 909/981 [00:35<00:02, 29.64it/s] 93%|█████████▎| 912/981 [00:35<00:02, 29.70it/s] 93%|█████████▎| 915/981 [00:35<00:02, 29.67it/s] 94%|█████████▎| 918/981 [00:35<00:02, 28.94it/s] 94%|█████████▍| 921/981 [00:35<00:02, 29.03it/s] 94%|█████████▍| 924/981 [00:36<00:01, 29.28it/s] 95%|█████████▍| 928/981 [00:36<00:01, 29.73it/s] 95%|█████████▍| 931/981 [00:36<00:01, 29.79it/s] 95%|█████████▌| 935/981 [00:36<00:01, 30.03it/s] 96%|█████████▌| 939/981 [00:36<00:01, 30.21it/s] 96%|█████████▌| 943/981 [00:36<00:01, 30.27it/s] 97%|█████████▋| 947/981 [00:36<00:01, 30.31it/s] 97%|█████████▋| 951/981 [00:36<00:00, 30.32it/s] 97%|█████████▋| 955/981 [00:37<00:00, 30.24it/s] 98%|█████████▊| 959/981 [00:37<00:00, 30.10it/s] 98%|█████████▊| 963/981 [00:37<00:00, 30.05it/s] 99%|█████████▊| 967/981 [00:37<00:00, 29.90it/s] 99%|█████████▉| 970/981 [00:37<00:00, 29.86it/s] 99%|█████████▉| 973/981 [00:37<00:00, 29.68it/s] 99%|█████████▉| 976/981 [00:37<00:00, 29.61it/s]100%|█████████▉| 979/981 [00:37<00:00, 29.55it/s]100%|██████████| 981/981 [00:37<00:00, 25.82it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_RS
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.295, valid loss : 0.066, train acc : 0.857, valid acc : 0.984, train f1 : 0.857, valid f1 : 0.829
training process:   2%|▏         | 1/50 [04:02<3:18:21, 242.88s/it]training process:   4%|▍         | 2/50 [07:15<2:50:32, 213.19s/it]training process:   6%|▌         | 3/50 [10:28<2:39:59, 204.24s/it]training process:   8%|▊         | 4/50 [13:42<2:33:26, 200.15s/it]epoch : 5, train loss : 0.144, valid loss : 0.048, train acc : 0.941, valid acc : 0.992, train f1 : 0.941, valid f1 : 0.896
training process:  10%|█         | 5/50 [17:42<2:40:47, 214.39s/it]training process:  12%|█▏        | 6/50 [20:57<2:32:31, 208.00s/it]training process:  14%|█▍        | 7/50 [24:12<2:26:00, 203.73s/it]training process:  16%|█▌        | 8/50 [27:25<2:20:08, 200.20s/it]epoch : 9, train loss : 0.127, valid loss : 0.176, train acc : 0.953, valid acc : 0.932, train f1 : 0.953, valid f1 : 0.651
training process:  18%|█▊        | 9/50 [31:26<2:25:34, 213.03s/it]training process:  20%|██        | 10/50 [34:42<2:18:23, 207.58s/it]training process:  22%|██▏       | 11/50 [37:56<2:12:11, 203.38s/it]training process:  24%|██▍       | 12/50 [41:11<2:07:22, 201.12s/it]epoch : 13, train loss : 0.111, valid loss : 0.083, train acc : 0.956, valid acc : 0.959, train f1 : 0.956, valid f1 : 0.720
training process:  26%|██▌       | 13/50 [45:12<2:11:21, 213.01s/it]training process:  28%|██▊       | 14/50 [48:25<2:04:13, 207.03s/it]training process:  30%|███       | 15/50 [51:37<1:58:02, 202.36s/it]training process:  32%|███▏      | 16/50 [54:47<1:52:33, 198.65s/it]epoch : 17, train loss : 0.110, valid loss : 0.076, train acc : 0.957, valid acc : 0.961, train f1 : 0.957, valid f1 : 0.721
training process:  34%|███▍      | 17/50 [58:43<1:55:29, 209.99s/it]training process:  36%|███▌      | 18/50 [1:01:54<1:49:00, 204.38s/it]training process:  38%|███▊      | 19/50 [1:05:06<1:43:36, 200.53s/it]training process:  40%|████      | 20/50 [1:08:16<1:38:46, 197.55s/it]epoch : 21, train loss : 0.104, valid loss : 0.101, train acc : 0.959, valid acc : 0.958, train f1 : 0.959, valid f1 : 0.714
training process:  42%|████▏     | 21/50 [1:12:17<1:41:41, 210.41s/it]training process:  44%|████▍     | 22/50 [1:15:29<1:35:40, 205.02s/it]training process:  46%|████▌     | 23/50 [1:18:45<1:30:56, 202.09s/it]training process:  48%|████▊     | 24/50 [1:21:59<1:26:32, 199.71s/it]epoch : 25, train loss : 0.099, valid loss : 0.068, train acc : 0.963, valid acc : 0.989, train f1 : 0.963, valid f1 : 0.875
training process:  50%|█████     | 25/50 [1:25:56<1:27:55, 211.03s/it]training process:  52%|█████▏    | 26/50 [1:29:09<1:22:14, 205.59s/it]training process:  54%|█████▍    | 27/50 [1:32:28<1:18:00, 203.50s/it]training process:  56%|█████▌    | 28/50 [1:35:45<1:13:54, 201.57s/it]epoch : 29, train loss : 0.077, valid loss : 0.078, train acc : 0.967, valid acc : 0.968, train f1 : 0.967, valid f1 : 0.750
training process:  58%|█████▊    | 29/50 [1:39:43<1:14:24, 212.58s/it]training process:  60%|██████    | 30/50 [1:42:58<1:09:03, 207.17s/it]training process:  62%|██████▏   | 31/50 [1:46:10<1:04:12, 202.77s/it]training process:  64%|██████▍   | 32/50 [1:49:24<1:00:03, 200.21s/it]epoch : 33, train loss : 0.083, valid loss : 0.061, train acc : 0.965, valid acc : 0.977, train f1 : 0.965, valid f1 : 0.791
training process:  66%|██████▌   | 33/50 [1:53:23<59:58, 211.70s/it]  training process:  68%|██████▊   | 34/50 [1:56:40<55:15, 207.22s/it]training process:  70%|███████   | 35/50 [1:59:53<50:44, 202.97s/it]training process:  72%|███████▏  | 36/50 [2:03:06<46:41, 200.12s/it]epoch : 37, train loss : 0.085, valid loss : 0.049, train acc : 0.965, valid acc : 0.987, train f1 : 0.965, valid f1 : 0.853
training process:  74%|███████▍  | 37/50 [2:07:06<45:58, 212.19s/it]training process:  76%|███████▌  | 38/50 [2:10:22<41:25, 207.16s/it]training process:  78%|███████▊  | 39/50 [2:13:38<37:22, 203.88s/it]training process:  80%|████████  | 40/50 [2:16:53<33:31, 201.13s/it]epoch : 41, train loss : 0.075, valid loss : 0.083, train acc : 0.968, valid acc : 0.968, train f1 : 0.968, valid f1 : 0.745
training process:  82%|████████▏ | 41/50 [2:20:52<31:52, 212.48s/it]training process:  84%|████████▍ | 42/50 [2:24:08<27:41, 207.72s/it]training process:  86%|████████▌ | 43/50 [2:27:24<23:49, 204.18s/it]training process:  88%|████████▊ | 44/50 [2:30:42<20:12, 202.16s/it]epoch : 45, train loss : 0.076, valid loss : 0.076, train acc : 0.970, valid acc : 0.974, train f1 : 0.970, valid f1 : 0.765
training process:  90%|█████████ | 45/50 [2:34:45<17:52, 214.59s/it]training process:  92%|█████████▏| 46/50 [2:38:06<14:02, 210.52s/it]training process:  94%|█████████▍| 47/50 [2:41:21<10:17, 205.74s/it]training process:  96%|█████████▌| 48/50 [2:44:35<06:44, 202.27s/it]epoch : 49, train loss : 0.066, valid loss : 0.088, train acc : 0.970, valid acc : 0.964, train f1 : 0.970, valid f1 : 0.733
training process:  98%|█████████▊| 49/50 [2:48:34<03:33, 213.27s/it]training process: 100%|██████████| 50/50 [2:51:49<00:00, 207.78s/it]training process: 100%|██████████| 50/50 [2:51:49<00:00, 206.19s/it]
training process finished, best loss : 0.048 and best acc : 0.992, best f1 : 0.896, best epoch : 4

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.57      0.89      0.70        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.79      0.94      0.84      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.84, test AUC : 0.94, test loss : 1.458

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:40, 24.05it/s]  1%|          | 6/981 [00:00<00:39, 24.96it/s]  1%|          | 9/981 [00:00<00:37, 25.60it/s]  1%|          | 12/981 [00:00<00:37, 25.64it/s]  2%|▏         | 15/981 [00:00<00:37, 25.61it/s]  2%|▏         | 18/981 [00:00<00:37, 25.68it/s]  2%|▏         | 21/981 [00:00<00:37, 25.62it/s]  2%|▏         | 24/981 [00:00<00:37, 25.66it/s]  3%|▎         | 27/981 [00:01<00:37, 25.57it/s]  3%|▎         | 30/981 [00:01<00:37, 25.67it/s]  3%|▎         | 33/981 [00:01<00:36, 25.72it/s]  4%|▎         | 36/981 [00:01<00:36, 25.76it/s]  4%|▍         | 39/981 [00:01<00:36, 25.76it/s]  4%|▍         | 42/981 [00:01<00:36, 25.81it/s]  5%|▍         | 45/981 [00:01<00:36, 25.72it/s]  5%|▍         | 48/981 [00:01<00:36, 25.82it/s]  5%|▌         | 51/981 [00:01<00:36, 25.64it/s]  6%|▌         | 54/981 [00:02<00:36, 25.60it/s]  6%|▌         | 57/981 [00:02<00:36, 25.52it/s]  6%|▌         | 60/981 [00:02<00:36, 25.53it/s]  6%|▋         | 63/981 [00:02<00:36, 25.49it/s]  7%|▋         | 66/981 [00:02<00:35, 25.50it/s]  7%|▋         | 69/981 [00:02<00:35, 25.73it/s]  7%|▋         | 72/981 [00:02<00:35, 25.34it/s]  8%|▊         | 75/981 [00:02<00:35, 25.63it/s]  8%|▊         | 78/981 [00:03<00:35, 25.40it/s]  8%|▊         | 81/981 [00:03<00:35, 25.45it/s]  9%|▊         | 84/981 [00:03<00:35, 25.45it/s]  9%|▉         | 87/981 [00:03<00:35, 25.52it/s]  9%|▉         | 90/981 [00:03<00:34, 25.59it/s]  9%|▉         | 93/981 [00:03<00:34, 25.55it/s] 10%|▉         | 96/981 [00:03<00:34, 25.65it/s] 10%|█         | 99/981 [00:03<00:34, 25.62it/s] 10%|█         | 102/981 [00:03<00:34, 25.60it/s] 11%|█         | 105/981 [00:04<00:34, 25.50it/s] 11%|█         | 108/981 [00:04<00:34, 25.36it/s] 11%|█▏        | 111/981 [00:04<00:34, 25.45it/s] 12%|█▏        | 114/981 [00:04<00:34, 25.28it/s] 12%|█▏        | 117/981 [00:04<00:34, 25.39it/s] 12%|█▏        | 120/981 [00:04<00:34, 25.31it/s] 13%|█▎        | 123/981 [00:04<00:33, 25.35it/s] 13%|█▎        | 126/981 [00:04<00:33, 25.39it/s] 13%|█▎        | 129/981 [00:05<00:33, 25.34it/s] 13%|█▎        | 132/981 [00:05<00:33, 25.56it/s] 14%|█▍        | 135/981 [00:05<00:33, 25.56it/s] 14%|█▍        | 138/981 [00:05<00:32, 25.56it/s] 14%|█▍        | 141/981 [00:05<00:32, 25.52it/s] 15%|█▍        | 144/981 [00:05<00:32, 25.60it/s] 15%|█▍        | 147/981 [00:05<00:32, 25.62it/s] 15%|█▌        | 150/981 [00:05<00:32, 25.54it/s] 16%|█▌        | 153/981 [00:05<00:32, 25.50it/s] 16%|█▌        | 156/981 [00:06<00:32, 25.74it/s] 16%|█▌        | 159/981 [00:06<00:32, 25.62it/s] 17%|█▋        | 162/981 [00:06<00:31, 25.78it/s] 17%|█▋        | 165/981 [00:06<00:31, 25.75it/s] 17%|█▋        | 168/981 [00:06<00:31, 25.76it/s] 17%|█▋        | 171/981 [00:06<00:31, 25.77it/s] 18%|█▊        | 174/981 [00:06<00:31, 25.77it/s] 18%|█▊        | 177/981 [00:06<00:31, 25.70it/s] 18%|█▊        | 180/981 [00:07<00:31, 25.66it/s] 19%|█▊        | 183/981 [00:07<00:30, 25.87it/s] 19%|█▉        | 186/981 [00:07<00:30, 26.10it/s] 19%|█▉        | 189/981 [00:07<00:30, 26.21it/s] 20%|█▉        | 192/981 [00:07<00:30, 26.25it/s] 20%|█▉        | 195/981 [00:07<00:29, 26.27it/s] 20%|██        | 198/981 [00:07<00:31, 25.12it/s] 20%|██        | 201/981 [00:07<00:30, 25.33it/s] 21%|██        | 204/981 [00:07<00:30, 25.54it/s] 21%|██        | 207/981 [00:08<00:30, 25.63it/s] 21%|██▏       | 210/981 [00:08<00:30, 25.67it/s] 22%|██▏       | 213/981 [00:08<00:29, 25.67it/s] 22%|██▏       | 216/981 [00:08<00:30, 25.47it/s] 22%|██▏       | 219/981 [00:08<00:30, 25.22it/s] 23%|██▎       | 222/981 [00:08<00:30, 25.15it/s] 23%|██▎       | 225/981 [00:08<00:30, 25.20it/s] 23%|██▎       | 228/981 [00:08<00:29, 25.12it/s] 24%|██▎       | 231/981 [00:09<00:30, 24.99it/s] 24%|██▍       | 234/981 [00:09<00:29, 24.95it/s] 24%|██▍       | 237/981 [00:09<00:29, 24.97it/s] 24%|██▍       | 240/981 [00:09<00:29, 24.91it/s] 25%|██▍       | 243/981 [00:09<00:29, 24.89it/s] 25%|██▌       | 246/981 [00:09<00:29, 24.83it/s] 25%|██▌       | 249/981 [00:09<00:30, 24.32it/s] 26%|██▌       | 252/981 [00:09<00:30, 23.98it/s] 26%|██▌       | 255/981 [00:10<00:29, 24.29it/s] 26%|██▋       | 258/981 [00:10<00:29, 24.60it/s] 27%|██▋       | 261/981 [00:10<00:29, 24.62it/s] 27%|██▋       | 264/981 [00:10<00:28, 24.78it/s] 27%|██▋       | 267/981 [00:10<00:28, 24.96it/s] 28%|██▊       | 270/981 [00:10<00:28, 24.82it/s] 28%|██▊       | 273/981 [00:10<00:28, 24.47it/s] 28%|██▊       | 276/981 [00:10<00:28, 24.72it/s] 28%|██▊       | 279/981 [00:10<00:28, 24.83it/s] 29%|██▊       | 282/981 [00:11<00:27, 25.07it/s] 29%|██▉       | 285/981 [00:11<00:27, 25.10it/s] 29%|██▉       | 288/981 [00:11<00:27, 25.06it/s] 30%|██▉       | 291/981 [00:11<00:27, 25.03it/s] 30%|██▉       | 294/981 [00:11<00:27, 24.99it/s] 30%|███       | 297/981 [00:11<00:27, 25.05it/s] 31%|███       | 300/981 [00:11<00:27, 25.12it/s] 31%|███       | 303/981 [00:11<00:26, 25.13it/s] 31%|███       | 306/981 [00:12<00:26, 25.20it/s] 31%|███▏      | 309/981 [00:12<00:26, 25.21it/s] 32%|███▏      | 312/981 [00:12<00:26, 25.32it/s] 32%|███▏      | 315/981 [00:12<00:26, 25.34it/s] 32%|███▏      | 318/981 [00:12<00:26, 25.45it/s] 33%|███▎      | 321/981 [00:12<00:25, 25.51it/s] 33%|███▎      | 324/981 [00:12<00:25, 25.61it/s] 33%|███▎      | 327/981 [00:12<00:25, 25.34it/s] 34%|███▎      | 330/981 [00:13<00:27, 24.06it/s] 34%|███▍      | 333/981 [00:13<00:27, 23.47it/s] 34%|███▍      | 336/981 [00:13<00:27, 23.05it/s] 35%|███▍      | 339/981 [00:13<00:28, 22.77it/s] 35%|███▍      | 342/981 [00:13<00:27, 23.11it/s] 35%|███▌      | 345/981 [00:13<00:26, 23.60it/s] 35%|███▌      | 348/981 [00:13<00:26, 24.12it/s] 36%|███▌      | 351/981 [00:13<00:25, 24.43it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.75it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.81it/s] 37%|███▋      | 360/981 [00:14<00:24, 24.86it/s] 37%|███▋      | 363/981 [00:14<00:24, 24.84it/s] 37%|███▋      | 366/981 [00:14<00:24, 24.94it/s] 38%|███▊      | 369/981 [00:14<00:24, 24.74it/s] 38%|███▊      | 372/981 [00:14<00:24, 24.86it/s] 38%|███▊      | 375/981 [00:14<00:24, 24.92it/s] 39%|███▊      | 378/981 [00:14<00:24, 25.08it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.94it/s] 39%|███▉      | 384/981 [00:15<00:23, 24.93it/s] 39%|███▉      | 387/981 [00:15<00:23, 24.87it/s] 40%|███▉      | 390/981 [00:15<00:23, 24.80it/s] 40%|████      | 393/981 [00:15<00:23, 24.97it/s] 40%|████      | 396/981 [00:15<00:23, 24.91it/s] 41%|████      | 399/981 [00:15<00:23, 24.98it/s] 41%|████      | 402/981 [00:15<00:23, 25.06it/s] 41%|████▏     | 405/981 [00:16<00:22, 25.12it/s] 42%|████▏     | 408/981 [00:16<00:22, 25.16it/s] 42%|████▏     | 411/981 [00:16<00:22, 24.92it/s] 42%|████▏     | 414/981 [00:16<00:22, 24.72it/s] 43%|████▎     | 417/981 [00:16<00:22, 24.80it/s] 43%|████▎     | 420/981 [00:16<00:22, 24.95it/s] 43%|████▎     | 423/981 [00:16<00:22, 25.26it/s] 43%|████▎     | 426/981 [00:16<00:21, 25.44it/s] 44%|████▎     | 429/981 [00:17<00:21, 25.38it/s] 44%|████▍     | 432/981 [00:17<00:21, 25.67it/s] 44%|████▍     | 435/981 [00:17<00:21, 25.61it/s] 45%|████▍     | 438/981 [00:17<00:21, 25.67it/s] 45%|████▍     | 441/981 [00:17<00:21, 25.66it/s] 45%|████▌     | 444/981 [00:17<00:20, 25.68it/s] 46%|████▌     | 447/981 [00:17<00:21, 25.35it/s] 46%|████▌     | 450/981 [00:17<00:20, 25.36it/s] 46%|████▌     | 453/981 [00:17<00:20, 25.62it/s] 46%|████▋     | 456/981 [00:18<00:20, 25.73it/s] 47%|████▋     | 459/981 [00:18<00:20, 25.66it/s] 47%|████▋     | 462/981 [00:18<00:20, 25.64it/s] 47%|████▋     | 465/981 [00:18<00:20, 25.55it/s] 48%|████▊     | 468/981 [00:18<00:20, 25.54it/s] 48%|████▊     | 471/981 [00:18<00:22, 22.98it/s] 48%|████▊     | 474/981 [00:18<00:21, 23.90it/s] 49%|████▊     | 477/981 [00:18<00:20, 24.43it/s] 49%|████▉     | 480/981 [00:19<00:20, 24.84it/s] 49%|████▉     | 483/981 [00:19<00:19, 25.21it/s] 50%|████▉     | 486/981 [00:19<00:19, 25.45it/s] 50%|████▉     | 489/981 [00:19<00:19, 25.61it/s] 50%|█████     | 492/981 [00:19<00:19, 25.59it/s] 50%|█████     | 495/981 [00:19<00:18, 25.62it/s] 51%|█████     | 498/981 [00:19<00:18, 26.01it/s] 51%|█████     | 501/981 [00:19<00:18, 26.28it/s] 51%|█████▏    | 504/981 [00:19<00:18, 26.08it/s] 52%|█████▏    | 507/981 [00:20<00:18, 26.25it/s] 52%|█████▏    | 510/981 [00:20<00:17, 26.45it/s] 52%|█████▏    | 513/981 [00:20<00:17, 26.61it/s] 53%|█████▎    | 516/981 [00:20<00:17, 26.73it/s] 53%|█████▎    | 519/981 [00:20<00:17, 26.77it/s] 53%|█████▎    | 522/981 [00:20<00:17, 26.85it/s] 54%|█████▎    | 525/981 [00:20<00:16, 26.95it/s] 54%|█████▍    | 528/981 [00:20<00:16, 27.06it/s] 54%|█████▍    | 531/981 [00:20<00:16, 26.97it/s] 54%|█████▍    | 534/981 [00:21<00:16, 27.02it/s] 55%|█████▍    | 537/981 [00:21<00:16, 27.10it/s] 55%|█████▌    | 540/981 [00:21<00:16, 27.09it/s] 55%|█████▌    | 543/981 [00:21<00:16, 27.10it/s] 56%|█████▌    | 546/981 [00:21<00:16, 27.18it/s] 56%|█████▌    | 549/981 [00:21<00:15, 27.31it/s] 56%|█████▋    | 552/981 [00:21<00:15, 27.23it/s] 57%|█████▋    | 555/981 [00:21<00:15, 27.19it/s] 57%|█████▋    | 558/981 [00:21<00:15, 27.28it/s] 57%|█████▋    | 561/981 [00:22<00:15, 27.35it/s] 57%|█████▋    | 564/981 [00:22<00:15, 27.13it/s] 58%|█████▊    | 567/981 [00:22<00:15, 27.16it/s] 58%|█████▊    | 570/981 [00:22<00:15, 27.13it/s] 58%|█████▊    | 573/981 [00:22<00:15, 27.19it/s] 59%|█████▊    | 576/981 [00:22<00:14, 27.13it/s] 59%|█████▉    | 579/981 [00:22<00:14, 27.07it/s] 59%|█████▉    | 582/981 [00:22<00:14, 27.22it/s] 60%|█████▉    | 585/981 [00:22<00:14, 27.30it/s] 60%|█████▉    | 588/981 [00:23<00:14, 27.35it/s] 60%|██████    | 591/981 [00:23<00:14, 27.47it/s] 61%|██████    | 594/981 [00:23<00:14, 27.48it/s] 61%|██████    | 597/981 [00:23<00:13, 27.51it/s] 61%|██████    | 600/981 [00:23<00:13, 27.39it/s] 61%|██████▏   | 603/981 [00:23<00:13, 27.40it/s] 62%|██████▏   | 606/981 [00:23<00:13, 27.35it/s] 62%|██████▏   | 609/981 [00:23<00:13, 27.37it/s] 62%|██████▏   | 612/981 [00:23<00:13, 27.45it/s] 63%|██████▎   | 615/981 [00:24<00:13, 27.53it/s] 63%|██████▎   | 618/981 [00:24<00:13, 27.56it/s] 63%|██████▎   | 621/981 [00:24<00:13, 27.59it/s] 64%|██████▎   | 624/981 [00:24<00:12, 27.63it/s] 64%|██████▍   | 627/981 [00:24<00:12, 27.24it/s] 64%|██████▍   | 630/981 [00:24<00:12, 27.14it/s] 65%|██████▍   | 633/981 [00:24<00:12, 27.10it/s] 65%|██████▍   | 636/981 [00:24<00:12, 27.16it/s] 65%|██████▌   | 639/981 [00:24<00:12, 27.25it/s] 65%|██████▌   | 642/981 [00:25<00:12, 27.38it/s] 66%|██████▌   | 645/981 [00:25<00:12, 27.34it/s] 66%|██████▌   | 648/981 [00:25<00:12, 27.14it/s] 66%|██████▋   | 651/981 [00:25<00:12, 27.23it/s] 67%|██████▋   | 654/981 [00:25<00:12, 27.11it/s] 67%|██████▋   | 657/981 [00:25<00:11, 27.19it/s] 67%|██████▋   | 660/981 [00:25<00:11, 27.26it/s] 68%|██████▊   | 663/981 [00:25<00:11, 27.35it/s] 68%|██████▊   | 666/981 [00:25<00:11, 27.16it/s] 68%|██████▊   | 669/981 [00:26<00:11, 26.85it/s] 69%|██████▊   | 672/981 [00:26<00:11, 27.03it/s] 69%|██████▉   | 675/981 [00:26<00:11, 27.22it/s] 69%|██████▉   | 678/981 [00:26<00:11, 27.08it/s] 69%|██████▉   | 681/981 [00:26<00:11, 27.18it/s] 70%|██████▉   | 684/981 [00:26<00:11, 26.91it/s] 70%|███████   | 687/981 [00:26<00:10, 26.87it/s] 70%|███████   | 690/981 [00:26<00:10, 27.08it/s] 71%|███████   | 693/981 [00:26<00:10, 27.18it/s] 71%|███████   | 696/981 [00:27<00:10, 26.91it/s] 71%|███████▏  | 699/981 [00:27<00:10, 27.10it/s] 72%|███████▏  | 702/981 [00:27<00:10, 26.90it/s] 72%|███████▏  | 705/981 [00:27<00:10, 26.96it/s] 72%|███████▏  | 708/981 [00:27<00:10, 26.95it/s] 72%|███████▏  | 711/981 [00:27<00:10, 26.87it/s] 73%|███████▎  | 714/981 [00:27<00:09, 26.90it/s] 73%|███████▎  | 717/981 [00:27<00:09, 26.85it/s] 73%|███████▎  | 720/981 [00:27<00:09, 26.77it/s] 74%|███████▎  | 723/981 [00:28<00:09, 26.73it/s] 74%|███████▍  | 726/981 [00:28<00:09, 26.69it/s] 74%|███████▍  | 729/981 [00:28<00:09, 26.91it/s] 75%|███████▍  | 732/981 [00:28<00:09, 27.03it/s] 75%|███████▍  | 735/981 [00:28<00:09, 27.06it/s] 75%|███████▌  | 738/981 [00:28<00:08, 27.03it/s] 76%|███████▌  | 741/981 [00:28<00:08, 27.10it/s] 76%|███████▌  | 744/981 [00:28<00:08, 27.17it/s] 76%|███████▌  | 747/981 [00:28<00:08, 27.02it/s] 76%|███████▋  | 750/981 [00:29<00:08, 26.51it/s] 77%|███████▋  | 753/981 [00:29<00:08, 26.28it/s] 77%|███████▋  | 756/981 [00:29<00:08, 26.32it/s] 77%|███████▋  | 759/981 [00:29<00:08, 26.33it/s] 78%|███████▊  | 762/981 [00:29<00:08, 26.53it/s] 78%|███████▊  | 765/981 [00:29<00:08, 26.62it/s] 78%|███████▊  | 768/981 [00:29<00:08, 26.58it/s] 79%|███████▊  | 771/981 [00:29<00:07, 26.54it/s] 79%|███████▉  | 774/981 [00:29<00:07, 26.57it/s] 79%|███████▉  | 777/981 [00:30<00:07, 26.71it/s] 80%|███████▉  | 780/981 [00:30<00:07, 26.83it/s] 80%|███████▉  | 783/981 [00:30<00:07, 27.15it/s] 80%|████████  | 786/981 [00:30<00:07, 27.52it/s] 80%|████████  | 789/981 [00:30<00:06, 28.01it/s] 81%|████████  | 792/981 [00:30<00:06, 28.24it/s] 81%|████████  | 795/981 [00:30<00:06, 28.61it/s] 81%|████████▏ | 798/981 [00:30<00:06, 28.87it/s] 82%|████████▏ | 802/981 [00:30<00:06, 29.38it/s] 82%|████████▏ | 806/981 [00:31<00:05, 29.80it/s] 83%|████████▎ | 810/981 [00:31<00:05, 30.24it/s] 83%|████████▎ | 814/981 [00:31<00:05, 30.60it/s] 83%|████████▎ | 818/981 [00:31<00:05, 30.75it/s] 84%|████████▍ | 822/981 [00:31<00:05, 30.90it/s] 84%|████████▍ | 826/981 [00:31<00:04, 31.03it/s] 85%|████████▍ | 830/981 [00:31<00:04, 31.06it/s] 85%|████████▌ | 834/981 [00:31<00:04, 31.12it/s] 85%|████████▌ | 838/981 [00:32<00:04, 31.20it/s] 86%|████████▌ | 842/981 [00:32<00:04, 31.30it/s] 86%|████████▌ | 846/981 [00:32<00:04, 31.26it/s] 87%|████████▋ | 850/981 [00:32<00:04, 30.87it/s] 87%|████████▋ | 854/981 [00:32<00:04, 31.13it/s] 87%|████████▋ | 858/981 [00:32<00:03, 31.26it/s] 88%|████████▊ | 862/981 [00:32<00:03, 31.40it/s] 88%|████████▊ | 866/981 [00:32<00:03, 31.50it/s] 89%|████████▊ | 870/981 [00:33<00:03, 31.52it/s] 89%|████████▉ | 874/981 [00:33<00:03, 31.61it/s] 90%|████████▉ | 878/981 [00:33<00:03, 31.59it/s] 90%|████████▉ | 882/981 [00:33<00:03, 31.53it/s] 90%|█████████ | 886/981 [00:33<00:03, 31.52it/s] 91%|█████████ | 890/981 [00:33<00:02, 31.59it/s] 91%|█████████ | 894/981 [00:33<00:02, 31.67it/s] 92%|█████████▏| 898/981 [00:33<00:02, 31.73it/s] 92%|█████████▏| 902/981 [00:34<00:02, 31.85it/s] 92%|█████████▏| 906/981 [00:34<00:02, 31.89it/s] 93%|█████████▎| 910/981 [00:34<00:02, 31.89it/s] 93%|█████████▎| 914/981 [00:34<00:02, 31.89it/s] 94%|█████████▎| 918/981 [00:34<00:01, 31.82it/s] 94%|█████████▍| 922/981 [00:34<00:01, 31.88it/s] 94%|█████████▍| 926/981 [00:34<00:01, 31.94it/s] 95%|█████████▍| 930/981 [00:34<00:01, 31.89it/s] 95%|█████████▌| 934/981 [00:35<00:01, 31.86it/s] 96%|█████████▌| 938/981 [00:35<00:01, 31.83it/s] 96%|█████████▌| 942/981 [00:35<00:01, 31.85it/s] 96%|█████████▋| 946/981 [00:35<00:01, 31.88it/s] 97%|█████████▋| 950/981 [00:35<00:00, 31.84it/s] 97%|█████████▋| 954/981 [00:35<00:00, 30.52it/s] 98%|█████████▊| 958/981 [00:35<00:00, 30.83it/s] 98%|█████████▊| 962/981 [00:36<00:00, 31.06it/s] 98%|█████████▊| 966/981 [00:36<00:00, 31.30it/s] 99%|█████████▉| 970/981 [00:36<00:00, 31.46it/s] 99%|█████████▉| 974/981 [00:36<00:00, 31.62it/s]100%|█████████▉| 978/981 [00:36<00:00, 31.64it/s]100%|██████████| 981/981 [00:36<00:00, 26.79it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.037, valid loss : 0.037, train acc : 0.981, valid acc : 0.976, train f1 : 0.511, valid f1 : 0.519
training process:   2%|▏         | 1/50 [03:59<3:15:41, 239.63s/it]training process:   4%|▍         | 2/50 [07:11<2:49:08, 211.43s/it]training process:   6%|▌         | 3/50 [10:21<2:38:07, 201.85s/it]training process:   8%|▊         | 4/50 [13:34<2:31:51, 198.07s/it]epoch : 5, train loss : 0.027, valid loss : 0.031, train acc : 0.988, valid acc : 0.988, train f1 : 0.769, valid f1 : 0.766
training process:  10%|█         | 5/50 [17:29<2:38:36, 211.47s/it]training process:  12%|█▏        | 6/50 [20:41<2:30:15, 204.89s/it]training process:  14%|█▍        | 7/50 [23:54<2:24:02, 200.98s/it]training process:  16%|█▌        | 8/50 [27:08<2:19:14, 198.93s/it]epoch : 9, train loss : 0.026, valid loss : 0.020, train acc : 0.981, valid acc : 0.979, train f1 : 0.699, valid f1 : 0.747
training process:  18%|█▊        | 9/50 [31:04<2:23:51, 210.53s/it]training process:  20%|██        | 10/50 [34:16<2:16:28, 204.72s/it]training process:  22%|██▏       | 11/50 [37:28<2:10:35, 200.92s/it]training process:  24%|██▍       | 12/50 [40:44<2:06:08, 199.18s/it]epoch : 13, train loss : 0.016, valid loss : 0.020, train acc : 0.990, valid acc : 0.994, train f1 : 0.845, valid f1 : 0.909
training process:  26%|██▌       | 13/50 [44:44<2:10:29, 211.61s/it]training process:  28%|██▊       | 14/50 [47:57<2:03:38, 206.08s/it]training process:  30%|███       | 15/50 [51:20<1:59:39, 205.13s/it]training process:  32%|███▏      | 16/50 [55:38<2:05:19, 221.16s/it]epoch : 17, train loss : 0.011, valid loss : 0.016, train acc : 0.993, valid acc : 0.990, train f1 : 0.890, valid f1 : 0.873
training process:  34%|███▍      | 17/50 [1:00:20<2:11:35, 239.25s/it]training process:  36%|███▌      | 18/50 [1:03:30<1:59:42, 224.44s/it]training process:  38%|███▊      | 19/50 [1:06:39<1:50:34, 214.01s/it]training process:  40%|████      | 20/50 [1:09:49<1:43:19, 206.66s/it]epoch : 21, train loss : 0.012, valid loss : 0.015, train acc : 0.994, valid acc : 0.994, train f1 : 0.907, valid f1 : 0.904
training process:  42%|████▏     | 21/50 [1:13:43<1:43:49, 214.83s/it]training process:  44%|████▍     | 22/50 [1:16:55<1:37:06, 208.10s/it]training process:  46%|████▌     | 23/50 [1:20:06<1:31:18, 202.92s/it]training process:  48%|████▊     | 24/50 [1:23:18<1:26:26, 199.46s/it]epoch : 25, train loss : 0.010, valid loss : 0.014, train acc : 0.994, valid acc : 0.995, train f1 : 0.912, valid f1 : 0.919
training process:  50%|█████     | 25/50 [1:27:12<1:27:30, 210.04s/it]training process:  52%|█████▏    | 26/50 [1:30:25<1:21:57, 204.90s/it]training process:  54%|█████▍    | 27/50 [1:33:38<1:17:06, 201.15s/it]training process:  56%|█████▌    | 28/50 [1:36:49<1:12:42, 198.28s/it]epoch : 29, train loss : 0.009, valid loss : 0.013, train acc : 0.995, valid acc : 0.995, train f1 : 0.926, valid f1 : 0.930
training process:  58%|█████▊    | 29/50 [1:40:44<1:13:12, 209.15s/it]training process:  60%|██████    | 30/50 [1:43:54<1:07:52, 203.61s/it]training process:  62%|██████▏   | 31/50 [1:47:06<1:03:18, 199.93s/it]training process:  64%|██████▍   | 32/50 [1:50:16<59:08, 197.13s/it]  epoch : 33, train loss : 0.009, valid loss : 0.011, train acc : 0.995, valid acc : 0.996, train f1 : 0.920, valid f1 : 0.942
training process:  66%|██████▌   | 33/50 [1:54:11<59:04, 208.50s/it]training process:  68%|██████▊   | 34/50 [1:57:22<54:08, 203.03s/it]training process:  70%|███████   | 35/50 [2:00:34<49:57, 199.82s/it]training process:  72%|███████▏  | 36/50 [2:03:46<46:06, 197.62s/it]epoch : 37, train loss : 0.009, valid loss : 0.013, train acc : 0.995, valid acc : 0.996, train f1 : 0.924, valid f1 : 0.932
training process:  74%|███████▍  | 37/50 [2:07:42<45:18, 209.12s/it]training process:  76%|███████▌  | 38/50 [2:10:55<40:51, 204.27s/it]training process:  78%|███████▊  | 39/50 [2:14:09<36:51, 201.02s/it]training process:  80%|████████  | 40/50 [2:17:21<33:05, 198.54s/it]epoch : 41, train loss : 0.008, valid loss : 0.011, train acc : 0.995, valid acc : 0.996, train f1 : 0.926, valid f1 : 0.943
training process:  82%|████████▏ | 41/50 [2:21:16<31:23, 209.22s/it]training process:  84%|████████▍ | 42/50 [2:24:28<27:12, 204.08s/it]training process:  86%|████████▌ | 43/50 [2:27:38<23:18, 199.86s/it]training process:  88%|████████▊ | 44/50 [2:30:50<19:46, 197.68s/it]epoch : 45, train loss : 0.008, valid loss : 0.011, train acc : 0.995, valid acc : 0.993, train f1 : 0.925, valid f1 : 0.907
training process:  90%|█████████ | 45/50 [2:34:44<17:22, 208.59s/it]training process:  92%|█████████▏| 46/50 [2:37:59<13:37, 204.45s/it]training process:  94%|█████████▍| 47/50 [2:41:09<10:00, 200.18s/it]training process:  96%|█████████▌| 48/50 [2:44:21<06:35, 197.73s/it]epoch : 49, train loss : 0.008, valid loss : 0.016, train acc : 0.996, valid acc : 0.994, train f1 : 0.936, valid f1 : 0.915
training process:  98%|█████████▊| 49/50 [2:48:19<03:29, 209.80s/it]training process: 100%|██████████| 50/50 [2:51:29<00:00, 203.82s/it]training process: 100%|██████████| 50/50 [2:51:29<00:00, 205.79s/it]
training process finished, best loss : 0.011 and best acc : 0.996, best f1 : 0.943, best epoch : 40

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.64      0.82      0.72        71
           1       1.00      0.99      0.99      3812

    accuracy                           0.99      3883
   macro avg       0.82      0.90      0.86      3883
weighted avg       0.99      0.99      0.99      3883


# test acc : 0.99, test f1 : 0.86, test AUC : 0.90, test loss : 0.201

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 3/981 [00:00<00:42, 23.23it/s]  1%|          | 6/981 [00:00<00:40, 24.00it/s]  1%|          | 9/981 [00:00<00:39, 24.31it/s]  1%|          | 12/981 [00:00<00:39, 24.48it/s]  2%|▏         | 15/981 [00:00<00:39, 24.55it/s]  2%|▏         | 18/981 [00:00<00:39, 24.61it/s]  2%|▏         | 21/981 [00:00<00:38, 24.74it/s]  2%|▏         | 24/981 [00:00<00:38, 24.67it/s]  3%|▎         | 27/981 [00:01<00:38, 24.74it/s]  3%|▎         | 30/981 [00:01<00:38, 24.97it/s]  3%|▎         | 33/981 [00:01<00:37, 24.97it/s]  4%|▎         | 36/981 [00:01<00:37, 24.96it/s]  4%|▍         | 39/981 [00:01<00:37, 24.95it/s]  4%|▍         | 42/981 [00:01<00:37, 24.89it/s]  5%|▍         | 45/981 [00:01<00:37, 24.79it/s]  5%|▍         | 48/981 [00:01<00:37, 24.67it/s]  5%|▌         | 51/981 [00:02<00:37, 24.68it/s]  6%|▌         | 54/981 [00:02<00:37, 24.79it/s]  6%|▌         | 57/981 [00:02<00:37, 24.78it/s]  6%|▌         | 60/981 [00:02<00:36, 25.06it/s]  6%|▋         | 63/981 [00:02<00:36, 25.43it/s]  7%|▋         | 66/981 [00:02<00:35, 25.45it/s]  7%|▋         | 69/981 [00:02<00:35, 25.34it/s]  7%|▋         | 72/981 [00:02<00:35, 25.37it/s]  8%|▊         | 75/981 [00:03<00:35, 25.47it/s]  8%|▊         | 78/981 [00:03<00:35, 25.29it/s]  8%|▊         | 81/981 [00:03<00:35, 25.17it/s]  9%|▊         | 84/981 [00:03<00:35, 24.96it/s]  9%|▉         | 87/981 [00:03<00:36, 24.73it/s]  9%|▉         | 90/981 [00:03<00:36, 24.55it/s]  9%|▉         | 93/981 [00:03<00:36, 24.58it/s] 10%|▉         | 96/981 [00:03<00:35, 24.65it/s] 10%|█         | 99/981 [00:03<00:35, 24.68it/s] 10%|█         | 102/981 [00:04<00:35, 24.68it/s] 11%|█         | 105/981 [00:04<00:35, 24.62it/s] 11%|█         | 108/981 [00:04<00:35, 24.48it/s] 11%|█▏        | 111/981 [00:04<00:35, 24.61it/s] 12%|█▏        | 114/981 [00:04<00:35, 24.57it/s] 12%|█▏        | 117/981 [00:04<00:35, 24.47it/s] 12%|█▏        | 120/981 [00:04<00:35, 24.39it/s] 13%|█▎        | 123/981 [00:04<00:35, 24.16it/s] 13%|█▎        | 126/981 [00:05<00:35, 24.13it/s] 13%|█▎        | 129/981 [00:05<00:35, 24.21it/s] 13%|█▎        | 132/981 [00:05<00:35, 24.22it/s] 14%|█▍        | 135/981 [00:05<00:34, 24.32it/s] 14%|█▍        | 138/981 [00:05<00:34, 24.46it/s] 14%|█▍        | 141/981 [00:05<00:34, 24.53it/s] 15%|█▍        | 144/981 [00:05<00:34, 24.61it/s] 15%|█▍        | 147/981 [00:05<00:33, 24.77it/s] 15%|█▌        | 150/981 [00:06<00:33, 24.71it/s] 16%|█▌        | 153/981 [00:06<00:33, 24.62it/s] 16%|█▌        | 156/981 [00:06<00:33, 24.66it/s] 16%|█▌        | 159/981 [00:06<00:33, 24.40it/s] 17%|█▋        | 162/981 [00:06<00:33, 24.22it/s] 17%|█▋        | 165/981 [00:06<00:33, 24.35it/s] 17%|█▋        | 168/981 [00:06<00:33, 24.13it/s] 17%|█▋        | 171/981 [00:06<00:33, 23.92it/s] 18%|█▊        | 174/981 [00:07<00:33, 24.12it/s] 18%|█▊        | 177/981 [00:07<00:32, 24.41it/s] 18%|█▊        | 180/981 [00:07<00:32, 24.58it/s] 19%|█▊        | 183/981 [00:07<00:32, 24.63it/s] 19%|█▉        | 186/981 [00:07<00:32, 24.66it/s] 19%|█▉        | 189/981 [00:07<00:31, 24.78it/s] 20%|█▉        | 192/981 [00:07<00:31, 24.79it/s] 20%|█▉        | 195/981 [00:07<00:31, 24.59it/s] 20%|██        | 198/981 [00:08<00:31, 24.59it/s] 20%|██        | 201/981 [00:08<00:31, 24.46it/s] 21%|██        | 204/981 [00:08<00:31, 24.35it/s] 21%|██        | 207/981 [00:08<00:32, 24.13it/s] 21%|██▏       | 210/981 [00:08<00:32, 24.05it/s] 22%|██▏       | 213/981 [00:08<00:31, 24.10it/s] 22%|██▏       | 216/981 [00:08<00:31, 24.14it/s] 22%|██▏       | 219/981 [00:08<00:31, 24.30it/s] 23%|██▎       | 222/981 [00:09<00:31, 24.35it/s] 23%|██▎       | 225/981 [00:09<00:31, 24.32it/s] 23%|██▎       | 228/981 [00:09<00:30, 24.33it/s] 24%|██▎       | 231/981 [00:09<00:30, 24.29it/s] 24%|██▍       | 234/981 [00:09<00:30, 24.27it/s] 24%|██▍       | 237/981 [00:09<00:30, 24.33it/s] 24%|██▍       | 240/981 [00:09<00:30, 24.38it/s] 25%|██▍       | 243/981 [00:09<00:30, 23.85it/s] 25%|██▌       | 246/981 [00:10<00:30, 23.97it/s] 25%|██▌       | 249/981 [00:10<00:30, 24.01it/s] 26%|██▌       | 252/981 [00:10<00:30, 23.96it/s] 26%|██▌       | 255/981 [00:10<00:29, 24.27it/s] 26%|██▋       | 258/981 [00:10<00:29, 24.53it/s] 27%|██▋       | 261/981 [00:10<00:29, 24.74it/s] 27%|██▋       | 264/981 [00:10<00:28, 24.87it/s] 27%|██▋       | 267/981 [00:10<00:29, 24.52it/s] 28%|██▊       | 270/981 [00:11<00:29, 24.34it/s] 28%|██▊       | 273/981 [00:11<00:29, 24.23it/s] 28%|██▊       | 276/981 [00:11<00:29, 23.76it/s] 28%|██▊       | 279/981 [00:11<00:29, 23.89it/s] 29%|██▊       | 282/981 [00:11<00:29, 24.02it/s] 29%|██▉       | 285/981 [00:11<00:28, 24.05it/s] 29%|██▉       | 288/981 [00:11<00:28, 23.97it/s] 30%|██▉       | 291/981 [00:11<00:28, 24.23it/s] 30%|██▉       | 294/981 [00:11<00:28, 24.39it/s] 30%|███       | 297/981 [00:12<00:27, 24.59it/s] 31%|███       | 300/981 [00:12<00:27, 24.75it/s] 31%|███       | 303/981 [00:12<00:27, 24.53it/s] 31%|███       | 306/981 [00:12<00:27, 24.31it/s] 31%|███▏      | 309/981 [00:12<00:28, 23.69it/s] 32%|███▏      | 312/981 [00:12<00:28, 23.85it/s] 32%|███▏      | 315/981 [00:12<00:27, 23.92it/s] 32%|███▏      | 318/981 [00:12<00:27, 24.00it/s] 33%|███▎      | 321/981 [00:13<00:27, 24.22it/s] 33%|███▎      | 324/981 [00:13<00:27, 24.14it/s] 33%|███▎      | 327/981 [00:13<00:26, 24.24it/s] 34%|███▎      | 330/981 [00:13<00:26, 24.37it/s] 34%|███▍      | 333/981 [00:13<00:26, 24.35it/s] 34%|███▍      | 336/981 [00:13<00:26, 24.41it/s] 35%|███▍      | 339/981 [00:13<00:26, 24.45it/s] 35%|███▍      | 342/981 [00:13<00:25, 24.65it/s] 35%|███▌      | 345/981 [00:14<00:25, 24.60it/s] 35%|███▌      | 348/981 [00:14<00:25, 24.43it/s] 36%|███▌      | 351/981 [00:14<00:25, 24.29it/s] 36%|███▌      | 354/981 [00:14<00:25, 24.28it/s] 36%|███▋      | 357/981 [00:14<00:25, 24.13it/s] 37%|███▋      | 360/981 [00:14<00:25, 24.11it/s] 37%|███▋      | 363/981 [00:14<00:25, 24.17it/s] 37%|███▋      | 366/981 [00:14<00:25, 24.05it/s] 38%|███▊      | 369/981 [00:15<00:25, 24.20it/s] 38%|███▊      | 372/981 [00:15<00:25, 24.22it/s] 38%|███▊      | 375/981 [00:15<00:24, 24.28it/s] 39%|███▊      | 378/981 [00:15<00:24, 24.21it/s] 39%|███▉      | 381/981 [00:15<00:24, 24.31it/s] 39%|███▉      | 384/981 [00:15<00:24, 24.33it/s] 39%|███▉      | 387/981 [00:15<00:24, 24.20it/s] 40%|███▉      | 390/981 [00:15<00:24, 24.10it/s] 40%|████      | 393/981 [00:16<00:24, 24.08it/s] 40%|████      | 396/981 [00:16<00:24, 24.09it/s] 41%|████      | 399/981 [00:16<00:24, 23.99it/s] 41%|████      | 402/981 [00:16<00:23, 24.19it/s] 41%|████▏     | 405/981 [00:16<00:23, 24.40it/s] 42%|████▏     | 408/981 [00:16<00:23, 24.47it/s] 42%|████▏     | 411/981 [00:16<00:23, 24.20it/s] 42%|████▏     | 414/981 [00:16<00:23, 24.32it/s] 43%|████▎     | 417/981 [00:17<00:23, 24.42it/s] 43%|████▎     | 420/981 [00:17<00:23, 24.39it/s] 43%|████▎     | 423/981 [00:17<00:22, 24.39it/s] 43%|████▎     | 426/981 [00:17<00:22, 24.39it/s] 44%|████▎     | 429/981 [00:17<00:22, 24.32it/s] 44%|████▍     | 432/981 [00:17<00:22, 23.93it/s] 44%|████▍     | 435/981 [00:17<00:22, 23.89it/s] 45%|████▍     | 438/981 [00:17<00:22, 23.81it/s] 45%|████▍     | 441/981 [00:18<00:22, 23.91it/s] 45%|████▌     | 444/981 [00:18<00:22, 24.30it/s] 46%|████▌     | 447/981 [00:18<00:21, 24.60it/s] 46%|████▌     | 450/981 [00:18<00:21, 24.24it/s] 46%|████▌     | 453/981 [00:18<00:21, 24.35it/s] 46%|████▋     | 456/981 [00:18<00:21, 24.42it/s] 47%|████▋     | 459/981 [00:18<00:21, 24.30it/s] 47%|████▋     | 462/981 [00:18<00:21, 24.28it/s] 47%|████▋     | 465/981 [00:19<00:21, 24.29it/s] 48%|████▊     | 468/981 [00:19<00:21, 24.12it/s] 48%|████▊     | 471/981 [00:19<00:21, 24.11it/s] 48%|████▊     | 474/981 [00:19<00:20, 24.15it/s] 49%|████▊     | 477/981 [00:19<00:20, 24.13it/s] 49%|████▉     | 480/981 [00:19<00:20, 24.28it/s] 49%|████▉     | 483/981 [00:19<00:20, 24.39it/s] 50%|████▉     | 486/981 [00:19<00:19, 24.79it/s] 50%|████▉     | 489/981 [00:20<00:19, 24.70it/s] 50%|█████     | 492/981 [00:20<00:19, 24.56it/s] 50%|█████     | 495/981 [00:20<00:19, 24.53it/s] 51%|█████     | 498/981 [00:20<00:19, 24.49it/s] 51%|█████     | 501/981 [00:20<00:19, 24.38it/s] 51%|█████▏    | 504/981 [00:20<00:19, 24.36it/s] 52%|█████▏    | 507/981 [00:20<00:19, 24.47it/s] 52%|█████▏    | 510/981 [00:20<00:19, 24.23it/s] 52%|█████▏    | 513/981 [00:21<00:19, 24.30it/s] 53%|█████▎    | 516/981 [00:21<00:19, 24.15it/s] 53%|█████▎    | 519/981 [00:21<00:18, 24.45it/s] 53%|█████▎    | 522/981 [00:21<00:18, 24.68it/s] 54%|█████▎    | 525/981 [00:21<00:18, 24.82it/s] 54%|█████▍    | 528/981 [00:21<00:18, 25.13it/s] 54%|█████▍    | 531/981 [00:21<00:17, 25.32it/s] 54%|█████▍    | 534/981 [00:21<00:17, 25.16it/s] 55%|█████▍    | 537/981 [00:21<00:17, 24.84it/s] 55%|█████▌    | 540/981 [00:22<00:17, 24.97it/s] 55%|█████▌    | 543/981 [00:22<00:17, 25.00it/s] 56%|█████▌    | 546/981 [00:22<00:17, 24.63it/s] 56%|█████▌    | 549/981 [00:22<00:17, 24.78it/s] 56%|█████▋    | 552/981 [00:22<00:17, 24.85it/s] 57%|█████▋    | 555/981 [00:22<00:17, 25.01it/s] 57%|█████▋    | 558/981 [00:22<00:16, 25.10it/s] 57%|█████▋    | 561/981 [00:22<00:16, 25.18it/s] 57%|█████▋    | 564/981 [00:23<00:16, 25.24it/s] 58%|█████▊    | 567/981 [00:23<00:16, 25.33it/s] 58%|█████▊    | 570/981 [00:23<00:16, 25.50it/s] 58%|█████▊    | 573/981 [00:23<00:15, 25.55it/s] 59%|█████▊    | 576/981 [00:23<00:15, 25.37it/s] 59%|█████▉    | 579/981 [00:23<00:15, 25.26it/s] 59%|█████▉    | 582/981 [00:23<00:15, 25.25it/s] 60%|█████▉    | 585/981 [00:23<00:15, 25.18it/s] 60%|█████▉    | 588/981 [00:24<00:15, 25.10it/s] 60%|██████    | 591/981 [00:24<00:15, 25.14it/s] 61%|██████    | 594/981 [00:24<00:15, 25.23it/s] 61%|██████    | 597/981 [00:24<00:15, 25.27it/s] 61%|██████    | 600/981 [00:24<00:15, 25.23it/s] 61%|██████▏   | 603/981 [00:24<00:14, 25.58it/s] 62%|██████▏   | 606/981 [00:24<00:14, 25.85it/s] 62%|██████▏   | 609/981 [00:24<00:14, 25.69it/s] 62%|██████▏   | 612/981 [00:24<00:14, 25.84it/s] 63%|██████▎   | 615/981 [00:25<00:14, 25.83it/s] 63%|██████▎   | 618/981 [00:25<00:14, 25.83it/s] 63%|██████▎   | 621/981 [00:25<00:14, 25.50it/s] 64%|██████▎   | 624/981 [00:25<00:13, 25.50it/s] 64%|██████▍   | 627/981 [00:25<00:13, 25.46it/s] 64%|██████▍   | 630/981 [00:25<00:13, 25.49it/s] 65%|██████▍   | 633/981 [00:25<00:13, 25.51it/s] 65%|██████▍   | 636/981 [00:25<00:13, 25.74it/s] 65%|██████▌   | 639/981 [00:25<00:13, 26.00it/s] 65%|██████▌   | 642/981 [00:26<00:12, 26.14it/s] 66%|██████▌   | 645/981 [00:26<00:12, 26.02it/s] 66%|██████▌   | 648/981 [00:26<00:12, 25.92it/s] 66%|██████▋   | 651/981 [00:26<00:13, 25.01it/s] 67%|██████▋   | 654/981 [00:26<00:13, 25.13it/s] 67%|██████▋   | 657/981 [00:26<00:12, 25.17it/s] 67%|██████▋   | 660/981 [00:26<00:12, 25.27it/s] 68%|██████▊   | 663/981 [00:26<00:12, 25.36it/s] 68%|██████▊   | 666/981 [00:27<00:12, 25.39it/s] 68%|██████▊   | 669/981 [00:27<00:12, 25.37it/s] 69%|██████▊   | 672/981 [00:27<00:12, 25.26it/s] 69%|██████▉   | 675/981 [00:27<00:12, 25.18it/s] 69%|██████▉   | 678/981 [00:27<00:11, 25.29it/s] 69%|██████▉   | 681/981 [00:27<00:11, 25.07it/s] 70%|██████▉   | 684/981 [00:27<00:11, 25.20it/s] 70%|███████   | 687/981 [00:27<00:11, 25.24it/s] 70%|███████   | 690/981 [00:28<00:11, 25.15it/s] 71%|███████   | 693/981 [00:28<00:11, 25.01it/s] 71%|███████   | 696/981 [00:28<00:11, 24.97it/s] 71%|███████▏  | 699/981 [00:28<00:11, 24.89it/s] 72%|███████▏  | 702/981 [00:28<00:11, 24.95it/s] 72%|███████▏  | 705/981 [00:28<00:11, 24.62it/s] 72%|███████▏  | 708/981 [00:28<00:11, 24.81it/s] 72%|███████▏  | 711/981 [00:28<00:10, 24.96it/s] 73%|███████▎  | 714/981 [00:28<00:10, 24.88it/s] 73%|███████▎  | 717/981 [00:29<00:10, 25.04it/s] 73%|███████▎  | 720/981 [00:29<00:10, 25.19it/s] 74%|███████▎  | 723/981 [00:29<00:10, 25.18it/s] 74%|███████▍  | 726/981 [00:29<00:10, 25.29it/s] 74%|███████▍  | 729/981 [00:29<00:09, 25.29it/s] 75%|███████▍  | 732/981 [00:29<00:09, 25.38it/s] 75%|███████▍  | 735/981 [00:29<00:09, 25.11it/s] 75%|███████▌  | 738/981 [00:29<00:09, 25.00it/s] 76%|███████▌  | 741/981 [00:30<00:09, 25.04it/s] 76%|███████▌  | 744/981 [00:30<00:09, 24.80it/s] 76%|███████▌  | 747/981 [00:30<00:09, 24.71it/s] 76%|███████▋  | 750/981 [00:30<00:09, 24.55it/s] 77%|███████▋  | 753/981 [00:30<00:09, 24.55it/s] 77%|███████▋  | 756/981 [00:30<00:09, 24.71it/s] 77%|███████▋  | 759/981 [00:30<00:08, 24.76it/s] 78%|███████▊  | 762/981 [00:30<00:08, 24.79it/s] 78%|███████▊  | 765/981 [00:31<00:08, 24.33it/s] 78%|███████▊  | 768/981 [00:31<00:08, 24.29it/s] 79%|███████▊  | 771/981 [00:31<00:08, 24.39it/s] 79%|███████▉  | 774/981 [00:31<00:08, 24.44it/s] 79%|███████▉  | 777/981 [00:31<00:08, 24.61it/s] 80%|███████▉  | 780/981 [00:31<00:08, 24.55it/s] 80%|███████▉  | 783/981 [00:31<00:08, 24.64it/s] 80%|████████  | 786/981 [00:31<00:07, 25.04it/s] 80%|████████  | 789/981 [00:31<00:07, 25.47it/s] 81%|████████  | 792/981 [00:32<00:07, 26.02it/s] 81%|████████  | 795/981 [00:32<00:06, 26.59it/s] 81%|████████▏ | 798/981 [00:32<00:06, 27.08it/s] 82%|████████▏ | 801/981 [00:32<00:06, 27.70it/s] 82%|████████▏ | 804/981 [00:32<00:06, 27.84it/s] 82%|████████▏ | 807/981 [00:32<00:06, 27.99it/s] 83%|████████▎ | 810/981 [00:32<00:06, 28.21it/s] 83%|████████▎ | 813/981 [00:32<00:05, 28.44it/s] 83%|████████▎ | 816/981 [00:32<00:05, 28.44it/s] 83%|████████▎ | 819/981 [00:33<00:05, 28.34it/s] 84%|████████▍ | 822/981 [00:33<00:05, 28.22it/s] 84%|████████▍ | 825/981 [00:33<00:05, 28.20it/s] 84%|████████▍ | 828/981 [00:33<00:05, 28.15it/s] 85%|████████▍ | 831/981 [00:33<00:05, 28.14it/s] 85%|████████▌ | 834/981 [00:33<00:05, 28.26it/s] 85%|████████▌ | 837/981 [00:33<00:05, 28.29it/s] 86%|████████▌ | 840/981 [00:33<00:04, 28.48it/s] 86%|████████▌ | 843/981 [00:33<00:04, 28.64it/s] 86%|████████▌ | 846/981 [00:33<00:04, 28.79it/s] 87%|████████▋ | 849/981 [00:34<00:04, 29.07it/s] 87%|████████▋ | 852/981 [00:34<00:04, 29.08it/s] 87%|████████▋ | 855/981 [00:34<00:04, 29.14it/s] 87%|████████▋ | 858/981 [00:34<00:04, 29.06it/s] 88%|████████▊ | 861/981 [00:34<00:04, 28.94it/s] 88%|████████▊ | 864/981 [00:34<00:04, 28.76it/s] 88%|████████▊ | 867/981 [00:34<00:03, 28.72it/s] 89%|████████▊ | 870/981 [00:34<00:03, 28.68it/s] 89%|████████▉ | 873/981 [00:34<00:03, 28.76it/s] 89%|████████▉ | 876/981 [00:35<00:03, 28.78it/s] 90%|████████▉ | 879/981 [00:35<00:03, 28.83it/s] 90%|████████▉ | 882/981 [00:35<00:03, 28.76it/s] 90%|█████████ | 885/981 [00:35<00:03, 28.51it/s] 91%|█████████ | 888/981 [00:35<00:03, 28.58it/s] 91%|█████████ | 891/981 [00:35<00:03, 28.56it/s] 91%|█████████ | 894/981 [00:35<00:03, 28.55it/s] 91%|█████████▏| 897/981 [00:35<00:02, 28.85it/s] 92%|█████████▏| 900/981 [00:35<00:02, 28.96it/s] 92%|█████████▏| 903/981 [00:35<00:02, 28.92it/s] 92%|█████████▏| 906/981 [00:36<00:02, 28.88it/s] 93%|█████████▎| 909/981 [00:36<00:02, 28.73it/s] 93%|█████████▎| 912/981 [00:36<00:02, 28.67it/s] 93%|█████████▎| 915/981 [00:36<00:02, 28.36it/s] 94%|█████████▎| 918/981 [00:36<00:02, 28.45it/s] 94%|█████████▍| 921/981 [00:36<00:02, 28.41it/s] 94%|█████████▍| 924/981 [00:36<00:01, 28.56it/s] 94%|█████████▍| 927/981 [00:36<00:01, 28.63it/s] 95%|█████████▍| 930/981 [00:36<00:01, 28.81it/s] 95%|█████████▌| 933/981 [00:37<00:01, 28.78it/s] 95%|█████████▌| 936/981 [00:37<00:01, 28.84it/s] 96%|█████████▌| 939/981 [00:37<00:01, 28.98it/s] 96%|█████████▌| 942/981 [00:37<00:01, 28.93it/s] 96%|█████████▋| 945/981 [00:37<00:01, 29.12it/s] 97%|█████████▋| 948/981 [00:37<00:01, 29.12it/s] 97%|█████████▋| 951/981 [00:37<00:01, 29.24it/s] 97%|█████████▋| 954/981 [00:37<00:00, 29.16it/s] 98%|█████████▊| 957/981 [00:37<00:00, 28.60it/s] 98%|█████████▊| 960/981 [00:37<00:00, 28.57it/s] 98%|█████████▊| 963/981 [00:38<00:00, 28.77it/s] 98%|█████████▊| 966/981 [00:38<00:00, 28.84it/s] 99%|█████████▉| 969/981 [00:38<00:00, 28.92it/s] 99%|█████████▉| 972/981 [00:38<00:00, 29.14it/s] 99%|█████████▉| 975/981 [00:38<00:00, 29.26it/s]100%|█████████▉| 978/981 [00:38<00:00, 29.19it/s]100%|██████████| 981/981 [00:38<00:00, 29.30it/s]100%|██████████| 981/981 [00:38<00:00, 25.36it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_RS_RW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process:   0%|          | 0/50 [00:00<?, ?it/s]epoch : 1, train loss : 0.040, valid loss : 0.019, train acc : 0.744, valid acc : 0.613, train f1 : 0.728, valid f1 : 0.419
training process:   2%|▏         | 1/50 [03:59<3:15:45, 239.70s/it]training process:   4%|▍         | 2/50 [07:17<2:52:02, 215.05s/it]training process:   6%|▌         | 3/50 [10:32<2:41:12, 205.80s/it]training process:   8%|▊         | 4/50 [13:46<2:34:24, 201.41s/it]epoch : 5, train loss : 0.021, valid loss : 0.009, train acc : 0.929, valid acc : 0.924, train f1 : 0.929, valid f1 : 0.635
training process:  10%|█         | 5/50 [17:46<2:41:25, 215.23s/it]training process:  12%|█▏        | 6/50 [21:02<2:32:54, 208.51s/it]training process:  14%|█▍        | 7/50 [24:13<2:25:28, 202.99s/it]training process:  16%|█▌        | 8/50 [27:28<2:20:10, 200.26s/it]epoch : 9, train loss : 0.018, valid loss : 0.009, train acc : 0.934, valid acc : 0.918, train f1 : 0.934, valid f1 : 0.627
training process:  18%|█▊        | 9/50 [31:27<2:25:12, 212.51s/it]training process:  20%|██        | 10/50 [34:39<2:17:20, 206.00s/it]training process:  22%|██▏       | 11/50 [37:51<2:11:17, 201.98s/it]training process:  24%|██▍       | 12/50 [41:04<2:06:06, 199.11s/it]epoch : 13, train loss : 0.015, valid loss : 0.010, train acc : 0.944, valid acc : 0.909, train f1 : 0.943, valid f1 : 0.611
training process:  26%|██▌       | 13/50 [45:02<2:10:05, 210.96s/it]training process:  28%|██▊       | 14/50 [48:15<2:03:18, 205.52s/it]training process:  30%|███       | 15/50 [51:27<1:57:25, 201.30s/it]training process:  32%|███▏      | 16/50 [54:38<1:52:21, 198.29s/it]epoch : 17, train loss : 0.015, valid loss : 0.012, train acc : 0.949, valid acc : 0.928, train f1 : 0.948, valid f1 : 0.638
training process:  34%|███▍      | 17/50 [58:35<1:55:23, 209.80s/it]training process:  36%|███▌      | 18/50 [1:01:48<1:49:20, 205.01s/it]training process:  38%|███▊      | 19/50 [1:05:02<1:44:09, 201.59s/it]training process:  40%|████      | 20/50 [1:08:17<1:39:44, 199.47s/it]epoch : 21, train loss : 0.012, valid loss : 0.014, train acc : 0.955, valid acc : 0.935, train f1 : 0.955, valid f1 : 0.650
training process:  42%|████▏     | 21/50 [1:12:14<1:41:59, 211.02s/it]training process:  44%|████▍     | 22/50 [1:15:30<1:36:18, 206.36s/it]training process:  46%|████▌     | 23/50 [1:18:43<1:31:01, 202.29s/it]training process:  48%|████▊     | 24/50 [1:21:57<1:26:35, 199.83s/it]epoch : 25, train loss : 0.011, valid loss : 0.010, train acc : 0.955, valid acc : 0.930, train f1 : 0.955, valid f1 : 0.645
training process:  50%|█████     | 25/50 [1:25:54<1:27:52, 210.91s/it]training process:  52%|█████▏    | 26/50 [1:29:07<1:22:13, 205.58s/it]training process:  54%|█████▍    | 27/50 [1:32:20<1:17:26, 202.01s/it]training process:  56%|█████▌    | 28/50 [1:35:30<1:12:39, 198.16s/it]epoch : 29, train loss : 0.010, valid loss : 0.010, train acc : 0.961, valid acc : 0.957, train f1 : 0.961, valid f1 : 0.706
training process:  58%|█████▊    | 29/50 [1:39:32<1:13:58, 211.36s/it]training process:  60%|██████    | 30/50 [1:42:43<1:08:24, 205.24s/it]training process:  62%|██████▏   | 31/50 [1:45:56<1:03:48, 201.51s/it]training process:  64%|██████▍   | 32/50 [1:49:06<59:26, 198.15s/it]  epoch : 33, train loss : 0.010, valid loss : 0.014, train acc : 0.963, valid acc : 0.960, train f1 : 0.963, valid f1 : 0.713
training process:  66%|██████▌   | 33/50 [1:53:02<59:20, 209.47s/it]training process:  68%|██████▊   | 34/50 [1:56:17<54:45, 205.32s/it]training process:  70%|███████   | 35/50 [1:59:33<50:36, 202.43s/it]training process:  72%|███████▏  | 36/50 [2:02:46<46:34, 199.59s/it]epoch : 37, train loss : 0.007, valid loss : 0.017, train acc : 0.966, valid acc : 0.934, train f1 : 0.966, valid f1 : 0.648
training process:  74%|███████▍  | 37/50 [2:06:44<45:43, 211.01s/it]training process:  76%|███████▌  | 38/50 [2:09:59<41:15, 206.25s/it]training process:  78%|███████▊  | 39/50 [2:13:11<37:03, 202.12s/it]training process:  80%|████████  | 40/50 [2:16:24<33:13, 199.34s/it]epoch : 41, train loss : 0.006, valid loss : 0.013, train acc : 0.968, valid acc : 0.961, train f1 : 0.968, valid f1 : 0.716
training process:  82%|████████▏ | 41/50 [2:20:21<31:34, 210.56s/it]training process:  84%|████████▍ | 42/50 [2:23:35<27:25, 205.74s/it]training process:  86%|████████▌ | 43/50 [2:26:47<23:30, 201.55s/it]training process:  88%|████████▊ | 44/50 [2:29:59<19:51, 198.61s/it]epoch : 45, train loss : 0.008, valid loss : 0.009, train acc : 0.966, valid acc : 0.954, train f1 : 0.966, valid f1 : 0.700
training process:  90%|█████████ | 45/50 [2:33:59<17:35, 211.13s/it]training process:  92%|█████████▏| 46/50 [2:37:11<13:41, 205.45s/it]training process:  94%|█████████▍| 47/50 [2:40:25<10:05, 201.80s/it]training process:  96%|█████████▌| 48/50 [2:43:41<06:40, 200.02s/it]epoch : 49, train loss : 0.006, valid loss : 0.014, train acc : 0.972, valid acc : 0.975, train f1 : 0.972, valid f1 : 0.770
training process:  98%|█████████▊| 49/50 [2:47:43<03:32, 212.61s/it]training process: 100%|██████████| 50/50 [2:50:58<00:00, 207.49s/it]training process: 100%|██████████| 50/50 [2:50:58<00:00, 205.17s/it]
training process finished, best loss : 0.010 and best acc : 0.976, best f1 : 0.779, best epoch : 18

################# evaluation process #################

############### Classification Report ####################
              precision    recall  f1-score   support

           0       0.39      0.90      0.55        71
           1       1.00      0.97      0.99      3812

    accuracy                           0.97      3883
   macro avg       0.70      0.94      0.77      3883
weighted avg       0.99      0.97      0.98      3883


# test acc : 0.97, test f1 : 0.77, test AUC : 0.94, test loss : 0.127

################# Visualization process #################


################# Probability curve generation process #################

  0%|          | 0/981 [00:00<?, ?it/s]  0%|          | 2/981 [00:00<00:51, 18.85it/s]  1%|          | 5/981 [00:00<00:44, 21.90it/s]  1%|          | 8/981 [00:00<00:42, 22.79it/s]  1%|          | 11/981 [00:00<00:41, 23.19it/s]  1%|▏         | 14/981 [00:00<00:40, 23.69it/s]  2%|▏         | 17/981 [00:00<00:40, 23.85it/s]  2%|▏         | 20/981 [00:00<00:39, 24.13it/s]  2%|▏         | 23/981 [00:00<00:39, 24.11it/s]  3%|▎         | 26/981 [00:01<00:40, 23.83it/s]  3%|▎         | 29/981 [00:01<00:40, 23.78it/s]  3%|▎         | 32/981 [00:01<00:39, 23.77it/s]  4%|▎         | 35/981 [00:01<00:39, 23.76it/s]  4%|▍         | 38/981 [00:01<00:39, 23.77it/s]  4%|▍         | 41/981 [00:01<00:39, 23.79it/s]  4%|▍         | 44/981 [00:01<00:39, 23.78it/s]  5%|▍         | 47/981 [00:01<00:39, 23.73it/s]  5%|▌         | 50/981 [00:02<00:39, 23.50it/s]  5%|▌         | 53/981 [00:02<00:38, 23.84it/s]  6%|▌         | 56/981 [00:02<00:38, 23.95it/s]  6%|▌         | 59/981 [00:02<00:38, 23.79it/s]  6%|▋         | 62/981 [00:02<00:38, 23.83it/s]  7%|▋         | 65/981 [00:02<00:38, 23.95it/s]  7%|▋         | 68/981 [00:02<00:38, 24.00it/s]  7%|▋         | 71/981 [00:02<00:37, 24.04it/s]  8%|▊         | 74/981 [00:03<00:37, 24.06it/s]  8%|▊         | 77/981 [00:03<00:37, 24.05it/s]  8%|▊         | 80/981 [00:03<00:37, 23.83it/s]  8%|▊         | 83/981 [00:03<00:37, 23.85it/s]  9%|▉         | 86/981 [00:03<00:37, 23.59it/s]  9%|▉         | 89/981 [00:03<00:38, 23.34it/s]  9%|▉         | 92/981 [00:03<00:38, 23.11it/s] 10%|▉         | 95/981 [00:04<00:38, 23.29it/s] 10%|▉         | 98/981 [00:04<00:37, 23.52it/s] 10%|█         | 101/981 [00:04<00:37, 23.37it/s] 11%|█         | 104/981 [00:04<00:37, 23.27it/s] 11%|█         | 107/981 [00:04<00:37, 23.25it/s] 11%|█         | 110/981 [00:04<00:37, 23.24it/s] 12%|█▏        | 113/981 [00:04<00:37, 23.23it/s] 12%|█▏        | 116/981 [00:04<00:37, 23.13it/s] 12%|█▏        | 119/981 [00:05<00:37, 22.98it/s] 12%|█▏        | 122/981 [00:05<00:37, 22.92it/s] 13%|█▎        | 125/981 [00:05<00:37, 22.89it/s] 13%|█▎        | 128/981 [00:05<00:37, 23.02it/s] 13%|█▎        | 131/981 [00:05<00:36, 23.43it/s] 14%|█▎        | 134/981 [00:05<00:36, 23.41it/s] 14%|█▍        | 137/981 [00:05<00:35, 23.67it/s] 14%|█▍        | 140/981 [00:05<00:35, 23.60it/s] 15%|█▍        | 143/981 [00:06<00:35, 23.93it/s] 15%|█▍        | 146/981 [00:06<00:34, 24.05it/s] 15%|█▌        | 149/981 [00:06<00:34, 23.98it/s] 15%|█▌        | 152/981 [00:06<00:34, 24.02it/s] 16%|█▌        | 155/981 [00:06<00:34, 24.04it/s] 16%|█▌        | 158/981 [00:06<00:34, 24.16it/s] 16%|█▋        | 161/981 [00:06<00:33, 24.16it/s] 17%|█▋        | 164/981 [00:06<00:33, 24.09it/s] 17%|█▋        | 167/981 [00:07<00:33, 24.14it/s] 17%|█▋        | 170/981 [00:07<00:33, 24.04it/s] 18%|█▊        | 173/981 [00:07<00:33, 24.00it/s] 18%|█▊        | 176/981 [00:07<00:33, 23.87it/s] 18%|█▊        | 179/981 [00:07<00:33, 23.88it/s] 19%|█▊        | 182/981 [00:07<00:33, 23.87it/s] 19%|█▉        | 185/981 [00:07<00:33, 23.83it/s] 19%|█▉        | 188/981 [00:07<00:33, 23.87it/s] 19%|█▉        | 191/981 [00:08<00:32, 24.06it/s] 20%|█▉        | 194/981 [00:08<00:32, 24.15it/s] 20%|██        | 197/981 [00:08<00:32, 24.06it/s] 20%|██        | 200/981 [00:08<00:32, 23.91it/s] 21%|██        | 203/981 [00:08<00:32, 23.79it/s] 21%|██        | 206/981 [00:08<00:32, 23.70it/s] 21%|██▏       | 209/981 [00:08<00:32, 23.58it/s] 22%|██▏       | 212/981 [00:08<00:32, 23.49it/s] 22%|██▏       | 215/981 [00:09<00:32, 23.40it/s] 22%|██▏       | 218/981 [00:09<00:32, 23.26it/s] 23%|██▎       | 221/981 [00:09<00:32, 23.08it/s] 23%|██▎       | 224/981 [00:09<00:32, 23.18it/s] 23%|██▎       | 227/981 [00:09<00:32, 23.34it/s] 23%|██▎       | 230/981 [00:09<00:32, 23.40it/s] 24%|██▍       | 233/981 [00:09<00:32, 23.10it/s] 24%|██▍       | 236/981 [00:09<00:32, 23.06it/s] 24%|██▍       | 239/981 [00:10<00:32, 22.79it/s] 25%|██▍       | 242/981 [00:10<00:32, 22.94it/s] 25%|██▍       | 245/981 [00:10<00:31, 23.05it/s] 25%|██▌       | 248/981 [00:10<00:31, 23.02it/s] 26%|██▌       | 251/981 [00:10<00:31, 23.34it/s] 26%|██▌       | 254/981 [00:10<00:31, 23.39it/s] 26%|██▌       | 257/981 [00:10<00:30, 23.40it/s] 27%|██▋       | 260/981 [00:11<00:30, 23.55it/s] 27%|██▋       | 263/981 [00:11<00:30, 23.73it/s] 27%|██▋       | 266/981 [00:11<00:30, 23.73it/s] 27%|██▋       | 269/981 [00:11<00:30, 23.13it/s] 28%|██▊       | 272/981 [00:11<00:31, 22.60it/s] 28%|██▊       | 275/981 [00:11<00:31, 22.47it/s] 28%|██▊       | 278/981 [00:11<00:30, 22.83it/s] 29%|██▊       | 281/981 [00:11<00:30, 23.21it/s] 29%|██▉       | 284/981 [00:12<00:29, 23.26it/s] 29%|██▉       | 287/981 [00:12<00:29, 23.57it/s] 30%|██▉       | 290/981 [00:12<00:29, 23.50it/s] 30%|██▉       | 293/981 [00:12<00:29, 23.58it/s] 30%|███       | 296/981 [00:12<00:28, 23.69it/s] 30%|███       | 299/981 [00:12<00:28, 23.77it/s] 31%|███       | 302/981 [00:12<00:28, 23.43it/s] 31%|███       | 305/981 [00:12<00:28, 23.38it/s] 31%|███▏      | 308/981 [00:13<00:28, 23.38it/s] 32%|███▏      | 311/981 [00:13<00:28, 23.34it/s] 32%|███▏      | 314/981 [00:13<00:28, 23.31it/s] 32%|███▏      | 317/981 [00:13<00:28, 23.28it/s] 33%|███▎      | 320/981 [00:13<00:28, 23.27it/s] 33%|███▎      | 323/981 [00:13<00:28, 23.28it/s] 33%|███▎      | 326/981 [00:13<00:28, 23.28it/s] 34%|███▎      | 329/981 [00:13<00:27, 23.31it/s] 34%|███▍      | 332/981 [00:14<00:27, 23.60it/s] 34%|███▍      | 335/981 [00:14<00:27, 23.74it/s] 34%|███▍      | 338/981 [00:14<00:27, 23.60it/s] 35%|███▍      | 341/981 [00:14<00:27, 23.53it/s] 35%|███▌      | 344/981 [00:14<00:27, 23.40it/s] 35%|███▌      | 347/981 [00:14<00:27, 23.40it/s] 36%|███▌      | 350/981 [00:14<00:27, 23.37it/s] 36%|███▌      | 353/981 [00:15<00:26, 23.35it/s] 36%|███▋      | 356/981 [00:15<00:26, 23.30it/s] 37%|███▋      | 359/981 [00:15<00:26, 23.29it/s] 37%|███▋      | 362/981 [00:15<00:26, 23.36it/s] 37%|███▋      | 365/981 [00:15<00:26, 23.57it/s] 38%|███▊      | 368/981 [00:15<00:25, 23.73it/s] 38%|███▊      | 371/981 [00:15<00:25, 23.76it/s] 38%|███▊      | 374/981 [00:15<00:25, 23.62it/s] 38%|███▊      | 377/981 [00:16<00:25, 23.53it/s] 39%|███▊      | 380/981 [00:16<00:25, 23.44it/s] 39%|███▉      | 383/981 [00:16<00:25, 23.38it/s] 39%|███▉      | 386/981 [00:16<00:25, 23.32it/s] 40%|███▉      | 389/981 [00:16<00:25, 23.26it/s] 40%|███▉      | 392/981 [00:16<00:25, 23.23it/s] 40%|████      | 395/981 [00:16<00:25, 23.18it/s] 41%|████      | 398/981 [00:16<00:25, 23.22it/s] 41%|████      | 401/981 [00:17<00:24, 23.47it/s] 41%|████      | 404/981 [00:17<00:24, 23.64it/s] 41%|████▏     | 407/981 [00:17<00:24, 23.62it/s] 42%|████▏     | 410/981 [00:17<00:24, 23.54it/s] 42%|████▏     | 413/981 [00:17<00:24, 23.31it/s] 42%|████▏     | 416/981 [00:17<00:24, 23.30it/s] 43%|████▎     | 419/981 [00:17<00:24, 23.35it/s] 43%|████▎     | 422/981 [00:17<00:23, 23.37it/s] 43%|████▎     | 425/981 [00:18<00:23, 23.38it/s] 44%|████▎     | 428/981 [00:18<00:23, 23.47it/s] 44%|████▍     | 431/981 [00:18<00:23, 23.36it/s] 44%|████▍     | 434/981 [00:18<00:23, 23.54it/s] 45%|████▍     | 437/981 [00:18<00:22, 23.70it/s] 45%|████▍     | 440/981 [00:18<00:22, 23.76it/s] 45%|████▌     | 443/981 [00:18<00:22, 23.71it/s] 45%|████▌     | 446/981 [00:18<00:22, 23.56it/s] 46%|████▌     | 449/981 [00:19<00:22, 23.49it/s] 46%|████▌     | 452/981 [00:19<00:22, 23.18it/s] 46%|████▋     | 455/981 [00:19<00:22, 23.34it/s] 47%|████▋     | 458/981 [00:19<00:22, 23.61it/s] 47%|████▋     | 461/981 [00:19<00:22, 23.47it/s] 47%|████▋     | 464/981 [00:19<00:21, 23.60it/s] 48%|████▊     | 467/981 [00:19<00:21, 23.59it/s] 48%|████▊     | 470/981 [00:19<00:21, 23.70it/s] 48%|████▊     | 473/981 [00:20<00:21, 23.69it/s] 49%|████▊     | 476/981 [00:20<00:21, 23.72it/s] 49%|████▉     | 479/981 [00:20<00:21, 23.63it/s] 49%|████▉     | 482/981 [00:20<00:21, 23.69it/s] 49%|████▉     | 485/981 [00:20<00:20, 23.73it/s] 50%|████▉     | 488/981 [00:20<00:20, 23.66it/s] 50%|█████     | 491/981 [00:20<00:20, 23.61it/s] 50%|█████     | 494/981 [00:21<00:20, 23.55it/s] 51%|█████     | 497/981 [00:21<00:20, 23.52it/s] 51%|█████     | 500/981 [00:21<00:20, 23.46it/s] 51%|█████▏    | 503/981 [00:21<00:20, 23.59it/s] 52%|█████▏    | 506/981 [00:21<00:19, 23.86it/s] 52%|█████▏    | 509/981 [00:21<00:19, 23.98it/s] 52%|█████▏    | 512/981 [00:21<00:19, 24.06it/s] 52%|█████▏    | 515/981 [00:21<00:19, 23.98it/s] 53%|█████▎    | 518/981 [00:22<00:19, 23.93it/s] 53%|█████▎    | 521/981 [00:22<00:19, 23.90it/s] 53%|█████▎    | 524/981 [00:22<00:19, 23.92it/s] 54%|█████▎    | 527/981 [00:22<00:18, 23.91it/s] 54%|█████▍    | 530/981 [00:22<00:18, 23.92it/s] 54%|█████▍    | 533/981 [00:22<00:18, 23.87it/s] 55%|█████▍    | 536/981 [00:22<00:18, 23.82it/s] 55%|█████▍    | 539/981 [00:22<00:18, 24.08it/s] 55%|█████▌    | 542/981 [00:23<00:18, 24.25it/s] 56%|█████▌    | 545/981 [00:23<00:17, 24.39it/s] 56%|█████▌    | 548/981 [00:23<00:17, 24.32it/s] 56%|█████▌    | 551/981 [00:23<00:17, 24.25it/s] 56%|█████▋    | 554/981 [00:23<00:17, 24.19it/s] 57%|█████▋    | 557/981 [00:23<00:17, 24.18it/s] 57%|█████▋    | 560/981 [00:23<00:17, 24.12it/s] 57%|█████▋    | 563/981 [00:23<00:17, 24.12it/s] 58%|█████▊    | 566/981 [00:24<00:17, 24.09it/s] 58%|█████▊    | 569/981 [00:24<00:17, 24.00it/s] 58%|█████▊    | 572/981 [00:24<00:17, 23.99it/s] 59%|█████▊    | 575/981 [00:24<00:16, 24.32it/s] 59%|█████▉    | 578/981 [00:24<00:16, 24.28it/s] 59%|█████▉    | 581/981 [00:24<00:16, 24.46it/s] 60%|█████▉    | 584/981 [00:24<00:16, 24.35it/s] 60%|█████▉    | 587/981 [00:24<00:16, 24.24it/s] 60%|██████    | 590/981 [00:24<00:16, 24.18it/s] 60%|██████    | 593/981 [00:25<00:16, 24.17it/s] 61%|██████    | 596/981 [00:25<00:15, 24.14it/s] 61%|██████    | 599/981 [00:25<00:15, 24.16it/s] 61%|██████▏   | 602/981 [00:25<00:15, 24.14it/s] 62%|██████▏   | 605/981 [00:25<00:15, 24.04it/s] 62%|██████▏   | 608/981 [00:25<00:15, 24.00it/s] 62%|██████▏   | 611/981 [00:25<00:15, 24.25it/s] 63%|██████▎   | 614/981 [00:25<00:14, 24.47it/s] 63%|██████▎   | 617/981 [00:26<00:14, 24.46it/s] 63%|██████▎   | 620/981 [00:26<00:14, 24.36it/s] 64%|██████▎   | 623/981 [00:26<00:14, 24.29it/s] 64%|██████▍   | 626/981 [00:26<00:14, 24.21it/s] 64%|██████▍   | 629/981 [00:26<00:14, 24.18it/s] 64%|██████▍   | 632/981 [00:26<00:14, 24.14it/s] 65%|██████▍   | 635/981 [00:26<00:14, 24.12it/s] 65%|██████▌   | 638/981 [00:26<00:14, 24.11it/s] 65%|██████▌   | 641/981 [00:27<00:14, 24.02it/s] 66%|██████▌   | 644/981 [00:27<00:13, 24.09it/s] 66%|██████▌   | 647/981 [00:27<00:13, 24.27it/s] 66%|██████▋   | 650/981 [00:27<00:13, 24.50it/s] 67%|██████▋   | 653/981 [00:27<00:13, 24.62it/s] 67%|██████▋   | 656/981 [00:27<00:13, 24.51it/s] 67%|██████▋   | 659/981 [00:27<00:13, 24.44it/s] 67%|██████▋   | 662/981 [00:27<00:13, 24.35it/s] 68%|██████▊   | 665/981 [00:28<00:12, 24.32it/s] 68%|██████▊   | 668/981 [00:28<00:12, 24.26it/s] 68%|██████▊   | 671/981 [00:28<00:12, 24.27it/s] 69%|██████▊   | 674/981 [00:28<00:12, 24.20it/s] 69%|██████▉   | 677/981 [00:28<00:12, 24.05it/s] 69%|██████▉   | 680/981 [00:28<00:12, 24.11it/s] 70%|██████▉   | 683/981 [00:28<00:12, 24.40it/s] 70%|██████▉   | 686/981 [00:28<00:12, 24.53it/s] 70%|███████   | 689/981 [00:29<00:11, 24.38it/s] 71%|███████   | 692/981 [00:29<00:11, 24.22it/s] 71%|███████   | 695/981 [00:29<00:11, 24.20it/s] 71%|███████   | 698/981 [00:29<00:11, 24.20it/s] 71%|███████▏  | 701/981 [00:29<00:11, 24.20it/s] 72%|███████▏  | 704/981 [00:29<00:11, 24.20it/s] 72%|███████▏  | 707/981 [00:29<00:11, 24.21it/s] 72%|███████▏  | 710/981 [00:29<00:11, 24.15it/s] 73%|███████▎  | 713/981 [00:30<00:11, 23.97it/s] 73%|███████▎  | 716/981 [00:30<00:10, 24.15it/s] 73%|███████▎  | 719/981 [00:30<00:10, 24.37it/s] 74%|███████▎  | 722/981 [00:30<00:10, 24.55it/s] 74%|███████▍  | 725/981 [00:30<00:10, 24.32it/s] 74%|███████▍  | 728/981 [00:30<00:10, 24.21it/s] 75%|███████▍  | 731/981 [00:30<00:10, 24.17it/s] 75%|███████▍  | 734/981 [00:30<00:10, 24.11it/s] 75%|███████▌  | 737/981 [00:31<00:10, 24.12it/s] 75%|███████▌  | 740/981 [00:31<00:10, 24.00it/s] 76%|███████▌  | 743/981 [00:31<00:09, 23.98it/s] 76%|███████▌  | 746/981 [00:31<00:09, 23.92it/s] 76%|███████▋  | 749/981 [00:31<00:09, 23.80it/s] 77%|███████▋  | 752/981 [00:31<00:09, 23.90it/s] 77%|███████▋  | 755/981 [00:31<00:09, 24.23it/s] 77%|███████▋  | 758/981 [00:31<00:09, 24.37it/s] 78%|███████▊  | 761/981 [00:32<00:09, 24.33it/s] 78%|███████▊  | 764/981 [00:32<00:08, 24.20it/s] 78%|███████▊  | 767/981 [00:32<00:08, 24.09it/s] 78%|███████▊  | 770/981 [00:32<00:08, 24.00it/s] 79%|███████▉  | 773/981 [00:32<00:08, 23.98it/s] 79%|███████▉  | 776/981 [00:32<00:08, 23.94it/s] 79%|███████▉  | 779/981 [00:32<00:08, 23.98it/s] 80%|███████▉  | 782/981 [00:32<00:08, 24.12it/s] 80%|████████  | 785/981 [00:33<00:08, 24.32it/s] 80%|████████  | 788/981 [00:33<00:07, 24.90it/s] 81%|████████  | 791/981 [00:33<00:07, 25.54it/s] 81%|████████  | 794/981 [00:33<00:07, 25.96it/s] 81%|████████  | 797/981 [00:33<00:06, 26.34it/s] 82%|████████▏ | 800/981 [00:33<00:06, 26.59it/s] 82%|████████▏ | 803/981 [00:33<00:06, 26.76it/s] 82%|████████▏ | 806/981 [00:33<00:06, 26.87it/s] 82%|████████▏ | 809/981 [00:33<00:06, 26.97it/s] 83%|████████▎ | 812/981 [00:34<00:06, 27.03it/s] 83%|████████▎ | 815/981 [00:34<00:06, 26.90it/s] 83%|████████▎ | 818/981 [00:34<00:06, 26.98it/s] 84%|████████▎ | 821/981 [00:34<00:05, 27.02it/s] 84%|████████▍ | 824/981 [00:34<00:05, 27.05it/s] 84%|████████▍ | 827/981 [00:34<00:05, 27.29it/s] 85%|████████▍ | 830/981 [00:34<00:05, 27.66it/s] 85%|████████▍ | 833/981 [00:34<00:05, 27.92it/s] 85%|████████▌ | 836/981 [00:34<00:05, 27.94it/s] 86%|████████▌ | 839/981 [00:35<00:05, 27.79it/s] 86%|████████▌ | 842/981 [00:35<00:05, 27.71it/s] 86%|████████▌ | 845/981 [00:35<00:04, 27.64it/s] 86%|████████▋ | 848/981 [00:35<00:04, 27.61it/s] 87%|████████▋ | 851/981 [00:35<00:04, 27.60it/s] 87%|████████▋ | 854/981 [00:35<00:04, 27.57it/s] 87%|████████▋ | 857/981 [00:35<00:04, 27.53it/s] 88%|████████▊ | 860/981 [00:35<00:04, 27.45it/s] 88%|████████▊ | 863/981 [00:35<00:04, 27.40it/s] 88%|████████▊ | 866/981 [00:36<00:04, 27.46it/s] 89%|████████▊ | 869/981 [00:36<00:04, 27.76it/s] 89%|████████▉ | 872/981 [00:36<00:03, 27.93it/s] 89%|████████▉ | 875/981 [00:36<00:03, 28.06it/s] 90%|████████▉ | 878/981 [00:36<00:03, 27.90it/s] 90%|████████▉ | 881/981 [00:36<00:03, 27.80it/s] 90%|█████████ | 884/981 [00:36<00:03, 27.70it/s] 90%|█████████ | 887/981 [00:36<00:03, 27.68it/s] 91%|█████████ | 890/981 [00:36<00:03, 27.67it/s] 91%|█████████ | 893/981 [00:36<00:03, 27.63it/s] 91%|█████████▏| 896/981 [00:37<00:03, 27.60it/s] 92%|█████████▏| 899/981 [00:37<00:02, 27.59it/s] 92%|█████████▏| 902/981 [00:37<00:02, 27.50it/s] 92%|█████████▏| 905/981 [00:37<00:02, 27.48it/s] 93%|█████████▎| 908/981 [00:37<00:02, 27.91it/s] 93%|█████████▎| 911/981 [00:37<00:02, 28.20it/s] 93%|█████████▎| 914/981 [00:37<00:02, 28.42it/s] 93%|█████████▎| 917/981 [00:37<00:02, 28.22it/s] 94%|█████████▍| 920/981 [00:37<00:02, 28.04it/s] 94%|█████████▍| 923/981 [00:38<00:02, 27.91it/s] 94%|█████████▍| 926/981 [00:38<00:01, 27.81it/s] 95%|█████████▍| 929/981 [00:38<00:01, 27.72it/s] 95%|█████████▌| 932/981 [00:38<00:01, 27.67it/s] 95%|█████████▌| 935/981 [00:38<00:01, 27.65it/s] 96%|█████████▌| 938/981 [00:38<00:01, 27.62it/s] 96%|█████████▌| 941/981 [00:38<00:01, 27.60it/s] 96%|█████████▌| 944/981 [00:38<00:01, 27.50it/s] 97%|█████████▋| 947/981 [00:38<00:01, 27.77it/s] 97%|█████████▋| 950/981 [00:39<00:01, 28.10it/s] 97%|█████████▋| 953/981 [00:39<00:00, 28.34it/s] 97%|█████████▋| 956/981 [00:39<00:00, 28.36it/s] 98%|█████████▊| 959/981 [00:39<00:00, 27.98it/s] 98%|█████████▊| 962/981 [00:39<00:00, 27.82it/s] 98%|█████████▊| 965/981 [00:39<00:00, 27.73it/s] 99%|█████████▊| 968/981 [00:39<00:00, 27.68it/s] 99%|█████████▉| 971/981 [00:39<00:00, 27.64it/s] 99%|█████████▉| 974/981 [00:39<00:00, 27.60it/s]100%|█████████▉| 977/981 [00:39<00:00, 27.60it/s]100%|█████████▉| 980/981 [00:40<00:00, 27.57it/s]100%|██████████| 981/981 [00:40<00:00, 24.44it/s]
time :  1338
prob :  1338
thermal quench :  5.342
current quench:  5.368
/home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/io/image.py:11: UserWarning: Failed to load image Python extension: /home/jinsukim/miniconda3/envs/research-env/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZNK3c1010TensorImpl36is_contiguous_nondefault_policy_implENS_12MemoryFormatE
  warn(f"Failed to load image Python extension: {e}")
############### device setup ###################
torch device avaliable :  True
torch current device :  0
torch device num :  4
running : ViViT-exp_clip_21_dist_3_CE_DRW
train data : 13447, disrupt : 227, non-disrupt : 13220
valid data : 3119, disrupt : 57, non-disrupt : 3062
test data : 3883, disrupt : 71, non-disrupt : 3812

################# model summary #################

--------------------------------------------------------------------------------------------
   Parent Layers       Layer (type)              Input Shape         Param #     Tr. Param #
============================================================================================
           ViViT        Rearrange-1     [8, 21, 3, 128, 128]               0               0
           ViViT           Linear-2         [8, 21, 64, 768]          98,432          98,432
           ViViT          Dropout-3         [8, 21, 65, 128]               0               0
           ViViT      Transformer-4           [168, 65, 128]         790,272         790,272
           ViViT      Transformer-5             [8, 22, 128]         790,272         790,272
           ViViT           Linear-6                 [8, 128]           8,256           8,256
           ViViT        LayerNorm-7                  [8, 64]             128             128
           ViViT              ELU-8                  [8, 64]               0               0
           ViViT           Linear-9                  [8, 64]             130             130
============================================================================================
Total params: 1,687,490
Trainable params: 1,687,490
Non-trainable params: 0
--------------------------------------------------------------------------------------------

################# training process #################

training process - Deferred Re-weighting:   0%|          | 0/50 [00:00<?, ?it/s]training process - Deferred Re-weighting:   2%|▏         | 1/50 [03:17<2:41:03, 197.22s/it]epoch : 1, train loss : 0.105, valid loss : 0.113, train f1 : 0.496, valid f1 : 0.495
training process - Deferred Re-weighting:   4%|▍         | 2/50 [06:36<2:38:32, 198.19s/it]training process - Deferred Re-weighting:   6%|▌         | 3/50 [09:50<2:34:01, 196.62s/it]training process - Deferred Re-weighting:   8%|▊         | 4/50 [13:08<2:31:07, 197.13s/it]training process - Deferred Re-weighting:  10%|█         | 5/50 [16:26<2:27:53, 197.20s/it]epoch : 5, train loss : 0.094, valid loss : 0.111, train f1 : 0.640, valid f1 : 0.747
training process - Deferred Re-weighting:  12%|█▏        | 6/50 [19:41<2:24:17, 196.75s/it]training process - Deferred Re-weighting:  14%|█▍        | 7/50 [22:59<2:21:08, 196.94s/it]training process - Deferred Re-weighting:  16%|█▌        | 8/50 [26:16<2:17:55, 197.04s/it]training process - Deferred Re-weighting:  18%|█▊        | 9/50 [29:32<2:14:24, 196.71s/it]epoch : 9, train loss : 0.069, valid loss : 0.076, train f1 : 0.792, valid f1 : 0.785
training process - Deferred Re-weighting:  20%|██        | 10/50 [32:47<2:10:49, 196.23s/it]training process - Deferred Re-weighting:  22%|██▏       | 11/50 [36:01<2:07:03, 195.47s/it]training process - Deferred Re-weighting:  24%|██▍       | 12/50 [39:19<2:04:18, 196.27s/it]training process - Deferred Re-weighting:  26%|██▌       | 13/50 [42:35<2:00:54, 196.06s/it]epoch : 13, train loss : 0.069, valid loss : 0.072, train f1 : 0.788, valid f1 : 0.812
training process - Deferred Re-weighting:  28%|██▊       | 14/50 [45:50<1:57:33, 195.94s/it]training process - Deferred Re-weighting:  30%|███       | 15/50 [49:06<1:54:18, 195.95s/it]training process - Deferred Re-weighting:  32%|███▏      | 16/50 [52:32<1:52:38, 198.79s/it]training process - Deferred Re-weighting:  34%|███▍      | 17/50 [55:53<1:49:46, 199.59s/it]epoch : 17, train loss : 0.069, valid loss : 0.070, train f1 : 0.785, valid f1 : 0.794
training process - Deferred Re-weighting:  36%|███▌      | 18/50 [59:14<1:46:35, 199.87s/it]training process - Deferred Re-weighting:  38%|███▊      | 19/50 [1:02:43<1:44:46, 202.78s/it]training process - Deferred Re-weighting:  40%|████      | 20/50 [1:06:11<1:42:05, 204.18s/it]training process - Deferred Re-weighting:  42%|████▏     | 21/50 [1:09:33<1:38:29, 203.78s/it]epoch : 21, train loss : 0.071, valid loss : 0.073, train f1 : 0.783, valid f1 : 0.801
training process - Deferred Re-weighting:  44%|████▍     | 22/50 [1:12:57<1:35:04, 203.74s/it]training process - Deferred Re-weighting:  46%|████▌     | 23/50 [1:16:24<1:32:03, 204.59s/it]